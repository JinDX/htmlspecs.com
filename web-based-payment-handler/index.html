<!DOCTYPE html>
<html lang="zh-hans">

<head>
    <meta charset="utf-8">
    <!-- <meta name="generator" content="ReSpec 35.5.1"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <style>
        span.example-title {
            text-transform: none
        }

        :is(aside, div).example,
        div.illegal-example {
            padding: .5em;
            margin: 1em 0;
            position: relative;
            clear: both
        }

        div.illegal-example {
            color: red
        }

        div.illegal-example p {
            color: #000
        }

        aside.example div.example {
            border-left-width: .1em;
            border-color: #999;
            background: #fff
        }
    </style>
    <style>
        .issue-label {
            text-transform: initial
        }

        .warning>p:first-child {
            margin-top: 0
        }

        .warning {
            padding: .5em;
            border-left-width: .5em;
            border-left-style: solid
        }

        span.warning {
            padding: .1em .5em .15em
        }

        .issue.closed span.issue-number {
            text-decoration: line-through
        }

        .issue.closed span.issue-number::after {
            content: " (Closed)";
            font-size: smaller
        }

        .warning {
            border-color: #f11;
            border-color: var(--warning-border, #f11);
            border-width: .2em;
            border-style: solid;
            background: #fbe9e9;
            background: var(--warning-bg, #fbe9e9);
            color: #000;
            color: var(--text, #000)
        }

        .warning-title:before {
            content: "⚠";
            font-size: 1.3em;
            float: left;
            padding-right: .3em;
            margin-top: -.3em
        }

        li.task-list-item {
            list-style: none
        }

        input.task-list-item-checkbox {
            margin: 0 .35em .25em -1.6em;
            vertical-align: middle
        }

        .issue a.respec-gh-label {
            padding: 5px;
            margin: 0 2px 0 2px;
            font-size: 10px;
            text-transform: none;
            text-decoration: none;
            font-weight: 700;
            border-radius: 4px;
            position: relative;
            bottom: 2px;
            border: none;
            display: inline-block
        }
    </style>
    <style>
        pre.idl {
            padding: 1em;
            position: relative
        }

        pre.idl>code {
            color: #000;
            color: var(--text, #000)
        }

        @media print {
            pre.idl {
                white-space: pre-wrap
            }
        }

        .idlHeader {
            display: block;
            width: 150px;
            background: #8ccbf2;
            background: var(--def-border, #8ccbf2);
            color: #fff;
            color: var(--defrow-border, #fff);
            font-family: sans-serif;
            font-weight: 700;
            margin: -1em 0 1em -1em;
            height: 28px;
            line-height: 28px
        }

        .idlHeader a.self-link {
            margin-left: .3cm;
            text-decoration: none;
            border-bottom: none;
            color: inherit
        }

        .idlID {
            font-weight: 700;
            color: #005a9c
        }

        .idlType {
            color: #005a9c
        }

        .idlName {
            color: #ff4500
        }

        .idlName a {
            color: #ff4500;
            border-bottom: 1px dotted #ff4500;
            text-decoration: none
        }

        a.idlEnumItem {
            color: #000;
            border-bottom: 1px dotted #ccc;
            text-decoration: none
        }

        .idlSuperclass {
            font-style: italic;
            color: #005a9c
        }

        .idlDefaultValue,
        .idlParamName {
            font-style: italic
        }

        .extAttr {
            color: #666
        }

        .idlSectionComment {
            color: gray
        }

        .idlIncludes a {
            font-weight: 700
        }

        .respec-button-copy-paste:focus {
            text-decoration: none;
            border-color: #51a7e8;
            outline: 0;
            box-shadow: 0 0 5px rgba(81, 167, 232, .5)
        }

        .respec-button-copy-paste:is(:focus:hover, .selected:focus) {
            border-color: #51a7e8
        }

        .respec-button-copy-paste:is(:hover, :active, .zeroclipboard-is-hover, .zeroclipboard-is-active) {
            text-decoration: none;
            background-color: #ddd;
            background-image: linear-gradient(#eee, #ddd);
            border-color: #ccc
        }

        .respec-button-copy-paste:is(:active, .selected, .zeroclipboard-is-active) {
            background-color: #dcdcdc;
            background-image: none;
            border-color: #b5b5b5;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, .15)
        }

        .respec-button-copy-paste.selected:hover {
            background-color: #cfcfcf
        }

        .respec-button-copy-paste:is(:disabled, :disabled:hover, .disabled, .disabled:hover) {
            color: rgba(102, 102, 102, .5);
            cursor: default;
            background-color: rgba(229, 229, 229, .5);
            background-image: none;
            border-color: rgba(197, 197, 197, .5);
            box-shadow: none
        }

        @media print {
            .respec-button-copy-paste {
                visibility: hidden
            }
        }
    </style>
    <style>
        dfn {
            cursor: pointer
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            min-width: 300px;
            max-width: 500px;
            padding: .5em .75em;
            margin-top: .6em;
            font-family: "Helvetica Neue", sans-serif;
            font-size: small;
            background: #fff;
            background: var(--indextable-hover-bg, #fff);
            color: #000;
            color: var(--text, #000);
            box-shadow: 0 1em 3em -.4em rgba(0, 0, 0, .3), 0 0 1px 1px rgba(0, 0, 0, .05);
            box-shadow: 0 1em 3em -.4em var(--tocsidebar-shadow, rgba(0, 0, 0, .3)), 0 0 1px 1px var(--tocsidebar-shadow, rgba(0, 0, 0, .05));
            border-radius: 2px
        }

        .dfn-panel:not(.docked)>.caret {
            position: absolute;
            top: -9px
        }

        .dfn-panel:not(.docked)>.caret::after,
        .dfn-panel:not(.docked)>.caret::before {
            content: "";
            position: absolute;
            border: 10px solid transparent;
            border-top: 0;
            border-bottom: 10px solid #fff;
            border-bottom-color: var(--indextable-hover-bg, #fff);
            top: 0
        }

        .dfn-panel:not(.docked)>.caret::before {
            border-bottom: 9px solid #a2a9b1;
            border-bottom-color: var(--indextable-hover-bg, #a2a9b1)
        }

        .dfn-panel * {
            margin: 0
        }

        .dfn-panel b {
            display: block;
            color: #000;
            color: var(--text, #000);
            margin-top: .25em
        }

        .dfn-panel ul a[href] {
            color: #333;
            color: var(--text, #333)
        }

        .dfn-panel>div {
            display: flex
        }

        .dfn-panel a.self-link {
            font-weight: 700;
            margin-right: auto
        }

        .dfn-panel .marker {
            padding: .1em;
            margin-left: .5em;
            border-radius: .2em;
            text-align: center;
            white-space: nowrap;
            font-size: 90%;
            color: #040b1c
        }

        .dfn-panel .marker.dfn-exported {
            background: #d1edfd;
            box-shadow: 0 0 0 .125em #1ca5f940
        }

        .dfn-panel .marker.idl-block {
            background: #8ccbf2;
            box-shadow: 0 0 0 .125em #0670b161
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important
        }

        .dfn-panel a[href]:hover {
            border-bottom-width: 1px
        }

        .dfn-panel ul {
            padding: 0
        }

        .dfn-panel li {
            margin-left: 1em
        }

        .dfn-panel.docked {
            position: fixed;
            left: .5em;
            top: unset;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - .75em * 2 - .5em - .2em * 2);
            max-height: 30vh;
            overflow: auto
        }
    </style>


    <title>基于 Web 的支付处理程序 API</title>

    <style id="respec-mainstyle">
        @keyframes pop {
            0% {
                transform: scale(1, 1)
            }

            25% {
                transform: scale(1.25, 1.25);
                opacity: .75
            }

            100% {
                transform: scale(1, 1)
            }
        }

        a.internalDFN {
            color: inherit;
            border-bottom: 1px solid #99c;
            text-decoration: none
        }

        a.externalDFN {
            color: inherit;
            border-bottom: 1px dotted #ccc;
            text-decoration: none
        }

        a.bibref {
            text-decoration: none
        }

        .respec-offending-element:target {
            animation: pop .25s ease-in-out 0s 1
        }

        .respec-offending-element,
        a[href].respec-offending-element {
            text-decoration: red wavy underline
        }

        @supports not (text-decoration:red wavy underline) {
            .respec-offending-element:not(pre) {
                display: inline-block
            }

            .respec-offending-element {
                background: url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x
            }
        }

        #references :target {
            background: #eaf3ff;
            animation: pop .4s ease-in-out 0s 1
        }

        cite .bibref {
            font-style: italic
        }

        a[href].orcid {
            padding-left: 4px;
            padding-right: 4px
        }

        a[href].orcid>svg {
            margin-bottom: -2px
        }

        ol.tof,
        ul.tof {
            list-style: none outside none
        }

        .caption {
            margin-top: .5em;
            font-style: italic
        }

        #issue-summary>ul {
            column-count: 2
        }

        #issue-summary li {
            list-style: none;
            display: inline-block
        }

        details.respec-tests-details {
            margin-left: 1em;
            display: inline-block;
            vertical-align: top
        }

        details.respec-tests-details>* {
            padding-right: 2em
        }

        details.respec-tests-details[open] {
            z-index: 999999;
            position: absolute;
            border: thin solid #cad3e2;
            border-radius: .3em;
            background-color: #fff;
            padding-bottom: .5em
        }

        details.respec-tests-details[open]>summary {
            border-bottom: thin solid #cad3e2;
            padding-left: 1em;
            margin-bottom: 1em;
            line-height: 2em
        }

        details.respec-tests-details>ul {
            width: 100%;
            margin-top: -.3em
        }

        details.respec-tests-details>li {
            padding-left: 1em
        }

        .self-link:hover {
            opacity: 1;
            text-decoration: none;
            background-color: transparent
        }

        aside.example .marker>a.self-link {
            color: inherit
        }

        .header-wrapper {
            display: flex;
            align-items: baseline
        }

        :is(h2, h3, h4, h5, h6):not(#toc>h2, #abstract>h2, #sotd>h2, .head>h2) {
            position: relative;
            left: -.5em
        }

        :is(h2, h3, h4, h5, h6):not(#toch2)+a.self-link {
            color: inherit;
            order: -1;
            position: relative;
            left: -1.1em;
            font-size: 1rem;
            opacity: .5
        }

        :is(h2, h3, h4, h5, h6)+a.self-link::before {
            content: "§";
            text-decoration: none;
            color: var(--heading-text)
        }

        :is(h2, h3)+a.self-link {
            top: -.2em
        }

        :is(h4, h5, h6)+a.self-link::before {
            color: #000
        }

        @media (max-width:767px) {
            dd {
                margin-left: 0
            }
        }

        @media print {
            .removeOnSave {
                display: none
            }
        }
    </style>


    <meta name="color-scheme" content="light">
    <!-- <meta name="revision" content="dd7e0d284c4476b1804c49ca205967141ebb464d"> -->
    <meta name="description" content="本规范定义了使 Web 应用能够
        处理支付请求的能力。">
    <link rel="canonical" href="https://www.w3.org/TR/web-based-payment-handler/">
    <style>
        .hljs {
            --base: #fafafa;
            --mono-1: #383a42;
            --mono-2: #686b77;
            --mono-3: #717277;
            --hue-1: #0b76c5;
            --hue-2: #336ae3;
            --hue-3: #a626a4;
            --hue-4: #42803c;
            --hue-5: #ca4706;
            --hue-5-2: #c91243;
            --hue-6: #986801;
            --hue-6-2: #9a6a01
        }

        @media (prefers-color-scheme:dark) {
            .hljs {
                --base: #282c34;
                --mono-1: #abb2bf;
                --mono-2: #818896;
                --mono-3: #5c6370;
                --hue-1: #56b6c2;
                --hue-2: #61aeee;
                --hue-3: #c678dd;
                --hue-4: #98c379;
                --hue-5: #e06c75;
                --hue-5-2: #be5046;
                --hue-6: #d19a66;
                --hue-6-2: #e6c07b
            }
        }

        .hljs {
            display: block;
            overflow-x: auto;
            padding: .5em;
            color: #383a42;
            color: var(--mono-1, #383a42);
            background: #fafafa;
            background: var(--base, #fafafa)
        }

        .hljs-comment,
        .hljs-quote {
            color: #717277;
            color: var(--mono-3, #717277);
            font-style: italic
        }

        .hljs-doctag,
        .hljs-formula,
        .hljs-keyword {
            color: #a626a4;
            color: var(--hue-3, #a626a4)
        }

        .hljs-deletion,
        .hljs-name,
        .hljs-section,
        .hljs-selector-tag,
        .hljs-subst {
            color: #ca4706;
            color: var(--hue-5, #ca4706);
            font-weight: 700
        }

        .hljs-literal {
            color: #0b76c5;
            color: var(--hue-1, #0b76c5)
        }

        .hljs-addition,
        .hljs-attribute,
        .hljs-meta-string,
        .hljs-regexp,
        .hljs-string {
            color: #42803c;
            color: var(--hue-4, #42803c)
        }

        .hljs-built_in,
        .hljs-class .hljs-title {
            color: #9a6a01;
            color: var(--hue-6-2, #9a6a01)
        }

        .hljs-attr,
        .hljs-number,
        .hljs-selector-attr,
        .hljs-selector-class,
        .hljs-selector-pseudo,
        .hljs-template-variable,
        .hljs-type,
        .hljs-variable {
            color: #986801;
            color: var(--hue-6, #986801)
        }

        .hljs-bullet,
        .hljs-link,
        .hljs-meta,
        .hljs-selector-id,
        .hljs-symbol,
        .hljs-title {
            color: #336ae3;
            color: var(--hue-2, #336ae3)
        }

        .hljs-emphasis {
            font-style: italic
        }

        .hljs-strong {
            font-weight: 700
        }

        .hljs-link {
            text-decoration: underline
        }
    </style>
    <style>
        var:hover {
            text-decoration: underline;
            cursor: pointer
        }

        var.respec-hl {
            color: var(--color, #000);
            background-color: var(--bg-color);
            box-shadow: 0 0 0 2px var(--bg-color)
        }

        @media (prefers-color-scheme:dark) {
            var.respec-hl {
                filter: saturate(.9) brightness(.9)
            }
        }

        var.respec-hl-c1 {
            --bg-color: #f4d200
        }

        var.respec-hl-c2 {
            --bg-color: #ff87a2
        }

        var.respec-hl-c3 {
            --bg-color: #96e885
        }

        var.respec-hl-c4 {
            --bg-color: #3eeed2
        }

        var.respec-hl-c5 {
            --bg-color: #eacfb6
        }

        var.respec-hl-c6 {
            --bg-color: #82ddff
        }

        var.respec-hl-c7 {
            --bg-color: #ffbcf2
        }

        @media print {
            var.respec-hl {
                background: 0 0;
                color: #000;
                box-shadow: unset
            }
        }
    </style>
    <style>
        var {
            position: relative;
            cursor: pointer
        }

        var[data-type]::after,
        var[data-type]::before {
            position: absolute;
            left: 50%;
            top: -6px;
            opacity: 0;
            transition: opacity .4s;
            pointer-events: none
        }

        var[data-type]::before {
            content: "";
            transform: translateX(-50%);
            border-width: 4px 6px 0 6px;
            border-style: solid;
            border-color: transparent;
            border-top-color: #222
        }

        var[data-type]::after {
            content: attr(data-type);
            transform: translateX(-50%) translateY(-100%);
            background: #222;
            text-align: center;
            font-family: "Dank Mono", "Fira Code", monospace;
            font-style: normal;
            padding: 6px;
            border-radius: 3px;
            color: #daca88;
            text-indent: 0;
            font-weight: 400
        }

        var[data-type]:hover::after,
        var[data-type]:hover::before {
            opacity: 1
        }
    </style>
    <script id="initialUserConfig" type="application/json">{
  "github": "https://github.com/w3c/web-based-payment-handler/",
  "specStatus": "WD",
  "previousPublishDate": "2026-02-17",
  "prevVersion": "FPWD",
  "previousMaturity": "WD",
  "editors": [
    {
      "name": "Ian Jacobs",
      "url": "http://www.w3.org/People/Jacobs/",
      "company": "W3C",
      "companyURL": "https://www.w3.org/",
      "w3cid": 2175
    },
    {
      "name": "Jinho Bang",
      "company": "Invited Expert",
      "email": "zino@chromium.org",
      "url": "https://github.com/romandev",
      "w3cid": 77147
    },
    {
      "name": "Stephen McGruer",
      "company": "Google",
      "companyURL": "https://www.google.com/",
      "email": "smcgruer@chromium.org",
      "w3cid": 96463
    }
  ],
  "formerEditors": [
    {
      "name": "Andre Lyver",
      "url": "https://github.com/lyverovski",
      "company": "Shopify",
      "companyURL": "https://shopify.com",
      "w3cid": 87485
    },
    {
      "name": "Tommy Thorsen",
      "url": "https://github.com/tommythorsen",
      "company": "Opera",
      "companyURL": "https://opera.com",
      "w3cid": 90636
    },
    {
      "name": "Adam Roach",
      "url": "https://github.com/adamroach",
      "company": "Mozilla",
      "companyURL": "https://mozilla.org",
      "w3cid": 67785
    },
    {
      "name": "Rouslan Solomakhin",
      "url": "https://github.com/rsolomakhin",
      "company": "Google",
      "companyURL": "https://www.google.com/",
      "w3cid": 83784
    },
    {
      "name": "Adrian Hope-Bailie",
      "url": "https://github.com/adrianhopebailie",
      "company": "Coil",
      "companyURL": "https://coil.com",
      "w3cid": 42590
    }
  ],
  "group": "payments",
  "testSuiteURI": "https://wpt.live/payment-handler/",
  "xref": "web-platform",
  "shortName": "web-based-payment-handler",
  "gitRevision": "d20fd52f69bb3d5413830b546ef9d87390822e4f",
  "publishDate": "2026-02-18",
  "publishISODate": "2026-02-18T00:00:00.000Z",
  "generatedSubtitle": "W3C Working Draft 18 February 2026"
}</script>
    <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD">
</head>

<body data-cite="WEBIDL service-workers payment-method-id payment-request HTML INFRA URL WEBIDL DOM FETCH"
    class="h-entry">
    <div class="head">
        <p class="logos"><a class="logo" href="https://www.w3.org/"><img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
            </a></p>
        <h1 id="title" class="title">基于 Web 的支付处理程序 API</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types#WD">W3C 工作草案</a> <time class="dt-published"
                datetime="2026-02-18">2026 年 2 月 18 日</time></p>
        <details open="">
            <summary>关于本文件的更多细节</summary>
            <dl>
                <dt>本版本：</dt>
                <dd>
                    <a class="u-url"
                        href="https://www.w3.org/TR/2026/WD-web-based-payment-handler-20260218/">https://www.w3.org/TR/2026/WD-web-based-payment-handler-20260218/</a>
                </dd>
                <dt>最新发布版本：</dt>
                <dd>
                    <a
                        href="https://www.w3.org/TR/web-based-payment-handler/">https://www.w3.org/TR/web-based-payment-handler/</a>
                </dd>
                <dt>最新编辑草案：</dt>
                <dd><a
                        href="https://w3c.github.io/web-based-payment-handler/">https://w3c.github.io/web-based-payment-handler/</a>
                </dd>
                <dt>历史版本：</dt>
                <dd>
                    <a
                        href="https://www.w3.org/standards/history/web-based-payment-handler/">https://www.w3.org/standards/history/web-based-payment-handler/</a>
                </dd>
                <dd>
                    <a href="https://github.com/w3c/web-based-payment-handler/commits/">提交历史</a>
                </dd>
                <dt>测试套件：</dt>
                <dd><a href="https://wpt.live/payment-handler/">https://wpt.live/payment-handler/</a></dd>




                <dt>编辑：</dt>
                <dd class="editor p-author h-card vcard" data-editor-id="2175">
                    <a class="u-url url p-name fn" href="https://www.w3.org/People/Jacobs/">Ian Jacobs</a> (<a
                        class="p-org org h-org" href="https://www.w3.org/">W3C</a>)
                </dd>
                <dd class="editor p-author h-card vcard" data-editor-id="77147">
                    <a class="u-url url p-name fn" href="https://github.com/romandev">Jinho Bang</a> (<span
                        class="p-org org h-org">受邀专家</span>)
                </dd>
                <dd class="editor p-author h-card vcard" data-editor-id="96463">
                    <span class="p-name fn">Stephen McGruer</span> (<a class="p-org org h-org"
                        href="https://www.google.com/">Google</a>)
                </dd>
                <dt>
                    前编辑：
                </dt>
                <dd class="editor p-author h-card vcard" data-editor-id="87485">
                    <a class="u-url url p-name fn" href="https://github.com/lyverovski">Andre Lyver</a> (<a
                        class="p-org org h-org" href="https://shopify.com">Shopify</a>)
                </dd>
                <dd class="editor p-author h-card vcard" data-editor-id="90636">
                    <a class="u-url url p-name fn" href="https://github.com/tommythorsen">Tommy Thorsen</a> (<a
                        class="p-org org h-org" href="https://opera.com">Opera</a>)
                </dd>
                <dd class="editor p-author h-card vcard" data-editor-id="67785">
                    <a class="u-url url p-name fn" href="https://github.com/adamroach">Adam Roach</a> (<a
                        class="p-org org h-org" href="https://mozilla.org">Mozilla</a>)
                </dd>
                <dd class="editor p-author h-card vcard" data-editor-id="83784">
                    <a class="u-url url p-name fn" href="https://github.com/rsolomakhin">Rouslan Solomakhin</a> (<a
                        class="p-org org h-org" href="https://www.google.com/">Google</a>)
                </dd>
                <dd class="editor p-author h-card vcard" data-editor-id="42590">
                    <a class="u-url url p-name fn" href="https://github.com/adrianhopebailie">Adrian Hope-Bailie</a> (<a
                        class="p-org org h-org" href="https://coil.com">Coil</a>)
                </dd>

                <dt>反馈：</dt>
                <dd>
                    <a href="https://github.com/w3c/web-based-payment-handler/">GitHub w3c/web-based-payment-handler</a>
                    (<a href="https://github.com/w3c/web-based-payment-handler/pulls/">拉取请求</a>,
                    <a href="https://github.com/w3c/web-based-payment-handler/issues/new/choose">新问题</a>,
                    <a href="https://github.com/w3c/web-based-payment-handler/issues/">开放问题</a>)
                </dd>


            </dl>
        </details>


        <p class="copyright">
            <a href="https://www.w3.org/policies/#copyright">Copyright</a>
            ©
            2026

            <a href="https://www.w3.org/">World Wide Web Consortium</a>.
            <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup>
            <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>,
            <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and
            <a rel="license" href="https://www.w3.org/copyright/software-license-2023/"
                title="W3C Software and Document Notice and License">permissive document license</a> rules apply.
        </p>
        <hr title="Separator for header">
    </div>
    <section id="abstract" class="introductory">
        <h2>摘要</h2>
        <p>
            本规范定义了使 Web 应用能够处理支付请求的能力。
        </p>
    </section>
    <section id="sotd" class="introductory">
        <h2>本文档状态</h2>
        <p><em>本节描述了本文件在发布时的状态。可在
                <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> 标准和草案索引</a>
                中找到当前的 W3C 出版物列表以及本技术报告的最新修订版。</em></p>
        <p>
            Web Payments 工作组维护着<a
                href="https://github.com/w3c/web-based-payment-handler/issues">一份该工作组尚未处理的所有错误报告列表</a>。本草案强调了一些仍待在工作组内讨论的未决问题。尚未就这些问题的结论作出决定，也未决定它们是否有效。强烈鼓励提交包含针对未决问题的规范文本建议的拉取请求。
        </p>
        <p>
            本文档由<a href="https://www.w3.org/groups/wg/payments">Web Payments 工作组</a>作为工作草案发布，使用了
            <a href="https://www.w3.org/policies/process/20250818/#recs-and-notes">Recommendation track</a>。
        </p>
        <p>作为工作草案发布并不意味着得到 <abbr title="World Wide Web Consortium">W3C</abbr> 及其成员的认可。 </p>
        <p>
            这是一个草案文档，可能随时被更新、替换或被其他文档废弃。不宜将此文档引用为除正在进行的工作之外的资料。
        </p>
        <p>
            本文档由在以下政策下运作的小组产生：
            <a href="https://www.w3.org/policies/patent-policy/"><abbr title="World Wide Web Consortium">W3C</abbr>
                专利政策</a>。
            <abbr title="World Wide Web Consortium">W3C</abbr> 维护一份<a rel="disclosure"
                href="https://www.w3.org/groups/wg/payments/ipr">与该小组交付物相关的任何专利披露的公开列表</a>；该页面还包含披露专利的说明。任何实际知道并认为包含<a
                href="https://www.w3.org/policies/patent-policy/#def-essential">必要权利要求（Essential
                Claim(s)）</a>的专利的个人，必须按照
            <a href="https://www.w3.org/policies/patent-policy/#sec-Disclosure">W3C 专利政策第6节</a>的规定披露该信息。
        </p>
        <p>
            本文档受<a id="w3c_process_revision" href="https://www.w3.org/policies/process/20250818/">2025年8月18日的 <abbr
                    title="World Wide Web Consortium">W3C</abbr> 流程文档</a>的约束。
        </p>
    </section>
    <nav id="toc">
        <h2 class="introductory" id="table-of-contents">目录</h2>
        <ol class="toc">
            <li class="tocline"><a class="tocxref" href="#abstract">摘要</a></li>
            <li class="tocline"><a class="tocxref" href="#sotd">本文档状态</a></li>
            <li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>
                    介绍
                </a></li>
            <li class="tocline"><a class="tocxref" href="#model"><bdi class="secno">2. </bdi>
                    概述
                </a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#handling-a-payment-request"><bdi class="secno">2.1
                            </bdi>
                            处理支付请求
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#relation-to-other-types-of-payment-apps"><bdi
                                class="secno">2.2 </bdi>
                            与其他类型支付应用的关系
                        </a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#registration"><bdi class="secno">3. </bdi>
                    注册
                </a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#just-in-time-registration"><bdi class="secno">3.1
                            </bdi>
                            及时注册
                        </a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#management"><bdi class="secno">4. </bdi>
                    管理
                </a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref"
                            href="#extension-to-the-serviceworkerregistration-interface"><bdi class="secno">4.1 </bdi>
                            对 <code>ServiceWorkerRegistration</code> 接口的扩展
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#paymentmanager-interface"><bdi class="secno">4.2
                            </bdi>
                            <span data-export="" data-dfn-type="interface" data-idl="interface"
                                data-title="PaymentManager" data-dfn-for=""><code>PaymentManager</code></span> 接口
                        </a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#userhint-attribute"><bdi class="secno">4.2.1
                                    </bdi>
                                    <span data-export="" data-dfn-type="attribute" data-idl="attribute"
                                        data-title="userHint" data-dfn-for="PaymentManager" data-type="DOMString"
                                        data-lt="userHint"
                                        data-local-lt="PaymentManager.userHint"><code>userHint</code></span> 属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#enabledelegations-method"><bdi
                                        class="secno">4.2.2 </bdi>
                                    <span data-export="" data-dfn-type="method" data-idl="operation"
                                        data-title="enableDelegations()" data-dfn-for="PaymentManager"
                                        data-type="Promise" data-lt="enableDelegations()|enableDelegations(delegations)"
                                        data-local-lt="PaymentManager.enableDelegations|PaymentManager.enableDelegations()|enableDelegations"><code>enableDelegations()</code></span>
                                    方法
                                </a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#paymentdelegation-enum"><bdi class="secno">4.3 </bdi>
                            <span data-export="" data-dfn-type="enum" data-idl="enum" data-title="PaymentDelegation"
                                data-dfn-for=""><code>PaymentDelegation</code></span> 枚举
                        </a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#canmakepayment"><bdi class="secno">5. </bdi>
                    可进行支付
                </a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#extension-to-serviceworkerglobalscope"><bdi
                                class="secno">5.1 </bdi>
                            对 <code>ServiceWorkerGlobalScope</code> 的扩展
                        </a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#oncanmakepayment-attribute"><bdi
                                        class="secno">5.1.1 </bdi>
                                    <span data-export="" data-dfn-type="attribute" data-idl="attribute"
                                        data-title="oncanmakepayment" data-dfn-for="ServiceWorkerGlobalScope"
                                        data-type="EventHandler" data-lt="oncanmakepayment"
                                        data-local-lt="ServiceWorkerGlobalScope.oncanmakepayment"><code>oncanmakepayment</code></span>
                                    属性
                                </a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#the-canmakepaymentevent"><bdi class="secno">5.2 </bdi>
                            <span data-export="" data-dfn-type="interface" data-idl="interface"
                                data-title="CanMakePaymentEvent" data-dfn-for=""><code>CanMakePaymentEvent</code></span>
                        </a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#respondwith-method"><bdi class="secno">5.2.1
                                    </bdi>
                                    <span data-export="" data-dfn-type="method" data-idl="operation"
                                        data-title="respondWith()" data-dfn-for="CanMakePaymentEvent"
                                        data-type="undefined"
                                        data-lt="respondWith()|respondWith(canMakePaymentResponse)"
                                        data-local-lt="CanMakePaymentEvent.respondWith|CanMakePaymentEvent.respondWith()|respondWith"><code>respondWith()</code></span>
                                    方法
                                </a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#handling-a-canmakepaymentevent"><bdi class="secno">5.3
                            </bdi>
                            处理 <code>CanMakePaymentEvent</code>
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#canmakepayment-example"><bdi class="secno">5.4 </bdi>
                            处理 <span class="formerLink" data-link-type="idl"><code>CanMakePaymentEvent</code></span> 的示例
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#filtering-of-payment-handlers"><bdi class="secno">5.5
                            </bdi>
                            支付处理程序的筛选
                        </a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#invocation"><bdi class="secno">6. </bdi>
                    调用
                </a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#extension-to-serviceworkerglobalscope-0"><bdi
                                class="secno">6.1 </bdi>
                            对 <span data-cite="SERVICE-WORKERS#serviceworkerglobalscope-interface" data-link-type="idl"
                                class="formerLink"><code>ServiceWorkerGlobalScope</code></span> 的扩展
                        </a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#onpaymentrequest-attribute"><bdi
                                        class="secno">6.1.1 </bdi>
                                    <span data-export="" data-dfn-type="attribute" data-idl="attribute"
                                        data-title="onpaymentrequest" data-dfn-for="ServiceWorkerGlobalScope"
                                        data-type="EventHandler" data-lt="onpaymentrequest"
                                        data-local-lt="ServiceWorkerGlobalScope.onpaymentrequest"><code>onpaymentrequest</code></span>
                                    属性
                                </a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#the-paymentrequestdetailsupdate"><bdi
                                class="secno">6.2 </bdi>
                            <span data-export="" data-dfn-type="dictionary" data-idl="dictionary"
                                data-title="PaymentRequestDetailsUpdate"
                                data-dfn-for=""><code>PaymentRequestDetailsUpdate</code></span>
                        </a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#error-member"><bdi class="secno">6.2.1 </bdi>
                                    <span data-export="" data-dfn-type="dict-member" data-idl="field" data-title="error"
                                        data-dfn-for="PaymentRequestDetailsUpdate"
                                        data-type="DOMString"><code>error</code></span> 成员
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#total-member"><bdi class="secno">6.2.2 </bdi>
                                    <span data-export="" data-dfn-type="dict-member" data-idl="field" data-title="total"
                                        data-dfn-for="PaymentRequestDetailsUpdate"
                                        data-type="PaymentCurrencyAmount"><code>total</code></span> 成员
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#modifiers-member"><bdi class="secno">6.2.3
                                    </bdi>
                                    <span data-export="" data-dfn-type="dict-member" data-idl="field"
                                        data-title="modifiers" data-dfn-for="PaymentRequestDetailsUpdate"
                                        data-type="sequence"><code>modifiers</code></span> 成员
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#shippingoptions-member"><bdi
                                        class="secno">6.2.4 </bdi>
                                    <span data-export="" data-dfn-type="dict-member" data-idl="field"
                                        data-title="shippingOptions" data-dfn-for="PaymentRequestDetailsUpdate"
                                        data-type="sequence"><code>shippingOptions</code></span> 成员
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#paymentmethoderrors-member"><bdi
                                        class="secno">6.2.5 </bdi>
                                    <span data-export="" data-dfn-type="dict-member" data-idl="field"
                                        data-title="paymentMethodErrors" data-dfn-for="PaymentRequestDetailsUpdate"
                                        data-type="object"><code>paymentMethodErrors</code></span> 成员
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#shippingaddresserrors-member"><bdi
                                        class="secno">6.2.6 </bdi>
                                    <span data-export="" data-dfn-type="dict-member" data-idl="field"
                                        data-title="shippingAddressErrors" data-dfn-for="PaymentRequestDetailsUpdate"
                                        data-type="AddressErrors"><code>shippingAddressErrors</code></span> 成员
                                </a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#the-paymentrequestevent"><bdi class="secno">6.3 </bdi>
                            <span data-export="" data-dfn-type="interface" data-idl="interface"
                                data-title="PaymentRequestEvent" data-dfn-for=""><code>PaymentRequestEvent</code></span>
                        </a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#toporigin-attribute"><bdi class="secno">6.3.1
                                    </bdi>
                                    <span data-export="" data-dfn-type="attribute" data-idl="attribute"
                                        data-title="topOrigin" data-dfn-for="PaymentRequestEvent" data-type="USVString"
                                        data-lt="topOrigin"
                                        data-local-lt="PaymentRequestEvent.topOrigin"><code>topOrigin</code></span>
                                    属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#paymentrequestorigin-attribute"><bdi
                                        class="secno">6.3.2 </bdi>
                                    <span data-export="" data-dfn-type="attribute" data-idl="attribute"
                                        data-title="paymentRequestOrigin" data-dfn-for="PaymentRequestEvent"
                                        data-type="USVString" data-lt="paymentRequestOrigin"
                                        data-local-lt="PaymentRequestEvent.paymentRequestOrigin"><code>paymentRequestOrigin</code></span>
                                    属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#paymentrequestid-attribute"><bdi
                                        class="secno">6.3.3 </bdi>
                                    <span data-export="" data-dfn-type="attribute" data-idl="attribute"
                                        data-title="paymentRequestId" data-dfn-for="PaymentRequestEvent"
                                        data-type="DOMString" data-lt="paymentRequestId"
                                        data-local-lt="PaymentRequestEvent.paymentRequestId"><code>paymentRequestId</code></span>
                                    属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#methoddata-attribute"><bdi class="secno">6.3.4
                                    </bdi>
                                    <span data-export="" data-dfn-type="attribute" data-idl="attribute"
                                        data-title="methodData" data-dfn-for="PaymentRequestEvent"
                                        data-type="FrozenArray" data-lt="methodData"
                                        data-local-lt="PaymentRequestEvent.methodData"><code>methodData</code></span>
                                    属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#total-attribute"><bdi class="secno">6.3.5
                                    </bdi>
                                    <span data-export="" data-dfn-type="attribute" data-idl="attribute"
                                        data-title="total" data-dfn-for="PaymentRequestEvent" data-type="object"
                                        data-lt="total"
                                        data-local-lt="PaymentRequestEvent.total"><code>total</code></span> 属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#modifiers-attribute"><bdi class="secno">6.3.6
                                    </bdi>
                                    <span data-export="" data-dfn-type="attribute" data-idl="attribute"
                                        data-title="modifiers" data-dfn-for="PaymentRequestEvent"
                                        data-type="FrozenArray" data-lt="modifiers"
                                        data-local-lt="PaymentRequestEvent.modifiers"><code>modifiers</code></span>
                                    属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#paymentoptions-attribute"><bdi
                                        class="secno">6.3.7 </bdi>
                                    <span data-export="" data-dfn-type="attribute" data-idl="attribute"
                                        data-title="paymentOptions" data-dfn-for="PaymentRequestEvent"
                                        data-type="object" data-lt="paymentOptions"
                                        data-local-lt="PaymentRequestEvent.paymentOptions"><code>paymentOptions</code></span>
                                    属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#shippingoptions-attribute"><bdi
                                        class="secno">6.3.8 </bdi>
                                    <span data-export="" data-dfn-type="attribute" data-idl="attribute"
                                        data-title="shippingOptions" data-dfn-for="PaymentRequestEvent"
                                        data-type="FrozenArray" data-lt="shippingOptions"
                                        data-local-lt="PaymentRequestEvent.shippingOptions"><code>shippingOptions</code></span>
                                    属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#openwindow-method"><bdi class="secno">6.3.9
                                    </bdi>
                                    <span data-export="" data-dfn-type="method" data-idl="operation"
                                        data-title="openWindow()" data-dfn-for="PaymentRequestEvent" data-type="Promise"
                                        data-lt="openWindow()|openWindow(url)"
                                        data-local-lt="PaymentRequestEvent.openWindow|PaymentRequestEvent.openWindow()|openWindow"><code>openWindow()</code></span>
                                    方法
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#changepaymentmethod-method"><bdi
                                        class="secno">6.3.10 </bdi>
                                    <span
                                        data-lt="changePaymentMethod(methodName, methodDetails)|changePaymentMethod()|changePaymentMethod(methodName)"
                                        data-export="" data-dfn-type="method" data-idl="operation"
                                        data-title="changePaymentMethod()" data-dfn-for="PaymentRequestEvent"
                                        data-type="Promise"
                                        data-local-lt="PaymentRequestEvent.changePaymentMethod|PaymentRequestEvent.changePaymentMethod()|changePaymentMethod"><code>changePaymentMethod()</code></span>
                                    方法
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#changeshippingaddress-method"><bdi
                                        class="secno">6.3.11 </bdi>
                                    <span data-lt="changeShippingAddress(shippingAddress)|changeShippingAddress()"
                                        data-export="" data-dfn-type="method" data-idl="operation"
                                        data-title="changeShippingAddress()" data-dfn-for="PaymentRequestEvent"
                                        data-type="Promise"
                                        data-local-lt="PaymentRequestEvent.changeShippingAddress|PaymentRequestEvent.changeShippingAddress()|changeShippingAddress"><code>changeShippingAddress()</code></span>
                                    方法
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#changeshippingoption-method"><bdi
                                        class="secno">6.3.12 </bdi>
                                    <span data-lt="changeShippingOption(shippingOption)|changeShippingOption()"
                                        data-export="" data-dfn-type="method" data-idl="operation"
                                        data-title="changeShippingOption()" data-dfn-for="PaymentRequestEvent"
                                        data-type="Promise"
                                        data-local-lt="PaymentRequestEvent.changeShippingOption|PaymentRequestEvent.changeShippingOption()|changeShippingOption"><code>changeShippingOption()</code></span>
                                    方法
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#respondwith-method-0"><bdi
                                        class="secno">6.3.13 </bdi>
                                    <span data-lt="respondWith(handlerResponsePromise)|respondWith()" data-export=""
                                        data-dfn-type="method" data-idl="operation" data-title="respondWith()"
                                        data-dfn-for="PaymentRequestEvent" data-type="undefined"
                                        data-local-lt="PaymentRequestEvent.respondWith|PaymentRequestEvent.respondWith()|respondWith"><code>respondWith()</code></span>
                                    方法
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#paymentrequesteventinit-dictionary"><bdi
                                        class="secno">6.3.14 </bdi>
                                    <span data-export="" data-dfn-type="dictionary" data-idl="dictionary"
                                        data-title="PaymentRequestEventInit"
                                        data-dfn-for=""><code>PaymentRequestEventInit</code></span> 字典
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#methoddata-population-algorithm"><bdi
                                        class="secno">6.3.15 </bdi>
                                    方法数据填充算法
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#modifiers-population-algorithm"><bdi
                                        class="secno">6.3.16 </bdi>
                                    修饰符填充算法
                                </a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#internal-slots"><bdi class="secno">6.4 </bdi>
                            内部槽
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#handling-a-paymentrequestevent"><bdi class="secno">6.5
                            </bdi>
                            处理 <code>PaymentRequestEvent</code>
                        </a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#windows"><bdi class="secno">7. </bdi>
                    <span data-lt="web-based payment handler window|Windows">窗口</span>
                </a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#open-window-algorithm"><bdi class="secno">7.1 </bdi>
                            打开窗口算法
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#post-example"><bdi class="secno">7.2 </bdi>
                            处理 <span data-xref-type="_IDL_" data-link-type="idl" data-lt="PaymentRequestEvent"
                                class="formerLink"><code>PaymentRequestEvent</code></span> 的示例
                        </a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#response"><bdi class="secno">8. </bdi>
                    响应
                </a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#paymenthandlerresponse-dictionary"><bdi
                                class="secno">8.1 </bdi>
                            <span data-export="" data-dfn-type="dictionary" data-idl="dictionary"
                                data-title="PaymentHandlerResponse"
                                data-dfn-for=""><code>PaymentHandlerResponse</code></span> 字典
                        </a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#methodname-attribute"><bdi class="secno">8.1.1
                                    </bdi>
                                    <span data-export="" data-dfn-type="dict-member" data-idl="field"
                                        data-title="methodName" data-dfn-for="PaymentHandlerResponse"
                                        data-type="DOMString"><code>methodName</code></span> 属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#details-attribute"><bdi class="secno">8.1.2
                                    </bdi>
                                    <span data-export="" data-dfn-type="dict-member" data-idl="field"
                                        data-title="details" data-dfn-for="PaymentHandlerResponse"
                                        data-type="object"><code>details</code></span> 属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#payername-attribute"><bdi class="secno">8.1.3
                                    </bdi>
                                    <span data-export="" data-dfn-type="dict-member" data-idl="field"
                                        data-title="payerName" data-dfn-for="PaymentHandlerResponse"
                                        data-type="DOMString"><code>payerName</code></span> 属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#payeremail-attribute"><bdi class="secno">8.1.4
                                    </bdi>
                                    <span data-export="" data-dfn-type="dict-member" data-idl="field"
                                        data-title="payerEmail" data-dfn-for="PaymentHandlerResponse"
                                        data-type="DOMString"><code>payerEmail</code></span> 属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#payerphone-attribute"><bdi class="secno">8.1.5
                                    </bdi>
                                    <span data-export="" data-dfn-type="dict-member" data-idl="field"
                                        data-title="payerPhone" data-dfn-for="PaymentHandlerResponse"
                                        data-type="DOMString"><code>payerPhone</code></span> 属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#shippingaddress-attribute"><bdi
                                        class="secno">8.1.6 </bdi>
                                    <span data-export="" data-dfn-type="dict-member" data-idl="field"
                                        data-title="shippingAddress" data-dfn-for="PaymentHandlerResponse"
                                        data-type="AddressInit"><code>shippingAddress</code></span> 属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#shippingoption-attribute"><bdi
                                        class="secno">8.1.7 </bdi>
                                    <span data-export="" data-dfn-type="dict-member" data-idl="field"
                                        data-title="shippingOption" data-dfn-for="PaymentHandlerResponse"
                                        data-type="DOMString"><code>shippingOption</code></span> 属性
                                </a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#change-payment-method-algorithm"><bdi
                                class="secno">8.2 </bdi>
                            变更支付方法算法
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#change-payment-details-algorithm"><bdi
                                class="secno">8.3 </bdi>
                            变更支付详情算法
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#respond-to-paymentrequest-algorithm"><bdi
                                class="secno">8.4 </bdi>
                            响应 PaymentRequest 算法
                        </a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#security"><bdi class="secno">9. </bdi>
                    安全与隐私注意事项
                </a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#addresses"><bdi class="secno">9.1 </bdi>地址</a>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#information-about-the-user-environment"><bdi
                                class="secno">9.2 </bdi>
                            有关用户环境的信息
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#user-consent-to-install"><bdi class="secno">9.3 </bdi>
                            用户同意安装支付处理程序
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#user-consent-before-payment"><bdi class="secno">9.4
                            </bdi>
                            付款前的用户同意
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#user-awareness-about-sharing-data-cross-origin"><bdi
                                class="secno">9.5 </bdi>
                            用户对跨源共享数据的认知
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#secure-communications"><bdi class="secno">9.6 </bdi>
                            安全通信
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#authorized-payment-apps"><bdi class="secno">9.7 </bdi>
                            授权的支付应用
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#supported-origin"><bdi class="secno">9.8 </bdi>
                            支持的来源
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#data-validation"><bdi class="secno">9.9 </bdi>
                            数据验证
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#private-browsing-mode"><bdi class="secno">9.10 </bdi>
                            私密浏览模式
                        </a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#display"><bdi class="secno">10. </bdi>
                    支付处理程序显示注意事项
                </a></li>
            <li class="tocline"><a class="tocxref" href="#dependencies"><bdi class="secno">11. </bdi>
                    依赖关系
                </a></li>
            <li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">12. </bdi>一致性</a></li>
            <li class="tocline"><a class="tocxref" href="#idl-index"><bdi class="secno">A. </bdi>IDL 索引</a></li>
            <li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">B. </bdi>参考文献</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">B.1
                            </bdi>规范性参考文献</a></li>
                    <li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">B.2
                            </bdi>参考资料</a></li>
                </ol>
            </li>
        </ol>
    </nav>
    <section class="informative" id="introduction">
        <div class="header-wrapper">
            <h2 id="x1-introduction"><bdi class="secno">1. </bdi>
                介绍
            </h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a>
        </div>
        <p><em>本节为非规范性内容。</em></p>

        <p>
            本规范定义了若干新特性，以便 Web 应用代表用户处理支付请求：
        </p>
        <ul>
            <li>基于源（origin）的权限机制，用于处理支付请求事件。
            </li>
            <li>支付请求事件类型（<a data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                    class="internalDFN" id="ref-for-dom-paymentrequestevent-1"><code>PaymentRequestEvent</code></a>）。一个
                <a href="#dfn-web-based-payment-handler" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-web-based-payment-handler-1">基于 Web 的支付处理程序</a>是
                <a data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                    class="internalDFN" id="ref-for-dom-paymentrequestevent-2"><code>PaymentRequestEvent</code></a>
                的事件处理器。
            </li>
            <li>对 <a href="#dfn-service-worker-registration" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-service-worker-registration-1">Service Worker 注册</a>接口的扩展
                （<a data-link-type="idl" data-lt="PaymentManager" href="#dom-paymentmanager" class="internalDFN"
                    id="ref-for-dom-paymentmanager-1"><code>PaymentManager</code></a>），用于管理基于 Web 的
                支付处理程序的属性。
            </li>
            <li>响应 <a data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                    class="internalDFN" id="ref-for-dom-paymentrequestevent-3"><code>PaymentRequestEvent</code></a>
                的机制。
            </li>
        </ul>
        <div class="note" role="note" id="issue-container-generatedID">
            <div role="heading" class="note-title marker" id="h-note" aria-level="3"><span>注意</span></div>
            <p class="">
                本规范不涉及使用操作系统特定机制（即“原生应用”）构建的软件如何处理支付请求。
            </p>
        </div>
    </section>
    <section id="model">
        <div class="header-wrapper">
            <h2 id="x2-overview"><bdi class="secno">2. </bdi>
                概述
            </h2><a class="self-link" href="#model" aria-label="Permalink for Section 2."></a>
        </div>

        <p>
            本文档设想了如下流程：
        </p>
        <ol>
            <li>某个源（origin）向用户请求权限，以处理一组支持的支付方式的支付请求。例如，用户访问零售或银行网站时，可能会被提示注册来自该源的基于 Web
                的支付处理程序。该源确定权限的作用域，但其能力可以扩展，而无需用户额外授权。
            </li>
            <li>
                <a href="#dfn-web-based-payment-handler" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-web-based-payment-handler-2">基于 Web 的支付处理程序</a>由 <a data-link-type="dfn"
                    href="https://www.w3.org/TR/service-workers/#service-worker-concept">Service Worker</a> 代码定义。
            </li>
            <li>当商家（或其他 <dfn id="dfn-payee" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">收款方</dfn>）调用
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-payment-request"
                        title="Payment Request API">payment-request</a></cite>] 方法 <a data-link-type="dfn"
                    href="https://www.w3.org/TR/payment-request/#canmakepayment-method">canMakePayment()</a> 或 <a
                    data-link-type="dfn" href="https://www.w3.org/TR/payment-request/#show-method">show()</a>
                （例如用户——即 <dfn id="dfn-payer" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">付款方</dfn>——在结账页面点击按钮时），用户代理会计算候选基于 Web
                的支付处理程序列表，将商家接受的支付方式与用户代理已知的支付方式进行比较，这些方式包括但不限于：
                <ul>
                    <li>之前通过该 API 注册的支付方式。</li>
                    <li>在交易过程中可能通过该 API 注册的支付方式，例如通过 <a data-link-type="dfn"
                            href="https://www.w3.org/TR/payment-method-manifest/#payment-method-manifest">支付方式清单</a>
                        确认的方式。</li>
                    <li>通过其他机制（如操作系统）注册的支付方式。</li>
                </ul>
            </li>
            <li>用户代理向用户展示一组选项：候选支付处理程序。用户代理通过注册时或 Web 应用所提供的信息（标签与图标）来展示这些选项。
            </li>
            <li>当 <a href="#dfn-payer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-payer-1">付款方</a>
                用户选择某个基于 Web 的支付处理程序时，用户代理会在该支付处理程序对应的 <a data-link-type="dfn"
                    href="https://www.w3.org/TR/service-workers/#service-worker-concept">Service Worker</a> 里触发 <a
                    data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                    class="internalDFN" id="ref-for-dom-paymentrequestevent-4"><code>PaymentRequestEvent</code></a>（参考
                <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source">用户交互任务源</a>）。<a
                    data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                    class="internalDFN" id="ref-for-dom-paymentrequestevent-5"><code>PaymentRequestEvent</code></a> 包含
                PaymentRequest
                （定义见 [<cite><a class="bibref" data-link-type="biblio" href="#bib-payment-request"
                        title="Payment Request API">payment-request</a></cite>]）中的部分信息以及其他信息（如收款方 origin）。
            </li>
            <li>激活后，基于 Web 的支付处理程序执行 <a href="#handling-a-payment-request">处理支付请求</a> 所需的各种步骤，并向
                <a href="#dfn-payee" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-payee-1">收款方</a>
                返回合适的支付响应。如需用户交互，<a href="#dfn-web-based-payment-handler" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-web-based-payment-handler-3">基于 Web 的支付处理程序</a> 可弹窗（window）实现此目的。
            </li>
            <li>基于 Web 的支付处理程序处理完请求后，用户代理会异步接收响应。该响应将成为 <a data-link-type="dfn"
                    href="https://www.w3.org/TR/payment-request/#dom-paymentresponse">PaymentResponse</a>（见 [<cite><a
                        class="bibref" data-link-type="biblio" href="#bib-payment-request"
                        title="Payment Request API">payment-request</a></cite>]）。
            </li>
        </ol>
        <div class="note" role="note" id="issue-container-generatedID-0">
            <div role="heading" class="note-title marker" id="h-note-0" aria-level="3"><span>注</span></div>
            <p class="">
                一个源（origin）可以用多个 Service Worker 实现支付应用。因此每个源可以注册多个 <a href="#dfn-web-based-payment-handler"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-web-based-payment-handler-4">基于 Web
                    的支付处理程序</a>。被调用的处理程序由用户选择决定。
            </p>
        </div>
        <section class="informative" id="handling-a-payment-request">
            <div class="header-wrapper">
                <h3 id="x2-1-handling-a-payment-request"><bdi class="secno">2.1 </bdi>
                    处理支付请求
                </h3><a class="self-link" href="#handling-a-payment-request" aria-label="Permalink for Section 2.1"></a>
            </div>
            <p><em>本节为非规范性内容。</em></p>

            <p>
                <dfn data-plurals="web-based payment handlers" id="dfn-web-based-payment-handler" tabindex="0"
                    aria-haspopup="dialog" data-dfn-type="dfn">基于 Web 的支付处理程序</dfn>
                是一种基于 Web 应用的
                <a data-link-type="dfn" href="https://www.w3.org/TR/payment-request/#dfn-payment-handler">支付处理程序</a>；
                即，能够代表用户处理支付请求的 Web 应用。
            </p>
            <p>
                基于 Web 的支付处理程序的逻辑由其支持的支付方式驱动。
                某些支付方式要求支付处理程序仅进行很少甚至无需处理，仅在响应中直接返回支付卡信息。
                此时，收款方网站负责使用返回的数据完成支付处理。
            </p>
            <p>
                相比之下，某些支付方式（如加密货币支付或银行发起的信用转账）要求基于 Web 的支付处理程序主动发起支付处理。
                在这种情形下，支付处理程序将返回一个支付凭证、端点 URL 或其他数据，收款方网站可据此判断支付结果（而不是直接处理支付本身）。
            </p>
            <p>
                处理支付请求过程可能涉及多种交互：可通过新窗口或其他 API（例如
                <cite><a data-matched-text="[[[WebCryptoAPI]]]" href="https://www.w3.org/TR/WebCryptoAPI/">Web
                        加密 API</a></cite>）与用户交互，或通过 Web 请求等方式与其他服务、其他源进行交互。
            </p>
            <p>
                本规范未涉及支付处理程序在接受
                <a data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                    class="internalDFN" id="ref-for-dom-paymentrequestevent-6"><code>PaymentRequestEvent</code></a>
                到返回响应之间发生的这些活动。
                配置支付处理程序及处理支付请求所需的所有操作，均由支付处理程序的实现决定，包括：
            </p>
            <ul>
                <li>用户如何与提供支付服务的源建立账户。
                </li>
                <li>源如何对用户进行身份验证。
                </li>
                <li>收款方服务器与收款方 Web 应用，或支付应用源与其它方之间如何通信。
                </li>
            </ul>
            <p>
                因此，一个源会依赖于其他 Web 技术（此规范未详细定义）来管理生命周期、安全、用户认证、用户交互等。
            </p>
        </section>
        <section class="informative" id="relation-to-other-types-of-payment-apps">
            <div class="header-wrapper">
                <h3 id="x2-2-relation-to-other-types-of-payment-apps"><bdi class="secno">2.2 </bdi>
                    与其他类型支付应用的关系
                </h3><a class="self-link" href="#relation-to-other-types-of-payment-apps"
                    aria-label="Permalink for Section 2.2"></a>
            </div>
            <p><em>本节为非规范性内容。</em></p>

            <p>
                本规范不涉及第三方移动支付应用如何通过专有机制与用户代理交互，也不涉及用户代理自身如何提供简单的支付应用功能。
            </p>
            <figure
                id="fig-web-based-payment-handler-api-enables-web-apps-to-handle-payments-other-types-of-payment-apps-may-use-other-proprietary-mechanisms">
                <img alt="Different types of payment apps. Web-based Payment Handler API is for Web apps."
                    src="https://www.w3.org/TR/payment-handler/app-types.png">
                <figcaption><a class="self-link"
                        href="#fig-web-based-payment-handler-api-enables-web-apps-to-handle-payments-other-types-of-payment-apps-may-use-other-proprietary-mechanisms">图
                        <bdi class="figno">1</bdi></a> <span class="fig-title">
                        基于 Web 的支付处理程序 API 使 Web 应用能够处理支付。
                        其他类型的支付应用可能使用其它（专有）机制。
                    </span></figcaption>
            </figure>
        </section>
    </section>

    <section id="registration">
        <div class="header-wrapper">
            <h2 id="x3-registration"><bdi class="secno">3. </bdi>
                注册
            </h2><a class="self-link" href="#registration" aria-label="Permalink for Section 3."></a>
        </div>

        <p>
            通过即时（JIT）注册机制，可以在用户代理中注册基于 Web 的支付处理程序。
        </p>
        <section id="just-in-time-registration">
            <div class="header-wrapper">
                <h3 id="x3-1-just-in-time-registration"><bdi class="secno">3.1 </bdi>
                    及时注册
                </h3><a class="self-link" href="#just-in-time-registration" aria-label="Permalink for Section 3.1"></a>
            </div>

            <p>
                如果在商家调用 <a data-link-type="idl" data-lt="show()"
                    href="https://www.w3.org/TR/payment-request/#show-method"><code>show</code></a><code>()</code>
                方法时，基于 Web 的支付处理程序尚未注册，用户代理可以在交易过程中允许用户注册此基于 Web 的支付处理程序（“即时”）。
            </p>
            <p><em>本节其余内容为非规范性内容。</em></p>
            <p>
                用户代理可以通过从商家请求的 <a data-link-type="dfn"
                    href="https://www.w3.org/TR/payment-method-manifest/#payment-method-manifest">支付方式清单</a>
                中，通过 <a data-link-type="dfn"
                    href="https://www.w3.org/TR/payment-method-id/#dfn-url-based-payment-method-identifier">基于 URL
                    的支付方式标识符</a>
                获取，推导出基于 Web 的支付处理程序信息，从而实现即时安装。
            </p>
        </section>
    </section>
    <section id="management">
        <div class="header-wrapper">
            <h2 id="x4-management"><bdi class="secno">4. </bdi>
                管理
            </h2><a class="self-link" href="#management" aria-label="Permalink for Section 4."></a>
        </div>

        <p>
            本节描述了基于 Web 的支付处理程序可用于管理自身属性的功能。
        </p>
        <section data-dfn-for="ServiceWorkerRegistration" id="extension-to-the-serviceworkerregistration-interface">
            <div class="header-wrapper">
                <h3 id="x4-1-extension-to-the-serviceworkerregistration-interface"><bdi class="secno">4.1 </bdi>
                    对 <code>ServiceWorkerRegistration</code> 接口的扩展
                </h3><a class="self-link" href="#extension-to-the-serviceworkerregistration-interface"
                    aria-label="Permalink for Section 4.1"></a>
            </div>

            <pre class="idl def" id="webidl-1742672635"><span class="idlHeader"><a class="self-link" href="#webidl-1742672635">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-serviceworkerregistration-partial-1" data-title="ServiceWorkerRegistration">partial interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-serviceworkerregistration"><code>ServiceWorkerRegistration</code></a> {<span data-idl="" class="idlAttribute" id="idl-def-serviceworkerregistration-paymentmanager" data-title="paymentManager" data-dfn-for="ServiceWorkerRegistration">
  [<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject">SameObject</a></span>] readonly attribute<span class="idlType"> <a data-link-type="idl" href="#dom-paymentmanager" class="internalDFN" id="ref-for-dom-paymentmanager-2"><code>PaymentManager</code></a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-serviceworkerregistration-paymentmanager" id="ref-for-dom-serviceworkerregistration-paymentmanager-1"><code>paymentManager</code></a>;</span>
};</span></code></pre>
            <p>
                <dfn data-export="" data-dfn-type="attribute" id="dom-serviceworkerregistration-paymentmanager"
                    data-idl="attribute" data-title="paymentManager" data-dfn-for="ServiceWorkerRegistration"
                    data-type="PaymentManager" data-lt="paymentManager"
                    data-local-lt="ServiceWorkerRegistration.paymentManager" tabindex="0"
                    aria-haspopup="dialog"><code>paymentManager</code></dfn> 属性用于暴露基于 Web 的支付处理程序的管理功能。
            </p>
        </section>
        <section data-dfn-for="PaymentManager" id="paymentmanager-interface">
            <div class="header-wrapper">
                <h3 id="x4-2-paymentmanager-interface"><bdi class="secno">4.2 </bdi>
                    <dfn data-export="" data-dfn-type="interface" id="dom-paymentmanager" data-idl="interface"
                        data-title="PaymentManager" data-dfn-for="" tabindex="0"
                        aria-haspopup="dialog"><code>PaymentManager</code></dfn> 接口
                </h3><a class="self-link" href="#paymentmanager-interface" aria-label="Permalink for Section 4.2"></a>
            </div>

            <pre class="idl def" id="webidl-1708874582"><span class="idlHeader"><a class="self-link" href="#webidl-1708874582">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-paymentmanager" data-title="PaymentManager">[<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=(Window)</span>]
interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-paymentmanager" id="ref-for-dom-paymentmanager-3"><code>PaymentManager</code></a> {<span data-idl="" class="idlAttribute" id="idl-def-paymentmanager-userhint" data-title="userHint" data-dfn-for="PaymentManager">
  attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentmanager-userhint" id="ref-for-dom-paymentmanager-userhint-1"><code>userHint</code></a>;</span><span data-idl="" class="idlMethod" id="idl-def-paymentmanager-enabledelegations-delegations" data-title="enableDelegations" data-dfn-for="PaymentManager"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-paymentmanager-enabledelegations" id="ref-for-dom-paymentmanager-enabledelegations-1"><code>enableDelegations</code></a>(<span class="idlType"><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="#dom-paymentdelegation" class="internalDFN" id="ref-for-dom-paymentdelegation-1"><code>PaymentDelegation</code></a>&gt;</span> <span class="idlParamName">delegations</span>);</span>
};</span></code></pre>
            <p>
                <a data-link-type="idl" data-lt="PaymentManager" href="#dom-paymentmanager" class="internalDFN"
                    id="ref-for-dom-paymentmanager-4"><code>PaymentManager</code></a> 用于
                <a href="#dfn-web-based-payment-handler" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-web-based-payment-handler-5">基于 Web 的支付处理程序</a>
                管理其所支持的委托功能。
            </p>
            <section id="userhint-attribute">
                <div class="header-wrapper">
                    <h4 id="x4-2-1-userhint-attribute"><bdi class="secno">4.2.1 </bdi>
                        <dfn data-export="" data-dfn-type="attribute" id="dom-paymentmanager-userhint"
                            data-idl="attribute" data-title="userHint" data-dfn-for="PaymentManager"
                            data-type="DOMString" data-lt="userHint" data-local-lt="PaymentManager.userHint"
                            tabindex="0" aria-haspopup="dialog"><code>userHint</code></dfn> 属性
                    </h4><a class="self-link" href="#userhint-attribute" aria-label="Permalink for Section 4.2.1"></a>
                </div>

                <p>
                    在显示基于 Web 的支付处理程序名称和图标时，
                    用户代理可以使用该字符串以提升用户体验。
                    例如，"**** 1234" 这样的用户提示
                    可以提醒用户该基于 Web 的支付处理程序
                    可用于某张特定的卡片。
                </p>
            </section>
            <section id="enabledelegations-method">
                <div class="header-wrapper">
                    <h4 id="x4-2-2-enabledelegations-method"><bdi class="secno">4.2.2 </bdi>
                        <dfn data-export="" data-dfn-type="method" id="dom-paymentmanager-enabledelegations"
                            data-idl="operation" data-title="enableDelegations()" data-dfn-for="PaymentManager"
                            data-type="Promise" data-lt="enableDelegations()|enableDelegations(delegations)"
                            data-local-lt="PaymentManager.enableDelegations|PaymentManager.enableDelegations()|enableDelegations"
                            tabindex="0" aria-haspopup="dialog"><code>enableDelegations()</code></dfn> 方法
                    </h4><a class="self-link" href="#enabledelegations-method"
                        aria-label="Permalink for Section 4.2.2"></a>
                </div>

                <p>
                    此方法允许
                    <a href="#dfn-web-based-payment-handler" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-web-based-payment-handler-6">基于 Web 的支付处理程序</a>
                    异步声明其所支持的
                    <a href="#dom-paymentdelegation" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-paymentdelegation-2"><code>PaymentDelegation</code></a>
                    列表。
                </p>
            </section>
        </section>
        <section data-dfn-for="PaymentDelegation" id="paymentdelegation-enum">
            <div class="header-wrapper">
                <h3 id="x4-3-paymentdelegation-enum"><bdi class="secno">4.3 </bdi>
                    <dfn data-export="" data-dfn-type="enum" id="dom-paymentdelegation" data-idl="enum"
                        data-title="PaymentDelegation" data-dfn-for="" tabindex="0"
                        aria-haspopup="dialog"><code>PaymentDelegation</code></dfn> 枚举
                </h3><a class="self-link" href="#paymentdelegation-enum" aria-label="Permalink for Section 4.3"></a>
            </div>

            <pre class="idl def" id="webidl-1015767474"><span class="idlHeader"><a class="self-link" href="#webidl-1015767474">WebIDL</a></span><code><span data-idl="" class="idlEnum" id="idl-def-paymentdelegation" data-title="PaymentDelegation">enum <a class="internalDFN idlID" data-link-type="enum" href="#dom-paymentdelegation" id="ref-for-dom-paymentdelegation-3"><code>PaymentDelegation</code></a> {
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-paymentdelegation-shippingaddress" id="ref-for-dom-paymentdelegation-shippingaddress-1"><code>shippingAddress</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-paymentdelegation-payername" id="ref-for-dom-paymentdelegation-payername-1"><code>payerName</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-paymentdelegation-payerphone" id="ref-for-dom-paymentdelegation-payerphone-1"><code>payerPhone</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-paymentdelegation-payeremail" id="ref-for-dom-paymentdelegation-payeremail-1"><code>payerEmail</code></a>"</span>
};</span></code></pre>
            <dl>
                <dt>
                    "<dfn data-export="" data-dfn-type="enum-value" id="dom-paymentdelegation-shippingaddress"
                        data-idl="enum-value" data-title="shippingAddress" data-dfn-for="PaymentDelegation" tabindex="0"
                        aria-haspopup="dialog"><code>shippingAddress</code></dfn>"
                </dt>
                <dd>
                    基于 Web 的支付处理程序会在需要时提供收货地址。
                </dd>
                <dt>
                    "<dfn data-export="" data-dfn-type="enum-value" id="dom-paymentdelegation-payername"
                        data-idl="enum-value" data-title="payerName" data-dfn-for="PaymentDelegation" tabindex="0"
                        aria-haspopup="dialog"><code>payerName</code></dfn>"
                </dt>
                <dd>
                    基于 Web 的支付处理程序会在需要时提供付款人姓名。
                </dd>
                <dt>
                    "<dfn data-export="" data-dfn-type="enum-value" id="dom-paymentdelegation-payerphone"
                        data-idl="enum-value" data-title="payerPhone" data-dfn-for="PaymentDelegation" tabindex="0"
                        aria-haspopup="dialog"><code>payerPhone</code></dfn>"
                </dt>
                <dd>
                    基于 Web 的支付处理程序会在需要时提供付款人电话。
                </dd>
                <dt>
                    "<dfn data-export="" data-dfn-type="enum-value" id="dom-paymentdelegation-payeremail"
                        data-idl="enum-value" data-title="payerEmail" data-dfn-for="PaymentDelegation" tabindex="0"
                        aria-haspopup="dialog"><code>payerEmail</code></dfn>"
                </dt>
                <dd>
                    基于 Web 的支付处理程序会在需要时提供付款人邮箱。
                </dd>
            </dl>
        </section>
    </section>
    <section id="canmakepayment">
        <div class="header-wrapper">
            <h2 id="x5-can-make-payment"><bdi class="secno">5. </bdi>
                可进行支付
            </h2><a class="self-link" href="#canmakepayment" aria-label="Permalink for Section 5."></a>
        </div>

        <p>
            如果 <a href="#dfn-web-based-payment-handler" class="internalDFN" data-link-type="dfn"
                id="ref-for-dfn-web-based-payment-handler-7">基于 Web 的支付处理程序</a>支持
            <a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                id="ref-for-dom-canmakepaymentevent-1"><code>CanMakePaymentEvent</code></a>，
            <a href="#dfn-user-agents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agents-1">用户代理</a>
            可使用它协助筛选可用的基于 Web 的支付处理程序。
        </p>
        <p>
            实现可以对开发者响应
            <a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                id="ref-for-dom-canmakepaymentevent-2"><code>CanMakePaymentEvent</code></a>施加超时时间。如果超时到期，
            则实现的行为等同于调用了 <a data-link-type="idl" data-lt="respondWith()" href="#dom-canmakepaymentevent-respondwith"
                class="internalDFN"
                id="ref-for-dom-canmakepaymentevent-respondwith-1"><code>respondWith</code></a><code>()</code> 且参数为
            <code>false</code>。
        </p>
        <section data-dfn-for="ServiceWorkerGlobalScope" id="extension-to-serviceworkerglobalscope">
            <div class="header-wrapper">
                <h3 id="x5-1-extension-to-serviceworkerglobalscope"><bdi class="secno">5.1 </bdi>
                    对 <code>ServiceWorkerGlobalScope</code> 的扩展
                </h3><a class="self-link" href="#extension-to-serviceworkerglobalscope"
                    aria-label="Permalink for Section 5.1"></a>
            </div>

            <pre class="idl def" id="webidl-1445944587"><span class="idlHeader"><a class="self-link" href="#webidl-1445944587">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-serviceworkerglobalscope-partial-1" data-title="ServiceWorkerGlobalScope">partial interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-serviceworkerglobalscope"><code>ServiceWorkerGlobalScope</code></a> {<span data-idl="" class="idlAttribute" id="idl-def-serviceworkerglobalscope-oncanmakepayment" data-title="oncanmakepayment" data-dfn-for="ServiceWorkerGlobalScope">
  attribute<span class="idlType"> <a data-link-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-serviceworkerglobalscope-oncanmakepayment" id="ref-for-dom-serviceworkerglobalscope-oncanmakepayment-1"><code>oncanmakepayment</code></a>;</span>
};</span></code></pre>
            <section id="oncanmakepayment-attribute">
                <div class="header-wrapper">
                    <h4 id="x5-1-1-oncanmakepayment-attribute"><bdi class="secno">5.1.1 </bdi>
                        <dfn data-export="" data-dfn-type="attribute" id="dom-serviceworkerglobalscope-oncanmakepayment"
                            data-idl="attribute" data-title="oncanmakepayment" data-dfn-for="ServiceWorkerGlobalScope"
                            data-type="EventHandler" data-lt="oncanmakepayment"
                            data-local-lt="ServiceWorkerGlobalScope.oncanmakepayment" tabindex="0"
                            aria-haspopup="dialog"><code>oncanmakepayment</code></dfn> 属性
                    </h4><a class="self-link" href="#oncanmakepayment-attribute"
                        aria-label="Permalink for Section 5.1.1"></a>
                </div>

                <p>
                    <a data-link-type="idl" href="#dom-serviceworkerglobalscope-oncanmakepayment" class="internalDFN"
                        id="ref-for-dom-serviceworkerglobalscope-oncanmakepayment-2"><code>oncanmakepayment</code></a>
                    属性是一个
                    <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers">事件处理程序</a>，
                    其对应的<a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type">事件处理程序事件类型</a>为
                    "canmakepayment"。
                </p>
            </section>
        </section>
        <section data-dfn-for="CanMakePaymentEvent" id="the-canmakepaymentevent">
            <div class="header-wrapper">
                <h3 id="x5-2-the-canmakepaymentevent"><bdi class="secno">5.2 </bdi>
                    <dfn data-export="" data-dfn-type="interface" id="dom-canmakepaymentevent" data-idl="interface"
                        data-title="CanMakePaymentEvent" data-dfn-for="" tabindex="0"
                        aria-haspopup="dialog"><code>CanMakePaymentEvent</code></dfn>
                </h3><a class="self-link" href="#the-canmakepaymentevent" aria-label="Permalink for Section 5.2"></a>
            </div>

            <p>
                <a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                    id="ref-for-dom-canmakepaymentevent-3"><code>CanMakePaymentEvent</code></a>
                用作一个信号，指示基于 Web 的支付处理程序是否能够响应支付请求。
            </p>
            <pre class="idl def" id="webidl-238602632"><span class="idlHeader"><a class="self-link" href="#webidl-238602632">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-canmakepaymentevent" data-title="CanMakePaymentEvent">[<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=ServiceWorker</span>]
interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-canmakepaymentevent" id="ref-for-dom-canmakepaymentevent-4"><code>CanMakePaymentEvent</code></a> : <span class="idlSuperclass"><a data-link-type="idl" href="https://www.w3.org/TR/service-workers/#extendableevent-interface">ExtendableEvent</a></span> {<span data-idl="" class="idlConstructor" id="idl-def-canmakepaymentevent-constructor-type" data-title="constructor" data-dfn-for="CanMakePaymentEvent">
  <dfn data-export="" data-dfn-type="constructor" id="dom-canmakepaymentevent-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="CanMakePaymentEvent" data-lt="constructor()|constructor(type)" data-local-lt="CanMakePaymentEvent.constructor|CanMakePaymentEvent.constructor()|constructor" tabindex="0" aria-haspopup="dialog"><code>constructor</code></dfn>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">type</span>);</span><span data-idl="" class="idlMethod" id="idl-def-canmakepaymentevent-respondwith-canmakepaymentresponse" data-title="respondWith" data-dfn-for="CanMakePaymentEvent"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-canmakepaymentevent-respondwith" id="ref-for-dom-canmakepaymentevent-respondwith-2"><code>respondWith</code></a>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a>&gt;</span> <span class="idlParamName">canMakePaymentResponse</span>);</span>
};</span></code></pre>
            <section id="respondwith-method">
                <div class="header-wrapper">
                    <h4 id="x5-2-1-respondwith-method"><bdi class="secno">5.2.1 </bdi>
                        <dfn data-export="" data-dfn-type="method" id="dom-canmakepaymentevent-respondwith"
                            data-idl="operation" data-title="respondWith()" data-dfn-for="CanMakePaymentEvent"
                            data-type="undefined" data-lt="respondWith()|respondWith(canMakePaymentResponse)"
                            data-local-lt="CanMakePaymentEvent.respondWith|CanMakePaymentEvent.respondWith()|respondWith"
                            tabindex="0" aria-haspopup="dialog"><code>respondWith()</code></dfn> 方法
                    </h4><a class="self-link" href="#respondwith-method" aria-label="Permalink for Section 5.2.1"></a>
                </div>

                <p>
                    此方法由基于 Web 的支付处理程序用作一个信号，
                    指示其是否能够响应支付请求。
                </p>
            </section>
        </section>
        <section id="handling-a-canmakepaymentevent">
            <div class="header-wrapper">
                <h3 id="x5-3-handling-a-canmakepaymentevent"><bdi class="secno">5.3 </bdi>
                    <dfn id="dfn-handling-a-canmakepaymentevent" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">处理 CanMakePaymentEvent</dfn>
                </h3><a class="self-link" href="#handling-a-canmakepaymentevent"
                    aria-label="Permalink for Section 5.3"></a>
            </div>

            <p>
                通过 <a data-link-type="dfn"
                    href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a> 收到请求后，<a
                    href="#dfn-user-agents" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-user-agents-2">用户代理</a><em class="rfc2119">必须（MUST）</em>
                运行以下步骤：
            </p>
            <ol>
                <li>如果 <a href="#dfn-user-agents" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-user-agents-3">用户代理</a> 的设置禁止使用
                    <a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-canmakepaymentevent-5"><code>CanMakePaymentEvent</code></a>（例如在私密浏览模式下），
                    则终止这些步骤。
                </li>
                <li>令 <var>registration</var> 为一个 <a data-link-type="idl" data-lt="ServiceWorkerRegistration"
                        href="https://www.w3.org/TR/service-workers/#service-worker-registration-concept"><code>ServiceWorkerRegistration</code></a>。
                </li>
                <li>如果未找到 <var>registration</var>，则终止这些步骤。
                </li>
                <li>
                    <p>
                        使用 <a data-link-type="dfn"
                            href="https://www.w3.org/TR/service-workers/#fire-functional-event-algorithm">触发功能事件</a>
                        "<code>canmakepayment</code>"，并在 <var>registration</var> 上使用
                        <a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                            id="ref-for-dom-canmakepaymentevent-6"><code>CanMakePaymentEvent</code></a>。
                    </p>
                </li>
            </ol>
        </section>
        <section id="canmakepayment-example" class="informative">
            <div class="header-wrapper">
                <h3 id="x5-4-example-of-handling-the-canmakepaymentevent"><bdi class="secno">5.4 </bdi>
                    处理 <a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-canmakepaymentevent-7"><code>CanMakePaymentEvent</code></a> 的示例
                </h3><a class="self-link" href="#canmakepayment-example" aria-label="Permalink for Section 5.4"></a>
            </div>
            <p><em>本节为非规范性内容。</em></p>

            <p>
                此示例展示如何编写一个监听
                <a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                    id="ref-for-dom-canmakepaymentevent-8"><code>CanMakePaymentEvent</code></a> 的 service worker。当收到
                <a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                    id="ref-for-dom-canmakepaymentevent-9"><code>CanMakePaymentEvent</code></a> 时，service worker 始终返回
                true。
            </p>
            <div class="example" id="example-handling-the-canmakepaymentevent">
                <div class="marker">
                    <a class="self-link" href="#example-handling-the-canmakepaymentevent">示例<bdi> 1</bdi></a><span
                        class="example-title">：处理 CanMakePaymentEvent</span>
                </div>
                <pre aria-busy="false"><code class="hljs js">self.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"canmakepayment"</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {
  e.<span class="hljs-title function_">respondWith</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-literal">true</span>);
  }));
});</code></pre>
            </div>
        </section>
        <section id="filtering-of-payment-handlers">
            <div class="header-wrapper">
                <h3 id="x5-5-filtering-of-payment-handlers"><bdi class="secno">5.5 </bdi>
                    支付处理程序的筛选
                </h3><a class="self-link" href="#filtering-of-payment-handlers"
                    aria-label="Permalink for Section 5.5"></a>
            </div>

            <p>
                给定一个 <a data-link-type="dfn"
                    href="https://www.w3.org/TR/payment-request/#paymentmethoddata-dictionary">PaymentMethodData</a> 和
                一个在 <a data-link-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">支付方式标识符</a>
                上匹配的基于 Web 的支付处理程序，如果该支付处理程序可用于支付，则此算法返回 <code>true</code>：
            </p>
            <ol class="algorithm">
                <li>令 <var>methodName</var> 为 <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">支付方式标识符</a>
                    字符串，由 <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#paymentmethoddata-dictionary">PaymentMethodData</a>
                    中指定。
                </li>
                <li>令 <var>methodData</var> 为
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#paymentmethoddata-dictionary">PaymentMethodData</a>
                    的支付方式专有数据。
                </li>
                <li>令 <var>paymentHandlerOrigin</var> 为该基于 Web 的支付处理程序的
                    <a data-link-type="idl" data-lt="ServiceWorkerRegistration"
                        href="https://www.w3.org/TR/service-workers/#service-worker-registration-concept"><code>ServiceWorkerRegistration</code></a>
                    作用域 URL 的 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">源</a>。
                </li>
                <li>令 <var>paymentMethodManifest</var> 为 <var>methodName</var> 的
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-method-manifest/#ingest-payment-method-manifests">已获取</a>
                    并
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-method-manifest/#parsed-payment-method-manifest">已解析</a>
                    的
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-method-manifest/#payment-method-manifest">支付方式清单</a>。
                </li>
                <li>如果 <var>methodName</var> 是一个
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-method-id/#dfn-url-based-payment-method-identifier">基于 URL
                        的支付方式标识符</a>，
                    且 <var>paymentMethodManifest</var> 中 <code>"*"</code> 字符串已被
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-method-manifest/#parsed-payment-method-manifest-supported-origins">support
                        origins</a>
                    支持，则返回 <code>true</code>。
                </li>
                <li>否则，如果 <var>methodName</var> 这个
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-method-id/#dfn-url-based-payment-method-identifier">基于 URL
                        的支付方式标识符</a>
                    与 <var>paymentHandlerOrigin</var> 有相同的 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">源</a>，
                    则在该基于 Web 的支付处理程序中触发 <a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-canmakepaymentevent-10"><code>CanMakePaymentEvent</code></a> 并返回其结果。
                </li>
                <li>否则，如果 <var>paymentMethodManifest</var> 的
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-method-manifest/#parsed-payment-method-manifest-supported-origins">支持源</a>
                    是一个有序 <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin">源(origin)</a>
                    集合，并包含 <var>paymentHandlerOrigin</var>，
                    则在该基于 Web 的支付处理程序中触发
                    <a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-canmakepaymentevent-11"><code>CanMakePaymentEvent</code></a> 并返回其结果。
                </li>
                <li>否则，返回 <code>false</code>。
                </li>
            </ol>
        </section>
    </section>
    <section id="invocation">
        <div class="header-wrapper">
            <h2 id="x6-invocation"><bdi class="secno">6. </bdi>
                调用
            </h2><a class="self-link" href="#invocation" aria-label="Permalink for Section 6."></a>
        </div>

        <p>
            用户选择某个基于 Web 的支付处理程序后，
            用户代理会触发 <a data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                class="internalDFN" id="ref-for-dom-paymentrequestevent-7"><code>PaymentRequestEvent</code></a>，
            并使用随后得到的
            <a href="#dom-paymenthandlerresponse" class="internalDFN" data-link-type="idl"
                id="ref-for-dom-paymenthandlerresponse-1"><code>PaymentHandlerResponse</code></a>
            为 [<cite><a class="bibref" data-link-type="biblio" href="#bib-payment-request"
                    title="Payment Request API">payment-request</a></cite>] 创建
            <a data-link-type="dfn"
                href="https://www.w3.org/TR/payment-request/#dom-paymentresponse">PaymentResponse</a>。
        </p>
        <div class="issue" id="issue-container-number-117">
            <div role="heading" class="issue-title marker" id="h-issue" aria-level="3"><a
                    href="https://github.com/w3c/web-based-payment-handler/issues/117"><span class="issue-number">Issue
                        117</span></a><span class="issue-label">：支持将 Abort() 委托给支付处理程序</span></div>
            <p class="">
                Payment Request API 支持将终止操作的管理责任委托给支付应用。
                目前有一个提案，计划在 Web-based Payment Handler 接口中
                增加一个 paymentRequestAborted 事件。
                该事件将拥有一个 respondWith 方法，接受一个布尔参数，
                用于指示 paymentRequest 是否已被成功中止。
            </p>
        </div>
        <section data-dfn-for="ServiceWorkerGlobalScope" data-link-for="ServiceWorkerGlobalScope"
            id="extension-to-serviceworkerglobalscope-0">
            <div class="header-wrapper">
                <h3 id="x6-1-extension-to-serviceworkerglobalscope"><bdi class="secno">6.1 </bdi>
                    对 <a data-link-type="idl"
                        href="https://www.w3.org/TR/service-workers/#serviceworkerglobalscope-interface"><code>ServiceWorkerGlobalScope</code></a>
                    的扩展
                </h3><a class="self-link" href="#extension-to-serviceworkerglobalscope-0"
                    aria-label="Permalink for Section 6.1"></a>
            </div>

            <p>
                本规范扩展了 <a data-link-type="idl"
                    href="https://www.w3.org/TR/service-workers/#serviceworkerglobalscope-interface"><code>ServiceWorkerGlobalScope</code></a>
                接口。
            </p>
            <pre class="idl def" id="webidl-1119623754"><span class="idlHeader"><a class="self-link" href="#webidl-1119623754">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-serviceworkerglobalscope-partial-2" data-title="ServiceWorkerGlobalScope">partial interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-serviceworkerglobalscope"><code>ServiceWorkerGlobalScope</code></a> {<span data-idl="" class="idlAttribute" id="idl-def-serviceworkerglobalscope-onpaymentrequest" data-title="onpaymentrequest" data-dfn-for="ServiceWorkerGlobalScope">
  attribute<span class="idlType"> <a data-link-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-serviceworkerglobalscope-onpaymentrequest" id="ref-for-dom-serviceworkerglobalscope-onpaymentrequest-1"><code>onpaymentrequest</code></a>;</span>
};</span></code></pre>
            <section id="onpaymentrequest-attribute">
                <div class="header-wrapper">
                    <h4 id="x6-1-1-onpaymentrequest-attribute"><bdi class="secno">6.1.1 </bdi>
                        <dfn data-export="" data-dfn-type="attribute" id="dom-serviceworkerglobalscope-onpaymentrequest"
                            data-idl="attribute" data-title="onpaymentrequest" data-dfn-for="ServiceWorkerGlobalScope"
                            data-type="EventHandler" data-lt="onpaymentrequest"
                            data-local-lt="ServiceWorkerGlobalScope.onpaymentrequest" tabindex="0"
                            aria-haspopup="dialog"><code>onpaymentrequest</code></dfn> 属性
                    </h4><a class="self-link" href="#onpaymentrequest-attribute"
                        aria-label="Permalink for Section 6.1.1"></a>
                </div>

                <p>
                    <a href="#dom-serviceworkerglobalscope-onpaymentrequest" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-serviceworkerglobalscope-onpaymentrequest-2"><code>onpaymentrequest</code></a>
                    属性是一个 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers">事件处理程序</a>，
                    其对应的<a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type">事件处理程序事件类型</a>为
                    <a data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                        class="internalDFN" id="ref-for-dom-paymentrequestevent-8"><code>PaymentRequestEvent</code></a>。
                </p>
            </section>
        </section>
        <section data-dfn-for="PaymentRequestDetailsUpdate" data-link-for="PaymentRequestDetailsUpdate"
            id="the-paymentrequestdetailsupdate">
            <div class="header-wrapper">
                <h3 id="x6-2-the-paymentrequestdetailsupdate"><bdi class="secno">6.2 </bdi>
                    <dfn data-export="" data-dfn-type="dictionary" id="dom-paymentrequestdetailsupdate"
                        data-idl="dictionary" data-title="PaymentRequestDetailsUpdate" data-dfn-for="" tabindex="0"
                        aria-haspopup="dialog"><code>PaymentRequestDetailsUpdate</code></dfn> 字典
                </h3><a class="self-link" href="#the-paymentrequestdetailsupdate"
                    aria-label="Permalink for Section 6.2"></a>
            </div>

            <p>
                <code>PaymentRequestDetailsUpdate</code> 包含更新后的总金额（可选包括修饰符和配送选项）以及由于用户在基于 Web
                的支付处理程序中选择支付方式、收货地址或配送选项可能导致的错误信息。
            </p>
            <pre class="idl def" id="webidl-2024425618"><span class="idlHeader"><a class="self-link" href="#webidl-2024425618">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-paymentrequestdetailsupdate" data-title="PaymentRequestDetailsUpdate">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dom-paymentrequestdetailsupdate" id="ref-for-dom-paymentrequestdetailsupdate-1"><code>PaymentRequestDetailsUpdate</code></a> {<span data-idl="" class="idlMember" id="idl-def-paymentrequestdetailsupdate-error" data-title="error" data-dfn-for="PaymentRequestDetailsUpdate"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequestdetailsupdate-error" id="ref-for-dom-paymentrequestdetailsupdate-error-1"><code>error</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymentrequestdetailsupdate-total" data-title="total" data-dfn-for="PaymentRequestDetailsUpdate"><span class="idlType">
  <a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#paymentcurrencyamount-dictionary">PaymentCurrencyAmount</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequestdetailsupdate-total" id="ref-for-dom-paymentrequestdetailsupdate-total-1"><code>total</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymentrequestdetailsupdate-modifiers" data-title="modifiers" data-dfn-for="PaymentRequestDetailsUpdate"><span class="idlType">
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#paymentdetailsmodifier-dictionary">PaymentDetailsModifier</a>&gt;</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequestdetailsupdate-modifiers" id="ref-for-dom-paymentrequestdetailsupdate-modifiers-1"><code>modifiers</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymentrequestdetailsupdate-shippingoptions" data-title="shippingOptions" data-dfn-for="PaymentRequestDetailsUpdate"><span class="idlType">
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#dom-paymentshippingoption">PaymentShippingOption</a>&gt;</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequestdetailsupdate-shippingoptions" id="ref-for-dom-paymentrequestdetailsupdate-shippingoptions-1"><code>shippingOptions</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymentrequestdetailsupdate-paymentmethoderrors" data-title="paymentMethodErrors" data-dfn-for="PaymentRequestDetailsUpdate"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object">object</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequestdetailsupdate-paymentmethoderrors" id="ref-for-dom-paymentrequestdetailsupdate-paymentmethoderrors-1"><code>paymentMethodErrors</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymentrequestdetailsupdate-shippingaddresserrors" data-title="shippingAddressErrors" data-dfn-for="PaymentRequestDetailsUpdate"><span class="idlType">
  <a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#dom-addresserrors">AddressErrors</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequestdetailsupdate-shippingaddresserrors" id="ref-for-dom-paymentrequestdetailsupdate-shippingaddresserrors-1"><code>shippingAddressErrors</code></a>;</span>
};</span></code></pre>
            <section id="error-member">
                <div class="header-wrapper">
                    <h4 id="x6-2-1-error-member"><bdi class="secno">6.2.1 </bdi>
                        <dfn data-export="" data-dfn-type="dict-member" id="dom-paymentrequestdetailsupdate-error"
                            data-idl="field" data-title="error" data-dfn-for="PaymentRequestDetailsUpdate"
                            data-type="DOMString" tabindex="0" aria-haspopup="dialog"><code>error</code></dfn> 成员
                    </h4><a class="self-link" href="#error-member" aria-label="Permalink for Section 6.2.1"></a>
                </div>

                <p>
                    一个人类可读的字符串，用于说明为什么用户选择的基于 Web 的支付方式、
                    收货地址或配送选项无法使用。
                </p>
            </section>
            <section id="total-member">
                <div class="header-wrapper">
                    <h4 id="x6-2-2-total-member"><bdi class="secno">6.2.2 </bdi>
                        <dfn data-export="" data-dfn-type="dict-member" id="dom-paymentrequestdetailsupdate-total"
                            data-idl="field" data-title="total" data-dfn-for="PaymentRequestDetailsUpdate"
                            data-type="PaymentCurrencyAmount" tabindex="0"
                            aria-haspopup="dialog"><code>total</code></dfn> 成员
                    </h4><a class="self-link" href="#total-member" aria-label="Permalink for Section 6.2.2"></a>
                </div>

                <p>
                    基于变更后的支付方法、收货地址或配送选项而更新的总额。例如，总额可能因用户所选支付方法的账单地址改变了增值税（VAT）而变化；或者因用户所选/提供的配送选项/地址改变了配送费用而变化。
                </p>
            </section>
            <section id="modifiers-member">
                <div class="header-wrapper">
                    <h4 id="x6-2-3-modifiers-member"><bdi class="secno">6.2.3 </bdi>
                        <dfn data-export="" data-dfn-type="dict-member" id="dom-paymentrequestdetailsupdate-modifiers"
                            data-idl="field" data-title="modifiers" data-dfn-for="PaymentRequestDetailsUpdate"
                            data-type="sequence" tabindex="0" aria-haspopup="dialog"><code>modifiers</code></dfn> 成员
                    </h4><a class="self-link" href="#modifiers-member" aria-label="Permalink for Section 6.2.3"></a>
                </div>

                <p>
                    基于变更后的支付方法、收货地址或配送选项而更新的修饰符。例如，如果根据账单或收货地址总体总额增加了 €1.00，则每个修饰符中指定的总额也应增加 €1.00。
                </p>
            </section>
            <section id="shippingoptions-member">
                <div class="header-wrapper">
                    <h4 id="x6-2-4-shippingoptions-member"><bdi class="secno">6.2.4 </bdi>
                        <dfn data-export="" data-dfn-type="dict-member"
                            id="dom-paymentrequestdetailsupdate-shippingoptions" data-idl="field"
                            data-title="shippingOptions" data-dfn-for="PaymentRequestDetailsUpdate" data-type="sequence"
                            tabindex="0" aria-haspopup="dialog"><code>shippingOptions</code></dfn> 成员
                    </h4><a class="self-link" href="#shippingoptions-member"
                        aria-label="Permalink for Section 6.2.4"></a>
                </div>

                <p>
                    基于变更后的收货地址而更新的 shippingOptions。例如，对于用户提供的国家/地区，加急配送可能更昂贵或不可用。
                </p>
            </section>
            <section id="paymentmethoderrors-member">
                <div class="header-wrapper">
                    <h4 id="x6-2-5-paymentmethoderrors-member"><bdi class="secno">6.2.5 </bdi>
                        <dfn data-export="" data-dfn-type="dict-member"
                            id="dom-paymentrequestdetailsupdate-paymentmethoderrors" data-idl="field"
                            data-title="paymentMethodErrors" data-dfn-for="PaymentRequestDetailsUpdate"
                            data-type="object" tabindex="0"
                            aria-haspopup="dialog"><code>paymentMethodErrors</code></dfn> 成员
                    </h4><a class="self-link" href="#paymentmethoderrors-member"
                        aria-label="Permalink for Section 6.2.5"></a>
                </div>

                <p>
                    支付方法的校验错误（如有）。
                </p>
            </section>
            <section id="shippingaddresserrors-member">
                <div class="header-wrapper">
                    <h4 id="x6-2-6-shippingaddresserrors-member"><bdi class="secno">6.2.6 </bdi>
                        <dfn data-export="" data-dfn-type="dict-member"
                            id="dom-paymentrequestdetailsupdate-shippingaddresserrors" data-idl="field"
                            data-title="shippingAddressErrors" data-dfn-for="PaymentRequestDetailsUpdate"
                            data-type="AddressErrors" tabindex="0"
                            aria-haspopup="dialog"><code>shippingAddressErrors</code></dfn> 成员
                    </h4><a class="self-link" href="#shippingaddresserrors-member"
                        aria-label="Permalink for Section 6.2.6"></a>
                </div>

                <p>
                    收货地址的校验错误（如有）。
                </p>
            </section>
        </section>
        <section data-dfn-for="PaymentRequestEvent" data-link-for="PaymentRequestEvent" id="the-paymentrequestevent">
            <div class="header-wrapper">
                <h3 id="x6-3-the-paymentrequestevent"><bdi class="secno">6.3 </bdi>
                    <dfn data-export="" data-dfn-type="interface" id="dom-paymentrequestevent" data-idl="interface"
                        data-title="PaymentRequestEvent" data-dfn-for="" tabindex="0"
                        aria-haspopup="dialog"><code>PaymentRequestEvent</code></dfn>
                </h3><a class="self-link" href="#the-paymentrequestevent" aria-label="Permalink for Section 6.3"></a>
            </div>

            <p>
                PaymentRequestEvent 表示在用户选择之后，支付处理程序可用的数据和方法。用户代理会将
                <a data-link-type="dfn"
                    href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a>
                中可用数据的一个子集传递给支付处理程序。
            </p>
            <pre class="idl def" id="webidl-941889379"><span class="idlHeader"><a class="self-link" href="#webidl-941889379">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-paymentrequestevent" data-title="PaymentRequestEvent">[<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=ServiceWorker</span>]
interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-paymentrequestevent" id="ref-for-dom-paymentrequestevent-9"><code>PaymentRequestEvent</code></a> : <span class="idlSuperclass"><a data-link-type="idl" href="https://www.w3.org/TR/service-workers/#extendableevent-interface">ExtendableEvent</a></span> {<span data-idl="" class="idlConstructor" id="idl-def-paymentrequestevent-constructor-type-eventinitdict" data-title="constructor" data-dfn-for="PaymentRequestEvent">
  <dfn data-export="" data-dfn-type="constructor" id="dom-paymentrequestevent-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="PaymentRequestEvent" data-lt="constructor()|constructor(type)|constructor(type, eventInitDict)" data-local-lt="PaymentRequestEvent.constructor|PaymentRequestEvent.constructor()|constructor" tabindex="0" aria-haspopup="dialog"><code>constructor</code></dfn>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">type</span>, optional<span class="idlType"> <a data-link-type="idl" href="#dom-paymentrequesteventinit" class="internalDFN" id="ref-for-dom-paymentrequesteventinit-1"><code>PaymentRequestEventInit</code></a></span> <span class="idlParamName">eventInitDict</span> = {});</span><span data-idl="" class="idlAttribute" id="idl-def-paymentrequestevent-toporigin" data-title="topOrigin" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-toporigin" id="ref-for-dom-paymentrequestevent-toporigin-1"><code>topOrigin</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-paymentrequestevent-paymentrequestorigin" data-title="paymentRequestOrigin" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-paymentrequestorigin" id="ref-for-dom-paymentrequestevent-paymentrequestorigin-1"><code>paymentRequestOrigin</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-paymentrequestevent-paymentrequestid" data-title="paymentRequestId" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-paymentrequestid" id="ref-for-dom-paymentrequestevent-paymentrequestid-1"><code>paymentRequestId</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-paymentrequestevent-methoddata" data-title="methodData" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array">FrozenArray</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#paymentmethoddata-dictionary">PaymentMethodData</a>&gt;</span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-methoddata" id="ref-for-dom-paymentrequestevent-methoddata-1"><code>methodData</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-paymentrequestevent-total" data-title="total" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object">object</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-total" id="ref-for-dom-paymentrequestevent-total-1"><code>total</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-paymentrequestevent-modifiers" data-title="modifiers" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array">FrozenArray</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#paymentdetailsmodifier-dictionary">PaymentDetailsModifier</a>&gt;</span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-modifiers" id="ref-for-dom-paymentrequestevent-modifiers-1"><code>modifiers</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-paymentrequestevent-paymentoptions" data-title="paymentOptions" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object">object</a>?</span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-paymentoptions" id="ref-for-dom-paymentrequestevent-paymentoptions-1"><code>paymentOptions</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-paymentrequestevent-shippingoptions" data-title="shippingOptions" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array">FrozenArray</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#dom-paymentshippingoption">PaymentShippingOption</a>&gt;?</span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-shippingoptions" id="ref-for-dom-paymentrequestevent-shippingoptions-1"><code>shippingOptions</code></a>;</span><span data-idl="" class="idlMethod" id="idl-def-paymentrequestevent-openwindow-url" data-title="openWindow" data-dfn-for="PaymentRequestEvent"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dfn-windowclient-0" class="internalDFN" id="ref-for-dfn-windowclient-0-1">WindowClient</a>?&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-paymentrequestevent-openwindow" id="ref-for-dom-paymentrequestevent-openwindow-1"><code>openWindow</code></a>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString">USVString</a></span> <span class="idlParamName">url</span>);</span><span data-idl="" class="idlMethod" id="idl-def-paymentrequestevent-changepaymentmethod-methodname-methoddetails" data-title="changePaymentMethod" data-dfn-for="PaymentRequestEvent"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dom-paymentrequestdetailsupdate" class="internalDFN" id="ref-for-dom-paymentrequestdetailsupdate-2"><code>PaymentRequestDetailsUpdate</code></a>?&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-paymentrequestevent-changepaymentmethod" id="ref-for-dom-paymentrequestevent-changepaymentmethod-1"><code>changePaymentMethod</code></a>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">methodName</span>, optional<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object">object</a>?</span> <span class="idlParamName">methodDetails</span> = null);</span><span data-idl="" class="idlMethod" id="idl-def-paymentrequestevent-changeshippingaddress-shippingaddress" data-title="changeShippingAddress" data-dfn-for="PaymentRequestEvent"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dom-paymentrequestdetailsupdate" class="internalDFN" id="ref-for-dom-paymentrequestdetailsupdate-3"><code>PaymentRequestDetailsUpdate</code></a>?&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-paymentrequestevent-changeshippingaddress" id="ref-for-dom-paymentrequestevent-changeshippingaddress-1"><code>changeShippingAddress</code></a>(optional<span class="idlType"> <a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#dom-addressinit">AddressInit</a></span> <span class="idlParamName">shippingAddress</span> = {});</span><span data-idl="" class="idlMethod" id="idl-def-paymentrequestevent-changeshippingoption-shippingoption" data-title="changeShippingOption" data-dfn-for="PaymentRequestEvent"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dom-paymentrequestdetailsupdate" class="internalDFN" id="ref-for-dom-paymentrequestdetailsupdate-4"><code>PaymentRequestDetailsUpdate</code></a>?&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-paymentrequestevent-changeshippingoption" id="ref-for-dom-paymentrequestevent-changeshippingoption-1"><code>changeShippingOption</code></a>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">shippingOption</span>);</span><span data-idl="" class="idlMethod" id="idl-def-paymentrequestevent-respondwith-handlerresponsepromise" data-title="respondWith" data-dfn-for="PaymentRequestEvent"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-paymentrequestevent-respondwith" id="ref-for-dom-paymentrequestevent-respondwith-1"><code>respondWith</code></a>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dom-paymenthandlerresponse" class="internalDFN" id="ref-for-dom-paymenthandlerresponse-2"><code>PaymentHandlerResponse</code></a>&gt;</span> <span class="idlParamName">handlerResponsePromise</span>);</span>
};</span></code></pre>
            <section id="toporigin-attribute">
                <div class="header-wrapper">
                    <h4 id="x6-3-1-toporigin-attribute"><bdi class="secno">6.3.1 </bdi>
                        <dfn data-export="" data-dfn-type="attribute" id="dom-paymentrequestevent-toporigin"
                            data-idl="attribute" data-title="topOrigin" data-dfn-for="PaymentRequestEvent"
                            data-type="USVString" data-lt="topOrigin" data-local-lt="PaymentRequestEvent.topOrigin"
                            tabindex="0" aria-haspopup="dialog"><code>topOrigin</code></dfn> 属性
                    </h4><a class="self-link" href="#toporigin-attribute" aria-label="Permalink for Section 6.3.1"></a>
                </div>

                <p>
                    返回一个字符串，指示顶层
                    <a href="#dfn-payee" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-payee-2">收款方</a>网页的<a
                        data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">来源（origin）</a>。
                    此属性由<a href="#dfn-handling-a-paymentrequestevent" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-handling-a-paymentrequestevent-1">处理 PaymentRequestEvent</a>进行初始化。
                </p>
            </section>
            <section id="paymentrequestorigin-attribute">
                <div class="header-wrapper">
                    <h4 id="x6-3-2-paymentrequestorigin-attribute"><bdi class="secno">6.3.2 </bdi>
                        <dfn data-export="" data-dfn-type="attribute" id="dom-paymentrequestevent-paymentrequestorigin"
                            data-idl="attribute" data-title="paymentRequestOrigin" data-dfn-for="PaymentRequestEvent"
                            data-type="USVString" data-lt="paymentRequestOrigin"
                            data-local-lt="PaymentRequestEvent.paymentRequestOrigin" tabindex="0"
                            aria-haspopup="dialog"><code>paymentRequestOrigin</code></dfn> 属性
                    </h4><a class="self-link" href="#paymentrequestorigin-attribute"
                        aria-label="Permalink for Section 6.3.2"></a>
                </div>

                <p>
                    返回一个字符串，指示
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a>
                    被初始化的<a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">来源</a>。
                    当 <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a>
                    在 <a href="#dom-paymentrequestevent-toporigin" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-paymentrequestevent-toporigin-2"><code>topOrigin</code></a>
                    中初始化时，这两个属性具有相同的值；否则二者不同。
                    例如，当 <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a>
                    在一个来源不同于 <a href="#dom-paymentrequestevent-toporigin" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-paymentrequestevent-toporigin-3"><code>topOrigin</code></a> 的 iframe
                    中初始化时，此属性值为该 iframe 的来源。此属性由
                    <a href="#dfn-handling-a-paymentrequestevent" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-handling-a-paymentrequestevent-2">处理 PaymentRequestEvent</a>进行初始化。
                </p>
            </section>
            <section data-cite="payment-request" id="paymentrequestid-attribute">
                <div class="header-wrapper">
                    <h4 id="x6-3-3-paymentrequestid-attribute"><bdi class="secno">6.3.3 </bdi>
                        <dfn data-export="" data-dfn-type="attribute" id="dom-paymentrequestevent-paymentrequestid"
                            data-idl="attribute" data-title="paymentRequestId" data-dfn-for="PaymentRequestEvent"
                            data-type="DOMString" data-lt="paymentRequestId"
                            data-local-lt="PaymentRequestEvent.paymentRequestId" tabindex="0"
                            aria-haspopup="dialog"><code>paymentRequestId</code></dfn> 属性
                    </h4><a class="self-link" href="#paymentrequestid-attribute"
                        aria-label="Permalink for Section 6.3.3"></a>
                </div>

                <p>
                    获取时，<a href="#dom-paymentrequestevent-paymentrequestid" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-paymentrequestevent-paymentrequestid-2"><code>paymentRequestId</code></a>
                    属性返回与此 <a data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                        class="internalDFN" id="ref-for-dom-paymentrequestevent-10"><code>PaymentRequestEvent</code></a>
                    对应的
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a> 的
                    <a data-link-type="attribute" data-lt="[[details]]"
                        href="https://www.w3.org/TR/payment-request/#dfn-details"><code>[[details]]</code></a>.<a
                        data-link-type="dfn" href="https://www.w3.org/TR/payment-request/#id-attribute">id</a>。
                </p>
            </section>
            <section id="methoddata-attribute">
                <div class="header-wrapper">
                    <h4 id="x6-3-4-methoddata-attribute"><bdi class="secno">6.3.4 </bdi>
                        <dfn data-export="" data-dfn-type="attribute" id="dom-paymentrequestevent-methoddata"
                            data-idl="attribute" data-title="methodData" data-dfn-for="PaymentRequestEvent"
                            data-type="FrozenArray" data-lt="methodData" data-local-lt="PaymentRequestEvent.methodData"
                            tabindex="0" aria-haspopup="dialog"><code>methodData</code></dfn> 属性
                    </h4><a class="self-link" href="#methoddata-attribute" aria-label="Permalink for Section 6.3.4"></a>
                </div>

                <p>
                    此属性包含若干 <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#paymentmethoddata-dictionary">PaymentMethodData</a>
                    字典，包含网站可接受的<a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">支付方法标识符</a>以及任何相关的特定
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#dfn-payment-method">支付方法</a>数据。它由
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a> 使用下文定义的
                    <a href="#dfn-methoddata-population-algorithm" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-methoddata-population-algorithm-1">方法数据填充算法</a>进行填充。
                </p>
            </section>
            <section id="total-attribute">
                <div class="header-wrapper">
                    <h4 id="x6-3-5-total-attribute"><bdi class="secno">6.3.5 </bdi>
                        <dfn data-export="" data-dfn-type="attribute" id="dom-paymentrequestevent-total"
                            data-idl="attribute" data-title="total" data-dfn-for="PaymentRequestEvent"
                            data-type="object" data-lt="total" data-local-lt="PaymentRequestEvent.total" tabindex="0"
                            aria-haspopup="dialog"><code>total</code></dfn> 属性
                    </h4><a class="self-link" href="#total-attribute" aria-label="Permalink for Section 6.3.5"></a>
                </div>

                <p>
                    此属性表示请求支付的总金额。其类型为
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#paymentcurrencyamount-dictionary">PaymentCurrencyAmount</a>
                    字典（定义见 [<cite><a class="bibref" data-link-type="biblio" href="#bib-payment-request"
                            title="Payment Request API">payment-request</a></cite>]），并使用在实例化相应
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a> 对象时所提供的
                    <a href="#dom-paymentrequestevent-total" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-paymentrequestevent-total-2"><code>total</code></a> 字段的副本进行初始化。
                </p>
            </section>
            <section id="modifiers-attribute">
                <div class="header-wrapper">
                    <h4 id="x6-3-6-modifiers-attribute"><bdi class="secno">6.3.6 </bdi>
                        <dfn data-export="" data-dfn-type="attribute" id="dom-paymentrequestevent-modifiers"
                            data-idl="attribute" data-title="modifiers" data-dfn-for="PaymentRequestEvent"
                            data-type="FrozenArray" data-lt="modifiers" data-local-lt="PaymentRequestEvent.modifiers"
                            tabindex="0" aria-haspopup="dialog"><code>modifiers</code></dfn> 属性
                    </h4><a class="self-link" href="#modifiers-attribute" aria-label="Permalink for Section 6.3.6"></a>
                </div>

                <p>
                    此 <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#paymentdetailsmodifier-dictionary">PaymentDetailsModifier</a>
                    字典序列包含针对特定支付方法标识符的修饰符（例如，如果基于每种支付方法，支付金额或货币类型有所不同）。它由
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a> 使用下文定义的
                    <a href="#dfn-modifiers-population-algorithm" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-modifiers-population-algorithm-1">修饰符填充算法</a>进行填充。
                </p>
            </section>
            <section id="paymentoptions-attribute">
                <div class="header-wrapper">
                    <h4 id="x6-3-7-paymentoptions-attribute"><bdi class="secno">6.3.7 </bdi>
                        <dfn data-export="" data-dfn-type="attribute" id="dom-paymentrequestevent-paymentoptions"
                            data-idl="attribute" data-title="paymentOptions" data-dfn-for="PaymentRequestEvent"
                            data-type="object" data-lt="paymentOptions"
                            data-local-lt="PaymentRequestEvent.paymentOptions" tabindex="0"
                            aria-haspopup="dialog"><code>paymentOptions</code></dfn> 属性
                    </h4><a class="self-link" href="#paymentoptions-attribute"
                        aria-label="Permalink for Section 6.3.7"></a>
                </div>

                <p>
                    相应 <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a> 中
                    <a href="https://www.w3.org/TR/payment-request/#dom-paymentoptions">PaymentOptions</a> 的取值。
                    仅当请求收货地址和/或付款人联系信息的任意子集时可用。
                </p>
            </section>
            <section id="shippingoptions-attribute">
                <div class="header-wrapper">
                    <h4 id="x6-3-8-shippingoptions-attribute"><bdi class="secno">6.3.8 </bdi>
                        <dfn data-export="" data-dfn-type="attribute" id="dom-paymentrequestevent-shippingoptions"
                            data-idl="attribute" data-title="shippingOptions" data-dfn-for="PaymentRequestEvent"
                            data-type="FrozenArray" data-lt="shippingOptions"
                            data-local-lt="PaymentRequestEvent.shippingOptions" tabindex="0"
                            aria-haspopup="dialog"><code>shippingOptions</code></dfn> 属性
                    </h4><a class="self-link" href="#shippingoptions-attribute"
                        aria-label="Permalink for Section 6.3.8"></a>
                </div>

                <p>
                    相应 <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#paymentdetailsinit-dictionary">PaymentDetailsInit</a>
                    字典中的 <a
                        href="https://www.w3.org/TR/payment-request/#dom-paymentdetailsbase-shippingoptions">ShippingOptions</a>
                    的取值。（<a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#paymentdetailsinit-dictionary">PaymentDetailsInit</a>
                    继承了 <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#paymentdetailsbase-dictionary">PaymentDetailsBase</a>
                    的 ShippingOptions）。仅当请求收货地址时可用。
                </p>
            </section>
            <section id="openwindow-method">
                <div class="header-wrapper">
                    <h4 id="x6-3-9-openwindow-method"><bdi class="secno">6.3.9 </bdi>
                        <dfn data-export="" data-dfn-type="method" id="dom-paymentrequestevent-openwindow"
                            data-idl="operation" data-title="openWindow()" data-dfn-for="PaymentRequestEvent"
                            data-type="Promise" data-lt="openWindow()|openWindow(url)"
                            data-local-lt="PaymentRequestEvent.openWindow|PaymentRequestEvent.openWindow()|openWindow"
                            tabindex="0" aria-haspopup="dialog"><code>openWindow()</code></dfn> 方法
                    </h4><a class="self-link" href="#openwindow-method" aria-label="Permalink for Section 6.3.9"></a>
                </div>

                <p>
                    此方法由基于 Web 的支付处理程序用于向用户展示一个窗口。
                    调用该方法时，会运行
                    <a href="#dfn-open-window-algorithm" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-open-window-algorithm-1">打开窗口算法</a>。
                </p>
            </section>
            <section id="changepaymentmethod-method">
                <div class="header-wrapper">
                    <h4 id="x6-3-10-changepaymentmethod-method"><bdi class="secno">6.3.10 </bdi>
                        <dfn data-lt="changePaymentMethod(methodName, methodDetails)|changePaymentMethod()|changePaymentMethod(methodName)"
                            data-export="" data-dfn-type="method" id="dom-paymentrequestevent-changepaymentmethod"
                            data-idl="operation" data-title="changePaymentMethod()" data-dfn-for="PaymentRequestEvent"
                            data-type="Promise"
                            data-local-lt="PaymentRequestEvent.changePaymentMethod|PaymentRequestEvent.changePaymentMethod()|changePaymentMethod"
                            tabindex="0" aria-haspopup="dialog"><code>changePaymentMethod()</code></dfn>
                        方法
                    </h4><a class="self-link" href="#changepaymentmethod-method"
                        aria-label="Permalink for Section 6.3.10"></a>
                </div>

                <p>
                    此方法由基于 Web 的支付处理程序用于根据付款方式详情（如账单地址）获取更新后的总金额。
                    调用该方法时，会运行
                    <a href="#dfn-change-payment-method-algorithm" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-change-payment-method-algorithm-1">更改支付方式算法</a>。
                </p>
            </section>
            <section id="changeshippingaddress-method">
                <div class="header-wrapper">
                    <h4 id="x6-3-11-changeshippingaddress-method"><bdi class="secno">6.3.11 </bdi>
                        <dfn data-lt="changeShippingAddress(shippingAddress)|changeShippingAddress()" data-export=""
                            data-dfn-type="method" id="dom-paymentrequestevent-changeshippingaddress"
                            data-idl="operation" data-title="changeShippingAddress()" data-dfn-for="PaymentRequestEvent"
                            data-type="Promise"
                            data-local-lt="PaymentRequestEvent.changeShippingAddress|PaymentRequestEvent.changeShippingAddress()|changeShippingAddress"
                            tabindex="0" aria-haspopup="dialog"><code>changeShippingAddress()</code></dfn>
                        方法
                    </h4><a class="self-link" href="#changeshippingaddress-method"
                        aria-label="Permalink for Section 6.3.11"></a>
                </div>

                <p>
                    此方法由基于 Web 的支付处理程序用于根据 shippingAddress 获取更新后的支付详情。
                    调用该方法时，会运行
                    <a href="#dfn-change-payment-details-algorithm" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-change-payment-details-algorithm-1">更改支付详情算法</a>。
                </p>
            </section>
            <section id="changeshippingoption-method">
                <div class="header-wrapper">
                    <h4 id="x6-3-12-changeshippingoption-method"><bdi class="secno">6.3.12 </bdi>
                        <dfn data-lt="changeShippingOption(shippingOption)|changeShippingOption()" data-export=""
                            data-dfn-type="method" id="dom-paymentrequestevent-changeshippingoption"
                            data-idl="operation" data-title="changeShippingOption()" data-dfn-for="PaymentRequestEvent"
                            data-type="Promise"
                            data-local-lt="PaymentRequestEvent.changeShippingOption|PaymentRequestEvent.changeShippingOption()|changeShippingOption"
                            tabindex="0" aria-haspopup="dialog"><code>changeShippingOption()</code></dfn>
                        方法
                    </h4><a class="self-link" href="#changeshippingoption-method"
                        aria-label="Permalink for Section 6.3.12"></a>
                </div>

                <p>
                    此方法由基于 Web 的支付处理程序用于根据 shippingOption 标识符获取更新后的支付详情。
                    调用该方法时，会运行
                    <a href="#dfn-change-payment-details-algorithm" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-change-payment-details-algorithm-2">更改支付详情算法</a>。
                </p>
            </section>
            <section id="respondwith-method-0">
                <div class="header-wrapper">
                    <h4 id="x6-3-13-respondwith-method"><bdi class="secno">6.3.13 </bdi>
                        <dfn data-lt="respondWith(handlerResponsePromise)|respondWith()" data-export=""
                            data-dfn-type="method" id="dom-paymentrequestevent-respondwith" data-idl="operation"
                            data-title="respondWith()" data-dfn-for="PaymentRequestEvent" data-type="undefined"
                            data-local-lt="PaymentRequestEvent.respondWith|PaymentRequestEvent.respondWith()|respondWith"
                            tabindex="0" aria-haspopup="dialog"><code>respondWith()</code></dfn> 方法
                    </h4><a class="self-link" href="#respondwith-method-0"
                        aria-label="Permalink for Section 6.3.13"></a>
                </div>

                <p>
                    此方法由基于 Web 的支付处理程序在支付成功完成时，提供
                    <a href="#dom-paymenthandlerresponse" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-paymenthandlerresponse-3"><code>PaymentHandlerResponse</code></a>。
                    调用该方法时，会以 <var>event</var> 和 <var>handlerResponsePromise</var> 为参数，
                    运行
                    <a href="#dfn-respond-to-paymentrequest-algorithm" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-respond-to-paymentrequest-algorithm-1">响应 PaymentRequest 算法</a>。
                </p>
            </section>
            <div class="issue" id="issue-container-number-123">
                <div role="heading" class="issue-title marker" id="h-issue-0" aria-level="4"><a
                        href="https://github.com/w3c/web-based-payment-handler/issues/123"><span
                            class="issue-number">Issue
                            123</span></a><span class="issue-label">: 与支付应用共享用户数据？</span></div>
                <p class="">
                    是否应在用户明确同意的情况下，将存储在用户代理中的用户数据提供给支付应用？支付应用可以在安装时或首次被调用时请求该权限。
                </p>
            </div>
            <section data-dfn-for="PaymentRequestEventInit" id="paymentrequesteventinit-dictionary">
                <div class="header-wrapper">
                    <h4 id="x6-3-14-paymentrequesteventinit-dictionary"><bdi class="secno">6.3.14 </bdi>
                        <dfn data-export="" data-dfn-type="dictionary" id="dom-paymentrequesteventinit"
                            data-idl="dictionary" data-title="PaymentRequestEventInit" data-dfn-for="" tabindex="0"
                            aria-haspopup="dialog"><code>PaymentRequestEventInit</code></dfn> 字典
                    </h4><a class="self-link" href="#paymentrequesteventinit-dictionary"
                        aria-label="Permalink for Section 6.3.14"></a>
                </div>

                <pre class="idl def" id="webidl-488183213"><span class="idlHeader"><a class="self-link" href="#webidl-488183213">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-paymentrequesteventinit" data-title="PaymentRequestEventInit">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dom-paymentrequesteventinit" id="ref-for-dom-paymentrequesteventinit-2"><code>PaymentRequestEventInit</code></a> : <span class="idlSuperclass"><a data-link-type="idl" href="https://www.w3.org/TR/service-workers/#dictdef-extendableeventinit">ExtendableEventInit</a></span> {<span data-idl="" class="idlMember" id="idl-def-paymentrequesteventinit-toporigin" data-title="topOrigin" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-toporigin" id="ref-for-dom-paymentrequesteventinit-toporigin-1"><code>topOrigin</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymentrequesteventinit-paymentrequestorigin" data-title="paymentRequestOrigin" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-paymentrequestorigin" id="ref-for-dom-paymentrequesteventinit-paymentrequestorigin-1"><code>paymentRequestOrigin</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymentrequesteventinit-paymentrequestid" data-title="paymentRequestId" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-paymentrequestid" id="ref-for-dom-paymentrequesteventinit-paymentrequestid-1"><code>paymentRequestId</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymentrequesteventinit-methoddata" data-title="methodData" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#paymentmethoddata-dictionary">PaymentMethodData</a>&gt;</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-methoddata" id="ref-for-dom-paymentrequesteventinit-methoddata-1"><code>methodData</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymentrequesteventinit-total" data-title="total" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#paymentcurrencyamount-dictionary">PaymentCurrencyAmount</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-total" id="ref-for-dom-paymentrequesteventinit-total-1"><code>total</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymentrequesteventinit-modifiers" data-title="modifiers" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#paymentdetailsmodifier-dictionary">PaymentDetailsModifier</a>&gt;</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-modifiers" id="ref-for-dom-paymentrequesteventinit-modifiers-1"><code>modifiers</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymentrequesteventinit-paymentoptions" data-title="paymentOptions" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="idl" href="#dom-paymentrequestevent-paymentoptions" class="internalDFN" id="ref-for-dom-paymentrequestevent-paymentoptions-2">PaymentOptions</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-paymentoptions" id="ref-for-dom-paymentrequesteventinit-paymentoptions-1"><code>paymentOptions</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymentrequesteventinit-shippingoptions" data-title="shippingOptions" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#dom-paymentshippingoption">PaymentShippingOption</a>&gt;</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-shippingoptions" id="ref-for-dom-paymentrequesteventinit-shippingoptions-1"><code>shippingOptions</code></a>;</span>
};</span></code></pre>
                <p>
                    <dfn data-export="" data-dfn-type="dict-member" id="dom-paymentrequesteventinit-toporigin"
                        data-idl="field" data-title="topOrigin" data-dfn-for="PaymentRequestEventInit"
                        data-type="USVString" tabindex="0" aria-haspopup="dialog"><code>topOrigin</code></dfn>、
                    <dfn data-export="" data-dfn-type="dict-member"
                        id="dom-paymentrequesteventinit-paymentrequestorigin" data-idl="field"
                        data-title="paymentRequestOrigin" data-dfn-for="PaymentRequestEventInit" data-type="USVString"
                        tabindex="0" aria-haspopup="dialog"><code>paymentRequestOrigin</code></dfn>、
                    <dfn data-export="" data-dfn-type="dict-member" id="dom-paymentrequesteventinit-paymentrequestid"
                        data-idl="field" data-title="paymentRequestId" data-dfn-for="PaymentRequestEventInit"
                        data-type="DOMString" tabindex="0" aria-haspopup="dialog"><code>paymentRequestId</code></dfn>、
                    <dfn data-export="" data-dfn-type="dict-member" id="dom-paymentrequesteventinit-methoddata"
                        data-idl="field" data-title="methodData" data-dfn-for="PaymentRequestEventInit"
                        data-type="sequence" tabindex="0" aria-haspopup="dialog"><code>methodData</code></dfn>、
                    <dfn data-export="" data-dfn-type="dict-member" id="dom-paymentrequesteventinit-total"
                        data-idl="field" data-title="total" data-dfn-for="PaymentRequestEventInit"
                        data-type="PaymentCurrencyAmount" tabindex="0" aria-haspopup="dialog"><code>total</code></dfn>、
                    <dfn data-export="" data-dfn-type="dict-member" id="dom-paymentrequesteventinit-modifiers"
                        data-idl="field" data-title="modifiers" data-dfn-for="PaymentRequestEventInit"
                        data-type="sequence" tabindex="0" aria-haspopup="dialog"><code>modifiers</code></dfn>、
                    <dfn data-export="" data-dfn-type="dict-member" id="dom-paymentrequesteventinit-paymentoptions"
                        data-idl="field" data-title="paymentOptions" data-dfn-for="PaymentRequestEventInit"
                        data-type="PaymentOptions" tabindex="0" aria-haspopup="dialog"><code>paymentOptions</code></dfn>
                    与
                    <dfn data-export="" data-dfn-type="dict-member" id="dom-paymentrequesteventinit-shippingoptions"
                        data-idl="field" data-title="shippingOptions" data-dfn-for="PaymentRequestEventInit"
                        data-type="sequence" tabindex="0" aria-haspopup="dialog"><code>shippingOptions</code></dfn>
                    成员与 <a data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                        class="internalDFN" id="ref-for-dom-paymentrequestevent-11"><code>PaymentRequestEvent</code></a>
                    中的相应定义共享定义。
                </p>
            </section>
            <section id="methoddata-population-algorithm">
                <div class="header-wrapper">
                    <h4 id="x6-3-15-methoddata-population-algorithm"><bdi class="secno">6.3.15 </bdi>
                        <dfn id="dfn-methoddata-population-algorithm" tabindex="0" aria-haspopup="dialog"
                            data-dfn-type="dfn">方法数据填充算法</dfn>
                    </h4><a class="self-link" href="#methoddata-population-algorithm"
                        aria-label="Permalink for Section 6.3.15"></a>
                </div>

                <p>
                    为初始化 <a href="#dom-paymentrequestevent-methoddata" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-paymentrequestevent-methoddata-2"><code>methodData</code></a> 的值，用户代理
                    <em class="rfc2119">必须（MUST）</em>执行以下步骤或等效步骤：
                </p>
                <ol>
                    <li>令 <var>registeredMethods</var> 为已调用的基于 Web 的支付处理程序所注册的
                        <a data-link-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">支付方式标识符</a>
                        集合。
                    </li>
                    <li>创建一个新的空的 <a data-link-type="dfn"
                            href="https://webidl.spec.whatwg.org/#idl-sequence">Sequence</a>。
                    </li>
                    <li>将 <var>dataList</var> 设为新创建的
                        <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">Sequence</a>。
                    </li>
                    <li>对于相应支付请求中的
                        <a data-link-type="dfn"
                            href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a>@<var>[[methodData]]</var>
                        中的每个条目，执行以下步骤：
                        <ol>
                            <li>将 <var>inData</var> 设为当前条目。
                            </li>
                            <li>将 <var>commonMethods</var> 设为
                                <var>inData</var>.<a data-link-type="dfn"
                                    href="https://www.w3.org/TR/payment-request/#dom-paymentmethoddata-supportedmethods">supportedMethods</a>
                                与 <var>registeredMethods</var> 的交集。
                            </li>
                            <li>如果 <var>commonMethods</var> 为空，跳过余下子步骤并继续下一个条目（如果有）。
                            </li>
                            <li>创建一个新的
                                <a data-link-type="dfn"
                                    href="https://www.w3.org/TR/payment-request/#paymentmethoddata-dictionary">PaymentMethodData</a>
                                对象。
                            </li>
                            <li>将 <var>outData</var> 设为新创建的
                                <a data-link-type="dfn"
                                    href="https://www.w3.org/TR/payment-request/#paymentmethoddata-dictionary">PaymentMethodData</a>。
                            </li>
                            <li>将 <var>outData</var>.<a data-link-type="dfn"
                                    href="https://www.w3.org/TR/payment-request/#dom-paymentmethoddata-supportedmethods">supportedMethods</a>
                                设为包含 <var>commonMethods</var> 成员的列表。
                            </li>
                            <li>将 <var>outData</var>.data 设为
                                <var>inData</var>.data 的副本。
                            </li>
                            <li>将 <var>outData</var> 追加到 <var>dataList</var>。
                            </li>
                        </ol>
                    </li>
                    <li>将 <a href="#dom-paymentrequestevent-methoddata" class="internalDFN" data-link-type="idl"
                            id="ref-for-dom-paymentrequestevent-methoddata-3"><code>methodData</code></a> 设为
                        <var>dataList</var>。
                    </li>
                </ol>
            </section>
            <section id="modifiers-population-algorithm">
                <div class="header-wrapper">
                    <h4 id="x6-3-16-modifiers-population-algorithm"><bdi class="secno">6.3.16 </bdi>
                        <dfn id="dfn-modifiers-population-algorithm" tabindex="0" aria-haspopup="dialog"
                            data-dfn-type="dfn">修饰符填充算法</dfn>
                    </h4><a class="self-link" href="#modifiers-population-algorithm"
                        aria-label="Permalink for Section 6.3.16"></a>
                </div>

                <p>
                    为初始化 <a href="#dom-paymentrequestevent-modifiers" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-paymentrequestevent-modifiers-2"><code>modifiers</code></a> 的值，用户代理
                    <em class="rfc2119">必须（MUST）</em>执行以下步骤或等效步骤：
                </p>
                <ol>
                    <li>令 <var>registeredMethods</var> 为已调用的基于 Web 的支付处理程序所注册的
                        <a data-link-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">支付方式标识符</a>
                        集合。
                    </li>
                    <li>创建一个新的空的 <a data-link-type="dfn"
                            href="https://webidl.spec.whatwg.org/#idl-sequence">Sequence</a>。
                    </li>
                    <li>将 <var>modifierList</var> 设为新创建的
                        <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">Sequence</a>。
                    </li>
                    <li>对于相应支付请求中的
                        <a data-link-type="dfn"
                            href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a>@<var>[[paymentDetails]]</var>.<a
                            href="#dom-paymentrequestevent-modifiers" class="internalDFN" data-link-type="idl"
                            id="ref-for-dom-paymentrequestevent-modifiers-3"><code>modifiers</code></a>
                        中的每个条目，执行以下步骤：
                        <ol>
                            <li>将 <var>inModifier</var> 设为当前条目。
                            </li>
                            <li>将 <var>commonMethods</var> 设为
                                <var>inModifier</var>.<a data-link-type="dfn"
                                    href="https://www.w3.org/TR/payment-request/#dom-paymentmethoddata-supportedmethods">supportedMethods</a>
                                与 <var>registeredMethods</var> 的交集。
                            </li>
                            <li>如果 <var>commonMethods</var> 为空，跳过余下子步骤并继续下一个条目（如果有）。
                            </li>
                            <li>创建一个新的
                                <a data-link-type="dfn"
                                    href="https://www.w3.org/TR/payment-request/#paymentdetailsmodifier-dictionary">PaymentDetailsModifier</a>
                                对象。
                            </li>
                            <li>将 <var>outModifier</var> 设为新创建的
                                <a data-link-type="dfn"
                                    href="https://www.w3.org/TR/payment-request/#paymentdetailsmodifier-dictionary">PaymentDetailsModifier</a>。
                            </li>
                            <li>将 <var>outModifier</var>.<a data-link-type="dfn"
                                    href="https://www.w3.org/TR/payment-request/#dom-paymentmethoddata-supportedmethods">supportedMethods</a>
                                设为包含 <var>commonMethods</var> 成员的列表。
                            </li>
                            <li>将 <var>outModifier</var>.<a href="#dom-paymentrequestevent-total" class="internalDFN"
                                    data-link-type="idl"
                                    id="ref-for-dom-paymentrequestevent-total-3"><code>total</code></a> 设为
                                <var>inModifier</var>.<a href="#dom-paymentrequestevent-total" class="internalDFN"
                                    data-link-type="idl"
                                    id="ref-for-dom-paymentrequestevent-total-4"><code>total</code></a> 的副本。
                            </li>
                            <li>将 <var>outModifier</var> 追加到 <var>modifierList</var>。
                            </li>
                        </ol>
                    </li>
                    <li>将 <a href="#dom-paymentrequestevent-modifiers" class="internalDFN" data-link-type="idl"
                            id="ref-for-dom-paymentrequestevent-modifiers-4"><code>modifiers</code></a> 设为
                        <var>modifierList</var>。
                    </li>
                </ol>
            </section>
        </section>
        <section id="internal-slots">
            <div class="header-wrapper">
                <h3 id="x6-4-internal-slots"><bdi class="secno">6.4 </bdi>
                    内部槽
                </h3><a class="self-link" href="#internal-slots" aria-label="Permalink for Section 6.4"></a>
            </div>

            <p>
                <a data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                    class="internalDFN" id="ref-for-dom-paymentrequestevent-12"><code>PaymentRequestEvent</code></a>
                的实例会使用下表中的内部槽进行创建：
            </p>
            <table>
                <tbody>
                    <tr>
                        <th>
                            内部槽
                        </th>
                        <th>
                            默认值
                        </th>
                        <th>
                            描述（<em>非规范性</em>）
                        </th>
                    </tr>
                    <tr>
                        <td>
                            <dfn data-dfn-for="PaymentRequestEvent" data-idl="" data-noexport=""
                                data-dfn-type="attribute" id="dfn-windowclient" tabindex="0"
                                aria-haspopup="dialog">[[windowClient]]</dfn>
                        </td>
                        <td>
                            null
                        </td>
                        <td>
                            当前活跃的 <dfn id="dfn-windowclient-0" tabindex="0" aria-haspopup="dialog"
                                data-dfn-type="dfn">WindowClient</dfn>。
                            如果基于 Web 的支付处理程序当前正在向用户展示窗口，则会设置此项。否则为 null。
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <dfn data-dfn-for="PaymentRequestEvent" data-idl="" data-noexport=""
                                data-dfn-type="attribute" id="dfn-respondwithcalled" tabindex="0"
                                aria-haspopup="dialog">[[respondWithCalled]]</dfn>
                        </td>
                        <td>
                            false
                        </td>
                        <td>
                            YAHO
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>
        <section id="handling-a-paymentrequestevent">
            <div class="header-wrapper">
                <h3 id="x6-5-handling-a-paymentrequestevent"><bdi class="secno">6.5 </bdi>
                    <dfn id="dfn-handling-a-paymentrequestevent" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">处理 PaymentRequestEvent</dfn>
                </h3><a class="self-link" href="#handling-a-paymentrequestevent"
                    aria-label="Permalink for Section 6.5"></a>
            </div>

            <p>
                当通过 <a data-link-type="dfn"
                    href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a>，
                利用 <a href="https://www.w3.org/TR/payment-request/#show-method">PaymentRequest.show()</a>
                接收到付款请求，并且用户随后选择了某个基于 Web 的支付处理程序时，
                <a href="#dfn-user-agents" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-user-agents-4">用户代理</a>
                <em class="rfc2119">必须</em>执行以下步骤：
            </p>
            <ol>
                <li>令 <var>registration</var> 为用户所选择的基于 Web 的支付处理程序所对应的
                    <a data-link-type="idl" data-lt="ServiceWorkerRegistration"
                        href="https://www.w3.org/TR/service-workers/#service-worker-registration-concept"><code>ServiceWorkerRegistration</code></a>。
                </li>
                <li>如果未找到 <var>registration</var>，则拒绝由
                    <a data-link-type="interface" data-lt="Promise"
                        href="https://webidl.spec.whatwg.org/#idl-promise"><code>Promise</code></a>
                    （由 <a href="https://www.w3.org/TR/payment-request/#show-method">PaymentRequest.show()</a> 创建）
                    并返回
                    "<a data-link-type="exception"
                        href="https://webidl.spec.whatwg.org/#invalidstateerror"><code>InvalidStateError</code></a>"
                    <a data-link-type="interface" data-lt="DOMException"
                        href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a>，并终止这些步骤。
                </li>
                <li>
                    <p>
                        在 <var>registration</var> 上，使用
                        <a data-link-type="dfn"
                            href="https://www.w3.org/TR/service-workers/#fire-functional-event-algorithm">触发功能事件</a>
                        "<code>paymentrequest</code>"，
                        并以
                        <a data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                            class="internalDFN"
                            id="ref-for-dom-paymentrequestevent-13"><code>PaymentRequestEvent</code></a>
                        及如下属性：
                    </p>
                    <dl>
                        <dt>
                            <a data-link-type="idl" href="#dom-paymentrequestevent-toporigin" class="internalDFN"
                                id="ref-for-dom-paymentrequestevent-toporigin-4"><code>topOrigin</code></a>
                        </dt>
                        <dd>
                            付款网页顶层页面的
                            <a data-link-type="dfn"
                                href="https://html.spec.whatwg.org/multipage/browsers.html#ascii-serialisation-of-an-origin">origin
                                的序列化</a>。
                        </dd>
                        <dt>
                            <a data-lt="PaymentRequestEvent.paymentRequestOrigin"
                                href="#dom-paymentrequestevent-paymentrequestorigin" class="internalDFN"
                                data-link-type="idl"
                                id="ref-for-dom-paymentrequestevent-paymentrequestorigin-2"><code>paymentRequestOrigin</code></a>
                        </dt>
                        <dd>
                            初始化 PaymentRequest 的上下文
                            <a data-link-type="dfn"
                                href="https://html.spec.whatwg.org/multipage/browsers.html#ascii-serialisation-of-an-origin">origin
                                的序列化</a>。
                        </dd>
                        <dt>
                            <a data-link-type="idl" href="#dom-paymentrequestevent-methoddata" class="internalDFN"
                                id="ref-for-dom-paymentrequestevent-methoddata-4"><code>methodData</code></a>
                        </dt>
                        <dd>
                            执行 <a href="#dfn-methoddata-population-algorithm" class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-methoddata-population-algorithm-2">方法数据填充算法</a> 的结果。
                        </dd>
                        <dt>
                            <a data-lt="PaymentRequestEvent.modifiers" href="#dom-paymentrequestevent-modifiers"
                                class="internalDFN" data-link-type="idl"
                                id="ref-for-dom-paymentrequestevent-modifiers-5"><code>modifiers</code></a>
                        </dt>
                        <dd>
                            执行 <a href="#dfn-modifiers-population-algorithm" class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-modifiers-population-algorithm-2">修饰符填充算法</a> 的结果。
                        </dd>
                        <dt>
                            <a data-link-type="idl" href="#dom-paymentrequestevent-total" class="internalDFN"
                                id="ref-for-dom-paymentrequestevent-total-5"><code>total</code></a>
                        </dt>
                        <dd>
                            来自对应
                            <a data-link-type="dfn"
                                href="https://www.w3.org/TR/payment-request/#paymentdetailsinit-dictionary">PaymentDetailsInit</a>
                            的总金额字段的副本。
                        </dd>
                        <dt>
                            <a data-lt="PaymentRequestEvent.paymentRequestId"
                                href="#dom-paymentrequestevent-paymentrequestid" class="internalDFN"
                                data-link-type="idl"
                                id="ref-for-dom-paymentrequestevent-paymentrequestid-3"><code>paymentRequestId</code></a>
                        </dt>
                        <dd>
                            \[\[details\]\].<a data-link-type="dfn"
                                href="https://www.w3.org/TR/payment-request/#id-attribute">id</a>
                            ，取自对应
                            <a data-link-type="dfn"
                                href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a>。
                        </dd>
                        <dt>
                            <a data-lt="PaymentRequestEvent.paymentOptions"
                                href="#dom-paymentrequestevent-paymentoptions" class="internalDFN" data-link-type="idl"
                                id="ref-for-dom-paymentrequestevent-paymentoptions-3"><code>paymentOptions</code></a>
                        </dt>
                        <dd>
                            传递给对应
                            <a data-link-type="dfn"
                                href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a>
                            构造函数的 paymentOptions 字典的副本。
                        </dd>
                        <dt>
                            <a data-lt="PaymentRequestEvent.shippingOptions"
                                href="#dom-paymentrequestevent-shippingoptions" class="internalDFN" data-link-type="idl"
                                id="ref-for-dom-paymentrequestevent-shippingoptions-2"><code>shippingOptions</code></a>
                        </dt>
                        <dd>
                            来自对应
                            <a data-link-type="dfn"
                                href="https://www.w3.org/TR/payment-request/#paymentdetailsinit-dictionary">PaymentDetailsInit</a>
                            的 shippingOptions 字段副本。
                        </dd>
                    </dl>
                    <p>
                        然后在并行中，以 <var>dispatchedEvent</var> 执行以下步骤：
                    </p>
                    <ol>
                        <li>等待 <var>dispatchedEvent</var> 的所有
                            <a data-link-type="dfn"
                                href="https://www.w3.org/TR/service-workers/#extendableevent-extend-lifetime-promises">扩展生命周期
                                promise</a>
                            均已解决。
                        </li>
                        <li>
                            如果
                            <a href="#dfn-web-based-payment-handler" class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-web-based-payment-handler-8">基于 Web 的支付处理程序</a>
                            未提供
                            <a href="#dom-paymenthandlerresponse" class="internalDFN" data-link-type="idl"
                                id="ref-for-dom-paymenthandlerresponse-4"><code>PaymentHandlerResponse</code></a>，
                            则拒绝由
                            <a data-link-type="interface" data-lt="Promise"
                                href="https://webidl.spec.whatwg.org/#idl-promise"><code>Promise</code></a>
                            （由 <a href="https://www.w3.org/TR/payment-request/#show-method">PaymentRequest.show()</a>
                            创建）
                            并返回
                            "<a data-link-type="exception"
                                href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>"
                            <a data-link-type="interface" data-lt="DOMException"
                                href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a>。
                        </li>
                    </ol>
                </li>
            </ol>
        </section>
    </section>
    <section id="windows">
        <div class="header-wrapper">
            <h2 id="x7-windows"><bdi class="secno">7. </bdi>
                <dfn data-lt="web-based payment handler window|Windows" id="dfn-web-based-payment-handler-window"
                    tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">窗口</dfn>
            </h2><a class="self-link" href="#windows" aria-label="Permalink for Section 7."></a>
        </div>

        <p>
            被调用的基于 Web 的支付处理程序可能需要，也可能不需要，显示自身相关信息或请求用户输入。基于 Web 的支付处理程序可能显示的情况示例包括：
        </p>
        <ul>
            <li>基于 Web 的支付处理程序为用户打开一个窗口，以输入授权码。
            </li>
            <li>基于 Web 的支付处理程序打开一个窗口，让用户可以直接用此前配置的默认信息简便地确认支付。
            </li>
            <li>在某次会话中首次选用该支付处理程序支付时，会打开窗口。之后在同一会话中，如有配置，基于 Web 的支付处理程序可无需打开窗口和用户交互直接完成操作。
            </li>
        </ul>
        <p>
            若<a href="#dfn-web-based-payment-handler" class="internalDFN" data-link-type="dfn"
                id="ref-for-dfn-web-based-payment-handler-9">基于 Web 的支付处理程序</a>需要可视化展示和用户交互，可调用 openWindow() 向用户展示页面。
        </p>
        <div class="note" role="note" id="issue-container-generatedID-1">
            <div role="heading" class="note-title marker" id="h-note-1" aria-level="3"><span>注</span></div>
            <p class="">
                由于用户代理知晓该方法与
                <a data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                    class="internalDFN" id="ref-for-dom-paymentrequestevent-14"><code>PaymentRequestEvent</code></a>
                是相关联的，<em class="rfc2119">应当</em>以合理且不造成用户困惑的方式渲染窗口。最终生成的窗口 client 会绑定到发起
                <a data-link-type="dfn"
                    href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a> 的标签页/窗口。
                单个<a href="#dfn-web-based-payment-handler" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-web-based-payment-handler-10">基于 Web 的支付处理程序</a>
                <em class="rfc2119">不应</em>允许通过该方法打开多个 client 窗口。
            </p>
        </div>
        <section id="open-window-algorithm">
            <div class="header-wrapper">
                <h3 id="x7-1-open-window-algorithm"><bdi class="secno">7.1 </bdi>
                    <dfn id="dfn-open-window-algorithm" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">打开窗口算法</dfn>
                </h3><a class="self-link" href="#open-window-algorithm" aria-label="Permalink for Section 7.1"></a>
            </div>

            <div class="issue closed" id="issue-container-number-115">
                <div role="heading" class="issue-title marker" id="h-issue-1" aria-level="4"><a
                        href="https://github.com/w3c/web-based-payment-handler/issues/115"><span
                            class="issue-number">Issue 115</span></a><span class="issue-label">：打开窗口算法</span></div>
                <p class="">
                    该算法类似于 Service Workers 规范中的<a href="#dfn-open-window-algorithm" class="internalDFN"
                        data-link-type="dfn" id="ref-for-dfn-open-window-algorithm-2">打开窗口算法</a>。
                </p>
            </div>
            <div class="issue closed" id="issue-container-number-115-0">
                <div role="heading" class="issue-title marker" id="h-issue-2" aria-level="4"><a
                        href="https://github.com/w3c/web-based-payment-handler/issues/115"><span
                            class="issue-number">Issue 115</span></a><span class="issue-label">：打开窗口算法</span></div>
                <p class="">
                    我们是否应该直接引用 Service Workers 规范而不是把其步骤复制过来？
                </p>
            </div>
            <ol class="algorithm">
                <li>令 <var>event</var> 为此 <a data-link-type="idl" data-lt="PaymentRequestEvent"
                        href="#dom-paymentrequestevent" class="internalDFN"
                        id="ref-for-dom-paymentrequestevent-15"><code>PaymentRequestEvent</code></a>。
                </li>
                <li>如果 <var>event</var> 的 <a data-link-type="attribute"
                        href="https://dom.spec.whatwg.org/#dom-event-istrusted"><code>isTrusted</code></a> 属性为
                    false，则返回以
                    "<a data-link-type="exception"
                        href="https://webidl.spec.whatwg.org/#invalidstateerror"><code>InvalidStateError</code></a>" <a
                        data-link-type="interface" data-lt="DOMException"
                        href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a>
                    拒绝的 <a data-link-type="interface" data-lt="Promise"
                        href="https://webidl.spec.whatwg.org/#idl-promise"><code>Promise</code></a>。
                </li>
                <li>令 <var>request</var> 为触发此 <a data-link-type="idl" data-lt="PaymentRequestEvent"
                        href="#dom-paymentrequestevent" class="internalDFN"
                        id="ref-for-dom-paymentrequestevent-16"><code>PaymentRequestEvent</code></a>
                    的 <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a>。
                </li>
                <li>令 <var>url</var> 为 <a href="https://url.spec.whatwg.org/#concept-url-parser">解析</a> <var>url</var>
                    参数的结果。
                </li>
                <li>如果 url 解析抛出异常，则返回以该异常拒绝的
                    <a data-link-type="interface" data-lt="Promise"
                        href="https://webidl.spec.whatwg.org/#idl-promise"><code>Promise</code></a>。
                </li>
                <li>若 <var>url</var> 为 <code>about:blank</code>，则返回以
                    <a data-link-type="exception" data-lt="TypeError"
                        href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror"><code>TypeError</code></a>
                    拒绝的 <a data-link-type="interface" data-lt="Promise"
                        href="https://webidl.spec.whatwg.org/#idl-promise"><code>Promise</code></a>。
                </li>
                <li>如果 <var>url</var> 的 origin 与与该基于 Web 的支付处理程序相关联的
                    <a data-link-type="dfn" href="https://www.w3.org/TR/service-workers/#service-worker-concept">service
                        worker</a>
                    的 origin 不同，则返回以 null 解决的
                    <a data-link-type="interface" data-lt="Promise"
                        href="https://webidl.spec.whatwg.org/#idl-promise"><code>Promise</code></a>。
                </li>
                <li>令 <var>promise</var> 为新的
                    <a data-link-type="interface" data-lt="Promise"
                        href="https://webidl.spec.whatwg.org/#idl-promise"><code>Promise</code></a>。
                </li>
                <li>返回 <var>promise</var>，并在并行中执行后续步骤：
                </li>
                <li>若 <var>event</var>.<a data-link-type="attribute" data-lt="[[windowClient]]" href="#dfn-windowclient"
                        class="internalDFN" id="ref-for-dfn-windowclient-1"><code>[[windowClient]]</code></a> 不为 null，则：
                    <ol>
                        <li>若 <var>event</var>.<a data-link-type="attribute" data-lt="[[windowClient]]"
                                href="#dfn-windowclient" class="internalDFN"
                                id="ref-for-dfn-windowclient-2"><code>[[windowClient]]</code></a>.<a
                                href="https://www.w3.org/TR/service-workers/#client-visibilitystate">visibilityState</a>
                            不为 "unloaded"，用
                            "<a data-link-type="exception"
                                href="https://webidl.spec.whatwg.org/#invalidstateerror"><code>InvalidStateError</code></a>"
                            <a data-link-type="interface" data-lt="DOMException"
                                href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a>
                            拒绝 <var>promise</var>，并终止这些步骤。
                        </li>
                    </ol>
                </li>
                <li>令 <var>newContext</var> 为新的
                    <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context">顶级浏览上下文</a>。
                </li>
                <li>
                    用启用异常和启用替换的模式
                    <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate">导航</a>
                    <var>newContext</var> 到 <var>url</var>。
                </li>
                <li>如果导航抛出异常，则以该异常拒绝 <var>promise</var> 并终止这些步骤。
                </li>
                <li>若 <var>newContext</var> 的 origin 与与该基于 Web 的支付处理程序相关联的
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/service-workers/#dfn-service-worker-client">service worker
                        client</a>
                    的 origin 不同，则：
                    <ol>
                        <li>用 null 解决 <var>promise</var>。
                        </li>
                        <li>终止这些步骤。
                        </li>
                    </ol>
                </li>
                <li>令 <var>client</var> 为以 <var>newContext</var> 作为参数，运行
                    <a href="https://www.w3.org/TR/service-workers/#create-windowclient-algorithm">创建窗口 client</a>
                    算法的结果。
                </li>
                <li>设置 <var>event</var>.<a data-link-type="attribute" data-lt="[[windowClient]]"
                        href="#dfn-windowclient" class="internalDFN"
                        id="ref-for-dfn-windowclient-3"><code>[[windowClient]]</code></a> 为 <var>client</var>。
                </li>
                <li>用 <var>client</var> 解决 <var>promise</var>。
                </li>
            </ol>
        </section>
        <section id="post-example" class="informative">
            <div class="header-wrapper">
                <h3 id="x7-2-example-of-handling-the-paymentrequestevent"><bdi class="secno">7.2 </bdi>
                    处理 <a data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                        class="internalDFN" id="ref-for-dom-paymentrequestevent-17"><code>PaymentRequestEvent</code></a>
                    的示例
                </h3><a class="self-link" href="#post-example" aria-label="Permalink for Section 7.2"></a>
            </div>
            <p><em>本节为非规范性内容。</em></p>

            <p>
                此示例展示如何编写一个监听
                <a data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                    class="internalDFN" id="ref-for-dom-paymentrequestevent-18"><code>PaymentRequestEvent</code></a>
                的 service worker。当接收到
                <a data-link-type="idl" data-lt="PaymentRequestEvent" href="#dom-paymentrequestevent"
                    class="internalDFN" id="ref-for-dom-paymentrequestevent-19"><code>PaymentRequestEvent</code></a>
                时，service worker 会打开一个窗口与用户交互。
            </p>
            <div class="example" id="example-handling-the-paymentrequestevent">
                <div class="marker">
                    <a class="self-link" href="#example-handling-the-paymentrequestevent">示例<bdi> 2</bdi></a><span
                        class="example-title">：处理 PaymentRequestEvent</span>
                </div>
                <pre aria-busy="false"><code class="hljs js"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getPaymentResponseFromWindow</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    self.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"message"</span>, listener = <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
      self.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">"message"</span>, listener);
      <span class="hljs-keyword">if</span> (!e.<span class="hljs-property">data</span> || !e.<span class="hljs-property">data</span>.<span class="hljs-property">methodName</span>) {
        <span class="hljs-title function_">reject</span>();
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-title function_">resolve</span>(e.<span class="hljs-property">data</span>);
    });
  });
}

self.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"paymentrequest"</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
  e.<span class="hljs-title function_">respondWith</span>((<span class="hljs-title function_">async</span>() =&gt; {
    <span class="hljs-comment">// Open a new window for providing payment UI to user.</span>
    <span class="hljs-keyword">const</span> windowClient = <span class="hljs-keyword">await</span> e.<span class="hljs-title function_">openWindow</span>(<span class="hljs-string">"payment_ui.html"</span>);

    <span class="hljs-comment">// Send data to the opened window.</span>
    windowClient.<span class="hljs-title function_">postMessage</span>({
      <span class="hljs-attr">total</span>: e.<span class="hljs-property">total</span>,
      <span class="hljs-attr">modifiers</span>: e.<span class="hljs-property">modifiers</span>
    });

    <span class="hljs-comment">// Wait for a payment response from the opened window.</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">getPaymentResponseFromWindow</span>();
  })());
});</code></pre>
            </div>
            <p>
                使用上述简单方案，加载到
                <a href="#dfn-web-based-payment-handler-window" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-web-based-payment-handler-window-1">基于 Web 的支付处理程序窗口</a>
                的一个基础 HTML 页面可能如下所示：
            </p>
            <div class="example" id="example-simple-payment-handler-window">
                <div class="marker">
                    <a class="self-link" href="#example-simple-payment-handler-window">示例<bdi> 3</bdi></a><span
                        class="example-title">：简单的支付处理程序窗口</span>
                </div>
                <pre aria-busy="false"><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"form"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">table</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Cardholder Name:<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"cardholderName"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Card Number:<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"cardNumber"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Expiration Month:<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"expiryMonth"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Expiration Year:<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"expiryYear"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Security Code:<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"cardSecurityCode"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Pay"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">
navigator.<span class="hljs-property">serviceWorker</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"message"</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
  <span class="hljs-comment">/* Note: message sent from payment app is available in e.data */</span>
});

<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"form"</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"submit"</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> details = {};
  [<span class="hljs-string">"cardholderName"</span>, <span class="hljs-string">"cardNumber"</span>, <span class="hljs-string">"expiryMonth"</span>, <span class="hljs-string">"expiryYear"</span>, <span class="hljs-string">"cardSecurityCode"</span>]
  .<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">field</span> =&gt;</span> {
    details[field] = form.<span class="hljs-property">elements</span>[field].<span class="hljs-property">value</span>;
  });

  <span class="hljs-keyword">const</span> paymentAppResponse = {
    <span class="hljs-attr">methodName</span>: <span class="hljs-string">"https://example.com/pay"</span>,
    details
  };

  navigator.<span class="hljs-property">serviceWorker</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">postMessage</span>(paymentAppResponse);
  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">close</span>();
});
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>
            </div>
        </section>
    </section>
    <section id="response">
        <div class="header-wrapper">
            <h2 id="x8-response"><bdi class="secno">8. </bdi>
                响应
            </h2><a class="self-link" href="#response" aria-label="Permalink for Section 8."></a>
        </div>

        <section data-dfn-for="PaymentHandlerResponse" data-link-for="PaymentHandlerResponse"
            id="paymenthandlerresponse-dictionary">
            <div class="header-wrapper">
                <h3 id="x8-1-paymenthandlerresponse-dictionary"><bdi class="secno">8.1 </bdi>
                    <dfn data-export="" data-dfn-type="dictionary" id="dom-paymenthandlerresponse" data-idl="dictionary"
                        data-title="PaymentHandlerResponse" data-dfn-for="" tabindex="0"
                        aria-haspopup="dialog"><code>PaymentHandlerResponse</code></dfn> 字典
                </h3><a class="self-link" href="#paymenthandlerresponse-dictionary"
                    aria-label="Permalink for Section 8.1"></a>
            </div>
            PaymentHandlerResponse 使用以下字典进行传达：
            <pre class="idl def" id="webidl-822477832"><span class="idlHeader"><a class="self-link" href="#webidl-822477832">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-paymenthandlerresponse" data-title="PaymentHandlerResponse">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dom-paymenthandlerresponse" id="ref-for-dom-paymenthandlerresponse-5"><code>PaymentHandlerResponse</code></a> {<span data-idl="" class="idlMember" id="idl-def-paymenthandlerresponse-methodname" data-title="methodName" data-dfn-for="PaymentHandlerResponse"><span class="idlType">
<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymenthandlerresponse-methodname" id="ref-for-dom-paymenthandlerresponse-methodname-1"><code>methodName</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymenthandlerresponse-details" data-title="details" data-dfn-for="PaymentHandlerResponse"><span class="idlType">
<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object">object</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymenthandlerresponse-details" id="ref-for-dom-paymenthandlerresponse-details-1"><code>details</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymenthandlerresponse-payername" data-title="payerName" data-dfn-for="PaymentHandlerResponse"><span class="idlType">
<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a>?</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymenthandlerresponse-payername" id="ref-for-dom-paymenthandlerresponse-payername-1"><code>payerName</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymenthandlerresponse-payeremail" data-title="payerEmail" data-dfn-for="PaymentHandlerResponse"><span class="idlType">
<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a>?</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymenthandlerresponse-payeremail" id="ref-for-dom-paymenthandlerresponse-payeremail-1"><code>payerEmail</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymenthandlerresponse-payerphone" data-title="payerPhone" data-dfn-for="PaymentHandlerResponse"><span class="idlType">
<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a>?</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymenthandlerresponse-payerphone" id="ref-for-dom-paymenthandlerresponse-payerphone-1"><code>payerPhone</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymenthandlerresponse-shippingaddress" data-title="shippingAddress" data-dfn-for="PaymentHandlerResponse"><span class="idlType">
<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#dom-addressinit">AddressInit</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymenthandlerresponse-shippingaddress" id="ref-for-dom-paymenthandlerresponse-shippingaddress-1"><code>shippingAddress</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-paymenthandlerresponse-shippingoption" data-title="shippingOption" data-dfn-for="PaymentHandlerResponse"><span class="idlType">
<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a>?</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymenthandlerresponse-shippingoption" id="ref-for-dom-paymenthandlerresponse-shippingoption-1"><code>shippingOption</code></a>;</span>
};</span></code></pre>
            <section id="methodname-attribute">
                <div class="header-wrapper">
                    <h4 id="x8-1-1-methodname-attribute"><bdi class="secno">8.1.1 </bdi>
                        <dfn data-export="" data-dfn-type="dict-member" id="dom-paymenthandlerresponse-methodname"
                            data-idl="field" data-title="methodName" data-dfn-for="PaymentHandlerResponse"
                            data-type="DOMString" tabindex="0" aria-haspopup="dialog"><code>methodName</code></dfn>
                        属性
                    </h4><a class="self-link" href="#methodname-attribute" aria-label="Permalink for Section 8.1.1"></a>
                </div>

                <p>
                    用户为完成交易所选择的<a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">支付方法标识符</a>，对应于该
                    <a data-link-type="dfn" href="https://www.w3.org/TR/payment-request/#dfn-payment-method">支付方法</a>。
                </p>
            </section>
            <section id="details-attribute">
                <div class="header-wrapper">
                    <h4 id="x8-1-2-details-attribute"><bdi class="secno">8.1.2 </bdi>
                        <dfn data-export="" data-dfn-type="dict-member" id="dom-paymenthandlerresponse-details"
                            data-idl="field" data-title="details" data-dfn-for="PaymentHandlerResponse"
                            data-type="object" tabindex="0" aria-haspopup="dialog"><code>details</code></dfn> 属性
                    </h4><a class="self-link" href="#details-attribute" aria-label="Permalink for Section 8.1.2"></a>
                </div>

                <p>
                    一个<a data-link-type="dfn" href="https://www.w3.org/TR/payment-request/#dfn-json-serialize">可 JSON
                        序列化</a>的对象，
                    提供一条由商户用于处理交易并判断资金转账是否成功的，
                    <a data-link-type="dfn" href="https://www.w3.org/TR/payment-request/#dfn-payment-method">支付方法</a>
                    专有消息。
                </p>
                <p>
                    用户代理通过对应
                    <a data-link-type="idl" href="#dom-paymentrequestevent-respondwith" class="internalDFN"
                        id="ref-for-dom-paymentrequestevent-respondwith-2"><code>respondWith</code></a> 函数
                    所提供 Promise 的解决，从基于 Web 的支付处理程序处收到成功响应。
                    应用需用包含支付响应的
                    <a href="#dom-paymenthandlerresponse" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-paymenthandlerresponse-6"><code>PaymentHandlerResponse</code></a> 实例
                    来解决该 Promise。
                    如遇用户取消或出错，应用可通过拒绝该 Promise 来表示失败。
                </p>
                <p>
                    如果该 Promise 被拒绝，则用户代理<em class="rfc2119">必须</em>运行
                    <dfn id="dfn-payment-app-failure-algorithm" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">支付应用失败算法</dfn>。
                    该算法的具体细节留给各实现者决定。
                    可接受的行为包括但不限于：
                </p>
                <ul>
                    <li>允许用户重试，可以使用同一个基于 Web 的支付处理程序，也可以换一个；
                    </li>
                    <li>拒绝由 <a href="https://www.w3.org/TR/payment-request/#show-method">PaymentRequest.show()</a>
                        创建的 Promise。
                    </li>
                </ul>

            </section>
            <section id="payername-attribute">
                <div class="header-wrapper">
                    <h4 id="x8-1-3-payername-attribute"><bdi class="secno">8.1.3 </bdi>
                        <dfn data-export="" data-dfn-type="dict-member" id="dom-paymenthandlerresponse-payername"
                            data-idl="field" data-title="payerName" data-dfn-for="PaymentHandlerResponse"
                            data-type="DOMString" tabindex="0" aria-haspopup="dialog"><code>payerName</code></dfn>
                        属性
                    </h4><a class="self-link" href="#payername-attribute" aria-label="Permalink for Section 8.1.3"></a>
                </div>

                <p>
                    用户提供的付款人姓名。
                </p>
            </section>
            <section id="payeremail-attribute">
                <div class="header-wrapper">
                    <h4 id="x8-1-4-payeremail-attribute"><bdi class="secno">8.1.4 </bdi>
                        <dfn data-export="" data-dfn-type="dict-member" id="dom-paymenthandlerresponse-payeremail"
                            data-idl="field" data-title="payerEmail" data-dfn-for="PaymentHandlerResponse"
                            data-type="DOMString" tabindex="0" aria-haspopup="dialog"><code>payerEmail</code></dfn>
                        属性
                    </h4><a class="self-link" href="#payeremail-attribute" aria-label="Permalink for Section 8.1.4"></a>
                </div>

                <p>
                    用户提供的付款人电子邮件。
                </p>
            </section>
            <section id="payerphone-attribute">
                <div class="header-wrapper">
                    <h4 id="x8-1-5-payerphone-attribute"><bdi class="secno">8.1.5 </bdi>
                        <dfn data-export="" data-dfn-type="dict-member" id="dom-paymenthandlerresponse-payerphone"
                            data-idl="field" data-title="payerPhone" data-dfn-for="PaymentHandlerResponse"
                            data-type="DOMString" tabindex="0" aria-haspopup="dialog"><code>payerPhone</code></dfn>
                        属性
                    </h4><a class="self-link" href="#payerphone-attribute" aria-label="Permalink for Section 8.1.5"></a>
                </div>

                <p>
                    用户提供的付款人电话号码。
                </p>
            </section>
            <section id="shippingaddress-attribute">
                <div class="header-wrapper">
                    <h4 id="x8-1-6-shippingaddress-attribute"><bdi class="secno">8.1.6 </bdi>
                        <dfn data-export="" data-dfn-type="dict-member" id="dom-paymenthandlerresponse-shippingaddress"
                            data-idl="field" data-title="shippingAddress" data-dfn-for="PaymentHandlerResponse"
                            data-type="AddressInit" tabindex="0"
                            aria-haspopup="dialog"><code>shippingAddress</code></dfn> 属性
                    </h4><a class="self-link" href="#shippingaddress-attribute"
                        aria-label="Permalink for Section 8.1.6"></a>
                </div>

                <p>
                    用户提供的收货地址。
                </p>
            </section>
            <section id="shippingoption-attribute">
                <div class="header-wrapper">
                    <h4 id="x8-1-7-shippingoption-attribute"><bdi class="secno">8.1.7 </bdi>
                        <dfn data-export="" data-dfn-type="dict-member" id="dom-paymenthandlerresponse-shippingoption"
                            data-idl="field" data-title="shippingOption" data-dfn-for="PaymentHandlerResponse"
                            data-type="DOMString" tabindex="0" aria-haspopup="dialog"><code>shippingOption</code></dfn>
                        属性
                    </h4><a class="self-link" href="#shippingoption-attribute"
                        aria-label="Permalink for Section 8.1.7"></a>
                </div>

                <p>
                    用户所选配送选项的标识符。
                </p>
            </section>
        </section>
        <section id="change-payment-method-algorithm">
            <div class="header-wrapper">
                <h3 id="x8-2-change-payment-method-algorithm"><bdi class="secno">8.2 </bdi>
                    <dfn id="dfn-change-payment-method-algorithm" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">变更支付方法算法</dfn>
                </h3><a class="self-link" href="#change-payment-method-algorithm"
                    aria-label="Permalink for Section 8.2"></a>
            </div>

            <p>
                当以 <var>methodName</var> 和 <var>methodDetails</var> 参数调用此算法时，用户代理<em class="rfc2119">MUST</em>运行以下步骤：
            </p>
            <ol class="algorithm">
                <li>以给定的 <var>methodName</var> 和 <var>methodDetails</var> 参数构造
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#dom-paymentmethodchangeevent">PaymentMethodChangeEvent</a>
                    <var>event</var>，并运行
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#payment-method-changed-algorithm">payment method
                        changed algorithm</a>。
                </li>
                <li>如果 <var>event</var> 的
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#updatewith-method">updateWith(detailsPromise)</a>
                    未被运行，则返回 <code>null</code>。
                </li>
                <li>如果 <var>event</var> 的
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#updatewith-method">updateWith(detailsPromise)</a>
                    抛出异常，则重新抛出该错误。
                </li>
                <li>如果 <var>event</var> 的
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#updatewith-method">updateWith(detailsPromise)</a>
                    超时（可选），则抛出
                    "<a data-link-type="exception"
                        href="https://webidl.spec.whatwg.org/#invalidstateerror"><code>InvalidStateError</code></a>"
                    <a data-link-type="interface" data-lt="DOMException"
                        href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a>。
                </li>
                <li>从 <var>event</var>.<a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#updatewith-method">updateWith(detailsPromise)</a>
                    中的 <var>detailsPromise</var> 构造并返回一个
                    <a href="#dom-paymentrequestdetailsupdate" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-paymentrequestdetailsupdate-5"><code>PaymentRequestDetailsUpdate</code></a>。
                </li>
            </ol>
        </section>
        <section id="change-payment-details-algorithm">
            <div class="header-wrapper">
                <h3 id="x8-3-change-payment-details-algorithm"><bdi class="secno">8.3 </bdi>
                    <dfn id="dfn-change-payment-details-algorithm" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">变更支付详情算法</dfn>
                </h3><a class="self-link" href="#change-payment-details-algorithm"
                    aria-label="Permalink for Section 8.3"></a>
            </div>

            <p>
                当以 <var>shippingAddress</var> 或 <var>shippingOption</var> 调用此算法时，用户代理<em
                    class="rfc2119">MUST</em>运行以下步骤：
            </p>
            <ol class="algorithm">
                <li>使用更新后的详情（<var>shippingAddress</var> 或 <var>shippingOption</var>）构造
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#dom-paymentrequestupdateevent">PaymentRequestUpdateEvent</a>
                    <var>event</var>，并运行
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#paymentrequest-updated-algorithm">PaymentRequest
                        updated algorithm</a>。
                </li>
                <li>如果 <var>event</var> 的
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#updatewith-method">updateWith(detailsPromise)</a>
                    未被运行，则返回 <code>null</code>。
                </li>
                <li>如果 <var>event</var> 的
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#updatewith-method">updateWith(detailsPromise)</a>
                    抛出异常，则重新抛出该错误。
                </li>
                <li>如果 <var>event</var> 的
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#updatewith-method">updateWith(detailsPromise)</a>
                    超时（可选），则抛出
                    "<a data-link-type="exception"
                        href="https://webidl.spec.whatwg.org/#invalidstateerror"><code>InvalidStateError</code></a>"
                    <a data-link-type="interface" data-lt="DOMException"
                        href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a>。
                </li>
                <li>从 <var>event</var>.<a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#updatewith-method">updateWith(detailsPromise)</a>
                    中的 <var>detailsPromise</var> 构造并返回一个
                    <a href="#dom-paymentrequestdetailsupdate" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-paymentrequestdetailsupdate-6"><code>PaymentRequestDetailsUpdate</code></a>。
                </li>
            </ol>
        </section>
        <section id="respond-to-paymentrequest-algorithm">
            <div class="header-wrapper">
                <h3 id="x8-4-respond-to-paymentrequest-algorithm"><bdi class="secno">8.4 </bdi>
                    <dfn id="dfn-respond-to-paymentrequest-algorithm" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">响应 PaymentRequest 算法</dfn>
                </h3><a class="self-link" href="#respond-to-paymentrequest-algorithm"
                    aria-label="Permalink for Section 8.4"></a>
            </div>

            <p>
                当以 <var>event</var> 和 <var>handlerResponsePromise</var> 参数调用此算法时，用户代理<em
                    class="rfc2119">MUST</em>运行以下步骤：
            </p>
            <ol class="algorithm">
                <li>如果 <var>event</var> 的 <a data-link-type="attribute"
                        href="https://dom.spec.whatwg.org/#dom-event-istrusted"><code>isTrusted</code></a> 为 false，
                    则抛出 "InvalidStateError"
                    <a data-link-type="interface" data-lt="DOMException"
                        href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a> 并中止这些步骤。
                </li>
                <li>如果 <var>event</var> 的 <a data-link-type="dfn"
                        href="https://dom.spec.whatwg.org/#dispatch-flag">dispatch flag</a> 未设置，则抛出
                    "<a data-link-type="exception"
                        href="https://webidl.spec.whatwg.org/#invalidstateerror"><code>InvalidStateError</code></a>"
                    <a data-link-type="interface" data-lt="DOMException"
                        href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a> 并中止这些步骤。
                </li>
                <li>如果 <var>event</var> 的 <a data-link-type="attribute" data-lt="[[respondWithCalled]]"
                        href="#dfn-respondwithcalled" class="internalDFN"
                        id="ref-for-dfn-respondwithcalled-1"><code>[[respondWithCalled]]</code></a> 为 true，则抛出
                    "<a data-link-type="exception"
                        href="https://webidl.spec.whatwg.org/#invalidstateerror"><code>InvalidStateError</code></a>"
                    <a data-link-type="interface" data-lt="DOMException"
                        href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a> 并中止这些步骤。
                </li>
                <li>将 <var>event</var> 的 <a data-link-type="attribute" data-lt="[[respondWithCalled]]"
                        href="#dfn-respondwithcalled" class="internalDFN"
                        id="ref-for-dfn-respondwithcalled-2"><code>[[respondWithCalled]]</code></a> 设为 true。
                </li>
                <li>设置 <var>event</var> 的 <a data-link-type="dfn"
                        href="https://dom.spec.whatwg.org/#stop-propagation-flag">stop propagation flag</a> 和
                    <var>event</var> 的 <a data-link-type="dfn"
                        href="https://dom.spec.whatwg.org/#stop-immediate-propagation-flag">stop immediate propagation
                        flag</a>。
                </li>
                <li>将 <var>handlerResponsePromise</var> 添加到 <var>event</var> 的
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/service-workers/#extendableevent-extend-lifetime-promises">extend
                        lifetime promises</a> 中。
                </li>
                <li>将 <var>event</var> 的
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/service-workers/#extendableevent-pending-promises-count">pending
                        promises count</a> 增加 1。
                </li>
                <li>
                    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#upon-rejection">当被拒绝时（Upon
                        rejection）</a>，
                    针对 <var>handlerResponsePromise</var>：
                    <ol>
                        <li>运行 <a href="#dfn-payment-app-failure-algorithm" class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-payment-app-failure-algorithm-1">支付应用失败算法</a> 并中止这些步骤。
                        </li>
                    </ol>
                </li>
                <li>
                    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#upon-fulfillment">当被兑现时（Upon
                        fulfillment）</a>，
                    针对 <var>handlerResponsePromise</var>：
                    <ol>
                        <li>令 <var>handlerResponse</var> 为将 <var>value</var>
                            <a data-link-type="dfn"
                                href="https://webidl.spec.whatwg.org/#dfn-convert-ecmascript-to-idl-value">转换为 IDL 值</a>
                            的结果，类型为 <a data-link-type="idl" data-lt="PaymentHandlerResponse"
                                href="#dom-paymenthandlerresponse" class="internalDFN"
                                id="ref-for-dom-paymenthandlerresponse-7"><code>PaymentHandlerResponse</code></a>。若此操作抛出异常，
                            则运行 <a href="#dfn-payment-app-failure-algorithm" class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-payment-app-failure-algorithm-2">支付应用失败算法</a> 并中止这些步骤。
                        </li>
                        <li>校验 <var>handlerResponse</var> 中所有必需成员是否存在且格式正确。
                            <ol>
                                <li>若 <var>handlerResponse</var> 的
                                    <a data-lt="PaymentHandlerResponse.methodName"
                                        href="#dom-paymenthandlerresponse-methodname" class="internalDFN"
                                        data-link-type="idl"
                                        id="ref-for-dom-paymenthandlerresponse-methodname-2"><code>methodName</code></a>
                                    不存在，或未设置为 <var>event</var> 的
                                    <a data-lt="PaymentRequestEvent.methodData"
                                        href="#dom-paymentrequestevent-methoddata" class="internalDFN"
                                        data-link-type="idl"
                                        id="ref-for-dom-paymentrequestevent-methoddata-5"><code>methodData</code></a>
                                    中的某个值，则运行
                                    <a href="#dfn-payment-app-failure-algorithm" class="internalDFN"
                                        data-link-type="dfn"
                                        id="ref-for-dfn-payment-app-failure-algorithm-3">支付应用失败算法</a>
                                    并中止这些步骤。
                                </li>
                                <li>若 <var>handlerResponse</var> 的
                                    <a data-lt="PaymentHandlerResponse.details"
                                        href="#dom-paymenthandlerresponse-details" class="internalDFN"
                                        data-link-type="idl"
                                        id="ref-for-dom-paymenthandlerresponse-details-2"><code>details</code></a>
                                    不存在或不是<a data-link-type="dfn"
                                        href="https://www.w3.org/TR/payment-request/#dfn-json-serialize">可 JSON
                                        序列化</a>的，
                                    则运行 <a href="#dfn-payment-app-failure-algorithm" class="internalDFN"
                                        data-link-type="dfn"
                                        id="ref-for-dfn-payment-app-failure-algorithm-4">支付应用失败算法</a>
                                    并中止这些步骤。
                                </li>
                                <li>令 <var>shippingRequired</var> 为关联的 PaymentRequest 的
                                    <a
                                        href="https://www.w3.org/TR/payment-request/#dom-paymentoptions-requestshipping">requestShipping</a>
                                    取值，来自
                                    <a data-link-type="dfn"
                                        href="https://www.w3.org/TR/payment-request/#dom-paymentoptions">paymentOptions</a>。
                                    如果 <var>shippingRequired</var> 且
                                    <var>handlerResponse</var> 的
                                    <a data-lt="PaymentHandlerResponse.shippingAddress"
                                        href="#dom-paymenthandlerresponse-shippingaddress" class="internalDFN"
                                        data-link-type="idl"
                                        id="ref-for-dom-paymenthandlerresponse-shippingaddress-2"><code>shippingAddress</code></a>
                                    不存在，则运行 <a href="#dfn-payment-app-failure-algorithm" class="internalDFN"
                                        data-link-type="dfn"
                                        id="ref-for-dfn-payment-app-failure-algorithm-5">支付应用失败算法</a> 并中止这些步骤。
                                </li>
                                <li>如果 <var>shippingRequired</var> 且
                                    <var>handlerResponse</var> 的
                                    <a data-lt="PaymentHandlerResponse.shippingOption"
                                        href="#dom-paymenthandlerresponse-shippingoption" class="internalDFN"
                                        data-link-type="idl"
                                        id="ref-for-dom-paymenthandlerresponse-shippingoption-2"><code>shippingOption</code></a>
                                    不存在，或未设置为来自 <var>event</var> 的
                                    <a data-lt="PaymentRequestEvent.shippingOptions"
                                        href="#dom-paymentrequestevent-shippingoptions" class="internalDFN"
                                        data-link-type="idl"
                                        id="ref-for-dom-paymentrequestevent-shippingoptions-3"><code>shippingOptions</code></a>
                                    中的某个配送选项标识符，则运行
                                    <a href="#dfn-payment-app-failure-algorithm" class="internalDFN"
                                        data-link-type="dfn"
                                        id="ref-for-dfn-payment-app-failure-algorithm-6">支付应用失败算法</a>
                                    并中止这些步骤。
                                </li>
                                <li>令 <var>payerNameRequired</var> 为关联的 PaymentRequest 的
                                    <a
                                        href="https://www.w3.org/TR/payment-request/#dom-paymentoptions-requestpayername">requestPayerName</a>
                                    取值，来自
                                    <a data-link-type="dfn"
                                        href="https://www.w3.org/TR/payment-request/#dom-paymentoptions">paymentOptions</a>。
                                    如果 <var>payerNameRequired</var> 且
                                    <var>handlerResponse</var> 的
                                    <a data-lt="PaymentHandlerResponse.payerName"
                                        href="#dom-paymenthandlerresponse-payername" class="internalDFN"
                                        data-link-type="idl"
                                        id="ref-for-dom-paymenthandlerresponse-payername-2"><code>payerName</code></a>
                                    不存在，则运行
                                    <a href="#dfn-payment-app-failure-algorithm" class="internalDFN"
                                        data-link-type="dfn"
                                        id="ref-for-dfn-payment-app-failure-algorithm-7">支付应用失败算法</a>
                                    并中止这些步骤。
                                </li>
                                <li>令 <var>payerEmailRequired</var> 为关联的 PaymentRequest 的
                                    <a
                                        href="https://www.w3.org/TR/payment-request/#dom-paymentoptions-requestpayeremail">requestPayerEmail</a>
                                    取值，来自
                                    <a data-link-type="dfn"
                                        href="https://www.w3.org/TR/payment-request/#dom-paymentoptions">paymentOptions</a>。
                                    如果 <var>payerEmailRequired</var> 且
                                    <var>handlerResponse</var> 的
                                    <a data-lt="PaymentHandlerResponse.payerEmail"
                                        href="#dom-paymenthandlerresponse-payeremail" class="internalDFN"
                                        data-link-type="idl"
                                        id="ref-for-dom-paymenthandlerresponse-payeremail-2"><code>payerEmail</code></a>
                                    不存在，则运行
                                    <a href="#dfn-payment-app-failure-algorithm" class="internalDFN"
                                        data-link-type="dfn"
                                        id="ref-for-dfn-payment-app-failure-algorithm-8">支付应用失败算法</a>
                                    并中止这些步骤。
                                </li>
                                <li>令 <var>payerPhoneRequired</var> 为关联的 PaymentRequest 的
                                    <a
                                        href="https://www.w3.org/TR/payment-request/#dom-paymentoptions-requestpayerphone">requestPayerPhone</a>
                                    取值，来自
                                    <a data-link-type="dfn"
                                        href="https://www.w3.org/TR/payment-request/#dom-paymentoptions">paymentOptions</a>。
                                    如果 <var>payerPhoneRequired</var> 且
                                    <var>handlerResponse</var> 的
                                    <a data-lt="PaymentHandlerResponse.payerPhone"
                                        href="#dom-paymenthandlerresponse-payerphone" class="internalDFN"
                                        data-link-type="idl"
                                        id="ref-for-dom-paymenthandlerresponse-payerphone-2"><code>payerPhone</code></a>
                                    不存在，则运行
                                    <a href="#dfn-payment-app-failure-algorithm" class="internalDFN"
                                        data-link-type="dfn"
                                        id="ref-for-dfn-payment-app-failure-algorithm-9">支付应用失败算法</a>
                                    并中止这些步骤。
                                </li>
                            </ol>
                        </li>
                        <li>序列化 <var>handlerResponse</var> 的必需成员（<var>methodName</var> 与 <var>details</var> 始终必需；
                            当 <var>shippingRequired</var> 为 true 时，<var>shippingAddress</var> 与
                            <var>shippingOption</var> 必需；
                            当 <var>payerNameRequired</var>、<var>payerEmailRequired</var>、<var>payerPhoneRequired</var>
                            分别为 true 时，<var>payerName</var>、<var>payerEmail</var>、<var>payerPhone</var> 必需）：
                            <ol>
                                <li>对 <var>handlerResponse</var> 中的每个 <var>member</var>，令
                                    <var>serializeMember</var> 为调用
                                    <a
                                        href="https://html.spec.whatwg.org/multipage/#structuredserialize">StructuredSerialize</a>
                                    处理 <var>handlerResponse</var>.<var>member</var> 的结果。若有异常则重新抛出。
                                </li>
                            </ol>
                        </li>
                        <li>用户代理<em class="rfc2119">MUST</em>运行 [<cite><a class="bibref" data-link-type="biblio"
                                    href="#bib-payment-request" title="Payment Request API">payment-request</a></cite>]
                            中定义的
                            <a data-link-type="dfn"
                                href="https://www.w3.org/TR/payment-request/#user-accepts-the-payment-request-algorithm">user
                                accepts the payment request algorithm</a>，并以以下步骤替换其第 9-15 步或其等效步骤。
                            <ol>
                                <li>反序列化已序列化的成员：
                                    <ol>
                                        <li>对每个 <var>serializeMember</var>，令 <var>member</var> 为调用
                                            <a
                                                href="https://html.spec.whatwg.org/multipage/#structureddeserialize">StructuredDeserialize</a>
                                            处理 <var>serializeMember</var> 的结果。若有异常则重新抛出。
                                        </li>
                                    </ol>
                                </li>
                                <li>如果上述步骤中出现任何异常，则运行
                                    <a href="#dfn-payment-app-failure-algorithm" class="internalDFN"
                                        data-link-type="dfn"
                                        id="ref-for-dfn-payment-app-failure-algorithm-10">支付应用失败算法</a>
                                    并中止这些步骤。
                                </li>
                                <li>将 <var>methodName</var> 赋予关联 PaymentRequest 的
                                    <a data-lt="PaymentResponse" data-link-type="dfn"
                                        href="https://www.w3.org/TR/payment-request/#dom-paymentresponse"><var>response</var></a>.<a
                                        href="https://www.w3.org/TR/payment-request/#dom-paymentresponse-methodname">methodName</a>。
                                </li>
                                <li>将 <var>details</var> 赋予关联 PaymentReqeust 的
                                    <a data-lt="PaymentResponse" data-link-type="dfn"
                                        href="https://www.w3.org/TR/payment-request/#dom-paymentresponse"><var>response</var></a>.<a
                                        href="https://www.w3.org/TR/payment-request/#dom-paymentresponse-details">details</a>。
                                </li>
                                <li>若 <var>shippingRequired</var>，则将关联 PaymentReqeust 的
                                    <a
                                        href="https://www.w3.org/TR/payment-request/#dom-paymentresponse-shippingaddress">
                                        shippingAddress</a> 属性设为 <var>shippingAddress</var>；否则设为 null。
                                </li>
                                <li>若 <var>shippingRequired</var>，则将关联 PaymentReqeust 的
                                    <a href="https://www.w3.org/TR/payment-request/#dom-paymentresponse-shippingoption">
                                        shippingOption</a> 属性设为 <var>shippingOption</var>；否则设为 null。
                                </li>
                                <li>若 <var>payerNameRequired</var>，则将关联 PaymentReqeust 的
                                    <a href="https://www.w3.org/TR/payment-request/#dom-paymentresponse-payername">
                                        payerName</a> 属性设为 <var>payerName</var>；否则设为 null。
                                </li>
                                <li>若 <var>payerEmailRequired</var>，则将关联 PaymentReqeust 的
                                    <a
                                        href="https://www.w3.org/TR/payment-request/#dom-paymentresponse-payeremail">payerEmail</a>
                                    属性设为 <var>payerEmail</var>；否则设为 null。
                                </li>
                                <li>若 <var>payerPhoneRequired</var>，则将关联 PaymentReqeust 的
                                    <a
                                        href="https://www.w3.org/TR/payment-request/#dom-paymentresponse-payerphone">payerPhone</a>
                                    属性设为 <var>payerPhone</var>；否则设为 null。
                                </li>
                            </ol>
                        </li>
                    </ol>
                </li>
                <li>
                    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#upon-fulfillment">当被兑现（Upon
                        fulfillment）</a>或
                    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#upon-rejection">当被拒绝（upon
                        rejection）</a>
                    <var>handlerResponsePromise</var> 时，
                    <a href="https://html.spec.whatwg.org/multipage/#queue-a-microtask">将一个微任务排入队列</a>以执行以下步骤：
                    <ol>
                        <li>将 <var>event</var> 的
                            <a data-link-type="dfn"
                                href="https://www.w3.org/TR/service-workers/#extendableevent-pending-promises-count">pending
                                promises count</a> 减一。
                        </li>
                        <li>令 <var>registration</var> 为 <a data-link-type="dfn"
                                href="https://webidl.spec.whatwg.org/#this">this</a> 的
                            <a data-link-type="dfn"
                                href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">相关全局对象</a>
                            所关联的
                            <a data-link-type="dfn"
                                href="https://www.w3.org/TR/service-workers/#service-worker-concept">service
                                worker</a> 的
                            <a data-link-type="dfn"
                                href="https://www.w3.org/TR/service-workers/#dfn-containing-service-worker-registration">containing
                                service worker registration</a>。
                        </li>
                        <li>如果 <var>registration</var> 不为 null，则以 <var>registration</var> 调用
                            <a data-link-type="dfn"
                                href="https://www.w3.org/TR/service-workers/#try-activate-algorithm">Try
                                Activate</a>。
                        </li>
                    </ol>
                </li>
            </ol>
            <p>
                以下示例展示如何响应支付请求：
            </p>
            <div class="example" id="example-sending-a-payment-response">
                <div class="marker">
                    <a class="self-link" href="#example-sending-a-payment-response">示例<bdi> 4</bdi></a><span
                        class="example-title">：发送支付响应</span>
                </div>
                <pre aria-busy="false"><code class="hljs js">paymentRequestEvent.<span class="hljs-title function_">respondWith</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">accept,reject</span>) {
  <span class="hljs-comment">/* ... processing may occur here ... */</span>
  <span class="hljs-title function_">accept</span>({
    <span class="hljs-attr">methodName</span>: <span class="hljs-string">"https://example.com/pay"</span>,
    <span class="hljs-attr">details</span>: {
      <span class="hljs-attr">cardHolderName</span>:   <span class="hljs-string">"John Smith"</span>,
      <span class="hljs-attr">cardNumber</span>:       <span class="hljs-string">"1232343451234"</span>,
      <span class="hljs-attr">expiryMonth</span>:      <span class="hljs-string">"12"</span>,
      expiryYear :      <span class="hljs-string">"2020"</span>,
      <span class="hljs-attr">cardSecurityCode</span>: <span class="hljs-string">"123"</span>
     },
    <span class="hljs-attr">shippingAddress</span>: {
      <span class="hljs-attr">addressLine</span>: [
        <span class="hljs-string">"1875 Explorer St #1000"</span>,
      ],
      <span class="hljs-attr">city</span>: <span class="hljs-string">"Reston"</span>,
      <span class="hljs-attr">country</span>: <span class="hljs-string">"US"</span>,
      <span class="hljs-attr">dependentLocality</span>: <span class="hljs-string">""</span>,
      <span class="hljs-attr">organization</span>: <span class="hljs-string">""</span>,
      <span class="hljs-attr">phone</span>: <span class="hljs-string">"+15555555555"</span>,
      <span class="hljs-attr">postalCode</span>: <span class="hljs-string">"20190"</span>,
      <span class="hljs-attr">recipient</span>: <span class="hljs-string">"John Smith"</span>,
      <span class="hljs-attr">region</span>: <span class="hljs-string">"VA"</span>,
      <span class="hljs-attr">sortingCode</span>: <span class="hljs-string">""</span>
    },
    <span class="hljs-attr">shippingOption</span>: <span class="hljs-string">"express"</span>,
    <span class="hljs-attr">payerEmail</span>: <span class="hljs-string">"john.smith@gmail.com"</span>,
  });
}));</code></pre>
            </div>
            <div class="note" role="note" id="issue-container-generatedID-2">
                <div role="heading" class="note-title marker" id="h-note-2" aria-level="4"><span>注意</span></div>
                <p class="">
                    [<cite><a class="bibref" data-link-type="biblio" href="#bib-payment-request"
                            title="Payment Request API">payment-request</a></cite>] 定义了一个 <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-request/#id-attribute">ID</a>，生态系统中的各方（包括支付应用提供方和收款方）可在网络或其他故障后使用其进行对账。
                </p>
            </div>
        </section>
    </section>

    <section id="security">
        <div class="header-wrapper">
            <h2 id="x9-security-and-privacy-considerations"><bdi class="secno">9. </bdi>
                安全与隐私注意事项
            </h2><a class="self-link" href="#security" aria-label="Permalink for Section 9."></a>
        </div>

        <section id="addresses">
            <div class="header-wrapper">
                <h3 id="x9-1-addresses"><bdi class="secno">9.1 </bdi>地址</h3><a class="self-link" href="#addresses"
                    aria-label="Permalink for Section 9.1"></a>
            </div>

            <p>
                由于隐私问题，Web Payments 工作组从最初版本的 Payment Request API 中移除了对收货地址和账单地址的支持；参见
                <a href="https://github.com/w3c/payment-request/issues/842">issue
                    842</a>。为给仍继续支持此能力的实现提供文档，工作组现正恢复该功能，并期望同时解决隐私问题。在此过程中，工作组也可能基于其他 API 的演进（例如 Content Picker API）对
                Payment Request API 进行更改。
            </p>
        </section>
        <section id="information-about-the-user-environment">
            <div class="header-wrapper">
                <h3 id="x9-2-information-about-the-user-environment"><bdi class="secno">9.2 </bdi>
                    有关用户环境的信息
                </h3><a class="self-link" href="#information-about-the-user-environment"
                    aria-label="Permalink for Section 9.2"></a>
            </div>

            <ul>
                <li>该 API 不会共享用户已注册的基于 Web 的支付处理程序信息。
                    只有在用户同意的情况下，来源(origin)的信息才会与收款方共享。
                </li>
                <li>在用户选择某个支付处理程序之前，用户代理不应与任何基于 Web 的支付处理程序共享支付请求信息。
                </li>
                <li>在支持 Web-based Payment Handler API 的浏览器中，
                    当商户用基于 URL 的支付方式标识符创建 PaymentRequest 对象时，
                    一个 <a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-canmakepaymentevent-12"><code>CanMakePaymentEvent</code></a> 会在已注册的
                    基于 Web 的支付处理程序里被触发，这些处理程序来源于一组有限的来源：
                    即支付方式清单(origin)以及其
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-method-manifest/#parsed-payment-method-manifest-supported-origins">支持的来源</a>。
                    该事件会在用户选择该支付处理程序之前触发，
                    但事件中不含任何触发源信息（即商户网站），因此不能直接用于用户跟踪。
                </li>
                <li>我们意识到通过
                    <a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-canmakepaymentevent-13"><code>CanMakePaymentEvent</code></a>
                    存在时序攻击(timing attack)的风险：
                    <ul>
                        <li>商户网站通过后端通道（如 fetch API）向某个基于 Web 的支付处理程序 origin 发送通知，表示即将创建 PaymentRequest 对象；</li>
                        <li>随后商户网站创建 PaymentRequest，对应的
                            <a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                                id="ref-for-dom-canmakepaymentevent-14"><code>CanMakePaymentEvent</code></a>
                            会在已安装的基于 Web 的支付处理程序中被触发；
                        </li>
                        <li>该基于 Web 的支付处理程序联系其自身的 origin，服务器端试图关联这两次请求。</li>
                    </ul>
                </li>
                <li>用户代理应允许用户禁用
                    <a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-canmakepaymentevent-15"><code>CanMakePaymentEvent</code></a> 的支持。
                </li>
                <li>在支持 Web-based Payment Handler API 的浏览器中，
                    只要需要，包括收货地址和付款人联系方式在内，
                    <a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-canmakepaymentevent-16"><code>CanMakePaymentEvent</code></a>
                    会被触发给能提供全部商户请求信息的已注册基于 Web 的支付处理程序。
                </li>
            </ul>
        </section>
        <section id="user-consent-to-install">
            <div class="header-wrapper">
                <h3 id="x9-3-user-consent-to-install-a-payment-handler"><bdi class="secno">9.3 </bdi>
                    用户同意安装支付处理程序
                </h3><a class="self-link" href="#user-consent-to-install" aria-label="Permalink for Section 9.3"></a>
            </div>

            <ul>
                <li>本规范未定义用户代理在首次注册基于 Web 的支付处理程序时如何征得用户同意。
                    用户代理可以在注册过程中通知和/或提示用户。
                </li>
                <li>用户代理<em class="rfc2119">可以</em>因安全原因（例如 SSL 证书无效）拒绝注册基于 Web 的支付处理程序，并且<em class="rfc2119">应当</em>
                    在发生此类情况时通知用户。
                </li>
            </ul>
        </section>
        <section id="user-consent-before-payment">
            <div class="header-wrapper">
                <h3 id="x9-4-user-consent-before-payment"><bdi class="secno">9.4 </bdi>
                    付款前的用户同意
                </h3><a class="self-link" href="#user-consent-before-payment"
                    aria-label="Permalink for Section 9.4"></a>
            </div>

            <ul>
                <li>本规范的目标之一是在支付时最小化用户交互。
                    但我们也要确保用户有机会同意付款。
                    由于基于 Web 的支付处理程序不一定要为用户交互打开窗口，
                    用户代理应采取必要措施确保用户 (1) 在支付请求被调用时能够知晓，
                    并且 (2) 在商户收到该支付处理程序响应前，有机会与基于 Web 的支付处理程序进行交互。
                </li>
            </ul>
        </section>
        <section id="user-awareness-about-sharing-data-cross-origin">
            <div class="header-wrapper">
                <h3 id="x9-5-user-awareness-about-sharing-data-cross-origin"><bdi class="secno">9.5 </bdi>
                    用户对跨源共享数据的认知
                </h3><a class="self-link" href="#user-awareness-about-sharing-data-cross-origin"
                    aria-label="Permalink for Section 9.5"></a>
            </div>

            <ul>
                <li>根据设计，来自一个来源的基于 Web 的支付处理程序可以与另一个来源
                    （例如商户网站）共享数据。
                </li>
                <li>为防止网络钓鱼攻击，用户代理应向用户明确展示
                    基于 Web 的支付处理程序的来源。
                </li>
                <li>用户代理应帮助用户理解他们正在进行跨来源信息共享，
                    并且最好明确哪些信息将被共享。
                </li>
            </ul>
        </section>
        <section id="secure-communications">
            <div class="header-wrapper">
                <h3 id="x9-6-secure-communications"><bdi class="secno">9.6 </bdi>
                    安全通信
                </h3><a class="self-link" href="#secure-communications" aria-label="Permalink for Section 9.6"></a>
            </div>

            <ul>
                <li>参见 <a href="https://www.w3.org/TR/service-workers/#security-considerations">Service Worker
                        安全注意事项</a>
                </li>
                <li>支付方式的安全性不在本规范范围之内，由支持这些支付方式的基于 Web 的支付处理程序自行处理。
                </li>
            </ul>
        </section>
        <section id="authorized-payment-apps">
            <div class="header-wrapper">
                <h3 id="x9-7-authorized-payment-apps"><bdi class="secno">9.7 </bdi>
                    授权的支付应用
                </h3><a class="self-link" href="#authorized-payment-apps" aria-label="Permalink for Section 9.7"></a>
            </div>

            <ul>
                <li>支付方式的责任方通过
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-method-manifest/#payment-method-manifest">支付方式清单</a>
                    授权支付应用。详情参见
                    <a href="#dfn-handling-a-canmakepaymentevent" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-handling-a-canmakepaymentevent-1">处理 CanMakePaymentEvent</a> 算法。
                </li>
                <li>用户代理没有义务提供存在安全风险的基于 Web 的支付处理程序。这些安全风险可能包括：
                    <ul>
                        <li>证书已过期、已吊销、自签名等情况。</li>
                        <li>混合内容</li>
                        <li>通过 HTTPS 可访问的页面跳转至非 HTTPS 页面。</li>
                        <li>支付处理程序在安全浏览数据库中被认定为恶意。</li>
                    </ul>
                    <p>
                        当某个基于 Web 的支付处理程序由于安全原因不可用时，
                        用户代理应通过（如控制台消息）向开发者提供原因，
                        也可以通知用户以帮助避免混淆。
                    </p>
                </li>
            </ul>
        </section>
        <section id="supported-origin">
            <div class="header-wrapper">
                <h3 id="x9-8-supported-origin"><bdi class="secno">9.8 </bdi>
                    支持的来源
                </h3><a class="self-link" href="#supported-origin" aria-label="Permalink for Section 9.8"></a>
            </div>

            <ul>
                <li>
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-method-manifest/#payment-method-manifest">支付方式清单</a>
                    授权特定来源发布某种支付方式的支付应用。
                    当用户代理判断一个基于 Web 的支付处理程序是否与
                    <a data-link-type="dfn"
                        href="https://www.w3.org/TR/payment-method-manifest/#payment-method-manifest">支付方式清单</a>
                    中列出的来源匹配时，用户代理会使用该支付处理程序
                    <a href="#dfn-service-worker-registration" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-service-worker-registration-2">Service Worker 注册</a>
                    的 scope URL。
                </li>
            </ul>
        </section>
        <section id="data-validation">
            <div class="header-wrapper">
                <h3 id="x9-9-data-validation"><bdi class="secno">9.9 </bdi>
                    数据验证
                </h3><a class="self-link" href="#data-validation" aria-label="Permalink for Section 9.9"></a>
            </div>

            <ul>
                <li>为缓解被劫持的收款方站点向其服务器提交欺诈或格式错误的支付方法数据（或相应的支付请求数据）的情形，收款方服务器应验证数据格式，并将数据与服务器上的权威信息进行关联，例如可接受的支付方法、总额、显示项以及收货地址。
                </li>
            </ul>
        </section>
        <section id="private-browsing-mode">
            <div class="header-wrapper">
                <h3 id="x9-10-private-browsing-mode"><bdi class="secno">9.10 </bdi>
                    私密浏览模式
                </h3><a class="self-link" href="#private-browsing-mode" aria-label="Permalink for Section 9.10"></a>
            </div>

            <ul>
                <li>当在“隐私浏览模式”下调用 Payment Request API 时，
                    用户代理应在私有上下文中启动基于 Web 的支付处理程序。
                    这一般会阻止站点访问任何先前存储的信息，
                    这通常需要用户重新登录该来源或重新输入支付信息。
                </li>
                <li><a href="#dom-canmakepaymentevent" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-canmakepaymentevent-17"><code>CanMakePaymentEvent</code></a>
                    事件不应在隐私浏览模式下触发。
                    用户代理应表现得如同
                    <a data-lt="CanMakePaymentEvent.respondWith()" href="#dom-canmakepaymentevent-respondwith"
                        class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-canmakepaymentevent-respondwith-3"><code>respondWith()</code></a>
                    被以 <code>false</code> 调用一样。
                    但我们也承认一个相关的风险：如果某个实体同时控制 Payment Request API
                    调用的来源和基于 Web 的支付处理程序的来源，
                    则其可能能够推断用户处于隐私浏览模式。
                </li>
            </ul>
        </section>
    </section>
    <section id="display" class="informative">
        <div class="header-wrapper">
            <h2 id="x10-payment-handler-display-considerations"><bdi class="secno">10. </bdi>
                支付处理程序显示注意事项
            </h2><a class="self-link" href="#display" aria-label="Permalink for Section 10."></a>
        </div>
        <p><em>本节为非规范性内容。</em></p>

        <p>
            在排序基于 Web 的支付处理程序时，
            用户代理应优先遵循用户偏好，而非其他偏好。
            用户代理应允许手动配置，例如为某个来源或所有来源
            设置基于 Web 的支付处理程序显示顺序的首选项。
        </p>
        <p>
            用户体验细节留给实现者决定。
        </p>
    </section>
    <section id="dependencies">
        <div class="header-wrapper">
            <h2 id="x11-dependencies"><bdi class="secno">11. </bdi>
                依赖关系
            </h2><a class="self-link" href="#dependencies" aria-label="Permalink for Section 11."></a>
        </div>

        <p>
            本规范依赖于若干其他底层规范。
        </p>
        <dl>
            <dt>
                Payment Request API
            </dt>
            <dd>
                术语 <dfn data-lt="payment methods" id="dfn-payment-methods" class="externalDFN" data-no-export=""
                    data-dfn-type="dfn"><a href="https://www.w3.org/TR/payment-request/#dfn-payment-method">payment
                        method</a></dfn>、
                <dfn id="dfn-paymentrequest" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#dom-paymentrequest">PaymentRequest</a></dfn>、
                <dfn id="dfn-paymentresponse" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#dom-paymentresponse">PaymentResponse</a></dfn>、
                <dfn id="dfn-supportedmethods" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#dom-paymentmethoddata-supportedmethods">supportedMethods</a></dfn>、
                <dfn id="dfn-paymentcurrencyamount" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#paymentcurrencyamount-dictionary">PaymentCurrencyAmount</a></dfn>、
                <dfn id="dfn-paymentdetailsmodifier" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#paymentdetailsmodifier-dictionary">paymentDetailsModifier</a></dfn>、
                <dfn id="dfn-paymentdetailsinit" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#paymentdetailsinit-dictionary">paymentDetailsInit</a></dfn>、
                <dfn id="dfn-paymentdetailsbase" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#paymentdetailsbase-dictionary">paymentDetailsBase</a></dfn>、
                <dfn id="dfn-paymentmethoddata" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#paymentmethoddata-dictionary">PaymentMethodData</a></dfn>、
                <dfn id="dfn-paymentoptions" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#dom-paymentoptions">PaymentOptions</a></dfn>、
                <dfn id="dfn-paymentshippingoption" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#dom-paymentshippingoption">PaymentShippingOption</a></dfn>、
                <dfn id="dfn-addressinit" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#dom-addressinit">AddressInit</a></dfn>、
                <dfn id="dfn-addresserrors" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#dom-addresserrors">AddressErrors</a></dfn>、
                <dfn id="dfn-paymentmethodchangeevent" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#dom-paymentmethodchangeevent">PaymentMethodChangeEvent</a></dfn>、
                <dfn id="dfn-paymentrequestupdateevent" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#dom-paymentrequestupdateevent">PaymentRequestUpdateEvent</a></dfn>、
                <dfn id="dfn-id" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#id-attribute">ID</a></dfn>、
                <dfn id="dfn-canmakepayment" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#canmakepayment-method">canMakePayment()</a></dfn>、
                <dfn id="dfn-show" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#show-method">show()</a></dfn>、
                <dfn id="dfn-updatewith-detailspromise" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#updatewith-method">updateWith(detailsPromise)</a></dfn>、
                <dfn id="dfn-user-accepts-the-payment-request-algorithm" class="externalDFN" data-no-export=""
                    data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#user-accepts-the-payment-request-algorithm">user
                        accepts the payment request algorithm</a></dfn>、<dfn id="dfn-payment-method-changed-algorithm"
                    class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#payment-method-changed-algorithm">payment method
                        changed algorithm</a></dfn>、<dfn id="dfn-paymentrequest-updated-algorithm" class="externalDFN"
                    data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#paymentrequest-updated-algorithm">PaymentRequest
                        updated algorithm</a></dfn> 以及 <dfn id="dfn-json-serializable" class="externalDFN"
                    data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-request/#dfn-json-serialize">JSON-serializable</a></dfn>，均由
                Payment Request API 规范
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-payment-request"
                        title="Payment Request API">payment-request</a></cite>] 定义。
            </dd>
            <dt>
                ECMAScript
            </dt>
            <dd>
                术语 <dfn id="dfn-internal-slot" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://tc39.es/ecma262/multipage/#sec-object-internal-methods-and-internal-slots">internal
                        slot</a></dfn> 与
                <code><dfn id="dfn-json-stringify" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a href="https://tc39.es/ecma262/multipage/#sec-json.stringify">JSON.stringify</a></dfn></code>
                由
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-ecmascript"
                        title="ECMAScript Language Specification">ECMASCRIPT</a></cite>] 定义。
            </dd>
            <dt>
                Payment Method Manifest
            </dt>
            <dd>
                术语 <dfn data-lt="payment method manifests" id="dfn-payment-method-manifests" class="externalDFN"
                    data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-method-manifest/#payment-method-manifest">payment method
                        manifest</a></dfn>、<dfn data-lt="ingested" id="dfn-ingested" class="externalDFN"
                    data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-method-manifest/#ingest-payment-method-manifests">ingest
                        payment method manifest</a></dfn>、<dfn data-lt="parsed" id="dfn-parsed" class="externalDFN"
                    data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-method-manifest/#parsed-payment-method-manifest">parsed
                        payment method manifest</a></dfn> 与 <dfn id="dfn-supported-origins" class="externalDFN"
                    data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/payment-method-manifest/#parsed-payment-method-manifest-supported-origins">
                        supported origins</a></dfn>，由 Payment Method Manifest 规范
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-payment-method-manifest"
                        title="Payment Method Manifest">payment-method-manifest</a></cite>] 定义。
            </dd>
            <dt>
                Service Workers
            </dt>
            <dd>
                术语 <dfn id="dfn-service-worker" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/service-workers/#service-worker-concept">service worker</a></dfn>、
                <dfn id="dfn-service-worker-registration" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">service worker registration</dfn>、
                <dfn id="dfn-service-worker-client" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/service-workers/#dfn-service-worker-client">service
                        worker client</a></dfn>、
                <code><dfn id="dom-serviceworkerregistration" data-idl="interface" data-title="ServiceWorkerRegistration" data-dfn-for="" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a href="https://www.w3.org/TR/service-workers/#service-worker-registration-concept">ServiceWorkerRegistration</a></dfn></code>、
                <code><dfn id="dom-serviceworkerglobalscope" data-idl="interface" data-title="ServiceWorkerGlobalScope" data-dfn-for="" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a href="https://www.w3.org/TR/service-workers/#serviceworkerglobalscope-interface">ServiceWorkerGlobalScope</a></dfn></code>、
                <dfn id="dfn-fire-functional-event" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/service-workers/#fire-functional-event-algorithm">fire
                        functional event</a></dfn>、<dfn id="dfn-extend-lifetime-promises" class="externalDFN"
                    data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/service-workers/#extendableevent-extend-lifetime-promises">extend
                        lifetime
                        promises</a></dfn>、<dfn id="dfn-pending-promises-count" class="externalDFN" data-no-export=""
                    data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/service-workers/#extendableevent-pending-promises-count">pending
                        promises
                        count</a></dfn>、<dfn id="dfn-containing-service-worker-registration" class="externalDFN"
                    data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/service-workers/#dfn-containing-service-worker-registration">containing
                        service worker registration</a></dfn>、
                <dfn id="dfn-try-clear-registration" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/service-workers/#try-clear-registration-algorithm">Try
                        Clear Registration</a></dfn>、<dfn id="dfn-try-activate" class="externalDFN" data-no-export=""
                    data-dfn-type="dfn"><a href="https://www.w3.org/TR/service-workers/#try-activate-algorithm">Try
                        Activate</a></dfn>、
                <dfn id="dfn-extendableevent" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/service-workers/#extendableevent-interface">ExtendableEvent</a></dfn>、
                <dfn id="dfn-extendableeventinit" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/service-workers/#dictdef-extendableeventinit">ExtendableEventInit</a></dfn>、
                和 <dfn id="dfn-scope-url" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a
                        href="https://www.w3.org/TR/service-workers/#dfn-scope-url">scope URL</a></dfn>
                定义见
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-service-workers"
                        title="Service Workers Nightly">SERVICE-WORKERS</a></cite>]。
            </dd>
        </dl>
    </section>
    <section id="conformance">
        <div class="header-wrapper">
            <h2 id="x12-conformance"><bdi class="secno">12. </bdi>一致性</h2><a class="self-link" href="#conformance"
                aria-label="Permalink for Section 12."></a>
        </div>
        <p>除了标记为非规范性的章节外，本规范中的所有编写指南、图表、示例和注记均为非规范性内容。除此之外，本规范中的其他内容均为规范性内容。</p>
        <p>
            本文档中的关键词 <em class="rfc2119">MAY</em>、<em class="rfc2119">MUST</em>、<em class="rfc2119">SHOULD</em>、
            和 <em class="rfc2119">SHOULD NOT</em>
            的解释方式如
            <a href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119"
                    title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a
                    class="bibref" data-link-type="biblio" href="#bib-rfc8174"
                    title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
            所述，仅当且仅当这些词以此处所示的全大写形式出现时适用。
        </p>
        <p>
            只有一种产品类别可以宣称符合本规范：<dfn data-lt="user agents|user agent" id="dfn-user-agents" tabindex="0"
                aria-haspopup="dialog" data-dfn-type="dfn">用户代理</dfn>。
        </p>
        <p>
            只要最终结果与按照本规范算法所得结果不可区分，用户代理<em class="rfc2119">MAY</em>以任何期望的方式实现本规范中给出的算法。
        </p>
        <p>
            用户代理<em class="rfc2119">MAY</em>对原本无限制的输入施加与实现相关的限制，例如为了防止拒绝服务攻击、避免内存耗尽或绕开平台特定限制。当某个输入超出与实现相关的限制时，用户代理<em
                class="rfc2119">MUST</em>抛出，或在 promise 的上下文中以
            <a data-link-type="exception" data-lt="TypeError"
                href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror"><code>TypeError</code></a>
            拒绝，并可选择性地告知开发者该输入如何超出了与实现相关的限制。
        </p>
    </section>
    <section class="appendix" id="idl-index">
        <div class="header-wrapper">
            <h2 id="a-idl-index"><bdi class="secno">A. </bdi>IDL 索引</h2><a class="self-link" href="#idl-index"
                aria-label="Permalink for Appendix A."></a>
        </div>
        <pre class="idl def" id="actual-idl-index"><span class="idlHeader"><a class="self-link" href="#actual-idl-index">WebIDL</a></span><code><span data-idl="" class="idlInterface" data-title="ServiceWorkerRegistration">partial interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-serviceworkerregistration"><code>ServiceWorkerRegistration</code></a> {<span data-idl="" class="idlAttribute" data-title="paymentManager" data-dfn-for="ServiceWorkerRegistration">
  [<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject">SameObject</a></span>] readonly attribute<span class="idlType"> <a data-link-type="idl" href="#dom-paymentmanager" class="internalDFN" id="ref-for-dom-paymentmanager-5"><code>PaymentManager</code></a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-serviceworkerregistration-paymentmanager" id="ref-for-dom-serviceworkerregistration-paymentmanager-2"><code>paymentManager</code></a>;</span>
};</span>

<span data-idl="" class="idlInterface" data-title="PaymentManager">[<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>, <span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=(Window)</span>]
interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-paymentmanager" id="ref-for-dom-paymentmanager-6"><code>PaymentManager</code></a> {<span data-idl="" class="idlAttribute" data-title="userHint" data-dfn-for="PaymentManager">
  attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentmanager-userhint" id="ref-for-dom-paymentmanager-userhint-2"><code>userHint</code></a>;</span><span data-idl="" class="idlMethod" data-title="enableDelegations" data-dfn-for="PaymentManager"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-paymentmanager-enabledelegations" id="ref-for-dom-paymentmanager-enabledelegations-2"><code>enableDelegations</code></a>(<span class="idlType"><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="#dom-paymentdelegation" class="internalDFN" id="ref-for-dom-paymentdelegation-4"><code>PaymentDelegation</code></a>&gt;</span> <span class="idlParamName">delegations</span>);</span>
};</span>

<span data-idl="" class="idlEnum" data-title="PaymentDelegation">enum <a class="internalDFN idlID" data-link-type="enum" href="#dom-paymentdelegation" id="ref-for-dom-paymentdelegation-5"><code>PaymentDelegation</code></a> {
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-paymentdelegation-shippingaddress" id="ref-for-dom-paymentdelegation-shippingaddress-2"><code>shippingAddress</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-paymentdelegation-payername" id="ref-for-dom-paymentdelegation-payername-2"><code>payerName</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-paymentdelegation-payerphone" id="ref-for-dom-paymentdelegation-payerphone-2"><code>payerPhone</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-paymentdelegation-payeremail" id="ref-for-dom-paymentdelegation-payeremail-2"><code>payerEmail</code></a>"</span>
};</span>

<span data-idl="" class="idlInterface" data-title="ServiceWorkerGlobalScope">partial interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-serviceworkerglobalscope"><code>ServiceWorkerGlobalScope</code></a> {<span data-idl="" class="idlAttribute" data-title="oncanmakepayment" data-dfn-for="ServiceWorkerGlobalScope">
  attribute<span class="idlType"> <a data-link-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-serviceworkerglobalscope-oncanmakepayment" id="ref-for-dom-serviceworkerglobalscope-oncanmakepayment-3"><code>oncanmakepayment</code></a>;</span>
};</span>

<span data-idl="" class="idlInterface" data-title="CanMakePaymentEvent">[<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=ServiceWorker</span>]
interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-canmakepaymentevent" id="ref-for-dom-canmakepaymentevent-18"><code>CanMakePaymentEvent</code></a> : <span class="idlSuperclass"><a data-link-type="idl" href="https://www.w3.org/TR/service-workers/#extendableevent-interface">ExtendableEvent</a></span> {<span data-idl="" class="idlConstructor" data-title="constructor" data-dfn-for="CanMakePaymentEvent">
  <dfn data-export="" data-dfn-type="constructor" data-idl="constructor" data-title="constructor" data-dfn-for="CanMakePaymentEvent" data-lt="constructor()|constructor(type)" data-local-lt="CanMakePaymentEvent.constructor|CanMakePaymentEvent.constructor()|constructor"><code>constructor</code></dfn>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">type</span>);</span><span data-idl="" class="idlMethod" data-title="respondWith" data-dfn-for="CanMakePaymentEvent"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-canmakepaymentevent-respondwith" id="ref-for-dom-canmakepaymentevent-respondwith-4"><code>respondWith</code></a>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a>&gt;</span> <span class="idlParamName">canMakePaymentResponse</span>);</span>
};</span>

<span data-idl="" class="idlInterface" data-title="ServiceWorkerGlobalScope">partial interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-serviceworkerglobalscope"><code>ServiceWorkerGlobalScope</code></a> {<span data-idl="" class="idlAttribute" data-title="onpaymentrequest" data-dfn-for="ServiceWorkerGlobalScope">
  attribute<span class="idlType"> <a data-link-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-serviceworkerglobalscope-onpaymentrequest" id="ref-for-dom-serviceworkerglobalscope-onpaymentrequest-3"><code>onpaymentrequest</code></a>;</span>
};</span>

<span data-idl="" class="idlDictionary" data-title="PaymentRequestDetailsUpdate">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dom-paymentrequestdetailsupdate" id="ref-for-dom-paymentrequestdetailsupdate-7"><code>PaymentRequestDetailsUpdate</code></a> {<span data-idl="" class="idlMember" data-title="error" data-dfn-for="PaymentRequestDetailsUpdate"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequestdetailsupdate-error" id="ref-for-dom-paymentrequestdetailsupdate-error-2"><code>error</code></a>;</span><span data-idl="" class="idlMember" data-title="total" data-dfn-for="PaymentRequestDetailsUpdate"><span class="idlType">
  <a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#paymentcurrencyamount-dictionary">PaymentCurrencyAmount</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequestdetailsupdate-total" id="ref-for-dom-paymentrequestdetailsupdate-total-2"><code>total</code></a>;</span><span data-idl="" class="idlMember" data-title="modifiers" data-dfn-for="PaymentRequestDetailsUpdate"><span class="idlType">
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#paymentdetailsmodifier-dictionary">PaymentDetailsModifier</a>&gt;</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequestdetailsupdate-modifiers" id="ref-for-dom-paymentrequestdetailsupdate-modifiers-2"><code>modifiers</code></a>;</span><span data-idl="" class="idlMember" data-title="shippingOptions" data-dfn-for="PaymentRequestDetailsUpdate"><span class="idlType">
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#dom-paymentshippingoption">PaymentShippingOption</a>&gt;</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequestdetailsupdate-shippingoptions" id="ref-for-dom-paymentrequestdetailsupdate-shippingoptions-2"><code>shippingOptions</code></a>;</span><span data-idl="" class="idlMember" data-title="paymentMethodErrors" data-dfn-for="PaymentRequestDetailsUpdate"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object">object</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequestdetailsupdate-paymentmethoderrors" id="ref-for-dom-paymentrequestdetailsupdate-paymentmethoderrors-2"><code>paymentMethodErrors</code></a>;</span><span data-idl="" class="idlMember" data-title="shippingAddressErrors" data-dfn-for="PaymentRequestDetailsUpdate"><span class="idlType">
  <a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#dom-addresserrors">AddressErrors</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequestdetailsupdate-shippingaddresserrors" id="ref-for-dom-paymentrequestdetailsupdate-shippingaddresserrors-2"><code>shippingAddressErrors</code></a>;</span>
};</span>

<span data-idl="" class="idlInterface" data-title="PaymentRequestEvent">[<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=ServiceWorker</span>]
interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-paymentrequestevent" id="ref-for-dom-paymentrequestevent-21"><code>PaymentRequestEvent</code></a> : <span class="idlSuperclass"><a data-link-type="idl" href="https://www.w3.org/TR/service-workers/#extendableevent-interface">ExtendableEvent</a></span> {<span data-idl="" class="idlConstructor" data-title="constructor" data-dfn-for="PaymentRequestEvent">
  <dfn data-export="" data-dfn-type="constructor" data-idl="constructor" data-title="constructor" data-dfn-for="PaymentRequestEvent" data-lt="constructor()|constructor(type)|constructor(type, eventInitDict)" data-local-lt="PaymentRequestEvent.constructor|PaymentRequestEvent.constructor()|constructor"><code>constructor</code></dfn>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">type</span>, optional<span class="idlType"> <a data-link-type="idl" href="#dom-paymentrequesteventinit" class="internalDFN" id="ref-for-dom-paymentrequesteventinit-3"><code>PaymentRequestEventInit</code></a></span> <span class="idlParamName">eventInitDict</span> = {});</span><span data-idl="" class="idlAttribute" data-title="topOrigin" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-toporigin" id="ref-for-dom-paymentrequestevent-toporigin-5"><code>topOrigin</code></a>;</span><span data-idl="" class="idlAttribute" data-title="paymentRequestOrigin" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-paymentrequestorigin" id="ref-for-dom-paymentrequestevent-paymentrequestorigin-3"><code>paymentRequestOrigin</code></a>;</span><span data-idl="" class="idlAttribute" data-title="paymentRequestId" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-paymentrequestid" id="ref-for-dom-paymentrequestevent-paymentrequestid-4"><code>paymentRequestId</code></a>;</span><span data-idl="" class="idlAttribute" data-title="methodData" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array">FrozenArray</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#paymentmethoddata-dictionary">PaymentMethodData</a>&gt;</span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-methoddata" id="ref-for-dom-paymentrequestevent-methoddata-6"><code>methodData</code></a>;</span><span data-idl="" class="idlAttribute" data-title="total" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object">object</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-total" id="ref-for-dom-paymentrequestevent-total-6"><code>total</code></a>;</span><span data-idl="" class="idlAttribute" data-title="modifiers" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array">FrozenArray</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#paymentdetailsmodifier-dictionary">PaymentDetailsModifier</a>&gt;</span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-modifiers" id="ref-for-dom-paymentrequestevent-modifiers-6"><code>modifiers</code></a>;</span><span data-idl="" class="idlAttribute" data-title="paymentOptions" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object">object</a>?</span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-paymentoptions" id="ref-for-dom-paymentrequestevent-paymentoptions-4"><code>paymentOptions</code></a>;</span><span data-idl="" class="idlAttribute" data-title="shippingOptions" data-dfn-for="PaymentRequestEvent">
  readonly attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array">FrozenArray</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#dom-paymentshippingoption">PaymentShippingOption</a>&gt;?</span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-paymentrequestevent-shippingoptions" id="ref-for-dom-paymentrequestevent-shippingoptions-4"><code>shippingOptions</code></a>;</span><span data-idl="" class="idlMethod" data-title="openWindow" data-dfn-for="PaymentRequestEvent"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dfn-windowclient-0" class="internalDFN" id="ref-for-dfn-windowclient-0-2">WindowClient</a>?&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-paymentrequestevent-openwindow" id="ref-for-dom-paymentrequestevent-openwindow-2"><code>openWindow</code></a>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString">USVString</a></span> <span class="idlParamName">url</span>);</span><span data-idl="" class="idlMethod" data-title="changePaymentMethod" data-dfn-for="PaymentRequestEvent"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dom-paymentrequestdetailsupdate" class="internalDFN" id="ref-for-dom-paymentrequestdetailsupdate-8"><code>PaymentRequestDetailsUpdate</code></a>?&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-paymentrequestevent-changepaymentmethod" id="ref-for-dom-paymentrequestevent-changepaymentmethod-2"><code>changePaymentMethod</code></a>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">methodName</span>, optional<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object">object</a>?</span> <span class="idlParamName">methodDetails</span> = null);</span><span data-idl="" class="idlMethod" data-title="changeShippingAddress" data-dfn-for="PaymentRequestEvent"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dom-paymentrequestdetailsupdate" class="internalDFN" id="ref-for-dom-paymentrequestdetailsupdate-9"><code>PaymentRequestDetailsUpdate</code></a>?&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-paymentrequestevent-changeshippingaddress" id="ref-for-dom-paymentrequestevent-changeshippingaddress-2"><code>changeShippingAddress</code></a>(optional<span class="idlType"> <a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#dom-addressinit">AddressInit</a></span> <span class="idlParamName">shippingAddress</span> = {});</span><span data-idl="" class="idlMethod" data-title="changeShippingOption" data-dfn-for="PaymentRequestEvent"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dom-paymentrequestdetailsupdate" class="internalDFN" id="ref-for-dom-paymentrequestdetailsupdate-10"><code>PaymentRequestDetailsUpdate</code></a>?&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-paymentrequestevent-changeshippingoption" id="ref-for-dom-paymentrequestevent-changeshippingoption-2"><code>changeShippingOption</code></a>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">shippingOption</span>);</span><span data-idl="" class="idlMethod" data-title="respondWith" data-dfn-for="PaymentRequestEvent"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-paymentrequestevent-respondwith" id="ref-for-dom-paymentrequestevent-respondwith-3"><code>respondWith</code></a>(<span class="idlType"><a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dom-paymenthandlerresponse" class="internalDFN" id="ref-for-dom-paymenthandlerresponse-8"><code>PaymentHandlerResponse</code></a>&gt;</span> <span class="idlParamName">handlerResponsePromise</span>);</span>
};</span>

<span data-idl="" class="idlDictionary" data-title="PaymentRequestEventInit">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dom-paymentrequesteventinit" id="ref-for-dom-paymentrequesteventinit-4"><code>PaymentRequestEventInit</code></a> : <span class="idlSuperclass"><a data-link-type="idl" href="https://www.w3.org/TR/service-workers/#dictdef-extendableeventinit">ExtendableEventInit</a></span> {<span data-idl="" class="idlMember" data-title="topOrigin" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-toporigin" id="ref-for-dom-paymentrequesteventinit-toporigin-2"><code>topOrigin</code></a>;</span><span data-idl="" class="idlMember" data-title="paymentRequestOrigin" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-paymentrequestorigin" id="ref-for-dom-paymentrequesteventinit-paymentrequestorigin-2"><code>paymentRequestOrigin</code></a>;</span><span data-idl="" class="idlMember" data-title="paymentRequestId" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-paymentrequestid" id="ref-for-dom-paymentrequesteventinit-paymentrequestid-2"><code>paymentRequestId</code></a>;</span><span data-idl="" class="idlMember" data-title="methodData" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#paymentmethoddata-dictionary">PaymentMethodData</a>&gt;</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-methoddata" id="ref-for-dom-paymentrequesteventinit-methoddata-2"><code>methodData</code></a>;</span><span data-idl="" class="idlMember" data-title="total" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#paymentcurrencyamount-dictionary">PaymentCurrencyAmount</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-total" id="ref-for-dom-paymentrequesteventinit-total-2"><code>total</code></a>;</span><span data-idl="" class="idlMember" data-title="modifiers" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#paymentdetailsmodifier-dictionary">PaymentDetailsModifier</a>&gt;</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-modifiers" id="ref-for-dom-paymentrequesteventinit-modifiers-2"><code>modifiers</code></a>;</span><span data-idl="" class="idlMember" data-title="paymentOptions" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="idl" href="#dom-paymentrequestevent-paymentoptions" class="internalDFN" id="ref-for-dom-paymentrequestevent-paymentoptions-5">PaymentOptions</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-paymentoptions" id="ref-for-dom-paymentrequesteventinit-paymentoptions-2"><code>paymentOptions</code></a>;</span><span data-idl="" class="idlMember" data-title="shippingOptions" data-dfn-for="PaymentRequestEventInit"><span class="idlType">
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#dom-paymentshippingoption">PaymentShippingOption</a>&gt;</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymentrequesteventinit-shippingoptions" id="ref-for-dom-paymentrequesteventinit-shippingoptions-2"><code>shippingOptions</code></a>;</span>
};</span>

<span data-idl="" class="idlDictionary" data-title="PaymentHandlerResponse">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dom-paymenthandlerresponse" id="ref-for-dom-paymenthandlerresponse-9"><code>PaymentHandlerResponse</code></a> {<span data-idl="" class="idlMember" data-title="methodName" data-dfn-for="PaymentHandlerResponse"><span class="idlType">
<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymenthandlerresponse-methodname" id="ref-for-dom-paymenthandlerresponse-methodname-3"><code>methodName</code></a>;</span><span data-idl="" class="idlMember" data-title="details" data-dfn-for="PaymentHandlerResponse"><span class="idlType">
<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object">object</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymenthandlerresponse-details" id="ref-for-dom-paymenthandlerresponse-details-3"><code>details</code></a>;</span><span data-idl="" class="idlMember" data-title="payerName" data-dfn-for="PaymentHandlerResponse"><span class="idlType">
<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a>?</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymenthandlerresponse-payername" id="ref-for-dom-paymenthandlerresponse-payername-3"><code>payerName</code></a>;</span><span data-idl="" class="idlMember" data-title="payerEmail" data-dfn-for="PaymentHandlerResponse"><span class="idlType">
<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a>?</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymenthandlerresponse-payeremail" id="ref-for-dom-paymenthandlerresponse-payeremail-3"><code>payerEmail</code></a>;</span><span data-idl="" class="idlMember" data-title="payerPhone" data-dfn-for="PaymentHandlerResponse"><span class="idlType">
<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a>?</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymenthandlerresponse-payerphone" id="ref-for-dom-paymenthandlerresponse-payerphone-3"><code>payerPhone</code></a>;</span><span data-idl="" class="idlMember" data-title="shippingAddress" data-dfn-for="PaymentHandlerResponse"><span class="idlType">
<a data-link-type="idl" href="https://www.w3.org/TR/payment-request/#dom-addressinit">AddressInit</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymenthandlerresponse-shippingaddress" id="ref-for-dom-paymenthandlerresponse-shippingaddress-3"><code>shippingAddress</code></a>;</span><span data-idl="" class="idlMember" data-title="shippingOption" data-dfn-for="PaymentHandlerResponse"><span class="idlType">
<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a>?</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-paymenthandlerresponse-shippingoption" id="ref-for-dom-paymenthandlerresponse-shippingoption-3"><code>shippingOption</code></a>;</span>
};</span></code></pre>
    </section>


    <section id="references" class="appendix">
        <div class="header-wrapper">
            <h2 id="b-references"><bdi class="secno">B. </bdi>参考文献</h2><a class="self-link" href="#references"
                aria-label="Permalink for Appendix B."></a>
        </div>
        <section id="normative-references">
            <div class="header-wrapper">
                <h3 id="b-1-normative-references"><bdi class="secno">B.1 </bdi>规范性参考文献</h3><a class="self-link"
                    href="#normative-references" aria-label="Permalink for Appendix B.1"></a>
            </div>

            <dl class="bibliography">
                <dt id="bib-dom">[dom]</dt>
                <dd>
                    <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Anne van Kesteren. WHATWG.
                    Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-ecmascript">[ECMASCRIPT]</dt>
                <dd>
                    <a href="https://tc39.es/ecma262/multipage/"><cite>ECMAScript Language Specification</cite></a>.
                    Ecma International. URL: <a
                        href="https://tc39.es/ecma262/multipage/">https://tc39.es/ecma262/multipage/</a>
                </dd>
                <dt id="bib-html">[HTML]</dt>
                <dd>
                    <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Anne van Kesteren;
                    Domenic Denicola; Dominic Farolino; Ian Hickson; Philip Jägenstedt; Simon Pieters. WHATWG. Living
                    Standard. URL: <a
                        href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
                </dd>
                <dt id="bib-payment-method-id">[payment-method-id]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/payment-method-id/"><cite>Payment Method Identifiers</cite></a>.
                    Marcos Caceres. W3C. 8 September 2022. W3C Recommendation. URL: <a
                        href="https://www.w3.org/TR/payment-method-id/">https://www.w3.org/TR/payment-method-id/</a>
                </dd>
                <dt id="bib-payment-method-manifest">[payment-method-manifest]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/payment-method-manifest/"><cite>Payment Method Manifest</cite></a>.
                    Dapeng(Max) Liu; Domenic Denicola; Zach Koch. W3C. 12 December 2017. FPWD. URL: <a
                        href="https://www.w3.org/TR/payment-method-manifest/">https://www.w3.org/TR/payment-method-manifest/</a>
                </dd>
                <dt id="bib-payment-request">[payment-request]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/payment-request/"><cite>Payment Request API</cite></a>. Marcos
                    Caceres; Ian Jacobs; Stephen McGruer. W3C. 27 January 2026. CRD. URL: <a
                        href="https://www.w3.org/TR/payment-request/">https://www.w3.org/TR/payment-request/</a>
                </dd>
                <dt id="bib-rfc2119">[RFC2119]</dt>
                <dd>
                    <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate
                            Requirement Levels</cite></a>. S. Bradner. IETF. March 1997. Best Current Practice. URL: <a
                        href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
                </dd>
                <dt id="bib-rfc8174">[RFC8174]</dt>
                <dd>
                    <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC
                            2119 Key Words</cite></a>. B. Leiba. IETF. May 2017. Best Current Practice. URL: <a
                        href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
                </dd>
                <dt id="bib-service-workers">[SERVICE-WORKERS]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/service-workers/"><cite>Service Workers Nightly</cite></a>. Monica
                    CHINTALA; Yoshisato Yanagisawa. W3C. 26 January 2026. CRD. URL: <a
                        href="https://www.w3.org/TR/service-workers/">https://www.w3.org/TR/service-workers/</a>
                </dd>
                <dt id="bib-url">[URL]</dt>
                <dd>
                    <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Anne van Kesteren. WHATWG.
                    Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-webidl">[WEBIDL]</dt>
                <dd>
                    <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Edgar Chen; Timothy Gu.
                    WHATWG. Living Standard. URL: <a
                        href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
                </dd>
            </dl>
        </section>
        <section id="informative-references">
            <div class="header-wrapper">
                <h3 id="b-2-informative-references"><bdi class="secno">B.2 </bdi>参考资料</h3><a class="self-link"
                    href="#informative-references" aria-label="Permalink for Appendix B.2"></a>
            </div>

            <dl class="bibliography">
                <dt id="bib-webcryptoapi">[WebCryptoAPI]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/WebCryptoAPI/"><cite>Web Cryptography API</cite></a>. Mark Watson.
                    W3C. 26 January 2017. W3C Recommendation. URL: <a
                        href="https://www.w3.org/TR/WebCryptoAPI/">https://www.w3.org/TR/WebCryptoAPI/</a>
                </dd>
            </dl>
        </section>
    </section>
    <p role="navigation" id="back-to-top">
        <a href="#title"><abbr title="Back to Top">↑</abbr></a>
    </p>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-payee"
        aria-label="Links in this document to definition: payee">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-payee"
                aria-label="Permalink for definition: payee. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-payee-1" title="§ 2. Overview">§ 2. Overview</a>
            </li>
            <li>
                <a href="#ref-for-dfn-payee-2" title="§ 6.3.1 topOrigin attribute">§ 6.3.1 topOrigin attribute</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-payer"
        aria-label="Links in this document to definition: payer">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-payer"
                aria-label="Permalink for definition: payer. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-payer-1" title="§ 2. Overview">§ 2. Overview</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-web-based-payment-handler"
        aria-label="Links in this document to definition: Web-based payment handler">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-web-based-payment-handler"
                aria-label="Permalink for definition: Web-based payment handler. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-web-based-payment-handler-1" title="§ 1. Introduction">§ 1. Introduction</a>
            </li>
            <li>
                <a href="#ref-for-dfn-web-based-payment-handler-2" title="§ 2. Overview">§ 2. Overview</a> <a
                    href="#ref-for-dfn-web-based-payment-handler-3" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-web-based-payment-handler-4" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-web-based-payment-handler-5" title="§ 4.2 PaymentManager interface">§ 4.2
                    PaymentManager interface</a>
            </li>
            <li>
                <a href="#ref-for-dfn-web-based-payment-handler-6" title="§ 4.2.2 enableDelegations() method">§ 4.2.2
                    enableDelegations() method</a>
            </li>
            <li>
                <a href="#ref-for-dfn-web-based-payment-handler-7" title="§ 5. Can make payment">§ 5. Can make
                    payment</a>
            </li>
            <li>
                <a href="#ref-for-dfn-web-based-payment-handler-8" title="§ 6.5 Handling a PaymentRequestEvent">§ 6.5
                    Handling a PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dfn-web-based-payment-handler-9" title="§ 7. Windows">§ 7. Windows</a> <a
                    href="#ref-for-dfn-web-based-payment-handler-10" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-serviceworkerregistration-paymentmanager"
        aria-label="Links in this document to definition: paymentManager">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-serviceworkerregistration-paymentmanager"
                aria-label="Permalink for definition: paymentManager. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1742672635">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-serviceworkerregistration-paymentmanager-1"
                    title="§ 4.1 Extension to the ServiceWorkerRegistration interface">§ 4.1 Extension to the
                    ServiceWorkerRegistration interface</a>
            </li>
            <li>
                <a href="#ref-for-dom-serviceworkerregistration-paymentmanager-2" title="§ A. IDL Index">§ A. IDL
                    Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-paymentmanager"
        aria-label="Links in this document to definition: PaymentManager">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentmanager"
                aria-label="Permalink for definition: PaymentManager. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1708874582">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentmanager-1" title="§ 1. Introduction">§ 1. Introduction</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentmanager-2"
                    title="§ 4.1 Extension to the ServiceWorkerRegistration interface">§ 4.1 Extension to the
                    ServiceWorkerRegistration interface</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentmanager-3" title="§ 4.2 PaymentManager interface">§ 4.2 PaymentManager
                    interface</a> <a href="#ref-for-dom-paymentmanager-4" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentmanager-5" title="§ A. IDL Index">§ A. IDL Index</a> <a
                    href="#ref-for-dom-paymentmanager-6" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-paymentmanager-userhint"
        aria-label="Links in this document to definition: userHint">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentmanager-userhint"
                aria-label="Permalink for definition: userHint. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1708874582">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentmanager-userhint-1" title="§ 4.2 PaymentManager interface">§ 4.2
                    PaymentManager interface</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentmanager-userhint-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentmanager-enabledelegations"
        aria-label="Links in this document to definition: enableDelegations()">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentmanager-enabledelegations"
                aria-label="Permalink for definition: enableDelegations(). Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1708874582">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentmanager-enabledelegations-1" title="§ 4.2 PaymentManager interface">§ 4.2
                    PaymentManager interface</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentmanager-enabledelegations-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-paymentdelegation"
        aria-label="Links in this document to definition: PaymentDelegation">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentdelegation"
                aria-label="Permalink for definition: PaymentDelegation. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1015767474">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentdelegation-1" title="§ 4.2 PaymentManager interface">§ 4.2 PaymentManager
                    interface</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentdelegation-2" title="§ 4.2.2 enableDelegations() method">§ 4.2.2
                    enableDelegations() method</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentdelegation-3" title="§ 4.3 PaymentDelegation enum">§ 4.3 PaymentDelegation
                    enum</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentdelegation-4" title="§ A. IDL Index">§ A. IDL Index</a> <a
                    href="#ref-for-dom-paymentdelegation-5" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentdelegation-shippingaddress"
        aria-label="Links in this document to definition: shippingAddress">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentdelegation-shippingaddress"
                aria-label="Permalink for definition: shippingAddress. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1015767474">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentdelegation-shippingaddress-1" title="§ 4.3 PaymentDelegation enum">§ 4.3
                    PaymentDelegation enum</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentdelegation-shippingaddress-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-paymentdelegation-payername"
        aria-label="Links in this document to definition: payerName">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentdelegation-payername"
                aria-label="Permalink for definition: payerName. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1015767474">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentdelegation-payername-1" title="§ 4.3 PaymentDelegation enum">§ 4.3
                    PaymentDelegation enum</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentdelegation-payername-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-paymentdelegation-payerphone"
        aria-label="Links in this document to definition: payerPhone">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentdelegation-payerphone"
                aria-label="Permalink for definition: payerPhone. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1015767474">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentdelegation-payerphone-1" title="§ 4.3 PaymentDelegation enum">§ 4.3
                    PaymentDelegation enum</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentdelegation-payerphone-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-paymentdelegation-payeremail"
        aria-label="Links in this document to definition: payerEmail">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentdelegation-payeremail"
                aria-label="Permalink for definition: payerEmail. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1015767474">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentdelegation-payeremail-1" title="§ 4.3 PaymentDelegation enum">§ 4.3
                    PaymentDelegation enum</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentdelegation-payeremail-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-serviceworkerglobalscope-oncanmakepayment"
        aria-label="Links in this document to definition: oncanmakepayment">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-serviceworkerglobalscope-oncanmakepayment"
                aria-label="Permalink for definition: oncanmakepayment. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1445944587">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-serviceworkerglobalscope-oncanmakepayment-1"
                    title="§ 5.1 Extension to ServiceWorkerGlobalScope">§ 5.1 Extension to ServiceWorkerGlobalScope</a>
            </li>
            <li>
                <a href="#ref-for-dom-serviceworkerglobalscope-oncanmakepayment-2"
                    title="§ 5.1.1 oncanmakepayment attribute">§ 5.1.1 oncanmakepayment attribute</a>
            </li>
            <li>
                <a href="#ref-for-dom-serviceworkerglobalscope-oncanmakepayment-3" title="§ A. IDL Index">§ A. IDL
                    Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-canmakepaymentevent"
        aria-label="Links in this document to definition: CanMakePaymentEvent">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-canmakepaymentevent"
                aria-label="Permalink for definition: CanMakePaymentEvent. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-238602632">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-canmakepaymentevent-1" title="§ 5. Can make payment">§ 5. Can make payment</a> <a
                    href="#ref-for-dom-canmakepaymentevent-2" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-canmakepaymentevent-3" title="§ 5.2 The CanMakePaymentEvent">§ 5.2 The
                    CanMakePaymentEvent</a> <a href="#ref-for-dom-canmakepaymentevent-4" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-canmakepaymentevent-5" title="§ 5.3 Handling a CanMakePaymentEvent">§ 5.3 Handling
                    a CanMakePaymentEvent</a> <a href="#ref-for-dom-canmakepaymentevent-6" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-canmakepaymentevent-7" title="§ 5.4 Example of handling the CanMakePaymentEvent">§
                    5.4 Example of handling the CanMakePaymentEvent</a> <a href="#ref-for-dom-canmakepaymentevent-8"
                    title="Reference 2">(2)</a> <a href="#ref-for-dom-canmakepaymentevent-9" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dom-canmakepaymentevent-10" title="§ 5.5 Filtering of Payment Handlers">§ 5.5
                    Filtering of Payment Handlers</a> <a href="#ref-for-dom-canmakepaymentevent-11"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-canmakepaymentevent-12" title="§ 9.2 Information about the User Environment">§ 9.2
                    Information about the User Environment</a> <a href="#ref-for-dom-canmakepaymentevent-13"
                    title="Reference 2">(2)</a> <a href="#ref-for-dom-canmakepaymentevent-14"
                    title="Reference 3">(3)</a> <a href="#ref-for-dom-canmakepaymentevent-15"
                    title="Reference 4">(4)</a> <a href="#ref-for-dom-canmakepaymentevent-16"
                    title="Reference 5">(5)</a>
            </li>
            <li>
                <a href="#ref-for-dom-canmakepaymentevent-17" title="§ 9.10 Private Browsing Mode">§ 9.10 Private
                    Browsing Mode</a>
            </li>
            <li>
                <a href="#ref-for-dom-canmakepaymentevent-18" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-canmakepaymentevent-constructor"
        aria-label="Links in this document to definition: constructor">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-canmakepaymentevent-constructor"
                aria-label="Permalink for definition: constructor. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-canmakepaymentevent-respondwith"
        aria-label="Links in this document to definition: respondWith()">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-canmakepaymentevent-respondwith"
                aria-label="Permalink for definition: respondWith(). Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-238602632">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-canmakepaymentevent-respondwith-1" title="§ 5. Can make payment">§ 5. Can make
                    payment</a>
            </li>
            <li>
                <a href="#ref-for-dom-canmakepaymentevent-respondwith-2" title="§ 5.2 The CanMakePaymentEvent">§ 5.2 The
                    CanMakePaymentEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-canmakepaymentevent-respondwith-3" title="§ 9.10 Private Browsing Mode">§ 9.10
                    Private Browsing Mode</a>
            </li>
            <li>
                <a href="#ref-for-dom-canmakepaymentevent-respondwith-4" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-handling-a-canmakepaymentevent"
        aria-label="Links in this document to definition: Handling a CanMakePaymentEvent">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-handling-a-canmakepaymentevent"
                aria-label="Permalink for definition: Handling a CanMakePaymentEvent. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-handling-a-canmakepaymentevent-1" title="§ 9.7 Authorized Payment Apps">§ 9.7
                    Authorized Payment Apps</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-serviceworkerglobalscope-onpaymentrequest"
        aria-label="Links in this document to definition: onpaymentrequest">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-serviceworkerglobalscope-onpaymentrequest"
                aria-label="Permalink for definition: onpaymentrequest. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1119623754">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-serviceworkerglobalscope-onpaymentrequest-1"
                    title="§ 6.1 Extension to ServiceWorkerGlobalScope">§ 6.1 Extension to ServiceWorkerGlobalScope</a>
            </li>
            <li>
                <a href="#ref-for-dom-serviceworkerglobalscope-onpaymentrequest-2"
                    title="§ 6.1.1 onpaymentrequest attribute">§ 6.1.1 onpaymentrequest attribute</a>
            </li>
            <li>
                <a href="#ref-for-dom-serviceworkerglobalscope-onpaymentrequest-3" title="§ A. IDL Index">§ A. IDL
                    Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-paymentrequestdetailsupdate"
        aria-label="Links in this document to definition: PaymentRequestDetailsUpdate">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestdetailsupdate"
                aria-label="Permalink for definition: PaymentRequestDetailsUpdate. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-2024425618">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-1" title="§ 6.2 The PaymentRequestDetailsUpdate">§ 6.2
                    The PaymentRequestDetailsUpdate</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-2" title="§ 6.3 The PaymentRequestEvent">§ 6.3 The
                    PaymentRequestEvent</a> <a href="#ref-for-dom-paymentrequestdetailsupdate-3"
                    title="Reference 2">(2)</a> <a href="#ref-for-dom-paymentrequestdetailsupdate-4"
                    title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-5" title="§ 8.2 Change Payment Method Algorithm">§ 8.2
                    Change Payment Method Algorithm</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-6" title="§ 8.3 Change Payment Details Algorithm">§
                    8.3 Change Payment Details Algorithm</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-7" title="§ A. IDL Index">§ A. IDL Index</a> <a
                    href="#ref-for-dom-paymentrequestdetailsupdate-8" title="Reference 2">(2)</a> <a
                    href="#ref-for-dom-paymentrequestdetailsupdate-9" title="Reference 3">(3)</a> <a
                    href="#ref-for-dom-paymentrequestdetailsupdate-10" title="Reference 4">(4)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestdetailsupdate-error"
        aria-label="Links in this document to definition: error">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestdetailsupdate-error"
                aria-label="Permalink for definition: error. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-2024425618">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-error-1"
                    title="§ 6.2 The PaymentRequestDetailsUpdate">§ 6.2 The PaymentRequestDetailsUpdate</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-error-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestdetailsupdate-total"
        aria-label="Links in this document to definition: total">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestdetailsupdate-total"
                aria-label="Permalink for definition: total. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-2024425618">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-total-1"
                    title="§ 6.2 The PaymentRequestDetailsUpdate">§ 6.2 The PaymentRequestDetailsUpdate</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-total-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestdetailsupdate-modifiers"
        aria-label="Links in this document to definition: modifiers">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestdetailsupdate-modifiers"
                aria-label="Permalink for definition: modifiers. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-2024425618">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-modifiers-1"
                    title="§ 6.2 The PaymentRequestDetailsUpdate">§ 6.2 The PaymentRequestDetailsUpdate</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-modifiers-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestdetailsupdate-shippingoptions"
        aria-label="Links in this document to definition: shippingOptions">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestdetailsupdate-shippingoptions"
                aria-label="Permalink for definition: shippingOptions. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-2024425618">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-shippingoptions-1"
                    title="§ 6.2 The PaymentRequestDetailsUpdate">§ 6.2 The PaymentRequestDetailsUpdate</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-shippingoptions-2" title="§ A. IDL Index">§ A. IDL
                    Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestdetailsupdate-paymentmethoderrors"
        aria-label="Links in this document to definition: paymentMethodErrors">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestdetailsupdate-paymentmethoderrors"
                aria-label="Permalink for definition: paymentMethodErrors. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-2024425618">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-paymentmethoderrors-1"
                    title="§ 6.2 The PaymentRequestDetailsUpdate">§ 6.2 The PaymentRequestDetailsUpdate</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-paymentmethoderrors-2" title="§ A. IDL Index">§ A. IDL
                    Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestdetailsupdate-shippingaddresserrors"
        aria-label="Links in this document to definition: shippingAddressErrors">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestdetailsupdate-shippingaddresserrors"
                aria-label="Permalink for definition: shippingAddressErrors. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-2024425618">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-shippingaddresserrors-1"
                    title="§ 6.2 The PaymentRequestDetailsUpdate">§ 6.2 The PaymentRequestDetailsUpdate</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestdetailsupdate-shippingaddresserrors-2" title="§ A. IDL Index">§ A.
                    IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-paymentrequestevent"
        aria-label="Links in this document to definition: PaymentRequestEvent">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestevent"
                aria-label="Permalink for definition: PaymentRequestEvent. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-941889379">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-1" title="§ 1. Introduction">§ 1. Introduction</a> <a
                    href="#ref-for-dom-paymentrequestevent-2" title="Reference 2">(2)</a> <a
                    href="#ref-for-dom-paymentrequestevent-3" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-4" title="§ 2. Overview">§ 2. Overview</a> <a
                    href="#ref-for-dom-paymentrequestevent-5" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-6" title="§ 2.1 Handling a Payment Request">§ 2.1 Handling a
                    Payment Request</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-7" title="§ 6. Invocation">§ 6. Invocation</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-8" title="§ 6.1.1 onpaymentrequest attribute">§ 6.1.1
                    onpaymentrequest attribute</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-9" title="§ 6.3 The PaymentRequestEvent">§ 6.3 The
                    PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-10" title="§ 6.3.3 paymentRequestId attribute">§ 6.3.3
                    paymentRequestId attribute</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-11" title="§ 6.3.14 PaymentRequestEventInit dictionary">§
                    6.3.14 PaymentRequestEventInit dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-12" title="§ 6.4 Internal Slots">§ 6.4 Internal Slots</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-13" title="§ 6.5 Handling a PaymentRequestEvent">§ 6.5
                    Handling a PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-14" title="§ 7. Windows">§ 7. Windows</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-15" title="§ 7.1 Open Window Algorithm">§ 7.1 Open Window
                    Algorithm</a> <a href="#ref-for-dom-paymentrequestevent-16" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-17"
                    title="§ 7.2 Example of handling the PaymentRequestEvent">§ 7.2 Example of handling the
                    PaymentRequestEvent</a> <a href="#ref-for-dom-paymentrequestevent-18" title="Reference 2">(2)</a> <a
                    href="#ref-for-dom-paymentrequestevent-19" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-20" title="§ 8.1.2 details attribute">§ 8.1.2 details
                    attribute</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-21" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestevent-constructor"
        aria-label="Links in this document to definition: constructor">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestevent-constructor"
                aria-label="Permalink for definition: constructor. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestevent-toporigin"
        aria-label="Links in this document to definition: topOrigin">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestevent-toporigin"
                aria-label="Permalink for definition: topOrigin. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-941889379">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-toporigin-1" title="§ 6.3 The PaymentRequestEvent">§ 6.3 The
                    PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-toporigin-2" title="§ 6.3.2 paymentRequestOrigin attribute">§
                    6.3.2 paymentRequestOrigin attribute</a> <a href="#ref-for-dom-paymentrequestevent-toporigin-3"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-toporigin-4" title="§ 6.5 Handling a PaymentRequestEvent">§
                    6.5 Handling a PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-toporigin-5" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestevent-paymentrequestorigin"
        aria-label="Links in this document to definition: paymentRequestOrigin">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestevent-paymentrequestorigin"
                aria-label="Permalink for definition: paymentRequestOrigin. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-941889379">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-paymentrequestorigin-1"
                    title="§ 6.3 The PaymentRequestEvent">§ 6.3 The PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-paymentrequestorigin-2"
                    title="§ 6.5 Handling a PaymentRequestEvent">§ 6.5 Handling a PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-paymentrequestorigin-3" title="§ A. IDL Index">§ A. IDL
                    Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestevent-paymentrequestid"
        aria-label="Links in this document to definition: paymentRequestId">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestevent-paymentrequestid"
                aria-label="Permalink for definition: paymentRequestId. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-941889379">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-paymentrequestid-1" title="§ 6.3 The PaymentRequestEvent">§
                    6.3 The PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-paymentrequestid-2"
                    title="§ 6.3.3 paymentRequestId attribute">§ 6.3.3 paymentRequestId attribute</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-paymentrequestid-3"
                    title="§ 6.5 Handling a PaymentRequestEvent">§ 6.5 Handling a PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-paymentrequestid-4" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestevent-methoddata"
        aria-label="Links in this document to definition: methodData">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestevent-methoddata"
                aria-label="Permalink for definition: methodData. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-941889379">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-methoddata-1" title="§ 6.3 The PaymentRequestEvent">§ 6.3 The
                    PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-methoddata-2"
                    title="§ 6.3.15 MethodData Population Algorithm">§ 6.3.15 MethodData Population Algorithm</a> <a
                    href="#ref-for-dom-paymentrequestevent-methoddata-3" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-methoddata-4" title="§ 6.5 Handling a PaymentRequestEvent">§
                    6.5 Handling a PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-methoddata-5"
                    title="§ 8.4 Respond to PaymentRequest Algorithm">§ 8.4 Respond to PaymentRequest Algorithm</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-methoddata-6" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-paymentrequestevent-total"
        aria-label="Links in this document to definition: total">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestevent-total"
                aria-label="Permalink for definition: total. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-941889379">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-total-1" title="§ 6.3 The PaymentRequestEvent">§ 6.3 The
                    PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-total-2" title="§ 6.3.5 total attribute">§ 6.3.5 total
                    attribute</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-total-3" title="§ 6.3.16 Modifiers Population Algorithm">§
                    6.3.16 Modifiers Population Algorithm</a> <a href="#ref-for-dom-paymentrequestevent-total-4"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-total-5" title="§ 6.5 Handling a PaymentRequestEvent">§ 6.5
                    Handling a PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-total-6" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestevent-modifiers"
        aria-label="Links in this document to definition: modifiers">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestevent-modifiers"
                aria-label="Permalink for definition: modifiers. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-941889379">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-modifiers-1" title="§ 6.3 The PaymentRequestEvent">§ 6.3 The
                    PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-modifiers-2" title="§ 6.3.16 Modifiers Population Algorithm">§
                    6.3.16 Modifiers Population Algorithm</a> <a href="#ref-for-dom-paymentrequestevent-modifiers-3"
                    title="Reference 2">(2)</a> <a href="#ref-for-dom-paymentrequestevent-modifiers-4"
                    title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-modifiers-5" title="§ 6.5 Handling a PaymentRequestEvent">§
                    6.5 Handling a PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-modifiers-6" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestevent-paymentoptions"
        aria-label="Links in this document to definition: paymentOptions">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestevent-paymentoptions"
                aria-label="Permalink for definition: paymentOptions. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-941889379">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-paymentoptions-1" title="§ 6.3 The PaymentRequestEvent">§ 6.3
                    The PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-paymentoptions-2"
                    title="§ 6.3.14 PaymentRequestEventInit dictionary">§ 6.3.14 PaymentRequestEventInit dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-paymentoptions-3"
                    title="§ 6.5 Handling a PaymentRequestEvent">§ 6.5 Handling a PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-paymentoptions-4" title="§ A. IDL Index">§ A. IDL Index</a> <a
                    href="#ref-for-dom-paymentrequestevent-paymentoptions-5" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestevent-shippingoptions"
        aria-label="Links in this document to definition: shippingOptions">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestevent-shippingoptions"
                aria-label="Permalink for definition: shippingOptions. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-941889379">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-shippingoptions-1" title="§ 6.3 The PaymentRequestEvent">§ 6.3
                    The PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-shippingoptions-2"
                    title="§ 6.5 Handling a PaymentRequestEvent">§ 6.5 Handling a PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-shippingoptions-3"
                    title="§ 8.4 Respond to PaymentRequest Algorithm">§ 8.4 Respond to PaymentRequest Algorithm</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-shippingoptions-4" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestevent-openwindow"
        aria-label="Links in this document to definition: openWindow()">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestevent-openwindow"
                aria-label="Permalink for definition: openWindow(). Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-941889379">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-openwindow-1" title="§ 6.3 The PaymentRequestEvent">§ 6.3 The
                    PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-openwindow-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestevent-changepaymentmethod"
        aria-label="Links in this document to definition: changePaymentMethod()">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestevent-changepaymentmethod"
                aria-label="Permalink for definition: changePaymentMethod(). Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-941889379">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-changepaymentmethod-1" title="§ 6.3 The PaymentRequestEvent">§
                    6.3 The PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-changepaymentmethod-2" title="§ A. IDL Index">§ A. IDL
                    Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestevent-changeshippingaddress"
        aria-label="Links in this document to definition: changeShippingAddress()">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestevent-changeshippingaddress"
                aria-label="Permalink for definition: changeShippingAddress(). Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-941889379">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-changeshippingaddress-1"
                    title="§ 6.3 The PaymentRequestEvent">§ 6.3 The PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-changeshippingaddress-2" title="§ A. IDL Index">§ A. IDL
                    Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestevent-changeshippingoption"
        aria-label="Links in this document to definition: changeShippingOption()">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestevent-changeshippingoption"
                aria-label="Permalink for definition: changeShippingOption(). Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-941889379">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-changeshippingoption-1"
                    title="§ 6.3 The PaymentRequestEvent">§ 6.3 The PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-changeshippingoption-2" title="§ A. IDL Index">§ A. IDL
                    Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequestevent-respondwith"
        aria-label="Links in this document to definition: respondWith()">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequestevent-respondwith"
                aria-label="Permalink for definition: respondWith(). Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-941889379">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-respondwith-1" title="§ 6.3 The PaymentRequestEvent">§ 6.3 The
                    PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-respondwith-2" title="§ 8.1.2 details attribute">§ 8.1.2
                    details attribute</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequestevent-respondwith-3" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-paymentrequesteventinit"
        aria-label="Links in this document to definition: PaymentRequestEventInit">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequesteventinit"
                aria-label="Permalink for definition: PaymentRequestEventInit. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-488183213">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-1" title="§ 6.3 The PaymentRequestEvent">§ 6.3 The
                    PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-2" title="§ 6.3.14 PaymentRequestEventInit dictionary">§
                    6.3.14 PaymentRequestEventInit dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-3" title="§ A. IDL Index">§ A. IDL Index</a> <a
                    href="#ref-for-dom-paymentrequesteventinit-4" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequesteventinit-toporigin"
        aria-label="Links in this document to definition: topOrigin">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequesteventinit-toporigin"
                aria-label="Permalink for definition: topOrigin. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-488183213">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-toporigin-1"
                    title="§ 6.3.14 PaymentRequestEventInit dictionary">§ 6.3.14 PaymentRequestEventInit dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-toporigin-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequesteventinit-paymentrequestorigin"
        aria-label="Links in this document to definition: paymentRequestOrigin">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequesteventinit-paymentrequestorigin"
                aria-label="Permalink for definition: paymentRequestOrigin. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-488183213">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-paymentrequestorigin-1"
                    title="§ 6.3.14 PaymentRequestEventInit dictionary">§ 6.3.14 PaymentRequestEventInit dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-paymentrequestorigin-2" title="§ A. IDL Index">§ A. IDL
                    Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequesteventinit-paymentrequestid"
        aria-label="Links in this document to definition: paymentRequestId">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequesteventinit-paymentrequestid"
                aria-label="Permalink for definition: paymentRequestId. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-488183213">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-paymentrequestid-1"
                    title="§ 6.3.14 PaymentRequestEventInit dictionary">§ 6.3.14 PaymentRequestEventInit dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-paymentrequestid-2" title="§ A. IDL Index">§ A. IDL
                    Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequesteventinit-methoddata"
        aria-label="Links in this document to definition: methodData">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequesteventinit-methoddata"
                aria-label="Permalink for definition: methodData. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-488183213">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-methoddata-1"
                    title="§ 6.3.14 PaymentRequestEventInit dictionary">§ 6.3.14 PaymentRequestEventInit dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-methoddata-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequesteventinit-total" aria-label="Links in this document to definition: total">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequesteventinit-total"
                aria-label="Permalink for definition: total. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-488183213">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-total-1"
                    title="§ 6.3.14 PaymentRequestEventInit dictionary">§ 6.3.14 PaymentRequestEventInit dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-total-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequesteventinit-modifiers"
        aria-label="Links in this document to definition: modifiers">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequesteventinit-modifiers"
                aria-label="Permalink for definition: modifiers. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-488183213">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-modifiers-1"
                    title="§ 6.3.14 PaymentRequestEventInit dictionary">§ 6.3.14 PaymentRequestEventInit dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-modifiers-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequesteventinit-paymentoptions"
        aria-label="Links in this document to definition: paymentOptions">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequesteventinit-paymentoptions"
                aria-label="Permalink for definition: paymentOptions. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-488183213">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-paymentoptions-1"
                    title="§ 6.3.14 PaymentRequestEventInit dictionary">§ 6.3.14 PaymentRequestEventInit dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-paymentoptions-2" title="§ A. IDL Index">§ A. IDL
                    Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymentrequesteventinit-shippingoptions"
        aria-label="Links in this document to definition: shippingOptions">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymentrequesteventinit-shippingoptions"
                aria-label="Permalink for definition: shippingOptions. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-488183213">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-shippingoptions-1"
                    title="§ 6.3.14 PaymentRequestEventInit dictionary">§ 6.3.14 PaymentRequestEventInit dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymentrequesteventinit-shippingoptions-2" title="§ A. IDL Index">§ A. IDL
                    Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-methoddata-population-algorithm"
        aria-label="Links in this document to definition: MethodData Population Algorithm">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-methoddata-population-algorithm"
                aria-label="Permalink for definition: MethodData Population Algorithm. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-methoddata-population-algorithm-1" title="§ 6.3.4 methodData attribute">§ 6.3.4
                    methodData attribute</a>
            </li>
            <li>
                <a href="#ref-for-dfn-methoddata-population-algorithm-2" title="§ 6.5 Handling a PaymentRequestEvent">§
                    6.5 Handling a PaymentRequestEvent</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-modifiers-population-algorithm"
        aria-label="Links in this document to definition: Modifiers Population Algorithm">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-modifiers-population-algorithm"
                aria-label="Permalink for definition: Modifiers Population Algorithm. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-modifiers-population-algorithm-1" title="§ 6.3.6 modifiers attribute">§ 6.3.6
                    modifiers attribute</a>
            </li>
            <li>
                <a href="#ref-for-dfn-modifiers-population-algorithm-2" title="§ 6.5 Handling a PaymentRequestEvent">§
                    6.5 Handling a PaymentRequestEvent</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-windowclient"
        aria-label="Links in this document to definition: [[windowClient]]">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-windowclient"
                aria-label="Permalink for definition: [[windowClient]]. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-windowclient-1" title="§ 7.1 Open Window Algorithm">§ 7.1 Open Window
                    Algorithm</a> <a href="#ref-for-dfn-windowclient-2" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-windowclient-3" title="Reference 3">(3)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-windowclient-0"
        aria-label="Links in this document to definition: WindowClient">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-windowclient-0"
                aria-label="Permalink for definition: WindowClient. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-windowclient-0-1" title="§ 6.3 The PaymentRequestEvent">§ 6.3 The
                    PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dfn-windowclient-0-2" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-respondwithcalled"
        aria-label="Links in this document to definition: [[respondWithCalled]]">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-respondwithcalled"
                aria-label="Permalink for definition: [[respondWithCalled]]. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-respondwithcalled-1" title="§ 8.4 Respond to PaymentRequest Algorithm">§ 8.4
                    Respond to PaymentRequest Algorithm</a> <a href="#ref-for-dfn-respondwithcalled-2"
                    title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-handling-a-paymentrequestevent"
        aria-label="Links in this document to definition: Handling a PaymentRequestEvent">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-handling-a-paymentrequestevent"
                aria-label="Permalink for definition: Handling a PaymentRequestEvent. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-handling-a-paymentrequestevent-1" title="§ 6.3.1 topOrigin attribute">§ 6.3.1
                    topOrigin attribute</a>
            </li>
            <li>
                <a href="#ref-for-dfn-handling-a-paymentrequestevent-2" title="§ 6.3.2 paymentRequestOrigin attribute">§
                    6.3.2 paymentRequestOrigin attribute</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-web-based-payment-handler-window"
        aria-label="Links in this document to definition: Windows">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-web-based-payment-handler-window"
                aria-label="Permalink for definition: Windows. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-web-based-payment-handler-window-1"
                    title="§ 7.2 Example of handling the PaymentRequestEvent">§ 7.2 Example of handling the
                    PaymentRequestEvent</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-open-window-algorithm"
        aria-label="Links in this document to definition: Open Window Algorithm">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-open-window-algorithm"
                aria-label="Permalink for definition: Open Window Algorithm. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-open-window-algorithm-1" title="§ 6.3.9 openWindow() method">§ 6.3.9 openWindow()
                    method</a>
            </li>
            <li>
                <a href="#ref-for-dfn-open-window-algorithm-2" title="§ 7.1 Open Window Algorithm">§ 7.1 Open Window
                    Algorithm</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-paymenthandlerresponse"
        aria-label="Links in this document to definition: PaymentHandlerResponse">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymenthandlerresponse"
                aria-label="Permalink for definition: PaymentHandlerResponse. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-822477832">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-1" title="§ 6. Invocation">§ 6. Invocation</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-2" title="§ 6.3 The PaymentRequestEvent">§ 6.3 The
                    PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-3" title="§ 6.3.13 respondWith() method">§ 6.3.13
                    respondWith() method</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-4" title="§ 6.5 Handling a PaymentRequestEvent">§ 6.5
                    Handling a PaymentRequestEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-5" title="§ 8.1 PaymentHandlerResponse dictionary">§ 8.1
                    PaymentHandlerResponse dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-6" title="§ 8.1.2 details attribute">§ 8.1.2 details
                    attribute</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-7" title="§ 8.4 Respond to PaymentRequest Algorithm">§ 8.4
                    Respond to PaymentRequest Algorithm</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-8" title="§ A. IDL Index">§ A. IDL Index</a> <a
                    href="#ref-for-dom-paymenthandlerresponse-9" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymenthandlerresponse-methodname"
        aria-label="Links in this document to definition: methodName">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymenthandlerresponse-methodname"
                aria-label="Permalink for definition: methodName. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-822477832">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-methodname-1"
                    title="§ 8.1 PaymentHandlerResponse dictionary">§ 8.1 PaymentHandlerResponse dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-methodname-2"
                    title="§ 8.4 Respond to PaymentRequest Algorithm">§ 8.4 Respond to PaymentRequest Algorithm</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-methodname-3" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymenthandlerresponse-details"
        aria-label="Links in this document to definition: details">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymenthandlerresponse-details"
                aria-label="Permalink for definition: details. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-822477832">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-details-1"
                    title="§ 8.1 PaymentHandlerResponse dictionary">§ 8.1 PaymentHandlerResponse dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-details-2"
                    title="§ 8.4 Respond to PaymentRequest Algorithm">§ 8.4 Respond to PaymentRequest Algorithm</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-details-3" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-payment-app-failure-algorithm"
        aria-label="Links in this document to definition: payment app failure algorithm">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-payment-app-failure-algorithm"
                aria-label="Permalink for definition: payment app failure algorithm. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-payment-app-failure-algorithm-1"
                    title="§ 8.4 Respond to PaymentRequest Algorithm">§ 8.4 Respond to PaymentRequest Algorithm</a> <a
                    href="#ref-for-dfn-payment-app-failure-algorithm-2" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-payment-app-failure-algorithm-3" title="Reference 3">(3)</a> <a
                    href="#ref-for-dfn-payment-app-failure-algorithm-4" title="Reference 4">(4)</a> <a
                    href="#ref-for-dfn-payment-app-failure-algorithm-5" title="Reference 5">(5)</a> <a
                    href="#ref-for-dfn-payment-app-failure-algorithm-6" title="Reference 6">(6)</a> <a
                    href="#ref-for-dfn-payment-app-failure-algorithm-7" title="Reference 7">(7)</a> <a
                    href="#ref-for-dfn-payment-app-failure-algorithm-8" title="Reference 8">(8)</a> <a
                    href="#ref-for-dfn-payment-app-failure-algorithm-9" title="Reference 9">(9)</a> <a
                    href="#ref-for-dfn-payment-app-failure-algorithm-10" title="Reference 10">(10)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymenthandlerresponse-payername"
        aria-label="Links in this document to definition: payerName">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymenthandlerresponse-payername"
                aria-label="Permalink for definition: payerName. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-822477832">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-payername-1"
                    title="§ 8.1 PaymentHandlerResponse dictionary">§ 8.1 PaymentHandlerResponse dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-payername-2"
                    title="§ 8.4 Respond to PaymentRequest Algorithm">§ 8.4 Respond to PaymentRequest Algorithm</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-payername-3" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymenthandlerresponse-payeremail"
        aria-label="Links in this document to definition: payerEmail">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymenthandlerresponse-payeremail"
                aria-label="Permalink for definition: payerEmail. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-822477832">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-payeremail-1"
                    title="§ 8.1 PaymentHandlerResponse dictionary">§ 8.1 PaymentHandlerResponse dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-payeremail-2"
                    title="§ 8.4 Respond to PaymentRequest Algorithm">§ 8.4 Respond to PaymentRequest Algorithm</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-payeremail-3" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymenthandlerresponse-payerphone"
        aria-label="Links in this document to definition: payerPhone">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymenthandlerresponse-payerphone"
                aria-label="Permalink for definition: payerPhone. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-822477832">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-payerphone-1"
                    title="§ 8.1 PaymentHandlerResponse dictionary">§ 8.1 PaymentHandlerResponse dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-payerphone-2"
                    title="§ 8.4 Respond to PaymentRequest Algorithm">§ 8.4 Respond to PaymentRequest Algorithm</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-payerphone-3" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymenthandlerresponse-shippingaddress"
        aria-label="Links in this document to definition: shippingAddress">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymenthandlerresponse-shippingaddress"
                aria-label="Permalink for definition: shippingAddress. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-822477832">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-shippingaddress-1"
                    title="§ 8.1 PaymentHandlerResponse dictionary">§ 8.1 PaymentHandlerResponse dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-shippingaddress-2"
                    title="§ 8.4 Respond to PaymentRequest Algorithm">§ 8.4 Respond to PaymentRequest Algorithm</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-shippingaddress-3" title="§ A. IDL Index">§ A. IDL
                    Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-paymenthandlerresponse-shippingoption"
        aria-label="Links in this document to definition: shippingOption">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-paymenthandlerresponse-shippingoption"
                aria-label="Permalink for definition: shippingOption. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-822477832">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-shippingoption-1"
                    title="§ 8.1 PaymentHandlerResponse dictionary">§ 8.1 PaymentHandlerResponse dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-shippingoption-2"
                    title="§ 8.4 Respond to PaymentRequest Algorithm">§ 8.4 Respond to PaymentRequest Algorithm</a>
            </li>
            <li>
                <a href="#ref-for-dom-paymenthandlerresponse-shippingoption-3" title="§ A. IDL Index">§ A. IDL Index</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-change-payment-method-algorithm"
        aria-label="Links in this document to definition: Change Payment Method Algorithm">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-change-payment-method-algorithm"
                aria-label="Permalink for definition: Change Payment Method Algorithm. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-change-payment-method-algorithm-1" title="§ 6.3.10 changePaymentMethod() method">§
                    6.3.10 changePaymentMethod() method</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-change-payment-details-algorithm"
        aria-label="Links in this document to definition: Change Payment Details Algorithm">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-change-payment-details-algorithm"
                aria-label="Permalink for definition: Change Payment Details Algorithm. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-change-payment-details-algorithm-1"
                    title="§ 6.3.11 changeShippingAddress() method">§ 6.3.11 changeShippingAddress() method</a>
            </li>
            <li>
                <a href="#ref-for-dfn-change-payment-details-algorithm-2"
                    title="§ 6.3.12 changeShippingOption() method">§ 6.3.12 changeShippingOption() method</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-respond-to-paymentrequest-algorithm"
        aria-label="Links in this document to definition: Respond to PaymentRequest Algorithm">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-respond-to-paymentrequest-algorithm"
                aria-label="Permalink for definition: Respond to PaymentRequest Algorithm. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-respond-to-paymentrequest-algorithm-1" title="§ 6.3.13 respondWith() method">§
                    6.3.13 respondWith() method</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-service-worker-registration"
        aria-label="Links in this document to definition: service worker registration">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-service-worker-registration"
                aria-label="Permalink for definition: service worker registration. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-service-worker-registration-1" title="§ 1. Introduction">§ 1. Introduction</a>
            </li>
            <li>
                <a href="#ref-for-dfn-service-worker-registration-2" title="§ 9.8 Supported Origin">§ 9.8 Supported
                    Origin</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-user-agents"
        aria-label="Links in this document to definition: user agent">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-user-agents"
                aria-label="Permalink for definition: user agent. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-user-agents-1" title="§ 5. Can make payment">§ 5. Can make payment</a>
            </li>
            <li>
                <a href="#ref-for-dfn-user-agents-2" title="§ 5.3 Handling a CanMakePaymentEvent">§ 5.3 Handling a
                    CanMakePaymentEvent</a> <a href="#ref-for-dfn-user-agents-3" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-user-agents-4" title="§ 6.5 Handling a PaymentRequestEvent">§ 6.5 Handling a
                    PaymentRequestEvent</a>
            </li>
        </ul>
    </div>
    <script id="respec-highlight-vars">(() => {
            // @ts-check

            if (document.respec) {
                document.respec.ready.then(setupVarHighlighter);
            } else {
                setupVarHighlighter();
            }

            function setupVarHighlighter() {
                document
                    .querySelectorAll("var")
                    .forEach(varElem => varElem.addEventListener("click", highlightListener));
            }

            function highlightListener(ev) {
                ev.stopPropagation();
                const { target: varElem } = ev;
                const hightligtedElems = highlightVars(varElem);
                const resetListener = () => {
                    const hlColor = getHighlightColor(varElem);
                    hightligtedElems.forEach(el => removeHighlight(el, hlColor));
                    [...HL_COLORS.keys()].forEach(key => HL_COLORS.set(key, true));
                };
                if (hightligtedElems.length) {
                    document.body.addEventListener("click", resetListener, { once: true });
                }
            }

            // availability of highlight colors. colors from var.css
            const HL_COLORS = new Map([
                ["respec-hl-c1", true],
                ["respec-hl-c2", true],
                ["respec-hl-c3", true],
                ["respec-hl-c4", true],
                ["respec-hl-c5", true],
                ["respec-hl-c6", true],
                ["respec-hl-c7", true],
            ]);

            function getHighlightColor(target) {
                // return current colors if applicable
                const { value } = target.classList;
                const re = /respec-hl-\w+/;
                const activeClass = re.test(value) && value.match(re);
                if (activeClass) return activeClass[0];

                // first color preference
                if (HL_COLORS.get("respec-hl-c1") === true) return "respec-hl-c1";

                // otherwise get some other available color
                return [...HL_COLORS.keys()].find(c => HL_COLORS.get(c)) || "respec-hl-c1";
            }

            function highlightVars(varElem) {
                const textContent = norm(varElem.textContent);
                const parent = varElem.closest(".algorithm, section");
                const highlightColor = getHighlightColor(varElem);

                const varsToHighlight = [...parent.querySelectorAll("var")].filter(
                    el =>
                        norm(el.textContent) === textContent &&
                        el.closest(".algorithm, section") === parent
                );

                // update availability of highlight color
                const colorStatus = varsToHighlight[0].classList.contains("respec-hl");
                HL_COLORS.set(highlightColor, colorStatus);

                // highlight vars
                if (colorStatus) {
                    varsToHighlight.forEach(el => removeHighlight(el, highlightColor));
                    return [];
                } else {
                    varsToHighlight.forEach(el => addHighlight(el, highlightColor));
                }
                return varsToHighlight;
            }

            function removeHighlight(el, highlightColor) {
                el.classList.remove("respec-hl", highlightColor);
                // clean up empty class attributes so they don't come in export
                if (!el.classList.length) el.removeAttribute("class");
            }

            function addHighlight(elem, highlightColor) {
                elem.classList.add("respec-hl", highlightColor);
            }

            /**
             * Same as `norm` from src/core/utils, but our build process doesn't allow
             * imports in runtime scripts, so duplicated here.
             * @param {string} str
             */
            function norm(str) {
                return str.trim().replace(/\s+/g, " ");
            }
        })()</script>
    <script id="respec-dfn-panel">(() => {
                                               // @ts-check
                                               if (document.respec) {
                                                   document.respec.ready.then(setupPanel);
                                               } else {
                                                   setupPanel();
                                               }

                                               function setupPanel() {
                                                   const listener = panelListener();
                                                   document.body.addEventListener("keydown", listener);
                                                   document.body.addEventListener("click", listener);
                                               }

                                               function panelListener() {
                                                   /** @type {HTMLElement} */
                                                   let panel = null;
                                                   return event => {
                                                       const { target, type } = event;

                                                       if (!(target instanceof HTMLElement)) return;

                                                       // For keys, we only care about Enter key to activate the panel
                                                       // otherwise it's activated via a click.
                                                       if (type === "keydown" && event.key !== "Enter") return;

                                                       const action = deriveAction(event);

                                                       switch (action) {
                                                           case "show": {
                                                               hidePanel(panel);
                                                               /** @type {HTMLElement} */
                                                               const dfn = target.closest("dfn, .index-term");
                                                               panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
                                                               const coords = deriveCoordinates(event);
                                                               displayPanel(dfn, panel, coords);
                                                               break;
                                                           }
                                                           case "dock": {
                                                               panel.style.left = null;
                                                               panel.style.top = null;
                                                               panel.classList.add("docked");
                                                               break;
                                                           }
                                                           case "hide": {
                                                               hidePanel(panel);
                                                               panel = null;
                                                               break;
                                                           }
                                                       }
                                                   };
                                               }

                                               /**
                                                * @param {MouseEvent|KeyboardEvent} event
                                                */
                                               function deriveCoordinates(event) {
                                                   const target = /** @type HTMLElement */ (event.target);

                                                   // We prevent synthetic AT clicks from putting
                                                   // the dialog in a weird place. The AT events sometimes
                                                   // lack coordinates, so they have clientX/Y = 0
                                                   const rect = target.getBoundingClientRect();
                                                   if (
                                                       event instanceof MouseEvent &&
                                                       event.clientX >= rect.left &&
                                                       event.clientY >= rect.top
                                                   ) {
                                                       // The event probably happened inside the bounding rect...
                                                       return { x: event.clientX, y: event.clientY };
                                                   }

                                                   // Offset to the middle of the element
                                                   const x = rect.x + rect.width / 2;
                                                   // Placed at the bottom of the element
                                                   const y = rect.y + rect.height;
                                                   return { x, y };
                                               }

                                               /**
                                                * @param {Event} event
                                                */
                                               function deriveAction(event) {
                                                   const target = /** @type {HTMLElement} */ (event.target);
                                                   const hitALink = !!target.closest("a");
                                                   if (target.closest("dfn:not([data-cite]), .index-term")) {
                                                       return hitALink ? "none" : "show";
                                                   }
                                                   if (target.closest(".dfn-panel")) {
                                                       if (hitALink) {
                                                           return target.classList.contains("self-link") ? "hide" : "dock";
                                                       }
                                                       const panel = target.closest(".dfn-panel");
                                                       return panel.classList.contains("docked") ? "hide" : "none";
                                                   }
                                                   if (document.querySelector(".dfn-panel:not([hidden])")) {
                                                       return "hide";
                                                   }
                                                   return "none";
                                               }

                                               /**
                                                * @param {HTMLElement} dfn
                                                * @param {HTMLElement} panel
                                                * @param {{ x: number, y: number }} clickPosition
                                                */
                                               function displayPanel(dfn, panel, { x, y }) {
                                                   panel.hidden = false;
                                                   // distance (px) between edge of panel and the pointing triangle (caret)
                                                   const MARGIN = 20;

                                                   const dfnRects = dfn.getClientRects();
                                                   // Find the `top` offset when the `dfn` can be spread across multiple lines
                                                   let closestTop = 0;
                                                   let minDiff = Infinity;
                                                   for (const rect of dfnRects) {
                                                       const { top, bottom } = rect;
                                                       const diffFromClickY = Math.abs((top + bottom) / 2 - y);
                                                       if (diffFromClickY < minDiff) {
                                                           minDiff = diffFromClickY;
                                                           closestTop = top;
                                                       }
                                                   }

                                                   const top = window.scrollY + closestTop + dfnRects[0].height;
                                                   const left = x - MARGIN;
                                                   panel.style.left = `${left}px`;
                                                   panel.style.top = `${top}px`;

                                                   // Find if the panel is flowing out of the window
                                                   const panelRect = panel.getBoundingClientRect();
                                                   const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
                                                   if (panelRect.right > SCREEN_WIDTH) {
                                                       const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
                                                       const newCaretOffset = left - newLeft;
                                                       panel.style.left = `${newLeft}px`;
                                                       /** @type {HTMLElement} */
                                                       const caret = panel.querySelector(".caret");
                                                       caret.style.left = `${newCaretOffset}px`;
                                                   }

                                                   // As it's a dialog, we trap focus.
                                                   // TODO: when <dialog> becomes a implemented, we should really
                                                   // use that.
                                                   trapFocus(panel, dfn);
                                               }

                                               /**
                                                * @param {HTMLElement} panel
                                                * @param {HTMLElement} dfn
                                                * @returns
                                                */
                                               function trapFocus(panel, dfn) {
                                                   /** @type NodeListOf<HTMLAnchorElement> elements */
                                                   const anchors = panel.querySelectorAll("a[href]");
                                                   // No need to trap focus
                                                   if (!anchors.length) return;

                                                   // Move focus to first anchor element
                                                   const first = anchors.item(0);
                                                   first.focus();

                                                   const trapListener = createTrapListener(anchors, panel, dfn);
                                                   panel.addEventListener("keydown", trapListener);

                                                   // Hiding the panel releases the trap
                                                   const mo = new MutationObserver(records => {
                                                       const [record] = records;
                                                       const target = /** @type HTMLElement */ (record.target);
                                                       if (target.hidden) {
                                                           panel.removeEventListener("keydown", trapListener);
                                                           mo.disconnect();
                                                       }
                                                   });
                                                   mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
                                               }

                                               /**
                                                *
                                                * @param {NodeListOf<HTMLAnchorElement>} anchors
                                                * @param {HTMLElement} panel
                                                * @param {HTMLElement} dfn
                                                * @returns
                                                */
                                               function createTrapListener(anchors, panel, dfn) {
                                                   const lastIndex = anchors.length - 1;
                                                   let currentIndex = 0;
                                                   return event => {
                                                       switch (event.key) {
                                                           // Hitting "Tab" traps us in a nice loop around elements.
                                                           case "Tab": {
                                                               event.preventDefault();
                                                               currentIndex += event.shiftKey ? -1 : +1;
                                                               if (currentIndex < 0) {
                                                                   currentIndex = lastIndex;
                                                               } else if (currentIndex > lastIndex) {
                                                                   currentIndex = 0;
                                                               }
                                                               anchors.item(currentIndex).focus();
                                                               break;
                                                           }

                                                           // Hitting "Enter" on an anchor releases the trap.
                                                           case "Enter":
                                                               hidePanel(panel);
                                                               break;

                                                           // Hitting "Escape" returns focus to dfn.
                                                           case "Escape":
                                                               hidePanel(panel);
                                                               dfn.focus();
                                                               return;
                                                       }
                                                   };
                                               }

                                               /** @param {HTMLElement} panel */
                                               function hidePanel(panel) {
                                                   if (!panel) return;
                                                   panel.hidden = true;
                                                   panel.classList.remove("docked");
                                               }
                                           })()</script>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <script src="/dropdown.js"></script>
</body>

</html>