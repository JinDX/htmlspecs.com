<!doctype html>
<html lang="zh-hans">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>清除站点数据</title>
    <meta content="WD" name="w3c-status">
    <!-- <meta content="Bikeshed version fbf1456a756299b3ff6d248d0857ec87f2e68cd7" name="generator"> -->
    <link href="https://www.w3.org/TR/clear-site-data/" rel="canonical">
    <!-- <meta content="1254b534c550ee719bf3d88552ed86d218b7c7de" name="document-revision"> -->
    <style>
        /* style-md-lists */

        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* style-counters */

        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* style-dfn-panel */

        .dfn-panel {
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            width: fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #DDDDDD;
            color: black;
            border: outset 0.2em;
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: black;
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0;
        }

        .dfn-panel li {
            list-style: inside;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled {
            cursor: pointer;
        }
    </style>
    <style>
        /* style-selflinks */

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: gray;
            color: white;
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: black;
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <style>
        /* style-autolinks */

        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: #005a9c;
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-WD" rel="stylesheet" type="text/css">

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"> </a> </p>
        <h1>清除站点数据</h1>
        <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">W3C 工作草案，<time
                    class="dt-updated" datetime="2017-11-30">2017年11月30日</time></span></h2>
        <div data-fill-with="spec-metadata">
            <dl>
                <dt>本版本：
                <dd><a class="u-url"
                        href="https://www.w3.org/TR/2017/WD-clear-site-data-20171130/">https://www.w3.org/TR/2017/WD-clear-site-data-20171130/</a>
                <dt>最新发布版本：
                <dd><a href="https://www.w3.org/TR/clear-site-data/">https://www.w3.org/TR/clear-site-data/</a>
                <dt>编辑草案：
                <dd><a
                        href="https://w3c.github.io/webappsec-clear-site-data/">https://w3c.github.io/webappsec-clear-site-data/</a>
                <dt>历史版本：
                <dd><a href="https://www.w3.org/TR/2016/WD-clear-site-data-20160720/"
                        rel="prev">https://www.w3.org/TR/2016/WD-clear-site-data-20160720/</a>
                <dt>版本历史：
                <dd><a
                        href="https://github.com/w3c/webappsec-clear-site-data/commits/master/index.src.html">https://github.com/w3c/webappsec-clear-site-data/commits/master/index.src.html</a>
                <dt>反馈：
                <dd><span><a
                            href="mailto:public-webappsec@w3.org?subject=%5Bclear-site-data%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a>
                        ，主题为 “<kbd>[clear-site-data] <i data-lt="">… message topic …</i></kbd>” (<a
                            href="https://lists.w3.org/Archives/Public/public-webappsec/"
                            rel="discussion">邮件存档</a>)</span>
                <dt class="editor">编辑：
                <dd class="editor p-author h-card vcard" data-editor-id="56384"><a class="p-name fn u-email email"
                        href="mailto:mkwst@google.com">Mike West</a> (<span class="p-org org">Google Inc.</span>)
                <dt>参与讨论：
                <dd><a href="https://github.com/w3c/webappsec-clear-site-data/issues/new">提交 issue</a> (<a
                        href="https://github.com/w3c/webappsec-clear-site-data/issues">查看已开放的 issue</a>)
            </dl>
        </div>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a
                href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2017 <a
                href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a
                href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a
                href="https://www.ercim.eu/"><abbr
                    title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a
                href="https://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a
                href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a
                href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a
                href="https://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply. </p>
        <hr title="Separator for header">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">摘要</span></h2>
        <p>本文档定义了一种命令式机制，允许 Web 开发者指示用户代理清除与某个主机相关的本地存储数据。</p>
    </div>
    <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">本文档状态</span>
    </h2>
    <div data-fill-with="status">
        <p> <em>本节描述了本文档发布时的状态。其他文档可能会取代本文档。当前 W3C 发布的文档列表以及本技术报告的最新修订版可在 <a href="https://www.w3.org/TR/">W3C 技术报告索引
                    https://www.w3.org/TR/</a> 找到。</em> </p>
        <p> 本文档由 <a href="https://www.w3.org/2011/webappsec/">Web 应用安全工作组</a> 作为工作草案发布。本文档预期成为 W3C 推荐标准。 </p>
        <p> (<a href="https://lists.w3.org/Archives/Public/public-webappsec/">存档</a>) 的公共邮件列表 <a
                href="mailto:public-webappsec@w3.org?Subject=%5Bclear-site-data%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a>
            （参见 <a href="https://www.w3.org/Mail/Request">说明</a>）
            是对本规范进行讨论的首选方式。
            发送邮件时，
            请在主题中包含 “clear-site-data”，
            最好如下所示：
            “[clear-site-data] <em>…评论摘要…</em>” </p>
        <p> 作为工作草案发布不代表 W3C 会员的认可。该文档为草案，可能随时更新、替换或被其他文档废弃。不应将其作为正式成果引用，仅作为在研工作。 </p>
        <p> 本文档由 <a href="https://www.w3.org/2011/webappsec/">Web 应用安全工作组</a> 产生。 </p>
        <p> 本文档由依据 <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/">2004 年 2 月 5 日 W3C 专利政策</a> 运行的团队产生。
            W3C 维护了一份 <a href="https://www.w3.org/2004/01/pp-impl/49309/status" rel="disclosure">与本组交付物有关的专利公开的公开列表</a>；
            该页面还包含专利披露的说明。
            如个人确实知悉其所掌握的专利包含 <a
                href="https://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">必要权利要求</a>，则必须按照 <a
                href="https://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">W3C 专利政策第 6 节</a> 进行披露。 </p>
        <p> 本文档受 <a href="https://www.w3.org/2017/Process-20170301/" id="w3c_process_revision">2017 年 3 月 1 日 W3C
                流程文档</a> 管辖。 </p>
        <p></p>
    </div>
    <div data-fill-with="at-risk"></div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目录</h2>
        <ol class="toc" role="directory">
            <li>
                <a href="#intro"><span class="secno">1</span> <span class="content">介绍</span></a>
                <ol class="toc">
                    <li>
                        <a href="#examples"><span class="secno">1.1</span> <span class="content">示例</span></a>
                        <ol class="toc">
                            <li><a href="#example-signout"><span class="secno">1.1.1</span> <span
                                        class="content">注销</span></a>
                            <li><a href="#example-targeted"><span class="secno">1.1.2</span> <span
                                        class="content">定向清除</span></a>
                            <li><a href="#example-keepcookies"><span class="secno">1.1.3</span> <span
                                        class="content">保留关键 Cookie</span></a>
                            <li><a href="#example-killswitch"><span class="secno">1.1.4</span> <span
                                        class="content">紧急开关</span></a>
                        </ol>
                    <li><a href="#goals"><span class="secno">1.2</span> <span class="content">目标</span></a>
                </ol>
            <li><a href="#infra"><span class="secno">2</span> <span class="content">基础设施</span></a>
            <li>
                <a href="#clearing"><span class="secno">3</span> <span class="content">清除站点数据</span></a>
                <ol class="toc">
                    <li><a href="#header"><span class="secno">3.1</span> <span class="content">
                                <code>Clear-Site-Data</code> HTTP 响应头字段 </span></a>
                    <li><a href="#fetch-integration"><span class="secno">3.2</span> <span class="content">Fetch
                                集成</span></a>
                </ol>
            <li>
                <a href="#algorithms"><span class="secno">4</span> <span class="content">算法</span></a>
                <ol class="toc">
                    <li><a href="#parsing"><span class="secno">4.1</span> <span class="content">解析</span></a>
                    <li>
                        <a href="#clear-response"><span class="secno">4.2</span> <span class="content">为
                                <var>response</var> 清除数据 </span></a>
                        <ol class="toc">
                            <li><a href="#prepare"><span class="secno">4.2.1</span> <span class="content">准备为
                                        <var>origin</var> 清除数据 </span></a>
                            <li><a href="#reload-contexts"><span class="secno">4.2.2</span> <span class="content">重新加载
                                        <var>browsing contexts</var> </span></a>
                            <li><a href="#clear-cache"><span class="secno">4.2.3</span> <span class="content">清除
                                        <var>origin</var> 的缓存 </span></a>
                            <li><a href="#clear-cookies"><span class="secno">4.2.4</span> <span class="content">清除
                                        <var>origin</var> 的 Cookie </span></a>
                            <li><a href="#clear-dom"><span class="secno">4.2.5</span> <span class="content">清除
                                        <var>origin</var> 的 DOM 可访问存储 </span></a>
                        </ol>
                </ol>
            <li>
                <a href="#security"><span class="secno">5</span> <span class="content">安全注意事项</span></a>
                <ol class="toc">
                    <li><a href="#incomplete"><span class="secno">5.1</span> <span class="content">清除不彻底</span></a>
                    <li><a href="#service-workers"><span class="secno">5.2</span> <span class="content">Service
                                worker</span></a>
                </ol>
            <li>
                <a href="#privacy"><span class="secno">6</span> <span class="content">隐私注意事项</span></a>
                <ol class="toc">
                    <li><a href="#user-vs-author"><span class="secno">6.1</span> <span class="content">Web
                                开发者控制时机。</span></a>
                    <li><a href="#remnants"><span class="secno">6.2</span> <span class="content">磁盘上的数据残留。</span></a>
                </ol>
            <li>
                <a href="#iana-considerations"><span class="secno">7</span> <span class="content">IANA 注意事项</span></a>
                <ol class="toc">
                    <li><a href="#iana-clear-site-data"><span class="secno">7.1</span> <span class="content">
                                Clear-Site-Data </span></a>
                </ol>
            <li><a href="#acknowledgements"><span class="secno">8</span> <span class="content">致谢</span></a>
            <li>
                <a href="#conformance"><span class="secno"></span> <span class="content">一致性</span></a>
                <ol class="toc">
                    <li><a href="#conventions"><span class="secno"></span> <span class="content">文档约定</span></a>
                    <li><a href="#conformant-algorithms"><span class="secno"></span> <span
                                class="content">合规算法</span></a>
                </ol>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本规范定义的术语</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">引用定义的术语</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考文献</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">规范性引用</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">说明性引用</span></a>
                </ol>
            <li><a href="#issues-index"><span class="secno"></span> <span class="content">问题索引</span></a>
        </ol>
    </nav>
    <main>
        <section>
            <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span
                    class="content">介绍</span><a class="self-link" href="#intro"></a></h2>
            <p><em>本节不具规范性。</em></p>
            <p>Web 应用程序会将数据存储在用户本地计算机上，以便在用户离线时提供功能，并在用户在线时提升性能。这些本地缓存对用户和开发者都带来了显著优势，但同样也存在风险。</p>
            <p>用户的数据既敏感又有价值；Web 开发者应当采取合理措施予以保护。可以采取的措施之一是，在存储前加密数据。另一个措施是在数据不再需要时（例如用户退出应用或删除账号时）从用户设备上移除数据。</p>
            <p>站点作者可以通过 JavaScript 移除多种存储机制中的数据，但某些机制难以可靠处理。例如，Cookie 可以通过 JavaScript 访问 <code>document.cookie</code>
                部分清除，但 <code>HttpOnly</code> Cookie 只能通过 HTTP 响应中的多个 <code>Set-Cookie</code> 头来移除。这需要对主机设置的所有 Cookie
                了如指掌，而这通常很复杂。缓存则更难，没有命令式接口可直接操作浏览器的网络缓存。</p>
            <p>本文档定义了一种新机制，用以移除这些及其它类型本地存储中的数据，使 Web 开发者能够通过 <a data-link-type="http-header"
                    href="#http-headerdef-clear-site-data"
                    id="ref-for-http-headerdef-clear-site-data">Clear-Site-Data</a> HTTP 响应头清除用户本地缓存数据。</p>
            <h3 class="heading settled" data-level="1.1" id="examples"><span class="secno">1.1. </span><span
                    class="content">示例</span><a class="self-link" href="#examples"></a></h3>
            <h4 class="heading settled" data-level="1.1.1" id="example-signout"><span class="secno">1.1.1. </span><span
                    class="content">注销</span><a class="self-link" href="#example-signout"></a></h4>
            <div class="example" id="example-49c6d404">
                <a class="self-link" href="#example-49c6d404"></a> 用户通过携带 CSRF 防护的 POST 请求
                <code>https://supersecretsocialnetwork.example.com/logout</code> 退出 “超级机密社交网络”，站点作者希望确保本地存储数据因此被移除。
                <p>他们可以在响应中发送如下 HTTP 头实现此目的：</p>
                <pre><a data-link-type="http-header" href="#http-headerdef-clear-site-data" id="ref-for-http-headerdef-clear-site-data①">Clear-Site-Data</a>: "<a data-link-type="grammar" href="#grammardef-cache" id="ref-for-grammardef-cache">cache</a>", "<a data-link-type="grammar" href="#grammardef-cookies" id="ref-for-grammardef-cookies">cookies</a>", "<a data-link-type="grammar" href="#grammardef-storage" id="ref-for-grammardef-storage">storage</a>", "<a data-link-type="grammar" href="#grammardef-executioncontexts" id="ref-for-grammardef-executioncontexts">executionContexts</a>"
</pre>
            </div>
            <h4 class="heading settled" data-level="1.1.2" id="example-targeted"><span class="secno">1.1.2. </span><span
                    class="content">定向清除</span><a class="self-link" href="#example-targeted"></a></h4>
            <div class="example" id="example-46539dbc">
                <a class="self-link" href="#example-46539dbc"></a> 用户通过携带 CSRF 防护的 POST 请求
                <code>https://megacorp.example.com/logout</code> 退出 Megacorp Inc. 站点。Megacorp
                有大量子域服务，数量之多导致退出后哪些子域的数据可以安全清除并不清楚。有个选择是全部清除，之后应对各种副作用。然而 Megacorp 的 CEO 曾因误清数据导致在“Irate
                Ibexes”游戏中损失大量进度，因此坚决反对对用户造成如此大影响。
                <p>不过，开发者知道 “Minus” 应用的数据肯定可以被安全清除。可以在注销落地页中，专门针对该子域发起请求（最好是 CORS 支持且有 CSRF 防护的 POST）：</p>
                <pre>fetch("https://minus.megacorp.example.com/clear-site-data",
      {
          method: "POST",
          mode: "cors",
          headers: new Headers({
              "CSRF": "[<em>insert sekrit token here</em>]"
          })
      });
</pre>
                <p>该端点会响应合适的 CORS 头，并对实际请求返回如下响应头：</p>
                <pre><a data-link-type="http-header" href="#http-headerdef-clear-site-data" id="ref-for-http-headerdef-clear-site-data②">Clear-Site-Data</a>: "<a data-link-type="grammar" href="#grammardef-cache" id="ref-for-grammardef-cache①">cache</a>", "<a data-link-type="grammar" href="#grammardef-cookies" id="ref-for-grammardef-cookies①">cookies</a>", "<a data-link-type="grammar" href="#grammardef-storage" id="ref-for-grammardef-storage①">storage</a>", "<a data-link-type="grammar" href="#grammardef-executioncontexts" id="ref-for-grammardef-executioncontexts①">executionContexts</a>"
</pre>
            </div>
            <h4 class="heading settled" data-level="1.1.3" id="example-keepcookies"><span class="secno">1.1.3.
                </span><span class="content">保留关键 Cookie</span><a class="self-link" href="#example-keepcookies"></a>
            </h4>
            <div class="example" id="example-d9204fbb">
                <a class="self-link" href="#example-d9204fbb"></a> 用户通过携带 CSRF 防护的 POST 请求
                <code>https://ads-are-awesome.example.com/optout</code> 选择退出兴趣定向广告。站点作者希望移除可能包含跟踪信息的 DOM
                可访问数据，但又要确保用户刚获得的退出 Cookie 不会被清除。
                <p>他们可在响应中发送以下 HTTP 头，仅包含除 "<a data-link-type="grammar" href="#grammardef-cookies"
                        id="ref-for-grammardef-cookies②">cookies</a>" 以外的所有类型：</p>
                <pre><a data-link-type="http-header" href="#http-headerdef-clear-site-data" id="ref-for-http-headerdef-clear-site-data③">Clear-Site-Data</a>: "<a data-link-type="grammar" href="#grammardef-cache" id="ref-for-grammardef-cache②">cache</a>", "<a data-link-type="grammar" href="#grammardef-storage" id="ref-for-grammardef-storage②">storage</a>", "<a data-link-type="grammar" href="#grammardef-executioncontexts" id="ref-for-grammardef-executioncontexts②">executionContexts</a>"
</pre>
            </div>
            <h4 class="heading settled" data-level="1.1.4" id="example-killswitch"><span class="secno">1.1.4.
                </span><span class="content">紧急开关</span><a class="self-link" href="#example-killswitch"></a></h4>
            <div class="example" id="example-d2647715">
                <a class="self-link" href="#example-d2647715"></a> “超级机密社交网络”
                的开发者发现站点存在跨站脚本攻击漏洞，可能被恶意方注入任意代码。他们修复了漏洞，并添加了强 Content Security Policy <a data-link-type="biblio"
                    href="#biblio-csp">[CSP]</a> 以降低风险，但无法百分百确保客户端恢复到可信状态。也许攻击者有某种巧妙持久化手段？
                <p>他们可以在响应中发送如下 HTTP 头，清除本地所有数据源，从而降低持久型客户端 XSS 风险：</p>
                <pre><a data-link-type="http-header" href="#http-headerdef-clear-site-data" id="ref-for-http-headerdef-clear-site-data④">Clear-Site-Data</a>: "<a data-link-type="grammar" href="#grammardef-cache" id="ref-for-grammardef-cache③">cache</a>", "<a data-link-type="grammar" href="#grammardef-cookies" id="ref-for-grammardef-cookies③">cookies</a>", "<a data-link-type="grammar" href="#grammardef-storage" id="ref-for-grammardef-storage③">storage</a>", "<a data-link-type="grammar" href="#grammardef-executioncontexts" id="ref-for-grammardef-executioncontexts③">executionContexts</a>"
</pre>
                <p class="note" role="note"><span>注意：</span>安装 Service Worker 后，浏览器每隔约 24 小时会向服务器发起一次请求。这种更新 ping
                    很适合在出现重大事故时发送如上的清除头。<a data-link-type="biblio" href="#biblio-service-workers">[SERVICE-WORKERS]</a>
                </p>
            </div>
            <h3 class="heading settled" data-level="1.2" id="goals"><span class="secno">1.2. </span><span
                    class="content">目标</span><a class="self-link" href="#goals"></a></h3>
            <p>总体目标是让 Web 开发者能更好地控制用户代理为其 origin 本地存储的数据。特别是，开发者应该能够可靠实现以下各点：</p>
            <ol>
                <li data-md="">
                    <p>origin 客户端本地存储机制的数据（如 <a data-link-type="biblio"
                            href="#biblio-indexeddb">[INDEXEDDB]</a>、WebSQL、Filesystem、<code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webstorage.html#dom-localstorage" id="ref-for-dom-localstorage">localStorage</a></code>
                        及 <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webstorage.html#dom-sessionstorage" id="ref-for-dom-sessionstorage">sessionStorage</a></code>）被清除。
                    </p>
                <li data-md="">
                    <p>origin 主机的 Cookie 被移除 <a data-link-type="biblio" href="#biblio-rfc6265">[RFC6265]</a>。</p>
                <li data-md="">
                    <p>为 origin 运行的 Web Worker（专用和共享）被终止。</p>
                <li data-md="">
                    <p>为 origin 注册的 Service Worker 被终止并注销。</p>
                <li data-md="">
                    <p>origin 的资源被移除出用户代理的本地缓存。</p>
                <li data-md="">
                    <p>以上所有操作可传播到对应 HTTPS origin 的 HTTP 版本。</p>
                <li data-md="">
                    <p>上述措施无法被恶意活动文档绕过，也不会因感兴趣数据驻留内存并在清除后重写而失效。</p>
            </ol>
        </section>
        <section>
            <h2 class="heading settled" data-level="2" id="infra"><span class="secno">2. </span><span
                    class="content">基础设施</span><a class="self-link" href="#infra"></a></h2>
            <p>本文档采用 ABNF 语法描述格式，具体定义见 <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a>，更新见 <a
                    data-link-type="biblio" href="#biblio-rfc7405">[RFC7405]</a>，并用到了 <a
                    href="https://tools.ietf.org/html/rfc7230#section-7">RFC7230 第7节</a>中定义的 <code>#rule</code>
                扩展，以及该文档第 3.2.6 节定义的 <code>quoted-string</code> 规则。</p>
            <p>本文档算法及正文多项基础概念依赖于 Infra 标准 <a data-link-type="biblio" href="#biblio-infra">[INFRA]</a>。</p>
        </section>
        <section>
            <h2 class="heading settled" data-level="3" id="clearing"><span class="secno">3. </span><span
                    class="content">清除站点数据</span><a class="self-link" href="#clearing"></a></h2>
            <p>开发者可以通过在响应中返回 <code>Clear-Site-Data</code> HTTP 响应头，指示用户代理清除各种类型的相关数据。</p>
            <h3 class="heading settled" data-level="3.1" id="header"><span class="secno">3.1. </span><span
                    class="content"> <code>Clear-Site-Data</code> HTTP 响应头字段 </span><a class="self-link"
                    href="#header"></a></h3>
            <p><dfn class="dfn-paneled" data-dfn-type="http-header" data-export=""
                    id="http-headerdef-clear-site-data"><code>Clear-Site-Data</code></dfn> HTTP
                响应头字段向用户代理发送信号，告知其应移除某一类型集合的所有数据。该头字段的语法如下：</p>
            <pre class="abnf">Clear-Site-Data = 1#( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230https://tools.ietf.org/html/rfc7230#section-3.2.6" id="ref-for-section-3.2.6">quoted-string</a> )
; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-7" id="ref-for-section-7">#rule</a> 在 RFC 7230 第 7 节定义。
</pre>
            <p><a href="#fetch-integration">§3.2 Fetch 集成</a> 和 <a href="#parsing">§4.1 解析</a> 描述了 <a
                    data-link-type="http-header" href="#http-headerdef-clear-site-data"
                    id="ref-for-http-headerdef-clear-site-data⑤">Clear-Site-Data</a> 头的处理方式。</p>
            <p>本文档定义了一组可通过该机制清除的基础数据类型。参见下方各自描述。未来版本该头可支持更多数据类型，这些类型必须符合 <a data-link-type="grammar"
                    href="https://tools.ietf.org/html/rfc7230https://tools.ietf.org/html/rfc7230#section-3.2.6"
                    id="ref-for-section-3.2.6①">quoted-string</a> 语法。用户代理在解析头字段时必须忽略未知类型。</p>
            <dl>
                <dt data-md="">"<dfn class="dfn-paneled" data-dfn-type="grammar" data-export=""
                        id="grammardef-cache"><code>cache</code></dfn>"
                <dd data-md="">
                    <p>"<code>cache</code>" 类型表示服务器希望移除与某个 <a data-link-type="dfn"
                            href="https://tools.ietf.org/html/rfc6454#section-3.2" id="ref-for-section-3.2">origin</a>
                        相关的本地缓存数据，该 origin 来源于特定 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-response"
                            id="ref-for-concept-response">response</a> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-response-url"
                            id="ref-for-concept-response-url">url</a>。这包括 <a data-link-type="dfn"
                            href="https://tools.ietf.org/html/rfc7234#section-2"
                            id="ref-for-section-2">网络缓存</a>，也会移除用户代理实现的其他缓存数据（预渲染页面、脚本缓存、着色器缓存等）。</p>
                    <p>实现细节参见 <a href="#clear-cache">§4.2.3 清除缓存</a>。</p>
                    <div class="example" id="example-f74a3235">
                        <a class="self-link" href="#example-f74a3235"></a> 当配合 <code>https://example.com/clear</code>
                        的响应发送时，下列头部将导致与 <code>https://example.com</code> 关联的缓存被清除：
                        <pre><a data-link-type="http-header" href="#http-headerdef-clear-site-data" id="ref-for-http-headerdef-clear-site-data⑥">Clear-Site-Data</a>: "<a data-link-type="grammar" href="#grammardef-cache" id="ref-for-grammardef-cache④">cache</a>"
</pre>
                    </div>
                    <p class="note" role="note"><span>注意：</span> 缓存通常不是按 origin 组织的，而是按 URL 及时间戳。这意味着在实际中，按 origin
                        清除缓存可能需要线性扫描。对于大型缓存，这会成为极其消耗资源的操作。</p>
                <dt data-md="">"<dfn class="dfn-paneled" data-dfn-type="grammar" data-export=""
                        id="grammardef-cookies"><code>cookies</code></dfn>"
                <dd data-md="">
                    <p>"<code>cookies</code>" 类型表示服务器希望移除与特定 <a data-link-type="dfn"
                            href="https://tools.ietf.org/html/rfc6454#section-3.2" id="ref-for-section-3.2①">origin</a>
                        相关的 cookies，该 origin 来源于 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-response"
                            id="ref-for-concept-response①">response</a> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-response-url"
                            id="ref-for-concept-response-url①">url</a>。除 cookies 外，HTTP 身份验证凭据 <a
                            data-link-type="biblio" href="#biblio-rfc7235">[RFC7235]</a> 及如 CHANNELID 和 TOKBIND 等 origin
                        绑定的令牌也会被同时移除。</p>
                    <p>实现细节参见 <a href="#clear-cookies">§4.2.4 清除 cookies</a>。</p>
                    <div class="example" id="example-54e5f977">
                        <a class="self-link" href="#example-54e5f977"></a> 当配合 <code>https://example.com/clear</code>
                        的响应发送时，下列头部会清除与 <code>https://example.com</code> 关联的 cookies，也会清除同一注册域内任意 origin（如
                        <code>https://www.example.com/</code> 和 <code>https://more.subdomains.example.com/</code>）的
                        cookies。
                        <pre><a data-link-type="http-header" href="#http-headerdef-clear-site-data" id="ref-for-http-headerdef-clear-site-data⑦">Clear-Site-Data</a>: "<a data-link-type="grammar" href="#grammardef-cookies" id="ref-for-grammardef-cookies④">cookies</a>"
</pre>
                    </div>
                <dt data-md="">"<dfn class="dfn-paneled" data-dfn-type="grammar" data-export=""
                        id="grammardef-storage"><code>storage</code></dfn>"
                <dd data-md="">
                    <p>"<code>storage</code>" 类型表示服务器希望移除与特定 <a data-link-type="dfn"
                            href="https://tools.ietf.org/html/rfc6454#section-3.2" id="ref-for-section-3.2②">origin</a>
                        关联的本地存储数据，
                        该 origin 来源于 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
                            id="ref-for-concept-response②">response</a> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-response-url"
                            id="ref-for-concept-response-url②">url</a>。这包括如 (<code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webstorage.html#dom-localstorage" id="ref-for-dom-localstorage①">localStorage</a></code>、
                        <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webstorage.html#dom-sessionstorage" id="ref-for-dom-sessionstorage①">sessionStorage</a></code>、
                        <a data-link-type="biblio" href="#biblio-indexeddb">[INDEXEDDB]</a>、<a data-link-type="biblio"
                            href="#biblio-webdatabase">[WEBDATABASE]</a> 等机制，以及与之相关的如 <a data-link-type="dfn"
                            href="https://w3c.github.io/ServiceWorker/#dfn-service-worker-registration"
                            id="ref-for-dfn-service-worker-registration">service worker 注册</a>。
                    </p>
                    <p>实现细节参见 <a href="#clear-dom">§4.2.5 清除 DOM 可访问存储</a>。</p>
                    <div class="example" id="example-cc066205">
                        <a class="self-link" href="#example-cc066205"></a> 当配合 <code>https://example.com/clear</code>
                        的响应发送时，下列头部会导致该 origin 的 DOM 可访问存储被清除：
                        <pre><a data-link-type="http-header" href="#http-headerdef-clear-site-data" id="ref-for-http-headerdef-clear-site-data⑧">Clear-Site-Data</a>: "<a data-link-type="grammar" href="#grammardef-storage" id="ref-for-grammardef-storage④">storage</a>"
</pre>
                    </div>
                <dt data-md="">"<dfn class="dfn-paneled" data-dfn-type="grammar" data-export=""
                        id="grammardef-executioncontexts"><code>executionContexts</code></dfn>"
                <dd data-md="">
                    <p>"<code>executionContexts</code>" 类型表示服务器希望使当前渲染该 <a data-link-type="dfn"
                            href="https://tools.ietf.org/html/rfc6454#section-3.2" id="ref-for-section-3.2③">origin</a>
                        的执行上下文失效并重新加载，
                        该 origin 来源于 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
                            id="ref-for-concept-response③">response</a> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-response-url"
                            id="ref-for-concept-response-url③">url</a>。</p>
                    <div class="example" id="example-b8b629a3">
                        <a class="self-link" href="#example-b8b629a3"></a> 当配合 <code>https://example.com/clear</code>
                        的响应发送时，下列头部会使显示 <code>https://example.com</code> 的执行上下文失效并重新加载：
                        <pre><a data-link-type="http-header" href="#http-headerdef-clear-site-data" id="ref-for-http-headerdef-clear-site-data⑨">Clear-Site-Data</a>: "<a data-link-type="grammar" href="#grammardef-executioncontexts" id="ref-for-grammardef-executioncontexts④">executionContexts</a>"
</pre>
                    </div>
                <dt data-md="">"<dfn class="dfn-paneled" data-dfn-type="grammar" data-export=""
                        id="grammardef-"><code>*</code></dfn>"
                <dd data-md="">
                    <p>"<code>*</code>"（通配符）伪类型表示其效果等同于指定所有类型。</p>
                    <div class="example" id="example-06da2e13">
                        <a class="self-link" href="#example-06da2e13"></a> 当配合 <code>https://example.com/clear</code>
                        的响应发送时，下列头部会导致与 <code>https://example.com</code> 相关的所有 cookies、缓存、本地存储被清除，且相关执行上下文失效并重新加载：
                        <pre><a data-link-type="http-header" href="#http-headerdef-clear-site-data" id="ref-for-http-headerdef-clear-site-data①⓪">Clear-Site-Data</a>: "<a data-link-type="grammar" href="#grammardef-" id="ref-for-grammardef-">*</a>"
</pre>
                    </div>
                    <div class="note" role="note">
                        <p> 注意：通配符具备向前兼容性，即若将来头字段新增更多数据类型，通配符也会涵盖这些类型。 </p>
                        <p> 若意图进行广泛清理（即清除该头能知晓下所有数据类型），请务必使用通配符。 </p>
                        <p> 请勿将通配符作为上面四种类型的快捷写法，因为该语义未来可能发生变化。 </p>
                    </div>
            </dl>
            <p class="note" role="note"><span>注意：</span> 此处定义的语法与未来对类型过滤机制的扩展兼容。例如，"<a data-link-type="grammar"
                    href="#grammardef-cookies" id="ref-for-grammardef-cookies⑤"><code>cookies</code></a>" 很可能将来需增加防止个别
                cookie 被删除的机制。所有类型名用双引号包裹，使我们可无缝从简单字符串分割升级为 JSON 处理而不破坏兼容性。</p>
            <h3 class="heading settled" data-level="3.2" id="fetch-integration"><span class="secno">3.2. </span><span
                    class="content">Fetch 集成</span><a class="self-link" href="#fetch-integration"></a></h3>
            <p class="issue" id="issue-3ded38d3"><a class="self-link" href="#issue-3ded38d3"></a> 猴子补丁！与 Anne 沟通。</p>
            <p>若从网络获得的 HTTP <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
                    id="ref-for-concept-response④">response</a> 包含 <a data-link-type="http-header"
                    href="#http-headerdef-clear-site-data"
                    id="ref-for-http-headerdef-clear-site-data①①"><code>Clear-Site-Data</code></a>
                头，则必须在将响应渲染给用户前完成数据清除。即，在现有 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-http-network-fetch"
                    id="ref-for-concept-http-network-fetch">HTTP-network fetch</a> 算法的第 14 步后，执行下列步骤：</p>
            <ol start="15">
                <li data-md="">
                    <p>如果 <var>credentials flag</var> 被设定，且 <var>response</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-response-header-list"
                            id="ref-for-concept-response-header-list">头字段列表</a>包含名为 <a data-link-type="http-header"
                            href="#http-headerdef-clear-site-data"
                            id="ref-for-http-headerdef-clear-site-data①②"><code>Clear-Site-Data</code></a> 的头，则对
                        <var>response</var> 执行 <a href="#clear-response">§4.2 为响应清除数据</a>。
                    </p>
            </ol>
            <p class="note" role="note"><span>注意：</span> 该步骤发生在处理 <code>Set-Cookie</code> 头之后。清除 cookies
                时会全部清除，这一行为有意如此，因为只移除部分 cookie 可能导致应用处于不确定或脆弱状态。如需精确移除特定 cookies，应通过 <code>Set-Cookie</code> 头设置过期时间实现。
            </p>
            <p class="note" role="note"><span>注意：</span> 虽然 fetch 的 <code>credentials flag</code> 目的是限制对 cookies 的修改，<a
                    data-link-type="http-header" href="#http-headerdef-clear-site-data"
                    id="ref-for-http-headerdef-clear-site-data①③"><code>Clear-Site-Data</code></a> 出于一致性，对所有类型施加相同约束。
            </p>
            <section>
                <section>
                    <h2 class="heading settled" data-level="4" id="algorithms"><span class="secno">4. </span><span
                            class="content">算法</span><a class="self-link" href="#algorithms"></a></h2>
                    <h3 class="heading settled algorithm" data-algorithm="Parsing" data-level="4.1" id="parsing"><span
                            class="secno">4.1. </span><span class="content">解析</span><a class="self-link"
                            href="#parsing"></a></h3>
                    <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
                            id="ref-for-concept-response⑤">response</a>，用户代理可以<dfn class="dfn-paneled"
                            data-dfn-type="abstract-op" data-export="" data-local-lt="parse response"
                            data-lt="parse response’s Clear-Site-Data header"
                            id="abstract-opdef-parse-responses-clear-site-data-header">解析 <var>response</var> 的
                            <code>Clear-Site-Data</code> 头</dfn>，返回类型列表，步骤如下：</p>
                    <ol class="algorithm">
                        <li data-md="">
                            <p>令 <var>types</var> 为空列表。</p>
                        <li data-md="">
                            <p>令 <var>header</var> 为 <a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#extract-header-list-values"
                                    id="ref-for-extract-header-list-values">提取</a> <code>Clear-Site-Data</code> 和
                                <var>response</var> 的 <a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#concept-response-header-list"
                                    id="ref-for-concept-response-header-list①">头字段列表</a>的结果。
                            </p>
                        <li data-md="">
                            <p>如果 <var>header</var> 为 <code>null</code> 或失败，返回空列表。</p>
                        <li data-md="">
                            <p>对 <var>header</var> 中每个 <var>type</var>，逐条匹配如下分支：</p>
                            <dl>
                                <dt data-md="">`<code>"cache"</code>`
                                <dd data-md="">
                                    <p>将 "<a data-link-type="grammar" href="#grammardef-cache"
                                            id="ref-for-grammardef-cache⑤">cache</a>" 添加入 <var>types</var>。</p>
                                <dt data-md="">`<code>"cookies"</code>`
                                <dd data-md="">
                                    <p>将 "<a data-link-type="grammar" href="#grammardef-cookies"
                                            id="ref-for-grammardef-cookies⑥">cookies</a>" 添加入 <var>types</var>。</p>
                                <dt data-md="">`<code>"storage"</code>`
                                <dd data-md="">
                                    <p>将 "<a data-link-type="grammar" href="#grammardef-storage"
                                            id="ref-for-grammardef-storage⑤">storage</a>" 添加入 <var>types</var>。</p>
                                <dt data-md="">`<code>"executionContexts"</code>`
                                <dd data-md="">
                                    <p>将 "<a data-link-type="grammar" href="#grammardef-executioncontexts"
                                            id="ref-for-grammardef-executioncontexts⑤">executionContexts</a>" 添加入
                                        <var>types</var>。
                                    </p>
                                <dt data-md="">`<code>"*"</code>`
                                <dd data-md="">
                                    <p>将 "<a data-link-type="grammar" href="#grammardef-cache"
                                            id="ref-for-grammardef-cache⑥">cache</a>"、"<a data-link-type="grammar"
                                            href="#grammardef-cookies" id="ref-for-grammardef-cookies⑦">cookies</a>"、
                                        "<a data-link-type="grammar" href="#grammardef-storage"
                                            id="ref-for-grammardef-storage⑥">storage</a>"、
                                        以及 "<a data-link-type="grammar" href="#grammardef-executioncontexts"
                                            id="ref-for-grammardef-executioncontexts⑥">executionContexts</a>" 添加入
                                        <var>types</var>。
                                    </p>
                            </dl>
                        <li data-md="">
                            <p>返回 <var>types</var>。</p>
                    </ol>
                    <p class="note" role="note"><span>注意：</span> 当前所有值用上述分支即可覆盖。如后续类型定义更复杂，解析器届时会整体转用 JSON。</p>
                    <h3 class="heading settled algorithm" data-algorithm="Clear data for response" data-level="4.2"
                        id="clear-response"><span class="secno">4.2. </span><span class="content"> 为 <var>response</var>
                            清除数据 </span><a class="self-link" href="#clear-response"></a></h3>
                    <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
                            id="ref-for-concept-response⑥">response</a>（<var>response</var>），用户代理可以 <dfn
                            data-dfn-type="abstract-op" data-export="" data-lt="clear site data for response"
                            id="abstract-opdef-clear-site-data-for-response">为 <var>response</var> 清除站点数据<a
                                class="self-link" href="#abstract-opdef-clear-site-data-for-response"></a></dfn>，步骤如下：
                    </p>
                    <ol class="algorithm">
                        <li data-md="">
                            <p>如果 <var>response</var> 的 <a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#concept-response-url"
                                    id="ref-for-concept-response-url④">url</a> 不是 <a data-link-type="dfn"
                                    href="https://www.w3.org/TR/mixed-content/#a-priori-authenticated-url"
                                    id="ref-for-a-priori-authenticated-url"><i lang="la">a priori</i> 认证 URL</a>，则 <a
                                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-break"
                                    id="ref-for-iteration-break">break</a>。</p>
                        <li data-md="">
                            <p>令 <var>types</var> 为 <a data-link-type="abstract-op"
                                    href="#abstract-opdef-parse-responses-clear-site-data-header"
                                    id="ref-for-abstract-opdef-parse-responses-clear-site-data-header">解析
                                    <var>response</var> 的 <code>Clear-Site-Data</code> 头</a> 的结果。</p>
                        <li data-md="">
                            <p>令 <var>origin</var> 为 <var>response</var> 的 <a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#concept-response-url"
                                    id="ref-for-concept-response-url⑤">url</a> 的 <a data-link-type="dfn"
                                    href="https://url.spec.whatwg.org/#concept-url-origin"
                                    id="ref-for-concept-url-origin">origin</a>。</p>
                        <li data-md="">
                            <p>令 <var>browsing contexts</var> 为 <a data-link-type="abstract-op"
                                    href="#abstract-opdef-prepare-to-clear-origins-data"
                                    id="ref-for-abstract-opdef-prepare-to-clear-origins-data">准备为 <var>origin</var>
                                    清除数据</a> 的结果，参数为 <var>origin</var> 和 <var>types</var>。</p>
                        <li data-md="">
                            <p>对于 <var>types</var> 中每个 <var>type</var>，逐条执行匹配：</p>
                            <ol>
                                <li data-md="">
                                    <p>匹配分支如下：</p>
                                    <dl>
                                        <dt data-md="">"<a data-link-type="grammar" href="#grammardef-cache"
                                                id="ref-for-grammardef-cache⑦"><code>cache</code></a>"
                                        <dd data-md="">
                                            <p><a data-link-type="abstract-op"
                                                    href="#abstract-opdef-clear-cache-for-origin"
                                                    id="ref-for-abstract-opdef-clear-cache-for-origin">清除
                                                    <var>origin</var> 缓存</a>。</p>
                                        <dt data-md="">"<a data-link-type="grammar" href="#grammardef-cookies"
                                                id="ref-for-grammardef-cookies⑧"><code>cookies</code></a>"
                                        <dd data-md="">
                                            <p><a data-link-type="abstract-op"
                                                    href="#abstract-opdef-clear-cookies-for-origin"
                                                    id="ref-for-abstract-opdef-clear-cookies-for-origin">清除
                                                    <var>origin</var> cookies</a>。</p>
                                        <dt data-md="">"<a data-link-type="grammar" href="#grammardef-storage"
                                                id="ref-for-grammardef-storage⑦"><code>storage</code></a>"
                                        <dd data-md="">
                                            <p><a data-link-type="abstract-op"
                                                    href="#abstract-opdef-clear-dom-accessible-storage-for-origin"
                                                    id="ref-for-abstract-opdef-clear-dom-accessible-storage-for-origin">清除
                                                    <var>origin</var> 的 DOM 可访问存储</a>。</p>
                                    </dl>
                            </ol>
                        <li data-md="">
                            <p>如果 <var>types</var> 包含 "<a data-link-type="grammar" href="#grammardef-executioncontexts"
                                    id="ref-for-grammardef-executioncontexts⑦">executionContexts</a>"，则<a
                                    data-link-type="abstract-op" href="#abstract-opdef-reload-browsing-contexts"
                                    id="ref-for-abstract-opdef-reload-browsing-contexts">重新加载 <var>browsing
                                        contexts</var></a>。</p>
                    </ol>
                    <p class="note" role="note"><span>注意：</span> 鼓励用户代理为开发者提供调试该清除操作的机制，例如通过控制台消息或时间线条目显示结果。</p>
                    <h4 class="heading settled algorithm" data-algorithm="Prepare to clear origin’s data"
                        data-level="4.2.1" id="prepare"><span class="secno">4.2.1. </span><span class="content">准备为
                            <var>origin</var> 清除数据 </span><a class="self-link" href="#prepare"></a></h4>
                    <p>给定一个 <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2"
                            id="ref-for-section-3.2④">origin</a>（<var>origin</var>）和类型列表
                        （<var>types</var>），用户代理可以<dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export=""
                            data-local-lt="prepare" id="abstract-opdef-prepare-to-clear-origins-data">准备为
                            <var>origin</var> 清除数据</dfn>，步骤如下。该算法返回已沙箱化的<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context"
                            id="ref-for-browsing-context">浏览上下文</a>列表，以防止其用内存中的 JavaScript 变量重建已清除数据。</p>
                    <ol class="algorithm">
                        <li data-md="">
                            <p>令 <var>sandboxed</var> 为空列表。</p>
                        <li data-md="">
                            <p>如果 <var>types</var> 未<a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">包含</a>
                                "<a data-link-type="grammar" href="#grammardef-executioncontexts"
                                    id="ref-for-grammardef-executioncontexts⑧"><code>executionContexts</code></a>"，返回
                                <var>sandboxed</var>。
                            </p>
                        <li data-md="">
                            <p>对于用户代理的所有 <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context"
                                    id="ref-for-browsing-context①">浏览上下文</a>中的每一个 <var>context</var>：</p>
                            <ol>
                                <li data-md="">
                                    <p>令 <var>document</var> 为 <var>context</var> 的 <a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                                            id="ref-for-active-document">活动文档</a>。</p>
                                <li data-md="">
                                    <p>如果 <var>document</var> 的 <a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                                            id="ref-for-relevant-settings-object">相关环境设置对象</a>的 <a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                                            id="ref-for-concept-settings-object-origin">origin</a> 不等于
                                        <var>origin</var>，<a data-link-type="dfn"
                                            href="https://infra.spec.whatwg.org/#iteration-continue"
                                            id="ref-for-iteration-continue">continue</a>。
                                    </p>
                                <li data-md="">
                                    <p><a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/origin.html#parse-a-sandboxing-directive"
                                            id="ref-for-parse-a-sandboxing-directive">解析沙箱指令</a>，输入为空字符串，输出为
                                        <var>document</var> 的 <a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/origin.html#active-sandboxing-flag-set"
                                            id="ref-for-active-sandboxing-flag-set">激活沙箱标志集合</a>。
                                    </p>
                                <li data-md="">
                                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append"
                                            id="ref-for-list-append">追加</a> <var>context</var> 至
                                        <var>sandboxed</var>。
                                    </p>
                            </ol>
                        <li data-md="">
                            <p>返回 <var>sandboxed</var>。</p>
                    </ol>
                    <h4 class="heading settled" data-level="4.2.2" id="reload-contexts"><span class="secno">4.2.2.
                        </span><span class="content"> 重新加载<var>browsing contexts</var> </span><a class="self-link"
                            href="#reload-contexts"></a></h4>
                    <p>给定<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context"
                            id="ref-for-browsing-context②">浏览上下文</a>（<var>contexts</var>）列表，用户代理可以按如下方式<dfn
                            class="dfn-paneled" data-dfn-type="abstract-op" data-export="" data-local-lt="reload"
                            id="abstract-opdef-reload-browsing-contexts">重新加载浏览上下文</dfn>：</p>
                    <ol class="algorithm">
                        <li data-md="">
                            <p>对<var>contexts</var>中的每个<var>context</var>：</p>
                            <ol>
                                <li data-md="">
                                    <p>执行<var>context</var>的<a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                                            id="ref-for-active-document①">活动文档</a>的<a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                                            id="ref-for-relevant-settings-object①">相关设置对象</a>的<a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                                            id="ref-for-concept-settings-object-global">全局对象</a>的<code
                                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/history.html#location" id="ref-for-location">Location</a></code>
                                        对象的<code
                                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/history.html#dom-location-reload" id="ref-for-dom-location-reload">reload()</a></code>。
                                    </p>
                                    <p class="issue" id="issue-808c351f"><a class="self-link"
                                            href="#issue-808c351f"></a>
                                        这是最简单的做法，但它可能过于深入地干扰文档和它们的上下文。或许需要拆解并复制粘贴HTML中的相关部分。</p>
                            </ol>
                    </ol>
                    <h4 class="heading settled" data-level="4.2.3" id="clear-cache"><span class="secno">4.2.3.
                        </span><span class="content"> 清除<var>origin</var>的缓存 </span><a class="self-link"
                            href="#clear-cache"></a></h4>
                    <p>给定一个<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2"
                            id="ref-for-section-3.2⑤">origin</a>（<var>origin</var>），用户代理可以按如下方式<dfn class="dfn-paneled"
                            data-dfn-type="abstract-op" data-export="" data-local-lt="clear cache"
                            id="abstract-opdef-clear-cache-for-origin">清除<var>origin</var>的缓存</dfn>：</p>
                    <ol class="algorithm">
                        <li data-md="">
                            <p>令<var>host</var>为<var>origin</var>的<a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-host"
                                    id="ref-for-concept-origin-host">主机</a>。</p>
                        <li data-md="">
                            <p>令<var>cache list</var>为<a data-link-type="dfn"
                                    href="https://tools.ietf.org/html/rfc7234#section-2"
                                    id="ref-for-section-2①">网络缓存</a>中其<code>target URI</code>的<a data-link-type="dfn"
                                    href="https://url.spec.whatwg.org/#concept-url-host"
                                    id="ref-for-concept-url-host">主机</a>与<var>host</var>完全相同的所有条目的集合。</p>
                        <li data-md="">
                            <p>对<var>cache list</var>中的每个<var>entry</var>：</p>
                            <ol>
                                <li data-md="">
                                    <p>从<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7234#section-2"
                                            id="ref-for-section-2②">网络缓存</a>中移除<var>entry</var>。</p>
                            </ol>
                        <li data-md="">
                            <p>如果用户代理实现了除<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7234#section-2"
                                    id="ref-for-section-2③">纯网络缓存</a>以外的缓存，则必须移除与<var>origin</var>匹配的所有条目。</p>
                            <p class="issue" id="issue-0156fcab"><a class="self-link" href="#issue-0156fcab"></a>
                                这里处理的是<a data-link-type="biblio"
                                    href="#biblio-rfc7234">[RFC7234]</a>中定义的网络缓存，但实际上用户代理缓存远不止如此。供应商特有部分能模糊到什么程度？例如，Chrome
                                会清除预渲染页面、脚本缓存、WebGL 着色器缓存、WebRTC 各类内容、地址栏建议缓存及各种非内容表示的数据（HSTS/HPKP、SCDH等）。或许<a
                                    data-link-type="biblio" href="#biblio-storage">[STORAGE]</a>会让这一点更清晰？</p>
                    </ol>
                    <h4 class="heading settled" data-level="4.2.4" id="clear-cookies"><span class="secno">4.2.4.
                        </span><span class="content"> 清除<var>origin</var>的 cookies </span><a class="self-link"
                            href="#clear-cookies"></a></h4>
                    <p>给定一个<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2"
                            id="ref-for-section-3.2⑥">origin</a>（<var>origin</var>），用户代理可以按如下方式<dfn class="dfn-paneled"
                            data-dfn-type="abstract-op" data-export="" data-local-lt="clear cookies"
                            id="abstract-opdef-clear-cookies-for-origin">清除<var>origin</var>的 cookies</dfn>：</p>
                    <p class="note" role="note"><span>注：</span>我们会清除整个<a data-link-type="dfn"
                            href="https://publicsuffix.org/list/#">注册域</a>的所有 cookie，因为 cookie 不遵守同源策略，如果只清除特定子域的
                        cookies，可能导致应用处于未定义状态。比如 <code>accounts.google.com</code> 与 <code>mail.google.com</code>
                        都有标识用户登录状态的 cookies。</p>
                    <p class="note" role="note"><span>注：</span>此算法假设用户代理已实现<a data-link-type="dfn"
                            href="https://tools.ietf.org/html/rfc6265#section-5.3" id="ref-for-section-5.3">cookie
                            存储</a>（见<a data-link-type="biblio" href="#biblio-rfc6265">[RFC6265]</a>5.3节），能按主机检索 cookie
                        列表并删除单个 cookie。</p>
                    <ol class="algorithm">
                        <li data-md="">
                            <p>令<var>registered</var>为<var>origin</var>的<a data-link-type="dfn"
                                    href="https://publicsuffix.org/list/#">注册域</a>。
                                <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-host"
                                    id="ref-for-concept-origin-host①">主机</a>
                            </p>
                        <li data-md="">
                            <p>令<var>cookie list</var>为<a data-link-type="dfn"
                                    href="https://tools.ietf.org/html/rfc6265#section-5.3"
                                    id="ref-for-section-5.3①">cookie
                                    存储</a>中其<code>domain</code>属性与<var>registered</var>做<a data-link-type="dfn"
                                    href="https://tools.ietf.org/html/rfc6265#section-5.1.3"
                                    id="ref-for-section-5.1.3">域匹配</a>的所有 cookie 集合。</p>
                        <li data-md="">
                            <p>对<var>cookie list</var>中的每个<var>cookie</var>：</p>
                            <ol>
                                <li data-md="">
                                    <p>从<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6265#section-5.3"
                                            id="ref-for-section-5.3②">cookie 存储</a>中移除<var>cookie</var>。</p>
                            </ol>
                        <li data-md="">
                            <p>如果用户代理支持其他类似 cookie 的存储方式，这些也必须针对<a data-link-type="dfn"
                                    href="https://tools.ietf.org/html/rfc6454#section-3.2"
                                    id="ref-for-section-3.2⑦">origin</a>的<a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-host"
                                    id="ref-for-concept-origin-host②">主机</a>的<a data-link-type="dfn"
                                    href="https://publicsuffix.org/list/#">注册域</a>一起清除。
                            </p>
                            <p class="note" role="note"><span>注：</span>例如用户代理支持 Flash，则通过<a
                                    href="https://wiki.mozilla.org/NPAPI:ClearSiteData">NPP_ClearSiteData</a>清除本地存储对象。
                            </p>
                        <li data-md="">
                            <p>清除与<a data-link-type="biblio" href="#biblio-channelid">[CHANNELID]</a>和<a
                                    data-link-type="biblio" href="#biblio-tokbind">[TOKBIND]</a>绑定的 Channel ID 及
                                token，这些必须与<a data-link-type="dfn"
                                    href="https://tools.ietf.org/html/rfc6454#section-3.2"
                                    id="ref-for-section-3.2⑧">origin</a>的<a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-host"
                                    id="ref-for-concept-origin-host③">主机</a>的<a data-link-type="dfn"
                                    href="https://publicsuffix.org/list/#">注册域</a>一致。
                            </p>
                        <li data-md="">
                            <p>清除与<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#authentication-entry"
                                    id="ref-for-authentication-entry">认证条目</a>和<a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#proxy-authentication-entry"
                                    id="ref-for-proxy-authentication-entry">代理认证条目</a>相关的所有记录，这些也必须与<a
                                    data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2"
                                    id="ref-for-section-3.2⑨">origin</a>的<a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-host"
                                    id="ref-for-concept-origin-host④">主机</a>的<a data-link-type="dfn"
                                    href="https://publicsuffix.org/list/#">注册域</a>一致。
                            </p>
                    </ol>
                    <p class="issue" id="issue-a4a76269"><a class="self-link" href="#issue-a4a76269"></a> 同时清除绑定
                        token/ID 和 HTTP 认证的过程非常模糊。<a
                            href="https://github.com/w3c/webappsec-clear-site-data/issues/2">&lt;https://github.com/w3c/webappsec-clear-site-data/issues/2></a>
                    </p>
                    <h4 class="heading settled" data-level="4.2.5" id="clear-dom"><span class="secno">4.2.5.
                        </span><span class="content"> 清除<var>origin</var>的 DOM 可访问存储 </span><a class="self-link"
                            href="#clear-dom"></a></h4>
                    <p>给定一个<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2"
                            id="ref-for-section-3.2①⓪">origin</a>（<var>origin</var>），用户代理可以按如下方式<dfn class="dfn-paneled"
                            data-dfn-type="abstract-op" data-export="" data-local-lt="clear storage"
                            id="abstract-opdef-clear-dom-accessible-storage-for-origin">清除<var>origin</var>的 DOM
                            可访问存储</dfn>：</p>
                    <ol class="algorithm">
                        <li data-md="">
                            <p>对用户代理中所有<a class="idl-code" data-link-type="attribute"
                                    href="https://html.spec.whatwg.org/multipage/webstorage.html#dom-localstorage"
                                    id="ref-for-dom-localstorage②">本地存储区</a><a data-link-type="biblio"
                                    href="#biblio-html">[HTML]</a>中的每个<var>area</var>：</p>
                            <ol>
                                <li data-md="">
                                    <p>如果<var>area</var>的<a data-link-type="dfn"
                                            href="https://tools.ietf.org/html/rfc6454#section-3.2"
                                            id="ref-for-section-3.2①①">origin</a>是<var>origin</var>：</p>
                                    <ol>
                                        <li data-md="">
                                            <p>在与<var>area</var>关联的<code
                                                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webstorage.html#dom-storage-clear" id="ref-for-dom-storage-clear">clear()</a></code>
                                                的<code
                                                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webstorage.html#storage-2" id="ref-for-storage-2">Storage</a></code>
                                                对象上执行。</p>
                                    </ol>
                            </ol>
                        <li data-md="">
                            <p>对用户代理中所有<a class="idl-code" data-link-type="attribute"
                                    href="https://html.spec.whatwg.org/multipage/webstorage.html#dom-sessionstorage"
                                    id="ref-for-dom-sessionstorage②">会话存储区</a><a data-link-type="biblio"
                                    href="#biblio-html">[HTML]</a>中的每个<var>area</var>：</p>
                            <ol>
                                <li data-md="">
                                    <p>如果<var>area</var>的<a data-link-type="dfn"
                                            href="https://tools.ietf.org/html/rfc6454#section-3.2"
                                            id="ref-for-section-3.2①②">origin</a>是<var>origin</var>：</p>
                                    <ol>
                                        <li data-md="">
                                            <p>在与<var>area</var>关联的<code
                                                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webstorage.html#dom-storage-clear" id="ref-for-dom-storage-clear①">clear()</a></code>
                                                的<code
                                                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webstorage.html#storage-2" id="ref-for-storage-2①">Storage</a></code>
                                                对象上执行。</p>
                                    </ol>
                            </ol>
                        <li data-md="">
                            <p>对<var>origin</var>的<a data-link-type="dfn"
                                    href="https://w3c.github.io/IndexedDB/#database" id="ref-for-database">数据库</a><a
                                    data-link-type="biblio"
                                    href="#biblio-indexeddb">[INDEXEDDB]</a>集合中的每个<var>database</var>：</p>
                            <ol>
                                <li data-md="">
                                    <p><a data-link-type="dfn" href="https://w3c.github.io/IndexedDB/#delete-a-database"
                                            id="ref-for-delete-a-database">删除</a><var>database</var>。</p>
                            </ol>
                        <li data-md="">
                            <p>对用户代理中所有<a data-link-type="dfn"
                                    href="https://w3c.github.io/ServiceWorker/#dfn-service-worker-registration"
                                    id="ref-for-dfn-service-worker-registration①">ServiceWorker
                                    注册</a>中的每个<var>registration</var>：</p>
                            <ol>
                                <li data-md="">
                                    <p>如果<var>registration</var>的<a data-link-type="dfn"
                                            href="https://w3c.github.io/ServiceWorker/#dfn-scope-url"
                                            id="ref-for-dfn-scope-url">作用域 URL</a>的<a data-link-type="dfn"
                                            href="https://url.spec.whatwg.org/#concept-url-origin"
                                            id="ref-for-concept-url-origin①">origin</a>是<var>origin</var>：</p>
                                    <ol>
                                        <li data-md="">
                                            <p>对<var>registration</var>执行<code
                                                    class="idl"><a data-link-type="idl" href="https://w3c.github.io/ServiceWorker/#dom-serviceworkerregistration-unregister" id="ref-for-dom-serviceworkerregistration-unregister">unregister()</a></code>。
                                            </p>
                                    </ol>
                            </ol>
                        <li data-md="">
                            <p>对用户代理中所有<a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/offline.html#application-cache"
                                    id="ref-for-application-cache">应用缓存</a>的每个<var>appcache</var>：</p>
                            <ol>
                                <li data-md="">
                                    <p>如果<var>appcache</var>的<a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/offline.html#application-cache-group"
                                            id="ref-for-application-cache-group">应用缓存组</a>由<var>origin</var>的<a
                                            data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin"
                                            id="ref-for-concept-url-origin②">origin</a>确定：</p>
                                    <ol>
                                        <li data-md="">
                                            <p>丢弃<var>appcache</var>。</p>
                                    </ol>
                            </ol>
                        <li data-md="">
                            <p>对于任何其他脚本可访问的存储机制，用户代理必须删除与该 origin 相关的所有数据。包括（但不限于）：</p>
                            <ol>
                                <li data-md="">
                                    <p>origin 的 WebSQL 数据库<a data-link-type="biblio"
                                            href="#biblio-webdatabase">[WEBDATABASE]</a>。</p>
                                <li data-md="">
                                    <p>origin 的文件系统<a data-link-type="biblio"
                                            href="#biblio-file-system-api">[file-system-api]</a></p>
                                <li data-md="">
                                    <p>插件数据（如 Flash 通过<a
                                            href="https://wiki.mozilla.org/NPAPI:ClearSiteData">NPP_ClearSiteData</a>），
                                    </p>
                                <li data-md="">
                                    <p class="issue" id="issue-b346d876"><a class="self-link"
                                            href="#issue-b346d876"></a> 还有吗？</p>
                            </ol>
                    </ol>
                </section>
                <section>
                    <h2 class="heading settled" data-level="5" id="security"><span class="secno">5. </span><span
                            class="content">安全注意事项</span><a class="self-link" href="#security"></a>
                    </h2>
                    <h3 class="heading settled" data-level="5.1" id="incomplete"><span class="secno">5.1. </span><span
                            class="content">清除不彻底</span><a class="self-link" href="#incomplete"></a></h3>
                    <p>仅清除一种类型的存储有可能会导致应用进入未定义状态。我们通过将所有存储选项一并清除，并要求该 header 只能通过安全连接传递，以一定程度上降低风险。</p>
                    <h3 class="heading settled" data-level="5.2" id="service-workers"><span class="secno">5.2.
                        </span><span class="content">Service worker</span><a class="self-link"
                            href="#service-workers"></a></h3>
                    <p>Clear-Site-Data 头必须只在通过网络获取的响应中生效，而不是用于 service worker 提供的响应。</p>
                    <p>原因是 service worker 可以为其作用域内的资源请求返回任意响应，包括第三方请求。因此，如果支持 Clear-Site-Data，会赋予其为任意 origin 清除数据的能力。
                    </p>
                    <p>注意，如果一个请求先发给了 service
                        worker，未被处理后以<code>service-workers mode = "none"</code>重新通过网络发送，则对应响应为网络响应，可以处理。上一次尝试 service
                        worker 无关。</p>
                    <p>另外，service worker 更新属于网络响应，因此不受此限制。这对实现<a href="#example-killswitch">§1.1.4 Kill Switch</a>用例很重要。
                    </p>
                    <h2 class="heading settled" data-level="6" id="privacy"><span class="secno">6. </span><span
                            class="content">隐私注意事项</span><a class="self-link" href="#privacy"></a></h2>
                    <h3 class="heading settled" data-level="6.1" id="user-vs-author"><span class="secno">6.1.
                        </span><span class="content">Web 开发者控制时机。</span><a class="self-link" href="#user-vs-author"></a>
                    </h3>
                    <p>如果在适当时机触发，<a data-link-type="http-header" href="#http-headerdef-clear-site-data"
                            id="ref-for-http-headerdef-clear-site-data①④"><code>Clear-Site-Data</code></a>可以通过清除敏感数据提升用户的隐私和安全性。但是，请注意
                        web 开发者（而<b>不是</b>用户）决定何时触发清除事件。即便假定站点作者无恶意，用户无法保证数据会在某一特定时刻被清除，也无法控制清除的数据类型。</p>
                    <p>如果用户希望确保站点数据在某一特定时间点被清除，应该依赖其用户代理提供的数据清除功能。</p>
                    <p>至少，用户代理“应该”（<a data-link-type="biblio"
                            href="#biblio-rfc6919">[RFC6919]</a>意义上）为用户提供与web开发者相同的功能。理想情况下，还会提供更多，例如清除浏览历史。</p>
                    <h3 class="heading settled" data-level="6.2" id="remnants"><span class="secno">6.2. </span><span
                            class="content">磁盘上的数据残留。</span><a class="self-link" href="#remnants"></a>
                    </h3>
                    <p>虽然<a data-link-type="http-header" href="#http-headerdef-clear-site-data"
                            id="ref-for-http-headerdef-clear-site-data①⑤"><code>Clear-Site-Data</code></a>会触发用户代理的清理操作，但很难保证在清理后磁盘上不再有任何站点数据残留。最终还是靠用户代理确保所有站点痕迹真正被移除，这往往非常困难（比如虚拟内存只是一个例子）。
                    </p>
                    <p>简言之，大多数用户代理会以“尽力而为”方式实现数据清除，但无法保证彻底擦除。</p>
                    <p>如果用户希望保证站点数据不留存于磁盘，最佳做法是使用声称不会有意写盘的浏览模式（Chrome 的“无痕”、IE 的“InPrivate”等）。这些模式更能防止数据落盘，但边缘场景下依然有限制。
                    </p>
                </section>
                <section>
                    <h2 class="heading settled" data-level="7" id="iana-considerations"><span class="secno">7.
                        </span><span class="content">IANA 注意事项</span><a class="self-link"
                            href="#iana-considerations"></a></h2>
                    <p>永久消息头字段注册表应更新如下内容：<a data-link-type="biblio" href="#biblio-rfc3864">[RFC3864]</a>
                    </p>
                    <h3 class="heading settled" data-level="7.1" id="iana-clear-site-data"><span class="secno">7.1.
                        </span><span class="content"> Clear-Site-Data </span><a class="self-link"
                            href="#iana-clear-site-data"></a></h3>
                    <dl>
                        <dt>头字段名
                        <dd>Clear-Site-Data
                        <dt>适用协议
                        <dd>http
                        <dt>状态
                        <dd>标准
                        <dt>作者/修改方
                        <dd>W3C
                        <dt>规范文档
                        <dd>本规范（见<a href="#header">§3.1 Clear-Site-Data HTTP响应头字段</a>）
                    </dl>
                    <section>
                        <h2 class="heading settled" data-level="8" id="acknowledgements"><span class="secno">8.
                            </span><span class="content">致谢</span><a class="self-link" href="#acknowledgements"></a>
                        </h2>
                        <p>Michal Zalewski 提出了该概念的变体，Mark Knichel 帮助完善了细节。</p>
                    </section>
                </section>
            </section>
        </section>
    </main>
    <h2 class="no-ref no-num heading settled" id="conformance"><span class="content">一致性</span><a class="self-link"
            href="#conformance"></a></h2>
    <h3 class="no-ref no-num heading settled" id="conventions"><span class="content">文档约定</span><a class="self-link"
            href="#conventions"></a></h3>
    <p>一致性要求通过描述性断言和 RFC 2119 术语的结合表达。关键字 “MUST”（必须）、“MUST NOT”（禁止）、“REQUIRED”（要求）、“SHALL”（应）、“SHALL
        NOT”（不应）、“SHOULD”（应该）、“SHOULD NOT”（不应该）、“RECOMMENDED”（推荐）、“MAY”（可以）和 “OPTIONAL”（可选） 在本规范的规范性部分应按照 RFC 2119
        中的说明进行解释。然而，为了可读性，本规范未将这些关键字全部以大写字母出现。 </p>
    <p>本规范中的所有文本均为规范性内容，明确标记为非规范性的章节、示例和注释除外。<a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>
    <p>本规范中的示例以 “for example”（例如）开头，或用 <code>class="example"</code> 与规范性文本区分开，如下所示：</p>
    <div class="example" id="example-f839f6c8">
        <a class="self-link" href="#example-f839f6c8"></a>
        <p>这是一个说明性示例。</p>
    </div>
    <p>说明性注释以 “Note” 开头，并用 <code>class="note"</code> 与规范性文本区分，如下所示：</p>
    <p class="note" role="note">Note，这是一个说明性注释。</p>
    <h3 class="no-ref no-num heading settled" id="conformant-algorithms"><span class="content">合规算法</span><a
            class="self-link" href="#conformant-algorithms"></a></h3>
    <p>以祈使句形式表述在算法中的要求（如 “strip any leading space characters”（去除所有前导空格字符）或 “return false and abort these steps”（返回 false
        并终止这些步骤））应根据用于引入算法的关键字（“must”、“should”、“may”等）进行解释。</p>
    <p>以算法或特定步骤表述的一致性要求可以以任何方式实现，只要最终结果等价即可。特别地，本规范中定义的算法旨在易于理解，并非旨在高效。鼓励实现者进行优化。</p>
    <script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本规范定义的术语</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#grammardef-">*</a><span>, 见 §3.1</span>
        <li><a href="#grammardef-cache">缓存</a><span>, 见 §3.1</span>
        <li><a href="#abstract-opdef-clear-cache-for-origin">清除缓存</a><span>, 见 §4.2.3</span>
        <li><a href="#abstract-opdef-clear-cache-for-origin">为来源清除缓存</a><span>, 见 §4.2.3</span>
        <li><a href="#abstract-opdef-clear-cookies-for-origin">清除 cookies</a><span>, 见 §4.2.4</span>
        <li><a href="#abstract-opdef-clear-cookies-for-origin">为来源清除 cookies</a><span>, 见 §4.2.4</span>
        <li><a href="#abstract-opdef-clear-dom-accessible-storage-for-origin">为来源清除 DOM 可访问存储</a><span>, 见 §4.2.5</span>
        <li><a href="#http-headerdef-clear-site-data">Clear-Site-Data</a><span>, 见 §3.1</span>
        <li><a href="#abstract-opdef-clear-site-data-for-response">为响应清除站点数据</a><span>, 见§4.2</span>
        <li><a href="#abstract-opdef-clear-dom-accessible-storage-for-origin">清除存储</a><span>, 见 §4.2.5</span>
        <li><a href="#grammardef-cookies">cookies</a><span>, 见 §3.1</span>
        <li><a href="#grammardef-executioncontexts">执行上下文</a><span>, 见 §3.1</span>
        <li><a href="#abstract-opdef-parse-responses-clear-site-data-header">解析响应</a><span>, 见 §4.1</span>
        <li><a href="#abstract-opdef-parse-responses-clear-site-data-header">解析响应的 Clear-Site-Data 头</a><span>, 见
                §4.1</span>
        <li><a href="#abstract-opdef-prepare-to-clear-origins-data">准备</a><span>, 见 §4.2.1</span>
        <li><a href="#abstract-opdef-prepare-to-clear-origins-data">准备清除来源数据</a><span>, 见 §4.2.1</span>
        <li><a href="#abstract-opdef-reload-browsing-contexts">重新加载</a><span>, 见 §4.2.2</span>
        <li><a href="#abstract-opdef-reload-browsing-contexts">重新加载浏览上下文</a><span>, 见 §4.2.2</span>
        <li><a href="#grammardef-storage">存储</a><span>, 见 §3.1</span>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">引用定义的术语</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[FETCH]</a> 定义了如下术语：
            <ul>
                <li><a href="https://fetch.spec.whatwg.org/#authentication-entry">authentication entry</a>
                <li><a href="https://fetch.spec.whatwg.org/#extract-header-list-values">extracting header list
                        values</a>
                <li><a href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a>
                <li><a href="https://fetch.spec.whatwg.org/#concept-http-network-fetch">http-network fetch</a>
                <li><a href="https://fetch.spec.whatwg.org/#proxy-authentication-entry">proxy-authentication entry</a>
                <li><a href="https://fetch.spec.whatwg.org/#concept-response">response</a>
                <li><a href="https://fetch.spec.whatwg.org/#request-service-workers-mode">service-workers mode</a>
                <li><a href="https://fetch.spec.whatwg.org/#concept-response-url">url</a>
            </ul>
        <li>
            <a data-link-type="biblio">[HTML]</a> 定义了如下术语：
            <ul>
                <li><a href="https://html.spec.whatwg.org/multipage/history.html#location">Location</a>
                <li><a href="https://html.spec.whatwg.org/multipage/webstorage.html#storage-2">Storage</a>
                <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#active-document">active document</a>
                <li><a href="https://html.spec.whatwg.org/multipage/origin.html#active-sandboxing-flag-set">active
                        sandboxing flag set</a>
                <li><a href="https://html.spec.whatwg.org/multipage/offline.html#application-cache">application
                        cache</a>
                <li><a href="https://html.spec.whatwg.org/multipage/offline.html#application-cache-group">application
                        cache group</a>
                <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context">browsing context</a>
                <li><a href="https://html.spec.whatwg.org/multipage/webstorage.html#dom-storage-clear">clear()</a>
                <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global">global
                        object</a>
                <li><a href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-host">host</a>
                <li><a href="https://html.spec.whatwg.org/multipage/webstorage.html#dom-localstorage">localStorage</a>
                <li><a
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin">origin</a>
                <li><a href="https://html.spec.whatwg.org/multipage/origin.html#parse-a-sandboxing-directive">parse a
                        sandboxing directive</a>
                <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">relevant
                        settings object</a>
                <li><a href="https://html.spec.whatwg.org/multipage/history.html#dom-location-reload">reload()</a>
                <li><a
                        href="https://html.spec.whatwg.org/multipage/webstorage.html#dom-sessionstorage">sessionStorage</a>
            </ul>
        <li>
            <a data-link-type="biblio">[IndexedDB-2]</a> 定义了如下术语：
            <ul>
                <li><a href="https://w3c.github.io/IndexedDB/#database">database</a>
                <li><a href="https://w3c.github.io/IndexedDB/#delete-a-database">delete a database</a>
            </ul>
        <li>
            <a data-link-type="biblio">[INFRA]</a> 定义了如下术语：
            <ul>
                <li><a href="https://infra.spec.whatwg.org/#list-append">append</a>
                <li><a href="https://infra.spec.whatwg.org/#iteration-break">break</a>
                <li><a href="https://infra.spec.whatwg.org/#list-contain">contain</a>
                <li><a href="https://infra.spec.whatwg.org/#iteration-continue">continue</a>
            </ul>
        <li>
            <a data-link-type="biblio">[mixed-content]</a> 定义了如下术语：
            <ul>
                <li><a href="https://www.w3.org/TR/mixed-content/#a-priori-authenticated-url">a priori authenticated
                        url</a>
            </ul>
        <li>
            <a data-link-type="biblio">[PSL]</a> 定义了如下术语：
            <ul>
                <li><a href="https://publicsuffix.org/list/#">registered domain</a>
            </ul>
        <li>
            <a data-link-type="biblio">[RFC6265]</a> 定义了如下术语：
            <ul>
                <li><a href="https://tools.ietf.org/html/rfc6265#section-5.3">cookie store</a>
                <li><a href="https://tools.ietf.org/html/rfc6265#section-5.1.3">domain-match</a>
            </ul>
        <li>
            <a data-link-type="biblio">[rfc6454]</a> 定义了如下术语：
            <ul>
                <li><a href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a>
            </ul>
        <li>
            <a data-link-type="biblio">[RFC7230]</a> 定义了如下术语：
            <ul>
                <li><a href="https://tools.ietf.org/html/rfc7230#section-7">#rule</a>
                <li><a
                        href="https://tools.ietf.org/html/rfc7230https://tools.ietf.org/html/rfc7230#section-3.2.6">quoted-string</a>
            </ul>
        <li>
            <a data-link-type="biblio">[RFC7234]</a> 定义了如下术语：
            <ul>
                <li><a href="https://tools.ietf.org/html/rfc7234#section-2">network cache</a>
            </ul>
        <li>
            <a data-link-type="biblio">[SERVICE-WORKERS]</a> 定义了如下术语：
            <ul>
                <li><a href="https://w3c.github.io/ServiceWorker/#dfn-scope-url">scope url</a>
                <li><a href="https://w3c.github.io/ServiceWorker/#dfn-service-worker-registration">service worker
                        registration</a>
                <li><a
                        href="https://w3c.github.io/ServiceWorker/#dom-serviceworkerregistration-unregister">unregister()</a>
            </ul>
        <li>
            <a data-link-type="biblio">[URL]</a> 定义了如下术语：
            <ul>
                <li><a href="https://url.spec.whatwg.org/#concept-url-host">host</a>
                <li><a href="https://url.spec.whatwg.org/#concept-url-origin">origin</a>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">规范性引用</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-channelid">[CHANNELID]
        <dd>Dirk Balfanz; Ryan Hamilton. <a href="https://tools.ietf.org/html/draft-balfanz-tls-channelid">Transport
                Layer Security (TLS) Channel IDs</a>. URL: <a
                href="https://tools.ietf.org/html/draft-balfanz-tls-channelid">https://tools.ietf.org/html/draft-balfanz-tls-channelid</a>
        <dt id="biblio-fetch">[FETCH]
        <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a>. Living Standard. URL: <a
                href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
        <dt id="biblio-file-system-api">[FILE-SYSTEM-API]
        <dd>Eric Uhrhane. <a href="https://www.w3.org/TR/file-system-api/">File API: Directories and System</a>. 24
            April 2014. NOTE. URL: <a
                href="https://www.w3.org/TR/file-system-api/">https://www.w3.org/TR/file-system-api/</a>
        <dt id="biblio-html">[HTML]
        <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living
            Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        <dt id="biblio-indexeddb">[INDEXEDDB]
        <dd>Nikunj Mehta; et al. <a href="https://www.w3.org/TR/IndexedDB/">Indexed Database API</a>. 8 January 2015.
            REC. URL: <a href="https://www.w3.org/TR/IndexedDB/">https://www.w3.org/TR/IndexedDB/</a>
        <dt id="biblio-indexeddb-2">[IndexedDB-2]
        <dd>Ali Alabbas; Joshua Bell. <a href="https://www.w3.org/TR/IndexedDB-2/">Indexed Database API 2.0</a>. 16
            November 2017. PR. URL: <a href="https://www.w3.org/TR/IndexedDB-2/">https://www.w3.org/TR/IndexedDB-2/</a>
        <dt id="biblio-infra">[INFRA]
        <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/">Infra Standard</a>. Living
            Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
        <dt id="biblio-mixed-content">[MIXED-CONTENT]
        <dd>Mike West. <a href="https://www.w3.org/TR/mixed-content/">Mixed Content</a>. 2 August 2016. CR. URL: <a
                href="https://www.w3.org/TR/mixed-content/">https://www.w3.org/TR/mixed-content/</a>
        <dt id="biblio-psl">[PSL]
        <dd><cite><a href="https://publicsuffix.org/">Public Suffix List</a></cite>. Mozilla Foundation.
        <dt id="biblio-rfc2119">[RFC2119]
        <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement
                Levels</a>. March 1997. Best Current Practice. URL: <a
                href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
        <dt id="biblio-rfc3864">[RFC3864]
        <dd>G. Klyne; M. Nottingham; J. Mogul. <a href="https://tools.ietf.org/html/rfc3864">Registration Procedures for
                Message Header Fields</a>. September 2004. Best Current Practice. URL: <a
                href="https://tools.ietf.org/html/rfc3864">https://tools.ietf.org/html/rfc3864</a>
        <dt id="biblio-rfc5234">[RFC5234]
        <dd>D. Crocker, Ed.; P. Overell. <a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax
                Specifications: ABNF</a>. January 2008. Internet Standard. URL: <a
                href="https://tools.ietf.org/html/rfc5234">https://tools.ietf.org/html/rfc5234</a>
        <dt id="biblio-rfc6265">[RFC6265]
        <dd>A. Barth. <a href="https://tools.ietf.org/html/rfc6265">HTTP State Management Mechanism</a>. April 2011.
            Proposed Standard. URL: <a
                href="https://tools.ietf.org/html/rfc6265">https://tools.ietf.org/html/rfc6265</a>
        <dt id="biblio-rfc6454">[RFC6454]
        <dd>A. Barth. <a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>. December 2011. Proposed
            Standard. URL: <a href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a>
        <dt id="biblio-rfc7230">[RFC7230]
        <dd>R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://tools.ietf.org/html/rfc7230">Hypertext Transfer Protocol
                (HTTP/1.1): Message Syntax and Routing</a>. June 2014. Proposed Standard. URL: <a
                href="https://tools.ietf.org/html/rfc7230">https://tools.ietf.org/html/rfc7230</a>
        <dt id="biblio-rfc7234">[RFC7234]
        <dd>R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed.. <a
                href="https://tools.ietf.org/html/rfc7234">Hypertext Transfer Protocol (HTTP/1.1): Caching</a>. June
            2014. Proposed Standard. URL: <a
                href="https://tools.ietf.org/html/rfc7234">https://tools.ietf.org/html/rfc7234</a>
        <dt id="biblio-rfc7235">[RFC7235]
        <dd>R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://tools.ietf.org/html/rfc7235">Hypertext Transfer Protocol
                (HTTP/1.1): Authentication</a>. June 2014. Proposed Standard. URL: <a
                href="https://tools.ietf.org/html/rfc7235">https://tools.ietf.org/html/rfc7235</a>
        <dt id="biblio-rfc7405">[RFC7405]
        <dd>P. Kyzivat. <a href="https://tools.ietf.org/html/rfc7405">Case-Sensitive String Support in ABNF</a>.
            December 2014. Proposed Standard. URL: <a
                href="https://tools.ietf.org/html/rfc7405">https://tools.ietf.org/html/rfc7405</a>
        <dt id="biblio-service-workers">[SERVICE-WORKERS]
        <dd>Alex Russell; et al. <a href="https://www.w3.org/TR/service-workers-1/">Service Workers 1</a>. 2 November
            2017. WD. URL: <a
                href="https://www.w3.org/TR/service-workers-1/">https://www.w3.org/TR/service-workers-1/</a>
        <dt id="biblio-tokbind">[TOKBIND]
        <dd>Andrei Popov; et al. <a href="https://tools.ietf.org/html/draft-ietf-tokbind-protocol">The Token Binding
                Protocol Version 1.0</a>. URL: <a
                href="https://tools.ietf.org/html/draft-ietf-tokbind-protocol">https://tools.ietf.org/html/draft-ietf-tokbind-protocol</a>
        <dt id="biblio-url">[URL]
        <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/">URL Standard</a>. Living Standard. URL: <a
                href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
        <dt id="biblio-webdatabase">[WEBDATABASE]
        <dd>Ian Hickson. <a href="https://www.w3.org/TR/webdatabase/">Web SQL Database</a>. 18 November 2010. NOTE. URL:
            <a href="https://www.w3.org/TR/webdatabase/">https://www.w3.org/TR/webdatabase/</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">说明性引用</span><a class="self-link"
            href="#informative"></a></h3>
    <dl>
        <dt id="biblio-csp">[CSP]
        <dd>Mike West. <a href="https://www.w3.org/TR/CSP3/">Content Security Policy Level 3</a>. 13 September 2016. WD.
            URL: <a href="https://www.w3.org/TR/CSP3/">https://www.w3.org/TR/CSP3/</a>
        <dt id="biblio-rfc6919">[RFC6919]
        <dd>R. Barnes; S. Kent; E. Rescorla. <a href="https://tools.ietf.org/html/rfc6919">Further Key Words for Use in
                RFCs to Indicate Requirement Levels</a>. 1 April 2013. Experimental. URL: <a
                href="https://tools.ietf.org/html/rfc6919">https://tools.ietf.org/html/rfc6919</a>
        <dt id="biblio-storage">[STORAGE]
        <dd>Anne van Kesteren. <a href="https://storage.spec.whatwg.org/">Storage Standard</a>. Living Standard. URL: <a
                href="https://storage.spec.whatwg.org/">https://storage.spec.whatwg.org/</a>
    </dl>
    <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">问题索引</span><a class="self-link"
            href="#issues-index"></a></h2>
    <div style="counter-reset:issue">
        <div class="issue">猴子补丁！和 Anne 沟通。<a href="#issue-3ded38d3"> ↵ </a></div>
        <div class="issue"> 这虽然是最简单的事情，但很可能过于深入文档并弄乱了它们的上下文。我可能只需要分解并从 HTML 复制/粘贴相关部分。<a href="#issue-808c351f"> ↵ </a>
        </div>
        <div class="issue"> 我们在这里处理的是 <a data-link-type="biblio" href="#biblio-rfc7234">[RFC7234]</a>
            中定义的网络缓存，但这远不是用户代理缓存的全部。我们在厂商特定部分可以多手动么？例如，Chrome 会清理预渲染页面、脚本缓存、WebGL 着色器缓存、WebRTC
            各种零件、地址栏建议缓存、各种并非表现形式的网络相关内容（HSTS/HPKP、SCDH等）。也许 <a data-link-type="biblio"
                href="#biblio-storage">[STORAGE]</a> 会更清晰？<a href="#issue-0156fcab"> ↵ </a></div>
        <div class="issue"> 清除绑定的令牌/ID 以及 HTTP 认证的过程非常模糊。<a
                href="https://github.com/w3c/webappsec-clear-site-data/issues/2">&lt;https://github.com/w3c/webappsec-clear-site-data/issues/2></a><a
                href="#issue-a4a76269"> ↵ </a></div>
        <div class="issue"> 更多？<a href="#issue-b346d876"> ↵ </a></div>
    </div>
    <aside class="dfn-panel" data-for="http-headerdef-clear-site-data">
        <b><a href="#http-headerdef-clear-site-data">#http-headerdef-clear-site-data</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-http-headerdef-clear-site-data">1. Introduction</a>
            <li><a href="#ref-for-http-headerdef-clear-site-data①">1.1.1. Signing Out</a>
            <li><a href="#ref-for-http-headerdef-clear-site-data②">1.1.2. Targeted Clearing</a>
            <li><a href="#ref-for-http-headerdef-clear-site-data③">1.1.3. Keep Critical Cookies</a>
            <li><a href="#ref-for-http-headerdef-clear-site-data④">1.1.4. Kill Switch</a>
            <li><a href="#ref-for-http-headerdef-clear-site-data⑤">3.1.
                    The Clear-Site-Data HTTP Response Header Field </a> <a
                    href="#ref-for-http-headerdef-clear-site-data⑥">(2)</a> <a
                    href="#ref-for-http-headerdef-clear-site-data⑦">(3)</a> <a
                    href="#ref-for-http-headerdef-clear-site-data⑧">(4)</a> <a
                    href="#ref-for-http-headerdef-clear-site-data⑨">(5)</a> <a
                    href="#ref-for-http-headerdef-clear-site-data①⓪">(6)</a>
            <li><a href="#ref-for-http-headerdef-clear-site-data①①">3.2. Fetch Integration</a> <a
                    href="#ref-for-http-headerdef-clear-site-data①②">(2)</a> <a
                    href="#ref-for-http-headerdef-clear-site-data①③">(3)</a>
            <li><a href="#ref-for-http-headerdef-clear-site-data①④">6.1. Web developers control the timing.</a>
            <li><a href="#ref-for-http-headerdef-clear-site-data①⑤">6.2. Remnants of data on disk.</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="grammardef-cache">
        <b><a href="#grammardef-cache">#grammardef-cache</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-grammardef-cache">1.1.1. Signing Out</a>
            <li><a href="#ref-for-grammardef-cache①">1.1.2. Targeted Clearing</a>
            <li><a href="#ref-for-grammardef-cache②">1.1.3. Keep Critical Cookies</a>
            <li><a href="#ref-for-grammardef-cache③">1.1.4. Kill Switch</a>
            <li><a href="#ref-for-grammardef-cache④">3.1.
                    The Clear-Site-Data HTTP Response Header Field </a>
            <li><a href="#ref-for-grammardef-cache⑤">4.1. Parsing</a> <a href="#ref-for-grammardef-cache⑥">(2)</a>
            <li><a href="#ref-for-grammardef-cache⑦">4.2.
                    Clear data for response </a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="grammardef-cookies">
        <b><a href="#grammardef-cookies">#grammardef-cookies</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-grammardef-cookies">1.1.1. Signing Out</a>
            <li><a href="#ref-for-grammardef-cookies①">1.1.2. Targeted Clearing</a>
            <li><a href="#ref-for-grammardef-cookies②">1.1.3. Keep Critical Cookies</a>
            <li><a href="#ref-for-grammardef-cookies③">1.1.4. Kill Switch</a>
            <li><a href="#ref-for-grammardef-cookies④">3.1.
                    The Clear-Site-Data HTTP Response Header Field </a> <a href="#ref-for-grammardef-cookies⑤">(2)</a>
            <li><a href="#ref-for-grammardef-cookies⑥">4.1. Parsing</a> <a href="#ref-for-grammardef-cookies⑦">(2)</a>
            <li><a href="#ref-for-grammardef-cookies⑧">4.2.
                    Clear data for response </a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="grammardef-storage">
        <b><a href="#grammardef-storage">#grammardef-storage</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-grammardef-storage">1.1.1. Signing Out</a>
            <li><a href="#ref-for-grammardef-storage①">1.1.2. Targeted Clearing</a>
            <li><a href="#ref-for-grammardef-storage②">1.1.3. Keep Critical Cookies</a>
            <li><a href="#ref-for-grammardef-storage③">1.1.4. Kill Switch</a>
            <li><a href="#ref-for-grammardef-storage④">3.1.
                    The Clear-Site-Data HTTP Response Header Field </a>
            <li><a href="#ref-for-grammardef-storage⑤">4.1. Parsing</a> <a href="#ref-for-grammardef-storage⑥">(2)</a>
            <li><a href="#ref-for-grammardef-storage⑦">4.2.
                    Clear data for response </a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="grammardef-executioncontexts">
        <b><a href="#grammardef-executioncontexts">#grammardef-executioncontexts</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-grammardef-executioncontexts">1.1.1. Signing Out</a>
            <li><a href="#ref-for-grammardef-executioncontexts①">1.1.2. Targeted Clearing</a>
            <li><a href="#ref-for-grammardef-executioncontexts②">1.1.3. Keep Critical Cookies</a>
            <li><a href="#ref-for-grammardef-executioncontexts③">1.1.4. Kill Switch</a>
            <li><a href="#ref-for-grammardef-executioncontexts④">3.1.
                    The Clear-Site-Data HTTP Response Header Field </a>
            <li><a href="#ref-for-grammardef-executioncontexts⑤">4.1. Parsing</a> <a
                    href="#ref-for-grammardef-executioncontexts⑥">(2)</a>
            <li><a href="#ref-for-grammardef-executioncontexts⑦">4.2.
                    Clear data for response </a>
            <li><a href="#ref-for-grammardef-executioncontexts⑧">4.2.1.
                    Prepare to clear origin’s data </a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="grammardef-">
        <b><a href="#grammardef-">#grammardef-</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-grammardef-">3.1.
                    The Clear-Site-Data HTTP Response Header Field </a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="abstract-opdef-parse-responses-clear-site-data-header">
        <b><a
                href="#abstract-opdef-parse-responses-clear-site-data-header">#abstract-opdef-parse-responses-clear-site-data-header</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-abstract-opdef-parse-responses-clear-site-data-header">4.2.
                    Clear data for response </a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="abstract-opdef-prepare-to-clear-origins-data">
        <b><a
                href="#abstract-opdef-prepare-to-clear-origins-data">#abstract-opdef-prepare-to-clear-origins-data</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-abstract-opdef-prepare-to-clear-origins-data">4.2.
                    Clear data for response </a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="abstract-opdef-reload-browsing-contexts">
        <b><a
                href="#abstract-opdef-reload-browsing-contexts">#abstract-opdef-reload-browsing-contexts</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-abstract-opdef-reload-browsing-contexts">4.2.
                    Clear data for response </a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="abstract-opdef-clear-cache-for-origin">
        <b><a href="#abstract-opdef-clear-cache-for-origin">#abstract-opdef-clear-cache-for-origin</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-abstract-opdef-clear-cache-for-origin">4.2.
                    Clear data for response </a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="abstract-opdef-clear-cookies-for-origin">
        <b><a
                href="#abstract-opdef-clear-cookies-for-origin">#abstract-opdef-clear-cookies-for-origin</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-abstract-opdef-clear-cookies-for-origin">4.2.
                    Clear data for response </a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="abstract-opdef-clear-dom-accessible-storage-for-origin">
        <b><a
                href="#abstract-opdef-clear-dom-accessible-storage-for-origin">#abstract-opdef-clear-dom-accessible-storage-for-origin</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-abstract-opdef-clear-dom-accessible-storage-for-origin">4.2.
                    Clear data for response </a>
        </ul>
    </aside>
    <script>/* script-dfn-panel */

        document.body.addEventListener("click", function (e) {
            var queryAll = function (sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            var hitALink = false;
            while (el.parentElement) {
                if (el.tagName == "A") {
                    // Clicking on a link in a <dfn> shouldn't summon the panel
                    hitALink = true;
                }
                if (el.classList.contains("dfn-paneled")) {
                    target = "dfn";
                    break;
                }
                if (el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if (target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function (el) {
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if (target == "dfn" && !hitALink) {
                // open the panel
                var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
                if (dfnPanel) {
                    console.log(dfnPanel);
                    dfnPanel.classList.add("on");
                    var rect = el.getBoundingClientRect();
                    dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
                    dfnPanel.style.top = window.scrollY + rect.top + "px";
                    var panelRect = dfnPanel.getBoundingClientRect();
                    var panelWidth = panelRect.right - panelRect.left;
                    if (panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                        // Reposition, because the panel is overflowing
                        dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
                    }
                } else {
                    console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
                }
            } else if (target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
                el.style.left = null;
                el.style.top = null;
            }

        });
    </script>
    <script src="/dropdown.js"></script>