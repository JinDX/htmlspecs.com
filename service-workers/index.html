<!doctype html>
<html lang="zh-hans">

<head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>服务工作线程</title>
  <meta content="CRD" name="w3c-status">
  <meta content="Bikeshed version 37b7e7e68, updated Fri May 27 15:08:11 2022 -0700" name="generator">
  <link href="https://www.w3.org/TR/service-workers/" rel="canonical">
  <meta content="994563ac9dbc2b1216befd85330208476047d092" name="document-revision">
  <style>
    /* style-autolinks */
    .css.css,
    .property.property,
    .descriptor.descriptor {
      color: var(--a-normal-text);
      font-size: inherit;
      font-family: inherit;
    }

    .css::before,
    .property::before,
    .descriptor::before {
      content: "‘";
    }

    .css::after,
    .property::after,
    .descriptor::after {
      content: "’";
    }

    .property,
    .descriptor {
      /* Don't wrap property and descriptor names */
      white-space: nowrap;
    }

    .type {
      /* CSS value <type> */
      font-style: italic;
    }

    pre .property::before,
    pre .property::after {
      content: "";
    }

    [data-link-type="property"]::before,
    [data-link-type="propdesc"]::before,
    [data-link-type="descriptor"]::before,
    [data-link-type="value"]::before,
    [data-link-type="function"]::before,
    [data-link-type="at-rule"]::before,
    [data-link-type="selector"]::before,
    [data-link-type="maybe"]::before {
      content: "‘";
    }

    [data-link-type="property"]::after,
    [data-link-type="propdesc"]::after,
    [data-link-type="descriptor"]::after,
    [data-link-type="value"]::after,
    [data-link-type="function"]::after,
    [data-link-type="at-rule"]::after,
    [data-link-type="selector"]::after,
    [data-link-type="maybe"]::after {
      content: "’";
    }

    [data-link-type].production::before,
    [data-link-type].production::after,
    .prod [data-link-type]::before,
    .prod [data-link-type]::after {
      content: "";
    }

    [data-link-type=element],
    [data-link-type=element-attr] {
      font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
      font-size: .9em;
    }

    [data-link-type=element]::before {
      content: "<"
    }

    [data-link-type=element]::after {
      content: ">"
    }

    [data-link-type=biblio] {
      white-space: pre;
    }
  </style>
  <style>
    /* style-counters */

    body {
      counter-reset: example figure issue;
    }

    .issue {
      counter-increment: issue;
    }

    .issue:not(.no-marker)::before {
      content: "Issue " counter(issue);
    }

    .example {
      counter-increment: example;
    }

    .example:not(.no-marker)::before {
      content: "Example " counter(example);
    }

    .invalid.example:not(.no-marker)::before,
    .illegal.example:not(.no-marker)::before {
      content: "Invalid Example" counter(example);
    }

    figcaption {
      counter-increment: figure;
    }

    figcaption:not(.no-marker)::before {
      content: "Figure " counter(figure) " ";
    }
  </style>
  <style>
    /* style-dfn-panel */

    :root {
      --dfnpanel-bg: #ddd;
      --dfnpanel-text: var(--text);
    }

    .dfn-panel {
      position: absolute;
      z-index: 35;
      height: auto;
      width: -webkit-fit-content;
      width: fit-content;
      max-width: 300px;
      max-height: 500px;
      overflow: auto;
      padding: 0.5em 0.75em;
      font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
      background: var(--dfnpanel-bg);
      color: var(--dfnpanel-text);
      border: outset 0.2em;
    }

    .dfn-panel:not(.on) {
      display: none;
    }

    .dfn-panel * {
      margin: 0;
      padding: 0;
      text-indent: 0;
    }

    .dfn-panel>b {
      display: block;
    }

    .dfn-panel a {
      color: var(--dfnpanel-text);
    }

    .dfn-panel a:not(:hover) {
      text-decoration: none !important;
      border-bottom: none !important;
    }

    .dfn-panel>b+b {
      margin-top: 0.25em;
    }

    .dfn-panel ul {
      padding: 0;
    }

    .dfn-panel li {
      list-style: inside;
    }

    .dfn-panel.activated {
      display: inline-block;
      position: fixed;
      left: .5em;
      bottom: 2em;
      margin: 0 auto;
      max-width: calc(100vw - 1.5em - .4em - .5em);
      max-height: 30vh;
    }

    .dfn-paneled {
      cursor: pointer;
    }
  </style>
  <style>
    /* style-issues */

    a[href].issue-return {
      float: right;
      float: inline-end;
      color: var(--issueheading-text);
      font-weight: bold;
      text-decoration: none;
    }
  </style>
  <style>
    /* style-md-lists */

    /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
    [data-md]> :first-child {
      margin-top: 0;
    }

    [data-md]> :last-child {
      margin-bottom: 0;
    }
  </style>
  <style>
    /* style-mdn-anno */

    @media (max-width: 767px) {
      .mdn-anno {
        opacity: .1
      }
    }

    .mdn-anno {
      font: 1em sans-serif;
      padding: 0.3em;
      position: absolute;
      z-index: 8;
      right: 0.3em;
      background: #EEE;
      color: black;
      box-shadow: 0 0 3px #999;
      overflow: hidden;
      border-collapse: initial;
      border-spacing: initial;
      min-width: 9em;
      max-width: min-content;
      white-space: nowrap;
      word-wrap: normal;
      hyphens: none
    }

    .mdn-anno:not(.wrapped) {
      opacity: 1
    }

    .mdn-anno:hover {
      z-index: 9
    }

    .mdn-anno.wrapped {
      min-width: 0
    }

    .mdn-anno.wrapped> :not(button) {
      display: none;
    }

    .mdn-anno>.mdn-anno-btn {
      cursor: pointer;
      border: none;
      color: #000;
      background: transparent;
      margin: -8px;
      float: right;
      padding: 10px 8px 8px 8px;
      outline: none;
    }

    .mdn-anno>.mdn-anno-btn>.less-than-two-engines-flag {
      color: red;
      padding-right: 2px;
    }

    .mdn-anno>.mdn-anno-btn>.all-engines-flag {
      color: green;
      padding-right: 2px;
    }

    .mdn-anno>.mdn-anno-btn>span {
      color: #fff;
      background-color: #000;
      font-weight: normal;
      font-family: zillaslab, Palatino, "Palatino Linotype", serif;
      padding: 2px 3px 0px 3px;
      line-height: 1.3em;
      vertical-align: top;
    }

    .mdn-anno>.feature {
      margin-top: 20px;
    }

    .mdn-anno>.feature:not(:first-of-type) {
      border-top: 1px solid #999;
      margin-top: 6px;
      padding-top: 2px;
    }

    .mdn-anno>.feature>.less-than-two-engines-text {
      color: red
    }

    .mdn-anno>.feature>.all-engines-text {
      color: green
    }

    .mdn-anno>.feature>p {
      font-size: .75em;
      margin-top: 6px;
      margin-bottom: 0;
    }

    .mdn-anno>.feature>p+p {
      margin-top: 3px;
    }

    .mdn-anno>.feature>.support {
      display: block;
      font-size: 0.6em;
      margin: 0;
      padding: 0;
      margin-top: 2px
    }

    .mdn-anno>.feature>.support+div {
      padding-top: 0.5em;
    }

    .mdn-anno>.feature>.support>hr {
      display: block;
      border: none;
      border-top: 1px dotted #999;
      padding: 3px 0px 0px 0px;
      margin: 2px 3px 0px 3px;
    }

    .mdn-anno>.feature>.support>hr::before {
      content: "";
    }

    .mdn-anno>.feature>.support>span {
      padding: 0.2em 0;
      display: block;
      display: table;
    }

    .mdn-anno>.feature>.support>span.no {
      color: #CCCCCC;
      filter: grayscale(100%);
    }

    .mdn-anno>.feature>.support>span.no::before {
      opacity: 0.5;
    }

    .mdn-anno>.feature>.support>span:first-of-type {
      padding-top: 0.5em;
    }

    .mdn-anno>.feature>.support>span>span {
      padding: 0 0.5em;
      display: table-cell;
    }

    .mdn-anno>.feature>.support>span>span:first-child {
      width: 100%;
    }

    .mdn-anno>.feature>.support>span>span:last-child {
      width: 100%;
      white-space: pre;
      padding: 0;
    }

    .mdn-anno>.feature>.support>span::before {
      content: ' ';
      display: table-cell;
      min-width: 1.5em;
      height: 1.5em;
      background: no-repeat center center;
      background-size: contain;
      text-align: right;
      font-size: 0.75em;
      font-weight: bold;
    }

    .mdn-anno>.feature>.support>.chrome_android::before {
      background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
    }

    .mdn-anno>.feature>.support>.firefox_android::before {
      background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
    }

    .mdn-anno>.feature>.support>.chrome::before {
      background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
    }

    .mdn-anno>.feature>.support>.edge_blink::before {
      background-image: url(https://resources.whatwg.org/browser-logos/edge.svg);
    }

    .mdn-anno>.feature>.support>.edge::before {
      background-image: url(https://resources.whatwg.org/browser-logos/edge_legacy.svg);
    }

    .mdn-anno>.feature>.support>.firefox::before {
      background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
    }

    .mdn-anno>.feature>.support>.ie::before {
      background-image: url(https://resources.whatwg.org/browser-logos/ie.png);
    }

    .mdn-anno>.feature>.support>.safari_ios::before {
      background-image: url(https://resources.whatwg.org/browser-logos/safari-ios.svg);
    }

    .mdn-anno>.feature>.support>.nodejs::before {
      background-image: url(https://nodejs.org/static/images/favicons/favicon.ico);
    }

    .mdn-anno>.feature>.support>.opera_android::before {
      background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
    }

    .mdn-anno>.feature>.support>.opera::before {
      background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
    }

    .mdn-anno>.feature>.support>.safari::before {
      background-image: url(https://resources.whatwg.org/browser-logos/safari.png);
    }

    .mdn-anno>.feature>.support>.samsunginternet_android::before {
      background-image: url(https://resources.whatwg.org/browser-logos/samsung.svg);
    }

    .mdn-anno>.feature>.support>.webview_android::before {
      background-image: url(https://resources.whatwg.org/browser-logos/android-webview.png);
    }

    .name-slug-mismatch {
      color: red
    }

    .caniuse-status:hover {
      z-index: 9;
    }

    /* dt, li, .issue, .note, and .example are "position: relative", so to put annotation at right margin, must move to right of containing block */
    .h-entry:not(.status-LS) dt>.mdn-anno,
    .h-entry:not(.status-LS) li>.mdn-anno,
    .h-entry:not(.status-LS) .issue>.mdn-anno,
    .h-entry:not(.status-LS) .note>.mdn-anno,
    .h-entry:not(.status-LS) .example>.mdn-anno {
      right: -6.7em;
    }

    .h-entry p+.mdn-anno {
      margin-top: 0;
    }

    h2+.mdn-anno.after {
      margin: -48px 0 0 0;
    }

    h3+.mdn-anno.after {
      margin: -46px 0 0 0;
    }

    h4+.mdn-anno.after {
      margin: -42px 0 0 0;
    }

    h5+.mdn-anno.after {
      margin: -40px 0 0 0;
    }

    h6+.mdn-anno.after {
      margin: -40px 0 0 0;
    }
  </style>
  <style>
    /* style-selflinks */

    :root {
      --selflink-text: white;
      --selflink-bg: gray;
      --selflink-hover-text: black;
    }

    .heading,
    .issue,
    .note,
    .example,
    li,
    dt {
      position: relative;
    }

    a.self-link {
      position: absolute;
      top: 0;
      left: calc(-1 * (3.5rem - 26px));
      width: calc(3.5rem - 26px);
      height: 2em;
      text-align: center;
      border: none;
      transition: opacity .2s;
      opacity: .5;
    }

    a.self-link:hover {
      opacity: 1;
    }

    .heading>a.self-link {
      font-size: 83%;
    }

    li>a.self-link {
      left: calc(-1 * (3.5rem - 26px) - 2em);
    }

    dfn>a.self-link {
      top: auto;
      left: auto;
      opacity: 0;
      width: 1.5em;
      height: 1.5em;
      background: var(--selflink-bg);
      color: var(--selflink-text);
      font-style: normal;
      transition: opacity .2s, background-color .2s, color .2s;
    }

    dfn:hover>a.self-link {
      opacity: 1;
    }

    dfn>a.self-link:hover {
      color: var(--selflink-hover-text);
    }

    a.self-link::before {
      content: "¶";
    }

    .heading>a.self-link::before {
      content: "§";
    }

    dfn>a.self-link::before {
      content: "#";
    }
  </style>
  <style>
    /* style-syntax-highlighting */

    pre.idl.highlight {
      background: var(--borderedblock-bg, var(--def-bg));
    }

    code.highlight {
      padding: .1em;
      border-radius: .3em;
    }

    pre.highlight,
    pre>code.highlight {
      display: block;
      padding: 1em;
      margin: .5em 0;
      overflow: auto;
      border-radius: 0;
    }

    .highlight:not(.idl) {
      background: rgba(0, 0, 0, .03);
    }

    c-[a] {
      color: #990055
    }

    /* Keyword.Declaration */
    c-[b] {
      color: #990055
    }

    /* Keyword.Type */
    c-[c] {
      color: #708090
    }

    /* Comment */
    c-[d] {
      color: #708090
    }

    /* Comment.Multiline */
    c-[e] {
      color: #0077aa
    }

    /* Name.Attribute */
    c-[f] {
      color: #669900
    }

    /* Name.Tag */
    c-[g] {
      color: #222222
    }

    /* Name.Variable */
    c-[k] {
      color: #990055
    }

    /* Keyword */
    c-[l] {
      color: #000000
    }

    /* Literal */
    c-[m] {
      color: #000000
    }

    /* Literal.Number */
    c-[n] {
      color: #0077aa
    }

    /* Name */
    c-[o] {
      color: #999999
    }

    /* Operator */
    c-[p] {
      color: #999999
    }

    /* Punctuation */
    c-[s] {
      color: #a67f59
    }

    /* Literal.String */
    c-[t] {
      color: #a67f59
    }

    /* Literal.String.Single */
    c-[u] {
      color: #a67f59
    }

    /* Literal.String.Double */
    c-[cp] {
      color: #708090
    }

    /* Comment.Preproc */
    c-[c1] {
      color: #708090
    }

    /* Comment.Single */
    c-[cs] {
      color: #708090
    }

    /* Comment.Special */
    c-[kc] {
      color: #990055
    }

    /* Keyword.Constant */
    c-[kn] {
      color: #990055
    }

    /* Keyword.Namespace */
    c-[kp] {
      color: #990055
    }

    /* Keyword.Pseudo */
    c-[kr] {
      color: #990055
    }

    /* Keyword.Reserved */
    c-[ld] {
      color: #000000
    }

    /* Literal.Date */
    c-[nc] {
      color: #0077aa
    }

    /* Name.Class */
    c-[no] {
      color: #0077aa
    }

    /* Name.Constant */
    c-[nd] {
      color: #0077aa
    }

    /* Name.Decorator */
    c-[ni] {
      color: #0077aa
    }

    /* Name.Entity */
    c-[ne] {
      color: #0077aa
    }

    /* Name.Exception */
    c-[nf] {
      color: #0077aa
    }

    /* Name.Function */
    c-[nl] {
      color: #0077aa
    }

    /* Name.Label */
    c-[nn] {
      color: #0077aa
    }

    /* Name.Namespace */
    c-[py] {
      color: #0077aa
    }

    /* Name.Property */
    c-[ow] {
      color: #999999
    }

    /* Operator.Word */
    c-[mb] {
      color: #000000
    }

    /* Literal.Number.Bin */
    c-[mf] {
      color: #000000
    }

    /* Literal.Number.Float */
    c-[mh] {
      color: #000000
    }

    /* Literal.Number.Hex */
    c-[mi] {
      color: #000000
    }

    /* Literal.Number.Integer */
    c-[mo] {
      color: #000000
    }

    /* Literal.Number.Oct */
    c-[sb] {
      color: #a67f59
    }

    /* Literal.String.Backtick */
    c-[sc] {
      color: #a67f59
    }

    /* Literal.String.Char */
    c-[sd] {
      color: #a67f59
    }

    /* Literal.String.Doc */
    c-[se] {
      color: #a67f59
    }

    /* Literal.String.Escape */
    c-[sh] {
      color: #a67f59
    }

    /* Literal.String.Heredoc */
    c-[si] {
      color: #a67f59
    }

    /* Literal.String.Interpol */
    c-[sx] {
      color: #a67f59
    }

    /* Literal.String.Other */
    c-[sr] {
      color: #a67f59
    }

    /* Literal.String.Regex */
    c-[ss] {
      color: #a67f59
    }

    /* Literal.String.Symbol */
    c-[vc] {
      color: #0077aa
    }

    /* Name.Variable.Class */
    c-[vg] {
      color: #0077aa
    }

    /* Name.Variable.Global */
    c-[vi] {
      color: #0077aa
    }

    /* Name.Variable.Instance */
    c-[il] {
      color: #000000
    }

    /* Literal.Number.Integer.Long */
  </style>
  <style>
    /* style-var-click-highlighting */

    var {
      cursor: pointer;
    }

    var.selected0 {
      background-color: #F4D200;
      box-shadow: 0 0 0 2px #F4D200;
    }

    var.selected1 {
      background-color: #FF87A2;
      box-shadow: 0 0 0 2px #FF87A2;
    }

    var.selected2 {
      background-color: #96E885;
      box-shadow: 0 0 0 2px #96E885;
    }

    var.selected3 {
      background-color: #3EEED2;
      box-shadow: 0 0 0 2px #3EEED2;
    }

    var.selected4 {
      background-color: #EACFB6;
      box-shadow: 0 0 0 2px #EACFB6;
    }

    var.selected5 {
      background-color: #82DDFF;
      box-shadow: 0 0 0 2px #82DDFF;
    }

    var.selected6 {
      background-color: #FFBCF2;
      box-shadow: 0 0 0 2px #FFBCF2;
    }
  </style>
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-CRD" rel="stylesheet">

<body class="h-entry">
  <div class="head">
    <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
          src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"> </a> </p>
    <h1 class="p-name no-ref" id="title">服务工作线程</h1>
    <p id="w3c-state"><a href="https://www.w3.org/standards/types#CRD">W3C 候选推荐草案</a>, <time class="dt-updated"
        datetime="2022-07-12">2022年7月12日</time></p>
    <details open>
      <summary>更多关于此文档的细节</summary>
      <div data-fill-with="spec-metadata">
        <dl>
          <dt>此版本：
          <dd><a class="u-url"
              href="https://www.w3.org/TR/2022/CRD-service-workers-20220712/">https://www.w3.org/TR/2022/CRD-service-workers-20220712/</a>
          <dt>最新发布版本：
          <dd><a href="https://www.w3.org/TR/service-workers/">https://www.w3.org/TR/service-workers/</a>
          <dt>编辑草案：
          <dd><a href="https://w3c.github.io/ServiceWorker/">https://w3c.github.io/ServiceWorker/</a>
          <dt>历史记录：
          <dd><a class="u-url" data-previous-shortname="service-workers-1"
              href="https://www.w3.org/standards/history/service-workers">https://www.w3.org/standards/history/service-workers</a>
          <dt>实施报告：
          <dd><a href="https://wpt.fyi/service-workers">https://wpt.fyi/service-workers</a>
          <dt>反馈：
          <dd><a href="https://github.com/w3c/ServiceWorker/issues/">GitHub</a>
          <dd><a href="#issues-index">规范中的内联反馈</a>
          <dt class="editor">编辑：
          <dd class="editor p-author h-card vcard" data-editor-id="76394"><a class="p-name fn u-email email"
              href="mailto:jakearchibald@chromium.org">Jake Archibald</a> (<span class="p-org org">谷歌</span>)
          <dd class="editor p-author h-card vcard" data-editor-id="72440"><a class="p-name fn u-email email"
              href="mailto:mek@chromium.org">Marijn Kruisselbrink</a> (<span class="p-org org">谷歌</span>)
          <dt class="editor">前编辑：
          <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email"
              href="mailto:slightlyoff@chromium.org">Alex Russell</a> (<span class="p-org org">谷歌</span>)
          <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email"
              href="mailto:jungkee.song@microsoft.com">Jungkee Song</a> (<span class="p-org org">微软，代表三星至2018年4月</span>)
          <dt>测试：
          <dd><a href="https://github.com/web-platform-tests/wpt/tree/master/service-workers">web-platform-tests
              service-workers/</a> (<a
              href="https://github.com/web-platform-tests/wpt/labels/service-workers">正在进行的工作</a>)
        </dl>
      </div>
    </details>
    <div data-fill-with="warning"></div>
    <p class="copyright" data-fill-with="copyright"><a
        href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">版权所有</a> © 2022 <a
        href="https://www.w3.org/"><abbr title="万维网联盟">W3C</abbr></a><sup>®</sup> (<a
        href="https://www.csail.mit.edu/"><abbr title="麻省理工学院">MIT</abbr></a>, <a href="https://www.ercim.eu/"><abbr
          title="欧洲信息与数学研究联盟">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">庆应义塾大学</a>, <a
        href="https://ev.buaa.edu.cn/">北航</a>). W3C <a
        href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">责任声明</a>, <a
        href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">商标</a> 和 <a
        href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" rel="license">宽松的文档许可</a> 规则适用。
    </p>
    <hr title="页眉分隔符">
  </div>
  <div class="p-summary" data-fill-with="abstract">
    <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">摘要</span></h2>
    <p>本规范的核心是一个唤醒以接收事件的工作线程。当其他目标不合适或不存在其他目标时，这提供了一个事件目标。</p>
    <p>例如，为了允许开发者决定页面应该如何获取，需要在该源的任何其他执行上下文存在之前可能分发一个事件。为了响应推送消息或持久下载的完成，最初注册感兴趣的上下文可能不再存在。在这些情况下，服务工作线程是理想的事件目标。</p>
    <p>本规范还提供了一个<a data-link-type="dfn" href="#handle-fetch" id="ref-for-handle-fetch">fetch 事件</a>和一个类似于HTTP缓存的<a
        href="#cache-objects">请求和响应存储</a>，这使得构建支持离线的Web应用程序变得更容易。</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">本文档的状态</span></h2>
  <div data-fill-with="status">
    <p><em>本节描述了本文档在发布时的状态。
        当前 <abbr title="万维网联盟">W3C</abbr> 出版物列表和本技术报告的最新修订版可以在
        <a href="https://www.w3.org/TR/"><abbr title="万维网联盟">W3C</abbr> 技术报告索引</a>中找到：https://www.w3.org/TR/。</em></p>
    <p>本文件由<a href="https://www.w3.org/groups/wg/service-workers">服务工作线程工作组</a>作为使用
      <a href="https://www.w3.org/2021/Process-20211102/#recs-and-notes">推荐路径</a>的候选推荐草案发布。
    </p>
    <p>欢迎对本规范提出反馈和意见，请<a href="https://github.com/w3c/ServiceWorker/issues/new">提交错误报告</a>或向
      <a href="mailto:public-webapps@w3.org?subject=%5Bservice-workers%5D">public-webapps@w3.org</a>发送评论（<a
        href="mailto:public-webapps@w3.org?subject=subscribe">订阅</a>，<a
        href="https://lists.w3.org/Archives/Public/public-webapps/">档案</a>），邮件主题开头请注明 <code>[service-workers]</code>。
    </p>
    <p>作为候选推荐草案的发布并不意味着 <abbr title="万维网联盟">W3C</abbr> 及其成员的认可。候选推荐草案集成了工作组打算在后续候选推荐快照中包含的对先前候选推荐的更改。</p>
    <p>这是一个草案文件，可能会随时更新、替换或被其他文件取代。将本文档作为除工作进展外的引用是不合适的。</p>
    <p>本文件由一个根据 <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="万维网联盟">W3C</abbr> 专利政策</a>
      运行的小组制作。<abbr title="万维网联盟">W3C</abbr> 在
      <a href="https://www.w3.org/groups/wg/service-workers/ipr"
        rel="disclosure">公开列出</a>了在与小组交付物相关的专利披露信息；该页面还包括披露专利的说明。如果某个人确实知道包含
      <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">基本要求</a> 的专利，则必须根据 <a
        href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">W3C 专利政策第6节</a>披露该信息。
    </p>
    <p>本文件受 <a href="https://www.w3.org/2021/Process-20211102/" id="w3c_process_revision">2021年11月2日 <abbr
          title="万维网联盟">W3C</abbr> 流程文件</a>管辖。</p>
  </div>

  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
    <h2 class="no-num no-toc no-ref" id="contents">目录</h2>
    <ol class="toc" role="directory">
      <li><a href="#motivations"><span class="secno">1</span> <span class="content">动机</span></a>
      <li>
        <a href="#model"><span class="secno">2</span> <span class="content">模型</span></a>
        <ol class="toc">
          <li>
            <a href="#service-worker-concept"><span class="secno">2.1</span> <span class="content">服务工作线程</span></a>
            <ol class="toc">
              <li><a href="#service-worker-lifetime"><span class="secno">2.1.1</span> <span
                    class="content">生命周期</span></a>
              <li><a href="#service-worker-events"><span class="secno">2.1.2</span> <span class="content">事件</span></a>
            </ol>
          <li><a href="#service-worker-timing"><span class="secno">2.2</span> <span class="content">服务工作线程时序</span></a>
          <li>
            <a href="#service-worker-registration-concept"><span class="secno">2.3</span> <span
                class="content">服务工作线程注册</span></a>
            <ol class="toc">
              <li><a href="#service-worker-registration-lifetime"><span class="secno">2.3.1</span> <span
                    class="content">生命周期</span></a>
            </ol>
          <li><a href="#service-worker-client-concept"><span class="secno">2.4</span> <span
                class="content">服务工作线程客户端</span></a>
          <li>
            <a href="#control-and-use"><span class="secno">2.5</span> <span class="content">控制与使用</span></a>
            <ol class="toc">
              <li><a href="#control-and-use-window-client"><span class="secno">2.5.1</span> <span
                    class="content">窗口客户端情况</span></a>
              <li><a href="#control-and-use-worker-client"><span class="secno">2.5.2</span> <span
                    class="content">工作线程客户端情况</span></a>
            </ol>
          <li><a href="#task-sources"><span class="secno">2.6</span> <span class="content">任务来源</span></a>
          <li><a href="#user-agent-shutdown"><span class="secno">2.7</span> <span class="content">用户代理关闭</span></a>
        </ol>
      <li>
        <a href="#document-context"><span class="secno">3</span> <span class="content">客户端上下文</span></a>
        <ol class="toc">
          <li>
            <a href="#serviceworker-interface"><span class="secno">3.1</span> <span class="content"><code
                  class="idl"><span>ServiceWorker</span></code></span></a>
            <ol class="toc">
              <li><a href="#service-worker-creation"><span class="secno">3.1.1</span> <span class="content">获取 <code
                      class="idl"><span>ServiceWorker</span></code> 实例</span></a>
              <li><a href="#service-worker-url"><span class="secno">3.1.2</span> <span class="content"><code
                      class="idl"><span>scriptURL</span></code></span></a>
              <li><a href="#service-worker-state"><span class="secno">3.1.3</span> <span class="content"><code
                      class="idl"><span>state</span></code></span></a>
              <li><a href="#service-worker-postmessage"><span class="secno">3.1.4</span> <span class="content"><code
                      class="idl"><span>postMessage(message, transfer)</span></code></span></a>
              <li><a href="#service-worker-postmessage-options"><span class="secno">3.1.5</span> <span
                    class="content"><code class="idl"><span>postMessage(message, options)</span></code></span></a>
              <li><a href="#service-worker-event-handler"><span class="secno">3.1.6</span> <span
                    class="content">事件处理器</span></a>
            </ol>
          <li>
            <a href="#serviceworkerregistration-interface"><span class="secno">3.2</span> <span class="content"><code
                  class="idl"><span>ServiceWorkerRegistration</span></code></span></a>
            <ol class="toc">
              <li><a href="#service-worker-registration-creation"><span class="secno">3.2.1</span> <span
                    class="content">获取 <code class="idl"><span>ServiceWorkerRegistration</span></code> 实例</span></a>
              <li><a href="#navigator-service-worker-installing"><span class="secno">3.2.2</span> <span
                    class="content"><code class="idl"><span>installing</span></code></span></a>
              <li><a href="#navigator-service-worker-waiting"><span class="secno">3.2.3</span> <span
                    class="content"><code class="idl"><span>waiting</span></code></span></a>
              <li><a href="#navigator-service-worker-active"><span class="secno">3.2.4</span> <span
                    class="content"><code class="idl"><span>active</span></code></span></a>
              <li><a href="#service-worker-registration-navigationpreload"><span class="secno">3.2.5</span> <span
                    class="content"><code class="idl"><span>navigationPreload</span></code></span></a>
              <li><a href="#service-worker-registration-scope"><span class="secno">3.2.6</span> <span
                    class="content"><code class="idl"><span>scope</span></code></span></a>
              <li><a href="#service-worker-registration-updateviacache"><span class="secno">3.2.7</span> <span
                    class="content"><code class="idl"><span>updateViaCache</span></code></span></a>
              <li><a href="#service-worker-registration-update"><span class="secno">3.2.8</span> <span
                    class="content"><code class="idl"><span>update()</span></code></span></a>
              <li><a href="#navigator-service-worker-unregister"><span class="secno">3.2.9</span> <span
                    class="content"><code class="idl"><span>unregister()</span></code></span></a>
              <li><a href="#service-worker-registration-event-handler"><span class="secno">3.2.10</span> <span
                    class="content">事件处理器</span></a>
            </ol>
          <li><a href="#navigator-serviceworker"><span class="secno">3.3</span> <span class="content"><code
                  class="idl"><span>navigator.serviceWorker</span></code></span></a>
          <li>
            <a href="#serviceworkercontainer-interface"><span class="secno">3.4</span> <span class="content"><code
                  class="idl"><span>ServiceWorkerContainer</span></code></span></a>
            <ol class="toc">
              <li><a href="#navigator-service-worker-controller"><span class="secno">3.4.1</span> <span
                    class="content"><code class="idl"><span>controller</span></code></span></a>
              <li><a href="#navigator-service-worker-ready"><span class="secno">3.4.2</span> <span class="content"><code
                      class="idl"><span>ready</span></code></span></a>
              <li><a href="#navigator-service-worker-register"><span class="secno">3.4.3</span> <span
                    class="content"><code class="idl"><span>register(scriptURL, options)</span></code></span></a>
              <li><a href="#navigator-service-worker-getRegistration"><span class="secno">3.4.4</span> <span
                    class="content"><code class="idl"><span>getRegistration(clientURL)</span></code></span></a>
              <li><a href="#navigator-service-worker-getRegistrations"><span class="secno">3.4.5</span> <span
                    class="content"><code class="idl"><span>getRegistrations()</span></code></span></a>
              <li><a href="#navigator-service-worker-startMessages"><span class="secno">3.4.6</span> <span
                    class="content"><code class="idl"><span>startMessages()</span></code></span></a>
              <li><a href="#service-worker-container-event-handlers"><span class="secno">3.4.7</span> <span
                    class="content">事件处理器</span></a>
            </ol>
          <li><a href="#document-context-events"><span class="secno">3.5</span> <span class="content">事件</span></a>
          <li>
            <a href="#navigation-preload-manager"><span class="secno">3.6</span> <span class="content"><code
                  class="idl"><span>NavigationPreloadManager</span></code></span></a>
            <ol class="toc">
              <li><a href="#navigation-preload-manager-enable"><span class="secno">3.6.1</span> <span
                    class="content"><code class="idl"><span>enable()</span></code></span></a>
              <li><a href="#navigation-preload-manager-disable"><span class="secno">3.6.2</span> <span
                    class="content"><code class="idl"><span>disable()</span></code></span></a>
              <li><a href="#navigation-preload-manager-setheadervalue"><span class="secno">3.6.3</span> <span
                    class="content"><code class="idl"><span>setHeaderValue(value)</span></code></span></a>
              <li><a href="#navigation-preload-manager-getstate"><span class="secno">3.6.4</span> <span
                    class="content"><code class="idl"><span>getState()</span></code></span></a>
            </ol>
        </ol>
      <li>
        <a href="#execution-context"><span class="secno">4</span> <span class="content">执行上下文</span></a>
        <ol class="toc">
          <li>
            <a href="#serviceworkerglobalscope-interface"><span class="secno">4.1</span> <span class="content"><code
                  class="idl"><span>ServiceWorkerGlobalScope</span></code></span></a>
            <ol class="toc">
              <li><a href="#service-worker-global-scope-clients"><span class="secno">4.1.1</span> <span
                    class="content"><code class="idl"><span>clients</span></code></span></a>
              <li><a href="#service-worker-global-scope-registration"><span class="secno">4.1.2</span> <span
                    class="content"><code class="idl"><span>registration</span></code></span></a>
              <li><a href="#service-worker-global-scope-serviceworker"><span class="secno">4.1.3</span> <span
                    class="content"><code class="idl"><span>serviceWorker</span></code></span></a>
              <li><a href="#service-worker-global-scope-skipwaiting"><span class="secno">4.1.4</span> <span
                    class="content"><code class="idl"><span>skipWaiting()</span></code></span></a>
              <li><a href="#service-worker-global-scope-event-handlers"><span class="secno">4.1.5</span> <span
                    class="content">事件处理器</span></a>
            </ol>
          <li>
            <a href="#client-interface"><span class="secno">4.2</span> <span class="content"><code
                  class="idl"><span>Client</span></code></span></a>
            <ol class="toc">
              <li><a href="#client-url"><span class="secno">4.2.1</span> <span class="content"><code
                      class="idl"><span>url</span></code></span></a>
              <li><a href="#client-frametype"><span class="secno">4.2.2</span> <span class="content"><code
                      class="idl"><span>frameType</span></code></span></a>
              <li><a href="#client-id"><span class="secno">4.2.3</span> <span class="content"><code
                      class="idl"><span>id</span></code></span></a>
              <li><a href="#client-type"><span class="secno">4.2.4</span> <span class="content"><code
                      class="idl"><span>type</span></code></span></a>
              <li><a href="#client-postmessage"><span class="secno">4.2.5</span> <span class="content"><code
                      class="idl"><span>postMessage(message, transfer)</span></code></span></a>
              <li><a href="#client-postmessage-options"><span class="secno">4.2.6</span> <span class="content"><code
                      class="idl"><span>postMessage(message, options)</span></code></span></a>
              <li><a href="#client-visibilitystate"><span class="secno">4.2.7</span> <span class="content"><code
                      class="idl"><span>visibilityState</span></code></span></a>
              <li><a href="#client-focused"><span class="secno">4.2.8</span> <span class="content"><code
                      class="idl"><span>focused</span></code></span></a>
              <li><a href="#client-ancestororigins"><span class="secno">4.2.9</span> <span class="content"><code
                      class="idl"><span>ancestorOrigins</span></code></span></a>
              <li><a href="#client-focus"><span class="secno">4.2.10</span> <span class="content"><code
                      class="idl"><span>focus()</span></code></span></a>
              <li><a href="#client-navigate"><span class="secno">4.2.11</span> <span class="content"><code
                      class="idl"><span>navigate(url)</span></code></span></a>
            </ol>
          <li>
            <a href="#clients-interface"><span class="secno">4.3</span> <span class="content"><code
                  class="idl"><span>Clients</span></code></span></a>
            <ol class="toc">
              <li><a href="#clients-get"><span class="secno">4.3.1</span> <span class="content"><code
                      class="idl"><span>get(id)</span></code></span></a>
              <li><a href="#clients-matchall"><span class="secno">4.3.2</span> <span class="content"><code
                      class="idl"><span>matchAll(options)</span></code></span></a>
              <li><a href="#clients-openwindow"><span class="secno">4.3.3</span> <span class="content"><code
                      class="idl"><span>openWindow(url)</span></code></span></a>
              <li><a href="#clients-claim"><span class="secno">4.3.4</span> <span class="content"><code
                      class="idl"><span>claim()</span></code></span></a>
            </ol>
          <li>
            <a href="#extendableevent-interface"><span class="secno">4.4</span> <span class="content"><code
                  class="idl"><span>ExtendableEvent</span></code></span></a>
            <ol class="toc">
              <li><a href="#wait-until-method"><span class="secno">4.4.1</span> <span class="content"><code
                      class="idl"><span>event.waitUntil(f)</span></code></span></a>
            </ol>
          <li>
            <a href="#fetchevent-interface"><span class="secno">4.5</span> <span class="content"><code
                  class="idl"><span>FetchEvent</span></code></span></a>
            <ol class="toc">
              <li><a href="#fetch-event-request"><span class="secno">4.5.1</span> <span class="content"><code
                      class="idl"><span>event.request</span></code></span></a>
              <li><a href="#fetch-event-preloadresponse"><span class="secno">4.5.2</span> <span class="content"><code
                      class="idl"><span>event.preloadResponse</span></code></span></a>
              <li><a href="#fetch-event-clientid"><span class="secno">4.5.3</span> <span class="content"><code
                      class="idl"><span>event.clientId</span></code></span></a>
              <li><a href="#fetch-event-resultingclientid"><span class="secno">4.5.4</span> <span class="content"><code
                      class="idl"><span>event.resultingClientId</span></code></span></a>
              <li><a href="#fetch-event-replacesClientId"><span class="secno">4.5.5</span> <span class="content"><code
                      class="idl"><span>event.replacesClientId</span></code></span></a>
              <li><a href="#fetch-event-handled"><span class="secno">4.5.6</span> <span class="content"><code
                      class="idl"><span>event.handled</span></code></span></a>
              <li><a href="#fetch-event-respondwith"><span class="secno">4.5.7</span> <span class="content"><code
                      class="idl"><span>event.respondWith(r)</span></code></span></a>
            </ol>
          <li>
            <a href="#extendablemessageevent-interface"><span class="secno">4.6</span> <span class="content"><code
                  class="idl"><span>ExtendableMessageEvent</span></code></span></a>
            <ol class="toc">
              <li><a href="#extendablemessage-event-data"><span class="secno">4.6.1</span> <span class="content"><code
                      class="idl"><span>event.data</span></code></span></a>
              <li><a href="#extendablemessage-event-origin"><span class="secno">4.6.2</span> <span class="content"><code
                      class="idl"><span>event.origin</span></code></span></a>
              <li><a href="#extendablemessage-event-lasteventid"><span class="secno">4.6.3</span> <span
                    class="content"><code class="idl"><span>event.lastEventId</span></code></span></a>
              <li><a href="#extendablemessage-event-source"><span class="secno">4.6.4</span> <span class="content"><code
                      class="idl"><span>event.source</span></code></span></a>
              <li><a href="#extendablemessage-event-ports"><span class="secno">4.6.5</span> <span class="content"><code
                      class="idl"><span>event.ports</span></code></span></a>
            </ol>
          <li><a href="#execution-context-events"><span class="secno">4.7</span> <span class="content">事件</span></a>
        </ol>
      <li>
        <a href="#cache-objects"><span class="secno">5</span> <span class="content">缓存</span></a>
        <ol class="toc">
          <li><a href="#cache-constructs"><span class="secno">5.1</span> <span class="content">构造</span></a>
          <li><a href="#cache-lifetimes"><span class="secno">5.2</span> <span class="content">理解缓存生命周期</span></a>
          <li>
            <a href="#self-caches"><span class="secno">5.3</span> <span class="content"><code
                  class="idl"><span>self.caches</span></code></span></a>
            <ol class="toc">
              <li><a href="#global-caches"><span class="secno">5.3.1</span> <span class="content"><code
                      class="idl"><span>caches</span></code></span></a>
            </ol>
          <li>
            <a href="#cache-interface"><span class="secno">5.4</span> <span class="content"><code
                  class="idl"><span>Cache</span></code></span></a>
            <ol class="toc">
              <li><a href="#cache-match"><span class="secno">5.4.1</span> <span class="content"><code
                      class="idl"><span>match(request, options)</span></code></span></a>
              <li><a href="#cache-matchall"><span class="secno">5.4.2</span> <span class="content"><code
                      class="idl"><span>matchAll(request, options)</span></code></span></a>
              <li><a href="#cache-add"><span class="secno">5.4.3</span> <span class="content"><code
                      class="idl"><span>add(request)</span></code></span></a>
              <li><a href="#cache-addAll"><span class="secno">5.4.4</span> <span class="content"><code
                      class="idl"><span>addAll(requests)</span></code></span></a>
              <li><a href="#cache-put"><span class="secno">5.4.5</span> <span class="content"><code
                      class="idl"><span>put(request, response)</span></code></span></a>
              <li><a href="#cache-delete"><span class="secno">5.4.6</span> <span class="content"><code
                      class="idl"><span>delete(request, options)</span></code></span></a>
              <li><a href="#cache-keys"><span class="secno">5.4.7</span> <span class="content"><code
                      class="idl"><span>keys(request, options)</span></code></span></a>
            </ol>
          <li>
            <a href="#cachestorage-interface"><span class="secno">5.5</span> <span class="content"><code
                  class="idl"><span>CacheStorage</span></code></span></a>
            <ol class="toc">
              <li><a href="#cache-storage-match"><span class="secno">5.5.1</span> <span class="content"><code
                      class="idl"><span>match(request, options)</span></code></span></a>
              <li><a href="#cache-storage-has"><span class="secno">5.5.2</span> <span class="content"><code
                      class="idl"><span>has(cacheName)</span></code></span></a>
              <li><a href="#cache-storage-open"><span class="secno">5.5.3</span> <span class="content"><code
                      class="idl"><span>open(cacheName)</span></code></span></a>
              <li><a href="#cache-storage-delete"><span class="secno">5.5.4</span> <span class="content"><code
                      class="idl"><span>delete(cacheName)</span></code></span></a>
              <li><a href="#cache-storage-keys"><span class="secno">5.5.5</span> <span class="content"><code
                      class="idl"><span>keys()</span></code></span></a>
            </ol>
        </ol>
      <li>
        <a href="#security-considerations"><span class="secno">6</span> <span class="content">安全考虑</span></a>
        <ol class="toc">
          <li><a href="#secure-context"><span class="secno">6.1</span> <span class="content">安全上下文</span></a>
          <li><a href="#content-security-policy"><span class="secno">6.2</span> <span class="content">内容安全策略</span></a>
          <li>
            <a href="#origin-relativity"><span class="secno">6.3</span> <span class="content">源相关性</span></a>
            <ol class="toc">
              <li><a href="#origin-restriction"><span class="secno">6.3.1</span> <span class="content">源限制</span></a>
              <li><a href="#importscripts"><span class="secno">6.3.2</span> <span class="content"><code
                      class="idl"><span>importScripts(urls)</span></code></span></a>
            </ol>
          <li><a href="#cross-origin-resources"><span class="secno">6.4</span> <span
                class="content">跨源资源和CORS</span></a>
          <li><a href="#path-restriction"><span class="secno">6.5</span> <span class="content">路径限制</span></a>
          <li><a href="#script-request"><span class="secno">6.6</span> <span class="content">服务工作线程脚本请求</span></a>
          <li><a href="#implementer-concerns"><span class="secno">6.7</span> <span class="content">实施者关注</span></a>
          <li><a href="#privacy"><span class="secno">6.8</span> <span class="content">隐私</span></a>
        </ol>
      <li>
        <a href="#extensibility"><span class="secno">7</span> <span class="content">可扩展性</span></a>
        <ol class="toc">
          <li><a href="#extension-to-service-worker-registration"><span class="secno">7.1</span> <span
                class="content">定义绑定到服务工作线程注册的API</span></a>
          <li><a href="#extension-to-extendable-event"><span class="secno">7.2</span> <span
                class="content">定义功能性事件</span></a>
          <li><a href="#extension-to-service-worker-global-scope"><span class="secno">7.3</span> <span
                class="content">定义事件处理器</span></a>
          <li><a href="#firing-functional-events"><span class="secno">7.4</span> <span
                class="content">触发功能性事件</span></a>
        </ol>
      <li>
        <a href="#algorithms"><span class="secno"></span> <span class="content">附录A：算法</span></a>
        <ol class="toc">
          <li><a href="#create-job-algorithm"><span class="secno"></span> <span
                class="content"><span>创建任务</span></span></a>
          <li><a href="#schedule-job-algorithm"><span class="secno"></span> <span
                class="content"><span>调度任务</span></span></a>
          <li><a href="#run-job-algorithm"><span class="secno"></span> <span
                class="content"><span>运行任务</span></span></a>
          <li><a href="#finish-job-algorithm"><span class="secno"></span> <span
                class="content"><span>完成任务</span></span></a>
          <li><a href="#resolve-job-promise-algorithm"><span class="secno"></span> <span
                class="content"><span>解决任务Promise</span></span></a>
          <li><a href="#reject-job-promise-algorithm"><span class="secno"></span> <span
                class="content"><span>拒绝任务Promise</span></span></a>
          <li><a href="#start-register-algorithm"><span class="secno"></span> <span
                class="content"><span>开始注册</span></span></a>
          <li><a href="#register-algorithm"><span class="secno"></span> <span class="content"><span>注册</span></span></a>
          <li><a href="#update-algorithm"><span class="secno"></span> <span class="content"><span>更新</span></span></a>
          <li><a href="#soft-update-algorithm"><span class="secno"></span> <span
                class="content"><span>软更新</span></span></a>
          <li><a href="#installation-algorithm"><span class="secno"></span> <span
                class="content"><span>安装</span></span></a>
          <li><a href="#activation-algorithm"><span class="secno"></span> <span
                class="content"><span>激活</span></span></a>
          <li><a href="#try-activate-algorithm"><span class="secno"></span> <span
                class="content"><span>尝试激活</span></span></a>
          <li><a href="#run-service-worker-algorithm"><span class="secno"></span> <span
                class="content"><span>运行服务工作线程</span></span></a>
          <li><a href="#terminate-service-worker-algorithm"><span class="secno"></span> <span
                class="content"><span>终止服务工作线程</span></span></a>
          <li><a href="#on-fetch-request-algorithm"><span class="secno"></span> <span
                class="content"><span>处理Fetch请求</span></span></a>
          <li><a href="#should-skip-event-algorithm"><span class="secno"></span> <span
                class="content"><span>是否应跳过事件</span></span></a>
          <li><a href="#fire-functional-event-algorithm"><span class="secno"></span> <span
                class="content"><span>触发功能性事件</span></span></a>
          <li><a href="#on-client-unload-algorithm"><span class="secno"></span> <span
                class="content"><span>处理服务工作线程客户端卸载</span></span></a>
          <li><a href="#on-user-agent-shutdown-algorithm"><span class="secno"></span> <span
                class="content"><span>处理用户代理关闭</span></span></a>
          <li><a href="#update-service-worker-extended-events-set-algorithm"><span class="secno"></span> <span
                class="content"><span>更新服务工作线程扩展事件集</span></span></a>
          <li><a href="#unregister-algorithm"><span class="secno"></span> <span
                class="content"><span>取消注册</span></span></a>
          <li><a href="#set-registration-algorithm"><span class="secno"></span> <span
                class="content"><span>设置注册</span></span></a>
          <li><a href="#clear-registration-algorithm"><span class="secno"></span> <span
                class="content"><span>清除注册</span></span></a>
          <li><a href="#try-clear-registration-algorithm"><span class="secno"></span> <span
                class="content"><span>尝试清除注册</span></span></a>
          <li><a href="#update-registration-state-algorithm"><span class="secno"></span> <span
                class="content"><span>更新注册状态</span></span></a>
          <li><a href="#update-state-algorithm"><span class="secno"></span> <span
                class="content"><span>更新工作线程状态</span></span></a>
          <li><a href="#notify-controller-change-algorithm"><span class="secno"></span> <span
                class="content"><span>通知控制器变更</span></span></a>
          <li><a href="#scope-match-algorithm"><span class="secno"></span> <span
                class="content"><span>匹配服务工作线程注册</span></span></a>
          <li><a href="#get-registration-algorithm"><span class="secno"></span> <span
                class="content"><span>获取注册</span></span></a>
          <li><a href="#get-newest-worker-algorithm"><span class="secno"></span> <span
                class="content"><span>获取最新工作线程</span></span></a>
          <li><a href="#service-worker-has-no-pending-events-algorithm"><span class="secno"></span> <span
                class="content"><span>服务工作线程无待处理事件</span></span></a>
          <li><a href="#create-client-algorithm"><span class="secno"></span> <span
                class="content"><span>创建客户端</span></span></a>
          <li><a href="#create-windowclient-algorithm"><span class="secno"></span> <span
                class="content"><span>创建窗口客户端</span></span></a>
          <li><a href="#get-frametype-algorithm"><span class="secno"></span> <span
                class="content"><span>获取框架类型</span></span></a>
          <li><a href="#resolve-get-client-promise-algorithm"><span class="secno"></span> <span
                class="content"><span>解决获取客户端Promise</span></span></a>
          <li><a href="#query-cache-algorithm"><span class="secno"></span> <span
                class="content"><span>查询缓存</span></span></a>
          <li><a href="#request-matches-cached-item-algorithm"><span class="secno"></span> <span
                class="content"><span>请求匹配缓存项</span></span></a>
          <li><a href="#batch-cache-operations-algorithm"><span class="secno"></span> <span
                class="content"><span>批处理缓存操作</span></span></a>
          <li><a href="#is-async-module-algorithm"><span class="secno"></span> <span
                class="content"><span>是否为异步模块</span></span></a>
        </ol>
      <li>
        <a href="#extended-http-headers"><span class="secno"></span> <span class="content">附录B：扩展的HTTP头</span></a>
        <ol class="toc">
          <li><a href="#service-worker-script-request"><span class="secno"></span> <span
                class="content">服务工作线程脚本请求</span></a>
          <li><a href="#service-worker-script-response"><span class="secno"></span> <span
                class="content">服务工作线程脚本响应</span></a>
          <li><a href="#syntax"><span class="secno"></span> <span class="content">语法</span></a>
        </ol>
      <li><a href="#acknowledgements"><span class="secno">8</span> <span class="content">致谢</span></a>
      <li>
        <a href="#w3c-conformance"><span class="secno"></span> <span class="content">一致性</span></a>
        <ol class="toc">
          <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">文档惯例</span></a>
          <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">符合的算法</span></a>
        </ol>
      <li>
        <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
        <ol class="toc">
          <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">本规范定义的术语</span></a>
          <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">参考定义的术语</span></a>
        </ol>
      <li>
        <a href="#references"><span class="secno"></span> <span class="content">参考资料</span></a>
        <ol class="toc">
          <li><a href="#normative"><span class="secno"></span> <span class="content">规范性参考资料</span></a>
          <li><a href="#informative"><span class="secno"></span> <span class="content">参考性参考资料</span></a>
        </ol>
      <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL 索引</span></a>
      <li><a href="#issues-index"><span class="secno"></span> <span class="content">问题索引</span></a>
    </ol>
  </nav>

  <main>
    <section>
      <h2 class="heading settled" data-level="1" id="motivations"><span class="secno">1. </span><span
          class="content">动机</span><a class="self-link" href="#motivations"></a></h2>
      <p><em>本节是非规范性的。</em></p>
      <p>Web 应用程序传统上假设网络是可达的。这一假设贯穿整个平台。HTML 文档通过 HTTP 加载，并且传统上通过后续的 HTTP 请求获取所有子资源。这使得 Web 内容在与其他技术栈的竞争中处于劣势。</p>
      <p><a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker">服务工作线程</a>的设计初衷是通过提供一个 Web
        Worker
        上下文来平衡这一点，该上下文可以在导航即将发生时由运行时启动。这种事件驱动的工作线程针对一个源和一个路径（或模式）进行注册，这意味着当导航到该位置时，可以参考它。与网络请求对应的事件被分派给工作线程，工作线程生成的响应可能会覆盖默认的网络栈行为。从概念上讲，这使得<a
          data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker①">服务工作线程</a>位于网络和文档渲染器之间，从而允许<a
          data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker②">服务工作线程</a>在离线时为文档提供内容。</p>
      <p>熟悉以前解决离线问题尝试的 Web 开发人员报告了这些解决方案中的灵活性不足。因此，<a data-link-type="dfn" href="#dfn-service-worker"
          id="ref-for-dfn-service-worker③">服务工作线程</a>是高度程序化的，在为开发人员提供最大灵活性的同时，也增加了复杂性。部分复杂性来源于在单线程执行模型下保持<a
          data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker④">服务工作线程</a>响应的需要。因此，<a
          data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑤">服务工作线程</a>暴露的 API
        几乎完全是异步的，这在其他 JavaScript 上下文中是常见的模式，但在这里由于需要避免阻塞文档和资源加载而更加显著。</p>
      <p>使用 <a href="https://developer.mozilla.org/docs/Web/API/Window/applicationCache">HTML5 应用程序缓存</a> 的开发人员也 <a
          href="http://alistapart.com/article/application-cache-is-a-douchebag">报告了一些设计属性</a> 导致了 <a
          href="http://alistapart.com/article/application-cache-is-a-douchebag#section6">不可恢复的错误</a>。<a
          data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑥">服务工作线程</a> 的一个关键设计原则是错误应该
        <em>始终</em> 可恢复。<a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑦">服务工作线程</a>
        的更新过程中的许多细节旨在避免这些风险。
      </p>
      <p><a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑧">服务工作线程</a>
        是由它们与事件的关系启动并保持活跃的，而不是由文档。这种设计大量借鉴了开发人员和供应商在 <a data-link-type="dfn"
          href="https://html.spec.whatwg.org/multipage/workers.html#shared-workers"
          id="ref-for-shared-workers">共享工作线程</a> 和 <a
          href="https://developer.chrome.com/extensions/background_pages">Chrome 背景页面</a>
        中的经验教训。这些系统的一个关键教训是限制后台处理上下文执行时间的必要性，既要节省资源，又要确保后台上下文丢失和重启成为开发人员的重点考虑。因此，<a data-link-type="dfn"
          href="#dfn-service-worker" id="ref-for-dfn-service-worker⑨">服务工作线程</a> 与 <a
          href="https://developer.chrome.com/extensions/event_pages">Chrome 事件页面</a> 颇为相似，后者是背景页面的继任者。<a
          data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker①⓪">服务工作线程</a> 可能由用户代理
        <em>在没有附加文档的情况下</em> 启动，并且可能在几乎任何时候被用户代理终止。从概念上讲，<a data-link-type="dfn" href="#dfn-service-worker"
          id="ref-for-dfn-service-worker①①">服务工作线程</a> 可以被认为是可以启动、处理事件并在没有处理文档消息的情况下终止的共享工作线程。开发人员应牢记，<a
          data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker①②">服务工作线程</a> 可能每秒启动和终止多次。
      </p>
      <p><a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker①③">服务工作线程</a>
        是通用的、事件驱动的、时间限制的脚本上下文，它们在一个源上运行。这些特性使它们成为一系列运行时服务的自然终端，这些服务可能会超出特定文档的上下文，例如处理推送通知、后台数据同步、响应来自其他源的资源请求或接收对昂贵计算数据（例如地理位置或陀螺仪）的集中更新。
      </p>
    </section>

    <section>
      <h2 class="heading settled" data-level="2" id="model"><span class="secno">2. </span><span
          class="content">模型</span><a class="self-link" href="#model"></a></h2>
      <section>
        <h3 class="heading settled" data-level="2.1" id="service-worker-concept"><span class="secno">2.1. </span><span
            class="content">服务工作线程</span><a class="self-link" href="#service-worker-concept"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-for data-dfn-type="dfn" data-export id="dfn-service-worker">服务工作线程</dfn>
          是一种 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#workers"
            id="ref-for-workers">Web Worker</a>。<a data-link-type="dfn" href="#dfn-service-worker"
            id="ref-for-dfn-service-worker①④">服务工作线程</a> 在注册的 <a data-link-type="dfn" href="#dfn-service-worker-client"
            id="ref-for-dfn-service-worker-client">服务工作线程客户端</a>的 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin">源</a>
          中执行。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker①⑤">服务工作线程</a> 关联了一个 <dfn
            class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-export
            id="dfn-state">状态</dfn>，其值为 "<code>parsed</code>", "<code>installing</code>", "<code>installed</code>",
          "<code>activating</code>", "<code>activated</code>", 和 "<code>redundant</code>" 中之一。最初状态为
          "<code>parsed</code>"。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker①⑥">服务工作线程</a> 关联了一个 <dfn
            class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-export
            id="dfn-script-url">脚本URL</dfn>（一个 <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url"
            id="ref-for-concept-url">URL</a>）。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker①⑦">服务工作线程</a> 关联了一个 <dfn
            class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-export id="dfn-type">类型</dfn>，其值为
          "<code>classic</code>" 或 "<code>module</code>"。除非另有说明，默认值为 "<code>classic</code>"。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker①⑧">服务工作线程</a> 关联了一个 <dfn
            class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-export
            data-lt="registration|containing service worker registration"
            id="dfn-containing-service-worker-registration">包含服务工作线程注册</dfn>（一个 <a data-link-type="dfn"
            href="#dfn-service-worker-registration" id="ref-for-dfn-service-worker-registration">服务工作线程注册</a>），其中包含它自身。
        </p>
        <p><a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker①⑨">服务工作线程</a> 关联了一个 <dfn
            class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-export
            id="dfn-service-worker-global-object">全局对象</dfn>（一个 <code
            class="idl"><a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope">ServiceWorkerGlobalScope</a></code>
          对象或 null）。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker②⓪">服务工作线程</a> 关联了一个 <dfn
            class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-export
            id="dfn-script-resource">脚本资源</dfn>（一个 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-script"
            id="ref-for-concept-script">脚本</a>），表示其自身的脚本资源。最初值为 null。</p>
        <p><a data-link-type="dfn" href="#dfn-script-resource" id="ref-for-dfn-script-resource">脚本资源</a> 关联了一个 <dfn
            class="dfn-paneled" data-dfn-for="script resource" data-dfn-type="dfn" data-export
            id="dfn-has-ever-been-evaluated-flag">曾被评估标志</dfn>。最初未设置。</p>
        <p><a data-link-type="dfn" href="#dfn-script-resource" id="ref-for-dfn-script-resource①">脚本资源</a> 关联了一个 <dfn
            class="dfn-paneled" data-dfn-for="script resource" data-dfn-type="dfn" data-export
            id="dfn-policy-container">策略容器</dfn>（一个 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/origin.html#policy-container"
            id="ref-for-policy-container">策略容器</a>）。最初为一个新的策略容器。</p>
        <p>一个 <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker②①">service worker</a>
          具有一个关联的 <dfn class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-export
            id="dfn-script-resource-map">脚本资源映射</dfn>，它是一个 <a data-link-type="dfn"
            href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map">有序映射</a>，其中键是 <a
            data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①">URL</a>，值是 <a
            data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
            id="ref-for-concept-response">响应</a>。</p>
        <p>一个 <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker②②">service worker</a>
          具有一个关联的 <dfn class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-export
            id="dfn-set-of-used-scripts">已使用脚本集</dfn>（一个 <a data-link-type="dfn"
            href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">集合</a>），其 <a data-link-type="dfn"
            href="https://infra.spec.whatwg.org/#list-item" id="ref-for-list-item">项</a> 是一个 <a data-link-type="dfn"
            href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url②">URL</a>。它最初是一个新的 <a
            data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①">集合</a>。</p>
        <p class="note" role="note"><span>注意：</span> <a data-link-type="dfn" href="#dfn-set-of-used-scripts"
            id="ref-for-dfn-set-of-used-scripts">已使用脚本集</a> 仅用于在安装新 worker 后，从新 worker 的映射中修剪旧 worker
          映射中未使用的资源，这些资源是在更新检查过程中填充的。</p>
        <p>一个 <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker②③">service worker</a>
          具有一个关联的 <dfn class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-export
            id="dfn-skip-waiting-flag">跳过等待标志</dfn>。除非另有说明，否则该标志未设置。</p>
        <p>一个 <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker②④">service worker</a>
          具有一个关联的 <dfn class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-export
            id="dfn-classic-scripts-imported-flag">经典脚本导入标志</dfn>。它最初未设置。</p>
        <p>一个 <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker②⑤">service worker</a>
          具有一个关联的 <dfn class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-export
            id="dfn-set-of-event-types-to-handle">要处理的事件类型集</dfn>（一个 <a data-link-type="dfn"
            href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set②">集合</a>），其 <a
            data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-item" id="ref-for-list-item①">项</a> 是一个 <a
            data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-listener"
            id="ref-for-concept-event-listener">事件监听器</a> 的事件类型。它最初是一个新的 <a data-link-type="dfn"
            href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set③">集合</a>。</p>
        <p>一个 <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker②⑥">service worker</a>
          具有一个关联的 <dfn class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-export
            id="dfn-set-of-extended-events">扩展事件集</dfn>（一个 <a data-link-type="dfn"
            href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set④">集合</a>），其 <a
            data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-item" id="ref-for-list-item②">项</a> 是一个 <code
            class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent">ExtendableEvent</a></code>。它最初是一个新的
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set⑤">集合</a>。
        </p>
        <p>一个 <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker②⑦">service worker</a>
          具有一个关联的 <dfn class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-noexport
            id="service-worker-start-status">启动状态</dfn>，它可以是 null 或一个 <a data-link-type="dfn"
            href="http://tc39.github.io/ecma262/#sec-completion-record-specification-type"
            id="ref-for-sec-completion-record-specification-type">完成记录</a>。它最初为 null。</p>
        <p>一个 <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker②⑧">service worker</a>
          被称为 <dfn class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-noexport
            id="service-worker-running">运行中</dfn>，如果其 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop" id="ref-for-event-loop">事件循环</a>
          正在运行。</p>
        <section>
          <h4 class="heading settled" data-level="2.1.1" id="service-worker-lifetime"><span class="secno">2.1.1.
            </span><span class="content">生命周期</span><a class="self-link" href="#service-worker-lifetime"></a></h4>
          <p><a data-link-type="dfn" href="#dfn-service-worker"
              id="ref-for-dfn-service-worker②⑨">服务工作线程</a>的生命周期与事件的执行生命周期相关，而不是与 <a data-link-type="dfn"
              href="#dfn-service-worker-client" id="ref-for-dfn-service-worker-client①">服务工作线程客户端</a>对 <code
              class="idl"><a data-link-type="idl" href="#serviceworker"
                id="ref-for-serviceworker">ServiceWorker</a></code> 对象的引用相关。</p>
          <p>用户代理 <em>可以</em> 在以下任一情况下<a data-link-type="dfn" href="#terminate-service-worker"
              id="ref-for-terminate-service-worker">终止</a> <a data-link-type="dfn" href="#dfn-service-worker"
              id="ref-for-dfn-service-worker③⓪">服务工作线程</a>：</p>
          <ul>
            <li data-md>
              <p>没有要处理的事件。</p>
            <li data-md>
              <p>检测到异常操作：如无限循环和在处理事件时超过设定的时间限制（如果有）。</p>
          </ul>
        </section>
        <section>
          <h4 class="heading settled" data-level="2.1.2" id="service-worker-events"><span class="secno">2.1.2.
            </span><span class="content">事件</span><a class="self-link" href="#service-worker-events"></a></h4>
          <p>服务工作线程规范定义了 <dfn class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-export
              id="dfn-service-worker-events">服务工作线程事件</dfn>（每个都是一个 <a data-link-type="dfn"
              href="https://dom.spec.whatwg.org/#concept-event" id="ref-for-concept-event">事件</a>），包括（见 <a
              href="#execution-context-events">列表</a>）：</p>
          <ul>
            <li data-md>
              <p><dfn class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-export
                  id="dfn-lifecycle-events">生命周期事件</dfn>：<code class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-install-event"
                        id="ref-for-service-worker-global-scope-install-event">install</a></code> 和 <code class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-activate-event"
                        id="ref-for-service-worker-global-scope-activate-event">activate</a></code>。</p>
            <li data-md>
              <p><dfn class="dfn-paneled" data-dfn-for="service worker" data-dfn-type="dfn" data-export
                  id="dfn-functional-events">功能性事件</dfn>：<code class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-fetch-event"
                        id="ref-for-service-worker-global-scope-fetch-event">fetch</a></code> 和其他规范定义的 <a
                  data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event"
                  id="ref-for-concept-event①">事件</a>，这些规范<a href="#extensibility">扩展</a>了服务工作线程规范。（见 <a
                  href="#execution-context-events">列表</a>。）</p>
            <li data-md>
              <p><code class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-container-message-event"
                        id="ref-for-service-worker-container-message-event">message</a></code> 和 <code class="idl"><a class="idl-code" data-link-type="event" href="#eventdef-serviceworkerglobalscope-messageerror"
                        id="ref-for-eventdef-serviceworkerglobalscope-messageerror">messageerror</a></code>。</p>
          </ul>
        </section>
      </section>
      <section>
        <h3 class="heading settled" data-level="2.2" id="service-worker-timing"><span class="secno">2.2. </span><span
            class="content">服务工作线程时序</span><a class="self-link" href="#service-worker-timing"></a></h3>
        <p>服务工作线程标记了一些时间点，这些时间点随后会通过 <a class="idl-code" data-link-type="interface"
            href="https://www.w3.org/TR/navigation-timing-2/#dom-performancenavigationtiming"
            id="ref-for-dom-performancenavigationtiming">导航时序</a> API 暴露出来。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="service-worker-timing-info">服务工作线程时序信息</dfn> 是一个
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct">结构体</a>。它具有以下<a
            data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item">项</a>：
        </p>
        <!-- <section> -->
        <dl>
          <dt data-md><dfn class="dfn-paneled" data-dfn-for="service worker timing info" data-dfn-type="dfn" data-export
              id="service-worker-timing-info-start-time">开始时间</dfn>
          <dd data-md>
            <p>一个 <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/hr-time-3/#dom-domhighrestimestamp"
                        id="ref-for-dom-domhighrestimestamp">DOMHighResTimeStamp</a></code>，初始值为 0。</p>
          <dt data-md><dfn class="dfn-paneled" data-dfn-for="service worker timing info" data-dfn-type="dfn" data-export
              id="service-worker-timing-info-fetch-event-dispatch-time">Fetch 事件分派时间</dfn>
          <dd data-md>
            <p>一个 <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/hr-time-3/#dom-domhighrestimestamp"
                        id="ref-for-dom-domhighrestimestamp①">DOMHighResTimeStamp</a></code>，初始值为 0。</p>
        </dl>
        <!-- </section> -->
      </section>

      <section>
        <h3 class="heading settled" data-level="2.3" id="service-worker-registration-concept"><span class="secno">2.3.
          </span><span class="content">服务工作线程注册</span><a class="self-link"
            href="#service-worker-registration-concept"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-for data-dfn-type="dfn" data-export
            id="dfn-service-worker-registration">服务工作线程注册</dfn> 是一个元组，包含 <a data-link-type="dfn" href="#dfn-scope-url"
            id="ref-for-dfn-scope-url">范围URL</a>、<a data-link-type="dfn"
            href="https://storage.spec.whatwg.org/#storage-key" id="ref-for-storage-key">存储密钥</a> 和一组 <a
            data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker③①">服务工作线程</a>、<a
            data-link-type="dfn" href="#dfn-installing-worker" id="ref-for-dfn-installing-worker">安装中的工作线程</a>、<a
            data-link-type="dfn" href="#dfn-waiting-worker" id="ref-for-dfn-waiting-worker">等待中的工作线程</a> 和 <a
            data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker">活跃的工作线程</a>。只要 <a
            data-link-type="dfn" href="#dfn-scope-url" id="ref-for-dfn-scope-url①">范围URL</a> 不同，用户代理 <em>可以</em>
          在单个源上启用多个 <a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration①">服务工作线程注册</a>。当用户代理中已存在具有相同 <a data-link-type="dfn"
            href="#dfn-scope-url" id="ref-for-dfn-scope-url②">范围URL</a> 的 <a data-link-type="dfn"
            href="#dfn-service-worker-registration" id="ref-for-dfn-service-worker-registration③">服务工作线程注册</a> 时，会替换现有的
          <a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration④">服务工作线程注册</a>。
        </p>
        <p><a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration⑤">服务工作线程注册</a> 关联了一个 <dfn class="dfn-paneled"
            data-dfn-for="service worker registration" data-dfn-type="dfn" data-export
            id="service-worker-registration-storage-key">存储密钥</dfn>（一个 <a data-link-type="dfn"
            href="https://storage.spec.whatwg.org/#storage-key" id="ref-for-storage-key①">存储密钥</a>）。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration⑥">服务工作线程注册</a> 关联了一个 <dfn class="dfn-paneled"
            data-dfn-for="service worker registration" data-dfn-type="dfn" data-export id="dfn-scope-url">范围URL</dfn>（一个
          <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url③">URL</a>）。
        </p>
        <p><a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration⑦">服务工作线程注册</a> 关联了一个 <dfn class="dfn-paneled"
            data-dfn-for="service worker registration" data-dfn-type="dfn" data-export
            id="dfn-installing-worker">安装中的工作线程</dfn>（一个 <a data-link-type="dfn" href="#dfn-service-worker"
            id="ref-for-dfn-service-worker③②">服务工作线程</a> 或 null），其 <a data-link-type="dfn" href="#dfn-state"
            id="ref-for-dfn-state">状态</a> 为 "<code>installing</code>"。最初值为 null。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration⑧">服务工作线程注册</a> 关联了一个 <dfn class="dfn-paneled"
            data-dfn-for="service worker registration" data-dfn-type="dfn" data-export
            id="dfn-waiting-worker">等待中的工作线程</dfn>（一个 <a data-link-type="dfn" href="#dfn-service-worker"
            id="ref-for-dfn-service-worker③③">服务工作线程</a> 或 null），其 <a data-link-type="dfn" href="#dfn-state"
            id="ref-for-dfn-state①">状态</a> 为 "<code>installed</code>"。最初值为 null。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration⑨">服务工作线程注册</a> 关联了一个 <dfn class="dfn-paneled"
            data-dfn-for="service worker registration" data-dfn-type="dfn" data-export
            id="dfn-active-worker">活跃的工作线程</dfn>（一个 <a data-link-type="dfn" href="#dfn-service-worker"
            id="ref-for-dfn-service-worker③④">服务工作线程</a> 或 null），其 <a data-link-type="dfn" href="#dfn-state"
            id="ref-for-dfn-state②">状态</a> 为 "<code>activating</code>" 或 "<code>activated</code>"。最初值为 null。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration①⓪">服务工作线程注册</a> 关联了一个 <dfn class="dfn-paneled"
            data-dfn-for="service worker registration" data-dfn-type="dfn" data-export
            id="dfn-last-update-check-time">最后更新检查时间</dfn>。最初值为 null。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration①①">服务工作线程注册</a> 如果其 <a data-link-type="dfn"
            href="#dfn-last-update-check-time" id="ref-for-dfn-last-update-check-time">最后更新检查时间</a> 非空且由当前时间减去该注册的 <a
            data-link-type="dfn" href="#dfn-last-update-check-time"
            id="ref-for-dfn-last-update-check-time①">最后更新检查时间</a> 计算出的时间差以秒计大于 86400，则被称为 <dfn class="dfn-paneled"
            data-dfn-for="service worker registration" data-dfn-type="dfn" data-noexport
            id="service-worker-registration-stale">过期</dfn>。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration①②">服务工作线程注册</a> 关联了一个 <dfn class="dfn-paneled"
            data-dfn-for="service worker registration" data-dfn-type="dfn" data-export
            id="dfn-update-via-cache">通过缓存更新模式</dfn>，其值为 "<code>imports</code>"、"<code>all</code>" 或
          "<code>none</code>"。最初值为 "<code>imports</code>"。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration①③">服务工作线程注册</a> 具有一个或多个 <dfn class="dfn-paneled"
            data-dfn-for="service worker registration" data-dfn-type="dfn" data-export
            id="dfn-service-worker-registration-task-queue">任务队列</dfn>，用于备份其 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task"
            id="ref-for-concept-task">任务</a>，这些任务来自其 <a data-link-type="dfn" href="#dfn-active-worker"
            id="ref-for-dfn-active-worker①">活跃的工作线程</a>的 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop" id="ref-for-event-loop①">事件循环</a>
          对应的 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#task-queue"
            id="ref-for-task-queue">任务队列</a>。（此备份操作的目标任务源是 <a data-link-type="dfn" href="#dfn-handle-fetch-task-source"
            id="ref-for-dfn-handle-fetch-task-source">处理Fetch任务源</a> 和 <a data-link-type="dfn"
            href="#dfn-handle-functional-event-task-source"
            id="ref-for-dfn-handle-functional-event-task-source">处理功能性事件任务源</a>。）当 <a data-link-type="dfn"
            href="#dfn-active-worker" id="ref-for-dfn-active-worker③">活跃的工作线程</a> 被 <a data-link-type="dfn"
            href="#terminate-service-worker" id="ref-for-terminate-service-worker①">终止</a>时，用户代理将其 <a
            data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task"
            id="ref-for-concept-task①">任务</a>转储到 <a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration①④">服务工作线程注册</a>的 <a data-link-type="dfn"
            href="#dfn-service-worker-registration-task-queue"
            id="ref-for-dfn-service-worker-registration-task-queue">任务队列</a>，并在 <a data-link-type="dfn"
            href="#dfn-active-worker" id="ref-for-dfn-active-worker④">活跃的工作线程</a>启动时将这些任务重新排队到其 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop"
            id="ref-for-event-loop②">事件循环</a>对应的 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#task-queue"
            id="ref-for-task-queue①">任务队列</a>中。与 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop" id="ref-for-event-loop③">事件循环</a>
          所拥有的 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#task-queue"
            id="ref-for-task-queue②">任务队列</a> 不同，<a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration①⑤">服务工作线程注册</a>的 <a data-link-type="dfn"
            href="#dfn-service-worker-registration-task-queue"
            id="ref-for-dfn-service-worker-registration-task-queue①">任务队列</a>不由任何 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop"
            id="ref-for-event-loop④">事件循环</a>自行处理。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration①⑥">服务工作线程注册</a> 关联了一个 <dfn
            data-dfn-for="service worker registration" data-dfn-type="dfn" data-export
            id="service-worker-registration-navigationpreloadmanager"><code
              class="idl"><a data-link-type="idl"
            href="#navigationpreloadmanager" id="ref-for-navigationpreloadmanager">NavigationPreloadManager</a></code><a class="self-link"
              href="#service-worker-registration-navigationpreloadmanager"></a></dfn> 对象。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration①⑦">服务工作线程注册</a> 关联了一个 <dfn class="dfn-paneled"
            data-dfn-for="service worker registration" data-dfn-type="dfn" data-export
            id="service-worker-registration-navigation-preload-enabled-flag">导航预加载启用标志</dfn>。最初未设置。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration①⑧">服务工作线程注册</a> 关联了一个 <dfn class="dfn-paneled"
            data-dfn-for="service worker registration" data-dfn-type="dfn" data-export
            id="service-worker-registration-navigation-preload-header-value">导航预加载标头值</dfn>，它是一个 <a data-link-type="dfn"
            href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence">字节序列</a>。最初设置为
          `<code>true</code>`。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration①⑨">服务工作线程注册</a> 如果 <a data-link-type="dfn"
            href="#dfn-scope-to-registration-map" id="ref-for-dfn-scope-to-registration-map">注册映射</a>[该 <a
            data-link-type="dfn" href="#serviceworkerregistration-service-worker-registration"
            id="ref-for-serviceworkerregistration-service-worker-registration">服务工作线程注册</a> 的（<a data-link-type="dfn"
            href="#service-worker-registration-storage-key"
            id="ref-for-service-worker-registration-storage-key">存储密钥</a>，<a data-link-type="dfn"
            href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer">序列化</a> <a
            data-link-type="dfn" href="#dfn-scope-url" id="ref-for-dfn-scope-url③">范围URL</a>）] 不是该 <a
            data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration②⓪">服务工作线程注册</a>，则称为 <dfn class="dfn-paneled"
            data-dfn-for="service worker registration" data-dfn-type="dfn" data-export
            id="dfn-service-worker-registration-unregistered">未注册</dfn>。</p>
        <section>
          <h4 class="heading settled" data-level="2.3.1" id="service-worker-registration-lifetime"><span
              class="secno">2.3.1. </span><span class="content">生命周期</span><a class="self-link"
              href="#service-worker-registration-lifetime"></a></h4>
          <p>用户代理 <em>必须</em> 持久地保留 <a data-link-type="dfn" href="#register" id="ref-for-register">已注册</a> 的 <a
              data-link-type="dfn" href="#dfn-service-worker-registration"
              id="ref-for-dfn-service-worker-registration②①">服务工作线程注册</a> 列表，除非它们被明确 <a data-link-type="dfn"
              href="#dfn-service-worker-registration-unregistered"
              id="ref-for-dfn-service-worker-registration-unregistered">取消注册</a>。用户代理具有一个 <a data-link-type="dfn"
              href="#dfn-scope-to-registration-map" id="ref-for-dfn-scope-to-registration-map①">注册映射</a>，用于存储元组的条目 <a
              data-link-type="dfn" href="#dfn-service-worker-registration"
              id="ref-for-dfn-service-worker-registration②②">服务工作线程注册</a>（<a data-link-type="dfn"
              href="#service-worker-registration-storage-key"
              id="ref-for-service-worker-registration-storage-key①">存储密钥</a>，<a data-link-type="dfn"
              href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer①">序列化</a> <a
              data-link-type="dfn" href="#dfn-scope-url" id="ref-for-dfn-scope-url④">范围URL</a>）和对应的 <a
              data-link-type="dfn" href="#dfn-service-worker-registration"
              id="ref-for-dfn-service-worker-registration②③">服务工作线程注册</a>。<a data-link-type="dfn"
              href="#dfn-service-worker-registration" id="ref-for-dfn-service-worker-registration②④">服务工作线程注册</a>
            的生命周期超出了表示它们的 <code
              class="idl"><a data-link-type="idl"
            href="#serviceworkerregistration" id="ref-for-serviceworkerregistration">ServiceWorkerRegistration</a></code> 对象的生命周期，即便在其对应的
            <a data-link-type="dfn" href="#dfn-service-worker-client"
              id="ref-for-dfn-service-worker-client②">服务工作线程客户端</a> 的生命周期内。
          </p>
        </section>
      </section>

      <section>
        <h3 class="heading settled" data-level="2.4" id="service-worker-client-concept"><span class="secno">2.4.
          </span><span class="content">服务工作线程客户端</span><a class="self-link" href="#service-worker-client-concept"></a>
        </h3>
        <p><dfn class="dfn-paneled" data-dfn-for data-dfn-type="dfn" data-export
            id="dfn-service-worker-client">服务工作线程客户端</dfn> 是一个 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#environment" id="ref-for-environment">环境</a>。
        </p>
        <p><a data-link-type="dfn" href="#dfn-service-worker-client"
            id="ref-for-dfn-service-worker-client③">服务工作线程客户端</a> 关联了一个 <dfn class="dfn-paneled"
            data-dfn-for="service worker client" data-dfn-type="dfn" data-export
            id="service-worker-client-discarded-flag">丢弃标志</dfn>。最初未设置。</p>
        <p>每个 <a data-link-type="dfn" href="#dfn-service-worker-client"
            id="ref-for-dfn-service-worker-client④">服务工作线程客户端</a> 都具有以下 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-discarding-steps"
            id="ref-for-environment-discarding-steps">环境丢弃步骤</a>：</p>
        <ol>
          <li data-md>
            <p>设置 <var>client</var> 的 <a data-link-type="dfn" href="#service-worker-client-discarded-flag"
                id="ref-for-service-worker-client-discarded-flag">丢弃标志</a>。</p>
        </ol>
        <p class="note" role="note"><span>注意：</span> 实现可以丢弃其 <a data-link-type="dfn"
            href="#service-worker-client-discarded-flag" id="ref-for-service-worker-client-discarded-flag①">丢弃标志</a>
          已设置的客户端。</p>
        <p><a data-link-type="dfn" href="#dfn-service-worker-client"
            id="ref-for-dfn-service-worker-client⑤">服务工作线程客户端</a> 定义了一个算法，称为 <dfn class="dfn-paneled"
            data-dfn-for="service worker client" data-dfn-type="dfn" data-export
            id="service-worker-client-origin">来源</dfn>，如果 <a data-link-type="dfn" href="#dfn-service-worker-client"
            id="ref-for-dfn-service-worker-client⑥">服务工作线程客户端</a> 是 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
            id="ref-for-environment-settings-object">环境设置对象</a>，则返回 <a data-link-type="dfn"
            href="#dfn-service-worker-client" id="ref-for-dfn-service-worker-client⑦">服务工作线程客户端</a> 的 <a
            data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
            id="ref-for-concept-settings-object-origin">来源</a>，否则返回 <a data-link-type="dfn"
            href="#dfn-service-worker-client" id="ref-for-dfn-service-worker-client⑧">服务工作线程客户端</a> 的 <a
            data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url"
            id="ref-for-concept-environment-creation-url">创建URL</a> 的 <a data-link-type="dfn"
            href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin">来源</a>。</p>
        <p><dfn class="dfn-paneled" data-dfn-for="service worker client" data-dfn-type="dfn" data-export
            id="dfn-window-client">窗口客户端</dfn> 是一个 <a data-link-type="dfn" href="#dfn-service-worker-client"
            id="ref-for-dfn-service-worker-client⑨">服务工作线程客户端</a>，其 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
            id="ref-for-concept-settings-object-global">全局对象</a> 是一个 <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window"
            id="ref-for-window">Window</a></code> 对象。</p>
        <p><dfn class="dfn-paneled" data-dfn-for="service worker client" data-dfn-type="dfn" data-export
            id="dfn-dedicatedworker-client">专用工作线程客户端</dfn> 是一个 <a data-link-type="dfn"
            href="#dfn-service-worker-client" id="ref-for-dfn-service-worker-client①⓪">服务工作线程客户端</a>，其 <a
            data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
            id="ref-for-concept-settings-object-global①">全局对象</a> 是一个 <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope"
            id="ref-for-dedicatedworkerglobalscope">DedicatedWorkerGlobalScope</a></code> 对象。</p>
        <p><dfn class="dfn-paneled" data-dfn-for="service worker client" data-dfn-type="dfn" data-export
            id="dfn-sharedworker-client">共享工作线程客户端</dfn> 是一个 <a data-link-type="dfn" href="#dfn-service-worker-client"
            id="ref-for-dfn-service-worker-client①①">服务工作线程客户端</a>，其 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
            id="ref-for-concept-settings-object-global②">全局对象</a> 是一个 <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope"
            id="ref-for-sharedworkerglobalscope">SharedWorkerGlobalScope</a></code> 对象。</p>
        <p><dfn class="dfn-paneled" data-dfn-for="service worker client" data-dfn-type="dfn" data-export
            id="dfn-worker-client">工作线程客户端</dfn> 可以是 <a data-link-type="dfn" href="#dfn-dedicatedworker-client"
            id="ref-for-dfn-dedicatedworker-client">专用工作线程客户端</a> 或 <a data-link-type="dfn"
            href="#dfn-sharedworker-client" id="ref-for-dfn-sharedworker-client">共享工作线程客户端</a>。</p>
      </section>

      <section>
        <h3 class="heading settled" data-level="2.5" id="control-and-use"><span class="secno">2.5. </span><span
            class="content">控制与使用</span><a class="self-link" href="#control-and-use"></a></h3>
        <p><a data-link-type="dfn" href="#dfn-service-worker-client"
            id="ref-for-dfn-service-worker-client①②">服务工作线程客户端</a>
          有一个 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
            id="ref-for-concept-environment-active-service-worker">活动服务工作线程</a>，负责它自己的加载及其子资源的加载。当
          <a data-link-type="dfn" href="#dfn-service-worker-client"
            id="ref-for-dfn-service-worker-client①③">服务工作线程客户端</a>
          有一个非空的 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
            id="ref-for-concept-environment-active-service-worker①">活动服务工作线程</a> 时，就说该客户端被该服务工作线程
          <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="controlling|controls|controlled" data-noexport
            id="dfn-control">控制</dfn>。当一个 <a data-link-type="dfn" href="#dfn-service-worker-client"
            id="ref-for-dfn-service-worker-client①④">服务工作线程客户端</a> 被一个 <a data-link-type="dfn"
            href="#dfn-service-worker" id="ref-for-dfn-service-worker③⑤">服务工作线程</a>
          <a data-link-type="dfn" href="#dfn-control" id="ref-for-dfn-control">控制</a> 时，就说这个
          <a data-link-type="dfn" href="#dfn-service-worker-client"
            id="ref-for-dfn-service-worker-client①⑤">服务工作线程客户端</a>
          <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="using|uses|used" data-noexport id="dfn-use">使用</dfn>
          该服务工作线程的 <a data-link-type="dfn" href="#dfn-containing-service-worker-registration"
            id="ref-for-dfn-containing-service-worker-registration">包含服务工作线程注册</a>。一个
          <a data-link-type="dfn" href="#dfn-service-worker-client"
            id="ref-for-dfn-service-worker-client①⑥">服务工作线程客户端</a>
          的 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
            id="ref-for-concept-environment-active-service-worker③">活动服务工作线程</a> 如下文所述确定。
        </p>
        <p><em>本节的其余部分为非规范性内容。</em></p>
        <p class="issue" id="issue-f6a7ea80"><a class="self-link" href="#issue-f6a7ea80"></a> 本节的行为尚未完全规范化，将在
          <a href="https://html.spec.whatwg.org">HTML 标准</a> 中规范。工作由 <a
            href="https://github.com/w3c/ServiceWorker/issues/765">问题</a>
          和 <a href="https://github.com/whatwg/html/pull/2809">拉取请求</a> 跟踪。
        </p>
        <section>
          <h4 class="heading settled" data-level="2.5.1" id="control-and-use-window-client"><span class="secno">2.5.1.
            </span><span class="content">窗口客户端案例</span><a class="self-link" href="#control-and-use-window-client"></a>
          </h4>
          <p><a data-link-type="dfn" href="#dfn-window-client" id="ref-for-dfn-window-client">窗口客户端</a> 在创建
            <a href="https://html.spec.whatwg.org/#set-up-a-window-environment-settings-object">窗口环境设置对象</a> 时，
            或在 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context"
              id="ref-for-browsing-context">浏览上下文</a> 创建和 <a
              href="https://html.spec.whatwg.org/#creating-a-new-browsing-context">导航</a>
            时被创建。
          </p>
          <p>当 <a data-link-type="dfn" href="#dfn-window-client" id="ref-for-dfn-window-client①">窗口客户端</a> 在
            <a href="https://html.spec.whatwg.org/#set-up-a-window-environment-settings-object">设置窗口环境设置对象</a> 过程中
            创建的 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context"
              id="ref-for-browsing-context①">浏览上下文</a> 创建时：
          </p>
          <p>如果 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context"
              id="ref-for-browsing-context②">浏览上下文</a> 的初始 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
              id="ref-for-active-document">活动文档</a> 的 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin"
              id="ref-for-concept-origin①">来源</a> 是 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque"
              id="ref-for-concept-origin-opaque">不透明来源</a>，则 <a data-link-type="dfn" href="#dfn-window-client"
              id="ref-for-dfn-window-client②">窗口客户端</a> 的 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
              id="ref-for-concept-environment-active-service-worker④">活动服务工作线程</a> 设置为 null。否则，它设置为创建者
            <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document"
              id="ref-for-concept-document">文档</a> 的
            <a data-link-type="dfn" href="#dfn-service-worker-client"
              id="ref-for-dfn-service-worker-client①⑦">服务工作线程客户端</a> 的
            <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
              id="ref-for-concept-environment-active-service-worker⑤">活动服务工作线程</a>。
          </p>
          <p>当 <a data-link-type="dfn" href="#dfn-window-client" id="ref-for-dfn-window-client③">窗口客户端</a> 在
            <a href="https://html.spec.whatwg.org/#set-up-a-window-environment-settings-object">设置窗口环境设置对象</a> 过程中，
            在 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context"
              id="ref-for-browsing-context③">浏览上下文</a> 的 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate" id="ref-for-navigate">导航</a>
            时被创建：
          </p>
          <p>如果 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
              id="ref-for-concept-fetch">获取</a> 通过 <a data-link-type="dfn"
              href="https://fetch.spec.whatwg.org/#concept-http-fetch" id="ref-for-concept-http-fetch">HTTP 获取</a> 路由，则
            <a data-link-type="dfn" href="#dfn-window-client" id="ref-for-dfn-window-client④">窗口客户端</a> 的 <a
              data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
              id="ref-for-concept-environment-active-service-worker⑥">活动服务工作线程</a> 设置为
            <a data-link-type="dfn" href="#match-service-worker-registration"
              id="ref-for-match-service-worker-registration">服务工作线程注册匹配</a>
            的结果。否则，如果创建的 <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document"
              id="ref-for-concept-document①">文档</a> 的 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin"
              id="ref-for-concept-origin②">来源</a> 是 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque"
              id="ref-for-concept-origin-opaque①">不透明来源</a> 或与其创建者的 <a data-link-type="dfn"
              href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document②">文档</a> 的 <a
              data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin"
              id="ref-for-concept-origin③">来源</a> 不相同，则 <a data-link-type="dfn" href="#dfn-window-client"
              id="ref-for-dfn-window-client⑤">窗口客户端</a> 的 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
              id="ref-for-concept-environment-active-service-worker⑦">活动服务工作线程</a> 设置为 null。否则，它设置为创建者
            <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document"
              id="ref-for-concept-document③">文档</a> 的
            <a data-link-type="dfn" href="#dfn-service-worker-client"
              id="ref-for-dfn-service-worker-client①⑧">服务工作线程客户端</a> 的
            <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
              id="ref-for-concept-environment-active-service-worker⑧">活动服务工作线程</a>。
          </p>
          <p class="note" role="note"><span>注意：</span> 对于启用了替换的初始 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate"
              id="ref-for-navigate②">导航</a>，
            在创建 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context"
              id="ref-for-browsing-context④">浏览上下文</a> 时创建的初始 <a data-link-type="dfn" href="#dfn-window-client"
              id="ref-for-dfn-window-client⑥">窗口客户端</a> 将被重用，但 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
              id="ref-for-concept-environment-active-service-worker⑨">活动服务工作线程</a> 将按照上述相同行为确定。</p>
          <p class="note" role="note"><span>注意：</span> 没有沙箱指令 <code>allow-same-origin</code> 和
            <code>allow-scripts</code> 的
            <a data-link-type="element-attr"
              href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-sandbox"
              id="ref-for-attr-iframe-sandbox">沙盒化</a>
            <code><a data-link-type="element" 
           href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element">iframe</a></code>
            导致其 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
              id="ref-for-concept-environment-active-service-worker①⓪">活动服务工作线程</a> 值为 null，因为它们的 <a
              data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin"
              id="ref-for-concept-origin④">来源</a> 是
            <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque"
              id="ref-for-concept-origin-opaque②">不透明来源</a>。
          </p>
        </section>
        <section>
          <h4 class="heading settled" data-level="2.5.2" id="control-and-use-worker-client"><span class="secno">2.5.2.
            </span><span class="content">工作线程客户端案例</span><a class="self-link" href="#control-and-use-worker-client"></a>
          </h4>
          <p>当用户代理 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#run-a-worker"
              id="ref-for-run-a-worker">运行工作线程</a> 时，会创建 <a data-link-type="dfn" href="#dfn-worker-client"
              id="ref-for-dfn-worker-client">工作线程客户端</a>。</p>
          <p>当创建 <a data-link-type="dfn" href="#dfn-worker-client" id="ref-for-dfn-worker-client①">工作线程客户端</a> 时：</p>
          <p>如果 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
              id="ref-for-concept-fetch①">获取</a> 通过 <a data-link-type="dfn"
              href="https://fetch.spec.whatwg.org/#concept-http-fetch" id="ref-for-concept-http-fetch①">HTTP 获取</a> 路由，则
            <a data-link-type="dfn" href="#dfn-worker-client" id="ref-for-dfn-worker-client②">工作线程客户端</a> 的 <a
              data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
              id="ref-for-concept-environment-active-service-worker①①">活动服务工作线程</a> 设置为
            <a data-link-type="dfn" href="#match-service-worker-registration"
              id="ref-for-match-service-worker-registration①">服务工作线程注册匹配</a>
            的结果。否则，如果 <a data-link-type="dfn" href="#dfn-worker-client" id="ref-for-dfn-worker-client③">工作线程客户端</a>
            的 <a data-link-type="dfn" href="#service-worker-client-origin"
              id="ref-for-service-worker-client-origin">来源</a>
            是 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque"
              id="ref-for-concept-origin-opaque③">不透明来源</a>，或 <a data-link-type="dfn"
              href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request">请求</a> 的 <a
              data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url"
              id="ref-for-concept-request-url">URL</a> 是 <a data-link-type="dfn"
              href="https://w3c.github.io/FileAPI/#blob-url" id="ref-for-blob-url">blob URL</a>，且 <a
              data-link-type="dfn" href="#dfn-worker-client" id="ref-for-dfn-worker-client④">工作线程客户端</a>
            的 <a data-link-type="dfn" href="#service-worker-client-origin"
              id="ref-for-service-worker-client-origin①">来源</a> 与其
            <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin"
              id="ref-for-same-origin①">相同</a>，并且
            <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin"
              id="ref-for-concept-origin⑤">来源</a>
            是最后一个 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-item" id="ref-for-list-item③">项</a>
            中
            <a data-link-type="dfn" href="#dfn-worker-client" id="ref-for-dfn-worker-client⑤">工作线程客户端</a> 的 <a
              data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
              id="ref-for-global-object">全局对象</a> 的
            <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/workers.html#concept-WorkerGlobalScope-owner-set"
              id="ref-for-concept-WorkerGlobalScope-owner-set">所有者集</a> 不相同，则 <a data-link-type="dfn"
              href="#dfn-worker-client" id="ref-for-dfn-worker-client⑥">工作线程客户端</a> 的 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
              id="ref-for-concept-environment-active-service-worker①②">活动服务工作线程</a> 设置为 null。否则，它设置为最后一个 <a
              data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
              id="ref-for-concept-environment-active-service-worker①③">活动服务工作线程</a> 的 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
              id="ref-for-environment-settings-object①">环境设置对象</a>。
          </p>
        </section>
        <p class="note" role="note"><span>注意：</span>
          <a data-link-type="dfn" href="#dfn-window-client" id="ref-for-dfn-window-client⑦">窗口客户端</a> 和 <a
            data-link-type="dfn" href="#dfn-worker-client" id="ref-for-dfn-worker-client⑧">工作线程客户端</a> 使用 <a
            href="https://tools.ietf.org/html/rfc2397#section-2">data: URL</a>
          会导致其 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
            id="ref-for-concept-environment-active-service-worker①④">活动服务工作线程</a> 值为 null，因为它们的 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin⑥">来源</a>
          是
          <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque"
            id="ref-for-concept-origin-opaque④">不透明来源</a>。 <a data-link-type="dfn" href="#dfn-window-client"
            id="ref-for-dfn-window-client⑧">窗口客户端</a> 和 <a data-link-type="dfn" href="#dfn-worker-client"
            id="ref-for-dfn-worker-client⑨">工作线程客户端</a>
          使用 <a data-link-type="dfn" href="https://w3c.github.io/FileAPI/#blob-url" id="ref-for-blob-url①">blob URL</a>
          可以继承其创建者
          <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document"
            id="ref-for-concept-document④">文档</a> 或所有者的
          <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
            id="ref-for-concept-environment-active-service-worker①⑤">活动服务工作线程</a>，但如果 <a data-link-type="dfn"
            href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①">请求</a> 的 <a
            data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin"
            id="ref-for-concept-request-origin">来源</a> 与其创建者 <a data-link-type="dfn"
            href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document⑤">文档</a> 或所有者的 <a
            data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin"
            id="ref-for-same-origin②">来源</a> 不同，则
          <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
            id="ref-for-concept-environment-active-service-worker①⑥">活动服务工作线程</a> 设置为 null。
        </p>
      </section>

      <section>
        <h3 class="heading settled" data-level="2.6" id="task-sources"><span class="secno">2.6. </span><span
            class="content">任务来源</span><a class="self-link" href="#task-sources"></a></h3>
        <p>以下附加的 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#task-source"
            id="ref-for-task-source">任务来源</a> 被
          <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker③⑦">服务工作线程</a> 使用。
        </p>
        <dl>
          <dt data-md> <dfn class="dfn-paneled" data-dfn-type="dfn" data-export
              id="dfn-handle-fetch-task-source">处理获取任务来源</dfn>
          <dd data-md>
            <p>这个 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#task-source"
                id="ref-for-task-source①">任务来源</a> 用于向 <a data-link-type="dfn" href="#dfn-service-worker"
                id="ref-for-dfn-service-worker③⑧">服务工作线程</a> <code
                class="idl"><a class="idl-code" data-link-type="event"
                    href="#service-worker-global-scope-fetch-event" id="ref-for-service-worker-global-scope-fetch-event①">fetch</a></code>
              事件进行调度。</p>
          <dt data-md> <dfn class="dfn-paneled" data-dfn-type="dfn" data-export
              id="dfn-handle-functional-event-task-source">处理功能性事件任务来源</dfn>
          <dd data-md>
            <p>这个 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#task-source"
                id="ref-for-task-source②">任务来源</a> 用于那些调度其他<a data-link-type="dfn" href="#dfn-functional-events"
                id="ref-for-dfn-functional-events">功能性事件</a>的特性，例如，向
              <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker③⑨">服务工作线程</a>
              调度 <code
                class="idl"><a class="idl-code" data-link-type="event"
                    href="https://w3c.github.io/push-api/#h-the-push-event" id="ref-for-h-the-push-event">push</a></code> 事件。
            </p>
            <p class="note" role="note"><span>注意：</span> 用户代理可能为每种功能性事件类型使用一个单独的任务来源，以避免某些功能性事件的队头阻塞现象。</p>
        </dl>
      </section>

      <section>
        <h3 class="heading settled" data-level="2.7" id="user-agent-shutdown"><span class="secno">2.7. </span><span
            class="content">用户代理关闭</span><a class="self-link" href="#user-agent-shutdown"></a></h3>
        <p>用户代理<em>必须</em>在重启后保持其存储的<a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration②⑤">服务工作者注册</a>的状态，并遵循以下规则：</p>
        <ul>
          <li data-md>
            <p>正在安装的<a data-link-type="dfn" href="#dfn-installing-worker"
                id="ref-for-dfn-installing-worker①">工作者</a>不会保留，而是被丢弃。如果该<a data-link-type="dfn"
                href="#dfn-installing-worker" id="ref-for-dfn-installing-worker②">安装中的工作者</a>是唯一的<a data-link-type="dfn"
                href="#dfn-service-worker" id="ref-for-dfn-service-worker④⓪">服务工作者</a>，则该<a data-link-type="dfn"
                href="#dfn-service-worker-registration" id="ref-for-dfn-service-worker-registration②⑥">服务工作者注册</a>将被丢弃。
            </p>
          <li data-md>
            <p>等待中的<a data-link-type="dfn" href="#dfn-waiting-worker" id="ref-for-dfn-waiting-worker①">工作者</a>会提升为活跃的<a
                data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker⑥">工作者</a>。</p>
        </ul>
        <p>为实现这一点，用户代理<em>必须</em>在终止时调用<a data-link-type="dfn" href="#handle-user-agent-shutdown"
            id="ref-for-handle-user-agent-shutdown">处理用户代理关闭</a>。</p>
      </section>
    </section>
    <section>
      <h2 class="heading settled" data-level="3" id="document-context"><span class="secno">3. </span><span
          class="content">客户端上下文</span><a class="self-link" href="#document-context"></a></h2>
      <div class="example" id="example-c7be5225">
        <a class="self-link" href="#example-c7be5225"></a> 使用 service worker 引导：
        <pre class="highlight"><c- c1>// scope defaults to the path the script sits in</c->
<c- c1>// "/" in this example</c->
navigator<c- p>.</c->serviceWorker<c- p>.</c->register<c- p>(</c-><c- u>"/serviceworker.js"</c-><c- p>).</c->then<c- p>(</c->registration <c- p>=></c-> <c- p>{</c->
  console<c- p>.</c->log<c- p>(</c-><c- u>"success!"</c-><c- p>);</c->
  <c- k>if</c-> <c- p>(</c->registration<c- p>.</c->installing<c- p>)</c-> <c- p>{</c->
    registration<c- p>.</c->installing<c- p>.</c->postMessage<c- p>(</c-><c- u>"Howdy from your installing page."</c-><c- p>);</c->
  <c- p>}</c->
<c- p>},</c-> err <c- p>=></c-> <c- p>{</c->
  console<c- p>.</c->error<c- p>(</c-><c- u>"Installing the worker failed!"</c-><c- p>,</c-> err<c- p>);</c->
<c- p>});</c->
</pre>
      </div>
      <section>
        <h3 class="heading settled" data-level="3.1" id="serviceworker-interface"><span class="secno">3.1. </span><span
            class="content"><code
              class="idl"><a data-link-type="idl" href="#serviceworker" id="ref-for-serviceworker①">ServiceWorker</a></code></span><a
            class="self-link" href="#serviceworker-interface"></a></h3>
        <div class="mdn-anno wrapped after">
          <button class="mdn-anno-btn"><b class="all-engines-flag"
              title="This feature is in all current engines.">✔</b><span>MDN</span></button>
          <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorker"
                title="Service Worker API 的 ServiceWorker 接口提供了对 service worker 的引用。多个浏览上下文（例如页面、workers 等）都可以通过唯一的 ServiceWorker 对象与同一个 service worker 相关联。">ServiceWorker</a>
            </p>
            <p class="all-engines-text">在所有当前引擎中。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                class="chrome yes"><span>Chrome</span><span>40+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                class="ie no"><span>IE</span><span>不支持</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
            </div>
          </div>
        </div>
        <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="serviceworker"><code><c- g>ServiceWorker</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget"><c- n>EventTarget</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString"><c- b>USVString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="USVString" href="#dom-serviceworker-scripturl" id="ref-for-dom-serviceworker-scripturl"><c- g>scriptURL</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-serviceworkerstate" id="ref-for-enumdef-serviceworkerstate"><c- n>ServiceWorkerState</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorkerState" href="#dom-serviceworker-state" id="ref-for-dom-serviceworker-state"><c- g>state</c-></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-serviceworker-postmessage" id="ref-for-dom-serviceworker-postmessage"><c- g>postMessage</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="ServiceWorker/postMessage(message, transfer)" data-dfn-type="argument" data-export id="dom-serviceworker-postmessage-message-transfer-message"><code><c- g>message</c-></code><a class="self-link" href="#dom-serviceworker-postmessage-message-transfer-message"></a></dfn>, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence" id="ref-for-idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object"><c- b>object</c-></a>> <dfn class="idl-code" data-dfn-for="ServiceWorker/postMessage(message, transfer)" data-dfn-type="argument" data-export id="dom-serviceworker-postmessage-message-transfer-transfer"><code><c- g>transfer</c-></code><a class="self-link" href="#dom-serviceworker-postmessage-message-transfer-transfer"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined①"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-serviceworker-postmessage-message-options" id="ref-for-dom-serviceworker-postmessage-message-options"><c- g>postMessage</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any①"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="ServiceWorker/postMessage(message, options), ServiceWorker/postMessage(message)" data-dfn-type="argument" data-export id="dom-serviceworker-postmessage-message-options-message"><code><c- g>message</c-></code><a class="self-link" href="#dom-serviceworker-postmessage-message-options-message"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/web-messaging.html#structuredserializeoptions" id="ref-for-structuredserializeoptions"><c- n>StructuredSerializeOptions</c-></a> <dfn class="idl-code" data-dfn-for="ServiceWorker/postMessage(message, options), ServiceWorker/postMessage(message)" data-dfn-type="argument" data-export id="dom-serviceworker-postmessage-message-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-serviceworker-postmessage-message-options-options"></a></dfn> = {});

  // event
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworker-onstatechange" id="ref-for-dom-serviceworker-onstatechange"><c- g>onstatechange</c-></a>;
};
<a data-link-type="idl-name" href="#serviceworker" id="ref-for-serviceworker②"><c- n>ServiceWorker</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/workers.html#abstractworker" id="ref-for-abstractworker"><c- n>AbstractWorker</c-></a>;

<c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-serviceworkerstate"><code><c- g>ServiceWorkerState</c-></code></dfn> {
  <dfn class="idl-code" data-dfn-for="ServiceWorkerState" data-dfn-type="enum-value" data-export id="dom-serviceworkerstate-parsed"><code><c- s>"parsed"</c-></code><a class="self-link" href="#dom-serviceworkerstate-parsed"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="ServiceWorkerState" data-dfn-type="enum-value" data-export id="dom-serviceworkerstate-installing"><code><c- s>"installing"</c-></code><a class="self-link" href="#dom-serviceworkerstate-installing"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="ServiceWorkerState" data-dfn-type="enum-value" data-export id="dom-serviceworkerstate-installed"><code><c- s>"installed"</c-></code><a class="self-link" href="#dom-serviceworkerstate-installed"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="ServiceWorkerState" data-dfn-type="enum-value" data-export id="dom-serviceworkerstate-activating"><code><c- s>"activating"</c-></code><a class="self-link" href="#dom-serviceworkerstate-activating"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="ServiceWorkerState" data-dfn-type="enum-value" data-export id="dom-serviceworkerstate-activated"><code><c- s>"activated"</c-></code><a class="self-link" href="#dom-serviceworkerstate-activated"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="ServiceWorkerState" data-dfn-type="enum-value" data-export id="dom-serviceworkerstate-redundant"><code><c- s>"redundant"</c-></code><a class="self-link" href="#dom-serviceworkerstate-redundant"></a></dfn>
};
</pre>
        <p><code
            class="idl"><a data-link-type="idl" href="#serviceworker" id="ref-for-serviceworker③">ServiceWorker</a></code>
          对象表示一个 <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker④①">service
            worker</a>。每个 <code
            class="idl"><a data-link-type="idl" href="#serviceworker" id="ref-for-serviceworker④">ServiceWorker</a></code>
          对象都与一个 <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker④②">service worker</a>
          相关联。在不同文档和 workers 中实现 <code
            class="idl"><a data-link-type="idl" href="#serviceworker" id="ref-for-serviceworker⑤">ServiceWorker</a></code>
          接口的多个单独对象可以同时与同一个 <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker④③">service
            worker</a> 相关联。</p>
        <p><code
            class="idl"><a data-link-type="idl" href="#serviceworker" id="ref-for-serviceworker⑥">ServiceWorker</a></code>
          对象具有一个关联的 <code
            class="idl"><a data-link-type="idl" href="#enumdef-serviceworkerstate" id="ref-for-enumdef-serviceworkerstate①">ServiceWorkerState</a></code>
          对象，该对象本身与 <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker④④">service
            worker</a> 的 <a data-link-type="dfn">state</a> 相关联。</p>
        <section>
          <h4 class="heading settled" data-level="3.1.1" id="service-worker-creation"><span class="secno">3.1.1.
            </span><span class="content">获取 <code
                class="idl"><a data-link-type="idl" href="#serviceworker" id="ref-for-serviceworker⑦">ServiceWorker</a></code>
              实例</span><a class="self-link" href="#service-worker-creation"></a></h4>
          <p><a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
              id="ref-for-environment-settings-object②">环境设置对象</a> 具有一个 <dfn class="dfn-paneled"
              data-dfn-for="environment settings object" data-dfn-type="dfn" data-noexport
              id="environment-settings-object-service-worker-object-map">service worker 对象映射</dfn>，即一个 <a
              data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①">映射</a>，
            其中 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-getting-the-keys"
              id="ref-for-map-getting-the-keys">键</a> 是 <a data-link-type="dfn" href="#dfn-service-worker"
              id="ref-for-dfn-service-worker④⑤">service workers</a>，<a data-link-type="dfn"
              href="https://infra.spec.whatwg.org/#map-getting-the-values" id="ref-for-map-getting-the-values">值</a> 是
            <code
              class="idl"><a data-link-type="idl" href="#serviceworker" id="ref-for-serviceworker⑧">ServiceWorker</a></code>
            对象。
          </p>
          <!-- <section class="algorithm" data-algorithm="service-worker-creation-algorithm"> -->
          <p>要获取表示 <var>serviceWorker</var>（一个 <a data-link-type="dfn" href="#dfn-service-worker"
              id="ref-for-dfn-service-worker④⑥">service worker</a>）在 <var>environment</var>（一个 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
              id="ref-for-environment-settings-object③">环境设置对象</a>）中的 <dfn class="dfn-paneled" data-dfn-type="dfn"
              data-lt="获取 service worker 对象" data-noexport id="get-the-service-worker-object">service worker
              对象</dfn>，请执行以下步骤：</p>
          <ol>
            <li data-md>
              <p>令 <var>objectMap</var> 为 <var>environment</var> 的 <a data-link-type="dfn"
                  href="#environment-settings-object-service-worker-object-map"
                  id="ref-for-environment-settings-object-service-worker-object-map">service worker 对象映射</a>。</p>
            <li data-md>
              <p>如果 <var>objectMap</var>[<var>serviceWorker</var>] 不 <a data-link-type="dfn"
                  href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists">存在</a>，则：</p>
              <ol>
                <li data-md>
                  <p>令 <var>serviceWorkerObj</var> 为 <var>environment</var> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object&apos;s-realm"
                      id="ref-for-environment-settings-object&apos;s-realm">Realm</a> 中的一个新的 <code
                      class="idl"><a data-link-type="idl" href="#serviceworker" id="ref-for-serviceworker⑨">ServiceWorker</a></code>
                    对象，并将其与 <var>serviceWorker</var> 关联。</p>
                <li data-md>
                  <p>将 <var>serviceWorkerObj</var> 的 <code
                      class="idl"><a data-link-type="idl" href="#dom-serviceworker-state" id="ref-for-dom-serviceworker-state①">state</a></code>
                    设置为 <var>serviceWorker</var> 的 <a data-link-type="dfn" href="#dfn-state"
                      id="ref-for-dfn-state③">state</a>。</p>
                <li data-md>
                  <p>将 <var>objectMap</var>[<var>serviceWorker</var>] 设置为 <var>serviceWorkerObj</var>。</p>
              </ol>
            <li data-md>
              <p>返回 <var>objectMap</var>[<var>serviceWorker</var>]。</p>
          </ol>
          <!-- </section> -->
        </section>

        <section>
          <h4 class="heading settled" data-level="3.1.2" id="service-worker-url"><span class="secno">3.1.2. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-serviceworker-scripturl" id="ref-for-dom-serviceworker-scripturl①">scriptURL</a></code></span><a
              class="self-link" href="#service-worker-url"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorker/scriptURL"
                  title="返回作为 ServiceWorkerRegistration 一部分定义的 ServiceWorker 序列化脚本 URL。必须与注册 ServiceWorker 的文档具有相同的源。">ServiceWorker/scriptURL</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>不支持</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorker" data-dfn-type="attribute" data-export
              id="dom-serviceworker-scripturl"><code>scriptURL</code></dfn> 的 getter 步骤是返回 <a data-link-type="dfn"
              href="#dfn-service-worker" id="ref-for-dfn-service-worker④⑦">service worker</a> 的 <a data-link-type="dfn"
              href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer②">序列化</a> <a
              data-link-type="dfn" href="#dfn-script-url" id="ref-for-dfn-script-url">脚本 URL</a>。</p>
          <div class="example" id="example-afd15a33">
            <a class="self-link" href="#example-afd15a33"></a> 例如，考虑通过导航到 <code>https://example.com/app.html</code>
            创建的文档，它通过以下已执行的注册调用 <a data-link-type="dfn" href="#match-service-worker-registration"
              id="ref-for-match-service-worker-registration②">匹配</a>：
            <pre class="highlight"><c- c1>// 页面上的脚本 https://example.com/app.html</c->
navigator<c- p>.</c->serviceWorker<c- p>.</c->register<c- p>(</c-><c- u>"/service_worker.js"</c-><c- p>);</c->
</pre>
            <p><code>navigator.serviceWorker.controller.scriptURL</code> 的值将为
              "<code>https://example.com/service_worker.js</code>"。</p>
          </div>
        </section>

        <section>
          <h4 class="heading settled" data-level="3.1.3" id="service-worker-state"><span class="secno">3.1.3.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-serviceworker-state" id="ref-for-dom-serviceworker-state②">state</a></code></span><a
              class="self-link" href="#service-worker-state"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorker/state"
                  title="ServiceWorker 接口的 state 只读属性返回表示 service worker 当前状态的字符串。可以是以下值之一：installing, installed, activating, activated, 或 redundant。">ServiceWorker/state</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>不支持</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorker" data-dfn-type="attribute" data-export
              id="dom-serviceworker-state"><code>state</code></dfn> 属性<em>必须</em>返回最近设置的值（在 <code
              class="idl"><a data-link-type="idl" href="#enumdef-serviceworkerstate" id="ref-for-enumdef-serviceworkerstate②">ServiceWorkerState</a></code>
            枚举中）。</p>
        </section>
        <section class="algorithm" data-algorithm="service-worker-postmessage">
          <h4 class="heading settled" data-level="3.1.4" id="service-worker-postmessage"><span class="secno">3.1.4.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-serviceworker-postmessage" id="ref-for-dom-serviceworker-postmessage①">postMessage(message, transfer)</a></code></span><a
              class="self-link" href="#service-worker-postmessage"></a></h4>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorker" data-dfn-type="method" data-export
              id="dom-serviceworker-postmessage"><code>postMessage(<var>message</var>, <var>transfer</var>)</code></dfn>
            方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>令 <var>options</var> 为 «[ "transfer" → <var>transfer</var> ]»。</p>
            <li data-md>
              <p>使用 <var>message</var> 和 <var>options</var> 作为参数调用 <code
                  class="idl"><a data-link-type="idl" href="#dom-serviceworker-postmessage-message-options" id="ref-for-dom-serviceworker-postmessage-message-options①">postMessage(message, options)</a></code>。
              </p>
          </ol>
        </section>
        <section class="algorithm" data-algorithm="service-worker-postmessage-options">
          <h4 class="heading settled" data-level="3.1.5" id="service-worker-postmessage-options"><span
              class="secno">3.1.5. </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-serviceworker-postmessage-message-options" id="ref-for-dom-serviceworker-postmessage-message-options②">postMessage(message, options)</a></code></span><a
              class="self-link" href="#service-worker-postmessage-options"></a></h4>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorker" data-dfn-type="method" data-export
              data-lt="postMessage(message, options)|postMessage(message)"
              id="dom-serviceworker-postmessage-message-options"><code>postMessage(<var>message</var>, <var>options</var>)</code></dfn>
            方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>令 <var>serviceWorker</var> 为由 <a data-link-type="dfn" href="#dfn-service-worker"
                  id="ref-for-dfn-service-worker④⑧">service worker</a> 表示的 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#this" id="ref-for-this">this</a>。</p>
            <li data-md>
              <p>令 <var>incumbentSettings</var> 为 <a data-link-type="dfn">现任设置对象</a>。</p>
            <li data-md>
              <p>令 <var>incumbentGlobal</var> 为 <var>incumbentSettings</var> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                  id="ref-for-concept-settings-object-global③">全局对象</a>。</p>
            <li data-md>
              <p>令 <var>serializeWithTransferResult</var> 为 <a data-link-type="abstract-op"
                  href="https://html.spec.whatwg.org/multipage/structured-data.html#structuredserializewithtransfer"
                  id="ref-for-structuredserializewithtransfer">StructuredSerializeWithTransfer</a>(<var>message</var>,
                <var>options</var>["<code
                  class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#dom-structuredserializeoptions-transfer" id="ref-for-dom-structuredserializeoptions-transfer">transfer</a></code>"]).
                抛出任何异常。
              </p>
            <li data-md>
              <p>如果使用 "message" 和 <var>serviceWorker</var> 运行 <a data-link-type="dfn" href="#should-skip-event"
                  id="ref-for-should-skip-event">是否应跳过事件</a> 算法的结果为 true，则返回。
              </p>
            <li data-md>
              <p>并行运行这些子步骤：</p>
              <ol>
                <li data-md>
                  <p>如果运行 <a data-link-type="dfn" href="#run-service-worker" id="ref-for-run-service-worker">运行 Service
                      Worker</a> 算法的结果为<em>失败</em>，则返回。
                  </p>
                <li data-md>
                  <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                      id="ref-for-queue-a-task①">在 DOM 操作任务源上排队一个任务</a>，以运行以下步骤：</p>
                  <ol>
                    <li data-md>
                      <p>通过切换 <var>incumbentGlobal</var> 的类型来确定 <var>source</var>：</p>
                      <dl class="switch">
                        <dt><code
                            class="idl"><a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope①">ServiceWorkerGlobalScope</a></code>
                        <dd>在 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                            id="ref-for-relevant-settings-object">相关设置对象</a>中表示 <var>incumbentGlobal</var> 的 <a
                            data-link-type="dfn" href="#serviceworkerglobalscope-service-worker"
                            id="ref-for-serviceworkerglobalscope-service-worker">service worker</a> 的 <a
                            data-link-type="dfn" href="#get-the-service-worker-object"
                            id="ref-for-get-the-service-worker-object">获取 service worker 对象</a> 的结果。
                        <dt><code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window①">Window</a></code>
                        <dd>表示 <var>incumbentGlobal</var> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                            id="ref-for-relevant-settings-object①">相关设置对象</a> 的一个新 <code
                            class="idl"><a data-link-type="idl" href="#windowclient" id="ref-for-windowclient">WindowClient</a></code>
                          对象。
                        <dt>否则
                        <dd>表示 <var>incumbentGlobal</var> 的关联 worker 的一个新 <code
                            class="idl"><a data-link-type="idl" href="#client" id="ref-for-client">Client</a></code> 对象。
                      </dl>
                    <li data-md>
                      <p>令 <var>origin</var> 为 <var>incumbentSettings</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/origin.html#ascii-serialisation-of-an-origin"
                          id="ref-for-ascii-serialisation-of-an-origin">序列化</a> <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                          id="ref-for-concept-settings-object-origin①">源</a>。
                      </p>
                    <li data-md>
                      <p>令 <var>destination</var> 为与 <var>serviceWorker</var> 关联的 <code
                          class="idl"><a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope②">ServiceWorkerGlobalScope</a></code>
                        对象。</p>
                    <li data-md>
                      <p>令 <var>deserializeRecord</var> 为 <a data-link-type="abstract-op"
                          href="https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserializewithtransfer"
                          id="ref-for-structureddeserializewithtransfer">StructuredDeserializeWithTransfer</a>(<var>serializeWithTransferResult</var>,
                        <var>destination</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm"
                          id="ref-for-concept-global-object-realm">Realm</a>).
                      </p>
                      <p>如果这抛出一个异常，则令 <var>e</var> 为 <a data-link-type="dfn"
                          href="https://dom.spec.whatwg.org/#concept-event-create"
                          id="ref-for-concept-event-create">创建一个名为</a> <code
                          class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-container-messageerror-event" id="ref-for-service-worker-container-messageerror-event">messageerror</a></code>
                        的事件的结果，
                        使用 <code
                          class="idl"><a data-link-type="idl" href="#extendablemessageevent" id="ref-for-extendablemessageevent">ExtendableMessageEvent</a></code>，
                        将 <code
                          class="idl"><a data-link-type="idl" href="#dom-extendablemessageevent-origin" id="ref-for-dom-extendablemessageevent-origin">origin</a></code>
                        属性初始化为 <var>origin</var>，将 <code
                          class="idl"><a data-link-type="idl" href="#dom-extendablemessageevent-source" id="ref-for-dom-extendablemessageevent-source">source</a></code>
                        属性初始化为 <var>source</var>。</p>
                    <li data-md>
                      <p>否则：</p>
                      <ol>
                        <li data-md>
                          <p>令 <var>messageClone</var> 为 <var>deserializeRecord</var>.[[Deserialized]]。</p>
                        <li data-md>
                          <p>令 <var>newPorts</var> 为一个新的 <a data-link-type="dfn"
                              href="https://webidl.spec.whatwg.org/#dfn-frozen-array-type"
                              id="ref-for-dfn-frozen-array-type">冻结数组</a>，由
                            <var>deserializeRecord</var>.[[TransferredValues]] 中的所有 <code
                              class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport">MessagePort</a></code>
                            对象组成（如果有），保持它们的相对顺序。
                          </p>
                        <li data-md>
                          <p>令 <var>e</var> 为 <a data-link-type="dfn"
                              href="https://dom.spec.whatwg.org/#concept-event-create"
                              id="ref-for-concept-event-create①">创建一个名为</a> <code
                              class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-container-message-event" id="ref-for-service-worker-container-message-event①">message</a></code>
                            的事件的结果，
                            使用 <code
                              class="idl"><a data-link-type="idl" href="#extendablemessageevent" id="ref-for-extendablemessageevent①">ExtendableMessageEvent</a></code>，
                            将 <code
                              class="idl"><a data-link-type="idl" href="#dom-extendablemessageevent-origin" id="ref-for-dom-extendablemessageevent-origin①">origin</a></code>
                            属性初始化为 <var>origin</var>，将 <code
                              class="idl"><a data-link-type="idl" href="#dom-extendablemessageevent-source" id="ref-for-dom-extendablemessageevent-source①">source</a></code>
                            属性初始化为 <var>source</var>，将 <code
                              class="idl"><a data-link-type="idl" href="#dom-extendablemessageevent-data" id="ref-for-dom-extendablemessageevent-data">data</a></code>
                            属性初始化为 <var>messageClone</var>，将 <code
                              class="idl"><a data-link-type="idl" href="#dom-extendablemessageevent-ports" id="ref-for-dom-extendablemessageevent-ports">ports</a></code>
                            属性初始化为 <var>newPorts</var>。</p>
                      </ol>
                    <li data-md>
                      <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch"
                          id="ref-for-concept-event-dispatch②">在</a> <var>destination</var> 处分派 <var>e</var>。</p>
                    <li data-md>
                      <p>使用 <var>serviceWorker</var> 和 <var>e</var> 调用 <a data-link-type="dfn"
                          href="#update-service-worker-extended-events-set"
                          id="ref-for-update-service-worker-extended-events-set">更新 Service Worker 扩展事件集</a>。</p>
                  </ol>
              </ol>
          </ol>
        </section>

        <section>
          <h4 class="heading settled" data-level="3.1.6" id="service-worker-event-handler"><span class="secno">3.1.6.
            </span><span class="content">事件处理器</span><a class="self-link" href="#service-worker-event-handler"></a></h4>
          <p>以下是所有实现 <code
              class="idl"><a data-link-type="idl" href="#serviceworker" id="ref-for-serviceworker①⓪">ServiceWorker</a></code>
            接口的对象<em>必须</em>支持的<a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers"
              id="ref-for-event-handlers">事件处理器</a>（及其相应的 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type"
              id="ref-for-event-handler-event-type">事件处理器事件类型</a>），作为 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes"
              id="ref-for-event-handler-idl-attributes">事件处理器 IDL 属性</a>:
          </p>
          <table class="data">
            <thead>
              <tr>
                <th><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers"
                    id="ref-for-event-handlers①">事件处理器</a>
                <th><a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type"
                    id="ref-for-event-handler-event-type①">事件处理器事件类型</a>
            <tbody>
              <tr>
                <td>
                  <div class="mdn-anno wrapped">
                    <button class="mdn-anno-btn"><b class="all-engines-flag"
                        title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
                    <div class="feature">
                      <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorker/statechange_event"
                          title="ServiceWorker.state 更改时会触发 statechange 事件。">ServiceWorker/statechange_event</a>
                      </p>
                      <p class="all-engines-text">在所有当前引擎中。</p>
                      <div class="support">
                        <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                          class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                          class="chrome yes"><span>Chrome</span><span>40+</span></span>
                        <hr>
                        <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                          class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                        <hr>
                        <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                          class="ie no"><span>IE</span><span>不支持</span></span>
                        <hr>
                        <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                          class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                          class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                          class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                          class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                          class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
                      </div>
                    </div>
                  </div>
                  <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorker" data-dfn-type="attribute" data-export
                    id="dom-serviceworker-onstatechange"><code>onstatechange</code></dfn>
                <td><code
                    class="idl"><a data-link-type="idl" href="#eventdef-serviceworker-statechange" id="ref-for-eventdef-serviceworker-statechange">statechange</a></code>
          </table>
        </section>
      </section>
      <section>
        <h3 class="heading settled" data-level="3.2" id="serviceworkerregistration-interface"><span class="secno">3.2.
          </span><span class="content"><code
              class="idl"><a data-link-type="idl" href="#serviceworkerregistration" id="ref-for-serviceworkerregistration①">ServiceWorkerRegistration</a></code></span><a
            class="self-link" href="#serviceworkerregistration-interface"></a></h3>
        <div class="mdn-anno wrapped after">
          <button class="mdn-anno-btn"><b class="all-engines-flag" title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
          <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerRegistration"
                title="Service Worker API 的 ServiceWorkerRegistration 接口表示 service worker 的注册。您可以注册一个 service worker 来控制共享相同源的一个或多个页面。">ServiceWorkerRegistration</a>
            </p>
            <p class="all-engines-text">在所有当前引擎中。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                class="chrome yes"><span>Chrome</span><span>40+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                class="ie no"><span>IE</span><span>不支持</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
            </div>
          </div>
        </div>
        <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext①"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="serviceworkerregistration"><code><c- g>ServiceWorkerRegistration</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget①"><c- n>EventTarget</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworker" id="ref-for-serviceworker①①"><c- n>ServiceWorker</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorker?" href="#dom-serviceworkerregistration-installing" id="ref-for-dom-serviceworkerregistration-installing"><c- g>installing</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworker" id="ref-for-serviceworker①②"><c- n>ServiceWorker</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorker?" href="#dom-serviceworkerregistration-waiting" id="ref-for-dom-serviceworkerregistration-waiting"><c- g>waiting</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworker" id="ref-for-serviceworker①③"><c- n>ServiceWorker</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorker?" href="#dom-serviceworkerregistration-active" id="ref-for-dom-serviceworkerregistration-active"><c- g>active</c-></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#navigationpreloadmanager" id="ref-for-navigationpreloadmanager①"><c- n>NavigationPreloadManager</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="NavigationPreloadManager" href="#dom-serviceworkerregistration-navigationpreload" id="ref-for-dom-serviceworkerregistration-navigationpreload"><c- g>navigationPreload</c-></a>;

  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString①"><c- b>USVString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="USVString" href="#dom-serviceworkerregistration-scope" id="ref-for-dom-serviceworkerregistration-scope"><c- g>scope</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-serviceworkerupdateviacache" id="ref-for-enumdef-serviceworkerupdateviacache"><c- n>ServiceWorkerUpdateViaCache</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorkerUpdateViaCache" href="#dom-serviceworkerregistration-updateviacache" id="ref-for-dom-serviceworkerregistration-updateviacache"><c- g>updateViaCache</c-></a>;

  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined②"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-serviceworkerregistration-update" id="ref-for-dom-serviceworkerregistration-update"><c- g>update</c-></a>();
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject①"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean"><c- b>boolean</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-serviceworkerregistration-unregister" id="ref-for-dom-serviceworkerregistration-unregister"><c- g>unregister</c-></a>();

  // event
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler①"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkerregistration-onupdatefound" id="ref-for-dom-serviceworkerregistration-onupdatefound"><c- g>onupdatefound</c-></a>;
};

<c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-serviceworkerupdateviacache"><code><c- g>ServiceWorkerUpdateViaCache</c-></code></dfn> {
  <dfn class="idl-code" data-dfn-for="ServiceWorkerUpdateViaCache" data-dfn-type="enum-value" data-export id="dom-serviceworkerupdateviacache-imports"><code><c- s>"imports"</c-></code><a class="self-link" href="#dom-serviceworkerupdateviacache-imports"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="ServiceWorkerUpdateViaCache" data-dfn-type="enum-value" data-export id="dom-serviceworkerupdateviacache-all"><code><c- s>"all"</c-></code><a class="self-link" href="#dom-serviceworkerupdateviacache-all"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="ServiceWorkerUpdateViaCache" data-dfn-type="enum-value" data-export id="dom-serviceworkerupdateviacache-none"><code><c- s>"none"</c-></code><a class="self-link" href="#dom-serviceworkerupdateviacache-none"></a></dfn>
};
</pre>
        <p><code
            class="idl"><a data-link-type="idl" href="#serviceworkerregistration" id="ref-for-serviceworkerregistration②">ServiceWorkerRegistration</a></code>
          具有一个 <dfn class="dfn-paneled" data-dfn-for="ServiceWorkerRegistration" data-dfn-type="dfn" data-export
            id="serviceworkerregistration-service-worker-registration">service worker 注册</dfn>（一个 <a
            data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration②⑧">service worker 注册</a>）。</p>
        <section>
          <h4 class="heading settled" data-level="3.2.1" id="service-worker-registration-creation"><span
              class="secno">3.2.1. </span><span class="content">获取 <code
                class="idl"><a data-link-type="idl" href="#serviceworkerregistration" id="ref-for-serviceworkerregistration③">ServiceWorkerRegistration</a></code>
              实例</span><a class="self-link" href="#service-worker-registration-creation"></a></h4>
          <p><a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
              id="ref-for-environment-settings-object④">环境设置对象</a> 具有一个 <dfn class="dfn-paneled"
              data-dfn-for="environment settings object" data-dfn-type="dfn" data-noexport
              id="environment-settings-object-service-worker-registration-object-map">service worker 注册对象映射</dfn>，即一个 <a
              data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map②">映射</a>，其中
            <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-getting-the-keys"
              id="ref-for-map-getting-the-keys①">键</a> 是 <a data-link-type="dfn" href="#dfn-service-worker-registration"
              id="ref-for-dfn-service-worker-registration②⑨">service worker 注册</a>，<a data-link-type="dfn"
              href="https://infra.spec.whatwg.org/#map-getting-the-values" id="ref-for-map-getting-the-values①">值</a> 是
            <code
              class="idl"><a data-link-type="idl" href="#serviceworkerregistration" id="ref-for-serviceworkerregistration④">ServiceWorkerRegistration</a></code>
            对象。
          </p>
          <!-- <section class="algorithm" data-algorithm="service-worker-registration-creation-algorithm"> -->
          <p>要获取表示 <var>registration</var>（一个 <a data-link-type="dfn" href="#dfn-service-worker-registration"
              id="ref-for-dfn-service-worker-registration③⓪">service worker
              注册</a>）在 <var>environment</var>（一个 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
              id="ref-for-environment-settings-object⑤">环境设置对象</a>）中的 <dfn class="dfn-paneled" data-dfn-type="dfn"
              data-lt="获取 service worker 注册对象" data-noexport id="get-the-service-worker-registration-object">service
              worker 注册对象</dfn>，请运行以下步骤：</p>
          <ol>
            <li data-md>
              <p>令 <var>objectMap</var> 为 <var>environment</var> 的 <a data-link-type="dfn"
                  href="#environment-settings-object-service-worker-registration-object-map"
                  id="ref-for-environment-settings-object-service-worker-registration-object-map">service worker
                  注册对象映射</a>。</p>
            <li data-md>
              <p>如果 <var>objectMap</var>[<var>registration</var>] 不 <a data-link-type="dfn"
                  href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①">存在</a>，则：</p>
              <ol>
                <li data-md>
                  <p>令 <var>registrationObject</var> 为 <var>environment</var> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object&apos;s-realm"
                      id="ref-for-environment-settings-object&apos;s-realm①">Realm</a> 中的一个新的 <code
                      class="idl"><a data-link-type="idl" href="#serviceworkerregistration" id="ref-for-serviceworkerregistration⑤">ServiceWorkerRegistration</a></code>
                    对象。</p>
                <li data-md>
                  <p>将 <var>registrationObject</var> 的 <a data-link-type="dfn"
                      href="#serviceworkerregistration-service-worker-registration"
                      id="ref-for-serviceworkerregistration-service-worker-registration①">service worker
                      注册</a> 设置为 <var>registration</var>。</p>
                <li data-md>
                  <p>将 <var>registrationObject</var> 的 <code
                      class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-installing" id="ref-for-dom-serviceworkerregistration-installing①">installing</a></code>
                    属性设置为 null。</p>
                <li data-md>
                  <p>将 <var>registrationObject</var> 的 <code
                      class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-waiting" id="ref-for-dom-serviceworkerregistration-waiting①">waiting</a></code>
                    属性设置为 null。</p>
                <li data-md>
                  <p>将 <var>registrationObject</var> 的 <code
                      class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-active" id="ref-for-dom-serviceworkerregistration-active①">active</a></code>
                    属性设置为 null。</p>
                <li data-md>
                  <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-installing-worker"
                      id="ref-for-dfn-installing-worker③">installing worker</a> 不为 null，则将
                    <var>registrationObject</var> 的 <code
                      class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-installing" id="ref-for-dom-serviceworkerregistration-installing②">installing</a></code>
                    属性设置为在 <var>environment</var> 中<a data-link-type="dfn" href="#get-the-service-worker-object"
                      id="ref-for-get-the-service-worker-object①">获取</a>表示 <var>registration</var> 的 <a
                      data-link-type="dfn" href="#dfn-installing-worker" id="ref-for-dfn-installing-worker④">installing
                      worker</a> 的 service worker 对象的结果。
                  </p>
                <li data-md>
                  <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-waiting-worker"
                      id="ref-for-dfn-waiting-worker②">waiting worker</a> 不为 null，则将
                    <var>registrationObject</var> 的 <code
                      class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-waiting" id="ref-for-dom-serviceworkerregistration-waiting②">waiting</a></code>
                    属性设置为在 <var>environment</var> 中<a data-link-type="dfn" href="#get-the-service-worker-object"
                      id="ref-for-get-the-service-worker-object②">获取</a>表示 <var>registration</var> 的 <a
                      data-link-type="dfn" href="#dfn-waiting-worker" id="ref-for-dfn-waiting-worker③">waiting
                      worker</a> 的 service worker 对象的结果。
                  </p>
                <li data-md>
                  <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                      id="ref-for-dfn-active-worker⑦">active worker</a> 不为 null，则将
                    <var>registrationObject</var> 的 <code
                      class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-active" id="ref-for-dom-serviceworkerregistration-active②">active</a></code>
                    属性设置为在 <var>environment</var> 中<a data-link-type="dfn" href="#get-the-service-worker-object"
                      id="ref-for-get-the-service-worker-object③">获取</a>表示 <var>registration</var> 的 <a
                      data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker⑧">active worker</a>
                    的 service worker 对象的结果。
                  </p>
                <li data-md>
                  <p>将 <var>objectMap</var>[<var>registration</var>] 设置为 <var>registrationObject</var>。</p>
              </ol>
            <li data-md>
              <p>返回 <var>objectMap</var>[<var>registration</var>]。</p>
          </ol>
          <!-- </section> -->
        </section>

        <section class="algorithm" data-algorithm="navigator-service-worker-installing">
          <h4 class="heading settled" data-level="3.2.2" id="navigator-service-worker-installing"><span
              class="secno">3.2.2. </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-installing" id="ref-for-dom-serviceworkerregistration-installing③">installing</a></code></span><a
              class="self-link" href="#navigator-service-worker-installing"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerRegistration/installing"
                  title="ServiceWorkerRegistration 接口的 installing 属性返回一个 ServiceWorker，其 ServiceWorker.state 为 installing。该属性最初设置为 null。">ServiceWorkerRegistration/installing</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>不支持</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerRegistration" data-dfn-type="attribute"
              data-export id="dom-serviceworkerregistration-installing"><code>installing</code></dfn>
            属性<em>必须</em>返回最近设置的值。
          </p>
          <p class="note" role="note"><span>注意：</span>在 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object&apos;s-realm"
              id="ref-for-environment-settings-object&apos;s-realm②">Realm</a> 中，每个关联的 <a data-link-type="dfn"
              href="#dfn-service-worker" id="ref-for-dfn-service-worker④⑨">service worker</a> 只有一个 <code
              class="idl"><a data-link-type="idl" href="#serviceworker" id="ref-for-serviceworker①④">ServiceWorker</a></code>
            对象。</p>
        </section>

        <section class="algorithm" data-algorithm="navigator-service-worker-waiting">
          <h4 class="heading settled" data-level="3.2.3" id="navigator-service-worker-waiting"><span
              class="secno">3.2.3. </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-waiting" id="ref-for-dom-serviceworkerregistration-waiting③">waiting</a></code></span><a
              class="self-link" href="#navigator-service-worker-waiting"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerRegistration/waiting"
                  title="ServiceWorkerRegistration 接口的 waiting 属性返回一个 ServiceWorker，其 ServiceWorker.state 为 installed。该属性最初设置为 null。">ServiceWorkerRegistration/waiting</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>不支持</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerRegistration" data-dfn-type="attribute"
              data-export id="dom-serviceworkerregistration-waiting"><code>waiting</code></dfn> 属性<em>必须</em>
            返回最近设置的值。</p>
          <p class="note" role="note"><span>注意：</span>在 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object&apos;s-realm"
              id="ref-for-environment-settings-object&apos;s-realm③">Realm</a> 中，每个关联的 <a data-link-type="dfn"
              href="#dfn-service-worker" id="ref-for-dfn-service-worker⑤⓪">service worker</a> 只有一个 <code
              class="idl"><a data-link-type="idl" href="#serviceworker" id="ref-for-serviceworker①⑤">ServiceWorker</a></code>
            对象。</p>
        </section>

        <section class="algorithm" data-algorithm="navigator-service-worker-active">
          <h4 class="heading settled" data-level="3.2.4" id="navigator-service-worker-active"><span class="secno">3.2.4.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-active" id="ref-for-dom-serviceworkerregistration-active③">active</a></code></span><a
              class="self-link" href="#navigator-service-worker-active"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerRegistration/active"
                  title="ServiceWorkerRegistration 接口的 active 属性返回一个 ServiceWorker，其 ServiceWorker.state 为 activating 或 activated。该属性最初设置为 null。">ServiceWorkerRegistration/active</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>不支持</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerRegistration" data-dfn-type="attribute"
              data-export id="dom-serviceworkerregistration-active"><code>active</code></dfn> 属性<em>必须</em>
            返回最近设置的值。</p>
          <p class="note" role="note"><span>注意：</span>在 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object&apos;s-realm"
              id="ref-for-environment-settings-object&apos;s-realm④">Realm</a> 中，每个关联的 <a data-link-type="dfn"
              href="#dfn-service-worker" id="ref-for-dfn-service-worker⑤①">service worker</a> 只有一个 <code
              class="idl"><a data-link-type="idl" href="#serviceworker" id="ref-for-serviceworker①⑥">ServiceWorker</a></code>
            对象。</p>
        </section>

        <section class="algorithm" data-algorithm="service-worker-registration-navigationpreload">
          <h4 class="heading settled" data-level="3.2.5" id="service-worker-registration-navigationpreload"><span
              class="secno">3.2.5. </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-navigationpreload" id="ref-for-dom-serviceworkerregistration-navigationpreload①">navigationPreload</a></code></span><a
              class="self-link" href="#service-worker-registration-navigationpreload"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerRegistration/navigationPreload"
                  title="ServiceWorkerRegistration 接口的 navigationPreload 只读属性返回与当前 service worker 注册关联的 NavigationPreloadManager。">ServiceWorkerRegistration/navigationPreload</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>99+</span></span><span
                  class="safari yes"><span>Safari</span><span>15.4+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>59+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>46+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>不支持</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>99+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>15.4+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerRegistration" data-dfn-type="attribute"
              data-export id="dom-serviceworkerregistration-navigationpreload"><code>navigationPreload</code></dfn>
            getter 的步骤是返回 <a data-link-type="dfn" href="#serviceworkerregistration-service-worker-registration"
              id="ref-for-serviceworkerregistration-service-worker-registration②">service worker 注册</a> 的 <code
              class="idl"><a data-link-type="idl" href="#navigationpreloadmanager" id="ref-for-navigationpreloadmanager②">NavigationPreloadManager</a></code>
            对象。
          </p>
        </section>
        <section class="algorithm" data-algorithm="service-worker-registration-scope">
          <h4 class="heading settled" data-level="3.2.6" id="service-worker-registration-scope"><span
              class="secno">3.2.6. </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-scope" id="ref-for-dom-serviceworkerregistration-scope①">scope</a></code></span><a
              class="self-link" href="#service-worker-registration-scope"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerRegistration/scope"
                  title="ServiceWorkerRegistration 接口的 scope 只读属性返回 service worker 注册的唯一标识符。service worker 必须与注册 ServiceWorker 的文档具有相同的源。">ServiceWorkerRegistration/scope</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>不支持</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerRegistration" data-dfn-type="attribute"
              data-export id="dom-serviceworkerregistration-scope"><code>scope</code></dfn> getter 的步骤是返回 <a
              data-link-type="dfn" href="#serviceworkerregistration-service-worker-registration"
              id="ref-for-serviceworkerregistration-service-worker-registration③">service worker 注册</a> 的 <a
              data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer"
              id="ref-for-concept-url-serializer③">序列化</a> <a data-link-type="dfn" href="#dfn-scope-url"
              id="ref-for-dfn-scope-url⑤">scope url</a>。</p>
          <div class="example" id="example-0146b4b0"><a class="self-link" href="#example-0146b4b0"></a> 在 <a
              href="#service-worker-url">§ 3.1.2 scriptURL</a> 的示例中，从
            <code>navigator.serviceWorker.ready.then(registration => console.log(registration.scope))</code> 中获取的
            <code>registration.scope</code> 的值将是 "<code>https://example.com/</code>"。
          </div>
        </section>

        <section class="algorithm" data-algorithm="service-worker-registration-updateviacache">
          <h4 class="heading settled" data-level="3.2.7" id="service-worker-registration-updateviacache"><span
              class="secno">3.2.7. </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-updateviacache" id="ref-for-dom-serviceworkerregistration-updateviacache①">updateViaCache</a></code></span><a
              class="self-link" href="#service-worker-registration-updateviacache"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerRegistration/updateViaCache"
                  title="ServiceWorkerRegistration 接口的 updateViaCache 只读属性根据调用 ServiceWorkerContainer.register 时指定的模式更新缓存。对 `importScripts` 的请求仍然通过 HTTP 缓存。`updateViaCache` 提供对此行为的控制。">ServiceWorkerRegistration/updateViaCache</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>57+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>68+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>55+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>18</span></span><span
                  class="ie no"><span>IE</span><span>不支持</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>57+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>68+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>68+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>10.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>48+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerRegistration" data-dfn-type="attribute"
              data-export id="dom-serviceworkerregistration-updateviacache"><code>updateViaCache</code></dfn>
            getter 的步骤是返回 <a data-link-type="dfn" href="#serviceworkerregistration-service-worker-registration"
              id="ref-for-serviceworkerregistration-service-worker-registration④">service worker 注册</a> 的 <a
              data-link-type="dfn" href="#dfn-update-via-cache" id="ref-for-dfn-update-via-cache">update via cache
              模式</a>。</p>
        </section>
        <section class="algorithm" data-algorithm="service-worker-registration-update">
          <h4 class="heading settled" data-level="3.2.8" id="service-worker-registration-update"><span
              class="secno">3.2.8. </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-update" id="ref-for-dom-serviceworkerregistration-update①">update()</a></code></span><a
              class="self-link" href="#service-worker-registration-update"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerRegistration/update"
                  title="ServiceWorkerRegistration 接口的 update() 方法尝试更新 service worker。它获取 worker 的脚本 URL，如果新 worker 与当前 worker 不是逐字节相同，它将安装新 worker。如果上一次获取是在 24 小时之前进行的，则获取 worker 时会绕过任何浏览器缓存。">ServiceWorkerRegistration/update</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>45+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>32+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>不支持</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>45+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>45+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>32+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerRegistration" data-dfn-type="method"
              data-export id="dom-serviceworkerregistration-update"><code>update()</code></dfn> 方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>让 <var>registration</var> 成为 <a data-link-type="dfn"
                  href="#serviceworkerregistration-service-worker-registration"
                  id="ref-for-serviceworkerregistration-service-worker-registration⑤">service worker 注册</a>。</p>
            <li data-md>
              <p>让 <var>newestWorker</var> 成为传递 <var>registration</var> 作为参数运行 <a data-link-type="dfn"
                  href="#get-newest-worker" id="ref-for-get-newest-worker">获取最新 worker</a> 算法的结果。</p>
            <li data-md>
              <p>如果 <var>newestWorker</var> 为 null，则返回 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#a-promise-rejected-with"
                  id="ref-for-a-promise-rejected-with">一个被拒绝的 promise</a>，并附有 "<code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror">InvalidStateError</a></code>"
                的 <code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException">DOMException</a></code>，并中止这些步骤。
              </p>
            <li data-md>
              <p>如果 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①">this</a> 的 <a
                  data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"
                  id="ref-for-concept-relevant-global">相关全局对象</a> <var>globalObject</var> 是 <code
                  class="idl"><a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope③">ServiceWorkerGlobalScope</a></code>
                对象，并且 <var>globalObject</var> 关联的 <a data-link-type="dfn"
                  href="#serviceworkerglobalscope-service-worker"
                  id="ref-for-serviceworkerglobalscope-service-worker①">service worker</a> 的 <a
                  data-link-type="dfn">状态</a> 是 "<code>installing</code>"，则返回 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#a-promise-rejected-with"
                  id="ref-for-a-promise-rejected-with①">一个被拒绝的 promise</a>，并附有 "<code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror①">InvalidStateError</a></code>"
                的 <code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException①">DOMException</a></code>，并中止这些步骤。
              </p>
            <li data-md>
              <p>让 <var>promise</var> 成为 <a data-link-type="dfn"
                  href="http://tc39.github.io/ecma262/#sec-promise-objects" id="ref-for-sec-promise-objects">一个
                  promise</a>。</p>
            <li data-md>
              <p>让 <var>job</var> 成为运行 <a data-link-type="dfn" href="#create-job" id="ref-for-create-job">创建作业</a>
                的结果，并使用 <em>update</em>，<var>registration</var> 的 <a data-link-type="dfn"
                  href="#service-worker-registration-storage-key"
                  id="ref-for-service-worker-registration-storage-key②">存储键</a>，<var>registration</var> 的 <a
                  data-link-type="dfn" href="#dfn-scope-url" id="ref-for-dfn-scope-url⑥">scope
                  url</a>，<var>newestWorker</var> 的 <a data-link-type="dfn" href="#dfn-script-url"
                  id="ref-for-dfn-script-url①">脚本 url</a>，<var>promise</var> 和 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②">this</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                  id="ref-for-relevant-settings-object②">相关设置对象</a>。</p>
            <li data-md>
              <p>将 <var>job</var> 的 <a data-link-type="dfn" href="#dfn-job-worker-type"
                  id="ref-for-dfn-job-worker-type">worker 类型</a> 设置为 <var>newestWorker</var> 的 <a data-link-type="dfn"
                  href="#dfn-type" id="ref-for-dfn-type">类型</a>。</p>
            <li data-md>
              <p>调用 <a data-link-type="dfn" href="#schedule-job" id="ref-for-schedule-job">安排作业</a>，并使用 <var>job</var>。
              </p>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
          </ol>
        </section>
        <section class="algorithm" data-algorithm="navigator-service-worker-unregister">
          <h4 class="heading settled" data-level="3.2.9" id="navigator-service-worker-unregister"><span
              class="secno">3.2.9. </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-unregister" id="ref-for-dom-serviceworkerregistration-unregister①">unregister()</a></code></span><a
              class="self-link" href="#navigator-service-worker-unregister"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerRegistration/unregister"
                  title="ServiceWorkerRegistration 接口的 unregister() 方法注销 service worker 注册并返回一个 Promise。如果没有找到注册，promise 将解析为 false，否则它将解析为 true，无论是否发生了注销（如果其他人刚刚使用相同的 scope 调用了 ServiceWorkerContainer.register()，它可能不会注销）。service worker 将在完成任何正在进行的操作后注销。">ServiceWorkerRegistration/unregister</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>不支持</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p class="note" role="note"><span>注意：</span> <code
              class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-unregister" id="ref-for-dom-serviceworkerregistration-unregister②">unregister()</a></code>
            方法注销 <a data-link-type="dfn" href="#dfn-service-worker-registration"
              id="ref-for-dfn-service-worker-registration③①">service worker 注册</a>。需要注意的是，当前<a data-link-type="dfn"
              href="#dfn-control" id="ref-for-dfn-control①">控制</a>的 <a data-link-type="dfn"
              href="#dfn-service-worker-client" id="ref-for-dfn-service-worker-client①⑨">service worker 客户端</a>的 <a
              data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
              id="ref-for-concept-environment-active-service-worker①⑦">active service worker</a> 的 <a
              data-link-type="dfn" href="#dfn-containing-service-worker-registration"
              id="ref-for-dfn-containing-service-worker-registration①">包含 service worker 注册</a> 在所有使用此 <a
              data-link-type="dfn" href="#dfn-service-worker-registration"
              id="ref-for-dfn-service-worker-registration③②">service worker 注册</a> 的 <a data-link-type="dfn"
              href="#dfn-service-worker-client" id="ref-for-dfn-service-worker-client②⓪">service worker
              客户端</a>（包括它本身）卸载之前仍然有效。也就是说，<code
              class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-unregister" id="ref-for-dom-serviceworkerregistration-unregister③">unregister()</a></code>
            方法只影响后续的<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate"
              id="ref-for-navigate③">导航</a>。</p>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerRegistration" data-dfn-type="method"
              data-export id="dom-serviceworkerregistration-unregister"><code>unregister()</code></dfn> 方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>让 <var>registration</var> 成为 <a data-link-type="dfn"
                  href="#serviceworkerregistration-service-worker-registration"
                  id="ref-for-serviceworkerregistration-service-worker-registration⑥">service worker 注册</a>。</p>
            <li data-md>
              <p>让 <var>promise</var> 成为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                  id="ref-for-a-new-promise">一个新的 promise</a>。</p>
            <li data-md>
              <p>让 <var>job</var> 成为运行 <a data-link-type="dfn" href="#create-job" id="ref-for-create-job①">创建作业</a>
                的结果，并使用 <em>unregister</em>，<var>registration</var> 的 <a data-link-type="dfn"
                  href="#service-worker-registration-storage-key"
                  id="ref-for-service-worker-registration-storage-key③">存储键</a>，<var>registration</var> 的 <a
                  data-link-type="dfn" href="#dfn-scope-url" id="ref-for-dfn-scope-url⑦">scope url</a>，null，
                <var>promise</var>，以及 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this③">this</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                  id="ref-for-relevant-settings-object③">相关设置对象</a>。
              </p>
            <li data-md>
              <p>调用 <a data-link-type="dfn" href="#schedule-job" id="ref-for-schedule-job①">安排作业</a>，并使用 <var>job</var>。
              </p>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
          </ol>
        </section>
        <section>
          <h4 class="heading settled" data-level="3.2.10" id="service-worker-registration-event-handler"><span
              class="secno">3.2.10. </span><span class="content">事件处理器</span><a class="self-link"
              href="#service-worker-registration-event-handler"></a></h4>
          <p>以下是 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers"
              id="ref-for-event-handlers②">事件处理器</a>（及其相应的 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type"
              id="ref-for-event-handler-event-type②">事件处理器事件类型</a>），所有实现 <code
              class="idl"><a data-link-type="idl" href="#serviceworkerregistration" id="ref-for-serviceworkerregistration⑥">ServiceWorkerRegistration</a></code>
            接口的对象 <em>必须</em> 支持这些属性，作为 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes"
              id="ref-for-event-handler-idl-attributes①">事件处理器 IDL 属性</a>：
          </p>
          <table class="data">
            <thead>
              <tr>
                <th><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers"
                    id="ref-for-event-handlers③">事件处理器</a>
                <th><a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type"
                    id="ref-for-event-handler-event-type③">事件处理器事件类型</a>
            <tbody>
              <tr>
                <td>
                  <div class="mdn-anno wrapped">
                    <button class="mdn-anno-btn"><b class="all-engines-flag"
                        title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
                    <div class="feature">
                      <p><a
                          href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerRegistration/updatefound_event"
                          title="ServiceWorkerRegistration 接口的 updatefound 事件在 ServiceWorkerRegistration.installing 属性获取新 service worker 时触发。">ServiceWorkerRegistration/updatefound_event</a>
                      </p>
                      <p class="all-engines-text">在所有当前引擎中。</p>
                      <div class="support">
                        <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                          class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                          class="chrome yes"><span>Chrome</span><span>40+</span></span>
                        <hr>
                        <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                          class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                        <hr>
                        <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                          class="ie no"><span>IE</span><span>不支持</span></span>
                        <hr>
                        <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                          class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                          class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                          class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                          class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                          class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
                      </div>
                    </div>
                  </div>
                  <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerRegistration" data-dfn-type="attribute"
                    data-export id="dom-serviceworkerregistration-onupdatefound"><code>onupdatefound</code></dfn>
                <td><code
                    class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-registration-updatefound-event" id="ref-for-service-worker-registration-updatefound-event">updatefound</a></code>
          </table>
        </section>
      </section>
      <section>
        <h3 class="heading settled" data-level="3.3" id="navigator-serviceworker"><span class="secno">3.3. </span><span
            class="content"><code
              class="idl"><a data-link-type="idl" href="#navigator-service-worker-attribute" id="ref-for-navigator-service-worker-attribute">navigator.serviceWorker</a></code></span><a
            class="self-link" href="#navigator-serviceworker"></a></h3>
        <pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/system-state.html#navigator" id="ref-for-navigator"><c- g>Navigator</c-></a> {
      [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext②"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject①"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer"><c- n>ServiceWorkerContainer</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorkerContainer" href="#navigator-service-worker-attribute" id="ref-for-navigator-service-worker-attribute①"><c- g>serviceWorker</c-></a>;
    };
    
    <c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workernavigator" id="ref-for-workernavigator"><c- g>WorkerNavigator</c-></a> {
      [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext③"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject②"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer①"><c- n>ServiceWorkerContainer</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorkerContainer" href="#navigator-service-worker-attribute" id="ref-for-navigator-service-worker-attribute②"><c- g>serviceWorker</c-></a>;
    };
    </pre>
        <div class="mdn-anno wrapped">
          <button class="mdn-anno-btn"><b class="all-engines-flag" title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
          <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/serviceWorker"
                title="Navigator.serviceWorker 只读属性返回关联文档的 ServiceWorkerContainer 对象，该对象提供注册、移除、升级和与 ServiceWorker 通信的访问权限。">Navigator/serviceWorker</a>
            </p>
            <p class="all-engines-text">在所有当前引擎中。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                class="chrome yes"><span>Chrome</span><span>40+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (旧版)</span><span>17+</span></span><span
                class="ie no"><span>IE</span><span>不支持</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
            </div>
          </div>
        </div>
        <p>这个 <dfn class="dfn-paneled idl-code" data-dfn-for="Navigator,WorkerNavigator" data-dfn-type="attribute"
            data-export id="navigator-service-worker-attribute"><code>serviceWorker</code></dfn> 的 getter 步骤是返回与 <a
            data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this④">此对象</a> 关联的 <code
            class="idl"><a data-link-type="idl" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer②">ServiceWorkerContainer</a></code>
          对象。</p>
      </section>

      <section>
        <h3 class="heading settled" data-level="3.4" id="serviceworkercontainer-interface"><span class="secno">3.4.
          </span><span class="content"><code
              class="idl"><a data-link-type="idl" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer③">ServiceWorkerContainer</a></code></span><a
            class="self-link" href="#serviceworkercontainer-interface"></a></h3>
        <div class="mdn-anno wrapped after">
          <button class="mdn-anno-btn"><b class="all-engines-flag" title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
          <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer"
                title="ServiceWorkerContainer 接口是 Service Worker API 的一部分，提供了一个表示服务工作线程的对象，包括注册、注销和更新服务工作线程的功能，以及访问服务工作线程及其注册状态的能力。">ServiceWorkerContainer</a>
            </p>
            <p class="all-engines-text">在所有当前引擎中。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                class="chrome yes"><span>Chrome</span><span>40+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (旧版)</span><span>17+</span></span><span
                class="ie no"><span>IE</span><span>不支持</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
            </div>
          </div>
        </div>
        <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext④"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed②"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="serviceworkercontainer"><code><c- g>ServiceWorkerContainer</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget②"><c- n>EventTarget</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworker" id="ref-for-serviceworker①⑦"><c- n>ServiceWorker</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorker?" href="#dom-serviceworkercontainer-controller" id="ref-for-dom-serviceworkercontainer-controller"><c- g>controller</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#serviceworkerregistration" id="ref-for-serviceworkerregistration⑦"><c- n>ServiceWorkerRegistration</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Promise<ServiceWorkerRegistration>" href="#dom-serviceworkercontainer-ready" id="ref-for-dom-serviceworkercontainer-ready"><c- g>ready</c-></a>;

  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject②"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise③"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#serviceworkerregistration" id="ref-for-serviceworkerregistration⑧"><c- n>ServiceWorkerRegistration</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-serviceworkercontainer-register" id="ref-for-dom-serviceworkercontainer-register"><c- g>register</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString②"><c- b>USVString</c-></a> <dfn class="idl-code" data-dfn-for="ServiceWorkerContainer/register(scriptURL, options), ServiceWorkerContainer/register(scriptURL)" data-dfn-type="argument" data-export id="dom-serviceworkercontainer-register-scripturl-options-scripturl"><code><c- g>scriptURL</c-></code><a class="self-link" href="#dom-serviceworkercontainer-register-scripturl-options-scripturl"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-registrationoptions" id="ref-for-dictdef-registrationoptions"><c- n>RegistrationOptions</c-></a> <dfn class="idl-code" data-dfn-for="ServiceWorkerContainer/register(scriptURL, options), ServiceWorkerContainer/register(scriptURL)" data-dfn-type="argument" data-export id="dom-serviceworkercontainer-register-scripturl-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-serviceworkercontainer-register-scripturl-options-options"></a></dfn> = {});

  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject③"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise④"><c- b>Promise</c-></a>&lt;(<a data-link-type="idl-name" href="#serviceworkerregistration" id="ref-for-serviceworkerregistration⑨"><c- n>ServiceWorkerRegistration</c-></a> <c- b>or</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined③"><c- b>undefined</c-></a>)> <a class="idl-code" data-link-type="method" href="#dom-serviceworkercontainer-getregistration" id="ref-for-dom-serviceworkercontainer-getregistration"><c- g>getRegistration</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString③"><c- b>USVString</c-></a> <dfn class="idl-code" data-dfn-for="ServiceWorkerContainer/getRegistration(clientURL), ServiceWorkerContainer/getRegistration()" data-dfn-type="argument" data-export id="dom-serviceworkercontainer-getregistration-clienturl-clienturl"><code><c- g>clientURL</c-></code><a class="self-link" href="#dom-serviceworkercontainer-getregistration-clienturl-clienturl"></a></dfn> = "");
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject④"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise⑤"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array" id="ref-for-idl-frozen-array"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="#serviceworkerregistration" id="ref-for-serviceworkerregistration①⓪"><c- n>ServiceWorkerRegistration</c-></a>>> <a class="idl-code" data-link-type="method" href="#dom-serviceworkercontainer-getregistrations" id="ref-for-dom-serviceworkercontainer-getregistrations"><c- g>getRegistrations</c-></a>();

  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined④"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-serviceworkercontainer-startmessages" id="ref-for-dom-serviceworkercontainer-startmessages"><c- g>startMessages</c-></a>();


  // events
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler②"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkercontainer-oncontrollerchange" id="ref-for-dom-serviceworkercontainer-oncontrollerchange"><c- g>oncontrollerchange</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler③"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkercontainer-onmessage" id="ref-for-dom-serviceworkercontainer-onmessage"><c- g>onmessage</c-></a>; // event.source of message events is ServiceWorker object
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler④"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkercontainer-onmessageerror" id="ref-for-dom-serviceworkercontainer-onmessageerror"><c- g>onmessageerror</c-></a>;
};
</pre>
        <pre class="idl highlight def" id="registration-option-list-dictionary"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-registrationoptions"><code><c- g>RegistrationOptions</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString④"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="RegistrationOptions" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-registrationoptions-scope"><code><c- g>scope</c-></code></dfn>;
  <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/workers.html#workertype" id="ref-for-workertype"><c- n>WorkerType</c-></a> <dfn class="dfn-paneled idl-code" data-default="&quot;classic&quot;" data-dfn-for="RegistrationOptions" data-dfn-type="dict-member" data-export data-type="WorkerType " id="dom-registrationoptions-type"><code><c- g>type</c-></code></dfn> = "classic";
  <a data-link-type="idl-name" href="#enumdef-serviceworkerupdateviacache" id="ref-for-enumdef-serviceworkerupdateviacache①"><c- n>ServiceWorkerUpdateViaCache</c-></a> <dfn class="dfn-paneled idl-code" data-default="&quot;imports&quot;" data-dfn-for="RegistrationOptions" data-dfn-type="dict-member" data-export data-type="ServiceWorkerUpdateViaCache " id="dom-registrationoptions-updateviacache"><code><c- g>updateViaCache</c-></code></dfn> = "imports";
};
</pre>
        <p>用户代理在创建 <code
            class="idl"><a data-link-type="idl" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer④">ServiceWorkerContainer</a></code>
          对象时，<em>必须</em>在创建 <code
            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/system-state.html#navigator" id="ref-for-navigator①">Navigator</a></code>
          对象或 <code
            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workernavigator" id="ref-for-workernavigator①">WorkerNavigator</a></code>
          对象时将其与该对象关联。</p>
        <p><code
            class="idl"><a data-link-type="idl" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer⑤">ServiceWorkerContainer</a></code>
          提供了注册、注销和更新 <a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration③③">服务工作线程注册</a>的功能，并提供对 <a data-link-type="dfn"
            href="#dfn-service-worker-registration" id="ref-for-dfn-service-worker-registration③④">服务工作线程注册</a>及其关联的 <a
            data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑤②">服务工作线程</a> 状态的访问。</p>
        <p><code
            class="idl"><a data-link-type="idl" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer⑥">ServiceWorkerContainer</a></code>
          具有一个关联的 <dfn class="dfn-paneled" data-dfn-for="ServiceWorkerContainer" data-dfn-type="dfn" data-noexport
            id="serviceworkercontainer-service-worker-client">服务工作线程客户端</dfn>，这是一个 <a data-link-type="dfn"
            href="#dfn-service-worker-client" id="ref-for-dfn-service-worker-client②①">服务工作线程客户端</a>，其 <a
            data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
            id="ref-for-concept-settings-object-global④">全局对象</a> 与从中检索 <code
            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/system-state.html#navigator" id="ref-for-navigator②">Navigator</a></code>
          对象或 <code
            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workernavigator" id="ref-for-workernavigator②">WorkerNavigator</a></code>
          对象关联。</p>
        <p><code
            class="idl"><a data-link-type="idl" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer⑧">ServiceWorkerContainer</a></code>
          对象具有一个关联的 <dfn class="dfn-paneled" data-dfn-for="ServiceWorkerContainer" data-dfn-type="dfn" data-noexport
            id="serviceworkercontainer-ready-promise">就绪承诺</dfn>（<a data-link-type="dfn"
            href="http://tc39.github.io/ecma262/#sec-promise-objects" id="ref-for-sec-promise-objects①">承诺</a> 或
          null），它最初为 null。</p>
        <p><code
            class="idl"><a data-link-type="idl" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer⑨">ServiceWorkerContainer</a></code>
          对象有一个称为 <dfn class="dfn-paneled" data-dfn-for="ServiceWorkerContainer" data-dfn-type="dfn" data-export
            id="dfn-client-message-queue">客户端消息队列</dfn> 的 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#task-source"
            id="ref-for-task-source③">任务源</a>，最初为空。<a data-link-type="dfn" href="#dfn-client-message-queue"
            id="ref-for-dfn-client-message-queue">客户端消息队列</a> 可以启用或禁用，最初为禁用状态。当 <code
            class="idl"><a data-link-type="idl" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer①⓪">ServiceWorkerContainer</a></code>
          对象的 <a data-link-type="dfn" href="#dfn-client-message-queue"
            id="ref-for-dfn-client-message-queue①">客户端消息队列</a> 被启用时，<a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop" id="ref-for-event-loop⑤">事件循环</a>
          <em>必须</em> 将其用作其 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#task-source" id="ref-for-task-source④">任务源</a>
          之一。当 <code
            class="idl"><a data-link-type="idl" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer①①">ServiceWorkerContainer</a></code>
          对象的 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"
            id="ref-for-concept-relevant-global①">相关全局对象</a> 是一个 <code
            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window②">Window</a></code>
          对象时，所有在其 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
            id="ref-for-queue-a-task②">排队</a> 的 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" id="ref-for-concept-task②">任务</a>
          <em>必须</em> 与其 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
            id="ref-for-relevant-settings-object④">相关设置对象</a> 的 <a data-link-type="dfn">负责的文档</a> 关联。
        </p>

        <section class="algorithm" data-algorithm="navigator-service-worker-controller">
          <h4 class="heading settled" data-level="3.4.1" id="navigator-service-worker-controller"><span
              class="secno">3.4.1. </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkercontainer-controller" id="ref-for-dom-serviceworkercontainer-controller①">controller</a></code></span><a
              class="self-link" href="#navigator-service-worker-controller"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="This feature is in all current engines.">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer/controller"
                  title="The controller read-only property of the ServiceWorkerContainer interface returns a ServiceWorker object if its state is activating or activated (the same object returned by ServiceWorkerRegistration.active). This property returns null if the request is a force refresh (Shift + refresh) or if there is no active worker.">ServiceWorkerContainer/controller</a>
              </p>
              <p class="all-engines-text">In all current engines.</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerContainer" data-dfn-type="attribute"
              data-export id="dom-serviceworkercontainer-controller"><code>controller</code></dfn> 属性<em>必须</em>执行以下步骤：
          </p>
          <ol>
            <li data-md>
              <p>令 <var>client</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this⑤">this</a> 的 <a data-link-type="dfn"
                  href="#serviceworkercontainer-service-worker-client"
                  id="ref-for-serviceworkercontainer-service-worker-client">服务工作线程客户端</a>。</p>
            <li data-md>
              <p>如果 <var>client</var> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
                  id="ref-for-concept-environment-active-service-worker①⑧">活动的服务工作线程</a> 为 null，则返回 null。</p>
            <li data-md>
              <p>返回表示 <var>client</var> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
                  id="ref-for-concept-environment-active-service-worker①⑨">活动的服务工作线程</a> 的服务工作线程对象，该对象是在 <a
                  data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑥">this</a> 的 <a
                  data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                  id="ref-for-relevant-settings-object⑤">相关设置对象</a>中获取的。</p>
          </ol>
          <p class="note" role="note"><span>注意：</span><code
              class="idl"><a data-link-type="idl" href="#dom-serviceworkercontainer-controller" id="ref-for-dom-serviceworkercontainer-controller②">navigator.serviceWorker.controller</a></code>
            在强制刷新（shift+refresh）时返回 <code>null</code>。</p>
        </section>
        <section class="algorithm" data-algorithm="navigator-service-worker-ready">
          <h4 class="heading settled" data-level="3.4.2" id="navigator-service-worker-ready"><span class="secno">3.4.2.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkercontainer-ready" id="ref-for-dom-serviceworkercontainer-ready①">ready</a></code></span><a
              class="self-link" href="#navigator-service-worker-ready"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="This feature is in all current engines.">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer/ready"
                  title="The ready read-only property of the ServiceWorkerContainer interface provides a way of delaying code execution until a service worker is active. It returns a Promise that will never reject, and which waits indefinitely until the ServiceWorkerRegistration associated with the current page has an active worker. Once that condition is met, it resolves with the ServiceWorkerRegistration.">ServiceWorkerContainer/ready</a>
              </p>
              <p class="all-engines-text">In all current engines.</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerContainer" data-dfn-type="attribute"
              data-export id="dom-serviceworkercontainer-ready"><code>ready</code></dfn> 属性<em>必须</em>执行以下步骤：</p>
          <ol>
            <li data-md>
              <p>如果 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑦">this</a> 的 <a
                  data-link-type="dfn" href="#serviceworkercontainer-ready-promise"
                  id="ref-for-serviceworkercontainer-ready-promise">就绪承诺</a> 为 null，则将 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑧">this</a> 的 <a data-link-type="dfn"
                  href="#serviceworkercontainer-ready-promise"
                  id="ref-for-serviceworkercontainer-ready-promise①">就绪承诺</a> 设置为 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#a-new-promise" id="ref-for-a-new-promise①">一个新的承诺</a>。</p>
            <li data-md>
              <p>令 <var>readyPromise</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this⑨">this</a> 的 <a data-link-type="dfn" href="#serviceworkercontainer-ready-promise"
                  id="ref-for-serviceworkercontainer-ready-promise②">就绪承诺</a>。</p>
            <li data-md>
              <p>如果 <var>readyPromise</var> 正在等待，则并行执行以下子步骤：</p>
              <ol>
                <li data-md>
                  <p>令 <var>client</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                      id="ref-for-this①⓪">this</a> 的 <a data-link-type="dfn"
                      href="#serviceworkercontainer-service-worker-client"
                      id="ref-for-serviceworkercontainer-service-worker-client①">服务工作线程客户端</a>。</p>
                <li data-md>
                  <p>令 <var>storage key</var> 为运行 <a data-link-type="dfn"
                      href="https://storage.spec.whatwg.org/#obtain-a-storage-key"
                      id="ref-for-obtain-a-storage-key">获取存储密钥</a> 的结果，参数为 client。</p>
                <li data-md>
                  <p>令 <var>registration</var> 为运行 <a data-link-type="dfn" href="#match-service-worker-registration"
                      id="ref-for-match-service-worker-registration③">匹配服务工作线程注册</a> 的结果，参数为 <var>storage key</var> 和
                    <var>client</var> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url"
                      id="ref-for-concept-environment-creation-url①">创建 URL</a>。
                  </p>
                <li data-md>
                  <p>如果 <var>registration</var> 不为 null 且 <var>registration</var> 的 <a data-link-type="dfn"
                      href="#dfn-active-worker" id="ref-for-dfn-active-worker⑨">活动工作线程</a> 不为 null，则在
                    <var>readyPromise</var> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                      id="ref-for-relevant-settings-object⑥">相关设置对象</a> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                      id="ref-for-responsible-event-loop">负责的事件循环</a>中使用 <a data-link-type="dfn">DOM 操作任务源</a> <a
                      data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                      id="ref-for-queue-a-task③">排队任务</a>，并用获取表示 <var>registration</var> 的服务工作线程注册对象的结果来解决
                    <var>readyPromise</var>。
                  </p>
              </ol>
            <li data-md>
              <p>返回 <var>readyPromise</var>。</p>
          </ol>
          <p class="note" role="note"><span>注意：</span>返回的 <a data-link-type="dfn"
              href="#serviceworkercontainer-ready-promise" id="ref-for-serviceworkercontainer-ready-promise③">就绪承诺</a>
            永远不会被拒绝。如果在此算法中未解决，它将在匹配的 <a data-link-type="dfn" href="#dfn-service-worker-registration"
              id="ref-for-dfn-service-worker-registration③⑤">服务工作线程注册</a> 注册并设置其 <a data-link-type="dfn"
              href="#dfn-active-worker" id="ref-for-dfn-active-worker①⓪">活动工作线程</a> 时最终解决。（参见相关的<a
              href="#activate-resolve-ready-step">激活算法步骤</a>。）</p>
        </section>
        <section class="algorithm" data-algorithm="navigator-service-worker-register">
          <h4 class="heading settled" data-level="3.4.3" id="navigator-service-worker-register"><span
              class="secno">3.4.3. </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkercontainer-register" id="ref-for-dom-serviceworkercontainer-register①">register(scriptURL, options)</a></code></span><a
              class="self-link" href="#navigator-service-worker-register"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="This feature is in all current engines.">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer/register"
                  title="The register() method of the ServiceWorkerContainer interface creates or updates a ServiceWorkerRegistration for the given scriptURL.">ServiceWorkerContainer/register</a>
              </p>
              <p class="all-engines-text">In all current engines.</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p class="note" role="note"><span>注意：</span><code
              class="idl"><a data-link-type="idl" href="#dom-serviceworkercontainer-register" id="ref-for-dom-serviceworkercontainer-register②">register(scriptURL, options)</a></code>
            方法为给定的 <a data-link-type="dfn" href="#dfn-scope-url" id="ref-for-dfn-scope-url⑧">范围 URL</a> 创建或更新 <a
              data-link-type="dfn" href="#dfn-service-worker-registration"
              id="ref-for-dfn-service-worker-registration③⑥">服务工作线程注册</a>。如果成功，<a data-link-type="dfn"
              href="#dfn-service-worker-registration" id="ref-for-dfn-service-worker-registration③⑦">服务工作线程注册</a> 会将提供的
            <var>scriptURL</var> 绑定到 <a data-link-type="dfn" href="#dfn-scope-url" id="ref-for-dfn-scope-url⑨">范围
              URL</a>，该 URL 随后用于 <a data-link-type="dfn" href="#handle-fetch" id="ref-for-handle-fetch①">导航匹配</a>。
          </p>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerContainer" data-dfn-type="method" data-export
              data-lt="register(scriptURL, options)|register(scriptURL)"
              id="dom-serviceworkercontainer-register"><code>register(<var>scriptURL</var>, <var>options</var>)</code></dfn>
            方法步骤如下：</p>
          <ol>
            <li data-md>
              <p>令 <var>p</var> 为 <a data-link-type="dfn" href="http://tc39.github.io/ecma262/#sec-promise-objects"
                  id="ref-for-sec-promise-objects②">承诺</a>。</p>
            <li data-md>
              <p>令 <var>client</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this①①">this</a> 的 <a data-link-type="dfn"
                  href="#serviceworkercontainer-service-worker-client"
                  id="ref-for-serviceworkercontainer-service-worker-client②">服务工作线程客户端</a>。</p>
            <li data-md>
              <p>令 <var>scriptURL</var> 为使用 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this①②">this</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                  id="ref-for-relevant-settings-object⑧">相关设置对象</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url"
                  id="ref-for-api-base-url">API 基本 URL</a> 解析 <var>scriptURL</var> 的结果。</p>
            <li data-md>
              <p>令 <var>scopeURL</var> 为 null。</p>
            <li data-md>
              <p>如果 <var>options</var>["<code
                  class="idl"><a data-link-type="idl" href="#dom-registrationoptions-scope" id="ref-for-dom-registrationoptions-scope">scope</a></code>"]
                <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists"
                  id="ref-for-map-exists②">存在</a>，则将 <var>scopeURL</var> 设置为使用 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①③">this</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                  id="ref-for-relevant-settings-object⑨">相关设置对象</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url"
                  id="ref-for-api-base-url①">API 基本 URL</a> 解析 <var>options</var>["<code
                  class="idl"><a data-link-type="idl" href="#dom-registrationoptions-scope" id="ref-for-dom-registrationoptions-scope①">scope</a></code>"]
                的结果。
              </p>
            <li data-md>
              <p>使用 <var>scopeURL</var>、<var>scriptURL</var>、<var>p</var>、<var>client</var>、<var>client</var> 的 <a
                  data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url"
                  id="ref-for-concept-environment-creation-url②">创建 URL</a>、<var>options</var>["<code
                  class="idl"><a data-link-type="idl" href="#dom-registrationoptions-type" id="ref-for-dom-registrationoptions-type">type</a></code>"]
                和 <var>options</var>["<code
                  class="idl"><a data-link-type="idl" href="#dom-registrationoptions-updateviacache" id="ref-for-dom-registrationoptions-updateviacache">updateViaCache</a></code>"]
                调用 <a data-link-type="dfn" href="#start-register" id="ref-for-start-register">开始注册</a>。</p>
            <li data-md>
              <p>返回 <var>p</var>。</p>
          </ol>
        </section>

        <section class="algorithm" data-algorithm="navigator-service-worker-getRegistration">
          <h4 class="heading settled" data-level="3.4.4" id="navigator-service-worker-getRegistration">
            <span class="secno">3.4.4. </span>
            <span class="content">
              <code class="idl">
                <a data-link-type="idl" href="#dom-serviceworkercontainer-getregistration" id="ref-for-dom-serviceworkercontainer-getregistration①">
                  getRegistration(clientURL)
                </a>
              </code>
            </span>
            <a class="self-link" href="#navigator-service-worker-getRegistration"></a>
          </h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn">
              <b class="all-engines-flag" title="此功能在所有当前引擎中。">✔</b>
              <span>MDN</span>
            </button>
            <div class="feature">
              <p>
                <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer/getRegistration"
                  title="ServiceWorkerContainer 接口的 getRegistration() 方法获取与提供的 client URL 匹配的作用域 URL 的 ServiceWorkerRegistration 对象。该方法返回一个 Promise 对象，该 Promise 对象解析为一个 ServiceWorkerRegistration 对象或 undefined。">
                  ServiceWorkerContainer/getRegistration
                </a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
                <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
                <span class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span>
                <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>17+</span></span>
                <span class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
                <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
                <span class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span>
                <span class="webview_android yes"><span>Android WebView</span><span>40+</span></span>
                <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span>
                <span class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p>
            <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerContainer" data-dfn-type="method" data-export
              data-lt="getRegistration(clientURL)|getRegistration()" id="dom-serviceworkercontainer-getregistration">
              <code>getRegistration(<var>clientURL</var>)</code>
            </dfn>
            方法步骤如下：
          </p>
          <ol>
            <li data-md>
              <p>
                让 <var>client</var> 成为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this①④">this</a> 的 <a data-link-type="dfn"
                  href="#serviceworkercontainer-service-worker-client"
                  id="ref-for-serviceworkercontainer-service-worker-client③">service worker 客户端</a>。
              </p>
            </li>
            <li data-md>
              <p>
                让 <var>storage key</var> 成为通过运行 <a data-link-type="dfn"
                  href="https://storage.spec.whatwg.org/#obtain-a-storage-key"
                  id="ref-for-obtain-a-storage-key①">获取存储密钥</a> 给定 <var>client</var> 的结果。
              </p>
            </li>
            <li data-md>
              <p>
                让 <var>clientURL</var> 成为通过 <a data-link-type="dfn"
                  href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser②">解析</a>
                <var>clientURL</var> 并结合 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this①⑤">this</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                  id="ref-for-relevant-settings-object①⓪">相关设置对象</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url"
                  id="ref-for-api-base-url②">API 基础 URL</a> 解析的结果。
              </p>
            </li>
            <li data-md>
              <p>
                如果 <var>clientURL</var> 解析失败，则返回一个 <a data-link-type="dfn"
                  href="http://tc39.github.io/ecma262/#sec-promise-objects"
                  id="ref-for-sec-promise-objects③">Promise</a>，其被拒绝并带有 <code>TypeError</code>。
              </p>
            </li>
            <li data-md>
              <p>
                将 <var>clientURL</var> 的 <a data-link-type="dfn"
                  href="https://url.spec.whatwg.org/#concept-url-fragment" id="ref-for-concept-url-fragment">片段</a>设置为
                null。
              </p>
            </li>
            <li data-md>
              <p>
                如果 <var>clientURL</var> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                  id="ref-for-concept-settings-object-origin②">来源</a> 不是 <var>client</var> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                  id="ref-for-concept-settings-object-origin③">来源</a>，则返回一个被拒绝的 <var>promise</var>，并带有 "<code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#securityerror" id="ref-for-securityerror">SecurityError</a></code>"
                <code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException②">DOMException</a></code>。
              </p>
            </li>
            <li data-md>
              <p>创建一个新的 <var>promise</var>。</p>
            </li>
            <li data-md>
              <p>并行运行以下子步骤：</p>
              <ol>
                <li data-md>
                  <p>让 <var>registration</var> 成为通过运行 <a data-link-type="dfn" href="#match-service-worker-registration"
                      id="ref-for-match-service-worker-registration④">匹配 Service Worker 注册</a> 给定 <var>storage key</var>
                    和 <var>clientURL</var> 的结果。</p>
                </li>
                <li data-md>
                  <p>如果 <var>registration</var> 为 null，则用 undefined 解析 <var>promise</var>，并中止这些步骤。</p>
                </li>
                <li data-md>
                  <p>使用 <var>registration</var> 的 Service Worker 注册对象解析 <var>promise</var>。</p>
                </li>
              </ol>
            </li>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
            </li>
          </ol>
        </section>

        <section class="algorithm" data-algorithm="navigator-service-worker-getRegistrations">
          <h4 class="heading settled" data-level="3.4.5" id="navigator-service-worker-getRegistrations">
            <span class="secno">3.4.5. </span>
            <span class="content">
              <code class="idl">
                <a data-link-type="idl" href="#dom-serviceworkercontainer-getregistrations" id="ref-for-dom-serviceworkercontainer-getregistrations①">
                  getRegistrations()
                </a>
              </code>
            </span>
            <a class="self-link" href="#navigator-service-worker-getRegistrations"></a>
          </h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn">
              <b class="all-engines-flag" title="此功能在所有当前引擎中。">✔</b>
              <span>MDN</span>
            </button>
            <div class="feature">
              <p>
                <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer/getRegistrations"
                  title="ServiceWorkerContainer 接口的 getRegistrations() 方法获取与 ServiceWorkerContainer 关联的所有 ServiceWorkerRegistrations，并以数组形式返回。该方法返回一个解析为 ServiceWorkerRegistration 数组的 Promise。">
                  ServiceWorkerContainer/getRegistrations
                </a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
                <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
                <span class="chrome yes"><span>Chrome</span><span>45+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span>
                <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>17+</span></span>
                <span class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
                <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
                <span class="chrome_android yes"><span>Chrome for Android</span><span>45+</span></span>
                <span class="webview_android yes"><span>Android WebView</span><span>40+</span></span>
                <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span>
                <span class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p>
            <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerContainer" data-dfn-type="method" data-export
              id="dom-serviceworkercontainer-getregistrations">
              <code>getRegistrations()</code>
            </dfn>
            方法步骤如下：
          </p>
          <ol>
            <li data-md>
              <p>
                让 <var>client</var> 成为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this①⑥">this</a> 的 <a data-link-type="dfn"
                  href="#serviceworkercontainer-service-worker-client"
                  id="ref-for-serviceworkercontainer-service-worker-client④">service worker 客户端</a>。
              </p>
            </li>
            <li data-md>
              <p>
                让 <var>client storage key</var> 成为通过运行 <a data-link-type="dfn"
                  href="https://storage.spec.whatwg.org/#obtain-a-storage-key"
                  id="ref-for-obtain-a-storage-key②">获取存储密钥</a> 给定 <var>client</var> 的结果。
              </p>
            </li>
            <li data-md>
              <p>创建一个新的 <var>promise</var>。</p>
            </li>
            <li data-md>
              <p>并行运行以下步骤：</p>
              <ol>
                <li data-md>
                  <p>创建一个新的 <var>registrations</var> 列表。</p>
                </li>
                <li data-md>
                  <p>遍历 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate"
                      id="ref-for-map-iterate">每个</a> (<var>storage key</var>, <var>scope</var>) →
                    <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-scope-to-registration-map"
                      id="ref-for-dfn-scope-to-registration-map②">注册映射</a>:
                  </p>
                  <ol>
                    <li data-md>
                      <p>如果 <var>storage key</var> <a data-link-type="dfn"
                          href="https://storage.spec.whatwg.org/#storage-key-equal"
                          id="ref-for-storage-key-equal">等于</a> <var>client storage key</var>，则将 <var>registration</var>
                        追加到 <var>registrations</var> 列表。</p>
                    </li>
                  </ol>
                </li>
                <li data-md>
                  <p>在 <var>promise</var> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                      id="ref-for-responsible-event-loop①">负责的事件循环</a> 中，使用 <a data-link-type="dfn">DOM
                      操作任务源</a>来运行以下步骤：</p>
                  <ol>
                    <li data-md>
                      <p>创建一个新的 <var>registrationObjects</var> 列表。</p>
                    </li>
                    <li data-md>
                      <p>遍历 <var>registrations</var> 列表中的每个 <var>registration</var>:</p>
                      <ol>
                        <li data-md>
                          <p>让 <var>registrationObj</var> 成为通过 <a data-link-type="dfn"
                              href="#get-the-service-worker-registration-object"
                              id="ref-for-get-the-service-worker-registration-object②">获取 Service Worker 注册对象</a>的结果，并在
                            <var>promise</var> 的 <a data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                              id="ref-for-relevant-settings-object①③">相关设置对象</a> 中表示 <var>registration</var>。
                          </p>
                        </li>
                        <li data-md>
                          <p>将 <var>registrationObj</var> 追加到 <var>registrationObjects</var> 列表。</p>
                        </li>
                      </ol>
                    </li>
                    <li data-md>
                      <p>使用 <var>registrationObjects</var> 的新冻结数组解析 <var>promise</var>。</p>
                    </li>
                  </ol>
                </li>
              </ol>
            </li>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
            </li>
          </ol>
        </section>

        <section class="algorithm" data-algorithm="navigator-service-worker-startMessages">
          <h4 class="heading settled" data-level="3.4.6" id="navigator-service-worker-startMessages">
            <span class="secno">3.4.6. </span>
            <span class="content">
              <code class="idl">
                <a data-link-type="idl" href="#dom-serviceworkercontainer-startmessages" id="ref-for-dom-serviceworkercontainer-startmessages①">
                  startMessages()
                </a>
              </code>
            </span>
            <a class="self-link" href="#navigator-service-worker-startMessages"></a>
          </h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn">
              <b class="all-engines-flag" title="此功能在所有当前引擎中。">✔</b>
              <span>MDN</span>
            </button>
            <div class="feature">
              <p>
                <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer/startMessages"
                  title="ServiceWorkerContainer 接口的 startMessages() 方法显式启动从 service worker 发送到其控制下页面的消息流（例如通过 Client.postMessage() 发送的消息）。这可以用于更早地响应发送的消息，即使该页面的内容尚未加载完成。">
                  ServiceWorkerContainer/startMessages
                </a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>64+</span></span>
                <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
                <span class="chrome yes"><span>Chrome</span><span>74+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>62+</span></span>
                <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge no"><span>Edge (旧版)</span><span>无</span></span>
                <span class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>64+</span></span>
                <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
                <span class="chrome_android yes"><span>Chrome for Android</span><span>74+</span></span>
                <span class="webview_android yes"><span>Android WebView</span><span>74+</span></span>
                <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>11.0+</span></span>
                <span class="opera_android yes"><span>Opera Mobile</span><span>50+</span></span>
              </div>
            </div>
          </div>
          <p>
            <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerContainer" data-dfn-type="method" data-export
              id="dom-serviceworkercontainer-startmessages">
              <code>startMessages()</code>
            </dfn>
            方法步骤是：如果 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①⑦">this</a> 的
            <a data-link-type="dfn" href="#dfn-client-message-queue" id="ref-for-dfn-client-message-queue③">客户端消息队列</a>
            尚未启用，则启用它。
          </p>
        </section>

        <section>
          <h4 class="heading settled" data-level="3.4.7" id="service-worker-container-event-handlers">
            <span class="secno">3.4.7. </span>
            <span class="content">事件处理程序</span>
            <a class="self-link" href="#service-worker-container-event-handlers"></a>
          </h4>
          <p>
            以下是 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers"
              id="ref-for-event-handlers④">事件处理程序</a>（及其对应的 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type"
              id="ref-for-event-handler-event-type④">事件处理程序事件类型</a>），它们 <em>必须</em> 被所有实现 <code class="idl">
            <a data-link-type="idl" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer①②">ServiceWorkerContainer</a></code>
            接口的对象支持，作为 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes"
              id="ref-for-event-handler-idl-attributes②">事件处理程序 IDL 属性</a>:
          </p>
          <table class="data">
            <thead>
              <tr>
                <th>
                  <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers"
                    id="ref-for-event-handlers⑤">事件处理程序</a>
                <th>
                  <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type"
                    id="ref-for-event-handler-event-type⑤">事件处理程序事件类型</a>
            <tbody>
              <tr>
                <td>
                  <div class="mdn-anno wrapped">
                    <button class="mdn-anno-btn">
                      <b class="all-engines-flag" title="此功能在所有当前引擎中。">✔</b>
                      <span>MDN</span>
                    </button>
                    <div class="feature">
                      <p>
                        <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer/controllerchange_event"
                          title="ServiceWorkerContainer 接口的 controllerchange 事件在文档的关联 ServiceWorkerRegistration 获取新活动 worker 时触发。">
                          ServiceWorkerContainer/controllerchange_event
                        </a>
                      </p>
                      <p class="all-engines-text">在所有当前引擎中。</p>
                      <div class="support">
                        <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
                        <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
                        <span class="chrome yes"><span>Chrome</span><span>40+</span></span>
                        <hr>
                        <span class="opera yes"><span>Opera</span><span>27+</span></span>
                        <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                        <hr>
                        <span class="edge yes"><span>Edge (旧版)</span><span>17+</span></span>
                        <span class="ie no"><span>IE</span><span>无</span></span>
                        <hr>
                        <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
                        <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
                        <span class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span>
                        <span class="webview_android yes"><span>Android WebView</span><span>40+</span></span>
                        <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span>
                        <span class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
                      </div>
                    </div>
                  </div>
                  <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerContainer" data-dfn-type="attribute"
                    data-export id="dom-serviceworkercontainer-oncontrollerchange">
                    <code>oncontrollerchange</code>
                  </dfn>
                <td>
                  <code class="idl">
                    <a class="idl-code" data-link-type="event" href="#service-worker-container-controllerchange-event" id="ref-for-service-worker-container-controllerchange-event">
                      controllerchange
                    </a>
                  </code>
              <tr>
                <td>
                  <div class="mdn-anno wrapped">
                    <button class="mdn-anno-btn">
                      <b class="all-engines-flag" title="此功能在所有当前引擎中。">✔</b>
                      <span>MDN</span>
                    </button>
                    <div class="feature">
                      <p>
                        <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer/message_event"
                          title="message 事件用于被 service worker 控制的页面接收来自 service worker 的消息。">
                          ServiceWorkerContainer/message_event
                        </a>
                      </p>
                      <p class="all-engines-text">在所有当前引擎中。</p>
                      <div class="support">
                        <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
                        <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
                        <span class="chrome yes"><span>Chrome</span><span>40+</span></span>
                        <hr>
                        <span class="opera yes"><span>Opera</span><span>27+</span></span>
                        <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                        <hr>
                        <span class="edge yes"><span>Edge (旧版)</span><span>17+</span></span>
                        <span class="ie no"><span>IE</span><span>无</span></span>
                        <hr>
                        <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
                        <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
                        <span class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span>
                        <span class="webview_android yes"><span>Android WebView</span><span>40+</span></span>
                        <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span>
                        <span class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
                      </div>
                    </div>
                  </div>
                  <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerContainer" data-dfn-type="attribute"
                    data-export id="dom-serviceworkercontainer-onmessage">
                    <code>onmessage</code>
                  </dfn>
                <td>
                  <code class="idl">
                    <a class="idl-code" data-link-type="event" href="#service-worker-container-message-event" id="ref-for-service-worker-container-message-event②">
                      message
                    </a>
                  </code>
              <tr>
                <td>
                  <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerContainer" data-dfn-type="attribute"
                    data-export id="dom-serviceworkercontainer-onmessageerror">
                    <code>onmessageerror</code>
                  </dfn>
                <td>
                  <code class="idl">
                    <a class="idl-code" data-link-type="event" href="#service-worker-container-messageerror-event" id="ref-for-service-worker-container-messageerror-event①">
                      messageerror
                    </a>
                  </code>
          </table>
          <p>
            第一次执行 <code class="idl">
            <a data-link-type="idl" href="#dom-serviceworkercontainer-onmessage" id="ref-for-dom-serviceworkercontainer-onmessage①">
              onmessage
            </a>
            </code> 设置程序步骤时，启用 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
              id="ref-for-this①⑧">this</a> 的 <a data-link-type="dfn" href="#dfn-client-message-queue"
              id="ref-for-dfn-client-message-queue④">客户端消息队列</a>。
          </p>
        </section>
      </section>
      <section>
        <h3 class="heading settled" data-level="3.5" id="document-context-events">
          <span class="secno">3.5. </span>
          <span class="content">事件</span>
          <a class="self-link" href="#document-context-events"></a>
        </h3>
        <p>以下事件会在 <code class="idl">
          <a data-link-type="idl" href="#serviceworker" id="ref-for-serviceworker①⑧">ServiceWorker</a></code> 对象上触发：</p>
        <table class="data">
          <thead>
            <tr>
              <th>事件名称</th>
              <th>接口</th>
              <th>触发时机</th>
          </thead>
          <tbody>
            <tr>
              <td>
                <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorker" data-dfn-type="event" data-export
                  id="eventdef-serviceworker-statechange">
                  <code>statechange</code>
                </dfn>
              </td>
              <td>
                <code class="idl">
                  <a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event">Event</a>
                </code>
              </td>
              <td>
                当 <code class="idl">
                <a data-link-type="idl" href="#dom-serviceworker-state" id="ref-for-dom-serviceworker-state③">state</a>
                </code> 属性的 <code class="idl">
                <a data-link-type="idl" href="#serviceworker" id="ref-for-serviceworker①⑨">ServiceWorker</a>
                </code> 对象发生变化时。
              </td>
            </tr>
          </tbody>
        </table>
        <p>以下事件会在 <code class="idl">
          <a data-link-type="idl" href="#serviceworkerregistration" id="ref-for-serviceworkerregistration①①">ServiceWorkerRegistration</a>
          </code> 对象上触发：</p>
        <table class="data">
          <thead>
            <tr>
              <th>事件名称</th>
              <th>接口</th>
              <th>触发时机</th>
          </thead>
          <tbody>
            <tr>
              <td>
                <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerRegistration" data-dfn-type="event"
                  data-export id="service-worker-registration-updatefound-event">
                  <code>updatefound</code>
                </dfn>
              </td>
              <td>
                <code class="idl">
                  <a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event①">Event</a>
                </code>
              </td>
              <td>
                当 <a data-link-type="dfn" href="#serviceworkerregistration-service-worker-registration"
                  id="ref-for-serviceworkerregistration-service-worker-registration⑦">service worker 注册</a> 的 <a
                  data-link-type="dfn" href="#dfn-installing-worker" id="ref-for-dfn-installing-worker⑤">installing
                  worker</a> 发生变化时。 (参见 <a data-link-type="dfn" href="#install" id="ref-for-install">安装</a> 算法的第 8 步。)
              </td>
            </tr>
          </tbody>
        </table>
        <p>以下事件会在 <code class="idl">
          <a data-link-type="idl" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer①③">ServiceWorkerContainer</a>
          </code> 对象上触发：</p>
        <table class="data">
          <thead>
            <tr>
              <th>事件名称</th>
              <th>接口</th>
              <th>触发时机</th>
          </thead>
          <tbody>
            <tr>
              <td>
                <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerContainer" data-dfn-type="event"
                  data-export id="service-worker-container-controllerchange-event">
                  <code>controllerchange</code>
                </dfn>
              </td>
              <td>
                <code class="idl">
                  <a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event②">Event</a>
                </code>
              </td>
              <td>
                当 <a data-link-type="dfn" href="#serviceworkercontainer-service-worker-client"
                  id="ref-for-serviceworkercontainer-service-worker-client⑤">service worker 客户端</a> 的 <a
                  data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
                  id="ref-for-concept-environment-active-service-worker②⓪">active service worker</a> 发生变化时。 (参见 <a
                  data-link-type="dfn" href="#activate" id="ref-for-activate">激活</a> 算法的第 9.2 步。<a data-link-type="dfn"
                  href="#dfn-skip-waiting-flag" id="ref-for-dfn-skip-waiting-flag">跳过等待标志</a> 的 <a data-link-type="dfn"
                  href="#dfn-service-worker" id="ref-for-dfn-service-worker⑤③">service worker</a> 导致 <a
                  data-link-type="dfn" href="#activate" id="ref-for-activate①">激活</a> 的 <a data-link-type="dfn"
                  href="#dfn-service-worker-registration" id="ref-for-dfn-service-worker-registration③⑧">service worker
                  注册</a> 在 <a data-link-type="dfn" href="#dfn-service-worker-client"
                  id="ref-for-dfn-service-worker-client②②">service worker 客户端</a> 正在 <a data-link-type="dfn"
                  href="#dfn-use" id="ref-for-dfn-use">使用</a> <a data-link-type="dfn"
                  href="#dfn-service-worker-registration" id="ref-for-dfn-service-worker-registration③⑨">service worker
                  注册</a> 时发生变化，<code class="idl">
                <a data-link-type="idl" href="#dom-serviceworkercontainer-controller" id="ref-for-dom-serviceworkercontainer-controller③">navigator.serviceWorker.controller</a>
                </code> 立即反映 <a data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker①①">active
                  worker</a> 作为控制 <a data-link-type="dfn" href="#dfn-service-worker-client"
                  id="ref-for-dfn-service-worker-client②③">service worker 客户端</a> 的 <a data-link-type="dfn"
                  href="#dfn-service-worker" id="ref-for-dfn-service-worker⑤④">service worker</a>。
              </td>
            </tr>
            <tr>
              <td>
                <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerContainer" data-dfn-type="event"
                  data-export id="service-worker-container-message-event">
                  <code>message</code>
                </dfn>
              </td>
              <td>
                <code class="idl">
                  <a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event③">Event</a>
                </code>
              </td>
              <td>
                当 <a data-link-type="dfn" href="#serviceworkercontainer-service-worker-client"
                  id="ref-for-serviceworkercontainer-service-worker-client⑥">service worker 客户端</a> 从 <a
                  data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑤⑤">service worker</a>
                接收到消息时。参见 <code class="idl">
                <a data-link-type="idl" href="#dom-client-postmessage-message-options" id="ref-for-dom-client-postmessage-message-options">postMessage(message, options)</a>
                </code>。
              </td>
            </tr>
            <tr>
              <td>
                <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerContainer" data-dfn-type="event"
                  data-export id="service-worker-container-messageerror-event">
                  <code>messageerror</code>
                </dfn>
              </td>
              <td>
                <code class="idl">
                  <a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event④">Event</a>
                </code>
              </td>
              <td>
                当 <a data-link-type="dfn" href="#serviceworkercontainer-service-worker-client"
                  id="ref-for-serviceworkercontainer-service-worker-client⑦">service worker 客户端</a> 从 <a
                  data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑤⑥">service worker</a>
                接收到无法反序列化的消息时。参见 <code class="idl">
                <a data-link-type="idl" href="#dom-client-postmessage-message-options" id="ref-for-dom-client-postmessage-message-options①">postMessage(message, options)</a>
                </code>。
              </td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
    <section>
      <h3 class="heading settled" data-level="3.6" id="navigation-preload-manager">
        <span class="secno">3.6. </span>
        <span class="content">
          <code class="idl">
            <a data-link-type="idl" href="#navigationpreloadmanager" id="ref-for-navigationpreloadmanager③">NavigationPreloadManager</a>
          </code>
        </span>
        <a class="self-link" href="#navigation-preload-manager"></a>
      </h3>
      <div class="mdn-anno wrapped after">
        <button class="mdn-anno-btn">
          <b class="all-engines-flag" title="所有当前引擎均支持此功能">✔</b><span>MDN</span>
        </button>
        <div class="feature">
          <p>
            <a href="https://developer.mozilla.org/en-US/docs/Web/API/NavigationPreloadManager"
              title="Service Worker API 的 NavigationPreloadManager 接口提供了用于管理与 service worker 启动并行预加载资源的方法。">
              NavigationPreloadManager
            </a>
          </p>
          <p class="all-engines-text">所有当前引擎均支持此功能。</p>
          <div class="support">
            <span class="firefox yes"><span>Firefox</span><span>99+</span></span>
            <span class="safari yes"><span>Safari</span><span>15.4+</span></span>
            <span class="chrome yes"><span>Chrome</span><span>59+</span></span>
            <hr>
            <span class="opera yes"><span>Opera</span><span>46+</span></span>
            <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
            <hr>
            <span class="edge yes"><span>Edge (Legacy)</span><span>18</span></span>
            <span class="ie no"><span>IE</span><span>无支持</span></span>
            <hr>
            <span class="firefox_android yes"><span>Firefox for Android</span><span>99+</span></span>
            <span class="safari_ios yes"><span>iOS Safari</span><span>15.4+</span></span>
            <span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span>
            <span class="webview_android yes"><span>Android WebView</span><span>59+</span></span>
            <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span>
            <span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
          </div>
        </div>
      </div>
      <pre class="idl highlight def">
    [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext⑤">SecureContext</a>, 
    <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed③">Exposed</a>=(<c- n>Window</c->,<c- n>Worker</c->)]
    <c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="navigationpreloadmanager"><code><c- g>NavigationPreloadManager</c-></code></dfn> {
      <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise⑥"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined⑤"><c- b>undefined</c-></a>> 
      <a class="idl-code" data-link-type="method" href="#dom-navigationpreloadmanager-enable" id="ref-for-dom-navigationpreloadmanager-enable"><c- g>enable</c-></a>();
      <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise⑦"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined⑥"><c- b>undefined</c-></a>> 
      <a class="idl-code" data-link-type="method" href="#dom-navigationpreloadmanager-disable" id="ref-for-dom-navigationpreloadmanager-disable"><c- g>disable</c-></a>();
      <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise⑧"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-navigationpreloadstate" id="ref-for-dictdef-navigationpreloadstate"><c- n>NavigationPreloadState</c-></a>> 
      <a class="idl-code" data-link-type="method" href="#dom-navigationpreloadmanager-getstate" id="ref-for-dom-navigationpreloadmanager-getstate"><c- g>getState</c-></a>();
    };
    <c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-navigationpreloadstate"><code><c- g>NavigationPreloadState</c-></code></dfn> {
      <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean①"><c- b>boolean</c-></a> 
      <dfn class="dfn-paneled idl-code" data-default="false" data-dfn-for="NavigationPreloadState" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-navigationpreloadstate-enabled"><code><c- g>enabled</c-></code></dfn> = <c- b>false</c->;
      <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-ByteString" id="ref-for-idl-ByteString①"><c- b>ByteString</c-></a> 
      <dfn class="dfn-paneled idl-code" data-dfn-for="NavigationPreloadState" data-dfn-type="dict-member" data-export data-type="ByteString " id="dom-navigationpreloadstate-headervalue"><code><c- g>headerValue</c-></code></dfn>;
    };
    </pre>
      <section class="algorithm" data-algorithm="navigation-preload-manager-enable">
        <h4 class="heading settled" data-level="3.6.1" id="navigation-preload-manager-enable">
          <span class="secno">3.6.1. </span>
          <span class="content">
            <code class="idl">
              <a data-link-type="idl" href="#dom-navigationpreloadmanager-enable" id="ref-for-dom-navigationpreloadmanager-enable①">enable()</a>
            </code>
          </span>
          <a class="self-link" href="#navigation-preload-manager-enable"></a>
        </h4>
        <div class="mdn-anno wrapped">
          <button class="mdn-anno-btn">
            <b class="all-engines-flag" title="所有当前引擎均支持此功能">✔</b><span>MDN</span>
          </button>
          <div class="feature">
            <p>
              <a href="https://developer.mozilla.org/en-US/docs/Web/API/NavigationPreloadManager/enable"
                title="NavigationPreloadManager 接口的 enable() 方法用于启用由 service worker 管理的资源的预加载。它返回一个 promise，该 promise 会解析为 undefined。">
                NavigationPreloadManager/enable
              </a>
            </p>
            <p class="all-engines-text">所有当前引擎均支持此功能。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>99+</span></span>
              <span class="safari yes"><span>Safari</span><span>15.4+</span></span>
              <span class="chrome yes"><span>Chrome</span><span>59+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>46+</span></span>
              <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (Legacy)</span><span>18</span></span>
              <span class="ie no"><span>IE</span><span>无支持</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>99+</span></span>
              <span class="safari_ios yes"><span>iOS Safari</span><span>15.4+</span></span>
              <span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span>
              <span class="webview_android yes"><span>Android WebView</span><span>59+</span></span>
              <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span>
              <span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
            </div>
          </div>
        </div>
        <p>
          <dfn class="dfn-paneled idl-code" data-dfn-for="NavigationPreloadManager" data-dfn-type="method" data-export
            id="dom-navigationpreloadmanager-enable">
            <code>enable()</code>
          </dfn>
          方法步骤如下：
        </p>
        <ol>
          <li data-md>
            <p>让 <var>promise</var> 成为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                id="ref-for-a-new-promise③">一个新的 promise</a>。</p>
          <li data-md>
            <p>并行运行以下步骤：</p>
          <li data-md>
            <p>让 <var>registration</var> 成为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                id="ref-for-this①⑨">this</a> 的关联
              <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration④⓪">service worker registration</a>。
            </p>
          <li data-md>
            <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                id="ref-for-dfn-active-worker①②">active worker</a> 为 null，
              <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject">拒绝</a>
              <var>promise</var>，返回一个
              "<code
                class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror②">InvalidStateError</a></code>"
              <code
                class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException③">DOMException</a></code>，并中止这些步骤。
            </p>
          <li data-md>
            <p>设置 <var>registration</var> 的
              <a data-link-type="dfn" href="#service-worker-registration-navigation-preload-enabled-flag"
                id="ref-for-service-worker-registration-navigation-preload-enabled-flag">navigation preload enabled
                标志</a>。
            </p>
          <li data-md>
            <p>以 undefined 解析 <var>promise</var>。</p>
          <li data-md>
            <p>返回 <var>promise</var>。</p>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="navigation-preload-manager-disable">
        <h4 class="heading settled" data-level="3.6.2" id="navigation-preload-manager-disable">
          <span class="secno">3.6.2. </span>
          <span class="content">
            <code class="idl">
              <a data-link-type="idl" href="#dom-navigationpreloadmanager-disable" id="ref-for-dom-navigationpreloadmanager-disable①">disable()</a>
            </code>
          </span>
          <a class="self-link" href="#navigation-preload-manager-disable"></a>
        </h4>
        <div class="mdn-anno wrapped">
          <button class="mdn-anno-btn">
            <b class="all-engines-flag" title="所有当前引擎均支持此功能">✔</b><span>MDN</span>
          </button>
          <div class="feature">
            <p>
              <a href="https://developer.mozilla.org/en-US/docs/Web/API/NavigationPreloadManager/disable"
                title="NavigationPreloadManager 接口的 disable() 方法停止由 enable() 启动的 service worker 管理的资源的自动预加载。它返回一个 promise，该 promise 会解析为 undefined。">
                NavigationPreloadManager/disable
              </a>
            </p>
            <p class="all-engines-text">所有当前引擎均支持此功能。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>99+</span></span>
              <span class="safari yes"><span>Safari</span><span>15.4+</span></span>
              <span class="chrome yes"><span>Chrome</span><span>59+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>46+</span></span>
              <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (Legacy)</span><span>18</span></span>
              <span class="ie no"><span>IE</span><span>无支持</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>99+</span></span>
              <span class="safari_ios yes"><span>iOS Safari</span><span>15.4+</span></span>
              <span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span>
              <span class="webview_android yes"><span>Android WebView</span><span>59+</span></span>
              <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span>
              <span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
            </div>
          </div>
        </div>
        <p>
          <dfn class="dfn-paneled idl-code" data-dfn-for="NavigationPreloadManager" data-dfn-type="method" data-export
            id="dom-navigationpreloadmanager-disable">
            <code>disable()</code>
          </dfn>
          方法步骤如下：
        </p>
        <ol>
          <li data-md>
            <p>让 <var>promise</var> 成为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                id="ref-for-a-new-promise④">一个新的 promise</a>。</p>
          <li data-md>
            <p>并行运行以下步骤：</p>
          <li data-md>
            <p>让 <var>registration</var> 成为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                id="ref-for-this②⓪">this</a> 的关联
              <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration④①">service worker registration</a>。
            </p>
          <li data-md>
            <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                id="ref-for-dfn-active-worker①③">active worker</a> 为 null，
              <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject①">拒绝</a>
              <var>promise</var>，返回一个
              "<code
                class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror③">InvalidStateError</a></code>"
              <code
                class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException④">DOMException</a></code>，并中止这些步骤。
            </p>
          <li data-md>
            <p>取消设置 <var>registration</var> 的
              <a data-link-type="dfn" href="#service-worker-registration-navigation-preload-enabled-flag"
                id="ref-for-service-worker-registration-navigation-preload-enabled-flag①">navigation preload enabled
                标志</a>。
            </p>
          <li data-md>
            <p>以 undefined 解析 <var>promise</var>。</p>
          <li data-md>
            <p>返回 <var>promise</var>。</p>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="navigation-preload-manager-setheadervalue">
        <h4 class="heading settled" data-level="3.6.3" id="navigation-preload-manager-setheadervalue">
          <span class="secno">3.6.3. </span>
          <span class="content">
            <code class="idl">
              <a data-link-type="idl" href="#dom-navigationpreloadmanager-setheadervalue" id="ref-for-dom-navigationpreloadmanager-setheadervalue①">setHeaderValue(value)</a>
            </code>
          </span>
          <a class="self-link" href="#navigation-preload-manager-setheadervalue"></a>
        </h4>
        <div class="mdn-anno wrapped">
          <button class="mdn-anno-btn">
            <b class="all-engines-flag" title="所有当前引擎均支持此功能">✔</b><span>MDN</span>
          </button>
          <div class="feature">
            <p>
              <a href="https://developer.mozilla.org/en-US/docs/Web/API/NavigationPreloadManager/setHeaderValue"
                title="NavigationPreloadManager 接口的 setHeaderValue() 方法设置在 service worker 导航预加载期间通过 fetch() 操作产生的请求中将发送的 Service-Worker-Navigation-Preload 头的值。它返回一个解析为 undefined 的空 Promise。">
                NavigationPreloadManager/setHeaderValue
              </a>
            </p>
            <p class="all-engines-text">所有当前引擎均支持此功能。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>99+</span></span>
              <span class="safari yes"><span>Safari</span><span>15.4+</span></span>
              <span class="chrome yes"><span>Chrome</span><span>59+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>46+</span></span>
              <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (Legacy)</span><span>18</span></span>
              <span class="ie no"><span>IE</span><span>无支持</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>99+</span></span>
              <span class="safari_ios yes"><span>iOS Safari</span><span>15.4+</span></span>
              <span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span>
              <span class="webview_android yes"><span>Android WebView</span><span>59+</span></span>
              <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span>
              <span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
            </div>
          </div>
        </div>
        <p>
          <dfn class="dfn-paneled idl-code" data-dfn-for="NavigationPreloadManager" data-dfn-type="method" data-export
            id="dom-navigationpreloadmanager-setheadervalue">
            <code>setHeaderValue(<var>value</var>)</code>
          </dfn>
          方法步骤如下：
        </p>
        <ol>
          <li data-md>
            <p>让 <var>promise</var> 成为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                id="ref-for-a-new-promise⑤">一个新的 promise</a>。</p>
          <li data-md>
            <p>并行运行以下步骤：</p>
          <li data-md>
            <p>让 <var>registration</var> 成为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                id="ref-for-this②①">this</a> 的关联
              <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration④②">service worker registration</a>。
            </p>
          <li data-md>
            <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                id="ref-for-dfn-active-worker①④">active worker</a> 为 null，
              <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject②">拒绝</a>
              <var>promise</var>，
              返回一个 "<code
                class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror④">InvalidStateError</a></code>"
              <code
                class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException⑤">DOMException</a></code>，并中止这些步骤。
            </p>
          <li data-md>
            <p>设置 <var>registration</var> 的
              <a data-link-type="dfn" href="#service-worker-registration-navigation-preload-header-value"
                id="ref-for-service-worker-registration-navigation-preload-header-value">navigation preload header
                value</a> 为 <var>value</var>。
            </p>
          <li data-md>
            <p>以 undefined 解析 <var>promise</var>。</p>
          <li data-md>
            <p>返回 <var>promise</var>。</p>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="navigation-preload-manager-getstate">
        <h4 class="heading settled" data-level="3.6.4" id="navigation-preload-manager-getstate">
          <span class="secno">3.6.4. </span>
          <span class="content">
            <code class="idl">
              <a data-link-type="idl" href="#dom-navigationpreloadmanager-getstate" id="ref-for-dom-navigationpreloadmanager-getstate①">getState()</a>
            </code>
          </span>
          <a class="self-link" href="#navigation-preload-manager-getstate"></a>
        </h4>
        <div class="mdn-anno wrapped">
          <button class="mdn-anno-btn">
            <b class="all-engines-flag" title="所有当前引擎均支持此功能">✔</b><span>MDN</span>
          </button>
          <div class="feature">
            <p>
              <a href="https://developer.mozilla.org/en-US/docs/Web/API/NavigationPreloadManager/getState"
                title="NavigationPreloadManager 接口的 getState() 方法返回一个 Promise，该 Promise 解析为一个对象，其属性指示是否启用了预加载，以及在 Service-Worker-Navigation-Preload HTTP 头中将发送的值。">
                NavigationPreloadManager/getState
              </a>
            </p>
            <p class="all-engines-text">所有当前引擎均支持此功能。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>99+</span></span>
              <span class="safari yes"><span>Safari</span><span>15.4+</span></span>
              <span class="chrome yes"><span>Chrome</span><span>59+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>46+</span></span>
              <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (Legacy)</span><span>18</span></span>
              <span class="ie no"><span>IE</span><span>无支持</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>99+</span></span>
              <span class="safari_ios yes"><span>iOS Safari</span><span>15.4+</span></span>
              <span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span>
              <span class="webview_android yes"><span>Android WebView</span><span>59+</span></span>
              <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span>
              <span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
            </div>
          </div>
        </div>
        <p>
          <dfn class="dfn-paneled idl-code" data-dfn-for="NavigationPreloadManager" data-dfn-type="method" data-export
            id="dom-navigationpreloadmanager-getstate">
            <code>getState()</code>
          </dfn>
          方法步骤如下：
        </p>
        <ol>
          <li data-md>
            <p>让 <var>promise</var> 成为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                id="ref-for-a-new-promise⑥">一个新的 promise</a>。</p>
          <li data-md>
            <p>并行运行以下步骤：</p>
          <li data-md>
            <p>让 <var>registration</var> 成为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                id="ref-for-this②②">this</a> 的关联
              <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration④③">service worker registration</a>。
            </p>
          <li data-md>
            <p>让 <var>state</var> 成为一个新的 <code
                class="idl"><a data-link-type="idl" href="#dictdef-navigationpreloadstate" id="ref-for-dictdef-navigationpreloadstate①">NavigationPreloadState</a></code>
              字典。</p>
          <li data-md>
            <p>如果 <var>registration</var> 的
              <a data-link-type="dfn" href="#service-worker-registration-navigation-preload-enabled-flag"
                id="ref-for-service-worker-registration-navigation-preload-enabled-flag②">navigation preload enabled
                标志</a>
              被设置，则将 <var>state</var>["<code
                class="idl"><a data-link-type="idl" href="#dom-navigationpreloadstate-enabled" id="ref-for-dom-navigationpreloadstate-enabled">enabled</a></code>"]
              设置为 true。
            </p>
          <li data-md>
            <p>将 <var>state</var>["<code
                class="idl"><a data-link-type="idl" href="#dom-navigationpreloadstate-headervalue" id="ref-for-dom-navigationpreloadstate-headervalue">headerValue</a></code>"]
              设置为
              <var>registration</var> 的
              <a data-link-type="dfn" href="#service-worker-registration-navigation-preload-header-value"
                id="ref-for-service-worker-registration-navigation-preload-header-value①">navigation preload header
                value</a>。
            </p>
          <li data-md>
            <p>以 <var>state</var> 解析 <var>promise</var>。</p>
          <li data-md>
            <p>返回 <var>promise</var>。</p>
        </ol>
      </section>
    </section>
    <section>
      <h2 class="heading settled" data-level="4" id="execution-context">
        <span class="secno">4. </span><span class="content">执行上下文</span>
        <a class="self-link" href="#execution-context"></a>
      </h2>
      <div class="example" id="example-b1dcfb45">
        <a class="self-link" href="#example-b1dcfb45"></a> 服务缓存资源:
        <pre class="highlight"><c- c1>// caching.js</c->
self<c- p>.</c->addEventListener<c- p>(</c-><c- u>"install"</c-><c- p>,</c-> event <c- p>=></c-> <c- p>{</c->
  event<c- p>.</c->waitUntil<c- p>(</c->
    <c- c1>// 打开资源缓存。</c->
    caches<c- p>.</c->open<c- p>(</c-><c- u>"shell-v1"</c-><c- p>).</c->then<c- p>(</c->cache <c- p>=></c-> <c- p>{</c->
      <c- c1>// 开始获取资源的过程。仅在所有资源</c->
      <c- c1>// 都被存储后，操作才会成功。即使只有</c->
      <c- c1>// 一个资源获取失败，整个操作也会失败。</c->
      <c- k>return</c-> cache<c- p>.</c->addAll<c- p>([</c->
        <c- u>"/app.html"</c-><c- p>,</c->
        <c- u>"/assets/v1/base.css"</c-><c- p>,</c->
        <c- u>"/assets/v1/app.js"</c-><c- p>,</c->
        <c- u>"/assets/v1/logo.png"</c-><c- p>,</c->
        <c- u>"/assets/v1/intro_video.webm"</c-><c- p>]);</c->
    <c- p>})</c->
  <c- p>);</c->
<c- p>});</c->

self<c- p>.</c->addEventListener<c- p>(</c-><c- u>"fetch"</c-><c- p>,</c-> event <c- p>=></c-> <c- p>{</c->
  <c- c1>// 在 service worker 成功安装并激活之前，</c->
  <c- c1>// 不会触发任何 "fetch" 事件。</c->

  <c- c1>// 缓存操作都是异步的，包括匹配 URL，所以我们会大量使用 promises。</c->
  <c- c1>// e.respondWith() 甚至接受 promises 来启用这个功能:</c->

  event<c- p>.</c->respondWith<c- p>(</c->
    caches<c- p>.</c->match<c- p>(</c->e<c- p>.</c->request<c- p>).</c->then<c- p>(</c->response <c- p>=></c-> <c- p>{</c->
      <c- k>return</c-> response <c- o>||</c-> fetch<c- p>(</c->e<c- p>.</c->request<c- p>);</c->
    <c- p>}).</c-><c- k>catch</c-><c- p>(()</c-> <c- p>=></c-> <c- p>{</c->
      <c- k>return</c-> caches<c- p>.</c->match<c- p>(</c-><c- u>"/fallback.html"</c-><c- p>);</c->
    <c- p>})</c->
  <c- p>);</c->
<c- p>});</c-></pre>
      </div>
      <section>
        <h3 class="heading settled" data-level="4.1" id="serviceworkerglobalscope-interface">
          <span class="secno">4.1. </span>
          <span class="content">
            <code class="idl">
          <a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope④">ServiceWorkerGlobalScope</a>
        </code>
          </span>
          <a class="self-link" href="#serviceworkerglobalscope-interface"></a>
        </h3>
        <div class="mdn-anno wrapped after">
          <button class="mdn-anno-btn">
            <b class="all-engines-flag" title="所有当前引擎均支持此功能">✔</b><span>MDN</span>
          </button>
          <div class="feature">
            <p>
              <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope"
                title="Service Worker API 的 ServiceWorkerGlobalScope 接口代表 service worker 的全局执行上下文。">
                ServiceWorkerGlobalScope
              </a>
            </p>
            <p class="all-engines-text">所有当前引擎均支持此功能。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
              <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
              <span class="chrome yes"><span>Chrome</span><span>40+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>24+</span></span>
              <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span>
              <span class="ie no"><span>IE</span><span>无支持</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
              <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
              <span class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span>
              <span class="webview_android yes"><span>Android WebView</span><span>40+</span></span>
              <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span>
              <span class="opera_android yes"><span>Opera Mobile</span><span>24+</span></span>
            </div>
          </div>
        </div>
        <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Global" id="ref-for-Global"><c- g>Global</c-></a>=(<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/workers.html#worker" id="ref-for-worker"><c- n>Worker</c-></a>,<a data-link-type="idl-name" href="#serviceworker" id="ref-for-serviceworker②⓪"><c- n>ServiceWorker</c-></a>), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed④"><c- g>Exposed</c-></a>=<c- n>ServiceWorker</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="serviceworkerglobalscope"><code><c- g>ServiceWorkerGlobalScope</c-></code></dfn> : <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope"><c- n>WorkerGlobalScope</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject③"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#clients" id="ref-for-clients"><c- n>Clients</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Clients" href="#dom-serviceworkerglobalscope-clients" id="ref-for-dom-serviceworkerglobalscope-clients"><c- g>clients</c-></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject④"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworkerregistration" id="ref-for-serviceworkerregistration①②"><c- n>ServiceWorkerRegistration</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorkerRegistration" href="#dom-serviceworkerglobalscope-registration" id="ref-for-dom-serviceworkerglobalscope-registration"><c- g>registration</c-></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject⑤"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworker" id="ref-for-serviceworker②①"><c- n>ServiceWorker</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorker" href="#dom-serviceworkerglobalscope-serviceworker" id="ref-for-dom-serviceworkerglobalscope-serviceworker"><c- g>serviceWorker</c-></a>;

  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject⑤"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①⓪"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined⑧"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-serviceworkerglobalscope-skipwaiting" id="ref-for-dom-serviceworkerglobalscope-skipwaiting"><c- g>skipWaiting</c-></a>();

  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑤"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkerglobalscope-oninstall" id="ref-for-dom-serviceworkerglobalscope-oninstall"><c- g>oninstall</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑥"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkerglobalscope-onactivate" id="ref-for-dom-serviceworkerglobalscope-onactivate"><c- g>onactivate</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑦"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkerglobalscope-onfetch" id="ref-for-dom-serviceworkerglobalscope-onfetch"><c- g>onfetch</c-></a>;

  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑧"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkerglobalscope-onmessage" id="ref-for-dom-serviceworkerglobalscope-onmessage"><c- g>onmessage</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑨"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkerglobalscope-onmessageerror" id="ref-for-dom-serviceworkerglobalscope-onmessageerror"><c- g>onmessageerror</c-></a>;
};
</pre>
        <p>
          <code class="idl">
        <a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope⑤">ServiceWorkerGlobalScope</a>
      </code> 对象表示 <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑤⑦">service
            worker</a> 的全局执行上下文。
          <code class="idl">
        <a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope⑥">ServiceWorkerGlobalScope</a>
      </code> 对象有一个关联的
          <dfn class="dfn-paneled" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="dfn" data-export
            id="serviceworkerglobalscope-service-worker">service worker</dfn>（一个
          <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑤⑧">service worker</a>）。
          <code class="idl">
        <a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope⑦">ServiceWorkerGlobalScope</a>
      </code> 对象有一个关联的
          <dfn class="dfn-paneled" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="dfn" data-noexport
            id="serviceworkerglobalscope-force-bypass-cache-for-import-scripts-flag">强制绕过导入脚本缓存的标志</dfn>。它最初未设置。
        </p>
        <p class="note" role="note">
          <span>注意：</span> <code class="idl">
        <a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope⑧">ServiceWorkerGlobalScope</a>
      </code> 对象提供了通用的、事件驱动的、时间有限的脚本执行上下文，这些上下文在一个源上运行。<a data-link-type="dfn" href="#register"
            id="ref-for-register①">注册</a>成功后，
          <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑤⑨">service worker</a>
          会启动、保持活跃，并通过与事件的关系而非与
          <a data-link-type="dfn" href="#dfn-service-worker-client" id="ref-for-dfn-service-worker-client②④">service
            worker 客户端</a> 的关系而被终止。
          在 <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑥⓪">service worker</a>
          内部不能发起任何类型的同步请求。
        </p>
        <section>
          <h4 class="heading settled" data-level="4.1.1" id="service-worker-global-scope-clients">
            <span class="secno">4.1.1. </span><span class="content">
              <code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkerglobalscope-clients" id="ref-for-dom-serviceworkerglobalscope-clients①">clients</a></code>
            </span><a class="self-link" href="#service-worker-global-scope-clients"></a>
          </h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn">
              <b class="all-engines-flag" title="所有当前引擎均支持此功能">✔</b><span>MDN</span>
            </button>
            <div class="feature">
              <p>
                <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/clients"
                  title="ServiceWorkerGlobalScope 接口的 clients 只读属性返回与 service worker 关联的 Clients 对象。">
                  ServiceWorkerGlobalScope/clients
                </a>
              </p>
              <p class="all-engines-text">所有当前引擎均支持此功能。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
                <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
                <span class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>24+</span></span>
                <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span>
                <span class="ie no"><span>IE</span><span>无支持</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
                <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
                <span class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span>
                <span class="webview_android yes"><span>Android WebView</span><span>40+</span></span>
                <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span>
                <span class="opera_android yes"><span>Opera Mobile</span><span>24+</span></span>
              </div>
            </div>
          </div>
          <p>
            <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="attribute"
              data-export id="dom-serviceworkerglobalscope-clients"><code>clients</code></dfn> getter 的步骤是返回与
            <code class="idl"><a data-link-type="idl" href="#clients" id="ref-for-clients①">Clients</a></code> 对象关联的
            <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②③">this</a>。
          </p>
        </section>

        <section>
          <h4 class="heading settled" data-level="4.1.2" id="service-worker-global-scope-registration">
            <span class="secno">4.1.2. </span><span class="content">
              <code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkerglobalscope-registration" id="ref-for-dom-serviceworkerglobalscope-registration①">registration</a></code>
            </span>
            <a class="self-link" href="#service-worker-global-scope-registration"></a>
          </h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn">
              <b class="all-engines-flag" title="所有当前引擎均支持此功能">✔</b><span>MDN</span>
            </button>
            <div class="feature">
              <p>
                <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/registration"
                  title="ServiceWorkerGlobalScope 接口的 registration 只读属性返回一个对 ServiceWorkerRegistration 对象的引用，该对象表示 service worker 的注册。">
                  ServiceWorkerGlobalScope/registration
                </a>
              </p>
              <p class="all-engines-text">所有当前引擎均支持此功能。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
                <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
                <span class="chrome yes"><span>Chrome</span><span>42+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>26+</span></span>
                <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span>
                <span class="ie no"><span>IE</span><span>无支持</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
                <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
                <span class="chrome_android yes"><span>Chrome for Android</span><span>42+</span></span>
                <span class="webview_android yes"><span>Android WebView</span><span>42+</span></span>
                <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span>
                <span class="opera_android yes"><span>Opera Mobile</span><span>26+</span></span>
              </div>
            </div>
          </div>
          <p>
            <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="attribute"
              data-export id="dom-serviceworkerglobalscope-registration">
              <code>registration</code>
            </dfn> getter 的步骤是返回
            <a data-link-type="dfn" href="#get-the-service-worker-registration-object"
              id="ref-for-get-the-service-worker-registration-object③">获取服务工作者注册对象</a>的结果，该对象代表
            <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②④">this</a> 的
            <a data-link-type="dfn" href="#serviceworkerglobalscope-service-worker"
              id="ref-for-serviceworkerglobalscope-service-worker②">service worker</a> 的
            <a data-link-type="dfn" href="#dfn-containing-service-worker-registration"
              id="ref-for-dfn-containing-service-worker-registration②">包含的服务工作者注册</a> 在
            <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
              id="ref-for-relevant-settings-object①④">相关设置对象</a> 中。
          </p>
        </section>
        <section>
          <h4 class="heading settled" data-level="4.1.3" id="service-worker-global-scope-serviceworker">
            <span class="secno">4.1.3. </span><span class="content">
              <code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkerglobalscope-serviceworker" id="ref-for-dom-serviceworkerglobalscope-serviceworker①">serviceWorker</a></code>
            </span>
            <a class="self-link" href="#service-worker-global-scope-serviceworker"></a>
          </h4>
          <p>
            <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="attribute"
              data-export id="dom-serviceworkerglobalscope-serviceworker">
              <code>serviceWorker</code>
            </dfn> getter 的步骤是返回
            <a data-link-type="dfn" href="#get-the-service-worker-object"
              id="ref-for-get-the-service-worker-object⑤">获取服务工作者对象</a> 的结果，该对象表示
            <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②⑥">this</a> 的
            <a data-link-type="dfn" href="#serviceworkerglobalscope-service-worker"
              id="ref-for-serviceworkerglobalscope-service-worker③">service worker</a> 在
            <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
              id="ref-for-relevant-settings-object①⑤">相关设置对象</a> 中。
          </p>
        </section>
        <section class="algorithm" data-algorithm="service-worker-global-scope-skipwaiting">
          <h4 class="heading settled" data-level="4.1.4" id="service-worker-global-scope-skipwaiting">
            <span class="secno">4.1.4. </span><span class="content">
              <code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkerglobalscope-skipwaiting" id="ref-for-dom-serviceworkerglobalscope-skipwaiting①">skipWaiting()</a></code>
            </span>
            <a class="self-link" href="#service-worker-global-scope-skipwaiting"></a>
          </h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn">
              <b class="all-engines-flag" title="所有当前引擎均支持此功能">✔</b><span>MDN</span>
            </button>
            <div class="feature">
              <p>
                <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/skipWaiting"
                  title="ServiceWorkerGlobalScope 的 skipWaiting() 方法强制等待中的 service worker 变为活动的 service worker。">
                  ServiceWorkerGlobalScope/skipWaiting
                </a>
              </p>
              <p class="all-engines-text">所有当前引擎均支持此功能。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
                <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
                <span class="chrome yes"><span>Chrome</span><span>41+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>25+</span></span>
                <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span>
                <span class="ie no"><span>IE</span><span>无支持</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
                <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
                <span class="chrome_android yes"><span>Chrome for Android</span><span>41+</span></span>
                <span class="webview_android yes"><span>Android WebView</span><span>41+</span></span>
                <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span>
                <span class="opera_android yes"><span>Opera Mobile</span><span>25+</span></span>
              </div>
            </div>
          </div>
          <p class="note" role="note">
            <span>注意：</span> <code class="idl">
              <a data-link-type="idl" href="#dom-serviceworkerglobalscope-skipwaiting" id="ref-for-dom-serviceworkerglobalscope-skipwaiting②">skipWaiting()</a>
            </code> 方法允许此
            <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑥①">service worker</a> 从
            <a data-link-type="dfn" href="#dfn-containing-service-worker-registration"
              id="ref-for-dfn-containing-service-worker-registration③">注册</a> 的
            <a data-link-type="dfn" href="#dfn-waiting-worker" id="ref-for-dfn-waiting-worker④">等待</a> 位置进展到
            <a data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker①⑤">激活</a>，即使
            <a data-link-type="dfn" href="#dfn-service-worker-client" id="ref-for-dfn-service-worker-client②⑤">service
              worker 客户端</a> 正在
            <a data-link-type="dfn" href="#dfn-use" id="ref-for-dfn-use①">使用</a> 该
            <a data-link-type="dfn" href="#dfn-containing-service-worker-registration"
              id="ref-for-dfn-containing-service-worker-registration④">注册</a> 。
          </p>
          <p>
            <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="method" data-export
              id="dom-serviceworkerglobalscope-skipwaiting">
              <code>skipWaiting()</code>
            </dfn> 方法的步骤是：
          </p>
          <ol>
            <li data-md>
              <p>让 <var>promise</var> 成为一个新的 <a data-link-type="dfn"
                  href="http://tc39.github.io/ecma262/#sec-promise-objects"
                  id="ref-for-sec-promise-objects⑤">promise</a>。</p>
            </li>
            <li data-md>
              <p>并行运行以下子步骤：</p>
              <ol>
                <li data-md>
                  <p>设置 <a data-link-type="dfn" href="#serviceworkerglobalscope-service-worker"
                      id="ref-for-serviceworkerglobalscope-service-worker④">service worker</a> 的
                    <a data-link-type="dfn" href="#dfn-skip-waiting-flag"
                      id="ref-for-dfn-skip-waiting-flag①">跳过等待标志</a>。
                  </p>
                </li>
                <li data-md>
                  <p>调用 <a data-link-type="dfn" href="#try-activate" id="ref-for-try-activate">尝试激活</a> ，其中包含
                    <a data-link-type="dfn" href="#serviceworkerglobalscope-service-worker"
                      id="ref-for-serviceworkerglobalscope-service-worker⑤">service worker</a> 的
                    <a data-link-type="dfn" href="#dfn-containing-service-worker-registration"
                      id="ref-for-dfn-containing-service-worker-registration⑤">包含服务工作者注册</a>。
                  </p>
                </li>
                <li data-md>
                  <p>用 undefined 解析 <var>promise</var>。</p>
                </li>
              </ol>
            </li>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
            </li>
          </ol>
        </section>
        <section>
          <h4 class="heading settled" data-level="4.1.5" id="service-worker-global-scope-event-handlers">
            <span class="secno">4.1.5. </span><span class="content">事件处理程序</span>
            <a class="self-link" href="#service-worker-global-scope-event-handlers"></a>
          </h4>
          <p>
            以下是
            <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers"
              id="ref-for-event-handlers⑥">事件处理程序</a>
            （及其对应的
            <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type"
              id="ref-for-event-handler-event-type⑥">事件处理程序事件类型</a>），
            所有实现
            <code
              class="idl"><a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope⑨">ServiceWorkerGlobalScope</a></code>
            接口的对象都
            <em>必须</em> 支持这些事件处理程序，作为
            <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes"
              id="ref-for-event-handler-idl-attributes③">事件处理程序 IDL 属性</a>：
          </p>
          <table class="data">
            <thead>
              <tr>
                <th>
                  <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers"
                    id="ref-for-event-handlers⑦">事件处理程序</a>
                </th>
                <th>
                  <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type"
                    id="ref-for-event-handler-event-type⑦">事件处理程序事件类型</a>
                </th>
            </thead>
            <tbody>
              <tr>
                <td>
                  <div class="mdn-anno wrapped">
                    <button class="mdn-anno-btn">
                      <b class="all-engines-flag" title="所有当前引擎均支持此功能">✔</b><span>MDN</span>
                    </button>
                    <div class="feature">
                      <p>
                        <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/install_event"
                          title="ServiceWorkerGlobalScope 接口的 install 事件在 ServiceWorkerRegistration 获取一个新的 ServiceWorkerRegistration.installing worker 时触发。">
                          ServiceWorkerGlobalScope/install_event
                        </a>
                      </p>
                      <p class="all-engines-text">所有当前引擎均支持此功能。</p>
                      <div class="support">
                        <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
                        <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
                        <span class="chrome yes"><span>Chrome</span><span>40+</span></span>
                        <hr>
                        <span class="opera yes"><span>Opera</span><span>24+</span></span>
                        <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                        <hr>
                        <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span>
                        <span class="ie no"><span>IE</span><span>无支持</span></span>
                        <hr>
                        <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
                        <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
                        <span class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span>
                        <span class="webview_android yes"><span>Android WebView</span><span>40+</span></span>
                        <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span>
                        <span class="opera_android yes"><span>Opera Mobile</span><span>24+</span></span>
                      </div>
                    </div>
                  </div>
                  <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="attribute"
                    data-export id="dom-serviceworkerglobalscope-oninstall">
                    <code>oninstall</code>
                  </dfn>
                </td>
                <td>
                  <code
                    class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-install-event" id="ref-for-service-worker-global-scope-install-event①">install</a></code>
                </td>
              </tr>
              <tr>
                <td>
                  <div class="mdn-anno wrapped">
                    <button class="mdn-anno-btn">
                      <b class="all-engines-flag" title="所有当前引擎均支持此功能">✔</b><span>MDN</span>
                    </button>
                    <div class="feature">
                      <p>
                        <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/activate_event"
                          title="ServiceWorkerGlobalScope 接口的 activate 事件在 ServiceWorkerRegistration 获取一个新的 ServiceWorkerRegistration.active worker 时触发。">
                          ServiceWorkerGlobalScope/activate_event
                        </a>
                      </p>
                      <p class="all-engines-text">所有当前引擎均支持此功能。</p>
                      <div class="support">
                        <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
                        <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
                        <span class="chrome yes"><span>Chrome</span><span>40+</span></span>
                        <hr>
                        <span class="opera yes"><span>Opera</span><span>24+</span></span>
                        <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                        <hr>
                        <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span>
                        <span class="ie no"><span>IE</span><span>无支持</span></span>
                        <hr>
                        <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
                        <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
                        <span class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span>
                        <span class="webview_android yes"><span>Android WebView</span><span>40+</span></span>
                        <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span>
                        <span class="opera_android yes"><span>Opera Mobile</span><span>24+</span></span>
                      </div>
                    </div>
                  </div>
                  <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="attribute"
                    data-export id="dom-serviceworkerglobalscope-onactivate">
                    <code>onactivate</code>
                  </dfn>
                </td>
                <td>
                  <code
                    class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-activate-event" id="ref-for-service-worker-global-scope-activate-event①">activate</a></code>
                </td>
              </tr>
              <tr>
                <td>
                  <div class="mdn-anno wrapped">
                    <button class="mdn-anno-btn">
                      <b class="all-engines-flag" title="所有当前引擎均支持此功能">✔</b><span>MDN</span>
                    </button>
                    <div class="feature">
                      <p>
                        <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/fetch_event"
                          title="当调用 fetch() 方法时，ServiceWorkerGlobalScope 接口的 fetch 事件会触发。">
                          ServiceWorkerGlobalScope/fetch_event
                        </a>
                      </p>
                      <p class="all-engines-text">所有当前引擎均支持此功能。</p>
                      <div class="support">
                        <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
                        <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
                        <span class="chrome yes"><span>Chrome</span><span>40+</span></span>
                        <hr>
                        <span class="opera yes"><span>Opera</span><span>24+</span></span>
                        <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                        <hr>
                        <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span>
                        <span class="ie no"><span>IE</span><span>无支持</span></span>
                        <hr>
                        <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
                        <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
                        <span class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span>
                        <span class="webview_android yes"><span>Android WebView</span><span>40+</span></span>
                        <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span>
                        <span class="opera_android yes"><span>Opera Mobile</span><span>24+</span></span>
                      </div>
                    </div>
                  </div>
                  <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="attribute"
                    data-export id="dom-serviceworkerglobalscope-onfetch">
                    <code>onfetch</code>
                  </dfn>
                </td>
                <td>
                  <code
                    class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-fetch-event" id="ref-for-service-worker-global-scope-fetch-event②">fetch</a></code>
                </td>
              </tr>
              <tr>
                <td>
                  <div class="mdn-anno wrapped">
                    <button class="mdn-anno-btn">
                      <b class="all-engines-flag" title="所有当前引擎均支持此功能">✔</b><span>MDN</span>
                    </button>
                    <div class="feature">
                      <p>
                        <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/message_event"
                          title="ServiceWorkerGlobalScope 接口的 message 事件在接收到传入消息时发生。受控页面可以使用 ServiceWorker.postMessage() 方法向 service workers 发送消息。service worker 可以选择通过 Client.postMessage() 返回响应，响应对应的受控页面。">
                          ServiceWorkerGlobalScope/message_event
                        </a>
                      </p>
                      <p class="all-engines-text">所有当前引擎均支持此功能。</p>
                      <div class="support">
                        <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
                        <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
                        <span class="chrome yes"><span>Chrome</span><span>40+</span></span>
                        <hr>
                        <span class="opera yes"><span>Opera</span><span>24+</span></span>
                        <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                        <hr>
                        <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span>
                        <span class="ie no"><span>IE</span><span>无支持</span></span>
                        <hr>
                        <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
                        <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
                        <span class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span>
                        <span class="webview_android yes"><span>Android WebView</span><span>40+</span></span>
                        <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span>
                        <span class="opera_android yes"><span>Opera Mobile</span><span>24+</span></span>
                      </div>
                    </div>
                  </div>
                  <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="attribute"
                    data-export id="dom-serviceworkerglobalscope-onmessage">
                    <code>onmessage</code>
                  </dfn>
                </td>
                <td>
                  <code
                    class="idl"><a class="idl-code" data-link-type="event" href="#eventdef-serviceworkerglobalscope-message" id="ref-for-eventdef-serviceworkerglobalscope-message">message</a></code>
                </td>
              </tr>
              <tr>
                <td>
                  <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="attribute"
                    data-export id="dom-serviceworkerglobalscope-onmessageerror">
                    <code>onmessageerror</code>
                  </dfn>
                </td>
                <td>
                  <code
                    class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-container-messageerror-event" id="ref-for-service-worker-container-messageerror-event②">messageerror</a></code>
                </td>
              </tr>
            </tbody>
          </table>
        </section>
      </section>
      <section>
        <h3 class="heading settled" data-level="4.2" id="client-interface">
          <span class="secno">4.2. </span>
          <span class="content">
            <code class="idl">
              <a data-link-type="idl" href="#client" id="ref-for-client①">Client</a>
            </code>
          </span>
          <a class="self-link" href="#client-interface"></a>
        </h3>
        <div class="mdn-anno wrapped after">
          <button class="mdn-anno-btn">
            <b class="all-engines-flag" title="所有当前引擎均支持此功能">✔</b><span>MDN</span>
          </button>
          <div class="feature">
            <p>
              <a href="https://developer.mozilla.org/en-US/docs/Web/API/Client"
                title="Client 接口表示一个可执行上下文，比如 Worker 或 SharedWorker。窗口客户端由更具体的 WindowClient 表示。您可以通过 Clients.matchAll() 和 Clients.get() 等方法获取 Client/WindowClient 对象。">
                Client
              </a>
            </p>
            <p class="all-engines-text">所有当前引擎均支持此功能。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
              <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
              <span class="chrome yes"><span>Chrome</span><span>40+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>27+</span></span>
              <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span>
              <span class="ie no"><span>IE</span><span>无支持</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
              <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
              <span class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span>
              <span class="webview_android yes"><span>Android WebView</span><span>40+</span></span>
              <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span>
              <span class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
            </div>
          </div>
        </div>
        <div class="mdn-anno wrapped">
          <button class="mdn-anno-btn">
            <b class="all-engines-flag" title="所有当前引擎均支持此功能">✔</b><span>MDN</span>
          </button>
          <div class="feature">
            <p>
              <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowClient"
                title="ServiceWorker API 的 WindowClient 接口表示受活动 worker 控制的浏览上下文中的文档范围。service worker 客户端独立选择并使用 service worker 进行自己的加载和子资源。">
                WindowClient
              </a>
            </p>
            <p class="all-engines-text">所有当前引擎均支持此功能。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
              <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
              <span class="chrome yes"><span>Chrome</span><span>42+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>29+</span></span>
              <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span>
              <span class="ie no"><span>IE</span><span>无支持</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
              <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
              <span class="chrome_android yes"><span>Chrome for Android</span><span>42+</span></span>
              <span class="webview_android yes"><span>Android WebView</span><span>42+</span></span>
              <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span>
              <span class="opera_android yes"><span>Opera Mobile</span><span>29+</span></span>
            </div>
          </div>
        </div>
        <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed⑤"><c- g>Exposed</c-></a>=<c- n>ServiceWorker</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="client"><code><c- g>Client</c-></code></dfn> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑤"><c- b>USVString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="USVString" href="#dom-client-url" id="ref-for-dom-client-url"><c- g>url</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-frametype" id="ref-for-enumdef-frametype"><c- n>FrameType</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="FrameType" href="#dom-client-frametype" id="ref-for-dom-client-frametype"><c- g>frameType</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-client-id" id="ref-for-dom-client-id"><c- g>id</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-clienttype" id="ref-for-enumdef-clienttype"><c- n>ClientType</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ClientType" href="#dom-client-type" id="ref-for-dom-client-type"><c- g>type</c-></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined⑨"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-client-postmessage" id="ref-for-dom-client-postmessage"><c- g>postMessage</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any②"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="Client/postMessage(message, transfer)" data-dfn-type="argument" data-export id="dom-client-postmessage-message-transfer-message"><code><c- g>message</c-></code><a class="self-link" href="#dom-client-postmessage-message-transfer-message"></a></dfn>, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence" id="ref-for-idl-sequence①"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object①"><c- b>object</c-></a>> <dfn class="idl-code" data-dfn-for="Client/postMessage(message, transfer)" data-dfn-type="argument" data-export id="dom-client-postmessage-message-transfer-transfer"><code><c- g>transfer</c-></code><a class="self-link" href="#dom-client-postmessage-message-transfer-transfer"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined①⓪"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-client-postmessage-message-options" id="ref-for-dom-client-postmessage-message-options②"><c- g>postMessage</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any③"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="Client/postMessage(message, options), Client/postMessage(message)" data-dfn-type="argument" data-export id="dom-client-postmessage-message-options-message"><code><c- g>message</c-></code><a class="self-link" href="#dom-client-postmessage-message-options-message"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/web-messaging.html#structuredserializeoptions" id="ref-for-structuredserializeoptions①"><c- n>StructuredSerializeOptions</c-></a> <dfn class="idl-code" data-dfn-for="Client/postMessage(message, options), Client/postMessage(message)" data-dfn-type="argument" data-export id="dom-client-postmessage-message-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-client-postmessage-message-options-options"></a></dfn> = {});
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed⑥"><c- g>Exposed</c-></a>=<c- n>ServiceWorker</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="windowclient"><code><c- g>WindowClient</c-></code></dfn> : <a data-link-type="idl-name" href="#client" id="ref-for-client②"><c- n>Client</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://www.w3.org/TR/page-visibility/#VisibilityState" id="ref-for-VisibilityState"><c- n>VisibilityState</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="VisibilityState" href="#dom-windowclient-visibilitystate" id="ref-for-dom-windowclient-visibilitystate"><c- g>visibilityState</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean②"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="boolean" href="#dom-windowclient-focused" id="ref-for-dom-windowclient-focused"><c- g>focused</c-></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject⑥"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array" id="ref-for-idl-frozen-array①"><c- b>FrozenArray</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑥"><c- b>USVString</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="FrozenArray<USVString>" href="#dom-windowclient-ancestororigins" id="ref-for-dom-windowclient-ancestororigins"><c- g>ancestorOrigins</c-></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject⑥"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①①"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#windowclient" id="ref-for-windowclient①"><c- n>WindowClient</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-windowclient-focus" id="ref-for-dom-windowclient-focus"><c- g>focus</c-></a>();
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject⑦"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①②"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#windowclient" id="ref-for-windowclient②"><c- n>WindowClient</c-></a>?> <a class="idl-code" data-link-type="method" href="#dom-windowclient-navigate" id="ref-for-dom-windowclient-navigate"><c- g>navigate</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑦"><c- b>USVString</c-></a> <dfn class="idl-code" data-dfn-for="WindowClient/navigate(url)" data-dfn-type="argument" data-export id="dom-windowclient-navigate-url-url"><code><c- g>url</c-></code><a class="self-link" href="#dom-windowclient-navigate-url-url"></a></dfn>);
};

<c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-frametype"><code><c- g>FrameType</c-></code></dfn> {
  <dfn class="idl-code" data-dfn-for="FrameType" data-dfn-type="enum-value" data-export id="dom-frametype-auxiliary"><code><c- s>"auxiliary"</c-></code><a class="self-link" href="#dom-frametype-auxiliary"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="FrameType" data-dfn-type="enum-value" data-export id="dom-frametype-top-level"><code><c- s>"top-level"</c-></code><a class="self-link" href="#dom-frametype-top-level"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="FrameType" data-dfn-type="enum-value" data-export id="dom-frametype-nested"><code><c- s>"nested"</c-></code><a class="self-link" href="#dom-frametype-nested"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="FrameType" data-dfn-type="enum-value" data-export id="dom-frametype-none"><code><c- s>"none"</c-></code><a class="self-link" href="#dom-frametype-none"></a></dfn>
};
</pre>
        <p>一个 <code class="idl"><a data-link-type="idl" href="#client" id="ref-for-client③">Client</a></code> 对象关联一个
          <dfn class="dfn-paneled" data-dfn-for="Client" data-dfn-type="dfn" data-noexport
            id="dfn-service-worker-client-service-worker-client">service worker client</dfn>（一个 <a data-link-type="dfn"
            href="#dfn-service-worker-client" id="ref-for-dfn-service-worker-client②⑥">service worker client</a>）。
        </p>
        <p>一个 <code class="idl"><a data-link-type="idl" href="#client" id="ref-for-client④">Client</a></code> 对象关联一个
          <dfn class="dfn-paneled" data-dfn-for="Client" data-dfn-type="dfn" data-noexport
            id="dfn-service-worker-client-frame-type">frame type</dfn>，它可以是
          "<code>auxiliary</code>"、"<code>top-level</code>"、"<code>nested</code>" 和 "<code>none</code>" 之一。除非另有说明，否则它是
          "<code>none</code>"。
        </p>
        <p>一个 <code
            class="idl"><a data-link-type="idl" href="#windowclient" id="ref-for-windowclient③">WindowClient</a></code>
          对象关联一个 <dfn class="dfn-paneled" data-dfn-for="WindowClient" data-dfn-type="dfn" data-noexport
            id="dfn-service-worker-client-browsing-context">browsing context</dfn>，它是其 <a data-link-type="dfn"
            href="#dfn-service-worker-client-service-worker-client"
            id="ref-for-dfn-service-worker-client-service-worker-client">service worker client</a> 的 <a
            data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
            id="ref-for-concept-settings-object-global⑤">全局对象</a> 的 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context"
            id="ref-for-browsing-context⑤">浏览上下文</a>。</p>
        <p>一个 <code
            class="idl"><a data-link-type="idl" href="#windowclient" id="ref-for-windowclient④">WindowClient</a></code>
          对象关联一个 <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
            id="dfn-service-worker-client-visibilitystate">visibility state</dfn>，它是 <code
            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/page-visibility/#dom-document-visibilitystate" id="ref-for-dom-document-visibilitystate">visibilityState</a></code>
          属性值之一。</p>
        <p>一个 <code
            class="idl"><a data-link-type="idl" href="#windowclient" id="ref-for-windowclient⑤">WindowClient</a></code>
          对象关联一个 <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
            id="dfn-service-worker-client-focusstate">focus state</dfn>，它要么为 true，要么为 false（初始值为 false）。</p>
        <p>一个 <code
            class="idl"><a data-link-type="idl" href="#windowclient" id="ref-for-windowclient⑥">WindowClient</a></code>
          对象关联一个 <dfn class="dfn-paneled" data-dfn-for="WindowClient" data-dfn-type="dfn" data-noexport
            id="windowclient-ancestor-origins-array">ancestor origins array</dfn>。</p>
        <section>
          <h4 class="heading settled" data-level="4.2.1" id="client-url"><span class="secno">4.2.1. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-client-url" id="ref-for-dom-client-url①">url</a></code></span><a
              class="self-link" href="#client-url"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="This feature is in all current engines.">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Client/url"
                  title="The url read-only property of the Client interface returns the URL of the current service worker client.">Client/url</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="Client" data-dfn-type="attribute" data-export
              id="dom-client-url"><code>url</code></dfn> getter 步骤是返回 <a data-link-type="dfn"
              href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②⑧">this</a> 的关联 <a data-link-type="dfn"
              href="#dfn-service-worker-client-service-worker-client"
              id="ref-for-dfn-service-worker-client-service-worker-client①">service worker client</a> 的 <a
              data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer"
              id="ref-for-concept-url-serializer④">序列化</a> <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url"
              id="ref-for-concept-environment-creation-url③">创建URL</a>。</p>
        </section>

        <section>
          <h4 class="heading settled" data-level="4.2.2" id="client-frametype"><span class="secno">4.2.2. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-client-frametype" id="ref-for-dom-client-frametype①">frameType</a></code></span><a
              class="self-link" href="#client-frametype"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="This feature is in all current engines.">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Client/frameType"
                  title="Client 接口的只读属性 frameType 指示当前 Client 的浏览上下文类型。此值可以是 &quot;auxiliary&quot;、&quot;top-level&quot;、&quot;nested&quot; 或 &quot;none&quot; 之一。">Client/frameType</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>43+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>30+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>43+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>43+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>30+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="Client" data-dfn-type="attribute" data-export
              id="dom-client-frametype"><code>frameType</code></dfn> getter 步骤是返回 <a data-link-type="dfn"
              href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②⑨">this</a> 的 <a data-link-type="dfn"
              href="#dfn-service-worker-client-frame-type" id="ref-for-dfn-service-worker-client-frame-type">frame
              type</a>。</p>
        </section>
        <section>
          <h4 class="heading settled" data-level="4.2.3" id="client-id"><span class="secno">4.2.3. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-client-id" id="ref-for-dom-client-id①">id</a></code></span><a
              class="self-link" href="#client-id"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="This feature is in all current engines.">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Client/id"
                  title="Client 接口的只读属性 id 返回 Client 对象的通用唯一标识符。">Client/id</a></p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="Client" data-dfn-type="attribute" data-export
              id="dom-client-id"><code>id</code></dfn> getter 步骤是返回 <a data-link-type="dfn"
              href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③⓪">this</a> 的关联 <a data-link-type="dfn"
              href="#dfn-service-worker-client-service-worker-client"
              id="ref-for-dfn-service-worker-client-service-worker-client②">service worker client</a> 的 <a
              data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-id"
              id="ref-for-concept-environment-id">id</a>。</p>
        </section>
        <section>
          <h4 class="heading settled" data-level="4.2.4" id="client-type"><span class="secno">4.2.4. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-client-type" id="ref-for-dom-client-type①">type</a></code></span><a
              class="self-link" href="#client-type"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="This feature is in all current engines.">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Client/type"
                  title="Client 接口的只读属性 type 表示 service worker 正在控制的客户端的类型。">Client/type</a></p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>54+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>60+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>47+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>54+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>60+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>60+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>8.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>44+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="Client" data-dfn-type="attribute" data-export
              id="dom-client-type"><code>type</code></dfn> getter 步骤如下：</p>
          <ol>
            <li data-md>
              <p>让 <var>client</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this③①">this</a> 的 <a data-link-type="dfn"
                  href="#dfn-service-worker-client-service-worker-client"
                  id="ref-for-dfn-service-worker-client-service-worker-client③">service worker client</a>。</p>
            <li data-md>
              <p>如果 <var>client</var> 是一个 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                  id="ref-for-environment-settings-object⑥">环境设置对象</a>，那么：</p>
              <ol>
                <li data-md>
                  <p>如果 <var>client</var> 是一个 <a data-link-type="dfn" href="#dfn-window-client"
                      id="ref-for-dfn-window-client⑨">window client</a>，返回 <code
                      class="idl"><a data-link-type="idl" href="#dom-clienttype-window" id="ref-for-dom-clienttype-window">"window"</a></code>。
                  </p>
                <li data-md>
                  <p>否则如果 <var>client</var> 是一个 <a data-link-type="dfn" href="#dfn-dedicatedworker-client"
                      id="ref-for-dfn-dedicatedworker-client①">dedicated worker client</a>，返回 <code
                      class="idl"><a data-link-type="idl" href="#dom-clienttype-worker" id="ref-for-dom-clienttype-worker">"worker"</a></code>。
                  </p>
                <li data-md>
                  <p>否则如果 <var>client</var> 是一个 <a data-link-type="dfn" href="#dfn-sharedworker-client"
                      id="ref-for-dfn-sharedworker-client①">shared worker client</a>，返回 <code
                      class="idl"><a data-link-type="idl" href="#dom-clienttype-sharedworker" id="ref-for-dom-clienttype-sharedworker">"sharedworker"</a></code>。
                  </p>
              </ol>
            <li data-md>
              <p>否则：</p>
              <ol>
                <li data-md>
                  <p>返回 <code
                      class="idl"><a data-link-type="idl" href="#dom-clienttype-window" id="ref-for-dom-clienttype-window①">"window"</a></code>。
                  </p>
              </ol>
          </ol>
        </section>

        <section class="algorithm" data-algorithm="client-postmessage">
          <h4 class="heading settled" data-level="4.2.5" id="client-postmessage"><span class="secno">4.2.5. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-client-postmessage" id="ref-for-dom-client-postmessage①">postMessage(message, transfer)</a></code></span><a
              class="self-link" href="#client-postmessage"></a></h4>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="Client" data-dfn-type="method" data-export
              id="dom-client-postmessage"><code>postMessage(<var>message</var>, <var>transfer</var>)</code></dfn>
            方法步骤如下：</p>
          <ol>
            <li data-md>
              <p>让 <var>options</var> 为 «[ "transfer" → <var>transfer</var> ]»。</p>
            <li data-md>
              <p>调用 <code
                  class="idl"><a data-link-type="idl" href="#dom-client-postmessage-message-options" id="ref-for-dom-client-postmessage-message-options③">postMessage(message, options)</a></code>，并将
                <var>message</var> 和 <var>options</var> 作为参数。
              </p>
          </ol>
        </section>
        <section class="algorithm" data-algorithm="client-postmessage-options">
          <h4 class="heading settled" data-level="4.2.6" id="client-postmessage-options"><span class="secno">4.2.6.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-client-postmessage-message-options" id="ref-for-dom-client-postmessage-message-options④">postMessage(message, options)</a></code></span><a
              class="self-link" href="#client-postmessage-options"></a></h4>
          <div class="mdn-anno wrapped">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="This feature is in all current engines.">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Client/postMessage"
                  title="Client 接口的 postMessage() 方法允许 service worker 向客户端（Window、Worker 或 SharedWorker）发送消息。消息在 navigator.serviceWorker 上的 &quot;message&quot; 事件中接收。">Client/postMessage</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="Client" data-dfn-type="method" data-export
              data-lt="postMessage(message, options)|postMessage(message)"
              id="dom-client-postmessage-message-options"><code>postMessage(<var>message</var>, <var>options</var>)</code></dfn>
            方法步骤如下：</p>
          <ol>
            <li data-md>
              <p>让 <var>contextObject</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this③②">this</a>。</p>
            <li data-md>
              <p>让 <var>sourceSettings</var> 为 <var>contextObject</var> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                  id="ref-for-relevant-settings-object①⑥">相关设置对象</a>。</p>
            <li data-md>
              <p>让 <var>serializeWithTransferResult</var> 为 <a data-link-type="abstract-op"
                  href="https://html.spec.whatwg.org/multipage/structured-data.html#structuredserializewithtransfer"
                  id="ref-for-structuredserializewithtransfer①">StructuredSerializeWithTransfer</a>(<var>message</var>,
                <var>options</var>["<code
                  class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#dom-structuredserializeoptions-transfer" id="ref-for-dom-structuredserializeoptions-transfer①">transfer</a></code>"])。重新抛出任何异常。
              </p>
            <li data-md>
              <p>并行执行以下步骤：</p>
              <ol>
                <li data-md>
                  <p>将 <var>targetClient</var> 设为 null。</p>
                <li data-md>
                  <p>对于每个 <a data-link-type="dfn" href="#dfn-service-worker-client"
                      id="ref-for-dfn-service-worker-client②⑦">service worker client</a> <var>client</var>：</p>
                  <ol>
                    <li data-md>
                      <p>如果 <var>client</var> 是 <var>contextObject</var> 的 <a data-link-type="dfn"
                          href="#dfn-service-worker-client-service-worker-client"
                          id="ref-for-dfn-service-worker-client-service-worker-client④">service worker client</a>，将
                        <var>targetClient</var> 设为 <var>client</var>，然后 <a data-link-type="dfn"
                          href="https://infra.spec.whatwg.org/#iteration-break" id="ref-for-iteration-break">中断</a>。
                      </p>
                  </ol>
                <li data-md>
                  <p>如果 <var>targetClient</var> 为 null，则返回。</p>
                <li data-md>
                  <p>让 <var>destination</var> 为其关联的 <a data-link-type="dfn"
                      href="#serviceworkercontainer-service-worker-client"
                      id="ref-for-serviceworkercontainer-service-worker-client⑧">service worker client</a> 是
                    <var>targetClient</var> 的 <code
                      class="idl"><a data-link-type="idl" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer①④">ServiceWorkerContainer</a></code>
                    对象。
                  </p>
                <li data-md>
                  <p>将运行以下步骤的任务添加到 <var>destination</var> 的 <a data-link-type="dfn" href="#dfn-client-message-queue"
                      id="ref-for-dfn-client-message-queue⑤">客户端消息队列</a>：</p>
                  <ol>
                    <li data-md>
                      <p>让 <var>origin</var> 为 <var>sourceSettings</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/origin.html#ascii-serialisation-of-an-origin"
                          id="ref-for-ascii-serialisation-of-an-origin①">来源的序列化</a>。</p>
                    <li data-md>
                      <p>让 <var>source</var> 为获取表示 <var>contextObject</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"
                          id="ref-for-concept-relevant-global②">相关全局对象</a> 的 <a data-link-type="dfn"
                          href="#serviceworkerglobalscope-service-worker"
                          id="ref-for-serviceworkerglobalscope-service-worker⑥">service worker</a> 在
                        <var>targetClient</var> 中的结果。
                      </p>
                    <li data-md>
                      <p>让 <var>deserializeRecord</var> 为 <a data-link-type="abstract-op"
                          href="https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserializewithtransfer"
                          id="ref-for-structureddeserializewithtransfer①">StructuredDeserializeWithTransfer</a>(<var>serializeWithTransferResult</var>,
                        <var>destination</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm"
                          id="ref-for-concept-relevant-realm①">相关 Realm</a>)。
                      </p>
                      <p>如果这抛出异常，捕获它，使用 <code
                          class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/comms.html#messageevent" id="ref-for-messageevent">MessageEvent</a></code>
                        触发一个名为 <code
                          class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-container-messageerror-event" id="ref-for-service-worker-container-messageerror-event③">messageerror</a></code>
                        的事件在 <var>destination</var> 上，<code
                          class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/comms.html#dom-messageevent-origin" id="ref-for-dom-messageevent-origin">origin</a></code>
                        属性初始化为 <var>origin</var>，<code
                          class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/comms.html#dom-messageevent-source" id="ref-for-dom-messageevent-source">source</a></code>
                        属性初始化为 <var>source</var>，然后中止这些步骤。</p>
                    <li data-md>
                      <p>让 <var>messageClone</var> 为 <var>deserializeRecord</var>.[[Deserialized]]。</p>
                    <li data-md>
                      <p>让 <var>newPorts</var> 为一个新的 <a data-link-type="dfn"
                          href="https://webidl.spec.whatwg.org/#dfn-frozen-array-type"
                          id="ref-for-dfn-frozen-array-type①">冻结数组</a>，由
                        <var>deserializeRecord</var>.[[TransferredValues]] 中的所有 <code
                          class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport①">MessagePort</a></code>
                        对象组成（如果有的话）。
                      </p>
                    <li data-md>
                      <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch"
                          id="ref-for-concept-event-dispatch③">分派一个事件</a>名为 <code
                          class="idl"><a class="idl-code" data-link-type="event" href="https://html.spec.whatwg.org/multipage/indices.html#event-message" id="ref-for-event-message">message</a></code>
                        在 <var>destination</var> 上，使用 <code
                          class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/comms.html#messageevent" id="ref-for-messageevent①">MessageEvent</a></code>，<code
                          class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/comms.html#dom-messageevent-origin" id="ref-for-dom-messageevent-origin①">origin</a></code>
                        属性初始化为 <var>origin</var>，<code
                          class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/comms.html#dom-messageevent-source" id="ref-for-dom-messageevent-source①">source</a></code>
                        属性初始化为 <var>source</var>，<code
                          class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/comms.html#dom-messageevent-data" id="ref-for-dom-messageevent-data">data</a></code>
                        属性初始化为 <var>messageClone</var>，<code
                          class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/comms.html#dom-messageevent-ports" id="ref-for-dom-messageevent-ports">ports</a></code>
                        属性初始化为 <var>newPorts</var>。</p>
                  </ol>
              </ol>
          </ol>
        </section>
        <section>
          <h4 class="heading settled" data-level="4.2.7" id="client-visibilitystate"><span class="secno">4.2.7.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-windowclient-visibilitystate" id="ref-for-dom-windowclient-visibilitystate①">visibilityState</a></code></span><a
              class="self-link" href="#client-visibilitystate"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="This feature is in all current engines.">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowClient/visibilityState"
                  title="WindowClient 接口的只读属性 visibilityState 指示当前客户端的可见性。此值可以是 &quot;hidden&quot;、&quot;visible&quot; 或 &quot;prerender&quot; 之一。">WindowClient/visibilityState</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>42+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>29+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>42+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>42+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>29+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="WindowClient" data-dfn-type="attribute" data-export
              id="dom-windowclient-visibilitystate"><code>visibilityState</code></dfn> getter 步骤是返回 <a
              data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③③">this</a> 的 <a
              data-link-type="dfn" href="#dfn-service-worker-client-visibilitystate"
              id="ref-for-dfn-service-worker-client-visibilitystate">可见性状态</a>。</p>
        </section>

        <section>
          <h4 class="heading settled" data-level="4.2.8" id="client-focused"><span class="secno">4.2.8. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-windowclient-focused" id="ref-for-dom-windowclient-focused①">focused</a></code></span><a
              class="self-link" href="#client-focused"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowClient/focused"
                  title="WindowClient 接口的只读属性 focused 是一个布尔值，指示当前客户端是否有焦点。">WindowClient/focused</a></p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>42+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>29+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>42+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>42+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>29+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="WindowClient" data-dfn-type="attribute" data-export
              id="dom-windowclient-focused"><code>focused</code></dfn> getter 步骤是返回 <a data-link-type="dfn"
              href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③④">this</a> 的 <a data-link-type="dfn"
              href="#dfn-service-worker-client-focusstate" id="ref-for-dfn-service-worker-client-focusstate">focus
              state</a>。</p>
        </section>
        <section>
          <h4 class="heading settled" data-level="4.2.9" id="client-ancestororigins"><span class="secno">4.2.9.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-windowclient-ancestororigins" id="ref-for-dom-windowclient-ancestororigins①">ancestorOrigins</a></code></span><a
              class="self-link" href="#client-ancestororigins"></a></h4>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="WindowClient" data-dfn-type="attribute" data-export
              id="dom-windowclient-ancestororigins"><code>ancestorOrigins</code></dfn> getter 步骤是返回 <a
              data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③⑤">this</a> 的关联 <a
              data-link-type="dfn" href="#windowclient-ancestor-origins-array"
              id="ref-for-windowclient-ancestor-origins-array">ancestor origins array</a>。</p>
        </section>
        <section class="algorithm" data-algorithm="client-focus">
          <h4 class="heading settled" data-level="4.2.10" id="client-focus"><span class="secno">4.2.10. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-windowclient-focus" id="ref-for-dom-windowclient-focus①">focus()</a></code></span><a
              class="self-link" href="#client-focus"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowClient/focus"
                  title="WindowClient 接口的 focus() 方法将用户输入焦点赋予当前客户端，并返回一个 Promise，该 Promise 解析为现有的 WindowClient。">WindowClient/focus</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>42+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>29+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>42+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>42+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>29+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="WindowClient" data-dfn-type="method" data-export
              id="dom-windowclient-focus"><code>focus()</code></dfn> 方法步骤如下：</p>
          <ol>
            <li data-md>
              <p>如果此算法未由用户激活<a data-link-type="dfn">触发</a>，则返回一个以 "<code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidaccesserror" id="ref-for-invalidaccesserror">InvalidAccessError</a></code>"
                <code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException⑥">DOMException</a></code>
                拒绝的 <a data-link-type="dfn" href="http://tc39.github.io/ecma262/#sec-promise-objects"
                  id="ref-for-sec-promise-objects⑥">promise</a>。
              </p>
            <li data-md>
              <p>让 <var>serviceWorkerEventLoop</var> 为 <a data-link-type="dfn">周围代理</a>的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-agent-event-loop"
                  id="ref-for-concept-agent-event-loop">事件循环</a>。</p>
            <li data-md>
              <p>让 <var>promise</var> 为一个新的 <a data-link-type="dfn"
                  href="http://tc39.github.io/ecma262/#sec-promise-objects"
                  id="ref-for-sec-promise-objects⑦">promise</a>。</p>
            <li data-md>
              <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                  id="ref-for-queue-a-task⑤">排队一个任务</a>，在 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③⑥">this</a> 关联的 <a data-link-type="dfn"
                  href="#dfn-service-worker-client-service-worker-client"
                  id="ref-for-dfn-service-worker-client-service-worker-client⑤">service worker client</a> 的 <a
                  data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                  id="ref-for-responsible-event-loop②">负责的事件循环</a>上，使用 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source"
                  id="ref-for-user-interaction-task-source">用户交互任务源</a> 运行以下步骤：</p>
              <ol>
                <li data-md>
                  <p>使用 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③⑦">this</a>
                    的 <a data-link-type="dfn" href="#dfn-service-worker-client-browsing-context"
                      id="ref-for-dfn-service-worker-client-browsing-context">浏览上下文</a> 运行 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/interaction.html#focusing-steps"
                      id="ref-for-focusing-steps">聚焦步骤</a>。</p>
                <li data-md>
                  <p>让 <var>frameType</var> 为运行 <a data-link-type="dfn" href="#get-frame-type"
                      id="ref-for-get-frame-type">获取框架类型</a> 与 <a data-link-type="dfn"
                      href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③⑧">this</a> 的 <a data-link-type="dfn"
                      href="#dfn-service-worker-client-browsing-context"
                      id="ref-for-dfn-service-worker-client-browsing-context①">浏览上下文</a> 的结果。</p>
                <li data-md>
                  <p>让 <var>visibilityState</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                      id="ref-for-this③⑨">this</a> 的 <a data-link-type="dfn"
                      href="#dfn-service-worker-client-browsing-context"
                      id="ref-for-dfn-service-worker-client-browsing-context②">浏览上下文</a> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                      id="ref-for-active-document①">活动文档</a> 的 <code
                      class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/page-visibility/#dom-document-visibilitystate" id="ref-for-dom-document-visibilitystate①">visibilityState</a></code>
                    属性值。</p>
                <li data-md>
                  <p>让 <var>focusState</var> 为运行 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/interaction.html#has-focus-steps"
                      id="ref-for-has-focus-steps">具有焦点步骤</a> 与 <a data-link-type="dfn"
                      href="https://webidl.spec.whatwg.org/#this" id="ref-for-this④⓪">this</a> 的 <a data-link-type="dfn"
                      href="#dfn-service-worker-client-browsing-context"
                      id="ref-for-dfn-service-worker-client-browsing-context③">浏览上下文</a> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                      id="ref-for-active-document②">活动文档</a> 的结果。</p>
                <li data-md>
                  <p>让 <var>ancestorOriginsList</var> 为 <a data-link-type="dfn"
                      href="https://webidl.spec.whatwg.org/#this" id="ref-for-this④①">this</a> 的 <a data-link-type="dfn"
                      href="#dfn-service-worker-client-browsing-context"
                      id="ref-for-dfn-service-worker-client-browsing-context④">浏览上下文</a> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                      id="ref-for-active-document③">活动文档</a> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"
                      id="ref-for-concept-relevant-global③">相关全局对象</a> 的 <code
                      class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/history.html#location" id="ref-for-location">Location</a></code>
                    对象的 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html"
                      id="ref-for-concept-location-ancestor-origins-list">祖先来源列表</a> 的关联列表。</p>
                <li data-md>
                  <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                      id="ref-for-queue-a-task⑥">排队一个任务</a>，在 <var>serviceWorkerEventLoop</var> 上使用 <a
                      data-link-type="dfn">DOM 操作任务源</a>运行以下步骤：</p>
                  <ol>
                    <li data-md>
                      <p>让 <var>windowClient</var> 为运行 <a data-link-type="dfn" href="#create-window-client"
                          id="ref-for-create-window-client">创建 Window Client</a> 与 <a data-link-type="dfn"
                          href="https://webidl.spec.whatwg.org/#this" id="ref-for-this④②">this</a> 的关联 <a
                          data-link-type="dfn" href="#dfn-service-worker-client-service-worker-client"
                          id="ref-for-dfn-service-worker-client-service-worker-client⑥">service worker
                          client</a>、<var>frameType</var>、<var>visibilityState</var>、<var>focusState</var> 和
                        <var>ancestorOriginsList</var> 的结果。
                      </p>
                    <li data-md>
                      <p>如果 <var>windowClient</var> 的 <a data-link-type="dfn"
                          href="#dfn-service-worker-client-focusstate"
                          id="ref-for-dfn-service-worker-client-focusstate①">focus state</a> 为 true，则用
                        <var>windowClient</var> 解析 <var>promise</var>。
                      </p>
                    <li data-md>
                      <p>否则，使用 <code>TypeError</code> 拒绝 <var>promise</var>。</p>
                  </ol>
              </ol>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
          </ol>
        </section>

        <section class="algorithm" data-algorithm="client-navigate">
          <h4 class="heading settled" data-level="4.2.11" id="client-navigate"><span class="secno">4.2.11. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-windowclient-navigate" id="ref-for-dom-windowclient-navigate①">navigate(url)</a></code></span><a
              class="self-link" href="#client-navigate"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowClient/navigate"
                  title="WindowClient 接口的 navigate() 方法将指定的 URL 加载到受控客户端页面，然后返回一个解析为现有 WindowClient 的 Promise。">WindowClient/navigate</a>
              </p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari no"><span>Safari</span><span>None</span></span><span
                  class="chrome yes"><span>Chrome</span><span>49+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>36+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>49+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>42+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>36+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="WindowClient" data-dfn-type="method" data-export
              id="dom-windowclient-navigate"><code>navigate(url)</code></dfn> 方法步骤如下：</p>
          <ol>
            <li data-md>
              <p>将 <var>url</var> 设为使用 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this④③">this</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                  id="ref-for-relevant-settings-object①⑦">相关设置对象</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url"
                  id="ref-for-api-base-url③">API 基础 URL</a> <a data-link-type="dfn"
                  href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser③">解析</a>
                <var>url</var> 的结果。
              </p>
            <li data-md>
              <p>如果 <var>url</var> 解析失败，返回一个以 <code>TypeError</code> 拒绝的 <a data-link-type="dfn"
                  href="http://tc39.github.io/ecma262/#sec-promise-objects"
                  id="ref-for-sec-promise-objects⑧">promise</a>。</p>
            <li data-md>
              <p>如果 <var>url</var> 是 <code>about:blank</code>，返回一个以 <code>TypeError</code> 拒绝的 <a data-link-type="dfn"
                  href="http://tc39.github.io/ecma262/#sec-promise-objects"
                  id="ref-for-sec-promise-objects⑨">promise</a>。</p>
            <li data-md>
              <p>如果 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this④④">this</a> 的关联
                <a data-link-type="dfn" href="#dfn-service-worker-client-service-worker-client"
                  id="ref-for-dfn-service-worker-client-service-worker-client⑦">service worker client</a> 的 <a
                  data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
                  id="ref-for-concept-environment-active-service-worker②①">活动 service worker</a> 不是 <a
                  data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this④⑤">this</a> 的 <a
                  data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"
                  id="ref-for-concept-relevant-global④">相关全局对象</a> 的 <a data-link-type="dfn"
                  href="#serviceworkerglobalscope-service-worker"
                  id="ref-for-serviceworkerglobalscope-service-worker⑦">service worker</a>，返回一个以 <code>TypeError</code>
                拒绝的 <a data-link-type="dfn" href="http://tc39.github.io/ecma262/#sec-promise-objects"
                  id="ref-for-sec-promise-objects①⓪">promise</a>。
              </p>
            <li data-md>
              <p>将 <var>serviceWorkerEventLoop</var> 设为 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#current-global-object"
                  id="ref-for-current-global-object">当前全局对象</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop"
                  id="ref-for-event-loop⑥">事件循环</a>。</p>
            <li data-md>
              <p>让 <var>promise</var> 为一个新的 <a data-link-type="dfn"
                  href="http://tc39.github.io/ecma262/#sec-promise-objects"
                  id="ref-for-sec-promise-objects①①">promise</a>。</p>
            <li data-md>
              <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                  id="ref-for-queue-a-task⑦">排队一个任务</a>，在 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#this" id="ref-for-this④⑥">this</a> 的关联 <a data-link-type="dfn"
                  href="#dfn-service-worker-client-service-worker-client"
                  id="ref-for-dfn-service-worker-client-service-worker-client⑧">service worker client</a> 的 <a
                  data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                  id="ref-for-responsible-event-loop③">负责的事件循环</a>上，使用 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source"
                  id="ref-for-user-interaction-task-source①">用户交互任务源</a> 运行以下步骤：</p>
              <ol>
                <li data-md>
                  <p>让 <var>browsingContext</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                      id="ref-for-this④⑦">this</a> 的 <a data-link-type="dfn"
                      href="#dfn-service-worker-client-browsing-context"
                      id="ref-for-dfn-service-worker-client-browsing-context⑤">浏览上下文</a>。</p>
                <li data-md>
                  <p>如果 <var>browsingContext</var> 已<a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/window-object.html#discard-a-document"
                      id="ref-for-discard-a-document">丢弃</a>其 <code
                      class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code>，<a
                      data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                      id="ref-for-queue-a-task⑧">排队一个任务</a>，在 <var>serviceWorkerEventLoop</var> 上使用 <a
                      data-link-type="dfn">DOM 操作任务源</a>拒绝 <var>promise</var> 并附带 <code>TypeError</code>，并中止这些步骤。</p>
                <li data-md>
                  <p><em>HandleNavigate</em>：使用 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate"
                      id="ref-for-navigate④">导航</a>将 <var>browsingContext</var> 导航至 <var>url</var>，并启用 <a
                      data-link-type="dfn">异常</a>。<a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#source-browsing-context"
                      id="ref-for-source-browsing-context">源浏览上下文</a>必须是 <var>browsingContext</var>。</p>
                <li data-md>
                  <p>如果在标记为 <em>HandleNavigate</em> 的步骤中调用的算法步骤<a data-link-type="dfn"
                      href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw">抛出</a>异常，<a
                      data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                      id="ref-for-queue-a-task⑨">排队一个任务</a>，在 <var>serviceWorkerEventLoop</var> 上使用 <a
                      data-link-type="dfn">DOM 操作任务源</a>拒绝 <var>promise</var> 并附带该异常，并中止这些步骤。</p>
                <li data-md>
                  <p>让 <var>frameType</var> 为运行 <a data-link-type="dfn" href="#get-frame-type"
                      id="ref-for-get-frame-type①">获取框架类型</a>与 <var>browsingContext</var> 的结果。</p>
                <li data-md>
                  <p>让 <var>visibilityState</var> 为 <var>browsingContext</var> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                      id="ref-for-active-document④">活动文档</a> 的 <code
                      class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/page-visibility/#dom-document-visibilitystate" id="ref-for-dom-document-visibilitystate②">visibilityState</a></code>
                    属性值。</p>
                <li data-md>
                  <p>让 <var>focusState</var> 为运行 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/interaction.html#has-focus-steps"
                      id="ref-for-has-focus-steps①">具有焦点步骤</a>与 <var>browsingContext</var> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                      id="ref-for-active-document⑤">活动文档</a> 的结果。</p>
                <li data-md>
                  <p>让 <var>ancestorOriginsList</var> 为 <var>browsingContext</var> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                      id="ref-for-active-document⑥">活动文档</a> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"
                      id="ref-for-concept-relevant-global⑤">相关全局对象</a> 的 <code
                      class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/history.html#location" id="ref-for-location①">Location</a></code>
                    对象的 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html"
                      id="ref-for-concept-location-ancestor-origins-list①">祖先来源列表</a> 的关联列表。</p>
                <li data-md>
                  <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                      id="ref-for-queue-a-task①⓪">排队一个任务</a>，在 <var>serviceWorkerEventLoop</var> 上使用 <a
                      data-link-type="dfn">DOM 操作任务源</a>运行以下步骤：</p>
                  <ol>
                    <li data-md>
                      <p>如果 <var>browsingContext</var> 的 <code
                          class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window③">Window</a></code>
                        对象的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                          id="ref-for-environment-settings-object⑦">环境设置对象</a> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url"
                          id="ref-for-concept-environment-creation-url④">创建 URL</a> 的 <a data-link-type="dfn"
                          href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin①">来源</a>
                        与 <a data-link-type="dfn" href="#serviceworkerglobalscope-service-worker"
                          id="ref-for-serviceworkerglobalscope-service-worker⑧">service worker</a> 的 <a
                          data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                          id="ref-for-concept-settings-object-origin⑤">来源</a>不同，使用 null 解析 <var>promise</var> 并中止这些步骤。
                      </p>
                    <li data-md>
                      <p>让 <var>windowClient</var> 为运行 <a data-link-type="dfn" href="#create-window-client"
                          id="ref-for-create-window-client①">创建 Window Client</a>与 <a data-link-type="dfn"
                          href="https://webidl.spec.whatwg.org/#this" id="ref-for-this④⑧">this</a> 的 <a
                          data-link-type="dfn" href="#dfn-service-worker-client-service-worker-client"
                          id="ref-for-dfn-service-worker-client-service-worker-client⑨">service worker
                          client</a>、<var>frameType</var>、<var>visibilityState</var>、<var>focusState</var> 和
                        <var>ancestorOriginsList</var> 的结果。
                      </p>
                    <li data-md>
                      <p>使用 <var>windowClient</var> 解析 <var>promise</var>。</p>
                  </ol>
              </ol>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
          </ol>
        </section>
      </section>
      <section>
        <h3 class="heading settled" data-level="4.3" id="clients-interface"><span class="secno">4.3. </span><span
            class="content"><code
              class="idl"><a data-link-type="idl" href="#clients" id="ref-for-clients②">Clients</a></code></span><a
            class="self-link" href="#clients-interface"></a></h3>
        <div class="mdn-anno wrapped after">
          <button class="mdn-anno-btn"><b class="all-engines-flag" title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
          <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Clients"
                title="Clients 接口提供对 Client 对象的访问。在 service worker 中通过 self.clients 访问。">Clients</a></p>
            <p class="all-engines-text">在所有当前引擎中。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                class="chrome yes"><span>Chrome</span><span>40+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                class="ie no"><span>IE</span><span>None</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
            </div>
          </div>
        </div>
        <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed⑦"><c- g>Exposed</c-></a>=<c- n>ServiceWorker</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="clients"><code><c- g>Clients</c-></code></dfn> {
  // The objects returned will be new instances every time
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject⑧"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①③"><c- b>Promise</c-></a>&lt;(<a data-link-type="idl-name" href="#client" id="ref-for-client⑤"><c- n>Client</c-></a> <c- b>or</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined①①"><c- b>undefined</c-></a>)> <a class="idl-code" data-link-type="method" href="#dom-clients-get" id="ref-for-dom-clients-get"><c- g>get</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="Clients/get(id)" data-dfn-type="argument" data-export id="dom-clients-get-id-id"><code><c- g>id</c-></code><a class="self-link" href="#dom-clients-get-id-id"></a></dfn>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject⑨"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①④"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array" id="ref-for-idl-frozen-array②"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="#client" id="ref-for-client⑥"><c- n>Client</c-></a>>> <a class="idl-code" data-link-type="method" href="#dom-clients-matchall" id="ref-for-dom-clients-matchall"><c- g>matchAll</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-clientqueryoptions" id="ref-for-dictdef-clientqueryoptions"><c- n>ClientQueryOptions</c-></a> <dfn class="idl-code" data-dfn-for="Clients/matchAll(options), Clients/matchAll()" data-dfn-type="argument" data-export id="dom-clients-matchall-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-clients-matchall-options-options"></a></dfn> = {});
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject①⓪"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①⑤"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#windowclient" id="ref-for-windowclient⑦"><c- n>WindowClient</c-></a>?> <a class="idl-code" data-link-type="method" href="#dom-clients-openwindow" id="ref-for-dom-clients-openwindow"><c- g>openWindow</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑧"><c- b>USVString</c-></a> <dfn class="idl-code" data-dfn-for="Clients/openWindow(url)" data-dfn-type="argument" data-export id="dom-clients-openwindow-url-url"><code><c- g>url</c-></code><a class="self-link" href="#dom-clients-openwindow-url-url"></a></dfn>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject①①"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①⑥"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined①②"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-clients-claim" id="ref-for-dom-clients-claim"><c- g>claim</c-></a>();
};
</pre>
        <pre class="idl highlight def" id="serviceworker-client-query-options-dictionary"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-clientqueryoptions"><code><c- g>ClientQueryOptions</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean③"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-default="false" data-dfn-for="ClientQueryOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-clientqueryoptions-includeuncontrolled"><code><c- g>includeUncontrolled</c-></code></dfn> = <c- b>false</c->;
  <a data-link-type="idl-name" href="#enumdef-clienttype" id="ref-for-enumdef-clienttype①"><c- n>ClientType</c-></a> <dfn class="dfn-paneled idl-code" data-default="&quot;window&quot;" data-dfn-for="ClientQueryOptions" data-dfn-type="dict-member" data-export data-type="ClientType " id="dom-clientqueryoptions-type"><code><c- g>type</c-></code></dfn> = "window";
};
</pre>
        <pre class="idl highlight def" id="client-type-enum"><c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-clienttype"><code><c- g>ClientType</c-></code></dfn> {
  <dfn class="dfn-paneled idl-code" data-dfn-for="ClientType" data-dfn-type="enum-value" data-export id="dom-clienttype-window"><code><c- s>"window"</c-></code></dfn>,
  <dfn class="dfn-paneled idl-code" data-dfn-for="ClientType" data-dfn-type="enum-value" data-export id="dom-clienttype-worker"><code><c- s>"worker"</c-></code></dfn>,
  <dfn class="dfn-paneled idl-code" data-dfn-for="ClientType" data-dfn-type="enum-value" data-export id="dom-clienttype-sharedworker"><code><c- s>"sharedworker"</c-></code></dfn>,
  <dfn class="dfn-paneled idl-code" data-dfn-for="ClientType" data-dfn-type="enum-value" data-export id="dom-clienttype-all"><code><c- s>"all"</c-></code></dfn>
};
</pre>
        <p>当创建一个 <code
            class="idl"><a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope①⓪">ServiceWorkerGlobalScope</a></code>
          对象时，用户代理<em>必须</em>创建一个 <code
            class="idl"><a data-link-type="idl" href="#clients" id="ref-for-clients③">Clients</a></code> 对象，并将其与该对象关联。
        </p>
        <section class="algorithm" data-algorithm="clients-get">
          <h4 class="heading settled" data-level="4.3.1" id="clients-get"><span class="secno">4.3.1. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-clients-get" id="ref-for-dom-clients-get①">get(id)</a></code></span><a
              class="self-link" href="#clients-get"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Clients/get"
                  title="Clients 接口的 get() 方法获取与给定 ID 匹配的 service worker client，并将其返回到 Promise 中。">Clients/get</a></p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>45+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>51+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>38+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>45+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>51+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>51+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>5.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>41+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="Clients" data-dfn-type="method" data-export
              id="dom-clients-get"><code>get(<var>id</var>)</code></dfn> 方法步骤如下：</p>
          <ol>
            <li data-md>
              <p>让 <var>promise</var> 为一个新的 <a data-link-type="dfn"
                  href="http://tc39.github.io/ecma262/#sec-promise-objects"
                  id="ref-for-sec-promise-objects①②">promise</a>。</p>
            <li data-md>
              <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                  id="ref-for-in-parallel①⓪">并行</a>执行以下子步骤：</p>
              <ol>
                <li data-md>
                  <p>对于每个 <a data-link-type="dfn" href="#dfn-service-worker-client"
                      id="ref-for-dfn-service-worker-client②⑧">service worker client</a> <var>client</var>，如果给定
                    <var>client</var> 的 <a data-link-type="dfn"
                      href="https://storage.spec.whatwg.org/#obtain-a-storage-key"
                      id="ref-for-obtain-a-storage-key③">获取存储键</a>的结果与关联的 <a data-link-type="dfn"
                      href="#serviceworkerglobalscope-service-worker"
                      id="ref-for-serviceworkerglobalscope-service-worker⑨">service worker</a> 的 <a data-link-type="dfn"
                      href="#dfn-containing-service-worker-registration"
                      id="ref-for-dfn-containing-service-worker-registration⑥">包含的 service worker 注册</a>的 <a
                      data-link-type="dfn" href="#service-worker-registration-storage-key"
                      id="ref-for-service-worker-registration-storage-key④">存储键</a> <a data-link-type="dfn"
                      href="https://storage.spec.whatwg.org/#storage-key-equal" id="ref-for-storage-key-equal①">相等</a>：
                  </p>
                  <ol>
                    <li data-md>
                      <p>如果 <var>client</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-id"
                          id="ref-for-concept-environment-id①">id</a> 不是 <var>id</var>，<a data-link-type="dfn"
                          href="https://infra.spec.whatwg.org/#iteration-continue"
                          id="ref-for-iteration-continue">继续</a>。</p>
                    <li data-md>
                      <p>等待 <var>client</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-execution-ready-flag"
                          id="ref-for-concept-environment-execution-ready-flag">执行就绪标志</a>被设置，或等待 <var>client</var> 的 <a
                          data-link-type="dfn" href="#service-worker-client-discarded-flag"
                          id="ref-for-service-worker-client-discarded-flag②">丢弃标志</a>被设置。</p>
                    <li data-md>
                      <p>如果 <var>client</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-execution-ready-flag"
                          id="ref-for-concept-environment-execution-ready-flag①">执行就绪标志</a>被设置，则使用 <var>client</var> 和
                        <var>promise</var> 调用 <a data-link-type="dfn" href="#resolve-get-client-promise"
                          id="ref-for-resolve-get-client-promise">解决获取客户端 Promise</a>，并中止这些步骤。
                      </p>
                  </ol>
                <li data-md>
                  <p>使用 undefined 解决 <var>promise</var>。</p>
              </ol>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
          </ol>
        </section>

        <section class="algorithm" data-algorithm="clients-matchall">
          <h4 class="heading settled" data-level="4.3.2" id="clients-matchall"><span class="secno">4.3.2. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-clients-matchall" id="ref-for-dom-clients-matchall①">matchAll(options)</a></code></span><a
              class="self-link" href="#clients-matchall"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Clients/matchAll"
                  title="Clients 接口的 matchAll() 方法返回一个包含 service worker Client 对象列表的 Promise。包含 options 参数以返回所有与关联的 service worker 具有相同源的 service worker 客户端。如果未包含 options，则该方法仅返回由 service worker 控制的 service worker 客户端。">Clients/matchAll</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>54+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>42+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>29+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>54+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>42+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>42+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>29+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="Clients" data-dfn-type="method" data-export
              data-lt="matchAll(options)|matchAll()"
              id="dom-clients-matchall"><code>matchAll(<var>options</var>)</code></dfn> 方法步骤如下：</p>
          <ol>
            <li data-md>
              <p>让 <var>promise</var> 成为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                  id="ref-for-a-new-promise⑦">一个新的 promise</a>。</p>
            <li data-md>
              <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                  id="ref-for-in-parallel①①">并行</a>运行以下步骤：</p>
              <ol>
                <li data-md>
                  <p>让 <var>targetClients</var> 成为一个新的 <a data-link-type="dfn"
                      href="https://infra.spec.whatwg.org/#list" id="ref-for-list②">列表</a>。</p>
                <li data-md>
                  <p>对于每个 <a data-link-type="dfn" href="#dfn-service-worker-client"
                      id="ref-for-dfn-service-worker-client②⑨">service worker client</a> <var>client</var>，如果给定
                    <var>client</var> 的 <a data-link-type="dfn"
                      href="https://storage.spec.whatwg.org/#obtain-a-storage-key"
                      id="ref-for-obtain-a-storage-key④">获取存储键</a>的结果与关联的 <a data-link-type="dfn"
                      href="#serviceworkerglobalscope-service-worker"
                      id="ref-for-serviceworkerglobalscope-service-worker①⓪">service worker</a> 的 <a
                      data-link-type="dfn" href="#dfn-containing-service-worker-registration"
                      id="ref-for-dfn-containing-service-worker-registration⑦">包含的 service worker 注册</a>的 <a
                      data-link-type="dfn" href="#service-worker-registration-storage-key"
                      id="ref-for-service-worker-registration-storage-key⑤">存储键</a> <a data-link-type="dfn"
                      href="https://storage.spec.whatwg.org/#storage-key-equal" id="ref-for-storage-key-equal②">相等</a>：
                  </p>
                  <ol>
                    <li data-md>
                      <p>如果 <var>client</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-execution-ready-flag"
                          id="ref-for-concept-environment-execution-ready-flag②">执行就绪标志</a>未设置或 <var>client</var> 的 <a
                          data-link-type="dfn" href="#service-worker-client-discarded-flag"
                          id="ref-for-service-worker-client-discarded-flag③">丢弃标志</a>已设置，<a data-link-type="dfn"
                          href="https://infra.spec.whatwg.org/#iteration-continue"
                          id="ref-for-iteration-continue①">继续</a>。</p>
                    <li data-md>
                      <p>如果 <var>client</var> 不是 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context"
                          id="ref-for-secure-context">安全上下文</a>，<a data-link-type="dfn"
                          href="https://infra.spec.whatwg.org/#iteration-continue"
                          id="ref-for-iteration-continue②">继续</a>。</p>
                    <li data-md>
                      <p>如果 <var>options</var>["<code
                          class="idl"><a data-link-type="idl" href="#dom-clientqueryoptions-includeuncontrolled" id="ref-for-dom-clientqueryoptions-includeuncontrolled">includeUncontrolled</a></code>"]
                        为 false，并且 <var>client</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
                          id="ref-for-concept-environment-active-service-worker②②">活动 service worker</a> 不是关联的 <a
                          data-link-type="dfn" href="#serviceworkerglobalscope-service-worker"
                          id="ref-for-serviceworkerglobalscope-service-worker①①">service worker</a>，<a
                          data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue"
                          id="ref-for-iteration-continue③">继续</a>。</p>
                    <li data-md>
                      <p>将 <var>client</var> 添加到 <var>targetClients</var>。</p>
                  </ol>
                <li data-md>
                  <p>让 <var>matchedWindowData</var> 成为一个新的 <a data-link-type="dfn"
                      href="https://infra.spec.whatwg.org/#list" id="ref-for-list③">列表</a>。</p>
                <li data-md>
                  <p>让 <var>matchedClients</var> 成为一个新的 <a data-link-type="dfn"
                      href="https://infra.spec.whatwg.org/#list" id="ref-for-list④">列表</a>。</p>
                <li data-md>
                  <p>对于 <var>targetClients</var> 中的每个 <a data-link-type="dfn" href="#dfn-service-worker-client"
                      id="ref-for-dfn-service-worker-client③⓪">service worker client</a> <var>client</var>：</p>
                  <ol>
                    <li data-md>
                      <p>如果 <var>options</var>["<code
                          class="idl"><a data-link-type="idl" href="#dom-clientqueryoptions-type" id="ref-for-dom-clientqueryoptions-type">type</a></code>"]
                        是 <code
                          class="idl"><a data-link-type="idl" href="#dom-clienttype-window" id="ref-for-dom-clienttype-window②">"window"</a></code>
                        或 <code
                          class="idl"><a data-link-type="idl" href="#dom-clienttype-all" id="ref-for-dom-clienttype-all">"all"</a></code>，并且
                        <var>client</var> 不是 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                          id="ref-for-environment-settings-object⑧">环境设置对象</a> 或是一个 <a data-link-type="dfn"
                          href="#dfn-window-client" id="ref-for-dfn-window-client①⓪">window client</a>，则：
                      </p>
                      <ol>
                        <li data-md>
                          <p>让 <var>windowData</var> 成为 «[ "client" → <var>client</var>, "ancestorOriginsList" → 一个新的 <a
                              data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑤">列表</a>
                            ]»。</p>
                        <li data-md>
                          <p>让 <var>browsingContext</var> 为 null。</p>
                        <li data-md>
                          <p>让 <var>isClientEnumerable</var> 为 true。</p>
                        <li data-md>
                          <p>如果 <var>client</var> 是一个 <a data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                              id="ref-for-environment-settings-object⑨">环境设置对象</a>，将 <var>browsingContext</var> 设置为
                            <var>client</var> 的 <a data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                              id="ref-for-concept-settings-object-global⑥">全局对象</a>的 <a data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context"
                              id="ref-for-browsing-context⑥">浏览上下文</a>。
                          </p>
                        <li data-md>
                          <p>否则，将 <var>browsingContext</var> 设置为 <var>client</var> 的 <a data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context"
                              id="ref-for-concept-environment-target-browsing-context">目标浏览上下文</a>。</p>
                        <li data-md>
                          <p><a data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                              id="ref-for-queue-a-task①①">队列任务</a> <var>task</var> 以在 <var>browsingContext</var> 的 <a
                              data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop"
                              id="ref-for-event-loop⑦">事件循环</a>中使用 <a data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source"
                              id="ref-for-user-interaction-task-source②">用户交互任务来源</a>运行以下子步骤：</p>
                          <ol>
                            <li data-md>
                              <p>如果 <var>browsingContext</var> 已被 <a data-link-type="dfn"
                                  href="https://html.spec.whatwg.org/multipage/window-object.html#a-browsing-context-is-discarded"
                                  id="ref-for-a-browsing-context-is-discarded">丢弃</a>，则将 <var>isClientEnumerable</var>
                                设置为 false 并中止这些步骤。</p>
                            <li data-md>
                              <p>如果 <var>client</var> 是一个 window client 并且 <var>client</var> 的 <a
                                  data-link-type="dfn">负责文档</a> 不是 <var>browsingContext</var> 的 <a data-link-type="dfn"
                                  href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                                  id="ref-for-active-document⑦">活动文档</a>，则将 <var>isClientEnumerable</var> 设置为 false
                                并中止这些步骤。</p>
                            <li data-md>
                              <p>将 <var>windowData</var>["<code>frameType</code>"] 设置为运行 <a data-link-type="dfn"
                                  href="#get-frame-type" id="ref-for-get-frame-type②">获取框架类型</a>与
                                <var>browsingContext</var> 的结果。
                              </p>
                            <li data-md>
                              <p>将 <var>windowData</var>["<code>visibilityState</code>"] 设置为 <var>browsingContext</var>
                                的 <a data-link-type="dfn"
                                  href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                                  id="ref-for-active-document⑧">活动文档</a>的 <code
                                  class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/page-visibility/#dom-document-visibilitystate" id="ref-for-dom-document-visibilitystate③">visibilityState</a></code>
                                属性值。</p>
                            <li data-md>
                              <p>将 <var>windowData</var>["<code>focusState</code>"] 设置为运行 <a data-link-type="dfn"
                                  href="https://html.spec.whatwg.org/multipage/interaction.html#has-focus-steps"
                                  id="ref-for-has-focus-steps②">具有焦点步骤</a>与 <var>browsingContext</var> 的 <a
                                  data-link-type="dfn"
                                  href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                                  id="ref-for-active-document⑨">活动文档</a>作为参数的结果。</p>
                            <li data-md>
                              <p>如果 <var>client</var> 是一个 <a data-link-type="dfn" href="#dfn-window-client"
                                  id="ref-for-dfn-window-client①①">window client</a>，则将
                                <var>windowData</var>["<code>ancestorOriginsList</code>"] 设置为 <var>browsingContext</var>
                                的 <a data-link-type="dfn"
                                  href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                                  id="ref-for-active-document①⓪">活动文档</a>的 <a data-link-type="dfn"
                                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"
                                  id="ref-for-concept-relevant-global⑥">相关全局对象</a>的 <code
                                  class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/history.html#location" id="ref-for-location②">位置</a></code>对象的
                                <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html"
                                  id="ref-for-concept-location-ancestor-origins-list②">祖先来源列表</a>的关联列表。
                              </p>
                          </ol>
                        <li data-md>
                          <p>等待 <var>task</var> 执行。</p>
                          <p class="note" role="note"><span>注意：</span>等待是阻塞等待，但实现者可以并行运行迭代，只要状态不被破坏。</p>
                        <li data-md>
                          <p>如果 <var>isClientEnumerable</var> 为 true，则：</p>
                          <ol>
                            <li data-md>
                              <p>将 <var>windowData</var> 添加到 <var>matchedWindowData</var>。</p>
                          </ol>
                      </ol>
                    <li data-md>
                      <p>否则如果 <var>options</var>["<code
                          class="idl"><a data-link-type="idl" href="#dom-clientqueryoptions-type" id="ref-for-dom-clientqueryoptions-type①">type</a></code>"]
                        是 <code
                          class="idl"><a data-link-type="idl" href="#dom-clienttype-worker" id="ref-for-dom-clienttype-worker①">"worker"</a></code>
                        或 <code
                          class="idl"><a data-link-type="idl" href="#dom-clienttype-all" id="ref-for-dom-clienttype-all①">"all"</a></code>，并且
                        <var>client</var> 是一个 <a data-link-type="dfn" href="#dfn-dedicatedworker-client"
                          id="ref-for-dfn-dedicatedworker-client②">专用 worker 客户端</a>，或者 <var>options</var>["<code
                          class="idl"><a data-link-type="idl" href="#dom-clientqueryoptions-type" id="ref-for-dom-clientqueryoptions-type②">type</a></code>"]
                        是 <code
                          class="idl"><a data-link-type="idl" href="#dom-clienttype-sharedworker" id="ref-for-dom-clienttype-sharedworker①">"sharedworker"</a></code>
                        或 <code
                          class="idl"><a data-link-type="idl" href="#dom-clienttype-all" id="ref-for-dom-clienttype-all②">"all"</a></code>，并且
                        <var>client</var> 是一个 <a data-link-type="dfn" href="#dfn-sharedworker-client"
                          id="ref-for-dfn-sharedworker-client②">共享 worker 客户端</a>，则：
                      </p>
                      <ol>
                        <li data-md>
                          <p>将 <var>client</var> 添加到 <var>matchedClients</var>。</p>
                      </ol>
                  </ol>
                <li data-md>
                  <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                      id="ref-for-queue-a-task①②">队列任务</a>以在 <var>promise</var> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                      id="ref-for-relevant-settings-object①⑧">相关设置对象</a>的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                      id="ref-for-responsible-event-loop④">负责的事件循环</a>中使用 <a data-link-type="dfn">DOM 操作任务来源</a>运行以下步骤：
                  </p>
                  <ol>
                    <li data-md>
                      <p>让 <var>clientObjects</var> 成为一个新的 <a data-link-type="dfn"
                          href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑥">列表</a>。</p>
                    <li data-md>
                      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                          id="ref-for-list-iterate①">对于每个</a> <var>windowData</var> 在 <var>matchedWindowData</var> 中：
                      </p>
                      <ol>
                        <li data-md>
                          <p>让 <var>windowClient</var> 成为运行 <a data-link-type="dfn" href="#create-window-client"
                              id="ref-for-create-window-client②">创建 Window Client</a> 算法与
                            <var>windowData</var>["<code>client</code>"]，<var>windowData</var>["<code>frameType</code>"]，<var>windowData</var>["<code>visibilityState</code>"]，<var>windowData</var>["<code>focusState</code>"]
                            和 <var>windowData</var>["<code>ancestorOriginsList</code>"] 作为参数的结果。
                          </p>
                        <li data-md>
                          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append"
                              id="ref-for-list-append②">附加</a> <var>windowClient</var> 到 <var>clientObjects</var>。</p>
                      </ol>
                    <li data-md>
                      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                          id="ref-for-list-iterate②">对于每个</a> <var>client</var> 在 <var>matchedClients</var> 中：</p>
                      <ol>
                        <li data-md>
                          <p>让 <var>clientObject</var> 成为运行 <a data-link-type="dfn" href="#create-client"
                              id="ref-for-create-client">创建 Client</a> 算法与 <var>client</var> 作为参数的结果。</p>
                        <li data-md>
                          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append"
                              id="ref-for-list-append③">附加</a> <var>clientObject</var> 到 <var>clientObjects</var>。</p>
                      </ol>
                    <li data-md>
                      <p>对 <var>clientObjects</var> 进行排序，使得：</p>
                      <ul>
                        <li data-md>
                          <p><code
                              class="idl"><a data-link-type="idl" href="#windowclient" id="ref-for-windowclient⑧">WindowClient</a></code>
                            对象的 <a data-link-type="dfn" href="#dfn-service-worker-client-browsing-context"
                              id="ref-for-dfn-service-worker-client-browsing-context⑥">浏览上下文</a>已被 <a
                              data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/interaction.html#focusing-steps"
                              id="ref-for-focusing-steps①">聚焦</a> 的先放置，按最近 <a data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/interaction.html#focusing-steps"
                              id="ref-for-focusing-steps②">聚焦</a>的顺序排序。</p>
                        <li data-md>
                          <p><code
                              class="idl"><a data-link-type="idl" href="#windowclient" id="ref-for-windowclient⑨">WindowClient</a></code>
                            对象的 <a data-link-type="dfn" href="#dfn-service-worker-client-browsing-context"
                              id="ref-for-dfn-service-worker-client-browsing-context⑦">浏览上下文</a>从未被 <a
                              data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/interaction.html#focusing-steps"
                              id="ref-for-focusing-steps③">聚焦</a>的下一个放置，按其 <a data-link-type="dfn"
                              href="#dfn-service-worker-client-service-worker-client"
                              id="ref-for-dfn-service-worker-client-service-worker-client①⓪">service worker 客户端</a>
                            的创建顺序排序。</p>
                        <li data-md>
                          <p><code
                              class="idl"><a data-link-type="idl" href="#client" id="ref-for-client⑦">Client</a></code>
                            对象的关联 <a data-link-type="dfn" href="#dfn-service-worker-client-service-worker-client"
                              id="ref-for-dfn-service-worker-client-service-worker-client①①">service worker 客户端</a> 是 <a
                              data-link-type="dfn" href="#dfn-worker-client" id="ref-for-dfn-worker-client①⓪">worker
                              client</a> 的最后放置，按其 <a data-link-type="dfn"
                              href="#dfn-service-worker-client-service-worker-client"
                              id="ref-for-dfn-service-worker-client-service-worker-client①②">service worker 客户端</a>
                            的创建顺序排序。</p>
                      </ul>
                      <p class="note" role="note"><span>注意：</span> <a data-link-type="dfn" href="#dfn-window-client"
                          id="ref-for-dfn-window-client①②">窗口客户端</a>总是放在 <a data-link-type="dfn"
                          href="#dfn-worker-client" id="ref-for-dfn-worker-client①①">worker 客户端</a>之前。</p>
                    <li data-md>
                      <p>用 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-create-frozen-array"
                          id="ref-for-dfn-create-frozen-array①">一个新的冻结数组</a>解析 <var>promise</var>，该数组包含
                        <var>promise</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm"
                          id="ref-for-concept-relevant-realm②">相关领域</a>中的 <var>clientObjects</var>。
                      </p>
                  </ol>
              </ol>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
          </ol>
        </section>

        <section class="algorithm" data-algorithm="clients-openwindow">
          <h4 class="heading settled" data-level="4.3.3" id="clients-openwindow">
            <span class="secno">4.3.3. </span>
            <span class="content">
              <code class="idl">
                <a data-link-type="idl" href="#dom-clients-openwindow" id="ref-for-dom-clients-openwindow①">openWindow(url)</a>
              </code>
            </span>
            <a class="self-link" href="#clients-openwindow"></a>
          </h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn">
              <b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span>
            </button>
            <div class="feature">
              <p>
                <a href="https://developer.mozilla.org/en-US/docs/Web/API/Clients/openWindow"
                  title="The openWindow() method of the Clients interface creates a new top level browsing context and loads a given URL. If the calling script doesn&apos;t have permission to show popups, openWindow() will throw an InvalidAccessError.">
                  Clients/openWindow
                </a>
              </p>
              <p class="all-engines-text">In all current engines.</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>45+</span></span>
                <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
                <span class="chrome yes"><span>Chrome</span><span>51+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>38+</span></span>
                <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span>
                <span class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>45+</span></span>
                <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
                <span class="chrome_android yes"><span>Chrome for Android</span><span>51+</span></span>
                <span class="webview_android yes"><span>Android WebView</span><span>51+</span></span>
                <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>5.0+</span></span>
                <span class="opera_android yes"><span>Opera Mobile</span><span>41+</span></span>
              </div>
            </div>
          </div>
          <p>
            <dfn class="dfn-paneled idl-code" data-dfn-for="Clients" data-dfn-type="method" data-export
              id="dom-clients-openwindow">
              <code>openWindow(<var>url</var>)</code>
            </dfn>
            方法的步骤为：
          </p>
          <ol>
            <li data-md>
              <p>将 <var>url</var> 解析为 <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser"
                  id="ref-for-concept-url-parser④">解析</a> <var>url</var> 与 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#this" id="ref-for-this④⑨">this</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                  id="ref-for-relevant-settings-object①⑨">相关设置对象</a>的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url"
                  id="ref-for-api-base-url④">API 基本 URL</a>。</p>
            <li data-md>
              <p>如果 <var>url</var> 解析失败，返回一个 <a data-link-type="dfn"
                  href="http://tc39.github.io/ecma262/#sec-promise-objects" id="ref-for-sec-promise-objects①③">被拒绝的
                  promise</a> 并附带 <code>TypeError</code>。</p>
            <li data-md>
              <p>如果 <var>url</var> 是 <code>about:blank</code>，返回一个 <a data-link-type="dfn"
                  href="http://tc39.github.io/ecma262/#sec-promise-objects" id="ref-for-sec-promise-objects①④">被拒绝的
                  promise</a> 并附带 <code>TypeError</code>。</p>
            <li data-md>
              <p>如果该算法未被 <a data-link-type="dfn">用户激活触发</a>，返回一个 <a data-link-type="dfn"
                  href="http://tc39.github.io/ecma262/#sec-promise-objects" id="ref-for-sec-promise-objects①⑤">被拒绝的
                  promise</a> 并附带 "<code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidaccesserror" id="ref-for-invalidaccesserror①">InvalidAccessError</a></code>"
                <code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException⑦">DOMException</a></code>。
              </p>
            <li data-md>
              <p>将 <var>serviceWorkerEventLoop</var> 设置为 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#current-global-object"
                  id="ref-for-current-global-object①">当前全局对象</a>的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop"
                  id="ref-for-event-loop⑧">事件循环</a>。</p>
            <li data-md>
              <p>将 <var>promise</var> 设置为一个新的 <a data-link-type="dfn"
                  href="http://tc39.github.io/ecma262/#sec-promise-objects"
                  id="ref-for-sec-promise-objects①⑥">promise</a>。</p>
            <li data-md>
              <p>在 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                  id="ref-for-in-parallel①②">并行</a>中运行以下子步骤：</p>
              <ol>
                <li data-md>
                  <p>将 <var>newContext</var> 设置为一个新的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context"
                      id="ref-for-top-level-browsing-context">顶级浏览上下文</a>。</p>
                <li data-md>
                  <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                      id="ref-for-queue-a-task①③">队列任务</a> 以在 <var>newContext</var> 的 <code
                      class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window④">Window</a></code>
                    对象的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                      id="ref-for-environment-settings-object①⓪">环境设置对象</a> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                      id="ref-for-responsible-event-loop⑤">负责的事件循环</a>中使用 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source"
                      id="ref-for-user-interaction-task-source③">用户交互任务来源</a>运行以下步骤：</p>
                  <ol>
                    <li data-md>
                      <p><em>HandleNavigate</em>：<a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate"
                          id="ref-for-navigate⑤">导航</a> <var>newContext</var> 到 <var>url</var>，并启用 <a
                          data-link-type="dfn">异常处理</a> 和 <a data-link-type="dfn">替换启用</a>。</p>
                    <li data-md>
                      <p>如果在标签为 <em>HandleNavigate</em> 的步骤中调用的算法 <a data-link-type="dfn"
                          href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw①">抛出</a>异常，<a
                          data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                          id="ref-for-queue-a-task①④">队列任务</a>以在 <var>serviceWorkerEventLoop</var> 中使用 <a
                          data-link-type="dfn">DOM 操作任务来源</a>拒绝 <var>promise</var> 并附带异常，之后中止这些步骤。</p>
                    <li data-md>
                      <p>将 <var>frameType</var> 设置为运行 <a data-link-type="dfn" href="#get-frame-type"
                          id="ref-for-get-frame-type③">获取 Frame 类型</a>与 <var>newContext</var> 作为参数的结果。</p>
                    <li data-md>
                      <p>将 <var>visibilityState</var> 设置为 <var>newContext</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                          id="ref-for-active-document①①">活动文档</a> 的 <code
                          class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/page-visibility/#dom-document-visibilitystate" id="ref-for-dom-document-visibilitystate④">visibilityState</a></code>
                        属性值。</p>
                    <li data-md>
                      <p>将 <var>focusState</var> 设置为运行 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/interaction.html#has-focus-steps"
                          id="ref-for-has-focus-steps③">具有焦点步骤</a>与 <var>newContext</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                          id="ref-for-active-document①②">活动文档</a> 作为参数的结果。</p>
                    <li data-md>
                      <p>将 <var>ancestorOriginsList</var> 设置为 <var>newContext</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                          id="ref-for-active-document①③">活动文档</a> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"
                          id="ref-for-concept-relevant-global⑦">相关全局对象</a> 的 <code
                          class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/history.html#location" id="ref-for-location③">Location</a></code>
                        对象的 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html"
                          id="ref-for-concept-location-ancestor-origins-list③">祖先来源列表</a> 的关联列表。</p>
                    <li data-md>
                      <p><a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                          id="ref-for-queue-a-task①⑤">队列任务</a>以在 <var>serviceWorkerEventLoop</var> 中使用 <a
                          data-link-type="dfn">DOM 操作任务来源</a>运行以下步骤：</p>
                      <ol>
                        <li data-md>
                          <p>如果运行 <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#obtain-a-storage-key"
                              id="ref-for-obtain-a-storage-key⑤">获取存储密钥</a>的结果给定 <var>newContext</var> 的 <code
                              class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window⑤">Window</a></code>
                            对象的 <a data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                              id="ref-for-environment-settings-object①①">环境设置对象</a> 不 <a data-link-type="dfn"
                              href="https://storage.spec.whatwg.org/#storage-key-equal"
                              id="ref-for-storage-key-equal③">等于</a> <a data-link-type="dfn"
                              href="#serviceworkerglobalscope-service-worker"
                              id="ref-for-serviceworkerglobalscope-service-worker①②">service worker</a> 的 <a
                              data-link-type="dfn" href="#dfn-containing-service-worker-registration"
                              id="ref-for-dfn-containing-service-worker-registration⑧">包含的 service worker 注册</a>的 <a
                              data-link-type="dfn" href="#service-worker-registration-storage-key"
                              id="ref-for-service-worker-registration-storage-key⑥">存储密钥</a>，则用 null 解析
                            <var>promise</var> 并中止这些步骤。
                          </p>
                        <li data-md>
                          <p>将 <var>client</var> 设置为运行 <a data-link-type="dfn" href="#create-window-client"
                              id="ref-for-create-window-client③">创建窗口客户端</a> 算法与 <var>newContext</var> 的 <code
                              class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window⑥">Window</a></code>
                            对象的 <a data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                              id="ref-for-environment-settings-object①②">环境设置对象</a>，<var>frameType</var>，<var>visibilityState</var>，<var>focusState</var>
                            和 <var>ancestorOriginsList</var> 作为参数的结果。</p>
                        <li data-md>
                          <p>用 <var>client</var> 解析 <var>promise</var>。</p>
                      </ol>
                  </ol>
              </ol>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
          </ol>
        </section>

        <section class="algorithm" data-algorithm="clients-claim">
          <h4 class="heading settled" data-level="4.3.4" id="clients-claim">
            <span class="secno">4.3.4. </span>
            <span class="content">
              <code class="idl">
                <a data-link-type="idl" href="#dom-clients-claim" id="ref-for-dom-clients-claim①">claim()</a>
              </code>
            </span>
            <a class="self-link" href="#clients-claim"></a>
          </h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn">
              <b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span>
            </button>
            <div class="feature">
              <p>
                <a href="https://developer.mozilla.org/en-US/docs/Web/API/Clients/claim"
                  title="The claim() method of the Clients interface allows an active service worker to set itself as the controller for all clients within its scope. This triggers a &quot;controllerchange&quot; event on navigator.serviceWorker in any clients that become controlled by this service worker.">
                  Clients/claim
                </a>
              </p>
              <p class="all-engines-text">In all current engines.</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
                <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
                <span class="chrome yes"><span>Chrome</span><span>42+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>29+</span></span>
                <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span>
                <span class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
                <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
                <span class="chrome_android yes"><span>Chrome for Android</span><span>42+</span></span>
                <span class="webview_android yes"><span>Android WebView</span><span>42+</span></span>
                <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span>
                <span class="opera_android yes"><span>Opera Mobile</span><span>29+</span></span>
              </div>
            </div>
          </div>
          <p>
            <dfn class="dfn-paneled idl-code" data-dfn-for="Clients" data-dfn-type="method" data-export
              id="dom-clients-claim">
              <code>claim()</code>
            </dfn>
            方法的步骤为：
          </p>
          <ol>
            <li data-md>
              <p>
                如果 <a data-link-type="dfn" href="#serviceworkerglobalscope-service-worker"
                  id="ref-for-serviceworkerglobalscope-service-worker①③">service worker</a> 不是 <a data-link-type="dfn"
                  href="#dfn-active-worker" id="ref-for-dfn-active-worker①⑥">活跃的 worker</a>，返回一个 <a data-link-type="dfn"
                  href="http://tc39.github.io/ecma262/#sec-promise-objects"
                  id="ref-for-sec-promise-objects①⑦">promise</a>，并附带 "<code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror⑤">InvalidStateError</a></code>"
                <code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException⑧">DOMException</a></code>。
              </p>
            <li data-md>
              <p>将 <var>promise</var> 设置为一个新的 <a data-link-type="dfn"
                  href="http://tc39.github.io/ecma262/#sec-promise-objects"
                  id="ref-for-sec-promise-objects①⑧">promise</a>。</p>
            <li data-md>
              <p>在 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                  id="ref-for-in-parallel①③">并行</a>中运行以下子步骤：</p>
              <ol>
                <li data-md>
                  <p>
                    对于每个 <a data-link-type="dfn" href="#dfn-service-worker-client"
                      id="ref-for-dfn-service-worker-client③①">service worker 客户端</a> <var>client</var>，当运行 <a
                      data-link-type="dfn" href="https://storage.spec.whatwg.org/#obtain-a-storage-key"
                      id="ref-for-obtain-a-storage-key⑥">获取存储密钥</a> 的结果给定 <var>client</var> <a data-link-type="dfn"
                      href="https://storage.spec.whatwg.org/#storage-key-equal" id="ref-for-storage-key-equal④">等于</a>
                    <a data-link-type="dfn" href="#serviceworkerglobalscope-service-worker"
                      id="ref-for-serviceworkerglobalscope-service-worker①④">service worker</a> 的 <a
                      data-link-type="dfn" href="#dfn-containing-service-worker-registration"
                      id="ref-for-dfn-containing-service-worker-registration⑨">包含的 service worker 注册</a> 的 <a
                      data-link-type="dfn" href="#service-worker-registration-storage-key"
                      id="ref-for-service-worker-registration-storage-key⑦">存储密钥</a>时：
                  </p>
                  <ol>
                    <li data-md>
                      <p>
                        如果 <var>client</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-execution-ready-flag"
                          id="ref-for-concept-environment-execution-ready-flag③">执行准备标志</a> 未设置或 <var>client</var> 的 <a
                          data-link-type="dfn" href="#service-worker-client-discarded-flag"
                          id="ref-for-service-worker-client-discarded-flag④">丢弃标志</a> 已设置，<a data-link-type="dfn"
                          href="https://infra.spec.whatwg.org/#iteration-continue"
                          id="ref-for-iteration-continue④">继续</a>。
                      </p>
                    <li data-md>
                      <p>
                        如果 <var>client</var> 不是 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context"
                          id="ref-for-secure-context①">安全上下文</a>，<a data-link-type="dfn"
                          href="https://infra.spec.whatwg.org/#iteration-continue"
                          id="ref-for-iteration-continue⑤">继续</a>。
                      </p>
                    <li data-md>
                      <p>将 <var>storage key</var> 设置为运行 <a data-link-type="dfn"
                          href="https://storage.spec.whatwg.org/#obtain-a-storage-key"
                          id="ref-for-obtain-a-storage-key⑦">获取存储密钥</a> 与 <var>client</var> 作为参数的结果。</p>
                    <li data-md>
                      <p>
                        将 <var>registration</var> 设置为运行 <a data-link-type="dfn"
                          href="#match-service-worker-registration" id="ref-for-match-service-worker-registration⑤">匹配
                          Service Worker 注册</a> 与 <var>storage key</var> 和 <var>client</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url"
                          id="ref-for-concept-environment-creation-url⑤">创建 URL</a> 作为参数的结果。
                      </p>
                    <li data-md>
                      <p>
                        如果 <var>registration</var> 不是 <a data-link-type="dfn"
                          href="#serviceworkerglobalscope-service-worker"
                          id="ref-for-serviceworkerglobalscope-service-worker①⑤">service worker</a> 的 <a
                          data-link-type="dfn" href="#dfn-containing-service-worker-registration"
                          id="ref-for-dfn-containing-service-worker-registration①⓪">包含的 service worker 注册</a>，<a
                          data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue"
                          id="ref-for-iteration-continue⑥">继续</a>。
                      </p>
                      <p class="note" role="note"><span>注意：</span> 如果 <a data-link-type="dfn"
                          href="#serviceworkerglobalscope-service-worker"
                          id="ref-for-serviceworkerglobalscope-service-worker①⑥">service worker</a> 的 <a
                          data-link-type="dfn" href="#dfn-containing-service-worker-registration"
                          id="ref-for-dfn-containing-service-worker-registration①①">包含的 service worker 注册</a> <a
                          data-link-type="dfn" href="#dfn-service-worker-registration-unregistered"
                          id="ref-for-dfn-service-worker-registration-unregistered①">未注册</a>，则 <var>registration</var>
                        将为 null。</p>
                    <li data-md>
                      <p>
                        如果 <var>client</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
                          id="ref-for-concept-environment-active-service-worker②③">活跃 service worker</a> 不是 <a
                          data-link-type="dfn" href="#serviceworkerglobalscope-service-worker"
                          id="ref-for-serviceworkerglobalscope-service-worker①⑦">service worker</a>，那么：
                      </p>
                      <ol>
                        <li data-md>
                          <p>调用 <a data-link-type="dfn" href="#handle-service-worker-client-unload"
                              id="ref-for-handle-service-worker-client-unload">处理 Service Worker 客户端卸载</a> 与
                            <var>client</var> 作为参数。
                          </p>
                        <li data-md>
                          <p>将 <var>client</var> 的 <a data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
                              id="ref-for-concept-environment-active-service-worker②④">活跃 service worker</a> 设置为 <a
                              data-link-type="dfn" href="#serviceworkerglobalscope-service-worker"
                              id="ref-for-serviceworkerglobalscope-service-worker①⑧">service worker</a>。</p>
                        <li data-md>
                          <p>调用 <a data-link-type="dfn" href="#notify-controller-change"
                              id="ref-for-notify-controller-change">通知控制器变更</a> 算法与 <var>client</var> 作为参数。</p>
                      </ol>
                  </ol>
                <li data-md>
                  <p>用 undefined 解析 <var>promise</var>。</p>
              </ol>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
          </ol>
        </section>
      </section>
      <section>
        <h3 class="heading settled" data-level="4.4" id="extendableevent-interface">
          <span class="secno">4.4. </span>
          <span class="content">
            <code class="idl">
              <a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent①">ExtendableEvent</a>
            </code>
          </span>
          <a class="self-link" href="#extendableevent-interface"></a>
        </h3>
        <div class="mdn-anno wrapped after">
          <button class="mdn-anno-btn">
            <b class="all-engines-flag" title="该功能在所有当前引擎中均可用。">✔</b><span>MDN</span>
          </button>
          <div class="feature">
            <p>
              <a href="https://developer.mozilla.org/en-US/docs/Web/API/ExtendableEvent"
                title="ExtendableEvent 接口扩展了在全局作用域内调度的安装和激活事件的生命周期，作为 service worker 生命周期的一部分。这确保在升级数据库模式和删除过时的缓存条目之前，不会调度任何功能性事件（如 FetchEvent）。">
                ExtendableEvent
              </a>
            </p>
            <p class="all-engines-text">在所有当前引擎中可用。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
              <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
              <span class="chrome yes"><span>Chrome</span><span>40+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>24+</span></span>
              <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (旧版)</span><span>17+</span></span>
              <span class="ie no"><span>IE</span><span>无</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
              <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
              <span class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span>
              <span class="webview_android yes"><span>Android WebView</span><span>40+</span></span>
              <span class="samsunginternet_android yes"><span>三星 Internet</span><span>4.0+</span></span>
              <span class="opera_android yes"><span>Opera Mobile</span><span>24+</span></span>
            </div>
          </div>
        </div>
        <div class="mdn-anno wrapped">
          <button class="mdn-anno-btn">
            <b class="all-engines-flag" title="该功能在所有当前引擎中均可用。">✔</b><span>MDN</span>
          </button>
          <div class="feature">
            <p>
              <a href="https://developer.mozilla.org/en-US/docs/Web/API/ExtendableEvent/ExtendableEvent"
                title="ExtendableEvent() 构造函数创建一个新的 ExtendableEvent 对象。">
                ExtendableEvent/ExtendableEvent
              </a>
            </p>
            <p class="all-engines-text">在所有当前引擎中可用。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
              <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
              <span class="chrome yes"><span>Chrome</span><span>40+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>24+</span></span>
              <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (旧版)</span><span>17+</span></span>
              <span class="ie no"><span>IE</span><span>无</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
              <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
              <span class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span>
              <span class="webview_android yes"><span>Android WebView</span><span>40+</span></span>
              <span class="samsunginternet_android yes"><span>三星 Internet</span><span>4.0+</span></span>
              <span class="opera_android yes"><span>Opera Mobile</span><span>24+</span></span>
            </div>
          </div>
        </div>

        <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed⑧"><c- g>Exposed</c-></a>=<c- n>ServiceWorker</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="extendableevent"><code><c- g>ExtendableEvent</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event" id="ref-for-event⑤"><c- n>Event</c-></a> {
  <dfn class="idl-code" data-dfn-for="ExtendableEvent" data-dfn-type="constructor" data-export data-lt="ExtendableEvent(type, eventInitDict)|constructor(type, eventInitDict)|ExtendableEvent(type)|constructor(type)" id="dom-extendableevent-extendableevent"><code><c- g>constructor</c-></code><a class="self-link" href="#dom-extendableevent-extendableevent"></a></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="ExtendableEvent/ExtendableEvent(type, eventInitDict), ExtendableEvent/constructor(type, eventInitDict), ExtendableEvent/ExtendableEvent(type), ExtendableEvent/constructor(type)" data-dfn-type="argument" data-export id="dom-extendableevent-extendableevent-type-eventinitdict-type"><code><c- g>type</c-></code><a class="self-link" href="#dom-extendableevent-extendableevent-type-eventinitdict-type"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-extendableeventinit" id="ref-for-dictdef-extendableeventinit"><c- n>ExtendableEventInit</c-></a> <dfn class="idl-code" data-dfn-for="ExtendableEvent/ExtendableEvent(type, eventInitDict), ExtendableEvent/constructor(type, eventInitDict), ExtendableEvent/ExtendableEvent(type), ExtendableEvent/constructor(type)" data-dfn-type="argument" data-export id="dom-extendableevent-extendableevent-type-eventinitdict-eventinitdict"><code><c- g>eventInitDict</c-></code><a class="self-link" href="#dom-extendableevent-extendableevent-type-eventinitdict-eventinitdict"></a></dfn> = {});
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined①③"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-extendableevent-waituntil" id="ref-for-dom-extendableevent-waituntil"><c- g>waitUntil</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①⑦"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any④"><c- b>any</c-></a>> <dfn class="idl-code" data-dfn-for="ExtendableEvent/waitUntil(f)" data-dfn-type="argument" data-export id="dom-extendableevent-waituntil-f-f"><code><c- g>f</c-></code><a class="self-link" href="#dom-extendableevent-waituntil-f-f"></a></dfn>);
};
</pre>
        <pre class="idl highlight def" id="extendable-event-init-dictionary"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-extendableeventinit"><code><c- g>ExtendableEventInit</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit" id="ref-for-dictdef-eventinit"><c- n>EventInit</c-></a> {
  // Defined for the forward compatibility across the derived events
};
</pre>
        <p>
          一个 <code
            class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent②">ExtendableEvent</a></code>
          对象有一个关联的 <dfn class="dfn-paneled" data-dfn-for="ExtendableEvent" data-dfn-type="dfn" data-export
            id="extendableevent-extend-lifetime-promises">延长生命周期的 promises</dfn>（一个 <a data-link-type="dfn"
            href="http://tc39.github.io/ecma262/#sec-promise-objects" id="ref-for-sec-promise-objects①⑨">promises</a>
          数组）。它最初是一个空数组。
        </p>
        <p>
          一个 <code
            class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent③">ExtendableEvent</a></code>
          对象有一个关联的 <dfn class="dfn-paneled" data-dfn-for="ExtendableEvent" data-dfn-type="dfn" data-noexport
            id="extendableevent-pending-promises-count">待处理 promises 计数</dfn>（<a data-link-type="dfn"
            href="#extendableevent-extend-lifetime-promises"
            id="ref-for-extendableevent-extend-lifetime-promises">延长生命周期的 promises</a> 中待处理的 promises 数量）。它最初设置为零。
        </p>
        <p>
          一个 <code
            class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent④">ExtendableEvent</a></code>
          对象有一个关联的 <dfn class="dfn-paneled" data-dfn-for="ExtendableEvent" data-dfn-type="dfn" data-export
            id="extendableevent-timed-out-flag">超时标志</dfn>。它最初未设置，如果 <a data-link-type="dfn"
            href="#extendableevent-pending-promises-count" id="ref-for-extendableevent-pending-promises-count">待处理
            promises 计数</a> 大于零，则在用户代理可选施加的延迟之后设置。
        </p>
        <p>
          当一个 <code
            class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent⑤">ExtendableEvent</a></code>
          对象的 <a data-link-type="dfn" href="#extendableevent-timed-out-flag"
            id="ref-for-extendableevent-timed-out-flag">超时标志</a> 未设置且其 <a data-link-type="dfn"
            href="#extendableevent-pending-promises-count" id="ref-for-extendableevent-pending-promises-count①">待处理
            promises 计数</a> 大于零或其 <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#dispatch-flag"
            id="ref-for-dispatch-flag">调度标志</a> 被设置时，称该对象为 <dfn class="dfn-paneled" data-dfn-for="ExtendableEvent"
            data-dfn-type="dfn" data-export id="extendableevent-active">活跃</dfn>。
        </p>
        <p>
          <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑥②">服务工作线程</a> 有两个 <a
            data-link-type="dfn" href="#dfn-lifecycle-events" id="ref-for-dfn-lifecycle-events">生命周期事件</a>，<code
            class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-install-event" id="ref-for-service-worker-global-scope-install-event②">install</a></code>
          和 <code
            class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-activate-event" id="ref-for-service-worker-global-scope-activate-event②">activate</a></code>。<a
            data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑥③">服务工作线程</a> 在 <code
            class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent⑥">ExtendableEvent</a></code>
          接口中使用 <code
            class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-activate-event" id="ref-for-service-worker-global-scope-activate-event③">activate</a></code>
          事件和 <code
            class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-install-event" id="ref-for-service-worker-global-scope-install-event③">install</a></code>
          事件。
        </p>
        <p>
          <a href="#extensibility">服务工作线程扩展</a> 可能 <em>会</em> 使用或扩展 <code
            class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent⑦">ExtendableEvent</a></code>
          接口，这些扩展 <a href="#extension-to-service-worker-global-scope">定义了事件处理程序</a>。
        </p>

        <section class="algorithm" data-algorithm="wait-until-method">
          <h4 class="heading settled" data-level="4.4.1" id="wait-until-method"><span class="secno">4.4.1. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-extendableevent-waituntil" id="ref-for-dom-extendableevent-waituntil①">event.waitUntil(f)</a></code></span><a
              class="self-link" href="#wait-until-method"></a></h4>
          <p class="note" role="note"><span>注意：</span> <code
              class="idl"><a data-link-type="idl" href="#dom-extendableevent-waituntil" id="ref-for-dom-extendableevent-waituntil②">waitUntil()</a></code>
            方法会延长事件的生命周期。</p>
          <div class="mdn-anno wrapped">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="This feature is in all current engines.">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ExtendableEvent/waitUntil"
                  title="ExtendableEvent.waitUntil() 方法告知事件分发器工作正在进行中。它还可以用来检测该工作是否成功。在 Service Workers 中，waitUntil() 告诉浏览器在 promise 完成之前工作仍在进行，并且如果想要完成该工作，就不应终止 Service Worker。">ExtendableEvent/waitUntil</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>24+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>24+</span></span>
              </div>
            </div>
          </div>
          <p>
            <dfn class="dfn-paneled idl-code" data-dfn-for="ExtendableEvent" data-dfn-type="method" data-export
              id="dom-extendableevent-waituntil"><code>waitUntil(<var>f</var>)</code></dfn> 方法步骤是将生命周期 promise
            <var>f</var> 添加到 <a data-link-type="dfn" href="#extendableevent-add-lifetime-promise"
              id="ref-for-extendableevent-add-lifetime-promise">生命周期 promises</a> 到 <a data-link-type="dfn"
              href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑤⓪">this</a> 中。
          </p>
          <p>
            要将 <dfn class="dfn-paneled" data-dfn-for="ExtendableEvent" data-dfn-type="dfn" data-export
              id="extendableevent-add-lifetime-promise">生命周期 promise</dfn> <var>promise</var>（一个 <a data-link-type="dfn"
              href="http://tc39.github.io/ecma262/#sec-promise-objects"
              id="ref-for-sec-promise-objects②⓪">promise</a>）添加到 <var>event</var>（一个 <code
              class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent⑧">ExtendableEvent</a></code>），执行以下步骤：
          </p>
          <ol>
            <li data-md>
              <p>如果 <var>event</var> 的 <code
                  class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-istrusted" id="ref-for-dom-event-istrusted">isTrusted</a></code>
                属性为 false，<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw"
                  id="ref-for-dfn-throw②">抛出</a> 一个 "<code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror⑥">InvalidStateError</a></code>"
                <code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException⑨">DOMException</a></code>。
              </p>
            </li>
            <li data-md>
              <p>如果 <var>event</var> 不是 <a data-link-type="dfn" href="#extendableevent-active"
                  id="ref-for-extendableevent-active">活跃的</a>，<a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw③">抛出</a> 一个 "<code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror⑦">InvalidStateError</a></code>"
                <code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException①⓪">DOMException</a></code>。
              </p>
              <p class="note" role="note"><span>注意：</span>如果在调用事件处理程序的任务中尚未添加任何生命周期扩展 promise，那么在后续异步任务中调用 <code
                  class="idl"><a data-link-type="idl" href="#dom-extendableevent-waituntil" id="ref-for-dom-extendableevent-waituntil③">waitUntil()</a></code>
                将抛出错误。</p>
            </li>
            <li data-md>
              <p>将 <var>promise</var> 添加到 <var>event</var> 的 <a data-link-type="dfn"
                  href="#extendableevent-extend-lifetime-promises"
                  id="ref-for-extendableevent-extend-lifetime-promises①">延长生命周期的 promises</a>。</p>
            </li>
            <li data-md>
              <p>将 <var>event</var> 的 <a data-link-type="dfn" href="#extendableevent-pending-promises-count"
                  id="ref-for-extendableevent-pending-promises-count②">待处理 promises 计数</a> 增加一个。</p>
              <p class="note" role="note"><span>注意：</span>即使给定的 promise 已经解决，<a data-link-type="dfn"
                  href="#extendableevent-pending-promises-count"
                  id="ref-for-extendableevent-pending-promises-count③">待处理 promises 计数</a> 也会增加。相应的计数减少是在 promise
                反应所排队的微任务中进行的。</p>
            </li>
            <li data-md>
              <p>在 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#upon-fulfillment"
                  id="ref-for-upon-fulfillment">履行</a>或 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#upon-rejection" id="ref-for-upon-rejection">拒绝</a>
                <var>promise</var> 时，<a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-microtask"
                  id="ref-for-queue-a-microtask">排队一个微任务</a>以执行以下子步骤：
              </p>
              <ol>
                <li data-md>
                  <p>将 <var>event</var> 的 <a data-link-type="dfn" href="#extendableevent-pending-promises-count"
                      id="ref-for-extendableevent-pending-promises-count④">待处理 promises 计数</a> 减少一个。</p>
                </li>
                <li data-md>
                  <p>如果 <var>event</var> 的 <a data-link-type="dfn" href="#extendableevent-pending-promises-count"
                      id="ref-for-extendableevent-pending-promises-count⑤">待处理 promises 计数</a> 为 0，则：</p>
                  <ol>
                    <li data-md>
                      <p>让 <var>registration</var> 成为 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#current-global-object"
                          id="ref-for-current-global-object②">当前全局对象</a>的关联的 <a data-link-type="dfn"
                          href="#serviceworkerglobalscope-service-worker"
                          id="ref-for-serviceworkerglobalscope-service-worker①⑨">服务工作线程</a>的 <a data-link-type="dfn"
                          href="#dfn-containing-service-worker-registration"
                          id="ref-for-dfn-containing-service-worker-registration①②">包含服务工作线程注册</a>。</p>
                    </li>
                    <li data-md>
                      <p>如果 <var>registration</var> 是 <a data-link-type="dfn"
                          href="#dfn-service-worker-registration-unregistered"
                          id="ref-for-dfn-service-worker-registration-unregistered②">未注册的</a>，则调用 <a
                          data-link-type="dfn" href="#try-clear-registration"
                          id="ref-for-try-clear-registration">尝试清除注册</a> 并传入 <var>registration</var>。</p>
                    </li>
                    <li data-md>
                      <p>如果 <var>registration</var> 不为 null，调用 <a data-link-type="dfn" href="#try-activate"
                          id="ref-for-try-activate①">尝试激活</a> 并传入 <var>registration</var>。</p>
                    </li>
                  </ol>
                </li>
              </ol>
            </li>
          </ol>
          <p>如果 <a data-link-type="dfn" href="#service-worker-has-no-pending-events"
              id="ref-for-service-worker-has-no-pending-events">服务工作线程没有未处理的事件</a> 返回 false，那么用户代理 <em>不应</em> <a
              data-link-type="dfn" href="#terminate-service-worker" id="ref-for-terminate-service-worker②">终止</a> 该 <a
              data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑥④">服务工作线程</a>。</p>
          <p>
            <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑥⑥">服务工作线程</a>和 <a
              href="#extensibility">扩展</a> 可以 <em>定义</em> 它们自己的行为，允许 <a data-link-type="dfn"
              href="#extendableevent-extend-lifetime-promises"
              id="ref-for-extendableevent-extend-lifetime-promises②">延长生命周期 promises</a> 来建议操作时长，并且任何 <a
              data-link-type="dfn" href="http://tc39.github.io/ecma262/#sec-promise-objects"
              id="ref-for-sec-promise-objects②①">promise</a> 在 <a data-link-type="dfn"
              href="#extendableevent-extend-lifetime-promises"
              id="ref-for-extendableevent-extend-lifetime-promises③">延长生命周期 promises</a> 中的拒绝状态可以表明操作失败。
          </p>
          <p class="note" role="note"><span>注意：</span> <a data-link-type="dfn" href="#dfn-service-worker"
              id="ref-for-dfn-service-worker⑥⑦">服务工作线程</a> 会推迟将 <a data-link-type="dfn" href="#dfn-installing-worker"
              id="ref-for-dfn-installing-worker⑥">安装工作线程</a>视为 "<code>已安装</code>"，直到所有 <a data-link-type="dfn"
              href="http://tc39.github.io/ecma262/#sec-promise-objects" id="ref-for-sec-promise-objects②②">promises</a>
            在 <code
              class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-install-event" id="ref-for-service-worker-global-scope-install-event④">install</a></code>
            事件的 <a data-link-type="dfn" href="#extendableevent-extend-lifetime-promises"
              id="ref-for-extendableevent-extend-lifetime-promises④">延长生命周期 promises</a> 成功解决。（参见相关的 <a
              href="#install-settle-step">安装算法步骤</a>。）如果任何一个 promise 被拒绝，则安装失败。这主要用于确保 <a data-link-type="dfn"
              href="#dfn-service-worker" id="ref-for-dfn-service-worker⑥⑧">服务工作线程</a> 在所有依赖的核心缓存被填充之前不会被视为
            "<code>已安装</code>"。同样，<a data-link-type="dfn" href="#dfn-service-worker"
              id="ref-for-dfn-service-worker⑥⑨">服务工作线程</a> 会推迟将 <a data-link-type="dfn" href="#dfn-active-worker"
              id="ref-for-dfn-active-worker①⑦">激活工作线程</a>视为 "<code>已激活</code>"，直到所有 <a data-link-type="dfn"
              href="http://tc39.github.io/ecma262/#sec-promise-objects" id="ref-for-sec-promise-objects②③">promises</a>
            在 <code
              class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-activate-event" id="ref-for-service-worker-global-scope-activate-event④">activate</a></code>
            事件的 <a data-link-type="dfn" href="#extendableevent-extend-lifetime-promises"
              id="ref-for-extendableevent-extend-lifetime-promises⑤">延长生命周期 promises</a> 完成解决。（参见相关的 <a
              href="#activate-settle-step">激活算法步骤</a>。）这主要用于确保任何 <a data-link-type="dfn" href="#dfn-functional-events"
              id="ref-for-dfn-functional-events①">功能性事件</a> 在升级数据库模式和删除过时的缓存条目之前不会被分发给 <a data-link-type="dfn"
              href="#dfn-service-worker" id="ref-for-dfn-service-worker⑦⓪">服务工作线程</a>。</p>
        </section>
      </section>
      <section>
        <h3 class="heading settled" data-level="4.5" id="fetchevent-interface"><span class="secno">4.5. </span><span
            class="content"><code
              class="idl"><a data-link-type="idl" href="#fetchevent" id="ref-for-fetchevent">FetchEvent</a></code></span><a
            class="self-link" href="#fetchevent-interface"></a></h3>
        <div class="mdn-anno wrapped after">
          <button class="mdn-anno-btn"><b class="all-engines-flag"
              title="This feature is in all current engines.">✔</b><span>MDN</span></button>
          <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent"
                title="这是在 service worker 全局范围内分派的 fetch 事件的事件类型。它包含有关 fetch 的信息，包括请求以及接收者如何处理响应。它提供了 event.respondWith() 方法，允许我们为此 fetch 提供响应。">FetchEvent</a>
            </p>
            <p class="all-engines-text">在所有当前引擎中。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                class="chrome yes"><span>Chrome</span><span>40+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                class="ie no"><span>IE</span><span>None</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
            </div>
          </div>
        </div>
        <div class="mdn-anno wrapped">
          <button class="mdn-anno-btn"><b class="all-engines-flag"
              title="This feature is in all current engines.">✔</b><span>MDN</span></button>
          <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent/FetchEvent"
                title="FetchEvent() 构造函数创建一个新的 FetchEvent 对象。">FetchEvent/FetchEvent</a></p>
            <p class="all-engines-text">在所有当前引擎中。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                class="chrome yes"><span>Chrome</span><span>40+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                class="ie no"><span>IE</span><span>None</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
            </div>
          </div>
        </div>

        <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed⑨"><c- g>Exposed</c-></a>=<c- n>ServiceWorker</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="fetchevent"><code><c- g>FetchEvent</c-></code></dfn> : <a data-link-type="idl-name" href="#extendableevent" id="ref-for-extendableevent⑨"><c- n>ExtendableEvent</c-></a> {
  <dfn class="idl-code" data-dfn-for="FetchEvent" data-dfn-type="constructor" data-export data-lt="FetchEvent(type, eventInitDict)|constructor(type, eventInitDict)" id="dom-fetchevent-fetchevent"><code><c- g>constructor</c-></code><a class="self-link" href="#dom-fetchevent-fetchevent"></a></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString③"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="FetchEvent/FetchEvent(type, eventInitDict), FetchEvent/constructor(type, eventInitDict)" data-dfn-type="argument" data-export id="dom-fetchevent-fetchevent-type-eventinitdict-type"><code><c- g>type</c-></code><a class="self-link" href="#dom-fetchevent-fetchevent-type-eventinitdict-type"></a></dfn>, <a data-link-type="idl-name" href="#dictdef-fetcheventinit" id="ref-for-dictdef-fetcheventinit"><c- n>FetchEventInit</c-></a> <dfn class="idl-code" data-dfn-for="FetchEvent/FetchEvent(type, eventInitDict), FetchEvent/constructor(type, eventInitDict)" data-dfn-type="argument" data-export id="dom-fetchevent-fetchevent-type-eventinitdict-eventinitdict"><code><c- g>eventInitDict</c-></code><a class="self-link" href="#dom-fetchevent-fetchevent-type-eventinitdict-eventinitdict"></a></dfn>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject⑦"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request"><c- n>Request</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Request" href="#dom-fetchevent-request" id="ref-for-dom-fetchevent-request"><c- g>request</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①⑧"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any⑤"><c- b>any</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Promise<any>" href="#dom-fetchevent-preloadresponse" id="ref-for-dom-fetchevent-preloadresponse"><c- g>preloadResponse</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString④"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-fetchevent-clientid" id="ref-for-dom-fetchevent-clientid"><c- g>clientId</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑤"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-fetchevent-resultingclientid" id="ref-for-dom-fetchevent-resultingclientid"><c- g>resultingClientId</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑥"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-fetchevent-replacesclientid" id="ref-for-dom-fetchevent-replacesclientid"><c- g>replacesClientId</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①⑨"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined①④"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Promise<undefined>" href="#dom-fetchevent-handled" id="ref-for-dom-fetchevent-handled"><c- g>handled</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined①⑤"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-fetchevent-respondwith" id="ref-for-dom-fetchevent-respondwith"><c- g>respondWith</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②⓪"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response"><c- n>Response</c-></a>> <dfn class="idl-code" data-dfn-for="FetchEvent/respondWith(r)" data-dfn-type="argument" data-export id="dom-fetchevent-respondwith-r-r"><code><c- g>r</c-></code><a class="self-link" href="#dom-fetchevent-respondwith-r-r"></a></dfn>);
};
</pre>
        <pre class="idl highlight def" id="fetch-event-init-dictionary"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-fetcheventinit"><code><c- g>FetchEventInit</c-></code></dfn> : <a data-link-type="idl-name" href="#dictdef-extendableeventinit" id="ref-for-dictdef-extendableeventinit①"><c- n>ExtendableEventInit</c-></a> {
  <c- b>required</c-> <a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request①"><c- n>Request</c-></a> <dfn class="idl-code" data-dfn-for="FetchEventInit" data-dfn-type="dict-member" data-export data-type="Request " id="dom-fetcheventinit-request"><code><c- g>request</c-></code><a class="self-link" href="#dom-fetcheventinit-request"></a></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②①"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any⑥"><c- b>any</c-></a>> <dfn class="idl-code" data-dfn-for="FetchEventInit" data-dfn-type="dict-member" data-export data-type="Promise<any> " id="dom-fetcheventinit-preloadresponse"><code><c- g>preloadResponse</c-></code><a class="self-link" href="#dom-fetcheventinit-preloadresponse"></a></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑦"><c- b>DOMString</c-></a> <dfn class="idl-code" data-default="&quot;&quot;" data-dfn-for="FetchEventInit" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-fetcheventinit-clientid"><code><c- g>clientId</c-></code><a class="self-link" href="#dom-fetcheventinit-clientid"></a></dfn> = "";
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑧"><c- b>DOMString</c-></a> <dfn class="idl-code" data-default="&quot;&quot;" data-dfn-for="FetchEventInit" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-fetcheventinit-resultingclientid"><code><c- g>resultingClientId</c-></code><a class="self-link" href="#dom-fetcheventinit-resultingclientid"></a></dfn> = "";
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑨"><c- b>DOMString</c-></a> <dfn class="idl-code" data-default="&quot;&quot;" data-dfn-for="FetchEventInit" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-fetcheventinit-replacesclientid"><code><c- g>replacesClientId</c-></code><a class="self-link" href="#dom-fetcheventinit-replacesclientid"></a></dfn> = "";
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②②"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined①⑥"><c- b>undefined</c-></a>> <dfn class="idl-code" data-dfn-for="FetchEventInit" data-dfn-type="dict-member" data-export data-type="Promise<undefined> " id="dom-fetcheventinit-handled"><code><c- g>handled</c-></code><a class="self-link" href="#dom-fetcheventinit-handled"></a></dfn>;
};
</pre>
        <p><a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑦①">Service workers</a>
          有一个重要的 <a data-link-type="dfn" href="#dfn-functional-events" id="ref-for-dfn-functional-events②">功能事件</a>
          <code
            class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-fetch-event" id="ref-for-service-worker-global-scope-fetch-event③">fetch</a></code>。对于
          <code
            class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-fetch-event" id="ref-for-service-worker-global-scope-fetch-event④">fetch</a></code>
          事件，<a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑦②">service workers</a> 使用
          <code class="idl"><a data-link-type="idl" href="#fetchevent" id="ref-for-fetchevent①">FetchEvent</a></code>
          接口，该接口扩展了 <code
            class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent①⓪">ExtendableEvent</a></code>
          接口。
        </p>
        <p>每个使用 <code
            class="idl"><a data-link-type="idl" href="#fetchevent" id="ref-for-fetchevent②">FetchEvent</a></code>
          接口的事件都有一个关联的 <dfn class="dfn-paneled" data-dfn-for="FetchEvent" data-dfn-type="dfn" data-noexport
            id="fetchevent-potential-response">潜在响应</dfn>（一个 <a data-link-type="dfn"
            href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①">response</a>），初始值为
          null，并且有以下初始为未设置的关联标志：</p>
        <ul>
          <li data-md>
            <p><dfn class="dfn-paneled" data-dfn-for="FetchEvent" data-dfn-type="dfn" data-noexport
                id="fetchevent-wait-to-respond-flag">等待响应标志</dfn></p>
          </li>
          <li data-md>
            <p><dfn class="dfn-paneled" data-dfn-for="FetchEvent" data-dfn-type="dfn" data-noexport
                id="fetchevent-respond-with-entered-flag">进入 respond-with 标志</dfn></p>
          </li>
          <li data-md>
            <p><dfn class="dfn-paneled" data-dfn-for="FetchEvent" data-dfn-type="dfn" data-noexport
                id="fetchevent-respond-with-error-flag">respond-with 错误标志</dfn></p>
          </li>
        </ul>

        <section>
          <h4 class="heading settled" data-level="4.5.1" id="fetch-event-request"><span class="secno">4.5.1.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-fetchevent-request" id="ref-for-dom-fetchevent-request①">event.request</a></code></span><a
              class="self-link" href="#fetch-event-request"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中都存在。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent/request"
                  title="FetchEvent 接口的只读属性 request 返回触发事件处理程序的请求。">FetchEvent/request</a></p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="FetchEvent" data-dfn-type="attribute" data-export
              id="dom-fetchevent-request"><code>request</code></dfn> 属性<em>必须</em>返回其初始化时的值。</p>
        </section>
        <section>
          <h4 class="heading settled" data-level="4.5.2" id="fetch-event-preloadresponse"><span class="secno">4.5.2.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-fetchevent-preloadresponse" id="ref-for-dom-fetchevent-preloadresponse①">event.preloadResponse</a></code></span><a
              class="self-link" href="#fetch-event-preloadresponse"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent/preloadResponse"
                  title="FetchEvent 接口的只读属性 preloadResponse 返回一个 Promise，该 Promise 解析为导航预加载响应（如果触发了导航预加载），否则为 undefined。">FetchEvent/preloadResponse</a>
              </p>
              <div class="support">
                <span class="firefox no"><span>Firefox</span><span>无</span></span><span
                  class="safari yes"><span>Safari</span><span>15.4+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>59+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>46+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>18</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android no"><span>Firefox for Android</span><span>无</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>15.4+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="FetchEvent" data-dfn-type="attribute" data-export
              id="dom-fetchevent-preloadresponse"><code>preloadResponse</code></dfn> 属性<em>必须</em>返回其初始化时的值。创建 <a
              data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event"
              id="ref-for-concept-event②">事件</a>时，该属性<em>必须</em>初始化为 <a data-link-type="dfn"
              href="https://webidl.spec.whatwg.org/#a-promise-resolved-with"
              id="ref-for-a-promise-resolved-with">一个解析为</a> undefined 的 Promise。</p>
        </section>
        <section>
          <h4 class="heading settled" data-level="4.5.3" id="fetch-event-clientid"><span class="secno">4.5.3.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-fetchevent-clientid" id="ref-for-dom-fetchevent-clientid①">event.clientId</a></code></span><a
              class="self-link" href="#fetch-event-clientid"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中都存在。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent/clientId"
                  title="FetchEvent 接口的只读属性 clientId 返回当前 service worker 所控制的 Client 的 ID。">FetchEvent/clientId</a></p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>45+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>49+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>36+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>45+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>49+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>49+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>5.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>36+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="FetchEvent" data-dfn-type="attribute" data-export
              id="dom-fetchevent-clientid"><code>clientId</code></dfn> 属性<em>必须</em>返回其初始化时的值。创建 <a data-link-type="dfn"
              href="https://dom.spec.whatwg.org/#concept-event"
              id="ref-for-concept-event③">事件</a>时，该属性<em>必须</em>初始化为空字符串。</p>
        </section>

        <section>
          <h4 class="heading settled" data-level="4.5.4" id="fetch-event-resultingclientid"><span class="secno">4.5.4.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-fetchevent-resultingclientid" id="ref-for-dom-fetchevent-resultingclientid①">event.resultingClientId</a></code></span><a
              class="self-link" href="#fetch-event-resultingclientid"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中都存在。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent/resultingClientId"
                  title="FetchEvent 接口的只读属性 resultingClientId 是在页面导航过程中替换前一个客户端的客户端 ID。">FetchEvent/resultingClientId</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span
                  class="safari yes"><span>Safari</span><span>16+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>72+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>60+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge no"><span>Edge (旧版)</span><span>无</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>16+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>72+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>72+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>11.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>50+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="FetchEvent" data-dfn-type="attribute" data-export
              id="dom-fetchevent-resultingclientid"><code>resultingClientId</code></dfn> 属性<em>必须</em>返回其初始化时的值。创建 <a
              data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event"
              id="ref-for-concept-event④">事件</a>时，该属性<em>必须</em>初始化为空字符串。</p>
        </section>
        <section>
          <h4 class="heading settled" data-level="4.5.5" id="fetch-event-replacesClientId"><span class="secno">4.5.5.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-fetchevent-replacesclientid" id="ref-for-dom-fetchevent-replacesclientid①">event.replacesClientId</a></code></span><a
              class="self-link" href="#fetch-event-replacesClientId"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="less-than-two-engines-flag"
                title="此功能在不到两个当前引擎中存在。">⚠</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent/replacesClientId"
                  title="FetchEvent 接口的只读属性 replacesClientId 是在页面导航过程中被替换的客户端 ID。">FetchEvent/replacesClientId</a></p>
              <p class="less-than-two-engines-text">在当前没有引擎中。</p>
              <div class="support">
                <span class="firefox no"><span>Firefox</span><span>无</span></span><span
                  class="safari no"><span>Safari</span><span>无</span></span><span
                  class="chrome no"><span>Chrome</span><span>无</span></span>
                <hr>
                <span class="opera no"><span>Opera</span><span>无</span></span><span
                  class="edge_blink no"><span>Edge</span><span>无</span></span>
                <hr>
                <span class="edge no"><span>Edge (旧版)</span><span>无</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android no"><span>Firefox for Android</span><span>无</span></span><span
                  class="safari_ios no"><span>iOS Safari</span><span>无</span></span><span
                  class="chrome_android no"><span>Chrome for Android</span><span>无</span></span><span
                  class="webview_android no"><span>Android WebView</span><span>无</span></span><span
                  class="samsunginternet_android no"><span>Samsung Internet</span><span>无</span></span><span
                  class="opera_android no"><span>Opera Mobile</span><span>无</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="FetchEvent" data-dfn-type="attribute" data-export
              id="dom-fetchevent-replacesclientid"><code>replacesClientId</code></dfn> 属性<em>必须</em>返回其初始化时的值。创建 <a
              data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event"
              id="ref-for-concept-event⑤">事件</a>时，该属性<em>必须</em>初始化为空字符串。</p>
        </section>
        <section>
          <h4 class="heading settled" data-level="4.5.6" id="fetch-event-handled"><span class="secno">4.5.6.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-fetchevent-handled" id="ref-for-dom-fetchevent-handled①">event.handled</a></code></span><a
              class="self-link" href="#fetch-event-handled"></a></h4>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="FetchEvent" data-dfn-type="attribute" data-export
              id="dom-fetchevent-handled"><code>handled</code></dfn> 属性<em>必须</em>返回其初始化时的值。创建 <a data-link-type="dfn"
              href="https://dom.spec.whatwg.org/#concept-event"
              id="ref-for-concept-event⑥">事件</a>时，该属性<em>必须</em>初始化为一个挂起的 <a data-link-type="dfn"
              href="http://tc39.github.io/ecma262/#sec-promise-objects" id="ref-for-sec-promise-objects②④">promise</a>。
          </p>
        </section>

        <section class="algorithm" data-algorithm="fetch-event-respondwith">
          <h4 class="heading settled" data-level="4.5.7" id="fetch-event-respondwith"><span class="secno">4.5.7.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-fetchevent-respondwith" id="ref-for-dom-fetchevent-respondwith①">event.respondWith(r)</a></code></span><a
              class="self-link" href="#fetch-event-respondwith"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中都存在。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent/respondWith"
                  title="FetchEvent 的 respondWith() 方法可以防止浏览器的默认获取处理，并允许开发者自己提供一个 promise 来生成响应。">FetchEvent/respondWith</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>59+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>42+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>29+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>59+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>42+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>42+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>29+</span></span>
              </div>
            </div>
          </div>
          <p class="note" role="note"><span>注意：</span> 开发者可以将参数 <var>r</var> 设置为解析为 <code
              class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response①">Response</a></code>
            对象的 <a data-link-type="dfn" href="http://tc39.github.io/ecma262/#sec-promise-objects"
              id="ref-for-sec-promise-objects②⑤">promise</a> 或直接设置为 <code
              class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response②">Response</a></code>
            对象（将自动转换为 promise）。否则，将返回 <a data-link-type="dfn"
              href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error">网络错误</a> 到
            <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
              id="ref-for-concept-fetch②">Fetch</a>。与跨域内容的污染相关的渲染器端安全检查与 <a data-link-type="dfn"
              href="https://fetch.spec.whatwg.org/#concept-filtered-response"
              id="ref-for-concept-filtered-response">过滤响应</a> 类型有关，这些类型在 <a data-link-type="dfn"
              href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch③">Fetch</a> 中定义。
          </p>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="FetchEvent" data-dfn-type="method" data-export
              id="dom-fetchevent-respondwith"><code>respondWith(<var>r</var>)</code></dfn> 方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>令 <var>event</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this⑤①">this</a>。</p>
            <li data-md>
              <p>如果 <var>event</var> 的 <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#dispatch-flag"
                  id="ref-for-dispatch-flag①">分派标志</a> 未设置，<a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw④">抛出</a> "<code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror⑧">InvalidStateError</a></code>"
                <code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException①①">DOMException</a></code>。
              </p>
            <li data-md>
              <p>如果 <var>event</var> 的 <a data-link-type="dfn" href="#fetchevent-respond-with-entered-flag"
                  id="ref-for-fetchevent-respond-with-entered-flag">响应已进入标志</a> 已设置，<a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw⑤">抛出</a> "<code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror⑨">InvalidStateError</a></code>"
                <code
                  class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException①②">DOMException</a></code>。
              </p>
            <li data-md>
              <p><a data-link-type="dfn" href="#extendableevent-add-lifetime-promise"
                  id="ref-for-extendableevent-add-lifetime-promise①">添加生命周期 promise</a> <var>r</var> 到 <var>event</var>。
              </p>
              <p class="note" role="note"><span>注意：</span> <code
                  class="idl"><a data-link-type="idl" href="#dom-fetchevent-respondwith" id="ref-for-dom-fetchevent-respondwith②">event.respondWith(r)</a></code>
                默认情况下延长了事件的生命周期，就像调用了 <code
                  class="idl"><a data-link-type="idl" href="#dom-extendableevent-waituntil" id="ref-for-dom-extendableevent-waituntil④">event.waitUntil(r)</a></code>
                一样。</p>
            <li data-md>
              <p>设置 <var>event</var> 的 <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#stop-propagation-flag"
                  id="ref-for-stop-propagation-flag">停止传播标志</a> 和 <a data-link-type="dfn"
                  href="https://dom.spec.whatwg.org/#stop-immediate-propagation-flag"
                  id="ref-for-stop-immediate-propagation-flag">立即停止传播标志</a>。</p>
            <li data-md>
              <p>设置 <var>event</var> 的 <a data-link-type="dfn" href="#fetchevent-respond-with-entered-flag"
                  id="ref-for-fetchevent-respond-with-entered-flag①">响应已进入标志</a>。</p>
            <li data-md>
              <p>设置 <var>event</var> 的 <a data-link-type="dfn" href="#fetchevent-wait-to-respond-flag"
                  id="ref-for-fetchevent-wait-to-respond-flag">等待响应标志</a>。</p>
            <li data-md>
              <p>令 <var>targetRealm</var> 为 <var>event</var> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm"
                  id="ref-for-concept-relevant-realm③">相关 Realm</a>。</p>
            <li data-md>
              <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#upon-rejection"
                  id="ref-for-upon-rejection①">当拒绝</a> <var>r</var> 时：</p>
              <ol>
                <li data-md>
                  <p>设置 <var>event</var> 的 <a data-link-type="dfn" href="#fetchevent-respond-with-error-flag"
                      id="ref-for-fetchevent-respond-with-error-flag">响应错误标志</a>。</p>
                <li data-md>
                  <p>取消设置 <var>event</var> 的 <a data-link-type="dfn" href="#fetchevent-wait-to-respond-flag"
                      id="ref-for-fetchevent-wait-to-respond-flag①">等待响应标志</a>。</p>
              </ol>
            <li data-md>
              <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#upon-fulfillment"
                  id="ref-for-upon-fulfillment①">当满足</a> <var>r</var> 且 <var>response</var> 时：</p>
              <ol>
                <li data-md>
                  <p>如果 <var>response</var> 不是 <code
                      class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response③">Response</a></code>
                    对象，则设置 <a data-link-type="dfn" href="#fetchevent-respond-with-error-flag"
                      id="ref-for-fetchevent-respond-with-error-flag①">响应错误标志</a>。</p>
                  <p class="note" role="note"><span>注意：</span> 如果 <a data-link-type="dfn"
                      href="#fetchevent-respond-with-error-flag"
                      id="ref-for-fetchevent-respond-with-error-flag②">响应错误标志</a> 已设置，则通过 <a data-link-type="dfn"
                      href="#handle-fetch" id="ref-for-handle-fetch②">处理获取</a> 算法（参见步骤 21.1）向 <a data-link-type="dfn"
                      href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch④">Fetch</a> 返回 <a
                      data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error"
                      id="ref-for-concept-network-error①">网络错误</a>。否则，通过 <a data-link-type="dfn" href="#handle-fetch"
                      id="ref-for-handle-fetch③">处理获取</a> 算法（参见步骤 22.1）向 <a data-link-type="dfn"
                      href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch⑤">Fetch</a> 返回
                    <var>response</var> 值。
                  </p>
                <li data-md>
                  <p>否则：</p>
                  <ol>
                    <li data-md>
                      <p>令 <var>bytes</var> 为一个空的字节序列。</p>
                    <li data-md>
                      <p>令 <var>end-of-body</var> 为 false。</p>
                    <li data-md>
                      <p>令 <var>done</var> 为 false。</p>
                    <li data-md>
                      <p>令 <var>potentialResponse</var> 为 <var>response</var> 的关联 <a data-link-type="dfn"
                          href="https://fetch.spec.whatwg.org/#concept-response-response"
                          id="ref-for-concept-response-response">响应</a> 的副本，<var>response</var> 的 <a
                          data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-body"
                          id="ref-for-concept-response-body">主体</a> 除外。</p>
                    <li data-md>
                      <p>如果 <var>response</var> 的 <a data-link-type="dfn"
                          href="https://fetch.spec.whatwg.org/#concept-response-body"
                          id="ref-for-concept-response-body①">主体</a> 不为空，运行以下子步骤：</p>
                      <ol>
                        <li data-md>
                          <p>令 <var>reader</var> 为从 <var>response</var> 的 <a data-link-type="dfn"
                              href="https://fetch.spec.whatwg.org/#concept-response-body"
                              id="ref-for-concept-response-body②">主体</a> 的 <a data-link-type="dfn"
                              href="https://fetch.spec.whatwg.org/#concept-body-stream"
                              id="ref-for-concept-body-stream">流</a> <a data-link-type="dfn"
                              href="https://streams.spec.whatwg.org/#readablestream-get-a-reader"
                              id="ref-for-readablestream-get-a-reader">获取读取器</a> 的结果。</p>
                        <li data-md>
                          <p>令 <var>pullAlgorithm</var> 为一个运行以下步骤的动作：</p>
                          <ol>
                            <li data-md>
                              <p>令 <var>readRequest</var> 为一个新 <a data-link-type="dfn"
                                  href="https://streams.spec.whatwg.org/#read-request"
                                  id="ref-for-read-request">读取请求</a>，包含以下 <a data-link-type="dfn"
                                  href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item①">项</a>：</p>
                              <dl>
                                <dt data-md><a data-link-type="dfn"
                                    href="https://streams.spec.whatwg.org/#read-request-chunk-steps"
                                    id="ref-for-read-request-chunk-steps">数据块步骤</a>，给定 <var>chunk</var>
                                <dd data-md>
                                  <ol>
                                    <li data-md>
                                      <p class="assertion">断言：<var>chunk</var> 是一个 <code
                                          class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-Uint8Array" id="ref-for-idl-Uint8Array">Uint8Array</a></code>。
                                      </p>
                                    <li data-md>
                                      <p>将 <var>chunk</var> 所代表的字节附加到 <var>bytes</var>。</p>
                                    <li data-md>
                                      <p>执行 ! <a data-link-type="dfn"
                                          href="http://tc39.github.io/ecma262/#sec-detacharraybuffer"
                                          id="ref-for-sec-detacharraybuffer">DetachArrayBuffer</a>(<var>chunk</var>.[[ViewedArrayBuffer]])。
                                      </p>
                                  </ol>
                                <dt data-md><a data-link-type="dfn"
                                    href="https://streams.spec.whatwg.org/#read-request-close-steps"
                                    id="ref-for-read-request-close-steps">关闭步骤</a>
                                <dd data-md>
                                  <ol>
                                    <li data-md>
                                      <p>设置 <var>end-of-body</var> 为 true。</p>
                                  </ol>
                                <dt data-md><a data-link-type="dfn"
                                    href="https://streams.spec.whatwg.org/#read-request-error-steps"
                                    id="ref-for-read-request-error-steps">错误步骤</a>
                                <dd data-md>
                                  <ol>
                                    <li data-md>
                                      <p><a data-link-type="dfn"
                                          href="https://streams.spec.whatwg.org/#readablestream-error"
                                          id="ref-for-readablestream-error">错误处理</a> <var>newStream</var>，并抛出 <code
                                          class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror">TypeError</a></code>。
                                      </p>
                                  </ol>
                              </dl>
                            <li data-md>
                              <p><a data-link-type="dfn"
                                  href="https://streams.spec.whatwg.org/#readablestreamdefaultreader-read-a-chunk"
                                  id="ref-for-readablestreamdefaultreader-read-a-chunk">读取一个数据块</a> 从 <var>reader</var>
                                给定 <var>readRequest</var>。</p>
                          </ol>
                        <li data-md>
                          <p>令 <var>cancelAlgorithm</var> 为 <a data-link-type="dfn"
                              href="https://streams.spec.whatwg.org/#readablestreamdefaultreader-cancel"
                              id="ref-for-readablestreamdefaultreader-cancel">取消</a> <var>reader</var> 的一个动作。</p>
                        <li data-md>
                          <p>令 <var>highWaterMark</var> 为一个非负的、非 NaN 的数字，由用户代理选择。</p>
                        <li data-md>
                          <p>令 <var>sizeAlgorithm</var> 为一个接受 <a data-link-type="dfn"
                              href="https://streams.spec.whatwg.org/#chunk" id="ref-for-chunk">数据块</a> 对象并返回一个非负、非
                            NaN、非无限数字的算法，由用户代理选择。</p>
                        <li data-md>
                          <p>令 <var>newStream</var> 为 <a data-link-type="dfn">创建</a> 的一个 <code
                              class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream">ReadableStream</a></code>
                            的结果，<a data-link-type="dfn"><var>pullAlgorithm</var></a> 设置为 <var>pullAlgorithm</var>，<a
                              data-link-type="dfn"><var>cancelAlgorithm</var></a> 设置为 <var>cancelAlgorithm</var>，<a
                              data-link-type="dfn"><var>highWaterMark</var></a> 设置为 <var>highWaterMark</var>，<a
                              data-link-type="dfn"><var>sizeAlgorithm</var></a> 设置为 <var>sizeAlgorithm</var>，在
                            <var>targetRealm</var> 中。
                          </p>
                        <li data-md>
                          <p>设置 <var>potentialResponse</var> 的 <a data-link-type="dfn"
                              href="https://fetch.spec.whatwg.org/#concept-response-body"
                              id="ref-for-concept-response-body③">主体</a> 为一个新的 <a data-link-type="dfn"
                              href="https://fetch.spec.whatwg.org/#concept-body" id="ref-for-concept-body">主体</a>，其 <a
                              data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body-stream"
                              id="ref-for-concept-body-stream①">流</a> 为 <var>newStream</var>。</p>
                        <li data-md>
                          <p>在 <var>done</var> 为 false 的情况下，<a data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                              id="ref-for-in-parallel①④">并行</a> 多次运行这些子子步骤：</p>
                          <ol>
                            <li data-md>
                              <p>如果 <var>newStream</var> 是 <a data-link-type="dfn"
                                  href="https://streams.spec.whatwg.org/#readablestream-errored"
                                  id="ref-for-readablestream-errored">错误的</a>，则将 <var>done</var> 设置为 true。</p>
                            <li data-md>
                              <p>否则，如果 <var>bytes</var> 为空且 <var>end-of-body</var> 为 true，则 <a data-link-type="dfn"
                                  href="https://streams.spec.whatwg.org/#readablestream-close"
                                  id="ref-for-readablestream-close">关闭</a> <var>newStream</var> 并将 <var>done</var> 设置为
                                true。</p>
                            <li data-md>
                              <p>否则，如果 <var>bytes</var> 不为空，运行以下子子子步骤：</p>
                              <ol>
                                <li data-md>
                                  <p>令 <var>chunk</var> 为从 <var>bytes</var> 开始的子序列。</p>
                                <li data-md>
                                  <p>从 <var>bytes</var> 中删除 <var>chunk</var>。</p>
                                <li data-md>
                                  <p>令 <var>buffer</var> 为在 <var>targetRealm</var> 中创建的 <code
                                      class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer" id="ref-for-idl-ArrayBuffer">ArrayBuffer</a></code>
                                    对象，包含 <var>chunk</var>。</p>
                                <li data-md>
                                  <p><a data-link-type="dfn"
                                      href="https://streams.spec.whatwg.org/#readablestream-enqueue"
                                      id="ref-for-readablestream-enqueue">将</a> 包含 <var>buffer</var> 的在
                                    <var>targetRealm</var> 中创建的 <code
                                      class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-Uint8Array" id="ref-for-idl-Uint8Array①">Uint8Array</a></code>
                                    对象入队至 <var>newStream</var>。
                                  </p>
                              </ol>
                          </ol>
                          <p class="note" role="note"><span>注意：</span> 这些子步骤旨在产生与将 <var>response</var> 的 <a
                              data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-body"
                              id="ref-for-concept-response-body④">主体</a> 的 <a data-link-type="dfn"
                              href="https://fetch.spec.whatwg.org/#concept-body-stream"
                              id="ref-for-concept-body-stream②">流</a> “管道” 到 <var>potentialResponse</var> 的观察等价物。</p>
                          <p class="note" role="note"><span>注意：</span>
                            由服务工作者以块的形式写入的数据并不保证在接收数据的客户端中以相同的数据块读取。也就是说，客户端将读取相同的数据，但可能会被浏览器以不同的块方式分段。</p>
                        <li data-md>
                          <p>设置 <var>event</var> 的 <a data-link-type="dfn" href="#fetchevent-potential-response"
                              id="ref-for-fetchevent-potential-response">潜在响应</a> 为 <var>potentialResponse</var>。</p>
                      </ol>
                    <li data-md>
                      <p>取消设置 <var>event</var> 的 <a data-link-type="dfn" href="#fetchevent-wait-to-respond-flag"
                          id="ref-for-fetchevent-wait-to-respond-flag②">等待响应标志</a>。</p>
                  </ol>
              </ol>
          </ol>
        </section>
      </section>
      <section>
        <h3 class="heading settled" data-level="4.6" id="extendablemessageevent-interface">
          <span class="secno">4.6. </span>
          <span class="content">
            <code class="idl">
              <a data-link-type="idl" href="#extendablemessageevent" id="ref-for-extendablemessageevent②">ExtendableMessageEvent</a>
            </code>
          </span>
          <a class="self-link" href="#extendablemessageevent-interface"></a>
        </h3>
        <div class="mdn-anno wrapped after">
          <button class="mdn-anno-btn">
            <b class="all-engines-flag" title="此功能在所有当前引擎中均可用。">✔</b>
            <span>MDN</span>
          </button>
          <div class="feature">
            <p>
              <a href="https://developer.mozilla.org/en-US/docs/Web/API/ExtendableMessageEvent"
                title="ExtendableMessageEvent 接口是 Service Worker API 的一部分，表示在 service worker 上触发的消息事件的事件对象（当从另一个上下文向 ServiceWorkerGlobalScope 接收到消息时）— 扩展了此类事件的生命周期。">
                ExtendableMessageEvent
              </a>
            </p>
            <p class="all-engines-text">在所有当前引擎中均可用。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
              <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
              <span class="chrome yes"><span>Chrome</span><span>51+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>38+</span></span>
              <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span>
              <span class="ie no"><span>IE</span><span>None</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
              <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
              <span class="chrome_android yes"><span>Chrome for Android</span><span>51+</span></span>
              <span class="webview_android yes"><span>Android WebView</span><span>51+</span></span>
              <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>5.0+</span></span>
              <span class="opera_android yes"><span>Opera Mobile</span><span>41+</span></span>
            </div>
          </div>
        </div>
        <div class="mdn-anno wrapped">
          <button class="mdn-anno-btn">
            <b class="all-engines-flag" title="此功能在所有当前引擎中均可用。">✔</b>
            <span>MDN</span>
          </button>
          <div class="feature">
            <p>
              <a href="https://developer.mozilla.org/en-US/docs/Web/API/ExtendableMessageEvent/ExtendableMessageEvent"
                title="ExtendableMessageEvent() 构造函数创建一个新的 ExtendableMessageEvent 对象。">
                ExtendableMessageEvent/ExtendableMessageEvent
              </a>
            </p>
            <p class="all-engines-text">在所有当前引擎中均可用。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>44+</span></span>
              <span class="safari yes"><span>Safari</span><span>11.1+</span></span>
              <span class="chrome yes"><span>Chrome</span><span>51+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>38+</span></span>
              <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span>
              <span class="ie no"><span>IE</span><span>None</span></span>
              <hr>
              <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span>
              <span class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span>
              <span class="chrome_android yes"><span>Chrome for Android</span><span>51+</span></span>
              <span class="webview_android yes"><span>Android WebView</span><span>51+</span></span>
              <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>5.0+</span></span>
              <span class="opera_android yes"><span>Opera Mobile</span><span>41+</span></span>
            </div>
          </div>
        </div>
        <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①⓪"><c- g>Exposed</c-></a>=<c- n>ServiceWorker</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="extendablemessageevent"><code><c- g>ExtendableMessageEvent</c-></code></dfn> : <a data-link-type="idl-name" href="#extendableevent" id="ref-for-extendableevent①①"><c- n>ExtendableEvent</c-></a> {
  <dfn class="idl-code" data-dfn-for="ExtendableMessageEvent" data-dfn-type="constructor" data-export data-lt="ExtendableMessageEvent(type, eventInitDict)|constructor(type, eventInitDict)|ExtendableMessageEvent(type)|constructor(type)" id="dom-extendablemessageevent-extendablemessageevent"><code><c- g>constructor</c-></code><a class="self-link" href="#dom-extendablemessageevent-extendablemessageevent"></a></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①⓪"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="ExtendableMessageEvent/ExtendableMessageEvent(type, eventInitDict), ExtendableMessageEvent/constructor(type, eventInitDict), ExtendableMessageEvent/ExtendableMessageEvent(type), ExtendableMessageEvent/constructor(type)" data-dfn-type="argument" data-export id="dom-extendablemessageevent-extendablemessageevent-type-eventinitdict-type"><code><c- g>type</c-></code><a class="self-link" href="#dom-extendablemessageevent-extendablemessageevent-type-eventinitdict-type"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-extendablemessageeventinit" id="ref-for-dictdef-extendablemessageeventinit"><c- n>ExtendableMessageEventInit</c-></a> <dfn class="idl-code" data-dfn-for="ExtendableMessageEvent/ExtendableMessageEvent(type, eventInitDict), ExtendableMessageEvent/constructor(type, eventInitDict), ExtendableMessageEvent/ExtendableMessageEvent(type), ExtendableMessageEvent/constructor(type)" data-dfn-type="argument" data-export id="dom-extendablemessageevent-extendablemessageevent-type-eventinitdict-eventinitdict"><code><c- g>eventInitDict</c-></code><a class="self-link" href="#dom-extendablemessageevent-extendablemessageevent-type-eventinitdict-eventinitdict"></a></dfn> = {});
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any⑦"><c- b>any</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="any" href="#dom-extendablemessageevent-data" id="ref-for-dom-extendablemessageevent-data①"><c- g>data</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑨"><c- b>USVString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="USVString" href="#dom-extendablemessageevent-origin" id="ref-for-dom-extendablemessageevent-origin②"><c- g>origin</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①①"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-extendablemessageevent-lasteventid" id="ref-for-dom-extendablemessageevent-lasteventid"><c- g>lastEventId</c-></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject⑧"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> (<a data-link-type="idl-name" href="#client" id="ref-for-client⑧"><c- n>Client</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#serviceworker" id="ref-for-serviceworker②②"><c- n>ServiceWorker</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport②"><c- n>MessagePort</c-></a>)? <a class="idl-code" data-link-type="attribute" data-readonly data-type="(Client or ServiceWorker or MessagePort)?" href="#dom-extendablemessageevent-source" id="ref-for-dom-extendablemessageevent-source②"><c- g>source</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array" id="ref-for-idl-frozen-array③"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport③"><c- n>MessagePort</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="FrozenArray<MessagePort>" href="#dom-extendablemessageevent-ports" id="ref-for-dom-extendablemessageevent-ports①"><c- g>ports</c-></a>;
};
</pre>
        <pre class="idl highlight def" id="extendablemessage-event-init-dictionary"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-extendablemessageeventinit"><code><c- g>ExtendableMessageEventInit</c-></code></dfn> : <a data-link-type="idl-name" href="#dictdef-extendableeventinit" id="ref-for-dictdef-extendableeventinit②"><c- n>ExtendableEventInit</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any⑧"><c- b>any</c-></a> <dfn class="idl-code" data-default="null" data-dfn-for="ExtendableMessageEventInit" data-dfn-type="dict-member" data-export data-type="any " id="dom-extendablemessageeventinit-data"><code><c- g>data</c-></code><a class="self-link" href="#dom-extendablemessageeventinit-data"></a></dfn> = <c- b>null</c->;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString①⓪"><c- b>USVString</c-></a> <dfn class="idl-code" data-default="&quot;&quot;" data-dfn-for="ExtendableMessageEventInit" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-extendablemessageeventinit-origin"><code><c- g>origin</c-></code><a class="self-link" href="#dom-extendablemessageeventinit-origin"></a></dfn> = "";
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①②"><c- b>DOMString</c-></a> <dfn class="idl-code" data-default="&quot;&quot;" data-dfn-for="ExtendableMessageEventInit" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-extendablemessageeventinit-lasteventid"><code><c- g>lastEventId</c-></code><a class="self-link" href="#dom-extendablemessageeventinit-lasteventid"></a></dfn> = "";
  (<a data-link-type="idl-name" href="#client" id="ref-for-client⑨"><c- n>Client</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#serviceworker" id="ref-for-serviceworker②③"><c- n>ServiceWorker</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport④"><c- n>MessagePort</c-></a>)? <dfn class="idl-code" data-default="null" data-dfn-for="ExtendableMessageEventInit" data-dfn-type="dict-member" data-export data-type="(Client or ServiceWorker or MessagePort)? " id="dom-extendablemessageeventinit-source"><code><c- g>source</c-></code><a class="self-link" href="#dom-extendablemessageeventinit-source"></a></dfn> = <c- b>null</c->;
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence" id="ref-for-idl-sequence②"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport⑤"><c- n>MessagePort</c-></a>> <dfn class="idl-code" data-default="[]" data-dfn-for="ExtendableMessageEventInit" data-dfn-type="dict-member" data-export data-type="sequence<MessagePort> " id="dom-extendablemessageeventinit-ports"><code><c- g>ports</c-></code><a class="self-link" href="#dom-extendablemessageeventinit-ports"></a></dfn> = [];
};
</pre>
        <p><a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑦③">Service workers</a>
          定义了 <a class="idl-code" data-link-type="method" href="#dom-extendableevent-waituntil"
            id="ref-for-dom-extendableevent-waituntil⑤">extendable</a> <code
            class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-container-message-event" id="ref-for-service-worker-container-message-event③">message</a></code>
          事件以允许扩展事件的生命周期。对于 <code
            class="idl"><a class="idl-code" data-link-type="event" href="#eventdef-serviceworkerglobalscope-message" id="ref-for-eventdef-serviceworkerglobalscope-message①">message</a></code>
          事件，<a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑦④">service workers</a>
          使用扩展了
          <code
            class="idl"><a data-link-type="idl" href="#extendablemessageevent" id="ref-for-extendablemessageevent③">ExtendableMessageEvent</a></code>
          接口的 <code
            class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent①②">ExtendableEvent</a></code>
          接口。
        </p>
        <section>
          <h4 class="heading settled" data-level="4.6.1" id="extendablemessage-event-data"><span class="secno">4.6.1.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-extendablemessageevent-data" id="ref-for-dom-extendablemessageevent-data②">event.data</a></code></span><a
              class="self-link" href="#extendablemessage-event-data"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中均可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ExtendableMessageEvent/data"
                  title="ExtendableMessageEvent 接口的只读属性 data 返回事件的数据。它可以是任何数据类型。">ExtendableMessageEvent/data</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中均可用。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>51+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>38+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>51+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>51+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>5.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>41+</span></span>
              </div>
            </div>
          </div>
          <p>
            <dfn class="dfn-paneled idl-code" data-dfn-for="ExtendableMessageEvent" data-dfn-type="attribute"
              data-export id="dom-extendablemessageevent-data">
              <code>data</code>
            </dfn> 属性 <em>必须</em> 返回初始化时的值。当对象被创建时，该属性 <em>必须</em> 被初始化为 null。它表示正在发送的消息。
          </p>
        </section>
        <section>
          <h4 class="heading settled" data-level="4.6.2" id="extendablemessage-event-origin"><span class="secno">4.6.2.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-extendablemessageevent-origin" id="ref-for-dom-extendablemessageevent-origin③">event.origin</a></code></span><a
              class="self-link" href="#extendablemessage-event-origin"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中均可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ExtendableMessageEvent/origin"
                  title="ExtendableMessageEvent 接口的只读属性 origin 返回发送消息的客户端的来源。">ExtendableMessageEvent/origin</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中均可用。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>51+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>38+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>51+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>51+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>5.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>41+</span></span>
              </div>
            </div>
          </div>
          <p>
            <dfn class="dfn-paneled idl-code" data-dfn-for="ExtendableMessageEvent" data-dfn-type="attribute"
              data-export id="dom-extendablemessageevent-origin">
              <code>origin</code>
            </dfn> 属性 <em>必须</em> 返回初始化时的值。当对象被创建时，该属性 <em>必须</em> 被初始化为空字符串。它表示发送消息的 <a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
              id="ref-for-concept-settings-object-origin⑥">来源</a> 的 <a data-link-type="dfn"
              href="#dfn-service-worker-client" id="ref-for-dfn-service-worker-client③②">service worker 客户端</a>。
          </p>
        </section>

        <section>
          <h4 class="heading settled" data-level="4.6.3" id="extendablemessage-event-lasteventid"><span
              class="secno">4.6.3.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-extendablemessageevent-lasteventid" id="ref-for-dom-extendablemessageevent-lasteventid①">event.lastEventId</a></code></span><a
              class="self-link" href="#extendablemessage-event-lasteventid"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中均可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ExtendableMessageEvent/lastEventId"
                  title="ExtendableMessageEvent 接口的只读属性 lastEventID 表示在服务器发送事件中，事件源的最后一个事件 ID。默认是一个空字符串。">ExtendableMessageEvent/lastEventId</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中均可用。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>51+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>38+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>51+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>51+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>5.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>41+</span></span>
              </div>
            </div>
          </div>
          <p>
            <dfn class="dfn-paneled idl-code" data-dfn-for="ExtendableMessageEvent" data-dfn-type="attribute"
              data-export id="dom-extendablemessageevent-lasteventid">
              <code>lastEventId</code>
            </dfn> 属性 <em>必须</em> 返回初始化时的值。当对象被创建时，该属性 <em>必须</em> 被初始化为空字符串。
          </p>
        </section>
        <section>
          <h4 class="heading settled" data-level="4.6.4" id="extendablemessage-event-source"><span class="secno">4.6.4.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-extendablemessageevent-source" id="ref-for-dom-extendablemessageevent-source③">event.source</a></code></span><a
              class="self-link" href="#extendablemessage-event-source"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中均可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ExtendableMessageEvent/source"
                  title="ExtendableMessageEvent 接口的只读属性 source 返回发送消息的 Client 对象的引用。">ExtendableMessageEvent/source</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中均可用。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>51+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>38+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>51+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>51+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>5.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>41+</span></span>
              </div>
            </div>
          </div>
          <p>
            <dfn class="dfn-paneled idl-code" data-dfn-for="ExtendableMessageEvent" data-dfn-type="attribute"
              data-export id="dom-extendablemessageevent-source">
              <code>source</code>
            </dfn> 属性 <em>必须</em> 返回初始化时的值。当对象被创建时，该属性 <em>必须</em> 被初始化为 null。它表示发送消息的 <code
              class="idl"><a data-link-type="idl" href="#client" id="ref-for-client①⓪">Client</a></code> 对象。
          </p>
        </section>
        <section>
          <h4 class="heading settled" data-level="4.6.5" id="extendablemessage-event-ports"><span class="secno">4.6.5.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-extendablemessageevent-ports" id="ref-for-dom-extendablemessageevent-ports②">event.ports</a></code></span><a
              class="self-link" href="#extendablemessage-event-ports"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中均可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ExtendableMessageEvent/ports"
                  title="ExtendableMessageEvent 接口的只读属性 ports 返回一个数组，该数组包含代表关联消息通道端口的 MessagePort 对象（即消息通过的通道）。">ExtendableMessageEvent/ports</a>
              </p>
              <p class="all-engines-text">在所有当前引擎中均可用。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>51+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>38+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                  class="ie no"><span>IE</span><span>None</span></span>
                <hr>
                <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                  class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Chrome for Android</span><span>51+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>51+</span></span><span
                  class="samsunginternet_android yes"><span>Samsung Internet</span><span>5.0+</span></span><span
                  class="opera_android yes"><span>Opera Mobile</span><span>41+</span></span>
              </div>
            </div>
          </div>
          <p>
            <dfn class="dfn-paneled idl-code" data-dfn-for="ExtendableMessageEvent" data-dfn-type="attribute"
              data-export id="dom-extendablemessageevent-ports">
              <code>ports</code>
            </dfn> 属性 <em>必须</em> 返回初始化时的值。当对象被创建时，该属性 <em>必须</em> 被初始化为空数组。它表示正在发送的 <code
              class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport⑥">MessagePort</a></code>
            数组。
          </p>
        </section>
      </section>
      <section>
        <h3 class="heading settled" data-level="4.7" id="execution-context-events"><span class="secno">4.7. </span><span
            class="content">事件</span><a class="self-link" href="#execution-context-events"></a></h3>
        <p>以下事件，称为<a data-link-type="dfn" href="#dfn-service-worker-events"
            id="ref-for-dfn-service-worker-events">service worker 事件</a>，在
          <code
            class="idl"><a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope①①">ServiceWorkerGlobalScope</a></code>
          对象上被分派：
        </p>
        <table class="data">
          <thead>
            <tr>
              <th>事件名称</th>
              <th>接口</th>
              <th>类别</th>
              <th>何时分派…</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="event"
                  data-export id="service-worker-global-scope-install-event"><code>install</code></dfn></td>
              <td><code
                  class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent①③">ExtendableEvent</a></code>
              </td>
              <td><a data-link-type="dfn" href="#dfn-lifecycle-events" id="ref-for-dfn-lifecycle-events①">生命周期</a></td>
              <td>当 <a data-link-type="dfn" href="#serviceworkerglobalscope-service-worker"
                  id="ref-for-serviceworkerglobalscope-service-worker②⓪">service worker</a> 的 <a data-link-type="dfn"
                  href="#dfn-containing-service-worker-registration"
                  id="ref-for-dfn-containing-service-worker-registration①③">包含 service worker 的注册</a> 的 <a
                  data-link-type="dfn" href="#dfn-installing-worker" id="ref-for-dfn-installing-worker⑦">正在安装的
                  worker</a> 发生变化时。（参见<a data-link-type="dfn" href="#install" id="ref-for-install①">安装</a>算法的步骤 11.2。）
              </td>
            </tr>
            <tr>
              <td>
                <div class="mdn-anno wrapped">
                  <button class="mdn-anno-btn"><b class="all-engines-flag"
                      title="此功能在所有当前引擎中均可用。">✔</b><span>MDN</span></button>
                  <div class="feature">
                    <p><a
                        href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/activate_event"
                        title="ServiceWorkerGlobalScope 接口的 activate 事件在 ServiceWorkerRegistration 获得一个新的 active worker 时触发。">ServiceWorkerGlobalScope/activate_event</a>
                    </p>
                    <p class="all-engines-text">在所有当前引擎中均可用。</p>
                    <div class="support">
                      <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                        class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                        class="chrome yes"><span>Chrome</span><span>40+</span></span>
                      <hr>
                      <span class="opera yes"><span>Opera</span><span>24+</span></span><span
                        class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                      <hr>
                      <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                        class="ie no"><span>IE</span><span>None</span></span>
                      <hr>
                      <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                        class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                        class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                        class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                        class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                        class="opera_android yes"><span>Opera Mobile</span><span>24+</span></span>
                    </div>
                  </div>
                </div>
                <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="event"
                  data-export id="service-worker-global-scope-activate-event"><code>activate</code></dfn>
              </td>
              <td><code
                  class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent①④">ExtendableEvent</a></code>
              </td>
              <td><a data-link-type="dfn" href="#dfn-lifecycle-events" id="ref-for-dfn-lifecycle-events②">生命周期</a></td>
              <td>当 <a data-link-type="dfn" href="#serviceworkerglobalscope-service-worker"
                  id="ref-for-serviceworkerglobalscope-service-worker②①">service worker</a> 的 <a data-link-type="dfn"
                  href="#dfn-containing-service-worker-registration"
                  id="ref-for-dfn-containing-service-worker-registration①④">包含 service worker 的注册</a> 的 <a
                  data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker①⑧">active worker</a>
                发生变化时。（参见 <a data-link-type="dfn" href="#activate" id="ref-for-activate②">激活</a>算法的步骤 12.2。）</td>
            </tr>
            <tr>
              <td><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="event"
                  data-export id="service-worker-global-scope-fetch-event"><code>fetch</code></dfn></td>
              <td><code
                  class="idl"><a data-link-type="idl" href="#fetchevent" id="ref-for-fetchevent③">FetchEvent</a></code>
              </td>
              <td><a data-link-type="dfn" href="#dfn-functional-events" id="ref-for-dfn-functional-events③">功能性</a></td>
              <td>当 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-http-fetch"
                  id="ref-for-concept-http-fetch②">http fetch</a> 调用 <a data-link-type="dfn" href="#handle-fetch"
                  id="ref-for-handle-fetch④">Handle Fetch</a> 与 <var>request</var>。执行 <a data-link-type="dfn"
                  href="#handle-fetch" id="ref-for-handle-fetch⑤">Handle Fetch</a> 的结果是，<a data-link-type="dfn"
                  href="#serviceworkerglobalscope-service-worker"
                  id="ref-for-serviceworkerglobalscope-service-worker②②">service worker</a> 向 <a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-http-fetch" id="ref-for-concept-http-fetch③">http
                  fetch</a> 返回一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
                  id="ref-for-concept-response②">response</a>。此 <a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③">response</a>，由一个
                <code
                  class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response④">Response</a></code>
                对象表示，可以从 <code class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache">Cache</a></code>
                对象中检索，或直接通过网络使用 <code
                  class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#dom-global-fetch" id="ref-for-dom-global-fetch">self.fetch(input, init)</a></code>
                方法检索。（自定义的 <code
                  class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response⑤">Response</a></code>
                对象也是另一种选择。）
              </td>
            </tr>
            <tr>
              <td><a href="https://w3c.github.io/push-api/#dfn-push">push</a></td>
              <td><a href="https://w3c.github.io/push-api/#dom-pushevent"><code>PushEvent</code></a></td>
              <td><a data-link-type="dfn" href="#dfn-functional-events" id="ref-for-dfn-functional-events④">功能性</a></td>
              <td>（参见<a href="https://w3c.github.io/push-api/#dfn-fire-the-push-event">触发 push 事件</a>。）</td>
            </tr>
            <tr>
              <td><a
                  href="https://notifications.spec.whatwg.org/#dom-serviceworkerglobalscope-onnotificationclick">notificationclick</a>
              </td>
              <td><a href="https://notifications.spec.whatwg.org/#notificationevent"><code>NotificationEvent</code></a>
              </td>
              <td><a data-link-type="dfn" href="#dfn-functional-events" id="ref-for-dfn-functional-events⑤">功能性</a></td>
              <td>（参见<a href="https://notifications.spec.whatwg.org/#activating-a-notification">激活通知。</a>）</td>
            </tr>
            <tr>
              <td><a
                  href="https://notifications.spec.whatwg.org/#dom-serviceworkerglobalscope-onnotificationclose">notificationclose</a>
              </td>
              <td><a href="https://notifications.spec.whatwg.org/#notificationevent"><code>NotificationEvent</code></a>
              </td>
              <td><a data-link-type="dfn" href="#dfn-functional-events" id="ref-for-dfn-functional-events⑥">功能性</a></td>
              <td>（参见<a href="https://notifications.spec.whatwg.org/#closing-a-notification">关闭通知。</a>）</td>
            </tr>
            <tr>
              <td><a href="https://wicg.github.io/BackgroundSync/spec/#sync">sync</a></td>
              <td><a href="https://wicg.github.io/BackgroundSync/spec/#syncevent"><code>SyncEvent</code></a></td>
              <td><a data-link-type="dfn" href="#dfn-functional-events" id="ref-for-dfn-functional-events⑦">功能性</a></td>
              <td>（参见<a href="https://wicg.github.io/BackgroundSync/spec/#fire-a-sync-event">触发同步事件</a>。）</td>
            </tr>
            <tr>
              <td><a href="https://w3c.github.io/payment-handler/#the-canmakepaymentevent">canmakepayment</a></td>
              <td><a href="https://w3c.github.io/payment-handler/#dom-canmakepaymentevent">CanMakePaymentEvent</a></td>
              <td><a data-link-type="dfn" href="#dfn-functional-events" id="ref-for-dfn-functional-events⑧">功能性</a></td>
              <td>（参见<a href="https://w3c.github.io/payment-handler/#dfn-handling-a-canmakepaymentevent">处理
                  CanMakePaymentEvent</a>。）</td>
            </tr>
            <tr>
              <td><a href="https://w3c.github.io/payment-handler/#the-paymentrequestevent">paymentrequest</a></td>
              <td><a href="https://w3c.github.io/payment-handler/#dom-paymentrequestevent">PaymentRequestEvent</a></td>
              <td><a data-link-type="dfn" href="#dfn-functional-events" id="ref-for-dfn-functional-events⑨">功能性</a></td>
              <td>（参见<a href="https://w3c.github.io/payment-handler/#dfn-handling-a-paymentrequestevent">处理
                  PaymentRequestEvent</a>。）</td>
            </tr>
            <tr>
              <td>
                <div class="mdn-anno wrapped">
                  <button class="mdn-anno-btn"><b class="all-engines-flag"
                      title="此功能在所有当前引擎中均可用。">✔</b><span>MDN</span></button>
                  <div class="feature">
                    <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/message_event"
                        title="ServiceWorkerGlobalScope 接口的 message 事件发生在接收到传入消息时。受控页面可以使用 ServiceWorker.postMessage() 方法将消息发送给 service workers。service worker 可以选择通过 Client.postMessage() 向受控页面发送响应消息。">ServiceWorkerGlobalScope/message_event</a>
                    </p>
                    <p class="all-engines-text">在所有当前引擎中均可用。</p>
                    <div class="support">
                      <span class="firefox yes"><span>Firefox</span><span>44+</span></span><span
                        class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                        class="chrome yes"><span>Chrome</span><span>40+</span></span>
                      <hr>
                      <span class="opera yes"><span>Opera</span><span>24+</span></span><span
                        class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                      <hr>
                      <span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span
                        class="ie no"><span>IE</span><span>None</span></span>
                      <hr>
                      <span class="firefox_android yes"><span>Firefox for Android</span><span>44+</span></span><span
                        class="safari_ios yes"><span>iOS Safari</span><span>11.3+</span></span><span
                        class="chrome_android yes"><span>Chrome for Android</span><span>40+</span></span><span
                        class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                        class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span
                        class="opera_android yes"><span>Opera Mobile</span><span>24+</span></span>
                    </div>
                  </div>
                </div>
                <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="event"
                  data-export id="eventdef-serviceworkerglobalscope-message"><code>message</code></dfn>
              </td>
              <td><code
                  class="idl"><a data-link-type="idl" href="#extendablemessageevent" id="ref-for-extendablemessageevent④">ExtendableMessageEvent</a></code>
              </td>
              <td>遗留</td>
              <td>当接收到消息时。</td>
            </tr>
            <tr>
              <td><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="event"
                  data-export id="eventdef-serviceworkerglobalscope-messageerror"><code>messageerror</code></dfn></td>
              <td><code
                  class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/comms.html#messageevent" id="ref-for-messageevent②">MessageEvent</a></code>
              </td>
              <td>遗留</td>
              <td>当发送了无法反序列化的消息时。</td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
    <section>
      <h2 class="heading settled" data-level="5" id="cache-objects"><span class="secno">5. </span><span
          class="content">缓存</span><a class="self-link" href="#cache-objects"></a></h2>
      <p>为了允许作者完全管理其内容缓存以供离线使用，<code
          class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window⑦">Window</a></code>
        和 <code
          class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope①">WorkerGlobalScope</a></code>
        提供了打开和操作 <code class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache①">Cache</a></code>
        对象的异步缓存方法。一个 <a data-link-type="dfn"
          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
          id="ref-for-concept-settings-object-origin⑦">源</a> 可以有多个命名的 <code
          class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache②">Cache</a></code> 对象，其内容完全由脚本控制。缓存不会跨 <a
          data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin"
          id="ref-for-concept-origin⑧">源</a> 共享，并且它们与浏览器的 HTTP 缓存完全隔离。</p>
      <section>
        <h3 class="heading settled" data-level="5.1" id="cache-constructs"><span class="secno">5.1. </span><span
            class="content">构造</span><a class="self-link" href="#cache-constructs"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="dfn-request-response-list">请求响应列表</dfn> 是由 <a
            data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑦">列表</a> 组成的 <a
            data-link-type="dfn">对</a>，包括请求（<a data-link-type="dfn"
            href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②">请求</a>）和响应（<a
            data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
            id="ref-for-concept-response④">响应</a>）。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
            id="dfn-relevant-request-response-list">相关的请求响应列表</dfn> 是 <a data-link-type="dfn"
            href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑤②">this</a> 所表示的实例。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="dfn-name-to-cache-map">名称到缓存映射</dfn> 是一个 <a
            data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map③">有序映射</a>，其
          <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-entry" id="ref-for-map-entry">条目</a> 由 <a
            data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-key" id="ref-for-map-key">键</a>（表示 <a
            data-link-type="dfn" href="#dfn-request-response-list" id="ref-for-dfn-request-response-list">请求响应列表</a>
          名称的字符串）和 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-value"
            id="ref-for-map-value">值</a>（<a data-link-type="dfn" href="#dfn-request-response-list"
            id="ref-for-dfn-request-response-list①">请求响应列表</a>）组成。
        </p>
        <p>每个 <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-key"
            id="ref-for-storage-key②">存储键</a> 都有一个关联的 <a data-link-type="dfn" href="#dfn-name-to-cache-map"
            id="ref-for-dfn-name-to-cache-map">名称到缓存映射</a>。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
            id="dfn-relevant-name-to-cache-map">相关的名称到缓存映射</dfn> 是与 <a data-link-type="dfn"
            href="https://storage.spec.whatwg.org/#storage-key" id="ref-for-storage-key③">存储键</a> 相关联的 <a
            data-link-type="dfn" href="#dfn-name-to-cache-map" id="ref-for-dfn-name-to-cache-map①">名称到缓存映射</a>，该存储键由 <a
            data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑤③">this</a> 关联的 <a
            data-link-type="dfn" href="#cachestorage-global-object" id="ref-for-cachestorage-global-object">全局对象</a> 的
          <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
            id="ref-for-environment-settings-object①③">环境设置对象</a> 获取 <a data-link-type="dfn"
            href="https://storage.spec.whatwg.org/#obtain-a-storage-key" id="ref-for-obtain-a-storage-key⑧">获得</a>。
        </p>
      </section>

      <section>
        <h3 class="heading settled" data-level="5.2" id="cache-lifetimes"><span class="secno">5.2. </span><span
            class="content">理解缓存的生命周期</span><a class="self-link" href="#cache-lifetimes"></a></h3>
        <p><code class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache③">Cache</a></code> 实例不是浏览器的 HTTP
          缓存的一部分。<code class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache④">Cache</a></code>
          对象完全由作者自行管理。<code class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache⑤">Cache</a></code>
          对象不会更新，除非作者明确请求它们更新。<code
            class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache⑥">Cache</a></code> 对象不会过期，除非作者删除条目。<code
            class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache⑦">Cache</a></code> 对象不会因为<a
            data-link-type="dfn" href="#dfn-service-worker"
            id="ref-for-dfn-service-worker⑦⑤">服务工作者</a>脚本被更新而消失。也就是说，缓存不会自动更新，必须手动管理。这意味着作者应该通过名称对缓存进行版本控制，并确保仅从可以安全操作的
          <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑦⑥">服务工作者</a>版本中使用这些缓存。
        </p>
      </section>
      <section>
        <h3 class="heading settled" data-level="5.3" id="self-caches"><span class="secno">5.3. </span><span
            class="content"><code
              class="idl"><a data-link-type="idl" href="#global-caches-attribute" id="ref-for-global-caches-attribute">self.caches</a></code></span><a
            class="self-link" href="#self-caches"></a></h3>
        <div class="mdn-anno wrapped after">
          <button class="mdn-anno-btn"><b class="all-engines-flag" title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
          <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/caches"
                title="全局 caches 只读属性返回与当前上下文关联的 CacheStorage 对象。此对象启用诸如存储资产以供离线使用和生成自定义响应请求等功能。">caches</a></p>
            <p class="all-engines-text">适用于所有当前引擎。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>41+</span></span><span
                class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                class="chrome yes"><span>Chrome</span><span>40+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (旧版)</span><span>16+</span></span><span
                class="ie no"><span>IE</span><span>无</span></span>
              <hr>
              <span class="firefox_android yes"><span>Android 版 Firefox</span><span>41+</span></span><span
                class="safari_ios yes"><span>iOS 版 Safari</span><span>11.3+</span></span><span
                class="chrome_android yes"><span>Android 版 Chrome</span><span>40+</span></span><span
                class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                class="samsunginternet_android yes"><span>三星互联网</span><span>4.0+</span></span><span
                class="opera_android yes"><span>Opera 移动版</span><span>27+</span></span>
            </div>
          </div>
        </div>
        <pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <c- b>mixin</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope"><c- g>WindowOrWorkerGlobalScope</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext⑥"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject⑨"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#cachestorage" id="ref-for-cachestorage"><c- n>CacheStorage</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="CacheStorage" href="#global-caches-attribute" id="ref-for-global-caches-attribute①"><c- g>caches</c-></a>;
};
</pre>
        <section>
          <h4 class="heading settled" data-level="5.3.1" id="global-caches"><span class="secno">5.3.1. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#global-caches-attribute" id="ref-for-global-caches-attribute②">caches</a></code></span><a
              class="self-link" href="#global-caches"></a></h4>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="WindowOrWorkerGlobalScope" data-dfn-type="attribute"
              data-export id="global-caches-attribute"><code>caches</code></dfn> getter 步骤是返回 <a data-link-type="dfn"
              href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑤④">this</a> 关联的 <code
              class="idl"><a data-link-type="idl" href="#cachestorage" id="ref-for-cachestorage①">CacheStorage</a></code>
            对象。</p>
        </section>
      </section>
      <section>
        <h3 class="heading settled" data-level="5.4" id="cache-interface"><span class="secno">5.4. </span><span
            class="content"><code
              class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache⑧">Cache</a></code></span><a
            class="self-link" href="#cache-interface"></a></h3>
        <div class="mdn-anno wrapped after">
          <button class="mdn-anno-btn"><b class="all-engines-flag" title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
          <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Cache"
                title="Cache 接口为缓存的请求/响应对象对提供了持久存储机制，这些对象对存储在长期存活的内存中。Cache 对象的存活时间取决于浏览器，但单个源的脚本通常可以依赖于以前填充的 Cache 对象。请注意，Cache 接口不仅暴露于窗口范围，还暴露于工作者范围。即使它是在服务工作者规范中定义的，你也不必将其与服务工作者一起使用。">Cache</a>
            </p>
            <p class="all-engines-text">适用于所有当前引擎。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>41+</span></span><span
                class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                class="chrome yes"><span>Chrome</span><span>40+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (旧版)</span><span>16+</span></span><span
                class="ie no"><span>IE</span><span>无</span></span>
              <hr>
              <span class="firefox_android yes"><span>Android 版 Firefox</span><span>41+</span></span><span
                class="safari_ios yes"><span>iOS 版 Safari</span><span>11.3+</span></span><span
                class="chrome_android yes"><span>Android 版 Chrome</span><span>40+</span></span><span
                class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                class="samsunginternet_android yes"><span>三星互联网</span><span>4.0+</span></span><span
                class="opera_android yes"><span>Opera 移动版</span><span>27+</span></span>
            </div>
          </div>
        </div>
        <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext⑦"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①①"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="cache"><code><c- g>Cache</c-></code></dfn> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject①②"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②③"><c- b>Promise</c-></a>&lt;(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response⑥"><c- n>Response</c-></a> <c- b>or</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined①⑦"><c- b>undefined</c-></a>)> <a class="idl-code" data-link-type="method" href="#dom-cache-match" id="ref-for-dom-cache-match"><c- g>match</c-></a>(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo" id="ref-for-requestinfo"><c- n>RequestInfo</c-></a> <dfn class="idl-code" data-dfn-for="Cache/match(request, options), Cache/match(request)" data-dfn-type="argument" data-export id="dom-cache-match-request-options-request"><code><c- g>request</c-></code><a class="self-link" href="#dom-cache-match-request-options-request"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-cachequeryoptions" id="ref-for-dictdef-cachequeryoptions"><c- n>CacheQueryOptions</c-></a> <dfn class="idl-code" data-dfn-for="Cache/match(request, options), Cache/match(request)" data-dfn-type="argument" data-export id="dom-cache-match-request-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-cache-match-request-options-options"></a></dfn> = {});
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject①③"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②④"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array" id="ref-for-idl-frozen-array④"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response⑦"><c- n>Response</c-></a>>> <a class="idl-code" data-link-type="method" href="#dom-cache-matchall" id="ref-for-dom-cache-matchall"><c- g>matchAll</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo" id="ref-for-requestinfo①"><c- n>RequestInfo</c-></a> <dfn class="idl-code" data-dfn-for="Cache/matchAll(request, options), Cache/matchAll(request), Cache/matchAll()" data-dfn-type="argument" data-export id="dom-cache-matchall-request-options-request"><code><c- g>request</c-></code><a class="self-link" href="#dom-cache-matchall-request-options-request"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-cachequeryoptions" id="ref-for-dictdef-cachequeryoptions①"><c- n>CacheQueryOptions</c-></a> <dfn class="idl-code" data-dfn-for="Cache/matchAll(request, options), Cache/matchAll(request), Cache/matchAll()" data-dfn-type="argument" data-export id="dom-cache-matchall-request-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-cache-matchall-request-options-options"></a></dfn> = {});
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject①④"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②⑤"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined①⑧"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-cache-add" id="ref-for-dom-cache-add"><c- g>add</c-></a>(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo" id="ref-for-requestinfo②"><c- n>RequestInfo</c-></a> <dfn class="idl-code" data-dfn-for="Cache/add(request)" data-dfn-type="argument" data-export id="dom-cache-add-request-request"><code><c- g>request</c-></code><a class="self-link" href="#dom-cache-add-request-request"></a></dfn>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject①⑤"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②⑥"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined①⑨"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-cache-addall" id="ref-for-dom-cache-addall"><c- g>addAll</c-></a>(<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence" id="ref-for-idl-sequence③"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo" id="ref-for-requestinfo③"><c- n>RequestInfo</c-></a>> <dfn class="idl-code" data-dfn-for="Cache/addAll(requests)" data-dfn-type="argument" data-export id="dom-cache-addall-requests-requests"><code><c- g>requests</c-></code><a class="self-link" href="#dom-cache-addall-requests-requests"></a></dfn>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject①⑥"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②⑦"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined②⓪"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-cache-put" id="ref-for-dom-cache-put"><c- g>put</c-></a>(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo" id="ref-for-requestinfo④"><c- n>RequestInfo</c-></a> <dfn class="idl-code" data-dfn-for="Cache/put(request, response)" data-dfn-type="argument" data-export id="dom-cache-put-request-response-request"><code><c- g>request</c-></code><a class="self-link" href="#dom-cache-put-request-response-request"></a></dfn>, <a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response⑧"><c- n>Response</c-></a> <dfn class="idl-code" data-dfn-for="Cache/put(request, response)" data-dfn-type="argument" data-export id="dom-cache-put-request-response-response"><code><c- g>response</c-></code><a class="self-link" href="#dom-cache-put-request-response-response"></a></dfn>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject①⑦"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②⑧"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean④"><c- b>boolean</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-cache-delete" id="ref-for-dom-cache-delete"><c- g>delete</c-></a>(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo" id="ref-for-requestinfo⑤"><c- n>RequestInfo</c-></a> <dfn class="idl-code" data-dfn-for="Cache/delete(request, options), Cache/delete(request)" data-dfn-type="argument" data-export id="dom-cache-delete-request-options-request"><code><c- g>request</c-></code><a class="self-link" href="#dom-cache-delete-request-options-request"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-cachequeryoptions" id="ref-for-dictdef-cachequeryoptions②"><c- n>CacheQueryOptions</c-></a> <dfn class="idl-code" data-dfn-for="Cache/delete(request, options), Cache/delete(request)" data-dfn-type="argument" data-export id="dom-cache-delete-request-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-cache-delete-request-options-options"></a></dfn> = {});
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject①⑧"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②⑨"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array" id="ref-for-idl-frozen-array⑤"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request②"><c- n>Request</c-></a>>> <a class="idl-code" data-link-type="method" href="#dom-cache-keys" id="ref-for-dom-cache-keys"><c- g>keys</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo" id="ref-for-requestinfo⑥"><c- n>RequestInfo</c-></a> <dfn class="idl-code" data-dfn-for="Cache/keys(request, options), Cache/keys(request), Cache/keys()" data-dfn-type="argument" data-export id="dom-cache-keys-request-options-request"><code><c- g>request</c-></code><a class="self-link" href="#dom-cache-keys-request-options-request"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-cachequeryoptions" id="ref-for-dictdef-cachequeryoptions③"><c- n>CacheQueryOptions</c-></a> <dfn class="idl-code" data-dfn-for="Cache/keys(request, options), Cache/keys(request), Cache/keys()" data-dfn-type="argument" data-export id="dom-cache-keys-request-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-cache-keys-request-options-options"></a></dfn> = {});
};
</pre>
        <pre class="idl highlight def" id="cache-query-options-dictionary"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-cachequeryoptions"><code><c- g>CacheQueryOptions</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean⑤"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-default="false" data-dfn-for="CacheQueryOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-cachequeryoptions-ignoresearch"><code><c- g>ignoreSearch</c-></code></dfn> = <c- b>false</c->;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean⑥"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-default="false" data-dfn-for="CacheQueryOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-cachequeryoptions-ignoremethod"><code><c- g>ignoreMethod</c-></code></dfn> = <c- b>false</c->;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean⑦"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-default="false" data-dfn-for="CacheQueryOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-cachequeryoptions-ignorevary"><code><c- g>ignoreVary</c-></code></dfn> = <c- b>false</c->;
};
</pre>
        <p><code class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache⑨">Cache</a></code> 对象表示一个 <a
            data-link-type="dfn" href="#dfn-request-response-list"
            id="ref-for-dfn-request-response-list②">请求响应列表</a>。多个在文档和工作者之间实现 <code
            class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache①⓪">Cache</a></code> 接口的独立对象可以同时关联到同一个 <a
            data-link-type="dfn" href="#dfn-request-response-list" id="ref-for-dfn-request-response-list③">请求响应列表</a>。
        </p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="dfn-cache-batch-operation">缓存批处理操作</dfn>
          是一个由以下内容组成的 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct①">结构体</a>：
        </p>
        <ul>
          <li data-md>
            <p><dfn class="dfn-paneled" data-dfn-for="cache batch operation" data-dfn-type="dfn" data-export
                id="dfn-cache-batch-operation-type">类型</dfn>（"<code>delete</code>" 或 "<code>put</code>"）。</p>
          <li data-md>
            <p><dfn class="dfn-paneled" data-dfn-for="cache batch operation" data-dfn-type="dfn" data-export
                id="dfn-cache-batch-operation-request">请求</dfn>（一个 <a data-link-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③">请求</a>）。</p>
          <li data-md>
            <p><dfn class="dfn-paneled" data-dfn-for="cache batch operation" data-dfn-type="dfn" data-export
                id="dfn-cache-batch-operation-response">响应</dfn>（一个 <a data-link-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑤">响应</a>）。</p>
          <li data-md>
            <p><dfn class="dfn-paneled" data-dfn-for="cache batch operation" data-dfn-type="dfn" data-export
                id="dfn-cache-batch-operation-options">选项</dfn>（一个 <code
                class="idl"><a data-link-type="idl" href="#dictdef-cachequeryoptions" id="ref-for-dictdef-cachequeryoptions④">CacheQueryOptions</a></code>）。
            </p>
        </ul>
        <section class="algorithm" data-algorithm="cache-match">
          <h4 class="heading settled" data-level="5.4.1" id="cache-match"><span class="secno">5.4.1. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-cache-match" id="ref-for-dom-cache-match①">match(request, options)</a></code></span><a
              class="self-link" href="#cache-match"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Cache/match"
                  title="Cache 接口的 match() 方法返回一个 Promise，该 Promise 解析为与 Cache 对象中第一个匹配请求相关联的 Response。如果未找到匹配项，则 Promise 解析为 undefined。">Cache/match</a>
              </p>
              <p class="all-engines-text">适用于所有当前引擎。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>41+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>43+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>30+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>16+</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Android 版 Firefox</span><span>41+</span></span><span
                  class="safari_ios yes"><span>iOS 版 Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Android 版 Chrome</span><span>43+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>43+</span></span><span
                  class="samsunginternet_android yes"><span>三星互联网</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera 移动版</span><span>30+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="Cache" data-dfn-type="method" data-export
              data-lt="match(request, options)|match(request)"
              id="dom-cache-match"><code>match(<var>request</var>, <var>options</var>)</code></dfn> 方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>令 <var>promise</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                  id="ref-for-a-new-promise⑧">一个新的 promise</a>。</p>
            <li data-md>
              <p>并行运行以下子步骤 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                  id="ref-for-in-parallel①⑤">in parallel</a>：</p>
              <ol>
                <li data-md>
                  <p>令 <var>p</var> 为使用 <var>request</var> 和 <var>options</var> 运行 <code
                      class="idl"><a data-link-type="idl" href="#dom-cache-matchall" id="ref-for-dom-cache-matchall①">matchAll(request, options)</a></code>
                    方法指定的算法的结果。</p>
                <li data-md>
                  <p>等待 <var>p</var> 达成。</p>
                <li data-md>
                  <p>如果 <var>p</var> 因异常而拒绝，则：</p>
                  <ol>
                    <li data-md>
                      <p>以该异常拒绝 <var>promise</var>。</p>
                  </ol>
                <li data-md>
                  <p>否则，如果 <var>p</var> 以数组 <var>responses</var> 达成，则：</p>
                  <ol>
                    <li data-md>
                      <p>如果 <var>responses</var> 是一个空数组，则：</p>
                      <ol>
                        <li data-md>
                          <p>用 undefined 解决 <var>promise</var>。</p>
                      </ol>
                    <li data-md>
                      <p>否则：</p>
                      <ol>
                        <li data-md>
                          <p>用 <var>responses</var> 的第一个元素解决 <var>promise</var>。</p>
                      </ol>
                  </ol>
              </ol>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
          </ol>
        </section>

        <section class="algorithm" data-algorithm="cache-matchall">
          <h4 class="heading settled" data-level="5.4.2" id="cache-matchall"><span class="secno">5.4.2. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-cache-matchall" id="ref-for-dom-cache-matchall②">matchAll(request, options)</a></code></span><a
              class="self-link" href="#cache-matchall"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Cache/matchAll"
                  title="Cache 接口的 matchAll() 方法返回一个 Promise，该 Promise 解析为 Cache 对象中所有匹配响应的数组。">Cache/matchAll</a></p>
              <p class="all-engines-text">适用于所有当前引擎。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>41+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>47+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>34+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>16+</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Android 版 Firefox</span><span>41+</span></span><span
                  class="safari_ios yes"><span>iOS 版 Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Android 版 Chrome</span><span>47+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>47+</span></span><span
                  class="samsunginternet_android yes"><span>三星互联网</span><span>5.0+</span></span><span
                  class="opera_android yes"><span>Opera 移动版</span><span>34+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="Cache" data-dfn-type="method" data-export
              data-lt="matchAll(request, options)|matchAll(request)|matchAll()"
              id="dom-cache-matchall"><code>matchAll(<var>request</var>, <var>options</var>)</code></dfn> 方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>令 <var>r</var> 为 null。</p>
            <li data-md>
              <p>如果可选参数 <var>request</var> 未被省略，则：</p>
              <ol>
                <li data-md>
                  <p>如果 <var>request</var> 是一个 <code
                      class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request③">Request</a></code>
                    对象，则：</p>
                  <ol>
                    <li data-md>
                      <p>将 <var>r</var> 设置为 <var>request</var> 的 <a data-link-type="dfn"
                          href="https://fetch.spec.whatwg.org/#concept-request-request"
                          id="ref-for-concept-request-request">请求</a>。</p>
                    <li data-md>
                      <p>如果 <var>r</var> 的 <a data-link-type="dfn"
                          href="https://fetch.spec.whatwg.org/#concept-request-method"
                          id="ref-for-concept-request-method">方法</a> 不是 `<code>GET</code>` 并且
                        <var>options</var>.ignoreMethod 为 false，则返回 <a data-link-type="dfn"
                          href="https://webidl.spec.whatwg.org/#a-promise-resolved-with"
                          id="ref-for-a-promise-resolved-with①">一个解析为空数组的 promise</a>。
                      </p>
                  </ol>
                <li data-md>
                  <p>否则，如果 <var>request</var> 是一个字符串，则：</p>
                  <ol>
                    <li data-md>
                      <p>将 <var>r</var> 设置为调用 <code
                          class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request④">Request</a></code>
                        构造函数的初始值，并以 <var>request</var> 作为参数的结果的关联 <a data-link-type="dfn"
                          href="https://fetch.spec.whatwg.org/#concept-request-request"
                          id="ref-for-concept-request-request①">请求</a>。如果这 <a data-link-type="dfn"
                          href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw⑥">抛出</a> 异常，则返回 <a
                          data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-rejected-with"
                          id="ref-for-a-promise-rejected-with②">一个以该异常拒绝的 promise</a>。</p>
                  </ol>
              </ol>
            <li data-md>
              <p>令 <var>realm</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this⑤⑤">this</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm"
                  id="ref-for-concept-relevant-realm④">相关领域</a>。</p>
            <li data-md>
              <p>令 <var>promise</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                  id="ref-for-a-new-promise⑨">一个新的 promise</a>。</p>
            <li data-md>
              <p>并行运行以下子步骤 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                  id="ref-for-in-parallel①⑥">in parallel</a>：</p>
              <ol>
                <li data-md>
                  <p>令 <var>responses</var> 为一个空的 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                      id="ref-for-list⑧">列表</a>。</p>
                <li data-md>
                  <p>如果省略了可选参数 <var>request</var>，则：</p>
                  <ol>
                    <li data-md>
                      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                          id="ref-for-list-iterate③">对于</a> <var>requestResponse</var> 的每个 <a data-link-type="dfn"
                          href="#dfn-relevant-request-response-list"
                          id="ref-for-dfn-relevant-request-response-list">相关请求响应列表</a>：</p>
                      <ol>
                        <li data-md>
                          <p>将 <var>requestResponse</var> 的响应副本添加到 <var>responses</var>。</p>
                      </ol>
                  </ol>
                <li data-md>
                  <p>否则：</p>
                  <ol>
                    <li data-md>
                      <p>令 <var>requestResponses</var> 为使用 <var>r</var> 和 <var>options</var> 运行 <a data-link-type="dfn"
                          href="#query-cache" id="ref-for-query-cache">查询缓存</a> 的结果。</p>
                    <li data-md>
                      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                          id="ref-for-list-iterate④">对于</a> <var>requestResponses</var> 中的每个 <var>requestResponse</var>：
                      </p>
                      <ol>
                        <li data-md>
                          <p>将 <var>requestResponse</var> 的响应副本添加到 <var>responses</var>。</p>
                      </ol>
                  </ol>
                <li data-md>
                  <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                      id="ref-for-list-iterate⑤">对于</a> <var>responses</var> 中的每个 <var>response</var>：</p>
                  <ol>
                    <li data-md>
                      <p>如果 <var>response</var> 的 <a data-link-type="dfn"
                          href="https://fetch.spec.whatwg.org/#concept-response-type"
                          id="ref-for-concept-response-type">类型</a> 是 "<code>opaque</code>" 并且 <a data-link-type="dfn"
                          href="https://fetch.spec.whatwg.org/#cross-origin-resource-policy-check"
                          id="ref-for-cross-origin-resource-policy-check">跨源资源策略检查</a> 与 <var>promise</var> 的 <a
                          data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                          id="ref-for-relevant-settings-object②⓪">相关设置对象</a> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                          id="ref-for-concept-settings-object-origin⑧">源</a>、<var>promise</var> 的 <a
                          data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                          id="ref-for-relevant-settings-object②①">相关设置对象</a>、"" 和 <var>response</var> 的 <a
                          data-link-type="dfn">内部响应</a> 返回 <b>阻止</b>，则用 <code>TypeError</code> 拒绝 <var>promise</var>
                        并中止这些步骤。</p>
                  </ol>
                <li data-md>
                  <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                      id="ref-for-queue-a-task①⑥">排队一个任务</a>，在 <var>promise</var> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                      id="ref-for-relevant-settings-object②②">相关设置对象</a> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                      id="ref-for-responsible-event-loop⑥">负责的事件循环</a> 上使用 <a data-link-type="dfn">DOM
                      操作任务源</a>，以执行以下步骤：</p>
                  <ol>
                    <li data-md>
                      <p>令 <var>responseList</var> 为一个 <a data-link-type="dfn"
                          href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑨">列表</a>。</p>
                    <li data-md>
                      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                          id="ref-for-list-iterate⑥">对于</a> <var>responses</var> 中的每个 <var>response</var>：</p>
                      <ol>
                        <li data-md>
                          <p>将一个与 <var>response</var> 关联的新 <code
                              class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response⑨">Response</a></code>
                            对象和一个 <code
                              class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#headers" id="ref-for-headers">Headers</a></code>
                            对象（其 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-headers-guard"
                              id="ref-for-concept-headers-guard">保护</a> 为 "<code>immutable</code>"）添加到
                            <var>responseList</var>。
                          </p>
                      </ol>
                    <li data-md>
                      <p>用 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-frozen-array-type"
                          id="ref-for-dfn-frozen-array-type②">从 <var>responseList</var> 创建的冻结数组</a>在 <var>realm</var>
                        中解决 <var>promise</var>。</p>
                  </ol>
              </ol>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
          </ol>
        </section>

        <section class="algorithm" data-algorithm="cache-add">
          <h4 class="heading settled" data-level="5.4.3" id="cache-add"><span class="secno">5.4.3. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-cache-add" id="ref-for-dom-cache-add①">add(request)</a></code></span><a
              class="self-link" href="#cache-add"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Cache/add"
                  title="Cache 接口的 add() 方法接受一个 URL，将其检索，并将生成的响应对象添加到给定缓存中。">Cache/add</a></p>
              <p class="all-engines-text">适用于所有当前引擎。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>41+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>44+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>31+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>16+</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Android 版 Firefox</span><span>41+</span></span><span
                  class="safari_ios yes"><span>iOS 版 Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Android 版 Chrome</span><span>44+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>44+</span></span><span
                  class="samsunginternet_android yes"><span>三星互联网</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera 移动版</span><span>32+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="Cache" data-dfn-type="method" data-export
              id="dom-cache-add"><code>add(<var>request</var>)</code></dfn> 方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>令 <var>requests</var> 为仅包含 <var>request</var> 的数组。</p>
            <li data-md>
              <p>令 <var>responseArrayPromise</var> 为传递 <var>requests</var> 作为参数，运行 <code
                  class="idl"><a data-link-type="idl" href="#dom-cache-addall" id="ref-for-dom-cache-addall①">addAll(requests)</a></code>
                指定算法的结果。</p>
            <li data-md>
              <p>返回 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#dfn-perform-steps-once-promise-is-settled"
                  id="ref-for-dfn-perform-steps-once-promise-is-settled">对 <var>responseArrayPromise</var>
                  作出反应</a>的结果，使用一个履行处理程序，该处理程序返回 undefined。</p>
          </ol>
        </section>
        <section class="algorithm" data-algorithm="cache-addAll">
          <h4 class="heading settled" data-level="5.4.4" id="cache-addAll"><span class="secno">5.4.4. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-cache-addall" id="ref-for-dom-cache-addall②">addAll(requests)</a></code></span><a
              class="self-link" href="#cache-addAll"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Cache/addAll"
                  title="Cache 接口的 addAll() 方法接受一个 URL 数组，将它们检索，并将生成的响应对象添加到给定缓存中。">Cache/addAll</a></p>
              <p class="all-engines-text">适用于所有当前引擎。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>41+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>46+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>33+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>16+</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Android 版 Firefox</span><span>41+</span></span><span
                  class="safari_ios yes"><span>iOS 版 Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Android 版 Chrome</span><span>46+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>46+</span></span><span
                  class="samsunginternet_android yes"><span>三星互联网</span><span>5.0+</span></span><span
                  class="opera_android yes"><span>Opera 移动版</span><span>33+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="Cache" data-dfn-type="method" data-export
              id="dom-cache-addall"><code>addAll(<var>requests</var>)</code></dfn> 方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>令 <var>responsePromises</var> 为一个空的 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                  id="ref-for-list①⓪">列表</a>。</p>
            <li data-md>
              <p>令 <var>requestList</var> 为一个空的 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                  id="ref-for-list①①">列表</a>。</p>
            <li data-md>
              <p>对于 <var>requests</var> 中类型为 <code
                  class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request⑤">Request</a></code>
                的每个 <var>request</var>：</p>
              <ol>
                <li data-md>
                  <p>令 <var>r</var> 为 <var>request</var> 的 <a data-link-type="dfn"
                      href="https://fetch.spec.whatwg.org/#concept-request-request"
                      id="ref-for-concept-request-request②">请求</a>。</p>
                <li data-md>
                  <p>如果 <var>r</var> 的 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url"
                      id="ref-for-concept-request-url①">url</a> 的 <a data-link-type="dfn"
                      href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme">协议</a> 不是
                    "<code>http</code>" 或 "<code>https</code>" 之一，或者 <var>r</var> 的 <a data-link-type="dfn"
                      href="https://fetch.spec.whatwg.org/#concept-request-method"
                      id="ref-for-concept-request-method①">方法</a> 不是 `<code>GET</code>`，则返回 <a data-link-type="dfn"
                      href="https://webidl.spec.whatwg.org/#a-promise-rejected-with"
                      id="ref-for-a-promise-rejected-with③">一个以 <code>TypeError</code> 拒绝的 promise</a>。</p>
              </ol>
            <li data-md>
              <p>对于 <var>requests</var> 中的每个 <var>request</var>：</p>
              <ol>
                <li data-md>
                  <p>令 <var>r</var> 为调用 <code
                      class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request⑥">Request</a></code>
                    构造函数的初始值并以 <var>request</var> 作为参数的结果的关联 <a data-link-type="dfn"
                      href="https://fetch.spec.whatwg.org/#concept-request-request"
                      id="ref-for-concept-request-request③">请求</a>。如果这 <a data-link-type="dfn"
                      href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw⑦">抛出</a>异常，则返回 <a
                      data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-rejected-with"
                      id="ref-for-a-promise-rejected-with④">一个以该异常拒绝的 promise</a>。</p>
                <li data-md>
                  <p>如果 <var>r</var> 的 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url"
                      id="ref-for-concept-request-url②">url</a> 的 <a data-link-type="dfn"
                      href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme①">协议</a> 不是
                    "<code>http</code>" 和 "<code>https</code>" 之一，则：</p>
                  <ol>
                    <li data-md>
                      <p><a data-link-type="dfn">终止</a>由 <var>requests</var> 发起的所有正在进行的 <a data-link-type="dfn"
                          href="https://fetch.spec.whatwg.org/#concept-fetch"
                          id="ref-for-concept-fetch⑥">fetches</a>，并设置为已中止。</p>
                    <li data-md>
                      <p>返回 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-rejected-with"
                          id="ref-for-a-promise-rejected-with⑤">一个以 <code>TypeError</code> 拒绝的 promise</a>。</p>
                  </ol>
                <li data-md>
                  <p>如果 <var>r</var> 的 <a data-link-type="dfn"
                      href="https://fetch.spec.whatwg.org/#concept-request-client"
                      id="ref-for-concept-request-client">客户端</a> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                      id="ref-for-concept-settings-object-global⑦">全局对象</a> 是一个 <code
                      class="idl"><a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope①②">ServiceWorkerGlobalScope</a></code>
                    对象，将 <var>request</var> 的 <a data-link-type="dfn"
                      href="https://fetch.spec.whatwg.org/#request-service-workers-mode"
                      id="ref-for-request-service-workers-mode">服务工作者模式</a> 设置为 "<code>none</code>"。</p>
                <li data-md>
                  <p>将 <var>r</var> 的 <a data-link-type="dfn"
                      href="https://fetch.spec.whatwg.org/#concept-request-initiator"
                      id="ref-for-concept-request-initiator">启动者</a> 设置为 "<code>fetch</code>"，并将 <a data-link-type="dfn"
                      href="https://fetch.spec.whatwg.org/#concept-request-destination"
                      id="ref-for-concept-request-destination">目标</a> 设置为 "<code>subresource</code>"。</p>
                <li data-md>
                  <p>将 <var>r</var> 添加到 <var>requestList</var>。</p>
                <li data-md>
                  <p>令 <var>responsePromise</var> 为 <a data-link-type="dfn"
                      href="https://webidl.spec.whatwg.org/#a-new-promise" id="ref-for-a-new-promise①⓪">一个新的
                      promise</a>。</p>
                <li data-md>
                  <p>并行运行以下子步骤 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                      id="ref-for-in-parallel①⑦">in parallel</a>：</p>
                  <ul>
                    <li data-md>
                      <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
                          id="ref-for-concept-fetch⑦">获取</a> <var>r</var>。</p>
                    <li data-md>
                      <p>要 <a data-link-type="dfn">处理响应</a> 的 <var>response</var>，请运行以下子步骤：</p>
                      <ol>
                        <li data-md>
                          <p>如果 <var>response</var> 的 <a data-link-type="dfn"
                              href="https://fetch.spec.whatwg.org/#concept-response-type"
                              id="ref-for-concept-response-type①">类型</a> 是 "<code>error</code>"，或者 <var>response</var> 的
                            <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-status"
                              id="ref-for-concept-response-status">状态</a> 不是 <a data-link-type="dfn"
                              href="https://fetch.spec.whatwg.org/#ok-status" id="ref-for-ok-status">ok 状态</a> 或者是
                            <code>206</code>，则以 <code>TypeError</code> 拒绝 <var>responsePromise</var>。
                          </p>
                        <li data-md>
                          <p>否则，如果 <var>response</var> 的 <a data-link-type="dfn"
                              href="https://fetch.spec.whatwg.org/#concept-response-header-list"
                              id="ref-for-concept-response-header-list">头列表</a> 包含名为 `<code>Vary</code>` 的 <a
                              data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header"
                              id="ref-for-concept-header">头</a>，则：</p>
                          <ol>
                            <li data-md>
                              <p>令 <var>fieldValues</var> 为包含与 <a data-link-type="dfn"
                                  href="https://tools.ietf.org/html/rfc7230#section-3.2"
                                  id="ref-for-section-3.2">字段值</a> 对应的元素的 <a data-link-type="dfn"
                                  href="https://infra.spec.whatwg.org/#list" id="ref-for-list①②">列表</a>，该元素来自 <a
                                  data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-7.1.4"
                                  id="ref-for-section-7.1.4">Vary</a> 头。</p>
                            <li data-md>
                              <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                  id="ref-for-list-iterate⑦">对于</a> <var>fieldValues</var> 中的每个 <var>fieldValue</var>：
                              </p>
                              <ol>
                                <li data-md>
                                  <p>如果 <var>fieldValue</var> 匹配 "<code>*</code>"，则：</p>
                                  <ol>
                                    <li data-md>
                                      <p>以 <code>TypeError</code> 拒绝 <var>responsePromise</var>。</p>
                                    <li data-md>
                                      <p><a data-link-type="dfn">终止</a>由 <var>requests</var> 发起的所有正在进行的 <a
                                          data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
                                          id="ref-for-concept-fetch⑧">fetches</a>，并设置为已中止。</p>
                                    <li data-md>
                                      <p>中止这些步骤。</p>
                                  </ol>
                              </ol>
                          </ol>
                      </ol>
                    <li data-md>
                      <p>要 <a data-link-type="dfn">处理响应正文结束</a> 的 <var>response</var>，请运行以下子步骤：</p>
                      <ol>
                        <li data-md>
                          <p>如果 <var>response</var> 的 <a data-link-type="dfn"
                              href="https://fetch.spec.whatwg.org/#concept-response-aborted"
                              id="ref-for-concept-response-aborted">已中止标志</a> 已设置，则以 "<code
                              class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#aborterror" id="ref-for-aborterror">AbortError</a></code>"
                            <code
                              class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException①③">DOMException</a></code>
                            拒绝 <var>responsePromise</var> 并中止这些步骤。
                          </p>
                        <li data-md>
                          <p>用 <var>response</var> 解决 <var>responsePromise</var>。</p>
                      </ol>
                      <p class="note" role="note"><span>注意：</span>允许在完全接收响应正文时提交缓存。</p>
                  </ul>
                <li data-md>
                  <p>将 <var>responsePromise</var> 添加到 <var>responsePromises</var>。</p>
              </ol>
            <li data-md>
              <p>令 <var>p</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#waiting-for-all-promise"
                  id="ref-for-waiting-for-all-promise">获取一个等待所有</a> <var>responsePromises</var> 的 promise 的结果。</p>
            <li data-md>
              <p>返回 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#dfn-perform-steps-once-promise-is-settled"
                  id="ref-for-dfn-perform-steps-once-promise-is-settled①">对 <var>p</var> 作出反应</a> 的结果，使用一个履行处理程序，当使用参数
                <var>responses</var> 调用时，执行以下子步骤：
              </p>
              <ol>
                <li data-md>
                  <p>令 <var>operations</var> 为一个空的 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                      id="ref-for-list①③">列表</a>。</p>
                <li data-md>
                  <p>令 <var>index</var> 为零。</p>
                <li data-md>
                  <p>对于 <var>responses</var> 中的每个 <var>response</var>：</p>
                  <ol>
                    <li data-md>
                      <p>令 <var>operation</var> 为 <a data-link-type="dfn" href="#dfn-cache-batch-operation"
                          id="ref-for-dfn-cache-batch-operation">缓存批处理操作</a>。</p>
                    <li data-md>
                      <p>将 <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-type"
                          id="ref-for-dfn-cache-batch-operation-type">类型</a> 设置为 "<code>put</code>"。</p>
                    <li data-md>
                      <p>将 <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-request"
                          id="ref-for-dfn-cache-batch-operation-request">请求</a> 设置为
                        <var>requestList</var>[<var>index</var>]。
                      </p>
                    <li data-md>
                      <p>将 <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-response"
                          id="ref-for-dfn-cache-batch-operation-response">响应</a> 设置为 <var>response</var>。</p>
                    <li data-md>
                      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append"
                          id="ref-for-list-append④">将 <var>operation</var> 附加</a> 到 <var>operations</var>。</p>
                    <li data-md>
                      <p>将 <var>index</var> 增加一。</p>
                  </ol>
                <li data-md>
                  <p>令 <var>realm</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                      id="ref-for-this⑤⑥">this</a> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm"
                      id="ref-for-concept-relevant-realm⑤">相关领域</a>。</p>
                <li data-md>
                  <p>令 <var>cacheJobPromise</var> 为 <a data-link-type="dfn"
                      href="https://webidl.spec.whatwg.org/#a-new-promise" id="ref-for-a-new-promise①①">一个新的
                      promise</a>。</p>
                <li data-md>
                  <p>并行运行以下子步骤 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                      id="ref-for-in-parallel①⑧">in parallel</a>：</p>
                  <ol>
                    <li data-md>
                      <p>令 <var>errorData</var> 为 null。</p>
                    <li data-md>
                      <p>调用 <a data-link-type="dfn" href="#batch-cache-operations"
                          id="ref-for-batch-cache-operations">批量缓存操作</a> 使用 <var>operations</var>。如果这 <a
                          data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw"
                          id="ref-for-dfn-throw⑧">抛出</a> 异常，将 <var>errorData</var> 设置为该异常。</p>
                    <li data-md>
                      <p><a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                          id="ref-for-queue-a-task①⑦">排队一个任务</a>，在 <var>cacheJobPromise</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                          id="ref-for-relevant-settings-object②③">相关设置对象</a> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                          id="ref-for-responsible-event-loop⑦">负责的事件循环</a> 上使用 <a data-link-type="dfn">DOM
                          操作任务源</a>，以执行以下子步骤：</p>
                      <ol>
                        <li data-md>
                          <p>如果 <var>errorData</var> 为 null，则用 undefined 解决 <var>cacheJobPromise</var>。</p>
                        <li data-md>
                          <p>否则，用 <var>errorData</var> 和用户代理定义的 <a data-link-type="dfn"
                              href="https://webidl.spec.whatwg.org/#dfn-exception-message"
                              id="ref-for-dfn-exception-message">消息</a> 拒绝 <var>cacheJobPromise</var>，并 <a
                              data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-create-exception"
                              id="ref-for-dfn-create-exception">创建新的</a> <a data-link-type="dfn"
                              href="https://webidl.spec.whatwg.org/#dfn-exception" id="ref-for-dfn-exception">异常</a> 在
                            <var>realm</var> 中。
                          </p>
                      </ol>
                  </ol>
                <li data-md>
                  <p>返回 <var>cacheJobPromise</var>。</p>
              </ol>
          </ol>
        </section>

        <section class="algorithm" data-algorithm="cache-put">
          <h4 class="heading settled" data-level="5.4.5" id="cache-put"><span class="secno">5.4.5. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-cache-put" id="ref-for-dom-cache-put①">put(request, response)</a></code></span><a
              class="self-link" href="#cache-put"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Cache/put"
                  title="Cache 接口的 put() 方法允许将键/值对添加到当前的缓存对象中。">Cache/put</a></p>
              <p class="all-engines-text">适用于所有当前引擎。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>41+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>43+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>30+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>16+</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Android 版 Firefox</span><span>41+</span></span><span
                  class="safari_ios yes"><span>iOS 版 Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Android 版 Chrome</span><span>43+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>43+</span></span><span
                  class="samsunginternet_android yes"><span>三星互联网</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera 移动版</span><span>30+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="Cache" data-dfn-type="method" data-export
              id="dom-cache-put"><code>put(<var>request</var>, <var>response</var>)</code></dfn> 方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>令 <var>innerRequest</var> 为 null。</p>
            <li data-md>
              <p>如果 <var>request</var> 是 <code
                  class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request⑦">Request</a></code>
                对象，则将 <var>innerRequest</var> 设置为 <var>request</var> 的 <a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-request-request"
                  id="ref-for-concept-request-request④">请求</a>。</p>
            <li data-md>
              <p>否则：</p>
              <ol>
                <li data-md>
                  <p>令 <var>requestObj</var> 为调用 <code
                      class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request⑧">Request</a></code>
                    构造函数并以 <var>request</var> 作为参数的结果。如果这 <a data-link-type="dfn"
                      href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw⑨">抛出</a> <var>异常</var>，则返回
                    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-rejected-with"
                      id="ref-for-a-promise-rejected-with⑥">一个以该异常拒绝的 promise</a>。
                  </p>
                <li data-md>
                  <p>将 <var>innerRequest</var> 设置为 <var>requestObj</var> 的 <a data-link-type="dfn"
                      href="https://fetch.spec.whatwg.org/#concept-request-request"
                      id="ref-for-concept-request-request⑤">请求</a>。</p>
              </ol>
            <li data-md>
              <p>如果 <var>innerRequest</var> 的 <a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url③">url</a> 的
                <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme"
                  id="ref-for-concept-url-scheme②">协议</a> 不是 "<code>http</code>" 和 "<code>https</code>" 之一，或者
                <var>innerRequest</var> 的 <a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-request-method"
                  id="ref-for-concept-request-method②">方法</a> 不是 `<code>GET</code>`，则返回 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#a-promise-rejected-with"
                  id="ref-for-a-promise-rejected-with⑦">一个以 <code>TypeError</code> 拒绝的 promise</a>。
              </p>
            <li data-md>
              <p>令 <var>innerResponse</var> 为 <var>response</var> 的 <a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-response-response"
                  id="ref-for-concept-response-response①">响应</a>。</p>
            <li data-md>
              <p>如果 <var>innerResponse</var> 的 <a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-response-status"
                  id="ref-for-concept-response-status①">状态</a> 是 <code>206</code>，则返回 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#a-promise-rejected-with"
                  id="ref-for-a-promise-rejected-with⑧">一个以 <code>TypeError</code> 拒绝的 promise</a>。</p>
            <li data-md>
              <p>如果 <var>innerResponse</var> 的 <a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-response-header-list"
                  id="ref-for-concept-response-header-list①">头列表</a> 包含名为 `<code>Vary</code>` 的 <a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-header①">头</a>，则：</p>
              <ol>
                <li data-md>
                  <p>令 <var>fieldValues</var> 为包含与 <a data-link-type="dfn"
                      href="https://tools.ietf.org/html/rfc7231#section-7.1.4" id="ref-for-section-7.1.4①">Vary</a> 头的
                    <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7230#section-3.2"
                      id="ref-for-section-3.2①">字段值</a> 对应的 <a data-link-type="dfn"
                      href="https://infra.spec.whatwg.org/#list" id="ref-for-list①④">列表</a>。
                  </p>
                <li data-md>
                  <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                      id="ref-for-list-iterate⑧">对于</a> <var>fieldValues</var> 中的每个 <var>fieldValue</var>：</p>
                  <ol>
                    <li data-md>
                      <p>如果 <var>fieldValue</var> 匹配 "<code>*</code>"，则返回 <a data-link-type="dfn"
                          href="https://webidl.spec.whatwg.org/#a-promise-rejected-with"
                          id="ref-for-a-promise-rejected-with⑨">一个以 <code>TypeError</code> 拒绝的 promise</a>。</p>
                  </ol>
              </ol>
            <li data-md>
              <p>如果 <var>innerResponse</var> 的 <a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-response-body"
                  id="ref-for-concept-response-body⑤">正文</a>是 <a data-link-type="dfn">被破坏的</a> 或 <a
                  data-link-type="dfn">被锁定的</a>，则返回 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#a-promise-rejected-with"
                  id="ref-for-a-promise-rejected-with①⓪">一个以 <code>TypeError</code> 拒绝的 promise</a>。</p>
            <li data-md>
              <p>令 <var>clonedResponse</var> 为 <var>innerResponse</var> 的 <a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-response-clone"
                  id="ref-for-concept-response-clone">克隆</a>。</p>
            <li data-md>
              <p>令 <var>bodyReadPromise</var> 为 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#a-promise-resolved-with"
                  id="ref-for-a-promise-resolved-with②">一个以 undefined 解决的 promise</a>。</p>
            <li data-md>
              <p>如果 <var>innerResponse</var> 的 <a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-response-body" id="ref-for-concept-response-body⑥">正文</a>
                非空，则运行以下子步骤：</p>
              <ol>
                <li data-md>
                  <p>令 <var>stream</var> 为 <var>innerResponse</var> 的 <a data-link-type="dfn"
                      href="https://fetch.spec.whatwg.org/#concept-response-body"
                      id="ref-for-concept-response-body⑦">正文</a> 的 <a data-link-type="dfn"
                      href="https://fetch.spec.whatwg.org/#concept-body-stream" id="ref-for-concept-body-stream③">流</a>。
                  </p>
                <li data-md>
                  <p>令 <var>reader</var> 为 <a data-link-type="dfn"
                      href="https://streams.spec.whatwg.org/#readablestream-get-a-reader"
                      id="ref-for-readablestream-get-a-reader①">获取</a> <var>stream</var> 的读取器的结果。</p>
                <li data-md>
                  <p>将 <var>bodyReadPromise</var> 设置为 <a data-link-type="dfn"
                      href="https://streams.spec.whatwg.org/#readablestreamdefaultreader-read-all-bytes"
                      id="ref-for-readablestreamdefaultreader-read-all-bytes">从 <var>reader</var> 读取所有字节</a>的结果。</p>
              </ol>
              <p class="note" role="note"><span>注意：</span>这确保了 <var>innerResponse</var> 的 <a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-response-body"
                  id="ref-for-concept-response-body⑧">正文</a>被 <a data-link-type="dfn">锁定</a>，并且我们在
                <var>clonedResponse</var> 中有一个完整的正文缓冲副本。实现可以通过直接流式传输到磁盘而不是内存来优化。
              </p>
            <li data-md>
              <p>令 <var>operations</var> 为一个空的 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                  id="ref-for-list①⑤">列表</a>。</p>
            <li data-md>
              <p>令 <var>operation</var> 为 <a data-link-type="dfn" href="#dfn-cache-batch-operation"
                  id="ref-for-dfn-cache-batch-operation①">缓存批处理操作</a>。</p>
            <li data-md>
              <p>将 <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-type"
                  id="ref-for-dfn-cache-batch-operation-type①">类型</a> 设置为 "<code>put</code>"。</p>
            <li data-md>
              <p>将 <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-request"
                  id="ref-for-dfn-cache-batch-operation-request①">请求</a> 设置为 <var>innerRequest</var>。</p>
            <li data-md>
              <p>将 <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-response"
                  id="ref-for-dfn-cache-batch-operation-response①">响应</a> 设置为 <var>clonedResponse</var>。</p>
            <li data-md>
              <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append⑤">将
                  <var>operation</var> 附加</a>到 <var>operations</var>。</p>
            <li data-md>
              <p>令 <var>realm</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this⑤⑦">this</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm"
                  id="ref-for-concept-relevant-realm⑥">相关领域</a>。</p>
            <li data-md>
              <p>返回 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#upon-fulfillment"
                  id="ref-for-upon-fulfillment②">履行</a> <var>bodyReadPromise</var> 的结果：</p>
              <ol>
                <li data-md>
                  <p>令 <var>cacheJobPromise</var> 为 <a data-link-type="dfn"
                      href="https://webidl.spec.whatwg.org/#a-new-promise" id="ref-for-a-new-promise①②">一个新的
                      promise</a>。</p>
                <li data-md>
                  <p>返回 <var>cacheJobPromise</var> 并运行这些步骤 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                      id="ref-for-in-parallel①⑨">in parallel</a>：</p>
                  <ol>
                    <li data-md>
                      <p>令 <var>errorData</var> 为 null。</p>
                    <li data-md>
                      <p>调用 <a data-link-type="dfn" href="#batch-cache-operations"
                          id="ref-for-batch-cache-operations①">批量缓存操作</a> 使用 <var>operations</var>。如果这 <a
                          data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw"
                          id="ref-for-dfn-throw①⓪">抛出</a> 异常，将 <var>errorData</var> 设置为该异常。</p>
                    <li data-md>
                      <p><a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                          id="ref-for-queue-a-task①⑧">排队一个任务</a>，在 <var>cacheJobPromise</var> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                          id="ref-for-relevant-settings-object②④">相关设置对象</a> 的 <a data-link-type="dfn"
                          href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                          id="ref-for-responsible-event-loop⑧">负责的事件循环</a> 上使用 <a data-link-type="dfn">DOM
                          操作任务源</a>，以执行以下子步骤：</p>
                      <ol>
                        <li data-md>
                          <p>如果 <var>errorData</var> 为 null，则用 undefined 解决 <var>cacheJobPromise</var>。</p>
                        <li data-md>
                          <p>否则，用 <var>errorData</var> 和用户代理定义的 <a data-link-type="dfn"
                              href="https://webidl.spec.whatwg.org/#dfn-exception-message"
                              id="ref-for-dfn-exception-message①">消息</a> 拒绝 <var>cacheJobPromise</var>，并 <a
                              data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-create-exception"
                              id="ref-for-dfn-create-exception①">创建新的</a> <a data-link-type="dfn"
                              href="https://webidl.spec.whatwg.org/#dfn-exception" id="ref-for-dfn-exception①">异常</a> 在
                            <var>realm</var> 中。
                          </p>
                      </ol>
                  </ol>
              </ol>
          </ol>
        </section>

        <section class="algorithm" data-algorithm="cache-delete">
          <h4 class="heading settled" data-level="5.4.6" id="cache-delete"><span class="secno">5.4.6. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-cache-delete" id="ref-for-dom-cache-delete①">delete(request, options)</a></code></span><a
              class="self-link" href="#cache-delete"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Cache/delete"
                  title="Cache 接口的 delete() 方法查找键为请求的缓存条目，如果找到，则删除缓存条目并返回一个解析为 true 的 Promise。如果未找到缓存条目，则返回解析为 false 的 Promise。">Cache/delete</a>
              </p>
              <p class="all-engines-text">适用于所有当前引擎。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>41+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>43+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>30+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>16+</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Android 版 Firefox</span><span>41+</span></span><span
                  class="safari_ios yes"><span>iOS 版 Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Android 版 Chrome</span><span>43+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>43+</span></span><span
                  class="samsunginternet_android yes"><span>三星互联网</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera 移动版</span><span>30+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="Cache" data-dfn-type="method" data-export
              data-lt="delete(request, options)|delete(request)"
              id="dom-cache-delete"><code>delete(<var>request</var>, <var>options</var>)</code></dfn> 方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>令 <var>r</var> 为 null。</p>
            <li data-md>
              <p>如果 <var>request</var> 是 <code
                  class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request⑨">Request</a></code>
                对象，则：</p>
              <ol>
                <li data-md>
                  <p>将 <var>r</var> 设置为 <var>request</var> 的 <a data-link-type="dfn"
                      href="https://fetch.spec.whatwg.org/#concept-request-request"
                      id="ref-for-concept-request-request⑥">请求</a>。</p>
                <li data-md>
                  <p>如果 <var>r</var> 的 <a data-link-type="dfn"
                      href="https://fetch.spec.whatwg.org/#concept-request-method"
                      id="ref-for-concept-request-method③">方法</a> 不是 `<code>GET</code>` 并且
                    <var>options</var>.ignoreMethod 为 false，返回 <a data-link-type="dfn"
                      href="https://webidl.spec.whatwg.org/#a-promise-resolved-with"
                      id="ref-for-a-promise-resolved-with③">一个解析为 false 的 promise</a>。
                  </p>
              </ol>
            <li data-md>
              <p>否则，如果 <var>request</var> 是字符串，则：</p>
              <ol>
                <li data-md>
                  <p>将 <var>r</var> 设置为调用初始值的 <code
                      class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request①⓪">Request</a></code>
                    构造函数并以 <var>request</var> 作为参数的结果的关联 <a data-link-type="dfn"
                      href="https://fetch.spec.whatwg.org/#concept-request-request"
                      id="ref-for-concept-request-request⑦">请求</a>。如果这 <a data-link-type="dfn"
                      href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw①①">抛出</a> 异常，返回 <a
                      data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-rejected-with"
                      id="ref-for-a-promise-rejected-with①①">一个以该异常拒绝的 promise</a>。</p>
              </ol>
            <li data-md>
              <p>令 <var>operations</var> 为一个空的 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                  id="ref-for-list①⑥">列表</a>。</p>
            <li data-md>
              <p>令 <var>operation</var> 为 <a data-link-type="dfn" href="#dfn-cache-batch-operation"
                  id="ref-for-dfn-cache-batch-operation②">缓存批处理操作</a>。</p>
            <li data-md>
              <p>将 <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-type"
                  id="ref-for-dfn-cache-batch-operation-type②">类型</a> 设置为 "<code>delete</code>"。</p>
            <li data-md>
              <p>将 <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-request"
                  id="ref-for-dfn-cache-batch-operation-request②">请求</a> 设置为 <var>r</var>。</p>
            <li data-md>
              <p>将 <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-options"
                  id="ref-for-dfn-cache-batch-operation-options">选项</a> 设置为 <var>options</var>。</p>
            <li data-md>
              <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append⑥">将
                  <var>operation</var> 附加</a> 到 <var>operations</var>。</p>
            <li data-md>
              <p>令 <var>realm</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this⑤⑧">this</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm"
                  id="ref-for-concept-relevant-realm⑦">相关领域</a>。</p>
            <li data-md>
              <p>令 <var>cacheJobPromise</var> 为 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#a-new-promise" id="ref-for-a-new-promise①③">一个新的 promise</a>。
              </p>
            <li data-md>
              <p>并行运行以下子步骤 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                  id="ref-for-in-parallel②⓪">in parallel</a>：</p>
              <ol>
                <li data-md>
                  <p>令 <var>errorData</var> 为 null。</p>
                <li data-md>
                  <p>令 <var>requestResponses</var> 为运行 <a data-link-type="dfn" href="#batch-cache-operations"
                      id="ref-for-batch-cache-operations②">批量缓存操作</a> 并以 <var>operations</var> 作为参数的结果。如果这 <a
                      data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw"
                      id="ref-for-dfn-throw①②">抛出</a> 异常，将 <var>errorData</var> 设置为该异常。</p>
                <li data-md>
                  <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                      id="ref-for-queue-a-task①⑨">排队一个任务</a>，在 <var>cacheJobPromise</var> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                      id="ref-for-relevant-settings-object②⑤">相关设置对象</a> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                      id="ref-for-responsible-event-loop⑨">负责的事件循环</a> 上使用 <a data-link-type="dfn">DOM
                      操作任务源</a>，以执行以下子步骤：</p>
                  <ol>
                    <li data-md>
                      <p>如果 <var>errorData</var> 为 null，则：</p>
                      <ol>
                        <li data-md>
                          <p>如果 <var>requestResponses</var> <a data-link-type="dfn"
                              href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty">非空</a>，则以
                            true 解决 <var>cacheJobPromise</var>。</p>
                        <li data-md>
                          <p>否则，以 false 解决 <var>cacheJobPromise</var>。</p>
                      </ol>
                    <li data-md>
                      <p>否则，用 <var>errorData</var> 和用户代理定义的 <a data-link-type="dfn"
                          href="https://webidl.spec.whatwg.org/#dfn-exception-message"
                          id="ref-for-dfn-exception-message②">消息</a> 拒绝 <var>cacheJobPromise</var>，并 <a
                          data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-create-exception"
                          id="ref-for-dfn-create-exception②">创建新的</a> <a data-link-type="dfn"
                          href="https://webidl.spec.whatwg.org/#dfn-exception" id="ref-for-dfn-exception②">异常</a> 在
                        <var>realm</var> 中。
                      </p>
                  </ol>
              </ol>
            <li data-md>
              <p>返回 <var>cacheJobPromise</var>。</p>
          </ol>
        </section>

        <section class="algorithm" data-algorithm="cache-keys">
          <h4 class="heading settled" data-level="5.4.7" id="cache-keys"><span class="secno">5.4.7. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-cache-keys" id="ref-for-dom-cache-keys①">keys(request, options)</a></code></span><a
              class="self-link" href="#cache-keys"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Cache/keys"
                  title="Cache 接口的 keys() 方法返回一个 Promise，该 Promise 解析为表示 Cache 键的 Request 对象的数组。">Cache/keys</a></p>
              <p class="all-engines-text">适用于所有当前引擎。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>41+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>43+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>30+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>16+</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Android 版 Firefox</span><span>41+</span></span><span
                  class="safari_ios yes"><span>iOS 版 Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Android 版 Chrome</span><span>43+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>43+</span></span><span
                  class="samsunginternet_android yes"><span>三星互联网</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera 移动版</span><span>30+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="Cache" data-dfn-type="method" data-export
              data-lt="keys(request, options)|keys(request)|keys()"
              id="dom-cache-keys"><code>keys(<var>request</var>, <var>options</var>)</code></dfn> 方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>令 <var>r</var> 为 null。</p>
            <li data-md>
              <p>如果未省略可选参数 <var>request</var>，则：</p>
              <ol>
                <li data-md>
                  <p>如果 <var>request</var> 是 <code
                      class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request①①">Request</a></code>
                    对象，则：</p>
                  <ol>
                    <li data-md>
                      <p>将 <var>r</var> 设置为 <var>request</var> 的 <a data-link-type="dfn"
                          href="https://fetch.spec.whatwg.org/#concept-request-request"
                          id="ref-for-concept-request-request⑧">请求</a>。</p>
                    <li data-md>
                      <p>如果 <var>r</var> 的 <a data-link-type="dfn"
                          href="https://fetch.spec.whatwg.org/#concept-request-method"
                          id="ref-for-concept-request-method④">方法</a> 不是 `<code>GET</code>` 并且
                        <var>options</var>.ignoreMethod 为 false，返回 <a data-link-type="dfn"
                          href="https://webidl.spec.whatwg.org/#a-promise-resolved-with"
                          id="ref-for-a-promise-resolved-with④">一个解析为空数组的 promise</a>。
                      </p>
                  </ol>
                <li data-md>
                  <p>否则，如果 <var>request</var> 是字符串，则：</p>
                  <ol>
                    <li data-md>
                      <p>将 <var>r</var> 设置为调用初始值的 <code
                          class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request①②">Request</a></code>
                        构造函数并以 <var>request</var> 作为参数的结果的关联 <a data-link-type="dfn"
                          href="https://fetch.spec.whatwg.org/#concept-request-request"
                          id="ref-for-concept-request-request⑨">请求</a>。如果这 <a data-link-type="dfn"
                          href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw①③">抛出</a> 异常，返回 <a
                          data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-rejected-with"
                          id="ref-for-a-promise-rejected-with①②">一个以该异常拒绝的 promise</a>。</p>
                  </ol>
              </ol>
            <li data-md>
              <p>令 <var>realm</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                  id="ref-for-this⑤⑨">this</a> 的 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm"
                  id="ref-for-concept-relevant-realm⑧">相关领域</a>。</p>
            <li data-md>
              <p>令 <var>promise</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                  id="ref-for-a-new-promise①④">一个新的 promise</a>。</p>
            <li data-md>
              <p>并行运行以下子步骤 <a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                  id="ref-for-in-parallel②①">in parallel</a>：</p>
              <ol>
                <li data-md>
                  <p>令 <var>requests</var> 为一个空的 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                      id="ref-for-list①⑦">列表</a>。</p>
                <li data-md>
                  <p>如果省略了可选参数 <var>request</var>，则：</p>
                  <ol>
                    <li data-md>
                      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                          id="ref-for-list-iterate⑨">对于每个</a> <var>requestResponse</var> 属于 <a data-link-type="dfn"
                          href="#dfn-relevant-request-response-list"
                          id="ref-for-dfn-relevant-request-response-list①">相关的请求响应列表</a>：</p>
                      <ol>
                        <li data-md>
                          <p>将 <var>requestResponse</var> 的请求添加到 <var>requests</var>。</p>
                      </ol>
                  </ol>
                <li data-md>
                  <p>否则：</p>
                  <ol>
                    <li data-md>
                      <p>令 <var>requestResponses</var> 为运行 <a data-link-type="dfn" href="#query-cache"
                          id="ref-for-query-cache①">查询缓存</a> 并以 <var>r</var> 和 <var>options</var> 作为参数的结果。</p>
                    <li data-md>
                      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                          id="ref-for-list-iterate①⓪">对于每个</a> <var>requestResponse</var> 属于
                        <var>requestResponses</var>：
                      </p>
                      <ol>
                        <li data-md>
                          <p>将 <var>requestResponse</var> 的请求添加到 <var>requests</var>。</p>
                      </ol>
                  </ol>
                <li data-md>
                  <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                      id="ref-for-queue-a-task②⓪">排队一个任务</a>，在 <var>promise</var> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                      id="ref-for-relevant-settings-object②⑥">相关设置对象</a> 的 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                      id="ref-for-responsible-event-loop①⓪">负责事件循环</a> 上使用 <a data-link-type="dfn">DOM 操作任务源</a>，执行以下步骤：
                  </p>
                  <ol>
                    <li data-md>
                      <p>令 <var>requestList</var> 为一个 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                          id="ref-for-list①⑧">列表</a>。</p>
                    <li data-md>
                      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                          id="ref-for-list-iterate①①">对于每个</a> <var>request</var> 属于 <var>requests</var>：</p>
                      <ol>
                        <li data-md>
                          <p>将与 <var>request</var> 相关联的新 <code
                              class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request①③">Request</a></code>
                            对象和与之关联的新 <code
                              class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#headers" id="ref-for-headers①">Headers</a></code>
                            对象添加到 <var>requestList</var> 中，其 <a data-link-type="dfn"
                              href="https://fetch.spec.whatwg.org/#concept-headers-guard"
                              id="ref-for-concept-headers-guard①">保护</a> 是 "<code>immutable</code>"。</p>
                      </ol>
                    <li data-md>
                      <p>用一个从 <var>requestList</var> 创建的 <a data-link-type="dfn"
                          href="https://webidl.spec.whatwg.org/#dfn-create-frozen-array"
                          id="ref-for-dfn-create-frozen-array③">冻结数组</a> 解析 <var>promise</var>，该数组在 <var>realm</var>
                        中创建。</p>
                  </ol>
              </ol>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
          </ol>
        </section>
      </section>
      <section>
        <h3 class="heading settled" data-level="5.5" id="cachestorage-interface"><span class="secno">5.5. </span><span
            class="content"><code
              class="idl"><a data-link-type="idl" href="#cachestorage" id="ref-for-cachestorage②">CacheStorage</a></code></span><a
            class="self-link" href="#cachestorage-interface"></a></h3>
        <div class="mdn-anno wrapped after">
          <button class="mdn-anno-btn"><b class="all-engines-flag" title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
          <div class="feature">
            <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/CacheStorage"
                title="CacheStorage 接口表示 Cache 对象的存储。">CacheStorage</a></p>
            <p class="all-engines-text">适用于所有当前引擎。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>41+</span></span><span
                class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                class="chrome yes"><span>Chrome</span><span>40+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (旧版)</span><span>16+</span></span><span
                class="ie no"><span>IE</span><span>无</span></span>
              <hr>
              <span class="firefox_android yes"><span>Android 版 Firefox</span><span>41+</span></span><span
                class="safari_ios yes"><span>iOS 版 Safari</span><span>11.3+</span></span><span
                class="chrome_android yes"><span>Android 版 Chrome</span><span>40+</span></span><span
                class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                class="samsunginternet_android yes"><span>三星互联网</span><span>4.0+</span></span><span
                class="opera_android yes"><span>Opera 移动版</span><span>27+</span></span>
            </div>
          </div>
        </div>
        <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext⑧"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①②"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="cachestorage"><code><c- g>CacheStorage</c-></code></dfn> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject①⑨"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise③⓪"><c- b>Promise</c-></a>&lt;(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response①⓪"><c- n>Response</c-></a> <c- b>or</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined②①"><c- b>undefined</c-></a>)> <a class="idl-code" data-link-type="method" href="#dom-cachestorage-match" id="ref-for-dom-cachestorage-match"><c- g>match</c-></a>(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo" id="ref-for-requestinfo⑦"><c- n>RequestInfo</c-></a> <dfn class="idl-code" data-dfn-for="CacheStorage/match(request, options), CacheStorage/match(request)" data-dfn-type="argument" data-export id="dom-cachestorage-match-request-options-request"><code><c- g>request</c-></code><a class="self-link" href="#dom-cachestorage-match-request-options-request"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-multicachequeryoptions" id="ref-for-dictdef-multicachequeryoptions"><c- n>MultiCacheQueryOptions</c-></a> <dfn class="idl-code" data-dfn-for="CacheStorage/match(request, options), CacheStorage/match(request)" data-dfn-type="argument" data-export id="dom-cachestorage-match-request-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-cachestorage-match-request-options-options"></a></dfn> = {});
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject②⓪"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise③①"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean⑧"><c- b>boolean</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-cachestorage-has" id="ref-for-dom-cachestorage-has"><c- g>has</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①③"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="CacheStorage/has(cacheName)" data-dfn-type="argument" data-export id="dom-cachestorage-has-cachename-cachename"><code><c- g>cacheName</c-></code><a class="self-link" href="#dom-cachestorage-has-cachename-cachename"></a></dfn>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject②①"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise③②"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#cache" id="ref-for-cache①①"><c- n>Cache</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-cachestorage-open" id="ref-for-dom-cachestorage-open"><c- g>open</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①④"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="CacheStorage/open(cacheName)" data-dfn-type="argument" data-export id="dom-cachestorage-open-cachename-cachename"><code><c- g>cacheName</c-></code><a class="self-link" href="#dom-cachestorage-open-cachename-cachename"></a></dfn>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject②②"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise③③"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean⑨"><c- b>boolean</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-cachestorage-delete" id="ref-for-dom-cachestorage-delete"><c- g>delete</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①⑤"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="CacheStorage/delete(cacheName)" data-dfn-type="argument" data-export id="dom-cachestorage-delete-cachename-cachename"><code><c- g>cacheName</c-></code><a class="self-link" href="#dom-cachestorage-delete-cachename-cachename"></a></dfn>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject" id="ref-for-NewObject②③"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise③④"><c- b>Promise</c-></a>&lt;<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence" id="ref-for-idl-sequence④"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①⑥"><c- b>DOMString</c-></a>>> <a class="idl-code" data-link-type="method" href="#dom-cachestorage-keys" id="ref-for-dom-cachestorage-keys"><c- g>keys</c-></a>();
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-multicachequeryoptions"><code><c- g>MultiCacheQueryOptions</c-></code></dfn> : <a data-link-type="idl-name" href="#dictdef-cachequeryoptions" id="ref-for-dictdef-cachequeryoptions⑤"><c- n>CacheQueryOptions</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①⑦"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MultiCacheQueryOptions" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-multicachequeryoptions-cachename"><code><c- g>cacheName</c-></code></dfn>;
};
</pre>
        <p class="note" role="note"><span>注意:</span> <code
            class="idl"><a data-link-type="idl" href="#cachestorage" id="ref-for-cachestorage③">CacheStorage</a></code>
          接口设计旨在很大程度上符合 <a data-link-type="dfn" href="http://tc39.github.io/ecma262/#sec-map-objects"
            id="ref-for-sec-map-objects">ECMAScript 6 Map
            对象</a>，但完全是异步的，并且具有额外的便捷方法。<code>clear</code>、<code>forEach</code>、<code>entries</code> 和
          <code>values</code> 方法在第一版中有意排除在外，依赖于 TC39 对异步迭代的持续讨论。
        </p>
        <p>用户代理 <em>必须</em> 在创建 <code
            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window⑧">Window</a></code>
          对象或 <code
            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope②">WorkerGlobalScope</a></code>
          对象时创建一个 <code
            class="idl"><a data-link-type="idl" href="#cachestorage" id="ref-for-cachestorage④">CacheStorage</a></code>
          对象，并将其与该 <dfn class="dfn-paneled" data-dfn-for="CacheStorage" data-dfn-type="dfn" data-noexport
            id="cachestorage-global-object">全局对象</dfn> 关联。</p>
        <p>一个 <code
            class="idl"><a data-link-type="idl" href="#cachestorage" id="ref-for-cachestorage⑤">CacheStorage</a></code>
          对象表示其关联的 <a data-link-type="dfn" href="#dfn-name-to-cache-map"
            id="ref-for-dfn-name-to-cache-map②">名称到缓存映射</a>。多个跨文档和工作线程实现 <code
            class="idl"><a data-link-type="idl" href="#cachestorage" id="ref-for-cachestorage⑥">CacheStorage</a></code>
          接口的独立对象可以同时与同一个 <a data-link-type="dfn" href="#dfn-name-to-cache-map"
            id="ref-for-dfn-name-to-cache-map③">名称到缓存映射</a> 相关联。</p>
        <section class="algorithm" data-algorithm="cache-storage-match">
          <h4 class="heading settled" data-level="5.5.1" id="cache-storage-match"><span class="secno">5.5.1.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-cachestorage-match" id="ref-for-dom-cachestorage-match①">match(request, options)</a></code></span><a
              class="self-link" href="#cache-storage-match"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/CacheStorage/match"
                  title="CacheStorage 接口的 match() 方法检查给定的 Request 或 URL 字符串是否是存储的 Response 的键。此方法返回一个 Promise 对象，该对象解析为一个 Response；如果未找到匹配项，则解析为 undefined。">CacheStorage/match</a>
              </p>
              <p class="all-engines-text">适用于所有当前引擎。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>41+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>54+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>41+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>16+</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Android 版 Firefox</span><span>41+</span></span><span
                  class="safari_ios yes"><span>iOS 版 Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Android 版 Chrome</span><span>54+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>54+</span></span><span
                  class="samsunginternet_android yes"><span>三星互联网</span><span>6.0+</span></span><span
                  class="opera_android yes"><span>Opera 移动版</span><span>41+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="CacheStorage" data-dfn-type="method" data-export
              data-lt="match(request, options)|match(request)"
              id="dom-cachestorage-match"><code>match(<var>request</var>, <var>options</var>)</code></dfn> 方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>如果 <var>options</var>["<code
                  class="idl"><a data-link-type="idl" href="#dom-multicachequeryoptions-cachename" id="ref-for-dom-multicachequeryoptions-cachename">cacheName</a></code>"]
                <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists"
                  id="ref-for-map-exists③">存在</a>，则：
              </p>
              <ol>
                <li data-md>
                  <p>返回 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                      id="ref-for-a-new-promise①⑤">一个新 promise</a> <var>promise</var> 并在 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                      id="ref-for-in-parallel②②">并行</a> 中运行以下子步骤：</p>
                  <ol>
                    <li data-md>
                      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate"
                          id="ref-for-map-iterate①">对于</a> <var>relevant name to cache map</var> 中的每个
                        <var>cacheName</var> → <var>cache</var>：
                      </p>
                      <ol>
                        <li data-md>
                          <p>如果 <var>options</var>["<code
                              class="idl"><a data-link-type="idl" href="#dom-multicachequeryoptions-cachename" id="ref-for-dom-multicachequeryoptions-cachename①">cacheName</a></code>"]
                            匹配 <var>cacheName</var>，则：</p>
                          <ol>
                            <li data-md>
                              <p>使用 <var>request</var> 和 <var>options</var> 作为参数（提供 <var>cache</var> 作为
                                <code>[[Call]]</code> 内部方法的 <code>thisArgument</code>），使用 <code
                                  class="idl"><a data-link-type="idl" href="#dom-cache-match" id="ref-for-dom-cache-match②">match(request, options)</a></code>
                                方法运行指定的算法，并使用该结果解析 <var>promise</var>。
                              </p>
                            <li data-md>
                              <p>终止这些步骤。</p>
                          </ol>
                      </ol>
                    <li data-md>
                      <p>使用 undefined 解析 <var>promise</var>。</p>
                  </ol>
              </ol>
            <li data-md>
              <p>否则：</p>
              <ol>
                <li data-md>
                  <p>将 <var>promise</var> 设置为 <a data-link-type="dfn"
                      href="https://webidl.spec.whatwg.org/#a-promise-resolved-with"
                      id="ref-for-a-promise-resolved-with⑤">解析为</a> undefined 的 promise。</p>
                <li data-md>
                  <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate"
                      id="ref-for-map-iterate②">对于</a> <var>relevant name to cache map</var> 中的每个 <var>cacheName</var> →
                    <var>cache</var>：
                  </p>
                  <ol>
                    <li data-md>
                      <p>将 <var>promise</var> 设置为对自身进行响应的结果，其中包含一个满足处理程序，该处理程序在调用时传递参数 <var>response</var>，并执行以下子步骤：</p>
                      <ol>
                        <li data-md>
                          <p>如果 <var>response</var> 不是 undefined，则返回 <var>response</var>。</p>
                        <li data-md>
                          <p>返回使用 <var>request</var> 和 <var>options</var> 作为参数（提供 <var>cache</var> 作为
                            <code>[[Call]]</code> 内部方法的 <code>thisArgument</code>），使用 <code
                              class="idl"><a data-link-type="idl" href="#dom-cache-match" id="ref-for-dom-cache-match④">match(request, options)</a></code>
                            方法运行指定算法的结果。
                          </p>
                      </ol>
                  </ol>
                <li data-md>
                  <p>返回 <var>promise</var>。</p>
              </ol>
          </ol>
        </section>
        <section class="algorithm" data-algorithm="cache-storage-has">
          <h4 class="heading settled" data-level="5.5.2" id="cache-storage-has"><span class="secno">5.5.2. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-cachestorage-has" id="ref-for-dom-cachestorage-has①">has(cacheName)</a></code></span><a
              class="self-link" href="#cache-storage-has"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/CacheStorage/has"
                  title="CacheStorage 接口的 has() 方法返回一个 Promise 对象，如果与 cacheName 匹配的 Cache 对象存在，则解析为 true。">CacheStorage/has</a>
              </p>
              <p class="all-engines-text">适用于所有当前引擎。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>41+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>16+</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Android 版 Firefox</span><span>41+</span></span><span
                  class="safari_ios yes"><span>iOS 版 Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Android 版 Chrome</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>三星互联网</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera 移动版</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="CacheStorage" data-dfn-type="method" data-export
              id="dom-cachestorage-has"><code>has(<var>cacheName</var>)</code></dfn> 方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>让 <var>promise</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                  id="ref-for-a-new-promise①⑥">一个新 promise</a>。</p>
            <li data-md>
              <p>在 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                  id="ref-for-in-parallel②③">并行</a> 中运行以下子步骤：</p>
              <ol>
                <li data-md>
                  <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate"
                      id="ref-for-map-iterate③">对于</a> <a data-link-type="dfn" href="#dfn-relevant-name-to-cache-map"
                      id="ref-for-dfn-relevant-name-to-cache-map②">相关名称到缓存映射</a> 中的每个 <var>key</var> → <var>value</var>：
                  </p>
                  <ol>
                    <li data-md>
                      <p>如果 <var>cacheName</var> 与 <var>key</var> 匹配，则使用 true 解析 <var>promise</var> 并终止这些步骤。</p>
                  </ol>
                <li data-md>
                  <p>使用 false 解析 <var>promise</var>。</p>
              </ol>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
          </ol>
        </section>
        <section class="algorithm" data-algorithm="cache-storage-open">
          <h4 class="heading settled" data-level="5.5.3" id="cache-storage-open"><span class="secno">5.5.3. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-cachestorage-open" id="ref-for-dom-cachestorage-open①">open(cacheName)</a></code></span><a
              class="self-link" href="#cache-storage-open"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/CacheStorage/open"
                  title="CacheStorage 接口的 open() 方法返回一个 Promise 对象，该对象解析为与 cacheName 匹配的 Cache 对象。">CacheStorage/open</a>
              </p>
              <p class="all-engines-text">适用于所有当前引擎。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>41+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>16+</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Android 版 Firefox</span><span>41+</span></span><span
                  class="safari_ios yes"><span>iOS 版 Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Android 版 Chrome</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>三星互联网</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera 移动版</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="CacheStorage" data-dfn-type="method" data-export
              id="dom-cachestorage-open"><code>open(<var>cacheName</var>)</code></dfn> 方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>让 <var>promise</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                  id="ref-for-a-new-promise①⑦">一个新 promise</a>。</p>
            <li data-md>
              <p>在 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                  id="ref-for-in-parallel②④">并行</a> 中运行以下子步骤：</p>
              <ol>
                <li data-md>
                  <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate"
                      id="ref-for-map-iterate④">对于</a> <var>key</var> → <var>value</var> 组成的 <a data-link-type="dfn"
                      href="#dfn-relevant-name-to-cache-map" id="ref-for-dfn-relevant-name-to-cache-map③">相关名称到缓存映射</a>：
                  </p>
                  <ol>
                    <li data-md>
                      <p>如果 <var>cacheName</var> 与 <var>key</var> 匹配，则：</p>
                      <ol>
                        <li data-md>
                          <p>使用表示 <var>value</var> 的新 <code
                              class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache①④">Cache</a></code>
                            对象解析 <var>promise</var>。</p>
                        <li data-md>
                          <p>终止这些步骤。</p>
                      </ol>
                  </ol>
                <li data-md>
                  <p>让 <var>cache</var> 为一个新的 <a data-link-type="dfn" href="#dfn-request-response-list"
                      id="ref-for-dfn-request-response-list④">请求响应列表</a>。</p>
                <li data-md>
                  <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set">设置</a>
                    <a data-link-type="dfn" href="#dfn-relevant-name-to-cache-map"
                      id="ref-for-dfn-relevant-name-to-cache-map④">相关名称到缓存映射</a>[<var>cacheName</var>] 为
                    <var>cache</var>。如果此缓存写入操作由于超出授予的配额限制而失败，使用 "<code
                      class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#quotaexceedederror" id="ref-for-quotaexceedederror">QuotaExceededError</a></code>"
                    <code
                      class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException①④">DOMException</a></code>
                    拒绝 <var>promise</var> 并终止这些步骤。
                  </p>
                <li data-md>
                  <p>使用表示 <var>cache</var> 的新 <code
                      class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache①⑤">Cache</a></code> 对象解析
                    <var>promise</var>。
                  </p>
              </ol>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
          </ol>
        </section>
        <section class="algorithm" data-algorithm="cache-storage-delete">
          <h4 class="heading settled" data-level="5.5.4" id="cache-storage-delete"><span class="secno">5.5.4.
            </span><span class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-cachestorage-delete" id="ref-for-dom-cachestorage-delete①">delete(cacheName)</a></code></span><a
              class="self-link" href="#cache-storage-delete"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/CacheStorage/delete"
                  title="CacheStorage 接口的 delete() 方法查找与 cacheName 匹配的 Cache 对象，如果找到，则删除该 Cache 对象并返回一个解析为 true 的 Promise 对象。如果未找到 Cache 对象，则解析为 false。">CacheStorage/delete</a>
              </p>
              <p class="all-engines-text">适用于所有当前引擎。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>41+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>16+</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Android 版 Firefox</span><span>41+</span></span><span
                  class="safari_ios yes"><span>iOS 版 Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Android 版 Chrome</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>三星互联网</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera 移动版</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="CacheStorage" data-dfn-type="method" data-export
              id="dom-cachestorage-delete"><code>delete(<var>cacheName</var>)</code></dfn> 方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>让 <var>promise</var> 为使用 <var>cacheName</var> 运行 <code
                  class="idl"><a data-link-type="idl" href="#dom-cachestorage-has" id="ref-for-dom-cachestorage-has②">has(cacheName)</a></code>
                方法时指定的算法的结果。</p>
            <li data-md>
              <p>返回 <a data-link-type="dfn"
                  href="https://webidl.spec.whatwg.org/#dfn-perform-steps-once-promise-is-settled"
                  id="ref-for-dfn-perform-steps-once-promise-is-settled③">反应</a> <var>promise</var> 与一个履行处理程序，该处理程序在使用参数
                <var>cacheExists</var> 调用时，执行以下子步骤：
              </p>
              <ol>
                <li data-md>
                  <p>如果 <var>cacheExists</var> 为 false，则：</p>
                  <ol>
                    <li data-md>
                      <p>返回 false。</p>
                  </ol>
                <li data-md>
                  <p>让 <var>cacheJobPromise</var> 为 <a data-link-type="dfn"
                      href="https://webidl.spec.whatwg.org/#a-new-promise" id="ref-for-a-new-promise①⑧">一个新 promise</a>。
                  </p>
                <li data-md>
                  <p>在 <a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                      id="ref-for-in-parallel②⑤">并行</a> 中运行以下子步骤：</p>
                  <ol>
                    <li data-md>
                      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-remove"
                          id="ref-for-map-remove">移除</a> <a data-link-type="dfn" href="#dfn-relevant-name-to-cache-map"
                          id="ref-for-dfn-relevant-name-to-cache-map⑤">相关名称到缓存映射</a>[<var>cacheName</var>]。</p>
                    <li data-md>
                      <p>使用 true 解析 <var>cacheJobPromise</var>。</p>
                  </ol>
                  <p class="note" role="note"><span>注意：</span> 在此步骤之后，现有的 DOM 对象（即当前引用的 Cache、Request 和 Response
                    对象）应继续保持功能。</p>
                <li data-md>
                  <p>返回 <var>cacheJobPromise</var>。</p>
              </ol>
          </ol>
        </section>
        <section class="algorithm" data-algorithm="cache-storage-keys">
          <h4 class="heading settled" data-level="5.5.5" id="cache-storage-keys"><span class="secno">5.5.5. </span><span
              class="content"><code
                class="idl"><a data-link-type="idl" href="#dom-cachestorage-keys" id="ref-for-dom-cachestorage-keys①">keys()</a></code></span><a
              class="self-link" href="#cache-storage-keys"></a></h4>
          <div class="mdn-anno wrapped after">
            <button class="mdn-anno-btn"><b class="all-engines-flag"
                title="此功能在所有当前引擎中可用。">✔</b><span>MDN</span></button>
            <div class="feature">
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/CacheStorage/keys"
                  title="CacheStorage 接口的 keys() 方法返回一个 Promise，该 Promise 将解析为一个数组，其中包含按创建顺序排列的由 CacheStorage 对象跟踪的所有命名 Cache 对象对应的字符串。使用此方法可以遍历所有 Cache 对象的列表。">CacheStorage/keys</a>
              </p>
              <p class="all-engines-text">适用于所有当前引擎。</p>
              <div class="support">
                <span class="firefox yes"><span>Firefox</span><span>41+</span></span><span
                  class="safari yes"><span>Safari</span><span>11.1+</span></span><span
                  class="chrome yes"><span>Chrome</span><span>40+</span></span>
                <hr>
                <span class="opera yes"><span>Opera</span><span>27+</span></span><span
                  class="edge_blink yes"><span>Edge</span><span>79+</span></span>
                <hr>
                <span class="edge yes"><span>Edge (旧版)</span><span>16+</span></span><span
                  class="ie no"><span>IE</span><span>无</span></span>
                <hr>
                <span class="firefox_android yes"><span>Android 版 Firefox</span><span>41+</span></span><span
                  class="safari_ios yes"><span>iOS 版 Safari</span><span>11.3+</span></span><span
                  class="chrome_android yes"><span>Android 版 Chrome</span><span>40+</span></span><span
                  class="webview_android yes"><span>Android WebView</span><span>40+</span></span><span
                  class="samsunginternet_android yes"><span>三星互联网</span><span>4.0+</span></span><span
                  class="opera_android yes"><span>Opera 移动版</span><span>27+</span></span>
              </div>
            </div>
          </div>
          <p><dfn class="dfn-paneled idl-code" data-dfn-for="CacheStorage" data-dfn-type="method" data-export
              id="dom-cachestorage-keys"><code>keys()</code></dfn> 方法的步骤如下：</p>
          <ol>
            <li data-md>
              <p>让 <var>promise</var> 为 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                  id="ref-for-a-new-promise①⑨">一个新 promise</a>。</p>
            <li data-md>
              <p>在 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                  id="ref-for-in-parallel②⑥">并行</a> 中运行以下子步骤：</p>
              <ol>
                <li data-md>
                  <p>让 <var>cacheKeys</var> 为 <a data-link-type="dfn"
                      href="https://infra.spec.whatwg.org/#map-getting-the-keys"
                      id="ref-for-map-getting-the-keys②">获取</a> <a data-link-type="dfn"
                      href="#dfn-relevant-name-to-cache-map" id="ref-for-dfn-relevant-name-to-cache-map⑥">相关名称到缓存映射</a>
                    的键的结果。</p>
                  <p class="note" role="note"><span>注意：</span> 结果<a data-link-type="dfn"
                      href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set⑥">有序集合</a>中的 <a
                      data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-item"
                      id="ref-for-list-item⑥">项目</a>按其对应条目添加到 <a data-link-type="dfn" href="#dfn-name-to-cache-map"
                      id="ref-for-dfn-name-to-cache-map④">名称到缓存映射</a> 的顺序排列。</p>
                <li data-md>
                  <p>使用 <var>cacheKeys</var> 解析 <var>promise</var>。</p>
              </ol>
            <li data-md>
              <p>返回 <var>promise</var>。</p>
          </ol>
        </section>
      </section>
    </section>
    <section>
      <h2 class="heading settled" data-level="6" id="security-considerations"><span class="secno">6. </span><span
          class="content">安全性考虑</span><a class="self-link" href="#security-considerations"></a></h2>
      <section>
        <h3 class="heading settled" data-level="6.1" id="secure-context"><span class="secno">6.1. </span><span
            class="content">安全上下文</span><a class="self-link" href="#secure-context"></a></h3>
        <p><a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑦⑦">Service workers</a>
          <em>必须</em>在<a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context"
            id="ref-for-secure-context②">安全上下文</a>中执行。<a data-link-type="dfn" href="#dfn-service-worker-client"
            id="ref-for-dfn-service-worker-client③③">Service worker 客户端</a> <em>必须</em>也是<a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context"
            id="ref-for-secure-context③">安全上下文</a>，以注册<a data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration④④">service worker 注册</a>，访问<a data-link-type="dfn"
            href="#dfn-service-worker-registration" id="ref-for-dfn-service-worker-registration④⑤">service worker
            注册</a>和<a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑦⑧">service
            workers</a>，与<a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑦⑨">service
            workers</a>进行消息传递，并由<a data-link-type="dfn" href="#dfn-service-worker"
            id="ref-for-dfn-service-worker⑧⓪">service workers</a>操控。
        </p>
        <p class="note" role="note"><span>注意：</span>这实际上意味着<a data-link-type="dfn" href="#dfn-service-worker"
            id="ref-for-dfn-service-worker⑧①">service workers</a>及其<a data-link-type="dfn"
            href="#dfn-service-worker-client" id="ref-for-dfn-service-worker-client③④">service worker 客户端</a>需要通过 HTTPS
          托管。用户代理可以允许 <code>localhost</code>（参见<a
            href="https://w3c.github.io/webappsec-secure-contexts/#localhost">要求</a>）、<code>127.0.0.0/8</code> 和
          <code>::1/128</code>用于开发目的。这一限制的主要原因是保护用户免受<a
            href="https://w3c.github.io/webappsec-secure-contexts/#threat-risks">不安全上下文的风险</a>。
        </p>
      </section>
      <section>
        <h3 class="heading settled" data-level="6.2" id="content-security-policy"><span class="secno">6.2. </span><span
            class="content">内容安全策略</span><a class="self-link" href="#content-security-policy"></a></h3>
        <p>每当用户代理调用<a data-link-type="dfn" href="#run-service-worker" id="ref-for-run-service-worker①">运行 Service
            Worker</a>算法时，如果包含 <var>serviceWorker</var> 的<a data-link-type="dfn" href="#dfn-service-worker"
            id="ref-for-dfn-service-worker⑧②">service worker</a>的<a data-link-type="dfn" href="#dfn-script-resource"
            id="ref-for-dfn-script-resource②">脚本资源</a>是通过包含值<var>policy</var>的 <code>Content-Security-Policy</code> HTTP
          头传递的，那么用户代理<em>必须</em><a data-link-type="dfn" href="https://www.w3.org/TR/CSP3/#enforced"
            id="ref-for-enforced">强制执行</a><var>policy</var>对于<var>serviceWorker</var>。如果<var>serviceWorker</var>的<a
            data-link-type="dfn" href="#dfn-script-resource"
            id="ref-for-dfn-script-resource③">脚本资源</a>是通过包含值<var>policy</var>的
          <code>Content-Security-Policy-Report-Only</code> HTTP 头传递的，那么用户代理<em>必须</em><a data-link-type="dfn"
            href="https://www.w3.org/TR/CSP3/#monitored"
            id="ref-for-monitored">监控</a><var>policy</var>对于<var>serviceWorker</var>。
        </p>
        <p>这一限制的主要原因是为了减轻广泛的内容注入漏洞（如跨站脚本攻击（XSS））的风险。</p>
      </section>
      <section>
        <h3 class="heading settled" data-level="6.3" id="origin-relativity"><span class="secno">6.3. </span><span
            class="content">来源相关性</span><a class="self-link" href="#origin-relativity"></a></h3>
        <section>
          <h4 class="heading settled" data-level="6.3.1" id="origin-restriction"><span class="secno">6.3.1. </span><span
              class="content">来源限制</span><a class="self-link" href="#origin-restriction"></a></h4>
          <p><em>本节为非规范性内容。</em></p>
          <p>一个<a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑧③">service
              worker</a>在注册<a data-link-type="dfn" href="#dfn-service-worker-client"
              id="ref-for-dfn-service-worker-client③⑤">service worker 客户端</a>的<a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
              id="ref-for-concept-settings-object-origin①⓪">来源</a>中执行。主要应用程序可能会遇到的一个高级问题是，它们是否可以从 CDN
            托管。根据定义，这些服务器位于其他地方，通常在其他<a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin"
              id="ref-for-concept-origin⑨">来源</a>。因此，<a data-link-type="dfn" href="#dfn-service-worker"
              id="ref-for-dfn-service-worker⑧④">service workers</a>不能托管在 CDN 上。但它们可以通过 <a data-link-type="functionish"
              href="#importscripts-method" id="ref-for-importscripts-method">importScripts()</a>引入资源。这个限制的原因是<a
              data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑧⑤">service
              workers</a>提供了坏人将糟糕的一天变成糟糕的永恒的机会。</p>
        </section>
        <section>
          <h4 class="heading settled" data-level="6.3.2" id="importscripts"><span class="secno">6.3.2. </span><span
              class="content"><code class="idl"><a data-link-type="idl">importScripts(urls)</a></code></span><a
              class="self-link" href="#importscripts"></a></h4>
          <p>当在 <code
              class="idl"><a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope①③">ServiceWorkerGlobalScope</a></code>
            对象上调用 <dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="method"
              data-export id="importscripts-method"><code>importScripts(<var>urls</var>)</code></dfn>
            方法时，用户代理<em>必须</em><a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/workers.html#import-scripts-into-worker-global-scope"
              id="ref-for-import-scripts-into-worker-global-scope">导入脚本到 worker 全局范围</a>，给定这个 <code
              class="idl"><a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope①④">ServiceWorkerGlobalScope</a></code>
            对象和<var>urls</var>，并通过以下步骤<a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#fetching-scripts-perform-fetch"
              id="ref-for-fetching-scripts-perform-fetch">执行抓取</a>给定 <var>request</var>：</p>
          <ol>
            <li data-md>
              <p>让 <var>serviceWorker</var> 为 <var>request</var> 的<a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-request-client"
                  id="ref-for-concept-request-client①">客户端</a>的<a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                  id="ref-for-concept-settings-object-global⑧">全局对象</a>的<a data-link-type="dfn"
                  href="#serviceworkerglobalscope-service-worker"
                  id="ref-for-serviceworkerglobalscope-service-worker②③">service worker</a>。</p>
            <li data-md>
              <p>让 <var>map</var> 为 <var>serviceWorker</var> 的<a data-link-type="dfn" href="#dfn-script-resource-map"
                  id="ref-for-dfn-script-resource-map">脚本资源映射</a>。</p>
            <li data-md>
              <p>让 <var>url</var> 为 <var>request</var> 的<a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url④">url</a>。
              </p>
            <li data-md>
              <p>如果 <var>serviceWorker</var> 的<a data-link-type="dfn">状态</a>不是 "<code>parsed</code>" 或
                "<code>installing</code>"：</p>
              <ol>
                <li data-md>
                  <p>返回 <var>map</var>[<var>url</var>]，如果它<a data-link-type="dfn"
                      href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists④">存在</a>，否则返回<a
                      data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error"
                      id="ref-for-concept-network-error②">网络错误</a>。</p>
              </ol>
            <li data-md>
              <p>如果 <var>map</var>[<var>url</var>] <a data-link-type="dfn"
                  href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑤">存在</a>：</p>
              <ol>
                <li data-md>
                  <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append"
                      id="ref-for-set-append">将</a><var>url</var>附加到 <var>serviceWorker</var> 的<a data-link-type="dfn"
                      href="#dfn-set-of-used-scripts" id="ref-for-dfn-set-of-used-scripts①">已使用脚本集</a>。</p>
                <li data-md>
                  <p>返回 <var>map</var>[<var>url</var>]。</p>
              </ol>
            <li data-md>
              <p>让 <var>registration</var> 为 <var>serviceWorker</var> 的<a data-link-type="dfn"
                  href="#dfn-containing-service-worker-registration"
                  id="ref-for-dfn-containing-service-worker-registration①⑤">包含的 service worker 注册</a>。</p>
            <li data-md>
              <p>将 <var>request</var> 的<a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#request-service-workers-mode"
                  id="ref-for-request-service-workers-mode①">service-workers 模式</a>设置为 "<code>none</code>"。</p>
            <li data-md>
              <p>如果以下任一项为真，将 <var>request</var> 的<a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-request-cache-mode"
                  id="ref-for-concept-request-cache-mode">缓存模式</a>设置为 "<code>no-cache</code>"：</p>
              <ul>
                <li data-md>
                  <p><var>registration</var> 的<a data-link-type="dfn" href="#dfn-update-via-cache"
                      id="ref-for-dfn-update-via-cache①">通过缓存更新模式</a>为 "<code>none</code>"。</p>
                <li data-md>
                  <p>当前全局对象的<a data-link-type="dfn"
                      href="#serviceworkerglobalscope-force-bypass-cache-for-import-scripts-flag"
                      id="ref-for-serviceworkerglobalscope-force-bypass-cache-for-import-scripts-flag">强制绕过缓存导入脚本标志</a>已设置。
                  </p>
                <li data-md>
                  <p><var>registration</var> 已过时。</p>
              </ul>
            <li data-md>
              <p>让 <var>response</var> 为<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
                  id="ref-for-concept-fetch⑨">抓取</a> <var>request</var> 的结果。</p>
            <li data-md>
              <p>如果 <var>response</var> 的<a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-response-cache-state"
                  id="ref-for-concept-response-cache-state">缓存状态</a>不是 "<code>local</code>"，将 <var>registration</var>
                的<a data-link-type="dfn" href="#dfn-last-update-check-time"
                  id="ref-for-dfn-last-update-check-time②">最后更新检查时间</a>设置为当前时间。</p>
            <li data-md>
              <p>如果 <var>response</var> 的<a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#unsafe-response"
                  id="ref-for-unsafe-response">不安全响应</a>是<a data-link-type="dfn" href="#dfn-bad-import-script-response"
                  id="ref-for-dfn-bad-import-script-response">错误导入脚本响应</a>，则返回<a data-link-type="dfn"
                  href="https://fetch.spec.whatwg.org/#concept-network-error"
                  id="ref-for-concept-network-error③">网络错误</a>。</p>
            <li data-md>
              <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set①">设置</a>
                <var>map</var>[<var>url</var>] 为 <var>response</var>。
              </p>
            <li data-md>
              <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append"
                  id="ref-for-set-append①">将</a><var>url</var>附加到 <var>serviceWorker</var> 的<a data-link-type="dfn"
                  href="#dfn-set-of-used-scripts" id="ref-for-dfn-set-of-used-scripts②">已使用脚本集</a>。</p>
            <li data-md>
              <p>设置 <var>serviceWorker</var> 的<a data-link-type="dfn" href="#dfn-classic-scripts-imported-flag"
                  id="ref-for-dfn-classic-scripts-imported-flag">经典脚本导入标志</a>。</p>
            <li data-md>
              <p>返回 <var>response</var>。</p>
          </ol>
        </section>
      </section>
      <section>
        <h3 class="heading settled" data-level="6.4" id="cross-origin-resources"><span class="secno">6.4. </span><span
            class="content">跨域资源和 CORS</span><a class="self-link" href="#cross-origin-resources"></a></h3>
        <p><em>本节为非规范性内容。</em></p>
        <p>应用程序通常会缓存来自 CDN 或其他<a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
            id="ref-for-concept-settings-object-origin①①">来源</a>的项目。可以使用
          <code>&lt;script></code>、<code>&lt;img></code>、<code>&lt;video></code> 和 <code>&lt;link></code>
          元素直接请求其中许多项目。如果这种运行时协作在离线时中断，那将是极大的限制。同样，如果设置了适当的 CORS 头，可以<a data-link-type="dfn"
            href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch①⓪">抓取</a>许多类型的离线<a
            data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
            id="ref-for-concept-settings-object-origin①②">跨来源</a>资源。<a data-link-type="dfn" href="#dfn-service-worker"
            id="ref-for-dfn-service-worker⑧⑥">Service workers</a>通过允许 <code
            class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache①⑥">缓存</a></code><a data-link-type="dfn"
            href="https://fetch.spec.whatwg.org/#concept-fetch"
            id="ref-for-concept-fetch①①">抓取</a>和缓存跨来源项目来实现这一点。然而，有一些限制。首先，与在 <code
            class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache①⑦">缓存</a></code>中管理为<a
            data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-filtered-response-basic"
            id="ref-for-concept-filtered-response-basic">基本过滤响应</a>的<a data-link-type="dfn"
            href="https://fetch.spec.whatwg.org/#concept-response-response"
            id="ref-for-concept-response-response②">响应</a>对应的<code
            class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response①①">Response</a></code>对象不同，存储的对象是其对应的<a
            data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-response"
            id="ref-for-concept-response-response③">响应</a>为<a data-link-type="dfn"
            href="https://fetch.spec.whatwg.org/#concept-filtered-response-cors"
            id="ref-for-concept-filtered-response-cors">CORS 过滤响应</a>或<a data-link-type="dfn"
            href="https://fetch.spec.whatwg.org/#concept-filtered-response-opaque"
            id="ref-for-concept-filtered-response-opaque">不透明过滤响应</a>的<code
            class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response①②">Response</a></code>对象。它们可以像其对应的<a
            data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-filtered-response-basic"
            id="ref-for-concept-filtered-response-basic①">基本过滤响应</a>的<code
            class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response①③">Response</a></code>对象一样传递给<code
            class="idl"><a data-link-type="idl" href="#dom-fetchevent-respondwith" id="ref-for-dom-fetchevent-respondwith③">event.respondWith(r)</a></code>方法，但不能以有意义的方式进行编程创建。这些限制对于保持平台的安全性是不必要的。允许
          <code
            class="idl"><a data-link-type="idl" href="#cache" id="ref-for-cache①⑧">缓存</a></code>存储它们可以让应用程序在大多数情况下避免重新架构。
        </p>
      </section>
      <section>
        <h3 class="heading settled" data-level="6.5" id="path-restriction"><span class="secno">6.5. </span><span
            class="content">路径限制</span><a class="self-link" href="#path-restriction"></a></h3>
        <p><em>本节为非规范性内容。</em></p>
        <p>除了<a href="#origin-restriction">来源限制</a>之外，service workers 还受制于 service worker 脚本的<a data-link-type="dfn"
            href="https://url.spec.whatwg.org/#concept-url-path" id="ref-for-concept-url-path">路径</a>。例如，位于
          <code>https://www.example.com/~bob/sw.js</code> 的 service worker 脚本可以为 <a data-link-type="dfn"
            href="#dfn-scope-url" id="ref-for-dfn-scope-url①⓪">范围 URL</a> <code>https://www.example.com/~bob/</code>
          注册，但不能为 <code>https://www.example.com/</code> 或 <code>https://www.example.com/~alice/</code>
          注册。这为托管多个用户内容的站点提供了一些保护，将这些内容隔离在同一来源的不同目录中。然而，路径限制不被视为硬性安全边界，只有来源才是。站点被鼓励在适当的情况下使用不同的来源来安全地隔离站点的各个部分。
        </p>
        <p>服务器可以通过在 service worker 脚本上设置 <a data-link-type="dfn" href="#service-worker-allowed"
            id="ref-for-service-worker-allowed">Service-Worker-Allowed</a> 头来移除路径限制。</p>
      </section>
      <section>
        <h3 class="heading settled" data-level="6.6" id="script-request"><span class="secno">6.6. </span><span
            class="content">Service worker 脚本请求</span><a class="self-link" href="#script-request"></a></h3>
        <p><em>本节为非规范性内容。</em></p>
        <p>为了进一步防范恶意注册 service worker 到站点，本规范要求：</p>
        <ul>
          <li data-md>
            <p><a data-link-type="dfn" href="#service-worker" id="ref-for-service-worker">Service-Worker</a> 头出现在
              service worker 脚本请求中，并且</p>
          <li data-md>
            <p>Service worker 脚本以<a data-link-type="dfn" href="https://mimesniff.spec.whatwg.org/#javascript-mime-type"
                id="ref-for-javascript-mime-type">JavaScript MIME 类型</a>提供。</p>
        </ul>
      </section>
      <section>
        <h3 class="heading settled" data-level="6.7" id="implementer-concerns"><span class="secno">6.7. </span><span
            class="content">实现者的关注点</span><a class="self-link" href="#implementer-concerns"></a></h3>
        <p><em>本节为非规范性内容。</em></p>
        <p>鼓励实现者注意：</p>
        <ul>
          <li data-md>
            <p>插件不应通过<a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑧⑦">service
                workers</a>加载。由于插件可能从其自己的 URL 获取其安全来源，嵌入的<a data-link-type="dfn" href="#dfn-service-worker"
                id="ref-for-dfn-service-worker⑧⑧">service worker</a>无法处理它。因此，<a data-link-type="dfn"
                href="#handle-fetch" id="ref-for-handle-fetch⑥">处理抓取</a>算法使 <code>&lt;embed></code> 和
              <code>&lt;object></code> 请求立即回退到网络，而不分派 <code
                class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-fetch-event" id="ref-for-service-worker-global-scope-fetch-event⑤">fetch</a></code>
              事件。
            </p>
          <li data-md>
            <p>可能需要仔细审核一些遗留的网络堆栈代码，以了解与<a data-link-type="dfn" href="#dfn-service-worker"
                id="ref-for-dfn-service-worker⑧⑨">service workers</a>交互的影响。</p>
        </ul>
      </section>
      <section>
        <h3 class="heading settled" data-level="6.8" id="privacy"><span class="secno">6.8. </span><span
            class="content">隐私</span><a class="self-link" href="#privacy"></a></h3>
        <p><a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑨⓪">Service workers</a>
          引入了新的持久存储功能，包括<a data-link-type="dfn" href="#dfn-scope-to-registration-map"
            id="ref-for-dfn-scope-to-registration-map③">注册映射</a>（用于<a data-link-type="dfn"
            href="#dfn-service-worker-registration" id="ref-for-dfn-service-worker-registration④⑥">service worker
            注册</a>及其<a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑨①">service
            workers</a>）、<a data-link-type="dfn" href="#dfn-request-response-list"
            id="ref-for-dfn-request-response-list⑤">请求响应列表</a>和<a data-link-type="dfn" href="#dfn-name-to-cache-map"
            id="ref-for-dfn-name-to-cache-map⑤">名称到缓存映射</a>（用于缓存），以及<a data-link-type="dfn"
            href="#dfn-script-resource-map" id="ref-for-dfn-script-resource-map①">脚本资源映射</a>（用于脚本资源）。为了保护用户免受任何潜在的<a
            data-link-type="biblio"
            href="#biblio-unsanctioned-tracking">未经授权的跟踪</a>威胁，这些持久存储<em>应当</em>在用户打算清除它们时清除，并<em>应当</em>维护和与现有的用户控制相互作用，例如清除所有现有的持久存储。
        </p>
      </section>
    </section>

    <section>
      <h2 class="heading settled" data-level="7" id="extensibility"><span class="secno">7. </span><span
          class="content">扩展性</span><a class="self-link" href="#extensibility"></a></h2>
      <p>Service Workers 规范可以被其他规范扩展。</p>
      <section>
        <h3 class="heading settled" data-level="7.1" id="extension-to-service-worker-registration"><span
            class="secno">7.1. </span><span class="content">定义绑定到 Service Worker Registration 的 API</span><a
            class="self-link" href="#extension-to-service-worker-registration"></a></h3>
        <p>规范<em>可以</em>通过使用<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-partial-interface"
            id="ref-for-dfn-partial-interface">partial interface</a>定义，将 API 绑定到<code
            class="idl"><a data-link-type="idl" href="#serviceworkerregistration" id="ref-for-serviceworkerregistration①③">ServiceWorkerRegistration</a></code>接口，并<em>可以</em>定义规范特定的属性和方法：
        </p>
        <pre class="example idl highlight def" data-no-idl id="example-e75a31ac"><a class="self-link" href="#example-e75a31ac"></a><c- b>partial</c-> <c- b>interface</c-> <c- g>ServiceWorkerRegistration</c-> {
  // 例如定义一个 API 命名空间
  <c- b>readonly</c-> <c- b>attribute</c-> <c- n>APISpaceType</c-> <c- g>APISpace</c->;
  // 例如定义一个方法
  <c- b>Promise</c->&lt;<c- n>T</c->> <c- g>methodName</c->(/* 参数列表 */);
};
</pre>
      </section>
      <section>
        <h3 class="heading settled" data-level="7.2" id="extension-to-extendable-event"><span class="secno">7.2.
          </span><span class="content">定义功能事件</span><a class="self-link" href="#extension-to-extendable-event"></a></h3>
        <p>规范<em>可以</em>通过扩展<code
            class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent①⑤">ExtendableEvent</a></code>接口来定义<a
            data-link-type="dfn" href="#dfn-functional-events" id="ref-for-dfn-functional-events①⓪">功能事件</a>：</p>
        <pre class="example idl highlight def" data-no-idl id="example-85e5c3c4"><a class="self-link" href="#example-85e5c3c4"></a>// 例如定义 FunctionalEvent 接口
<c- b>interface</c-> <c- g>FunctionalEvent</c-> : <c- n>ExtendableEvent</c-> {
  // 添加功能事件的自有属性和方法
};
</pre>
      </section>
      <section>
        <h3 class="heading settled" data-level="7.3" id="extension-to-service-worker-global-scope"><span
            class="secno">7.3. </span><span class="content">定义事件处理程序</span><a class="self-link"
            href="#extension-to-service-worker-global-scope"></a></h3>
        <p>规范<em>可以</em>通过使用<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-partial-interface"
            id="ref-for-dfn-partial-interface①">partial interface</a>定义，为<code
            class="idl"><a data-link-type="idl" href="#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope①⑤">ServiceWorkerGlobalScope</a></code>接口定义与相应<a
            data-link-type="dfn" href="#dfn-functional-events" id="ref-for-dfn-functional-events①①">功能事件</a>相关的事件处理程序属性：
        </p>
        <pre class="example idl highlight def" data-no-idl id="example-80342678"><a class="self-link" href="#example-80342678"></a><c- b>partial</c-> <c- b>interface</c-> <c- g>ServiceWorkerGlobalScope</c-> {
  <c- b>attribute</c-> <c- n>EventHandler</c-> <c- g>onfunctionalevent</c->;
};
</pre>
      </section>
      <section>
        <h3 class="heading settled" data-level="7.4" id="firing-functional-events"><span class="secno">7.4. </span><span
            class="content">触发功能事件</span><a class="self-link" href="#firing-functional-events"></a>
        </h3>
        <p>为了请求将<a data-link-type="dfn" href="#dfn-functional-events" id="ref-for-dfn-functional-events①②">功能事件</a>分派给<a
            data-link-type="dfn" href="#dfn-service-worker-registration"
            id="ref-for-dfn-service-worker-registration④⑧">Service Worker 注册</a>的<a data-link-type="dfn"
            href="#dfn-active-worker" id="ref-for-dfn-active-worker①⑨">激活的 worker</a>，规范<em>应当</em>调用<a
            data-link-type="dfn" href="#fire-functional-event" id="ref-for-fire-functional-event">触发功能事件</a>。</p>
      </section>
    </section>
    <section>
      <h2 class="heading settled" id="algorithms"><span class="content">附录 A：算法</span><a class="self-link"
          href="#algorithms"></a></h2>
      <p>以下定义是整个规范中用户代理使用的内部数据结构。</p>
      <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="dfn-scope-to-registration-map">注册映射</dfn>是一个<a
          data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map"
          id="ref-for-ordered-map④">有序映射</a>，其中键是(<a data-link-type="dfn"
          href="https://storage.spec.whatwg.org/#storage-key" id="ref-for-storage-key④">存储键</a>，<a data-link-type="dfn"
          href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer⑤">序列化</a>的<a
          data-link-type="dfn" href="#dfn-scope-url" id="ref-for-dfn-scope-url①①">作用域 URL</a>)，值是<a data-link-type="dfn"
          href="#dfn-service-worker-registration" id="ref-for-dfn-service-worker-registration④⑨">服务工作者注册</a>。</p>
      <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
          id="dfn-job">作业</dfn>是一个抽象概念，用于表示服务工作者注册的注册、更新和注销请求之一。</p>
      <div>
        <a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job">作业</a>具有<dfn class="dfn-paneled" data-dfn-for="job"
          data-dfn-type="dfn" data-noexport id="dfn-job-type">作业类型</dfn>，它可以是<em>注册</em>、<em>更新</em>或<em>注销</em>之一。
        <p><a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job①">作业</a>具有一个<dfn class="dfn-paneled"
            data-dfn-for="job" data-dfn-type="dfn" data-noexport id="job-storage-key">存储键</dfn>（一个<a
            data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-key" id="ref-for-storage-key⑤">存储键</a>）。
        </p>
        <p><a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job②">作业</a>具有一个<dfn class="dfn-paneled"
            data-dfn-for="job" data-dfn-type="dfn" data-noexport id="dfn-job-scope-url">作用域 URL</dfn>（一个<a
            data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url④">URL</a>）。</p>
        <p><a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job③">作业</a>具有一个<dfn class="dfn-paneled"
            data-dfn-for="job" data-dfn-type="dfn" data-noexport id="dfn-job-script-url">脚本 URL</dfn>（一个<a
            data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑤">URL</a>）。</p>
        <p><a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job④">作业</a>具有一个<dfn class="dfn-paneled"
            data-dfn-for="job" data-dfn-type="dfn" data-noexport id="dfn-job-worker-type">worker 类型</dfn>
          ("<code>classic</code>" 或 "<code>module</code>")。</p>
        <p><a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job⑤">作业</a>具有一个<dfn class="dfn-paneled"
            data-dfn-for="job" data-dfn-type="dfn" data-noexport
            id="dfn-job-update-via-cache-mode">通过缓存更新模式</dfn>，它可以是"<code>imports</code>"、"<code>all</code>"或"<code>none</code>"。
        </p>
        <p><a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job⑥">作业</a>具有一个<dfn class="dfn-paneled"
            data-dfn-for="job" data-dfn-type="dfn" data-noexport id="dfn-job-client">客户端</dfn>（一个<a data-link-type="dfn"
            href="#dfn-service-worker-client" id="ref-for-dfn-service-worker-client③⑥">服务工作者客户端</a>）。它最初为 null。</p>
        <p><a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job⑦">作业</a>具有一个<dfn class="dfn-paneled"
            data-dfn-for="job" data-dfn-type="dfn" data-noexport id="job-referrer">引荐来源</dfn>（一个<a data-link-type="dfn"
            href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑥">URL</a>或
          null）。</p>
        <p><a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job⑧">作业</a>具有一个<dfn class="dfn-paneled"
            data-dfn-for="job" data-dfn-type="dfn" data-noexport id="dfn-job-promise">作业承诺</dfn>（一个<a
            data-link-type="dfn" href="http://tc39.github.io/ecma262/#sec-promise-objects"
            id="ref-for-sec-promise-objects②⑥">承诺</a>）。它最初为 null。</p>
        <p><a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job⑨">作业</a>具有一个<dfn class="dfn-paneled"
            data-dfn-for="job" data-dfn-type="dfn" data-noexport id="dfn-containing-job-queue">包含作业队列</dfn>（一个<a
            data-link-type="dfn" href="#dfn-job-queue" id="ref-for-dfn-job-queue">作业队列</a>或
          null）。它最初为 null。</p>
        <p><a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job①⓪">作业</a>具有一个<dfn class="dfn-paneled"
            data-dfn-for="job" data-dfn-type="dfn" data-noexport id="dfn-job-list-of-equivalent-jobs">等效作业列表</dfn>（一个<a
            data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job①①">作业</a>列表）。它最初为空列表。</p>
        <p><a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job①②">作业</a>具有一个<dfn class="dfn-paneled"
            data-dfn-for="job" data-dfn-type="dfn" data-noexport
            id="dfn-job-force-bypass-cache-flag">强制绕过缓存标志</dfn>。它最初未设置。</p>
      </div>
      <p>当两个<a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job①③">作业</a>的<a data-link-type="dfn"
          href="#dfn-job-type" id="ref-for-dfn-job-type">作业类型</a>相同时，它们是<dfn class="dfn-paneled" data-dfn-type="dfn"
          data-noexport id="dfn-job-equivalent">等效</dfn>的，并且：</p>
      <ul>
        <li data-md>
          <p>对于<em>注册</em>和<em>更新</em>作业，它们的<a data-link-type="dfn" href="#dfn-job-scope-url"
              id="ref-for-dfn-job-scope-url">作用域 URL</a>、<a data-link-type="dfn" href="#dfn-job-script-url"
              id="ref-for-dfn-job-script-url">脚本 URL</a>、<a data-link-type="dfn" href="#dfn-job-worker-type"
              id="ref-for-dfn-job-worker-type①">worker 类型</a>和<a data-link-type="dfn"
              href="#dfn-job-update-via-cache-mode" id="ref-for-dfn-job-update-via-cache-mode">通过缓存更新模式</a>相同。</p>
        <li data-md>
          <p>对于<em>注销</em>作业，它们的<a data-link-type="dfn" href="#dfn-job-scope-url" id="ref-for-dfn-job-scope-url①">作用域
              URL</a>相同。</p>
      </ul>
      <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="dfn-job-queue">作业队列</dfn>是一个线程安全的<a
          data-link-type="dfn" href="https://infra.spec.whatwg.org/#queue" id="ref-for-queue">队列</a>，用于同步并发<a
          data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job①⑥">作业</a>的集合。<a data-link-type="dfn"
          href="#dfn-job-queue" id="ref-for-dfn-job-queue①">作业队列</a>包含<a data-link-type="dfn" href="#dfn-job"
          id="ref-for-dfn-job①⑦">作业</a>作为其<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-item"
          id="ref-for-list-item⑦">项</a>。<a data-link-type="dfn" href="#dfn-job-queue"
          id="ref-for-dfn-job-queue②">作业队列</a>最初为空。</p>
      <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
          id="dfn-scope-to-job-queue-map">作用域到作业队列映射</dfn>是一个<a data-link-type="dfn"
          href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map⑤">有序映射</a>，其中键是<a
          data-link-type="dfn" href="#dfn-scope-url" id="ref-for-dfn-scope-url①②">作用域 URL</a>、<a data-link-type="dfn"
          href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer⑥">序列化</a>，值是<a
          data-link-type="dfn" href="#dfn-job-queue" id="ref-for-dfn-job-queue③">作业队列</a>。</p>
      <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
          id="dfn-bad-import-script-response">错误的导入脚本响应</dfn>是一个满足以下任何条件的<a data-link-type="dfn"
          href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑥">响应</a>：</p>
      <ul>
        <li data-md>
          <p><var>响应</var>的<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-type"
              id="ref-for-concept-response-type②">类型</a>为"<code>error</code>"</p>
        <li data-md>
          <p><var>响应</var>的<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-status"
              id="ref-for-concept-response-status②">状态</a>不是<a data-link-type="dfn"
              href="https://fetch.spec.whatwg.org/#ok-status" id="ref-for-ok-status①">成功状态</a></p>
        <li data-md>
          <p>从<var>响应</var>的<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list"
              id="ref-for-concept-response-header-list②">头列表</a>中<a data-link-type="dfn"
              href="https://fetch.spec.whatwg.org/#concept-header-extract-mime-type"
              id="ref-for-concept-header-extract-mime-type">提取 MIME 类型</a>的结果不是<a data-link-type="dfn"
              href="https://mimesniff.spec.whatwg.org/#javascript-mime-type"
              id="ref-for-javascript-mime-type①">JavaScript MIME 类型</a></p>
          <p class="note" role="note"><span>注意：</span>保持此定义与<a data-link-type="dfn"
              href="https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-classic-worker-imported-script"
              id="ref-for-fetch-a-classic-worker-imported-script">获取经典 worker 导入的脚本</a>同步。</p>
      </ul>

      <section class="algorithm" data-algorithm="Create Job">
        <h3 class="heading settled" id="create-job-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="create-job">创建作业</dfn></span><a class="self-link"
            href="#create-job-algorithm"></a></h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>jobType</var>，一个<a data-link-type="dfn" href="#dfn-job-type" id="ref-for-dfn-job-type①">作业类型</a></p>
          <dd data-md>
            <p><var>storage key</var>，一个<a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-key"
                id="ref-for-storage-key⑥">存储键</a></p>
          <dd data-md>
            <p><var>scopeURL</var>，一个<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url"
                id="ref-for-concept-url⑦">URL</a></p>
          <dd data-md>
            <p><var>scriptURL</var>，一个<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url"
                id="ref-for-concept-url⑧">URL</a></p>
          <dd data-md>
            <p><var>promise</var>，一个<a data-link-type="dfn" href="http://tc39.github.io/ecma262/#sec-promise-objects"
                id="ref-for-sec-promise-objects②⑦">promise</a></p>
          <dd data-md>
            <p><var>client</var>，一个<a data-link-type="dfn" href="#dfn-service-worker-client"
                id="ref-for-dfn-service-worker-client③⑦">服务工作者客户端</a></p>
          <dt data-md>输出
          <dd data-md>
            <p><var>job</var>，一个<a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job①⑧">作业</a></p>
        </dl>
        <ol>
          <li data-md>
            <p>让<var>job</var>成为一个新的<a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job①⑨">作业</a>。</p>
          <li data-md>
            <p>将<var>job</var>的<a data-link-type="dfn" href="#dfn-job-type"
                id="ref-for-dfn-job-type②">作业类型</a>设置为<var>jobType</var>。</p>
          <li data-md>
            <p>将<var>job</var>的<a data-link-type="dfn" href="#job-storage-key"
                id="ref-for-job-storage-key">存储键</a>设置为<var>storage key</var>。</p>
          <li data-md>
            <p>将<var>job</var>的<a data-link-type="dfn" href="#dfn-job-scope-url" id="ref-for-dfn-job-scope-url②">作用域
                URL</a>设置为<var>scopeURL</var>。</p>
          <li data-md>
            <p>将<var>job</var>的<a data-link-type="dfn" href="#dfn-job-script-url" id="ref-for-dfn-job-script-url①">脚本
                URL</a>设置为<var>scriptURL</var>。</p>
          <li data-md>
            <p>将<var>job</var>的<a data-link-type="dfn" href="#dfn-job-promise"
                id="ref-for-dfn-job-promise">作业承诺</a>设置为<var>promise</var>。</p>
          <li data-md>
            <p>将<var>job</var>的<a data-link-type="dfn" href="#dfn-job-client"
                id="ref-for-dfn-job-client">客户端</a>设置为<var>client</var>。</p>
          <li data-md>
            <p>如果<var>client</var>不为 null，将<var>job</var>的<a data-link-type="dfn" href="#job-referrer"
                id="ref-for-job-referrer">引荐来源</a>设置为<var>client</var>的<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url"
                id="ref-for-concept-environment-creation-url⑥">创建 URL</a>。</p>
          <li data-md>
            <p>返回<var>job</var>。</p>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Schedule Job">
        <h3 class="heading settled" id="schedule-job-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="schedule-job">安排作业</dfn></span><a class="self-link"
            href="#schedule-job-algorithm"></a></h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>job</var>，一个<a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job②⓪">作业</a></p>
          <dt data-md>输出
          <dd data-md>
            <p>无</p>
        </dl>
        <ol>
          <li data-md>
            <p>让<var>jobQueue</var>为 null。</p>
          <li data-md>
            <p>让<var>jobScope</var>为<var>job</var>的<a data-link-type="dfn" href="#dfn-job-scope-url"
                id="ref-for-dfn-job-scope-url③">作用域 URL</a>，<a data-link-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer⑦">序列化</a>。
            </p>
          <li data-md>
            <p>如果<a data-link-type="dfn" href="#dfn-scope-to-job-queue-map"
                id="ref-for-dfn-scope-to-job-queue-map">作用域到作业队列映射</a>[<var>jobScope</var>]不存在，<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set②">设置</a><a data-link-type="dfn"
                href="#dfn-scope-to-job-queue-map"
                id="ref-for-dfn-scope-to-job-queue-map①">作用域到作业队列映射</a>[<var>jobScope</var>]为一个新的<a data-link-type="dfn"
                href="#dfn-job-queue" id="ref-for-dfn-job-queue④">作业队列</a>。</p>
          <li data-md>
            <p>设置<var>jobQueue</var>为<a data-link-type="dfn" href="#dfn-scope-to-job-queue-map"
                id="ref-for-dfn-scope-to-job-queue-map②">作用域到作业队列映射</a>[<var>jobScope</var>]。</p>
          <li data-md>
            <p>如果<var>jobQueue</var>为空，则：</p>
            <ol>
              <li data-md>
                <p>将<var>job</var>的<a data-link-type="dfn" href="#dfn-containing-job-queue"
                    id="ref-for-dfn-containing-job-queue">包含的作业队列</a>设置为<var>jobQueue</var>，并将<var>job</var> <a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#queue-enqueue"
                    id="ref-for-queue-enqueue">入队</a>到<var>jobQueue</var>。</p>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#run-job" id="ref-for-run-job">运行作业</a>，使用<var>jobQueue</var>。</p>
            </ol>
          <li data-md>
            <p>否则：</p>
            <ol>
              <li data-md>
                <p>让<var>lastJob</var>为<var>jobQueue</var>中的最后一个元素。</p>
              <li data-md>
                <p>如果<var>job</var>与<var>lastJob</var><a data-link-type="dfn" href="#dfn-job-equivalent"
                    id="ref-for-dfn-job-equivalent">等效</a>，并且<var>lastJob</var>的<a data-link-type="dfn"
                    href="#dfn-job-promise"
                    id="ref-for-dfn-job-promise①">作业承诺</a>尚未解决，则将<var>job</var>附加到<var>lastJob</var>的<a
                    data-link-type="dfn" href="#dfn-job-list-of-equivalent-jobs"
                    id="ref-for-dfn-job-list-of-equivalent-jobs">等效作业列表</a>。</p>
              <li data-md>
                <p>否则，将<var>job</var>的<a data-link-type="dfn" href="#dfn-containing-job-queue"
                    id="ref-for-dfn-containing-job-queue①">包含的作业队列</a>设置为<var>jobQueue</var>，并将<var>job</var><a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#queue-enqueue"
                    id="ref-for-queue-enqueue①">入队</a>到<var>jobQueue</var>。</p>
            </ol>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Run Job">
        <h3 class="heading settled" id="run-job-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="run-job">运行作业</dfn></span><a class="self-link"
            href="#run-job-algorithm"></a></h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p>jobQueue，一个<a data-link-type="dfn" href="#dfn-job-queue" id="ref-for-dfn-job-queue⑤">作业队列</a></p>
          <dt data-md>输出
          <dd data-md>
            <p>无</p>
        </dl>
        <ol>
          <li data-md>
            <p class="assertion">断言：<var>jobQueue</var> <a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty①">非空</a>。</p>
          <li data-md>
            <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                id="ref-for-queue-a-task②①">排队一个任务</a>以运行以下步骤：</p>
            <ol>
              <li data-md>
                <p>让<var>job</var>为<var>jobQueue</var>中的第一个<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#list-item" id="ref-for-list-item⑧">项目</a>。</p>
              <li data-md>
                <p>如果<var>job</var>的<a data-link-type="dfn" href="#dfn-job-type"
                    id="ref-for-dfn-job-type③">作业类型</a>是<em>注册</em>，则<var>job</var> <a data-link-type="dfn"
                    href="#register" id="ref-for-register②">注册</a> <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                    id="ref-for-in-parallel②⑦">并行</a>运行。</p>
              <li data-md>
                <p>否则，如果<var>job</var>的<a data-link-type="dfn" href="#dfn-job-type"
                    id="ref-for-dfn-job-type④">作业类型</a>是<em>更新</em>，则<var>job</var> <a data-link-type="dfn"
                    href="#update" id="ref-for-update">更新</a> <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                    id="ref-for-in-parallel②⑧">并行</a>运行。</p>
                <p class="note" role="note"><span>注意：</span> 对于注册作业和更新作业，用户代理会延迟排队运行作业的任务，直到触发了向启动作业的文档派发的<code
                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-domcontentloaded" id="ref-for-event-domcontentloaded">DOMContentLoaded</a></code>事件。
                </p>
              <li data-md>
                <p>否则，如果<var>job</var>的<a data-link-type="dfn" href="#dfn-job-type"
                    id="ref-for-dfn-job-type⑤">作业类型</a>是<em>注销</em>，则<var>job</var> <a data-link-type="dfn"
                    href="#unregister" id="ref-for-unregister">注销</a> <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                    id="ref-for-in-parallel②⑨">并行</a>运行。</p>
            </ol>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Finish Job">
        <h3 class="heading settled" id="finish-job-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="finish-job">完成作业</dfn></span><a class="self-link"
            href="#finish-job-algorithm"></a></h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>job</var>，一个<a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job②①">作业</a></p>
          <dt data-md>输出
          <dd data-md>
            <p>无</p>
        </dl>
        <ol>
          <li data-md>
            <p>让<var>jobQueue</var>为<var>job</var>的<a data-link-type="dfn" href="#dfn-containing-job-queue"
                id="ref-for-dfn-containing-job-queue②">包含作业队列</a>。</p>
          <li data-md>
            <p class="assertion">断言：<var>jobQueue</var>中的第一个<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#list-item" id="ref-for-list-item⑨">项目</a>是<var>job</var>。</p>
          <li data-md>
            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#queue-dequeue"
                id="ref-for-queue-dequeue">从<var>jobQueue</var>出列</a>。</p>
          <li data-md>
            <p>如果<var>jobQueue</var><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty"
                id="ref-for-list-is-empty②">非空</a>，则使用<var>jobQueue</var>调用<a data-link-type="dfn" href="#run-job"
                id="ref-for-run-job①">运行作业</a>。</p>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Resolve Job Promise">
        <h3 class="heading settled" id="resolve-job-promise-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="resolve-job-promise">解决作业Promise</dfn></span><a class="self-link"
            href="#resolve-job-promise-algorithm"></a></h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>job</var>，一个<a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job②②">作业</a></p>
          <dd data-md>
            <p><var>value</var>，任意类型</p>
          <dt data-md>输出
          <dd data-md>
            <p>无</p>
        </dl>
        <ol>
          <li data-md>
            <p>如果<var>job</var>的<a data-link-type="dfn" href="#dfn-job-client"
                id="ref-for-dfn-job-client①">客户端</a>不为空，<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                id="ref-for-queue-a-task②②">排队任务</a>，在<var>job</var>的<a data-link-type="dfn" href="#dfn-job-client"
                id="ref-for-dfn-job-client②">客户端</a>的<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                id="ref-for-responsible-event-loop①①">负责的事件循环</a>上，使用<a data-link-type="dfn">DOM操作任务源</a>，运行以下子步骤：</p>
            <ol>
              <li data-md>
                <p>令<var>convertedValue</var>为空。</p>
              <li data-md>
                <p>如果<var>job</var>的<a data-link-type="dfn" href="#dfn-job-type"
                    id="ref-for-dfn-job-type⑥">作业类型</a>是<em>注册</em>或<em>更新</em>，将<var>convertedValue</var>设置为在<var>job</var>的<a
                    data-link-type="dfn" href="#dfn-job-client"
                    id="ref-for-dfn-job-client③">客户端</a>中表示<var>value</var>的<a data-link-type="dfn"
                    href="#get-the-service-worker-registration-object"
                    id="ref-for-get-the-service-worker-registration-object④">服务工作者注册对象</a>的结果。</p>
              <li data-md>
                <p>否则，将<var>convertedValue</var>设置为<var>value</var>，在<var>job</var>的<a data-link-type="dfn"
                    href="#dfn-job-client" id="ref-for-dfn-job-client④">客户端</a>的<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object&apos;s-realm"
                    id="ref-for-environment-settings-object&apos;s-realm⑤">领域</a>中。</p>
              <li data-md>
                <p>使用<var>convertedValue</var>解决<var>job</var>的<a data-link-type="dfn" href="#dfn-job-promise"
                    id="ref-for-dfn-job-promise②">作业Promise</a>。</p>
            </ol>
          <li data-md>
            <p>对于<var>job</var>的<a data-link-type="dfn" href="#dfn-job-list-of-equivalent-jobs"
                id="ref-for-dfn-job-list-of-equivalent-jobs①">等效作业列表</a>中的每个<var>equivalentJob</var>：</p>
            <ol>
              <li data-md>
                <p>如果<var>equivalentJob</var>的<a data-link-type="dfn" href="#dfn-job-client"
                    id="ref-for-dfn-job-client⑤">客户端</a>为空，继续循环的下一次迭代。</p>
              <li data-md>
                <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                    id="ref-for-queue-a-task②③">排队任务</a>，在<var>equivalentJob</var>的<a data-link-type="dfn"
                    href="#dfn-job-client" id="ref-for-dfn-job-client⑥">客户端</a>的<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                    id="ref-for-responsible-event-loop①②">负责的事件循环</a>上，使用<a data-link-type="dfn">DOM操作任务源</a>，运行以下子步骤：
                </p>
                <ol>
                  <li data-md>
                    <p>令<var>convertedValue</var>为空。</p>
                  <li data-md>
                    <p>如果<var>equivalentJob</var>的<a data-link-type="dfn" href="#dfn-job-type"
                        id="ref-for-dfn-job-type⑦">作业类型</a>是<em>注册</em>或<em>更新</em>，将<var>convertedValue</var>设置为在<var>equivalentJob</var>的<a
                        data-link-type="dfn" href="#dfn-job-client"
                        id="ref-for-dfn-job-client⑦">客户端</a>中表示<var>value</var>的<a data-link-type="dfn"
                        href="#get-the-service-worker-registration-object"
                        id="ref-for-get-the-service-worker-registration-object⑤">服务工作者注册对象</a>的结果。
                    </p>
                  <li data-md>
                    <p>否则，将<var>convertedValue</var>设置为<var>value</var>，在<var>equivalentJob</var>的<a
                        data-link-type="dfn" href="#dfn-job-client" id="ref-for-dfn-job-client⑧">客户端</a>的<a
                        data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object&apos;s-realm"
                        id="ref-for-environment-settings-object&apos;s-realm⑥">领域</a>中。</p>
                  <li data-md>
                    <p>使用<var>convertedValue</var>解决<var>equivalentJob</var>的<a data-link-type="dfn"
                        href="#dfn-job-promise" id="ref-for-dfn-job-promise③">作业Promise</a>。</p>
                </ol>
            </ol>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Reject Job Promise">
        <h3 class="heading settled" id="reject-job-promise-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="reject-job-promise">拒绝作业Promise</dfn></span><a class="self-link"
            href="#reject-job-promise-algorithm"></a></h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>job</var>，一个<a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job②③">作业</a></p>
          <dd data-md>
            <p><var>errorData</var>，用于<a data-link-type="dfn"
                href="https://webidl.spec.whatwg.org/#dfn-create-exception"
                id="ref-for-dfn-create-exception③">创建异常</a>的信息</p>
          <dt data-md>输出
          <dd data-md>
            <p>无</p>
        </dl>
        <ol>
          <li data-md>
            <p>如果<var>job</var>的<a data-link-type="dfn" href="#dfn-job-client"
                id="ref-for-dfn-job-client⑨">客户端</a>不为空，<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                id="ref-for-queue-a-task②④">排队任务</a>，在<var>job</var>的<a data-link-type="dfn" href="#dfn-job-client"
                id="ref-for-dfn-job-client①⓪">客户端</a>的<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                id="ref-for-responsible-event-loop①③">负责的事件循环</a>上，使用<a data-link-type="dfn">DOM操作任务源</a>，以<a
                data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-create-exception"
                id="ref-for-dfn-create-exception④">新的</a>
              <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-exception"
                id="ref-for-dfn-exception③">异常</a>和<var>errorData</var>以及由用户代理定义的<a data-link-type="dfn"
                href="https://webidl.spec.whatwg.org/#dfn-exception-message"
                id="ref-for-dfn-exception-message③">消息</a>拒绝<var>job</var>的<a data-link-type="dfn"
                href="#dfn-job-promise" id="ref-for-dfn-job-promise④">作业Promise</a>，在<var>job</var>的<a
                data-link-type="dfn" href="#dfn-job-client" id="ref-for-dfn-job-client①①">客户端</a>的<a
                data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object&apos;s-realm"
                id="ref-for-environment-settings-object&apos;s-realm⑦">领域</a>中。
            </p>
          <li data-md>
            <p>对于<var>job</var>的<a data-link-type="dfn" href="#dfn-job-list-of-equivalent-jobs"
                id="ref-for-dfn-job-list-of-equivalent-jobs②">等效作业列表</a>中的每个<var>equivalentJob</var>：</p>
            <ol>
              <li data-md>
                <p>如果<var>equivalentJob</var>的<a data-link-type="dfn" href="#dfn-job-client"
                    id="ref-for-dfn-job-client①②">客户端</a>为空，<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue⑦">继续</a>。
                </p>
              <li data-md>
                <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                    id="ref-for-queue-a-task②⑤">排队任务</a>，在<var>equivalentJob</var>的<a data-link-type="dfn"
                    href="#dfn-job-client" id="ref-for-dfn-job-client①③">客户端</a>的<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                    id="ref-for-responsible-event-loop①④">负责的事件循环</a>上，使用<a data-link-type="dfn">DOM操作任务源</a>，以<a
                    data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-create-exception"
                    id="ref-for-dfn-create-exception⑤">新的</a><a data-link-type="dfn"
                    href="https://webidl.spec.whatwg.org/#dfn-exception" id="ref-for-dfn-exception④">异常</a>和
                  <var>errorData</var>以及由用户代理定义的<a data-link-type="dfn"
                    href="https://webidl.spec.whatwg.org/#dfn-exception-message"
                    id="ref-for-dfn-exception-message④">消息</a>拒绝<var>equivalentJob</var>的<a data-link-type="dfn"
                    href="#dfn-job-promise" id="ref-for-dfn-job-promise⑤">作业Promise</a>，在<var>equivalentJob</var>的<a
                    data-link-type="dfn" href="#dfn-job-client" id="ref-for-dfn-job-client①④">客户端</a>的<a
                    data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object&apos;s-realm"
                    id="ref-for-environment-settings-object&apos;s-realm⑧">领域</a>中。
                </p>
            </ol>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Start Register">
        <h3 class="heading settled" id="start-register-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="start-register">启动注册</dfn></span><a class="self-link"
            href="#start-register-algorithm"></a></h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>scopeURL</var>，一个<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url"
                id="ref-for-concept-url⑨">URL</a>，失败或null</p>
          <dd data-md>
            <p><var>scriptURL</var>，一个<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url"
                id="ref-for-concept-url①⓪">URL</a>或失败</p>
          <dd data-md>
            <p><var>promise</var>，一个<a data-link-type="dfn" href="http://tc39.github.io/ecma262/#sec-promise-objects"
                id="ref-for-sec-promise-objects②⑧">promise</a></p>
          <dd data-md>
            <p><var>client</var>，一个<a data-link-type="dfn" href="#dfn-service-worker-client"
                id="ref-for-dfn-service-worker-client③⑧">service worker客户端</a></p>
          <dd data-md>
            <p><var>referrer</var>，一个<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url"
                id="ref-for-concept-url①①">URL</a></p>
          <dd data-md>
            <p><var>workerType</var>，一个<a data-link-type="dfn" href="#dfn-job-worker-type"
                id="ref-for-dfn-job-worker-type②">worker类型</a></p>
          <dd data-md>
            <p><var>updateViaCache</var>，一个<a data-link-type="dfn" href="#dfn-update-via-cache"
                id="ref-for-dfn-update-via-cache②">通过缓存更新模式</a></p>
          <dt data-md>输出
          <dd data-md>
            <p>无</p>
        </dl>
        <ol>
          <li data-md>
            <p>如果<var>scriptURL</var>为失败状态，使用<code>TypeError</code>拒绝<var>promise</var>并中止这些步骤。</p>
          <li data-md>
            <p>将<var>scriptURL</var>的<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-fragment"
                id="ref-for-concept-url-fragment①">片段</a>设置为null。</p>
            <p class="note" role="note"><span>注意：</span>用户代理不会存储脚本URL的<a data-link-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url-fragment"
                id="ref-for-concept-url-fragment②">片段</a>。这意味着该<a data-link-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url-fragment" id="ref-for-concept-url-fragment③">片段</a>不会影响<a
                data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑨②">service
                workers</a>的识别。</p>
          <li data-md>
            <p>如果<var>scriptURL</var>的<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme"
                id="ref-for-concept-url-scheme③">方案</a>不是"<code>http</code>"或"<code>https</code>"，使用<code>TypeError</code>拒绝<var>promise</var>并中止这些步骤。
            </p>
          <li data-md>
            <p>如果<var>scriptURL</var>的<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-path"
                id="ref-for-concept-url-path①">路径</a>中的任何字符串包含<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                id="ref-for-ascii-case-insensitive">ASCII大小写不敏感</a>的"<code>%2f</code>"或"<code>%5c</code>"，使用<code>TypeError</code>拒绝<var>promise</var>并中止这些步骤。
            </p>
          <li data-md>
            <p>如果<var>scopeURL</var>为null，将<var>scopeURL</var>设置为通过<var>scriptURL</var>解析字符串"<code>./</code>"的结果。</p>
            <p class="note" role="note"><span>注意：</span>注册的范围URL默认设置为service worker脚本的位置。</p>
          <li data-md>
            <p>如果<var>scopeURL</var>为失败状态，使用<code>TypeError</code>拒绝<var>promise</var>并中止这些步骤。</p>
          <li data-md>
            <p>将<var>scopeURL</var>的<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-fragment"
                id="ref-for-concept-url-fragment④">片段</a>设置为null。</p>
            <p class="note" role="note"><span>注意：</span>用户代理不会存储范围URL的<a data-link-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url-fragment"
                id="ref-for-concept-url-fragment⑤">片段</a>。这意味着该<a data-link-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url-fragment" id="ref-for-concept-url-fragment⑥">片段</a>不会影响<a
                data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration⑤①">service worker注册</a>的识别。</p>
          <li data-md>
            <p>如果<var>scopeURL</var>的<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme"
                id="ref-for-concept-url-scheme④">方案</a>不是"<code>http</code>"或"<code>https</code>"，使用<code>TypeError</code>拒绝<var>promise</var>并中止这些步骤。
            </p>
          <li data-md>
            <p>如果<var>scopeURL</var>的<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-path"
                id="ref-for-concept-url-path②">路径</a>中的任何字符串包含<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                id="ref-for-ascii-case-insensitive②">ASCII大小写不敏感</a>的"<code>%2f</code>"或"<code>%5c</code>"，使用<code>TypeError</code>拒绝<var>promise</var>并中止这些步骤。
            </p>
          <li data-md>
            <p>让<var>storage key</var>成为通过给定<var>client</var>运行<a data-link-type="dfn"
                href="https://storage.spec.whatwg.org/#obtain-a-storage-key"
                id="ref-for-obtain-a-storage-key⑨">获取存储键</a>的结果。</p>
          <li data-md>
            <p>让<var>job</var>成为通过运行<a data-link-type="dfn" href="#create-job"
                id="ref-for-create-job②">创建作业</a>，使用<em>register</em>，<var>storage
                key</var>，<var>scopeURL</var>，<var>scriptURL</var>，<var>promise</var>和<var>client</var>得到的结果。
            </p>
          <li data-md>
            <p>将<var>job</var>的<a data-link-type="dfn" href="#dfn-job-worker-type"
                id="ref-for-dfn-job-worker-type③">worker类型</a>设置为<var>workerType</var>。</p>
          <li data-md>
            <p>将<var>job</var>的<a data-link-type="dfn" href="#dfn-job-update-via-cache-mode"
                id="ref-for-dfn-job-update-via-cache-mode①">通过缓存更新模式</a>设置为<var>updateViaCache</var>。</p>
          <li data-md>
            <p>将<var>job</var>的<a data-link-type="dfn" href="#job-referrer"
                id="ref-for-job-referrer①">引荐</a>设置为<var>referrer</var>。</p>
          <li data-md>
            <p>调用<a data-link-type="dfn" href="#schedule-job" id="ref-for-schedule-job②">安排作业</a>，使用<var>job</var>。
            </p>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Register">
        <h3 class="heading settled" id="register-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="register">注册</dfn></span><a class="self-link"
            href="#register-algorithm"></a></h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>job</var>，一个<a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job②④">作业</a></p>
          <dt data-md>输出
          <dd data-md>
            <p>无</p>
        </dl>
        <ol>
          <li data-md>
            <p>如果通过运行<a data-link-type="dfn"
                href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin"
                id="ref-for-potentially-trustworthy-origin">潜在可信来源</a>，将<var>job</var>的<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                id="ref-for-concept-settings-object-origin①③">来源</a>作为<var>script url</var>的参数，返回值为<code>不可信</code>，则：
            </p>
            <ol>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#reject-job-promise"
                    id="ref-for-reject-job-promise">拒绝作业Promise</a>，使用<var>job</var>和"<code
                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#securityerror" id="ref-for-securityerror①">SecurityError</a></code>"
                  <code
                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException①⑤">DOMException</a></code>。
                </p>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#finish-job"
                    id="ref-for-finish-job">完成作业</a>，使用<var>job</var>，并中止这些步骤。</p>
            </ol>
          <li data-md>
            <p>如果<var>job</var>的<a data-link-type="dfn" href="#dfn-job-script-url"
                id="ref-for-dfn-job-script-url③">脚本URL</a>的<a data-link-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url-origin"
                id="ref-for-concept-url-origin②">来源</a>和<var>job</var>的<a data-link-type="dfn" href="#job-referrer"
                id="ref-for-job-referrer②">引用</a>的<a data-link-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin③">来源</a>不是<a
                data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin"
                id="ref-for-same-origin④">同源</a>，则：</p>
            <ol>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#reject-job-promise"
                    id="ref-for-reject-job-promise①">拒绝作业Promise</a>，使用<var>job</var>和"<code
                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#securityerror" id="ref-for-securityerror②">SecurityError</a></code>"
                  <code
                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException①⑥">DOMException</a></code>。
                </p>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#finish-job"
                    id="ref-for-finish-job①">完成作业</a>，使用<var>job</var>，并中止这些步骤。</p>
            </ol>
          <li data-md>
            <p>如果<var>job</var>的<a data-link-type="dfn" href="#dfn-job-scope-url"
                id="ref-for-dfn-job-scope-url④">范围URL</a>的<a data-link-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url-origin"
                id="ref-for-concept-url-origin④">来源</a>和<var>job</var>的<a data-link-type="dfn" href="#job-referrer"
                id="ref-for-job-referrer③">引用</a>的<a data-link-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin⑤">来源</a>不是<a
                data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin"
                id="ref-for-same-origin⑤">同源</a>，则：</p>
            <ol>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#reject-job-promise"
                    id="ref-for-reject-job-promise②">拒绝作业Promise</a>，使用<var>job</var>和"<code
                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#securityerror" id="ref-for-securityerror③">SecurityError</a></code>"
                  <code
                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException①⑦">DOMException</a></code>。
                </p>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#finish-job"
                    id="ref-for-finish-job②">完成作业</a>，使用<var>job</var>，并中止这些步骤。</p>
            </ol>
          <li data-md>
            <p>让<var>registration</var>成为运行<a data-link-type="dfn" href="#get-registration"
                id="ref-for-get-registration">获取注册信息</a>，使用<var>job</var>的<a data-link-type="dfn"
                href="#job-storage-key" id="ref-for-job-storage-key①">存储键</a>和<var>job</var>的<a data-link-type="dfn"
                href="#dfn-job-scope-url" id="ref-for-dfn-job-scope-url⑤">范围URL</a>的结果。</p>
          <li data-md>
            <p>如果<var>registration</var>不为null，则：</p>
            <ol>
              <li data-md>
                <p>让<var>newestWorker</var>成为运行<a data-link-type="dfn" href="#get-newest-worker"
                    id="ref-for-get-newest-worker①">获取最新worker</a>算法并传递<var>registration</var>作为参数的结果。</p>
              <li data-md>
                <p>如果<var>newestWorker</var>不为null，<var>job</var>的<a data-link-type="dfn" href="#dfn-job-script-url"
                    id="ref-for-dfn-job-script-url④">脚本URL</a><a data-link-type="dfn"
                    href="https://url.spec.whatwg.org/#concept-url-equals"
                    id="ref-for-concept-url-equals">等于</a><var>newestWorker</var>的<a data-link-type="dfn"
                    href="#dfn-script-url" id="ref-for-dfn-script-url②">脚本URL</a>，<var>job</var>的<a data-link-type="dfn"
                    href="#dfn-job-worker-type"
                    id="ref-for-dfn-job-worker-type④">worker类型</a>等于<var>newestWorker</var>的<a data-link-type="dfn"
                    href="#dfn-type" id="ref-for-dfn-type①">类型</a>，并且<var>job</var>的<a data-link-type="dfn"
                    href="#dfn-job-update-via-cache-mode"
                    id="ref-for-dfn-job-update-via-cache-mode②">通过缓存更新模式</a>的值等于<var>registration</var>的<a
                    data-link-type="dfn" href="#dfn-update-via-cache" id="ref-for-dfn-update-via-cache③">通过缓存更新模式</a>，则：
                </p>
                <ol>
                  <li data-md>
                    <p>调用<a data-link-type="dfn" href="#resolve-job-promise"
                        id="ref-for-resolve-job-promise">解决作业Promise</a>，使用<var>job</var>和<var>registration</var>。</p>
                  <li data-md>
                    <p>调用<a data-link-type="dfn" href="#finish-job"
                        id="ref-for-finish-job③">完成作业</a>，使用<var>job</var>，并中止这些步骤。</p>
                </ol>
            </ol>
          <li data-md>
            <p>否则：</p>
            <ol>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#set-registration"
                    id="ref-for-set-registration">设置注册信息</a>算法，使用<var>job</var>的<a data-link-type="dfn"
                    href="#job-storage-key" id="ref-for-job-storage-key②">存储键</a>，<var>job</var>的<a data-link-type="dfn"
                    href="#dfn-job-scope-url" id="ref-for-dfn-job-scope-url⑥">范围URL</a>，以及<var>job</var>的<a
                    data-link-type="dfn" href="#dfn-job-update-via-cache-mode"
                    id="ref-for-dfn-job-update-via-cache-mode③">通过缓存更新模式</a>。</p>
            </ol>
          <li data-md>
            <p>调用<a data-link-type="dfn" href="#update" id="ref-for-update①">更新</a>算法并传递<var>job</var>作为参数。</p>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Update">
        <h3 class="heading settled" id="update-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="update">更新</dfn></span><a class="self-link"
            href="#update-algorithm"></a></h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>job</var>，一个<a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job②⑤">作业</a></p>
          <dt data-md>输出
          <dd data-md>
            <p>无</p>
        </dl>
        <ol>
          <li data-md>
            <p>让<var>registration</var>成为运行<a data-link-type="dfn" href="#get-registration"
                id="ref-for-get-registration①">获取注册信息</a>，使用<var>job</var>的<a data-link-type="dfn"
                href="#job-storage-key" id="ref-for-job-storage-key③">存储键</a>和<var>job</var>的<a data-link-type="dfn"
                href="#dfn-job-scope-url" id="ref-for-dfn-job-scope-url⑦">范围URL</a>的结果。</p>
          <li data-md>
            <p>如果<var>registration</var>为null，则：</p>
            <ol>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#reject-job-promise"
                    id="ref-for-reject-job-promise③">拒绝作业Promise</a>，使用<var>job</var>和<code>TypeError</code>。</p>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#finish-job"
                    id="ref-for-finish-job④">完成作业</a>，使用<var>job</var>，并中止这些步骤。</p>
            </ol>
          <li data-md>
            <p>让<var>newestWorker</var>成为运行<a data-link-type="dfn" href="#get-newest-worker"
                id="ref-for-get-newest-worker②">获取最新Worker</a>算法，传递<var>registration</var>作为参数的结果。</p>
          <li data-md>
            <p>如果<var>job</var>的<a data-link-type="dfn" href="#dfn-job-type"
                id="ref-for-dfn-job-type⑧">作业类型</a>是<em>更新</em>，且<var>newestWorker</var>不为null，并且其<a
                data-link-type="dfn" href="#dfn-script-url" id="ref-for-dfn-script-url③">脚本URL</a>不<a
                data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-equals"
                id="ref-for-concept-url-equals①">等于</a>
              <var>job</var>的<a data-link-type="dfn" href="#dfn-job-script-url"
                id="ref-for-dfn-job-script-url⑤">脚本URL</a>，则：
            </p>
            <ol>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#reject-job-promise"
                    id="ref-for-reject-job-promise④">拒绝作业Promise</a>，使用<var>job</var>和<code>TypeError</code>。</p>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#finish-job"
                    id="ref-for-finish-job⑤">完成作业</a>，使用<var>job</var>，并中止这些步骤。</p>
            </ol>
          <li data-md>
            <p>将<var>referrerPolicy</var>设为空字符串。</p>
          <li data-md>
            <p>将<var>hasUpdatedResources</var>设为false。</p>
          <li data-md>
            <p>将<var>updatedResourceMap</var>设为一个<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map⑥">有序映射</a>，其<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-getting-the-keys"
                id="ref-for-map-getting-the-keys③">键</a>是<a data-link-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①②">URL</a>，<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-getting-the-values"
                id="ref-for-map-getting-the-values②">值</a>是<a data-link-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑦">响应</a>。</p>
          <li data-md>
            <p>根据<var>job</var>的<a data-link-type="dfn" href="#dfn-job-worker-type"
                id="ref-for-dfn-job-worker-type⑤">worker类型</a>，运行以下子步骤：</p>
            <dl>
              <dt data-md>"<code>classic</code>"
              <dd data-md>
                <p><a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-classic-worker-script"
                    id="ref-for-fetch-a-classic-worker-script">获取一个经典worker脚本</a>，根据<var>job</var>的<a
                    data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer"
                    id="ref-for-concept-url-serializer⑧">序列化的</a><a data-link-type="dfn" href="#dfn-job-script-url"
                    id="ref-for-dfn-job-script-url⑥">脚本URL</a>、<var>job</var>的<a data-link-type="dfn"
                    href="#dfn-job-client" id="ref-for-dfn-job-client①⑤">客户端</a>、"<code>serviceworker</code>"和即将创建的<a
                    data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                    id="ref-for-environment-settings-object①⑤">环境设置对象</a>。</p>
              <dt data-md>"<code>module</code>"
              <dd data-md>
                <p><a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-module-worker-script-tree"
                    id="ref-for-fetch-a-module-worker-script-tree">获取一个模块worker脚本树</a>，根据<var>job</var>的<a
                    data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer"
                    id="ref-for-concept-url-serializer⑨">序列化的</a><a data-link-type="dfn" href="#dfn-job-script-url"
                    id="ref-for-dfn-job-script-url⑦">脚本URL</a>、<var>job</var>的<a data-link-type="dfn"
                    href="#dfn-job-client"
                    id="ref-for-dfn-job-client①⑥">客户端</a>、"<code>serviceworker</code>"、"<code>omit</code>"，以及即将创建的<a
                    data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                    id="ref-for-environment-settings-object①⑥">环境设置对象</a>。</p>
            </dl>
            <p class="issue" id="issue-02e2fe82"><a class="self-link" href="#issue-02e2fe82"></a> 使用即将创建的<a
                data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                id="ref-for-environment-settings-object①⑦">环境设置对象</a>而不是一个具体的<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                id="ref-for-environment-settings-object①⑧">环境设置对象</a>。这是因为Service Worker的独特处理模型与其他<a
                data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#workers"
                id="ref-for-workers①">Web Workers</a>的处理模型不同。HTML标准中为其他<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/workers.html#workers" id="ref-for-workers②">Web
                Workers</a>设计的脚本获取算法需要执行环境的<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                id="ref-for-environment-settings-object①⑨">环境设置对象</a>，但Service Worker在<a data-link-type="dfn"
                href="#update" id="ref-for-update②">更新</a>算法中单独获取脚本，然后在<a data-link-type="dfn"
                href="#run-service-worker" id="ref-for-run-service-worker②">运行Service Worker</a>算法中多次运行脚本。</p>
            <p class="issue" id="issue-9d9e65b5"><a class="self-link" href="#issue-9d9e65b5"></a> HTML中的<a
                data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-classic-worker-script"
                id="ref-for-fetch-a-classic-worker-script①">获取一个经典worker脚本</a>算法和<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-module-worker-script-tree"
                id="ref-for-fetch-a-module-worker-script-tree①">获取一个模块worker脚本树</a>算法将<var>job</var>的<a
                data-link-type="dfn" href="#dfn-job-client" id="ref-for-dfn-job-client①⑦">客户端</a>作为参数。当从<a
                data-link-type="dfn" href="#soft-update" id="ref-for-soft-update">软更新</a>算法传递时，<var>job</var>的<a
                data-link-type="dfn" href="#dfn-job-client" id="ref-for-dfn-job-client①⑧">客户端</a>为null。</p>
            <p>要根据<var>request</var>运行<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#fetching-scripts-perform-fetch"
                id="ref-for-fetching-scripts-perform-fetch①">执行获取</a>，请运行以下步骤：</p>
            <ol>
              <li data-md>
                <p>将`<code>Service-Worker</code>`/`<code>script</code>`附加到<var>request</var>的<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-header-list"
                    id="ref-for-concept-request-header-list">请求头列表</a>中。</p>
                <p class="note" role="note"><span>注意：</span>参见附录B：扩展HTTP头中对Service-Worker头的定义。</p>
              <li data-md>
                <p>将<var>request</var>的<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-cache-mode"
                    id="ref-for-concept-request-cache-mode①">缓存模式</a>设置为"<code>no-cache</code>"，如果以下任一条件为真：</p>
                <ul>
                  <li data-md>
                    <p><var>registration</var>的<a data-link-type="dfn" href="#dfn-update-via-cache"
                        id="ref-for-dfn-update-via-cache④">通过缓存更新模式</a>不是"<code>all</code>"。</p>
                  <li data-md>
                    <p><var>job</var>的<a data-link-type="dfn" href="#dfn-job-force-bypass-cache-flag"
                        id="ref-for-dfn-job-force-bypass-cache-flag">强制绕过缓存标志</a>已设置。</p>
                  <li data-md>
                    <p><var>newestWorker</var>不为null，并且<var>registration</var>是<a data-link-type="dfn"
                        href="#service-worker-registration-stale"
                        id="ref-for-service-worker-registration-stale①">过时的</a>。</p>
                </ul>
                <p class="note" role="note">
                  <span>注意：</span>即使缓存模式未设置为"<code>no-cache</code>"，用户代理仍会遵守网络层中的Cache-Control头的max-age值，以确定是否应绕过浏览器缓存。
                </p>
              <li data-md>
                <p>将<var>request</var>的<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#request-service-workers-mode"
                    id="ref-for-request-service-workers-mode②">service-workers模式</a>设置为"<code>none</code>"。</p>
              <li data-md>
                <p>如果未设置<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#fetching-scripts-is-top-level"
                    id="ref-for-fetching-scripts-is-top-level">是顶层</a>标志，则返回<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-fetch"
                    id="ref-for-concept-fetch①②">获取</a><var>request</var>的结果。</p>
              <li data-md>
                <p>将<var>request</var>的<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-redirect-mode"
                    id="ref-for-concept-request-redirect-mode">重定向模式</a>设置为"<code>error</code>"。</p>
              <li data-md>
                <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
                    id="ref-for-concept-fetch①③">获取</a><var>request</var>，并异步等待在获取的<a
                    data-link-type="dfn">处理响应</a>阶段运行剩余步骤，获取<var>response</var>的<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑧">响应</a>。</p>
              <li data-md>
                <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-extract-mime-type"
                    id="ref-for-concept-header-extract-mime-type①">从</a><var>response</var>的<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response-header-list"
                    id="ref-for-concept-response-header-list③">头列表</a>中提取MIME类型。如果此MIME类型（忽略参数）不是<a data-link-type="dfn"
                    href="https://mimesniff.spec.whatwg.org/#javascript-mime-type"
                    id="ref-for-javascript-mime-type②">JavaScript MIME类型</a>，则：</p>
                <ol>
                  <li data-md>
                    <p>调用<a data-link-type="dfn" href="#reject-job-promise"
                        id="ref-for-reject-job-promise⑤">拒绝作业Promise</a>，使用<var>job</var>和"<code
                        class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#securityerror" id="ref-for-securityerror④">SecurityError</a></code>"<code
                        class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException①⑧">DOMException</a></code>。
                    </p>
                  <li data-md>
                    <p>异步完成这些步骤，并返回<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error"
                        id="ref-for-concept-network-error④">网络错误</a>。</p>
                </ol>
              <li data-md>
                <p>让<var>serviceWorkerAllowed</var>成为<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#extract-header-list-values"
                    id="ref-for-extract-header-list-values">提取头列表值</a>给`<code>Service-Worker-Allowed</code>`和<var>response</var>的<a
                    data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list"
                    id="ref-for-concept-response-header-list④">头列表</a>的结果。</p>
                <p class="note" role="note"><span>注意：</span>参见附录B：扩展HTTP头中的<a data-link-type="dfn"
                    href="#service-worker-allowed" id="ref-for-service-worker-allowed①">Service-Worker-Allowed</a>头的定义。
                </p>
              <li data-md>
                <p>将<var>policyContainer</var>设置为<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/origin.html#creating-a-policy-container-from-a-fetch-response"
                    id="ref-for-creating-a-policy-container-from-a-fetch-response">从获取响应创建策略容器</a>的结果，使用<var>response</var>。
                </p>
              <li data-md>
                <p>如果<var>serviceWorkerAllowed</var>为失败，则：</p>
                <ol>
                  <li data-md>
                    <p>异步完成这些步骤，并返回<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error"
                        id="ref-for-concept-network-error⑤">网络错误</a>。</p>
                </ol>
              <li data-md>
                <p>让<var>scopeURL</var>成为<var>registration</var>的<a data-link-type="dfn" href="#dfn-scope-url"
                    id="ref-for-dfn-scope-url①③">范围URL</a>。</p>
              <li data-md>
                <p>将<var>maxScopeString</var>设为null。</p>
              <li data-md>
                <p>如果<var>serviceWorkerAllowed</var>为null，则：</p>
                <ol>
                  <li data-md>
                    <p>让<var>resolvedScope</var>成为<a data-link-type="dfn"
                        href="https://url.spec.whatwg.org/#concept-url-parser"
                        id="ref-for-concept-url-parser⑥">解析</a>"<code>./</code>"的结果，使用<var>job</var>的<a
                        data-link-type="dfn" href="#dfn-job-script-url" id="ref-for-dfn-job-script-url⑧">脚本URL</a>作为<a
                        data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-script-base-url"
                        id="ref-for-concept-script-base-url">基准URL</a>。</p>
                  <li data-md>
                    <p>将<var>maxScopeString</var>设为"<code>/</code>"，后跟<var>resolvedScope</var>的<a data-link-type="dfn"
                        href="https://url.spec.whatwg.org/#concept-url-path"
                        id="ref-for-concept-url-path③">路径</a>中的字符串（包括空字符串），由"<code>/</code>"分隔。</p>
                    <p class="note" role="note">
                      <span>注意：</span><var>resolvedScope</var>的路径中的最后一项将始终为空字符串，因此<var>maxScopeString</var>将有一个尾随的"<code>/</code>"。
                    </p>
                </ol>
              <li data-md>
                <p>否则：</p>
                <ol>
                  <li data-md>
                    <p>让<var>maxScope</var>成为<a data-link-type="dfn"
                        href="https://url.spec.whatwg.org/#concept-url-parser"
                        id="ref-for-concept-url-parser⑦">解析</a><var>serviceWorkerAllowed</var>的结果，使用<var>job</var>的<a
                        data-link-type="dfn" href="#dfn-job-script-url" id="ref-for-dfn-job-script-url⑨">脚本URL</a>作为<a
                        data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-script-base-url"
                        id="ref-for-concept-script-base-url①">基准URL</a>。</p>
                  <li data-md>
                    <p>如果<var>maxScope</var>的<a data-link-type="dfn"
                        href="https://url.spec.whatwg.org/#concept-url-origin"
                        id="ref-for-concept-url-origin⑥">来源</a>是<var>job</var>的<a data-link-type="dfn"
                        href="#dfn-job-script-url" id="ref-for-dfn-job-script-url①⓪">脚本URL</a>的<a data-link-type="dfn"
                        href="https://url.spec.whatwg.org/#concept-url-origin"
                        id="ref-for-concept-url-origin⑦">来源</a>，则：</p>
                    <ol>
                      <li data-md>
                        <p>将<var>maxScopeString</var>设为"<code>/</code>"，后跟<var>maxScope</var>的<a data-link-type="dfn"
                            href="https://url.spec.whatwg.org/#concept-url-path"
                            id="ref-for-concept-url-path⑤">路径</a>中的字符串（包括空字符串），由"<code>/</code>"分隔。</p>
                    </ol>
                </ol>
              <li data-md>
                <p>将<var>scopeString</var>设为"<code>/</code>"，后跟<var>scopeURL</var>的<a data-link-type="dfn"
                    href="https://url.spec.whatwg.org/#concept-url-path"
                    id="ref-for-concept-url-path⑥">路径</a>中的字符串（包括空字符串），由"<code>/</code>"分隔。</p>
              <li data-md>
                <p>如果<var>maxScopeString</var>为null或<var>scopeString</var>不以<var>maxScopeString</var>开头，则：</p>
                <ol>
                  <li data-md>
                    <p>调用<a data-link-type="dfn" href="#reject-job-promise"
                        id="ref-for-reject-job-promise⑥">拒绝作业Promise</a>，使用<var>job</var>和"<code
                        class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#securityerror" id="ref-for-securityerror⑤">SecurityError</a></code>"<code
                        class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException"
                            id="ref-for-idl-DOMException①⑨">DOMException</a></code>。</p>
                  <li data-md>
                    <p>异步完成这些步骤，并返回<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error"
                        id="ref-for-concept-network-error⑥">网络错误</a>。</p>
                </ol>
              <li data-md>
                <p>让<var>url</var>成为<var>request</var>的<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url⑤">url</a>。
                </p>
              <li data-md>
                <p>将<var>updatedResourceMap</var>[<var>url</var>]设置为<var>response</var>。</p>
              <li data-md>
                <p>如果<var>response</var>的<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response-cache-state"
                    id="ref-for-concept-response-cache-state①">缓存状态</a>不是"<code>local</code>"，将<var>registration</var>的<a
                    data-link-type="dfn" href="#dfn-last-update-check-time"
                    id="ref-for-dfn-last-update-check-time③">最后更新检查时间</a>设置为当前时间。</p>
              <li data-md>
                <p>如果以下任一条件为真，则将<var>hasUpdatedResources</var>设为true：</p>
                <ul>
                  <li data-md>
                    <p><var>newestWorker</var>为null。</p>
                  <li data-md>
                    <p><var>newestWorker</var>的<a data-link-type="dfn" href="#dfn-script-url"
                        id="ref-for-dfn-script-url④">脚本URL</a>不是<var>url</var>或<var>newestWorker</var>的<a
                        data-link-type="dfn" href="#dfn-type" id="ref-for-dfn-type②">类型</a>不是<var>job</var>的<a
                        data-link-type="dfn" href="#dfn-job-worker-type" id="ref-for-dfn-job-worker-type⑥">worker类型</a>。
                    </p>
                  <li data-md>
                    <p><var>newestWorker</var>的<a data-link-type="dfn" href="#dfn-script-resource-map"
                        id="ref-for-dfn-script-resource-map②">脚本资源映射</a>[<var>url</var>]的<a data-link-type="dfn"
                        href="https://fetch.spec.whatwg.org/#concept-response-body"
                        id="ref-for-concept-response-body⑨">主体</a>与<var>response</var>的<a data-link-type="dfn"
                        href="https://fetch.spec.whatwg.org/#concept-response-body"
                        id="ref-for-concept-response-body①⓪">主体</a>不完全相同。</p>
                </ul>
              <li data-md>
                <p>如果<var>hasUpdatedResources</var>为false，并且<var>newestWorker</var>的<a data-link-type="dfn"
                    href="#dfn-classic-scripts-imported-flag"
                    id="ref-for-dfn-classic-scripts-imported-flag①">经典脚本已导入标志</a>已设置，则：</p>
                <p class="note" role="note"><span>注意：</span>以下检查导入的脚本是否已更新，因为主脚本未更改。</p>
                <ol>
                  <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate"
                        id="ref-for-map-iterate⑤">对于每个</a><var>importUrl</var>→<var>storedResponse</var>，位于<var>newestWorker</var>的<a
                        data-link-type="dfn" href="#dfn-script-resource-map"
                        id="ref-for-dfn-script-resource-map③">脚本资源映射</a>中：</p>
                    <ol>
                      <li data-md>
                        <p>如果<var>importUrl</var>是<var>url</var>，则继续。</p>
                      <li data-md>
                        <p>让<var>importRequest</var>成为一个新的<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request"
                            id="ref-for-concept-request⑤">请求</a>，其<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-url"
                            id="ref-for-concept-request-url⑥">url</a>为<var>importUrl</var>，<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-client"
                            id="ref-for-concept-request-client②">客户端</a>为<var>job</var>的<a data-link-type="dfn"
                            href="#dfn-job-client" id="ref-for-dfn-job-client①⑨">客户端</a>，<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-destination"
                            id="ref-for-concept-request-destination①">目的地</a>为"<code>script</code>"，<a
                            data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-parser-metadata"
                            id="ref-for-concept-request-parser-metadata">解析器元数据</a>为"<code>未由解析器插入</code>"，<a
                            data-link-type="dfn">同步标志</a>已设置，且其<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-use-url-credentials-flag"
                            id="ref-for-concept-request-use-url-credentials-flag">使用URL凭据标志</a>已设置。</p>
                      <li data-md>
                        <p>将<var>importRequest</var>的<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-cache-mode"
                            id="ref-for-concept-request-cache-mode②">缓存模式</a>设置为"<code>no-cache</code>"，如果以下任一条件为真：</p>
                        <ul>
                          <li data-md>
                            <p><var>registration</var>的<a data-link-type="dfn" href="#dfn-update-via-cache"
                                id="ref-for-dfn-update-via-cache⑤">通过缓存更新模式</a>为"<code>none</code>"。</p>
                          <li data-md>
                            <p><var>job</var>的<a data-link-type="dfn" href="#dfn-job-force-bypass-cache-flag"
                                id="ref-for-dfn-job-force-bypass-cache-flag①">强制绕过缓存标志</a>已设置。</p>
                          <li data-md>
                            <p><var>registration</var>是<a data-link-type="dfn" href="#service-worker-registration-stale"
                                id="ref-for-service-worker-registration-stale②">过时的</a>。</p>
                        </ul>
                      <li data-md>
                        <p>让<var>fetchedResponse</var>成为<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-fetch"
                            id="ref-for-concept-fetch①④">获取</a><var>importRequest</var>的结果。</p>
                      <li data-md>
                        <p>将<var>updatedResourceMap</var>[<var>importRequest</var>的<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-url"
                            id="ref-for-concept-request-url⑦">url</a>]设置为<var>fetchedResponse</var>。</p>
                      <li data-md>
                        <p>将<var>fetchedResponse</var>设置为<var>fetchedResponse</var>的<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#unsafe-response"
                            id="ref-for-unsafe-response①">不安全响应</a>。</p>
                      <li data-md>
                        <p>如果<var>fetchedResponse</var>的<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-response-cache-state"
                            id="ref-for-concept-response-cache-state②">缓存状态</a>不是"<code>local</code>"，将<var>registration</var>的<a
                            data-link-type="dfn" href="#dfn-last-update-check-time"
                            id="ref-for-dfn-last-update-check-time④">最后更新检查时间</a>设置为当前时间。</p>
                      <li data-md>
                        <p>如果<var>fetchedResponse</var>是一个<a data-link-type="dfn" href="#dfn-bad-import-script-response"
                            id="ref-for-dfn-bad-import-script-response①">错误的导入脚本响应</a>，继续。</p>
                        <p class="note" role="note"><span>注意：</span>对于<a data-link-type="functionish"
                            href="#importscripts-method"
                            id="ref-for-importscripts-method①">importScripts()</a>的错误响应在字节检查的目的上将被忽略。仅考虑了现有worker和潜在更新worker的正确响应。参见<a
                            href="https://github.com/w3c/ServiceWorker/issues/1374">问题#1374</a>的一些理由。</p>
                      <li data-md>
                        <p>如果<var>fetchedResponse</var>的<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-response-body"
                            id="ref-for-concept-response-body①①">主体</a>与<var>storedResponse</var>的<a
                            data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#unsafe-response"
                            id="ref-for-unsafe-response②">不安全响应</a>的<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-response-body"
                            id="ref-for-concept-response-body①②">主体</a>不完全相同，设置<var>hasUpdatedResources</var>为true。</p>
                        <p class="note" role="note"><span>注意：</span>此步骤中的控制不会中断循环，而是继续所有导入的脚本以填充缓存。</p>
                    </ol>
                </ol>
              <li data-md>
                <p>异步完成这些步骤，返回<var>response</var>。</p>
            </ol>
            <p>当算法异步完成时，继续这些步骤的剩余部分，<var>script</var>作为异步完成值。</p>
          <li data-md>
            <p>如果<var>script</var>为null或<a data-link-type="dfn" href="#is-async-module"
                id="ref-for-is-async-module">是异步模块</a>，则使用<var>script</var>的<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-script-record"
                id="ref-for-concept-script-record">记录</a>，<var>script</var>的<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-script-base-url"
                id="ref-for-concept-script-base-url②">基准URL</a>和« »为true，则：</p>
            <ol>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#reject-job-promise"
                    id="ref-for-reject-job-promise⑦">拒绝作业Promise</a>，使用<var>job</var>和<code>TypeError</code>。</p>
                <p class="note" role="note"><span>注意：</span>如果之前已经调用了<a data-link-type="dfn" href="#reject-job-promise"
                    id="ref-for-reject-job-promise⑧">拒绝作业Promise</a>，并使用了"<code
                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#securityerror" id="ref-for-securityerror⑥">SecurityError</a></code>"<code
                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException"
                        id="ref-for-idl-DOMException②⓪">DOMException</a></code>，则此操作将无效。</p>
              <li data-md>
                <p>如果<var>newestWorker</var>为null，则<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#map-remove" id="ref-for-map-remove①">移除</a><a
                    data-link-type="dfn" href="#dfn-scope-to-registration-map"
                    id="ref-for-dfn-scope-to-registration-map④">注册映射</a>[(<var>registration</var>的<a
                    data-link-type="dfn" href="#service-worker-registration-storage-key"
                    id="ref-for-service-worker-registration-storage-key⑧">存储键</a>，<a data-link-type="dfn"
                    href="https://url.spec.whatwg.org/#concept-url-serializer"
                    id="ref-for-concept-url-serializer①⓪">序列化的</a><var>scopeURL</var>)。</p>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#finish-job"
                    id="ref-for-finish-job⑥">完成作业</a>，使用<var>job</var>，并中止这些步骤。</p>
            </ol>
          <li data-md>
            <p>如果<var>hasUpdatedResources</var>为false，则：</p>
            <ol>
              <li data-md>
                <p>将<var>registration</var>的<a data-link-type="dfn" href="#dfn-update-via-cache"
                    id="ref-for-dfn-update-via-cache⑥">通过缓存更新模式</a>设置为<var>job</var>的<a data-link-type="dfn"
                    href="#dfn-job-update-via-cache-mode" id="ref-for-dfn-job-update-via-cache-mode④">更新通过缓存模式</a>。</p>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#resolve-job-promise"
                    id="ref-for-resolve-job-promise①">解析作业Promise</a>，使用<var>job</var>和<var>registration</var>。</p>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#finish-job"
                    id="ref-for-finish-job⑦">完成作业</a>，使用<var>job</var>，并中止这些步骤。</p>
            </ol>
          <li data-md>
            <p>让<var>worker</var>成为一个新的<a data-link-type="dfn" href="#dfn-service-worker"
                id="ref-for-dfn-service-worker⑨③">service worker</a>。</p>
          <li data-md>
            <p>将<var>worker</var>的<a data-link-type="dfn" href="#dfn-script-url"
                id="ref-for-dfn-script-url⑤">脚本URL</a>设置为<var>job</var>的<a data-link-type="dfn"
                href="#dfn-job-script-url" id="ref-for-dfn-job-script-url①①">脚本URL</a>，<var>worker</var>的<a
                data-link-type="dfn" href="#dfn-script-resource"
                id="ref-for-dfn-script-resource④">脚本资源</a>设置为<var>script</var>，<var>worker</var>的<a data-link-type="dfn"
                href="#dfn-type" id="ref-for-dfn-type③">类型</a>设置为<var>job</var>的<a data-link-type="dfn"
                href="#dfn-job-worker-type" id="ref-for-dfn-job-worker-type⑦">worker类型</a>，并将<var>worker</var>的<a
                data-link-type="dfn" href="#dfn-script-resource-map"
                id="ref-for-dfn-script-resource-map④">脚本资源映射</a>设置为<var>updatedResourceMap</var>。</p>
          <li data-md>
            <p>将<var>url</var>添加到<var>worker</var>的<a data-link-type="dfn" href="#dfn-set-of-used-scripts"
                id="ref-for-dfn-set-of-used-scripts③">已使用脚本集</a>中。</p>
          <li data-md>
            <p>将<var>worker</var>的<a data-link-type="dfn" href="#dfn-script-resource"
                id="ref-for-dfn-script-resource⑤">脚本资源</a>的<a data-link-type="dfn" href="#dfn-policy-container"
                id="ref-for-dfn-policy-container">策略容器</a>设置为<var>policyContainer</var>。</p>
          <li data-md>
            <p>如果<var>job</var>的<a data-link-type="dfn" href="#dfn-job-force-bypass-cache-flag"
                id="ref-for-dfn-job-force-bypass-cache-flag②">强制绕过缓存标志</a>已设置，则将<var>forceBypassCache</var>设置为true，否则设置为false。
            </p>
          <li data-md>
            <p>让<var>runResult</var>成为运行<a data-link-type="dfn" href="#run-service-worker"
                id="ref-for-run-service-worker③">运行Service
                Worker</a>算法，使用<var>worker</var>和<var>forceBypassCache</var>的结果。</p>
          <li data-md>
            <p>如果<var>runResult</var>是<em>失败</em>或一个<a data-link-type="dfn"
                href="http://tc39.github.io/ecma262/#sec-completion-record-specification-type"
                id="ref-for-sec-completion-record-specification-type①">突然完成</a>，则：</p>
            <ol>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#reject-job-promise"
                    id="ref-for-reject-job-promise⑨">拒绝作业Promise</a>，使用<var>job</var>和<code>TypeError</code>。</p>
              <li data-md>
                <p>如果<var>newestWorker</var>为null，则<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#map-remove" id="ref-for-map-remove②">移除</a><a
                    data-link-type="dfn" href="#dfn-scope-to-registration-map"
                    id="ref-for-dfn-scope-to-registration-map⑤">注册映射</a>[(<var>registration</var>的<a
                    data-link-type="dfn" href="#service-worker-registration-storage-key"
                    id="ref-for-service-worker-registration-storage-key⑨">存储键</a>，<a data-link-type="dfn"
                    href="https://url.spec.whatwg.org/#concept-url-serializer"
                    id="ref-for-concept-url-serializer①①">序列化的</a><var>scopeURL</var>)。</p>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#finish-job" id="ref-for-finish-job⑧">完成作业</a>，使用<var>job</var>。</p>
            </ol>
          <li data-md>
            <p>否则，调用<a data-link-type="dfn" href="#install"
                id="ref-for-install②">安装</a>算法，使用<var>job</var>、<var>worker</var>和<var>registration</var>作为参数。</p>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Soft Update">
        <h3 class="heading settled" id="soft-update-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="soft-update">软更新</dfn></span><a class="self-link"
            href="#soft-update-algorithm"></a></h3>
        <p>用户代理<em>可以</em>随时调用此方法以检查更新。</p>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>registration</var>，一个<a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration⑤②">Service Worker 注册</a></p>
          <dd data-md>
            <p><var>forceBypassCache</var>，一个可选的布尔值，默认为 false</p>
            <p class="note" role="note"><span>注意：</span>实现者可以使用<var>forceBypassCache</var>来帮助调试（例如从开发者工具中调用），其他扩展
              Service Worker 的规范也可以根据需要使用该标志。</p>
          <dt data-md>输出
          <dd data-md>
            <p>无</p>
        </dl>
        <ol>
          <li data-md>
            <p>让<var>newestWorker</var>成为运行<a data-link-type="dfn" href="#get-newest-worker"
                id="ref-for-get-newest-worker③">获取最新 Worker</a>算法并传入<var>registration</var>作为参数的结果。</p>
          <li data-md>
            <p>如果<var>newestWorker</var>为 null，终止这些步骤。</p>
          <li data-md>
            <p>让<var>job</var>成为运行<a data-link-type="dfn" href="#create-job"
                id="ref-for-create-job③">创建作业</a>并传入<em>更新</em>、<var>registration</var>的<a data-link-type="dfn"
                href="#service-worker-registration-storage-key"
                id="ref-for-service-worker-registration-storage-key①⓪">存储键</a>、<var>registration</var>的<a
                data-link-type="dfn" href="#dfn-scope-url" id="ref-for-dfn-scope-url①④">范围 URL</a>、
              <var>newestWorker</var>的<a data-link-type="dfn" href="#dfn-script-url" id="ref-for-dfn-script-url⑥">脚本
                URL</a>、null 和 null 的结果。
            </p>
          <li data-md>
            <p>将<var>job</var>的<a data-link-type="dfn" href="#dfn-job-worker-type"
                id="ref-for-dfn-job-worker-type⑧">Worker 类型</a>设置为<var>newestWorker</var>的<a data-link-type="dfn"
                href="#dfn-type" id="ref-for-dfn-type④">类型</a>。</p>
          <li data-md>
            <p>如果<var>forceBypassCache</var>为 true，则设置<var>job</var>的<a data-link-type="dfn"
                href="#dfn-job-force-bypass-cache-flag" id="ref-for-dfn-job-force-bypass-cache-flag③">强制绕过缓存标志</a>。</p>
          <li data-md>
            <p>调用<a data-link-type="dfn" href="#schedule-job" id="ref-for-schedule-job③">安排作业</a>并传入<var>job</var>。</p>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Install">
        <h3 class="heading settled" id="installation-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="install">安装</dfn></span><a class="self-link"
            href="#installation-algorithm"></a></h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>job</var>，一个<a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job②⑥">作业</a></p>
          <dd data-md>
            <p><var>worker</var>，一个<a data-link-type="dfn" href="#dfn-service-worker"
                id="ref-for-dfn-service-worker⑨④">Service Worker</a></p>
          <dd data-md>
            <p><var>registration</var>，一个<a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration⑤③">Service Worker 注册</a></p>
          <dt data-md>输出
          <dd data-md>
            <p>无</p>
        </dl>
        <ol>
          <li data-md>
            <p>让<var>installFailed</var>为 false。</p>
          <li data-md>
            <p>让<var>newestWorker</var>成为运行<a data-link-type="dfn" href="#get-newest-worker"
                id="ref-for-get-newest-worker④">获取最新 Worker</a>算法并传入<var>registration</var>作为参数的结果。</p>
          <li data-md>
            <p>将<var>registration</var>的<a data-link-type="dfn" href="#dfn-update-via-cache"
                id="ref-for-dfn-update-via-cache⑦">通过缓存更新模式</a>设置为<var>job</var>的<a data-link-type="dfn"
                href="#dfn-job-update-via-cache-mode" id="ref-for-dfn-job-update-via-cache-mode⑤">通过缓存更新模式</a>。</p>
          <li data-md>
            <p>运行<a data-link-type="dfn" href="#update-registration-state"
                id="ref-for-update-registration-state">更新注册状态</a>算法并传入<var>registration</var>、"<code>installing</code>"
              和 <var>worker</var>作为参数。</p>
          <li data-md>
            <p>运行<a data-link-type="dfn" href="#update-worker-state" id="ref-for-update-worker-state">更新 Worker
                状态</a>算法并传入<var>registration</var>的<a data-link-type="dfn" href="#dfn-installing-worker"
                id="ref-for-dfn-installing-worker⑧">正在安装的 Worker</a>和"<code>installing</code>"作为参数。</p>
          <li data-md>
            <p class="assertion">断言：<var>job</var>的<a data-link-type="dfn" href="#dfn-job-promise"
                id="ref-for-dfn-job-promise⑥">作业 Promise</a>不为 null。</p>
          <li data-md>
            <p>调用<a data-link-type="dfn" href="#resolve-job-promise" id="ref-for-resolve-job-promise②">解析作业
                Promise</a>并传入<var>job</var>和<var>registration</var>。</p>
          <li data-md>
            <p>让<var>settingsObjects</var>成为所有<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                id="ref-for-environment-settings-object②⓪">环境设置对象</a>，其<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                id="ref-for-concept-settings-object-origin①④">源</a>是<var>registration</var>的<a data-link-type="dfn"
                href="#dfn-scope-url" id="ref-for-dfn-scope-url①⑤">范围 URL</a>的<a data-link-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin⑧">源</a>。</p>
          <li data-md>
            <p>对于<var>settingsObjects</var>中的每个<var>settingsObject</var>，<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                id="ref-for-queue-a-task②⑥">排队一个任务</a>到<var>settingsObject</var>的<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                id="ref-for-responsible-event-loop①⑤">负责的事件循环</a>中，并使用<a data-link-type="dfn">DOM 操作任务源</a>来运行以下步骤：</p>
            <ol>
              <li data-md>
                <p>让<var>registrationObjects</var>成为<var>settingsObject</var>的<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object&apos;s-realm"
                    id="ref-for-environment-settings-object&apos;s-realm⑨">域</a>中的所有<code
                    class="idl"><a data-link-type="idl" href="#serviceworkerregistration" id="ref-for-serviceworkerregistration①④">ServiceWorkerRegistration</a></code>对象，其<a
                    data-link-type="dfn" href="#serviceworkerregistration-service-worker-registration"
                    id="ref-for-serviceworkerregistration-service-worker-registration⑧">Service Worker
                    注册</a>是<var>registration</var>。</p>
              <li data-md>
                <p>对于<var>registrationObjects</var>中的每个<var>registrationObject</var>，<a data-link-type="dfn"
                    href="https://dom.spec.whatwg.org/#concept-event-fire"
                    id="ref-for-concept-event-fire①">触发一个事件</a>，名称为<code>updatefound</code>。</p>
            </ol>
          <li data-md>
            <p>让<var>installingWorker</var>成为<var>registration</var>的<a data-link-type="dfn"
                href="#dfn-installing-worker" id="ref-for-dfn-installing-worker⑨">正在安装的 Worker</a>。</p>
          <li data-md>
            <p>如果运行<a data-link-type="dfn" href="#should-skip-event"
                id="ref-for-should-skip-event①">是否应跳过事件</a>算法并传入<var>installingWorker</var>和“install”的结果为 false，则：</p>
            <ol>
              <li data-md>
                <p>如果<var>job</var>的<a data-link-type="dfn" href="#dfn-job-force-bypass-cache-flag"
                    id="ref-for-dfn-job-force-bypass-cache-flag④">强制绕过缓存标志</a>已设置，则将<var>forceBypassCache</var>设置为
                  true，否则设置为 false。</p>
              <li data-md>
                <p>如果运行<a data-link-type="dfn" href="#run-service-worker" id="ref-for-run-service-worker④">运行 Service
                    Worker</a>算法并传入<var>installingWorker</var>和<var>forceBypassCache</var>的结果是<em>失败</em>，则：</p>
                <ol>
                  <li data-md>
                    <p>将<var>installFailed</var>设置为 true。</p>
                </ol>
              <li data-md>
                <p>否则：</p>
                <ol>
                  <li data-md>
                    <p><a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                        id="ref-for-queue-a-task②⑦">排队一个任务</a> <var>task</var>到<var>installingWorker</var>的<a
                        data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop"
                        id="ref-for-event-loop⑨">事件循环</a>中，并使用<a data-link-type="dfn">DOM 操作任务源</a>来运行以下步骤：</p>
                    <ol>
                      <li data-md>
                        <p>让<var>e</var>成为<a data-link-type="dfn"
                            href="https://dom.spec.whatwg.org/#concept-event-create"
                            id="ref-for-concept-event-create②">创建事件</a>的结果，事件类型为<code
                            class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent①⑥">ExtendableEvent</a></code>。
                        </p>
                      <li data-md>
                        <p>初始化<var>e</var>的<code
                            class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-type" id="ref-for-dom-event-type">类型</a></code>属性为<code
                            class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-install-event" id="ref-for-service-worker-global-scope-install-event⑤">install</a></code>。
                        </p>
                      <li data-md>
                        <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch"
                            id="ref-for-concept-event-dispatch④">调度</a><var>e</var>到<var>installingWorker</var>的<a
                            data-link-type="dfn" href="#dfn-service-worker-global-object"
                            id="ref-for-dfn-service-worker-global-object①">全局对象</a>。</p>
                      <li data-md>
                        <p><em>等待异步扩展</em>：<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                            id="ref-for-in-parallel③⓪">并行</a>运行以下子步骤：</p>
                        <ol>
                          <li data-md>
                            <p><span id="install-settle-step">等待直到<var>e</var>不再<a data-link-type="dfn"
                                  href="#extendableevent-active" id="ref-for-extendableevent-active①">激活</a>。</span></p>
                          <li data-md>
                            <p>如果<var>e</var>的<a data-link-type="dfn" href="#extendableevent-timed-out-flag"
                                id="ref-for-extendableevent-timed-out-flag①">超时标志</a>已设置，将<var>installFailed</var>设置为
                              true。</p>
                          <li data-md>
                            <p>让<var>p</var>成为<a data-link-type="dfn"
                                href="https://webidl.spec.whatwg.org/#waiting-for-all-promise"
                                id="ref-for-waiting-for-all-promise①">等待所有承诺</a>的结果。</p>
                          <li data-md>
                            <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#upon-rejection"
                                id="ref-for-upon-rejection②">一旦被拒绝</a><var>p</var>，将<var>installFailed</var>设置为 true。
                            </p>
                        </ol>
                    </ol>
                    <p>如果<var>task</var>被丢弃，将<var>installFailed</var>设置为 true。</p>
                  <li data-md>
                    <p>等待<var>task</var>执行或被丢弃。</p>
                  <li data-md>
                    <p>等待标记为<em>等待异步扩展</em>的步骤完成。</p>
                </ol>
            </ol>
          <li data-md>
            <p>如果<var>installFailed</var>为 true，则：</p>
            <ol>
              <li data-md>
                <p>运行<a data-link-type="dfn" href="#update-worker-state" id="ref-for-update-worker-state①">更新 Worker
                    状态</a>算法并传入<var>registration</var>的<a data-link-type="dfn" href="#dfn-installing-worker"
                    id="ref-for-dfn-installing-worker①⓪">正在安装的 Worker</a>和"<code>redundant</code>"作为参数。</p>
              <li data-md>
                <p>运行<a data-link-type="dfn" href="#update-registration-state"
                    id="ref-for-update-registration-state①">更新注册状态</a>算法并传入<var>registration</var>、"<code>installing</code>"和
                  null 作为参数。</p>
              <li data-md>
                <p>如果<var>newestWorker</var>为 null，则<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#map-remove" id="ref-for-map-remove③">移除</a><a
                    data-link-type="dfn" href="#dfn-scope-to-registration-map"
                    id="ref-for-dfn-scope-to-registration-map⑥">注册映射</a>[(<var>registration</var>的<a
                    data-link-type="dfn" href="#service-worker-registration-storage-key"
                    id="ref-for-service-worker-registration-storage-key①①">存储键</a>，<a data-link-type="dfn"
                    href="https://url.spec.whatwg.org/#concept-url-serializer"
                    id="ref-for-concept-url-serializer①②">序列化的</a><var>registration</var>的<a data-link-type="dfn"
                    href="#dfn-scope-url" id="ref-for-dfn-scope-url①⑥">范围 URL</a>)。</p>
              <li data-md>
                <p>调用<a data-link-type="dfn" href="#finish-job"
                    id="ref-for-finish-job⑨">完成作业</a>并传入<var>job</var>，然后中止这些步骤。</p>
            </ol>
          <li data-md>
            <p>让<var>map</var>成为<var>registration</var>的<a data-link-type="dfn" href="#dfn-installing-worker"
                id="ref-for-dfn-installing-worker①①">正在安装的 Worker</a>的<a data-link-type="dfn"
                href="#dfn-script-resource-map" id="ref-for-dfn-script-resource-map⑤">脚本资源映射</a>。</p>
          <li data-md>
            <p>让<var>usedSet</var>成为<var>registration</var>的<a data-link-type="dfn" href="#dfn-installing-worker"
                id="ref-for-dfn-installing-worker①②">正在安装的 Worker</a>的<a data-link-type="dfn"
                href="#dfn-set-of-used-scripts" id="ref-for-dfn-set-of-used-scripts④">已使用脚本集</a>。</p>
          <li data-md>
            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate"
                id="ref-for-map-iterate⑥">对于每个</a><var>map</var>中的<var>url</var>：</p>
            <ol>
              <li data-md>
                <p>如果<var>usedSet</var>未<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain"
                    id="ref-for-list-contain">包含</a><var>url</var>，则<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#map-remove"
                    id="ref-for-map-remove④">移除</a><var>map</var>[<var>url</var>]。</p>
            </ol>
          <li data-md>
            <p>如果<var>registration</var>的<a data-link-type="dfn" href="#dfn-waiting-worker"
                id="ref-for-dfn-waiting-worker⑤">等待中的 Worker</a>不为 null，则：</p>
            <ol>
              <li data-md>
                <p><a data-link-type="dfn" href="#terminate-service-worker"
                    id="ref-for-terminate-service-worker③">终止</a><var>registration</var>的<a data-link-type="dfn"
                    href="#dfn-waiting-worker" id="ref-for-dfn-waiting-worker⑥">等待中的 Worker</a>。</p>
              <li data-md>
                <p>运行<a data-link-type="dfn" href="#update-worker-state" id="ref-for-update-worker-state②">更新 Worker
                    状态</a>算法并传入<var>registration</var>的<a data-link-type="dfn" href="#dfn-waiting-worker"
                    id="ref-for-dfn-waiting-worker⑦">等待中的 Worker</a>和"<code>redundant</code>"作为参数。</p>
            </ol>
          <li data-md>
            <p>运行<a data-link-type="dfn" href="#update-registration-state"
                id="ref-for-update-registration-state②">更新注册状态</a>算法并传入<var>registration</var>、"<code>waiting</code>"和<var>registration</var>的<a
                data-link-type="dfn" href="#dfn-installing-worker" id="ref-for-dfn-installing-worker①③">正在安装的
                Worker</a>作为参数。</p>
          <li data-md>
            <p>运行<a data-link-type="dfn" href="#update-registration-state"
                id="ref-for-update-registration-state③">更新注册状态</a>算法并传入<var>registration</var>、"<code>installing</code>"和
              null 作为参数。</p>
          <li data-md>
            <p>运行<a data-link-type="dfn" href="#update-worker-state" id="ref-for-update-worker-state③">更新 Worker
                状态</a>算法并传入<var>registration</var>的<a data-link-type="dfn" href="#dfn-waiting-worker"
                id="ref-for-dfn-waiting-worker⑧">等待中的 Worker</a>和"<code>installed</code>"作为参数。</p>
          <li data-md>
            <p>调用<a data-link-type="dfn" href="#finish-job" id="ref-for-finish-job①⓪">完成作业</a>并传入<var>job</var>。</p>
          <li data-md>
            <p>等待所有由<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task"
                id="ref-for-concept-task④">任务</a><a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                id="ref-for-queue-a-task②⑧">排队</a>的<a data-link-type="dfn" href="#update-worker-state"
                id="ref-for-update-worker-state④">更新 Worker 状态</a>算法执行。</p>
          <li data-md>
            <p>调用<a data-link-type="dfn" href="#try-activate"
                id="ref-for-try-activate②">尝试激活</a>并传入<var>registration</var>。</p>
            <p class="note" role="note"><span>注意：</span>如果<a data-link-type="dfn" href="#try-activate"
                id="ref-for-try-activate③">尝试激活</a>在此未触发<a data-link-type="dfn" href="#activate"
                id="ref-for-activate③">激活</a>，则当现有的<a data-link-type="dfn" href="#dfn-active-worker"
                id="ref-for-dfn-active-worker②⓪">活动 Worker</a>控制的最后一个客户端<a data-link-type="dfn"
                href="#handle-service-worker-client-unload"
                id="ref-for-handle-service-worker-client-unload①">卸载</a>时，<code
                class="idl"><a data-link-type="idl" href="#dom-serviceworkerglobalscope-skipwaiting" id="ref-for-dom-serviceworkerglobalscope-skipwaiting③">skipWaiting()</a></code>异步调用，或现有的<a
                data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker②①">活动 Worker</a>的<a
                data-link-type="dfn" href="#extendableevent-extend-lifetime-promises"
                id="ref-for-extendableevent-extend-lifetime-promises⑦">延长生命周期承诺</a>完成时，<a data-link-type="dfn"
                href="#activate" id="ref-for-activate④">激活</a>会再次被尝试。</p>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Activate">
        <h3 class="heading settled" id="activation-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="activate">激活</dfn></span><a class="self-link"
            href="#activation-algorithm"></a></h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>registration</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration⑤④">服务工作线程注册</a></p>
          <dt data-md>输出
          <dd data-md>
            <p>无</p>
        </dl>
        <ol>
          <li data-md>
            <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-waiting-worker"
                id="ref-for-dfn-waiting-worker⑨">等待中的工作线程</a> 为空，则中止这些步骤。</p>
          <li data-md>
            <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                id="ref-for-dfn-active-worker②②">活动工作线程</a> 不为空，则：</p>
            <ol>
              <li data-md>
                <p><a data-link-type="dfn" href="#terminate-service-worker"
                    id="ref-for-terminate-service-worker④">终止</a> <var>registration</var> 的 <a data-link-type="dfn"
                    href="#dfn-active-worker" id="ref-for-dfn-active-worker②③">活动工作线程</a>。</p>
              <li data-md>
                <p>运行 <a data-link-type="dfn" href="#update-worker-state" id="ref-for-update-worker-state⑤">更新工作线程状态</a>
                  算法，传入 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                    id="ref-for-dfn-active-worker②④">活动工作线程</a> 和
                  "<code>冗余</code>" 作为参数。</p>
            </ol>
          <li data-md>
            <p>运行 <a data-link-type="dfn" href="#update-registration-state"
                id="ref-for-update-registration-state④">更新注册状态</a> 算法，传入 <var>registration</var>、"<code>活动</code>" 和
              <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-waiting-worker"
                id="ref-for-dfn-waiting-worker①⓪">等待中的工作线程</a> 作为参数。
            </p>
          <li data-md>
            <p>运行 <a data-link-type="dfn" href="#update-registration-state"
                id="ref-for-update-registration-state⑤">更新注册状态</a> 算法，传入 <var>registration</var>、"<code>等待</code>" 和
              null
              作为参数。</p>
          <li data-md>
            <p>运行 <a data-link-type="dfn" href="#update-worker-state" id="ref-for-update-worker-state⑥">更新工作线程状态</a>
              算法，传入 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                id="ref-for-dfn-active-worker②⑤">活动工作线程</a> 和
              "<code>激活中</code>" 作为参数。</p>
            <p class="note" role="note"><span>注意：</span> 一旦活动工作线程正在激活，即使发生运行时脚本错误或强制终止活动工作线程，也不会阻止活动工作线程激活。</p>
            <p class="note" role="note"><span>注意：</span>
              确保设计激活处理程序以执行非关键任务（如清理）。这是因为激活处理程序可能无法全部运行完毕，尤其是在激活期间浏览器终止的情况下。服务工作线程应设计为即使激活处理程序未完全成功完成，也能正常运行。</p>
          <li data-md>
            <p>让 <var>matchedClients</var> 成为 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                id="ref-for-list①⑨">列表</a>，其中包含所有 <a data-link-type="dfn" href="#dfn-service-worker-client"
                id="ref-for-dfn-service-worker-client③⑨">服务工作线程客户端</a>，其 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url"
                id="ref-for-concept-environment-creation-url⑦">创建 URL</a> 与 <var>registration</var> 的 <a
                data-link-type="dfn" href="#service-worker-registration-storage-key"
                id="ref-for-service-worker-registration-storage-key①②">存储键</a> 和 <var>registration</var> 的 <a
                data-link-type="dfn" href="#dfn-scope-url" id="ref-for-dfn-scope-url①⑦">范围 URL</a> 匹配。</p>
          <li data-md>
            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                id="ref-for-list-iterate①②">对于每个</a> <var>matchedClients</var> 中的 <var>client</var>，<a
                data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                id="ref-for-queue-a-task②⑨">排队一个任务</a> 到 <var>client</var> 的 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                id="ref-for-responsible-event-loop①⑥">负责的事件循环</a> 中，使用 <a data-link-type="dfn">DOM 操作任务源</a>，以运行以下子步骤：
            </p>
            <ol>
              <li data-md>
                <p>让 <var>readyPromise</var> 成为 <var>client</var> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                    id="ref-for-concept-settings-object-global⑨">全局对象</a> 的 <code
                    class="idl"><a data-link-type="idl" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer①⑤">ServiceWorkerContainer</a></code>
                  对象的 <a data-link-type="dfn" href="#serviceworkercontainer-ready-promise"
                    id="ref-for-serviceworkercontainer-ready-promise④">就绪承诺</a>。</p>
              <li data-md>
                <p>如果 <var>readyPromise</var> 为空，则 <a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue⑧">继续</a>。
                </p>
              <li data-md>
                <p><span id="activate-resolve-ready-step">如果 <var>readyPromise</var> 处于待定状态，则使用通过 <a
                      data-link-type="dfn" href="#get-the-service-worker-registration-object"
                      id="ref-for-get-the-service-worker-registration-object⑥">获取表示</a> <var>registration</var>
                    的服务工作线程注册对象的结果，来解析 <var>readyPromise</var>。</span></p>
            </ol>
          <li data-md>
            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                id="ref-for-list-iterate①③">对于每个</a> <var>matchedClients</var> 中的 <var>client</var>：</p>
            <ol>
              <li data-md>
                <p>如果 <var>client</var> 是 <a data-link-type="dfn" href="#dfn-window-client"
                    id="ref-for-dfn-window-client①③">窗口客户端</a>，将 <var>client</var> 的 <a data-link-type="dfn">负责的文档</a>
                  与其 <a data-link-type="dfn">应用缓存</a> 解除关联（如果有）。</p>
              <li data-md>
                <p>否则，如果 <var>client</var> 是 <a data-link-type="dfn" href="#dfn-sharedworker-client"
                    id="ref-for-dfn-sharedworker-client③">共享工作线程客户端</a>，将 <var>client</var> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                    id="ref-for-concept-settings-object-global①⓪">全局对象</a> 与其 <a data-link-type="dfn">应用缓存</a>
                  解除关联（如果有）。</p>
            </ol>
            <p class="note" role="note"><span>注意：</span> 资源现在将使用服务工作线程注册，而不是现有的应用缓存。</p>
          <li data-md>
            <p>对于每个 <a data-link-type="dfn" href="#dfn-service-worker-client"
                id="ref-for-dfn-service-worker-client④⓪">服务工作线程客户端</a> <var>client</var>，其 <a data-link-type="dfn"
                href="#dfn-use" id="ref-for-dfn-use②">正在使用</a> <var>registration</var>：</p>
            <ol>
              <li data-md>
                <p>将 <var>client</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                    id="ref-for-dfn-active-worker②⑥">活动工作线程</a> 设置为 <var>registration</var> 的 <a data-link-type="dfn"
                    href="#dfn-active-worker" id="ref-for-dfn-active-worker②⑦">活动工作线程</a>。</p>
              <li data-md>
                <p>调用 <a data-link-type="dfn" href="#notify-controller-change"
                    id="ref-for-notify-controller-change①">通知控制器变更</a> 算法，将 <var>client</var> 作为参数。</p>
            </ol>
          <li data-md>
            <p>让 <var>activeWorker</var> 成为 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                id="ref-for-dfn-active-worker②⑧">活动工作线程</a>。</p>
          <li data-md>
            <p>如果运行 <a data-link-type="dfn" href="#should-skip-event" id="ref-for-should-skip-event②">是否应跳过事件</a> 算法的结果为
              <var>activeWorker</var> 和 "activate" 为 false，则：
            </p>
            <ol>
              <li data-md>
                <p>如果运行 <a data-link-type="dfn" href="#run-service-worker" id="ref-for-run-service-worker⑤">运行服务工作线程</a>
                  算法的结果为 <var>activeWorker</var> 不是 <em>失败</em>，则：</p>
                <ol>
                  <li data-md>
                    <p><a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                        id="ref-for-queue-a-task③⓪">排队一个任务</a> <var>task</var> 到 <var>activeWorker</var> 的 <a
                        data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop"
                        id="ref-for-event-loop①⓪">事件循环</a> 中，使用 <a data-link-type="dfn">DOM 操作任务源</a>，以运行以下步骤：</p>
                    <ol>
                      <li data-md>
                        <p>让 <var>e</var> 成为 <a data-link-type="dfn"
                            href="https://dom.spec.whatwg.org/#concept-event-create"
                            id="ref-for-concept-event-create③">创建一个事件</a> 的结果，其类型为 <code
                            class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent①⑦">ExtendableEvent</a></code>。
                        </p>
                      <li data-md>
                        <p>将 <var>e</var> 的 <code
                            class="idl"><a data-link-type="idl"
                              href="https://dom.spec.whatwg.org/#dom-event-type" id="ref-for-dom-event-type①">type</a></code>
                          属性初始化为 <code class="idl"><a class="idl-code" data-link-type="event"
                              href="#service-worker-global-scope-activate-event"
                              id="ref-for-service-worker-global-scope-activate-event⑤">activate</a></code>。</p>
                      <li data-md>
                        <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch"
                            id="ref-for-concept-event-dispatch⑤">分派</a> <var>e</var> 到 <var>activeWorker</var> 的 <a
                            data-link-type="dfn" href="#dfn-service-worker-global-object"
                            id="ref-for-dfn-service-worker-global-object②">全局对象</a>。</p>
                      <li data-md>
                        <p><span id="activate-settle-step"><em>等待异步扩展</em>：等待，<a data-link-type="dfn"
                              href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                              id="ref-for-in-parallel③①">并行</a>，直到 <var>e</var> 不再 <a data-link-type="dfn"
                              href="#extendableevent-active" id="ref-for-extendableevent-active②">活跃</a>。</span></p>
                    </ol>
                  <li data-md>
                    <p>等待 <var>task</var> 执行或被丢弃。</p>
                  <li data-md>
                    <p>等待标记为 <em>等待异步扩展</em> 的步骤完成。</p>
                </ol>
            </ol>
          <li data-md>
            <p>运行 <a data-link-type="dfn" href="#update-worker-state" id="ref-for-update-worker-state⑦">更新工作线程状态</a>
              算法，传入 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                id="ref-for-dfn-active-worker②⑨">活动工作线程</a> 和 "<code>激活</code>" 作为参数。</p>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Try Activate">
        <h3 class="heading settled" id="try-activate-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="try-activate">尝试激活</dfn></span><a class="self-link"
            href="#try-activate-algorithm"></a></h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>registration</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration⑤⑤">服务工作线程注册</a></p>
          <dt data-md>输出
          <dd data-md>
            <p>无</p>
        </dl>
        <ol>
          <li data-md>
            <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-waiting-worker"
                id="ref-for-dfn-waiting-worker①①">等待中的工作线程</a> 为空，则返回。</p>
          <li data-md>
            <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                id="ref-for-dfn-active-worker③⓪">活动工作线程</a> 不为空且 <var>registration</var> 的 <a data-link-type="dfn"
                href="#dfn-active-worker" id="ref-for-dfn-active-worker③①">活动工作线程</a> 的 <a data-link-type="dfn">状态</a> 为
              "<code>激活中</code>"，则返回。</p>
            <p class="note" role="note"><span>注意：</span> 如果现有的活动工作线程仍处于激活状态，则等待工作线程的激活将被延迟。</p>
          <li data-md>
            <p>调用 <a data-link-type="dfn" href="#activate" id="ref-for-activate⑤">激活</a>，传入
              <var>registration</var>，如果以下任一情况为真：
            </p>
            <ul>
              <li data-md>
                <p><var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                    id="ref-for-dfn-active-worker③②">活动工作线程</a> 为空。</p>
              <li data-md>
                <p>运行 <a data-link-type="dfn" href="#service-worker-has-no-pending-events"
                    id="ref-for-service-worker-has-no-pending-events①">服务工作线程没有挂起的事件</a> 算法的结果为 <var>registration</var>
                  的 <a data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker③③">活动工作线程</a> 为
                  true，并且没有 <a data-link-type="dfn" href="#dfn-service-worker-client"
                    id="ref-for-dfn-service-worker-client④①">服务工作线程客户端</a> <a data-link-type="dfn" href="#dfn-use"
                    id="ref-for-dfn-use③">正在使用</a> <var>registration</var> 或 <var>registration</var> 的 <a
                    data-link-type="dfn" href="#dfn-waiting-worker" id="ref-for-dfn-waiting-worker①②">等待中的工作线程</a> 的 <a
                    data-link-type="dfn" href="#dfn-skip-waiting-flag" id="ref-for-dfn-skip-waiting-flag②">跳过等待标志</a>
                  已设置。</p>
            </ul>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Run Service Worker">
        <h3 class="heading settled" id="run-service-worker-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="run-service-worker">运行服务工作线程</dfn></span><a class="self-link"
            href="#run-service-worker-algorithm"></a></h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>serviceWorker</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker"
                id="ref-for-dfn-service-worker⑨⑤">服务工作线程</a></p>
          <dd data-md>
            <p><var>forceBypassCache</var>，一个可选布尔值，默认为 false</p>
          <dt data-md>输出
          <dd data-md>
            <p>一个 <a data-link-type="dfn" href="http://tc39.github.io/ecma262/#sec-completion-record-specification-type"
                id="ref-for-sec-completion-record-specification-type②">完成记录</a> 或 <em>失败</em></p>
        </dl>
        <p class="note" role="note"><span>注意：</span> 此算法会阻塞，直到服务工作线程 <a data-link-type="dfn"
            href="#service-worker-running" id="ref-for-service-worker-running">运行</a> 或启动失败。</p>
        <ol>
          <li data-md>
            <p>让 <var>unsafeCreationTime</var> 成为 <a data-link-type="dfn"
                href="https://www.w3.org/TR/hr-time-3/#dfn-unsafe-shared-current-time"
                id="ref-for-dfn-unsafe-shared-current-time">不安全的共享当前时间</a>。</p>
          <li data-md>
            <p>如果 <var>serviceWorker</var> 正在 <a data-link-type="dfn" href="#service-worker-running"
                id="ref-for-service-worker-running①">运行</a>，则返回 <var>serviceWorker</var> 的 <a data-link-type="dfn"
                href="#service-worker-start-status" id="ref-for-service-worker-start-status">启动状态</a>。</p>
          <li data-md>
            <p>如果 <var>serviceWorker</var> 的 <a data-link-type="dfn">状态</a> 为 "<code>冗余</code>"，则返回 <em>失败</em>。</p>
          <li data-md>
            <p class="assertion">断言：<var>serviceWorker</var> 的 <a data-link-type="dfn"
                href="#service-worker-start-status" id="ref-for-service-worker-start-status①">启动状态</a> 为 null。</p>
          <li data-md>
            <p>让 <var>script</var> 成为 <var>serviceWorker</var> 的 <a data-link-type="dfn" href="#dfn-script-resource"
                id="ref-for-dfn-script-resource⑥">脚本资源</a>。</p>
          <li data-md>
            <p class="assertion">断言：<var>script</var> 不为 null。</p>
          <li data-md>
            <p>让 <var>startFailed</var> 为 false。</p>
          <li data-md>
            <p>让 <var>agent</var> 成为 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#obtain-a-service-worker-agent"
                id="ref-for-obtain-a-service-worker-agent">获取服务工作线程代理</a> 的结果，并在该上下文中运行以下步骤：</p>
            <ol>
              <li data-md>
                <p>让 <var>realmExecutionContext</var> 成为 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#creating-a-new-javascript-realm"
                    id="ref-for-creating-a-new-javascript-realm">创建新 JavaScript 域</a> 的结果，给定 <var>agent</var> 和以下定制项：
                </p>
                <ul>
                  <li data-md>
                    <p>对于全局对象，创建一个新的 <code class="idl"><a data-link-type="idl" href="#serviceworkerglobalscope"
                        id="ref-for-serviceworkerglobalscope①⑥">ServiceWorkerGlobalScope</a></code> 对象。让
                      <var>workerGlobalScope</var> 成为创建的对象。
                    </p>
                </ul>
              <li data-md>
                <p>将 <var>serviceWorker</var> 的 <a data-link-type="dfn" href="#dfn-service-worker-global-object"
                    id="ref-for-dfn-service-worker-global-object③">全局对象</a> 设置为 <var>workerGlobalScope</var>。</p>
              <li data-md>
                <p>让 <var>settingsObject</var> 成为一个新的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                    id="ref-for-environment-settings-object②①">环境设置对象</a>，其算法定义如下：</p>
                <dl>
                  <dt data-md><a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#realm-execution-context"
                      id="ref-for-realm-execution-context">域执行上下文</a>
                  <dd data-md>
                    <p>返回 <var>realmExecutionContext</var>。</p>
                  <dt data-md><a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-module-map"
                      id="ref-for-concept-settings-object-module-map">模块映射</a>
                  <dd data-md>
                    <p>返回 <var>workerGlobalScope</var> 的 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-module-map"
                        id="ref-for-concept-workerglobalscope-module-map">模块映射</a>。</p>
                  <dt data-md><a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#api-url-character-encoding"
                      id="ref-for-api-url-character-encoding">API URL 字符编码</a>
                  <dd data-md>
                    <p>返回 <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8"
                        id="ref-for-utf-8">UTF-8</a>。</p>
                  <dt data-md><a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url"
                      id="ref-for-api-base-url⑤">API 基础 URL</a>
                  <dd data-md>
                    <p>返回 <var>serviceWorker</var> 的 <a data-link-type="dfn" href="#dfn-script-url"
                        id="ref-for-dfn-script-url⑦">脚本 URL</a>。</p>
                  <dt data-md><a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                      id="ref-for-concept-settings-object-origin①⑤">源</a>
                  <dd data-md>
                    <p>返回其注册的 <a data-link-type="dfn" href="#dfn-service-worker-client"
                        id="ref-for-dfn-service-worker-client④②">服务工作线程客户端</a> 的 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                        id="ref-for-concept-settings-object-origin①⑥">源</a>。</p>
                  <dt data-md><a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-policy-container"
                      id="ref-for-concept-settings-object-policy-container">策略容器</a>
                  <dd data-md>
                    <p>返回 <var>workerGlobalScope</var> 的 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-policy-container"
                        id="ref-for-concept-workerglobalscope-policy-container">策略容器</a>。</p>
                  <dt data-md><a data-link-type="dfn"
                      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin"
                      id="ref-for-concept-settings-object-time-origin">时间原点</a>
                  <dd data-md>
                    <p>返回 <a data-link-type="dfn" href="https://www.w3.org/TR/hr-time-3/#dfn-coarsen-time"
                        id="ref-for-dfn-coarsen-time">粗化</a>后的 <var>unsafeCreationTime</var> 结果，给定
                      <var>workerGlobalScope</var> 的 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-cross-origin-isolated-capability"
                        id="ref-for-concept-workerglobalscope-cross-origin-isolated-capability">跨源隔离能力</a>。
                    </p>
                </dl>
              <li data-md>
                <p>将 <var>settingsObject</var> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-id"
                    id="ref-for-concept-environment-id②">id</a> 设置为一个新的唯一不透明字符串，<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url"
                    id="ref-for-concept-environment-creation-url⑧">创建 URL</a> 设置为 <var>serviceWorker</var> 的 <a
                    data-link-type="dfn" href="#dfn-script-url" id="ref-for-dfn-script-url⑧">脚本 URL</a>，<a
                    data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-creation-url"
                    id="ref-for-concept-environment-top-level-creation-url">顶级创建 URL</a> 设置为 null，<a
                    data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin"
                    id="ref-for-concept-environment-top-level-origin">顶级源</a> 设置为一个 <a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#implementation-defined"
                    id="ref-for-implementation-defined">实现定义的</a>值，<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context"
                    id="ref-for-concept-environment-target-browsing-context①">目标浏览上下文</a> 设置为 null，并且 <a
                    data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
                    id="ref-for-concept-environment-active-service-worker②⑤">活动服务工作线程</a> 设置为 null。</p>
              <li data-md>
                <p>将 <var>workerGlobalScope</var> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-url"
                    id="ref-for-concept-workerglobalscope-url">URL</a> 设置为 <var>serviceWorker</var> 的 <a
                    data-link-type="dfn" href="#dfn-script-url" id="ref-for-dfn-script-url⑨">脚本 URL</a>。</p>
              <li data-md>
                <p>将 <var>workerGlobalScope</var> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-policy-container"
                    id="ref-for-concept-workerglobalscope-policy-container①">策略容器</a> 设置为 <var>serviceWorker</var> 的 <a
                    data-link-type="dfn" href="#dfn-script-resource" id="ref-for-dfn-script-resource⑦">脚本资源</a> 的 <a
                    data-link-type="dfn" href="#dfn-policy-container" id="ref-for-dfn-policy-container①">策略容器</a>。</p>
              <li data-md>
                <p>将 <var>workerGlobalScope</var> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-type"
                    id="ref-for-concept-workerglobalscope-type">类型</a> 设置为 <var>serviceWorker</var> 的 <a
                    data-link-type="dfn" href="#dfn-type" id="ref-for-dfn-type⑤">类型</a>。</p>
              <li data-md>
                <p>如果 <var>forceBypassCache</var> 为 true，则设置 <var>workerGlobalScope</var> 的 <a data-link-type="dfn"
                    href="#serviceworkerglobalscope-force-bypass-cache-for-import-scripts-flag"
                    id="ref-for-serviceworkerglobalscope-force-bypass-cache-for-import-scripts-flag①">强制绕过导入脚本的缓存标志</a>。
                </p>
              <li data-md>
                <p>创建一个新的 <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerlocation"
                    id="ref-for-workerlocation">WorkerLocation</a></code> 对象并将其与 <var>workerGlobalScope</var> 关联。</p>
              <li data-md>
                <p>如果 <a data-link-type="dfn">为全局对象运行 CSP 初始化</a> 的算法在对 <var>workerGlobalScope</var> 执行时返回了
                  "<code>阻止</code>"，则将 <var>startFailed</var> 设置为 true 并中止这些步骤。</p>
              <li data-md>
                <p>如果 <var>serviceWorker</var> 是一个 <a data-link-type="dfn" href="#dfn-active-worker"
                    id="ref-for-dfn-active-worker③④">活动工作线程</a>，并且 <var>serviceWorker</var> 的 <a data-link-type="dfn"
                    href="#dfn-containing-service-worker-registration"
                    id="ref-for-dfn-containing-service-worker-registration①⑥">包含服务工作线程注册</a> 的任务队列中有任何任务
                  <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                    id="ref-for-queue-a-task③①">排队</a>到 <var>serviceWorker</var> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop"
                    id="ref-for-event-loop①①">事件循环</a> 的任务队列中，按照原来的顺序使用它们的原始任务源重新排队。
                </p>
              <li data-md>
                <p>让 <var>evaluationStatus</var> 为 null。</p>
              <li data-md>
                <p>如果 <var>script</var> 是一个 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#classic-script"
                    id="ref-for-classic-script">经典脚本</a>，则：</p>
                <ol>
                  <li data-md>
                    <p>将 <var>evaluationStatus</var> 设置为 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#run-a-classic-script"
                        id="ref-for-run-a-classic-script">运行经典脚本</a> <var>script</var> 的结果。</p>
                  <li data-md>
                    <p>如果 <var>evaluationStatus</var>.[[Value]] 为空，这意味着脚本没有被评估。将 <var>startFailed</var> 设置为 true
                      并中止这些步骤。</p>
                </ol>
              <li data-md>
                <p>否则，如果 <var>script</var> 是一个 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#module-script"
                    id="ref-for-module-script">模块脚本</a>，则：</p>
                <ol>
                  <li data-md>
                    <p>让 <var>evaluationPromise</var> 成为 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#run-a-module-script"
                        id="ref-for-run-a-module-script">运行模块脚本</a> <var>script</var> 的结果，并将报告错误设置为 false。</p>
                  <li data-md>
                    <p class="assertion">断言：<var>evaluationPromise</var>.[[PromiseState]] 不是 "pending"。</p>
                  <li data-md>
                    <p>如果 <var>evaluationPromise</var>.[[PromiseState]] 是 "rejected"：</p>
                    <ol>
                      <li data-md>
                        <p>将 <var>evaluationStatus</var> 设置为 <a data-link-type="abstract-op"
                            href="http://tc39.github.io/ecma262/#sec-throwcompletion"
                            id="ref-for-sec-throwcompletion">ThrowCompletion</a>(<var>evaluationPromise</var>.[[PromiseResult]])。
                        </p>
                    </ol>
                  <li data-md>
                    <p>否则：</p>
                    <ol>
                      <li data-md>
                        <p>将 <var>evaluationStatus</var> 设置为 <a data-link-type="abstract-op"
                            href="http://tc39.github.io/ecma262/#sec-normalcompletion"
                            id="ref-for-sec-normalcompletion">NormalCompletion</a>(undefined)。</p>
                    </ol>
                </ol>
              <li data-md>
                <p>如果脚本因 <a data-link-type="dfn" href="#terminate-service-worker"
                    id="ref-for-terminate-service-worker⑤">终止服务工作线程</a> 算法而中止，将 <var>startFailed</var> 设置为 true 并中止这些步骤。
                </p>
              <li data-md>
                <p>将 <var>serviceWorker</var> 的 <a data-link-type="dfn" href="#service-worker-start-status"
                    id="ref-for-service-worker-start-status②">启动状态</a> 设置为 <var>evaluationStatus</var>。</p>
              <li data-md>
                <p>如果 <var>script</var> 的 <a data-link-type="dfn" href="#dfn-has-ever-been-evaluated-flag"
                    id="ref-for-dfn-has-ever-been-evaluated-flag">曾被评估标志</a> 未设置，则：</p>
                <ol>
                  <li data-md>
                    <p>对于 <var>settingsObject</var> 的 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                        id="ref-for-concept-settings-object-global①①">全局对象</a> 关联的事件监听器列表中的每个 <var>eventType</var>：</p>
                    <ol>
                      <li data-md>
                        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append"
                            id="ref-for-set-append②">追加</a> <var>eventType</var> 到 <var>workerGlobalScope</var> 关联的 <a
                            data-link-type="dfn" href="#serviceworkerglobalscope-service-worker"
                            id="ref-for-serviceworkerglobalscope-service-worker②④">服务工作线程</a> 的 <a data-link-type="dfn"
                            href="#dfn-set-of-event-types-to-handle"
                            id="ref-for-dfn-set-of-event-types-to-handle">处理的事件类型集合</a> 中。</p>
                    </ol>
                    <p class="note" role="note"><span>注意：</span>
                      如果全局对象关联的事件监听器列表此时没有添加任何事件监听器，则服务工作线程的处理事件类型集合将保持为空集合。鼓励用户代理显示警告，提醒必须在第一次评估工作线程脚本时添加事件监听器。</p>
                  <li data-md>
                    <p>设置 <var>script</var> 的 <a data-link-type="dfn" href="#dfn-has-ever-been-evaluated-flag"
                        id="ref-for-dfn-has-ever-been-evaluated-flag①">曾被评估标志</a>。</p>
                </ol>
              <li data-md>
                <p>运行 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                    id="ref-for-responsible-event-loop①⑦">由 <var>settingsObject</var> 指定的责任事件循环</a>，直到其被销毁。</p>
              <li data-md>
                <p>清空 <var>workerGlobalScope</var> 的 <a data-link-type="dfn">活动计时器列表</a>。</p>
            </ol>
          <li data-md>
            <p>等待 <var>serviceWorker</var> 进入 <a data-link-type="dfn" href="#service-worker-running"
                id="ref-for-service-worker-running②">运行</a> 状态，或等待 <var>startFailed</var> 为 true。</p>
          <li data-md>
            <p>如果 <var>startFailed</var> 为 true，则返回 <em>失败</em>。</p>
          <li data-md>
            <p>返回 <var>serviceWorker</var> 的 <a data-link-type="dfn" href="#service-worker-start-status"
                id="ref-for-service-worker-start-status③">启动状态</a>。</p>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Terminate Service Worker">
        <h3 class="heading settled" id="terminate-service-worker-algorithm"><span class="content"><dfn
              class="dfn-paneled" data-dfn-type="dfn" data-noexport
              id="terminate-service-worker">终止服务工作线程</dfn></span><a class="self-link"
            href="#terminate-service-worker-algorithm"></a></h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>serviceWorker</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker"
                id="ref-for-dfn-service-worker⑨⑥">服务工作线程</a></p>
          <dt data-md>输出
          <dd data-md>
            <p>无</p>
        </dl>
        <ol>
          <li data-md>
            <p>与 <var>serviceWorker</var> 的主循环 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                id="ref-for-in-parallel③②">并行</a> 运行以下步骤：</p>
            <ol>
              <li data-md>
                <p>让 <var>serviceWorkerGlobalScope</var> 成为 <var>serviceWorker</var> 的 <a data-link-type="dfn"
                    href="#dfn-service-worker-global-object" id="ref-for-dfn-service-worker-global-object④">全局对象</a>。
                </p>
              <li data-md>
                <p>设置 <var>serviceWorkerGlobalScope</var> 的 <a data-link-type="dfn">关闭</a> 标志为 true。</p>
              <li data-md>
                <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove"
                    id="ref-for-list-remove">移除</a> <var>serviceWorker</var> 的 <a data-link-type="dfn"
                    href="#dfn-set-of-extended-events" id="ref-for-dfn-set-of-extended-events">扩展事件集合</a> 中的所有项。</p>
              <li data-md>
                <p>如果有任何任务（其 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#task-source"
                    id="ref-for-task-source⑥">任务源</a> 是 <a data-link-type="dfn" href="#dfn-handle-fetch-task-source"
                    id="ref-for-dfn-handle-fetch-task-source①">处理获取任务源</a> 或 <a data-link-type="dfn"
                    href="#dfn-handle-functional-event-task-source"
                    id="ref-for-dfn-handle-functional-event-task-source①">处理功能事件任务源</a>），在
                  <var>serviceWorkerGlobalScope</var>
                  的 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop"
                    id="ref-for-event-loop①②">事件循环</a> 的任务队列中排队，请按照其原始任务源将它们 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                    id="ref-for-queue-a-task③②">排队</a> 到 <var>serviceWorker</var> 的 <a data-link-type="dfn"
                    href="#dfn-containing-service-worker-registration"
                    id="ref-for-dfn-containing-service-worker-registration①⑦">包含服务工作线程注册</a> 的相应任务队列中，并丢弃
                  <var>serviceWorkerGlobalScope</var> 事件循环的任务队列中的所有任务（包括任务源既不是处理获取任务源也不是处理功能事件任务源的任务）。
                </p>
                <p class="note" role="note"><span>注意：</span> 这意味着获取事件和其他功能事件（如推送事件）将由注册的任务队列备份，而其他任务（包括消息事件）将被丢弃。</p>
              <li data-md>
                <p><a data-link-type="dfn">中止脚本</a> 当前正在 <var>serviceWorker</var> 中运行。</p>
              <li data-md>
                <p>将 <var>serviceWorker</var> 的 <a data-link-type="dfn" href="#service-worker-start-status"
                    id="ref-for-service-worker-start-status④">启动状态</a> 设置为 null。</p>
            </ol>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Handle Fetch">
        <h3 class="heading settled" id="on-fetch-request-algorithm">
          <span class="content">
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="handle-fetch">处理获取</dfn>
          </span>
          <a class="self-link" href="#on-fetch-request-algorithm"></a>
        </h3>
        <div class="mdn-anno wrapped after">
          <button class="mdn-anno-btn">
            <b class="all-engines-flag" title="此功能在所有当前引擎中。">✔</b>
            <span>MDN</span>
          </button>
          <div class="feature">
            <p>
              <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Service-Worker-Navigation-Preload"
                title="Service-Worker-Navigation-Preload 请求头表明该请求是在服务工作线程导航预加载期间由 fetch() 操作生成的。它允许服务器响应与正常获取不同的资源。">
                Headers/Service-Worker-Navigation-Preload
              </a>
            </p>
            <p class="all-engines-text">在所有当前引擎中。</p>
            <div class="support">
              <span class="firefox yes"><span>Firefox</span><span>preview+</span></span>
              <span class="safari yes"><span>Safari</span><span>15.4+</span></span>
              <span class="chrome yes"><span>Chrome</span><span>59+</span></span>
              <hr>
              <span class="opera yes"><span>Opera</span><span>46+</span></span>
              <span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
              <hr>
              <span class="edge yes"><span>Edge (Legacy)</span><span>18</span></span>
              <span class="ie no"><span>IE</span><span>None</span></span>
              <hr>
              <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span>
              <span class="safari_ios yes"><span>iOS Safari</span><span>15.4+</span></span>
              <span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span>
              <span class="webview_android yes"><span>Android WebView</span><span>59+</span></span>
              <span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span>
              <span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
            </div>
          </div>
        </div>
        <p>
          <a data-link-type="dfn" href="#handle-fetch" id="ref-for-handle-fetch⑦">处理获取</a>算法是处理传递到
          <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
            id="ref-for-concept-fetch①⑤">fetch</a>
          处理的入口点，并传递到
          <a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker⑨⑦">服务工作线程</a>上下文。
        </p>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>request</var>，一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                id="ref-for-concept-request⑥">请求</a></p>
          <dd data-md>
            <p><var>controller</var>，一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#fetch-controller"
                id="ref-for-fetch-controller">获取控制器</a></p>
          <dd data-md>
            <p><var>useHighResPerformanceTimers</var>，一个布尔值</p>
          <dt data-md>输出
          <dd data-md>
            <p><var>response</var>，一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
                id="ref-for-concept-response⑨">响应</a></p>
        </dl>
        <ol>
          <li data-md>
            <p>设 <var>handleFetchFailed</var> 为 false。</p>
          <li data-md>
            <p>设 <var>respondWithEntered</var> 为 false。</p>
          <li data-md>
            <p>设 <var>eventCanceled</var> 为 false。</p>
          <li data-md>
            <p>设 <var>response</var> 为 null。</p>
          <li data-md>
            <p>设 <var>registration</var> 为 null。</p>
          <li data-md>
            <p>设 <var>client</var> 为 <var>request</var> 的 <a data-link-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-request-client"
                id="ref-for-concept-request-client③">客户端</a>。
            </p>
          <li data-md>
            <p>设 <var>reservedClient</var> 为 <var>request</var> 的 <a data-link-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-request-reserved-client"
                id="ref-for-concept-request-reserved-client">预留客户端</a>。</p>
          <li data-md>
            <p>设 <var>preloadResponse</var> 为一个新的
              <a data-link-type="dfn" href="http://tc39.github.io/ecma262/#sec-promise-objects"
                id="ref-for-sec-promise-objects②⑨">Promise</a>。
            </p>
          <li data-md>
            <p>设 <var>workerRealm</var> 为 null。</p>
          <li data-md>
            <p>设 <var>eventHandled</var> 为 null。</p>
          <li data-md>
            <p>设 <var>timingInfo</var> 为一个新的
              <a data-link-type="dfn" href="#service-worker-timing-info"
                id="ref-for-service-worker-timing-info">服务工作线程计时信息</a>。
            </p>
          <li data-md>
            <p>设 <var>fetchInstance</var> 为表示正在进行的获取操作的
              <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
                id="ref-for-concept-fetch①⑥">获取算法</a>的实例。
            </p>
          <li data-md>
            <p class="assertion">断言：<var>request</var> 的 <a data-link-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-request-destination"
                id="ref-for-concept-request-destination②">目标</a> 不是 "<code>serviceworker</code>"。</p>
          <li data-md>
            <p>如果 <var>request</var> 的 <a data-link-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-request-destination"
                id="ref-for-concept-request-destination③">目标</a> 是 "<code>embed</code>" 或 "<code>object</code>"，则：</p>
            <ol>
              <li data-md>
                <p>返回 null。</p>
            </ol>
          <li data-md>
            <p>否则，如果 <var>request</var> 是一个
              <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#non-subresource-request"
                id="ref-for-non-subresource-request">非子资源请求</a>，
              则：
            </p>
            <p class="note" role="note"><span>注意：</span>如果非子资源请求属于服务工作线程注册范围内，则无论该请求是否使用了服务工作线程注册，应用程序缓存都将完全绕过。</p>
            <ol>
              <li data-md>
                <p>如果 <var>reservedClient</var> 不为 null 并且是一个
                  <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                    id="ref-for-environment-settings-object②②">环境设置对象</a>，
                  则：
                </p>
                <ol>
                  <li data-md>
                    <p>如果 <var>reservedClient</var> 不是
                      <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context"
                        id="ref-for-secure-context④">安全上下文</a>，
                      则返回 null。
                    </p>
                </ol>
              <li data-md>
                <p>否则：</p>
                <ol>
                  <li data-md>
                    <p>如果 <var>request</var> 的
                      <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url"
                        id="ref-for-concept-request-url⑧">URL</a>
                      不是 <a data-link-type="dfn"
                        href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url"
                        id="ref-for-potentially-trustworthy-url">潜在可信URL</a>，
                      则返回 null。
                    </p>
                </ol>
              <li data-md>
                <p>如果 <var>request</var> 是一个
                  <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#navigation-request"
                    id="ref-for-navigation-request">导航请求</a>
                  并且触发该请求的
                  <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate"
                    id="ref-for-navigate⑥">导航</a>
                  是通过 shift+reload 或等效操作发起的，则返回 null。
                </p>
              <li data-md>
                <p>
                  <a data-link-type="dfn" href="http://tc39.github.io/ecma262/#sec-algorithm-conventions"
                    id="ref-for-sec-algorithm-conventions">断言</a>
                  <var>reservedClient</var> 不为 null。
                </p>
              <li data-md>
                <p>设 <var>storage key</var> 为运行
                  <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#obtain-a-storage-key"
                    id="ref-for-obtain-a-storage-key①⓪">获取存储密钥</a>
                  给定 <var>reservedClient</var> 的结果。
                </p>
              <li data-md>
                <p>设 <var>registration</var> 为运行
                  <a data-link-type="dfn" href="#match-service-worker-registration"
                    id="ref-for-match-service-worker-registration⑦">匹配服务工作线程注册</a>
                  给定 <var>storage key</var> 和 <var>request</var> 的
                  <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url"
                    id="ref-for-concept-request-url⑨">URL</a>
                  的结果。
                </p>
              <li data-md>
                <p>如果 <var>registration</var> 为 null 或 <var>registration</var> 的
                  <a data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker③⑤">活跃的 worker</a>
                  为 null，则返回 null。
                </p>
              <li data-md>
                <p>如果 <var>request</var> 的
                  <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination"
                    id="ref-for-concept-request-destination④">目标</a>
                  不是 "<code
                    class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#dom-requestdestination-report" id="ref-for-dom-requestdestination-report">"report"</a></code>",
                  则将 <var>reservedClient</var> 的
                  <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
                    id="ref-for-concept-environment-active-service-worker②⑥">活跃服务工作线程</a>
                  设为 <var>registration</var> 的
                  <a data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker③⑥">活跃 worker</a>。
                </p>
              <li data-md>
                <p>如果 <var>request</var> 是一个
                  <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#navigation-request"
                    id="ref-for-navigation-request①">导航请求</a>，
                  <var>registration</var> 的
                  <a data-link-type="dfn" href="#service-worker-registration-navigation-preload-enabled-flag"
                    id="ref-for-service-worker-registration-navigation-preload-enabled-flag③">导航预加载已启用标志</a>
                  被设置，<var>request</var> 的
                  <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-method"
                    id="ref-for-concept-request-method⑤">方法</a>
                  是 `<code>GET</code>`，并且 <var>registration</var> 的
                  <a data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker③⑦">活跃 worker</a> 的
                  <a data-link-type="dfn" href="#dfn-set-of-event-types-to-handle"
                    id="ref-for-dfn-set-of-event-types-to-handle①">处理事件类型集合</a>
                  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain"
                    id="ref-for-list-contain①">包含</a>
                  <code>fetch</code>，则：
                </p>
                <p class="note" role="note"><span>注意：</span>如果上述条件全部成立，除了 <var>registration</var> 的
                  <a data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker③⑧">活跃 worker</a> 的
                  <a data-link-type="dfn" href="#dfn-set-of-event-types-to-handle"
                    id="ref-for-dfn-set-of-event-types-to-handle②">处理事件类型集合</a>
                  <strong>不</strong>包含 <code>fetch</code>，则用户代理可能希望在控制台中显示警告，因为开发者的意图并不明确。
                </p>
                <ol>
                  <li data-md>
                    <p>设 <var>preloadRequest</var> 为
                      <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-clone"
                        id="ref-for-concept-request-clone">克隆</a>
                      请求 <var>request</var> 的结果。
                    </p>
                  <li data-md>
                    <p>设 <var>preloadRequestHeaders</var> 为 <var>preloadRequest</var> 的
                      <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list"
                        id="ref-for-concept-request-header-list①">头部列表</a>。
                    </p>
                  <li data-md>
                    <p>设 <var>preloadResponseObject</var> 为一个与新的 <code class="idl"><a data-link-type="idl"
                          href="https://fetch.spec.whatwg.org/#response" id="ref-for-response①④">响应</a></code>对象相关联的新的
                      <code
                        class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#headers" id="ref-for-headers②">头部</a></code>
                      对象，其 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-headers-guard"
                        id="ref-for-concept-headers-guard②">保护</a> 为 "<code>不可变</code>"。
                    </p>
                  <li data-md>
                    <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-append"
                        id="ref-for-concept-header-list-append">附加</a>到 <var>preloadRequestHeaders</var> 一个新的
                      <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header"
                        id="ref-for-concept-header②">头部</a>，
                      其 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-name"
                        id="ref-for-concept-header-name②">名称</a> 是 `<code>Service-Worker-Navigation-Preload</code>`，
                      其 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-value"
                        id="ref-for-concept-header-value">值</a> 是 <var>registration</var> 的
                      <a data-link-type="dfn" href="#service-worker-registration-navigation-preload-header-value"
                        id="ref-for-service-worker-registration-navigation-preload-header-value②">导航预加载头部值</a>。
                    </p>
                  <li data-md>
                    <p>设 <var>preloadRequest</var> 的
                      <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#request-service-workers-mode"
                        id="ref-for-request-service-workers-mode③">服务工作线程模式</a> 为 "<code>无</code>"。
                    </p>
                  <li data-md>
                    <p>设 <var>preloadFetchController</var> 为 null。</p>
                  <li data-md>
                    <p>以 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                        id="ref-for-in-parallel③③">并行</a> 方式运行以下子步骤，但当 <var>controller</var> 的
                      <a data-link-type="dfn">状态</a> 是 "<code>终止</code>" 或 "<code>中止</code>" 时
                      <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#abort-when"
                        id="ref-for-abort-when">中止</a>：
                    </p>
                    <ol>
                      <li data-md>
                        <p>设 <var>preloadFetchController</var> 为
                          <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
                            id="ref-for-concept-fetch①⑦">获取</a>
                          <var>preloadRequest</var> 的结果。
                        </p>
                        <p>为了 <a data-link-type="dfn">处理响应</a> <var>navigationPreloadResponse</var>，运行以下子步骤：</p>
                        <ol>
                          <li data-md>
                            <p>如果 <var>navigationPreloadResponse</var> 的
                              <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-type"
                                id="ref-for-concept-response-type③">类型</a> 是 "<code>错误</code>"，则使用
                              <code>TypeError</code>
                              拒绝 <var>preloadResponse</var>，并终止这些子步骤。
                            </p>
                          <li data-md>
                            <p>将 <var>preloadResponseObject</var> 与 <var>navigationPreloadResponse</var> 关联。</p>
                          <li data-md>
                            <p>用 <var>preloadResponseObject</var> 解决 <var>preloadResponse</var>。</p>
                        </ol>
                    </ol>
                  <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#if-aborted"
                        id="ref-for-if-aborted">如果中止</a>，
                      则 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#fetch-controller-abort"
                        id="ref-for-fetch-controller-abort">中止</a> <var>preloadFetchController</var>。
                    </p>
                </ol>
              <li data-md>
                <p>否则，用 undefined 解决 <var>preloadResponse</var>。</p>
            </ol>
            <p class="note" role="note"><span>注意：</span>从此刻起，
              <a data-link-type="dfn" href="#dfn-service-worker-client"
                id="ref-for-dfn-service-worker-client④③">服务工作线程客户端</a>
              开始 <a data-link-type="dfn" href="#dfn-use" id="ref-for-dfn-use④">使用</a> 它的
              <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
                id="ref-for-concept-environment-active-service-worker②⑦">活跃服务工作线程</a> 的
              <a data-link-type="dfn" href="#dfn-containing-service-worker-registration"
                id="ref-for-dfn-containing-service-worker-registration①⑧">包含服务工作线程注册</a>。
            </p>
          <li data-md>
            <p>否则，如果 <var>request</var> 是一个
              <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#subresource-request"
                id="ref-for-subresource-request">子资源请求</a>，
              则：
            </p>
            <ol>
              <li data-md>
                <p>如果 <var>client</var> 的
                  <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
                    id="ref-for-concept-environment-active-service-worker②⑧">活跃服务工作线程</a> 非 null，
                  则将 <var>registration</var> 设为 <var>client</var> 的
                  <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker"
                    id="ref-for-concept-environment-active-service-worker②⑨">活跃服务工作线程</a> 的
                  <a data-link-type="dfn" href="#dfn-containing-service-worker-registration"
                    id="ref-for-dfn-containing-service-worker-registration①⑨">包含服务工作线程注册</a>。
                </p>
              <li data-md>
                <p>否则，返回 null。</p>
            </ol>
          <li data-md>
            <p>设 <var>activeWorker</var> 为 <var>registration</var> 的
              <a data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker③⑨">活跃 worker</a>。
            </p>
          <li data-md>
            <p>如果以下任一情况为 true，则设 <var>shouldSoftUpdate</var> 为 true，否则设为 false：</p>
            <ul>
              <li data-md>
                <p><var>request</var> 是一个
                  <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#non-subresource-request"
                    id="ref-for-non-subresource-request①">非子资源请求</a>。
                </p>
              <li data-md>
                <p><var>request</var> 是一个
                  <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#subresource-request"
                    id="ref-for-subresource-request①">子资源请求</a>，
                  且 <var>registration</var> 是
                  <a data-link-type="dfn" href="#service-worker-registration-stale"
                    id="ref-for-service-worker-registration-stale③">过期</a>的。
                </p>
            </ul>
          <li data-md>
            <p>如果运行 <a data-link-type="dfn" href="#should-skip-event" id="ref-for-should-skip-event③">是否应跳过事件</a>
              算法，使用 "fetch" 和 <var>activeWorker</var> 的结果为 true，则：
            </p>
            <ol>
              <li data-md>
                <p>如果 <var>shouldSoftUpdate</var> 为 true，则
                  <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                    id="ref-for-in-parallel③④">并行</a> 运行
                  <a data-link-type="dfn" href="#soft-update" id="ref-for-soft-update①">软更新</a> 算法，使用
                  <var>registration</var>。
                </p>
              <li data-md>
                <p>返回 null。</p>
            </ol>
          <li data-md>
            <p>如果 <var>useHighResPerformanceTimers</var> 为 true，则将 <var>useHighResPerformanceTimers</var> 设为
              <var>activeWorker</var> 的
              <a data-link-type="dfn" href="#dfn-service-worker-global-object"
                id="ref-for-dfn-service-worker-global-object⑤">全局对象</a>
              的
              <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-cross-origin-isolated-capability"
                id="ref-for-concept-workerglobalscope-cross-origin-isolated-capability①">跨域隔离能力</a>。
            </p>
          <li data-md>
            <p>设 <var>timingInfo</var> 的
              <a data-link-type="dfn" href="#service-worker-timing-info-start-time"
                id="ref-for-service-worker-timing-info-start-time">开始时间</a>
              为 <a data-link-type="dfn" href="https://www.w3.org/TR/hr-time-3/#dfn-coarsened-shared-current-time"
                id="ref-for-dfn-coarsened-shared-current-time">粗化的共享当前时间</a>，给定 <var>useHighResPerformanceTimers</var>。
            </p>
          <li data-md>
            <p>如果 <var>activeWorker</var> 的 <a data-link-type="dfn">状态</a> 是 "<code>激活中</code>"，等待
              <var>activeWorker</var> 的
              <a data-link-type="dfn">状态</a> 变为 "<code>已激活</code>"。
            </p>
          <li data-md>
            <p>如果运行 <a data-link-type="dfn" href="#run-service-worker" id="ref-for-run-service-worker⑥">运行服务工作线程</a>
              算法，使用 <var>activeWorker</var> 的结果为 <em>失败</em>，则将 <var>handleFetchFailed</var> 设为 true。
            </p>
          <li data-md>
            <p>否则：</p>
            <ol>
              <li data-md>
                <p>将 <var>workerRealm</var> 设为 <var>activeWorker</var> 的
                  <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm"
                    id="ref-for-concept-relevant-realm⑨">相关领域</a>。
                </p>
              <li data-md>
                <p>将 <var>eventHandled</var> 设为
                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise"
                    id="ref-for-a-new-promise②⓪">一个新的 Promise</a>
                  ，位于 <var>workerRealm</var> 中。
                </p>
              <li data-md>
                <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                    id="ref-for-queue-a-task③③">排队一个任务</a> <var>任务</var> 以运行以下子步骤：</p>
                <ol>
                  <li data-md>
                    <p>设 <var>e</var> 为
                      <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-create"
                        id="ref-for-concept-event-create④">创建事件</a> 的结果，类型为
                      <code
                        class="idl"><a data-link-type="idl" href="#fetchevent" id="ref-for-fetchevent④">FetchEvent</a></code>。
                    </p>
                  <li data-md>
                    <p>设 <var>requestObject</var> 为一个新的
                      <code
                        class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request①④">请求</a></code>
                      对象，关联到 <var>request</var>，并关联到一个新的
                      <code
                        class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#headers" id="ref-for-headers③">头部</a></code>
                      对象，其 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-headers-guard"
                        id="ref-for-concept-headers-guard③">保护</a> 为 "<code>不可变</code>"。
                    </p>
                  <li data-md>
                    <p>初始化 <var>e</var> 的
                      <code
                        class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-type" id="ref-for-dom-event-type②">类型</a></code>
                      属性为
                      <code class="idl"><a class="idl-code" data-link-type="event" href="#service-worker-global-scope-fetch-event"
                          id="ref-for-service-worker-global-scope-fetch-event⑥">fetch</a></code>。
                    </p>
                  <li data-md>
                    <p>初始化 <var>e</var> 的
                      <code
                        class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-cancelable" id="ref-for-dom-event-cancelable">可取消</a></code>
                      属性为 true。
                    </p>
                  <li data-md>
                    <p>初始化 <var>e</var> 的
                      <code
                        class="idl"><a data-link-type="idl" href="#dom-fetchevent-request" id="ref-for-dom-fetchevent-request②">请求</a></code>
                      属性为 <var>requestObject</var>。
                    </p>
                  <li data-md>
                    <p>初始化 <var>e</var> 的
                      <code
                        class="idl"><a data-link-type="idl" href="#dom-fetchevent-preloadresponse" id="ref-for-dom-fetchevent-preloadresponse②">预加载响应</a></code>
                      为 <var>preloadResponse</var>。
                    </p>
                  <li data-md>
                    <p>初始化 <var>e</var> 的
                      <code
                        class="idl"><a data-link-type="idl" href="#dom-fetchevent-clientid" id="ref-for-dom-fetchevent-clientid②">客户端ID</a></code>
                      属性为 <var>client</var> 的
                      <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-id"
                        id="ref-for-concept-environment-id③">ID</a>。
                    </p>
                  <li data-md>
                    <p>如果 <var>request</var> 是一个
                      <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#non-subresource-request"
                        id="ref-for-non-subresource-request②">非子资源请求</a>
                      且 <var>request</var> 的
                      <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination"
                        id="ref-for-concept-request-destination⑤">目标</a> 不是
                      <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#dom-requestdestination-report"
                          id="ref-for-dom-requestdestination-report①">"report"</a></code>，
                      初始化 <var>e</var> 的
                      <code
                        class="idl"><a data-link-type="idl" href="#dom-fetchevent-resultingclientid" id="ref-for-dom-fetchevent-resultingclientid②">结果客户端ID</a></code>
                      属性为 <var>reservedClient</var> 的
                      <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-id"
                        id="ref-for-concept-environment-id④">ID</a>，否则初始化为空字符串。
                    </p>
                  <li data-md>
                    <p>如果 <var>request</var> 是一个
                      <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#navigation-request"
                        id="ref-for-navigation-request②">导航请求</a>，初始化 <var>e</var> 的
                      <code
                        class="idl"><a data-link-type="idl" href="#dom-fetchevent-replacesclientid" id="ref-for-dom-fetchevent-replacesclientid②">替换客户端ID</a></code>
                      属性为 <var>request</var> 的
                      <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-replaces-client-id"
                        id="ref-for-concept-request-replaces-client-id">替换客户端ID</a>，否则初始化为空字符串。
                    </p>
                  <li data-md>
                    <p>初始化 <var>e</var> 的
                      <code
                        class="idl"><a data-link-type="idl" href="#dom-fetchevent-handled" id="ref-for-dom-fetchevent-handled②">handled</a></code>
                      为 <var>eventHandled</var>。
                    </p>
                  <li data-md>
                    <p>将 <var>timingInfo</var> 的
                      <a data-link-type="dfn" href="#service-worker-timing-info-fetch-event-dispatch-time"
                        id="ref-for-service-worker-timing-info-fetch-event-dispatch-time">获取事件调度时间</a> 设为
                      <a data-link-type="dfn" href="https://www.w3.org/TR/hr-time-3/#dfn-coarsened-shared-current-time"
                        id="ref-for-dfn-coarsened-shared-current-time①">粗化的共享当前时间</a>，给定
                      <var>useHighResPerformanceTimers</var>。
                    </p>
                  <li data-md>
                    <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch"
                        id="ref-for-concept-event-dispatch⑥">分派</a> <var>e</var> 到 <var>activeWorker</var> 的
                      <a data-link-type="dfn" href="#dfn-service-worker-global-object"
                        id="ref-for-dfn-service-worker-global-object⑦">全局对象</a>。
                    </p>
                  <li data-md>
                    <p>调用 <a data-link-type="dfn" href="#update-service-worker-extended-events-set"
                        id="ref-for-update-service-worker-extended-events-set①">更新服务工作线程扩展事件集</a>，使用
                      <var>activeWorker</var> 和
                      <var>e</var>。
                    </p>
                  <li data-md>
                    <p>如果 <var>e</var> 的
                      <a data-link-type="dfn" href="#fetchevent-respond-with-entered-flag"
                        id="ref-for-fetchevent-respond-with-entered-flag②">respond-with 进入标志</a> 已设置，则将
                      <var>respondWithEntered</var> 设为 true。
                    </p>
                  <li data-md>
                    <p>如果 <var>e</var> 的
                      <a data-link-type="dfn" href="#fetchevent-wait-to-respond-flag"
                        id="ref-for-fetchevent-wait-to-respond-flag③">wait-to-respond 标志</a> 已设置，则：
                    </p>
                    <ol>
                      <li data-md>
                        <p>等待直到 <var>e</var> 的
                          <a data-link-type="dfn" href="#fetchevent-wait-to-respond-flag"
                            id="ref-for-fetchevent-wait-to-respond-flag④">wait-to-respond 标志</a> 被取消设置。
                        </p>
                      <li data-md>
                        <p>如果 <var>e</var> 的
                          <a data-link-type="dfn" href="#fetchevent-respond-with-error-flag"
                            id="ref-for-fetchevent-respond-with-error-flag③">respond-with 错误标志</a> 已设置，则将
                          <var>handleFetchFailed</var> 设为 true。
                        </p>
                      <li data-md>
                        <p>否则，将 <var>response</var> 设为 <var>e</var> 的
                          <a data-link-type="dfn" href="#fetchevent-potential-response"
                            id="ref-for-fetchevent-potential-response①">潜在响应</a>。
                        </p>
                    </ol>
                  <li data-md>
                    <p>如果 <var>response</var> 为 null，<var>request</var> 的
                      <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-body"
                        id="ref-for-concept-request-body">正文</a>
                      不为 null，并且 <var>request</var> 的 <a data-link-type="dfn"
                        href="https://fetch.spec.whatwg.org/#concept-request-body"
                        id="ref-for-concept-request-body①">正文</a> 的
                      <a data-link-type="dfn">来源</a> 为 null，则：
                    </p>
                    <ol>
                      <li data-md>
                        <p>如果 <var>request</var> 的
                          <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-body"
                            id="ref-for-concept-request-body②">正文</a> 是
                          <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#body-unusable"
                            id="ref-for-body-unusable">不可用的</a>，
                          则将 <var>handleFetchFailed</var> 设为 true。
                        </p>
                      <li data-md>
                        <p>否则，
                          <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-cancel"
                            id="ref-for-readablestream-cancel">取消</a>
                          <var>request</var> 的
                          <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-body"
                            id="ref-for-concept-request-body③">正文</a>，值为 undefined。
                        </p>
                    </ol>
                  <li data-md>
                    <p>如果 <var>response</var> 不为 null，则将 <var>response</var> 的
                      <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#response-service-worker-timing-info"
                        id="ref-for-response-service-worker-timing-info">服务工作线程计时信息</a> 设为 <var>timingInfo</var>。
                    </p>
                  <li data-md>
                    <p>如果 <var>e</var> 的
                      <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#canceled-flag"
                        id="ref-for-canceled-flag">取消标志</a>
                      已设置，则将 <var>eventCanceled</var> 设为 true。
                    </p>
                  <li data-md>
                    <p>如果 <var>controller</var> 的
                      <a data-link-type="dfn">状态</a> 是 "<code>终止</code>" 或 "<code>中止</code>"，
                      则 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                        id="ref-for-queue-a-task③④">排队一个任务</a> 以 <a data-link-type="dfn"
                        href="https://dom.spec.whatwg.org/#abortsignal-signal-abort"
                        id="ref-for-abortsignal-signal-abort">发出中止信号</a>，
                      在 <var>requestObject</var> 的 <code
                        class="idl"><a data-link-type="idl"
                          href="https://fetch.spec.whatwg.org/#dom-request-signal" id="ref-for-dom-request-signal">signal</a></code> 上。
                    </p>
                </ol>
                <p>如果 <var>task</var> 被丢弃，将 <var>handleFetchFailed</var> 设为 true。</p>
                <p>此 <var>task</var> 必须使用 <var>activeWorker</var> 的
                  <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop"
                    id="ref-for-event-loop①④">事件循环</a> 和
                  <a data-link-type="dfn" href="#dfn-handle-fetch-task-source"
                    id="ref-for-dfn-handle-fetch-task-source③">处理获取任务源</a>。
                </p>
            </ol>
          <li data-md>
            <p>等待 <var>task</var> 执行完毕或 <var>handleFetchFailed</var> 为 true。</p>
          <li data-md>
            <p>如果 <var>shouldSoftUpdate</var> 为 true，则
              <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                id="ref-for-in-parallel③⑤">并行</a> 运行
              <a data-link-type="dfn" href="#soft-update" id="ref-for-soft-update②">软更新</a> 算法，使用
              <var>registration</var>。
            </p>
          <li data-md>
            <p>如果 <var>respondWithEntered</var> 为 false，则：</p>
            <ol>
              <li data-md>
                <p>如果 <var>eventCanceled</var> 为 true，则：</p>
                <ol>
                  <li data-md>
                    <p>如果 <var>eventHandled</var> 不为 null，则使用 "<code
                        class="idl"><a data-link-type="idl"
                          href="https://webidl.spec.whatwg.org/#networkerror" id="ref-for-networkerror">网络错误</a></code>"
                      <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException"
                          id="ref-for-idl-DOMException②①">DOMException</a></code>
                      拒绝 <var>eventHandled</var>，位于 <var>workerRealm</var> 中。
                    </p>
                  <li data-md>
                    <p>返回 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error"
                        id="ref-for-concept-network-error⑦">网络错误</a>。</p>
                </ol>
              <li data-md>
                <p>如果 <var>eventHandled</var> 不为 null，则
                  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve">解决</a>
                  <var>eventHandled</var>。
                </p>
              <li data-md>
                <p>返回 null。</p>
            </ol>
          <li data-md>
            <p>如果 <var>handleFetchFailed</var> 为 true，则：</p>
            <ol>
              <li data-md>
                <p>如果 <var>eventHandled</var> 不为 null，则使用 "<code class="idl"><a data-link-type="idl"
                      href="https://webidl.spec.whatwg.org/#networkerror" id="ref-for-networkerror①">网络错误</a></code>"
                  <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException"
                      id="ref-for-idl-DOMException②②">DOMException</a></code>
                  拒绝 <var>eventHandled</var>，位于 <var>workerRealm</var> 中。
                </p>
              <li data-md>
                <p>返回 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error"
                    id="ref-for-concept-network-error⑧">网络错误</a>。</p>
            </ol>
          <li data-md>
            <p>如果 <var>eventHandled</var> 不为 null，则
              <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve①">解决</a>
              <var>eventHandled</var>。
            </p>
          <li data-md>
            <p>返回 <var>response</var>。</p>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Should Skip Event">
        <h3 class="heading settled" id="should-skip-event-algorithm">
          <span class="content">
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="should-skip-event">是否应跳过事件</dfn>
          </span>
          <a class="self-link" href="#should-skip-event-algorithm"></a>
        </h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>eventName</var>，一个字符串</p>
          <dd data-md>
            <p><var>serviceWorker</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker"
                id="ref-for-dfn-service-worker⑨⑧">服务工作线程</a></p>
          <dt data-md>输出
          <dd data-md>
            <p>一个布尔值</p>
        </dl>
        <p class="note" role="note"><span>注意：</span>为了避免不必要的延迟，本规范允许在服务工作线程的全局中首次执行脚本时未明确添加事件监听器时跳过事件分派。</p>
        <ol>
          <li data-md>
            <p>如果 <var>serviceWorker</var> 的
              <a data-link-type="dfn" href="#dfn-set-of-event-types-to-handle"
                id="ref-for-dfn-set-of-event-types-to-handle③">处理事件类型集合</a>
              不 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain"
                id="ref-for-list-contain②">包含</a>
              <var>eventName</var>，则用户代理 <em>可以</em> 返回 true。
            </p>
          <li data-md>
            <p>返回 false。</p>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Fire Functional Event">
        <h3 class="heading settled" id="fire-functional-event-algorithm">
          <span class="content">
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="Fire Functional Event|触发功能事件"
              id="fire-functional-event">触发功能事件</dfn>
          </span>
          <a class="self-link" href="#fire-functional-event-algorithm"></a>
        </h3>
        <dl>
          <dt data-md>输入
          <dd data-md>
            <p><var>eventName</var>，一个字符串</p>
          <dd data-md>
            <p><var>eventConstructor</var>，一个扩展自
              <code
                class="idl"><a data-link-type="idl" href="#extendableevent" id="ref-for-extendableevent①⑧">ExtendableEvent</a></code>
              的事件构造函数
            </p>
          <dd data-md>
            <p><var>registration</var>，一个
              <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration⑤⑥">服务工作线程注册</a>
            </p>
          <dd data-md>
            <p><var>initialization</var>，<var>event</var> 的可选属性初始化，构建自 <var>eventConstructor</var>
            </p>
          <dd data-md>
            <p><var>postDispatchSteps</var>，在 <a data-link-type="dfn" href="#dfn-active-worker"
                id="ref-for-dfn-active-worker④⓪">活跃 worker</a> 的事件循环中运行的可选步骤，<var>dispatchedEvent</var> 设为分派的
              <var>eventConstructor</var> 实例。
            </p>
          <dt data-md>输出
          <dd data-md>
            <p>无</p>
        </dl>
        <ol>
          <li data-md>
            <p class="assertion">断言：<var>registration</var> 的
              <a data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker④①">活跃 worker</a> 不为 null。
            </p>
          <li data-md>
            <p>设 <var>activeWorker</var> 为 <var>registration</var> 的
              <a data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker④②">活跃 worker</a>。
            </p>
          <li data-md>
            <p>如果运行 <a data-link-type="dfn" href="#should-skip-event" id="ref-for-should-skip-event④">是否应跳过事件</a>
              算法，使用 <var>eventName</var> 和 <var>activeWorker</var> 的结果为 true，则：
            </p>
            <ol>
              <li data-md>
                <p>如果 <var>registration</var> 是
                  <a data-link-type="dfn" href="#service-worker-registration-stale"
                    id="ref-for-service-worker-registration-stale④">过期</a>
                  的，则 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                    id="ref-for-in-parallel③⑥">并行</a> 运行 <a data-link-type="dfn" href="#soft-update"
                    id="ref-for-soft-update③">软更新</a> 算法，使用 <var>registration</var>。
                </p>
              <li data-md>
                <p>返回。</p>
            </ol>
          <li data-md>
            <p>如果 <var>activeWorker</var> 的 <a data-link-type="dfn">状态</a> 是 "<code>激活中</code>"，
              等待 <var>activeWorker</var> 的 <a data-link-type="dfn">状态</a> 变为 "<code>已激活</code>"。
            </p>
          <li data-md>
            <p>如果运行 <a data-link-type="dfn" href="#run-service-worker" id="ref-for-run-service-worker⑦">运行服务工作线程</a>
              算法，使用 <var>activeWorker</var> 的结果为 <em>失败</em>，则：
            </p>
            <ol>
              <li data-md>
                <p>如果 <var>registration</var> 是
                  <a data-link-type="dfn" href="#service-worker-registration-stale"
                    id="ref-for-service-worker-registration-stale⑤">过期</a>
                  的，则 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                    id="ref-for-in-parallel③⑦">并行</a> 运行 <a data-link-type="dfn" href="#soft-update"
                    id="ref-for-soft-update④">软更新</a> 算法，使用 <var>registration</var>。
                </p>
              <li data-md>
                <p>返回。</p>
            </ol>
          <li data-md>
            <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                id="ref-for-queue-a-task③⑤">排队一个任务</a> <var>任务</var> 以运行以下子步骤：</p>
            <ol>
              <li data-md>
                <p>设 <var>event</var> 为
                  <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-create"
                    id="ref-for-concept-event-create⑤">创建事件</a> 的结果，类型为 <var>eventConstructor</var> 和
                  <var>activeWorker</var> 的
                  <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm"
                    id="ref-for-concept-relevant-realm①⓪">相关领域</a>。
                </p>
              <li data-md>
                <p>如果 <var>initialization</var> 不为 null，则使用 <var>initialization</var> 初始化 <var>event</var>。
                </p>
              <li data-md>
                <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch"
                    id="ref-for-concept-event-dispatch⑧">分派</a> <var>event</var> 到 <var>activeWorker</var> 的
                  <a data-link-type="dfn" href="#dfn-service-worker-global-object"
                    id="ref-for-dfn-service-worker-global-object⑧">全局对象</a>。
                </p>
              <li data-md>
                <p>调用 <a data-link-type="dfn" href="#update-service-worker-extended-events-set"
                    id="ref-for-update-service-worker-extended-events-set②">更新服务工作线程扩展事件集</a>，使用 <var>activeWorker</var>
                  和
                  <var>event</var>。
                </p>
              <li data-md>
                <p>如果 <var>postDispatchSteps</var> 不为 null，则运行 <var>postDispatchSteps</var>，传递 <var>event</var> 作为
                  <var>dispatchedEvent</var>。
                </p>
            </ol>
            <p>此 <var>任务</var> 必须使用 <var>activeWorker</var> 的
              <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop"
                id="ref-for-event-loop①⑤">事件循环</a> 和
              <a data-link-type="dfn" href="#dfn-handle-functional-event-task-source"
                id="ref-for-dfn-handle-functional-event-task-source③">处理功能事件任务源</a>。
            </p>
          <li data-md>
            <p>等待 <var>任务</var> 执行完毕或被丢弃。</p>
          <li data-md>
            <p>如果 <var>registration</var> 是
              <a data-link-type="dfn" href="#service-worker-registration-stale"
                id="ref-for-service-worker-registration-stale⑥">过期</a>
              的，则 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                id="ref-for-in-parallel③⑧">并行</a> 运行
              <a data-link-type="dfn" href="#soft-update" id="ref-for-soft-update⑤">软更新</a> 算法，使用
              <var>registration</var>。
            </p>
        </ol>
        <div class="example" id="example-cfaebd87">
          <a class="self-link" href="#example-cfaebd87"></a> 要触发一个 "<code>amazingthing</code>" 事件（类型为
          <code>AmazingThingEvent</code>）
          在特定的 <var>serviceWorkerRegistration</var> 上，并初始化事件对象的属性，描述如下：
          <ol>
            <li data-md>
              <p><a data-link-type="dfn" href="#fire-functional-event" id="ref-for-fire-functional-event①">触发功能事件</a>
                "<code>amazingthing</code>"，使用 <code>AmazingThingEvent</code> 在 <var>serviceWorkerRegistration</var>
                上，属性如下：
              </p>
              <dl>
                <dt data-md>propertyName
                <dd data-md>
                  <p>value</p>
                <dt data-md>anotherPropertyName
                <dd data-md>
                  <p>anotherValue</p>
              </dl>
              <p>然后运行以下步骤，使用 <var>dispatchedEvent</var>：</p>
              <ol>
                <li data-md>
                  <p>在服务工作线程的事件循环中执行所需操作，使用 <var>dispatchedEvent</var>。</p>
              </ol>
          </ol>
          <p>请注意，初始化步骤和分派后步骤是可选的。如果不需要，它们的描述如下：</p>
          <ol>
            <li data-md>
              <p><a data-link-type="dfn" href="#fire-functional-event" id="ref-for-fire-functional-event②">触发功能事件</a>
                "<code>whatever</code>"，使用 <code class="idl"><a data-link-type="idl" href="#extendableevent"
                    id="ref-for-extendableevent①⑨">ExtendableEvent</a></code> 在 <var>serviceWorkerRegistration</var> 上。
              </p>
          </ol>
        </div>
      </section>

      <section class="algorithm" data-algorithm="Handle Service Worker Client Unload">
        <h3 class="heading settled" id="on-client-unload-algorithm">
          <span class="content">
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-service-worker-client-unload">
              处理服务工作线程客户端卸载
            </dfn>
          </span>
          <a class="self-link" href="#on-client-unload-algorithm"></a>
        </h3>
        <p>当 <a data-link-type="dfn" href="#dfn-service-worker-client"
            id="ref-for-dfn-service-worker-client④④">服务工作线程客户端</a> 通过 <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#unload-a-document"
            id="ref-for-unload-a-document">卸载</a> 或 <a data-link-type="dfn" href="#terminate-service-worker"
            id="ref-for-terminate-service-worker⑥">终止</a> 卸载时，用户代理<em>必须</em>运行以下步骤。</p>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>client</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker-client"
                id="ref-for-dfn-service-worker-client④⑤">服务工作线程客户端</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p>无</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>以原子方式运行以下步骤。</p>
          </li>
          <li data-md>
            <p>设 <var>registration</var> 为 <var>client</var> 所 <a data-link-type="dfn" href="#dfn-use"
                id="ref-for-dfn-use⑤">使用</a> 的 <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration⑤⑦">服务工作线程注册</a>。</p>
          </li>
          <li data-md>
            <p>如果 <var>registration</var> 为 null，则中止这些步骤。</p>
          </li>
          <li data-md>
            <p>如果其他任何 <a data-link-type="dfn" href="#dfn-service-worker-client"
                id="ref-for-dfn-service-worker-client④⑥">服务工作线程客户端</a> 正在 <a data-link-type="dfn" href="#dfn-use"
                id="ref-for-dfn-use⑥">使用</a> <var>registration</var>，则中止这些步骤。</p>
          </li>
          <li data-md>
            <p>如果 <var>registration</var> 为 <a data-link-type="dfn" href="#dfn-service-worker-registration-unregistered"
                id="ref-for-dfn-service-worker-registration-unregistered③">未注册</a>状态，调用 <a data-link-type="dfn"
                href="#try-clear-registration" id="ref-for-try-clear-registration①">尝试清除注册</a>，传入
              <var>registration</var>。
            </p>
          </li>
          <li data-md>
            <p>调用 <a data-link-type="dfn" href="#try-activate" id="ref-for-try-activate④">尝试激活</a>，传入
              <var>registration</var>。
            </p>
          </li>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Handle User Agent Shutdown">
        <h3 class="heading settled" id="on-user-agent-shutdown-algorithm">
          <span class="content">
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-user-agent-shutdown">
              处理用户代理关闭
            </dfn>
          </span>
          <a class="self-link" href="#on-user-agent-shutdown-algorithm"></a>
        </h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p>无</p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p>无</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate"
                id="ref-for-map-iterate⑦">对于每个</a> (<var>storage key</var>, <var>scope</var>) → <var>registration</var>
              在 <a data-link-type="dfn" href="#dfn-scope-to-registration-map"
                id="ref-for-dfn-scope-to-registration-map⑦">注册映射</a> 中：</p>
            <ol>
              <li data-md>
                <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-installing-worker"
                    id="ref-for-dfn-installing-worker①④">安装中的 worker</a> <var>installingWorker</var> 不为 null，则：</p>
                <ol>
                  <li data-md>
                    <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-waiting-worker"
                        id="ref-for-dfn-waiting-worker①③">等待中的 worker</a> 为 null 且 <var>registration</var> 的 <a
                        data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker④③">活跃的 worker</a> 为
                      null，调用 <a data-link-type="dfn" href="#clear-registration"
                        id="ref-for-clear-registration">清除注册</a>，传入 <var>registration</var>，然后继续循环的下一次迭代。</p>
                  </li>
                  <li data-md>
                    <p>否则，设 <var>installingWorker</var> 为 null。</p>
                  </li>
                </ol>
              </li>
              <li data-md>
                <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-waiting-worker"
                    id="ref-for-dfn-waiting-worker①④">等待中的 worker</a> 不为 null，则并行运行以下子步骤：</p>
                <ol>
                  <li data-md>
                    <p>调用 <a data-link-type="dfn" href="#activate" id="ref-for-activate⑥">激活</a>，传入
                      <var>registration</var>。
                    </p>
                  </li>
                </ol>
              </li>
            </ol>
          </li>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Update Service Worker Extended Events Set">
        <h3 class="heading settled" id="update-service-worker-extended-events-set-algorithm">
          <span class="content">
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="update-service-worker-extended-events-set">
              更新服务工作线程扩展事件集
            </dfn>
          </span>
          <a class="self-link" href="#update-service-worker-extended-events-set-algorithm"></a>
        </h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>worker</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker"
                id="ref-for-dfn-service-worker⑨⑨">服务工作线程</a></p>
          </dd>
          <dd data-md>
            <p><var>event</var>，一个 <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event"
                id="ref-for-concept-event⑦">事件</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p>无</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p class="assertion">断言：<var>event</var> 的 <a data-link-type="dfn"
                href="https://dom.spec.whatwg.org/#dispatch-flag" id="ref-for-dispatch-flag②">分派标志</a> 未设置。</p>
          </li>
          <li data-md>
            <p>对于 <var>worker</var> 的 <a data-link-type="dfn" href="#dfn-set-of-extended-events"
                id="ref-for-dfn-set-of-extended-events①">扩展事件集</a> 中的每个 <var>item</var>：</p>
            <ol>
              <li data-md>
                <p>如果 <var>item</var> 未 <a data-link-type="dfn" href="#extendableevent-active"
                    id="ref-for-extendableevent-active③">激活</a>，从 <var>worker</var> 的 <a data-link-type="dfn"
                    href="#dfn-set-of-extended-events" id="ref-for-dfn-set-of-extended-events②">扩展事件集</a> 中 <a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove"
                    id="ref-for-list-remove①">移除</a> <var>item</var>。</p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>如果 <var>event</var> 已 <a data-link-type="dfn" href="#extendableevent-active"
                id="ref-for-extendableevent-active④">激活</a>，<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append③">添加</a> <var>event</var> 到
              <var>worker</var> 的 <a data-link-type="dfn" href="#dfn-set-of-extended-events"
                id="ref-for-dfn-set-of-extended-events③">扩展事件集</a>。
            </p>
          </li>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Unregister">
        <h3 class="heading settled" id="unregister-algorithm">
          <span class="content">
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="unregister">取消注册</dfn>
          </span>
          <a class="self-link" href="#unregister-algorithm"></a>
        </h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>job</var>，一个 <a data-link-type="dfn" href="#dfn-job" id="ref-for-dfn-job②⑦">任务</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p>无</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>如果 <var>job</var> 的 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                id="ref-for-concept-settings-object-origin①⑦">来源</a> 与 <var>job</var> 的 <a data-link-type="dfn"
                href="#dfn-job-scope-url" id="ref-for-dfn-job-scope-url⑧">范围 URL</a> 的 <a data-link-type="dfn"
                href="#dfn-job-client" id="ref-for-dfn-job-client②⓪">客户端</a> 的 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                id="ref-for-concept-settings-object-origin①⑧">来源</a> 不同，则：</p>
            <ol>
              <li data-md>
                <p>调用 <a data-link-type="dfn" href="#reject-job-promise" id="ref-for-reject-job-promise①⓪">拒绝任务
                    Promise</a>，传入 <var>job</var> 和 "<code
                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#securityerror" id="ref-for-securityerror⑦">SecurityError</a></code>"
                  <code
                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException②③">DOMException</a></code>。
                </p>
              </li>
              <li data-md>
                <p>调用 <a data-link-type="dfn" href="#finish-job" id="ref-for-finish-job①①">完成任务</a>，传入 <var>job</var>
                  并中止这些步骤。</p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>设 <var>registration</var> 为运行 <a data-link-type="dfn" href="#get-registration"
                id="ref-for-get-registration②">获取注册</a> 的结果，传入 <var>job</var> 的 <a data-link-type="dfn"
                href="#job-storage-key" id="ref-for-job-storage-key④">存储键</a> 和 <var>job</var> 的 <a data-link-type="dfn"
                href="#dfn-job-scope-url" id="ref-for-dfn-job-scope-url⑨">范围 URL</a>。</p>
          </li>
          <li data-md>
            <p>如果 <var>registration</var> 为 null，则：</p>
            <ol>
              <li data-md>
                <p>调用 <a data-link-type="dfn" href="#resolve-job-promise" id="ref-for-resolve-job-promise③">解决任务
                    Promise</a>，传入 <var>job</var> 和 false。</p>
              </li>
              <li data-md>
                <p>调用 <a data-link-type="dfn" href="#finish-job" id="ref-for-finish-job①②">完成任务</a>，传入 <var>job</var>
                  并中止这些步骤。</p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-remove" id="ref-for-map-remove⑤">移除</a>
              <a data-link-type="dfn" href="#dfn-scope-to-registration-map"
                id="ref-for-dfn-scope-to-registration-map⑧">注册映射</a>[<var>registration</var> 的 <a data-link-type="dfn"
                href="#service-worker-registration-storage-key"
                id="ref-for-service-worker-registration-storage-key①③">存储键</a>，<var>job</var> 的 <a data-link-type="dfn"
                href="#dfn-job-scope-url" id="ref-for-dfn-job-scope-url①⓪">范围 URL</a>]。
            </p>
          </li>
          <li data-md>
            <p>调用 <a data-link-type="dfn" href="#resolve-job-promise" id="ref-for-resolve-job-promise④">解决任务
                Promise</a>，传入 <var>job</var> 和 true。</p>
          </li>
          <li data-md>
            <p>调用 <a data-link-type="dfn" href="#try-clear-registration"
                id="ref-for-try-clear-registration②">尝试清除注册</a>，传入 <var>registration</var>。</p>
            <p class="note" role="note"><span>注意：</span>如果 <a data-link-type="dfn" href="#try-clear-registration"
                id="ref-for-try-clear-registration③">尝试清除注册</a> 在这里没有触发 <a data-link-type="dfn"
                href="#clear-registration" id="ref-for-clear-registration①">清除注册</a>，<a data-link-type="dfn"
                href="#clear-registration" id="ref-for-clear-registration②">清除注册</a> 会在最后一个客户端 <a data-link-type="dfn"
                href="#dfn-use" id="ref-for-dfn-use⑦">使用</a> 注册时或在注册的服务工作线程的 <a data-link-type="dfn"
                href="#extendableevent-extend-lifetime-promises"
                id="ref-for-extendableevent-extend-lifetime-promises⑧">延长生命周期的 Promise</a> 解决时再次尝试。</p>
          </li>
          <li data-md>
            <p>调用 <a data-link-type="dfn" href="#finish-job" id="ref-for-finish-job①③">完成任务</a>，传入 <var>job</var>。</p>
          </li>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Set Registration">
        <h3 class="heading settled" id="set-registration-algorithm">
          <span class="content">
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="set-registration">设置注册</dfn>
          </span>
          <a class="self-link" href="#set-registration-algorithm"></a>
        </h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>storage key</var>，一个 <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-key"
                id="ref-for-storage-key⑦">存储键</a></p>
          </dd>
          <dd data-md>
            <p><var>scope</var>，一个 <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url"
                id="ref-for-concept-url①③">URL</a></p>
          </dd>
          <dd data-md>
            <p><var>updateViaCache</var>，一个 <a data-link-type="dfn" href="#dfn-update-via-cache"
                id="ref-for-dfn-update-via-cache⑧">缓存更新模式</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p><var>registration</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration⑤⑧">服务工作线程注册</a></p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>以原子方式运行以下步骤。</p>
          </li>
          <li data-md>
            <p>设 <var>scopeString</var> 为 <a data-link-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url-serializer"
                id="ref-for-concept-url-serializer①③">序列化的</a> <var>scope</var>，并设置 <em>排除片段标志</em>。</p>
          </li>
          <li data-md>
            <p>设 <var>registration</var> 为一个新的 <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration⑤⑨">服务工作线程注册</a>，其 <a data-link-type="dfn"
                href="#service-worker-registration-storage-key"
                id="ref-for-service-worker-registration-storage-key①④">存储键</a> 设置为 <var>storage key</var>，<a
                data-link-type="dfn" href="#dfn-scope-url" id="ref-for-dfn-scope-url①⑧">范围 URL</a> 设置为
              <var>scope</var>，<a data-link-type="dfn" href="#dfn-update-via-cache"
                id="ref-for-dfn-update-via-cache⑨">缓存更新模式</a> 设置为 <var>updateViaCache</var>。
            </p>
          </li>
          <li data-md>
            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set③">设置</a> <a
                data-link-type="dfn" href="#dfn-scope-to-registration-map"
                id="ref-for-dfn-scope-to-registration-map⑨">注册映射</a>[(<var>storage key</var>, <var>scopeString</var>)] 为
              <var>registration</var>。
            </p>
          </li>
          <li data-md>
            <p>返回 <var>registration</var>。</p>
          </li>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Clear Registration">
        <h3 class="heading settled" id="clear-registration-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="clear-registration">清除注册</dfn></span><a class="self-link"
            href="#clear-registration-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>registration</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration⑥⓪">服务工作线程注册</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p>无</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>以原子方式运行以下步骤。</p>
          </li>
          <li data-md>
            <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-installing-worker"
                id="ref-for-dfn-installing-worker①⑤">安装中的工作线程</a> 不为 null，则：</p>
            <ol>
              <li data-md>
                <p><a data-link-type="dfn" href="#terminate-service-worker"
                    id="ref-for-terminate-service-worker⑦">终止</a> <var>registration</var> 的 <a data-link-type="dfn"
                    href="#dfn-installing-worker" id="ref-for-dfn-installing-worker①⑥">安装中的工作线程</a>。</p>
              </li>
              <li data-md>
                <p>运行 <a data-link-type="dfn" href="#update-worker-state" id="ref-for-update-worker-state⑧">更新工作线程状态</a>
                  算法，传入 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-installing-worker"
                    id="ref-for-dfn-installing-worker①⑦">安装中的工作线程</a> 和
                  "<code>redundant</code>" 作为参数。</p>
              </li>
              <li data-md>
                <p>运行 <a data-link-type="dfn" href="#update-registration-state"
                    id="ref-for-update-registration-state⑥">更新注册状态</a> 算法，传入
                  <var>registration</var>、"<code>installing</code>" 和 null 作为参数。
                </p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-waiting-worker"
                id="ref-for-dfn-waiting-worker①⑤">等待中的工作线程</a> 不为 null，则：</p>
            <ol>
              <li data-md>
                <p><a data-link-type="dfn" href="#terminate-service-worker"
                    id="ref-for-terminate-service-worker⑧">终止</a> <var>registration</var> 的 <a data-link-type="dfn"
                    href="#dfn-waiting-worker" id="ref-for-dfn-waiting-worker①⑥">等待中的工作线程</a>。</p>
              </li>
              <li data-md>
                <p>运行 <a data-link-type="dfn" href="#update-worker-state" id="ref-for-update-worker-state⑨">更新工作线程状态</a>
                  算法，传入 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-waiting-worker"
                    id="ref-for-dfn-waiting-worker①⑦">等待中的工作线程</a> 和
                  "<code>redundant</code>" 作为参数。</p>
              </li>
              <li data-md>
                <p>运行 <a data-link-type="dfn" href="#update-registration-state"
                    id="ref-for-update-registration-state⑦">更新注册状态</a> 算法，传入
                  <var>registration</var>、"<code>waiting</code>" 和 null 作为参数。
                </p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                id="ref-for-dfn-active-worker④④">活跃的工作线程</a> 不为 null，则：</p>
            <ol>
              <li data-md>
                <p><a data-link-type="dfn" href="#terminate-service-worker"
                    id="ref-for-terminate-service-worker⑨">终止</a> <var>registration</var> 的 <a data-link-type="dfn"
                    href="#dfn-active-worker" id="ref-for-dfn-active-worker④⑤">活跃的工作线程</a>。</p>
              </li>
              <li data-md>
                <p>运行 <a data-link-type="dfn" href="#update-worker-state"
                    id="ref-for-update-worker-state①⓪">更新工作线程状态</a> 算法，传入 <var>registration</var> 的 <a
                    data-link-type="dfn" href="#dfn-active-worker" id="ref-for-dfn-active-worker④⑥">活跃的工作线程</a> 和
                  "<code>redundant</code>" 作为参数。</p>
              </li>
              <li data-md>
                <p>运行 <a data-link-type="dfn" href="#update-registration-state"
                    id="ref-for-update-registration-state⑧">更新注册状态</a> 算法，传入
                  <var>registration</var>、"<code>active</code>" 和 null 作为参数。
                </p>
              </li>
            </ol>
          </li>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Try Clear Registration">
        <h3 class="heading settled" id="try-clear-registration-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="try-clear-registration">尝试清除注册</dfn></span><a class="self-link"
            href="#try-clear-registration-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>registration</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration⑥①">服务工作线程注册</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p>无</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>如果没有 <a data-link-type="dfn" href="#dfn-service-worker-client"
                id="ref-for-dfn-service-worker-client④⑦">服务工作线程客户端</a> <a data-link-type="dfn" href="#dfn-use"
                id="ref-for-dfn-use⑧">使用</a> <var>registration</var>，且以下所有条件都为真，则使用 <var>registration</var> 调用 <a
                data-link-type="dfn" href="#clear-registration" id="ref-for-clear-registration③">清除注册</a>。</p>
            <ul>
              <li data-md>
                <p><var>registration</var> 的 <a data-link-type="dfn" href="#dfn-installing-worker"
                    id="ref-for-dfn-installing-worker①⑧">安装中的工作线程</a> 为 null，或运行 <a data-link-type="dfn"
                    href="#service-worker-has-no-pending-events"
                    id="ref-for-service-worker-has-no-pending-events②">服务工作线程无待处理事件</a> 的结果为 true。</p>
              </li>
              <li data-md>
                <p><var>registration</var> 的 <a data-link-type="dfn" href="#dfn-waiting-worker"
                    id="ref-for-dfn-waiting-worker①⑧">等待中的工作线程</a> 为 null，或运行 <a data-link-type="dfn"
                    href="#service-worker-has-no-pending-events"
                    id="ref-for-service-worker-has-no-pending-events③">服务工作线程无待处理事件</a> 的结果为 true。</p>
              </li>
              <li data-md>
                <p><var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                    id="ref-for-dfn-active-worker④⑦">活跃的工作线程</a> 为 null，或运行 <a data-link-type="dfn"
                    href="#service-worker-has-no-pending-events"
                    id="ref-for-service-worker-has-no-pending-events④">服务工作线程无待处理事件</a> 的结果为 true。</p>
              </li>
            </ul>
          </li>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Update Registration State">
        <h3 class="heading settled" id="update-registration-state-algorithm"><span class="content"><dfn
              class="dfn-paneled" data-dfn-type="dfn" data-noexport id="update-registration-state">更新注册状态</dfn></span><a
            class="self-link" href="#update-registration-state-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>registration</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration⑥②">服务工作线程注册</a></p>
          </dd>
          <dd data-md>
            <p><var>target</var>，一个字符串（"<code>installing</code>"、"<code>waiting</code>" 和 "<code>active</code>" 之一）</p>
          </dd>
          <dd data-md>
            <p><var>source</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker"
                id="ref-for-dfn-service-worker①⓪⓪">服务工作线程</a> 或 null</p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p>无</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>让 <var>registrationObjects</var> 成为包含所有与 <var>registration</var> 相关联的 <code
                class="idl"><a data-link-type="idl" href="#serviceworkerregistration" id="ref-for-serviceworkerregistration①⑤">ServiceWorkerRegistration</a></code>
              对象的数组。</p>
          </li>
          <li data-md>
            <p>如果 <var>target</var> 是 "<code>installing</code>"，则：</p>
            <ol>
              <li data-md>
                <p>将 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-installing-worker"
                    id="ref-for-dfn-installing-worker②⓪">安装中的工作线程</a> 设置为 <var>source</var>。</p>
              </li>
              <li data-md>
                <p>对于 <var>registrationObjects</var> 中的每个 <var>registrationObject</var>：</p>
                <ol>
                  <li data-md>
                    <p><a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                        id="ref-for-queue-a-task③⑥">排队任务</a> 以将 <var>registrationObject</var> 的 <code
                        class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-installing" id="ref-for-dom-serviceworkerregistration-installing④">installing</a></code>
                      属性设置为 null，如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-installing-worker"
                        id="ref-for-dfn-installing-worker②①">安装中的工作线程</a> 为 null，或结果为 <a data-link-type="dfn"
                        href="#get-the-service-worker-object" id="ref-for-get-the-service-worker-object⑦">获取服务工作线程对象</a>
                      代表 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-installing-worker"
                        id="ref-for-dfn-installing-worker②②">安装中的工作线程</a> 在 <var>registrationObject</var> 的 <a
                        data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                        id="ref-for-relevant-settings-object②⑧">相关设置对象</a> 中。</p>
                  </li>
                </ol>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>否则，如果 <var>target</var> 是 "<code>waiting</code>"，则：</p>
            <ol>
              <li data-md>
                <p>将 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-waiting-worker"
                    id="ref-for-dfn-waiting-worker②⓪">等待中的工作线程</a> 设置为 <var>source</var>。</p>
              </li>
              <li data-md>
                <p>对于 <var>registrationObjects</var> 中的每个 <var>registrationObject</var>：</p>
                <ol>
                  <li data-md>
                    <p><a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                        id="ref-for-queue-a-task③⑦">排队任务</a> 以将 <var>registrationObject</var> 的 <code
                        class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-waiting" id="ref-for-dom-serviceworkerregistration-waiting④">waiting</a></code>
                      属性设置为 null，如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-waiting-worker"
                        id="ref-for-dfn-waiting-worker②①">等待中的工作线程</a> 为 null，或结果为 <a data-link-type="dfn"
                        href="#get-the-service-worker-object" id="ref-for-get-the-service-worker-object⑧">获取服务工作线程对象</a>
                      代表 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-waiting-worker"
                        id="ref-for-dfn-waiting-worker②②">等待中的工作线程</a> 在 <var>registrationObject</var> 的 <a
                        data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                        id="ref-for-relevant-settings-object②⑨">相关设置对象</a> 中。</p>
                  </li>
                </ol>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>否则，如果 <var>target</var> 是 "<code>active</code>"，则：</p>
            <ol>
              <li data-md>
                <p>将 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                    id="ref-for-dfn-active-worker④⑨">活跃的工作线程</a> 设置为 <var>source</var>。</p>
              </li>
              <li data-md>
                <p>对于 <var>registrationObjects</var> 中的每个 <var>registrationObject</var>：</p>
                <ol>
                  <li data-md>
                    <p><a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                        id="ref-for-queue-a-task③⑧">排队任务</a> 以将 <var>registrationObject</var> 的 <code
                        class="idl"><a data-link-type="idl" href="#dom-serviceworkerregistration-active" id="ref-for-dom-serviceworkerregistration-active④">active</a></code>
                      属性设置为 null，如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                        id="ref-for-dfn-active-worker⑤⓪">活跃的工作线程</a> 为 null，或结果为 <a data-link-type="dfn"
                        href="#get-the-service-worker-object" id="ref-for-get-the-service-worker-object⑨">获取服务工作线程对象</a>
                      代表 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                        id="ref-for-dfn-active-worker⑤①">活跃的工作线程</a> 在 <var>registrationObject</var> 的 <a
                        data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                        id="ref-for-relevant-settings-object③⓪">相关设置对象</a> 中。</p>
                  </li>
                </ol>
              </li>
            </ol>
            <p>该 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task"
                id="ref-for-concept-task⑨">任务</a> <em>必须</em> 使用 <var>registrationObject</var> 的 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                id="ref-for-relevant-settings-object③①">相关设置对象</a> 的 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                id="ref-for-responsible-event-loop①⑧">负责的事件循环</a> 和 <a data-link-type="dfn">DOM 操作任务源</a>。</p>
          </li>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Update Worker State">
        <h3 class="heading settled" id="update-state-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="update-worker-state">更新工作线程状态</dfn></span><a class="self-link"
            href="#update-state-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>worker</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker"
                id="ref-for-dfn-service-worker①⓪①">服务工作线程</a></p>
          </dd>
          <dd data-md>
            <p><var>state</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker"
                id="ref-for-dfn-service-worker①⓪②">服务工作线程</a> 的 <a data-link-type="dfn" href="#dfn-state"
                id="ref-for-dfn-state④">状态</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p>无</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p class="assertion">断言：<var>state</var> 不是 "<code>parsed</code>"。</p>
            <p class="note" role="note"><span>注意：</span> "<code>parsed</code>" 是初始状态。<a data-link-type="dfn"
                href="#dfn-service-worker" id="ref-for-dfn-service-worker①⓪③">服务工作线程</a> 永远不会更新为此状态。</p>
          </li>
          <li data-md>
            <p>将 <var>worker</var> 的 <a data-link-type="dfn" href="#dfn-state" id="ref-for-dfn-state⑤">状态</a> 设置为
              <var>state</var>。
            </p>
          </li>
          <li data-md>
            <p>让 <var>settingsObjects</var> 成为所有 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                id="ref-for-environment-settings-object②③">环境设置对象</a> 的集合，其 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                id="ref-for-concept-settings-object-origin①⑨">源</a> 是 <var>worker</var> 的 <a data-link-type="dfn"
                href="#dfn-script-url" id="ref-for-dfn-script-url①⓪">脚本 URL</a> 的 <a data-link-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin⑨">源</a>。</p>
          </li>
          <li data-md>
            <p>对于 <var>settingsObjects</var> 中的每个 <var>settingsObject</var>，<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                id="ref-for-queue-a-task③⑨">排队任务</a> 到 <var>settingsObject</var> 的 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                id="ref-for-responsible-event-loop①⑨">负责的事件循环</a>，在 <a data-link-type="dfn">DOM 操作任务源</a> 上运行以下步骤：</p>
            <ol>
              <li data-md>
                <p>让 <var>objectMap</var> 成为 <var>settingsObject</var> 的 <a data-link-type="dfn"
                    href="#environment-settings-object-service-worker-object-map"
                    id="ref-for-environment-settings-object-service-worker-object-map①">服务工作线程对象映射</a>。</p>
              </li>
              <li data-md>
                <p>如果 <var>objectMap</var>[<var>worker</var>] 不 <a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑦">存在</a>，则中止这些步骤。</p>
              </li>
              <li data-md>
                <p>让 <var>workerObj</var> 成为 <var>objectMap</var>[<var>worker</var>]。</p>
              </li>
              <li data-md>
                <p>将 <var>workerObj</var> 的 <code
                    class="idl"><a data-link-type="idl" href="#dom-serviceworker-state" id="ref-for-dom-serviceworker-state④">状态</a></code>
                  设置为 <var>state</var>。</p>
              </li>
              <li data-md>
                <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire"
                    id="ref-for-concept-event-fire②">触发</a> 一个名为 <code
                    class="idl"><a class="idl-code" data-link-type="event" href="#eventdef-serviceworker-statechange" id="ref-for-eventdef-serviceworker-statechange①">statechange</a></code>
                  的事件，目标是 <var>workerObj</var>。</p>
              </li>
            </ol>
          </li>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Notify Controller Change">
        <h3 class="heading settled" id="notify-controller-change-algorithm"><span class="content"><dfn
              class="dfn-paneled" data-dfn-type="dfn" data-noexport id="notify-controller-change">通知控制器更改</dfn></span><a
            class="self-link" href="#notify-controller-change-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>client</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker-client"
                id="ref-for-dfn-service-worker-client④⑧">服务工作线程客户端</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p>无</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p class="assertion">断言：<var>client</var> 不为 null。</p>
          </li>
          <li data-md>
            <p>如果 <var>client</var> 是一个 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                id="ref-for-environment-settings-object②④">环境设置对象</a>，则<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                id="ref-for-queue-a-task④⓪">排队任务</a>，<a data-link-type="dfn"
                href="https://dom.spec.whatwg.org/#concept-event-fire" id="ref-for-concept-event-fire③">触发</a>一个名为
              <code>controllerchange</code> 的事件，目标是 <var>client</var> 关联的 <code
                class="idl"><a data-link-type="idl" href="#serviceworkercontainer" id="ref-for-serviceworkercontainer①⑥">ServiceWorkerContainer</a></code>
              对象。
            </p>
          </li>
        </ol>
        <p>该<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task"
            id="ref-for-concept-task①⓪">任务</a><em>必须</em>使用 <var>client</var> 的<a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
            id="ref-for-responsible-event-loop②⓪">负责的事件循环</a>和<a data-link-type="dfn">DOM 操作任务源</a>。</p>
      </section>

      <section class="algorithm" data-algorithm="Match Service Worker Registration">
        <h3 class="heading settled" id="scope-match-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-export id="match-service-worker-registration">匹配服务工作线程注册</dfn></span><a
            class="self-link" href="#scope-match-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>storage key</var>，一个 <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-key"
                id="ref-for-storage-key⑧">存储键</a></p>
          </dd>
          <dd data-md>
            <p><var>clientURL</var>，一个 <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url"
                id="ref-for-concept-url①④">URL</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p>一个 <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration⑥③">服务工作线程注册</a></p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>按原子步骤执行以下步骤。</p>
          </li>
          <li data-md>
            <p>让 <var>clientURLString</var> 成为序列化后的 <var>clientURL</var>。</p>
          </li>
          <li data-md>
            <p>让 <var>matchingScopeString</var> 为空字符串。</p>
          </li>
          <li data-md>
            <p>让 <var>scopeStringSet</var> 成为空列表。</p>
          </li>
          <li data-md>
            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate"
                id="ref-for-map-iterate⑧">对于</a>
              (<var>entry storage key</var>，<var>entry scope</var>) → <var>registration</var> 在 <a data-link-type="dfn"
                href="#dfn-scope-to-registration-map" id="ref-for-dfn-scope-to-registration-map①⓪">注册映射</a> 中的每个项：</p>
            <ol>
              <li data-md>
                <p>如果 <var>storage key</var> <a data-link-type="dfn"
                    href="https://storage.spec.whatwg.org/#storage-key-equal" id="ref-for-storage-key-equal⑤">等于</a>
                  <var>entry storage key</var>，则<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append⑦">将</a> <var>entry
                    scope</var>
                  附加到 <var>scopeStringSet</var> 的末尾。
                </p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>如果存在，设置 <var>matchingScopeString</var> 为 <var>scopeStringSet</var> 中以 <var>clientURLString</var>
              开头的最长值。</p>
            <p class="note" role="note"><span>注意：</span> 此步骤中的 URL 字符串匹配是基于前缀的，而不是路径结构的。例如，具有
              "https://example.com/prefix-of/resource.html" 的客户端 URL 字符串将匹配具有 "https://example.com/prefix"
              的作用域的注册。URL 字符串比较对于同源安全是安全的，因为 HTTP(S) URL 始终在 URL 的源部分末尾以斜杠结尾
              进行序列化。</p>
          </li>
          <li data-md>
            <p>让 <var>matchingScope</var> 为空。</p>
          </li>
          <li data-md>
            <p>如果 <var>matchingScopeString</var> 不是空字符串，则：</p>
            <ol>
              <li data-md>
                <p>将 <var>matchingScope</var> 设置为 <a data-link-type="dfn"
                    href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser⑧">解析</a>
                  <var>matchingScopeString</var> 的结果。
                </p>
              </li>
              <li data-md>
                <p class="assertion">断言：<var>matchingScope</var> 的<a data-link-type="dfn"
                    href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin①⓪">源</a>和
                  <var>clientURL</var> 的<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin"
                    id="ref-for-concept-url-origin①①">源</a>是
                  <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin"
                    id="ref-for-same-origin⑥">同源</a>。
                </p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>返回运行 <a data-link-type="dfn" href="#get-registration" id="ref-for-get-registration③">获取注册</a> 给定
              <var>storage key</var> 和 <var>matchingScope</var> 的结果。
            </p>
          </li>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Get Registration">
        <h3 class="heading settled" id="get-registration-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="get-registration">获取注册</dfn></span><a class="self-link"
            href="#get-registration-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>storage key</var>，一个 <a data-link-type="dfn" href="https://storage.spec.whatwg.org/#storage-key"
                id="ref-for-storage-key⑨">存储键</a></p>
          </dd>
          <dd data-md>
            <p><var>scope</var>，一个 <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url"
                id="ref-for-concept-url①⑤">URL</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p>一个 <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration⑥④">服务工作线程注册</a></p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>按原子步骤执行以下步骤。</p>
          </li>
          <li data-md>
            <p>让 <var>scopeString</var> 为空字符串。</p>
          </li>
          <li data-md>
            <p>如果 <var>scope</var> 不为 null，则将 <var>scopeString</var> 设置为序列化的 <var>scope</var>，并设置
              <em>排除片段标志</em>。
            </p>
          </li>
          <li data-md>
            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate"
                id="ref-for-map-iterate⑨">对于</a>
              (<var>entry storage key</var>，<var>entry scope</var>) → <var>registration</var> 在 <a data-link-type="dfn"
                href="#dfn-scope-to-registration-map" id="ref-for-dfn-scope-to-registration-map①①">注册映射</a> 中的每个项：</p>
            <ol>
              <li data-md>
                <p>如果 <var>storage key</var> <a data-link-type="dfn"
                    href="https://storage.spec.whatwg.org/#storage-key-equal" id="ref-for-storage-key-equal⑥">等于</a>
                  <var>entry storage key</var> 且 <var>scopeString</var> 匹配 <var>entry scope</var>，则返回
                  <var>registration</var>。
                </p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>返回 null。</p>
          </li>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Get Newest Worker">
        <h3 class="heading settled" id="get-newest-worker-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="get-newest-worker">获取最新工作线程</dfn></span><a class="self-link"
            href="#get-newest-worker-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>registration</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker-registration"
                id="ref-for-dfn-service-worker-registration⑥⑤">服务工作线程注册</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p><var>newestWorker</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker"
                id="ref-for-dfn-service-worker①⓪④">服务工作线程</a></p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>按原子步骤执行以下步骤。</p>
          </li>
          <li data-md>
            <p>让 <var>newestWorker</var> 为空。</p>
          </li>
          <li data-md>
            <p>如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-installing-worker"
                id="ref-for-dfn-installing-worker②③">正在安装的工作线程</a> 不为 null，则将 <var>newestWorker</var> 设置为
              <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-installing-worker"
                id="ref-for-dfn-installing-worker②④">正在安装的工作线程</a>。
            </p>
          </li>
          <li data-md>
            <p>否则，如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-waiting-worker"
                id="ref-for-dfn-waiting-worker②③">等待中的工作线程</a> 不为 null，则将 <var>newestWorker</var> 设置为
              <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-waiting-worker"
                id="ref-for-dfn-waiting-worker②④">等待中的工作线程</a>。
            </p>
          </li>
          <li data-md>
            <p>否则，如果 <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                id="ref-for-dfn-active-worker⑤②">活跃的工作线程</a> 不为 null，则将 <var>newestWorker</var> 设置为
              <var>registration</var> 的 <a data-link-type="dfn" href="#dfn-active-worker"
                id="ref-for-dfn-active-worker⑤③">活跃的工作线程</a>。
            </p>
          </li>
          <li data-md>
            <p>返回 <var>newestWorker</var>。</p>
          </li>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Service Worker Has No Pending Events">
        <h3 class="heading settled" id="service-worker-has-no-pending-events-algorithm"><span class="content"><dfn
              class="dfn-paneled" data-dfn-type="dfn" data-noexport
              id="service-worker-has-no-pending-events">服务工作线程没有待处理的事件</dfn></span><a class="self-link"
            href="#service-worker-has-no-pending-events-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>worker</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker"
                id="ref-for-dfn-service-worker①⓪⑤">服务工作线程</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p>True 或 false，一个布尔值</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>对于 <var>worker</var> 的 <a data-link-type="dfn" href="#dfn-set-of-extended-events"
                id="ref-for-dfn-set-of-extended-events④">扩展事件集</a> 中的每个
              <var>event</var>：
            </p>
            <ol>
              <li data-md>
                <p>如果 <var>event</var> 是 <a data-link-type="dfn" href="#extendableevent-active"
                    id="ref-for-extendableevent-active⑤">活跃的</a>，则返回 false。</p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>返回 true。</p>
          </li>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Create Client">
        <h3 class="heading settled" id="create-client-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="create-client">创建客户端</dfn></span><a class="self-link"
            href="#create-client-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>client</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker-client"
                id="ref-for-dfn-service-worker-client④⑨">服务工作线程客户端</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p><var>clientObject</var>，一个 <code class="idl"><a data-link-type="idl" href="#client"
              id="ref-for-client①①">客户端</a></code> 对象</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>让 <var>clientObject</var> 成为一个新的 <code class="idl"><a data-link-type="idl"
              href="#client" id="ref-for-client①②">客户端</a></code> 对象。</p>
          </li>
          <li data-md>
            <p>将 <var>clientObject</var> 的 <a data-link-type="dfn"
                href="#dfn-service-worker-client-service-worker-client"
                id="ref-for-dfn-service-worker-client-service-worker-client①③">服务工作线程客户端</a> 设置为 <var>client</var>。</p>
          </li>
          <li data-md>
            <p>返回 <var>clientObject</var>。</p>
          </li>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Create Window Client">
        <h3 class="heading settled" id="create-windowclient-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="create-window-client">创建窗口客户端</dfn></span><a class="self-link"
            href="#create-windowclient-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>client</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker-client"
                id="ref-for-dfn-service-worker-client⑤⓪">服务工作线程客户端</a></p>
          </dd>
          <dd data-md>
            <p><var>frameType</var>，一个字符串</p>
          </dd>
          <dd data-md>
            <p><var>visibilityState</var>，一个字符串</p>
          </dd>
          <dd data-md>
            <p><var>focusState</var>，一个布尔值</p>
          </dd>
          <dd data-md>
            <p><var>ancestorOriginsList</var>，一个列表</p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p><var>windowClient</var>，一个 <code class="idl"><a data-link-type="idl" href="#windowclient"
                  id="ref-for-windowclient①⓪">WindowClient</a></code> 对象</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>让 <var>windowClient</var> 成为一个新的 <code class="idl"><a data-link-type="idl" href="#windowclient"
                  id="ref-for-windowclient①①">WindowClient</a></code> 对象。</p>
          </li>
          <li data-md>
            <p>将 <var>windowClient</var> 的 <a data-link-type="dfn"
                href="#dfn-service-worker-client-service-worker-client"
                id="ref-for-dfn-service-worker-client-service-worker-client①④">服务工作线程客户端</a> 设置为 <var>client</var>。</p>
          </li>
          <li data-md>
            <p>将 <var>windowClient</var> 的 <a data-link-type="dfn" href="#dfn-service-worker-client-frame-type"
                id="ref-for-dfn-service-worker-client-frame-type①">框架类型</a> 设置为 <var>frameType</var>。</p>
          </li>
          <li data-md>
            <p>将 <var>windowClient</var> 的 <a data-link-type="dfn" href="#dfn-service-worker-client-visibilitystate"
                id="ref-for-dfn-service-worker-client-visibilitystate①">可见状态</a> 设置为 <var>visibilityState</var>。</p>
          </li>
          <li data-md>
            <p>将 <var>windowClient</var> 的 <a data-link-type="dfn" href="#dfn-service-worker-client-focusstate"
                id="ref-for-dfn-service-worker-client-focusstate②">焦点状态</a> 设置为 <var>focusState</var>。</p>
          </li>
          <li data-md>
            <p>将 <var>windowClient</var> 的 <a data-link-type="dfn" href="#windowclient-ancestor-origins-array"
                id="ref-for-windowclient-ancestor-origins-array①">祖先来源数组</a> 设置为由 <var>ancestorOriginsList</var> 创建的
              <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-frozen-array-type"
                id="ref-for-dfn-frozen-array-type④">冻结数组</a>。
            </p>
          </li>
          <li data-md>
            <p>返回 <var>windowClient</var>。</p>
          </li>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Get Frame Type">
        <h3 class="heading settled" id="get-frametype-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="get-frame-type">获取框架类型</dfn></span><a class="self-link"
            href="#get-frametype-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>browsingContext</var>，一个 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context"
                id="ref-for-browsing-context⑦">浏览上下文</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p><var>frameType</var>，一个字符串</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>通过切换 <var>browsingContext</var> 的类型，返回相应的值：</p>
            <dl>
              <dt data-md><a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/browsers.html#nested-browsing-context"
                  id="ref-for-nested-browsing-context">嵌套浏览上下文</a></dt>
              <dd data-md>
                <p>"nested"</p>
              </dd>
              <dt data-md><a data-link-type="dfn"
                  href="https://html.spec.whatwg.org/multipage/browsers.html#auxiliary-browsing-context"
                  id="ref-for-auxiliary-browsing-context">辅助浏览上下文</a></dt>
              <dd data-md>
                <p>"auxiliary"</p>
              </dd>
              <dt data-md>否则</dt>
              <dd data-md>
                <p>"top-level"</p>
              </dd>
            </dl>
          </li>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Resolve Get Client Promise">
        <h3 class="heading settled" id="resolve-get-client-promise-algorithm"><span class="content"><dfn
              class="dfn-paneled" data-dfn-type="dfn" data-noexport id="resolve-get-client-promise">解析获取客户端的
              Promise</dfn></span><a class="self-link" href="#resolve-get-client-promise-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>client</var>，一个 <a data-link-type="dfn" href="#dfn-service-worker-client"
                id="ref-for-dfn-service-worker-client⑤①">服务工作线程客户端</a></p>
          </dd>
          <dd data-md>
            <p><var>promise</var>，一个 <a data-link-type="dfn" href="http://tc39.github.io/ecma262/#sec-promise-objects"
                id="ref-for-sec-promise-objects③⓪">Promise</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p>无</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>如果 <var>client</var> 是一个 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                id="ref-for-environment-settings-object②⑤">环境设置对象</a>，则：</p>
            <ol>
              <li data-md>
                <p>如果 <var>client</var> 不是一个 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context"
                    id="ref-for-secure-context⑤">安全上下文</a>，<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                    id="ref-for-queue-a-task④①">排队任务</a>以一个 "<code
                    class="idl"><a data-link-type="idl"
                    href="https://webidl.spec.whatwg.org/#securityerror" id="ref-for-securityerror⑧">SecurityError</a></code>"
                  <code
                    class="idl"><a data-link-type="idl"
                    href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException②④">DOMException</a></code>
                  拒绝 <var>promise</var>，在 <var>promise</var> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                    id="ref-for-relevant-settings-object③②">相关设置对象</a>的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                    id="ref-for-responsible-event-loop②①">负责的事件循环</a> 上使用 <a data-link-type="dfn">DOM 操作任务源</a>，并中止这些步骤。
                </p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>否则：</p>
            <ol>
              <li data-md>
                <p>如果 <var>client</var> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url"
                    id="ref-for-concept-environment-creation-url⑨">创建 URL</a> 不是一个 <a data-link-type="dfn"
                    href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url"
                    id="ref-for-potentially-trustworthy-url①">潜在可信 URL</a>，<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                    id="ref-for-queue-a-task④②">排队任务</a>以一个 "<code
                    class="idl"><a data-link-type="idl"
                    href="https://webidl.spec.whatwg.org/#securityerror" id="ref-for-securityerror⑨">SecurityError</a></code>"
                  <code
                    class="idl"><a data-link-type="idl"
                    href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException②⑤">DOMException</a></code>
                  拒绝 <var>promise</var>，在 <var>promise</var> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                    id="ref-for-relevant-settings-object③③">相关设置对象</a>的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                    id="ref-for-responsible-event-loop②②">负责的事件循环</a> 上使用 <a data-link-type="dfn">DOM 操作任务源</a>，并中止这些步骤。
                </p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>如果 <var>client</var> 是一个 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                id="ref-for-environment-settings-object②⑥">环境设置对象</a> 并且不是一个 <a data-link-type="dfn"
                href="#dfn-window-client" id="ref-for-dfn-window-client①④">窗口客户端</a>，则：</p>
            <ol>
              <li data-md>
                <p>让 <var>clientObject</var> 成为运行 <a data-link-type="dfn" href="#create-client"
                    id="ref-for-create-client①">创建客户端</a> 算法的结果，参数为 <var>client</var>。</p>
              </li>
              <li data-md>
                <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                    id="ref-for-queue-a-task④③">排队任务</a>以 <var>clientObject</var> 解析 <var>promise</var>，在
                  <var>promise</var> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                    id="ref-for-relevant-settings-object③④">相关设置对象</a>的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                    id="ref-for-responsible-event-loop②③">负责的事件循环</a> 上使用 <a data-link-type="dfn">DOM 操作任务源</a>，并中止这些步骤。
                </p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>否则：</p>
            <ol>
              <li data-md>
                <p>让 <var>browsingContext</var> 为空。</p>
              </li>
              <li data-md>
                <p>如果 <var>client</var> 是一个 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                    id="ref-for-environment-settings-object②⑦">环境设置对象</a>，将 <var>browsingContext</var> 设置为
                  <var>client</var> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                    id="ref-for-concept-settings-object-global①②">全局对象</a> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context"
                    id="ref-for-browsing-context⑧">浏览上下文</a>。
                </p>
              </li>
              <li data-md>
                <p>否则，将 <var>browsingContext</var> 设置为 <var>client</var> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context"
                    id="ref-for-concept-environment-target-browsing-context②">目标浏览上下文</a>。</p>
              </li>
              <li data-md>
                <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                    id="ref-for-queue-a-task④④">排队任务</a> 在 <var>browsingContext</var> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop"
                    id="ref-for-event-loop①⑥">事件循环</a> 上使用 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source"
                    id="ref-for-user-interaction-task-source④">用户交互任务源</a> 执行以下步骤：</p>
                <ol>
                  <li data-md>
                    <p>让 <var>frameType</var> 成为运行 <a data-link-type="dfn" href="#get-frame-type"
                        id="ref-for-get-frame-type④">获取框架类型</a> 算法的结果，参数为 <var>browsingContext</var>。</p>
                  </li>
                  <li data-md>
                    <p>让 <var>visibilityState</var> 成为 <var>browsingContext</var> 的 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                        id="ref-for-active-document①④">活动文档</a> 的 <code class="idl"><a data-link-type="idl"
                          href="https://www.w3.org/TR/page-visibility/#dom-document-visibilitystate"
                          id="ref-for-dom-document-visibilitystate⑤">visibilityState</a></code> 属性值。</p>
                  </li>
                  <li data-md>
                    <p>让 <var>focusState</var> 成为运行 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/interaction.html#has-focus-steps"
                        id="ref-for-has-focus-steps④">具有焦点的步骤</a> 的结果，参数为 <var>browsingContext</var> 的
                      <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                        id="ref-for-active-document①⑤">活动文档</a>。
                    </p>
                  </li>
                  <li data-md>
                    <p>让 <var>ancestorOriginsList</var> 为空列表。</p>
                  </li>
                  <li data-md>
                    <p>如果 <var>client</var> 是一个 <a data-link-type="dfn" href="#dfn-window-client"
                        id="ref-for-dfn-window-client①⑤">窗口客户端</a>，将 <var>ancestorOriginsList</var> 设置为
                      <var>browsingContext</var> 的 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/browsers.html#active-document"
                        id="ref-for-active-document①⑥">活动文档</a> 的 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"
                        id="ref-for-concept-relevant-global⑧">相关全局对象</a> 的 <code class="idl"><a data-link-type="idl"
                          href="https://html.spec.whatwg.org/multipage/history.html#location"
                          id="ref-for-location④">Location</a></code> 对象的
                      <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/browsers.html#concept-location-ancestor-origins-list"
                        id="ref-for-concept-location-ancestor-origins-list④">祖先来源列表</a> 的关联列表。
                    </p>
                  </li>
                  <li data-md>
                    <p><a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                        id="ref-for-queue-a-task④⑤">排队任务</a> 在 <var>promise</var> 的 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                        id="ref-for-relevant-settings-object③⑤">相关设置对象</a> 的 <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop"
                        id="ref-for-responsible-event-loop②④">负责的事件循环</a> 上使用 <a data-link-type="dfn">DOM 操作任务源</a>
                      执行以下步骤：</p>
                    <ol>
                      <li data-md>
                        <p>如果 <var>client</var> 的 <a data-link-type="dfn" href="#service-worker-client-discarded-flag"
                            id="ref-for-service-worker-client-discarded-flag⑤">丢弃标志</a> 已设置，使用 undefined 解析
                          <var>promise</var> 并中止这些步骤。
                        </p>
                      </li>
                      <li data-md>
                        <p>让 <var>windowClient</var> 成为运行 <a data-link-type="dfn" href="#create-window-client"
                            id="ref-for-create-window-client④">创建窗口客户端</a> 算法的结果，参数为 <var>client</var>、
                          <var>frameType</var>、<var>visibilityState</var>、<var>focusState</var> 和
                          <var>ancestorOriginsList</var>。
                        </p>
                      </li>
                      <li data-md>
                        <p>使用 <var>windowClient</var> 解析 <var>promise</var>。</p>
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
            </ol>
          </li>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Query Cache">
        <h3 class="heading settled" id="query-cache-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="query-cache">查询缓存</dfn></span><a class="self-link"
            href="#query-cache-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>requestQuery</var>，一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                id="ref-for-concept-request⑦">请求</a></p>
          </dd>
          <dd data-md>
            <p><var>options</var>，一个 <code class="idl"><a data-link-type="idl"
                  href="#dictdef-cachequeryoptions"
                  id="ref-for-dictdef-cachequeryoptions⑥">CacheQueryOptions</a></code> 对象，可选</p>
          </dd>
          <dd data-md>
            <p><var>targetStorage</var>，一个 <a data-link-type="dfn" href="#dfn-request-response-list"
                id="ref-for-dfn-request-response-list⑥">请求响应列表</a>，可选</p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p><var>resultList</var>，一个 <a data-link-type="dfn" href="#dfn-request-response-list"
                id="ref-for-dfn-request-response-list⑦">请求响应列表</a></p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>让 <var>resultList</var> 成为空的 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                id="ref-for-list②⓪">列表</a>。</p>
          </li>
          <li data-md>
            <p>让 <var>storage</var> 为空。</p>
          </li>
          <li data-md>
            <p>如果可选参数 <var>targetStorage</var> 被省略，设置 <var>storage</var> 为 <a data-link-type="dfn"
                href="#dfn-relevant-request-response-list"
                id="ref-for-dfn-relevant-request-response-list②">相关的请求响应列表</a>。</p>
          </li>
          <li data-md>
            <p>否则，将 <var>storage</var> 设置为 <var>targetStorage</var>。</p>
          </li>
          <li data-md>
            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                id="ref-for-list-iterate①④">对于</a> <var>storage</var> 中的每个 <var>requestResponse</var>：</p>
            <ol>
              <li data-md>
                <p>让 <var>cachedRequest</var> 成为 <var>requestResponse</var> 的请求。</p>
              </li>
              <li data-md>
                <p>让 <var>cachedResponse</var> 成为 <var>requestResponse</var> 的响应。</p>
              </li>
              <li data-md>
                <p>如果 <a data-link-type="dfn" href="#request-matches-cached-item"
                    id="ref-for-request-matches-cached-item">请求匹配缓存项</a> 算法的结果为 true，参数为
                  <var>requestQuery</var>、<var>cachedRequest</var>、<var>cachedResponse</var> 和
                  <var>options</var>，则：
                </p>
                <ol>
                  <li data-md>
                    <p>让 <var>requestCopy</var> 成为 <var>cachedRequest</var> 的副本。</p>
                  </li>
                  <li data-md>
                    <p>让 <var>responseCopy</var> 成为 <var>cachedResponse</var> 的副本。</p>
                  </li>
                  <li data-md>
                    <p>将 <var>requestCopy</var>/<var>responseCopy</var> 添加到 <var>resultList</var> 中。</p>
                  </li>
                </ol>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>返回 <var>resultList</var>。</p>
          </li>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Request Matches Cached Item">
        <h3 class="heading settled" id="request-matches-cached-item-algorithm"><span class="content"><dfn
              class="dfn-paneled" data-dfn-type="dfn" data-export
              id="request-matches-cached-item">请求匹配缓存项</dfn></span><a class="self-link"
            href="#request-matches-cached-item-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>requestQuery</var>，一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                id="ref-for-concept-request⑧">请求</a></p>
          </dd>
          <dd data-md>
            <p><var>request</var>，一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                id="ref-for-concept-request⑨">请求</a></p>
          </dd>
          <dd data-md>
            <p><var>response</var>，一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
                id="ref-for-concept-response①⓪">响应</a> 或 null，可选，默认值为 null</p>
          </dd>
          <dd data-md>
            <p><var>options</var>，一个 <code class="idl"><a data-link-type="idl"
                  href="#dictdef-cachequeryoptions"
                  id="ref-for-dictdef-cachequeryoptions⑦">CacheQueryOptions</a></code> 对象，可选</p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p>一个布尔值</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>如果 <var>options</var>["<code class="idl"><a data-link-type="idl"
                  href="#dom-cachequeryoptions-ignoremethod"
                  id="ref-for-dom-cachequeryoptions-ignoremethod">ignoreMethod</a></code>"] 为 false 且
              <var>request</var> 的
              <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-method"
                id="ref-for-concept-request-method⑥">方法</a> 不是 `<code>GET</code>`，则返回 false。
            </p>
          </li>
          <li data-md>
            <p>让 <var>queryURL</var> 成为 <var>requestQuery</var> 的 <a data-link-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url①⓪">url</a>。
            </p>
          </li>
          <li data-md>
            <p>让 <var>cachedURL</var> 成为 <var>request</var> 的 <a data-link-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url①①">url</a>。
            </p>
          </li>
          <li data-md>
            <p>如果 <var>options</var>["<code class="idl"><a data-link-type="idl"
                  href="#dom-cachequeryoptions-ignoresearch"
                  id="ref-for-dom-cachequeryoptions-ignoresearch">ignoreSearch</a></code>"] 为 true，则：</p>
            <ol>
              <li data-md>
                <p>将 <var>cachedURL</var> 的 <a data-link-type="dfn"
                    href="https://url.spec.whatwg.org/#concept-url-query" id="ref-for-concept-url-query">查询</a> 设置为空字符串。
                </p>
              </li>
              <li data-md>
                <p>将 <var>queryURL</var> 的 <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-query"
                    id="ref-for-concept-url-query①">查询</a> 设置为空字符串。</p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>如果 <var>queryURL</var> 在设置了 <em>排除片段标志</em> 时不 <a data-link-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url-equals" id="ref-for-concept-url-equals②">等于</a>
              <var>cachedURL</var>，则返回 false。
            </p>
          </li>
          <li data-md>
            <p>如果 <var>response</var> 为 null，<var>options</var>["<code class="idl"><a data-link-type="idl"
                  href="#dom-cachequeryoptions-ignorevary"
                  id="ref-for-dom-cachequeryoptions-ignorevary">ignoreVary</a></code>"] 为 true，或
              <var>response</var> 的 <a data-link-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-response-header-list"
                id="ref-for-concept-response-header-list⑤">头列表</a> 不 <a data-link-type="dfn"
                href="https://fetch.spec.whatwg.org/#header-list-contains" id="ref-for-header-list-contains">包含</a>
              `<code>Vary</code>`，则返回 true。
            </p>
          </li>
          <li data-md>
            <p>让 <var>fieldValues</var> 成为包含元素的 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                id="ref-for-list②①">列表</a>，这些元素对应于 <a data-link-type="dfn"
                href="https://tools.ietf.org/html/rfc7230#section-3.2" id="ref-for-section-3.2②">字段值</a> 中的 <a
                data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-7.1.4"
                id="ref-for-section-7.1.4②">Vary</a> 头的 <a data-link-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-header-value" id="ref-for-concept-header-value①">值</a> 的 <a
                data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header"
                id="ref-for-concept-header③">头</a> 中 <a data-link-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-header-name" id="ref-for-concept-header-name③">名称</a> 为
              `<code>Vary</code>` 的元素。</p>
          </li>
          <li data-md>
            <p>对于 <var>fieldValues</var> 中的每个 <var>fieldValue</var>：</p>
            <ol>
              <li data-md>
                <p>如果 <var>fieldValue</var> 匹配 "<code>*</code>"，或 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-header-list-combine"
                    id="ref-for-concept-header-list-combine">组合值</a> 给定 <var>fieldValue</var> 和 <var>request</var> 的
                  <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list"
                    id="ref-for-concept-request-header-list②">头列表</a> 不匹配 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-header-list-combine"
                    id="ref-for-concept-header-list-combine①">组合值</a> 给定 <var>fieldValue</var> 和
                  <var>requestQuery</var> 的 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-header-list"
                    id="ref-for-concept-request-header-list③">头列表</a>，则返回 false。
                </p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>返回 true。</p>
          </li>
        </ol>
      </section>

      <section class="algorithm" data-algorithm="Batch Cache Operations">
        <h3 class="heading settled" id="batch-cache-operations-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="batch-cache-operations">批量缓存操作</dfn></span><a class="self-link"
            href="#batch-cache-operations-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>operations</var>，一个 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                id="ref-for-list②②">列表</a>，包含 <a data-link-type="dfn" href="#dfn-cache-batch-operation"
                id="ref-for-dfn-cache-batch-operation③">缓存批量操作</a> 对象</p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p><var>resultList</var>，一个 <a data-link-type="dfn" href="#dfn-request-response-list"
                id="ref-for-dfn-request-response-list⑧">请求响应列表</a></p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>让 <var>cache</var> 成为 <a data-link-type="dfn" href="#dfn-relevant-request-response-list"
                id="ref-for-dfn-relevant-request-response-list③">相关的请求响应列表</a>。</p>
          </li>
          <li data-md>
            <p>让 <var>backupCache</var> 成为一个新的 <a data-link-type="dfn" href="#dfn-request-response-list"
                id="ref-for-dfn-request-response-list⑨">请求响应列表</a>，它是 <var>cache</var> 的副本。</p>
          </li>
          <li data-md>
            <p>让 <var>addedItems</var> 成为空的 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                id="ref-for-list②③">列表</a>。</p>
          </li>
          <li data-md>
            <p>尝试以原子方式运行以下子步骤：</p>
            <ol>
              <li data-md>
                <p>让 <var>resultList</var> 成为空的 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                    id="ref-for-list②④">列表</a>。</p>
              </li>
              <li data-md>
                <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                    id="ref-for-list-iterate①⑤">对于</a> <var>operations</var> 中的每个 <var>operation</var>：</p>
                <ol>
                  <li data-md>
                    <p>如果 <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-type"
                        id="ref-for-dfn-cache-batch-operation-type③">类型</a> 既不匹配 "<code>delete</code>" 也不匹配
                      "<code>put</code>"，<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw"
                        id="ref-for-dfn-throw①④">抛出</a> <code>TypeError</code>。</p>
                  </li>
                  <li data-md>
                    <p>如果 <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-type"
                        id="ref-for-dfn-cache-batch-operation-type④">类型</a> 匹配 "<code>delete</code>" 且
                      <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-response"
                        id="ref-for-dfn-cache-batch-operation-response②">响应</a> 不为 null，<a data-link-type="dfn"
                        href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw①⑤">抛出</a>
                      <code>TypeError</code>。
                    </p>
                  </li>
                  <li data-md>
                    <p>如果运行 <a data-link-type="dfn" href="#query-cache" id="ref-for-query-cache②">查询缓存</a> 算法的结果为非空，参数为
                      <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-request"
                        id="ref-for-dfn-cache-batch-operation-request③">请求</a>、<var>operation</var> 的 <a
                        data-link-type="dfn" href="#dfn-cache-batch-operation-options"
                        id="ref-for-dfn-cache-batch-operation-options①">选项</a> 和 <var>addedItems</var>，<a
                        data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw"
                        id="ref-for-dfn-throw①⑥">抛出</a>
                      "<code class="idl"><a data-link-type="idl"
                          href="https://webidl.spec.whatwg.org/#invalidstateerror"
                          id="ref-for-invalidstateerror①⓪">InvalidStateError</a></code>"
                      <code class="idl"><a data-link-type="idl"
                          href="https://webidl.spec.whatwg.org/#idl-DOMException"
                          id="ref-for-idl-DOMException②⑥">DOMException</a></code>。
                    </p>
                  </li>
                  <li data-md>
                    <p>让 <var>requestResponses</var> 成为空的 <a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#list" id="ref-for-list②⑤">列表</a>。</p>
                  </li>
                  <li data-md>
                    <p>如果 <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-type"
                        id="ref-for-dfn-cache-batch-operation-type⑤">类型</a> 匹配 "<code>delete</code>"，则：</p>
                    <ol>
                      <li data-md>
                        <p>将 <var>requestResponses</var> 设置为运行 <a data-link-type="dfn" href="#query-cache"
                            id="ref-for-query-cache③">查询缓存</a> 算法的结果，参数为 <var>operation</var> 的 <a data-link-type="dfn"
                            href="#dfn-cache-batch-operation-request"
                            id="ref-for-dfn-cache-batch-operation-request④">请求</a> 和 <var>operation</var> 的 <a
                            data-link-type="dfn" href="#dfn-cache-batch-operation-options"
                            id="ref-for-dfn-cache-batch-operation-options②">选项</a>。</p>
                      </li>
                      <li data-md>
                        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate①⑥">对于</a> <var>requestResponses</var> 中的每个
                          <var>requestResponse</var>：
                        </p>
                        <ol>
                          <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove"
                                id="ref-for-list-remove②">移除</a> <a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#list-item" id="ref-for-list-item①①">项</a> 其值与
                              <var>requestResponse</var> 匹配的对象从 <var>cache</var>。
                            </p>
                          </li>
                        </ol>
                      </li>
                    </ol>
                  </li>
                  <li data-md>
                    <p>否则，如果 <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-type"
                        id="ref-for-dfn-cache-batch-operation-type⑥">类型</a> 匹配 "<code>put</code>"，则：</p>
                    <ol>
                      <li data-md>
                        <p>如果 <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-response"
                            id="ref-for-dfn-cache-batch-operation-response③">响应</a> 为空，<a data-link-type="dfn"
                            href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw①⑦">抛出</a>
                          <code>TypeError</code>。
                        </p>
                      </li>
                      <li data-md>
                        <p>让 <var>r</var> 成为 <var>operation</var> 的 <a data-link-type="dfn"
                            href="#dfn-cache-batch-operation-request"
                            id="ref-for-dfn-cache-batch-operation-request⑤">请求</a> 关联的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-request"
                            id="ref-for-concept-request-request①⓪">请求</a>。</p>
                      </li>
                      <li data-md>
                        <p>如果 <var>r</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-url"
                            id="ref-for-concept-request-url①②">URL</a> 的 <a data-link-type="dfn"
                            href="https://url.spec.whatwg.org/#concept-url-scheme"
                            id="ref-for-concept-url-scheme⑤">方案</a> 不是 "<code>http</code>" 或 "<code>https</code>" 之一，<a
                            data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw"
                            id="ref-for-dfn-throw①⑧">抛出</a> <code>TypeError</code>。</p>
                      </li>
                      <li data-md>
                        <p>如果 <var>r</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-method"
                            id="ref-for-concept-request-method⑦">方法</a> 不是 `<code>GET</code>`，<a data-link-type="dfn"
                            href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw①⑨">抛出</a>
                          <code>TypeError</code>。
                        </p>
                      </li>
                      <li data-md>
                        <p>如果 <var>operation</var> 的 <a data-link-type="dfn" href="#dfn-cache-batch-operation-options"
                            id="ref-for-dfn-cache-batch-operation-options③">选项</a> 不为空，<a data-link-type="dfn"
                            href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw②⓪">抛出</a>
                          <code>TypeError</code>。
                        </p>
                      </li>
                      <li data-md>
                        <p>将 <var>requestResponses</var> 设置为运行 <a data-link-type="dfn" href="#query-cache"
                            id="ref-for-query-cache④">查询缓存</a> 算法的结果，参数为 <var>operation</var> 的 <a data-link-type="dfn"
                            href="#dfn-cache-batch-operation-request"
                            id="ref-for-dfn-cache-batch-operation-request⑥">请求</a>。</p>
                      </li>
                      <li data-md>
                        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate①⑦">对于</a> <var>requestResponses</var> 中的每个
                          <var>requestResponse</var>：
                        </p>
                        <ol>
                          <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove"
                                id="ref-for-list-remove③">移除</a> <a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#list-item" id="ref-for-list-item①②">项</a> 其值与
                              <var>requestResponse</var> 匹配的对象从 <var>cache</var>。
                            </p>
                          </li>
                        </ol>
                      </li>
                      <li data-md>
                        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append"
                            id="ref-for-list-append⑧">追加</a> <var>operation</var> 的 <a data-link-type="dfn"
                            href="#dfn-cache-batch-operation-request"
                            id="ref-for-dfn-cache-batch-operation-request⑦">请求</a>/<var>operation</var> 的 <a
                            data-link-type="dfn" href="#dfn-cache-batch-operation-response"
                            id="ref-for-dfn-cache-batch-operation-response④">响应</a> 到 <var>cache</var>。</p>
                      </li>
                      <li data-md>
                        <p>如果由于超出分配的配额限制导致上两步中的缓存写入操作失败，<a data-link-type="dfn"
                            href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw②①">抛出</a> "<code
                            class="idl"><a data-link-type="idl"
                              href="https://webidl.spec.whatwg.org/#quotaexceedederror"
                              id="ref-for-quotaexceedederror①">QuotaExceededError</a></code>"
                          <code class="idl"><a data-link-type="idl"
                              href="https://webidl.spec.whatwg.org/#idl-DOMException"
                              id="ref-for-idl-DOMException②⑦">DOMException</a></code>。
                        </p>
                      </li>
                      <li data-md>
                        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append"
                            id="ref-for-list-append⑨">追加</a> <var>operation</var> 的 <a data-link-type="dfn"
                            href="#dfn-cache-batch-operation-request"
                            id="ref-for-dfn-cache-batch-operation-request⑧">请求</a>/<var>operation</var> 的 <a
                            data-link-type="dfn" href="#dfn-cache-batch-operation-response"
                            id="ref-for-dfn-cache-batch-operation-response⑤">响应</a> 到 <var>addedItems</var>。</p>
                      </li>
                    </ol>
                  </li>
                  <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append"
                        id="ref-for-list-append①⓪">追加</a> <var>operation</var> 的 <a data-link-type="dfn"
                        href="#dfn-cache-batch-operation-request"
                        id="ref-for-dfn-cache-batch-operation-request⑨">请求</a>/<var>operation</var> 的 <a
                        data-link-type="dfn" href="#dfn-cache-batch-operation-response"
                        id="ref-for-dfn-cache-batch-operation-response⑥">响应</a> 到 <var>resultList</var>。</p>
                  </li>
                </ol>
              </li>
              <li data-md>
                <p>返回 <var>resultList</var>。</p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>然后，如果 <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw"
                id="ref-for-dfn-throw②②">抛出</a> 了异常，则：</p>
            <ol>
              <li data-md>
                <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove"
                    id="ref-for-list-remove④">移除</a> 所有项从 <a data-link-type="dfn"
                    href="#dfn-relevant-request-response-list"
                    id="ref-for-dfn-relevant-request-response-list④">相关的请求响应列表</a>。</p>
              </li>
              <li data-md>
                <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                    id="ref-for-list-iterate①⑧">对于</a> <var>backupCache</var> 中的每个 <var>requestResponse</var>：</p>
                <ol>
                  <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append"
                        id="ref-for-list-append①①">追加</a> <var>requestResponse</var> 到 <a data-link-type="dfn"
                        href="#dfn-relevant-request-response-list"
                        id="ref-for-dfn-relevant-request-response-list⑤">相关的请求响应列表</a>。</p>
                  </li>
                </ol>
              </li>
              <li data-md>
                <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw"
                    id="ref-for-dfn-throw②③">抛出</a> 异常。</p>
              </li>
            </ol>
            <p class="note" role="note"><span>注意：</span> 当 <a data-link-type="dfn"
                href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw②④">抛出</a>
              异常时，执行回滚操作以撤销批量操作期间对缓存存储所做的更改。</p>
          </li>
        </ol>
      </section>
      <section class="algorithm" data-algorithm="Is Async Module">
        <h3 class="heading settled" id="is-async-module-algorithm"><span class="content"><dfn class="dfn-paneled"
              data-dfn-type="dfn" data-noexport id="is-async-module">是否为异步模块</dfn></span><a class="self-link"
            href="#is-async-module-algorithm"></a></h3>
        <dl>
          <dt data-md>输入</dt>
          <dd data-md>
            <p><var>record</var>，一个 <a data-link-type="dfn"
                href="http://tc39.github.io/ecma262/#sec-abstract-module-records"
                id="ref-for-sec-abstract-module-records">模块记录</a></p>
          </dd>
          <dd data-md>
            <p><var>moduleMap</var>，一个 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#module-map"
                id="ref-for-module-map">模块映射</a></p>
          </dd>
          <dd data-md>
            <p><var>base</var>，一个 <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url"
                id="ref-for-concept-url①⑥">URL</a></p>
          </dd>
          <dd data-md>
            <p><var>seen</var>，一个 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set"
                id="ref-for-ordered-set⑦">集合</a>，包含 <a data-link-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①⑦">URL</a></p>
          </dd>
          <dt data-md>输出</dt>
          <dd data-md>
            <p>布尔值</p>
          </dd>
        </dl>
        <ol>
          <li data-md>
            <p>如果 <var>record</var> 不是一个 <a data-link-type="dfn"
                href="http://tc39.github.io/ecma262/#sec-cyclic-module-records"
                id="ref-for-sec-cyclic-module-records">循环模块记录</a>，则：</p>
            <ol>
              <li data-md>
                <p>返回 false。</p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>如果 <var>record</var> 的 [[Async]] 属性为 true，则：</p>
            <ol>
              <li data-md>
                <p>返回 true。</p>
              </li>
            </ol>
          </li>
          <li data-md>
            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                id="ref-for-list-iterate①⑨">对于</a> <var>record</var> 的 [[RequestedModules]] 列表中的每个字符串
              <var>requested</var>：
            </p>
            <ol>
              <li data-md>
                <p>让 <var>url</var> 成为运行 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#resolve-a-module-specifier"
                    id="ref-for-resolve-a-module-specifier">解析模块说明符</a> 算法的结果，参数为 <var>base</var> 和
                  <var>requested</var>。
                </p>
              </li>
              <li data-md>
                <p class="assertion">断言：<var>url</var> 绝不会为失败，因为使用这两个相同参数运行 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#resolve-a-module-specifier"
                    id="ref-for-resolve-a-module-specifier①">解析模块说明符</a> 算法必须先前已成功。</p>
              </li>
              <li data-md>
                <p>如果 <var>seen</var> 不包含 <var>url</var>，则：</p>
                <ol>
                  <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append"
                        id="ref-for-set-append④">追加</a> <var>url</var> 到 <var>seen</var>。</p>
                  </li>
                  <li data-md>
                    <p>如果 <var>moduleMap</var>[<var>url</var>] 没有记录，则：</p>
                    <ol>
                      <li data-md>
                        <p>返回 false。</p>
                      </li>
                    </ol>
                  </li>
                  <li data-md>
                    <p>如果运行 <a data-link-type="dfn" href="#is-async-module" id="ref-for-is-async-module①">是否为异步模块</a>
                      算法的结果为 true，参数为 <var>moduleMap</var>[<var>url</var>] 的记录、<var>moduleMap</var>、<var>base</var> 和
                      <var>seen</var>，则：
                    </p>
                    <ol>
                      <li data-md>
                        <p>返回 true。</p>
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
            </ol>
          </li>
          <li data-md>
            <p>返回 false。</p>
          </li>
        </ol>
      </section>
    </section>
    <section>
      <h2 class="heading settled" id="extended-http-headers"><span class="content">附录 B: 扩展的 HTTP 头</span><a
          class="self-link" href="#extended-http-headers"></a></h2>
      <section>
        <h3 class="heading settled" id="service-worker-script-request"><span class="content">服务工作者脚本请求</span><a
            class="self-link" href="#service-worker-script-request"></a></h3>
        <p>用于<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
            id="ref-for-concept-fetch①⑧">获取</a> <a data-link-type="dfn" href="#dfn-service-worker"
            id="ref-for-dfn-service-worker①⓪⑥">服务工作者</a>的<a data-link-type="dfn" href="#dfn-script-resource"
            id="ref-for-dfn-script-resource⑧">脚本资源</a>的 HTTP 请求将包括以下<a data-link-type="dfn"
            href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-header④">头信息</a>：</p>
        <dl>
          <dt data-md>`<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
              id="service-worker"><code>Service-Worker</code></dfn>`
          <dd data-md>
            <p>表示此请求是<a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker①⓪⑦">服务工作者</a>的<a
                data-link-type="dfn" href="#dfn-script-resource" id="ref-for-dfn-script-resource⑨">脚本资源</a>请求。</p>
            <p class="note" role="note"><span>注意：</span>此头信息有助于管理员记录请求并检测威胁。</p>
          </dd>
        </dl>
      </section>
      <section>
        <h3 class="heading settled" id="service-worker-script-response"><span class="content">服务工作者脚本响应</span><a
            class="self-link" href="#service-worker-script-response"></a></h3>
        <p>对<a data-link-type="dfn" href="#dfn-service-worker" id="ref-for-dfn-service-worker①⓪⑧">服务工作者</a>的<a
            data-link-type="dfn" href="#dfn-script-resource" id="ref-for-dfn-script-resource①⓪">脚本资源</a>请求的 HTTP
          响应可以包括以下<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header"
            id="ref-for-concept-header⑤">头信息</a>：</p>
        <dl>
          <dt data-md>`<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
              id="service-worker-allowed"><code>Service-Worker-Allowed</code></dfn>`
          <dd data-md>
            <p>表示用户代理将覆盖路径限制，将脚本可以<a data-link-type="dfn" href="#dfn-control" id="ref-for-dfn-control③">控制</a>的最大允许<a
                data-link-type="dfn" href="#dfn-scope-url" id="ref-for-dfn-scope-url①⑨">范围 URL</a>设置为给定的值。</p>
            <p class="note" role="note"><span>注意：</span>该值是一个 URL。如果给出了相对 URL，则会基于脚本的 URL 进行解析。</p>
          </dd>
        </dl>
        <div class="example" id="example-3c0435b3">
          <a class="self-link" href="#example-3c0435b3"></a> 默认范围：
          <pre class="highlight"><c- c1>// 最大允许范围默认为脚本所在路径</c->
<c- c1>// 本例中为 "/js/"</c->
navigator<c- p>.</c->serviceWorker<c- p>.</c->register<c- p>(</c-><c- u>"/js/sw.js"</c-><c- p>).</c->then<c- p>(()</c-> <c- p>=></c-> <c- p>{</c->
  console<c- p>.</c->log<c- p>(</c-><c- u>"安装成功，默认范围为 '/js/'。"</c-><c- p>);</c->
<c- p>});</c->
</pre>
        </div>
        <div class="example" id="example-7c01199a">
          <a class="self-link" href="#example-7c01199a"></a> 没有 Service-Worker-Allowed 头信息的上级路径：
          <pre class="highlight"><c- c1>// 将范围设置为脚本位置的上级路径</c->
<c- c1>// 响应中没有 Service-Worker-Allowed 头信息</c->
navigator<c- p>.</c->serviceWorker<c- p>.</c->register<c- p>(</c-><c- u>"/js/sw.js"</c-><c- p>,</c-> <c- p>{</c-> scope<c- o>:</c-> <c- u>"/"</c-> <c- p>}).</c-><c- k>catch</c-><c- p>(()</c-> <c- p>=></c-> <c- p>{</c->
  console<c- p>.</c->error<c- p>(</c-><c- u>"由于路径限制违规，安装失败。"</c-><c- p>);</c->
<c- p>});</c->
</pre>
        </div>
        <div class="example" id="example-4ac10046">
          <a class="self-link" href="#example-4ac10046"></a> 带有 Service-Worker-Allowed 头信息的上级路径：
          <pre class="highlight"><c- c1>// 将范围设置为脚本位置的上级路径</c->
<c- c1>// 响应中包含 "Service-Worker-Allowed : /"</c->
navigator<c- p>.</c->serviceWorker<c- p>.</c->register<c- p>(</c-><c- u>"/js/sw.js"</c-><c- p>,</c-> <c- p>{</c-> scope<c- o>:</c-> <c- u>"/"</c-> <c- p>}).</c->then<c- p>(()</c-> <c- p>=></c-> <c- p>{</c->
  console<c- p>.</c->log<c- p>(</c-><c- u>"安装成功，因为最大允许范围已被覆盖为 '/'。"</c-><c- p>);</c->
<c- p>});</c->
</pre>
        </div>
        <div class="example" id="example-e39a8279">
          <a class="self-link" href="#example-e39a8279"></a> 即使有 Service-Worker-Allowed 头信息也违反路径限制：
          <pre class="highlight"><c- c1>// 将范围设置为脚本位置的上级路径</c->
<c- c1>// 响应中包含 "Service-Worker-Allowed : /foo"</c->
navigator<c- p>.</c->serviceWorker<c- p>.</c->register<c- p>(</c-><c- u>"/foo/bar/sw.js"</c-><c- p>,</c-> <c- p>{</c-> scope<c- o>:</c-> <c- u>"/"</c-> <c- p>}).</c-><c- k>catch</c-><c- p>(()</c-> <c- p>=></c-> <c- p>{</c->
  console<c- p>.</c->error<c- p>(</c-><c- u>"安装失败，因为范围仍然超出了覆盖的最大允许范围。"</c-><c- p>);</c->
<c- p>});</c->
</pre>
        </div>
      </section>

      <section>
        <h3 class="heading settled" id="syntax"><span class="content">语法</span><a class="self-link" href="#syntax"></a>
        </h3>
        <p><a data-link-type="biblio" href="#biblio-rfc5234">ABNF</a> 用于验证 <a data-link-type="dfn"
            href="#dfn-service-worker" id="ref-for-dfn-service-worker①⓪⑨">服务工作者</a>的<a data-link-type="dfn"
            href="#dfn-script-resource" id="ref-for-dfn-script-resource①①">脚本资源</a>请求和响应中使用的头部值：</p>
        <pre>Service-Worker = %x73.63.72.69.70.74 ; "script", case-sensitive
</pre>
        <p class="note" role="note"><span>注意：</span>Service-Worker-Allowed 头部值的验证通过 URL 解析算法（在更新算法中）完成，而不是使用 ABNF。</p>
      </section>
    </section>
    <section>
      <h2 class="heading settled" data-level="8" id="acknowledgements"><span class="secno">8. </span><span
          class="content">致谢</span><a class="self-link" href="#acknowledgements"></a></h2>
      <p>特别感谢 Andrew Betts 组织并主持了一次由志同道合的人士参加的小型研讨会，参会者包括：Jake Archibald、Jackson Gabbard、Tobie Langel、Robin
        Berjon、Patrick Lauke、Christian Heilmann。通过当天讨论的清晰思路和提出的用例，许多事情成为了可能。进一步感谢 Andrew 提升了人们对离线问题的意识。他组织的 EdgeConf
        会议并将离线问题作为持续讨论的主题，为这项工作的进展创造了许多机会和联系。</p>
      <p>Anne van Kesteren 在整个服务工作者的开发过程中，慷慨地分享了他对 Web 平台奥秘的百科知识和标准开发经验。如果没有他在描述 URL、HTTP Fetch、Promises 和 DOM
        的实际行为方面的早期工作，这份规范将是不完整的。同样地，如果没有 Ian Hickson 的严格的 Web Worker 规范，这份规范也不可能实现。非常感谢他。</p>
      <p>在此没有特定顺序，深表感谢那些提供设计指导和讨论的人员：Jungkee Song、Alec Flett、David Barrett-Kahn、Aaron Boodman、Michael Nordman、Tom
        Ashworth、Kinuko Yasuda、Darin Fisher、Jonas Sicking、Jesús Leganés Combarro、Mark Christian、Dave Hermann、Yehuda
        Katz、François Remy、Ilya Grigorik、Will Chan、Domenic Denicola、Nikhil Marathe、Yves Lafon、Adam Barth、Greg
        Simon、Devdatta Akhawe、Dominic Cooney、Jeffrey Yasskin、Joshua Bell、Boris Zbarsky、Matt Falkenhagen、Tobie
        Langel、Gavin Peters、Ben Kelly、Hiroki Nakagawa、Jake Archibald、Josh Soref、Jinho Bang、Yutaka Hirano、Michael(tm)
        Smith、isonmad、Ali Alabbas、Philip Jägenstedt、Mike Pennisi 和 Eric Willigers。</p>
      <p>Jason Weber、Chris Wilson、Paul Kinlan、Ehsan Akhgari 和 Daniel Austin 在需求和标准化过程中提供了宝贵的、及时的反馈。</p>
      <p>作者还要感谢 Dimitri Glazkov 提供的脚本和格式化工具，这些工具在规范的制作过程中起到了重要作用。同时，作者也感谢他的宝贵指导。</p>
      <p>还要感谢 Vivian Cromwell、Greg Simon、Alex Komoroske、Wonsuk Lee 和 Seojin Kim 的专业支持。</p>
    </section>
  </main>
  <div data-fill-with="conformance">
    <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">一致性</span><a class="self-link"
        href="#w3c-conformance"></a></h2>
    <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">文档约定</span><a class="self-link"
        href="#w3c-conventions"></a></h3>
    <p>一致性要求通过描述性断言和 RFC 2119 术语的组合来表达。在本文件的规范部分中，关键字“MUST”、“MUST NOT”、“REQUIRED”、“SHALL”、“SHALL NOT”、“SHOULD”、“SHOULD
      NOT”、“RECOMMENDED”、“MAY”和“OPTIONAL”应按照 RFC 2119 中的描述进行解释。然而，为了可读性，这些词在本规范中并未全部以大写字母出现。</p>
    <p>本规范的所有文本均为规范性内容，除非明确标记为非规范性、示例和注释的部分。<a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>
    <p>本规范中的示例以“例如”一词开头，或通过<code>class="example"</code>与规范文本分开，如下所示：</p>
    <div class="example" id="w3c-example">
      <a class="self-link" href="#w3c-example"></a>
      <p>这是一个提供信息的示例。</p>
    </div>
    <p>提供信息的注释以“注意”一词开头，并通过<code>class="note"</code>与规范文本分开，如下所示：</p>
    <p class="note" role="note">注意，这是一个提供信息的注释。</p>
    <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">一致性算法</span><a
        class="self-link" href="#w3c-conformant-algorithms"></a></h3>
    <p>在算法中以命令式表达的要求（例如“去除任何前导空格字符”或“返回 false 并终止这些步骤”）应根据引入算法时使用的关键字（“必须”、“应”、“可以”等）进行解释。</p>
    <p>作为算法或具体步骤表述的一致性要求可以通过任何方式实现，只要最终结果是等效的即可。特别是，本规范中定义的算法旨在易于理解，并非旨在提高性能。我们鼓励实现者进行优化。</p>
  </div>

  <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
      href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本规范定义的术语</span><a
      class="self-link" href="#index-defined-here"></a></h3>

  <ul class="index">
    <li><a href="#activate">激活</a><span>, 位于 § 未编号部分</span>
    <li><a href="#service-worker-global-scope-activate-event">activate</a><span>, 位于 § 4.7</span>
    <li><a href="#dom-serviceworkerstate-activated">"activated"</a><span>, 位于 § 3.1</span>
    <li><a href="#dom-serviceworkerstate-activating">"activating"</a><span>, 位于 § 3.1</span>
    <li>
      active
      <ul>
        <li><a href="#dom-serviceworkerregistration-active">ServiceWorkerRegistration 的属性</a><span>, 位于
            § 3.2.4</span>
        <li><a href="#extendableevent-active">ExtendableEvent 的定义</a><span>, 位于 § 4.4</span>
      </ul>
    <li><a href="#dfn-active-worker">active worker</a><span>, 位于 § 2.3</span>
    <li><a href="#dom-cache-addall">addAll(requests)</a><span>, 位于 § 5.4.4</span>
    <li><a href="#extendableevent-add-lifetime-promise">添加生命周期承诺</a><span>, 位于 § 4.4</span>
    <li><a href="#dom-cache-add">add(request)</a><span>, 位于 § 5.4.3</span>
    <li>
      "all"
      <ul>
        <li><a href="#dom-clienttype-all">ClientType 的枚举值</a><span>, 位于 § 4.3</span>
        <li><a href="#dom-serviceworkerupdateviacache-all">ServiceWorkerUpdateViaCache 的枚举值</a><span>, 位于
            § 3.2</span>
      </ul>
    <li><a href="#dom-windowclient-ancestororigins">ancestorOrigins</a><span>, 位于 § 4.2.9</span>
    <li><a href="#windowclient-ancestor-origins-array">祖先起源数组</a><span>, 位于 § 4.2</span>
    <li><a href="#dom-frametype-auxiliary">"auxiliary"</a><span>, 位于 § 4.2</span>
    <li><a href="#dfn-bad-import-script-response">错误的导入脚本响应</a><span>, 位于 § 未编号部分</span>
    <li><a href="#batch-cache-operations">批量缓存操作</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dfn-service-worker-client-browsing-context">浏览上下文</a><span>, 位于 § 4.2</span>
    <li><a href="#cache">缓存</a><span>, 位于 § 5.4</span>
    <li><a href="#dfn-cache-batch-operation">缓存批处理操作</a><span>, 位于 § 5.4</span>
    <li><a href="#dom-multicachequeryoptions-cachename">缓存名称</a><span>, 位于 § 5.5</span>
    <li><a href="#dictdef-cachequeryoptions">CacheQueryOptions</a><span>, 位于 § 5.4</span>
    <li><a href="#global-caches-attribute">缓存</a><span>, 位于 § 5.3.1</span>
    <li><a href="#cachestorage">CacheStorage</a><span>, 位于 § 5.5</span>
    <li><a href="#dom-clients-claim">claim()</a><span>, 位于 § 4.3.4</span>
    <li><a href="#dfn-classic-scripts-imported-flag">经典脚本导入标志</a><span>, 位于 § 2.1</span>
    <li><a href="#clear-registration">清除注册</a><span>, 位于 § 未编号部分</span>
    <li><a href="#client">Client</a><span>, 位于 § 4.2</span>
    <li><a href="#dfn-job-client">客户端</a><span>, 位于 § 未编号部分</span>
    <li>
      clientId
      <ul>
        <li><a href="#dom-fetchevent-clientid">FetchEvent 的属性</a><span>, 位于 § 4.5.3</span>
        <li><a href="#dom-fetcheventinit-clientid">FetchEventInit 的字典成员</a><span>, 位于 § 4.5</span>
      </ul>
    <li><a href="#dfn-client-message-queue">客户端消息队列</a><span>, 位于 § 3.4</span>
    <li><a href="#dictdef-clientqueryoptions">ClientQueryOptions</a><span>, 位于 § 4.3</span>
    <li><a href="#clients">Clients</a><span>, 位于 § 4.3</span>
    <li><a href="#dom-serviceworkerglobalscope-clients">clients</a><span>, 位于 § 4.1.1</span>
    <li><a href="#enumdef-clienttype">ClientType</a><span>, 位于 § 4.3</span>
    <li>
      constructor(type)
      <ul>
        <li><a href="#dom-extendableevent-extendableevent">ExtendableEvent 的构造函数</a><span>, 位于 § 4.4</span>
        <li><a href="#dom-extendablemessageevent-extendablemessageevent">ExtendableMessageEvent 的构造函数</a><span>, 位于
            § 4.6</span>
      </ul>
    <li>
      constructor(type, eventInitDict)
      <ul>
        <li><a href="#dom-extendableevent-extendableevent">ExtendableEvent 的构造函数</a><span>, 位于 § 4.4</span>
        <li><a href="#dom-extendablemessageevent-extendablemessageevent">ExtendableMessageEvent 的构造函数</a><span>, 位于
            § 4.6</span>
        <li><a href="#dom-fetchevent-fetchevent">FetchEvent 的构造函数</a><span>, 位于 § 4.5</span>
      </ul>
    <li><a href="#dfn-containing-job-queue">包含的工作队列</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dfn-containing-service-worker-registration">包含的 Service Worker 注册</a><span>, 位于 § 2.1</span>
    <li><a href="#dfn-control">受控</a><span>, 位于 § 2.5</span>
    <li><a href="#dom-serviceworkercontainer-controller">控制器</a><span>, 位于 § 3.4.1</span>
    <li><a href="#service-worker-container-controllerchange-event">controllerchange</a><span>, 位于 § 3.5</span>
    <li><a href="#dfn-control">控制</a><span>, 位于 § 2.5</span>
    <li><a href="#dfn-control">控制</a><span>, 位于 § 2.5</span>
    <li><a href="#create-client">创建客户端</a><span>, 位于 § 未编号部分</span>
    <li><a href="#create-job">创建工作</a><span>, 位于 § 未编号部分</span>
    <li><a href="#create-window-client">创建窗口客户端</a><span>, 位于 § 未编号部分</span>
    <li>
      data
      <ul>
        <li><a href="#dom-extendablemessageevent-data">ExtendableMessageEvent 的属性</a><span>, 位于 § 4.6.1</span>
        <li><a href="#dom-extendablemessageeventinit-data">ExtendableMessageEventInit 的字典成员</a><span>, 位于
            § 4.6</span>
      </ul>
    <li><a href="#dfn-dedicatedworker-client">专用工作者客户端</a><span>, 位于 § 2.4</span>
    <li><a href="#dom-cachestorage-delete">delete(cacheName)</a><span>, 位于 § 5.5.4</span>
    <li><a href="#dom-cache-delete">delete(request)</a><span>, 位于 § 5.4.6</span>
    <li><a href="#dom-cache-delete">delete(request, options)</a><span>, 位于 § 5.4.6</span>
    <li><a href="#dom-navigationpreloadmanager-disable">disable()</a><span>, 位于 § 3.6.2</span>
    <li><a href="#service-worker-client-discarded-flag">丢弃标志</a><span>, 位于 § 2.4</span>
    <li><a href="#dom-navigationpreloadmanager-enable">enable()</a><span>, 位于 § 3.6.1</span>
    <li><a href="#dom-navigationpreloadstate-enabled">已启用</a><span>, 位于 § 3.6</span>
    <li><a href="#dfn-job-equivalent">等效</a><span>, 位于 § 未编号部分</span>
    <li><a href="#extendableevent">ExtendableEvent</a><span>, 位于 § 4.4</span>
    <li><a href="#dictdef-extendableeventinit">ExtendableEventInit</a><span>, 位于 § 4.4</span>
    <li><a href="#dom-extendableevent-extendableevent">ExtendableEvent(type)</a><span>, 位于 § 4.4</span>
    <li><a href="#dom-extendableevent-extendableevent">ExtendableEvent(type, eventInitDict)</a><span>, 位于 § 4.4</span>
    <li><a href="#extendablemessageevent">ExtendableMessageEvent</a><span>, 位于 § 4.6</span>
    <li><a href="#dictdef-extendablemessageeventinit">ExtendableMessageEventInit</a><span>, 位于 § 4.6</span>
    <li><a href="#dom-extendablemessageevent-extendablemessageevent">ExtendableMessageEvent(type)</a><span>, 位于
        § 4.6</span>
    <li><a href="#dom-extendablemessageevent-extendablemessageevent">ExtendableMessageEvent(type,
        eventInitDict)</a><span>, 位于 § 4.6</span>
    <li><a href="#extendableevent-extend-lifetime-promises">扩展生命周期承诺</a><span>, 位于 § 4.4</span>
    <li><a href="#service-worker-global-scope-fetch-event">fetch</a><span>, 位于 § 4.7</span>
    <li><a href="#fetchevent">FetchEvent</a><span>, 位于 § 4.5</span>
    <li><a href="#service-worker-timing-info-fetch-event-dispatch-time">fetch 事件调度时间</a><span>, 位于 § 2.2</span>
    <li><a href="#dictdef-fetcheventinit">FetchEventInit</a><span>, 位于 § 4.5</span>
    <li><a href="#dom-fetchevent-fetchevent">FetchEvent(type, eventInitDict)</a><span>, 位于 § 4.5</span>
    <li><a href="#finish-job">完成工作</a><span>, 位于 § 未编号部分</span>
    <li><a href="#fire-functional-event">触发功能事件</a><span>, 位于 § 未编号部分</span>
    <li><a href="#fire-functional-event">触发功能事件</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dom-windowclient-focus">focus()</a><span>, 位于 § 4.2.10</span>
    <li><a href="#dom-windowclient-focused">focused</a><span>, 位于 § 4.2.8</span>
    <li><a href="#dfn-service-worker-client-focusstate">聚焦状态</a><span>, 位于 § 4.2</span>
    <li><a href="#dfn-job-force-bypass-cache-flag">强制绕过缓存标志</a><span>, 位于 § 未编号部分</span>
    <li><a href="#serviceworkerglobalscope-force-bypass-cache-for-import-scripts-flag">强制绕过导入脚本的缓存标志</a><span>, 位于
        § 4.1</span>
    <li><a href="#dfn-service-worker-client-frame-type">框架类型</a><span>, 位于 § 4.2</span>
    <li><a href="#enumdef-frametype">FrameType</a><span>, 位于 § 4.2</span>
    <li><a href="#dom-client-frametype">frameType</a><span>, 位于 § 4.2.2</span>
    <li><a href="#dfn-functional-events">功能事件</a><span>, 位于 § 2.1.2</span>
    <li><a href="#get-frame-type">获取框架类型</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dom-clients-get">get(id)</a><span>, 位于 § 4.3.1</span>
    <li><a href="#get-newest-worker">获取最新的 worker</a><span>, 位于 § 未编号部分</span>
    <li><a href="#get-registration">获取注册信息</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dom-serviceworkercontainer-getregistration">getRegistration()</a><span>, 位于 § 3.4.4</span>
    <li><a href="#dom-serviceworkercontainer-getregistration">getRegistration(clientURL)</a><span>, 位于 § 3.4.4</span>
    <li><a href="#dom-serviceworkercontainer-getregistrations">getRegistrations()</a><span>, 位于 § 3.4.5</span>
    <li><a href="#dom-navigationpreloadmanager-getstate">getState()</a><span>, 位于 § 3.6.4</span>
    <li><a href="#get-the-service-worker-object">获取 service worker 对象</a><span>, 位于 § 3.1.1</span>
    <li><a href="#get-the-service-worker-registration-object">获取 service worker 注册对象</a><span>, 位于 § 3.2.1</span>
    <li><a href="#get-the-service-worker-object">获取 service worker 对象</a><span>, 位于 § 3.1.1</span>
    <li><a href="#get-the-service-worker-registration-object">获取 service worker 注册对象</a><span>, 位于 § 3.2.1</span>
    <li>
      全局对象
      <ul>
        <li><a href="#cachestorage-global-object">CacheStorage 的定义</a><span>, 位于 § 5.5</span>
        <li><a href="#dfn-service-worker-global-object">service worker 的定义</a><span>, 位于 § 2.1</span>
      </ul>
    <li>
      handled
      <ul>
        <li><a href="#dom-fetchevent-handled">FetchEvent 的属性</a><span>, 位于 § 4.5.6</span>
        <li><a href="#dom-fetcheventinit-handled">FetchEventInit 的字典成员</a><span>, 位于 § 4.5</span>
      </ul>
    <li><a href="#handle-fetch">处理 Fetch</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dfn-handle-fetch-task-source">处理 fetch 任务源</a><span>, 位于 § 2.6</span>
    <li><a href="#dfn-handle-functional-event-task-source">处理功能事件任务源</a><span>, 位于 § 2.6</span>
    <li><a href="#handle-service-worker-client-unload">处理 Service Worker 客户端卸载</a><span>, 位于 § 未编号部分</span>
    <li><a href="#handle-user-agent-shutdown">处理用户代理关闭</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dom-cachestorage-has">has(cacheName)</a><span>, 位于 § 5.5.2</span>
    <li><a href="#dfn-has-ever-been-evaluated-flag">曾被评估过的标志</a><span>, 位于 § 2.1</span>
    <li><a href="#dom-navigationpreloadstate-headervalue">headerValue</a><span>, 位于 § 3.6</span>
    <li><a href="#dom-client-id">id</a><span>, 位于 § 4.2.3</span>
    <li><a href="#dom-cachequeryoptions-ignoremethod">ignoreMethod</a><span>, 位于 § 5.4</span>
    <li><a href="#dom-cachequeryoptions-ignoresearch">ignoreSearch</a><span>, 位于 § 5.4</span>
    <li><a href="#dom-cachequeryoptions-ignorevary">ignoreVary</a><span>, 位于 § 5.4</span>
    <li><a href="#dom-serviceworkerupdateviacache-imports">"imports"</a><span>, 位于 § 3.2</span>
    <li><a href="#importscripts-method">importScripts(urls)</a><span>, 位于 § 6.3.2</span>
    <li><a href="#dom-clientqueryoptions-includeuncontrolled">includeUncontrolled</a><span>, 位于 § 4.3</span>
    <li><a href="#install">安装</a><span>, 位于 § 未编号部分</span>
    <li><a href="#service-worker-global-scope-install-event">install</a><span>, 位于 § 4.7</span>
    <li><a href="#dom-serviceworkerstate-installed">"installed"</a><span>, 位于 § 3.1</span>
    <li><a href="#dom-serviceworkerstate-installing">"installing"</a><span>, 位于 § 3.1</span>
    <li><a href="#dom-serviceworkerregistration-installing">installing</a><span>, 位于 § 3.2.2</span>
    <li><a href="#dfn-installing-worker">安装中的 worker</a><span>, 位于 § 2.3</span>
    <li><a href="#is-async-module">是异步模块</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dfn-job">工作</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dfn-job-promise">工作承诺</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dfn-job-queue">工作队列</a><span>, 位于 § 未编号部分</span>
    <li>
      keys()
      <ul>
        <li><a href="#dom-cache-keys">Cache 的方法</a><span>, 位于 § 5.4.7</span>
        <li><a href="#dom-cachestorage-keys">CacheStorage 的方法</a><span>, 位于 § 5.5.5</span>
      </ul>
    <li><a href="#dom-cache-keys">keys(request)</a><span>, 位于 § 5.4.7</span>
    <li><a href="#dom-cache-keys">keys(request, options)</a><span>, 位于 § 5.4.7</span>
    <li>
      lastEventId
      <ul>
        <li><a href="#dom-extendablemessageevent-lasteventid">ExtendableMessageEvent 的属性</a><span>, 位于
            § 4.6.3</span>
        <li><a href="#dom-extendablemessageeventinit-lasteventid">ExtendableMessageEventInit 的字典成员</a><span>,
            位于 § 4.6</span>
      </ul>
    <li><a href="#dfn-last-update-check-time">上次更新检查时间</a><span>, 位于 § 2.3</span>
    <li><a href="#dfn-lifecycle-events">生命周期事件</a><span>, 位于 § 2.1.2</span>
    <li><a href="#dfn-job-list-of-equivalent-jobs">等效工作列表</a><span>, 位于 § 未编号部分</span>
    <li>
      matchAll()
      <ul>
        <li><a href="#dom-cache-matchall">Cache 的方法</a><span>, 位于 § 5.4.2</span>
        <li><a href="#dom-clients-matchall">Clients 的方法</a><span>, 位于 § 4.3.2</span>
      </ul>
    <li><a href="#dom-clients-matchall">matchAll(options)</a><span>, 位于 § 4.3.2</span>
    <li><a href="#dom-cache-matchall">matchAll(request)</a><span>, 位于 § 5.4.2</span>
    <li><a href="#dom-cache-matchall">matchAll(request, options)</a><span>, 位于 § 5.4.2</span>
    <li>
      match(request)
      <ul>
        <li><a href="#dom-cache-match">Cache 的方法</a><span>, 位于 § 5.4.1</span>
        <li><a href="#dom-cachestorage-match">CacheStorage 的方法</a><span>, 位于 § 5.5.1</span>
      </ul>
    <li>
      match(request, options)
      <ul>
        <li><a href="#dom-cache-match">Cache 的方法</a><span>, 位于 § 5.4.1</span>
        <li><a href="#dom-cachestorage-match">CacheStorage 的方法</a><span>, 位于 § 5.5.1</span>
      </ul>
    <li><a href="#match-service-worker-registration">匹配 Service Worker 注册</a><span>, 位于 § 未编号部分</span>
    <li>
      message
      <ul>
        <li><a href="#service-worker-container-message-event">ServiceWorkerContainer 的事件</a><span>, 位于
            § 3.5</span>
        <li><a href="#eventdef-serviceworkerglobalscope-message">ServiceWorkerGlobalScope 的事件</a><span>, 位于
            § 4.7</span>
      </ul>
    <li>
      messageerror
      <ul>
        <li><a href="#service-worker-container-messageerror-event">ServiceWorkerContainer 的事件</a><span>, 位于
            § 3.5</span>
        <li><a href="#eventdef-serviceworkerglobalscope-messageerror">ServiceWorkerGlobalScope 的事件</a><span>, 位于
            § 4.7</span>
      </ul>
    <li><a href="#dictdef-multicachequeryoptions">MultiCacheQueryOptions</a><span>, 位于 § 5.5</span>
    <li><a href="#dfn-name-to-cache-map">名称到缓存映射</a><span>, 位于 § 5.1</span>
    <li><a href="#dom-windowclient-navigate">navigate(url)</a><span>, 位于 § 4.2.11</span>
    <li><a href="#dom-serviceworkerregistration-navigationpreload">navigationPreload</a><span>, 位于 § 3.2.5</span>
    <li><a href="#service-worker-registration-navigation-preload-enabled-flag">导航预加载启用标志</a><span>, 位于
        § 2.3</span>
    <li><a href="#service-worker-registration-navigation-preload-header-value">导航预加载标头值</a><span>, 位于 § 2.3</span>
    <li>
      NavigationPreloadManager
      <ul>
        <li><a href="#navigationpreloadmanager">(接口)</a><span>, 位于 § 3.6</span>
        <li><a href="#service-worker-registration-navigationpreloadmanager">服务工作者注册的定义</a><span>, 位于
            § 2.3</span>
      </ul>
    <li><a href="#dictdef-navigationpreloadstate">NavigationPreloadState</a><span>, 位于 § 3.6</span>
    <li><a href="#dom-frametype-nested">"nested"</a><span>, 位于 § 4.2</span>
    <li>
      "none"
      <ul>
        <li><a href="#dom-frametype-none">FrameType 的枚举值</a><span>, 位于 § 4.2</span>
        <li><a href="#dom-serviceworkerupdateviacache-none">ServiceWorkerUpdateViaCache 的枚举值</a><span>, 位于
            § 3.2</span>
      </ul>
    <li><a href="#notify-controller-change">通知控制器更改</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dom-serviceworkerglobalscope-onactivate">onactivate</a><span>, 位于 § 4.1.5</span>
    <li><a href="#dom-serviceworkercontainer-oncontrollerchange">oncontrollerchange</a><span>, 位于 § 3.4.7</span>
    <li><a href="#dom-serviceworkerglobalscope-onfetch">onfetch</a><span>, 位于 § 4.1.5</span>
    <li><a href="#dom-serviceworkerglobalscope-oninstall">oninstall</a><span>, 位于 § 4.1.5</span>
    <li>
      onmessage
      <ul>
        <li><a href="#dom-serviceworkercontainer-onmessage">ServiceWorkerContainer 的属性</a><span>, 位于
            § 3.4.7</span>
        <li><a href="#dom-serviceworkerglobalscope-onmessage">ServiceWorkerGlobalScope 的属性</a><span>, 位于
            § 4.1.5</span>
      </ul>
    <li>
      onmessageerror
      <ul>
        <li><a href="#dom-serviceworkercontainer-onmessageerror">ServiceWorkerContainer 的属性</a><span>, 位于
            § 3.4.7</span>
        <li><a href="#dom-serviceworkerglobalscope-onmessageerror">ServiceWorkerGlobalScope 的属性</a><span>, 位于
            § 4.1.5</span>
      </ul>
    <li><a href="#dom-serviceworker-onstatechange">onstatechange</a><span>, 位于 § 3.1.6</span>
    <li><a href="#dom-serviceworkerregistration-onupdatefound">onupdatefound</a><span>, 位于 § 3.2.10</span>
    <li><a href="#dom-cachestorage-open">open(cacheName)</a><span>, 位于 § 5.5.3</span>
    <li><a href="#dom-clients-openwindow">openWindow(url)</a><span>, 位于 § 4.3.3</span>
    <li><a href="#dfn-cache-batch-operation-options">options</a><span>, 位于 § 5.4</span>
    <li>
      origin
      <ul>
        <li><a href="#dom-extendablemessageevent-origin">ExtendableMessageEvent 的属性</a><span>, 位于 § 4.6.2</span>
        <li><a href="#service-worker-client-origin">Service Worker 客户端的定义</a><span>, 位于 § 2.4</span>
        <li><a href="#dom-extendablemessageeventinit-origin">ExtendableMessageEventInit 的字典成员</a><span>, 位于
            § 4.6</span>
      </ul>
    <li><a href="#dom-serviceworkerstate-parsed">"parsed"</a><span>, 位于 § 3.1</span>
    <li><a href="#extendableevent-pending-promises-count">待处理承诺计数</a><span>, 位于 § 4.4</span>
    <li><a href="#dfn-policy-container">策略容器</a><span>, 位于 § 2.1</span>
    <li>
      ports
      <ul>
        <li><a href="#dom-extendablemessageevent-ports">ExtendableMessageEvent 的属性</a><span>, 位于 § 4.6.5</span>
        <li><a href="#dom-extendablemessageeventinit-ports">ExtendableMessageEventInit 的字典成员</a><span>, 位于
            § 4.6</span>
      </ul>
    <li>
      postMessage(message)
      <ul>
        <li><a href="#dom-client-postmessage-message-options">Client 的方法</a><span>, 位于 § 4.2.6</span>
        <li><a href="#dom-serviceworker-postmessage-message-options">ServiceWorker 的方法</a><span>, 位于
            § 3.1.5</span>
      </ul>
    <li>
      postMessage(message, options)
      <ul>
        <li><a href="#dom-client-postmessage-message-options">Client 的方法</a><span>, 位于 § 4.2.6</span>
        <li><a href="#dom-serviceworker-postmessage-message-options">ServiceWorker 的方法</a><span>, 位于
            § 3.1.5</span>
      </ul>
    <li>
      postMessage(message, transfer)
      <ul>
        <li><a href="#dom-client-postmessage">Client 的方法</a><span>, 位于 § 4.2.5</span>
        <li><a href="#dom-serviceworker-postmessage">ServiceWorker 的方法</a><span>, 位于 § 3.1.4</span>
      </ul>
    <li><a href="#fetchevent-potential-response">潜在响应</a><span>, 位于 § 4.5</span>
    <li>
      preloadResponse
      <ul>
        <li><a href="#dom-fetchevent-preloadresponse">FetchEvent 的属性</a><span>, 位于 § 4.5.2</span>
        <li><a href="#dom-fetcheventinit-preloadresponse">FetchEventInit 的字典成员</a><span>, 位于 § 4.5</span>
      </ul>
    <li><a href="#dom-cache-put">put(request, response)</a><span>, 位于 § 5.4.5</span>
    <li><a href="#query-cache">查询缓存</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dom-serviceworkercontainer-ready">ready</a><span>, 位于 § 3.4.2</span>
    <li><a href="#serviceworkercontainer-ready-promise">ready 承诺</a><span>, 位于 § 3.4</span>
    <li><a href="#dom-serviceworkerstate-redundant">"redundant"</a><span>, 位于 § 3.1</span>
    <li><a href="#job-referrer">referrer</a><span>, 位于 § 未编号部分</span>
    <li><a href="#register">注册</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dom-serviceworkercontainer-register">register(scriptURL)</a><span>, 位于 § 3.4.3</span>
    <li><a href="#dom-serviceworkercontainer-register">register(scriptURL, options)</a><span>, 位于 § 3.4.3</span>
    <li>
      注册
      <ul>
        <li><a href="#dom-serviceworkerglobalscope-registration">ServiceWorkerGlobalScope 的属性</a><span>, 位于
            § 4.1.2</span>
        <li><a href="#dfn-containing-service-worker-registration">Service Worker 的定义</a><span>, 位于 § 2.1</span>
      </ul>
    <li><a href="#dfn-scope-to-registration-map">注册映射范围</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dictdef-registrationoptions">RegistrationOptions</a><span>, 位于 § 3.4</span>
    <li><a href="#reject-job-promise">拒绝工作承诺</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dfn-relevant-name-to-cache-map">相关名称到缓存映射</a><span>, 位于 § 5.1</span>
    <li><a href="#dfn-relevant-request-response-list">相关请求响应列表</a><span>, 位于 § 5.1</span>
    <li>
      replacesClientId
      <ul>
        <li><a href="#dom-fetchevent-replacesclientid">FetchEvent 的属性</a><span>, 位于 § 4.5.5</span>
        <li><a href="#dom-fetcheventinit-replacesclientid">FetchEventInit 的字典成员</a><span>, 位于 § 4.5</span>
      </ul>
    <li>
      请求
      <ul>
        <li><a href="#dom-fetchevent-request">FetchEvent 的属性</a><span>, 位于 § 4.5.1</span>
        <li><a href="#dfn-cache-batch-operation-request">缓存批处理操作的定义</a><span>, 位于 § 5.4</span>
        <li><a href="#dom-fetcheventinit-request">FetchEventInit 的字典成员</a><span>, 位于 § 4.5</span>
      </ul>
    <li><a href="#request-matches-cached-item">请求匹配缓存项</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dfn-request-response-list">请求响应列表</a><span>, 位于 § 5.1</span>
    <li><a href="#resolve-get-client-promise">解决获取客户端承诺</a><span>, 位于 § 未编号部分</span>
    <li><a href="#resolve-job-promise">解决工作承诺</a><span>, 位于 § 未编号部分</span>
    <li><a href="#fetchevent-respond-with-entered-flag">响应已进入标志</a><span>, 位于 § 4.5</span>
    <li><a href="#fetchevent-respond-with-error-flag">响应错误标志</a><span>, 位于 § 4.5</span>
    <li><a href="#dom-fetchevent-respondwith">respondWith(r)</a><span>, 位于 § 4.5.7</span>
    <li><a href="#dfn-cache-batch-operation-response">响应</a><span>, 位于 § 5.4</span>
    <li>
      resultingClientId
      <ul>
        <li><a href="#dom-fetchevent-resultingclientid">FetchEvent 的属性</a><span>, 位于 § 4.5.4</span>
        <li><a href="#dom-fetcheventinit-resultingclientid">FetchEventInit 的字典成员</a><span>, 位于 § 4.5</span>
      </ul>
    <li><a href="#run-job">运行工作</a><span>, 位于 § 未编号部分</span>
    <li><a href="#service-worker-running">正在运行</a><span>, 位于 § 2.1</span>
    <li><a href="#run-service-worker">运行 Service Worker</a><span>, 位于 § 未编号部分</span>
    <li><a href="#schedule-job">计划工作</a><span>, 位于 § 未编号部分</span>
    <li>
      范围
      <ul>
        <li><a href="#dom-serviceworkerregistration-scope">ServiceWorkerRegistration 的属性</a><span>, 位于
            § 3.2.6</span>
        <li><a href="#dom-registrationoptions-scope">RegistrationOptions 的字典成员</a><span>, 位于 § 3.4</span>
      </ul>
    <li><a href="#dfn-scope-to-job-queue-map">范围到工作队列映射</a><span>, 位于 § 未编号部分</span>
    <li>
      范围 URL
      <ul>
        <li><a href="#dfn-job-scope-url">工作的定义</a><span>, 位于 § 未编号部分</span>
        <li><a href="#dfn-scope-url">Service Worker 注册的定义</a><span>, 位于 § 2.3</span>
      </ul>
    <li><a href="#dfn-script-resource">脚本资源</a><span>, 位于 § 2.1</span>
    <li><a href="#dfn-script-resource-map">脚本资源映射</a><span>, 位于 § 2.1</span>
    <li>
      脚本 URL
      <ul>
        <li><a href="#dfn-job-script-url">工作的定义</a><span>, 位于 § 未编号部分</span>
        <li><a href="#dfn-script-url">Service Worker 的定义</a><span>, 位于 § 2.1</span>
      </ul>
    <li><a href="#dom-serviceworker-scripturl">scriptURL</a><span>, 位于 § 3.1.2</span>
    <li>
      service worker
      <ul>
        <li><a href="#dfn-service-worker">的定义</a><span>, 位于 § 2.1</span>
        <li><a href="#serviceworkerglobalscope-service-worker">ServiceWorkerGlobalScope 的定义</a><span>, 位于
            § 4.1</span>
      </ul>
    <li><a href="#service-worker">Service-Worker</a><span>, 位于 § 未编号部分</span>
    <li><a href="#serviceworker">ServiceWorker</a><span>, 位于 § 3.1</span>
    <li>
      serviceWorker
      <ul>
        <li><a href="#navigator-service-worker-attribute">Navigator 和 WorkerNavigator 的属性</a><span>, 位于
            § 3.3</span>
        <li><a href="#dom-serviceworkerglobalscope-serviceworker">ServiceWorkerGlobalScope 的属性</a><span>, 位于
            § 4.1.3</span>
      </ul>
    <li><a href="#service-worker-allowed">Service-Worker-Allowed</a><span>, 位于 § 未编号部分</span>
    <li>
      Service Worker 客户端
      <ul>
        <li><a href="#dfn-service-worker-client">的定义</a><span>, 位于 § 2.4</span>
        <li><a href="#dfn-service-worker-client-service-worker-client">Client 的定义</a><span>, 位于 § 4.2</span>
        <li><a href="#serviceworkercontainer-service-worker-client">ServiceWorkerContainer 的定义</a><span>, 位于
            § 3.4</span>
      </ul>
    <li><a href="#serviceworkercontainer">ServiceWorkerContainer</a><span>, 位于 § 3.4</span>
    <li><a href="#dfn-service-worker-events">service worker 事件</a><span>, 位于 § 2.1.2</span>
    <li><a href="#serviceworkerglobalscope">ServiceWorkerGlobalScope</a><span>, 位于 § 4.1</span>
    <li><a href="#service-worker-has-no-pending-events">Service Worker 无待处理事件</a><span>, 位于 § 未编号部分</span>
    <li><a href="#environment-settings-object-service-worker-object-map">service worker 对象映射</a><span>, 位于
        § 3.1.1</span>
    <li>
      service worker 注册
      <ul>
        <li><a href="#dfn-service-worker-registration">的定义</a><span>, 位于 § 2.3</span>
        <li><a href="#serviceworkerregistration-service-worker-registration">ServiceWorkerRegistration 的定义</a><span>, 位于
            § 3.2</span>
      </ul>
    <li><a href="#serviceworkerregistration">ServiceWorkerRegistration</a><span>, 位于 § 3.2</span>
    <li><a href="#environment-settings-object-service-worker-registration-object-map">service worker 注册对象映射</a><span>,
        位于 § 3.2.1</span>
    <li><a href="#enumdef-serviceworkerstate">ServiceWorkerState</a><span>, 位于 § 3.1</span>
    <li><a href="#service-worker-timing-info">service worker 定时信息</a><span>, 位于 § 2.2</span>
    <li><a href="#enumdef-serviceworkerupdateviacache">ServiceWorkerUpdateViaCache</a><span>, 位于 § 3.2</span>
    <li><a href="#dom-navigationpreloadmanager-setheadervalue">setHeaderValue(value)</a><span>, 位于 § 3.6.3</span>
    <li><a href="#dfn-set-of-event-types-to-handle">处理的事件类型集合</a><span>, 位于 § 2.1</span>
    <li><a href="#dfn-set-of-extended-events">扩展事件集合</a><span>, 位于 § 2.1</span>
    <li><a href="#dfn-set-of-used-scripts">已使用脚本集合</a><span>, 位于 § 2.1</span>
    <li><a href="#set-registration">设置注册</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dom-clienttype-sharedworker">"sharedworker"</a><span>, 位于 § 4.3</span>
    <li><a href="#dfn-sharedworker-client">共享工作者客户端</a><span>, 位于 § 2.4</span>
    <li><a href="#should-skip-event">应跳过事件</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dom-serviceworkerglobalscope-skipwaiting">skipWaiting()</a><span>, 位于 § 4.1.4</span>
    <li><a href="#dfn-skip-waiting-flag">跳过等待标志</a><span>, 位于 § 2.1</span>
    <li><a href="#soft-update">软更新</a><span>, 位于 § 未编号部分</span>
    <li>
      source
      <ul>
        <li><a href="#dom-extendablemessageevent-source">ExtendableMessageEvent 的属性</a><span>, 位于
            § 4.6.4</span>
        <li><a href="#dom-extendablemessageeventinit-source">ExtendableMessageEventInit 的字典成员</a><span>, 位于
            § 4.6</span>
      </ul>
    <li><a href="#service-worker-registration-stale">陈旧</a><span>, 位于 § 2.3</span>
    <li><a href="#dom-serviceworkercontainer-startmessages">startMessages()</a><span>, 位于 § 3.4.6</span>
    <li><a href="#start-register">开始注册</a><span>, 位于 § 未编号部分</span>
    <li><a href="#service-worker-start-status">启动状态</a><span>, 位于 § 2.1</span>
    <li><a href="#service-worker-timing-info-start-time">开始时间</a><span>, 位于 § 2.2</span>
    <li>
      状态
      <ul>
        <li><a href="#dom-serviceworker-state">ServiceWorker 的属性</a><span>, 位于 § 3.1.3</span>
        <li><a href="#dfn-state">Service Worker 的定义</a><span>, 位于 § 2.1</span>
      </ul>
    <li><a href="#eventdef-serviceworker-statechange">statechange</a><span>, 位于 § 3.5</span>
    <li>
      存储密钥
      <ul>
        <li><a href="#job-storage-key">工作的定义</a><span>, 位于 § 未编号部分</span>
        <li><a href="#service-worker-registration-storage-key">Service Worker 注册的定义</a><span>, 位于 § 2.3</span>
      </ul>
    <li><a href="#dfn-service-worker-registration-task-queue">任务队列</a><span>, 位于 § 2.3</span>
    <li><a href="#terminate-service-worker">终止 Service Worker</a><span>, 位于 § 未编号部分</span>
    <li><a href="#extendableevent-timed-out-flag">超时标志</a><span>, 位于 § 4.4</span>
    <li><a href="#dom-frametype-top-level">"顶级"</a><span>, 位于 § 4.2</span>
    <li><a href="#try-activate">尝试激活</a><span>, 位于 § 未编号部分</span>
    <li><a href="#try-clear-registration">尝试清除注册</a><span>, 位于 § 未编号部分</span>
    <li>
      类型
      <ul>
        <li><a href="#dom-client-type">Client 的属性</a><span>, 位于 § 4.2.4</span>
        <li><a href="#dfn-cache-batch-operation-type">缓存批处理操作的定义</a><span>, 位于 § 5.4</span>
        <li><a href="#dfn-type">Service Worker 的定义</a><span>, 位于 § 2.1</span>
        <li><a href="#dom-clientqueryoptions-type">ClientQueryOptions 的字典成员</a><span>, 位于 § 4.3</span>
        <li><a href="#dom-registrationoptions-type">RegistrationOptions 的字典成员</a><span>, 位于 § 3.4</span>
      </ul>
    <li><a href="#unregister">取消注册</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dom-serviceworkerregistration-unregister">unregister()</a><span>, 位于 § 3.2.9</span>
    <li><a href="#dfn-service-worker-registration-unregistered">未注册</a><span>, 位于 § 2.3</span>
    <li><a href="#update">更新</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dom-serviceworkerregistration-update">update()</a><span>, 位于 § 3.2.8</span>
    <li><a href="#service-worker-registration-updatefound-event">updatefound</a><span>, 位于 § 3.5</span>
    <li><a href="#update-registration-state">更新注册状态</a><span>, 位于 § 未编号部分</span>
    <li><a href="#update-service-worker-extended-events-set">更新 Service Worker 扩展事件集</a><span>, 位于 § 未编号部分</span>
    <li>
      updateViaCache
      <ul>
        <li><a href="#dom-serviceworkerregistration-updateviacache">ServiceWorkerRegistration 的属性</a><span>, 位于
            § 3.2.7</span>
        <li><a href="#dom-registrationoptions-updateviacache">RegistrationOptions 的字典成员</a><span>, 位于 § 3.4</span>
      </ul>
    <li>
      通过缓存更新模式
      <ul>
        <li><a href="#dfn-job-update-via-cache-mode">工作的定义</a><span>, 位于 § 未编号部分</span>
        <li><a href="#dfn-update-via-cache">Service Worker 注册的定义</a><span>, 位于 § 2.3</span>
      </ul>
    <li><a href="#update-worker-state">更新 worker 状态</a><span>, 位于 § 未编号部分</span>
    <li><a href="#dom-client-url">url</a><span>, 位于 § 4.2.1</span>
    <li><a href="#dfn-use">使用</a><span>, 位于 § 2.5</span>
    <li><a href="#dfn-use">用途</a><span>, 位于 § 2.5</span>
    <li><a href="#dfn-use">使用</a><span>, 位于 § 2.5</span>
    <li><a href="#dfn-service-worker-client-visibilitystate">可见性状态</a><span>, 位于 § 4.2</span>
    <li><a href="#dom-windowclient-visibilitystate">visibilityState</a><span>, 位于 § 4.2.7</span>
    <li><a href="#dom-serviceworkerregistration-waiting">waiting</a><span>, 位于 § 3.2.3</span>
    <li><a href="#dfn-waiting-worker">等待中的 worker</a><span>, 位于 § 2.3</span>
    <li><a href="#fetchevent-wait-to-respond-flag">等待响应标志</a><span>, 位于 § 4.5</span>
    <li><a href="#dom-extendableevent-waituntil">waitUntil(f)</a><span>, 位于 § 4.4.1</span>
    <li><a href="#dom-clienttype-window">"window"</a><span>, 位于 § 4.3</span>
    <li><a href="#dfn-window-client">窗口客户端</a><span>, 位于 § 2.4</span>
    <li><a href="#windowclient">WindowClient</a><span>, 位于 § 4.2</span>
    <li><a href="#dom-clienttype-worker">"worker"</a><span>, 位于 § 4.3</span>
    <li><a href="#dfn-worker-client">worker 客户端</a><span>, 位于 § 2.4</span>
    <li><a href="#dfn-job-worker-type">worker 类型</a><span>, 位于 § 未编号部分</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-enforced">
    <a href="https://www.w3.org/TR/CSP3/#enforced">https://www.w3.org/TR/CSP3/#enforced</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-enforced">6.2. Content Security Policy</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-monitored">
    <a href="https://www.w3.org/TR/CSP3/#monitored">https://www.w3.org/TR/CSP3/#monitored</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-monitored">6.2. Content Security Policy</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-document">
    <a href="https://dom.spec.whatwg.org/#document">https://dom.spec.whatwg.org/#document</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-document">4.2.11. navigate(url)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-event">
    <a href="https://dom.spec.whatwg.org/#event">https://dom.spec.whatwg.org/#event</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-event">3.5. Events</a> <a href="#ref-for-event①">(2)</a> <a href="#ref-for-event②">(3)</a>
        <a href="#ref-for-event③">(4)</a> <a href="#ref-for-event④">(5)</a>
      <li><a href="#ref-for-event⑤">4.4. ExtendableEvent</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dictdef-eventinit">
    <a href="https://dom.spec.whatwg.org/#dictdef-eventinit">https://dom.spec.whatwg.org/#dictdef-eventinit</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dictdef-eventinit">4.4. ExtendableEvent</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-eventtarget">
    <a href="https://dom.spec.whatwg.org/#eventtarget">https://dom.spec.whatwg.org/#eventtarget</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-eventtarget">3.1. ServiceWorker</a>
      <li><a href="#ref-for-eventtarget①">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-eventtarget②">3.4. ServiceWorkerContainer</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-event-cancelable">
    <a href="https://dom.spec.whatwg.org/#dom-event-cancelable">https://dom.spec.whatwg.org/#dom-event-cancelable</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-event-cancelable">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-canceled-flag">
    <a href="https://dom.spec.whatwg.org/#canceled-flag">https://dom.spec.whatwg.org/#canceled-flag</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-canceled-flag">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-event-create">
    <a href="https://dom.spec.whatwg.org/#concept-event-create">https://dom.spec.whatwg.org/#concept-event-create</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-event-create">3.1.5. postMessage(message, options)</a> <a
          href="#ref-for-concept-event-create①">(2)</a>
      <li><a href="#ref-for-concept-event-create②">Install</a>
      <li><a href="#ref-for-concept-event-create③">Activate</a>
      <li><a href="#ref-for-concept-event-create④">Handle Fetch</a>
      <li><a href="#ref-for-concept-event-create⑤">Fire Functional Event</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-event-dispatch">
    <a
      href="https://dom.spec.whatwg.org/#concept-event-dispatch">https://dom.spec.whatwg.org/#concept-event-dispatch</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-event-dispatch">2.6. Task Sources</a> <a
          href="#ref-for-concept-event-dispatch①">(2)</a>
      <li><a href="#ref-for-concept-event-dispatch②">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-concept-event-dispatch③">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-concept-event-dispatch④">Install</a>
      <li><a href="#ref-for-concept-event-dispatch⑤">Activate</a>
      <li><a href="#ref-for-concept-event-dispatch⑥">Handle Fetch</a>
      <li><a href="#ref-for-concept-event-dispatch⑦">Fire Functional Event</a> <a
          href="#ref-for-concept-event-dispatch⑧">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dispatch-flag">
    <a href="https://dom.spec.whatwg.org/#dispatch-flag">https://dom.spec.whatwg.org/#dispatch-flag</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dispatch-flag">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-dispatch-flag①">4.5.7. event.respondWith(r)</a>
      <li><a href="#ref-for-dispatch-flag②">Update Service Worker Extended Events Set</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-document">
    <a href="https://dom.spec.whatwg.org/#concept-document">https://dom.spec.whatwg.org/#concept-document</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-document">2.5.1. The window client case</a> <a
          href="#ref-for-concept-document①">(2)</a> <a href="#ref-for-concept-document②">(3)</a> <a
          href="#ref-for-concept-document③">(4)</a>
      <li><a href="#ref-for-concept-document④">2.5. Control and Use</a> <a href="#ref-for-concept-document⑤">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-event">
    <a href="https://dom.spec.whatwg.org/#concept-event">https://dom.spec.whatwg.org/#concept-event</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-event">2.1.2. Events</a> <a href="#ref-for-concept-event①">(2)</a>
      <li><a href="#ref-for-concept-event②">4.5.2. event.preloadResponse</a>
      <li><a href="#ref-for-concept-event③">4.5.3. event.clientId</a>
      <li><a href="#ref-for-concept-event④">4.5.4. event.resultingClientId</a>
      <li><a href="#ref-for-concept-event⑤">4.5.5. event.replacesClientId</a>
      <li><a href="#ref-for-concept-event⑥">4.5.6. event.handled</a>
      <li><a href="#ref-for-concept-event⑦">Update Service Worker Extended Events Set</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-event-listener">
    <a
      href="https://dom.spec.whatwg.org/#concept-event-listener">https://dom.spec.whatwg.org/#concept-event-listener</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-event-listener">2.1. Service Worker</a>
      <li><a href="#ref-for-concept-event-listener①">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-event-fire">
    <a href="https://dom.spec.whatwg.org/#concept-event-fire">https://dom.spec.whatwg.org/#concept-event-fire</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-event-fire">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-concept-event-fire①">Install</a>
      <li><a href="#ref-for-concept-event-fire②">Update Worker State</a>
      <li><a href="#ref-for-concept-event-fire③">Notify Controller Change</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-event-istrusted">
    <a href="https://dom.spec.whatwg.org/#dom-event-istrusted">https://dom.spec.whatwg.org/#dom-event-istrusted</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-event-istrusted">4.4. ExtendableEvent</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-abortsignal-signal-abort">
    <a
      href="https://dom.spec.whatwg.org/#abortsignal-signal-abort">https://dom.spec.whatwg.org/#abortsignal-signal-abort</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-abortsignal-signal-abort">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-stop-immediate-propagation-flag">
    <a
      href="https://dom.spec.whatwg.org/#stop-immediate-propagation-flag">https://dom.spec.whatwg.org/#stop-immediate-propagation-flag</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-stop-immediate-propagation-flag">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-stop-propagation-flag">
    <a
      href="https://dom.spec.whatwg.org/#stop-propagation-flag">https://dom.spec.whatwg.org/#stop-propagation-flag</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-stop-propagation-flag">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-event-type">
    <a href="https://dom.spec.whatwg.org/#dom-event-type">https://dom.spec.whatwg.org/#dom-event-type</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-event-type">Install</a>
      <li><a href="#ref-for-dom-event-type①">Activate</a>
      <li><a href="#ref-for-dom-event-type②">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-normalcompletion">
    <a
      href="http://tc39.github.io/ecma262/#sec-normalcompletion">http://tc39.github.io/ecma262/#sec-normalcompletion</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-sec-normalcompletion">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-throwcompletion">
    <a
      href="http://tc39.github.io/ecma262/#sec-throwcompletion">http://tc39.github.io/ecma262/#sec-throwcompletion</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-sec-throwcompletion">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-completion-record-specification-type">
    <a
      href="http://tc39.github.io/ecma262/#sec-completion-record-specification-type">http://tc39.github.io/ecma262/#sec-completion-record-specification-type</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-sec-completion-record-specification-type">2.1. Service Worker</a>
      <li><a href="#ref-for-sec-completion-record-specification-type①">Update</a>
      <li><a href="#ref-for-sec-completion-record-specification-type②">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-algorithm-conventions">
    <a
      href="http://tc39.github.io/ecma262/#sec-algorithm-conventions">http://tc39.github.io/ecma262/#sec-algorithm-conventions</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-sec-algorithm-conventions">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-completion-record-specification-type">
    <a
      href="http://tc39.github.io/ecma262/#sec-completion-record-specification-type">http://tc39.github.io/ecma262/#sec-completion-record-specification-type</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-sec-completion-record-specification-type">2.1. Service Worker</a>
      <li><a href="#ref-for-sec-completion-record-specification-type①">Update</a>
      <li><a href="#ref-for-sec-completion-record-specification-type②">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-cyclic-module-records">
    <a
      href="http://tc39.github.io/ecma262/#sec-cyclic-module-records">http://tc39.github.io/ecma262/#sec-cyclic-module-records</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-sec-cyclic-module-records">Is Async Module</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-detacharraybuffer">
    <a
      href="http://tc39.github.io/ecma262/#sec-detacharraybuffer">http://tc39.github.io/ecma262/#sec-detacharraybuffer</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-sec-detacharraybuffer">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-map-objects">
    <a href="http://tc39.github.io/ecma262/#sec-map-objects">http://tc39.github.io/ecma262/#sec-map-objects</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-sec-map-objects">5.5. CacheStorage</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-abstract-module-records">
    <a
      href="http://tc39.github.io/ecma262/#sec-abstract-module-records">http://tc39.github.io/ecma262/#sec-abstract-module-records</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-sec-abstract-module-records">Is Async Module</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-promise-objects">
    <a
      href="http://tc39.github.io/ecma262/#sec-promise-objects">http://tc39.github.io/ecma262/#sec-promise-objects</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-sec-promise-objects">3.2.8. update()</a>
      <li><a href="#ref-for-sec-promise-objects①">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-sec-promise-objects②">3.4.3. register(scriptURL, options)</a>
      <li><a href="#ref-for-sec-promise-objects③">3.4.4. getRegistration(clientURL)</a> <a
          href="#ref-for-sec-promise-objects④">(2)</a>
      <li><a href="#ref-for-sec-promise-objects⑤">4.1.4. skipWaiting()</a>
      <li><a href="#ref-for-sec-promise-objects⑥">4.2.10. focus()</a> <a href="#ref-for-sec-promise-objects⑦">(2)</a>
      <li><a href="#ref-for-sec-promise-objects⑧">4.2.11. navigate(url)</a> <a
          href="#ref-for-sec-promise-objects⑨">(2)</a> <a href="#ref-for-sec-promise-objects①⓪">(3)</a> <a
          href="#ref-for-sec-promise-objects①①">(4)</a>
      <li><a href="#ref-for-sec-promise-objects①②">4.3.1. get(id)</a>
      <li><a href="#ref-for-sec-promise-objects①③">4.3.3. openWindow(url)</a> <a
          href="#ref-for-sec-promise-objects①④">(2)</a> <a href="#ref-for-sec-promise-objects①⑤">(3)</a> <a
          href="#ref-for-sec-promise-objects①⑥">(4)</a>
      <li><a href="#ref-for-sec-promise-objects①⑦">4.3.4. claim()</a> <a href="#ref-for-sec-promise-objects①⑧">(2)</a>
      <li><a href="#ref-for-sec-promise-objects①⑨">4.4. ExtendableEvent</a> <a
          href="#ref-for-sec-promise-objects②⓪">(2)</a> <a href="#ref-for-sec-promise-objects②①">(3)</a> <a
          href="#ref-for-sec-promise-objects②②">(4)</a> <a href="#ref-for-sec-promise-objects②③">(5)</a>
      <li><a href="#ref-for-sec-promise-objects②④">4.5.6. event.handled</a>
      <li><a href="#ref-for-sec-promise-objects②⑤">4.5.7. event.respondWith(r)</a>
      <li><a href="#ref-for-sec-promise-objects②⑥">Appendix A: Algorithms</a>
      <li><a href="#ref-for-sec-promise-objects②⑦">Create Job</a>
      <li><a href="#ref-for-sec-promise-objects②⑧">Start Register</a>
      <li><a href="#ref-for-sec-promise-objects②⑨">Handle Fetch</a>
      <li><a href="#ref-for-sec-promise-objects③⓪">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-utf-8">
    <a href="https://encoding.spec.whatwg.org/#utf-8">https://encoding.spec.whatwg.org/#utf-8</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-utf-8">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-requestdestination-report">
    <a
      href="https://fetch.spec.whatwg.org/#dom-requestdestination-report">https://fetch.spec.whatwg.org/#dom-requestdestination-report</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-requestdestination-report">Handle Fetch</a> <a
          href="#ref-for-dom-requestdestination-report①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-headers">
    <a href="https://fetch.spec.whatwg.org/#headers">https://fetch.spec.whatwg.org/#headers</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-headers">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-headers①">5.4.7. keys(request, options)</a>
      <li><a href="#ref-for-headers②">Handle Fetch</a> <a href="#ref-for-headers③">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-request">
    <a href="https://fetch.spec.whatwg.org/#request">https://fetch.spec.whatwg.org/#request</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-request">4.5. FetchEvent</a> <a href="#ref-for-request①">(2)</a>
      <li><a href="#ref-for-request②">5.4. Cache</a>
      <li><a href="#ref-for-request③">5.4.2. matchAll(request, options)</a> <a href="#ref-for-request④">(2)</a>
      <li><a href="#ref-for-request⑤">5.4.4. addAll(requests)</a> <a href="#ref-for-request⑥">(2)</a>
      <li><a href="#ref-for-request⑦">5.4.5. put(request, response)</a> <a href="#ref-for-request⑧">(2)</a>
      <li><a href="#ref-for-request⑨">5.4.6. delete(request, options)</a> <a href="#ref-for-request①⓪">(2)</a>
      <li><a href="#ref-for-request①①">5.4.7. keys(request, options)</a> <a href="#ref-for-request①②">(2)</a> <a
          href="#ref-for-request①③">(3)</a>
      <li><a href="#ref-for-request①④">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-requestinfo">
    <a href="https://fetch.spec.whatwg.org/#requestinfo">https://fetch.spec.whatwg.org/#requestinfo</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-requestinfo">5.4. Cache</a> <a href="#ref-for-requestinfo①">(2)</a> <a
          href="#ref-for-requestinfo②">(3)</a> <a href="#ref-for-requestinfo③">(4)</a> <a
          href="#ref-for-requestinfo④">(5)</a> <a href="#ref-for-requestinfo⑤">(6)</a> <a
          href="#ref-for-requestinfo⑥">(7)</a>
      <li><a href="#ref-for-requestinfo⑦">5.5. CacheStorage</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-response">
    <a href="https://fetch.spec.whatwg.org/#response">https://fetch.spec.whatwg.org/#response</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-response">4.5. FetchEvent</a>
      <li><a href="#ref-for-response①">4.5.7. event.respondWith(r)</a> <a href="#ref-for-response②">(2)</a> <a
          href="#ref-for-response③">(3)</a>
      <li><a href="#ref-for-response④">4.7. Events</a> <a href="#ref-for-response⑤">(2)</a>
      <li><a href="#ref-for-response⑥">5.4. Cache</a> <a href="#ref-for-response⑦">(2)</a> <a
          href="#ref-for-response⑧">(3)</a>
      <li><a href="#ref-for-response⑨">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-response①⓪">5.5. CacheStorage</a>
      <li><a href="#ref-for-response①①">6.4. Cross-Origin Resources and CORS</a> <a href="#ref-for-response①②">(2)</a>
        <a href="#ref-for-response①③">(3)</a>
      <li><a href="#ref-for-response①④">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-fetch-controller-abort">
    <a
      href="https://fetch.spec.whatwg.org/#fetch-controller-abort">https://fetch.spec.whatwg.org/#fetch-controller-abort</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-fetch-controller-abort">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-response-aborted">
    <a
      href="https://fetch.spec.whatwg.org/#concept-response-aborted">https://fetch.spec.whatwg.org/#concept-response-aborted</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-response-aborted">5.4.4. addAll(requests)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-header-list-append">
    <a
      href="https://fetch.spec.whatwg.org/#concept-header-list-append">https://fetch.spec.whatwg.org/#concept-header-list-append</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-header-list-append">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-filtered-response-basic">
    <a
      href="https://fetch.spec.whatwg.org/#concept-filtered-response-basic">https://fetch.spec.whatwg.org/#concept-filtered-response-basic</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-filtered-response-basic">6.4. Cross-Origin Resources and CORS</a> <a
          href="#ref-for-concept-filtered-response-basic①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-response-body">
    <a
      href="https://fetch.spec.whatwg.org/#concept-response-body">https://fetch.spec.whatwg.org/#concept-response-body</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-response-body">4.5.7. event.respondWith(r)</a> <a
          href="#ref-for-concept-response-body①">(2)</a> <a href="#ref-for-concept-response-body②">(3)</a> <a
          href="#ref-for-concept-response-body③">(4)</a> <a href="#ref-for-concept-response-body④">(5)</a>
      <li><a href="#ref-for-concept-response-body⑤">5.4.5. put(request, response)</a> <a
          href="#ref-for-concept-response-body⑥">(2)</a> <a href="#ref-for-concept-response-body⑦">(3)</a> <a
          href="#ref-for-concept-response-body⑧">(4)</a>
      <li><a href="#ref-for-concept-response-body⑨">Update</a> <a href="#ref-for-concept-response-body①⓪">(2)</a> <a
          href="#ref-for-concept-response-body①①">(3)</a> <a href="#ref-for-concept-response-body①②">(4)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-cache-mode">
    <a
      href="https://fetch.spec.whatwg.org/#concept-request-cache-mode">https://fetch.spec.whatwg.org/#concept-request-cache-mode</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-request-cache-mode">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-concept-request-cache-mode①">Update</a> <a
          href="#ref-for-concept-request-cache-mode②">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-response-cache-state">
    <a
      href="https://fetch.spec.whatwg.org/#concept-response-cache-state">https://fetch.spec.whatwg.org/#concept-response-cache-state</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-response-cache-state">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-concept-response-cache-state①">Update</a> <a
          href="#ref-for-concept-response-cache-state②">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-client">
    <a
      href="https://fetch.spec.whatwg.org/#concept-request-client">https://fetch.spec.whatwg.org/#concept-request-client</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-request-client">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-concept-request-client①">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-concept-request-client②">Update</a>
      <li><a href="#ref-for-concept-request-client③">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-response-clone">
    <a
      href="https://fetch.spec.whatwg.org/#concept-response-clone">https://fetch.spec.whatwg.org/#concept-response-clone</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-response-clone">5.4.5. put(request, response)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-header-list-combine">
    <a
      href="https://fetch.spec.whatwg.org/#concept-header-list-combine">https://fetch.spec.whatwg.org/#concept-header-list-combine</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-header-list-combine">Request Matches Cached Item</a> <a
          href="#ref-for-concept-header-list-combine①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-header-list-contains">
    <a
      href="https://fetch.spec.whatwg.org/#header-list-contains">https://fetch.spec.whatwg.org/#header-list-contains</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-header-list-contains">Request Matches Cached Item</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-filtered-response-cors">
    <a
      href="https://fetch.spec.whatwg.org/#concept-filtered-response-cors">https://fetch.spec.whatwg.org/#concept-filtered-response-cors</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-filtered-response-cors">6.4. Cross-Origin Resources and CORS</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-cross-origin-resource-policy-check">
    <a
      href="https://fetch.spec.whatwg.org/#cross-origin-resource-policy-check">https://fetch.spec.whatwg.org/#cross-origin-resource-policy-check</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-cross-origin-resource-policy-check">5.4.2. matchAll(request, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-destination">
    <a
      href="https://fetch.spec.whatwg.org/#concept-request-destination">https://fetch.spec.whatwg.org/#concept-request-destination</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-request-destination">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-concept-request-destination①">Update</a>
      <li><a href="#ref-for-concept-request-destination②">Handle Fetch</a> <a
          href="#ref-for-concept-request-destination③">(2)</a> <a href="#ref-for-concept-request-destination④">(3)</a>
        <a href="#ref-for-concept-request-destination⑤">(4)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-header-extract-mime-type">
    <a
      href="https://fetch.spec.whatwg.org/#concept-header-extract-mime-type">https://fetch.spec.whatwg.org/#concept-header-extract-mime-type</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-header-extract-mime-type">Appendix A: Algorithms</a>
      <li><a href="#ref-for-concept-header-extract-mime-type①">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-extract-header-list-values">
    <a
      href="https://fetch.spec.whatwg.org/#extract-header-list-values">https://fetch.spec.whatwg.org/#extract-header-list-values</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-extract-header-list-values">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-fetch">
    <a href="https://fetch.spec.whatwg.org/#concept-fetch">https://fetch.spec.whatwg.org/#concept-fetch</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-fetch">2.5.1. The window client case</a>
      <li><a href="#ref-for-concept-fetch①">2.5.2. The worker client case</a>
      <li><a href="#ref-for-concept-fetch②">4.5.7. event.respondWith(r)</a> <a href="#ref-for-concept-fetch③">(2)</a> <a
          href="#ref-for-concept-fetch④">(3)</a> <a href="#ref-for-concept-fetch⑤">(4)</a>
      <li><a href="#ref-for-concept-fetch⑥">5.4.4. addAll(requests)</a> <a href="#ref-for-concept-fetch⑦">(2)</a> <a
          href="#ref-for-concept-fetch⑧">(3)</a>
      <li><a href="#ref-for-concept-fetch⑨">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-concept-fetch①⓪">6.4. Cross-Origin Resources and CORS</a> <a
          href="#ref-for-concept-fetch①①">(2)</a>
      <li><a href="#ref-for-concept-fetch①②">Update</a> <a href="#ref-for-concept-fetch①③">(2)</a> <a
          href="#ref-for-concept-fetch①④">(3)</a>
      <li><a href="#ref-for-concept-fetch①⑤">Handle Fetch</a> <a href="#ref-for-concept-fetch①⑥">(2)</a> <a
          href="#ref-for-concept-fetch①⑦">(3)</a>
      <li><a href="#ref-for-concept-fetch①⑧">Service Worker Script Request</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-fetch-controller">
    <a href="https://fetch.spec.whatwg.org/#fetch-controller">https://fetch.spec.whatwg.org/#fetch-controller</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-fetch-controller">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-global-fetch">
    <a href="https://fetch.spec.whatwg.org/#dom-global-fetch">https://fetch.spec.whatwg.org/#dom-global-fetch</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-global-fetch">4.7. Events</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-filtered-response">
    <a
      href="https://fetch.spec.whatwg.org/#concept-filtered-response">https://fetch.spec.whatwg.org/#concept-filtered-response</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-filtered-response">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-headers-guard">
    <a
      href="https://fetch.spec.whatwg.org/#concept-headers-guard">https://fetch.spec.whatwg.org/#concept-headers-guard</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-headers-guard">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-concept-headers-guard①">5.4.7. keys(request, options)</a>
      <li><a href="#ref-for-concept-headers-guard②">Handle Fetch</a> <a href="#ref-for-concept-headers-guard③">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-header">
    <a href="https://fetch.spec.whatwg.org/#concept-header">https://fetch.spec.whatwg.org/#concept-header</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-header">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-concept-header①">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-concept-header②">Handle Fetch</a>
      <li><a href="#ref-for-concept-header③">Request Matches Cached Item</a>
      <li><a href="#ref-for-concept-header④">Service Worker Script Request</a>
      <li><a href="#ref-for-concept-header⑤">Service Worker Script Response</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-response-header-list">
    <a
      href="https://fetch.spec.whatwg.org/#concept-response-header-list">https://fetch.spec.whatwg.org/#concept-response-header-list</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-response-header-list">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-concept-response-header-list①">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-concept-response-header-list②">Appendix A: Algorithms</a>
      <li><a href="#ref-for-concept-response-header-list③">Update</a> <a
          href="#ref-for-concept-response-header-list④">(2)</a>
      <li><a href="#ref-for-concept-response-header-list⑤">Request Matches Cached Item</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-http-fetch">
    <a href="https://fetch.spec.whatwg.org/#concept-http-fetch">https://fetch.spec.whatwg.org/#concept-http-fetch</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-http-fetch">2.5.1. The window client case</a>
      <li><a href="#ref-for-concept-http-fetch①">2.5.2. The worker client case</a>
      <li><a href="#ref-for-concept-http-fetch②">4.7. Events</a> <a href="#ref-for-concept-http-fetch③">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-initiator">
    <a
      href="https://fetch.spec.whatwg.org/#concept-request-initiator">https://fetch.spec.whatwg.org/#concept-request-initiator</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-request-initiator">5.4.4. addAll(requests)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-method">
    <a
      href="https://fetch.spec.whatwg.org/#concept-request-method">https://fetch.spec.whatwg.org/#concept-request-method</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-request-method">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-concept-request-method①">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-concept-request-method②">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-concept-request-method③">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-concept-request-method④">5.4.7. keys(request, options)</a>
      <li><a href="#ref-for-concept-request-method⑤">Handle Fetch</a>
      <li><a href="#ref-for-concept-request-method⑥">Request Matches Cached Item</a>
      <li><a href="#ref-for-concept-request-method⑦">Batch Cache Operations</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-header-name">
    <a
      href="https://fetch.spec.whatwg.org/#concept-header-name">https://fetch.spec.whatwg.org/#concept-header-name</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-header-name">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-concept-header-name①">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-concept-header-name②">Handle Fetch</a>
      <li><a href="#ref-for-concept-header-name③">Request Matches Cached Item</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-request">
    <a href="https://fetch.spec.whatwg.org/#navigation-request">https://fetch.spec.whatwg.org/#navigation-request</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-navigation-request">Handle Fetch</a> <a href="#ref-for-navigation-request①">(2)</a> <a
          href="#ref-for-navigation-request②">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-network-error">
    <a
      href="https://fetch.spec.whatwg.org/#concept-network-error">https://fetch.spec.whatwg.org/#concept-network-error</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-network-error">4.5.7. event.respondWith(r)</a> <a
          href="#ref-for-concept-network-error①">(2)</a>
      <li><a href="#ref-for-concept-network-error②">6.3.2. importScripts(urls)</a> <a
          href="#ref-for-concept-network-error③">(2)</a>
      <li><a href="#ref-for-concept-network-error④">Update</a> <a href="#ref-for-concept-network-error⑤">(2)</a> <a
          href="#ref-for-concept-network-error⑥">(3)</a>
      <li><a href="#ref-for-concept-network-error⑦">Handle Fetch</a> <a href="#ref-for-concept-network-error⑧">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-non-subresource-request">
    <a
      href="https://fetch.spec.whatwg.org/#non-subresource-request">https://fetch.spec.whatwg.org/#non-subresource-request</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-non-subresource-request">Handle Fetch</a> <a
          href="#ref-for-non-subresource-request①">(2)</a> <a href="#ref-for-non-subresource-request②">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ok-status">
    <a href="https://fetch.spec.whatwg.org/#ok-status">https://fetch.spec.whatwg.org/#ok-status</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-ok-status">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-ok-status①">Appendix A: Algorithms</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-filtered-response-opaque">
    <a
      href="https://fetch.spec.whatwg.org/#concept-filtered-response-opaque">https://fetch.spec.whatwg.org/#concept-filtered-response-opaque</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-filtered-response-opaque">6.4. Cross-Origin Resources and CORS</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-origin">
    <a
      href="https://fetch.spec.whatwg.org/#concept-request-origin">https://fetch.spec.whatwg.org/#concept-request-origin</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-request-origin">2.5. Control and Use</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-parser-metadata">
    <a
      href="https://fetch.spec.whatwg.org/#concept-request-parser-metadata">https://fetch.spec.whatwg.org/#concept-request-parser-metadata</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-request-parser-metadata">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-redirect-mode">
    <a
      href="https://fetch.spec.whatwg.org/#concept-request-redirect-mode">https://fetch.spec.whatwg.org/#concept-request-redirect-mode</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-request-redirect-mode">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-replaces-client-id">
    <a
      href="https://fetch.spec.whatwg.org/#concept-request-replaces-client-id">https://fetch.spec.whatwg.org/#concept-request-replaces-client-id</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-request-replaces-client-id">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-request">
    <a
      href="https://fetch.spec.whatwg.org/#concept-request-request">https://fetch.spec.whatwg.org/#concept-request-request</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-request-request">5.4.2. matchAll(request, options)</a> <a
          href="#ref-for-concept-request-request①">(2)</a>
      <li><a href="#ref-for-concept-request-request②">5.4.4. addAll(requests)</a> <a
          href="#ref-for-concept-request-request③">(2)</a>
      <li><a href="#ref-for-concept-request-request④">5.4.5. put(request, response)</a> <a
          href="#ref-for-concept-request-request⑤">(2)</a>
      <li><a href="#ref-for-concept-request-request⑥">5.4.6. delete(request, options)</a> <a
          href="#ref-for-concept-request-request⑦">(2)</a>
      <li><a href="#ref-for-concept-request-request⑧">5.4.7. keys(request, options)</a> <a
          href="#ref-for-concept-request-request⑨">(2)</a>
      <li><a href="#ref-for-concept-request-request①⓪">Batch Cache Operations</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-reserved-client">
    <a
      href="https://fetch.spec.whatwg.org/#concept-request-reserved-client">https://fetch.spec.whatwg.org/#concept-request-reserved-client</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-request-reserved-client">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-response-response">
    <a
      href="https://fetch.spec.whatwg.org/#concept-response-response">https://fetch.spec.whatwg.org/#concept-response-response</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-response-response">4.5.7. event.respondWith(r)</a>
      <li><a href="#ref-for-concept-response-response①">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-concept-response-response②">6.4. Cross-Origin Resources and CORS</a> <a
          href="#ref-for-concept-response-response③">(2)</a> <a href="#ref-for-concept-response-response④">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-response-service-worker-timing-info">
    <a
      href="https://fetch.spec.whatwg.org/#response-service-worker-timing-info">https://fetch.spec.whatwg.org/#response-service-worker-timing-info</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-response-service-worker-timing-info">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-request-service-workers-mode">
    <a
      href="https://fetch.spec.whatwg.org/#request-service-workers-mode">https://fetch.spec.whatwg.org/#request-service-workers-mode</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-request-service-workers-mode">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-request-service-workers-mode①">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-request-service-workers-mode②">Update</a>
      <li><a href="#ref-for-request-service-workers-mode③">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-request-signal">
    <a href="https://fetch.spec.whatwg.org/#dom-request-signal">https://fetch.spec.whatwg.org/#dom-request-signal</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-request-signal">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-response-status">
    <a
      href="https://fetch.spec.whatwg.org/#concept-response-status">https://fetch.spec.whatwg.org/#concept-response-status</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-response-status">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-concept-response-status①">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-concept-response-status②">Appendix A: Algorithms</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-body-stream">
    <a
      href="https://fetch.spec.whatwg.org/#concept-body-stream">https://fetch.spec.whatwg.org/#concept-body-stream</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-body-stream">4.5.7. event.respondWith(r)</a> <a
          href="#ref-for-concept-body-stream①">(2)</a> <a href="#ref-for-concept-body-stream②">(3)</a>
      <li><a href="#ref-for-concept-body-stream③">5.4.5. put(request, response)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-subresource-request">
    <a
      href="https://fetch.spec.whatwg.org/#subresource-request">https://fetch.spec.whatwg.org/#subresource-request</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-subresource-request">Handle Fetch</a> <a href="#ref-for-subresource-request①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-response-type">
    <a
      href="https://fetch.spec.whatwg.org/#concept-response-type">https://fetch.spec.whatwg.org/#concept-response-type</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-response-type">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-concept-response-type①">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-concept-response-type②">Appendix A: Algorithms</a>
      <li><a href="#ref-for-concept-response-type③">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-body-unusable">
    <a href="https://fetch.spec.whatwg.org/#body-unusable">https://fetch.spec.whatwg.org/#body-unusable</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-body-unusable">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-url">
    <a
      href="https://fetch.spec.whatwg.org/#concept-request-url">https://fetch.spec.whatwg.org/#concept-request-url</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-request-url">2.5.2. The worker client case</a>
      <li><a href="#ref-for-concept-request-url①">5.4.4. addAll(requests)</a> <a
          href="#ref-for-concept-request-url②">(2)</a>
      <li><a href="#ref-for-concept-request-url③">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-concept-request-url④">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-concept-request-url⑤">Update</a> <a href="#ref-for-concept-request-url⑥">(2)</a> <a
          href="#ref-for-concept-request-url⑦">(3)</a>
      <li><a href="#ref-for-concept-request-url⑧">Handle Fetch</a> <a href="#ref-for-concept-request-url⑨">(2)</a>
      <li><a href="#ref-for-concept-request-url①⓪">Request Matches Cached Item</a> <a
          href="#ref-for-concept-request-url①①">(2)</a>
      <li><a href="#ref-for-concept-request-url①②">Batch Cache Operations</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-use-url-credentials-flag">
    <a
      href="https://fetch.spec.whatwg.org/#concept-request-use-url-credentials-flag">https://fetch.spec.whatwg.org/#concept-request-use-url-credentials-flag</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-request-use-url-credentials-flag">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-header-value">
    <a
      href="https://fetch.spec.whatwg.org/#concept-header-value">https://fetch.spec.whatwg.org/#concept-header-value</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-header-value">Handle Fetch</a>
      <li><a href="#ref-for-concept-header-value①">Request Matches Cached Item</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-blob-url">
    <a href="https://w3c.github.io/FileAPI/#blob-url">https://w3c.github.io/FileAPI/#blob-url</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-blob-url">2.5.2. The worker client case</a>
      <li><a href="#ref-for-blob-url①">2.5. Control and Use</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-domhighrestimestamp">
    <a
      href="https://www.w3.org/TR/hr-time-3/#dom-domhighrestimestamp">https://www.w3.org/TR/hr-time-3/#dom-domhighrestimestamp</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-domhighrestimestamp">2.2. Service Worker Timing</a> <a
          href="#ref-for-dom-domhighrestimestamp①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-coarsen-time">
    <a href="https://www.w3.org/TR/hr-time-3/#dfn-coarsen-time">https://www.w3.org/TR/hr-time-3/#dfn-coarsen-time</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-coarsen-time">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-coarsened-shared-current-time">
    <a
      href="https://www.w3.org/TR/hr-time-3/#dfn-coarsened-shared-current-time">https://www.w3.org/TR/hr-time-3/#dfn-coarsened-shared-current-time</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-coarsened-shared-current-time">Handle Fetch</a> <a
          href="#ref-for-dfn-coarsened-shared-current-time①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-unsafe-shared-current-time">
    <a
      href="https://www.w3.org/TR/hr-time-3/#dfn-unsafe-shared-current-time">https://www.w3.org/TR/hr-time-3/#dfn-unsafe-shared-current-time</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-unsafe-shared-current-time">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-abstractworker">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#abstractworker">https://html.spec.whatwg.org/multipage/workers.html#abstractworker</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-abstractworker">3.1. ServiceWorker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-event-domcontentloaded">
    <a
      href="https://html.spec.whatwg.org/multipage/indices.html#event-domcontentloaded">https://html.spec.whatwg.org/multipage/indices.html#event-domcontentloaded</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-event-domcontentloaded">Run Job</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dedicatedworkerglobalscope">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope">https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dedicatedworkerglobalscope">2.4. Service Worker Client</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-eventhandler">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-eventhandler">3.1. ServiceWorker</a>
      <li><a href="#ref-for-eventhandler①">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-eventhandler②">3.4. ServiceWorkerContainer</a> <a href="#ref-for-eventhandler③">(2)</a> <a
          href="#ref-for-eventhandler④">(3)</a>
      <li><a href="#ref-for-eventhandler⑤">4.1. ServiceWorkerGlobalScope</a> <a href="#ref-for-eventhandler⑥">(2)</a> <a
          href="#ref-for-eventhandler⑦">(3)</a> <a href="#ref-for-eventhandler⑧">(4)</a> <a
          href="#ref-for-eventhandler⑨">(5)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-location">
    <a
      href="https://html.spec.whatwg.org/multipage/history.html#location">https://html.spec.whatwg.org/multipage/history.html#location</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-location">4.2.10. focus()</a>
      <li><a href="#ref-for-location①">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-location②">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-location③">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-location④">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-messageevent">
    <a
      href="https://html.spec.whatwg.org/multipage/comms.html#messageevent">https://html.spec.whatwg.org/multipage/comms.html#messageevent</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-messageevent">4.2.6. postMessage(message, options)</a> <a
          href="#ref-for-messageevent①">(2)</a>
      <li><a href="#ref-for-messageevent②">4.7. Events</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-messageport">
    <a
      href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport">https://html.spec.whatwg.org/multipage/web-messaging.html#messageport</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-messageport">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-messageport①">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-messageport②">4.6. ExtendableMessageEvent</a> <a href="#ref-for-messageport③">(2)</a> <a
          href="#ref-for-messageport④">(3)</a> <a href="#ref-for-messageport⑤">(4)</a>
      <li><a href="#ref-for-messageport⑥">4.6.5. event.ports</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigator">
    <a
      href="https://html.spec.whatwg.org/multipage/system-state.html#navigator">https://html.spec.whatwg.org/multipage/system-state.html#navigator</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-navigator">3.3. navigator.serviceWorker</a>
      <li><a href="#ref-for-navigator①">3.4. ServiceWorkerContainer</a> <a href="#ref-for-navigator②">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sharedworkerglobalscope">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope">https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-sharedworkerglobalscope">2.4. Service Worker Client</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-structureddeserializewithtransfer">
    <a
      href="https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserializewithtransfer">https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserializewithtransfer</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-structureddeserializewithtransfer">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-structureddeserializewithtransfer①">4.2.6. postMessage(message, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-structuredserializeoptions">
    <a
      href="https://html.spec.whatwg.org/multipage/web-messaging.html#structuredserializeoptions">https://html.spec.whatwg.org/multipage/web-messaging.html#structuredserializeoptions</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-structuredserializeoptions">3.1. ServiceWorker</a>
      <li><a href="#ref-for-structuredserializeoptions①">4.2. Client</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-structuredserializewithtransfer">
    <a
      href="https://html.spec.whatwg.org/multipage/structured-data.html#structuredserializewithtransfer">https://html.spec.whatwg.org/multipage/structured-data.html#structuredserializewithtransfer</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-structuredserializewithtransfer">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-structuredserializewithtransfer①">4.2.6. postMessage(message, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-window">
    <a
      href="https://html.spec.whatwg.org/multipage/window-object.html#window">https://html.spec.whatwg.org/multipage/window-object.html#window</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-window">2.4. Service Worker Client</a>
      <li><a href="#ref-for-window①">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-window②">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-window③">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-window④">4.3.3. openWindow(url)</a> <a href="#ref-for-window⑤">(2)</a> <a
          href="#ref-for-window⑥">(3)</a>
      <li><a href="#ref-for-window⑦">5. Caches</a>
      <li><a href="#ref-for-window⑧">5.5. CacheStorage</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-windoworworkerglobalscope">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope">https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-windoworworkerglobalscope">5.3. self.caches</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-worker">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#worker">https://html.spec.whatwg.org/multipage/workers.html#worker</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-worker">4.1. ServiceWorkerGlobalScope</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-workerglobalscope">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-workerglobalscope">4.1. ServiceWorkerGlobalScope</a>
      <li><a href="#ref-for-workerglobalscope①">5. Caches</a>
      <li><a href="#ref-for-workerglobalscope②">5.5. CacheStorage</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-workerlocation">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#workerlocation">https://html.spec.whatwg.org/multipage/workers.html#workerlocation</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-workerlocation">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-workernavigator">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#workernavigator">https://html.spec.whatwg.org/multipage/workers.html#workernavigator</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-workernavigator">3.3. navigator.serviceWorker</a>
      <li><a href="#ref-for-workernavigator①">3.4. ServiceWorkerContainer</a> <a
          href="#ref-for-workernavigator②">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-workertype">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#workertype">https://html.spec.whatwg.org/multipage/workers.html#workertype</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-workertype">3.4. ServiceWorkerContainer</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-active-document">
    <a
      href="https://html.spec.whatwg.org/multipage/browsers.html#active-document">https://html.spec.whatwg.org/multipage/browsers.html#active-document</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-active-document">2.5.1. The window client case</a>
      <li><a href="#ref-for-active-document①">4.2.10. focus()</a> <a href="#ref-for-active-document②">(2)</a> <a
          href="#ref-for-active-document③">(3)</a>
      <li><a href="#ref-for-active-document④">4.2.11. navigate(url)</a> <a href="#ref-for-active-document⑤">(2)</a> <a
          href="#ref-for-active-document⑥">(3)</a>
      <li><a href="#ref-for-active-document⑦">4.3.2. matchAll(options)</a> <a href="#ref-for-active-document⑧">(2)</a>
        <a href="#ref-for-active-document⑨">(3)</a> <a href="#ref-for-active-document①⓪">(4)</a>
      <li><a href="#ref-for-active-document①①">4.3.3. openWindow(url)</a> <a href="#ref-for-active-document①②">(2)</a>
        <a href="#ref-for-active-document①③">(3)</a>
      <li><a href="#ref-for-active-document①④">Resolve Get Client Promise</a> <a
          href="#ref-for-active-document①⑤">(2)</a> <a href="#ref-for-active-document①⑥">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-active-service-worker">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-environment-active-service-worker">2.5. Control and Use</a> <a
          href="#ref-for-concept-environment-active-service-worker①">(2)</a> <a
          href="#ref-for-concept-environment-active-service-worker②">(3)</a> <a
          href="#ref-for-concept-environment-active-service-worker③">(4)</a> <a
          href="#ref-for-concept-environment-active-service-worker①④">(5)</a> <a
          href="#ref-for-concept-environment-active-service-worker①⑤">(6)</a> <a
          href="#ref-for-concept-environment-active-service-worker①⑥">(7)</a>
      <li><a href="#ref-for-concept-environment-active-service-worker④">2.5.1. The window client case</a> <a
          href="#ref-for-concept-environment-active-service-worker⑤">(2)</a> <a
          href="#ref-for-concept-environment-active-service-worker⑥">(3)</a> <a
          href="#ref-for-concept-environment-active-service-worker⑦">(4)</a> <a
          href="#ref-for-concept-environment-active-service-worker⑧">(5)</a> <a
          href="#ref-for-concept-environment-active-service-worker⑨">(6)</a> <a
          href="#ref-for-concept-environment-active-service-worker①⓪">(7)</a>
      <li><a href="#ref-for-concept-environment-active-service-worker①①">2.5.2. The worker client case</a> <a
          href="#ref-for-concept-environment-active-service-worker①②">(2)</a> <a
          href="#ref-for-concept-environment-active-service-worker①③">(3)</a>
      <li><a href="#ref-for-concept-environment-active-service-worker①⑦">3.2.9. unregister()</a>
      <li><a href="#ref-for-concept-environment-active-service-worker①⑧">3.4.1. controller</a> <a
          href="#ref-for-concept-environment-active-service-worker①⑨">(2)</a>
      <li><a href="#ref-for-concept-environment-active-service-worker②⓪">3.5. Events</a>
      <li><a href="#ref-for-concept-environment-active-service-worker②①">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-concept-environment-active-service-worker②②">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-concept-environment-active-service-worker②③">4.3.4. claim()</a> <a
          href="#ref-for-concept-environment-active-service-worker②④">(2)</a>
      <li><a href="#ref-for-concept-environment-active-service-worker②⑤">Run Service Worker</a>
      <li><a href="#ref-for-concept-environment-active-service-worker②⑥">Handle Fetch</a> <a
          href="#ref-for-concept-environment-active-service-worker②⑦">(2)</a> <a
          href="#ref-for-concept-environment-active-service-worker②⑧">(3)</a> <a
          href="#ref-for-concept-environment-active-service-worker②⑨">(4)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-location-ancestor-origins-list">
    <a
      href="https://html.spec.whatwg.org/multipage/browsers.html">https://html.spec.whatwg.org/multipage/browsers.html#concept-location-ancestor-origins-list</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-location-ancestor-origins-list">4.2.10. focus()</a>
      <li><a href="#ref-for-concept-location-ancestor-origins-list①">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-concept-location-ancestor-origins-list②">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-concept-location-ancestor-origins-list③">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-concept-location-ancestor-origins-list④">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-api-base-url">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url">https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-api-base-url">3.4.3. register(scriptURL, options)</a> <a
          href="#ref-for-api-base-url①">(2)</a>
      <li><a href="#ref-for-api-base-url②">3.4.4. getRegistration(clientURL)</a>
      <li><a href="#ref-for-api-base-url③">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-api-base-url④">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-api-base-url⑤">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-api-url-character-encoding">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#api-url-character-encoding">https://html.spec.whatwg.org/multipage/webappapis.html#api-url-character-encoding</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-api-url-character-encoding">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-auxiliary-browsing-context">
    <a
      href="https://html.spec.whatwg.org/multipage/browsers.html#auxiliary-browsing-context">https://html.spec.whatwg.org/multipage/browsers.html#auxiliary-browsing-context</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-auxiliary-browsing-context">Get Frame Type</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-script-base-url">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-script-base-url">https://html.spec.whatwg.org/multipage/webappapis.html#concept-script-base-url</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-script-base-url">Update</a> <a href="#ref-for-concept-script-base-url①">(2)</a> <a
          href="#ref-for-concept-script-base-url②">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-browsing-context">
    <a
      href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context">https://html.spec.whatwg.org/multipage/browsers.html#browsing-context</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-browsing-context">2.5.1. The window client case</a> <a
          href="#ref-for-browsing-context①">(2)</a> <a href="#ref-for-browsing-context②">(3)</a> <a
          href="#ref-for-browsing-context③">(4)</a> <a href="#ref-for-browsing-context④">(5)</a>
      <li><a href="#ref-for-browsing-context⑤">4.2. Client</a>
      <li><a href="#ref-for-browsing-context⑥">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-browsing-context⑦">Get Frame Type</a>
      <li><a href="#ref-for-browsing-context⑧">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-classic-script">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#classic-script">https://html.spec.whatwg.org/multipage/webappapis.html#classic-script</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-classic-script">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-creating-a-new-javascript-realm">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#creating-a-new-javascript-realm">https://html.spec.whatwg.org/multipage/webappapis.html#creating-a-new-javascript-realm</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-creating-a-new-javascript-realm">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-creating-a-policy-container-from-a-fetch-response">
    <a
      href="https://html.spec.whatwg.org/multipage/origin.html#creating-a-policy-container-from-a-fetch-response">https://html.spec.whatwg.org/multipage/origin.html#creating-a-policy-container-from-a-fetch-response</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-creating-a-policy-container-from-a-fetch-response">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-creation-url">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-environment-creation-url">2.4. Service Worker Client</a>
      <li><a href="#ref-for-concept-environment-creation-url①">3.4.2. ready</a>
      <li><a href="#ref-for-concept-environment-creation-url②">3.4.3. register(scriptURL, options)</a>
      <li><a href="#ref-for-concept-environment-creation-url③">4.2.1. url</a>
      <li><a href="#ref-for-concept-environment-creation-url④">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-concept-environment-creation-url⑤">4.3.4. claim()</a>
      <li><a href="#ref-for-concept-environment-creation-url⑥">Create Job</a>
      <li><a href="#ref-for-concept-environment-creation-url⑦">Activate</a>
      <li><a href="#ref-for-concept-environment-creation-url⑧">Run Service Worker</a>
      <li><a href="#ref-for-concept-environment-creation-url⑨">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-workerglobalscope-cross-origin-isolated-capability">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-cross-origin-isolated-capability">https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-cross-origin-isolated-capability</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-workerglobalscope-cross-origin-isolated-capability">Run Service Worker</a>
      <li><a href="#ref-for-concept-workerglobalscope-cross-origin-isolated-capability①">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-current-global-object">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#current-global-object">https://html.spec.whatwg.org/multipage/webappapis.html#current-global-object</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-current-global-object">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-current-global-object①">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-current-global-object②">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-current-global-object③">6.3.2. importScripts(urls)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-messageevent-data">
    <a
      href="https://html.spec.whatwg.org/multipage/comms.html#dom-messageevent-data">https://html.spec.whatwg.org/multipage/comms.html#dom-messageevent-data</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-messageevent-data">4.2.6. postMessage(message, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-a-browsing-context-is-discarded">
    <a
      href="https://html.spec.whatwg.org/multipage/window-object.html#a-browsing-context-is-discarded">https://html.spec.whatwg.org/multipage/window-object.html#a-browsing-context-is-discarded</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-a-browsing-context-is-discarded">4.3.2. matchAll(options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-discard-a-document">
    <a
      href="https://html.spec.whatwg.org/multipage/window-object.html#discard-a-document">https://html.spec.whatwg.org/multipage/window-object.html#discard-a-document</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-discard-a-document">4.2.11. navigate(url)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-environment">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#environment">https://html.spec.whatwg.org/multipage/webappapis.html#environment</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-environment">2.4. Service Worker Client</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-environment-discarding-steps">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-discarding-steps">https://html.spec.whatwg.org/multipage/webappapis.html#environment-discarding-steps</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-environment-discarding-steps">2.4. Service Worker Client</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-environment-settings-object">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-environment-settings-object">2.4. Service Worker Client</a>
      <li><a href="#ref-for-environment-settings-object①">2.5.2. The worker client case</a>
      <li><a href="#ref-for-environment-settings-object②">3.1.1. Getting ServiceWorker instances</a> <a
          href="#ref-for-environment-settings-object③">(2)</a>
      <li><a href="#ref-for-environment-settings-object④">3.2.1. Getting ServiceWorkerRegistration instances</a> <a
          href="#ref-for-environment-settings-object⑤">(2)</a>
      <li><a href="#ref-for-environment-settings-object⑥">4.2.4. type</a>
      <li><a href="#ref-for-environment-settings-object⑦">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-environment-settings-object⑧">4.3.2. matchAll(options)</a> <a
          href="#ref-for-environment-settings-object⑨">(2)</a>
      <li><a href="#ref-for-environment-settings-object①⓪">4.3.3. openWindow(url)</a> <a
          href="#ref-for-environment-settings-object①①">(2)</a> <a href="#ref-for-environment-settings-object①②">(3)</a>
      <li><a href="#ref-for-environment-settings-object①③">5.1. Constructs</a>
      <li><a href="#ref-for-environment-settings-object①④">5.5. CacheStorage</a>
      <li><a href="#ref-for-environment-settings-object①⑤">Update</a> <a
          href="#ref-for-environment-settings-object①⑥">(2)</a> <a href="#ref-for-environment-settings-object①⑦">(3)</a>
        <a href="#ref-for-environment-settings-object①⑧">(4)</a> <a
          href="#ref-for-environment-settings-object①⑨">(5)</a>
      <li><a href="#ref-for-environment-settings-object②⓪">Install</a>
      <li><a href="#ref-for-environment-settings-object②①">Run Service Worker</a>
      <li><a href="#ref-for-environment-settings-object②②">Handle Fetch</a>
      <li><a href="#ref-for-environment-settings-object②③">Update Worker State</a>
      <li><a href="#ref-for-environment-settings-object②④">Notify Controller Change</a>
      <li><a href="#ref-for-environment-settings-object②⑤">Resolve Get Client Promise</a> <a
          href="#ref-for-environment-settings-object②⑥">(2)</a> <a href="#ref-for-environment-settings-object②⑦">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-event-handlers">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers">https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-event-handlers">3.1.6. Event handler</a> <a href="#ref-for-event-handlers①">(2)</a>
      <li><a href="#ref-for-event-handlers②">3.2.10. Event handler</a> <a href="#ref-for-event-handlers③">(2)</a>
      <li><a href="#ref-for-event-handlers④">3.4.7. Event handlers</a> <a href="#ref-for-event-handlers⑤">(2)</a>
      <li><a href="#ref-for-event-handlers⑥">4.1.5. Event handlers</a> <a href="#ref-for-event-handlers⑦">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-event-handler-event-type">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type">https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-event-handler-event-type">3.1.6. Event handler</a> <a
          href="#ref-for-event-handler-event-type①">(2)</a>
      <li><a href="#ref-for-event-handler-event-type②">3.2.10. Event handler</a> <a
          href="#ref-for-event-handler-event-type③">(2)</a>
      <li><a href="#ref-for-event-handler-event-type④">3.4.7. Event handlers</a> <a
          href="#ref-for-event-handler-event-type⑤">(2)</a>
      <li><a href="#ref-for-event-handler-event-type⑥">4.1.5. Event handlers</a> <a
          href="#ref-for-event-handler-event-type⑦">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-event-handler-idl-attributes">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes">https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-event-handler-idl-attributes">3.1.6. Event handler</a>
      <li><a href="#ref-for-event-handler-idl-attributes①">3.2.10. Event handler</a>
      <li><a href="#ref-for-event-handler-idl-attributes②">3.4.7. Event handlers</a>
      <li><a href="#ref-for-event-handler-idl-attributes③">4.1.5. Event handlers</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-agent-event-loop">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-agent-event-loop">https://html.spec.whatwg.org/multipage/webappapis.html#concept-agent-event-loop</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-agent-event-loop">4.2.10. focus()</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-execution-ready-flag">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-execution-ready-flag">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-execution-ready-flag</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-environment-execution-ready-flag">4.3.1. get(id)</a> <a
          href="#ref-for-concept-environment-execution-ready-flag①">(2)</a>
      <li><a href="#ref-for-concept-environment-execution-ready-flag②">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-concept-environment-execution-ready-flag③">4.3.4. claim()</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-fetch-a-classic-worker-script">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-classic-worker-script">https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-classic-worker-script</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-fetch-a-classic-worker-script">Update</a> <a
          href="#ref-for-fetch-a-classic-worker-script①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-fetch-a-classic-worker-imported-script">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-classic-worker-imported-script">https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-classic-worker-imported-script</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-fetch-a-classic-worker-imported-script">Appendix A: Algorithms</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-fetch-a-module-worker-script-tree">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-module-worker-script-tree">https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-module-worker-script-tree</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-fetch-a-module-worker-script-tree">Update</a> <a
          href="#ref-for-fetch-a-module-worker-script-tree①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-focusing-steps">
    <a
      href="https://html.spec.whatwg.org/multipage/interaction.html#focusing-steps">https://html.spec.whatwg.org/multipage/interaction.html#focusing-steps</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-focusing-steps">4.2.10. focus()</a>
      <li><a href="#ref-for-focusing-steps①">4.3.2. matchAll(options)</a> <a href="#ref-for-focusing-steps②">(2)</a> <a
          href="#ref-for-focusing-steps③">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-settings-object-global">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-settings-object-global">2.4. Service Worker Client</a> <a
          href="#ref-for-concept-settings-object-global①">(2)</a> <a
          href="#ref-for-concept-settings-object-global②">(3)</a>
      <li><a href="#ref-for-concept-settings-object-global③">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-concept-settings-object-global④">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-concept-settings-object-global⑤">4.2. Client</a>
      <li><a href="#ref-for-concept-settings-object-global⑥">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-concept-settings-object-global⑦">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-concept-settings-object-global⑧">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-concept-settings-object-global⑨">Activate</a> <a
          href="#ref-for-concept-settings-object-global①⓪">(2)</a>
      <li><a href="#ref-for-concept-settings-object-global①①">Run Service Worker</a>
      <li><a href="#ref-for-concept-settings-object-global①②">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-has-focus-steps">
    <a
      href="https://html.spec.whatwg.org/multipage/interaction.html#has-focus-steps">https://html.spec.whatwg.org/multipage/interaction.html#has-focus-steps</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-has-focus-steps">4.2.10. focus()</a>
      <li><a href="#ref-for-has-focus-steps①">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-has-focus-steps②">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-has-focus-steps③">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-has-focus-steps④">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-id">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-id">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-id</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-environment-id">4.2.3. id</a>
      <li><a href="#ref-for-concept-environment-id①">4.3.1. get(id)</a>
      <li><a href="#ref-for-concept-environment-id②">Run Service Worker</a>
      <li><a href="#ref-for-concept-environment-id③">Handle Fetch</a> <a href="#ref-for-concept-environment-id④">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-the-iframe-element">
    <a
      href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-the-iframe-element">2.5.1. The window client case</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-import-scripts-into-worker-global-scope">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#import-scripts-into-worker-global-scope">https://html.spec.whatwg.org/multipage/workers.html#import-scripts-into-worker-global-scope</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-import-scripts-into-worker-global-scope">6.3.2. importScripts(urls)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-in-parallel">
    <a
      href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-in-parallel">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-in-parallel①">3.4.2. ready</a>
      <li><a href="#ref-for-in-parallel②">3.4.4. getRegistration(clientURL)</a>
      <li><a href="#ref-for-in-parallel③">3.4.5. getRegistrations()</a>
      <li><a href="#ref-for-in-parallel④">3.6.1. enable()</a>
      <li><a href="#ref-for-in-parallel⑤">3.6.2. disable()</a>
      <li><a href="#ref-for-in-parallel⑥">3.6.3. setHeaderValue(value)</a>
      <li><a href="#ref-for-in-parallel⑦">3.6.4. getState()</a>
      <li><a href="#ref-for-in-parallel⑧">4.1.4. skipWaiting()</a>
      <li><a href="#ref-for-in-parallel⑨">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-in-parallel①⓪">4.3.1. get(id)</a>
      <li><a href="#ref-for-in-parallel①①">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-in-parallel①②">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-in-parallel①③">4.3.4. claim()</a>
      <li><a href="#ref-for-in-parallel①④">4.5.7. event.respondWith(r)</a>
      <li><a href="#ref-for-in-parallel①⑤">5.4.1. match(request, options)</a>
      <li><a href="#ref-for-in-parallel①⑥">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-in-parallel①⑦">5.4.4. addAll(requests)</a> <a href="#ref-for-in-parallel①⑧">(2)</a>
      <li><a href="#ref-for-in-parallel①⑨">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-in-parallel②⓪">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-in-parallel②①">5.4.7. keys(request, options)</a>
      <li><a href="#ref-for-in-parallel②②">5.5.1. match(request, options)</a>
      <li><a href="#ref-for-in-parallel②③">5.5.2. has(cacheName)</a>
      <li><a href="#ref-for-in-parallel②④">5.5.3. open(cacheName)</a>
      <li><a href="#ref-for-in-parallel②⑤">5.5.4. delete(cacheName)</a>
      <li><a href="#ref-for-in-parallel②⑥">5.5.5. keys()</a>
      <li><a href="#ref-for-in-parallel②⑦">Run Job</a> <a href="#ref-for-in-parallel②⑧">(2)</a> <a
          href="#ref-for-in-parallel②⑨">(3)</a>
      <li><a href="#ref-for-in-parallel③⓪">Install</a>
      <li><a href="#ref-for-in-parallel③①">Activate</a>
      <li><a href="#ref-for-in-parallel③②">Terminate Service Worker</a>
      <li><a href="#ref-for-in-parallel③③">Handle Fetch</a> <a href="#ref-for-in-parallel③④">(2)</a> <a
          href="#ref-for-in-parallel③⑤">(3)</a>
      <li><a href="#ref-for-in-parallel③⑥">Fire Functional Event</a> <a href="#ref-for-in-parallel③⑦">(2)</a> <a
          href="#ref-for-in-parallel③⑧">(3)</a>
      <li><a href="#ref-for-in-parallel③⑨">Handle User Agent Shutdown</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-fetching-scripts-is-top-level">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#fetching-scripts-is-top-level">https://html.spec.whatwg.org/multipage/webappapis.html#fetching-scripts-is-top-level</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-fetching-scripts-is-top-level">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-event-message">
    <a
      href="https://html.spec.whatwg.org/multipage/indices.html#event-message">https://html.spec.whatwg.org/multipage/indices.html#event-message</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-event-message">4.2.6. postMessage(message, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-settings-object-module-map">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-module-map">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-module-map</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-settings-object-module-map">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-module-script">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#module-script">https://html.spec.whatwg.org/multipage/webappapis.html#module-script</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-module-script">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigate">
    <a
      href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-navigate">2.5.1. The window client case</a> <a href="#ref-for-navigate①">(2)</a> <a
          href="#ref-for-navigate②">(3)</a>
      <li><a href="#ref-for-navigate③">3.2.9. unregister()</a>
      <li><a href="#ref-for-navigate④">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-navigate⑤">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-navigate⑥">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-nested-browsing-context">
    <a
      href="https://html.spec.whatwg.org/multipage/browsers.html#nested-browsing-context">https://html.spec.whatwg.org/multipage/browsers.html#nested-browsing-context</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-nested-browsing-context">Get Frame Type</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-obtain-a-service-worker-agent">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#obtain-a-service-worker-agent">https://html.spec.whatwg.org/multipage/webappapis.html#obtain-a-service-worker-agent</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-obtain-a-service-worker-agent">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-origin-opaque">
    <a
      href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque">https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-origin-opaque">2.5.1. The window client case</a> <a
          href="#ref-for-concept-origin-opaque①">(2)</a> <a href="#ref-for-concept-origin-opaque②">(3)</a>
      <li><a href="#ref-for-concept-origin-opaque③">2.5.2. The worker client case</a>
      <li><a href="#ref-for-concept-origin-opaque④">2.5. Control and Use</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-settings-object-origin">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-settings-object-origin">2.4. Service Worker Client</a>
      <li><a href="#ref-for-concept-settings-object-origin①">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-concept-settings-object-origin②">3.4.4. getRegistration(clientURL)</a> <a
          href="#ref-for-concept-settings-object-origin③">(2)</a>
      <li><a href="#ref-for-concept-settings-object-origin④">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-concept-settings-object-origin⑤">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-concept-settings-object-origin⑥">4.6.2. event.origin</a>
      <li><a href="#ref-for-concept-settings-object-origin⑦">5. Caches</a>
      <li><a href="#ref-for-concept-settings-object-origin⑧">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-concept-settings-object-origin⑨">5.5. CacheStorage</a>
      <li><a href="#ref-for-concept-settings-object-origin①⓪">6.3.1. Origin restriction</a>
      <li><a href="#ref-for-concept-settings-object-origin①①">6.4. Cross-Origin Resources and CORS</a> <a
          href="#ref-for-concept-settings-object-origin①②">(2)</a>
      <li><a href="#ref-for-concept-settings-object-origin①③">Register</a>
      <li><a href="#ref-for-concept-settings-object-origin①④">Install</a>
      <li><a href="#ref-for-concept-settings-object-origin①⑤">Run Service Worker</a> <a
          href="#ref-for-concept-settings-object-origin①⑥">(2)</a>
      <li><a href="#ref-for-concept-settings-object-origin①⑦">Unregister</a> <a
          href="#ref-for-concept-settings-object-origin①⑧">(2)</a>
      <li><a href="#ref-for-concept-settings-object-origin①⑨">Update Worker State</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-WorkerGlobalScope-owner-set">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#concept-WorkerGlobalScope-owner-set">https://html.spec.whatwg.org/multipage/workers.html#concept-WorkerGlobalScope-owner-set</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-WorkerGlobalScope-owner-set">2.5.2. The worker client case</a> <a
          href="#ref-for-concept-WorkerGlobalScope-owner-set①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-fetching-scripts-perform-fetch">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#fetching-scripts-perform-fetch">https://html.spec.whatwg.org/multipage/webappapis.html#fetching-scripts-perform-fetch</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-fetching-scripts-perform-fetch">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-fetching-scripts-perform-fetch①">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-settings-object-policy-container">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-policy-container">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-policy-container</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-settings-object-policy-container">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-messageevent-ports">
    <a
      href="https://html.spec.whatwg.org/multipage/comms.html#dom-messageevent-ports">https://html.spec.whatwg.org/multipage/comms.html#dom-messageevent-ports</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-messageevent-ports">4.2.6. postMessage(message, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-queue-a-microtask">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-microtask">https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-microtask</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-queue-a-microtask">4.4. ExtendableEvent</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-queue-a-task">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-queue-a-task">2.3. Service Worker Registration</a>
      <li><a href="#ref-for-queue-a-task①">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-queue-a-task②">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-queue-a-task③">3.4.2. ready</a>
      <li><a href="#ref-for-queue-a-task④">3.4.5. getRegistrations()</a>
      <li><a href="#ref-for-queue-a-task⑤">4.2.10. focus()</a> <a href="#ref-for-queue-a-task⑥">(2)</a>
      <li><a href="#ref-for-queue-a-task⑦">4.2.11. navigate(url)</a> <a href="#ref-for-queue-a-task⑧">(2)</a> <a
          href="#ref-for-queue-a-task⑨">(3)</a> <a href="#ref-for-queue-a-task①⓪">(4)</a>
      <li><a href="#ref-for-queue-a-task①①">4.3.2. matchAll(options)</a> <a href="#ref-for-queue-a-task①②">(2)</a>
      <li><a href="#ref-for-queue-a-task①③">4.3.3. openWindow(url)</a> <a href="#ref-for-queue-a-task①④">(2)</a> <a
          href="#ref-for-queue-a-task①⑤">(3)</a>
      <li><a href="#ref-for-queue-a-task①⑥">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-queue-a-task①⑦">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-queue-a-task①⑧">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-queue-a-task①⑨">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-queue-a-task②⓪">5.4.7. keys(request, options)</a>
      <li><a href="#ref-for-queue-a-task②①">Run Job</a>
      <li><a href="#ref-for-queue-a-task②②">Resolve Job Promise</a> <a href="#ref-for-queue-a-task②③">(2)</a>
      <li><a href="#ref-for-queue-a-task②④">Reject Job Promise</a> <a href="#ref-for-queue-a-task②⑤">(2)</a>
      <li><a href="#ref-for-queue-a-task②⑥">Install</a> <a href="#ref-for-queue-a-task②⑦">(2)</a> <a
          href="#ref-for-queue-a-task②⑧">(3)</a>
      <li><a href="#ref-for-queue-a-task②⑨">Activate</a> <a href="#ref-for-queue-a-task③⓪">(2)</a>
      <li><a href="#ref-for-queue-a-task③①">Run Service Worker</a>
      <li><a href="#ref-for-queue-a-task③②">Terminate Service Worker</a>
      <li><a href="#ref-for-queue-a-task③③">Handle Fetch</a> <a href="#ref-for-queue-a-task③④">(2)</a>
      <li><a href="#ref-for-queue-a-task③⑤">Fire Functional Event</a>
      <li><a href="#ref-for-queue-a-task③⑥">Update Registration State</a> <a href="#ref-for-queue-a-task③⑦">(2)</a> <a
          href="#ref-for-queue-a-task③⑧">(3)</a>
      <li><a href="#ref-for-queue-a-task③⑨">Update Worker State</a>
      <li><a href="#ref-for-queue-a-task④⓪">Notify Controller Change</a>
      <li><a href="#ref-for-queue-a-task④①">Resolve Get Client Promise</a> <a href="#ref-for-queue-a-task④②">(2)</a> <a
          href="#ref-for-queue-a-task④③">(3)</a> <a href="#ref-for-queue-a-task④④">(4)</a> <a
          href="#ref-for-queue-a-task④⑤">(5)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-global-object-realm">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm">https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-global-object-realm">3.1.5. postMessage(message, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-realm-execution-context">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#realm-execution-context">https://html.spec.whatwg.org/multipage/webappapis.html#realm-execution-context</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-realm-execution-context">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-script-record">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-script-record">https://html.spec.whatwg.org/multipage/webappapis.html#concept-script-record</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-script-record">Update</a>
      <li><a href="#ref-for-concept-script-record①">Is Async Module</a> <a
          href="#ref-for-concept-script-record②">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-relevant-global">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-relevant-global">3.2.8. update()</a>
      <li><a href="#ref-for-concept-relevant-global①">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-concept-relevant-global②">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-concept-relevant-global③">4.2.10. focus()</a>
      <li><a href="#ref-for-concept-relevant-global④">4.2.11. navigate(url)</a> <a
          href="#ref-for-concept-relevant-global⑤">(2)</a>
      <li><a href="#ref-for-concept-relevant-global⑥">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-concept-relevant-global⑦">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-concept-relevant-global⑧">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-relevant-realm">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm">https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-relevant-realm">3.4.5. getRegistrations()</a>
      <li><a href="#ref-for-concept-relevant-realm①">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-concept-relevant-realm②">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-concept-relevant-realm③">4.5.7. event.respondWith(r)</a>
      <li><a href="#ref-for-concept-relevant-realm④">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-concept-relevant-realm⑤">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-concept-relevant-realm⑥">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-concept-relevant-realm⑦">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-concept-relevant-realm⑧">5.4.7. keys(request, options)</a>
      <li><a href="#ref-for-concept-relevant-realm⑨">Handle Fetch</a>
      <li><a href="#ref-for-concept-relevant-realm①⓪">Fire Functional Event</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-relevant-settings-object">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-relevant-settings-object">3.1.5. postMessage(message, options)</a> <a
          href="#ref-for-relevant-settings-object①">(2)</a>
      <li><a href="#ref-for-relevant-settings-object②">3.2.8. update()</a>
      <li><a href="#ref-for-relevant-settings-object③">3.2.9. unregister()</a>
      <li><a href="#ref-for-relevant-settings-object④">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-relevant-settings-object⑤">3.4.1. controller</a>
      <li><a href="#ref-for-relevant-settings-object⑥">3.4.2. ready</a> <a
          href="#ref-for-relevant-settings-object⑦">(2)</a>
      <li><a href="#ref-for-relevant-settings-object⑧">3.4.3. register(scriptURL, options)</a> <a
          href="#ref-for-relevant-settings-object⑨">(2)</a>
      <li><a href="#ref-for-relevant-settings-object①⓪">3.4.4. getRegistration(clientURL)</a> <a
          href="#ref-for-relevant-settings-object①①">(2)</a>
      <li><a href="#ref-for-relevant-settings-object①②">3.4.5. getRegistrations()</a> <a
          href="#ref-for-relevant-settings-object①③">(2)</a>
      <li><a href="#ref-for-relevant-settings-object①④">4.1.2. registration</a>
      <li><a href="#ref-for-relevant-settings-object①⑤">4.1.3. serviceWorker</a>
      <li><a href="#ref-for-relevant-settings-object①⑥">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-relevant-settings-object①⑦">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-relevant-settings-object①⑧">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-relevant-settings-object①⑨">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-relevant-settings-object②⓪">5.4.2. matchAll(request, options)</a> <a
          href="#ref-for-relevant-settings-object②①">(2)</a> <a href="#ref-for-relevant-settings-object②②">(3)</a>
      <li><a href="#ref-for-relevant-settings-object②③">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-relevant-settings-object②④">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-relevant-settings-object②⑤">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-relevant-settings-object②⑥">5.4.7. keys(request, options)</a>
      <li><a href="#ref-for-relevant-settings-object②⑦">Activate</a>
      <li><a href="#ref-for-relevant-settings-object②⑧">Update Registration State</a> <a
          href="#ref-for-relevant-settings-object②⑨">(2)</a> <a href="#ref-for-relevant-settings-object③⓪">(3)</a> <a
          href="#ref-for-relevant-settings-object③①">(4)</a>
      <li><a href="#ref-for-relevant-settings-object③②">Resolve Get Client Promise</a> <a
          href="#ref-for-relevant-settings-object③③">(2)</a> <a href="#ref-for-relevant-settings-object③④">(3)</a> <a
          href="#ref-for-relevant-settings-object③⑤">(4)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-resolve-a-module-specifier">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#resolve-a-module-specifier">https://html.spec.whatwg.org/multipage/webappapis.html#resolve-a-module-specifier</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-resolve-a-module-specifier">Is Async Module</a> <a
          href="#ref-for-resolve-a-module-specifier①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-responsible-event-loop">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop">https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-responsible-event-loop">3.4.2. ready</a>
      <li><a href="#ref-for-responsible-event-loop①">3.4.5. getRegistrations()</a>
      <li><a href="#ref-for-responsible-event-loop②">4.2.10. focus()</a>
      <li><a href="#ref-for-responsible-event-loop③">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-responsible-event-loop④">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-responsible-event-loop⑤">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-responsible-event-loop⑥">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-responsible-event-loop⑦">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-responsible-event-loop⑧">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-responsible-event-loop⑨">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-responsible-event-loop①⓪">5.4.7. keys(request, options)</a>
      <li><a href="#ref-for-responsible-event-loop①①">Resolve Job Promise</a> <a
          href="#ref-for-responsible-event-loop①②">(2)</a>
      <li><a href="#ref-for-responsible-event-loop①③">Reject Job Promise</a> <a
          href="#ref-for-responsible-event-loop①④">(2)</a>
      <li><a href="#ref-for-responsible-event-loop①⑤">Install</a>
      <li><a href="#ref-for-responsible-event-loop①⑥">Activate</a>
      <li><a href="#ref-for-responsible-event-loop①⑦">Run Service Worker</a>
      <li><a href="#ref-for-responsible-event-loop①⑧">Update Registration State</a>
      <li><a href="#ref-for-responsible-event-loop①⑨">Update Worker State</a>
      <li><a href="#ref-for-responsible-event-loop②⓪">Notify Controller Change</a>
      <li><a href="#ref-for-responsible-event-loop②①">Resolve Get Client Promise</a> <a
          href="#ref-for-responsible-event-loop②②">(2)</a> <a href="#ref-for-responsible-event-loop②③">(3)</a> <a
          href="#ref-for-responsible-event-loop②④">(4)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-run-a-classic-script">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#run-a-classic-script">https://html.spec.whatwg.org/multipage/webappapis.html#run-a-classic-script</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-run-a-classic-script">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-run-a-module-script">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#run-a-module-script">https://html.spec.whatwg.org/multipage/webappapis.html#run-a-module-script</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-run-a-module-script">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-run-a-worker">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#run-a-worker">https://html.spec.whatwg.org/multipage/workers.html#run-a-worker</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-run-a-worker">2.5.2. The worker client case</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-same-origin">
    <a
      href="https://html.spec.whatwg.org/multipage/origin.html#same-origin">https://html.spec.whatwg.org/multipage/origin.html#same-origin</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-same-origin">2.5.1. The window client case</a>
      <li><a href="#ref-for-same-origin①">2.5.2. The worker client case</a>
      <li><a href="#ref-for-same-origin②">2.5. Control and Use</a>
      <li><a href="#ref-for-same-origin③">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-same-origin④">Register</a> <a href="#ref-for-same-origin⑤">(2)</a>
      <li><a href="#ref-for-same-origin⑥">Match Service Worker Registration</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-attr-iframe-sandbox">
    <a
      href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-sandbox">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-sandbox</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-attr-iframe-sandbox">2.5.1. The window client case</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-script">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-script">https://html.spec.whatwg.org/multipage/webappapis.html#concept-script</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-script">2.1. Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-secure-context">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context">https://html.spec.whatwg.org/multipage/webappapis.html#secure-context</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-secure-context">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-secure-context①">4.3.4. claim()</a>
      <li><a href="#ref-for-secure-context②">6.1. Secure Context</a> <a href="#ref-for-secure-context③">(2)</a>
      <li><a href="#ref-for-secure-context④">Handle Fetch</a>
      <li><a href="#ref-for-secure-context⑤">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ascii-serialisation-of-an-origin">
    <a
      href="https://html.spec.whatwg.org/multipage/origin.html#ascii-serialisation-of-an-origin">https://html.spec.whatwg.org/multipage/origin.html#ascii-serialisation-of-an-origin</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-ascii-serialisation-of-an-origin">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-ascii-serialisation-of-an-origin①">4.2.6. postMessage(message, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-shared-workers">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#shared-workers">https://html.spec.whatwg.org/multipage/workers.html#shared-workers</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-shared-workers">1. Motivations</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-messageevent-source">
    <a
      href="https://html.spec.whatwg.org/multipage/comms.html#dom-messageevent-source">https://html.spec.whatwg.org/multipage/comms.html#dom-messageevent-source</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-messageevent-source">4.2.6. postMessage(message, options)</a> <a
          href="#ref-for-dom-messageevent-source①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-source-browsing-context">
    <a
      href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#source-browsing-context">https://html.spec.whatwg.org/multipage/browsing-the-web.html#source-browsing-context</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-source-browsing-context">4.2.11. navigate(url)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-target-browsing-context">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-environment-target-browsing-context">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-concept-environment-target-browsing-context①">Run Service Worker</a>
      <li><a href="#ref-for-concept-environment-target-browsing-context②">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-task">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task">https://html.spec.whatwg.org/multipage/webappapis.html#concept-task</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-task">2.3. Service Worker Registration</a> <a href="#ref-for-concept-task①">(2)</a>
      <li><a href="#ref-for-concept-task②">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-concept-task③">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-concept-task④">Install</a>
      <li><a href="#ref-for-concept-task⑤">Run Service Worker</a>
      <li><a href="#ref-for-concept-task⑥">Terminate Service Worker</a> <a href="#ref-for-concept-task⑦">(2)</a> <a
          href="#ref-for-concept-task⑧">(3)</a>
      <li><a href="#ref-for-concept-task⑨">Update Registration State</a>
      <li><a href="#ref-for-concept-task①⓪">Notify Controller Change</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-task-queue">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#task-queue">https://html.spec.whatwg.org/multipage/webappapis.html#task-queue</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-task-queue">2.3. Service Worker Registration</a> <a href="#ref-for-task-queue①">(2)</a> <a
          href="#ref-for-task-queue②">(3)</a>
      <li><a href="#ref-for-task-queue③">Run Service Worker</a>
      <li><a href="#ref-for-task-queue④">Terminate Service Worker</a> <a href="#ref-for-task-queue⑤">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-task-source">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#task-source">https://html.spec.whatwg.org/multipage/webappapis.html#task-source</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-task-source">2.6. Task Sources</a> <a href="#ref-for-task-source①">(2)</a> <a
          href="#ref-for-task-source②">(3)</a>
      <li><a href="#ref-for-task-source③">3.4. ServiceWorkerContainer</a> <a href="#ref-for-task-source④">(2)</a>
      <li><a href="#ref-for-task-source⑤">Run Service Worker</a>
      <li><a href="#ref-for-task-source⑥">Terminate Service Worker</a> <a href="#ref-for-task-source⑦">(2)</a> <a
          href="#ref-for-task-source⑧">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-settings-object-time-origin">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-settings-object-time-origin">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-top-level-browsing-context">
    <a
      href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-top-level-browsing-context">4.3.3. openWindow(url)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-top-level-creation-url">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-creation-url">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-creation-url</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-environment-top-level-creation-url">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-top-level-origin">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-environment-top-level-origin">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-structuredserializeoptions-transfer">
    <a
      href="https://html.spec.whatwg.org/multipage/web-messaging.html#dom-structuredserializeoptions-transfer">https://html.spec.whatwg.org/multipage/web-messaging.html#dom-structuredserializeoptions-transfer</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-structuredserializeoptions-transfer">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-dom-structuredserializeoptions-transfer①">4.2.6. postMessage(message, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-workerglobalscope-type">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-type">https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-type</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-workerglobalscope-type">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-unload-a-document">
    <a
      href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#unload-a-document">https://html.spec.whatwg.org/multipage/browsing-the-web.html#unload-a-document</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-unload-a-document">Handle Service Worker Client Unload</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-unsafe-response">
    <a
      href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#unsafe-response">https://html.spec.whatwg.org/multipage/urls-and-fetching.html#unsafe-response</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-unsafe-response">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-unsafe-response①">Update</a> <a href="#ref-for-unsafe-response②">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-workerglobalscope-url">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-url">https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-url</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-workerglobalscope-url">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-user-interaction-task-source">
    <a
      href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source">https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-user-interaction-task-source">4.2.10. focus()</a>
      <li><a href="#ref-for-user-interaction-task-source①">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-user-interaction-task-source②">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-user-interaction-task-source③">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-user-interaction-task-source④">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-workers">
    <a
      href="https://html.spec.whatwg.org/multipage/workers.html#workers">https://html.spec.whatwg.org/multipage/workers.html#workers</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-workers">2.1. Service Worker</a>
      <li><a href="#ref-for-workers①">Update</a> <a href="#ref-for-workers②">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-abort-when">
    <a href="https://infra.spec.whatwg.org/#abort-when">https://infra.spec.whatwg.org/#abort-when</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-abort-when">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-set-append">
    <a href="https://infra.spec.whatwg.org/#set-append">https://infra.spec.whatwg.org/#set-append</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-set-append">6.3.2. importScripts(urls)</a> <a href="#ref-for-set-append①">(2)</a>
      <li><a href="#ref-for-set-append②">Run Service Worker</a>
      <li><a href="#ref-for-set-append③">Update Service Worker Extended Events Set</a>
      <li><a href="#ref-for-set-append④">Is Async Module</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ascii-case-insensitive">
    <a
      href="https://infra.spec.whatwg.org/#ascii-case-insensitive">https://infra.spec.whatwg.org/#ascii-case-insensitive</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-ascii-case-insensitive">Start Register</a> <a
          href="#ref-for-ascii-case-insensitive①">(2)</a> <a href="#ref-for-ascii-case-insensitive②">(3)</a> <a
          href="#ref-for-ascii-case-insensitive③">(4)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-iteration-break">
    <a href="https://infra.spec.whatwg.org/#iteration-break">https://infra.spec.whatwg.org/#iteration-break</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-iteration-break">4.2.6. postMessage(message, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-byte-sequence">
    <a href="https://infra.spec.whatwg.org/#byte-sequence">https://infra.spec.whatwg.org/#byte-sequence</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-byte-sequence">2.3. Service Worker Registration</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-contain">
    <a href="https://infra.spec.whatwg.org/#list-contain">https://infra.spec.whatwg.org/#list-contain</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-list-contain">Install</a>
      <li><a href="#ref-for-list-contain①">Handle Fetch</a>
      <li><a href="#ref-for-list-contain②">Should Skip Event</a>
      <li><a href="#ref-for-list-contain③">Is Async Module</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-iteration-continue">
    <a href="https://infra.spec.whatwg.org/#iteration-continue">https://infra.spec.whatwg.org/#iteration-continue</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-iteration-continue">4.3.1. get(id)</a>
      <li><a href="#ref-for-iteration-continue①">4.3.2. matchAll(options)</a> <a
          href="#ref-for-iteration-continue②">(2)</a> <a href="#ref-for-iteration-continue③">(3)</a>
      <li><a href="#ref-for-iteration-continue④">4.3.4. claim()</a> <a href="#ref-for-iteration-continue⑤">(2)</a> <a
          href="#ref-for-iteration-continue⑥">(3)</a>
      <li><a href="#ref-for-iteration-continue⑦">Reject Job Promise</a>
      <li><a href="#ref-for-iteration-continue⑧">Activate</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-queue-dequeue">
    <a href="https://infra.spec.whatwg.org/#queue-dequeue">https://infra.spec.whatwg.org/#queue-dequeue</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-queue-dequeue">Finish Job</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-queue-enqueue">
    <a href="https://infra.spec.whatwg.org/#queue-enqueue">https://infra.spec.whatwg.org/#queue-enqueue</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-queue-enqueue">Schedule Job</a> <a href="#ref-for-queue-enqueue①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-entry">
    <a href="https://infra.spec.whatwg.org/#map-entry">https://infra.spec.whatwg.org/#map-entry</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-map-entry">5.1. Constructs</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-exists">
    <a href="https://infra.spec.whatwg.org/#map-exists">https://infra.spec.whatwg.org/#map-exists</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-map-exists">3.1.1. Getting ServiceWorker instances</a>
      <li><a href="#ref-for-map-exists①">3.2.1. Getting ServiceWorkerRegistration instances</a>
      <li><a href="#ref-for-map-exists②">3.4.3. register(scriptURL, options)</a>
      <li><a href="#ref-for-map-exists③">5.5.1. match(request, options)</a>
      <li><a href="#ref-for-map-exists④">6.3.2. importScripts(urls)</a> <a href="#ref-for-map-exists⑤">(2)</a>
      <li><a href="#ref-for-map-exists⑥">Schedule Job</a>
      <li><a href="#ref-for-map-exists⑦">Update Worker State</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-iterate">
    <a href="https://infra.spec.whatwg.org/#map-iterate">https://infra.spec.whatwg.org/#map-iterate</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-map-iterate">3.4.5. getRegistrations()</a>
      <li><a href="#ref-for-map-iterate①">5.5.1. match(request, options)</a> <a href="#ref-for-map-iterate②">(2)</a>
      <li><a href="#ref-for-map-iterate③">5.5.2. has(cacheName)</a>
      <li><a href="#ref-for-map-iterate④">5.5.3. open(cacheName)</a>
      <li><a href="#ref-for-map-iterate⑤">Update</a>
      <li><a href="#ref-for-map-iterate⑥">Install</a>
      <li><a href="#ref-for-map-iterate⑦">Handle User Agent Shutdown</a>
      <li><a href="#ref-for-map-iterate⑧">Match Service Worker Registration</a>
      <li><a href="#ref-for-map-iterate⑨">Get Registration</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-getting-the-keys">
    <a
      href="https://infra.spec.whatwg.org/#map-getting-the-keys">https://infra.spec.whatwg.org/#map-getting-the-keys</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-map-getting-the-keys">3.1.1. Getting ServiceWorker instances</a>
      <li><a href="#ref-for-map-getting-the-keys①">3.2.1. Getting ServiceWorkerRegistration instances</a>
      <li><a href="#ref-for-map-getting-the-keys②">5.5.5. keys()</a>
      <li><a href="#ref-for-map-getting-the-keys③">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-if-aborted">
    <a href="https://infra.spec.whatwg.org/#if-aborted">https://infra.spec.whatwg.org/#if-aborted</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-if-aborted">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-implementation-defined">
    <a
      href="https://infra.spec.whatwg.org/#implementation-defined">https://infra.spec.whatwg.org/#implementation-defined</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-implementation-defined">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-is-empty">
    <a href="https://infra.spec.whatwg.org/#list-is-empty">https://infra.spec.whatwg.org/#list-is-empty</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-list-is-empty">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-list-is-empty①">Run Job</a>
      <li><a href="#ref-for-list-is-empty②">Finish Job</a>
      <li><a href="#ref-for-list-is-empty③">Batch Cache Operations</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-struct-item">
    <a href="https://infra.spec.whatwg.org/#struct-item">https://infra.spec.whatwg.org/#struct-item</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-struct-item">2.2. Service Worker Timing</a>
      <li><a href="#ref-for-struct-item①">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-key">
    <a href="https://infra.spec.whatwg.org/#map-key">https://infra.spec.whatwg.org/#map-key</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-map-key">5.1. Constructs</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-getting-the-keys">
    <a
      href="https://infra.spec.whatwg.org/#map-getting-the-keys">https://infra.spec.whatwg.org/#map-getting-the-keys</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-map-getting-the-keys">3.1.1. Getting ServiceWorker instances</a>
      <li><a href="#ref-for-map-getting-the-keys①">3.2.1. Getting ServiceWorkerRegistration instances</a>
      <li><a href="#ref-for-map-getting-the-keys②">5.5.5. keys()</a>
      <li><a href="#ref-for-map-getting-the-keys③">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list">
    <a href="https://infra.spec.whatwg.org/#list">https://infra.spec.whatwg.org/#list</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-list">3.4.5. getRegistrations()</a> <a href="#ref-for-list①">(2)</a>
      <li><a href="#ref-for-list②">4.3.2. matchAll(options)</a> <a href="#ref-for-list③">(2)</a> <a
          href="#ref-for-list④">(3)</a> <a href="#ref-for-list⑤">(4)</a> <a href="#ref-for-list⑥">(5)</a>
      <li><a href="#ref-for-list⑦">5.1. Constructs</a>
      <li><a href="#ref-for-list⑧">5.4.2. matchAll(request, options)</a> <a href="#ref-for-list⑨">(2)</a>
      <li><a href="#ref-for-list①⓪">5.4.4. addAll(requests)</a> <a href="#ref-for-list①①">(2)</a> <a
          href="#ref-for-list①②">(3)</a> <a href="#ref-for-list①③">(4)</a>
      <li><a href="#ref-for-list①④">5.4.5. put(request, response)</a> <a href="#ref-for-list①⑤">(2)</a>
      <li><a href="#ref-for-list①⑥">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-list①⑦">5.4.7. keys(request, options)</a> <a href="#ref-for-list①⑧">(2)</a>
      <li><a href="#ref-for-list①⑨">Activate</a>
      <li><a href="#ref-for-list②⓪">Query Cache</a>
      <li><a href="#ref-for-list②①">Request Matches Cached Item</a>
      <li><a href="#ref-for-list②②">Batch Cache Operations</a> <a href="#ref-for-list②③">(2)</a> <a
          href="#ref-for-list②④">(3)</a> <a href="#ref-for-list②⑤">(4)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ordered-map">
    <a href="https://infra.spec.whatwg.org/#ordered-map">https://infra.spec.whatwg.org/#ordered-map</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-ordered-map">2.1. Service Worker</a>
      <li><a href="#ref-for-ordered-map①">3.1.1. Getting ServiceWorker instances</a>
      <li><a href="#ref-for-ordered-map②">3.2.1. Getting ServiceWorkerRegistration instances</a>
      <li><a href="#ref-for-ordered-map③">5.1. Constructs</a>
      <li><a href="#ref-for-ordered-map④">Appendix A: Algorithms</a> <a href="#ref-for-ordered-map⑤">(2)</a>
      <li><a href="#ref-for-ordered-map⑥">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ordered-map">
    <a href="https://infra.spec.whatwg.org/#ordered-map">https://infra.spec.whatwg.org/#ordered-map</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-ordered-map">2.1. Service Worker</a>
      <li><a href="#ref-for-ordered-map①">3.1.1. Getting ServiceWorker instances</a>
      <li><a href="#ref-for-ordered-map②">3.2.1. Getting ServiceWorkerRegistration instances</a>
      <li><a href="#ref-for-ordered-map③">5.1. Constructs</a>
      <li><a href="#ref-for-ordered-map④">Appendix A: Algorithms</a> <a href="#ref-for-ordered-map⑤">(2)</a>
      <li><a href="#ref-for-ordered-map⑥">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ordered-set">
    <a href="https://infra.spec.whatwg.org/#ordered-set">https://infra.spec.whatwg.org/#ordered-set</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-ordered-set">2.1. Service Worker</a> <a href="#ref-for-ordered-set①">(2)</a> <a
          href="#ref-for-ordered-set②">(3)</a> <a href="#ref-for-ordered-set③">(4)</a> <a
          href="#ref-for-ordered-set④">(5)</a> <a href="#ref-for-ordered-set⑤">(6)</a>
      <li><a href="#ref-for-ordered-set⑥">5.5.5. keys()</a>
      <li><a href="#ref-for-ordered-set⑦">Is Async Module</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-queue">
    <a href="https://infra.spec.whatwg.org/#queue">https://infra.spec.whatwg.org/#queue</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-queue">Appendix A: Algorithms</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-remove">
    <a href="https://infra.spec.whatwg.org/#map-remove">https://infra.spec.whatwg.org/#map-remove</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-map-remove">5.5.4. delete(cacheName)</a>
      <li><a href="#ref-for-map-remove①">Update</a> <a href="#ref-for-map-remove②">(2)</a>
      <li><a href="#ref-for-map-remove③">Install</a> <a href="#ref-for-map-remove④">(2)</a>
      <li><a href="#ref-for-map-remove⑤">Unregister</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-set">
    <a href="https://infra.spec.whatwg.org/#map-set">https://infra.spec.whatwg.org/#map-set</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-map-set">5.5.3. open(cacheName)</a>
      <li><a href="#ref-for-map-set①">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-map-set②">Schedule Job</a>
      <li><a href="#ref-for-map-set③">Set Registration</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-struct">
    <a href="https://infra.spec.whatwg.org/#struct">https://infra.spec.whatwg.org/#struct</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-struct">2.2. Service Worker Timing</a>
      <li><a href="#ref-for-struct①">5.4. Cache</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-value">
    <a href="https://infra.spec.whatwg.org/#map-value">https://infra.spec.whatwg.org/#map-value</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-map-value">5.1. Constructs</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-getting-the-values">
    <a
      href="https://infra.spec.whatwg.org/#map-getting-the-values">https://infra.spec.whatwg.org/#map-getting-the-values</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-map-getting-the-values">3.1.1. Getting ServiceWorker instances</a>
      <li><a href="#ref-for-map-getting-the-values①">3.2.1. Getting ServiceWorkerRegistration instances</a>
      <li><a href="#ref-for-map-getting-the-values②">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-javascript-mime-type">
    <a
      href="https://mimesniff.spec.whatwg.org/#javascript-mime-type">https://mimesniff.spec.whatwg.org/#javascript-mime-type</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-javascript-mime-type">6.6. Service worker script request</a>
      <li><a href="#ref-for-javascript-mime-type①">Appendix A: Algorithms</a>
      <li><a href="#ref-for-javascript-mime-type②">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-performancenavigationtiming">
    <a
      href="https://www.w3.org/TR/navigation-timing-2/#dom-performancenavigationtiming">https://www.w3.org/TR/navigation-timing-2/#dom-performancenavigationtiming</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-performancenavigationtiming">2.2. Service Worker Timing</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-VisibilityState">
    <a
      href="https://www.w3.org/TR/page-visibility/#VisibilityState">https://www.w3.org/TR/page-visibility/#VisibilityState</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-VisibilityState">4.2. Client</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-document-visibilitystate">
    <a
      href="https://www.w3.org/TR/page-visibility/#dom-document-visibilitystate">https://www.w3.org/TR/page-visibility/#dom-document-visibilitystate</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-document-visibilitystate">4.2. Client</a>
      <li><a href="#ref-for-dom-document-visibilitystate①">4.2.10. focus()</a>
      <li><a href="#ref-for-dom-document-visibilitystate②">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-dom-document-visibilitystate③">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-dom-document-visibilitystate④">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-dom-document-visibilitystate⑤">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-h-the-push-event">
    <a href="https://w3c.github.io/push-api/#h-the-push-event">https://w3c.github.io/push-api/#h-the-push-event</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-h-the-push-event">2.6. Task Sources</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-section-3.2">
    <a href="https://tools.ietf.org/html/rfc7230#section-3.2">https://tools.ietf.org/html/rfc7230#section-3.2</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-section-3.2">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-section-3.2①">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-section-3.2②">Request Matches Cached Item</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-section-7.1.4">
    <a href="https://tools.ietf.org/html/rfc7231#section-7.1.4">https://tools.ietf.org/html/rfc7231#section-7.1.4</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-section-7.1.4">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-section-7.1.4①">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-section-7.1.4②">Request Matches Cached Item</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-potentially-trustworthy-origin">
    <a
      href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin">https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-potentially-trustworthy-origin">Register</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-potentially-trustworthy-url">
    <a
      href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url">https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-potentially-trustworthy-url">Handle Fetch</a>
      <li><a href="#ref-for-potentially-trustworthy-url①">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-storage-key-equal">
    <a
      href="https://storage.spec.whatwg.org/#storage-key-equal">https://storage.spec.whatwg.org/#storage-key-equal</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-storage-key-equal">3.4.5. getRegistrations()</a>
      <li><a href="#ref-for-storage-key-equal①">4.3.1. get(id)</a>
      <li><a href="#ref-for-storage-key-equal②">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-storage-key-equal③">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-storage-key-equal④">4.3.4. claim()</a>
      <li><a href="#ref-for-storage-key-equal⑤">Match Service Worker Registration</a>
      <li><a href="#ref-for-storage-key-equal⑥">Get Registration</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-obtain-a-storage-key">
    <a
      href="https://storage.spec.whatwg.org/#obtain-a-storage-key">https://storage.spec.whatwg.org/#obtain-a-storage-key</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-obtain-a-storage-key">3.4.2. ready</a>
      <li><a href="#ref-for-obtain-a-storage-key①">3.4.4. getRegistration(clientURL)</a>
      <li><a href="#ref-for-obtain-a-storage-key②">3.4.5. getRegistrations()</a>
      <li><a href="#ref-for-obtain-a-storage-key③">4.3.1. get(id)</a>
      <li><a href="#ref-for-obtain-a-storage-key④">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-obtain-a-storage-key⑤">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-obtain-a-storage-key⑥">4.3.4. claim()</a> <a href="#ref-for-obtain-a-storage-key⑦">(2)</a>
      <li><a href="#ref-for-obtain-a-storage-key⑧">5.1. Constructs</a>
      <li><a href="#ref-for-obtain-a-storage-key⑨">Start Register</a>
      <li><a href="#ref-for-obtain-a-storage-key①⓪">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-storage-key">
    <a href="https://storage.spec.whatwg.org/#storage-key">https://storage.spec.whatwg.org/#storage-key</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-storage-key">2.3. Service Worker Registration</a> <a href="#ref-for-storage-key①">(2)</a>
      <li><a href="#ref-for-storage-key②">5.1. Constructs</a> <a href="#ref-for-storage-key③">(2)</a>
      <li><a href="#ref-for-storage-key④">Appendix A: Algorithms</a> <a href="#ref-for-storage-key⑤">(2)</a>
      <li><a href="#ref-for-storage-key⑥">Create Job</a>
      <li><a href="#ref-for-storage-key⑦">Set Registration</a>
      <li><a href="#ref-for-storage-key⑧">Match Service Worker Registration</a>
      <li><a href="#ref-for-storage-key⑨">Get Registration</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-readablestream">
    <a href="https://streams.spec.whatwg.org/#readablestream">https://streams.spec.whatwg.org/#readablestream</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-readablestream">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-readablestreamdefaultreader-cancel">
    <a
      href="https://streams.spec.whatwg.org/#readablestreamdefaultreader-cancel">https://streams.spec.whatwg.org/#readablestreamdefaultreader-cancel</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-readablestreamdefaultreader-cancel">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-chunk">
    <a href="https://streams.spec.whatwg.org/#chunk">https://streams.spec.whatwg.org/#chunk</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-chunk">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-read-request-chunk-steps">
    <a
      href="https://streams.spec.whatwg.org/#read-request-chunk-steps">https://streams.spec.whatwg.org/#read-request-chunk-steps</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-read-request-chunk-steps">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-readablestream-close">
    <a
      href="https://streams.spec.whatwg.org/#readablestream-close">https://streams.spec.whatwg.org/#readablestream-close</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-readablestream-close">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-read-request-close-steps">
    <a
      href="https://streams.spec.whatwg.org/#read-request-close-steps">https://streams.spec.whatwg.org/#read-request-close-steps</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-read-request-close-steps">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-readablestream-enqueue">
    <a
      href="https://streams.spec.whatwg.org/#readablestream-enqueue">https://streams.spec.whatwg.org/#readablestream-enqueue</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-readablestream-enqueue">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-readablestream-error">
    <a
      href="https://streams.spec.whatwg.org/#readablestream-error">https://streams.spec.whatwg.org/#readablestream-error</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-readablestream-error">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-read-request-error-steps">
    <a
      href="https://streams.spec.whatwg.org/#read-request-error-steps">https://streams.spec.whatwg.org/#read-request-error-steps</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-read-request-error-steps">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-readablestream-errored">
    <a
      href="https://streams.spec.whatwg.org/#readablestream-errored">https://streams.spec.whatwg.org/#readablestream-errored</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-readablestream-errored">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-readablestream-get-a-reader">
    <a
      href="https://streams.spec.whatwg.org/#readablestream-get-a-reader">https://streams.spec.whatwg.org/#readablestream-get-a-reader</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-readablestream-get-a-reader">4.5.7. event.respondWith(r)</a>
      <li><a href="#ref-for-readablestream-get-a-reader①">5.4.5. put(request, response)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-readablestreamdefaultreader-read-a-chunk">
    <a
      href="https://streams.spec.whatwg.org/#readablestreamdefaultreader-read-a-chunk">https://streams.spec.whatwg.org/#readablestreamdefaultreader-read-a-chunk</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-readablestreamdefaultreader-read-a-chunk">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-read-request">
    <a href="https://streams.spec.whatwg.org/#read-request">https://streams.spec.whatwg.org/#read-request</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-read-request">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-readablestreamdefaultreader-read-all-bytes">
    <a
      href="https://streams.spec.whatwg.org/#readablestreamdefaultreader-read-all-bytes">https://streams.spec.whatwg.org/#readablestreamdefaultreader-read-all-bytes</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-readablestreamdefaultreader-read-all-bytes">5.4.5. put(request, response)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-equals">
    <a href="https://url.spec.whatwg.org/#concept-url-equals">https://url.spec.whatwg.org/#concept-url-equals</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-url-equals">Register</a>
      <li><a href="#ref-for-concept-url-equals①">Update</a>
      <li><a href="#ref-for-concept-url-equals②">Request Matches Cached Item</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-fragment">
    <a href="https://url.spec.whatwg.org/#concept-url-fragment">https://url.spec.whatwg.org/#concept-url-fragment</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-url-fragment">3.4.4. getRegistration(clientURL)</a>
      <li><a href="#ref-for-concept-url-fragment①">Start Register</a> <a href="#ref-for-concept-url-fragment②">(2)</a>
        <a href="#ref-for-concept-url-fragment③">(3)</a> <a href="#ref-for-concept-url-fragment④">(4)</a> <a
          href="#ref-for-concept-url-fragment⑤">(5)</a> <a href="#ref-for-concept-url-fragment⑥">(6)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-origin">
    <a href="https://url.spec.whatwg.org/#concept-url-origin">https://url.spec.whatwg.org/#concept-url-origin</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-url-origin">2.4. Service Worker Client</a>
      <li><a href="#ref-for-concept-url-origin①">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-concept-url-origin②">Register</a> <a href="#ref-for-concept-url-origin③">(2)</a> <a
          href="#ref-for-concept-url-origin④">(3)</a> <a href="#ref-for-concept-url-origin⑤">(4)</a>
      <li><a href="#ref-for-concept-url-origin⑥">Update</a> <a href="#ref-for-concept-url-origin⑦">(2)</a>
      <li><a href="#ref-for-concept-url-origin⑧">Install</a>
      <li><a href="#ref-for-concept-url-origin⑨">Update Worker State</a>
      <li><a href="#ref-for-concept-url-origin①⓪">Match Service Worker Registration</a> <a
          href="#ref-for-concept-url-origin①①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-path">
    <a href="https://url.spec.whatwg.org/#concept-url-path">https://url.spec.whatwg.org/#concept-url-path</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-url-path">6.5. Path restriction</a>
      <li><a href="#ref-for-concept-url-path①">Start Register</a> <a href="#ref-for-concept-url-path②">(2)</a>
      <li><a href="#ref-for-concept-url-path③">Update</a> <a href="#ref-for-concept-url-path④">(2)</a> <a
          href="#ref-for-concept-url-path⑤">(3)</a> <a href="#ref-for-concept-url-path⑥">(4)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-query">
    <a href="https://url.spec.whatwg.org/#concept-url-query">https://url.spec.whatwg.org/#concept-url-query</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-url-query">Request Matches Cached Item</a> <a
          href="#ref-for-concept-url-query①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-scheme">
    <a href="https://url.spec.whatwg.org/#concept-url-scheme">https://url.spec.whatwg.org/#concept-url-scheme</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-url-scheme">5.4.4. addAll(requests)</a> <a
          href="#ref-for-concept-url-scheme①">(2)</a>
      <li><a href="#ref-for-concept-url-scheme②">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-concept-url-scheme③">Start Register</a> <a href="#ref-for-concept-url-scheme④">(2)</a>
      <li><a href="#ref-for-concept-url-scheme⑤">Batch Cache Operations</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url">
    <a href="https://url.spec.whatwg.org/#concept-url">https://url.spec.whatwg.org/#concept-url</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-concept-url">2.1. Service Worker</a> <a href="#ref-for-concept-url①">(2)</a> <a
          href="#ref-for-concept-url②">(3)</a>
      <li><a href="#ref-for-concept-url③">2.3. Service Worker Registration</a>
      <li><a href="#ref-for-concept-url④">Appendix A: Algorithms</a> <a href="#ref-for-concept-url⑤">(2)</a> <a
          href="#ref-for-concept-url⑥">(3)</a>
      <li><a href="#ref-for-concept-url⑦">Create Job</a> <a href="#ref-for-concept-url⑧">(2)</a>
      <li><a href="#ref-for-concept-url⑨">Start Register</a> <a href="#ref-for-concept-url①⓪">(2)</a> <a
          href="#ref-for-concept-url①①">(3)</a>
      <li><a href="#ref-for-concept-url①②">Update</a>
      <li><a href="#ref-for-concept-url①③">Set Registration</a>
      <li><a href="#ref-for-concept-url①④">Match Service Worker Registration</a>
      <li><a href="#ref-for-concept-url①⑤">Get Registration</a>
      <li><a href="#ref-for-concept-url①⑥">Is Async Module</a> <a href="#ref-for-concept-url①⑦">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-parser">
    <a href="https://url.spec.whatwg.org/#concept-url-parser">https://url.spec.whatwg.org/#concept-url-parser</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-url-parser">3.4.3. register(scriptURL, options)</a> <a
          href="#ref-for-concept-url-parser①">(2)</a>
      <li><a href="#ref-for-concept-url-parser②">3.4.4. getRegistration(clientURL)</a>
      <li><a href="#ref-for-concept-url-parser③">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-concept-url-parser④">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-concept-url-parser⑤">Start Register</a>
      <li><a href="#ref-for-concept-url-parser⑥">Update</a> <a href="#ref-for-concept-url-parser⑦">(2)</a>
      <li><a href="#ref-for-concept-url-parser⑧">Match Service Worker Registration</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-serializer">
    <a
      href="https://url.spec.whatwg.org/#concept-url-serializer">https://url.spec.whatwg.org/#concept-url-serializer</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-concept-url-serializer">2.3. Service Worker Registration</a>
      <li><a href="#ref-for-concept-url-serializer①">2.3.1. Lifetime</a>
      <li><a href="#ref-for-concept-url-serializer②">3.1.2. scriptURL</a>
      <li><a href="#ref-for-concept-url-serializer③">3.2.6. scope</a>
      <li><a href="#ref-for-concept-url-serializer④">4.2.1. url</a>
      <li><a href="#ref-for-concept-url-serializer⑤">Appendix A: Algorithms</a> <a
          href="#ref-for-concept-url-serializer⑥">(2)</a>
      <li><a href="#ref-for-concept-url-serializer⑦">Schedule Job</a>
      <li><a href="#ref-for-concept-url-serializer⑧">Update</a> <a href="#ref-for-concept-url-serializer⑨">(2)</a> <a
          href="#ref-for-concept-url-serializer①⓪">(3)</a> <a href="#ref-for-concept-url-serializer①①">(4)</a>
      <li><a href="#ref-for-concept-url-serializer①②">Install</a>
      <li><a href="#ref-for-concept-url-serializer①③">Set Registration</a>
      <li><a href="#ref-for-concept-url-serializer①④">Match Service Worker Registration</a> <a
          href="#ref-for-concept-url-serializer①⑤">(2)</a>
      <li><a href="#ref-for-concept-url-serializer①⑥">Get Registration</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-aborterror">
    <a href="https://webidl.spec.whatwg.org/#aborterror">https://webidl.spec.whatwg.org/#aborterror</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-aborterror">5.4.4. addAll(requests)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-ArrayBuffer">
    <a href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer">https://webidl.spec.whatwg.org/#idl-ArrayBuffer</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-idl-ArrayBuffer">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-ByteString">
    <a href="https://webidl.spec.whatwg.org/#idl-ByteString">https://webidl.spec.whatwg.org/#idl-ByteString</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-idl-ByteString">3.6. NavigationPreloadManager</a> <a href="#ref-for-idl-ByteString①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-DOMException">
    <a href="https://webidl.spec.whatwg.org/#idl-DOMException">https://webidl.spec.whatwg.org/#idl-DOMException</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-idl-DOMException">3.2.8. update()</a> <a href="#ref-for-idl-DOMException①">(2)</a>
      <li><a href="#ref-for-idl-DOMException②">3.4.4. getRegistration(clientURL)</a>
      <li><a href="#ref-for-idl-DOMException③">3.6.1. enable()</a>
      <li><a href="#ref-for-idl-DOMException④">3.6.2. disable()</a>
      <li><a href="#ref-for-idl-DOMException⑤">3.6.3. setHeaderValue(value)</a>
      <li><a href="#ref-for-idl-DOMException⑥">4.2.10. focus()</a>
      <li><a href="#ref-for-idl-DOMException⑦">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-idl-DOMException⑧">4.3.4. claim()</a>
      <li><a href="#ref-for-idl-DOMException⑨">4.4. ExtendableEvent</a> <a href="#ref-for-idl-DOMException①⓪">(2)</a>
      <li><a href="#ref-for-idl-DOMException①①">4.5.7. event.respondWith(r)</a> <a
          href="#ref-for-idl-DOMException①②">(2)</a>
      <li><a href="#ref-for-idl-DOMException①③">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-idl-DOMException①④">5.5.3. open(cacheName)</a>
      <li><a href="#ref-for-idl-DOMException①⑤">Register</a> <a href="#ref-for-idl-DOMException①⑥">(2)</a> <a
          href="#ref-for-idl-DOMException①⑦">(3)</a>
      <li><a href="#ref-for-idl-DOMException①⑧">Update</a> <a href="#ref-for-idl-DOMException①⑨">(2)</a> <a
          href="#ref-for-idl-DOMException②⓪">(3)</a>
      <li><a href="#ref-for-idl-DOMException②①">Handle Fetch</a> <a href="#ref-for-idl-DOMException②②">(2)</a>
      <li><a href="#ref-for-idl-DOMException②③">Unregister</a>
      <li><a href="#ref-for-idl-DOMException②④">Resolve Get Client Promise</a> <a
          href="#ref-for-idl-DOMException②⑤">(2)</a>
      <li><a href="#ref-for-idl-DOMException②⑥">Batch Cache Operations</a> <a href="#ref-for-idl-DOMException②⑦">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-DOMString">
    <a href="https://webidl.spec.whatwg.org/#idl-DOMString">https://webidl.spec.whatwg.org/#idl-DOMString</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-idl-DOMString">4.2. Client</a>
      <li><a href="#ref-for-idl-DOMString①">4.3. Clients</a>
      <li><a href="#ref-for-idl-DOMString②">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-idl-DOMString③">4.5. FetchEvent</a> <a href="#ref-for-idl-DOMString④">(2)</a> <a
          href="#ref-for-idl-DOMString⑤">(3)</a> <a href="#ref-for-idl-DOMString⑥">(4)</a> <a
          href="#ref-for-idl-DOMString⑦">(5)</a> <a href="#ref-for-idl-DOMString⑧">(6)</a> <a
          href="#ref-for-idl-DOMString⑨">(7)</a>
      <li><a href="#ref-for-idl-DOMString①⓪">4.6. ExtendableMessageEvent</a> <a href="#ref-for-idl-DOMString①①">(2)</a>
        <a href="#ref-for-idl-DOMString①②">(3)</a>
      <li><a href="#ref-for-idl-DOMString①③">5.5. CacheStorage</a> <a href="#ref-for-idl-DOMString①④">(2)</a> <a
          href="#ref-for-idl-DOMString①⑤">(3)</a> <a href="#ref-for-idl-DOMString①⑥">(4)</a> <a
          href="#ref-for-idl-DOMString①⑦">(5)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Exposed">
    <a href="https://webidl.spec.whatwg.org/#Exposed">https://webidl.spec.whatwg.org/#Exposed</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-Exposed">3.1. ServiceWorker</a>
      <li><a href="#ref-for-Exposed①">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-Exposed②">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-Exposed③">3.6. NavigationPreloadManager</a>
      <li><a href="#ref-for-Exposed④">4.1. ServiceWorkerGlobalScope</a>
      <li><a href="#ref-for-Exposed⑤">4.2. Client</a> <a href="#ref-for-Exposed⑥">(2)</a>
      <li><a href="#ref-for-Exposed⑦">4.3. Clients</a>
      <li><a href="#ref-for-Exposed⑧">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-Exposed⑨">4.5. FetchEvent</a>
      <li><a href="#ref-for-Exposed①⓪">4.6. ExtendableMessageEvent</a>
      <li><a href="#ref-for-Exposed①①">5.4. Cache</a>
      <li><a href="#ref-for-Exposed①②">5.5. CacheStorage</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-frozen-array">
    <a href="https://webidl.spec.whatwg.org/#idl-frozen-array">https://webidl.spec.whatwg.org/#idl-frozen-array</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-idl-frozen-array">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-idl-frozen-array①">4.2. Client</a>
      <li><a href="#ref-for-idl-frozen-array②">4.3. Clients</a>
      <li><a href="#ref-for-idl-frozen-array③">4.6. ExtendableMessageEvent</a>
      <li><a href="#ref-for-idl-frozen-array④">5.4. Cache</a> <a href="#ref-for-idl-frozen-array⑤">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Global">
    <a href="https://webidl.spec.whatwg.org/#Global">https://webidl.spec.whatwg.org/#Global</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-Global">4.1. ServiceWorkerGlobalScope</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-invalidaccesserror">
    <a
      href="https://webidl.spec.whatwg.org/#invalidaccesserror">https://webidl.spec.whatwg.org/#invalidaccesserror</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-invalidaccesserror">4.2.10. focus()</a>
      <li><a href="#ref-for-invalidaccesserror①">4.3.3. openWindow(url)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-invalidstateerror">
    <a href="https://webidl.spec.whatwg.org/#invalidstateerror">https://webidl.spec.whatwg.org/#invalidstateerror</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-invalidstateerror">3.2.8. update()</a> <a href="#ref-for-invalidstateerror①">(2)</a>
      <li><a href="#ref-for-invalidstateerror②">3.6.1. enable()</a>
      <li><a href="#ref-for-invalidstateerror③">3.6.2. disable()</a>
      <li><a href="#ref-for-invalidstateerror④">3.6.3. setHeaderValue(value)</a>
      <li><a href="#ref-for-invalidstateerror⑤">4.3.4. claim()</a>
      <li><a href="#ref-for-invalidstateerror⑥">4.4. ExtendableEvent</a> <a href="#ref-for-invalidstateerror⑦">(2)</a>
      <li><a href="#ref-for-invalidstateerror⑧">4.5.7. event.respondWith(r)</a> <a
          href="#ref-for-invalidstateerror⑨">(2)</a>
      <li><a href="#ref-for-invalidstateerror①⓪">Batch Cache Operations</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-networkerror">
    <a href="https://webidl.spec.whatwg.org/#networkerror">https://webidl.spec.whatwg.org/#networkerror</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-networkerror">Handle Fetch</a> <a href="#ref-for-networkerror①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-NewObject">
    <a href="https://webidl.spec.whatwg.org/#NewObject">https://webidl.spec.whatwg.org/#NewObject</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-NewObject">3.2. ServiceWorkerRegistration</a> <a href="#ref-for-NewObject①">(2)</a>
      <li><a href="#ref-for-NewObject②">3.4. ServiceWorkerContainer</a> <a href="#ref-for-NewObject③">(2)</a> <a
          href="#ref-for-NewObject④">(3)</a>
      <li><a href="#ref-for-NewObject⑤">4.1. ServiceWorkerGlobalScope</a>
      <li><a href="#ref-for-NewObject⑥">4.2. Client</a> <a href="#ref-for-NewObject⑦">(2)</a>
      <li><a href="#ref-for-NewObject⑧">4.3. Clients</a> <a href="#ref-for-NewObject⑨">(2)</a> <a
          href="#ref-for-NewObject①⓪">(3)</a> <a href="#ref-for-NewObject①①">(4)</a>
      <li><a href="#ref-for-NewObject①②">5.4. Cache</a> <a href="#ref-for-NewObject①③">(2)</a> <a
          href="#ref-for-NewObject①④">(3)</a> <a href="#ref-for-NewObject①⑤">(4)</a> <a
          href="#ref-for-NewObject①⑥">(5)</a> <a href="#ref-for-NewObject①⑦">(6)</a> <a
          href="#ref-for-NewObject①⑧">(7)</a>
      <li><a href="#ref-for-NewObject①⑨">5.5. CacheStorage</a> <a href="#ref-for-NewObject②⓪">(2)</a> <a
          href="#ref-for-NewObject②①">(3)</a> <a href="#ref-for-NewObject②②">(4)</a> <a
          href="#ref-for-NewObject②③">(5)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-promise">
    <a href="https://webidl.spec.whatwg.org/#idl-promise">https://webidl.spec.whatwg.org/#idl-promise</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-idl-promise">3.2. ServiceWorkerRegistration</a> <a href="#ref-for-idl-promise①">(2)</a>
      <li><a href="#ref-for-idl-promise②">3.4. ServiceWorkerContainer</a> <a href="#ref-for-idl-promise③">(2)</a> <a
          href="#ref-for-idl-promise④">(3)</a> <a href="#ref-for-idl-promise⑤">(4)</a>
      <li><a href="#ref-for-idl-promise⑥">3.6. NavigationPreloadManager</a> <a href="#ref-for-idl-promise⑦">(2)</a> <a
          href="#ref-for-idl-promise⑧">(3)</a> <a href="#ref-for-idl-promise⑨">(4)</a>
      <li><a href="#ref-for-idl-promise①⓪">4.1. ServiceWorkerGlobalScope</a>
      <li><a href="#ref-for-idl-promise①①">4.2. Client</a> <a href="#ref-for-idl-promise①②">(2)</a>
      <li><a href="#ref-for-idl-promise①③">4.3. Clients</a> <a href="#ref-for-idl-promise①④">(2)</a> <a
          href="#ref-for-idl-promise①⑤">(3)</a> <a href="#ref-for-idl-promise①⑥">(4)</a>
      <li><a href="#ref-for-idl-promise①⑦">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-idl-promise①⑧">4.5. FetchEvent</a> <a href="#ref-for-idl-promise①⑨">(2)</a> <a
          href="#ref-for-idl-promise②⓪">(3)</a> <a href="#ref-for-idl-promise②①">(4)</a> <a
          href="#ref-for-idl-promise②②">(5)</a>
      <li><a href="#ref-for-idl-promise②③">5.4. Cache</a> <a href="#ref-for-idl-promise②④">(2)</a> <a
          href="#ref-for-idl-promise②⑤">(3)</a> <a href="#ref-for-idl-promise②⑥">(4)</a> <a
          href="#ref-for-idl-promise②⑦">(5)</a> <a href="#ref-for-idl-promise②⑧">(6)</a> <a
          href="#ref-for-idl-promise②⑨">(7)</a>
      <li><a href="#ref-for-idl-promise③⓪">5.5. CacheStorage</a> <a href="#ref-for-idl-promise③①">(2)</a> <a
          href="#ref-for-idl-promise③②">(3)</a> <a href="#ref-for-idl-promise③③">(4)</a> <a
          href="#ref-for-idl-promise③④">(5)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-quotaexceedederror">
    <a
      href="https://webidl.spec.whatwg.org/#quotaexceedederror">https://webidl.spec.whatwg.org/#quotaexceedederror</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-quotaexceedederror">5.5.3. open(cacheName)</a>
      <li><a href="#ref-for-quotaexceedederror①">Batch Cache Operations</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-SameObject">
    <a href="https://webidl.spec.whatwg.org/#SameObject">https://webidl.spec.whatwg.org/#SameObject</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-SameObject">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-SameObject①">3.3. navigator.serviceWorker</a> <a href="#ref-for-SameObject②">(2)</a>
      <li><a href="#ref-for-SameObject③">4.1. ServiceWorkerGlobalScope</a> <a href="#ref-for-SameObject④">(2)</a> <a
          href="#ref-for-SameObject⑤">(3)</a>
      <li><a href="#ref-for-SameObject⑥">4.2. Client</a>
      <li><a href="#ref-for-SameObject⑦">4.5. FetchEvent</a>
      <li><a href="#ref-for-SameObject⑧">4.6. ExtendableMessageEvent</a>
      <li><a href="#ref-for-SameObject⑨">5.3. self.caches</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-SecureContext">
    <a href="https://webidl.spec.whatwg.org/#SecureContext">https://webidl.spec.whatwg.org/#SecureContext</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-SecureContext">3.1. ServiceWorker</a>
      <li><a href="#ref-for-SecureContext①">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-SecureContext②">3.3. navigator.serviceWorker</a> <a href="#ref-for-SecureContext③">(2)</a>
      <li><a href="#ref-for-SecureContext④">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-SecureContext⑤">3.6. NavigationPreloadManager</a>
      <li><a href="#ref-for-SecureContext⑥">5.3. self.caches</a>
      <li><a href="#ref-for-SecureContext⑦">5.4. Cache</a>
      <li><a href="#ref-for-SecureContext⑧">5.5. CacheStorage</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-securityerror">
    <a href="https://webidl.spec.whatwg.org/#securityerror">https://webidl.spec.whatwg.org/#securityerror</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-securityerror">3.4.4. getRegistration(clientURL)</a>
      <li><a href="#ref-for-securityerror①">Register</a> <a href="#ref-for-securityerror②">(2)</a> <a
          href="#ref-for-securityerror③">(3)</a>
      <li><a href="#ref-for-securityerror④">Update</a> <a href="#ref-for-securityerror⑤">(2)</a> <a
          href="#ref-for-securityerror⑥">(3)</a>
      <li><a href="#ref-for-securityerror⑦">Unregister</a>
      <li><a href="#ref-for-securityerror⑧">Resolve Get Client Promise</a> <a href="#ref-for-securityerror⑨">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-exceptiondef-typeerror">
    <a
      href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror">https://webidl.spec.whatwg.org/#exceptiondef-typeerror</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-exceptiondef-typeerror">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-USVString">
    <a href="https://webidl.spec.whatwg.org/#idl-USVString">https://webidl.spec.whatwg.org/#idl-USVString</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-idl-USVString">3.1. ServiceWorker</a>
      <li><a href="#ref-for-idl-USVString①">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-idl-USVString②">3.4. ServiceWorkerContainer</a> <a href="#ref-for-idl-USVString③">(2)</a> <a
          href="#ref-for-idl-USVString④">(3)</a>
      <li><a href="#ref-for-idl-USVString⑤">4.2. Client</a> <a href="#ref-for-idl-USVString⑥">(2)</a> <a
          href="#ref-for-idl-USVString⑦">(3)</a>
      <li><a href="#ref-for-idl-USVString⑧">4.3. Clients</a>
      <li><a href="#ref-for-idl-USVString⑨">4.6. ExtendableMessageEvent</a> <a href="#ref-for-idl-USVString①⓪">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-Uint8Array">
    <a href="https://webidl.spec.whatwg.org/#idl-Uint8Array">https://webidl.spec.whatwg.org/#idl-Uint8Array</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-idl-Uint8Array">4.5.7. event.respondWith(r)</a> <a href="#ref-for-idl-Uint8Array①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-a-new-promise">
    <a href="https://webidl.spec.whatwg.org/#a-new-promise">https://webidl.spec.whatwg.org/#a-new-promise</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-a-new-promise">3.2.9. unregister()</a>
      <li><a href="#ref-for-a-new-promise①">3.4.2. ready</a>
      <li><a href="#ref-for-a-new-promise②">3.4.5. getRegistrations()</a>
      <li><a href="#ref-for-a-new-promise③">3.6.1. enable()</a>
      <li><a href="#ref-for-a-new-promise④">3.6.2. disable()</a>
      <li><a href="#ref-for-a-new-promise⑤">3.6.3. setHeaderValue(value)</a>
      <li><a href="#ref-for-a-new-promise⑥">3.6.4. getState()</a>
      <li><a href="#ref-for-a-new-promise⑦">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-a-new-promise⑧">5.4.1. match(request, options)</a>
      <li><a href="#ref-for-a-new-promise⑨">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-a-new-promise①⓪">5.4.4. addAll(requests)</a> <a href="#ref-for-a-new-promise①①">(2)</a>
      <li><a href="#ref-for-a-new-promise①②">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-a-new-promise①③">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-a-new-promise①④">5.4.7. keys(request, options)</a>
      <li><a href="#ref-for-a-new-promise①⑤">5.5.1. match(request, options)</a>
      <li><a href="#ref-for-a-new-promise①⑥">5.5.2. has(cacheName)</a>
      <li><a href="#ref-for-a-new-promise①⑦">5.5.3. open(cacheName)</a>
      <li><a href="#ref-for-a-new-promise①⑧">5.5.4. delete(cacheName)</a>
      <li><a href="#ref-for-a-new-promise①⑨">5.5.5. keys()</a>
      <li><a href="#ref-for-a-new-promise②⓪">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-a-promise-rejected-with">
    <a
      href="https://webidl.spec.whatwg.org/#a-promise-rejected-with">https://webidl.spec.whatwg.org/#a-promise-rejected-with</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-a-promise-rejected-with">3.2.8. update()</a> <a
          href="#ref-for-a-promise-rejected-with①">(2)</a>
      <li><a href="#ref-for-a-promise-rejected-with②">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-a-promise-rejected-with③">5.4.4. addAll(requests)</a> <a
          href="#ref-for-a-promise-rejected-with④">(2)</a> <a href="#ref-for-a-promise-rejected-with⑤">(3)</a>
      <li><a href="#ref-for-a-promise-rejected-with⑥">5.4.5. put(request, response)</a> <a
          href="#ref-for-a-promise-rejected-with⑦">(2)</a> <a href="#ref-for-a-promise-rejected-with⑧">(3)</a> <a
          href="#ref-for-a-promise-rejected-with⑨">(4)</a> <a href="#ref-for-a-promise-rejected-with①⓪">(5)</a>
      <li><a href="#ref-for-a-promise-rejected-with①①">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-a-promise-rejected-with①②">5.4.7. keys(request, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-a-promise-resolved-with">
    <a
      href="https://webidl.spec.whatwg.org/#a-promise-resolved-with">https://webidl.spec.whatwg.org/#a-promise-resolved-with</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-a-promise-resolved-with">4.5.2. event.preloadResponse</a>
      <li><a href="#ref-for-a-promise-resolved-with①">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-a-promise-resolved-with②">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-a-promise-resolved-with③">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-a-promise-resolved-with④">5.4.7. keys(request, options)</a>
      <li><a href="#ref-for-a-promise-resolved-with⑤">5.5.1. match(request, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-any">
    <a href="https://webidl.spec.whatwg.org/#idl-any">https://webidl.spec.whatwg.org/#idl-any</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-idl-any">3.1. ServiceWorker</a> <a href="#ref-for-idl-any①">(2)</a>
      <li><a href="#ref-for-idl-any②">4.2. Client</a> <a href="#ref-for-idl-any③">(2)</a>
      <li><a href="#ref-for-idl-any④">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-idl-any⑤">4.5. FetchEvent</a> <a href="#ref-for-idl-any⑥">(2)</a>
      <li><a href="#ref-for-idl-any⑦">4.6. ExtendableMessageEvent</a> <a href="#ref-for-idl-any⑧">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-boolean">
    <a href="https://webidl.spec.whatwg.org/#idl-boolean">https://webidl.spec.whatwg.org/#idl-boolean</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-idl-boolean">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-idl-boolean①">3.6. NavigationPreloadManager</a>
      <li><a href="#ref-for-idl-boolean②">4.2. Client</a>
      <li><a href="#ref-for-idl-boolean③">4.3. Clients</a>
      <li><a href="#ref-for-idl-boolean④">5.4. Cache</a> <a href="#ref-for-idl-boolean⑤">(2)</a> <a
          href="#ref-for-idl-boolean⑥">(3)</a> <a href="#ref-for-idl-boolean⑦">(4)</a>
      <li><a href="#ref-for-idl-boolean⑧">5.5. CacheStorage</a> <a href="#ref-for-idl-boolean⑨">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-create-frozen-array">
    <a
      href="https://webidl.spec.whatwg.org/#dfn-create-frozen-array">https://webidl.spec.whatwg.org/#dfn-create-frozen-array</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-create-frozen-array">3.4.5. getRegistrations()</a>
      <li><a href="#ref-for-dfn-create-frozen-array①">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-dfn-create-frozen-array②">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-dfn-create-frozen-array③">5.4.7. keys(request, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-create-exception">
    <a
      href="https://webidl.spec.whatwg.org/#dfn-create-exception">https://webidl.spec.whatwg.org/#dfn-create-exception</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-create-exception">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-dfn-create-exception①">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-dfn-create-exception②">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-dfn-create-exception③">Reject Job Promise</a> <a
          href="#ref-for-dfn-create-exception④">(2)</a> <a href="#ref-for-dfn-create-exception⑤">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-exception">
    <a href="https://webidl.spec.whatwg.org/#dfn-exception">https://webidl.spec.whatwg.org/#dfn-exception</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-exception">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-dfn-exception①">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-dfn-exception②">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-dfn-exception③">Reject Job Promise</a> <a href="#ref-for-dfn-exception④">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-frozen-array-type">
    <a
      href="https://webidl.spec.whatwg.org/#dfn-frozen-array-type">https://webidl.spec.whatwg.org/#dfn-frozen-array-type</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-frozen-array-type">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-dfn-frozen-array-type①">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-dfn-frozen-array-type②">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-dfn-frozen-array-type③">5.4.7. keys(request, options)</a>
      <li><a href="#ref-for-dfn-frozen-array-type④">Create Window Client</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-waiting-for-all-promise">
    <a
      href="https://webidl.spec.whatwg.org/#waiting-for-all-promise">https://webidl.spec.whatwg.org/#waiting-for-all-promise</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-waiting-for-all-promise">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-waiting-for-all-promise①">Install</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-exception-message">
    <a
      href="https://webidl.spec.whatwg.org/#dfn-exception-message">https://webidl.spec.whatwg.org/#dfn-exception-message</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-exception-message">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-dfn-exception-message①">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-dfn-exception-message②">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-dfn-exception-message③">Reject Job Promise</a> <a
          href="#ref-for-dfn-exception-message④">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-object">
    <a href="https://webidl.spec.whatwg.org/#idl-object">https://webidl.spec.whatwg.org/#idl-object</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-idl-object">3.1. ServiceWorker</a>
      <li><a href="#ref-for-idl-object①">4.2. Client</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-partial-interface">
    <a
      href="https://webidl.spec.whatwg.org/#dfn-partial-interface">https://webidl.spec.whatwg.org/#dfn-partial-interface</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-partial-interface">7.1. Define API bound to Service Worker Registration</a>
      <li><a href="#ref-for-dfn-partial-interface①">7.3. Define Event Handler</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-perform-steps-once-promise-is-settled">
    <a
      href="https://webidl.spec.whatwg.org/#dfn-perform-steps-once-promise-is-settled">https://webidl.spec.whatwg.org/#dfn-perform-steps-once-promise-is-settled</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-perform-steps-once-promise-is-settled">5.4.3. add(request)</a>
      <li><a href="#ref-for-dfn-perform-steps-once-promise-is-settled①">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-dfn-perform-steps-once-promise-is-settled②">5.5.1. match(request, options)</a>
      <li><a href="#ref-for-dfn-perform-steps-once-promise-is-settled③">5.5.4. delete(cacheName)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-reject">
    <a href="https://webidl.spec.whatwg.org/#reject">https://webidl.spec.whatwg.org/#reject</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-reject">3.6.1. enable()</a>
      <li><a href="#ref-for-reject①">3.6.2. disable()</a>
      <li><a href="#ref-for-reject②">3.6.3. setHeaderValue(value)</a>
      <li><a href="#ref-for-reject③">Handle Fetch</a> <a href="#ref-for-reject④">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-resolve">
    <a href="https://webidl.spec.whatwg.org/#resolve">https://webidl.spec.whatwg.org/#resolve</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-resolve">Handle Fetch</a> <a href="#ref-for-resolve①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-sequence">
    <a href="https://webidl.spec.whatwg.org/#idl-sequence">https://webidl.spec.whatwg.org/#idl-sequence</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-idl-sequence">3.1. ServiceWorker</a>
      <li><a href="#ref-for-idl-sequence①">4.2. Client</a>
      <li><a href="#ref-for-idl-sequence②">4.6. ExtendableMessageEvent</a>
      <li><a href="#ref-for-idl-sequence③">5.4. Cache</a>
      <li><a href="#ref-for-idl-sequence④">5.5. CacheStorage</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-this">
    <a href="https://webidl.spec.whatwg.org/#this">https://webidl.spec.whatwg.org/#this</a><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-this">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-this①">3.2.8. update()</a> <a href="#ref-for-this②">(2)</a>
      <li><a href="#ref-for-this③">3.2.9. unregister()</a>
      <li><a href="#ref-for-this④">3.3. navigator.serviceWorker</a>
      <li><a href="#ref-for-this⑤">3.4.1. controller</a> <a href="#ref-for-this⑥">(2)</a>
      <li><a href="#ref-for-this⑦">3.4.2. ready</a> <a href="#ref-for-this⑧">(2)</a> <a href="#ref-for-this⑨">(3)</a> <a
          href="#ref-for-this①⓪">(4)</a>
      <li><a href="#ref-for-this①①">3.4.3. register(scriptURL, options)</a> <a href="#ref-for-this①②">(2)</a> <a
          href="#ref-for-this①③">(3)</a>
      <li><a href="#ref-for-this①④">3.4.4. getRegistration(clientURL)</a> <a href="#ref-for-this①⑤">(2)</a>
      <li><a href="#ref-for-this①⑥">3.4.5. getRegistrations()</a>
      <li><a href="#ref-for-this①⑦">3.4.6. startMessages()</a>
      <li><a href="#ref-for-this①⑧">3.4.7. Event handlers</a>
      <li><a href="#ref-for-this①⑨">3.6.1. enable()</a>
      <li><a href="#ref-for-this②⓪">3.6.2. disable()</a>
      <li><a href="#ref-for-this②①">3.6.3. setHeaderValue(value)</a>
      <li><a href="#ref-for-this②②">3.6.4. getState()</a>
      <li><a href="#ref-for-this②③">4.1.1. clients</a>
      <li><a href="#ref-for-this②④">4.1.2. registration</a> <a href="#ref-for-this②⑤">(2)</a>
      <li><a href="#ref-for-this②⑥">4.1.3. serviceWorker</a> <a href="#ref-for-this②⑦">(2)</a>
      <li><a href="#ref-for-this②⑧">4.2.1. url</a>
      <li><a href="#ref-for-this②⑨">4.2.2. frameType</a>
      <li><a href="#ref-for-this③⓪">4.2.3. id</a>
      <li><a href="#ref-for-this③①">4.2.4. type</a>
      <li><a href="#ref-for-this③②">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-this③③">4.2.7. visibilityState</a>
      <li><a href="#ref-for-this③④">4.2.8. focused</a>
      <li><a href="#ref-for-this③⑤">4.2.9. ancestorOrigins</a>
      <li><a href="#ref-for-this③⑥">4.2.10. focus()</a> <a href="#ref-for-this③⑦">(2)</a> <a
          href="#ref-for-this③⑧">(3)</a> <a href="#ref-for-this③⑨">(4)</a> <a href="#ref-for-this④⓪">(5)</a> <a
          href="#ref-for-this④①">(6)</a> <a href="#ref-for-this④②">(7)</a>
      <li><a href="#ref-for-this④③">4.2.11. navigate(url)</a> <a href="#ref-for-this④④">(2)</a> <a
          href="#ref-for-this④⑤">(3)</a> <a href="#ref-for-this④⑥">(4)</a> <a href="#ref-for-this④⑦">(5)</a> <a
          href="#ref-for-this④⑧">(6)</a>
      <li><a href="#ref-for-this④⑨">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-this⑤⓪">4.4.1. event.waitUntil(f)</a>
      <li><a href="#ref-for-this⑤①">4.5.7. event.respondWith(r)</a>
      <li><a href="#ref-for-this⑤②">5.1. Constructs</a> <a href="#ref-for-this⑤③">(2)</a>
      <li><a href="#ref-for-this⑤④">5.3.1. caches</a>
      <li><a href="#ref-for-this⑤⑤">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-this⑤⑥">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-this⑤⑦">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-this⑤⑧">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-this⑤⑨">5.4.7. keys(request, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-throw">
    <a href="https://webidl.spec.whatwg.org/#dfn-throw">https://webidl.spec.whatwg.org/#dfn-throw</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-throw">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-dfn-throw①">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-dfn-throw②">4.4. ExtendableEvent</a> <a href="#ref-for-dfn-throw③">(2)</a>
      <li><a href="#ref-for-dfn-throw④">4.5.7. event.respondWith(r)</a> <a href="#ref-for-dfn-throw⑤">(2)</a>
      <li><a href="#ref-for-dfn-throw⑥">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-dfn-throw⑦">5.4.4. addAll(requests)</a> <a href="#ref-for-dfn-throw⑧">(2)</a>
      <li><a href="#ref-for-dfn-throw⑨">5.4.5. put(request, response)</a> <a href="#ref-for-dfn-throw①⓪">(2)</a>
      <li><a href="#ref-for-dfn-throw①①">5.4.6. delete(request, options)</a> <a href="#ref-for-dfn-throw①②">(2)</a>
      <li><a href="#ref-for-dfn-throw①③">5.4.7. keys(request, options)</a>
      <li><a href="#ref-for-dfn-throw①④">Batch Cache Operations</a> <a href="#ref-for-dfn-throw①⑤">(2)</a> <a
          href="#ref-for-dfn-throw①⑥">(3)</a> <a href="#ref-for-dfn-throw①⑦">(4)</a> <a
          href="#ref-for-dfn-throw①⑧">(5)</a> <a href="#ref-for-dfn-throw①⑨">(6)</a> <a
          href="#ref-for-dfn-throw②⓪">(7)</a> <a href="#ref-for-dfn-throw②①">(8)</a> <a
          href="#ref-for-dfn-throw②②">(9)</a> <a href="#ref-for-dfn-throw②③">(10)</a> <a
          href="#ref-for-dfn-throw②④">(11)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-undefined">
    <a href="https://webidl.spec.whatwg.org/#idl-undefined">https://webidl.spec.whatwg.org/#idl-undefined</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-idl-undefined">3.1. ServiceWorker</a> <a href="#ref-for-idl-undefined①">(2)</a>
      <li><a href="#ref-for-idl-undefined②">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-idl-undefined③">3.4. ServiceWorkerContainer</a> <a href="#ref-for-idl-undefined④">(2)</a>
      <li><a href="#ref-for-idl-undefined⑤">3.6. NavigationPreloadManager</a> <a href="#ref-for-idl-undefined⑥">(2)</a>
        <a href="#ref-for-idl-undefined⑦">(3)</a>
      <li><a href="#ref-for-idl-undefined⑧">4.1. ServiceWorkerGlobalScope</a>
      <li><a href="#ref-for-idl-undefined⑨">4.2. Client</a> <a href="#ref-for-idl-undefined①⓪">(2)</a>
      <li><a href="#ref-for-idl-undefined①①">4.3. Clients</a> <a href="#ref-for-idl-undefined①②">(2)</a>
      <li><a href="#ref-for-idl-undefined①③">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-idl-undefined①④">4.5. FetchEvent</a> <a href="#ref-for-idl-undefined①⑤">(2)</a> <a
          href="#ref-for-idl-undefined①⑥">(3)</a>
      <li><a href="#ref-for-idl-undefined①⑦">5.4. Cache</a> <a href="#ref-for-idl-undefined①⑧">(2)</a> <a
          href="#ref-for-idl-undefined①⑨">(3)</a> <a href="#ref-for-idl-undefined②⓪">(4)</a>
      <li><a href="#ref-for-idl-undefined②①">5.5. CacheStorage</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-upon-fulfillment">
    <a href="https://webidl.spec.whatwg.org/#upon-fulfillment">https://webidl.spec.whatwg.org/#upon-fulfillment</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-upon-fulfillment">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-upon-fulfillment①">4.5.7. event.respondWith(r)</a>
      <li><a href="#ref-for-upon-fulfillment②">5.4.5. put(request, response)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-upon-rejection">
    <a href="https://webidl.spec.whatwg.org/#upon-rejection">https://webidl.spec.whatwg.org/#upon-rejection</a><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-upon-rejection">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-upon-rejection①">4.5.7. event.respondWith(r)</a>
      <li><a href="#ref-for-upon-rejection②">Install</a>
    </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by
      reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
    <li>
      <a data-link-type="biblio">[CSP3]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-enforced">enforced</span>
        <li><span class="dfn-paneled" id="term-for-monitored">monitored</span>
      </ul>
    <li>
      <a data-link-type="biblio">[DOM]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-document">Document</span>
        <li><span class="dfn-paneled" id="term-for-event">Event</span>
        <li><span class="dfn-paneled" id="term-for-dictdef-eventinit">EventInit</span>
        <li><span class="dfn-paneled" id="term-for-eventtarget">EventTarget</span>
        <li><span class="dfn-paneled" id="term-for-dom-event-cancelable">cancelable</span>
        <li><span class="dfn-paneled" id="term-for-canceled-flag">canceled flag</span>
        <li><span class="dfn-paneled" id="term-for-concept-event-create">creating an event</span>
        <li><span class="dfn-paneled" id="term-for-concept-event-dispatch">dispatch</span>
        <li><span class="dfn-paneled" id="term-for-dispatch-flag">dispatch flag</span>
        <li><span class="dfn-paneled" id="term-for-concept-document">document</span>
        <li><span class="dfn-paneled" id="term-for-concept-event">event</span>
        <li><span class="dfn-paneled" id="term-for-concept-event-listener">event listener</span>
        <li><span class="dfn-paneled" id="term-for-concept-event-fire">fire an event</span>
        <li><span class="dfn-paneled" id="term-for-dom-event-istrusted">isTrusted</span>
        <li><span class="dfn-paneled" id="term-for-abortsignal-signal-abort">signal abort</span>
        <li><span class="dfn-paneled" id="term-for-stop-immediate-propagation-flag">stop immediate propagation
            flag</span>
        <li><span class="dfn-paneled" id="term-for-stop-propagation-flag">stop propagation flag</span>
        <li><span class="dfn-paneled" id="term-for-dom-event-type">type</span>
      </ul>
    <li>
      <a data-link-type="biblio">[ECMASCRIPT]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-sec-normalcompletion">NormalCompletion</span>
        <li><span class="dfn-paneled" id="term-for-sec-throwcompletion">ThrowCompletion</span>
        <li><span class="dfn-paneled" id="term-for-sec-completion-record-specification-type">abrupt completion</span>
        <li><span class="dfn-paneled" id="term-for-sec-algorithm-conventions">assert</span>
        <li><span class="dfn-paneled" id="term-for-sec-completion-record-specification-type①">completion</span>
        <li><span class="dfn-paneled" id="term-for-sec-cyclic-module-records">cyclic module record</span>
        <li><span class="dfn-paneled" id="term-for-sec-detacharraybuffer">detacharraybuffer</span>
        <li><span class="dfn-paneled" id="term-for-sec-map-objects">map objects</span>
        <li><span class="dfn-paneled" id="term-for-sec-abstract-module-records">module record</span>
        <li><span class="dfn-paneled" id="term-for-sec-promise-objects">promise</span>
      </ul>
    <li>
      <a data-link-type="biblio">[ENCODING]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-utf-8">utf-8</span>
      </ul>
    <li>
      <a data-link-type="biblio">[FETCH]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-dom-requestdestination-report">"report"</span>
        <li><span class="dfn-paneled" id="term-for-headers">Headers</span>
        <li><span class="dfn-paneled" id="term-for-request">Request</span>
        <li><span class="dfn-paneled" id="term-for-requestinfo">RequestInfo</span>
        <li><span class="dfn-paneled" id="term-for-response">Response</span>
        <li><span class="dfn-paneled" id="term-for-fetch-controller-abort">abort</span>
        <li><span class="dfn-paneled" id="term-for-concept-response-aborted">aborted flag</span>
        <li><span class="dfn-paneled" id="term-for-concept-header-list-append">append</span>
        <li><span class="dfn-paneled" id="term-for-concept-filtered-response-basic">basic filtered response</span>
        <li><span class="dfn-paneled" id="term-for-concept-response-body">body <small>(for response)</small></span>
        <li><span class="dfn-paneled" id="term-for-concept-request-cache-mode">cache mode</span>
        <li><span class="dfn-paneled" id="term-for-concept-response-cache-state">cache state</span>
        <li><span class="dfn-paneled" id="term-for-concept-request-client">client</span>
        <li><span class="dfn-paneled" id="term-for-concept-response-clone">clone <small>(for response)</small></span>
        <li><span class="dfn-paneled" id="term-for-concept-header-list-combine">combine</span>
        <li><span class="dfn-paneled" id="term-for-header-list-contains">contains</span>
        <li><span class="dfn-paneled" id="term-for-concept-filtered-response-cors">cors filtered response</span>
        <li><span class="dfn-paneled" id="term-for-cross-origin-resource-policy-check">cross-origin resource policy
            check</span>
        <li><span class="dfn-paneled" id="term-for-concept-request-destination">destination</span>
        <li><span class="dfn-paneled" id="term-for-concept-header-extract-mime-type">extract a mime type</span>
        <li><span class="dfn-paneled" id="term-for-extract-header-list-values">extracting header list values</span>
        <li><span class="dfn-paneled" id="term-for-concept-fetch">fetch</span>
        <li><span class="dfn-paneled" id="term-for-fetch-controller">fetch controller</span>
        <li><span class="dfn-paneled" id="term-for-dom-global-fetch">fetch(input, init)</span>
        <li><span class="dfn-paneled" id="term-for-concept-filtered-response">filtered response</span>
        <li><span class="dfn-paneled" id="term-for-concept-headers-guard">guard</span>
        <li><span class="dfn-paneled" id="term-for-concept-header">header</span>
        <li><span class="dfn-paneled" id="term-for-concept-response-header-list">header list <small>(for
              response)</small></span>
        <li><span class="dfn-paneled" id="term-for-concept-http-fetch">http fetch</span>
        <li><span class="dfn-paneled" id="term-for-concept-request-initiator">initiator</span>
        <li><span class="dfn-paneled" id="term-for-concept-request-method">method</span>
        <li><span class="dfn-paneled" id="term-for-concept-header-name">name</span>
        <li><span class="dfn-paneled" id="term-for-navigation-request">navigation request</span>
        <li><span class="dfn-paneled" id="term-for-concept-network-error">network error</span>
        <li><span class="dfn-paneled" id="term-for-non-subresource-request">non-subresource request</span>
        <li><span class="dfn-paneled" id="term-for-ok-status">ok status</span>
        <li><span class="dfn-paneled" id="term-for-concept-filtered-response-opaque">opaque filtered response</span>
        <li><span class="dfn-paneled" id="term-for-concept-request-origin">origin</span>
        <li><span class="dfn-paneled" id="term-for-concept-request-parser-metadata">parser metadata</span>
        <li><span class="dfn-paneled" id="term-for-concept-request-redirect-mode">redirect mode</span>
        <li><span class="dfn-paneled" id="term-for-concept-request-replaces-client-id">replaces client id</span>
        <li><span class="dfn-paneled" id="term-for-concept-request-request">request <small>(for Request)</small></span>
        <li><span class="dfn-paneled" id="term-for-concept-request-reserved-client">reserved client</span>
        <li><span class="dfn-paneled" id="term-for-concept-response-response">response <small>(for
              Response)</small></span>
        <li><span class="dfn-paneled" id="term-for-response-service-worker-timing-info">service worker timing
            info</span>
        <li><span class="dfn-paneled" id="term-for-request-service-workers-mode">service-workers mode</span>
        <li><span class="dfn-paneled" id="term-for-dom-request-signal">signal</span>
        <li><span class="dfn-paneled" id="term-for-concept-response-status">status</span>
        <li><span class="dfn-paneled" id="term-for-concept-body-stream">stream</span>
        <li><span class="dfn-paneled" id="term-for-subresource-request">subresource request</span>
        <li><span class="dfn-paneled" id="term-for-concept-response-type">type</span>
        <li><span class="dfn-paneled" id="term-for-body-unusable">unusable</span>
        <li><span class="dfn-paneled" id="term-for-concept-request-url">url</span>
        <li><span class="dfn-paneled" id="term-for-concept-request-use-url-credentials-flag">use-url-credentials
            flag</span>
        <li><span class="dfn-paneled" id="term-for-concept-header-value">value</span>
      </ul>
    <li>
      <a data-link-type="biblio">[FileAPI]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-blob-url">blob url</span>
      </ul>
    <li>
      <a data-link-type="biblio">[hr-time-3]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-dom-domhighrestimestamp">DOMHighResTimeStamp</span>
        <li><span class="dfn-paneled" id="term-for-dfn-coarsen-time">coarsen time</span>
        <li><span class="dfn-paneled" id="term-for-dfn-coarsened-shared-current-time">coarsened shared current
            time</span>
        <li><span class="dfn-paneled" id="term-for-dfn-unsafe-shared-current-time">unsafe shared current time</span>
      </ul>
    <li>
      <a data-link-type="biblio">[HTML]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-abstractworker">AbstractWorker</span>
        <li><span class="dfn-paneled" id="term-for-event-domcontentloaded">DOMContentLoaded</span>
        <li><span class="dfn-paneled" id="term-for-dedicatedworkerglobalscope">DedicatedWorkerGlobalScope</span>
        <li><span class="dfn-paneled" id="term-for-eventhandler">EventHandler</span>
        <li><span class="dfn-paneled" id="term-for-location">Location</span>
        <li><span class="dfn-paneled" id="term-for-messageevent">MessageEvent</span>
        <li><span class="dfn-paneled" id="term-for-messageport">MessagePort</span>
        <li><span class="dfn-paneled" id="term-for-navigator">Navigator</span>
        <li><span class="dfn-paneled" id="term-for-sharedworkerglobalscope">SharedWorkerGlobalScope</span>
        <li><span class="dfn-paneled"
            id="term-for-structureddeserializewithtransfer">StructuredDeserializeWithTransfer</span>
        <li><span class="dfn-paneled" id="term-for-structuredserializeoptions">StructuredSerializeOptions</span>
        <li><span class="dfn-paneled"
            id="term-for-structuredserializewithtransfer">StructuredSerializeWithTransfer</span>
        <li><span class="dfn-paneled" id="term-for-window">Window</span>
        <li><span class="dfn-paneled" id="term-for-windoworworkerglobalscope">WindowOrWorkerGlobalScope</span>
        <li><span class="dfn-paneled" id="term-for-worker">Worker</span>
        <li><span class="dfn-paneled" id="term-for-workerglobalscope">WorkerGlobalScope</span>
        <li><span class="dfn-paneled" id="term-for-workerlocation">WorkerLocation</span>
        <li><span class="dfn-paneled" id="term-for-workernavigator">WorkerNavigator</span>
        <li><span class="dfn-paneled" id="term-for-workertype">WorkerType</span>
        <li><span class="dfn-paneled" id="term-for-active-document">active document</span>
        <li><span class="dfn-paneled" id="term-for-concept-environment-active-service-worker">active service
            worker</span>
        <li><span class="dfn-paneled" id="term-for-concept-location-ancestor-origins-list">ancestor origins list</span>
        <li><span class="dfn-paneled" id="term-for-api-base-url">api base url</span>
        <li><span class="dfn-paneled" id="term-for-api-url-character-encoding">api url character encoding</span>
        <li><span class="dfn-paneled" id="term-for-auxiliary-browsing-context">auxiliary browsing context</span>
        <li><span class="dfn-paneled" id="term-for-concept-script-base-url">base url</span>
        <li><span class="dfn-paneled" id="term-for-browsing-context">browsing context</span>
        <li><span class="dfn-paneled" id="term-for-classic-script">classic script</span>
        <li><span class="dfn-paneled" id="term-for-creating-a-new-javascript-realm">create a new javascript realm</span>
        <li><span class="dfn-paneled" id="term-for-creating-a-policy-container-from-a-fetch-response">creating a policy
            container from a fetch response</span>
        <li><span class="dfn-paneled" id="term-for-concept-environment-creation-url">creation url</span>
        <li><span class="dfn-paneled"
            id="term-for-concept-workerglobalscope-cross-origin-isolated-capability">cross-origin isolated
            capability</span>
        <li><span class="dfn-paneled" id="term-for-current-global-object">current global object</span>
        <li><span class="dfn-paneled" id="term-for-dom-messageevent-data">data</span>
        <li><span class="dfn-paneled" id="term-for-a-browsing-context-is-discarded">discard</span>
        <li><span class="dfn-paneled" id="term-for-discard-a-document">discard a document</span>
        <li><span class="dfn-paneled" id="term-for-environment">environment</span>
        <li><span class="dfn-paneled" id="term-for-environment-discarding-steps">environment discarding steps</span>
        <li><span class="dfn-paneled" id="term-for-environment-settings-object">environment settings object</span>
        <li><span class="dfn-paneled" id="term-for-event-handlers">event handler</span>
        <li><span class="dfn-paneled" id="term-for-event-handler-event-type">event handler event type</span>
        <li><span class="dfn-paneled" id="term-for-event-handler-idl-attributes">event handler idl attribute</span>
        <li><span class="dfn-paneled" id="term-for-concept-agent-event-loop">event loop <small>(for
              agent)</small></span>
        <li><span class="dfn-paneled" id="term-for-concept-environment-execution-ready-flag">execution ready flag</span>
        <li><span class="dfn-paneled" id="term-for-fetch-a-classic-worker-script">fetch a classic worker script</span>
        <li><span class="dfn-paneled" id="term-for-fetch-a-classic-worker-imported-script">fetch a classic
            worker-imported script</span>
        <li><span class="dfn-paneled" id="term-for-fetch-a-module-worker-script-tree">fetch a module worker script
            graph</span>
        <li><span class="dfn-paneled" id="term-for-focusing-steps">focusing steps</span>
        <li><span class="dfn-paneled" id="term-for-concept-settings-object-global">global object <small>(for environment
              settings object)</small></span>
        <li><span class="dfn-paneled" id="term-for-has-focus-steps">has focus steps</span>
        <li><span class="dfn-paneled" id="term-for-concept-environment-id">id</span>
        <li><span class="dfn-paneled" id="term-for-the-iframe-element">iframe</span>
        <li><span class="dfn-paneled" id="term-for-import-scripts-into-worker-global-scope">import scripts into worker
            global scope</span>
        <li><span class="dfn-paneled" id="term-for-in-parallel">in parallel</span>
        <li><span class="dfn-paneled" id="term-for-fetching-scripts-is-top-level">is top-level</span>
        <li><span class="dfn-paneled" id="term-for-event-message">message</span>
        <li><span class="dfn-paneled" id="term-for-concept-settings-object-module-map">module map <small>(for
              environment settings object)</small></span>
        <li><span class="dfn-paneled" id="term-for-module-script">module script</span>
        <li><span class="dfn-paneled" id="term-for-navigate">navigate</span>
        <li><span class="dfn-paneled" id="term-for-nested-browsing-context">nested browsing context</span>
        <li><span class="dfn-paneled" id="term-for-obtain-a-service-worker-agent">obtain a service worker agent</span>
        <li><span class="dfn-paneled" id="term-for-concept-origin-opaque">opaque origin</span>
        <li><span class="dfn-paneled" id="term-for-concept-settings-object-origin">origin <small>(for environment
              settings object)</small></span>
        <li><span class="dfn-paneled" id="term-for-concept-WorkerGlobalScope-owner-set">owner set</span>
        <li><span class="dfn-paneled" id="term-for-fetching-scripts-perform-fetch">perform the fetch</span>
        <li><span class="dfn-paneled" id="term-for-concept-settings-object-policy-container">policy container
            <small>(for environment settings object)</small></span>
        <li><span class="dfn-paneled" id="term-for-dom-messageevent-ports">ports</span>
        <li><span class="dfn-paneled" id="term-for-queue-a-microtask">queue a microtask</span>
        <li><span class="dfn-paneled" id="term-for-queue-a-task">queue a task</span>
        <li><span class="dfn-paneled" id="term-for-concept-global-object-realm">realm <small>(for global
              object)</small></span>
        <li><span class="dfn-paneled" id="term-for-realm-execution-context">realm execution context</span>
        <li><span class="dfn-paneled" id="term-for-concept-script-record">record</span>
        <li><span class="dfn-paneled" id="term-for-concept-relevant-global">relevant global object</span>
        <li><span class="dfn-paneled" id="term-for-concept-relevant-realm">relevant realm</span>
        <li><span class="dfn-paneled" id="term-for-relevant-settings-object">relevant settings object</span>
        <li><span class="dfn-paneled" id="term-for-resolve-a-module-specifier">resolve a module specifier</span>
        <li><span class="dfn-paneled" id="term-for-responsible-event-loop">responsible event loop</span>
        <li><span class="dfn-paneled" id="term-for-run-a-classic-script">run a classic script</span>
        <li><span class="dfn-paneled" id="term-for-run-a-module-script">run a module script</span>
        <li><span class="dfn-paneled" id="term-for-run-a-worker">run a worker</span>
        <li><span class="dfn-paneled" id="term-for-same-origin">same origin</span>
        <li><span class="dfn-paneled" id="term-for-attr-iframe-sandbox">sandbox</span>
        <li><span class="dfn-paneled" id="term-for-concept-script">script</span>
        <li><span class="dfn-paneled" id="term-for-secure-context">secure context</span>
        <li><span class="dfn-paneled" id="term-for-ascii-serialisation-of-an-origin">serialization of an origin</span>
        <li><span class="dfn-paneled" id="term-for-shared-workers">shared worker</span>
        <li><span class="dfn-paneled" id="term-for-dom-messageevent-source">source</span>
        <li><span class="dfn-paneled" id="term-for-source-browsing-context">source browsing context</span>
        <li><span class="dfn-paneled" id="term-for-concept-environment-target-browsing-context">target browsing
            context</span>
        <li><span class="dfn-paneled" id="term-for-concept-task">task</span>
        <li><span class="dfn-paneled" id="term-for-task-queue">task queues</span>
        <li><span class="dfn-paneled" id="term-for-task-source">task source</span>
        <li><span class="dfn-paneled" id="term-for-concept-settings-object-time-origin">time origin</span>
        <li><span class="dfn-paneled" id="term-for-top-level-browsing-context">top-level browsing context</span>
        <li><span class="dfn-paneled" id="term-for-concept-environment-top-level-creation-url">top-level creation
            url</span>
        <li><span class="dfn-paneled" id="term-for-concept-environment-top-level-origin">top-level origin</span>
        <li><span class="dfn-paneled" id="term-for-dom-structuredserializeoptions-transfer">transfer</span>
        <li><span class="dfn-paneled" id="term-for-concept-workerglobalscope-type">type</span>
        <li><span class="dfn-paneled" id="term-for-unload-a-document">unload a document</span>
        <li><span class="dfn-paneled" id="term-for-unsafe-response">unsafe response</span>
        <li><span class="dfn-paneled" id="term-for-concept-workerglobalscope-url">url</span>
        <li><span class="dfn-paneled" id="term-for-user-interaction-task-source">user interaction task source</span>
        <li><span class="dfn-paneled" id="term-for-workers">web worker</span>
      </ul>
    <li>
      <a data-link-type="biblio">[INFRA]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-abort-when">abort when</span>
        <li><span class="dfn-paneled" id="term-for-set-append">append <small>(for set)</small></span>
        <li><span class="dfn-paneled" id="term-for-ascii-case-insensitive">ascii case-insensitive</span>
        <li><span class="dfn-paneled" id="term-for-iteration-break">break</span>
        <li><span class="dfn-paneled" id="term-for-byte-sequence">byte sequence</span>
        <li><span class="dfn-paneled" id="term-for-list-contain">contain</span>
        <li><span class="dfn-paneled" id="term-for-iteration-continue">continue</span>
        <li><span class="dfn-paneled" id="term-for-queue-dequeue">dequeue</span>
        <li><span class="dfn-paneled" id="term-for-queue-enqueue">enqueue</span>
        <li><span class="dfn-paneled" id="term-for-map-entry">entry</span>
        <li><span class="dfn-paneled" id="term-for-map-exists">exist</span>
        <li><span class="dfn-paneled" id="term-for-map-iterate">for each <small>(for map)</small></span>
        <li><span class="dfn-paneled" id="term-for-map-getting-the-keys">get the keys</span>
        <li><span class="dfn-paneled" id="term-for-if-aborted">if aborted</span>
        <li><span class="dfn-paneled" id="term-for-implementation-defined">implementation-defined</span>
        <li><span class="dfn-paneled" id="term-for-list-is-empty">is not empty</span>
        <li><span class="dfn-paneled" id="term-for-struct-item">item <small>(for struct)</small></span>
        <li><span class="dfn-paneled" id="term-for-map-key">key</span>
        <li><span class="dfn-paneled" id="term-for-map-getting-the-keys①">keys</span>
        <li><span class="dfn-paneled" id="term-for-list">list</span>
        <li><span class="dfn-paneled" id="term-for-ordered-map">map</span>
        <li><span class="dfn-paneled" id="term-for-ordered-map①">ordered map</span>
        <li><span class="dfn-paneled" id="term-for-ordered-set">ordered set</span>
        <li><span class="dfn-paneled" id="term-for-queue">queue</span>
        <li><span class="dfn-paneled" id="term-for-map-remove">remove <small>(for map)</small></span>
        <li><span class="dfn-paneled" id="term-for-map-set">set <small>(for map)</small></span>
        <li><span class="dfn-paneled" id="term-for-struct">struct</span>
        <li><span class="dfn-paneled" id="term-for-map-value">value</span>
        <li><span class="dfn-paneled" id="term-for-map-getting-the-values">values</span>
      </ul>
    <li>
      <a data-link-type="biblio">[MIMESNIFF]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-javascript-mime-type">javascript mime type</span>
      </ul>
    <li>
      <a data-link-type="biblio">[navigation-timing-2]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-dom-performancenavigationtiming">PerformanceNavigationTiming</span>
      </ul>
    <li>
      <a data-link-type="biblio">[page-visibility]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-VisibilityState">VisibilityState</span>
        <li><span class="dfn-paneled" id="term-for-dom-document-visibilitystate">visibilityState</span>
      </ul>
    <li>
      <a data-link-type="biblio">[PUSH]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-h-the-push-event">push</span>
      </ul>
    <li>
      <a data-link-type="biblio">[rfc7230]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-section-3.2">field-value</span>
      </ul>
    <li>
      <a data-link-type="biblio">[rfc7231]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-section-7.1.4">vary</span>
      </ul>
    <li>
      <a data-link-type="biblio">[secure-contexts]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-potentially-trustworthy-origin">potentially trustworthy origin</span>
        <li><span class="dfn-paneled" id="term-for-potentially-trustworthy-url">potentially trustworthy url</span>
      </ul>
    <li>
      <a data-link-type="biblio">[STORAGE]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-storage-key-equal">equal</span>
        <li><span class="dfn-paneled" id="term-for-obtain-a-storage-key">obtain a storage key</span>
        <li><span class="dfn-paneled" id="term-for-storage-key">storage key</span>
      </ul>
    <li>
      <a data-link-type="biblio">[STREAMS]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-readablestream">ReadableStream</span>
        <li><span class="dfn-paneled" id="term-for-readablestreamdefaultreader-cancel">cancel <small>(for
              ReadableStreamDefaultReader)</small></span>
        <li><span class="dfn-paneled" id="term-for-chunk">chunk</span>
        <li><span class="dfn-paneled" id="term-for-read-request-chunk-steps">chunk steps</span>
        <li><span class="dfn-paneled" id="term-for-readablestream-close">close</span>
        <li><span class="dfn-paneled" id="term-for-read-request-close-steps">close steps</span>
        <li><span class="dfn-paneled" id="term-for-readablestream-enqueue">enqueue</span>
        <li><span class="dfn-paneled" id="term-for-readablestream-error">error</span>
        <li><span class="dfn-paneled" id="term-for-read-request-error-steps">error steps</span>
        <li><span class="dfn-paneled" id="term-for-readablestream-errored">errored</span>
        <li><span class="dfn-paneled" id="term-for-readablestream-get-a-reader">getting a reader</span>
        <li><span class="dfn-paneled" id="term-for-readablestreamdefaultreader-read-a-chunk">read a chunk</span>
        <li><span class="dfn-paneled" id="term-for-read-request">read request</span>
        <li><span class="dfn-paneled" id="term-for-readablestreamdefaultreader-read-all-bytes">reading all bytes</span>
      </ul>
    <li>
      <a data-link-type="biblio">[URL]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-concept-url-equals">equal</span>
        <li><span class="dfn-paneled" id="term-for-concept-url-fragment">fragment</span>
        <li><span class="dfn-paneled" id="term-for-concept-url-origin">origin</span>
        <li><span class="dfn-paneled" id="term-for-concept-url-path">path</span>
        <li><span class="dfn-paneled" id="term-for-concept-url-query">query</span>
        <li><span class="dfn-paneled" id="term-for-concept-url-scheme">scheme</span>
        <li><span class="dfn-paneled" id="term-for-concept-url">url</span>
        <li><span class="dfn-paneled" id="term-for-concept-url-parser">url parser</span>
        <li><span class="dfn-paneled" id="term-for-concept-url-serializer">url serializer</span>
      </ul>
    <li>
      <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
      <ul>
        <li><span class="dfn-paneled" id="term-for-aborterror">AbortError</span>
        <li><span class="dfn-paneled" id="term-for-idl-ArrayBuffer">ArrayBuffer</span>
        <li><span class="dfn-paneled" id="term-for-idl-ByteString">ByteString</span>
        <li><span class="dfn-paneled" id="term-for-idl-DOMException">DOMException</span>
        <li><span class="dfn-paneled" id="term-for-idl-DOMString">DOMString</span>
        <li><span class="dfn-paneled" id="term-for-Exposed">Exposed</span>
        <li><span class="dfn-paneled" id="term-for-idl-frozen-array">FrozenArray</span>
        <li><span class="dfn-paneled" id="term-for-Global">Global</span>
        <li><span class="dfn-paneled" id="term-for-invalidaccesserror">InvalidAccessError</span>
        <li><span class="dfn-paneled" id="term-for-invalidstateerror">InvalidStateError</span>
        <li><span class="dfn-paneled" id="term-for-networkerror">NetworkError</span>
        <li><span class="dfn-paneled" id="term-for-NewObject">NewObject</span>
        <li><span class="dfn-paneled" id="term-for-idl-promise">Promise</span>
        <li><span class="dfn-paneled" id="term-for-quotaexceedederror">QuotaExceededError</span>
        <li><span class="dfn-paneled" id="term-for-SameObject">SameObject</span>
        <li><span class="dfn-paneled" id="term-for-SecureContext">SecureContext</span>
        <li><span class="dfn-paneled" id="term-for-securityerror">SecurityError</span>
        <li><span class="dfn-paneled" id="term-for-exceptiondef-typeerror">TypeError</span>
        <li><span class="dfn-paneled" id="term-for-idl-USVString">USVString</span>
        <li><span class="dfn-paneled" id="term-for-idl-Uint8Array">Uint8Array</span>
        <li><span class="dfn-paneled" id="term-for-a-new-promise">a new promise</span>
        <li><span class="dfn-paneled" id="term-for-a-promise-rejected-with">a promise rejected with</span>
        <li><span class="dfn-paneled" id="term-for-a-promise-resolved-with">a promise resolved with</span>
        <li><span class="dfn-paneled" id="term-for-idl-any">any</span>
        <li><span class="dfn-paneled" id="term-for-idl-boolean">boolean</span>
        <li><span class="dfn-paneled" id="term-for-dfn-create-frozen-array">create a frozen array</span>
        <li><span class="dfn-paneled" id="term-for-dfn-create-exception">created</span>
        <li><span class="dfn-paneled" id="term-for-dfn-exception">exception</span>
        <li><span class="dfn-paneled" id="term-for-dfn-frozen-array-type">frozen array type</span>
        <li><span class="dfn-paneled" id="term-for-waiting-for-all-promise">getting a promise to wait for all</span>
        <li><span class="dfn-paneled" id="term-for-dfn-exception-message">message</span>
        <li><span class="dfn-paneled" id="term-for-idl-object">object</span>
        <li><span class="dfn-paneled" id="term-for-dfn-partial-interface">partial interface</span>
        <li><span class="dfn-paneled" id="term-for-dfn-perform-steps-once-promise-is-settled">reacting</span>
        <li><span class="dfn-paneled" id="term-for-reject">reject</span>
        <li><span class="dfn-paneled" id="term-for-resolve">resolve</span>
        <li><span class="dfn-paneled" id="term-for-idl-sequence">sequence</span>
        <li><span class="dfn-paneled" id="term-for-this">this</span>
        <li><span class="dfn-paneled" id="term-for-dfn-throw">throw</span>
        <li><span class="dfn-paneled" id="term-for-idl-undefined">undefined</span>
        <li><span class="dfn-paneled" id="term-for-upon-fulfillment">upon fulfillment</span>
        <li><span class="dfn-paneled" id="term-for-upon-rejection">upon rejection</span>
      </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link"
      href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a
      class="self-link" href="#normative"></a></h3>
  <dl>
    <dt id="biblio-csp3">[CSP3]
    <dd>Mike West. <a href="https://www.w3.org/TR/CSP3/"><cite>Content Security Policy Level 3</cite></a>. 29 June 2021.
      WD. URL: <a href="https://www.w3.org/TR/CSP3/">https://www.w3.org/TR/CSP3/</a>
    <dt id="biblio-dom">[DOM]
    <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL:
      <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
    <dt id="biblio-ecmascript">[ECMASCRIPT]
    <dd><a href="https://tc39.es/ecma262/multipage/"><cite>ECMAScript Language Specification</cite></a>. URL: <a
        href="https://tc39.es/ecma262/multipage/">https://tc39.es/ecma262/multipage/</a>
    <dt id="biblio-encoding">[ENCODING]
    <dd>Anne van Kesteren. <a href="https://encoding.spec.whatwg.org/"><cite>Encoding Standard</cite></a>. Living
      Standard. URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
    <dt id="biblio-fetch">[FETCH]
    <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard.
      URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
    <dt id="biblio-fileapi">[FileAPI]
    <dd>Marijn Kruisselbrink; Arun Ranganathan. <a href="https://www.w3.org/TR/FileAPI/"><cite>File API</cite></a>. 4
      June 2021. WD. URL: <a href="https://www.w3.org/TR/FileAPI/">https://www.w3.org/TR/FileAPI/</a>
    <dt id="biblio-hr-time-3">[HR-TIME-3]
    <dd>Yoav Weiss. <a href="https://www.w3.org/TR/hr-time-3/"><cite>High Resolution Time</cite></a>. 28 January 2022.
      WD. URL: <a href="https://www.w3.org/TR/hr-time-3/">https://www.w3.org/TR/hr-time-3/</a>
    <dt id="biblio-html">[HTML]
    <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>.
      Living Standard. URL: <a
        href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
    <dt id="biblio-infra">[INFRA]
    <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>.
      Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
    <dt id="biblio-mimesniff">[MIMESNIFF]
    <dd>Gordon P. Hemsley. <a href="https://mimesniff.spec.whatwg.org/"><cite>MIME Sniffing Standard</cite></a>. Living
      Standard. URL: <a href="https://mimesniff.spec.whatwg.org/">https://mimesniff.spec.whatwg.org/</a>
    <dt id="biblio-navigation-timing-2">[NAVIGATION-TIMING-2]
    <dd>Yoav Weiss; Noam Rosenthal. <a href="https://www.w3.org/TR/navigation-timing-2/"><cite>Navigation Timing Level
          2</cite></a>. 10 March 2022. WD. URL: <a
        href="https://www.w3.org/TR/navigation-timing-2/">https://www.w3.org/TR/navigation-timing-2/</a>
    <dt id="biblio-page-visibility">[PAGE-VISIBILITY]
    <dd>Jatinder Mann; Arvind Jain. <a href="https://www.w3.org/TR/page-visibility/"><cite>Page Visibility (Second
          Edition)</cite></a>. 29 October 2013. REC. URL: <a
        href="https://www.w3.org/TR/page-visibility/">https://www.w3.org/TR/page-visibility/</a>
    <dt id="biblio-rfc2119">[RFC2119]
    <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate
          Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a
        href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
    <dt id="biblio-rfc5234">[RFC5234]
    <dd>D. Crocker, Ed.; P. Overell. <a href="https://www.rfc-editor.org/rfc/rfc5234"><cite>Augmented BNF for Syntax
          Specifications: ABNF</cite></a>. January 2008. Internet Standard. URL: <a
        href="https://www.rfc-editor.org/rfc/rfc5234">https://www.rfc-editor.org/rfc/rfc5234</a>
    <dt id="biblio-rfc7230">[RFC7230]
    <dd>R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://httpwg.org/specs/rfc7230.html"><cite>Hypertext Transfer
          Protocol (HTTP/1.1): Message Syntax and Routing</cite></a>. June 2014. Proposed Standard. URL: <a
        href="https://httpwg.org/specs/rfc7230.html">https://httpwg.org/specs/rfc7230.html</a>
    <dt id="biblio-rfc7231">[RFC7231]
    <dd>R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://httpwg.org/specs/rfc7231.html"><cite>Hypertext Transfer
          Protocol (HTTP/1.1): Semantics and Content</cite></a>. June 2014. Proposed Standard. URL: <a
        href="https://httpwg.org/specs/rfc7231.html">https://httpwg.org/specs/rfc7231.html</a>
    <dt id="biblio-secure-contexts">[SECURE-CONTEXTS]
    <dd>Mike West. <a href="https://www.w3.org/TR/secure-contexts/"><cite>Secure Contexts</cite></a>. 18 September 2021.
      CR. URL: <a href="https://www.w3.org/TR/secure-contexts/">https://www.w3.org/TR/secure-contexts/</a>
    <dt id="biblio-storage">[STORAGE]
    <dd>Anne van Kesteren. <a href="https://storage.spec.whatwg.org/"><cite>Storage Standard</cite></a>. Living
      Standard. URL: <a href="https://storage.spec.whatwg.org/">https://storage.spec.whatwg.org/</a>
    <dt id="biblio-streams">[STREAMS]
    <dd>Adam Rice; et al. <a href="https://streams.spec.whatwg.org/"><cite>Streams Standard</cite></a>. Living Standard.
      URL: <a href="https://streams.spec.whatwg.org/">https://streams.spec.whatwg.org/</a>
    <dt id="biblio-url">[URL]
    <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Living Standard. URL:
      <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
    <dt id="biblio-webidl">[WEBIDL]
    <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living
      Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a
      class="self-link" href="#informative"></a></h3>
  <dl>
    <dt id="biblio-unsanctioned-tracking">[UNSANCTIONED-TRACKING]
    <dd><a href="https://www.w3.org/2001/tag/doc/unsanctioned-tracking/"><cite>Unsanctioned Web Tracking</cite></a>. 17
      July 2015. Finding of the W3C TAG. URL: <a
        href="https://www.w3.org/2001/tag/doc/unsanctioned-tracking/">https://www.w3.org/2001/tag/doc/unsanctioned-tracking/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link"
      href="#idl-index"></a></h2>
  <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <a href="#serviceworker"><code><c- g>ServiceWorker</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget"><c- n>EventTarget</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="USVString" href="#dom-serviceworker-scripturl"><c- g>scriptURL</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-serviceworkerstate"><c- n>ServiceWorkerState</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorkerState" href="#dom-serviceworker-state"><c- g>state</c-></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-serviceworker-postmessage"><c- g>postMessage</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a> <a href="#dom-serviceworker-postmessage-message-transfer-message"><code><c- g>message</c-></code></a>, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object"><c- b>object</c-></a>> <a href="#dom-serviceworker-postmessage-message-transfer-transfer"><code><c- g>transfer</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-serviceworker-postmessage-message-options"><c- g>postMessage</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a> <a href="#dom-serviceworker-postmessage-message-options-message"><code><c- g>message</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/web-messaging.html#structuredserializeoptions"><c- n>StructuredSerializeOptions</c-></a> <a href="#dom-serviceworker-postmessage-message-options-options"><code><c- g>options</c-></code></a> = {});

  // event
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworker-onstatechange"><c- g>onstatechange</c-></a>;
};
<a data-link-type="idl-name" href="#serviceworker"><c- n>ServiceWorker</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/workers.html#abstractworker"><c- n>AbstractWorker</c-></a>;

<c- b>enum</c-> <a href="#enumdef-serviceworkerstate"><code><c- g>ServiceWorkerState</c-></code></a> {
  <a href="#dom-serviceworkerstate-parsed"><code><c- s>"parsed"</c-></code></a>,
  <a href="#dom-serviceworkerstate-installing"><code><c- s>"installing"</c-></code></a>,
  <a href="#dom-serviceworkerstate-installed"><code><c- s>"installed"</c-></code></a>,
  <a href="#dom-serviceworkerstate-activating"><code><c- s>"activating"</c-></code></a>,
  <a href="#dom-serviceworkerstate-activated"><code><c- s>"activated"</c-></code></a>,
  <a href="#dom-serviceworkerstate-redundant"><code><c- s>"redundant"</c-></code></a>
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <a href="#serviceworkerregistration"><code><c- g>ServiceWorkerRegistration</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget"><c- n>EventTarget</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworker"><c- n>ServiceWorker</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorker?" href="#dom-serviceworkerregistration-installing"><c- g>installing</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworker"><c- n>ServiceWorker</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorker?" href="#dom-serviceworkerregistration-waiting"><c- g>waiting</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworker"><c- n>ServiceWorker</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorker?" href="#dom-serviceworkerregistration-active"><c- g>active</c-></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#navigationpreloadmanager"><c- n>NavigationPreloadManager</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="NavigationPreloadManager" href="#dom-serviceworkerregistration-navigationpreload"><c- g>navigationPreload</c-></a>;

  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="USVString" href="#dom-serviceworkerregistration-scope"><c- g>scope</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-serviceworkerupdateviacache"><c- n>ServiceWorkerUpdateViaCache</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorkerUpdateViaCache" href="#dom-serviceworkerregistration-updateviacache"><c- g>updateViaCache</c-></a>;

  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-serviceworkerregistration-update"><c- g>update</c-></a>();
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-serviceworkerregistration-unregister"><c- g>unregister</c-></a>();

  // event
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkerregistration-onupdatefound"><c- g>onupdatefound</c-></a>;
};

<c- b>enum</c-> <a href="#enumdef-serviceworkerupdateviacache"><code><c- g>ServiceWorkerUpdateViaCache</c-></code></a> {
  <a href="#dom-serviceworkerupdateviacache-imports"><code><c- s>"imports"</c-></code></a>,
  <a href="#dom-serviceworkerupdateviacache-all"><code><c- s>"all"</c-></code></a>,
  <a href="#dom-serviceworkerupdateviacache-none"><code><c- s>"none"</c-></code></a>
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/system-state.html#navigator"><c- g>Navigator</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworkercontainer"><c- n>ServiceWorkerContainer</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorkerContainer" href="#navigator-service-worker-attribute"><c- g>serviceWorker</c-></a>;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workernavigator"><c- g>WorkerNavigator</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworkercontainer"><c- n>ServiceWorkerContainer</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorkerContainer" href="#navigator-service-worker-attribute"><c- g>serviceWorker</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <a href="#serviceworkercontainer"><code><c- g>ServiceWorkerContainer</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget"><c- n>EventTarget</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworker"><c- n>ServiceWorker</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorker?" href="#dom-serviceworkercontainer-controller"><c- g>controller</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#serviceworkerregistration"><c- n>ServiceWorkerRegistration</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Promise<ServiceWorkerRegistration>" href="#dom-serviceworkercontainer-ready"><c- g>ready</c-></a>;

  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#serviceworkerregistration"><c- n>ServiceWorkerRegistration</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-serviceworkercontainer-register"><c- g>register</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a href="#dom-serviceworkercontainer-register-scripturl-options-scripturl"><code><c- g>scriptURL</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-registrationoptions"><c- n>RegistrationOptions</c-></a> <a href="#dom-serviceworkercontainer-register-scripturl-options-options"><code><c- g>options</c-></code></a> = {});

  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;(<a data-link-type="idl-name" href="#serviceworkerregistration"><c- n>ServiceWorkerRegistration</c-></a> <c- b>or</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>)> <a class="idl-code" data-link-type="method" href="#dom-serviceworkercontainer-getregistration"><c- g>getRegistration</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a href="#dom-serviceworkercontainer-getregistration-clienturl-clienturl"><code><c- g>clientURL</c-></code></a> = "");
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="#serviceworkerregistration"><c- n>ServiceWorkerRegistration</c-></a>>> <a class="idl-code" data-link-type="method" href="#dom-serviceworkercontainer-getregistrations"><c- g>getRegistrations</c-></a>();

  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-serviceworkercontainer-startmessages"><c- g>startMessages</c-></a>();


  // events
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkercontainer-oncontrollerchange"><c- g>oncontrollerchange</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkercontainer-onmessage"><c- g>onmessage</c-></a>; // event.source of message events is ServiceWorker object
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkercontainer-onmessageerror"><c- g>onmessageerror</c-></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-registrationoptions"><code><c- g>RegistrationOptions</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-registrationoptions-scope"><code><c- g>scope</c-></code></a>;
  <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/workers.html#workertype"><c- n>WorkerType</c-></a> <a data-default="&quot;classic&quot;" data-type="WorkerType " href="#dom-registrationoptions-type"><code><c- g>type</c-></code></a> = "classic";
  <a data-link-type="idl-name" href="#enumdef-serviceworkerupdateviacache"><c- n>ServiceWorkerUpdateViaCache</c-></a> <a data-default="&quot;imports&quot;" data-type="ServiceWorkerUpdateViaCache " href="#dom-registrationoptions-updateviacache"><code><c- g>updateViaCache</c-></code></a> = "imports";
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <a href="#navigationpreloadmanager"><code><c- g>NavigationPreloadManager</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-navigationpreloadmanager-enable"><c- g>enable</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-navigationpreloadmanager-disable"><c- g>disable</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-navigationpreloadmanager-setheadervalue"><c- g>setHeaderValue</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-ByteString"><c- b>ByteString</c-></a> <a href="#dom-navigationpreloadmanager-setheadervalue-value-value"><code><c- g>value</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-navigationpreloadstate"><c- n>NavigationPreloadState</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-navigationpreloadmanager-getstate"><c- g>getState</c-></a>();
};

<c- b>dictionary</c-> <a href="#dictdef-navigationpreloadstate"><code><c- g>NavigationPreloadState</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-navigationpreloadstate-enabled"><code><c- g>enabled</c-></code></a> = <c- b>false</c->;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-ByteString"><c- b>ByteString</c-></a> <a data-type="ByteString " href="#dom-navigationpreloadstate-headervalue"><code><c- g>headerValue</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Global"><c- g>Global</c-></a>=(<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/workers.html#worker"><c- n>Worker</c-></a>,<a data-link-type="idl-name" href="#serviceworker"><c- n>ServiceWorker</c-></a>), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>ServiceWorker</c->]
<c- b>interface</c-> <a href="#serviceworkerglobalscope"><code><c- g>ServiceWorkerGlobalScope</c-></code></a> : <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope"><c- n>WorkerGlobalScope</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#clients"><c- n>Clients</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Clients" href="#dom-serviceworkerglobalscope-clients"><c- g>clients</c-></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworkerregistration"><c- n>ServiceWorkerRegistration</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorkerRegistration" href="#dom-serviceworkerglobalscope-registration"><c- g>registration</c-></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#serviceworker"><c- n>ServiceWorker</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ServiceWorker" href="#dom-serviceworkerglobalscope-serviceworker"><c- g>serviceWorker</c-></a>;

  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-serviceworkerglobalscope-skipwaiting"><c- g>skipWaiting</c-></a>();

  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkerglobalscope-oninstall"><c- g>oninstall</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkerglobalscope-onactivate"><c- g>onactivate</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkerglobalscope-onfetch"><c- g>onfetch</c-></a>;

  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkerglobalscope-onmessage"><c- g>onmessage</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-serviceworkerglobalscope-onmessageerror"><c- g>onmessageerror</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>ServiceWorker</c->]
<c- b>interface</c-> <a href="#client"><code><c- g>Client</c-></code></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="USVString" href="#dom-client-url"><c- g>url</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-frametype"><c- n>FrameType</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="FrameType" href="#dom-client-frametype"><c- g>frameType</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-client-id"><c- g>id</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-clienttype"><c- n>ClientType</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ClientType" href="#dom-client-type"><c- g>type</c-></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-client-postmessage"><c- g>postMessage</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a> <a href="#dom-client-postmessage-message-transfer-message"><code><c- g>message</c-></code></a>, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object"><c- b>object</c-></a>> <a href="#dom-client-postmessage-message-transfer-transfer"><code><c- g>transfer</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-client-postmessage-message-options"><c- g>postMessage</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a> <a href="#dom-client-postmessage-message-options-message"><code><c- g>message</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/web-messaging.html#structuredserializeoptions"><c- n>StructuredSerializeOptions</c-></a> <a href="#dom-client-postmessage-message-options-options"><code><c- g>options</c-></code></a> = {});
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>ServiceWorker</c->]
<c- b>interface</c-> <a href="#windowclient"><code><c- g>WindowClient</c-></code></a> : <a data-link-type="idl-name" href="#client"><c- n>Client</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://www.w3.org/TR/page-visibility/#VisibilityState"><c- n>VisibilityState</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="VisibilityState" href="#dom-windowclient-visibilitystate"><c- g>visibilityState</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="boolean" href="#dom-windowclient-focused"><c- g>focused</c-></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array"><c- b>FrozenArray</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="FrozenArray<USVString>" href="#dom-windowclient-ancestororigins"><c- g>ancestorOrigins</c-></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#windowclient"><c- n>WindowClient</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-windowclient-focus"><c- g>focus</c-></a>();
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#windowclient"><c- n>WindowClient</c-></a>?> <a class="idl-code" data-link-type="method" href="#dom-windowclient-navigate"><c- g>navigate</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a href="#dom-windowclient-navigate-url-url"><code><c- g>url</c-></code></a>);
};

<c- b>enum</c-> <a href="#enumdef-frametype"><code><c- g>FrameType</c-></code></a> {
  <a href="#dom-frametype-auxiliary"><code><c- s>"auxiliary"</c-></code></a>,
  <a href="#dom-frametype-top-level"><code><c- s>"top-level"</c-></code></a>,
  <a href="#dom-frametype-nested"><code><c- s>"nested"</c-></code></a>,
  <a href="#dom-frametype-none"><code><c- s>"none"</c-></code></a>
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>ServiceWorker</c->]
<c- b>interface</c-> <a href="#clients"><code><c- g>Clients</c-></code></a> {
  // The objects returned will be new instances every time
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;(<a data-link-type="idl-name" href="#client"><c- n>Client</c-></a> <c- b>or</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>)> <a class="idl-code" data-link-type="method" href="#dom-clients-get"><c- g>get</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-clients-get-id-id"><code><c- g>id</c-></code></a>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="#client"><c- n>Client</c-></a>>> <a class="idl-code" data-link-type="method" href="#dom-clients-matchall"><c- g>matchAll</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-clientqueryoptions"><c- n>ClientQueryOptions</c-></a> <a href="#dom-clients-matchall-options-options"><code><c- g>options</c-></code></a> = {});
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#windowclient"><c- n>WindowClient</c-></a>?> <a class="idl-code" data-link-type="method" href="#dom-clients-openwindow"><c- g>openWindow</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a href="#dom-clients-openwindow-url-url"><code><c- g>url</c-></code></a>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-clients-claim"><c- g>claim</c-></a>();
};

<c- b>dictionary</c-> <a href="#dictdef-clientqueryoptions"><code><c- g>ClientQueryOptions</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-clientqueryoptions-includeuncontrolled"><code><c- g>includeUncontrolled</c-></code></a> = <c- b>false</c->;
  <a data-link-type="idl-name" href="#enumdef-clienttype"><c- n>ClientType</c-></a> <a data-default="&quot;window&quot;" data-type="ClientType " href="#dom-clientqueryoptions-type"><code><c- g>type</c-></code></a> = "window";
};

<c- b>enum</c-> <a href="#enumdef-clienttype"><code><c- g>ClientType</c-></code></a> {
  <a href="#dom-clienttype-window"><code><c- s>"window"</c-></code></a>,
  <a href="#dom-clienttype-worker"><code><c- s>"worker"</c-></code></a>,
  <a href="#dom-clienttype-sharedworker"><code><c- s>"sharedworker"</c-></code></a>,
  <a href="#dom-clienttype-all"><code><c- s>"all"</c-></code></a>
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>ServiceWorker</c->]
<c- b>interface</c-> <a href="#extendableevent"><code><c- g>ExtendableEvent</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event"><c- n>Event</c-></a> {
  <a href="#dom-extendableevent-extendableevent"><code><c- g>constructor</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-extendableevent-extendableevent-type-eventinitdict-type"><code><c- g>type</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-extendableeventinit"><c- n>ExtendableEventInit</c-></a> <a href="#dom-extendableevent-extendableevent-type-eventinitdict-eventinitdict"><code><c- g>eventInitDict</c-></code></a> = {});
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-extendableevent-waituntil"><c- g>waitUntil</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a>> <a href="#dom-extendableevent-waituntil-f-f"><code><c- g>f</c-></code></a>);
};

<c- b>dictionary</c-> <a href="#dictdef-extendableeventinit"><code><c- g>ExtendableEventInit</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit"><c- n>EventInit</c-></a> {
  // Defined for the forward compatibility across the derived events
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>ServiceWorker</c->]
<c- b>interface</c-> <a href="#fetchevent"><code><c- g>FetchEvent</c-></code></a> : <a data-link-type="idl-name" href="#extendableevent"><c- n>ExtendableEvent</c-></a> {
  <a href="#dom-fetchevent-fetchevent"><code><c- g>constructor</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-fetchevent-fetchevent-type-eventinitdict-type"><code><c- g>type</c-></code></a>, <a data-link-type="idl-name" href="#dictdef-fetcheventinit"><c- n>FetchEventInit</c-></a> <a href="#dom-fetchevent-fetchevent-type-eventinitdict-eventinitdict"><code><c- g>eventInitDict</c-></code></a>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#request"><c- n>Request</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Request" href="#dom-fetchevent-request"><c- g>request</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Promise<any>" href="#dom-fetchevent-preloadresponse"><c- g>preloadResponse</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-fetchevent-clientid"><c- g>clientId</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-fetchevent-resultingclientid"><c- g>resultingClientId</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-fetchevent-replacesclientid"><c- g>replacesClientId</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Promise<undefined>" href="#dom-fetchevent-handled"><c- g>handled</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-fetchevent-respondwith"><c- g>respondWith</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#response"><c- n>Response</c-></a>> <a href="#dom-fetchevent-respondwith-r-r"><code><c- g>r</c-></code></a>);
};

<c- b>dictionary</c-> <a href="#dictdef-fetcheventinit"><code><c- g>FetchEventInit</c-></code></a> : <a data-link-type="idl-name" href="#dictdef-extendableeventinit"><c- n>ExtendableEventInit</c-></a> {
  <c- b>required</c-> <a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#request"><c- n>Request</c-></a> <a data-type="Request " href="#dom-fetcheventinit-request"><code><c- g>request</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a>> <a data-type="Promise<any> " href="#dom-fetcheventinit-preloadresponse"><code><c- g>preloadResponse</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-default="&quot;&quot;" data-type="DOMString " href="#dom-fetcheventinit-clientid"><code><c- g>clientId</c-></code></a> = "";
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-default="&quot;&quot;" data-type="DOMString " href="#dom-fetcheventinit-resultingclientid"><code><c- g>resultingClientId</c-></code></a> = "";
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-default="&quot;&quot;" data-type="DOMString " href="#dom-fetcheventinit-replacesclientid"><code><c- g>replacesClientId</c-></code></a> = "";
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a data-type="Promise<undefined> " href="#dom-fetcheventinit-handled"><code><c- g>handled</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>ServiceWorker</c->]
<c- b>interface</c-> <a href="#extendablemessageevent"><code><c- g>ExtendableMessageEvent</c-></code></a> : <a data-link-type="idl-name" href="#extendableevent"><c- n>ExtendableEvent</c-></a> {
  <a href="#dom-extendablemessageevent-extendablemessageevent"><code><c- g>constructor</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-extendablemessageevent-extendablemessageevent-type-eventinitdict-type"><code><c- g>type</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-extendablemessageeventinit"><c- n>ExtendableMessageEventInit</c-></a> <a href="#dom-extendablemessageevent-extendablemessageevent-type-eventinitdict-eventinitdict"><code><c- g>eventInitDict</c-></code></a> = {});
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="any" href="#dom-extendablemessageevent-data"><c- g>data</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="USVString" href="#dom-extendablemessageevent-origin"><c- g>origin</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-extendablemessageevent-lasteventid"><c- g>lastEventId</c-></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> (<a data-link-type="idl-name" href="#client"><c- n>Client</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#serviceworker"><c- n>ServiceWorker</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport"><c- n>MessagePort</c-></a>)? <a class="idl-code" data-link-type="attribute" data-readonly data-type="(Client or ServiceWorker or MessagePort)?" href="#dom-extendablemessageevent-source"><c- g>source</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport"><c- n>MessagePort</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="FrozenArray<MessagePort>" href="#dom-extendablemessageevent-ports"><c- g>ports</c-></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-extendablemessageeventinit"><code><c- g>ExtendableMessageEventInit</c-></code></a> : <a data-link-type="idl-name" href="#dictdef-extendableeventinit"><c- n>ExtendableEventInit</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a> <a data-default="null" data-type="any " href="#dom-extendablemessageeventinit-data"><code><c- g>data</c-></code></a> = <c- b>null</c->;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-default="&quot;&quot;" data-type="USVString " href="#dom-extendablemessageeventinit-origin"><code><c- g>origin</c-></code></a> = "";
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-default="&quot;&quot;" data-type="DOMString " href="#dom-extendablemessageeventinit-lasteventid"><code><c- g>lastEventId</c-></code></a> = "";
  (<a data-link-type="idl-name" href="#client"><c- n>Client</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#serviceworker"><c- n>ServiceWorker</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport"><c- n>MessagePort</c-></a>)? <a data-default="null" data-type="(Client or ServiceWorker or MessagePort)? " href="#dom-extendablemessageeventinit-source"><code><c- g>source</c-></code></a> = <c- b>null</c->;
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport"><c- n>MessagePort</c-></a>> <a data-default="[]" data-type="sequence<MessagePort> " href="#dom-extendablemessageeventinit-ports"><code><c- g>ports</c-></code></a> = [];
};

<c- b>partial</c-> <c- b>interface</c-> <c- b>mixin</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope"><c- g>WindowOrWorkerGlobalScope</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#cachestorage"><c- n>CacheStorage</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="CacheStorage" href="#global-caches-attribute"><c- g>caches</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <a href="#cache"><code><c- g>Cache</c-></code></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#response"><c- n>Response</c-></a> <c- b>or</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>)> <a class="idl-code" data-link-type="method" href="#dom-cache-match"><c- g>match</c-></a>(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo"><c- n>RequestInfo</c-></a> <a href="#dom-cache-match-request-options-request"><code><c- g>request</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-cachequeryoptions"><c- n>CacheQueryOptions</c-></a> <a href="#dom-cache-match-request-options-options"><code><c- g>options</c-></code></a> = {});
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#response"><c- n>Response</c-></a>>> <a class="idl-code" data-link-type="method" href="#dom-cache-matchall"><c- g>matchAll</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo"><c- n>RequestInfo</c-></a> <a href="#dom-cache-matchall-request-options-request"><code><c- g>request</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-cachequeryoptions"><c- n>CacheQueryOptions</c-></a> <a href="#dom-cache-matchall-request-options-options"><code><c- g>options</c-></code></a> = {});
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-cache-add"><c- g>add</c-></a>(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo"><c- n>RequestInfo</c-></a> <a href="#dom-cache-add-request-request"><code><c- g>request</c-></code></a>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-cache-addall"><c- g>addAll</c-></a>(<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo"><c- n>RequestInfo</c-></a>> <a href="#dom-cache-addall-requests-requests"><code><c- g>requests</c-></code></a>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-cache-put"><c- g>put</c-></a>(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo"><c- n>RequestInfo</c-></a> <a href="#dom-cache-put-request-response-request"><code><c- g>request</c-></code></a>, <a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#response"><c- n>Response</c-></a> <a href="#dom-cache-put-request-response-response"><code><c- g>response</c-></code></a>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-cache-delete"><c- g>delete</c-></a>(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo"><c- n>RequestInfo</c-></a> <a href="#dom-cache-delete-request-options-request"><code><c- g>request</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-cachequeryoptions"><c- n>CacheQueryOptions</c-></a> <a href="#dom-cache-delete-request-options-options"><code><c- g>options</c-></code></a> = {});
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#request"><c- n>Request</c-></a>>> <a class="idl-code" data-link-type="method" href="#dom-cache-keys"><c- g>keys</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo"><c- n>RequestInfo</c-></a> <a href="#dom-cache-keys-request-options-request"><code><c- g>request</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-cachequeryoptions"><c- n>CacheQueryOptions</c-></a> <a href="#dom-cache-keys-request-options-options"><code><c- g>options</c-></code></a> = {});
};

<c- b>dictionary</c-> <a href="#dictdef-cachequeryoptions"><code><c- g>CacheQueryOptions</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-cachequeryoptions-ignoresearch"><code><c- g>ignoreSearch</c-></code></a> = <c- b>false</c->;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-cachequeryoptions-ignoremethod"><code><c- g>ignoreMethod</c-></code></a> = <c- b>false</c->;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-cachequeryoptions-ignorevary"><code><c- g>ignoreVary</c-></code></a> = <c- b>false</c->;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <a href="#cachestorage"><code><c- g>CacheStorage</c-></code></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#response"><c- n>Response</c-></a> <c- b>or</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>)> <a class="idl-code" data-link-type="method" href="#dom-cachestorage-match"><c- g>match</c-></a>(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestinfo"><c- n>RequestInfo</c-></a> <a href="#dom-cachestorage-match-request-options-request"><code><c- g>request</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-multicachequeryoptions"><c- n>MultiCacheQueryOptions</c-></a> <a href="#dom-cachestorage-match-request-options-options"><code><c- g>options</c-></code></a> = {});
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-cachestorage-has"><c- g>has</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-cachestorage-has-cachename-cachename"><code><c- g>cacheName</c-></code></a>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#cache"><c- n>Cache</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-cachestorage-open"><c- g>open</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-cachestorage-open-cachename-cachename"><code><c- g>cacheName</c-></code></a>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-cachestorage-delete"><c- g>delete</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-cachestorage-delete-cachename-cachename"><code><c- g>cacheName</c-></code></a>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#NewObject"><c- g>NewObject</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>>> <a class="idl-code" data-link-type="method" href="#dom-cachestorage-keys"><c- g>keys</c-></a>();
};

<c- b>dictionary</c-> <a href="#dictdef-multicachequeryoptions"><code><c- g>MultiCacheQueryOptions</c-></code></a> : <a data-link-type="idl-name" href="#dictdef-cachequeryoptions"><c- n>CacheQueryOptions</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-multicachequeryoptions-cachename"><code><c- g>cacheName</c-></code></a>;
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a
      class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
    <div class="issue"> The behavior in this section is not fully specified yet and will be specified in <a
        href="https://html.spec.whatwg.org">HTML Standard</a>. The work is tracked by the <a
        href="https://github.com/w3c/ServiceWorker/issues/765">issue</a> and the <a
        href="https://github.com/whatwg/html/pull/2809">pull request</a>. <a class="issue-return" href="#issue-f6a7ea80"
        title="Jump to section">↵</a></div>
    <div class="issue"> Using the to-be-created <a data-link-type="dfn"
        href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">environment settings
        object</a> rather than a concrete <a data-link-type="dfn"
        href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">environment settings
        object</a>. This is used due to the unique processing model of service workers compared to the processing model
      of other <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#workers">web
        workers</a>. The script fetching algorithms of HTML standard originally designed for other <a
        data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#workers">web workers</a> require
      an <a data-link-type="dfn"
        href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">environment settings
        object</a> of the execution environment, but service workers fetch a script separately in the <a
        data-link-type="dfn" href="#update">Update</a> algorithm before the script later runs multiple times through the
      <a data-link-type="dfn" href="#run-service-worker">Run Service Worker</a> algorithm. <a class="issue-return"
        href="#issue-02e2fe82" title="Jump to section">↵</a>
    </div>
    <div class="issue"> The <a data-link-type="dfn"
        href="https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-classic-worker-script">fetch a classic
        worker script</a> algorithm and the <a data-link-type="dfn"
        href="https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-module-worker-script-tree">fetch a module
        worker script graph</a> algorithm in HTML take <var>job</var>’s <a data-link-type="dfn"
        href="#dfn-job-client">client</a> as an argument. <var>job</var>’s <a data-link-type="dfn"
        href="#dfn-job-client">client</a> is null when passed from the <a data-link-type="dfn" href="#soft-update">Soft
        Update</a> algorithm. <a class="issue-return" href="#issue-9d9e65b5" title="Jump to section">↵</a></div>
  </div>
  <aside class="dfn-panel" data-for="dfn-service-worker">
    <b><a href="#dfn-service-worker">#dfn-service-worker</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-service-worker">1. Motivations</a> <a href="#ref-for-dfn-service-worker①">(2)</a> <a
          href="#ref-for-dfn-service-worker②">(3)</a> <a href="#ref-for-dfn-service-worker③">(4)</a> <a
          href="#ref-for-dfn-service-worker④">(5)</a> <a href="#ref-for-dfn-service-worker⑤">(6)</a> <a
          href="#ref-for-dfn-service-worker⑥">(7)</a> <a href="#ref-for-dfn-service-worker⑦">(8)</a> <a
          href="#ref-for-dfn-service-worker⑧">(9)</a> <a href="#ref-for-dfn-service-worker⑨">(10)</a> <a
          href="#ref-for-dfn-service-worker①⓪">(11)</a> <a href="#ref-for-dfn-service-worker①①">(12)</a> <a
          href="#ref-for-dfn-service-worker①②">(13)</a> <a href="#ref-for-dfn-service-worker①③">(14)</a>
      <li><a href="#ref-for-dfn-service-worker①④">2.1. Service Worker</a> <a
          href="#ref-for-dfn-service-worker①⑤">(2)</a> <a href="#ref-for-dfn-service-worker①⑥">(3)</a> <a
          href="#ref-for-dfn-service-worker①⑦">(4)</a> <a href="#ref-for-dfn-service-worker①⑧">(5)</a> <a
          href="#ref-for-dfn-service-worker①⑨">(6)</a> <a href="#ref-for-dfn-service-worker②⓪">(7)</a> <a
          href="#ref-for-dfn-service-worker②①">(8)</a> <a href="#ref-for-dfn-service-worker②②">(9)</a> <a
          href="#ref-for-dfn-service-worker②③">(10)</a> <a href="#ref-for-dfn-service-worker②④">(11)</a> <a
          href="#ref-for-dfn-service-worker②⑤">(12)</a> <a href="#ref-for-dfn-service-worker②⑥">(13)</a> <a
          href="#ref-for-dfn-service-worker②⑦">(14)</a> <a href="#ref-for-dfn-service-worker②⑧">(15)</a>
      <li><a href="#ref-for-dfn-service-worker②⑨">2.1.1. Lifetime</a> <a href="#ref-for-dfn-service-worker③⓪">(2)</a>
      <li><a href="#ref-for-dfn-service-worker③①">2.3. Service Worker Registration</a> <a
          href="#ref-for-dfn-service-worker③②">(2)</a> <a href="#ref-for-dfn-service-worker③③">(3)</a> <a
          href="#ref-for-dfn-service-worker③④">(4)</a>
      <li><a href="#ref-for-dfn-service-worker③⑤">2.5. Control and Use</a> <a
          href="#ref-for-dfn-service-worker③⑥">(2)</a>
      <li><a href="#ref-for-dfn-service-worker③⑦">2.6. Task Sources</a> <a href="#ref-for-dfn-service-worker③⑧">(2)</a>
        <a href="#ref-for-dfn-service-worker③⑨">(3)</a>
      <li><a href="#ref-for-dfn-service-worker④⓪">2.7. User Agent Shutdown</a>
      <li><a href="#ref-for-dfn-service-worker④①">3.1. ServiceWorker</a> <a href="#ref-for-dfn-service-worker④②">(2)</a>
        <a href="#ref-for-dfn-service-worker④③">(3)</a> <a href="#ref-for-dfn-service-worker④④">(4)</a>
      <li><a href="#ref-for-dfn-service-worker④⑤">3.1.1. Getting ServiceWorker instances</a> <a
          href="#ref-for-dfn-service-worker④⑥">(2)</a>
      <li><a href="#ref-for-dfn-service-worker④⑦">3.1.2. scriptURL</a>
      <li><a href="#ref-for-dfn-service-worker④⑧">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-dfn-service-worker④⑨">3.2.2. installing</a>
      <li><a href="#ref-for-dfn-service-worker⑤⓪">3.2.3. waiting</a>
      <li><a href="#ref-for-dfn-service-worker⑤①">3.2.4. active</a>
      <li><a href="#ref-for-dfn-service-worker⑤②">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-dfn-service-worker⑤③">3.5. Events</a> <a href="#ref-for-dfn-service-worker⑤④">(2)</a> <a
          href="#ref-for-dfn-service-worker⑤⑤">(3)</a> <a href="#ref-for-dfn-service-worker⑤⑥">(4)</a>
      <li><a href="#ref-for-dfn-service-worker⑤⑦">4.1. ServiceWorkerGlobalScope</a> <a
          href="#ref-for-dfn-service-worker⑤⑧">(2)</a> <a href="#ref-for-dfn-service-worker⑤⑨">(3)</a> <a
          href="#ref-for-dfn-service-worker⑥⓪">(4)</a>
      <li><a href="#ref-for-dfn-service-worker⑥①">4.1.4. skipWaiting()</a>
      <li><a href="#ref-for-dfn-service-worker⑥②">4.4. ExtendableEvent</a> <a
          href="#ref-for-dfn-service-worker⑥③">(2)</a> <a href="#ref-for-dfn-service-worker⑥④">(3)</a> <a
          href="#ref-for-dfn-service-worker⑥⑤">(4)</a> <a href="#ref-for-dfn-service-worker⑥⑥">(5)</a> <a
          href="#ref-for-dfn-service-worker⑥⑦">(6)</a> <a href="#ref-for-dfn-service-worker⑥⑧">(7)</a> <a
          href="#ref-for-dfn-service-worker⑥⑨">(8)</a> <a href="#ref-for-dfn-service-worker⑦⓪">(9)</a>
      <li><a href="#ref-for-dfn-service-worker⑦①">4.5. FetchEvent</a> <a href="#ref-for-dfn-service-worker⑦②">(2)</a>
      <li><a href="#ref-for-dfn-service-worker⑦③">4.6. ExtendableMessageEvent</a> <a
          href="#ref-for-dfn-service-worker⑦④">(2)</a>
      <li><a href="#ref-for-dfn-service-worker⑦⑤">5.2. Understanding Cache Lifetimes</a> <a
          href="#ref-for-dfn-service-worker⑦⑥">(2)</a>
      <li><a href="#ref-for-dfn-service-worker⑦⑦">6.1. Secure Context</a> <a
          href="#ref-for-dfn-service-worker⑦⑧">(2)</a> <a href="#ref-for-dfn-service-worker⑦⑨">(3)</a> <a
          href="#ref-for-dfn-service-worker⑧⓪">(4)</a> <a href="#ref-for-dfn-service-worker⑧①">(5)</a>
      <li><a href="#ref-for-dfn-service-worker⑧②">6.2. Content Security Policy</a>
      <li><a href="#ref-for-dfn-service-worker⑧③">6.3.1. Origin restriction</a> <a
          href="#ref-for-dfn-service-worker⑧④">(2)</a> <a href="#ref-for-dfn-service-worker⑧⑤">(3)</a>
      <li><a href="#ref-for-dfn-service-worker⑧⑥">6.4. Cross-Origin Resources and CORS</a>
      <li><a href="#ref-for-dfn-service-worker⑧⑦">6.7. Implementer Concerns</a> <a
          href="#ref-for-dfn-service-worker⑧⑧">(2)</a> <a href="#ref-for-dfn-service-worker⑧⑨">(3)</a>
      <li><a href="#ref-for-dfn-service-worker⑨⓪">6.8. Privacy</a> <a href="#ref-for-dfn-service-worker⑨①">(2)</a>
      <li><a href="#ref-for-dfn-service-worker⑨②">Start Register</a>
      <li><a href="#ref-for-dfn-service-worker⑨③">Update</a>
      <li><a href="#ref-for-dfn-service-worker⑨④">Install</a>
      <li><a href="#ref-for-dfn-service-worker⑨⑤">Run Service Worker</a>
      <li><a href="#ref-for-dfn-service-worker⑨⑥">Terminate Service Worker</a>
      <li><a href="#ref-for-dfn-service-worker⑨⑦">Handle Fetch</a>
      <li><a href="#ref-for-dfn-service-worker⑨⑧">Should Skip Event</a>
      <li><a href="#ref-for-dfn-service-worker⑨⑨">Update Service Worker Extended Events Set</a>
      <li><a href="#ref-for-dfn-service-worker①⓪⓪">Update Registration State</a>
      <li><a href="#ref-for-dfn-service-worker①⓪①">Update Worker State</a> <a
          href="#ref-for-dfn-service-worker①⓪②">(2)</a> <a href="#ref-for-dfn-service-worker①⓪③">(3)</a>
      <li><a href="#ref-for-dfn-service-worker①⓪④">Get Newest Worker</a>
      <li><a href="#ref-for-dfn-service-worker①⓪⑤">Service Worker Has No Pending Events</a>
      <li><a href="#ref-for-dfn-service-worker①⓪⑥">Service Worker Script Request</a> <a
          href="#ref-for-dfn-service-worker①⓪⑦">(2)</a>
      <li><a href="#ref-for-dfn-service-worker①⓪⑧">Service Worker Script Response</a>
      <li><a href="#ref-for-dfn-service-worker①⓪⑨">Syntax</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-state">
    <b><a href="#dfn-state">#dfn-state</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-state">2.3. Service Worker Registration</a> <a href="#ref-for-dfn-state①">(2)</a> <a
          href="#ref-for-dfn-state②">(3)</a>
      <li><a href="#ref-for-dfn-state③">3.1.1. Getting ServiceWorker instances</a>
      <li><a href="#ref-for-dfn-state④">Update Worker State</a> <a href="#ref-for-dfn-state⑤">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-script-url">
    <b><a href="#dfn-script-url">#dfn-script-url</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-script-url">3.1.2. scriptURL</a>
      <li><a href="#ref-for-dfn-script-url①">3.2.8. update()</a>
      <li><a href="#ref-for-dfn-script-url②">Register</a>
      <li><a href="#ref-for-dfn-script-url③">Update</a> <a href="#ref-for-dfn-script-url④">(2)</a> <a
          href="#ref-for-dfn-script-url⑤">(3)</a>
      <li><a href="#ref-for-dfn-script-url⑥">Soft Update</a>
      <li><a href="#ref-for-dfn-script-url⑦">Run Service Worker</a> <a href="#ref-for-dfn-script-url⑧">(2)</a> <a
          href="#ref-for-dfn-script-url⑨">(3)</a>
      <li><a href="#ref-for-dfn-script-url①⓪">Update Worker State</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-type">
    <b><a href="#dfn-type">#dfn-type</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-type">3.2.8. update()</a>
      <li><a href="#ref-for-dfn-type①">Register</a>
      <li><a href="#ref-for-dfn-type②">Update</a> <a href="#ref-for-dfn-type③">(2)</a>
      <li><a href="#ref-for-dfn-type④">Soft Update</a>
      <li><a href="#ref-for-dfn-type⑤">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-containing-service-worker-registration">
    <b><a
        href="#dfn-containing-service-worker-registration">#dfn-containing-service-worker-registration</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-containing-service-worker-registration">2.5. Control and Use</a>
      <li><a href="#ref-for-dfn-containing-service-worker-registration①">3.2.9. unregister()</a>
      <li><a href="#ref-for-dfn-containing-service-worker-registration②">4.1.2. registration</a>
      <li><a href="#ref-for-dfn-containing-service-worker-registration③">4.1.4. skipWaiting()</a> <a
          href="#ref-for-dfn-containing-service-worker-registration④">(2)</a> <a
          href="#ref-for-dfn-containing-service-worker-registration⑤">(3)</a>
      <li><a href="#ref-for-dfn-containing-service-worker-registration⑥">4.3.1. get(id)</a>
      <li><a href="#ref-for-dfn-containing-service-worker-registration⑦">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-dfn-containing-service-worker-registration⑧">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-dfn-containing-service-worker-registration⑨">4.3.4. claim()</a> <a
          href="#ref-for-dfn-containing-service-worker-registration①⓪">(2)</a> <a
          href="#ref-for-dfn-containing-service-worker-registration①①">(3)</a>
      <li><a href="#ref-for-dfn-containing-service-worker-registration①②">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-dfn-containing-service-worker-registration①③">4.7. Events</a> <a
          href="#ref-for-dfn-containing-service-worker-registration①④">(2)</a>
      <li><a href="#ref-for-dfn-containing-service-worker-registration①⑤">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-dfn-containing-service-worker-registration①⑥">Run Service Worker</a>
      <li><a href="#ref-for-dfn-containing-service-worker-registration①⑦">Terminate Service Worker</a>
      <li><a href="#ref-for-dfn-containing-service-worker-registration①⑧">Handle Fetch</a> <a
          href="#ref-for-dfn-containing-service-worker-registration①⑨">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-service-worker-global-object">
    <b><a href="#dfn-service-worker-global-object">#dfn-service-worker-global-object</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-service-worker-global-object">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-dfn-service-worker-global-object①">Install</a>
      <li><a href="#ref-for-dfn-service-worker-global-object②">Activate</a>
      <li><a href="#ref-for-dfn-service-worker-global-object③">Run Service Worker</a>
      <li><a href="#ref-for-dfn-service-worker-global-object④">Terminate Service Worker</a>
      <li><a href="#ref-for-dfn-service-worker-global-object⑤">Handle Fetch</a> <a
          href="#ref-for-dfn-service-worker-global-object⑥">(2)</a> <a
          href="#ref-for-dfn-service-worker-global-object⑦">(3)</a>
      <li><a href="#ref-for-dfn-service-worker-global-object⑧">Fire Functional Event</a> <a
          href="#ref-for-dfn-service-worker-global-object⑨">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-script-resource">
    <b><a href="#dfn-script-resource">#dfn-script-resource</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-script-resource">2.1. Service Worker</a> <a href="#ref-for-dfn-script-resource①">(2)</a>
      <li><a href="#ref-for-dfn-script-resource②">6.2. Content Security Policy</a> <a
          href="#ref-for-dfn-script-resource③">(2)</a>
      <li><a href="#ref-for-dfn-script-resource④">Update</a> <a href="#ref-for-dfn-script-resource⑤">(2)</a>
      <li><a href="#ref-for-dfn-script-resource⑥">Run Service Worker</a> <a href="#ref-for-dfn-script-resource⑦">(2)</a>
      <li><a href="#ref-for-dfn-script-resource⑧">Service Worker Script Request</a> <a
          href="#ref-for-dfn-script-resource⑨">(2)</a>
      <li><a href="#ref-for-dfn-script-resource①⓪">Service Worker Script Response</a>
      <li><a href="#ref-for-dfn-script-resource①①">Syntax</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-has-ever-been-evaluated-flag">
    <b><a href="#dfn-has-ever-been-evaluated-flag">#dfn-has-ever-been-evaluated-flag</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-has-ever-been-evaluated-flag">Run Service Worker</a> <a
          href="#ref-for-dfn-has-ever-been-evaluated-flag①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-policy-container">
    <b><a href="#dfn-policy-container">#dfn-policy-container</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-policy-container">Update</a>
      <li><a href="#ref-for-dfn-policy-container①">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-script-resource-map">
    <b><a href="#dfn-script-resource-map">#dfn-script-resource-map</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-script-resource-map">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-dfn-script-resource-map①">6.8. Privacy</a>
      <li><a href="#ref-for-dfn-script-resource-map②">Update</a> <a href="#ref-for-dfn-script-resource-map③">(2)</a> <a
          href="#ref-for-dfn-script-resource-map④">(3)</a>
      <li><a href="#ref-for-dfn-script-resource-map⑤">Install</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-set-of-used-scripts">
    <b><a href="#dfn-set-of-used-scripts">#dfn-set-of-used-scripts</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-set-of-used-scripts">2.1. Service Worker</a>
      <li><a href="#ref-for-dfn-set-of-used-scripts①">6.3.2. importScripts(urls)</a> <a
          href="#ref-for-dfn-set-of-used-scripts②">(2)</a>
      <li><a href="#ref-for-dfn-set-of-used-scripts③">Update</a>
      <li><a href="#ref-for-dfn-set-of-used-scripts④">Install</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-skip-waiting-flag">
    <b><a href="#dfn-skip-waiting-flag">#dfn-skip-waiting-flag</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-skip-waiting-flag">3.5. Events</a>
      <li><a href="#ref-for-dfn-skip-waiting-flag①">4.1.4. skipWaiting()</a>
      <li><a href="#ref-for-dfn-skip-waiting-flag②">Try Activate</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-classic-scripts-imported-flag">
    <b><a href="#dfn-classic-scripts-imported-flag">#dfn-classic-scripts-imported-flag</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-classic-scripts-imported-flag">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-dfn-classic-scripts-imported-flag①">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-set-of-event-types-to-handle">
    <b><a href="#dfn-set-of-event-types-to-handle">#dfn-set-of-event-types-to-handle</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-set-of-event-types-to-handle">Run Service Worker</a>
      <li><a href="#ref-for-dfn-set-of-event-types-to-handle①">Handle Fetch</a> <a
          href="#ref-for-dfn-set-of-event-types-to-handle②">(2)</a>
      <li><a href="#ref-for-dfn-set-of-event-types-to-handle③">Should Skip Event</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-set-of-extended-events">
    <b><a href="#dfn-set-of-extended-events">#dfn-set-of-extended-events</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-set-of-extended-events">Terminate Service Worker</a>
      <li><a href="#ref-for-dfn-set-of-extended-events①">Update Service Worker Extended Events Set</a> <a
          href="#ref-for-dfn-set-of-extended-events②">(2)</a> <a href="#ref-for-dfn-set-of-extended-events③">(3)</a>
      <li><a href="#ref-for-dfn-set-of-extended-events④">Service Worker Has No Pending Events</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-start-status">
    <b><a href="#service-worker-start-status">#service-worker-start-status</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-start-status">Run Service Worker</a> <a
          href="#ref-for-service-worker-start-status①">(2)</a> <a href="#ref-for-service-worker-start-status②">(3)</a>
        <a href="#ref-for-service-worker-start-status③">(4)</a>
      <li><a href="#ref-for-service-worker-start-status④">Terminate Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-running">
    <b><a href="#service-worker-running">#service-worker-running</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-running">Run Service Worker</a> <a
          href="#ref-for-service-worker-running①">(2)</a> <a href="#ref-for-service-worker-running②">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-service-worker-events">
    <b><a href="#dfn-service-worker-events">#dfn-service-worker-events</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-service-worker-events">4.7. Events</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-lifecycle-events">
    <b><a href="#dfn-lifecycle-events">#dfn-lifecycle-events</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-lifecycle-events">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-dfn-lifecycle-events①">4.7. Events</a> <a href="#ref-for-dfn-lifecycle-events②">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-functional-events">
    <b><a href="#dfn-functional-events">#dfn-functional-events</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-functional-events">2.6. Task Sources</a>
      <li><a href="#ref-for-dfn-functional-events①">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-dfn-functional-events②">4.5. FetchEvent</a>
      <li><a href="#ref-for-dfn-functional-events③">4.7. Events</a> <a href="#ref-for-dfn-functional-events④">(2)</a> <a
          href="#ref-for-dfn-functional-events⑤">(3)</a> <a href="#ref-for-dfn-functional-events⑥">(4)</a> <a
          href="#ref-for-dfn-functional-events⑦">(5)</a> <a href="#ref-for-dfn-functional-events⑧">(6)</a> <a
          href="#ref-for-dfn-functional-events⑨">(7)</a>
      <li><a href="#ref-for-dfn-functional-events①⓪">7.2. Define Functional Event</a>
      <li><a href="#ref-for-dfn-functional-events①①">7.3. Define Event Handler</a>
      <li><a href="#ref-for-dfn-functional-events①②">7.4. Firing Functional Events</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-timing-info">
    <b><a href="#service-worker-timing-info">#service-worker-timing-info</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-timing-info">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-timing-info-start-time">
    <b><a href="#service-worker-timing-info-start-time">#service-worker-timing-info-start-time</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-timing-info-start-time">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-timing-info-fetch-event-dispatch-time">
    <b><a
        href="#service-worker-timing-info-fetch-event-dispatch-time">#service-worker-timing-info-fetch-event-dispatch-time</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-timing-info-fetch-event-dispatch-time">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-service-worker-registration">
    <b><a href="#dfn-service-worker-registration">#dfn-service-worker-registration</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-service-worker-registration">2.1. Service Worker</a>
      <li><a href="#ref-for-dfn-service-worker-registration①">2.3. Service Worker Registration</a> <a
          href="#ref-for-dfn-service-worker-registration②">(2)</a> <a
          href="#ref-for-dfn-service-worker-registration③">(3)</a> <a
          href="#ref-for-dfn-service-worker-registration④">(4)</a> <a
          href="#ref-for-dfn-service-worker-registration⑤">(5)</a> <a
          href="#ref-for-dfn-service-worker-registration⑥">(6)</a> <a
          href="#ref-for-dfn-service-worker-registration⑦">(7)</a> <a
          href="#ref-for-dfn-service-worker-registration⑧">(8)</a> <a
          href="#ref-for-dfn-service-worker-registration⑨">(9)</a> <a
          href="#ref-for-dfn-service-worker-registration①⓪">(10)</a> <a
          href="#ref-for-dfn-service-worker-registration①①">(11)</a> <a
          href="#ref-for-dfn-service-worker-registration①②">(12)</a> <a
          href="#ref-for-dfn-service-worker-registration①③">(13)</a> <a
          href="#ref-for-dfn-service-worker-registration①④">(14)</a> <a
          href="#ref-for-dfn-service-worker-registration①⑤">(15)</a> <a
          href="#ref-for-dfn-service-worker-registration①⑥">(16)</a> <a
          href="#ref-for-dfn-service-worker-registration①⑦">(17)</a> <a
          href="#ref-for-dfn-service-worker-registration①⑧">(18)</a> <a
          href="#ref-for-dfn-service-worker-registration①⑨">(19)</a> <a
          href="#ref-for-dfn-service-worker-registration②⓪">(20)</a>
      <li><a href="#ref-for-dfn-service-worker-registration②①">2.3.1. Lifetime</a> <a
          href="#ref-for-dfn-service-worker-registration②②">(2)</a> <a
          href="#ref-for-dfn-service-worker-registration②③">(3)</a> <a
          href="#ref-for-dfn-service-worker-registration②④">(4)</a>
      <li><a href="#ref-for-dfn-service-worker-registration②⑤">2.7. User Agent Shutdown</a> <a
          href="#ref-for-dfn-service-worker-registration②⑥">(2)</a> <a
          href="#ref-for-dfn-service-worker-registration②⑦">(3)</a>
      <li><a href="#ref-for-dfn-service-worker-registration②⑧">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-dfn-service-worker-registration②⑨">3.2.1. Getting ServiceWorkerRegistration instances</a> <a
          href="#ref-for-dfn-service-worker-registration③⓪">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-registration③①">3.2.9. unregister()</a> <a
          href="#ref-for-dfn-service-worker-registration③②">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-registration③③">3.4. ServiceWorkerContainer</a> <a
          href="#ref-for-dfn-service-worker-registration③④">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-registration③⑤">3.4.2. ready</a>
      <li><a href="#ref-for-dfn-service-worker-registration③⑥">3.4.3. register(scriptURL, options)</a> <a
          href="#ref-for-dfn-service-worker-registration③⑦">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-registration③⑧">3.5. Events</a> <a
          href="#ref-for-dfn-service-worker-registration③⑨">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-registration④⓪">3.6.1. enable()</a>
      <li><a href="#ref-for-dfn-service-worker-registration④①">3.6.2. disable()</a>
      <li><a href="#ref-for-dfn-service-worker-registration④②">3.6.3. setHeaderValue(value)</a>
      <li><a href="#ref-for-dfn-service-worker-registration④③">3.6.4. getState()</a>
      <li><a href="#ref-for-dfn-service-worker-registration④④">6.1. Secure Context</a> <a
          href="#ref-for-dfn-service-worker-registration④⑤">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-registration④⑥">6.8. Privacy</a>
      <li><a href="#ref-for-dfn-service-worker-registration④⑦">7.1. Define API bound to Service Worker Registration</a>
      <li><a href="#ref-for-dfn-service-worker-registration④⑧">7.4. Firing Functional Events</a>
      <li><a href="#ref-for-dfn-service-worker-registration④⑨">Appendix A: Algorithms</a> <a
          href="#ref-for-dfn-service-worker-registration⑤⓪">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-registration⑤①">Start Register</a>
      <li><a href="#ref-for-dfn-service-worker-registration⑤②">Soft Update</a>
      <li><a href="#ref-for-dfn-service-worker-registration⑤③">Install</a>
      <li><a href="#ref-for-dfn-service-worker-registration⑤④">Activate</a>
      <li><a href="#ref-for-dfn-service-worker-registration⑤⑤">Try Activate</a>
      <li><a href="#ref-for-dfn-service-worker-registration⑤⑥">Fire Functional Event</a>
      <li><a href="#ref-for-dfn-service-worker-registration⑤⑦">Handle Service Worker Client Unload</a>
      <li><a href="#ref-for-dfn-service-worker-registration⑤⑧">Set Registration</a> <a
          href="#ref-for-dfn-service-worker-registration⑤⑨">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-registration⑥⓪">Clear Registration</a>
      <li><a href="#ref-for-dfn-service-worker-registration⑥①">Try Clear Registration</a>
      <li><a href="#ref-for-dfn-service-worker-registration⑥②">Update Registration State</a>
      <li><a href="#ref-for-dfn-service-worker-registration⑥③">Match Service Worker Registration</a>
      <li><a href="#ref-for-dfn-service-worker-registration⑥④">Get Registration</a>
      <li><a href="#ref-for-dfn-service-worker-registration⑥⑤">Get Newest Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-registration-storage-key">
    <b><a href="#service-worker-registration-storage-key">#service-worker-registration-storage-key</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-registration-storage-key">2.3. Service Worker Registration</a>
      <li><a href="#ref-for-service-worker-registration-storage-key①">2.3.1. Lifetime</a>
      <li><a href="#ref-for-service-worker-registration-storage-key②">3.2.8. update()</a>
      <li><a href="#ref-for-service-worker-registration-storage-key③">3.2.9. unregister()</a>
      <li><a href="#ref-for-service-worker-registration-storage-key④">4.3.1. get(id)</a>
      <li><a href="#ref-for-service-worker-registration-storage-key⑤">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-service-worker-registration-storage-key⑥">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-service-worker-registration-storage-key⑦">4.3.4. claim()</a>
      <li><a href="#ref-for-service-worker-registration-storage-key⑧">Update</a> <a
          href="#ref-for-service-worker-registration-storage-key⑨">(2)</a>
      <li><a href="#ref-for-service-worker-registration-storage-key①⓪">Soft Update</a>
      <li><a href="#ref-for-service-worker-registration-storage-key①①">Install</a>
      <li><a href="#ref-for-service-worker-registration-storage-key①②">Activate</a>
      <li><a href="#ref-for-service-worker-registration-storage-key①③">Unregister</a>
      <li><a href="#ref-for-service-worker-registration-storage-key①④">Set Registration</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-scope-url">
    <b><a href="#dfn-scope-url">#dfn-scope-url</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-scope-url">2.3. Service Worker Registration</a> <a
          href="#ref-for-dfn-scope-url①">(2)</a> <a href="#ref-for-dfn-scope-url②">(3)</a> <a
          href="#ref-for-dfn-scope-url③">(4)</a>
      <li><a href="#ref-for-dfn-scope-url④">2.3.1. Lifetime</a>
      <li><a href="#ref-for-dfn-scope-url⑤">3.2.6. scope</a>
      <li><a href="#ref-for-dfn-scope-url⑥">3.2.8. update()</a>
      <li><a href="#ref-for-dfn-scope-url⑦">3.2.9. unregister()</a>
      <li><a href="#ref-for-dfn-scope-url⑧">3.4.3. register(scriptURL, options)</a> <a
          href="#ref-for-dfn-scope-url⑨">(2)</a>
      <li><a href="#ref-for-dfn-scope-url①⓪">6.5. Path restriction</a>
      <li><a href="#ref-for-dfn-scope-url①①">Appendix A: Algorithms</a> <a href="#ref-for-dfn-scope-url①②">(2)</a>
      <li><a href="#ref-for-dfn-scope-url①③">Update</a>
      <li><a href="#ref-for-dfn-scope-url①④">Soft Update</a>
      <li><a href="#ref-for-dfn-scope-url①⑤">Install</a> <a href="#ref-for-dfn-scope-url①⑥">(2)</a>
      <li><a href="#ref-for-dfn-scope-url①⑦">Activate</a>
      <li><a href="#ref-for-dfn-scope-url①⑧">Set Registration</a>
      <li><a href="#ref-for-dfn-scope-url①⑨">Service Worker Script Response</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-installing-worker">
    <b><a href="#dfn-installing-worker">#dfn-installing-worker</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-installing-worker">2.3. Service Worker Registration</a>
      <li><a href="#ref-for-dfn-installing-worker①">2.7. User Agent Shutdown</a> <a
          href="#ref-for-dfn-installing-worker②">(2)</a>
      <li><a href="#ref-for-dfn-installing-worker③">3.2.1. Getting ServiceWorkerRegistration instances</a> <a
          href="#ref-for-dfn-installing-worker④">(2)</a>
      <li><a href="#ref-for-dfn-installing-worker⑤">3.5. Events</a>
      <li><a href="#ref-for-dfn-installing-worker⑥">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-dfn-installing-worker⑦">4.7. Events</a>
      <li><a href="#ref-for-dfn-installing-worker⑧">Install</a> <a href="#ref-for-dfn-installing-worker⑨">(2)</a> <a
          href="#ref-for-dfn-installing-worker①⓪">(3)</a> <a href="#ref-for-dfn-installing-worker①①">(4)</a> <a
          href="#ref-for-dfn-installing-worker①②">(5)</a> <a href="#ref-for-dfn-installing-worker①③">(6)</a>
      <li><a href="#ref-for-dfn-installing-worker①④">Handle User Agent Shutdown</a>
      <li><a href="#ref-for-dfn-installing-worker①⑤">Clear Registration</a> <a
          href="#ref-for-dfn-installing-worker①⑥">(2)</a> <a href="#ref-for-dfn-installing-worker①⑦">(3)</a>
      <li><a href="#ref-for-dfn-installing-worker①⑧">Try Clear Registration</a> <a
          href="#ref-for-dfn-installing-worker①⑨">(2)</a>
      <li><a href="#ref-for-dfn-installing-worker②⓪">Update Registration State</a> <a
          href="#ref-for-dfn-installing-worker②①">(2)</a> <a href="#ref-for-dfn-installing-worker②②">(3)</a>
      <li><a href="#ref-for-dfn-installing-worker②③">Get Newest Worker</a> <a
          href="#ref-for-dfn-installing-worker②④">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-waiting-worker">
    <b><a href="#dfn-waiting-worker">#dfn-waiting-worker</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-waiting-worker">2.3. Service Worker Registration</a>
      <li><a href="#ref-for-dfn-waiting-worker①">2.7. User Agent Shutdown</a>
      <li><a href="#ref-for-dfn-waiting-worker②">3.2.1. Getting ServiceWorkerRegistration instances</a> <a
          href="#ref-for-dfn-waiting-worker③">(2)</a>
      <li><a href="#ref-for-dfn-waiting-worker④">4.1.4. skipWaiting()</a>
      <li><a href="#ref-for-dfn-waiting-worker⑤">Install</a> <a href="#ref-for-dfn-waiting-worker⑥">(2)</a> <a
          href="#ref-for-dfn-waiting-worker⑦">(3)</a> <a href="#ref-for-dfn-waiting-worker⑧">(4)</a>
      <li><a href="#ref-for-dfn-waiting-worker⑨">Activate</a> <a href="#ref-for-dfn-waiting-worker①⓪">(2)</a>
      <li><a href="#ref-for-dfn-waiting-worker①①">Try Activate</a> <a href="#ref-for-dfn-waiting-worker①②">(2)</a>
      <li><a href="#ref-for-dfn-waiting-worker①③">Handle User Agent Shutdown</a> <a
          href="#ref-for-dfn-waiting-worker①④">(2)</a>
      <li><a href="#ref-for-dfn-waiting-worker①⑤">Clear Registration</a> <a href="#ref-for-dfn-waiting-worker①⑥">(2)</a>
        <a href="#ref-for-dfn-waiting-worker①⑦">(3)</a>
      <li><a href="#ref-for-dfn-waiting-worker①⑧">Try Clear Registration</a> <a
          href="#ref-for-dfn-waiting-worker①⑨">(2)</a>
      <li><a href="#ref-for-dfn-waiting-worker②⓪">Update Registration State</a> <a
          href="#ref-for-dfn-waiting-worker②①">(2)</a> <a href="#ref-for-dfn-waiting-worker②②">(3)</a>
      <li><a href="#ref-for-dfn-waiting-worker②③">Get Newest Worker</a> <a href="#ref-for-dfn-waiting-worker②④">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-active-worker">
    <b><a href="#dfn-active-worker">#dfn-active-worker</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-active-worker">2.3. Service Worker Registration</a> <a
          href="#ref-for-dfn-active-worker①">(2)</a> <a href="#ref-for-dfn-active-worker②">(3)</a> <a
          href="#ref-for-dfn-active-worker③">(4)</a> <a href="#ref-for-dfn-active-worker④">(5)</a> <a
          href="#ref-for-dfn-active-worker⑤">(6)</a>
      <li><a href="#ref-for-dfn-active-worker⑥">2.7. User Agent Shutdown</a>
      <li><a href="#ref-for-dfn-active-worker⑦">3.2.1. Getting ServiceWorkerRegistration instances</a> <a
          href="#ref-for-dfn-active-worker⑧">(2)</a>
      <li><a href="#ref-for-dfn-active-worker⑨">3.4.2. ready</a> <a href="#ref-for-dfn-active-worker①⓪">(2)</a>
      <li><a href="#ref-for-dfn-active-worker①①">3.5. Events</a>
      <li><a href="#ref-for-dfn-active-worker①②">3.6.1. enable()</a>
      <li><a href="#ref-for-dfn-active-worker①③">3.6.2. disable()</a>
      <li><a href="#ref-for-dfn-active-worker①④">3.6.3. setHeaderValue(value)</a>
      <li><a href="#ref-for-dfn-active-worker①⑤">4.1.4. skipWaiting()</a>
      <li><a href="#ref-for-dfn-active-worker①⑥">4.3.4. claim()</a>
      <li><a href="#ref-for-dfn-active-worker①⑦">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-dfn-active-worker①⑧">4.7. Events</a>
      <li><a href="#ref-for-dfn-active-worker①⑨">7.4. Firing Functional Events</a>
      <li><a href="#ref-for-dfn-active-worker②⓪">Install</a> <a href="#ref-for-dfn-active-worker②①">(2)</a>
      <li><a href="#ref-for-dfn-active-worker②②">Activate</a> <a href="#ref-for-dfn-active-worker②③">(2)</a> <a
          href="#ref-for-dfn-active-worker②④">(3)</a> <a href="#ref-for-dfn-active-worker②⑤">(4)</a> <a
          href="#ref-for-dfn-active-worker②⑥">(5)</a> <a href="#ref-for-dfn-active-worker②⑦">(6)</a> <a
          href="#ref-for-dfn-active-worker②⑧">(7)</a> <a href="#ref-for-dfn-active-worker②⑨">(8)</a>
      <li><a href="#ref-for-dfn-active-worker③⓪">Try Activate</a> <a href="#ref-for-dfn-active-worker③①">(2)</a> <a
          href="#ref-for-dfn-active-worker③②">(3)</a> <a href="#ref-for-dfn-active-worker③③">(4)</a>
      <li><a href="#ref-for-dfn-active-worker③④">Run Service Worker</a>
      <li><a href="#ref-for-dfn-active-worker③⑤">Handle Fetch</a> <a href="#ref-for-dfn-active-worker③⑥">(2)</a> <a
          href="#ref-for-dfn-active-worker③⑦">(3)</a> <a href="#ref-for-dfn-active-worker③⑧">(4)</a> <a
          href="#ref-for-dfn-active-worker③⑨">(5)</a>
      <li><a href="#ref-for-dfn-active-worker④⓪">Fire Functional Event</a> <a
          href="#ref-for-dfn-active-worker④①">(2)</a> <a href="#ref-for-dfn-active-worker④②">(3)</a>
      <li><a href="#ref-for-dfn-active-worker④③">Handle User Agent Shutdown</a>
      <li><a href="#ref-for-dfn-active-worker④④">Clear Registration</a> <a href="#ref-for-dfn-active-worker④⑤">(2)</a>
        <a href="#ref-for-dfn-active-worker④⑥">(3)</a>
      <li><a href="#ref-for-dfn-active-worker④⑦">Try Clear Registration</a> <a
          href="#ref-for-dfn-active-worker④⑧">(2)</a>
      <li><a href="#ref-for-dfn-active-worker④⑨">Update Registration State</a> <a
          href="#ref-for-dfn-active-worker⑤⓪">(2)</a> <a href="#ref-for-dfn-active-worker⑤①">(3)</a>
      <li><a href="#ref-for-dfn-active-worker⑤②">Get Newest Worker</a> <a href="#ref-for-dfn-active-worker⑤③">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-last-update-check-time">
    <b><a href="#dfn-last-update-check-time">#dfn-last-update-check-time</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-last-update-check-time">2.3. Service Worker Registration</a> <a
          href="#ref-for-dfn-last-update-check-time①">(2)</a>
      <li><a href="#ref-for-dfn-last-update-check-time②">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-dfn-last-update-check-time③">Update</a> <a
          href="#ref-for-dfn-last-update-check-time④">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-registration-stale">
    <b><a href="#service-worker-registration-stale">#service-worker-registration-stale</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-registration-stale">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-service-worker-registration-stale①">Update</a> <a
          href="#ref-for-service-worker-registration-stale②">(2)</a>
      <li><a href="#ref-for-service-worker-registration-stale③">Handle Fetch</a>
      <li><a href="#ref-for-service-worker-registration-stale④">Fire Functional Event</a> <a
          href="#ref-for-service-worker-registration-stale⑤">(2)</a> <a
          href="#ref-for-service-worker-registration-stale⑥">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-update-via-cache">
    <b><a href="#dfn-update-via-cache">#dfn-update-via-cache</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-update-via-cache">3.2.7. updateViaCache</a>
      <li><a href="#ref-for-dfn-update-via-cache①">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-dfn-update-via-cache②">Start Register</a>
      <li><a href="#ref-for-dfn-update-via-cache③">Register</a>
      <li><a href="#ref-for-dfn-update-via-cache④">Update</a> <a href="#ref-for-dfn-update-via-cache⑤">(2)</a> <a
          href="#ref-for-dfn-update-via-cache⑥">(3)</a>
      <li><a href="#ref-for-dfn-update-via-cache⑦">Install</a>
      <li><a href="#ref-for-dfn-update-via-cache⑧">Set Registration</a> <a href="#ref-for-dfn-update-via-cache⑨">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-service-worker-registration-task-queue">
    <b><a
        href="#dfn-service-worker-registration-task-queue">#dfn-service-worker-registration-task-queue</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-service-worker-registration-task-queue">2.3. Service Worker Registration</a> <a
          href="#ref-for-dfn-service-worker-registration-task-queue①">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-registration-task-queue②">Run Service Worker</a>
      <li><a href="#ref-for-dfn-service-worker-registration-task-queue③">Terminate Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-registration-navigation-preload-enabled-flag">
    <b><a
        href="#service-worker-registration-navigation-preload-enabled-flag">#service-worker-registration-navigation-preload-enabled-flag</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-registration-navigation-preload-enabled-flag">3.6.1. enable()</a>
      <li><a href="#ref-for-service-worker-registration-navigation-preload-enabled-flag①">3.6.2. disable()</a>
      <li><a href="#ref-for-service-worker-registration-navigation-preload-enabled-flag②">3.6.4. getState()</a>
      <li><a href="#ref-for-service-worker-registration-navigation-preload-enabled-flag③">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-registration-navigation-preload-header-value">
    <b><a
        href="#service-worker-registration-navigation-preload-header-value">#service-worker-registration-navigation-preload-header-value</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-registration-navigation-preload-header-value">3.6.3.
          setHeaderValue(value)</a>
      <li><a href="#ref-for-service-worker-registration-navigation-preload-header-value①">3.6.4. getState()</a>
      <li><a href="#ref-for-service-worker-registration-navigation-preload-header-value②">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-service-worker-registration-unregistered">
    <b><a
        href="#dfn-service-worker-registration-unregistered">#dfn-service-worker-registration-unregistered</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-service-worker-registration-unregistered">2.3.1. Lifetime</a>
      <li><a href="#ref-for-dfn-service-worker-registration-unregistered①">4.3.4. claim()</a>
      <li><a href="#ref-for-dfn-service-worker-registration-unregistered②">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-dfn-service-worker-registration-unregistered③">Handle Service Worker Client Unload</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-service-worker-client">
    <b><a href="#dfn-service-worker-client">#dfn-service-worker-client</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-service-worker-client">2.1. Service Worker</a>
      <li><a href="#ref-for-dfn-service-worker-client①">2.1.1. Lifetime</a>
      <li><a href="#ref-for-dfn-service-worker-client②">2.3.1. Lifetime</a>
      <li><a href="#ref-for-dfn-service-worker-client③">2.4. Service Worker Client</a> <a
          href="#ref-for-dfn-service-worker-client④">(2)</a> <a href="#ref-for-dfn-service-worker-client⑤">(3)</a> <a
          href="#ref-for-dfn-service-worker-client⑥">(4)</a> <a href="#ref-for-dfn-service-worker-client⑦">(5)</a> <a
          href="#ref-for-dfn-service-worker-client⑧">(6)</a> <a href="#ref-for-dfn-service-worker-client⑨">(7)</a> <a
          href="#ref-for-dfn-service-worker-client①⓪">(8)</a> <a href="#ref-for-dfn-service-worker-client①①">(9)</a>
      <li><a href="#ref-for-dfn-service-worker-client①②">2.5. Control and Use</a> <a
          href="#ref-for-dfn-service-worker-client①③">(2)</a> <a href="#ref-for-dfn-service-worker-client①④">(3)</a> <a
          href="#ref-for-dfn-service-worker-client①⑤">(4)</a> <a href="#ref-for-dfn-service-worker-client①⑥">(5)</a>
      <li><a href="#ref-for-dfn-service-worker-client①⑦">2.5.1. The window client case</a> <a
          href="#ref-for-dfn-service-worker-client①⑧">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-client①⑨">3.2.9. unregister()</a> <a
          href="#ref-for-dfn-service-worker-client②⓪">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-client②①">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-dfn-service-worker-client②②">3.5. Events</a> <a
          href="#ref-for-dfn-service-worker-client②③">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-client②④">4.1. ServiceWorkerGlobalScope</a>
      <li><a href="#ref-for-dfn-service-worker-client②⑤">4.1.4. skipWaiting()</a>
      <li><a href="#ref-for-dfn-service-worker-client②⑥">4.2. Client</a>
      <li><a href="#ref-for-dfn-service-worker-client②⑦">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-dfn-service-worker-client②⑧">4.3.1. get(id)</a>
      <li><a href="#ref-for-dfn-service-worker-client②⑨">4.3.2. matchAll(options)</a> <a
          href="#ref-for-dfn-service-worker-client③⓪">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-client③①">4.3.4. claim()</a>
      <li><a href="#ref-for-dfn-service-worker-client③②">4.6.2. event.origin</a>
      <li><a href="#ref-for-dfn-service-worker-client③③">6.1. Secure Context</a> <a
          href="#ref-for-dfn-service-worker-client③④">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-client③⑤">6.3.1. Origin restriction</a>
      <li><a href="#ref-for-dfn-service-worker-client③⑥">Appendix A: Algorithms</a>
      <li><a href="#ref-for-dfn-service-worker-client③⑦">Create Job</a>
      <li><a href="#ref-for-dfn-service-worker-client③⑧">Start Register</a>
      <li><a href="#ref-for-dfn-service-worker-client③⑨">Activate</a> <a
          href="#ref-for-dfn-service-worker-client④⓪">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-client④①">Try Activate</a>
      <li><a href="#ref-for-dfn-service-worker-client④②">Run Service Worker</a>
      <li><a href="#ref-for-dfn-service-worker-client④③">Handle Fetch</a>
      <li><a href="#ref-for-dfn-service-worker-client④④">Handle Service Worker Client Unload</a> <a
          href="#ref-for-dfn-service-worker-client④⑤">(2)</a> <a href="#ref-for-dfn-service-worker-client④⑥">(3)</a>
      <li><a href="#ref-for-dfn-service-worker-client④⑦">Try Clear Registration</a>
      <li><a href="#ref-for-dfn-service-worker-client④⑧">Notify Controller Change</a>
      <li><a href="#ref-for-dfn-service-worker-client④⑨">Create Client</a>
      <li><a href="#ref-for-dfn-service-worker-client⑤⓪">Create Window Client</a>
      <li><a href="#ref-for-dfn-service-worker-client⑤①">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-client-discarded-flag">
    <b><a href="#service-worker-client-discarded-flag">#service-worker-client-discarded-flag</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-client-discarded-flag">2.4. Service Worker Client</a> <a
          href="#ref-for-service-worker-client-discarded-flag①">(2)</a>
      <li><a href="#ref-for-service-worker-client-discarded-flag②">4.3.1. get(id)</a>
      <li><a href="#ref-for-service-worker-client-discarded-flag③">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-service-worker-client-discarded-flag④">4.3.4. claim()</a>
      <li><a href="#ref-for-service-worker-client-discarded-flag⑤">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-client-origin">
    <b><a href="#service-worker-client-origin">#service-worker-client-origin</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-client-origin">2.5.2. The worker client case</a> <a
          href="#ref-for-service-worker-client-origin①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-window-client">
    <b><a href="#dfn-window-client">#dfn-window-client</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-window-client">2.5.1. The window client case</a> <a
          href="#ref-for-dfn-window-client①">(2)</a> <a href="#ref-for-dfn-window-client②">(3)</a> <a
          href="#ref-for-dfn-window-client③">(4)</a> <a href="#ref-for-dfn-window-client④">(5)</a> <a
          href="#ref-for-dfn-window-client⑤">(6)</a> <a href="#ref-for-dfn-window-client⑥">(7)</a>
      <li><a href="#ref-for-dfn-window-client⑦">2.5. Control and Use</a> <a href="#ref-for-dfn-window-client⑧">(2)</a>
      <li><a href="#ref-for-dfn-window-client⑨">4.2.4. type</a>
      <li><a href="#ref-for-dfn-window-client①⓪">4.3.2. matchAll(options)</a> <a
          href="#ref-for-dfn-window-client①①">(2)</a> <a href="#ref-for-dfn-window-client①②">(3)</a>
      <li><a href="#ref-for-dfn-window-client①③">Activate</a>
      <li><a href="#ref-for-dfn-window-client①④">Resolve Get Client Promise</a> <a
          href="#ref-for-dfn-window-client①⑤">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-dedicatedworker-client">
    <b><a href="#dfn-dedicatedworker-client">#dfn-dedicatedworker-client</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-dedicatedworker-client">2.4. Service Worker Client</a>
      <li><a href="#ref-for-dfn-dedicatedworker-client①">4.2.4. type</a>
      <li><a href="#ref-for-dfn-dedicatedworker-client②">4.3.2. matchAll(options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-sharedworker-client">
    <b><a href="#dfn-sharedworker-client">#dfn-sharedworker-client</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-sharedworker-client">2.4. Service Worker Client</a>
      <li><a href="#ref-for-dfn-sharedworker-client①">4.2.4. type</a>
      <li><a href="#ref-for-dfn-sharedworker-client②">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-dfn-sharedworker-client③">Activate</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-worker-client">
    <b><a href="#dfn-worker-client">#dfn-worker-client</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-worker-client">2.5.2. The worker client case</a> <a
          href="#ref-for-dfn-worker-client①">(2)</a> <a href="#ref-for-dfn-worker-client②">(3)</a> <a
          href="#ref-for-dfn-worker-client③">(4)</a> <a href="#ref-for-dfn-worker-client④">(5)</a> <a
          href="#ref-for-dfn-worker-client⑤">(6)</a> <a href="#ref-for-dfn-worker-client⑥">(7)</a> <a
          href="#ref-for-dfn-worker-client⑦">(8)</a>
      <li><a href="#ref-for-dfn-worker-client⑧">2.5. Control and Use</a> <a href="#ref-for-dfn-worker-client⑨">(2)</a>
      <li><a href="#ref-for-dfn-worker-client①⓪">4.3.2. matchAll(options)</a> <a
          href="#ref-for-dfn-worker-client①①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-control">
    <b><a href="#dfn-control">#dfn-control</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-control">2.5. Control and Use</a>
      <li><a href="#ref-for-dfn-control①">3.2.9. unregister()</a>
      <li><a href="#ref-for-dfn-control②">3.5. Events</a>
      <li><a href="#ref-for-dfn-control③">Service Worker Script Response</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-use">
    <b><a href="#dfn-use">#dfn-use</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-use">3.5. Events</a>
      <li><a href="#ref-for-dfn-use①">4.1.4. skipWaiting()</a>
      <li><a href="#ref-for-dfn-use②">Activate</a>
      <li><a href="#ref-for-dfn-use③">Try Activate</a>
      <li><a href="#ref-for-dfn-use④">Handle Fetch</a>
      <li><a href="#ref-for-dfn-use⑤">Handle Service Worker Client Unload</a> <a href="#ref-for-dfn-use⑥">(2)</a>
      <li><a href="#ref-for-dfn-use⑦">Unregister</a>
      <li><a href="#ref-for-dfn-use⑧">Try Clear Registration</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-handle-fetch-task-source">
    <b><a href="#dfn-handle-fetch-task-source">#dfn-handle-fetch-task-source</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-handle-fetch-task-source">2.3. Service Worker Registration</a>
      <li><a href="#ref-for-dfn-handle-fetch-task-source①">Terminate Service Worker</a> <a
          href="#ref-for-dfn-handle-fetch-task-source②">(2)</a>
      <li><a href="#ref-for-dfn-handle-fetch-task-source③">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-handle-functional-event-task-source">
    <b><a href="#dfn-handle-functional-event-task-source">#dfn-handle-functional-event-task-source</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-handle-functional-event-task-source">2.3. Service Worker Registration</a>
      <li><a href="#ref-for-dfn-handle-functional-event-task-source①">Terminate Service Worker</a> <a
          href="#ref-for-dfn-handle-functional-event-task-source②">(2)</a>
      <li><a href="#ref-for-dfn-handle-functional-event-task-source③">Fire Functional Event</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="serviceworker">
    <b><a href="#serviceworker">#serviceworker</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-serviceworker">2.1.1. Lifetime</a>
      <li><a href="#ref-for-serviceworker①">3.1. ServiceWorker</a> <a href="#ref-for-serviceworker②">(2)</a> <a
          href="#ref-for-serviceworker③">(3)</a> <a href="#ref-for-serviceworker④">(4)</a> <a
          href="#ref-for-serviceworker⑤">(5)</a> <a href="#ref-for-serviceworker⑥">(6)</a>
      <li><a href="#ref-for-serviceworker⑦">3.1.1. Getting ServiceWorker instances</a> <a
          href="#ref-for-serviceworker⑧">(2)</a> <a href="#ref-for-serviceworker⑨">(3)</a>
      <li><a href="#ref-for-serviceworker①⓪">3.1.6. Event handler</a>
      <li><a href="#ref-for-serviceworker①①">3.2. ServiceWorkerRegistration</a> <a
          href="#ref-for-serviceworker①②">(2)</a> <a href="#ref-for-serviceworker①③">(3)</a>
      <li><a href="#ref-for-serviceworker①④">3.2.2. installing</a>
      <li><a href="#ref-for-serviceworker①⑤">3.2.3. waiting</a>
      <li><a href="#ref-for-serviceworker①⑥">3.2.4. active</a>
      <li><a href="#ref-for-serviceworker①⑦">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-serviceworker①⑧">3.5. Events</a> <a href="#ref-for-serviceworker①⑨">(2)</a>
      <li><a href="#ref-for-serviceworker②⓪">4.1. ServiceWorkerGlobalScope</a> <a
          href="#ref-for-serviceworker②①">(2)</a>
      <li><a href="#ref-for-serviceworker②②">4.6. ExtendableMessageEvent</a> <a href="#ref-for-serviceworker②③">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-serviceworkerstate">
    <b><a href="#enumdef-serviceworkerstate">#enumdef-serviceworkerstate</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-enumdef-serviceworkerstate">3.1. ServiceWorker</a> <a
          href="#ref-for-enumdef-serviceworkerstate①">(2)</a>
      <li><a href="#ref-for-enumdef-serviceworkerstate②">3.1.3. state</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="environment-settings-object-service-worker-object-map">
    <b><a
        href="#environment-settings-object-service-worker-object-map">#environment-settings-object-service-worker-object-map</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-environment-settings-object-service-worker-object-map">3.1.1. Getting ServiceWorker
          instances</a>
      <li><a href="#ref-for-environment-settings-object-service-worker-object-map①">Update Worker State</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="get-the-service-worker-object">
    <b><a href="#get-the-service-worker-object">#get-the-service-worker-object</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-get-the-service-worker-object">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-get-the-service-worker-object①">3.2.1. Getting ServiceWorkerRegistration instances</a> <a
          href="#ref-for-get-the-service-worker-object②">(2)</a> <a
          href="#ref-for-get-the-service-worker-object③">(3)</a>
      <li><a href="#ref-for-get-the-service-worker-object④">3.4.1. controller</a>
      <li><a href="#ref-for-get-the-service-worker-object⑤">4.1.3. serviceWorker</a>
      <li><a href="#ref-for-get-the-service-worker-object⑥">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-get-the-service-worker-object⑦">Update Registration State</a> <a
          href="#ref-for-get-the-service-worker-object⑧">(2)</a> <a
          href="#ref-for-get-the-service-worker-object⑨">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworker-scripturl">
    <b><a href="#dom-serviceworker-scripturl">#dom-serviceworker-scripturl</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworker-scripturl">3.1. ServiceWorker</a>
      <li><a href="#ref-for-dom-serviceworker-scripturl①">3.1.2. scriptURL</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworker-state">
    <b><a href="#dom-serviceworker-state">#dom-serviceworker-state</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworker-state">3.1. ServiceWorker</a>
      <li><a href="#ref-for-dom-serviceworker-state①">3.1.1. Getting ServiceWorker instances</a>
      <li><a href="#ref-for-dom-serviceworker-state②">3.1.3. state</a>
      <li><a href="#ref-for-dom-serviceworker-state③">3.5. Events</a>
      <li><a href="#ref-for-dom-serviceworker-state④">Update Worker State</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworker-postmessage">
    <b><a href="#dom-serviceworker-postmessage">#dom-serviceworker-postmessage</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworker-postmessage">3.1. ServiceWorker</a>
      <li><a href="#ref-for-dom-serviceworker-postmessage①">3.1.4. postMessage(message, transfer)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworker-postmessage-message-options">
    <b><a
        href="#dom-serviceworker-postmessage-message-options">#dom-serviceworker-postmessage-message-options</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworker-postmessage-message-options">3.1. ServiceWorker</a>
      <li><a href="#ref-for-dom-serviceworker-postmessage-message-options①">3.1.4. postMessage(message, transfer)</a>
      <li><a href="#ref-for-dom-serviceworker-postmessage-message-options②">3.1.5. postMessage(message, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworker-onstatechange">
    <b><a href="#dom-serviceworker-onstatechange">#dom-serviceworker-onstatechange</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworker-onstatechange">3.1. ServiceWorker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="serviceworkerregistration">
    <b><a href="#serviceworkerregistration">#serviceworkerregistration</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-serviceworkerregistration">2.3.1. Lifetime</a>
      <li><a href="#ref-for-serviceworkerregistration①">3.2. ServiceWorkerRegistration</a> <a
          href="#ref-for-serviceworkerregistration②">(2)</a>
      <li><a href="#ref-for-serviceworkerregistration③">3.2.1. Getting ServiceWorkerRegistration instances</a> <a
          href="#ref-for-serviceworkerregistration④">(2)</a> <a href="#ref-for-serviceworkerregistration⑤">(3)</a>
      <li><a href="#ref-for-serviceworkerregistration⑥">3.2.10. Event handler</a>
      <li><a href="#ref-for-serviceworkerregistration⑦">3.4. ServiceWorkerContainer</a> <a
          href="#ref-for-serviceworkerregistration⑧">(2)</a> <a href="#ref-for-serviceworkerregistration⑨">(3)</a> <a
          href="#ref-for-serviceworkerregistration①⓪">(4)</a>
      <li><a href="#ref-for-serviceworkerregistration①①">3.5. Events</a>
      <li><a href="#ref-for-serviceworkerregistration①②">4.1. ServiceWorkerGlobalScope</a>
      <li><a href="#ref-for-serviceworkerregistration①③">7.1. Define API bound to Service Worker Registration</a>
      <li><a href="#ref-for-serviceworkerregistration①④">Install</a>
      <li><a href="#ref-for-serviceworkerregistration①⑤">Update Registration State</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-serviceworkerupdateviacache">
    <b><a href="#enumdef-serviceworkerupdateviacache">#enumdef-serviceworkerupdateviacache</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-enumdef-serviceworkerupdateviacache">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-enumdef-serviceworkerupdateviacache①">3.4. ServiceWorkerContainer</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="serviceworkerregistration-service-worker-registration">
    <b><a
        href="#serviceworkerregistration-service-worker-registration">#serviceworkerregistration-service-worker-registration</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-serviceworkerregistration-service-worker-registration">2.3. Service Worker Registration</a>
      <li><a href="#ref-for-serviceworkerregistration-service-worker-registration①">3.2.1. Getting
          ServiceWorkerRegistration instances</a>
      <li><a href="#ref-for-serviceworkerregistration-service-worker-registration②">3.2.5. navigationPreload</a>
      <li><a href="#ref-for-serviceworkerregistration-service-worker-registration③">3.2.6. scope</a>
      <li><a href="#ref-for-serviceworkerregistration-service-worker-registration④">3.2.7. updateViaCache</a>
      <li><a href="#ref-for-serviceworkerregistration-service-worker-registration⑤">3.2.8. update()</a>
      <li><a href="#ref-for-serviceworkerregistration-service-worker-registration⑥">3.2.9. unregister()</a>
      <li><a href="#ref-for-serviceworkerregistration-service-worker-registration⑦">3.5. Events</a>
      <li><a href="#ref-for-serviceworkerregistration-service-worker-registration⑧">Install</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="environment-settings-object-service-worker-registration-object-map">
    <b><a
        href="#environment-settings-object-service-worker-registration-object-map">#environment-settings-object-service-worker-registration-object-map</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-environment-settings-object-service-worker-registration-object-map">3.2.1. Getting
          ServiceWorkerRegistration instances</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="get-the-service-worker-registration-object">
    <b><a
        href="#get-the-service-worker-registration-object">#get-the-service-worker-registration-object</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-get-the-service-worker-registration-object">3.4.2. ready</a>
      <li><a href="#ref-for-get-the-service-worker-registration-object①">3.4.4. getRegistration(clientURL)</a>
      <li><a href="#ref-for-get-the-service-worker-registration-object②">3.4.5. getRegistrations()</a>
      <li><a href="#ref-for-get-the-service-worker-registration-object③">4.1.2. registration</a>
      <li><a href="#ref-for-get-the-service-worker-registration-object④">Resolve Job Promise</a> <a
          href="#ref-for-get-the-service-worker-registration-object⑤">(2)</a>
      <li><a href="#ref-for-get-the-service-worker-registration-object⑥">Activate</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerregistration-installing">
    <b><a
        href="#dom-serviceworkerregistration-installing">#dom-serviceworkerregistration-installing</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerregistration-installing">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-dom-serviceworkerregistration-installing①">3.2.1. Getting ServiceWorkerRegistration
          instances</a> <a href="#ref-for-dom-serviceworkerregistration-installing②">(2)</a>
      <li><a href="#ref-for-dom-serviceworkerregistration-installing③">3.2.2. installing</a>
      <li><a href="#ref-for-dom-serviceworkerregistration-installing④">Update Registration State</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerregistration-waiting">
    <b><a href="#dom-serviceworkerregistration-waiting">#dom-serviceworkerregistration-waiting</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerregistration-waiting">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-dom-serviceworkerregistration-waiting①">3.2.1. Getting ServiceWorkerRegistration
          instances</a> <a href="#ref-for-dom-serviceworkerregistration-waiting②">(2)</a>
      <li><a href="#ref-for-dom-serviceworkerregistration-waiting③">3.2.3. waiting</a>
      <li><a href="#ref-for-dom-serviceworkerregistration-waiting④">Update Registration State</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerregistration-active">
    <b><a href="#dom-serviceworkerregistration-active">#dom-serviceworkerregistration-active</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerregistration-active">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-dom-serviceworkerregistration-active①">3.2.1. Getting ServiceWorkerRegistration
          instances</a> <a href="#ref-for-dom-serviceworkerregistration-active②">(2)</a>
      <li><a href="#ref-for-dom-serviceworkerregistration-active③">3.2.4. active</a>
      <li><a href="#ref-for-dom-serviceworkerregistration-active④">Update Registration State</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerregistration-navigationpreload">
    <b><a
        href="#dom-serviceworkerregistration-navigationpreload">#dom-serviceworkerregistration-navigationpreload</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerregistration-navigationpreload">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-dom-serviceworkerregistration-navigationpreload①">3.2.5. navigationPreload</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerregistration-scope">
    <b><a href="#dom-serviceworkerregistration-scope">#dom-serviceworkerregistration-scope</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerregistration-scope">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-dom-serviceworkerregistration-scope①">3.2.6. scope</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerregistration-updateviacache">
    <b><a
        href="#dom-serviceworkerregistration-updateviacache">#dom-serviceworkerregistration-updateviacache</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerregistration-updateviacache">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-dom-serviceworkerregistration-updateviacache①">3.2.7. updateViaCache</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerregistration-update">
    <b><a href="#dom-serviceworkerregistration-update">#dom-serviceworkerregistration-update</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerregistration-update">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-dom-serviceworkerregistration-update①">3.2.8. update()</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerregistration-unregister">
    <b><a
        href="#dom-serviceworkerregistration-unregister">#dom-serviceworkerregistration-unregister</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerregistration-unregister">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-dom-serviceworkerregistration-unregister①">3.2.9. unregister()</a> <a
          href="#ref-for-dom-serviceworkerregistration-unregister②">(2)</a> <a
          href="#ref-for-dom-serviceworkerregistration-unregister③">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerregistration-onupdatefound">
    <b><a
        href="#dom-serviceworkerregistration-onupdatefound">#dom-serviceworkerregistration-onupdatefound</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerregistration-onupdatefound">3.2. ServiceWorkerRegistration</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="navigator-service-worker-attribute">
    <b><a href="#navigator-service-worker-attribute">#navigator-service-worker-attribute</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-navigator-service-worker-attribute">3.3. navigator.serviceWorker</a> <a
          href="#ref-for-navigator-service-worker-attribute①">(2)</a> <a
          href="#ref-for-navigator-service-worker-attribute②">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="serviceworkercontainer">
    <b><a href="#serviceworkercontainer">#serviceworkercontainer</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-serviceworkercontainer">3.3. navigator.serviceWorker</a> <a
          href="#ref-for-serviceworkercontainer①">(2)</a> <a href="#ref-for-serviceworkercontainer②">(3)</a>
      <li><a href="#ref-for-serviceworkercontainer③">3.4. ServiceWorkerContainer</a> <a
          href="#ref-for-serviceworkercontainer④">(2)</a> <a href="#ref-for-serviceworkercontainer⑤">(3)</a> <a
          href="#ref-for-serviceworkercontainer⑥">(4)</a> <a href="#ref-for-serviceworkercontainer⑦">(5)</a> <a
          href="#ref-for-serviceworkercontainer⑧">(6)</a> <a href="#ref-for-serviceworkercontainer⑨">(7)</a> <a
          href="#ref-for-serviceworkercontainer①⓪">(8)</a> <a href="#ref-for-serviceworkercontainer①①">(9)</a>
      <li><a href="#ref-for-serviceworkercontainer①②">3.4.7. Event handlers</a>
      <li><a href="#ref-for-serviceworkercontainer①③">3.5. Events</a>
      <li><a href="#ref-for-serviceworkercontainer①④">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-serviceworkercontainer①⑤">Activate</a>
      <li><a href="#ref-for-serviceworkercontainer①⑥">Notify Controller Change</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-registrationoptions">
    <b><a href="#dictdef-registrationoptions">#dictdef-registrationoptions</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dictdef-registrationoptions">3.4. ServiceWorkerContainer</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-registrationoptions-scope">
    <b><a href="#dom-registrationoptions-scope">#dom-registrationoptions-scope</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-registrationoptions-scope">3.4.3. register(scriptURL, options)</a> <a
          href="#ref-for-dom-registrationoptions-scope①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-registrationoptions-type">
    <b><a href="#dom-registrationoptions-type">#dom-registrationoptions-type</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-registrationoptions-type">3.4.3. register(scriptURL, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-registrationoptions-updateviacache">
    <b><a href="#dom-registrationoptions-updateviacache">#dom-registrationoptions-updateviacache</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-registrationoptions-updateviacache">3.4.3. register(scriptURL, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="serviceworkercontainer-service-worker-client">
    <b><a
        href="#serviceworkercontainer-service-worker-client">#serviceworkercontainer-service-worker-client</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-serviceworkercontainer-service-worker-client">3.4.1. controller</a>
      <li><a href="#ref-for-serviceworkercontainer-service-worker-client①">3.4.2. ready</a>
      <li><a href="#ref-for-serviceworkercontainer-service-worker-client②">3.4.3. register(scriptURL, options)</a>
      <li><a href="#ref-for-serviceworkercontainer-service-worker-client③">3.4.4. getRegistration(clientURL)</a>
      <li><a href="#ref-for-serviceworkercontainer-service-worker-client④">3.4.5. getRegistrations()</a>
      <li><a href="#ref-for-serviceworkercontainer-service-worker-client⑤">3.5. Events</a> <a
          href="#ref-for-serviceworkercontainer-service-worker-client⑥">(2)</a> <a
          href="#ref-for-serviceworkercontainer-service-worker-client⑦">(3)</a>
      <li><a href="#ref-for-serviceworkercontainer-service-worker-client⑧">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-serviceworkercontainer-service-worker-client⑨">Notify Controller Change</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="serviceworkercontainer-ready-promise">
    <b><a href="#serviceworkercontainer-ready-promise">#serviceworkercontainer-ready-promise</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-serviceworkercontainer-ready-promise">3.4.2. ready</a> <a
          href="#ref-for-serviceworkercontainer-ready-promise①">(2)</a> <a
          href="#ref-for-serviceworkercontainer-ready-promise②">(3)</a> <a
          href="#ref-for-serviceworkercontainer-ready-promise③">(4)</a>
      <li><a href="#ref-for-serviceworkercontainer-ready-promise④">Activate</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-client-message-queue">
    <b><a href="#dfn-client-message-queue">#dfn-client-message-queue</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-client-message-queue">3.4. ServiceWorkerContainer</a> <a
          href="#ref-for-dfn-client-message-queue①">(2)</a> <a href="#ref-for-dfn-client-message-queue②">(3)</a>
      <li><a href="#ref-for-dfn-client-message-queue③">3.4.6. startMessages()</a>
      <li><a href="#ref-for-dfn-client-message-queue④">3.4.7. Event handlers</a>
      <li><a href="#ref-for-dfn-client-message-queue⑤">4.2.6. postMessage(message, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkercontainer-controller">
    <b><a href="#dom-serviceworkercontainer-controller">#dom-serviceworkercontainer-controller</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkercontainer-controller">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-dom-serviceworkercontainer-controller①">3.4.1. controller</a> <a
          href="#ref-for-dom-serviceworkercontainer-controller②">(2)</a>
      <li><a href="#ref-for-dom-serviceworkercontainer-controller③">3.5. Events</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkercontainer-ready">
    <b><a href="#dom-serviceworkercontainer-ready">#dom-serviceworkercontainer-ready</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkercontainer-ready">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-dom-serviceworkercontainer-ready①">3.4.2. ready</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkercontainer-register">
    <b><a href="#dom-serviceworkercontainer-register">#dom-serviceworkercontainer-register</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkercontainer-register">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-dom-serviceworkercontainer-register①">3.4.3. register(scriptURL, options)</a> <a
          href="#ref-for-dom-serviceworkercontainer-register②">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkercontainer-getregistration">
    <b><a
        href="#dom-serviceworkercontainer-getregistration">#dom-serviceworkercontainer-getregistration</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkercontainer-getregistration">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-dom-serviceworkercontainer-getregistration①">3.4.4. getRegistration(clientURL)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkercontainer-getregistrations">
    <b><a
        href="#dom-serviceworkercontainer-getregistrations">#dom-serviceworkercontainer-getregistrations</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkercontainer-getregistrations">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-dom-serviceworkercontainer-getregistrations①">3.4.5. getRegistrations()</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkercontainer-startmessages">
    <b><a
        href="#dom-serviceworkercontainer-startmessages">#dom-serviceworkercontainer-startmessages</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkercontainer-startmessages">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-dom-serviceworkercontainer-startmessages①">3.4.6. startMessages()</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkercontainer-oncontrollerchange">
    <b><a
        href="#dom-serviceworkercontainer-oncontrollerchange">#dom-serviceworkercontainer-oncontrollerchange</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkercontainer-oncontrollerchange">3.4. ServiceWorkerContainer</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkercontainer-onmessage">
    <b><a href="#dom-serviceworkercontainer-onmessage">#dom-serviceworkercontainer-onmessage</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkercontainer-onmessage">3.4. ServiceWorkerContainer</a>
      <li><a href="#ref-for-dom-serviceworkercontainer-onmessage①">3.4.7. Event handlers</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkercontainer-onmessageerror">
    <b><a
        href="#dom-serviceworkercontainer-onmessageerror">#dom-serviceworkercontainer-onmessageerror</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkercontainer-onmessageerror">3.4. ServiceWorkerContainer</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="eventdef-serviceworker-statechange">
    <b><a href="#eventdef-serviceworker-statechange">#eventdef-serviceworker-statechange</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-eventdef-serviceworker-statechange">3.1.6. Event handler</a>
      <li><a href="#ref-for-eventdef-serviceworker-statechange①">Update Worker State</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-registration-updatefound-event">
    <b><a
        href="#service-worker-registration-updatefound-event">#service-worker-registration-updatefound-event</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-registration-updatefound-event">3.2.10. Event handler</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-container-controllerchange-event">
    <b><a
        href="#service-worker-container-controllerchange-event">#service-worker-container-controllerchange-event</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-container-controllerchange-event">3.4.7. Event handlers</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-container-message-event">
    <b><a href="#service-worker-container-message-event">#service-worker-container-message-event</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-container-message-event">2.1.2. Events</a>
      <li><a href="#ref-for-service-worker-container-message-event①">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-service-worker-container-message-event②">3.4.7. Event handlers</a>
      <li><a href="#ref-for-service-worker-container-message-event③">4.6. ExtendableMessageEvent</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-container-messageerror-event">
    <b><a
        href="#service-worker-container-messageerror-event">#service-worker-container-messageerror-event</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-container-messageerror-event">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-service-worker-container-messageerror-event①">3.4.7. Event handlers</a>
      <li><a href="#ref-for-service-worker-container-messageerror-event②">4.1.5. Event handlers</a>
      <li><a href="#ref-for-service-worker-container-messageerror-event③">4.2.6. postMessage(message, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="navigationpreloadmanager">
    <b><a href="#navigationpreloadmanager">#navigationpreloadmanager</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-navigationpreloadmanager">2.3. Service Worker Registration</a>
      <li><a href="#ref-for-navigationpreloadmanager①">3.2. ServiceWorkerRegistration</a>
      <li><a href="#ref-for-navigationpreloadmanager②">3.2.5. navigationPreload</a>
      <li><a href="#ref-for-navigationpreloadmanager③">3.6. NavigationPreloadManager</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-navigationpreloadstate">
    <b><a href="#dictdef-navigationpreloadstate">#dictdef-navigationpreloadstate</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dictdef-navigationpreloadstate">3.6. NavigationPreloadManager</a>
      <li><a href="#ref-for-dictdef-navigationpreloadstate①">3.6.4. getState()</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-navigationpreloadstate-enabled">
    <b><a href="#dom-navigationpreloadstate-enabled">#dom-navigationpreloadstate-enabled</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-navigationpreloadstate-enabled">3.6.4. getState()</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-navigationpreloadstate-headervalue">
    <b><a href="#dom-navigationpreloadstate-headervalue">#dom-navigationpreloadstate-headervalue</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-navigationpreloadstate-headervalue">3.6.4. getState()</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-navigationpreloadmanager-enable">
    <b><a href="#dom-navigationpreloadmanager-enable">#dom-navigationpreloadmanager-enable</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-navigationpreloadmanager-enable">3.6. NavigationPreloadManager</a>
      <li><a href="#ref-for-dom-navigationpreloadmanager-enable①">3.6.1. enable()</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-navigationpreloadmanager-disable">
    <b><a href="#dom-navigationpreloadmanager-disable">#dom-navigationpreloadmanager-disable</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-navigationpreloadmanager-disable">3.6. NavigationPreloadManager</a>
      <li><a href="#ref-for-dom-navigationpreloadmanager-disable①">3.6.2. disable()</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-navigationpreloadmanager-setheadervalue">
    <b><a
        href="#dom-navigationpreloadmanager-setheadervalue">#dom-navigationpreloadmanager-setheadervalue</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-navigationpreloadmanager-setheadervalue">3.6. NavigationPreloadManager</a>
      <li><a href="#ref-for-dom-navigationpreloadmanager-setheadervalue①">3.6.3. setHeaderValue(value)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-navigationpreloadmanager-getstate">
    <b><a href="#dom-navigationpreloadmanager-getstate">#dom-navigationpreloadmanager-getstate</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-navigationpreloadmanager-getstate">3.6. NavigationPreloadManager</a>
      <li><a href="#ref-for-dom-navigationpreloadmanager-getstate①">3.6.4. getState()</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="serviceworkerglobalscope">
    <b><a href="#serviceworkerglobalscope">#serviceworkerglobalscope</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-serviceworkerglobalscope">2.1. Service Worker</a>
      <li><a href="#ref-for-serviceworkerglobalscope①">3.1.5. postMessage(message, options)</a> <a
          href="#ref-for-serviceworkerglobalscope②">(2)</a>
      <li><a href="#ref-for-serviceworkerglobalscope③">3.2.8. update()</a>
      <li><a href="#ref-for-serviceworkerglobalscope④">4.1. ServiceWorkerGlobalScope</a> <a
          href="#ref-for-serviceworkerglobalscope⑤">(2)</a> <a href="#ref-for-serviceworkerglobalscope⑥">(3)</a> <a
          href="#ref-for-serviceworkerglobalscope⑦">(4)</a> <a href="#ref-for-serviceworkerglobalscope⑧">(5)</a>
      <li><a href="#ref-for-serviceworkerglobalscope⑨">4.1.5. Event handlers</a>
      <li><a href="#ref-for-serviceworkerglobalscope①⓪">4.3. Clients</a>
      <li><a href="#ref-for-serviceworkerglobalscope①①">4.7. Events</a>
      <li><a href="#ref-for-serviceworkerglobalscope①②">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-serviceworkerglobalscope①③">6.3.2. importScripts(urls)</a> <a
          href="#ref-for-serviceworkerglobalscope①④">(2)</a>
      <li><a href="#ref-for-serviceworkerglobalscope①⑤">7.3. Define Event Handler</a>
      <li><a href="#ref-for-serviceworkerglobalscope①⑥">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="serviceworkerglobalscope-service-worker">
    <b><a href="#serviceworkerglobalscope-service-worker">#serviceworkerglobalscope-service-worker</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-serviceworkerglobalscope-service-worker">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-serviceworkerglobalscope-service-worker①">3.2.8. update()</a>
      <li><a href="#ref-for-serviceworkerglobalscope-service-worker②">4.1.2. registration</a>
      <li><a href="#ref-for-serviceworkerglobalscope-service-worker③">4.1.3. serviceWorker</a>
      <li><a href="#ref-for-serviceworkerglobalscope-service-worker④">4.1.4. skipWaiting()</a> <a
          href="#ref-for-serviceworkerglobalscope-service-worker⑤">(2)</a>
      <li><a href="#ref-for-serviceworkerglobalscope-service-worker⑥">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-serviceworkerglobalscope-service-worker⑦">4.2.11. navigate(url)</a> <a
          href="#ref-for-serviceworkerglobalscope-service-worker⑧">(2)</a>
      <li><a href="#ref-for-serviceworkerglobalscope-service-worker⑨">4.3.1. get(id)</a>
      <li><a href="#ref-for-serviceworkerglobalscope-service-worker①⓪">4.3.2. matchAll(options)</a> <a
          href="#ref-for-serviceworkerglobalscope-service-worker①①">(2)</a>
      <li><a href="#ref-for-serviceworkerglobalscope-service-worker①②">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-serviceworkerglobalscope-service-worker①③">4.3.4. claim()</a> <a
          href="#ref-for-serviceworkerglobalscope-service-worker①④">(2)</a> <a
          href="#ref-for-serviceworkerglobalscope-service-worker①⑤">(3)</a> <a
          href="#ref-for-serviceworkerglobalscope-service-worker①⑥">(4)</a> <a
          href="#ref-for-serviceworkerglobalscope-service-worker①⑦">(5)</a> <a
          href="#ref-for-serviceworkerglobalscope-service-worker①⑧">(6)</a>
      <li><a href="#ref-for-serviceworkerglobalscope-service-worker①⑨">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-serviceworkerglobalscope-service-worker②⓪">4.7. Events</a> <a
          href="#ref-for-serviceworkerglobalscope-service-worker②①">(2)</a> <a
          href="#ref-for-serviceworkerglobalscope-service-worker②②">(3)</a>
      <li><a href="#ref-for-serviceworkerglobalscope-service-worker②③">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-serviceworkerglobalscope-service-worker②④">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="serviceworkerglobalscope-force-bypass-cache-for-import-scripts-flag">
    <b><a
        href="#serviceworkerglobalscope-force-bypass-cache-for-import-scripts-flag">#serviceworkerglobalscope-force-bypass-cache-for-import-scripts-flag</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-serviceworkerglobalscope-force-bypass-cache-for-import-scripts-flag">6.3.2.
          importScripts(urls)</a>
      <li><a href="#ref-for-serviceworkerglobalscope-force-bypass-cache-for-import-scripts-flag①">Run Service Worker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerglobalscope-clients">
    <b><a href="#dom-serviceworkerglobalscope-clients">#dom-serviceworkerglobalscope-clients</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerglobalscope-clients">4.1. ServiceWorkerGlobalScope</a>
      <li><a href="#ref-for-dom-serviceworkerglobalscope-clients①">4.1.1. clients</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerglobalscope-registration">
    <b><a
        href="#dom-serviceworkerglobalscope-registration">#dom-serviceworkerglobalscope-registration</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerglobalscope-registration">4.1. ServiceWorkerGlobalScope</a>
      <li><a href="#ref-for-dom-serviceworkerglobalscope-registration①">4.1.2. registration</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerglobalscope-serviceworker">
    <b><a
        href="#dom-serviceworkerglobalscope-serviceworker">#dom-serviceworkerglobalscope-serviceworker</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerglobalscope-serviceworker">4.1. ServiceWorkerGlobalScope</a>
      <li><a href="#ref-for-dom-serviceworkerglobalscope-serviceworker①">4.1.3. serviceWorker</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerglobalscope-skipwaiting">
    <b><a
        href="#dom-serviceworkerglobalscope-skipwaiting">#dom-serviceworkerglobalscope-skipwaiting</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerglobalscope-skipwaiting">4.1. ServiceWorkerGlobalScope</a>
      <li><a href="#ref-for-dom-serviceworkerglobalscope-skipwaiting①">4.1.4. skipWaiting()</a> <a
          href="#ref-for-dom-serviceworkerglobalscope-skipwaiting②">(2)</a>
      <li><a href="#ref-for-dom-serviceworkerglobalscope-skipwaiting③">Install</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerglobalscope-oninstall">
    <b><a href="#dom-serviceworkerglobalscope-oninstall">#dom-serviceworkerglobalscope-oninstall</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerglobalscope-oninstall">4.1. ServiceWorkerGlobalScope</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerglobalscope-onactivate">
    <b><a href="#dom-serviceworkerglobalscope-onactivate">#dom-serviceworkerglobalscope-onactivate</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerglobalscope-onactivate">4.1. ServiceWorkerGlobalScope</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerglobalscope-onfetch">
    <b><a href="#dom-serviceworkerglobalscope-onfetch">#dom-serviceworkerglobalscope-onfetch</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerglobalscope-onfetch">4.1. ServiceWorkerGlobalScope</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerglobalscope-onmessage">
    <b><a href="#dom-serviceworkerglobalscope-onmessage">#dom-serviceworkerglobalscope-onmessage</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerglobalscope-onmessage">4.1. ServiceWorkerGlobalScope</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-serviceworkerglobalscope-onmessageerror">
    <b><a
        href="#dom-serviceworkerglobalscope-onmessageerror">#dom-serviceworkerglobalscope-onmessageerror</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-serviceworkerglobalscope-onmessageerror">4.1. ServiceWorkerGlobalScope</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="client">
    <b><a href="#client">#client</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-client">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-client①">4.2. Client</a> <a href="#ref-for-client②">(2)</a> <a
          href="#ref-for-client③">(3)</a> <a href="#ref-for-client④">(4)</a>
      <li><a href="#ref-for-client⑤">4.3. Clients</a> <a href="#ref-for-client⑥">(2)</a>
      <li><a href="#ref-for-client⑦">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-client⑧">4.6. ExtendableMessageEvent</a> <a href="#ref-for-client⑨">(2)</a>
      <li><a href="#ref-for-client①⓪">4.6.4. event.source</a>
      <li><a href="#ref-for-client①①">Create Client</a> <a href="#ref-for-client①②">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="windowclient">
    <b><a href="#windowclient">#windowclient</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-windowclient">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-windowclient①">4.2. Client</a> <a href="#ref-for-windowclient②">(2)</a> <a
          href="#ref-for-windowclient③">(3)</a> <a href="#ref-for-windowclient④">(4)</a> <a
          href="#ref-for-windowclient⑤">(5)</a> <a href="#ref-for-windowclient⑥">(6)</a>
      <li><a href="#ref-for-windowclient⑦">4.3. Clients</a>
      <li><a href="#ref-for-windowclient⑧">4.3.2. matchAll(options)</a> <a href="#ref-for-windowclient⑨">(2)</a>
      <li><a href="#ref-for-windowclient①⓪">Create Window Client</a> <a href="#ref-for-windowclient①①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-frametype">
    <b><a href="#enumdef-frametype">#enumdef-frametype</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-enumdef-frametype">4.2. Client</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-service-worker-client-service-worker-client">
    <b><a
        href="#dfn-service-worker-client-service-worker-client">#dfn-service-worker-client-service-worker-client</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-service-worker-client-service-worker-client">4.2. Client</a>
      <li><a href="#ref-for-dfn-service-worker-client-service-worker-client①">4.2.1. url</a>
      <li><a href="#ref-for-dfn-service-worker-client-service-worker-client②">4.2.3. id</a>
      <li><a href="#ref-for-dfn-service-worker-client-service-worker-client③">4.2.4. type</a>
      <li><a href="#ref-for-dfn-service-worker-client-service-worker-client④">4.2.6. postMessage(message, options)</a>
      <li><a href="#ref-for-dfn-service-worker-client-service-worker-client⑤">4.2.10. focus()</a> <a
          href="#ref-for-dfn-service-worker-client-service-worker-client⑥">(2)</a>
      <li><a href="#ref-for-dfn-service-worker-client-service-worker-client⑦">4.2.11. navigate(url)</a> <a
          href="#ref-for-dfn-service-worker-client-service-worker-client⑧">(2)</a> <a
          href="#ref-for-dfn-service-worker-client-service-worker-client⑨">(3)</a>
      <li><a href="#ref-for-dfn-service-worker-client-service-worker-client①⓪">4.3.2. matchAll(options)</a> <a
          href="#ref-for-dfn-service-worker-client-service-worker-client①①">(2)</a> <a
          href="#ref-for-dfn-service-worker-client-service-worker-client①②">(3)</a>
      <li><a href="#ref-for-dfn-service-worker-client-service-worker-client①③">Create Client</a>
      <li><a href="#ref-for-dfn-service-worker-client-service-worker-client①④">Create Window Client</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-service-worker-client-frame-type">
    <b><a href="#dfn-service-worker-client-frame-type">#dfn-service-worker-client-frame-type</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-service-worker-client-frame-type">4.2.2. frameType</a>
      <li><a href="#ref-for-dfn-service-worker-client-frame-type①">Create Window Client</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-service-worker-client-browsing-context">
    <b><a
        href="#dfn-service-worker-client-browsing-context">#dfn-service-worker-client-browsing-context</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-service-worker-client-browsing-context">4.2.10. focus()</a> <a
          href="#ref-for-dfn-service-worker-client-browsing-context①">(2)</a> <a
          href="#ref-for-dfn-service-worker-client-browsing-context②">(3)</a> <a
          href="#ref-for-dfn-service-worker-client-browsing-context③">(4)</a> <a
          href="#ref-for-dfn-service-worker-client-browsing-context④">(5)</a>
      <li><a href="#ref-for-dfn-service-worker-client-browsing-context⑤">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-dfn-service-worker-client-browsing-context⑥">4.3.2. matchAll(options)</a> <a
          href="#ref-for-dfn-service-worker-client-browsing-context⑦">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-service-worker-client-visibilitystate">
    <b><a
        href="#dfn-service-worker-client-visibilitystate">#dfn-service-worker-client-visibilitystate</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-service-worker-client-visibilitystate">4.2.7. visibilityState</a>
      <li><a href="#ref-for-dfn-service-worker-client-visibilitystate①">Create Window Client</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-service-worker-client-focusstate">
    <b><a href="#dfn-service-worker-client-focusstate">#dfn-service-worker-client-focusstate</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dfn-service-worker-client-focusstate">4.2.8. focused</a>
      <li><a href="#ref-for-dfn-service-worker-client-focusstate①">4.2.10. focus()</a>
      <li><a href="#ref-for-dfn-service-worker-client-focusstate②">Create Window Client</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="windowclient-ancestor-origins-array">
    <b><a href="#windowclient-ancestor-origins-array">#windowclient-ancestor-origins-array</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-windowclient-ancestor-origins-array">4.2.9. ancestorOrigins</a>
      <li><a href="#ref-for-windowclient-ancestor-origins-array①">Create Window Client</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-client-url">
    <b><a href="#dom-client-url">#dom-client-url</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-client-url">4.2. Client</a>
      <li><a href="#ref-for-dom-client-url①">4.2.1. url</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-client-frametype">
    <b><a href="#dom-client-frametype">#dom-client-frametype</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-client-frametype">4.2. Client</a>
      <li><a href="#ref-for-dom-client-frametype①">4.2.2. frameType</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-client-id">
    <b><a href="#dom-client-id">#dom-client-id</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-client-id">4.2. Client</a>
      <li><a href="#ref-for-dom-client-id①">4.2.3. id</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-client-type">
    <b><a href="#dom-client-type">#dom-client-type</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-client-type">4.2. Client</a>
      <li><a href="#ref-for-dom-client-type①">4.2.4. type</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-client-postmessage">
    <b><a href="#dom-client-postmessage">#dom-client-postmessage</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-client-postmessage">4.2. Client</a>
      <li><a href="#ref-for-dom-client-postmessage①">4.2.5. postMessage(message, transfer)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-client-postmessage-message-options">
    <b><a href="#dom-client-postmessage-message-options">#dom-client-postmessage-message-options</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-client-postmessage-message-options">3.5. Events</a> <a
          href="#ref-for-dom-client-postmessage-message-options①">(2)</a>
      <li><a href="#ref-for-dom-client-postmessage-message-options②">4.2. Client</a>
      <li><a href="#ref-for-dom-client-postmessage-message-options③">4.2.5. postMessage(message, transfer)</a>
      <li><a href="#ref-for-dom-client-postmessage-message-options④">4.2.6. postMessage(message, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-windowclient-visibilitystate">
    <b><a href="#dom-windowclient-visibilitystate">#dom-windowclient-visibilitystate</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-windowclient-visibilitystate">4.2. Client</a>
      <li><a href="#ref-for-dom-windowclient-visibilitystate①">4.2.7. visibilityState</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-windowclient-focused">
    <b><a href="#dom-windowclient-focused">#dom-windowclient-focused</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-windowclient-focused">4.2. Client</a>
      <li><a href="#ref-for-dom-windowclient-focused①">4.2.8. focused</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-windowclient-ancestororigins">
    <b><a href="#dom-windowclient-ancestororigins">#dom-windowclient-ancestororigins</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-windowclient-ancestororigins">4.2. Client</a>
      <li><a href="#ref-for-dom-windowclient-ancestororigins①">4.2.9. ancestorOrigins</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-windowclient-focus">
    <b><a href="#dom-windowclient-focus">#dom-windowclient-focus</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-windowclient-focus">4.2. Client</a>
      <li><a href="#ref-for-dom-windowclient-focus①">4.2.10. focus()</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-windowclient-navigate">
    <b><a href="#dom-windowclient-navigate">#dom-windowclient-navigate</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-windowclient-navigate">4.2. Client</a>
      <li><a href="#ref-for-dom-windowclient-navigate①">4.2.11. navigate(url)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="clients">
    <b><a href="#clients">#clients</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-clients">4.1. ServiceWorkerGlobalScope</a>
      <li><a href="#ref-for-clients①">4.1.1. clients</a>
      <li><a href="#ref-for-clients②">4.3. Clients</a> <a href="#ref-for-clients③">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-clientqueryoptions">
    <b><a href="#dictdef-clientqueryoptions">#dictdef-clientqueryoptions</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dictdef-clientqueryoptions">4.3. Clients</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-clientqueryoptions-includeuncontrolled">
    <b><a
        href="#dom-clientqueryoptions-includeuncontrolled">#dom-clientqueryoptions-includeuncontrolled</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-clientqueryoptions-includeuncontrolled">4.3.2. matchAll(options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-clientqueryoptions-type">
    <b><a href="#dom-clientqueryoptions-type">#dom-clientqueryoptions-type</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-clientqueryoptions-type">4.3.2. matchAll(options)</a> <a
          href="#ref-for-dom-clientqueryoptions-type①">(2)</a> <a href="#ref-for-dom-clientqueryoptions-type②">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-clienttype">
    <b><a href="#enumdef-clienttype">#enumdef-clienttype</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-enumdef-clienttype">4.2. Client</a>
      <li><a href="#ref-for-enumdef-clienttype①">4.3. Clients</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-clienttype-window">
    <b><a href="#dom-clienttype-window">#dom-clienttype-window</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-clienttype-window">4.2.4. type</a> <a href="#ref-for-dom-clienttype-window①">(2)</a>
      <li><a href="#ref-for-dom-clienttype-window②">4.3.2. matchAll(options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-clienttype-worker">
    <b><a href="#dom-clienttype-worker">#dom-clienttype-worker</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-clienttype-worker">4.2.4. type</a>
      <li><a href="#ref-for-dom-clienttype-worker①">4.3.2. matchAll(options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-clienttype-sharedworker">
    <b><a href="#dom-clienttype-sharedworker">#dom-clienttype-sharedworker</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-clienttype-sharedworker">4.2.4. type</a>
      <li><a href="#ref-for-dom-clienttype-sharedworker①">4.3.2. matchAll(options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-clienttype-all">
    <b><a href="#dom-clienttype-all">#dom-clienttype-all</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-clienttype-all">4.3.2. matchAll(options)</a> <a
          href="#ref-for-dom-clienttype-all①">(2)</a> <a href="#ref-for-dom-clienttype-all②">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-clients-get">
    <b><a href="#dom-clients-get">#dom-clients-get</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-clients-get">4.3. Clients</a>
      <li><a href="#ref-for-dom-clients-get①">4.3.1. get(id)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-clients-matchall">
    <b><a href="#dom-clients-matchall">#dom-clients-matchall</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-clients-matchall">4.3. Clients</a>
      <li><a href="#ref-for-dom-clients-matchall①">4.3.2. matchAll(options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-clients-openwindow">
    <b><a href="#dom-clients-openwindow">#dom-clients-openwindow</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-clients-openwindow">4.3. Clients</a>
      <li><a href="#ref-for-dom-clients-openwindow①">4.3.3. openWindow(url)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-clients-claim">
    <b><a href="#dom-clients-claim">#dom-clients-claim</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-clients-claim">4.3. Clients</a>
      <li><a href="#ref-for-dom-clients-claim①">4.3.4. claim()</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="extendableevent">
    <b><a href="#extendableevent">#extendableevent</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-extendableevent">2.1. Service Worker</a>
      <li><a href="#ref-for-extendableevent①">4.4. ExtendableEvent</a> <a href="#ref-for-extendableevent②">(2)</a> <a
          href="#ref-for-extendableevent③">(3)</a> <a href="#ref-for-extendableevent④">(4)</a> <a
          href="#ref-for-extendableevent⑤">(5)</a> <a href="#ref-for-extendableevent⑥">(6)</a> <a
          href="#ref-for-extendableevent⑦">(7)</a> <a href="#ref-for-extendableevent⑧">(8)</a>
      <li><a href="#ref-for-extendableevent⑨">4.5. FetchEvent</a> <a href="#ref-for-extendableevent①⓪">(2)</a>
      <li><a href="#ref-for-extendableevent①①">4.6. ExtendableMessageEvent</a> <a
          href="#ref-for-extendableevent①②">(2)</a>
      <li><a href="#ref-for-extendableevent①③">4.7. Events</a> <a href="#ref-for-extendableevent①④">(2)</a>
      <li><a href="#ref-for-extendableevent①⑤">7.2. Define Functional Event</a>
      <li><a href="#ref-for-extendableevent①⑥">Install</a>
      <li><a href="#ref-for-extendableevent①⑦">Activate</a>
      <li><a href="#ref-for-extendableevent①⑧">Fire Functional Event</a> <a href="#ref-for-extendableevent①⑨">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-extendableeventinit">
    <b><a href="#dictdef-extendableeventinit">#dictdef-extendableeventinit</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dictdef-extendableeventinit">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-dictdef-extendableeventinit①">4.5. FetchEvent</a>
      <li><a href="#ref-for-dictdef-extendableeventinit②">4.6. ExtendableMessageEvent</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="extendableevent-extend-lifetime-promises">
    <b><a
        href="#extendableevent-extend-lifetime-promises">#extendableevent-extend-lifetime-promises</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-extendableevent-extend-lifetime-promises">4.4. ExtendableEvent</a> <a
          href="#ref-for-extendableevent-extend-lifetime-promises①">(2)</a> <a
          href="#ref-for-extendableevent-extend-lifetime-promises②">(3)</a> <a
          href="#ref-for-extendableevent-extend-lifetime-promises③">(4)</a> <a
          href="#ref-for-extendableevent-extend-lifetime-promises④">(5)</a> <a
          href="#ref-for-extendableevent-extend-lifetime-promises⑤">(6)</a>
      <li><a href="#ref-for-extendableevent-extend-lifetime-promises⑥">Install</a> <a
          href="#ref-for-extendableevent-extend-lifetime-promises⑦">(2)</a>
      <li><a href="#ref-for-extendableevent-extend-lifetime-promises⑧">Unregister</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="extendableevent-pending-promises-count">
    <b><a href="#extendableevent-pending-promises-count">#extendableevent-pending-promises-count</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-extendableevent-pending-promises-count">4.4. ExtendableEvent</a> <a
          href="#ref-for-extendableevent-pending-promises-count①">(2)</a> <a
          href="#ref-for-extendableevent-pending-promises-count②">(3)</a> <a
          href="#ref-for-extendableevent-pending-promises-count③">(4)</a> <a
          href="#ref-for-extendableevent-pending-promises-count④">(5)</a> <a
          href="#ref-for-extendableevent-pending-promises-count⑤">(6)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="extendableevent-timed-out-flag">
    <b><a href="#extendableevent-timed-out-flag">#extendableevent-timed-out-flag</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-extendableevent-timed-out-flag">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-extendableevent-timed-out-flag①">Install</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="extendableevent-active">
    <b><a href="#extendableevent-active">#extendableevent-active</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-extendableevent-active">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-extendableevent-active①">Install</a>
      <li><a href="#ref-for-extendableevent-active②">Activate</a>
      <li><a href="#ref-for-extendableevent-active③">Update Service Worker Extended Events Set</a> <a
          href="#ref-for-extendableevent-active④">(2)</a>
      <li><a href="#ref-for-extendableevent-active⑤">Service Worker Has No Pending Events</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-extendableevent-waituntil">
    <b><a href="#dom-extendableevent-waituntil">#dom-extendableevent-waituntil</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-extendableevent-waituntil">4.4. ExtendableEvent</a> <a
          href="#ref-for-dom-extendableevent-waituntil③">(2)</a>
      <li><a href="#ref-for-dom-extendableevent-waituntil①">4.4.1. event.waitUntil(f)</a> <a
          href="#ref-for-dom-extendableevent-waituntil②">(2)</a>
      <li><a href="#ref-for-dom-extendableevent-waituntil④">4.5.7. event.respondWith(r)</a>
      <li><a href="#ref-for-dom-extendableevent-waituntil⑤">4.6. ExtendableMessageEvent</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="extendableevent-add-lifetime-promise">
    <b><a href="#extendableevent-add-lifetime-promise">#extendableevent-add-lifetime-promise</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-extendableevent-add-lifetime-promise">4.4.1. event.waitUntil(f)</a>
      <li><a href="#ref-for-extendableevent-add-lifetime-promise①">4.5.7. event.respondWith(r)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="fetchevent">
    <b><a href="#fetchevent">#fetchevent</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-fetchevent">4.5. FetchEvent</a> <a href="#ref-for-fetchevent①">(2)</a> <a
          href="#ref-for-fetchevent②">(3)</a>
      <li><a href="#ref-for-fetchevent③">4.7. Events</a>
      <li><a href="#ref-for-fetchevent④">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-fetcheventinit">
    <b><a href="#dictdef-fetcheventinit">#dictdef-fetcheventinit</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dictdef-fetcheventinit">4.5. FetchEvent</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="fetchevent-potential-response">
    <b><a href="#fetchevent-potential-response">#fetchevent-potential-response</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-fetchevent-potential-response">4.5.7. event.respondWith(r)</a>
      <li><a href="#ref-for-fetchevent-potential-response①">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="fetchevent-wait-to-respond-flag">
    <b><a href="#fetchevent-wait-to-respond-flag">#fetchevent-wait-to-respond-flag</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-fetchevent-wait-to-respond-flag">4.5.7. event.respondWith(r)</a> <a
          href="#ref-for-fetchevent-wait-to-respond-flag①">(2)</a> <a
          href="#ref-for-fetchevent-wait-to-respond-flag②">(3)</a>
      <li><a href="#ref-for-fetchevent-wait-to-respond-flag③">Handle Fetch</a> <a
          href="#ref-for-fetchevent-wait-to-respond-flag④">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="fetchevent-respond-with-entered-flag">
    <b><a href="#fetchevent-respond-with-entered-flag">#fetchevent-respond-with-entered-flag</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-fetchevent-respond-with-entered-flag">4.5.7. event.respondWith(r)</a> <a
          href="#ref-for-fetchevent-respond-with-entered-flag①">(2)</a>
      <li><a href="#ref-for-fetchevent-respond-with-entered-flag②">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="fetchevent-respond-with-error-flag">
    <b><a href="#fetchevent-respond-with-error-flag">#fetchevent-respond-with-error-flag</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-fetchevent-respond-with-error-flag">4.5.7. event.respondWith(r)</a> <a
          href="#ref-for-fetchevent-respond-with-error-flag①">(2)</a> <a
          href="#ref-for-fetchevent-respond-with-error-flag②">(3)</a>
      <li><a href="#ref-for-fetchevent-respond-with-error-flag③">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-fetchevent-request">
    <b><a href="#dom-fetchevent-request">#dom-fetchevent-request</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-fetchevent-request">4.5. FetchEvent</a>
      <li><a href="#ref-for-dom-fetchevent-request①">4.5.1. event.request</a>
      <li><a href="#ref-for-dom-fetchevent-request②">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-fetchevent-preloadresponse">
    <b><a href="#dom-fetchevent-preloadresponse">#dom-fetchevent-preloadresponse</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-fetchevent-preloadresponse">4.5. FetchEvent</a>
      <li><a href="#ref-for-dom-fetchevent-preloadresponse①">4.5.2. event.preloadResponse</a>
      <li><a href="#ref-for-dom-fetchevent-preloadresponse②">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-fetchevent-clientid">
    <b><a href="#dom-fetchevent-clientid">#dom-fetchevent-clientid</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-fetchevent-clientid">4.5. FetchEvent</a>
      <li><a href="#ref-for-dom-fetchevent-clientid①">4.5.3. event.clientId</a>
      <li><a href="#ref-for-dom-fetchevent-clientid②">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-fetchevent-resultingclientid">
    <b><a href="#dom-fetchevent-resultingclientid">#dom-fetchevent-resultingclientid</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-fetchevent-resultingclientid">4.5. FetchEvent</a>
      <li><a href="#ref-for-dom-fetchevent-resultingclientid①">4.5.4. event.resultingClientId</a>
      <li><a href="#ref-for-dom-fetchevent-resultingclientid②">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-fetchevent-replacesclientid">
    <b><a href="#dom-fetchevent-replacesclientid">#dom-fetchevent-replacesclientid</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-fetchevent-replacesclientid">4.5. FetchEvent</a>
      <li><a href="#ref-for-dom-fetchevent-replacesclientid①">4.5.5. event.replacesClientId</a>
      <li><a href="#ref-for-dom-fetchevent-replacesclientid②">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-fetchevent-handled">
    <b><a href="#dom-fetchevent-handled">#dom-fetchevent-handled</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-fetchevent-handled">4.5. FetchEvent</a>
      <li><a href="#ref-for-dom-fetchevent-handled①">4.5.6. event.handled</a>
      <li><a href="#ref-for-dom-fetchevent-handled②">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-fetchevent-respondwith">
    <b><a href="#dom-fetchevent-respondwith">#dom-fetchevent-respondwith</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-fetchevent-respondwith">4.5. FetchEvent</a>
      <li><a href="#ref-for-dom-fetchevent-respondwith①">4.5.7. event.respondWith(r)</a> <a
          href="#ref-for-dom-fetchevent-respondwith②">(2)</a>
      <li><a href="#ref-for-dom-fetchevent-respondwith③">6.4. Cross-Origin Resources and CORS</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="extendablemessageevent">
    <b><a href="#extendablemessageevent">#extendablemessageevent</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-extendablemessageevent">3.1.5. postMessage(message, options)</a> <a
          href="#ref-for-extendablemessageevent①">(2)</a>
      <li><a href="#ref-for-extendablemessageevent②">4.6. ExtendableMessageEvent</a> <a
          href="#ref-for-extendablemessageevent③">(2)</a>
      <li><a href="#ref-for-extendablemessageevent④">4.7. Events</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-extendablemessageeventinit">
    <b><a href="#dictdef-extendablemessageeventinit">#dictdef-extendablemessageeventinit</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dictdef-extendablemessageeventinit">4.6. ExtendableMessageEvent</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-extendablemessageevent-data">
    <b><a href="#dom-extendablemessageevent-data">#dom-extendablemessageevent-data</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-extendablemessageevent-data">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-dom-extendablemessageevent-data①">4.6. ExtendableMessageEvent</a>
      <li><a href="#ref-for-dom-extendablemessageevent-data②">4.6.1. event.data</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-extendablemessageevent-origin">
    <b><a href="#dom-extendablemessageevent-origin">#dom-extendablemessageevent-origin</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-extendablemessageevent-origin">3.1.5. postMessage(message, options)</a> <a
          href="#ref-for-dom-extendablemessageevent-origin①">(2)</a>
      <li><a href="#ref-for-dom-extendablemessageevent-origin②">4.6. ExtendableMessageEvent</a>
      <li><a href="#ref-for-dom-extendablemessageevent-origin③">4.6.2. event.origin</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-extendablemessageevent-lasteventid">
    <b><a href="#dom-extendablemessageevent-lasteventid">#dom-extendablemessageevent-lasteventid</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-extendablemessageevent-lasteventid">4.6. ExtendableMessageEvent</a>
      <li><a href="#ref-for-dom-extendablemessageevent-lasteventid①">4.6.3. event.lastEventId</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-extendablemessageevent-source">
    <b><a href="#dom-extendablemessageevent-source">#dom-extendablemessageevent-source</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-extendablemessageevent-source">3.1.5. postMessage(message, options)</a> <a
          href="#ref-for-dom-extendablemessageevent-source①">(2)</a>
      <li><a href="#ref-for-dom-extendablemessageevent-source②">4.6. ExtendableMessageEvent</a>
      <li><a href="#ref-for-dom-extendablemessageevent-source③">4.6.4. event.source</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-extendablemessageevent-ports">
    <b><a href="#dom-extendablemessageevent-ports">#dom-extendablemessageevent-ports</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-extendablemessageevent-ports">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-dom-extendablemessageevent-ports①">4.6. ExtendableMessageEvent</a>
      <li><a href="#ref-for-dom-extendablemessageevent-ports②">4.6.5. event.ports</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-global-scope-install-event">
    <b><a
        href="#service-worker-global-scope-install-event">#service-worker-global-scope-install-event</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-global-scope-install-event">2.1.2. Events</a>
      <li><a href="#ref-for-service-worker-global-scope-install-event①">4.1.5. Event handlers</a>
      <li><a href="#ref-for-service-worker-global-scope-install-event②">4.4. ExtendableEvent</a> <a
          href="#ref-for-service-worker-global-scope-install-event③">(2)</a> <a
          href="#ref-for-service-worker-global-scope-install-event④">(3)</a>
      <li><a href="#ref-for-service-worker-global-scope-install-event⑤">Install</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-global-scope-activate-event">
    <b><a
        href="#service-worker-global-scope-activate-event">#service-worker-global-scope-activate-event</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-global-scope-activate-event">2.1.2. Events</a>
      <li><a href="#ref-for-service-worker-global-scope-activate-event①">4.1.5. Event handlers</a>
      <li><a href="#ref-for-service-worker-global-scope-activate-event②">4.4. ExtendableEvent</a> <a
          href="#ref-for-service-worker-global-scope-activate-event③">(2)</a> <a
          href="#ref-for-service-worker-global-scope-activate-event④">(3)</a>
      <li><a href="#ref-for-service-worker-global-scope-activate-event⑤">Activate</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-global-scope-fetch-event">
    <b><a href="#service-worker-global-scope-fetch-event">#service-worker-global-scope-fetch-event</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-global-scope-fetch-event">2.1.2. Events</a>
      <li><a href="#ref-for-service-worker-global-scope-fetch-event①">2.6. Task Sources</a>
      <li><a href="#ref-for-service-worker-global-scope-fetch-event②">4.1.5. Event handlers</a>
      <li><a href="#ref-for-service-worker-global-scope-fetch-event③">4.5. FetchEvent</a> <a
          href="#ref-for-service-worker-global-scope-fetch-event④">(2)</a>
      <li><a href="#ref-for-service-worker-global-scope-fetch-event⑤">6.7. Implementer Concerns</a>
      <li><a href="#ref-for-service-worker-global-scope-fetch-event⑥">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="eventdef-serviceworkerglobalscope-message">
    <b><a
        href="#eventdef-serviceworkerglobalscope-message">#eventdef-serviceworkerglobalscope-message</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-eventdef-serviceworkerglobalscope-message">4.1.5. Event handlers</a>
      <li><a href="#ref-for-eventdef-serviceworkerglobalscope-message①">4.6. ExtendableMessageEvent</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="eventdef-serviceworkerglobalscope-messageerror">
    <b><a
        href="#eventdef-serviceworkerglobalscope-messageerror">#eventdef-serviceworkerglobalscope-messageerror</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-eventdef-serviceworkerglobalscope-messageerror">2.1.2. Events</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-request-response-list">
    <b><a href="#dfn-request-response-list">#dfn-request-response-list</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-request-response-list">5.1. Constructs</a> <a
          href="#ref-for-dfn-request-response-list①">(2)</a>
      <li><a href="#ref-for-dfn-request-response-list②">5.4. Cache</a> <a
          href="#ref-for-dfn-request-response-list③">(2)</a>
      <li><a href="#ref-for-dfn-request-response-list④">5.5.3. open(cacheName)</a>
      <li><a href="#ref-for-dfn-request-response-list⑤">6.8. Privacy</a>
      <li><a href="#ref-for-dfn-request-response-list⑥">Query Cache</a> <a
          href="#ref-for-dfn-request-response-list⑦">(2)</a>
      <li><a href="#ref-for-dfn-request-response-list⑧">Batch Cache Operations</a> <a
          href="#ref-for-dfn-request-response-list⑨">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-relevant-request-response-list">
    <b><a href="#dfn-relevant-request-response-list">#dfn-relevant-request-response-list</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-relevant-request-response-list">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-dfn-relevant-request-response-list①">5.4.7. keys(request, options)</a>
      <li><a href="#ref-for-dfn-relevant-request-response-list②">Query Cache</a>
      <li><a href="#ref-for-dfn-relevant-request-response-list③">Batch Cache Operations</a> <a
          href="#ref-for-dfn-relevant-request-response-list④">(2)</a> <a
          href="#ref-for-dfn-relevant-request-response-list⑤">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-name-to-cache-map">
    <b><a href="#dfn-name-to-cache-map">#dfn-name-to-cache-map</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-name-to-cache-map">5.1. Constructs</a> <a href="#ref-for-dfn-name-to-cache-map①">(2)</a>
      <li><a href="#ref-for-dfn-name-to-cache-map②">5.5. CacheStorage</a> <a
          href="#ref-for-dfn-name-to-cache-map③">(2)</a>
      <li><a href="#ref-for-dfn-name-to-cache-map④">5.5.5. keys()</a>
      <li><a href="#ref-for-dfn-name-to-cache-map⑤">6.8. Privacy</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-relevant-name-to-cache-map">
    <b><a href="#dfn-relevant-name-to-cache-map">#dfn-relevant-name-to-cache-map</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-relevant-name-to-cache-map">5.5.1. match(request, options)</a> <a
          href="#ref-for-dfn-relevant-name-to-cache-map①">(2)</a>
      <li><a href="#ref-for-dfn-relevant-name-to-cache-map②">5.5.2. has(cacheName)</a>
      <li><a href="#ref-for-dfn-relevant-name-to-cache-map③">5.5.3. open(cacheName)</a> <a
          href="#ref-for-dfn-relevant-name-to-cache-map④">(2)</a>
      <li><a href="#ref-for-dfn-relevant-name-to-cache-map⑤">5.5.4. delete(cacheName)</a>
      <li><a href="#ref-for-dfn-relevant-name-to-cache-map⑥">5.5.5. keys()</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="global-caches-attribute">
    <b><a href="#global-caches-attribute">#global-caches-attribute</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-global-caches-attribute">5.3. self.caches</a> <a
          href="#ref-for-global-caches-attribute①">(2)</a>
      <li><a href="#ref-for-global-caches-attribute②">5.3.1. caches</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="cache">
    <b><a href="#cache">#cache</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-cache">4.7. Events</a>
      <li><a href="#ref-for-cache①">5. Caches</a> <a href="#ref-for-cache②">(2)</a>
      <li><a href="#ref-for-cache③">5.2. Understanding Cache Lifetimes</a> <a href="#ref-for-cache④">(2)</a> <a
          href="#ref-for-cache⑤">(3)</a> <a href="#ref-for-cache⑥">(4)</a> <a href="#ref-for-cache⑦">(5)</a>
      <li><a href="#ref-for-cache⑧">5.4. Cache</a> <a href="#ref-for-cache⑨">(2)</a> <a href="#ref-for-cache①⓪">(3)</a>
      <li><a href="#ref-for-cache①①">5.5. CacheStorage</a>
      <li><a href="#ref-for-cache①②">5.5.1. match(request, options)</a> <a href="#ref-for-cache①③">(2)</a>
      <li><a href="#ref-for-cache①④">5.5.3. open(cacheName)</a> <a href="#ref-for-cache①⑤">(2)</a>
      <li><a href="#ref-for-cache①⑥">6.4. Cross-Origin Resources and CORS</a> <a href="#ref-for-cache①⑦">(2)</a> <a
          href="#ref-for-cache①⑧">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-cachequeryoptions">
    <b><a href="#dictdef-cachequeryoptions">#dictdef-cachequeryoptions</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dictdef-cachequeryoptions">5.4. Cache</a> <a
          href="#ref-for-dictdef-cachequeryoptions①">(2)</a> <a href="#ref-for-dictdef-cachequeryoptions②">(3)</a> <a
          href="#ref-for-dictdef-cachequeryoptions③">(4)</a> <a href="#ref-for-dictdef-cachequeryoptions④">(5)</a>
      <li><a href="#ref-for-dictdef-cachequeryoptions⑤">5.5. CacheStorage</a>
      <li><a href="#ref-for-dictdef-cachequeryoptions⑥">Query Cache</a>
      <li><a href="#ref-for-dictdef-cachequeryoptions⑦">Request Matches Cached Item</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cachequeryoptions-ignoresearch">
    <b><a href="#dom-cachequeryoptions-ignoresearch">#dom-cachequeryoptions-ignoresearch</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-cachequeryoptions-ignoresearch">Request Matches Cached Item</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cachequeryoptions-ignoremethod">
    <b><a href="#dom-cachequeryoptions-ignoremethod">#dom-cachequeryoptions-ignoremethod</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-cachequeryoptions-ignoremethod">Request Matches Cached Item</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cachequeryoptions-ignorevary">
    <b><a href="#dom-cachequeryoptions-ignorevary">#dom-cachequeryoptions-ignorevary</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-cachequeryoptions-ignorevary">Request Matches Cached Item</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-cache-batch-operation">
    <b><a href="#dfn-cache-batch-operation">#dfn-cache-batch-operation</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-cache-batch-operation">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-dfn-cache-batch-operation①">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-dfn-cache-batch-operation②">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-dfn-cache-batch-operation③">Batch Cache Operations</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-cache-batch-operation-type">
    <b><a href="#dfn-cache-batch-operation-type">#dfn-cache-batch-operation-type</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-cache-batch-operation-type">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-dfn-cache-batch-operation-type①">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-dfn-cache-batch-operation-type②">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-dfn-cache-batch-operation-type③">Batch Cache Operations</a> <a
          href="#ref-for-dfn-cache-batch-operation-type④">(2)</a> <a
          href="#ref-for-dfn-cache-batch-operation-type⑤">(3)</a> <a
          href="#ref-for-dfn-cache-batch-operation-type⑥">(4)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-cache-batch-operation-request">
    <b><a href="#dfn-cache-batch-operation-request">#dfn-cache-batch-operation-request</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-cache-batch-operation-request">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-dfn-cache-batch-operation-request①">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-dfn-cache-batch-operation-request②">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-dfn-cache-batch-operation-request③">Batch Cache Operations</a> <a
          href="#ref-for-dfn-cache-batch-operation-request④">(2)</a> <a
          href="#ref-for-dfn-cache-batch-operation-request⑤">(3)</a> <a
          href="#ref-for-dfn-cache-batch-operation-request⑥">(4)</a> <a
          href="#ref-for-dfn-cache-batch-operation-request⑦">(5)</a> <a
          href="#ref-for-dfn-cache-batch-operation-request⑧">(6)</a> <a
          href="#ref-for-dfn-cache-batch-operation-request⑨">(7)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-cache-batch-operation-response">
    <b><a href="#dfn-cache-batch-operation-response">#dfn-cache-batch-operation-response</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-cache-batch-operation-response">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-dfn-cache-batch-operation-response①">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-dfn-cache-batch-operation-response②">Batch Cache Operations</a> <a
          href="#ref-for-dfn-cache-batch-operation-response③">(2)</a> <a
          href="#ref-for-dfn-cache-batch-operation-response④">(3)</a> <a
          href="#ref-for-dfn-cache-batch-operation-response⑤">(4)</a> <a
          href="#ref-for-dfn-cache-batch-operation-response⑥">(5)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-cache-batch-operation-options">
    <b><a href="#dfn-cache-batch-operation-options">#dfn-cache-batch-operation-options</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-cache-batch-operation-options">5.4.6. delete(request, options)</a>
      <li><a href="#ref-for-dfn-cache-batch-operation-options①">Batch Cache Operations</a> <a
          href="#ref-for-dfn-cache-batch-operation-options②">(2)</a> <a
          href="#ref-for-dfn-cache-batch-operation-options③">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cache-match">
    <b><a href="#dom-cache-match">#dom-cache-match</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-cache-match">5.4. Cache</a>
      <li><a href="#ref-for-dom-cache-match①">5.4.1. match(request, options)</a>
      <li><a href="#ref-for-dom-cache-match②">5.5.1. match(request, options)</a> <a
          href="#ref-for-dom-cache-match③">(2)</a> <a href="#ref-for-dom-cache-match④">(3)</a> <a
          href="#ref-for-dom-cache-match⑤">(4)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cache-matchall">
    <b><a href="#dom-cache-matchall">#dom-cache-matchall</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-cache-matchall">5.4. Cache</a>
      <li><a href="#ref-for-dom-cache-matchall①">5.4.1. match(request, options)</a>
      <li><a href="#ref-for-dom-cache-matchall②">5.4.2. matchAll(request, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cache-add">
    <b><a href="#dom-cache-add">#dom-cache-add</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-cache-add">5.4. Cache</a>
      <li><a href="#ref-for-dom-cache-add①">5.4.3. add(request)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cache-addall">
    <b><a href="#dom-cache-addall">#dom-cache-addall</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-cache-addall">5.4. Cache</a>
      <li><a href="#ref-for-dom-cache-addall①">5.4.3. add(request)</a>
      <li><a href="#ref-for-dom-cache-addall②">5.4.4. addAll(requests)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cache-put">
    <b><a href="#dom-cache-put">#dom-cache-put</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-cache-put">5.4. Cache</a>
      <li><a href="#ref-for-dom-cache-put①">5.4.5. put(request, response)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cache-delete">
    <b><a href="#dom-cache-delete">#dom-cache-delete</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-cache-delete">5.4. Cache</a>
      <li><a href="#ref-for-dom-cache-delete①">5.4.6. delete(request, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cache-keys">
    <b><a href="#dom-cache-keys">#dom-cache-keys</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-cache-keys">5.4. Cache</a>
      <li><a href="#ref-for-dom-cache-keys①">5.4.7. keys(request, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="cachestorage">
    <b><a href="#cachestorage">#cachestorage</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-cachestorage">5.3. self.caches</a>
      <li><a href="#ref-for-cachestorage①">5.3.1. caches</a>
      <li><a href="#ref-for-cachestorage②">5.5. CacheStorage</a> <a href="#ref-for-cachestorage③">(2)</a> <a
          href="#ref-for-cachestorage④">(3)</a> <a href="#ref-for-cachestorage⑤">(4)</a> <a
          href="#ref-for-cachestorage⑥">(5)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-multicachequeryoptions">
    <b><a href="#dictdef-multicachequeryoptions">#dictdef-multicachequeryoptions</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dictdef-multicachequeryoptions">5.5. CacheStorage</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-multicachequeryoptions-cachename">
    <b><a href="#dom-multicachequeryoptions-cachename">#dom-multicachequeryoptions-cachename</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-dom-multicachequeryoptions-cachename">5.5.1. match(request, options)</a> <a
          href="#ref-for-dom-multicachequeryoptions-cachename①">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="cachestorage-global-object">
    <b><a href="#cachestorage-global-object">#cachestorage-global-object</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-cachestorage-global-object">5.1. Constructs</a>
      <li><a href="#ref-for-cachestorage-global-object①">5.5. CacheStorage</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cachestorage-match">
    <b><a href="#dom-cachestorage-match">#dom-cachestorage-match</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-cachestorage-match">5.5. CacheStorage</a>
      <li><a href="#ref-for-dom-cachestorage-match①">5.5.1. match(request, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cachestorage-has">
    <b><a href="#dom-cachestorage-has">#dom-cachestorage-has</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-cachestorage-has">5.5. CacheStorage</a>
      <li><a href="#ref-for-dom-cachestorage-has①">5.5.2. has(cacheName)</a>
      <li><a href="#ref-for-dom-cachestorage-has②">5.5.4. delete(cacheName)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cachestorage-open">
    <b><a href="#dom-cachestorage-open">#dom-cachestorage-open</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-cachestorage-open">5.5. CacheStorage</a>
      <li><a href="#ref-for-dom-cachestorage-open①">5.5.3. open(cacheName)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cachestorage-delete">
    <b><a href="#dom-cachestorage-delete">#dom-cachestorage-delete</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-cachestorage-delete">5.5. CacheStorage</a>
      <li><a href="#ref-for-dom-cachestorage-delete①">5.5.4. delete(cacheName)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-cachestorage-keys">
    <b><a href="#dom-cachestorage-keys">#dom-cachestorage-keys</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dom-cachestorage-keys">5.5. CacheStorage</a>
      <li><a href="#ref-for-dom-cachestorage-keys①">5.5.5. keys()</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="importscripts-method">
    <b><a href="#importscripts-method">#importscripts-method</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-importscripts-method">6.3.1. Origin restriction</a>
      <li><a href="#ref-for-importscripts-method①">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-scope-to-registration-map">
    <b><a href="#dfn-scope-to-registration-map">#dfn-scope-to-registration-map</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-scope-to-registration-map">2.3. Service Worker Registration</a>
      <li><a href="#ref-for-dfn-scope-to-registration-map①">2.3.1. Lifetime</a>
      <li><a href="#ref-for-dfn-scope-to-registration-map②">3.4.5. getRegistrations()</a>
      <li><a href="#ref-for-dfn-scope-to-registration-map③">6.8. Privacy</a>
      <li><a href="#ref-for-dfn-scope-to-registration-map④">Update</a> <a
          href="#ref-for-dfn-scope-to-registration-map⑤">(2)</a>
      <li><a href="#ref-for-dfn-scope-to-registration-map⑥">Install</a>
      <li><a href="#ref-for-dfn-scope-to-registration-map⑦">Handle User Agent Shutdown</a>
      <li><a href="#ref-for-dfn-scope-to-registration-map⑧">Unregister</a>
      <li><a href="#ref-for-dfn-scope-to-registration-map⑨">Set Registration</a>
      <li><a href="#ref-for-dfn-scope-to-registration-map①⓪">Match Service Worker Registration</a>
      <li><a href="#ref-for-dfn-scope-to-registration-map①①">Get Registration</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-job">
    <b><a href="#dfn-job">#dfn-job</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-job">Appendix A: Algorithms</a> <a href="#ref-for-dfn-job①">(2)</a> <a
          href="#ref-for-dfn-job②">(3)</a> <a href="#ref-for-dfn-job③">(4)</a> <a href="#ref-for-dfn-job④">(5)</a> <a
          href="#ref-for-dfn-job⑤">(6)</a> <a href="#ref-for-dfn-job⑥">(7)</a> <a href="#ref-for-dfn-job⑦">(8)</a> <a
          href="#ref-for-dfn-job⑧">(9)</a> <a href="#ref-for-dfn-job⑨">(10)</a> <a href="#ref-for-dfn-job①⓪">(11)</a> <a
          href="#ref-for-dfn-job①①">(12)</a> <a href="#ref-for-dfn-job①②">(13)</a> <a href="#ref-for-dfn-job①③">(14)</a>
        <a href="#ref-for-dfn-job①④">(15)</a> <a href="#ref-for-dfn-job①⑤">(16)</a> <a
          href="#ref-for-dfn-job①⑥">(17)</a> <a href="#ref-for-dfn-job①⑦">(18)</a>
      <li><a href="#ref-for-dfn-job①⑧">Create Job</a> <a href="#ref-for-dfn-job①⑨">(2)</a>
      <li><a href="#ref-for-dfn-job②⓪">Schedule Job</a>
      <li><a href="#ref-for-dfn-job②①">Finish Job</a>
      <li><a href="#ref-for-dfn-job②②">Resolve Job Promise</a>
      <li><a href="#ref-for-dfn-job②③">Reject Job Promise</a>
      <li><a href="#ref-for-dfn-job②④">Register</a>
      <li><a href="#ref-for-dfn-job②⑤">Update</a>
      <li><a href="#ref-for-dfn-job②⑥">Install</a>
      <li><a href="#ref-for-dfn-job②⑦">Unregister</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-job-type">
    <b><a href="#dfn-job-type">#dfn-job-type</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-job-type">Appendix A: Algorithms</a>
      <li><a href="#ref-for-dfn-job-type①">Create Job</a> <a href="#ref-for-dfn-job-type②">(2)</a>
      <li><a href="#ref-for-dfn-job-type③">Run Job</a> <a href="#ref-for-dfn-job-type④">(2)</a> <a
          href="#ref-for-dfn-job-type⑤">(3)</a>
      <li><a href="#ref-for-dfn-job-type⑥">Resolve Job Promise</a> <a href="#ref-for-dfn-job-type⑦">(2)</a>
      <li><a href="#ref-for-dfn-job-type⑧">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="job-storage-key">
    <b><a href="#job-storage-key">#job-storage-key</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-job-storage-key">Create Job</a>
      <li><a href="#ref-for-job-storage-key①">Register</a> <a href="#ref-for-job-storage-key②">(2)</a>
      <li><a href="#ref-for-job-storage-key③">Update</a>
      <li><a href="#ref-for-job-storage-key④">Unregister</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-job-scope-url">
    <b><a href="#dfn-job-scope-url">#dfn-job-scope-url</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-job-scope-url">Appendix A: Algorithms</a> <a href="#ref-for-dfn-job-scope-url①">(2)</a>
      <li><a href="#ref-for-dfn-job-scope-url②">Create Job</a>
      <li><a href="#ref-for-dfn-job-scope-url③">Schedule Job</a>
      <li><a href="#ref-for-dfn-job-scope-url④">Register</a> <a href="#ref-for-dfn-job-scope-url⑤">(2)</a> <a
          href="#ref-for-dfn-job-scope-url⑥">(3)</a>
      <li><a href="#ref-for-dfn-job-scope-url⑦">Update</a>
      <li><a href="#ref-for-dfn-job-scope-url⑧">Unregister</a> <a href="#ref-for-dfn-job-scope-url⑨">(2)</a> <a
          href="#ref-for-dfn-job-scope-url①⓪">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-job-script-url">
    <b><a href="#dfn-job-script-url">#dfn-job-script-url</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-job-script-url">Appendix A: Algorithms</a>
      <li><a href="#ref-for-dfn-job-script-url①">Create Job</a>
      <li><a href="#ref-for-dfn-job-script-url②">Register</a> <a href="#ref-for-dfn-job-script-url③">(2)</a> <a
          href="#ref-for-dfn-job-script-url④">(3)</a>
      <li><a href="#ref-for-dfn-job-script-url⑤">Update</a> <a href="#ref-for-dfn-job-script-url⑥">(2)</a> <a
          href="#ref-for-dfn-job-script-url⑦">(3)</a> <a href="#ref-for-dfn-job-script-url⑧">(4)</a> <a
          href="#ref-for-dfn-job-script-url⑨">(5)</a> <a href="#ref-for-dfn-job-script-url①⓪">(6)</a> <a
          href="#ref-for-dfn-job-script-url①①">(7)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-job-worker-type">
    <b><a href="#dfn-job-worker-type">#dfn-job-worker-type</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-job-worker-type">3.2.8. update()</a>
      <li><a href="#ref-for-dfn-job-worker-type①">Appendix A: Algorithms</a>
      <li><a href="#ref-for-dfn-job-worker-type②">Start Register</a> <a href="#ref-for-dfn-job-worker-type③">(2)</a>
      <li><a href="#ref-for-dfn-job-worker-type④">Register</a>
      <li><a href="#ref-for-dfn-job-worker-type⑤">Update</a> <a href="#ref-for-dfn-job-worker-type⑥">(2)</a> <a
          href="#ref-for-dfn-job-worker-type⑦">(3)</a>
      <li><a href="#ref-for-dfn-job-worker-type⑧">Soft Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-job-update-via-cache-mode">
    <b><a href="#dfn-job-update-via-cache-mode">#dfn-job-update-via-cache-mode</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-job-update-via-cache-mode">Appendix A: Algorithms</a>
      <li><a href="#ref-for-dfn-job-update-via-cache-mode①">Start Register</a>
      <li><a href="#ref-for-dfn-job-update-via-cache-mode②">Register</a> <a
          href="#ref-for-dfn-job-update-via-cache-mode③">(2)</a>
      <li><a href="#ref-for-dfn-job-update-via-cache-mode④">Update</a>
      <li><a href="#ref-for-dfn-job-update-via-cache-mode⑤">Install</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-job-client">
    <b><a href="#dfn-job-client">#dfn-job-client</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-job-client">Create Job</a>
      <li><a href="#ref-for-dfn-job-client①">Resolve Job Promise</a> <a href="#ref-for-dfn-job-client②">(2)</a> <a
          href="#ref-for-dfn-job-client③">(3)</a> <a href="#ref-for-dfn-job-client④">(4)</a> <a
          href="#ref-for-dfn-job-client⑤">(5)</a> <a href="#ref-for-dfn-job-client⑥">(6)</a> <a
          href="#ref-for-dfn-job-client⑦">(7)</a> <a href="#ref-for-dfn-job-client⑧">(8)</a>
      <li><a href="#ref-for-dfn-job-client⑨">Reject Job Promise</a> <a href="#ref-for-dfn-job-client①⓪">(2)</a> <a
          href="#ref-for-dfn-job-client①①">(3)</a> <a href="#ref-for-dfn-job-client①②">(4)</a> <a
          href="#ref-for-dfn-job-client①③">(5)</a> <a href="#ref-for-dfn-job-client①④">(6)</a>
      <li><a href="#ref-for-dfn-job-client①⑤">Update</a> <a href="#ref-for-dfn-job-client①⑥">(2)</a> <a
          href="#ref-for-dfn-job-client①⑦">(3)</a> <a href="#ref-for-dfn-job-client①⑧">(4)</a> <a
          href="#ref-for-dfn-job-client①⑨">(5)</a>
      <li><a href="#ref-for-dfn-job-client②⓪">Unregister</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="job-referrer">
    <b><a href="#job-referrer">#job-referrer</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-job-referrer">Create Job</a>
      <li><a href="#ref-for-job-referrer①">Start Register</a>
      <li><a href="#ref-for-job-referrer②">Register</a> <a href="#ref-for-job-referrer③">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-job-promise">
    <b><a href="#dfn-job-promise">#dfn-job-promise</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-job-promise">Create Job</a>
      <li><a href="#ref-for-dfn-job-promise①">Schedule Job</a>
      <li><a href="#ref-for-dfn-job-promise②">Resolve Job Promise</a> <a href="#ref-for-dfn-job-promise③">(2)</a>
      <li><a href="#ref-for-dfn-job-promise④">Reject Job Promise</a> <a href="#ref-for-dfn-job-promise⑤">(2)</a>
      <li><a href="#ref-for-dfn-job-promise⑥">Install</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-containing-job-queue">
    <b><a href="#dfn-containing-job-queue">#dfn-containing-job-queue</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-containing-job-queue">Schedule Job</a> <a
          href="#ref-for-dfn-containing-job-queue①">(2)</a>
      <li><a href="#ref-for-dfn-containing-job-queue②">Finish Job</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-job-list-of-equivalent-jobs">
    <b><a href="#dfn-job-list-of-equivalent-jobs">#dfn-job-list-of-equivalent-jobs</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-job-list-of-equivalent-jobs">Schedule Job</a>
      <li><a href="#ref-for-dfn-job-list-of-equivalent-jobs①">Resolve Job Promise</a>
      <li><a href="#ref-for-dfn-job-list-of-equivalent-jobs②">Reject Job Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-job-force-bypass-cache-flag">
    <b><a href="#dfn-job-force-bypass-cache-flag">#dfn-job-force-bypass-cache-flag</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-job-force-bypass-cache-flag">Update</a> <a
          href="#ref-for-dfn-job-force-bypass-cache-flag①">(2)</a> <a
          href="#ref-for-dfn-job-force-bypass-cache-flag②">(3)</a>
      <li><a href="#ref-for-dfn-job-force-bypass-cache-flag③">Soft Update</a>
      <li><a href="#ref-for-dfn-job-force-bypass-cache-flag④">Install</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-job-equivalent">
    <b><a href="#dfn-job-equivalent">#dfn-job-equivalent</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-job-equivalent">Schedule Job</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-job-queue">
    <b><a href="#dfn-job-queue">#dfn-job-queue</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-job-queue">Appendix A: Algorithms</a> <a href="#ref-for-dfn-job-queue①">(2)</a> <a
          href="#ref-for-dfn-job-queue②">(3)</a> <a href="#ref-for-dfn-job-queue③">(4)</a>
      <li><a href="#ref-for-dfn-job-queue④">Schedule Job</a>
      <li><a href="#ref-for-dfn-job-queue⑤">Run Job</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-scope-to-job-queue-map">
    <b><a href="#dfn-scope-to-job-queue-map">#dfn-scope-to-job-queue-map</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-scope-to-job-queue-map">Schedule Job</a> <a
          href="#ref-for-dfn-scope-to-job-queue-map①">(2)</a> <a href="#ref-for-dfn-scope-to-job-queue-map②">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="dfn-bad-import-script-response">
    <b><a href="#dfn-bad-import-script-response">#dfn-bad-import-script-response</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-dfn-bad-import-script-response">6.3.2. importScripts(urls)</a>
      <li><a href="#ref-for-dfn-bad-import-script-response①">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="create-job">
    <b><a href="#create-job">#create-job</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-create-job">3.2.8. update()</a>
      <li><a href="#ref-for-create-job①">3.2.9. unregister()</a>
      <li><a href="#ref-for-create-job②">Start Register</a>
      <li><a href="#ref-for-create-job③">Soft Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="schedule-job">
    <b><a href="#schedule-job">#schedule-job</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-schedule-job">3.2.8. update()</a>
      <li><a href="#ref-for-schedule-job①">3.2.9. unregister()</a>
      <li><a href="#ref-for-schedule-job②">Start Register</a>
      <li><a href="#ref-for-schedule-job③">Soft Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="run-job">
    <b><a href="#run-job">#run-job</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-run-job">Schedule Job</a>
      <li><a href="#ref-for-run-job①">Finish Job</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="finish-job">
    <b><a href="#finish-job">#finish-job</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-finish-job">Register</a> <a href="#ref-for-finish-job①">(2)</a> <a
          href="#ref-for-finish-job②">(3)</a> <a href="#ref-for-finish-job③">(4)</a>
      <li><a href="#ref-for-finish-job④">Update</a> <a href="#ref-for-finish-job⑤">(2)</a> <a
          href="#ref-for-finish-job⑥">(3)</a> <a href="#ref-for-finish-job⑦">(4)</a> <a
          href="#ref-for-finish-job⑧">(5)</a>
      <li><a href="#ref-for-finish-job⑨">Install</a> <a href="#ref-for-finish-job①⓪">(2)</a>
      <li><a href="#ref-for-finish-job①①">Unregister</a> <a href="#ref-for-finish-job①②">(2)</a> <a
          href="#ref-for-finish-job①③">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="resolve-job-promise">
    <b><a href="#resolve-job-promise">#resolve-job-promise</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-resolve-job-promise">Register</a>
      <li><a href="#ref-for-resolve-job-promise①">Update</a>
      <li><a href="#ref-for-resolve-job-promise②">Install</a>
      <li><a href="#ref-for-resolve-job-promise③">Unregister</a> <a href="#ref-for-resolve-job-promise④">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="reject-job-promise">
    <b><a href="#reject-job-promise">#reject-job-promise</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-reject-job-promise">Register</a> <a href="#ref-for-reject-job-promise①">(2)</a> <a
          href="#ref-for-reject-job-promise②">(3)</a>
      <li><a href="#ref-for-reject-job-promise③">Update</a> <a href="#ref-for-reject-job-promise④">(2)</a> <a
          href="#ref-for-reject-job-promise⑤">(3)</a> <a href="#ref-for-reject-job-promise⑥">(4)</a> <a
          href="#ref-for-reject-job-promise⑦">(5)</a> <a href="#ref-for-reject-job-promise⑧">(6)</a> <a
          href="#ref-for-reject-job-promise⑨">(7)</a>
      <li><a href="#ref-for-reject-job-promise①⓪">Unregister</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="start-register">
    <b><a href="#start-register">#start-register</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-start-register">3.4.3. register(scriptURL, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="register">
    <b><a href="#register">#register</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-register">2.3.1. Lifetime</a>
      <li><a href="#ref-for-register①">4.1. ServiceWorkerGlobalScope</a>
      <li><a href="#ref-for-register②">Run Job</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="update">
    <b><a href="#update">#update</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-update">Run Job</a>
      <li><a href="#ref-for-update①">Register</a>
      <li><a href="#ref-for-update②">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="soft-update">
    <b><a href="#soft-update">#soft-update</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-soft-update">Update</a>
      <li><a href="#ref-for-soft-update①">Handle Fetch</a> <a href="#ref-for-soft-update②">(2)</a>
      <li><a href="#ref-for-soft-update③">Fire Functional Event</a> <a href="#ref-for-soft-update④">(2)</a> <a
          href="#ref-for-soft-update⑤">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="install">
    <b><a href="#install">#install</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-install">3.5. Events</a>
      <li><a href="#ref-for-install①">4.7. Events</a>
      <li><a href="#ref-for-install②">Update</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="activate">
    <b><a href="#activate">#activate</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-activate">3.5. Events</a> <a href="#ref-for-activate①">(2)</a>
      <li><a href="#ref-for-activate②">4.7. Events</a>
      <li><a href="#ref-for-activate③">Install</a> <a href="#ref-for-activate④">(2)</a>
      <li><a href="#ref-for-activate⑤">Try Activate</a>
      <li><a href="#ref-for-activate⑥">Handle User Agent Shutdown</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="try-activate">
    <b><a href="#try-activate">#try-activate</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-try-activate">4.1.4. skipWaiting()</a>
      <li><a href="#ref-for-try-activate①">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-try-activate②">Install</a> <a href="#ref-for-try-activate③">(2)</a>
      <li><a href="#ref-for-try-activate④">Handle Service Worker Client Unload</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="run-service-worker">
    <b><a href="#run-service-worker">#run-service-worker</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-run-service-worker">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-run-service-worker①">6.2. Content Security Policy</a>
      <li><a href="#ref-for-run-service-worker②">Update</a> <a href="#ref-for-run-service-worker③">(2)</a>
      <li><a href="#ref-for-run-service-worker④">Install</a>
      <li><a href="#ref-for-run-service-worker⑤">Activate</a>
      <li><a href="#ref-for-run-service-worker⑥">Handle Fetch</a>
      <li><a href="#ref-for-run-service-worker⑦">Fire Functional Event</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="terminate-service-worker">
    <b><a href="#terminate-service-worker">#terminate-service-worker</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-terminate-service-worker">2.1.1. Lifetime</a>
      <li><a href="#ref-for-terminate-service-worker①">2.3. Service Worker Registration</a>
      <li><a href="#ref-for-terminate-service-worker②">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-terminate-service-worker③">Install</a>
      <li><a href="#ref-for-terminate-service-worker④">Activate</a>
      <li><a href="#ref-for-terminate-service-worker⑤">Run Service Worker</a>
      <li><a href="#ref-for-terminate-service-worker⑥">Handle Service Worker Client Unload</a>
      <li><a href="#ref-for-terminate-service-worker⑦">Clear Registration</a> <a
          href="#ref-for-terminate-service-worker⑧">(2)</a> <a href="#ref-for-terminate-service-worker⑨">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="handle-fetch">
    <b><a href="#handle-fetch">#handle-fetch</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-handle-fetch①">3.4.3. register(scriptURL, options)</a>
      <li><a href="#ref-for-handle-fetch②">4.5.7. event.respondWith(r)</a> <a href="#ref-for-handle-fetch③">(2)</a>
      <li><a href="#ref-for-handle-fetch④">4.7. Events</a> <a href="#ref-for-handle-fetch⑤">(2)</a>
      <li><a href="#ref-for-handle-fetch⑥">6.7. Implementer Concerns</a>
      <li><a href="#ref-for-handle-fetch⑦">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="should-skip-event">
    <b><a href="#should-skip-event">#should-skip-event</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-should-skip-event">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-should-skip-event①">Install</a>
      <li><a href="#ref-for-should-skip-event②">Activate</a>
      <li><a href="#ref-for-should-skip-event③">Handle Fetch</a>
      <li><a href="#ref-for-should-skip-event④">Fire Functional Event</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="fire-functional-event">
    <b><a href="#fire-functional-event">#fire-functional-event</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-fire-functional-event">7.4. Firing Functional Events</a>
      <li><a href="#ref-for-fire-functional-event①">Fire Functional Event</a> <a
          href="#ref-for-fire-functional-event②">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="handle-service-worker-client-unload">
    <b><a href="#handle-service-worker-client-unload">#handle-service-worker-client-unload</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-handle-service-worker-client-unload">4.3.4. claim()</a>
      <li><a href="#ref-for-handle-service-worker-client-unload①">Install</a>
      <li><a href="#ref-for-handle-service-worker-client-unload②">Unregister</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="handle-user-agent-shutdown">
    <b><a href="#handle-user-agent-shutdown">#handle-user-agent-shutdown</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-handle-user-agent-shutdown">2.7. User Agent Shutdown</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="update-service-worker-extended-events-set">
    <b><a
        href="#update-service-worker-extended-events-set">#update-service-worker-extended-events-set</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-update-service-worker-extended-events-set">3.1.5. postMessage(message, options)</a>
      <li><a href="#ref-for-update-service-worker-extended-events-set①">Handle Fetch</a>
      <li><a href="#ref-for-update-service-worker-extended-events-set②">Fire Functional Event</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="unregister">
    <b><a href="#unregister">#unregister</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-unregister">Run Job</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="set-registration">
    <b><a href="#set-registration">#set-registration</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-set-registration">Register</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="clear-registration">
    <b><a href="#clear-registration">#clear-registration</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-clear-registration">Handle User Agent Shutdown</a>
      <li><a href="#ref-for-clear-registration①">Unregister</a> <a href="#ref-for-clear-registration②">(2)</a>
      <li><a href="#ref-for-clear-registration③">Try Clear Registration</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="try-clear-registration">
    <b><a href="#try-clear-registration">#try-clear-registration</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-try-clear-registration">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-try-clear-registration①">Handle Service Worker Client Unload</a>
      <li><a href="#ref-for-try-clear-registration②">Unregister</a> <a href="#ref-for-try-clear-registration③">(2)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="update-registration-state">
    <b><a href="#update-registration-state">#update-registration-state</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-update-registration-state">Install</a> <a href="#ref-for-update-registration-state①">(2)</a>
        <a href="#ref-for-update-registration-state②">(3)</a> <a href="#ref-for-update-registration-state③">(4)</a>
      <li><a href="#ref-for-update-registration-state④">Activate</a> <a
          href="#ref-for-update-registration-state⑤">(2)</a>
      <li><a href="#ref-for-update-registration-state⑥">Clear Registration</a> <a
          href="#ref-for-update-registration-state⑦">(2)</a> <a href="#ref-for-update-registration-state⑧">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="update-worker-state">
    <b><a href="#update-worker-state">#update-worker-state</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-update-worker-state">Install</a> <a href="#ref-for-update-worker-state①">(2)</a> <a
          href="#ref-for-update-worker-state②">(3)</a> <a href="#ref-for-update-worker-state③">(4)</a> <a
          href="#ref-for-update-worker-state④">(5)</a>
      <li><a href="#ref-for-update-worker-state⑤">Activate</a> <a href="#ref-for-update-worker-state⑥">(2)</a> <a
          href="#ref-for-update-worker-state⑦">(3)</a>
      <li><a href="#ref-for-update-worker-state⑧">Clear Registration</a> <a href="#ref-for-update-worker-state⑨">(2)</a>
        <a href="#ref-for-update-worker-state①⓪">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="notify-controller-change">
    <b><a href="#notify-controller-change">#notify-controller-change</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-notify-controller-change">4.3.4. claim()</a>
      <li><a href="#ref-for-notify-controller-change①">Activate</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="match-service-worker-registration">
    <b><a href="#match-service-worker-registration">#match-service-worker-registration</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-match-service-worker-registration">2.5.1. The window client case</a>
      <li><a href="#ref-for-match-service-worker-registration①">2.5.2. The worker client case</a>
      <li><a href="#ref-for-match-service-worker-registration②">3.1.2. scriptURL</a>
      <li><a href="#ref-for-match-service-worker-registration③">3.4.2. ready</a>
      <li><a href="#ref-for-match-service-worker-registration④">3.4.4. getRegistration(clientURL)</a>
      <li><a href="#ref-for-match-service-worker-registration⑤">4.3.4. claim()</a>
      <li><a href="#ref-for-match-service-worker-registration⑥">Activate</a>
      <li><a href="#ref-for-match-service-worker-registration⑦">Handle Fetch</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="get-registration">
    <b><a href="#get-registration">#get-registration</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-get-registration">Register</a>
      <li><a href="#ref-for-get-registration①">Update</a>
      <li><a href="#ref-for-get-registration②">Unregister</a>
      <li><a href="#ref-for-get-registration③">Match Service Worker Registration</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="get-newest-worker">
    <b><a href="#get-newest-worker">#get-newest-worker</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-get-newest-worker">3.2.8. update()</a>
      <li><a href="#ref-for-get-newest-worker①">Register</a>
      <li><a href="#ref-for-get-newest-worker②">Update</a>
      <li><a href="#ref-for-get-newest-worker③">Soft Update</a>
      <li><a href="#ref-for-get-newest-worker④">Install</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-has-no-pending-events">
    <b><a href="#service-worker-has-no-pending-events">#service-worker-has-no-pending-events</a></b><b>Referenced
      in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-has-no-pending-events">4.4. ExtendableEvent</a>
      <li><a href="#ref-for-service-worker-has-no-pending-events①">Try Activate</a>
      <li><a href="#ref-for-service-worker-has-no-pending-events②">Try Clear Registration</a> <a
          href="#ref-for-service-worker-has-no-pending-events③">(2)</a> <a
          href="#ref-for-service-worker-has-no-pending-events④">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="create-client">
    <b><a href="#create-client">#create-client</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-create-client">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-create-client①">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="create-window-client">
    <b><a href="#create-window-client">#create-window-client</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-create-window-client">4.2.10. focus()</a>
      <li><a href="#ref-for-create-window-client①">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-create-window-client②">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-create-window-client③">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-create-window-client④">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="get-frame-type">
    <b><a href="#get-frame-type">#get-frame-type</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-get-frame-type">4.2.10. focus()</a>
      <li><a href="#ref-for-get-frame-type①">4.2.11. navigate(url)</a>
      <li><a href="#ref-for-get-frame-type②">4.3.2. matchAll(options)</a>
      <li><a href="#ref-for-get-frame-type③">4.3.3. openWindow(url)</a>
      <li><a href="#ref-for-get-frame-type④">Resolve Get Client Promise</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="resolve-get-client-promise">
    <b><a href="#resolve-get-client-promise">#resolve-get-client-promise</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-resolve-get-client-promise">4.3.1. get(id)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="query-cache">
    <b><a href="#query-cache">#query-cache</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-query-cache">5.4.2. matchAll(request, options)</a>
      <li><a href="#ref-for-query-cache①">5.4.7. keys(request, options)</a>
      <li><a href="#ref-for-query-cache②">Batch Cache Operations</a> <a href="#ref-for-query-cache③">(2)</a> <a
          href="#ref-for-query-cache④">(3)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="request-matches-cached-item">
    <b><a href="#request-matches-cached-item">#request-matches-cached-item</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-request-matches-cached-item">Query Cache</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="batch-cache-operations">
    <b><a href="#batch-cache-operations">#batch-cache-operations</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-batch-cache-operations">5.4.4. addAll(requests)</a>
      <li><a href="#ref-for-batch-cache-operations①">5.4.5. put(request, response)</a>
      <li><a href="#ref-for-batch-cache-operations②">5.4.6. delete(request, options)</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="is-async-module">
    <b><a href="#is-async-module">#is-async-module</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-is-async-module">Update</a>
      <li><a href="#ref-for-is-async-module①">Is Async Module</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker">
    <b><a href="#service-worker">#service-worker</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-service-worker">6.6. Service worker script request</a>
    </ul>
  </aside>
  <aside class="dfn-panel" data-for="service-worker-allowed">
    <b><a href="#service-worker-allowed">#service-worker-allowed</a></b><b>Referenced in:</b>
    <ul>
      <li><a href="#ref-for-service-worker-allowed">6.5. Path restriction</a>
      <li><a href="#ref-for-service-worker-allowed①">Update</a>
    </ul>
  </aside>
  <script>/* script-dfn-panel */

    document.body.addEventListener("click", function (e) {
      var queryAll = function (sel) { return [].slice.call(document.querySelectorAll(sel)); }
      // Find the dfn element or panel, if any, that was clicked on.
      var el = e.target;
      var target;
      var hitALink = false;
      while (el.parentElement) {
        if (el.tagName == "A") {
          // Clicking on a link in a <dfn> shouldn't summon the panel
          hitALink = true;
        }
        if (el.classList.contains("dfn-paneled")) {
          target = "dfn";
          break;
        }
        if (el.classList.contains("dfn-panel")) {
          target = "dfn-panel";
          break;
        }
        el = el.parentElement;
      }
      if (target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function (el) {
          el.classList.remove("on");
          el.classList.remove("activated");
        });
      }
      if (target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if (dfnPanel) {
          dfnPanel.classList.add("on");
          var rect = el.getBoundingClientRect();
          dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
          dfnPanel.style.top = window.scrollY + rect.top + "px";
          var panelRect = dfnPanel.getBoundingClientRect();
          var panelWidth = panelRect.right - panelRect.left;
          if (panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
            // Reposition, because the panel is overflowing
            dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
          }
        } else {
          console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
      } else if (target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
      }

    });
  </script>
  <script>/* script-mdn-anno */

    document.body.addEventListener("click", (e) => {
      if (e.target.closest(".mdn-anno-btn")) {
        e.target.closest(".mdn-anno").classList.toggle("wrapped");
      }
    });
  </script>
  <script>/* script-var-click-highlighting */

    document.addEventListener("click", e => {
      if (e.target.nodeName == "VAR") {
        highlightSameAlgoVars(e.target);
      }
    });
    {
      const indexCounts = new Map();
      const indexNames = new Map();
      function highlightSameAlgoVars(v) {
        // Find the algorithm container.
        let algoContainer = null;
        let searchEl = v;
        while (algoContainer == null && searchEl != document.body) {
          searchEl = searchEl.parentNode;
          if (searchEl.hasAttribute("data-algorithm")) {
            algoContainer = searchEl;
          }
        }

        // Not highlighting document-global vars,
        // too likely to be unrelated.
        if (algoContainer == null) return;

        const algoName = algoContainer.getAttribute("data-algorithm");
        const varName = getVarName(v);
        const addClass = !v.classList.contains("selected");
        let highlightClass = null;
        if (addClass) {
          const index = chooseHighlightIndex(algoName, varName);
          indexCounts.get(algoName)[index] += 1;
          indexNames.set(algoName + "///" + varName, index);
          highlightClass = nameFromIndex(index);
        } else {
          const index = previousHighlightIndex(algoName, varName);
          indexCounts.get(algoName)[index] -= 1;
          highlightClass = nameFromIndex(index);
        }

        // Find all same-name vars, and toggle their class appropriately.
        for (const el of algoContainer.querySelectorAll("var")) {
          if (getVarName(el) == varName) {
            el.classList.toggle("selected", addClass);
            el.classList.toggle(highlightClass, addClass);
          }
        }
      }
      function getVarName(el) {
        return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
      }
      function chooseHighlightIndex(algoName, varName) {
        let indexes = null;
        if (indexCounts.has(algoName)) {
          indexes = indexCounts.get(algoName);
        } else {
          // 7 classes right now
          indexes = [0, 0, 0, 0, 0, 0, 0];
          indexCounts.set(algoName, indexes);
        }

        // If the element was recently unclicked,
        // *and* that color is still unclaimed,
        // give it back the same color.
        const lastIndex = previousHighlightIndex(algoName, varName);
        if (indexes[lastIndex] === 0) return lastIndex;

        // Find the earliest index with the lowest count.
        const minCount = Math.min.apply(null, indexes);
        let index = null;
        for (var i = 0; i < indexes.length; i++) {
          if (indexes[i] == minCount) {
            return i;
          }
        }
      }
      function previousHighlightIndex(algoName, varName) {
        return indexNames.get(algoName + "///" + varName);
      }
      function nameFromIndex(index) {
        return "selected" + index;
      }
    }
  </script>
