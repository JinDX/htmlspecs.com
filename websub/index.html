<!DOCTYPE html>
<html lang="zh-hans" dir="ltr" typeof="bibo:Document"
    prefix="bibo: http://purl.org/ontology/bibo/ w3p: http://www.w3.org/2001/02pd/rec54#">

<head>
    <meta charset="utf-8">
    <!-- <meta name="generator" content="ReSpec 19.0.1"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <style>
        /* --- EXAMPLES --- */
        div.example-title {
            min-width: 7.5em;
            color: #b9ab2d;
        }

        div.example-title span {
            text-transform: uppercase;
        }

        aside.example,
        div.example,
        div.illegal-example {
            padding: 0.5em;
            margin: 1em 0;
            position: relative;
            clear: both;
        }

        div.illegal-example {
            color: red
        }

        div.illegal-example p {
            color: black
        }

        aside.example,
        div.example {
            padding: .5em;
            border-left-width: .5em;
            border-left-style: solid;
            border-color: #e0cb52;
            background: #fcfaee;
        }

        aside.example div.example {
            border-left-width: .1em;
            border-color: #999;
            background: #fff;
        }

        aside.example div.example div.example-title {
            color: #999;
        }
    </style>
    <style>
        /* --- ISSUES/NOTES --- */
        div.issue-title,
        div.note-title,
        div.ednote-title,
        div.warning-title {
            padding-right: 1em;
            min-width: 7.5em;
            color: #b9ab2d;
        }

        div.issue-title {
            color: #e05252;
        }

        div.note-title,
        div.ednote-title {
            color: #2b2;
        }

        div.warning-title {
            color: #f22;
        }

        div.issue-title span,
        div.note-title span,
        div.ednote-title span,
        div.warning-title span {
            text-transform: uppercase;
        }

        div.note,
        div.issue,
        div.ednote,
        div.warning {
            margin-top: 1em;
            margin-bottom: 1em;
        }

        .note>p:first-child,
        .ednote>p:first-child,
        .issue>p:first-child,
        .warning>p:first-child {
            margin-top: 0
        }

        .issue,
        .note,
        .ednote,
        .warning {
            padding: .5em;
            border-left-width: .5em;
            border-left-style: solid;
        }

        div.issue,
        div.note,
        div.ednote,
        div.warning {
            padding: 1em 1.2em 0.5em;
            margin: 1em 0;
            position: relative;
            clear: both;
        }

        span.note,
        span.ednote,
        span.issue,
        span.warning {
            padding: .1em .5em .15em;
        }

        .issue {
            border-color: #e05252;
            background: #fbe9e9;
        }

        .note,
        .ednote {
            border-color: #52e052;
            background: #e9fbe9;
        }

        .warning {
            border-color: #f11;
            border-width: .2em;
            border-style: solid;
            background: #fbe9e9;
        }

        .warning-title:before {
            content: "⚠";
            /*U+26A0 WARNING SIGN*/
            font-size: 3em;
            float: left;
            height: 100%;
            padding-right: .3em;
            vertical-align: top;
            margin-top: -0.5em;
        }

        li.task-list-item {
            list-style: none;
        }

        input.task-list-item-checkbox {
            margin: 0 0.35em 0.25em -1.6em;
            vertical-align: middle;
        }
    </style>
    <meta lang="" property="dc:language" content="en">
    <title>WebSub</title>


    <link rel="pingback" href="https://webmention.io/w3c/xmlrpc">
    <link rel="webmention" href="https://webmention.io/w3c/webmention">
    <style id="respec-mainstyle">
        /*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

        /* Override code highlighter background */
        .hljs {
            background: transparent !important;
        }

        /* --- INLINES --- */
        h1 abbr,
        h2 abbr,
        h3 abbr,
        h4 abbr,
        h5 abbr,
        h6 abbr,
        a abbr {
            border: none;
        }

        dfn {
            font-weight: bold;
        }

        a.internalDFN {
            color: inherit;
            border-bottom: 1px solid #99c;
            text-decoration: none;
        }

        a.externalDFN {
            color: inherit;
            border-bottom: 1px dotted #ccc;
            text-decoration: none;
        }

        a.bibref {
            text-decoration: none;
        }

        cite .bibref {
            font-style: normal;
        }

        code {
            color: #c83500;
        }

        th code {
            color: inherit;
        }

        /* --- TOC --- */

        .toc a,
        .tof a {
            text-decoration: none;
        }

        a .secno,
        a .figno {
            color: #000;
        }

        ul.tof,
        ol.tof {
            list-style: none outside none;
        }

        .caption {
            margin-top: 0.5em;
            font-style: italic;
        }

        /* --- TABLE --- */

        table.simple {
            border-spacing: 0;
            border-collapse: collapse;
            border-bottom: 3px solid #005a9c;
        }

        .simple th {
            background: #005a9c;
            color: #fff;
            padding: 3px 5px;
            text-align: left;
        }

        .simple th[scope="row"] {
            background: inherit;
            color: inherit;
            border-top: 1px solid #ddd;
        }

        .simple td {
            padding: 3px 10px;
            border-top: 1px solid #ddd;
        }

        .simple tr:nth-child(even) {
            background: #f0f6ff;
        }

        /* --- DL --- */

        .section dd>p:first-child {
            margin-top: 0;
        }

        .section dd>p:last-child {
            margin-bottom: 0;
        }

        .section dd {
            margin-bottom: 1em;
        }

        .section dl.attrs dd,
        .section dl.eldef dd {
            margin-bottom: 0;
        }

        #issue-summary>ul,
        .respec-dfn-list {
            column-count: 2;
        }

        #issue-summary li,
        .respec-dfn-list li {
            list-style: none;
        }

        details.respec-tests-details {
            margin-left: 1em;
            display: inline-block;
            vertical-align: top;
        }

        details.respec-tests-details>* {
            padding-right: 2em;
        }

        details.respec-tests-details[open] {
            z-index: 999999;
            position: absolute;
            border: thin solid #cad3e2;
            border-radius: .3em;
            background-color: white;
            padding-bottom: .5em;
        }

        details.respec-tests-details[open]>summary {
            border-bottom: thin solid #cad3e2;
            padding-left: 1em;
            margin-bottom: 1em;
            line-height: 2em;
        }

        details.respec-tests-details>ul {
            width: 100%;
            margin-top: -0.3em;
        }

        details.respec-tests-details>li {
            padding-left: 1em;
        }

        @media print {
            .removeOnSave {
                display: none;
            }
        }
    </style>
    <style>
        /*

github.com style (c) Vasily Polovnyov <vast@whiteants.net>

*/

        .hljs {
            display: block;
            overflow-x: auto;
            padding: 0.5em;
            color: #333;
            background: #f8f8f8;
        }

        .hljs-comment,
        .hljs-quote {
            color: #998;
            font-style: italic;
        }

        .hljs-keyword,
        .hljs-selector-tag,
        .hljs-subst {
            color: #333;
            font-weight: bold;
        }

        .hljs-number,
        .hljs-literal,
        .hljs-variable,
        .hljs-template-variable,
        .hljs-tag .hljs-attr {
            color: #008080;
        }

        .hljs-string,
        .hljs-doctag {
            color: #d14;
        }

        .hljs-title,
        .hljs-section,
        .hljs-selector-id {
            color: #900;
            font-weight: bold;
        }

        .hljs-subst {
            font-weight: normal;
        }

        .hljs-type,
        .hljs-class .hljs-title {
            color: #458;
            font-weight: bold;
        }

        .hljs-tag,
        .hljs-name,
        .hljs-attribute {
            color: #000080;
            font-weight: normal;
        }

        .hljs-regexp,
        .hljs-link {
            color: #009926;
        }

        .hljs-symbol,
        .hljs-bullet {
            color: #990073;
        }

        .hljs-built_in,
        .hljs-builtin-name {
            color: #0086b3;
        }

        .hljs-meta {
            color: #999;
            font-weight: bold;
        }

        .hljs-deletion {
            background: #fdd;
        }

        .hljs-addition {
            background: #dfd;
        }

        .hljs-emphasis {
            font-style: italic;
        }

        .hljs-strong {
            font-weight: bold;
        }
    </style>
    <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/W3C-REC">
    <link rel="canonical" href="https://www.w3.org/TR/websub/">
    <script id="initialUserConfig" type="application/json">{
  "specStatus": "REC",
  "publishDate": "2018-01-23",
  "shortName": "websub",
  "editors": [
    {
      "name": "Julien Genestoux",
      "company": "Invited Expert",
      "url": "https://www.ouvre-boite.com/",
      "w3cid": "49792"
    },
    {
      "name": "Aaron Parecki",
      "company": "Invited Expert",
      "url": "https://aaronparecki.com/",
      "w3cid": "59996"
    }
  ],
  "authors": [
    {
      "name": "Julien Genestoux"
    }
  ],
  "previousMaturity": "PR",
  "previousPublishDate": "2017-10-03",
  "edDraftURI": "https://websub.net/draft",
  "testSuiteURI": "https://websub.rocks/",
  "implementationReportURI": "https://websub.net/implementation-reports",
  "errata": "https://websub.net/errata",
  "wg": "Social Web Working Group",
  "wgURI": "https://www.w3.org/Social/WG",
  "wgPublicList": "public-socialweb",
  "wgPatentURI": "https://www.w3.org/2004/01/pp-impl/72531/status",
  "otherLinks": [
    {
      "key": "Past Authors",
      "data": [
        {
          "value": "Brad Fitzpatrick",
          "href": "https://bradfitz.com/"
        },
        {
          "value": "Brett Slatkin",
          "href": "http://www.onebigfluke.com/"
        },
        {
          "value": "Martin Atkins",
          "href": "http://martin.atkins.me.uk/"
        }
      ]
    },
    {
      "key": "Repository",
      "data": [
        {
          "value": "Github",
          "href": "https://github.com/w3c/websub"
        },
        {
          "value": "Issues",
          "href": "https://github.com/w3c/websub/issues"
        },
        {
          "value": "Commits",
          "href": "https://github.com/w3c/websub/commits/master"
        }
      ]
    }
  ],
  "localBiblio": {
    "PubSubHubbub-Core-0.3": {
      "title": "PubSubHubbub Core 0.3 -- Working Draft",
      "href": "https://pubsubhubbub.github.io/PubSubHubbub/pubsubhubbub-core-0.3.html",
      "authors": [
        "B. Fitzpatrick",
        "B. Slatkin",
        "M. Atkins"
      ]
    },
    "PubSubHubbub-Core-0.4": {
      "title": "PubSubHubbub Core 0.4 -- Working Draft",
      "href": "https://pubsubhubbub.github.io/PubSubHubbub/pubsubhubbub-core-0.4.html",
      "authors": [
        "B. Fitzpatrick",
        "B. Slatkin",
        "M. Atkins",
        "J. Genestoux"
      ]
    },
    "XEP-0060": {
      "title": "Publish-Subscribe",
      "href": "http://www.xmpp.org/extensions/xep-0060.html",
      "authors": [
        "Peter Millard",
        "Peter Saint-Andre",
        "Ralph Meijer"
      ],
      "status": "Draft",
      "publisher": "XMPP Standards Foundation"
    },
    "RSS-2.0": {
      "title": "RSS 2.0",
      "href": "http://www.rssboard.org/rss-specification",
      "authors": [
        "Dave Winer"
      ],
      "status": "Stable",
      "publisher": "RSS Board"
    },
    "FIPS-PUB-180-4": {
      "title": "Secure Hash Standard (SHS)",
      "href": "http://dx.doi.org/10.6028/NIST.FIPS.180-4",
      "authors": [
        "National Institute of Standards and Technology"
      ],
      "publisher": "U.S. Department of Commerce"
    },
    "URL": {
      "title": "URL Standard",
      "href": "https://url.spec.whatwg.org/",
      "authors": [
        "Anne van Kesteren"
      ],
      "status": "Living Standard",
      "publisher": "WHATWG"
    }
  },
  "publishISODate": "2018-01-23T00:00:00.000Z",
  "generatedSubtitle": "Recommendation 23 January 2018"
}</script>
    <meta name="description"
        content="WebSub 提供了一种基于 HTTP web 钩子的、在任何类型 Web 内容发布者与其订阅者之间进行通信的通用机制。订阅请求会通过 hub 转发，hub 会验证和核实请求。一旦有新内容或更新内容可用，hub 会将其分发给订阅者。WebSub 之前被称为 PubSubHubbub。">
</head>

<body aria-busy="false" class="h-entry">
    <div class="head">
        <p>
            <a class="logo" href="https://www.w3.org/"><img width="72" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" alt="W3C"></a>
        </p>
        <p><!--_hyper: -475215410;--></p>
        <h1 class="title p-name" id="title">WebSub</h1>
        <h2 id="w3c-recommendation-23-january-2018"><abbr title="World Wide Web Consortium">W3C</abbr> 推荐规范
            <time class="dt-published" datetime="2018-01-23">2018年1月23日</time>
        </h2>
        <dl>
            <dt>本版本：</dt>
            <dd><a class="u-url"
                    href="https://www.w3.org/TR/2018/REC-websub-20180123/">https://www.w3.org/TR/2018/REC-websub-20180123/</a>
            </dd>
            <dt>最新发布版本：</dt>
            <dd><a href="https://www.w3.org/TR/websub/">https://www.w3.org/TR/websub/</a></dd>
            <dt>最新编辑草案：</dt>
            <dd><a href="https://websub.net/draft">https://websub.net/draft</a></dd>
            <dt>测试套件：</dt>
            <dd><a href="https://websub.rocks/">https://websub.rocks/</a></dd>
            <dt>实现报告：</dt>
            <dd><a href="https://websub.net/implementation-reports">https://websub.net/implementation-reports</a></dd>
            <dt>之前的版本：</dt>
            <dd><a
                    href="https://www.w3.org/TR/2017/PR-websub-20171003/">https://www.w3.org/TR/2017/PR-websub-20171003/</a>
            </dd>
            <dt>编辑：</dt>
            <dd class="p-author h-card vcard" data-editor-id="49792"><a class="u-url url p-name fn"
                    href="https://www.ouvre-boite.com/">Julien Genestoux</a>，受邀专家</dd>
            <dd class="p-author h-card vcard" data-editor-id="59996"><a class="u-url url p-name fn"
                    href="https://aaronparecki.com/">Aaron Parecki</a>，受邀专家</dd>

            <dt>作者：</dt>
            <dd class="p-author h-card vcard"><span class="p-name fn">Julien Genestoux</span></dd>

            <dt>过去的作者：</dt>
            <dd>
                <a href="https://bradfitz.com/">
                    Brad Fitzpatrick
                </a>
            </dd>
            <dd>
                <a href="http://www.onebigfluke.com/">
                    Brett Slatkin
                </a>
            </dd>
            <dd>
                <a href="http://martin.atkins.me.uk/">
                    Martin Atkins
                </a>
            </dd>
            <dt>代码仓库：</dt>
            <dd>
                <a href="https://github.com/w3c/websub">
                    Github
                </a>
            </dd>
            <dd>
                <a href="https://github.com/w3c/websub/issues">
                    问题
                </a>
            </dd>
            <dd>
                <a href="https://github.com/w3c/websub/commits/master">
                    提交记录
                </a>
            </dd>
        </dl>
        <p>
            请查看 <a href="https://websub.net/errata"><strong>勘误表</strong></a> 以获取自发布以来报告的所有错误或问题。
        </p>
        <p>
            另见 <a href="https://www.w3.org/2003/03/Translations/byTechnology?technology=websub">
                <strong>翻译</strong></a>。
        </p>
        <p class="copyright">
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> ©
            2018

            <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
            (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
            <a href="https://www.ercim.eu/"><abbr
                    title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
            <a href="https://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>).
            <abbr title="World Wide Web Consortium">W3C</abbr> <a
                href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
            <a rel="license" href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document">permissive
                document license</a>
            rules apply.
        </p>
        <hr title="Separator for header">
    </div>
    <section id="abstract" class="introductory">
        <h2 id="abstract-0">摘要</h2>
        <p>WebSub 提供了一种基于 HTTP web 钩子的通用机制，用于任何类型 Web 内容的发布者与其订阅者之间的通信。订阅请求通过 hub 转发，hub 会对请求进行验证与核查。当有新的或更新的内容可用时，hub
            会将其分发给订阅者。WebSub 之前被称为 PubSubHubbub。</p>
    </section>

    <section id="sotd" class="introductory">
        <h2 id="status-of-this-document">本文档状态</h2>
        <p>
            <em>本节描述了本文档在发布时的状态。其他文档可能会取代本文件。当前 <abbr title="World Wide Web Consortium">W3C</abbr> 发布的文档列表及本技术报告的最新修订版可在
                <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr>
                    技术报告索引</a>（https://www.w3.org/TR/）中找到。</em>
        </p>

        <p>
            本文档由 <a href="https://www.w3.org/Social/WG">Social Web 工作组</a>发布为一份推荐建议。
            欢迎对本文档提出意见。所有相关方都可以通过工作组的 <a href="https://github.com/w3c/websub/issues">问题追踪器</a>提供实现与漏洞报告及其他意见。这些内容将由 <a
                href="https://www.w3.org/wiki/SocialCG">Social Web 社区组</a>讨论，并在本规范的未来版本中予以考虑。
        </p>
        <p>
            请参阅工作组的 <a href="https://websub.net/implementation-reports">实现报告</a>。
        </p>
        <p>
            本文档经过 <abbr title="World Wide Web Consortium">W3C</abbr> 会员、软件开发者以及其他 <abbr
                title="World Wide Web Consortium">W3C</abbr>
            组织与相关方的审阅，并已由 W3C 董事确认为 <abbr title="World Wide Web Consortium">W3C</abbr> 推荐规范。
            本文档内容稳定，可作为参考材料或被其他文档引用。<abbr title="World Wide Web Consortium">W3C</abbr>
            在制定推荐规范时的作用，是引起对规范的关注并推动其广泛部署。这提升了 Web 的功能性和互操作性。
        </p>
        <p>
            本文档由
            一个遵循
            <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="World Wide Web Consortium">W3C</abbr>
                专利政策</a>运作的小组生成。
            <abbr title="World Wide Web Consortium">W3C</abbr> 维护着一个关于本组交付物的<a
                href="https://www.w3.org/2004/01/pp-impl/72531/status" rel="disclosure">专利披露公开列表</a>；
            该页面还包含专利披露的说明。任何已知某专利并认为其包含<a
                href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">必要权利要求</a>的个人，须按照
            <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">《W3C 专利政策》第6节</a>进行披露。
        </p>
        <p>本文件遵循 <a id="w3c_process_revision" href="https://www.w3.org/2017/Process-20170301/">2017年3月1日 <abbr
                    title="World Wide Web Consortium">W3C</abbr> 流程文件</a>管理。
        </p>


    </section>
    <nav id="toc">
        <h2 class="introductory" id="table-of-contents">目录</h2>
        <ol class="toc">
            <li class="tocline"><a href="#definitions" class="tocxref"><span class="secno">1. </span>术语定义</a>
            </li>
            <li class="tocline"><a href="#high-level-protocol-flow" class="tocxref"><span class="secno">2.
                    </span>协议流程（概述）</a></li>
            <li class="tocline"><a href="#conformance" class="tocxref"><span class="secno">3. </span>一致性</a>
                <ol class="toc">
                    <li class="tocline"><a href="#conformance-classes" class="tocxref"><span class="secno">3.1
                            </span>一致性类别</a></li>
                    <li class="tocline"><a href="#candidate-recommendation-exit-criteria" class="tocxref"><span
                                class="secno">3.2 </span>候选推荐退出标准</a>
                        <ol class="toc">
                            <li class="tocline"><a href="#publisher" class="tocxref"><span class="secno">3.2.1
                                    </span>发布者</a></li>
                            <li class="tocline"><a href="#subscriber" class="tocxref"><span class="secno">3.2.2
                                    </span>订阅者</a></li>
                            <li class="tocline"><a href="#hub" class="tocxref"><span class="secno">3.2.3 </span>Hub</a>
                            </li>
                            <li class="tocline"><a href="#independent" class="tocxref"><span class="secno">3.2.4
                                    </span>独立实现</a></li>
                            <li class="tocline"><a href="#interoperable" class="tocxref"><span class="secno">3.2.5
                                    </span>可互操作</a></li>
                            <li class="tocline"><a href="#feature" class="tocxref"><span class="secno">3.2.6
                                    </span>功能</a></li>
                        </ol>
                    </li>
                </ol>
            </li>
            <li class="tocline"><a href="#discovery" class="tocxref"><span class="secno">4. </span>发现</a>
                <ol class="toc">
                    <li class="tocline"><a href="#content-negotiation" class="tocxref"><span class="secno">4.1
                            </span>内容协商</a></li>
                </ol>
            </li>
            <li class="tocline"><a href="#subscribing-and-unsubscribing" class="tocxref"><span class="secno">5.
                    </span>订阅与取消订阅</a>
                <ol class="toc">
                    <li class="tocline"><a href="#subscriber-sends-subscription-request" class="tocxref"><span
                                class="secno">5.1 </span>订阅者发送订阅请求</a>
                        <ol class="toc">
                            <li class="tocline"><a href="#subscription-parameter-details" class="tocxref"><span
                                        class="secno">5.1.1 </span>订阅参数详情</a></li>
                            <li class="tocline"><a href="#subscription-response-details" class="tocxref"><span
                                        class="secno">5.1.2 </span>订阅响应详情</a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a href="#subscription-validation" class="tocxref"><span class="secno">5.2
                            </span>订阅验证</a></li>
                    <li class="tocline"><a href="#hub-verifies-intent" class="tocxref"><span class="secno">5.3
                            </span>Hub 验证订阅者意图</a>
                        <ol class="toc">
                            <li class="tocline"><a href="#verification-details" class="tocxref"><span
                                        class="secno">5.3.1 </span>验证详情</a></li>
                        </ol>
                    </li>
                </ol>
            </li>
            <li class="tocline"><a href="#publishing" class="tocxref"><span class="secno">6. </span>发布</a>
                <ol class="toc">
                    <li class="tocline"><a href="#subscription-migration" class="tocxref"><span class="secno">6.1
                            </span>订阅迁移</a></li>
                </ol>
            </li>
            <li class="tocline"><a href="#content-distribution" class="tocxref"><span class="secno">7. </span>内容分发</a>
                <ol class="toc">
                    <li class="tocline"><a href="#signing-content" class="tocxref"><span class="secno">7.1
                            </span>认证内容分发</a>
                        <ol class="toc">
                            <li class="tocline"><a href="#recognized-algorithm-names" class="tocxref"><span
                                        class="secno">7.1.1 </span>支持的算法名</a></li>
                            <li class="tocline"><a href="#signature-validation" class="tocxref"><span
                                        class="secno">7.1.2 </span>签名校验</a></li>
                        </ol>
                    </li>
                </ol>
            </li>
            <li class="tocline"><a href="#security-considerations" class="tocxref"><span class="secno">8.
                    </span>安全性注意事项</a>
                <ol class="toc">
                    <li class="tocline"><a href="#discovery-0" class="tocxref"><span class="secno">8.1
                            </span>发现</a></li>
                    <li class="tocline"><a href="#subscriptions" class="tocxref"><span class="secno">8.2
                            </span>订阅</a></li>
                    <li class="tocline"><a href="#distribution" class="tocxref"><span class="secno">8.3
                            </span>分发</a></li>
                    <li class="tocline"><a href="#security-and-privacy-review" class="tocxref"><span class="secno">8.4
                            </span>安全与隐私评估</a></li>
                </ol>
            </li>
            <li class="tocline"><a href="#acknowledgements" class="tocxref"><span class="secno">A.
                    </span>致谢</a></li>
            <li class="tocline"><a href="#change-log" class="tocxref"><span class="secno">B. </span>变更日志</a>
                <ol class="toc">
                    <li class="tocline"><a href="#changes-from-03-october-2017-pr-to-this-version" class="tocxref"><span
                                class="secno">B.1 </span>2017年10月3日PR至本版本的变更</a></li>
                    <li class="tocline"><a href="#changes-from-11-april-2017-cr-to-03-october-2017-pr"
                            class="tocxref"><span class="secno">B.2 </span>2017年4月11日CR至2017年10月3日PR的变更</a></li>
                    <li class="tocline"><a href="#changes-from-24-november-wd-to-11-april-2017-cr" class="tocxref"><span
                                class="secno">B.3 </span>2016年11月24日WD至2017年4月11日CR的变更</a></li>
                    <li class="tocline"><a href="#changes-from-20-october-fpwd-to-24-november-2016"
                            class="tocxref"><span class="secno">B.4 </span>2016年10月20日FPWD至2016年11月24日的变更</a></li>
                </ol>
            </li>
            <li class="tocline"><a href="#references" class="tocxref"><span class="secno">C. </span>参考文献</a>
                <ol class="toc">
                    <li class="tocline"><a href="#normative-references" class="tocxref"><span class="secno">C.1
                            </span>规范性引用</a></li>
                    <li class="tocline"><a href="#informative-references" class="tocxref"><span class="secno">C.2
                            </span>补充性引用</a></li>
                </ol>
            </li>
        </ol>
    </nav>

    <section id="definitions">
        <!--OddPage-->
        <h2 id="x1-definitions"><span class="secno">1. </span>术语定义</h2>
        <dl>
            <dt><dfn data-dfn-type="dfn" id="dfn-topic">主题 (Topic)</dfn></dt>
            <dd>一个 HTTP [<cite><a class="bibref" href="#bib-RFC7230">RFC7230</a></cite>]（或 HTTPS [<cite><a
                        class="bibref" href="#bib-RFC2818">RFC2818</a></cite>]）资源 URL。是可以订阅其变更的基本单元。</dd>
            <dt><dfn data-dfn-type="dfn" id="dfn-hub-the-hub">Hub（“hub”）</dfn></dt>
            <dd>实现该协议两端的服务器（URL [<cite><a class="bibref" href="#bib-URL">URL</a></cite>]）。任何 hub <em class="rfc2119"
                    title="MAY">可以</em>
                实现自己关于可用用户的策略。</dd>
            <dt><dfn data-dfn-type="dfn" id="dfn-publisher">发布者 (Publisher)</dfn></dt>
            <dd>主题的拥有者。在主题 feed 被更新时通知 hub。和几乎所有的 pubsub 系统一样，发布者并不知道存在的订阅者。其他 pubsub 系统可能称发布者为 “source”。</dd>
            <dt><dfn data-dfn-type="dfn" id="dfn-subscriber">订阅者 (Subscriber)</dfn></dt>
            <dd>希望被通知某主题变更的实体（个人或程序）。订阅者必须可以被直接访问，并由其订阅者回调 URL 标识。</dd>
            <dt><dfn data-dfn-type="dfn" id="dfn-subscription">订阅 (Subscription)</dfn></dt>
            <dd>订阅者与一个主题的唯一关系，表示应接收该主题的更新。唯一标识为（主题 URL，订阅者回调 URL）二元组。订阅（由 hub 决定）可能有类 DHCP 租期的过期时间，需要周期续订。</dd>
            <dt><dfn data-dfn-type="dfn" id="dfn-subscriber-callback-url">订阅者回调 URL</dfn></dt>
            <dd>订阅者希望接收到内容分发请求的 URL [<cite><a class="bibref" href="#bib-URL">URL</a></cite>]。</dd>
            <dt><dfn data-dfn-type="dfn" id="dfn-event">事件 (Event)</dfn></dt>
            <dd>导致多个主题更新的事件。每次事件发生时（如 “Brad 发帖到 Linux 社区。”），可能影响多个主题（如 “Brad 发帖。”以及 “Linux 社区有新帖子”）。发布者事件更新主题，hub
                查找所有受影响主题的订阅并将内容推送给订阅者。</dd>
            <dt><dfn data-dfn-type="dfn" id="dfn-content-distribution-notification">内容分发通知</dfn> / <dfn
                    data-dfn-type="dfn" id="dfn-content-distribution-request">（内容分发请求）</dfn></dt>
            <dd>描述主题内容变化或者完整内容的有效负载。根据主题内容类型，内容差异（或“增量”）可由 hub 计算并发送给所有订阅者。</dd>
        </dl>
    </section>

    <section id="high-level-protocol-flow">
        <!--OddPage-->
        <h2 id="x2-high-level-protocol-flow"><span class="secno">2. </span>协议流程（概述）</h2>
        <p>（本节为非规范性内容。）</p>
        <img src="https://www.w3.org/TR/websub/websub-overview.svg" style="width:100%" alt="WebSub 协议流程图">
        <!-- SVG generated at https://sequencediagram.org/index.html?initialData=C4S2BsFMAIHVIEYGUCuDoDFwHsDu0AREAQwHMAnYgWwCgaAFNcEAZwAtJyAeAWlQRYBjciAScAXPyEix5aABNWg7ADdOLaMA7QAVDrZo9AHQB2xeWvKgWkedAQBPaAAcmrDuQDkGvcGzOQQT0aKWFRTh4APgAJNEk0aXC5KmIAa0gNYmh6AHkkABVNbE1tPQMEPSLoFgSwsSqUZ3liYAzoYgRsFGBdHT8AoJ0Q2plOXh5YhHFoSehLEAAzEDatGBqBMOdQbBN24FaqLehcMDZ26ABxAFF8hjd2CJi4xgRmB7kTbFAlldL9Qx0pmwC2gJkg+GUJlaUJokyioVG5Gms3kkGYlg0q2gkOhwA0wN6-UClT80EgxEEZ3WiVkx1O51yBSAA -->
        <ul>
            <li>订阅者发现主题 URL 的 hub，并向一个或多个公布的 hub 发送 POST 请求，以便在主题发生变化时收到更新。</li>
            <li>发布者在其主题发生变化时通知 hub 的 URL。</li>
            <li>当 hub 检测到主题变更时，会向所有已注册订阅者发送内容分发通知。</li>
        </ul>
        <p>本协议早期版本称为 PubSubHubbub：</p>
        <ul>
            <li>工作草案 0.3 [<cite><a class="bibref" href="#bib-PubSubHubbub-Core-0.3">PubSubHubbub-Core-0.3</a></cite>]
            </li>
            <li>工作草案 0.4 [<cite><a class="bibref" href="#bib-PubSubHubbub-Core-0.4">PubSubHubbub-Core-0.4</a></cite>]
            </li>
        </ul>
    </section>

    <section id="conformance">
        <!--OddPage-->
        <h2 id="x3-conformance"><span class="secno">3. </span>一致性</h2>

        <p>本文件中的“<em class="rfc2119" title="MUST">必须</em>”、“<em class="rfc2119" title="MUST NOT">禁止</em>”、“<em
                class="rfc2119" title="REQUIRED">必须</em>”、“<em class="rfc2119" title="SHALL">应当</em>”、“<em
                class="rfc2119" title="SHALL NOT">不应当</em>”、“<em class="rfc2119" title="SHOULD">建议</em>”、“<em
                class="rfc2119" title="SHOULD NOT">不建议</em>”、“<em class="rfc2119" title="RECOMMENDED">推荐</em>”、“<em
                class="rfc2119" title="MAY">可以</em>” 以及 “<em class="rfc2119" title="OPTIONAL">可选</em>”
            的术语，其含义遵循 [<cite><a class="bibref" href="#bib-RFC2119">RFC2119</a></cite>] 的定义。</p>

        <section id="conformance-classes">
            <h3 id="x3-1-conformance-classes"><span class="secno">3.1 </span>一致性类别</h3>

            <p>WebSub 描述三种角色：发布者、订阅者和 hub。本节针对每种角色的合规标准做说明。</p>

            <h3 id="publishers">发布者</h3>

            <ul>
                <li>合规的发布者 <em class="rfc2119" title="MUST">必须</em> 如<a href="#discovery">发现</a>小节所述，公布某一资源 URL 的主题和 hub
                    URL。</li>
            </ul>

            <h3 id="subscribers">订阅者</h3>

            <p>合规的订阅者：</p>

            <ul>
                <li><em class="rfc2119" title="MUST">必须</em> 按规定顺序支持每一种发现机制，以发现主题和 hub 的 URL，如<a
                        href="#discovery">发现</a>所述。</li>
                <li><em class="rfc2119" title="MUST">必须</em> 如<a
                        href="#subscriber-sends-subscription-request">订阅者发送订阅请求</a>所述，发送订阅请求。</li>
                <li><em class="rfc2119" title="MAY">可以</em> 请求特定的租期时长</li>
                <li><em class="rfc2119" title="MAY">可以</em> 在订阅请求中包含 secret，如果包含 secret，则 <em class="rfc2119"
                        title="MUST">必须</em> 用该 secret 验证 <a href="#authenticated-content-distribution">内容分发请求</a>中的签名。
                </li>
                <li><em class="rfc2119" title="MUST">必须</em> 用 HTTP 2xx 状态码确认收到内容分发请求。</li>
                <li><em class="rfc2119" title="MAY">可以</em> 通过 “unsubscribe” 机制请求取消订阅。</li>
            </ul>

            <h4 id="hubs">Hub</h4>

            <p>合规的 hub：</p>

            <ul>
                <li><em class="rfc2119" title="MUST">必须</em> 接受带有参数 <code>hub.callback</code>、<code>hub.mode</code> 和
                    <code>hub.topic</code> 的订阅请求。
                </li>
                <li><em class="rfc2119" title="MUST">必须</em> 接受带有 <code>hub.secret</code> 参数的订阅请求。
                </li>
                <li><em class="rfc2119" title="MAY">可以</em> 按请求的租期参数处理订阅。</li>
                <li><em class="rfc2119" title="MUST">必须</em> 允许订阅者重新请求已经激活的订阅。</li>
                <li><em class="rfc2119" title="MUST">必须</em> 支持取消订阅请求。</li>
                <li><em class="rfc2119" title="MUST">必须</em> 发送与主题 URL 类型相匹配的内容分发请求。（参见<a
                        href="#content-negotiation">内容协商</a>）</li>
                <li><em class="rfc2119" title="MAY">可以</em> 对受支持格式，将内容分发负载减为内容的 diff，详见<a
                        href="#content-distribution">内容分发</a>。</li>
                <li><em class="rfc2119" title="MUST">必须</em> 对由 <code>hub.secret</code> 创建的订阅，发送
                    <code>X-Hub-Signature</code> 头，如<a href="#authenticated-content-distribution">认证的内容分发</a>所述。
                </li>
            </ul>

        </section>
        <section id="candidate-recommendation-exit-criteria">
            <h3 id="x3-2-candidate-recommendation-exit-criteria"><span class="secno">3.2 </span>候选推荐退出标准</h3>

            <p>本规范退出 CR 阶段时，每项功能至少有两个独立、可互操作的实现。每项功能可由不同产品实现。没有要求所有功能由同一产品实现。为本标准之目的，定义如下术语：</p>

            <section id="publisher">
                <h4 id="x3-2-1-publisher"><span class="secno">3.2.1 </span>发布者</h4>
                <p>WebSub 发布者是在一个或多个资源 URL 上发布主题和 hub URL 的实现。符合性标准如上面<a href="#conformance-classes">一致性类别</a>所述。</p>
            </section>

            <section id="subscriber">
                <h4 id="x3-2-2-subscriber"><span class="secno">3.2.2 </span>订阅者</h4>
                <p>WebSub 订阅者是指给定资源 URL 后，可以发现 hub 和主题 URL、向 hub 订阅并接收 hub 发来的内容分发请求的实现。订阅者 <em class="rfc2119"
                        title="MAY">可以</em>
                    支持<a href="#authenticated-content-distribution">认证内容分发</a>。符合性标准如<a
                        href="#conformance-classes">一致性类别</a>所述。
                </p>
            </section>

            <section id="hub">
                <h4 id="x3-2-3-hub"><span class="secno">3.2.3 </span>Hub</h4>
                <p>WebSub hub 负责处理订阅请求，并在对应主题 URL 被更新时向订阅者分发内容。hub <em class="rfc2119" title="MUST">必须</em> 支持带有 secret
                    的订阅请求，并在需要时交付 <a href="#authenticated-content-distribution">认证请求</a>。hub <em class="rfc2119"
                        title="MUST">必须</em> 在请求中交付主题 URL 的全部内容，并且 <em class="rfc2119" title="MAY">可以</em>
                    在内容类型支持时，将负载减为增量（diff）。符合性标准如<a href="#conformance-classes">一致性类别</a>所述。</p>
            </section>

            <section id="independent">
                <h4 id="x3-2-4-independent"><span class="secno">3.2.4 </span>独立实现</h4>
                <p>每个实现必须由不同方开发，不能共享、复用或派生自其他合格实现的代码。与本规范实现无关的代码部分可不受此约束。</p>
            </section>

            <section id="interoperable">
                <h4 id="x3-2-5-interoperable"><span class="secno">3.2.5 </span>可互操作</h4>
                <p>当 hub 能按定义行为响应订阅者请求、订阅者获得 hub 预期响应且 hub 向订阅者发回规范响应，则该特性在订阅者和 hub 之间视为可互操作。</p>
            </section>

            <section id="feature">
                <h4 id="x3-2-6-feature"><span class="secno">3.2.6 </span>功能</h4>
                <p>为评估退出标准，下列每一项都视为一个功能：</p>
                <ul>
                    <li>通过查看资源 URL 的 HTTP 头信息发现 hub 和主题 URL。</li>
                    <li>通过将资源 URL 内容视为 XML 文档发现 hub 和主题 URL。</li>
                    <li>通过将资源 URL 内容视为 HTML 文档发现 hub 和主题 URL。</li>
                    <li>用回调 URL 向 hub 订阅。</li>
                    <li>向 hub 订阅并请求特定的租期时长。</li>
                    <li>用 secret 订阅 hub 并处理认证内容分发。</li>
                    <li>通过发送取消请求要求取消订阅。</li>
                    <li>订阅者在验证请求中确认待处理订阅。</li>
                    <li>订阅者对无效主题 URL 的订阅验证请求进行拒绝。</li>
                    <li>负载分发时订阅者返回 HTTP 2xx 响应。</li>
                    <li>订阅者验证认证内容分发请求的签名。</li>
                    <li>签名未通过时，订阅者拒绝分发请求。</li>
                    <li>若使用 secret 建立订阅但分发请求无签名时，订阅者拒绝请求。</li>
                    <li>hub 在订阅请求期间遵守请求的租期时长。</li>
                    <li>hub 允许订阅者重新请求已激活订阅，延长租期。</li>
                    <li>hub 在分发请求中发送主题 URL 的全部内容。</li>
                    <li>hub 对于支持的格式，发送主题 URL 的 diff。</li>
                    <li>hub 为用 secret 订阅的情况发送有效签名。</li>
                </ul>
            </section>

        </section>
    </section>

    <section id="discovery">
        <!--OddPage-->
        <h2 id="x4-discovery"><span class="secno">4. </span>发现</h2>
        <p>发现机制旨在找出至少 2 个 URL。</p>
        <ul>
            <li>发布者指定的一个或多个 hub 的 URL。如果指定了不止一个 hub URL，期望发布者通知每个 hub，因此订阅者可选订阅其中一个或多个。</li>
            <li>订阅者实际用于订阅的规范主题 URL。</li>
        </ul>
        <div class="note">
            <div role="heading" class="note-title marker" id="h-note" aria-level="3"><span>注意</span></div>
            <p class="">发布者可以选择向多个 hub 广播和发布，以实现容错和冗余。如果某一个 hub 未能转发文档更新，采用多个独立 hub 能提升通知订阅者的成功率。因此，订阅者可选择订阅多个公布的 hub。
            </p>
        </div>
        <p>当前协议支持如下发现机制。发布者 <em class="rfc2119" title="MUST">必须</em> 至少实现其中一种：</p>
        <ul>
            <li>Link 头信息 [<cite><a class="bibref" href="#bib-RFC5988">RFC5988</a></cite>]：发布者 <em class="rfc2119"
                    title="SHOULD">建议</em> 至少包含一个 <samp>rel=hub</samp> 的 Link 头（hub 链接头）以及一个 <samp>rel=self</samp> 的
                Link 头（self 链接头）。
            </li>
            <li>如果主题是基于 XML 的 feed，发布者 <em class="rfc2119" title="SHOULD">建议</em> 嵌入链接元素，详见 Web Linking [<cite><a
                        class="bibref" href="#bib-RFC5988">RFC5988</a></cite>] 的附录 B。对于 HTML 页面，发布者 <em class="rfc2119"
                    title="SHOULD">建议</em> 按附录 A 中的方式嵌入 link 元素。</li>
        </ul>

        <div class="note">
            <div role="heading" class="note-title marker" id="h-note-0" aria-level="3"><span>注意</span></div>
            <p class="">由于 <samp>&lt;link&gt;</samp> 元素多年限定于 <samp>&lt;head&gt;</samp> 中，一些代码只会检测
                <samp>&lt;head&gt;</samp>。因此，将 <samp>&lt;link&gt;</samp> 标签只放在 HTML <samp>&lt;head&gt;</samp> 中更为稳妥，不宜放入
                <samp>&lt;body&gt;</samp>。
            </p>
        </div>

        <div class="example">
            <div class="example-title marker"><span>示例 1</span></div>
            <pre class="hljs http" aria-busy="false" aria-live="polite"><span class="hljs-keyword">GET</span> <span class="hljs-string">/feed</span> HTTP/1.1
<span class="hljs-attribute">Host</span>: example.com

<span class="http">HTTP/1.1 <span class="hljs-number">200</span> Ok
<span class="hljs-attribute">Content-type</span>: text/html
<span class="hljs-attribute">Link</span>: &lt;https://hub.example.com/&gt;; rel="hub"
<span class="hljs-attribute">Link</span>: &lt;http://example.com/feed&gt;; rel="self"

<span class="xml"><span class="hljs-meta">&lt;!doctype html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"hub"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://hub.example.com/"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"self"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"http://example.com/feed"</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    ...
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span></span></pre>
        </div>

        <p>执行发现时，订阅者 <em class="rfc2119" title="MUST">必须</em> 依次实现以下三种发现机制，并在首次成功后停止：</p>
        <ol>
            <li>对主题 URL 发起 GET 或 HEAD 请求。订阅者 <em class="rfc2119" title="MUST">必须</em> 优先检查 HTTP Link 头。</li>
            <li>若 HTTP Link 头不存在，且主题为 XML feed 或 HTML 页面，订阅者 <em class="rfc2119" title="MUST">必须</em> 检查嵌入的 link 元素。
            </li>
        </ol>

        <section id="content-negotiation">
            <h3 id="x4-1-content-negotiation"><span class="secno">4.1 </span>内容协商</h3>
            <p>
                出于实际目的，<samp>rel=self</samp> 的 URL 最好只提供单一表现形式。因为 hub 无法获知订阅者请求发现时请求了何种媒体类型（[<cite><a class="bibref"
                        href="#bib-RFC6838">RFC6838</a></cite>]）或语言，所以无法用合适的内容版本推送分发。
            </p>
            <p>
                但可以通过为初始发现请求中的 HTTP 头返回不同的 <samp>rel=self</samp> URL 来实现内容协商。例如，请求 <samp>/feed</samp> 时带
                <samp>Accept</samp> 头为 <samp>application/json</samp>，可返回 <samp>rel=self</samp> 值为
                <samp>/feed.json</samp>。
            </p>
            <p>下例展示了主题 URL 可根据 <samp>Accept</samp> 头返回不同的 <samp>Link</samp> 头：</p>
            <div class="example">
                <div class="example-title marker"><span>示例 2</span></div>
                <pre class="hljs http" aria-busy="false" aria-live="polite"><span class="hljs-keyword">GET</span> <span class="hljs-string">/feed</span> HTTP/1.1
<span class="hljs-attribute">Host</span>: example.com
<span class="hljs-attribute">Accept</span>: application/json

<span class="http">HTTP/1.1 <span class="hljs-number">200</span> Ok
<span class="hljs-attribute">Content-type</span>: application/json
<span class="hljs-attribute">Link</span>: &lt;/feed.json&gt;; rel="self"
<span class="hljs-attribute">Link</span>: &lt;https://hub.example.com/&gt;; rel="hub"

<span class="json">{
  <span class="hljs-attr">"items"</span>: [...]
}</span></span></pre>
            </div>
            <div class="example">
                <div class="example-title marker"><span>示例 3</span></div>
                <pre class="hljs http" aria-busy="false" aria-live="polite"><span class="hljs-keyword">GET</span> <span class="hljs-string">/feed</span> HTTP/1.1
<span class="hljs-attribute">Host</span>: example.com
<span class="hljs-attribute">Accept</span>: text/html

<span class="http">HTTP/1.1 <span class="hljs-number">200</span> Ok
<span class="hljs-attribute">Content-type</span>: text/html
<span class="hljs-attribute">Link</span>: &lt;/feed.html&gt;; rel="self"
<span class="hljs-attribute">Link</span>: &lt;https://hub.example.com/&gt;; rel="hub"

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
...</span></span></pre>
            </div>
            <p>同理，也可根据 <samp>Accept-Language</samp> 头返回不同的 <samp>rel=self</samp> URL。</p>
            <div class="example">
                <div class="example-title marker"><span>示例 4</span></div>
                <pre class="hljs http" aria-busy="false" aria-live="polite"><span class="hljs-keyword">GET</span> <span class="hljs-string">/feed</span> HTTP/1.1
<span class="hljs-attribute">Host</span>: example.com
<span class="hljs-attribute">Accept-Language</span>: de-DE

<span class="http">HTTP/1.1 <span class="hljs-number">200</span> Ok
<span class="hljs-attribute">Content-type</span>: text/html

<span class="http"><span class="hljs-attribute">Link</span>: &lt;/feed-de.json&gt;; rel="self"
<span class="hljs-attribute">Link</span>: &lt;https://hub.example.com/&gt;; rel="hub"

<span class="json">{
  <span class="hljs-attr">"items"</span>: [...]
}</span></span></span></pre>
            </div>

        </section>

    </section>

    <section id="subscribing-and-unsubscribing">
        <!--OddPage-->
        <h2 id="x5-subscribing-and-unsubscribing"><span class="secno">5. </span>订阅与取消订阅</h2>
        <p>订阅主题 URL 包含四个部分，这些部分可以立刻依次发生，也可以有延迟。</p>
        <ul>
            <li>订阅者向 hub 发送订阅请求</li>
            <li>hub 验证订阅请求并可选地与发布者验证（<em class="rfc2119" title="OPTIONAL">可选</em>）</li>
            <li>hub 确认订阅真正由订阅者发起</li>
            <li>hub 定期重新确认订阅仍然有效（<em class="rfc2119" title="OPTIONAL">可选</em>）</li>
        </ul>
        <p>取消订阅的步骤相同，只是用单独的参数表示取消操作。此外，Hub 不会向发布者验证取消订阅请求。</p>
        <section id="subscriber-sends-subscription-request">
            <h3 id="x5-1-subscriber-sends-subscription-request"><span class="secno">5.1 </span>订阅者发送订阅请求</h3>
            <p>订阅由订阅者向 hub URL 发起 HTTPS 或 HTTP POST [<cite><a class="bibref" href="#bib-RFC7231">RFC7231</a></cite>]
                请求开始。此请求<em class="rfc2119" title="MUST">必须</em>使用 <samp>application/x-www-form-urlencoded</samp> 的
                Content-Type 头（详见 4.10.22.6 [<cite><a class="bibref" href="#bib-HTML5">HTML5</a></cite>]），<em
                    class="rfc2119" title="MUST">必须</em>使用 UTF-8 [<cite><a class="bibref"
                        href="#bib-Encoding">Encoding</a></cite>] 作为文档字符编码，并<em class="rfc2119"
                    title="MUST">必须</em>在请求体中按如下格式包含以下参数：</p>
            <dl>
                <dt>hub.callback</dt>
                <dd><em class="rfc2119" title="REQUIRED">必需</em>。订阅者用于接收内容分发通知的回调 URL。回调 URL <em class="rfc2119"
                        title="SHOULD">应当</em>为每个订阅唯一、不可猜测的 URL。([<cite><a class="bibref"
                            href="#bib-capability-urls">capability-urls</a></cite>])</dd>
                <dt>hub.mode</dt>
                <dd><em class="rfc2119" title="REQUIRED">必需</em>。字面量字符串 "subscribe" 或 "unsubscribe"，取决于请求的目标。</dd>
                <dt>hub.topic</dt>
                <dd><em class="rfc2119" title="REQUIRED">必需</em>。订阅者希望订阅或取消订阅的主题 URL。注意，这<em class="rfc2119"
                        title="MUST">必须</em>是发现阶段获得的 "self" URL，可能与用于发现的 URL 不同。</dd>
                <dt>hub.lease_seconds</dt>
                <dd><em class="rfc2119" title="OPTIONAL">可选</em>。期望订阅保持有效的秒数，为正整数。Hub <em class="rfc2119"
                        title="MAY">可以</em>根据自身策略决定是否采用该值，也<em class="rfc2119" title="MAY">可以</em>在未指定时设置默认值。该参数<em
                        class="rfc2119" title="MAY">可以</em>存在于取消订阅请求中，此时 hub <em class="rfc2119"
                        title="MUST">必须</em>忽略该参数。
                </dd>
                <dt>hub.secret</dt>
                <dd><em class="rfc2119" title="OPTIONAL">可选</em>。订阅者提供的加密随机唯一密钥字符串，用于 <a
                        href="#authenticated-content-distribution">认证的内容分发</a> 的 HMAC 签名。如果未提供，内容分发请求不会有 HMAC 签名。该参数<em
                        class="rfc2119" title="SHOULD">应当</em>只在 HTTPS [<cite><a class="bibref"
                            href="#bib-RFC2818">RFC2818</a></cite>] 下使用，且<em class="rfc2119" title="MUST">必须</em>小于 200
                    字节。</dd>
            </dl>
            <p>订阅者 <em class="rfc2119" title="MAY">可以</em>根据 hub 要求，添加额外的 HTTP [<cite><a class="bibref"
                        href="#bib-RFC7230">RFC7230</a></cite>] 参数或请求头。</p>
            <p>hub <em class="rfc2119" title="MUST">必须</em> 忽略它不理解的额外参数。</p>
            <p>hub <em class="rfc2119" title="MUST">必须</em>允许订阅者重新请求已激活的订阅。每次向 hub 发送的订阅或取消请求<em class="rfc2119"
                    title="MUST">必须</em>在对应主题 URL 与回调 URL 的组合下覆盖之前的订阅状态，但前提是操作已被验证（<a
                    href="#hub-verifies-intent">4.3节</a>）。如果验证失败，订阅状态<em class="rfc2119"
                    title="MUST">必须</em>保持不变。这样订阅者可以在租期到期前无缝续订。订阅者<em class="rfc2119" title="MAY">可以</em>在下次订阅时使用新
                hub.secret 或不带 secret。</p>
            <section id="subscription-parameter-details">
                <h4 id="x5-1-1-subscription-parameter-details"><span class="secno">5.1.1 </span>订阅参数详情</h4>
                <p>主题和回调 URL <em class="rfc2119" title="MAY">可以</em>使用 HTTP [<cite><a class="bibref"
                            href="#bib-RFC7230">RFC7230</a></cite>] 或 HTTPS [<cite><a class="bibref"
                            href="#bib-RFC2818">RFC2818</a></cite>] 协议。主题 URL <em class="rfc2119"
                        title="MUST">必须</em>是发布者在自引用 Link 头中公布的 URL（见<a href="#discovery">第3节</a>）。Hub <em
                        class="rfc2119" title="MAY">可以</em> 拒绝与发布者声明不符的主题 URL。除此之外，主题 URL 可按 URL 规范自由选择 [<cite><a
                            class="bibref" href="#bib-URL">URL</a></cite>]。Hub <em class="rfc2119"
                        title="MUST">必须</em>始终对这些 URL 参数解码非保留字符，见 [<cite><a class="bibref"
                            href="#bib-URL">URL</a></cite>] 1.2节 <em>“百分号编码字节”</em>。</p>
                <p>回调 URL <em class="rfc2119" title="SHOULD">建议</em>为不可猜测的唯一 URL ([<cite><a class="bibref"
                            href="#bib-capability-urls">capability-urls</a></cite>])，并<em class="rfc2119"
                        title="SHOULD">建议</em>使用 HTTPS [<cite><a class="bibref"
                            href="#bib-RFC7230">RFC7230</a></cite>]。回调 URL 在 hub 验证订阅和分发内容时起到身份认证作用。同时，回调 <em
                        class="rfc2119" title="SHOULD">建议</em>唯一（不要多 hub 重复使用）且续订时更换。</p>
                <p>回调 URL <em class="rfc2119" title="MAY">可以</em>带任意查询参数（如 <samp>?foo=bar&amp;red=fish</samp>）。hub <em
                        class="rfc2119" title="MUST">必须</em>在验证时保留查询串，添加新参数时用 &amp; 连接，且不会覆盖已存在的重名参数。Hub
                    发送内容分发请求时，会将查询参数包含在 URL 部分（而非 POST body）。</p>
            </section>
            <section id="subscription-response-details">
                <h4 id="x5-1-2-subscription-response-details"><span class="secno">5.1.2 </span>订阅响应详情</h4>
                <p>若 hub URL 支持 WebSub 并能处理订阅或取消请求，则<em class="rfc2119" title="MUST">必须</em>以 HTTP [<cite><a
                            class="bibref" href="#bib-RFC7231">RFC7231</a></cite>] 202 "Accepted" 响应，表示请求已收到，将进行验证（<a
                        href="#hub-verifies-intent">4.3 节</a>）和确认（<a href="#subscription-validation">4.2 节</a>）。hub <em
                        class="rfc2119" title="SHOULD">应尽快</em>完成验证。</p>
                <p>若 hub 检测到订阅请求有误，<em class="rfc2119" title="MUST">必须</em>返回合适的 HTTP [<cite><a class="bibref"
                            href="#bib-RFC7231">RFC7231</a></cite>] 错误码（4xx 或 5xx）。错误响应<em class="rfc2119"
                        title="SHOULD">应当</em>返回纯文本错误描述，便于客户端开发者定位原因（不用于终端用户）。hub <em class="rfc2119"
                        title="MAY">可以</em>根据自身策略（如域名授权、主题 URL 端口等）拒绝某些回调或主题 URL。但因验证和确认都是异步过程，HTTP 响应<em
                        class="rfc2119" title="MUST NOT">禁止</em>依赖验证或确认的进程或结果。</p>
                <p>若 hub URL 无法处理订阅或取消请求，<em class="rfc2119" title="MAY">可以</em>重定向至另一个支持 WebSub 的 hub，可用 HTTP [<cite><a
                            class="bibref" href="#bib-RFC7231">RFC7231</a></cite>] 307（临时重定向）或 308（永久重定向）实现。<em
                        class="rfc2119" title="MUST">必须</em>包含至少一个 HTTP [<cite><a class="bibref"
                            href="#bib-RFC7230">RFC7230</a></cite>] Location 头，给出订阅者可用的 hub 新 URL。订阅者需在新 hub URL
                    重试订阅或取消请求。</p>
            </section>
        </section>
        <section id="subscription-validation">
            <h3 id="x5-2-subscription-validation"><span class="secno">5.2 </span>订阅验证</h3>
            <p>hub <em class="rfc2119" title="MAY">可以</em>要求进一步信息以决定是否接受订阅，也<em class="rfc2119"
                    title="MAY">可以</em>与发布者核实是否允许订阅。</p>
            <p>当订阅被接受时，hub <em class="rfc2119" title="MUST">必须</em>对订阅者进行<a href="#hub-verifies-intent">意图验证</a>。</p>
            <p>如果订阅被拒绝，hub <em class="rfc2119" title="MUST">必须</em>向订阅者回调 URL 发送 HTTP [<cite><a class="bibref"
                        href="#bib-RFC7231">RFC7231</a></cite>]（或 HTTPS [<cite><a class="bibref"
                        href="#bib-RFC2818">RFC2818</a></cite>]）GET 请求，通知订阅被拒绝。该请求会追加如下查询参数（格式见 [<cite><a class="bibref"
                        href="#bib-URL">URL</a></cite>] 第4节）：</p>
            <dl>
                <dt>hub.mode</dt>
                <dd><em class="rfc2119" title="REQUIRED">必需</em>。字面量字符串 "denied"。</dd>
                <dt>hub.topic</dt>
                <dd><em class="rfc2119" title="REQUIRED">必需</em>。对应订阅请求中的主题 URL。</dd>
                <dt>hub.reason</dt>
                <dd><em class="rfc2119" title="OPTIONAL">可选</em>。hub 可附带拒绝原因。</dd>
            </dl>
            <p>hub 可在任意时间点（即使之前已接受）拒绝订阅。此时订阅者<em class="rfc2119" title="SHOULD">应当</em>认为无法订阅此主题。</p>
        </section>
        <section id="hub-verifies-intent">
            <h3 id="x5-3-hub-verifies-intent-of-the-subscriber"><span class="secno">5.3 </span>Hub 验证订阅者意图</h3>
            <p>为防止攻击者替订阅者创建/删除订阅，hub 必须确保订阅请求确实由订阅者本人发送。</p>
            <p>hub 会向订阅者回调 URL 发送 HTTP [<cite><a class="bibref" href="#bib-RFC7231">RFC7231</a></cite>]（或 HTTPS
                [<cite><a class="bibref" href="#bib-RFC2818">RFC2818</a></cite>]）GET 请求，附带以下查询参数（格式见 [<cite><a
                        class="bibref" href="#bib-URL">URL</a></cite>] 第4节）：</p>
            <dl>
                <dt><samp>hub.mode</samp></dt>
                <dd><em class="rfc2119" title="REQUIRED">必需</em>。字面量字符串 "<samp>subscribe</samp>" 或
                    "<samp>unsubscribe</samp>"，与订阅者原始请求一致。</dd>
                <dt><samp>hub.topic</samp></dt>
                <dd><em class="rfc2119" title="REQUIRED">必需</em>。对应订阅请求中的主题 URL。</dd>
                <dt><samp>hub.challenge</samp></dt>
                <dd><em class="rfc2119" title="REQUIRED">必需</em>。hub 生成的随机字符串，订阅者<em class="rfc2119"
                        title="MUST">必须</em>原样返回以验证订阅。</dd>
                <dt><samp>hub.lease_seconds</samp></dt>
                <dd><em class="rfc2119" title="REQUIRED">必需</em>/<em class="rfc2119" title="OPTIONAL">可选</em>。hub
                    确定的订阅有效秒数，从验证请求发出时开始计。hub <em class="rfc2119" title="MUST">必须</em>在 <samp>hub.mode</samp> 为
                    "subscribe" 时给出此参数，"unsubscribe" 时<em class="rfc2119" title="MAY">可以</em>包含且订阅者<em class="rfc2119"
                        title="MUST">必须</em>忽略。
                </dd>
            </dl>
            <section id="verification-details">
                <h4 id="x5-3-1-verification-details"><span class="secno">5.3.1 </span>验证详情</h4>
                <p>订阅者<em class="rfc2119" title="MUST">必须</em>确认 <samp>hub.topic</samp> 对应其准备执行的待定订阅或取消操作。如是，则<em
                        class="rfc2119" title="MUST">必须</em>以 HTTP 成功（2xx）码响应，且响应体等于
                    <samp>hub.challenge</samp>。如不同意该操作，应<em class="rfc2119" title="MUST">必须</em>以 404 "Not Found" 响应。
                </p>
                <p>hub 必须将服务器端其他响应码（3xx、4xx、5xx）视为验证失败。如订阅者返回 2xx 但响应体与 <samp>hub.challenge</samp> 不符，也视为失败。</p>
                <p>hub <em class="rfc2119" title="MAY">可以</em>将 <samp>hub.lease_seconds</samp>
                    设置为订阅者请求的值，也允许根据自身政策修改。要维持订阅，订阅者<em class="rfc2119" title="MUST">必须</em>在租期之前向 hub 重新请求订阅。</p>
                <p>hub <em class="rfc2119" title="MUST">必须</em>强制租期到期，<em class="rfc2119"
                        title="MUST NOT">不得</em>颁发永久租期。</p>
            </section>
        </section>
        <div class="note">
            <div role="heading" class="note-title marker" id="h-note-1" aria-level="3"><span>注意</span></div>
            <p class="">本规范用 GET 和 POST 区分订阅请求的确认/拒绝和内容分发。虽然这不是 Web 架构层面“最佳实践”，但实现回调 URL 时更简单。由于内容分发请求的 POST body
                可能为任意内容类型，仅包含文档内容，故用 GET/POST 区分模式实现上更简便。</p>
        </div>
    </section>

    <section id="publishing">
        <!--OddPage-->
        <h2 id="x6-publishing"><span class="secno">6. </span>发布</h2>
        <p>当主题有更新时，<em class="rfc2119" title="MUST">发布者必须</em>通知此前指定的 hub。hub 与发布者可用任意协议达成一致，只要 hub 最终能将更新内容发送给订阅者。</p>

        <div class="note">
            <div role="heading" class="note-title marker" id="h-note-2" aria-level="3"><span>注意</span></div>
            <p class="">发布者通知 hub 的具体机制未明确规定。例如，一些公开 hub <a
                    href="https://documentation.superfeedr.com/publishers.html#ping">[1]</a> <a
                    href="https://pubsubhubbub.appspot.com/">[2]</a> <a href="https://switchboard.p3k.io/docs">[3]</a>
                要求发布者使用 <span style="white-space: nowrap">hub.mode="publish"</span> 和 <span
                    style="white-space: nowrap">hub.url=(资源的 URL)</span> 发送 POST 请求。</p>
        </div>

        <section id="subscription-migration">
            <h3 id="x6-1-subscription-migration"><span class="secno">6.1 </span>订阅迁移</h3>
            <p>如果发布者希望将现有订阅迁移到新的主题 URL，可通过 HTTP 重定向实现。</p>
            <ul>
                <li>原主题 URL 应重定向到新主题 URL。这对未用 WebSub、而是直接轮询的 HTTP 客户端可实现无缝过渡。</li>
                <li>WebSub 订阅到期后，订阅者会尝试续订，续订第一步会先拉取主题 URL，从而遇到重定向并转到新主题。</li>
                <li>在新主题 URL 下，订阅者会看到新的 <code>rel=self</code> URL 和 hub，并在新 hub 订阅新主题。</li>
            </ul>
            <p>这不需要原 hub 参与，无论发布者是否切换 hub 均可用。</p>
        </section>
    </section>

    <section id="content-distribution">
        <!--OddPage-->
        <h2 id="x7-content-distribution"><span class="secno">7. </span>内容分发</h2>
        <p>当有新内容可用时，Hub 会向订阅者发送内容分发请求。该请求为 Hub 向订阅者回调 URL 的 HTTP [<cite><a class="bibref"
                    href="#bib-RFC7231">RFC7231</a></cite>]（或 HTTPS [<cite><a class="bibref"
                    href="#bib-RFC2818">RFC2818</a></cite>]）POST 请求。POST 请求体<em class="rfc2119"
                title="MUST">必须</em>包含内容分发通知负载。内容分发请求<em class="rfc2119"
                title="MUST">必须</em>有与主题<samp>Content-Type</samp>一致的 Header，且<em class="rfc2119"
                title="MUST">必须</em>包含主题 URL 的全部内容，下述例外情况除外。
        </p>
        <p>对于 Atom ([<cite><a class="bibref" href="#bib-RFC4287">RFC4287</a></cite>]) 和 RSS ([<cite><a class="bibref"
                    href="#bib-RSS-2.0">RSS-2.0</a></cite>]) feed，hub <em class="rfc2119" title="MAY">可以</em>把已经分发的
            <code>atom:entry</code> 或 <code>rss:item</code> 元素从 feed 中移除。
        </p>
        <p>请求<em class="rfc2119" title="MUST">必须</em>包含至少一个指向相关 hub 的 <samp>rel=hub</samp> Link 头 [<cite><a
                    class="bibref" href="#bib-RFC5988">RFC5988</a></cite>]。还<em class="rfc2119" title="MUST">必须</em>包含一个
            <samp>rel=self</samp> Link 头，指向当前被更新主题的规范 URL。Hub <em class="rfc2119" title="SHOULD">建议</em>将这些合并为一个单独的 Link
            头。这些 URL 均源于发现流程（<a href="#discovery">第3节</a>）。订阅者<em class="rfc2119" title="MUST NOT">不得</em>用这些 Link
            头识别对应的订阅，因为 Link 是内容主题的元数据，而非特定订阅。例如，分发请求中的主题 URL 可能与原始订阅的主题 URL 不同。
        </p>
        <p>订阅者回调 URL <em class="rfc2119" title="MUST">必须</em>返回 HTTP [<cite><a class="bibref"
                    href="#bib-RFC7231">RFC7231</a></cite>] 2xx 响应码表示成功。订阅者回调 URL <em class="rfc2119"
                title="MAY">可以</em>用 410 表示订阅已删除，hub 收到后<em class="rfc2119" title="MAY">可以</em>终止订阅。hub <em
                class="rfc2119" title="MUST">必须</em>将其它响应码视为失败；即订阅者<em class="rfc2119" title="MUST NOT">不得</em>用 HTTP
            重定向进行订阅迁移。订阅者 <em class="rfc2119" title="SHOULD">建议</em>尽快响应分发请求；其成功码<em class="rfc2119"
                title="SHOULD">建议</em>仅表示收到消息，无需确认是否已成功处理。订阅者响应体<em class="rfc2119" title="MUST">必须</em>被 hub 忽略。hub <em
                class="rfc2119" title="SHOULD">建议</em>在次数和时长达到自定义重试上限前持续重试分发。若超过自定阈值，hub 不再发送通知，但仍<em class="rfc2119"
                title="MUST">必须</em>保持订阅生效至租期结束，且主题有新消息时，<em class="rfc2119" title="MUST">必须</em>继续尝试分发给以前失败的订阅者。
        </p>
        <section id="authenticated-content-distribution">
            <h3 id="signing-content"><span class="secno">7.1 </span>认证内容分发</h3>
            <p>如果订阅请求中带有 <samp>hub.secret</samp>，hub <em class="rfc2119" title="MUST">必须</em>用该密钥对有效载荷生成 HMAC
                签名，并在内容分发请求头中带上该签名。<samp>X-Hub-Signature</samp> 格式为 <samp>method=signature</samp>，其中 <samp>method</samp>
                为算法名，<samp>signature</samp> 为签名的十六进制字符串。签名<em class="rfc2119" title="MUST">必须</em>采用 HMAC 算法 [<cite><a
                        class="bibref" href="#bib-RFC6151">RFC6151</a></cite>]，请求体为数据，<samp>hub.secret</samp>为密钥。</p>

            <section id="recognized-algorithm-names">
                <h4 id="x7-1-1-recognized-algorithm-names"><span class="secno">7.1.1 </span>支持的算法名</h4>

                <p>以下是最初注册的算法名，依据 [<cite><a class="bibref" href="#bib-FIPS-PUB-180-4">FIPS-PUB-180-4</a></cite>]
                    发布时的算法注册表。</p>
                <dl>
                    <dt>sha1</dt>
                    <dd>SHA-1 算法，见 [<cite><a class="bibref" href="#bib-FIPS-PUB-180-4">FIPS-PUB-180-4</a></cite>] 第6.1节
                    </dd>
                    <dt>sha256</dt>
                    <dd>SHA-256 算法，见 [<cite><a class="bibref" href="#bib-FIPS-PUB-180-4">FIPS-PUB-180-4</a></cite>]
                        第6.2节</dd>
                    <dt>sha384</dt>
                    <dd>SHA-384 算法，见 [<cite><a class="bibref" href="#bib-FIPS-PUB-180-4">FIPS-PUB-180-4</a></cite>]
                        第6.5节</dd>
                    <dt>sha512</dt>
                    <dd>SHA-512 算法，见 [<cite><a class="bibref" href="#bib-FIPS-PUB-180-4">FIPS-PUB-180-4</a></cite>]
                        第6.4节</dd>
                </dl>
                <p>未来可扩展支持订阅者声明可用算法。当前大多数 hub 采用 SHA-1 签名，为兼容旧订阅者，尽管其已知存在安全风险。</p>
            </section>

            <section id="signature-validation">
                <h4 id="x7-1-2-signature-validation"><span class="secno">7.1.2 </span>签名校验</h4>
                <p>收到带 <samp>X-Hub-Signature</samp> 的内容分发请求时，订阅者<em class="rfc2119"
                        title="SHOULD">建议</em>使用同样密钥按算法重算签名。如签名不符，订阅者<em class="rfc2119"
                        title="MUST">必须</em>本地丢弃消息。订阅者<em class="rfc2119" title="MAY">可以</em>以 2xx
                    响应码确认，以便异步处理消息和/或抵御暴力破解尝试。结合 HTTPS [<cite><a class="bibref" href="#bib-RFC2818">RFC2818</a></cite>]
                    可让简单订阅者安全接收内容分发而无需自带 HTTPS 服务器。</p>
                <p>但须注意该签名仅保证载荷未伪造，头信息是否安全还需订阅者自身按需采用 HTTPS 校验。</p>
            </section>
        </section>
    </section>

    <section id="security-considerations">
        <!--OddPage-->
        <h2 id="x8-security-considerations"><span class="secno">8. </span>安全性注意事项</h2>
        <p>以下是安全注意事项摘要。需强调 WebSub 是纯 HTTP 的服务器到服务器协议，强烈建议所有请求使用 HTTPS。</p>
        <section id="discovery-0">
            <h3 id="x8-1-discovery"><span class="secno">8.1 </span>发现</h3>
            <p>订阅者是否应在页面 <samp>&lt;body&gt;</samp>（以及 <samp>&lt;head&gt;</samp>）查找 <samp>&lt;link&gt;</samp> 元素并无定论。忽略
                <samp>&lt;body&gt;</samp> 也是因为部分网站可能让用户上传带 <samp>&lt;link&gt;</samp>
                的内容（虽然目前工作组未见具体案例）。若用于发现，用户可恶意让所有订阅者用替代 hub 推送恶意内容。因此，仅在 HTML <samp>&lt;head&gt;</samp> 发现更安全。
            </p>
        </section>
        <section id="subscriptions">
            <h3 id="x8-2-subscriptions"><span class="secno">8.2 </span>订阅</h3>
            <p>首先，订阅者<em class="rfc2119" title="SHOULD">建议</em>优先选择 hub 的 HTTPS URL（即使是 HTTP 提供）。其次，订阅者<em
                    class="rfc2119" title="SHOULD">建议</em>为回调用唯一、不可预测的能力型 URL 且用 HTTPS。最后，订阅时<em class="rfc2119"
                    title="SHOULD">建议</em>附带 <samp>hub.secret</samp> 便于内容签名。
            </p>
            <p>hub <em class="rfc2119" title="SHOULD">建议</em>强制较短的 <samp>hub.lease_seconds</samp>（10 天较合适）。在验证意图时，hub
                <em class="rfc2119" title="SHOULD">建议</em>使用随机单次 <samp>hub.challenge</samp>。
            </p>
        </section>
        <section id="distribution">
            <h3 id="x8-3-distribution"><span class="secno">8.3 </span>分发</h3>
            <p>Hub <em class="rfc2119" title="MUST">必须</em>使用订阅者原回调（含 HTTPS）。如请求带 <samp>hub.secret</samp>，Hub <em
                    class="rfc2119" title="MUST">必须</em>用其签名。</p>
            <p>若订阅请求带 hub.secret，订阅者<em class="rfc2119" title="SHOULD">建议</em>校验签名，且<em class="rfc2119"
                    title="MUST">必须</em>按 server 声明的机制校验，不通过则丢弃请求。</p>
            <p>若订阅者不用安全回调（HTTPS），或 hub 与订阅者间 TLS 可能被破坏，则内容通知的完整性仅依赖 hub.secret 和摘要算法。此时应按应用安全需求选用算法。由于 SHA-1 已不安全，建议至少用
                SHA-256。</p>
        </section>
        <section id="security-and-privacy-review">
            <h3 id="x8-4-security-and-privacy-review"><span class="secno">8.4 </span>安全与隐私评估</h3>
            <p>下列问题基于《安全与隐私自评问卷》([<cite><a class="bibref"
                        href="#bib-security-privacy-questionnaire">security-privacy-questionnaire</a></cite>])，概述本规范的安全与隐私考虑。
            </p>

            <dl>
                <dt>本规范是否涉及可识别个人身份的信息？</dt>
                <dd>唯一有可能的个人可识别信息是主题和回调 URL。</dd>
                <dt>本规范涉及高价值数据吗？</dt>
                <dd>否，无身份认证或凭据。</dd>
                <dt>本规范是否为 origin 引入了可跨浏览会话持久化的新状态？</dt>
                <dd>否。</dd>
                <dt>本规范是否将持久跨域状态暴露到 web？</dt>
                <dd>WebSub 订阅者应为每个订阅主题创建一个资源。</dd>
                <dt>本规范是否向 origin 暴露了其当前无法获取的数据？</dt>
                <dd>否。</dd>
                <dt>本规范是否启用新的脚本执行/加载方式？</dt>
                <dd>否。</dd>
                <dt>本规范是否允许 origin 访问用户位置？</dt>
                <dd>否。</dd>
                <dt>本规范是否允许 origin 访问用户设备的传感器？</dt>
                <dd>否。</dd>
                <dt>本规范是否允许 origin 访问用户计算环境的细节？</dt>
                <dd>否。</dd>
                <dt>本规范是否允许 origin 访问其他设备？</dt>
                <dd>否。</dd>
                <dt>本规范是否允许 origin 控制用户代理的本地界面？</dt>
                <dd>否。</dd>
                <dt>本规范是否向 web 暴露临时标识符？</dt>
                <dd>否。</dd>
                <dt>本规范是否区分第一方与第三方环境下的行为？</dt>
                <dd>否。</dd>
                <dt>本规范在用户代理“隐身模式”下如何工作？</dt>
                <dd>WebSub 为服务器间协议，“隐身模式”无意义。</dd>
                <dt>本规范是否会将数据持久化到本地设备？</dt>
                <dd>否。</dd>
                <dt>本规范是否允许降级默认的安全特性？</dt>
                <dd>否。</dd>
            </dl>
        </section>
    </section>

    <section class="appendix informative" id="acknowledgements">
        <!--OddPage-->
        <h2 id="a-acknowledgements"><span class="secno">A. </span>致谢</h2>
        <p><em>本节为非规范性内容。</em></p>

        <p>编辑感谢 PubSubHubbub 的作者、IndieWeb 社区及各位实现者的支持、鼓励与热情。特别地，编辑感谢
            <a href="https://bradfitz.com/">Brad Fitzpatrick</a>、
            <a href="http://www.onebigfluke.com/">Brett Slatkin</a>、
            <a href="http://martin.atkins.me.uk/">Martin Atkins</a>、
            <a href="http://rhiaro.co.uk/">Amy Guy</a>、
            <a href="https://barryfrost.com/">Barry Frost</a>、
            <a href="https://ben.thatmustbe.me/">Benjamin Roberts</a>、
            <a href="https://zeonfederated.com/">Eugen Rochko</a>、
            <a href="https://github.com/twitch-jordanpotter">Jordan Potter</a>、
            <a href="https://notiz.blog/">Matthias Pfefferle</a>、
            <a href="https://unicyclic.com/mal/">Malcolm Blaney</a>、
            <a href="https://ma.rtendevri.es/">Marten de Vries</a>、
            <a href="http://hawke.org/sandro/">Sandro Hawke</a>、
            <a href="http://tantek.com/">Tantek Çelik</a>，
            以及
            <a href="https://eighty-twenty.org/">Tony Garnock-Jones</a>。
        </p>
    </section>

    <section class="appendix informative" id="change-log">
        <!--OddPage-->
        <h2 id="b-change-log"><span class="secno">B. </span>变更日志</h2>
        <p><em>本节为非规范性内容。</em></p>

        <section id="changes-from-03-october-2017-pr-to-this-version">
            <h3 id="b-1-changes-from-03-october-2017-pr-to-this-version"><span class="secno">B.1
                </span>自2017年10月3日PR至本版本的变更</h3>

            <ul>
                <li>在一致性标准相关项增加指向内容协商的链接</li>
                <li>引用名称由 "WHATWG-URL" 更新为 "[<cite><a class="bibref" href="#bib-URL">URL</a></cite>]"，但内容本身不变</li>
                <li>重写 hub URL 发现的句子，更清晰地区分提到的 URL，并使用 "notify" 取代 "ping"</li>
                <li>将 "mime-type" 更正为 "Media Type"，并增加 RFC 的参考说明</li>
                <li>重新表述“订阅与取消订阅”摘要，明确各步骤的参与者</li>
                <li>澄清向订阅者回调 URL 发送 POST 请求的流程</li>
                <li>凡可用 HTTPS 的场合，在仅提到 HTTP 处补充对 HTTPS 的说明</li>
                <li>澄清 hub.lease_seconds 参数何时为必需，何时为可选</li>
                <li>重写订阅迁移部分，使表述更清晰</li>
                <li>将发布者通知 hub 的说明移至订阅迁移部分之外</li>
                <li>移除“notification”单独术语，采用“内容分发请求”或“内容分发通知”</li>
                <li>将 CR 退出标准相关表述改为过去时</li>
                <li>增加解释说明为何发布者可能同时公布多个 hub</li>
                <li>重写第8节的句子，更准确描述“内容分发请求中的主题 URL 可能与原始订阅时不同”</li>
                <li>删除关于 link 标签仅限 head 的风险限制</li>
                <li>在安全注意事项中增加与 body/head 中 link rel 发现相关的探讨</li>
                <li>移除 hub 拒绝订阅并提供备用主题 URL 的未用特性</li>
                <li>在协议高阶概述添加时序图，并对措辞细节做小幅更新</li>
                <li>新增致谢部分</li>
                <li>说明 hub 可为 lease_seconds 设置默认值</li>
            </ul>
        </section>

        <section id="changes-from-11-april-2017-cr-to-03-october-2017-pr">
            <h3 id="b-2-changes-from-11-april-2017-cr-to-03-october-2017-pr"><span class="secno">B.2
                </span>自2017年4月11日CR至2017年10月3日PR的变更</h3>

            <ul>
                <li>增加发布者如何迁移订阅者到新主题 URL 的信息性指南</li>
                <li>允许订阅者用 2xx 以外的响应码拒绝无效签名</li>
                <li>建议订阅者若订阅已被删除返回 HTTP 410</li>
                <li>增加关于未规范化发布者-hub关系的说明</li>
                <li>因缺乏实现，移除处于风险的 <code>.host-meta</code> 发现特性（<a href="https://github.com/w3c/websub/issues/97">Issue
                        #97</a>）</li>
                <li>补充说明，订阅者的 <code>hub.secret</code> 应加密随机且唯一</li>
                <li>澄清通知投递失败时，订阅在租期结束前不应被删除（<a href="https://github.com/w3c/websub/issues/119">Issue #119</a>）</li>
                <li>将关于 FIPS 文档算法扩展的注释改为将来应定义允许订阅者与 hub 协商摘要算法的规范扩展</li>
                <li>新增示例：根据 HTTP <code>Accept-Language</code> 头返回不同的 rel=self URL</li>
                <li>在安全注意事项中增加：哈希算法可抵御部分 TLS 通道被攻破</li>
                <li>澄清安全性部分关于签名校验的内容</li>
                <li>将 "at risk" 部分移出 "sotd" 避免 respec 错误</li>
                <li>FIPS PUB 180-4 的超链接现在为页内引用</li>
            </ul>
        </section>

        <section id="changes-from-24-november-wd-to-11-april-2017-cr">
            <h3 id="b-3-changes-from-24-november-wd-to-11-april-2017-cr"><span class="secno">B.3
                </span>自2016年11月24日WD至2017年4月11日CR的变更</h3>

            <ul>
                <li>澄清了认证分发所支持算法的表述</li>
                <li>仅允许 <code>&lt;link&gt;</code> 标签放在 HTML &lt;head&gt; 元素内</li>
                <li>新增一致性标准和CR退出标准</li>
                <li>增加发现请求与响应的示例</li>
                <li>新增用不同 <code>rel=self</code> URL 支持内容协商的范例</li>
                <li>增加安全注意事项部分</li>
                <li>引用更新为 WHATWG-URL，代替 HTML4</li>
                <li>用新版描述替换原摘要</li>
            </ul>
        </section>

        <section id="changes-from-20-october-fpwd-to-24-november-2016">
            <h3 id="b-4-changes-from-20-october-fpwd-to-24-november-2016"><span class="secno">B.4
                </span>自2016年10月20日FPWD至2016年11月24日的变更</h3>

            <ul>
                <li>增加了对 PubSubHubbub 0.3 和 0.4 以往版本的说明性引用</li>
                <li>将发现章节拆分为发布者和订阅者两部分</li>
                <li>澄清发布者可任选发现方式，订阅者需支持全部</li>
                <li>将 host-meta 发现方式标记为“风险”，并将引用修正为 Host Meta 规范</li>
                <li>推荐将能力型 URL 用作订阅者回调 URL 以提升安全性和认证通知投递</li>
                <li>建议订阅续期时不要复用回调 URL</li>
                <li>澄清 <code>hub.topic</code> 必须是发现到的 <code>self</code> URL</li>
                <li>移除建议订阅请求包含 <code>From</code> 头的表述</li>
                <li>澄清 hub 响应订阅请求不该依赖验证/确认过程</li>
                <li>hub 必须强制实施租期到期</li>
                <li>澄清通知负载应含主题 URL 的全部内容</li>
                <li>建议 hub 重试通知投递失败直至自定上限</li>
                <li>澄清允许未来 FIPS PUB 180-4 新增签名算法</li>
                <li>增加回调 URL 使用 GET/POST 区分用途的说明性注释</li>
                <li>将规范更名为 WebSub</li>
            </ul>
        </section>

    </section>

    <script>
        // 当文本被选中（鼠标松开）时，查找最近的含 ID 属性的元素，并将该 ID 更新到浏览器地址栏的片段部分
        document.body.onmouseup = function () {
            var selection;
            if (selection = window.getSelection()) {
                var range = selection.getRangeAt(0);
                var el = range.startContainer;
                while ((el = el.parentElement) && !el.attributes["id"]);
                var hash = el.attributes["id"].value;
                if (history.replaceState) {
                    history.replaceState(null, null, "#" + hash);
                }
            }
        };
    </script>


    <section id="references" class="appendix"><!--OddPage-->
        <h2 id="c-references"><span class="secno">C. </span>参考文献</h2>
        <section id="normative-references">
            <h3 id="c-1-normative-references"><span class="secno">C.1 </span>规范性引用</h3>
            <dl class="bibliography">
                <dt id="bib-Encoding">[Encoding]</dt>
                <dd><a href="https://encoding.spec.whatwg.org/"><cite>编码标准</cite></a>. Anne van Kesteren.
                    WHATWG. 活标准. URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-HTML5">[HTML5]</dt>
                <dd><a href="https://www.w3.org/TR/html5/"><cite>HTML5</cite></a>. Ian Hickson; Robin Berjon; Steve
                    Faulkner; Travis Leithead; Erika Doyle Navara; Theresa O'Connor; Silvia Pfeiffer. W3C. 2014年10月28日.
                    W3C推荐. URL: <a href="https://www.w3.org/TR/html5/">https://www.w3.org/TR/html5/</a>
                </dd>
                <dt id="bib-RFC2119">[RFC2119]</dt>
                <dd><a href="https://tools.ietf.org/html/rfc2119"><cite>RFC 中用于指示需求等级的关键词</cite></a>. S. Bradner. IETF.
                    1997年3月. 最佳当前实践. URL: <a
                        href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
                </dd>
                <dt id="bib-RFC2818">[RFC2818]</dt>
                <dd><a href="https://tools.ietf.org/html/rfc2818"><cite>HTTP Over TLS</cite></a>. E. Rescorla. IETF.
                    2000年5月.
                    信息性. URL: <a href="https://tools.ietf.org/html/rfc2818">https://tools.ietf.org/html/rfc2818</a>
                </dd>
                <dt id="bib-RFC5988">[RFC5988]</dt>
                <dd><a href="https://tools.ietf.org/html/rfc5988"><cite>Web Linking</cite></a>. M. Nottingham. IETF.
                    2010年10月. 建议标准. URL: <a
                        href="https://tools.ietf.org/html/rfc5988">https://tools.ietf.org/html/rfc5988</a>
                </dd>
                <dt id="bib-RFC6151">[RFC6151]</dt>
                <dd><a href="https://tools.ietf.org/html/rfc6151"><cite>MD5 摘要及 HMAC-MD5 的安全注意更新</cite></a>. S. Turner;
                    L. Chen. IETF. 2011年3月.
                    信息性. URL: <a href="https://tools.ietf.org/html/rfc6151">https://tools.ietf.org/html/rfc6151</a>
                </dd>
                <dt id="bib-RFC7230">[RFC7230]</dt>
                <dd><a href="https://tools.ietf.org/html/rfc7230"><cite>超文本传输协议(HTTP/1.1): 消息语法与路由</cite></a>. R.
                    Fielding, Ed.; J. Reschke, Ed.. IETF. 2014年6月. 建议标准. URL: <a
                        href="https://tools.ietf.org/html/rfc7230">https://tools.ietf.org/html/rfc7230</a>
                </dd>
                <dt id="bib-RFC7231">[RFC7231]</dt>
                <dd><a href="https://tools.ietf.org/html/rfc7231"><cite>超文本传输协议(HTTP/1.1): 语义与内容</cite></a>. R.
                    Fielding, Ed.; J. Reschke, Ed.. IETF. 2014年6月.
                    建议标准. URL: <a href="https://tools.ietf.org/html/rfc7231">https://tools.ietf.org/html/rfc7231</a>
                </dd>
                <dt id="bib-URL">[URL]</dt>
                <dd><a href="https://url.spec.whatwg.org/"><cite>URL 标准</cite></a>. Anne van Kesteren. WHATWG.
                    活标准. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
                </dd>
            </dl>
        </section>
        <section id="informative-references">
            <h3 id="c-2-informative-references"><span class="secno">C.2 </span>补充性引用</h3>
            <dl class="bibliography">
                <dt id="bib-capability-urls">[capability-urls]</dt>
                <dd><a href="https://www.w3.org/TR/capability-urls/"><cite>能力型URL的良好实践</cite></a>. Jeni Tennison. W3C.
                    2014年2月18日. W3C工作草案. URL: <a
                        href="https://www.w3.org/TR/capability-urls/">https://www.w3.org/TR/capability-urls/</a>
                </dd>
                <dt id="bib-FIPS-PUB-180-4">[FIPS-PUB-180-4]</dt>
                <dd><a href="https://dx.doi.org/10.6028/NIST.FIPS.180-4"><cite>安全哈希标准 (SHS)</cite></a>.
                    美国国家标准与技术研究院. 美国商务部. URL: <a
                        href="https://dx.doi.org/10.6028/NIST.FIPS.180-4">http://dx.doi.org/10.6028/NIST.FIPS.180-4</a>
                </dd>
                <dt id="bib-PubSubHubbub-Core-0.3">[PubSubHubbub-Core-0.3]</dt>
                <dd><a href="https://pubsubhubbub.github.io/PubSubHubbub/pubsubhubbub-core-0.3.html"><cite>PubSubHubbub
                            Core 0.3 -- 工作草案</cite></a>. B. Fitzpatrick; B. Slatkin; M. Atkins.URL: <a
                        href="https://pubsubhubbub.github.io/PubSubHubbub/pubsubhubbub-core-0.3.html">https://pubsubhubbub.github.io/PubSubHubbub/pubsubhubbub-core-0.3.html</a>
                </dd>
                <dt id="bib-PubSubHubbub-Core-0.4">[PubSubHubbub-Core-0.4]</dt>
                <dd><a href="https://pubsubhubbub.github.io/PubSubHubbub/pubsubhubbub-core-0.4.html"><cite>PubSubHubbub
                            Core 0.4 -- 工作草案</cite></a>. B. Fitzpatrick; B. Slatkin; M. Atkins; J.
                    Genestoux.URL: <a
                        href="https://pubsubhubbub.github.io/PubSubHubbub/pubsubhubbub-core-0.4.html">https://pubsubhubbub.github.io/PubSubHubbub/pubsubhubbub-core-0.4.html</a>
                </dd>
                <dt id="bib-RFC4287">[RFC4287]</dt>
                <dd><a href="https://tools.ietf.org/html/rfc4287"><cite>Atom 信息摘要格式</cite></a>. M.
                    Nottingham, Ed.; R. Sayre, Ed.. IETF. 2005年12月. 建议标准. URL: <a
                        href="https://tools.ietf.org/html/rfc4287">https://tools.ietf.org/html/rfc4287</a>
                </dd>
                <dt id="bib-RFC6838">[RFC6838]</dt>
                <dd><a href="https://tools.ietf.org/html/rfc6838"><cite>媒体类型规范与注册流程</cite></a>. N. Freed; J. Klensin; T.
                    Hansen. IETF. 2013年1月. 最佳当前实践. URL: <a
                        href="https://tools.ietf.org/html/rfc6838">https://tools.ietf.org/html/rfc6838</a>
                </dd>
                <dt id="bib-RSS-2.0">[RSS-2.0]</dt>
                <dd><a href="http://www.rssboard.org/rss-specification"><cite>RSS 2.0</cite></a>. Dave Winer. RSS Board.
                    稳定版. URL: <a
                        href="http://www.rssboard.org/rss-specification">http://www.rssboard.org/rss-specification</a>
                </dd>
                <dt id="bib-security-privacy-questionnaire">[security-privacy-questionnaire]</dt>
                <dd><a href="https://www.w3.org/TR/security-privacy-questionnaire/"><cite>安全与隐私自查问卷</cite></a>. Mike
                    West. W3C. 2015年12月10日. W3C说明. URL: <a
                        href="https://www.w3.org/TR/security-privacy-questionnaire/">https://www.w3.org/TR/security-privacy-questionnaire/</a>
                </dd>
            </dl>
        </section>
    </section>
    <p role="navigation" id="back-to-top"><a href="#toc"><abbr title="Back to Top">↑</abbr></a></p>
    <script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
    <script src="/dropdown.js"></script>
</body>

</html>