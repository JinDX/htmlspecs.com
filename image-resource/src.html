<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <meta name="generator" content="ReSpec 26.8.9">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <style>
        .issue-label {
            text-transform: initial
        }

        .warning>p:first-child {
            margin-top: 0
        }

        .warning {
            padding: .5em;
            border-left-width: .5em;
            border-left-style: solid
        }

        span.warning {
            padding: .1em .5em .15em
        }

        .issue.closed span.issue-number {
            text-decoration: line-through
        }

        .warning {
            border-color: #f11;
            border-width: .2em;
            border-style: solid;
            background: #fbe9e9
        }

        .warning-title:before {
            content: "⚠";
            font-size: 1.3em;
            float: left;
            padding-right: .3em;
            margin-top: -.3em
        }

        li.task-list-item {
            list-style: none
        }

        input.task-list-item-checkbox {
            margin: 0 .35em .25em -1.6em;
            vertical-align: middle
        }

        .issue a.respec-gh-label {
            padding: 5px;
            margin: 0 2px 0 2px;
            font-size: 10px;
            text-transform: none;
            text-decoration: none;
            font-weight: 700;
            border-radius: 4px;
            position: relative;
            bottom: 2px;
            border: none;
            display: inline-block
        }
    </style>
    <style>
        pre.idl {
            padding: 1em;
            position: relative
        }

        pre.idl>code {
            color: #000
        }

        @media print {
            pre.idl {
                white-space: pre-wrap
            }
        }

        .idlHeader {
            display: block;
            width: 150px;
            background: #8ccbf2;
            color: #fff;
            font-family: sans-serif;
            font-weight: 700;
            margin: -1em 0 1em -1em;
            height: 28px;
            line-height: 28px
        }

        .idlHeader a.self-link {
            margin-left: .3cm;
            text-decoration: none;
            border-bottom: none
        }

        .idlID {
            font-weight: 700;
            color: #005a9c
        }

        .idlType {
            color: #005a9c
        }

        .idlName {
            color: #ff4500
        }

        .idlName a {
            color: #ff4500;
            border-bottom: 1px dotted #ff4500;
            text-decoration: none
        }

        a.idlEnumItem {
            color: #000;
            border-bottom: 1px dotted #ccc;
            text-decoration: none
        }

        .idlSuperclass {
            font-style: italic;
            color: #005a9c
        }

        .idlDefaultValue,
        .idlParamName {
            font-style: italic
        }

        .extAttr {
            color: #666
        }

        .idlSectionComment {
            color: gray
        }

        .idlIncludes a {
            font-weight: 700
        }

        .respec-button-copy-paste:focus {
            text-decoration: none;
            border-color: #51a7e8;
            outline: 0;
            box-shadow: 0 0 5px rgba(81, 167, 232, .5)
        }

        .respec-button-copy-paste.selected:focus,
        .respec-button-copy-paste:focus:hover {
            border-color: #51a7e8
        }

        .respec-button-copy-paste.zeroclipboard-is-active,
        .respec-button-copy-paste.zeroclipboard-is-hover,
        .respec-button-copy-paste:active,
        .respec-button-copy-paste:hover {
            text-decoration: none;
            background-color: #ddd;
            background-image: linear-gradient(#eee, #ddd);
            border-color: #ccc
        }

        .respec-button-copy-paste.selected,
        .respec-button-copy-paste.zeroclipboard-is-active,
        .respec-button-copy-paste:active {
            background-color: #dcdcdc;
            background-image: none;
            border-color: #b5b5b5;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, .15)
        }

        .respec-button-copy-paste.selected:hover {
            background-color: #cfcfcf
        }

        .respec-button-copy-paste.disabled,
        .respec-button-copy-paste.disabled:hover,
        .respec-button-copy-paste:disabled,
        .respec-button-copy-paste:disabled:hover {
            color: rgba(102, 102, 102, .5);
            cursor: default;
            background-color: rgba(229, 229, 229, .5);
            background-image: none;
            border-color: rgba(197, 197, 197, .5);
            box-shadow: none
        }

        @media print {
            .respec-button-copy-paste {
                visibility: hidden
            }
        }
    </style>
    <style>
        dfn {
            cursor: pointer
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            min-width: 300px;
            max-width: 500px;
            padding: .5em .75em;
            margin-top: .6em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #fff;
            color: #000;
            box-shadow: 0 1em 3em -.4em rgba(0, 0, 0, .3), 0 0 1px 1px rgba(0, 0, 0, .05);
            border-radius: 2px
        }

        .dfn-panel:not(.docked)>.caret {
            position: absolute;
            top: -9px
        }

        .dfn-panel:not(.docked)>.caret::after,
        .dfn-panel:not(.docked)>.caret::before {
            content: "";
            position: absolute;
            border: 10px solid transparent;
            border-top: 0;
            border-bottom: 10px solid #fff;
            top: 0
        }

        .dfn-panel:not(.docked)>.caret::before {
            border-bottom: 9px solid #a2a9b1
        }

        .dfn-panel * {
            margin: 0
        }

        .dfn-panel b {
            display: block;
            color: #000;
            margin-top: .25em
        }

        .dfn-panel ul a[href] {
            color: #333
        }

        .dfn-panel>div {
            display: flex
        }

        .dfn-panel a.self-link {
            font-weight: 700;
            margin-right: auto
        }

        .dfn-panel .marker {
            padding: .1em;
            margin-left: .5em;
            border-radius: .2em;
            text-align: center;
            white-space: nowrap;
            font-size: 90%;
            color: #040b1c
        }

        .dfn-panel .marker.dfn-exported {
            background: #d1edfd;
            box-shadow: 0 0 0 .125em #1ca5f940
        }

        .dfn-panel .marker.idl-block {
            background: #8ccbf2;
            box-shadow: 0 0 0 .125em #0670b161
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important
        }

        .dfn-panel a[href]:hover {
            border-bottom-width: 1px
        }

        .dfn-panel ul {
            padding: 0
        }

        .dfn-panel li {
            margin-left: 1em
        }

        .dfn-panel.docked {
            position: fixed;
            left: .5em;
            top: unset;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - .75em * 2 - .5em - .2em * 2);
            max-height: 30vh;
            overflow: auto
        }
    </style>


    <title>Image Resource</title>

    <style id="respec-mainstyle">
        @keyframes pop {
            0% {
                transform: scale(1, 1)
            }

            25% {
                transform: scale(1.25, 1.25);
                opacity: .75
            }

            100% {
                transform: scale(1, 1)
            }
        }

        .hljs {
            background: 0 0 !important
        }

        a abbr,
        h1 abbr,
        h2 abbr,
        h3 abbr,
        h4 abbr,
        h5 abbr,
        h6 abbr {
            border: none
        }

        dfn {
            font-weight: 700
        }

        a.internalDFN {
            color: inherit;
            border-bottom: 1px solid #99c;
            text-decoration: none
        }

        a.externalDFN {
            color: inherit;
            border-bottom: 1px dotted #ccc;
            text-decoration: none
        }

        a.bibref {
            text-decoration: none
        }

        .respec-offending-element:target {
            animation: pop .25s ease-in-out 0s 1
        }

        .respec-offending-element,
        a[href].respec-offending-element {
            text-decoration: red wavy underline
        }

        @supports not (text-decoration:red wavy underline) {
            .respec-offending-element:not(pre) {
                display: inline-block
            }

            .respec-offending-element {
                background: url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x
            }
        }

        #references :target {
            background: #eaf3ff;
            animation: pop .4s ease-in-out 0s 1
        }

        cite .bibref {
            font-style: normal
        }

        code {
            color: #c63501
        }

        th code {
            color: inherit
        }

        a[href].orcid {
            padding-left: 4px;
            padding-right: 4px
        }

        a[href].orcid>svg {
            margin-bottom: -2px
        }

        .toc a,
        .tof a {
            text-decoration: none
        }

        a .figno,
        a .secno {
            color: #000
        }

        ol.tof,
        ul.tof {
            list-style: none outside none
        }

        .caption {
            margin-top: .5em;
            font-style: italic
        }

        table.simple {
            border-spacing: 0;
            border-collapse: collapse;
            border-bottom: 3px solid #005a9c
        }

        .simple th {
            background: #005a9c;
            color: #fff;
            padding: 3px 5px;
            text-align: left
        }

        .simple th a {
            color: #fff;
            padding: 3px 5px;
            text-align: left
        }

        .simple th[scope=row] {
            background: inherit;
            color: inherit;
            border-top: 1px solid #ddd
        }

        .simple td {
            padding: 3px 10px;
            border-top: 1px solid #ddd
        }

        .simple tr:nth-child(even) {
            background: #f0f6ff
        }

        .section dd>p:first-child {
            margin-top: 0
        }

        .section dd>p:last-child {
            margin-bottom: 0
        }

        .section dd {
            margin-bottom: 1em
        }

        .section dl.attrs dd,
        .section dl.eldef dd {
            margin-bottom: 0
        }

        #issue-summary>ul {
            column-count: 2
        }

        #issue-summary li {
            list-style: none;
            display: inline-block
        }

        details.respec-tests-details {
            margin-left: 1em;
            display: inline-block;
            vertical-align: top
        }

        details.respec-tests-details>* {
            padding-right: 2em
        }

        details.respec-tests-details[open] {
            z-index: 999999;
            position: absolute;
            border: thin solid #cad3e2;
            border-radius: .3em;
            background-color: #fff;
            padding-bottom: .5em
        }

        details.respec-tests-details[open]>summary {
            border-bottom: thin solid #cad3e2;
            padding-left: 1em;
            margin-bottom: 1em;
            line-height: 2em
        }

        details.respec-tests-details>ul {
            width: 100%;
            margin-top: -.3em
        }

        details.respec-tests-details>li {
            padding-left: 1em
        }

        a[href].self-link:hover {
            opacity: 1;
            text-decoration: none;
            background-color: transparent
        }

        h2,
        h3,
        h4,
        h5,
        h6 {
            position: relative
        }

        aside.example .marker>a.self-link {
            color: inherit
        }

        h2>a.self-link,
        h3>a.self-link,
        h4>a.self-link,
        h5>a.self-link,
        h6>a.self-link {
            border: none;
            color: inherit;
            font-size: 83%;
            height: 2em;
            left: -1.6em;
            opacity: .5;
            position: absolute;
            text-align: center;
            text-decoration: none;
            top: 0;
            transition: opacity .2s;
            width: 2em
        }

        h2>a.self-link::before,
        h3>a.self-link::before,
        h4>a.self-link::before,
        h5>a.self-link::before,
        h6>a.self-link::before {
            content: "§";
            display: block
        }

        @media (max-width:767px) {
            dd {
                margin-left: 0
            }

            h2>a.self-link,
            h3>a.self-link,
            h4>a.self-link,
            h5>a.self-link,
            h6>a.self-link {
                left: auto;
                top: auto
            }
        }

        @media print {
            .removeOnSave {
                display: none
            }
        }
    </style>


    <meta name="description" content="This document defines the concept of an &quot;image resource&quot; and a
        corresponding WebIDL ImageResource dictionary. Web APIs can use the
        ImageResource dictionary to represent an image resource in contexts
        where an HTMLImageElement is not suitable or available (e.g., in a
        Worker).">
    <link rel="canonical" href="https://www.w3.org/TR/image-resource/">
    <style>
        .hljs {
            display: block;
            overflow-x: auto;
            padding: .5em;
            color: #383a42;
            background: #fafafa
        }

        .hljs-comment,
        .hljs-quote {
            color: #717277;
            font-style: italic
        }

        .hljs-doctag,
        .hljs-formula,
        .hljs-keyword {
            color: #a626a4
        }

        .hljs-deletion,
        .hljs-name,
        .hljs-section,
        .hljs-selector-tag,
        .hljs-subst {
            color: #ca4706;
            font-weight: 700
        }

        .hljs-literal {
            color: #0b76c5
        }

        .hljs-addition,
        .hljs-attribute,
        .hljs-meta-string,
        .hljs-regexp,
        .hljs-string {
            color: #42803c
        }

        .hljs-built_in,
        .hljs-class .hljs-title {
            color: #9a6a01
        }

        .hljs-attr,
        .hljs-number,
        .hljs-selector-attr,
        .hljs-selector-class,
        .hljs-selector-pseudo,
        .hljs-template-variable,
        .hljs-type,
        .hljs-variable {
            color: #986801
        }

        .hljs-bullet,
        .hljs-link,
        .hljs-meta,
        .hljs-selector-id,
        .hljs-symbol,
        .hljs-title {
            color: #336ae3
        }

        .hljs-emphasis {
            font-style: italic
        }

        .hljs-strong {
            font-weight: 700
        }

        .hljs-link {
            text-decoration: underline
        }
    </style>
    <style>
        var {
            position: relative;
            cursor: pointer
        }

        var[data-type]::after,
        var[data-type]::before {
            position: absolute;
            left: 50%;
            top: -6px;
            opacity: 0;
            transition: opacity .4s;
            pointer-events: none
        }

        var[data-type]::before {
            content: "";
            transform: translateX(-50%);
            border-width: 4px 6px 0 6px;
            border-style: solid;
            border-color: transparent;
            border-top-color: #000
        }

        var[data-type]::after {
            content: attr(data-type);
            transform: translateX(-50%) translateY(-100%);
            background: #000;
            text-align: center;
            font-family: "Dank Mono", "Fira Code", monospace;
            font-style: normal;
            padding: 6px;
            border-radius: 3px;
            color: #daca88;
            text-indent: 0;
            font-weight: 400
        }

        var[data-type]:hover::after,
        var[data-type]:hover::before {
            opacity: 1
        }
    </style>
    <script id="initialUserConfig" type="application/json">{
  "mdn": false,
  "specStatus": "WD",
  "group": "webapps",
  "editors": [
    {
      "name": "Aaron Gustafson",
      "company": "Microsoft Corporation",
      "companyURL": "https://microsoft.com/",
      "w3cid": 43672
    },
    {
      "name": "Rayan Kanso",
      "company": "Google Inc.",
      "companyURL": "https://google.com/",
      "w3cid": 115452
    },
    {
      "name": "Marcos Cáceres",
      "company": "W3C",
      "companyURL": "https://w3c.org/",
      "w3cid": 39125
    }
  ],
  "github": {
    "repoURL": "w3c/image-resource/",
    "branch": "main"
  },
  "xref": "web-platform",
  "shortName": "image-resource",
  "publishDate": "2021-06-04",
  "previousMaturity": "WD",
  "previousPublishDate": "2021-04-26",
  "publishISODate": "2021-06-04T00:00:00.000Z",
  "generatedSubtitle": "Working Draft 04 June 2021"
}</script>
    <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/W3C-WD">
</head>

<body data-cite="WebIDL ENCODING MIMESNIFF APPMANIFEST HTML INFRA URL WEBIDL DOM FETCH" class="h-entry">
    <div class="head">
        <a class="logo" href="https://www.w3.org/"><img alt="W3C" width="72" height="48"
                src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C"></a>
        <h1 id="title" class="title">
            Image Resource
        </h1>

        <h2>
            W3C Working Draft
            <time class="dt-published" datetime="2021-06-04">04 June 2021</time>
        </h2>
        <dl>
            <dt>This version:</dt>
            <dd>
                <a class="u-url"
                    href="https://www.w3.org/TR/2021/WD-image-resource-20210604/">https://www.w3.org/TR/2021/WD-image-resource-20210604/</a>
            </dd>
            <dt>Latest published version:</dt>
            <dd>
                <a href="https://www.w3.org/TR/image-resource/">https://www.w3.org/TR/image-resource/</a>
            </dd>
            <dt>Latest editor's draft:</dt>
            <dd><a href="https://w3c.github.io/image-resource/">https://w3c.github.io/image-resource/</a></dd>



            <dt>Previous version:</dt>
            <dd><a
                    href="https://www.w3.org/TR/2021/WD-image-resource-20210426/">https://www.w3.org/TR/2021/WD-image-resource-20210426/</a>
            </dd>

            <dt>Editors:</dt>
            <dd class="editor p-author h-card vcard" data-editor-id="43672">
                <span class="p-name fn">Aaron Gustafson</span> (<a class="p-org org h-org"
                    href="https://microsoft.com/">Microsoft Corporation</a>)
            </dd>
            <dd class="editor p-author h-card vcard" data-editor-id="115452">
                <span class="p-name fn">Rayan Kanso</span> (<a class="p-org org h-org" href="https://google.com/">Google
                    Inc.</a>)
            </dd>
            <dd class="editor p-author h-card vcard" data-editor-id="39125">
                <span class="p-name fn">Marcos Cáceres</span> (<a class="p-org org h-org"
                    href="https://w3c.org/">W3C</a>)
            </dd>


            <dt>Participate:</dt>
            <dd>
                <a href="https://github.com/w3c/image-resource/">GitHub w3c/image-resource</a>
            </dd>
            <dd>
                <a href="https://github.com/w3c/image-resource/issues/">File an issue</a>
            </dd>
            <dd>
                <a href="https://github.com/w3c/image-resource/commits/main">Commit history</a>
            </dd>
            <dd>
                <a href="https://github.com/w3c/image-resource/pulls/">Pull requests</a>
            </dd>
        </dl>



        <p class="copyright">
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
            ©
            2021

            <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a
                href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
            <a href="https://www.ercim.eu/"><abbr
                    title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a
                href="https://www.keio.ac.jp/">Keio</a>,
            <a href="https://ev.buaa.edu.cn/">Beihang</a>).
            W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a rel="license"
                href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document">permissive document
                license</a> rules
            apply.
        </p>
        <hr title="Separator for header">
    </div>

    <section id="abstract" class="introductory">
        <h2>Abstract</h2>
        <p>
            This document defines the concept of an "image resource" and a
            corresponding WebIDL <a data-link-type="idl" href="#dom-imageresource" class="internalDFN"
                id="ref-for-dom-imageresource-1"><code>ImageResource</code></a> dictionary. Web APIs can use the
            <a data-link-type="idl" href="#dom-imageresource" class="internalDFN"
                id="ref-for-dom-imageresource-2"><code>ImageResource</code></a> dictionary to represent an image
            resource in contexts
            where an <code>HTMLImageElement</code> is not suitable or available (e.g., in a
            Worker).
        </p>
    </section>
    <section id="sotd" class="introductory">
        <h2>Status of This Document</h2>
        <p><em>This section describes the status of this
                document at the time of its publication. Other documents may supersede
                this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the
                latest revision
                of this technical report can be found in the
                <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports
                    index</a> at
                https://www.w3.org/TR/.</em></p>
        <div class="warning" id="issue-container-generatedID">
            <div role="heading" class="warning-title marker" id="h-warning" aria-level="3"><span>Warning</span></div>
            <p class="">
                <strong>This specification is not stable.</strong> Implementors who are
                not taking part in the discussions will find the specification changing
                out from under them in incompatible ways.
            </p>
        </div>
        <p>
            This document was published by the <a href="https://www.w3.org/2019/webapps/">Web Applications Working
                Group</a> as a
            Working Draft.
            This document is intended to become a <abbr title="World Wide Web Consortium">W3C</abbr> Recommendation.
        </p>
        <p>
            <a href="https://github.com/w3c/image-resource/issues/">GitHub Issues</a> are preferred for
            discussion of this specification.


        </p>
        <p>
            Publication as a Working Draft does not imply endorsement
            by the <abbr title="World Wide Web Consortium">W3C</abbr> Membership.
        </p>
        <p>This is a draft document and may be updated, replaced
            or obsoleted by other documents at any time. It is inappropriate to cite this
            document as other than work in progress.
        </p>
        <p></p>
        <p>

            This document was produced by a group
            operating under the
            <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="World Wide Web Consortium">W3C</abbr>
                Patent
                Policy</a>.


            <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
            <a rel="disclosure" href="https://www.w3.org/groups/wg/webapps/ipr">public list of any patent
                disclosures</a>
            made in connection with the deliverables of
            the group; that page also includes
            instructions for disclosing a patent. An individual who has actual
            knowledge of a patent which the individual believes contains
            <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential Claim(s)</a>
            must disclose the information in accordance with
            <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section 6 of the <abbr
                    title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.


        </p>
        <p>
            This document is governed by the
            <a id="w3c_process_revision" href="https://www.w3.org/2020/Process-20200915/">15 September 2020 <abbr
                    title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
        </p>
    </section>
    <nav id="toc">
        <h2 class="introductory" id="table-of-contents">Table of Contents</h2>
        <ol class="toc">
            <li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>
                    Introduction
                </a></li>
            <li class="tocline"><a class="tocxref" href="#privacy-and-security-considerations"><bdi class="secno">2.
                    </bdi>
                    Privacy and security considerations
                </a></li>
            <li class="tocline"><a class="tocxref" href="#image-resource"><bdi class="secno">3. </bdi>
                    Image resource
                </a></li>
            <li class="tocline"><a class="tocxref" href="#imageresource-dictionary"><bdi class="secno">4. </bdi>
                    <span data-export="" data-dfn-type="dictionary" data-idl="dictionary" data-title="ImageResource"
                        data-dfn-for=""><code>ImageResource</code></span> dictionary
                </a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#src-member"><bdi class="secno">4.1 </bdi>
                            <span data-export="" data-dfn-type="dict-member" data-idl="field" data-title="src"
                                data-dfn-for="ImageResource" data-type="USVString"><code>src</code></span> member
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#sizes-member"><bdi class="secno">4.2 </bdi>
                            <span data-export="" data-dfn-type="dict-member" data-idl="field" data-title="sizes"
                                data-dfn-for="ImageResource" data-type="DOMString"><code>sizes</code></span> member
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#type-member"><bdi class="secno">4.3 </bdi>
                            <span data-export="" data-dfn-type="dict-member" data-idl="field" data-title="type"
                                data-dfn-for="ImageResource" data-type="DOMString"><code>type</code></span> member
                        </a></li>
                    <li class="tocline"><a class="tocxref" href="#label-member"><bdi class="secno">4.4 </bdi>
                            <span data-export="" data-dfn-type="dict-member" data-idl="field" data-title="label"
                                data-dfn-for="ImageResource" data-type="DOMString"><code>label</code></span> member
                        </a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#processing-an-imageresource-from-an-api"><bdi class="secno">5.
                    </bdi>
                    Processing an <code>ImageResource</code> from an API
                </a></li>
            <li class="tocline"><a class="tocxref" href="#processing-an-image-resource-from-json"><bdi class="secno">6.
                    </bdi>
                    Processing an image resource from JSON
                </a></li>
            <li class="tocline"><a class="tocxref" href="#fetching-an-image-resource"><bdi class="secno">7. </bdi>
                    Fetching an image resource
                </a></li>
            <li class="tocline"><a class="tocxref" href="#deriving-the-accessible-name"><bdi class="secno">8. </bdi>
                    Deriving the accessible name
                </a></li>
            <li class="tocline"><a class="tocxref"
                    href="#examples-of-graphics-formats-supporting-embedded-accessible-names"><bdi class="secno">9.
                    </bdi>
                    Examples of graphics formats supporting embedded accessible names
                </a></li>
            <li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">10. </bdi>Conformance</a></li>
            <li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">A. </bdi>References</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">A.1
                            </bdi>Normative references</a></li>
                </ol>
            </li>
        </ol>
    </nav>
    <section id="introduction">
        <h2 id="x1-introduction"><bdi class="secno">1. </bdi>
            Introduction
            <a class="self-link" aria-label="§" href="#introduction"></a>
        </h2>
        <p>
            Web applications often accept developer-provided image resources to be
            displayed outside of a HTML document (e.g., in the OS, in the browser
            UI, etc.). This specification defines a WebIDL dictionary that
            describes an image, and where that image resource can be fetched from.
            The user agent can then use this extra information to choose an image
            that is best suited to display on the end-user's device or most closely
            matches the end-user's preferences or environment.
        </p>
    </section>
    <section id="privacy-and-security-considerations">
        <h2 id="x2-privacy-and-security-considerations"><bdi class="secno">2. </bdi>
            Privacy and security considerations
            <a class="self-link" aria-label="§" href="#privacy-and-security-considerations"></a>
        </h2>
        <p>
            <a data-link-type="dfn" href="#dfn-fetching-an-image-resource" class="internalDFN"
                id="ref-for-dfn-fetching-an-image-resource-1">Fetching an image resource</a> can reveal the user's IP
            address. It is
            <em class="rfc2119">RECOMMENDED</em> that user agents fetch the chosen <a data-link-type="dfn"
                href="#dfn-image-resource" class="internalDFN" id="ref-for-dfn-image-resource-1">image resources</a>
            when
            provided by the developer, and store them for re-use if needed. This
            limits tracking the user's location over time.
        </p>
    </section>
    <section id="image-resource">
        <h2 id="x3-image-resource"><bdi class="secno">3. </bdi>
            Image resource
            <a class="self-link" aria-label="§" href="#image-resource"></a>
        </h2>
        <p>
            An <dfn data-export="" data-plurals="image resources" id="dfn-image-resource" tabindex="0"
                aria-haspopup="dialog">image resource</dfn> consists of:
        </p>
        <dl>
            <dt>
                <dfn data-dfn-for="image resource" id="dfn-src" tabindex="0" aria-haspopup="dialog">src</dfn>
            </dt>
            <dd>
                A <a data-link-type="dfn" data-type="dfn" href="https://url.spec.whatwg.org/#concept-url">URL</a> from
                where to obtain the image data.
            </dd>
            <dt>
                <dfn data-dfn-for="image resource" id="dfn-sizes" tabindex="0" aria-haspopup="dialog">sizes</dfn>
            </dt>
            <dd>
                An optional <a data-link-type="dfn" data-type="dfn"
                    href="https://infra.spec.whatwg.org/#string">string</a> representing the sizes of the image,
                expressed
                using the same syntax as
                <code><a data-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element">link</a></code>'s
                <code><a data-type="element-attr" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-sizes">sizes</a></code>
                attribute.
            </dd>
            <dt>
                <dfn data-dfn-for="image resource" id="dfn-type" tabindex="0" aria-haspopup="dialog">type</dfn>
            </dt>
            <dd>
                An optional <a data-link-type="dfn" data-type="dfn"
                    href="https://mimesniff.spec.whatwg.org/#image-mime-type">image MIME type</a>.
            </dd>
            <dt>
                <dfn data-dfn-for="image resource" id="dfn-label" tabindex="0" aria-haspopup="dialog">label</dfn>
            </dt>
            <dd>
                A <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#string">string</a>
                representing the accessible name of the image.
            </dd>
        </dl>
        <p>
            In an API, an <a data-link-type="dfn" href="#dfn-image-resource" class="internalDFN"
                id="ref-for-dfn-image-resource-2">image resource</a> is represented as an <a data-link-type="idl"
                href="#dom-imageresource" class="internalDFN"
                id="ref-for-dom-imageresource-3"><code>ImageResource</code></a>
            dictionary.
        </p>
        <p>
            In [<cite><a class="bibref" data-link-type="biblio" href="#bib-json"
                    title="The JavaScript Object Notation (JSON) Data Interchange Format">JSON</a></cite>], <a
                data-link-type="dfn" href="#dfn-image-resource" class="internalDFN"
                id="ref-for-dfn-image-resource-3">image resource</a> is represented as an object.
        </p>
    </section>
    <section data-dfn-for="ImageResource" id="imageresource-dictionary">
        <h2 id="x4-imageresource-dictionary"><bdi class="secno">4. </bdi>
            <dfn data-export="" data-dfn-type="dictionary" id="dom-imageresource" data-idl="dictionary"
                data-title="ImageResource" data-dfn-for="" tabindex="0"
                aria-haspopup="dialog"><code>ImageResource</code></dfn> dictionary
            <a class="self-link" aria-label="§" href="#imageresource-dictionary"></a>
        </h2>
        <pre class="idl def" id="webidl-1355091221"><span class="idlHeader"><a class="self-link" href="#webidl-1355091221">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-imageresource" data-title="ImageResource">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dom-imageresource" id="ref-for-dom-imageresource-4"><code>ImageResource</code></a> {<span data-idl="" class="idlMember" id="idl-def-imageresource-src" data-title="src" data-dfn-for="ImageResource">
  required<span class="idlType"> <a data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-imageresource-src" id="ref-for-dom-imageresource-src-1"><code>src</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-imageresource-sizes" data-title="sizes" data-dfn-for="ImageResource"><span class="idlType">
  <a data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-imageresource-sizes" id="ref-for-dom-imageresource-sizes-1"><code>sizes</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-imageresource-type" data-title="type" data-dfn-for="ImageResource"><span class="idlType">
  <a data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-imageresource-type" id="ref-for-dom-imageresource-type-1"><code>type</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-imageresource-label" data-title="label" data-dfn-for="ImageResource"><span class="idlType">
  <a data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-imageresource-label" id="ref-for-dom-imageresource-label-1"><code>label</code></a>;</span>
};</span></code></pre>
        <section id="src-member">
            <h3 id="x4-1-src-member"><bdi class="secno">4.1 </bdi>
                <dfn data-export="" data-dfn-type="dict-member" id="dom-imageresource-src" data-idl="field"
                    data-title="src" data-dfn-for="ImageResource" data-type="USVString" tabindex="0"
                    aria-haspopup="dialog"><code>src</code></dfn> member
                <a class="self-link" aria-label="§" href="#src-member"></a>
            </h3>
            <p>
                The <a data-link-type="idl" href="#dom-imageresource-src" class="internalDFN"
                    id="ref-for-dom-imageresource-src-2"><code>src</code></a> of an <a data-link-type="idl"
                    href="#dom-imageresource" class="internalDFN"
                    id="ref-for-dom-imageresource-5"><code>ImageResource</code></a> is a <a data-link-type="dfn"
                    data-type="dfn" href="https://url.spec.whatwg.org/#concept-url">URL</a> from
                which a user agent can <a data-link-type="dfn" data-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-fetch">fetch</a> image data.
            </p>
        </section>
        <section data-cite="html" id="sizes-member">
            <h3 id="x4-2-sizes-member"><bdi class="secno">4.2 </bdi>
                <dfn data-export="" data-dfn-type="dict-member" id="dom-imageresource-sizes" data-idl="field"
                    data-title="sizes" data-dfn-for="ImageResource" data-type="DOMString" tabindex="0"
                    aria-haspopup="dialog"><code>sizes</code></dfn> member
                <a class="self-link" aria-label="§" href="#sizes-member"></a>
            </h3>
            <p>
                The <a data-link-type="idl" href="#dom-imageresource-sizes" class="internalDFN"
                    id="ref-for-dom-imageresource-sizes-2"><code>sizes</code></a> member is equivalent to a
                <code><a data-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element">link</a></code>
                element's
                <code><a data-type="element-attr" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-sizes">sizes</a></code>
                attribute, and is processed in the same
                manner.
            </p>
            <p>
                When multiple <a data-link-type="idl" href="#dom-imageresource" class="internalDFN"
                    id="ref-for-dom-imageresource-6"><code>ImageResource</code></a> dictionaries are available, a user
                agent <em class="rfc2119">MAY</em> use the <a data-link-type="idl" href="#dom-imageresource-sizes"
                    class="internalDFN" id="ref-for-dom-imageresource-sizes-3"><code>sizes</code></a> value to decide
                which image
                is most suitable for a display context (and ignore any that are
                inappropriate).
            </p>
            <div class="note" role="note" id="issue-container-generatedID-0">
                <div role="heading" class="note-title marker" id="h-note" aria-level="4"><span>Note</span></div>
                <aside class="">
                    When multiple <a data-link-type="idl" href="#dom-imageresource" class="internalDFN"
                        id="ref-for-dom-imageresource-7"><code>ImageResource</code></a> dictionaries are being used by
                    an API
                    (e.g., in a WebIDL <a data-link-type="dfn" data-type="dfn"
                        href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>), the specifications should
                    indicate
                    if the order in which the dictionaries are passed is significant. As
                    a general rule, order is significant and "first match wins".
                </aside>
            </div>
            <div class="example">
                The <a data-link-type="idl" href="#dom-imageresource-sizes" class="internalDFN"
                    id="ref-for-dom-imageresource-sizes-4"><code>sizes</code></a> member allows for multiple
                space-separated size values in order to accommodate image formats
                (such as ICO) that can act as a container for multiple images of
                varying dimensions.
                <pre aria-busy="false"><code class="hljs js"><span class="hljs-keyword">const</span> image = {
  <span class="hljs-attr">src</span>: <span class="hljs-string">"path/to/image.ico"</span>,
  <span class="hljs-attr">sizes</span>: <span class="hljs-string">"16x16 32x32 64x64"</span>,
  <span class="hljs-attr">type</span>: <span class="hljs-string">"image/vnd.microsoft.icon"</span>,
};
some.api.doSomething(image);</code></pre>
            </div>
        </section>
        <section id="type-member">
            <h3 id="x4-3-type-member"><bdi class="secno">4.3 </bdi>
                <dfn data-export="" data-dfn-type="dict-member" id="dom-imageresource-type" data-idl="field"
                    data-title="type" data-dfn-for="ImageResource" data-type="DOMString" tabindex="0"
                    aria-haspopup="dialog"><code>type</code></dfn> member
                <a class="self-link" aria-label="§" href="#type-member"></a>
            </h3>
            <p>
                The <a data-link-type="idl" href="#dom-imageresource-type" class="internalDFN"
                    id="ref-for-dom-imageresource-type-2"><code>type</code></a> member represents an <a
                    data-link-type="dfn" data-type="dfn" href="https://mimesniff.spec.whatwg.org/#image-mime-type">image
                    MIME Type</a>
                for the image resource. A user agent <em class="rfc2119">MAY</em> ignore media types it does
                not support.
            </p>
            <p>
                There is no default <a data-link-type="dfn" data-type="dfn"
                    href="https://mimesniff.spec.whatwg.org/#mime-type">MIME type</a> for an <a data-link-type="idl"
                    href="#dom-imageresource" class="internalDFN"
                    id="ref-for-dom-imageresource-8"><code>ImageResource</code></a>. The
                <a data-link-type="idl" href="#dom-imageresource-type" class="internalDFN"
                    id="ref-for-dom-imageresource-type-3"><code>type</code></a> is purely advisory. User agents <em
                    class="rfc2119">MUST</em> use the
                <a data-link-type="dfn" data-type="dfn"
                    href="https://mimesniff.spec.whatwg.org/#rules-for-sniffing-images-specifically">rules for sniffing
                    images specifically</a> to determine the
                <a data-link-type="dfn" data-type="dfn"
                    href="https://mimesniff.spec.whatwg.org/#computed-mime-type">computed MIME type</a> of an <a
                    data-link-type="dfn" href="#dfn-image-resource" class="internalDFN"
                    id="ref-for-dfn-image-resource-4">image resource</a>.
            </p>
        </section>
        <section data-cite="WAI-ARIA" id="label-member">
            <h3 id="x4-4-label-member"><bdi class="secno">4.4 </bdi>
                <dfn data-export="" data-dfn-type="dict-member" id="dom-imageresource-label" data-idl="field"
                    data-title="label" data-dfn-for="ImageResource" data-type="DOMString" tabindex="0"
                    aria-haspopup="dialog"><code>label</code></dfn> member
                <a class="self-link" aria-label="§" href="#label-member"></a>
            </h3>
            <p>
                The <a data-link-type="idl" href="#dom-imageresource-label" class="internalDFN"
                    id="ref-for-dom-imageresource-label-2"><code>label</code></a> of an <a data-link-type="idl"
                    href="#dom-imageresource" class="internalDFN"
                    id="ref-for-dom-imageresource-9"><code>ImageResource</code></a> is a <a data-link-type="dfn"
                    data-type="dfn" href="https://infra.spec.whatwg.org/#string">string</a>
                that provides the <a data-link-type="dfn" data-type="dfn" class="respec-offending-element"
                    title="Error: Normative reference to informative term"
                    id="respec-offender-error-normative-reference-to-informative-term"
                    href="https://www.w3.org/TR/wai-aria/#dfn-accessible-name">accessible name</a> for the associated
                image.
            </p>
            <p>
                Implementors <em class="rfc2119">MUST</em> <a data-link-type="dfn"
                    href="#dfn-deriving-the-accessible-name" class="internalDFN"
                    id="ref-for-dfn-deriving-the-accessible-name-1">derive the accessible name</a> for every
                <a data-link-type="idl" href="#dom-imageresource" class="internalDFN"
                    id="ref-for-dom-imageresource-10"><code>ImageResource</code></a> they expose to users.
            </p>
            <p>
                Authors are strongly encouraged to add a <a data-link-type="idl" href="#dom-imageresource-label"
                    class="internalDFN" id="ref-for-dom-imageresource-label-3"><code>label</code></a>
                unless the <a data-link-type="idl" href="#dom-imageresource" class="internalDFN"
                    id="ref-for-dom-imageresource-11"><code>ImageResource</code></a>’s <a data-link-type="dfn"
                    data-type="dfn" class="respec-offending-element"
                    title="Error: Normative reference to informative term"
                    id="respec-offender-error-normative-reference-to-informative-term-0"
                    href="https://www.w3.org/TR/wai-aria/#dfn-accessible-name">accessible name</a> can be inferred
                from an <dfn id="dfn-external-label" tabindex="0" aria-haspopup="dialog">external label</dfn> in its
                context. For example, in the
                context of a <a data-link-type="dfn" data-type="dfn"
                    href="https://www.w3.org/TR/appmanifest/#dfn-application-manifest">manifest</a>, the <a
                    data-link-type="dfn" data-type="dfn"
                    href="https://www.w3.org/TR/appmanifest/#dfn-name"><code>name</code></a> (or
                <a data-link-type="dfn" data-type="dfn"
                    href="https://www.w3.org/TR/appmanifest/#dfn-short_name"><code>short_name</code></a>) provides an <a
                    data-link-type="dfn" href="#dfn-external-label" class="internalDFN"
                    id="ref-for-dfn-external-label-1">external label</a> for all
                members of the <a data-link-type="dfn" data-type="dfn"
                    href="https://www.w3.org/TR/appmanifest/#dfn-icons"><code>icons</code></a> array that don’t have a
                <a data-link-type="idl" href="#dom-imageresource-label" class="internalDFN"
                    id="ref-for-dom-imageresource-label-4"><code>label</code></a> defined.
            </p>
            <p>
                If neither an explicit <a data-link-type="idl" href="#dom-imageresource-label" class="internalDFN"
                    id="ref-for-dom-imageresource-label-5"><code>label</code></a> nor an <a data-link-type="dfn"
                    href="#dfn-external-label" class="internalDFN" id="ref-for-dfn-external-label-2">external
                    label</a> is provided, but the <a data-link-type="idl" href="#dom-imageresource-type"
                    class="internalDFN" id="ref-for-dom-imageresource-type-4"><code>type</code></a> supports
                providing an <a data-link-type="dfn" href="#dfn-embedded-accessible-name" class="internalDFN"
                    id="ref-for-dfn-embedded-accessible-name-1">embedded accessible name</a>, implementors <em
                    class="rfc2119">MAY</em> choose to
                defer assigning the <a data-link-type="idl" href="#dom-imageresource-label" class="internalDFN"
                    id="ref-for-dom-imageresource-label-6"><code>label</code></a> until the
                <a data-link-type="idl" href="#dom-imageresource-src" class="internalDFN"
                    id="ref-for-dom-imageresource-src-3"><code>src</code></a> has been fetched and processed. If the
                <a data-link-type="idl" href="#dom-imageresource-src" class="internalDFN"
                    id="ref-for-dom-imageresource-src-4"><code>src</code></a> is found to provide an <a
                    data-link-type="dfn" href="#dfn-embedded-accessible-name" class="internalDFN"
                    id="ref-for-dfn-embedded-accessible-name-2">embedded accessible
                    name</a>, implementors <em class="rfc2119">MUST</em> update the <a data-link-type="idl"
                    href="#dom-imageresource-label" class="internalDFN"
                    id="ref-for-dom-imageresource-label-7"><code>label</code></a> to match
                that value.
            </p>
        </section>
    </section>
    <section id="processing-an-imageresource-from-an-api">
        <h2 id="x5-processing-an-imageresource-from-an-api"><bdi class="secno">5. </bdi>
            Processing an <code>ImageResource</code> from an API
            <a class="self-link" aria-label="§" href="#processing-an-imageresource-from-an-api"></a>
        </h2>
        <p>
            The steps to <dfn data-export="" id="dfn-process-an-imageresource-from-an-api" tabindex="0"
                aria-haspopup="dialog">process an <code>ImageResource</code> from an
                API</dfn> are given by the following algorithm. The algorithm takes an
            <a data-link-type="idl" href="#dom-imageresource" class="internalDFN"
                id="ref-for-dom-imageresource-12"><code>ImageResource</code></a> <var
                data-type="ImageResource">input</var>. It returns an <a data-link-type="dfn" href="#dfn-image-resource"
                class="internalDFN" id="ref-for-dfn-image-resource-5">image
                resource</a>.
        </p>
        <ol>
            <li>Let <var>base URL</var> be the <a data-link-type="dfn" data-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">relevant
                    settings object</a>’s <a data-link-type="dfn" data-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url">api base url</a> from
                where this dictionary is being
                used.
            </li>
            <li>Let <var>image</var> be a new <a data-link-type="dfn" href="#dfn-image-resource" class="internalDFN"
                    id="ref-for-dfn-image-resource-6">image resource</a>.
            </li>
            <li>Set <var>image</var>'s <a data-link-type="dfn" href="#dfn-src" class="internalDFN"
                    id="ref-for-dfn-src-1">src</a> to the result of <a data-link-type="dfn" data-lt="URL
        parser" data-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser">URL parsing</a> <var
                    data-type="ImageResource">input</var>.<a data-link-type="idl" href="#dom-imageresource-src"
                    class="internalDFN" id="ref-for-dom-imageresource-src-5"><code>src</code></a> and <var>base
                    URL</var>. If
                parsing the URL fails, throw a <a data-link-type="idl" data-type="exception"
                    href="https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a>.
            </li>
            <li>If <var data-type="ImageResource">input</var>'s <a data-link-type="idl" href="#dom-imageresource-sizes"
                    class="internalDFN" id="ref-for-dom-imageresource-sizes-5"><code>sizes</code></a> member is present:
                <ol>
                    <li data-cite="html">Set <var>image</var>'s <a data-link-type="dfn" href="#dfn-sizes"
                            class="internalDFN" id="ref-for-dfn-sizes-1">sizes</a> to the
                        result of parsing <var data-type="ImageResource">input</var>.<a data-link-type="idl"
                            href="#dom-imageresource-sizes" class="internalDFN"
                            id="ref-for-dom-imageresource-sizes-6"><code>sizes</code></a> as if it was a
                        <code><a data-type="element-attr" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-sizes">sizes</a></code>
                        attribute of a
                        <code><a data-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element">link</a></code>
                        element whose
                        <code><a data-type="element-attr" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-rel">rel</a></code>
                        attribute contains the token <code>icon</code>. If parsing fails, throw a
                        <a data-link-type="idl" data-type="exception"
                            href="https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a>.
                    </li>
                </ol>
            </li>
            <li>If <var data-type="ImageResource">input</var>'s <a data-link-type="idl" href="#dom-imageresource-type"
                    class="internalDFN" id="ref-for-dom-imageresource-type-5"><code>type</code></a> member is present
                and not the
                empty string:
                <ol>
                    <li>If <a data-link-type="idl" href="#dom-imageresource-type" class="internalDFN"
                            id="ref-for-dom-imageresource-type-6"><code>type</code></a> is not an <a
                            data-link-type="dfn" data-type="dfn"
                            href="https://mimesniff.spec.whatwg.org/#image-mime-type">image MIME Type</a>, throw
                        a <a data-link-type="idl" data-type="exception"
                            href="https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a>.
                    </li>
                    <li>Set <var>image</var>'s <a data-link-type="dfn" href="#dfn-type" class="internalDFN"
                            id="ref-for-dfn-type-1">type</a> to
                        <var data-type="ImageResource">input</var>.<a data-link-type="idl"
                            href="#dom-imageresource-type" class="internalDFN"
                            id="ref-for-dom-imageresource-type-7"><code>type</code></a>.
                    </li>
                </ol>
            </li>
            <li>Set <var>image</var>'s <a data-link-type="dfn" href="#dfn-label" class="internalDFN"
                    id="ref-for-dfn-label-1">label</a> to the result of <a data-link-type="dfn"
                    href="#dfn-deriving-the-accessible-name" class="internalDFN"
                    id="ref-for-dfn-deriving-the-accessible-name-2">deriving
                    the accessible name</a>.
            </li>
            <li>Return <var>image</var>.
            </li>
        </ol>
    </section>
    <section id="processing-an-image-resource-from-json">
        <h2 id="x6-processing-an-image-resource-from-json"><bdi class="secno">6. </bdi>
            Processing an image resource from JSON
            <a class="self-link" aria-label="§" href="#processing-an-image-resource-from-json"></a>
        </h2>
        <p>
            To <dfn data-export="" id="dfn-process-an-image-resource-from-json" tabindex="0"
                aria-haspopup="dialog">process an image resource from JSON</dfn>, given
            a JSON Object <var data-type="object">input</var> and a <a data-link-type="dfn" data-type="dfn"
                href="https://url.spec.whatwg.org/#concept-url">URL</a> <var data-type="URL">base</var>. It returns an
            <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">ordered map</a>.
        </p>
        <ol>
            <li>If <var data-type="object">input</var> is not of type <a data-link-type="dfn" data-type="element"
                    href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element">object</a>,
                return failure.
            </li>
            <li>If <var data-type="object">input</var>["src"] is not of type <a data-link-type="dfn" data-type="dfn"
                    href="https://infra.spec.whatwg.org/#string">string</a>, return failure.
            </li>
            <li>Let <var data-type="URL">src</var> be the result of <a data-link-type="dfn" data-lt="URL parser"
                    data-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser">parsing</a>
                <var data-type="object">input</var>["src"] with <var data-type="URL">base</var> as the base URL.
            </li>
            <li>If <var data-type="URL">src</var> is failure, return failure.
            </li>
            <li>Let <var>image</var> be an new <a data-link-type="dfn" data-type="dfn"
                    href="https://infra.spec.whatwg.org/#ordered-map">ordered map</a>.
            </li>
            <li>Set <var>image</var>["src"] to <var data-type="URL">src</var>.
            </li>
            <li>If type of <var data-type="object">input</var>["sizes"] is a <a data-link-type="dfn" data-type="dfn"
                    href="https://infra.spec.whatwg.org/#string">string</a>, and its length is
                greater than zero:
                <ol>
                    <li>Set <var data-type="string">sizes</var> to the result of parsing <var
                            data-type="object">input</var>["sizes"] as
                        if it was a
                        <code><a data-type="element-attr" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-sizes">sizes</a></code>
                        attribute of a
                        <code><a data-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element">link</a></code>
                        element whose
                        <code><a data-type="element-attr" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-rel">rel</a></code>
                        attribute contains the token <code>icon</code>.
                    </li>
                    <li>If <var data-type="string">sizes</var> is failure, return failure.
                    </li>
                    <li>Set <var>image</var>["sizes"] to <var data-type="string">sizes</var>.
                    </li>
                </ol>
            </li>
            <li>If <var data-type="object">input</var>["type"] is a <a data-link-type="dfn" data-type="dfn"
                    href="https://infra.spec.whatwg.org/#string">string</a>, and it has a length greater
                than zero:
                <ol>
                    <li>Let <var>mime</var> be the result of <a data-link-type="dfn" data-lt="parse a mime type"
                            data-type="dfn" href="https://mimesniff.spec.whatwg.org/#parse-a-mime-type">parsing</a>
                        <var data-type="object">input</var>["type"].
                    </li>
                    <li>If <var>mime</var> is failure, return failure.
                    </li>
                    <li>Set <var>image</var>["type"] to the <a data-link-type="dfn" data-type="dfn"
                            href="https://mimesniff.spec.whatwg.org/#mime-type-essence">essence</a> of <var>mime</var>.
                    </li>
                </ol>
            </li>
            <li>Set <var>image</var>["label"] to the result of <a data-link-type="dfn"
                    href="#dfn-deriving-the-accessible-name" class="internalDFN"
                    id="ref-for-dfn-deriving-the-accessible-name-3">deriving the accessible
                    name</a>.
            </li>
            <li>Return <var>image</var>.
            </li>
        </ol>
    </section>
    <section id="fetching-an-image-resource">
        <h2 id="x7-fetching-an-image-resource"><bdi class="secno">7. </bdi>
            Fetching an image resource
            <a class="self-link" aria-label="§" href="#fetching-an-image-resource"></a>
        </h2>
        <p>
            The steps for <dfn data-export="" id="dfn-fetching-an-image-resource" tabindex="0"
                aria-haspopup="dialog">fetching an image resource</dfn> are
            given by the following algorithm. The algorithm takes an <a data-link-type="dfn" href="#dfn-image-resource"
                class="internalDFN" id="ref-for-dfn-image-resource-7">image
                resource</a> <var>image</var>, and an optional <a data-link-type="dfn" data-type="dfn"
                href="https://fetch.spec.whatwg.org/#concept-request">Request</a> <var>request</var>. It returns a
            <a data-link-type="dfn" data-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">Response</a>.
        </p>
        <ol>
            <li>If <var>request</var> is <code>undefined</code>:
                <ol>
                    <li>Set <var>request</var> to a new <a data-link-type="dfn" data-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request">Request</a>.
                    </li>
                    <li>Set <a data-link-type="dfn" data-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-url">URL</a> to <var>image</var>'s <a
                            data-link-type="dfn" href="#dfn-src" class="internalDFN" id="ref-for-dfn-src-2">src</a>.
                    </li>
                    <li>Set <a data-link-type="dfn" data-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-destination">Destination</a> to
                        "image".
                    </li>
                    <li>Set <a data-link-type="dfn" data-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-client">Client</a> to the context
                        object's <a data-link-type="dfn" data-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">relevant
                            settings object</a>.
                    </li>
                </ol>
            </li>
            <li>If <var>request</var>'s <a data-link-type="dfn" data-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-client">Client</a> is null, throw a <a
                    data-link-type="idl" data-type="exception"
                    href="https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a>.
            </li>
            <li>Perform a <a data-link-type="dfn" data-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-fetch">fetch</a> using <var>request</var> and return
                the <a data-link-type="dfn" data-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response">Response</a>.
            </li>
        </ol>
        <div class="note" role="note" id="issue-container-generatedID-1">
            <div role="heading" class="note-title marker" id="h-note-0" aria-level="3"><span>Note</span></div>
            <aside class="">
                <a data-link-type="dfn" data-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-client">Client</a> is required here so the
                appropriate CSP can be
                applied.
            </aside>
        </div>
    </section>
    <section id="deriving-the-accessible-name">
        <h2 id="x8-deriving-the-accessible-name"><bdi class="secno">8. </bdi>
            Deriving the accessible name
            <a class="self-link" aria-label="§" href="#deriving-the-accessible-name"></a>
        </h2>
        <p>
            The steps to <dfn data-lt="deriving the accessible name|derive the accessible name"
                id="dfn-deriving-the-accessible-name" tabindex="0" aria-haspopup="dialog">derive the
                accessible name</dfn> for an <a data-link-type="dfn" href="#dfn-image-resource" class="internalDFN"
                id="ref-for-dfn-image-resource-8">image resource</a> <var>resource</var> are as
            follows. It returns a <a data-link-type="dfn" data-type="dfn"
                href="https://infra.spec.whatwg.org/#string">string</a>.
        </p>
        <ol>
            <li>If <var>resource</var>["label"] is a <a data-link-type="dfn" data-type="dfn"
                    href="https://infra.spec.whatwg.org/#string">string</a>, return <var>input</var>["label"].
            </li>
            <li>Otherwise, if <var>image</var> provides an <a data-link-type="dfn" href="#dfn-embedded-accessible-name"
                    class="internalDFN" id="ref-for-dfn-embedded-accessible-name-3">embedded accessible name</a>,
                return the <a data-link-type="dfn" href="#dfn-embedded-accessible-name" class="internalDFN"
                    id="ref-for-dfn-embedded-accessible-name-4">embedded accessible name</a>.
            </li>
            <li>Otherwise, if an <a data-link-type="dfn" href="#dfn-external-label" class="internalDFN"
                    id="ref-for-dfn-external-label-3">external label</a> can be substituted, return the
                relevant <a data-link-type="dfn" href="#dfn-external-label" class="internalDFN"
                    id="ref-for-dfn-external-label-4">external label</a>.
            </li>
            <li>Return "".
            </li>
        </ol>
    </section>
    <section id="examples-of-graphics-formats-supporting-embedded-accessible-names">
        <h2 id="x9-examples-of-graphics-formats-supporting-embedded-accessible-names"><bdi class="secno">9. </bdi>
            Examples of graphics formats supporting embedded accessible names
            <a class="self-link" aria-label="§"
                href="#examples-of-graphics-formats-supporting-embedded-accessible-names"></a>
        </h2>
        <p>
            Certain graphics formats support the inclusion of an <dfn id="dfn-embedded-accessible-name" tabindex="0"
                aria-haspopup="dialog">embedded
                accessible name</dfn> as part of the image’s contents. Examples
            include:
        </p>
        <ul>
            <li data-cite="SVG">The
                <code><a data-type="element" href="https://www.w3.org/TR/SVG/struct.html#elementdef-title">title</a></code>
                element in <a data-link-type="dfn" data-type="element"
                    href="https://www.w3.org/TR/SVG/struct.html#elementdef-svg">SVG</a>.
            </li>
            <li>Metadata in raster images (e.g., tiff:ImageDescription,
                XMP:Description).
            </li>
        </ul>
    </section>
    <section id="conformance">
        <h2 id="x10-conformance"><bdi class="secno">10. </bdi>Conformance<a class="self-link" aria-label="§"
                href="#conformance"></a></h2>
        <p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this
            specification are non-normative. Everything else in this specification is normative.</p>
        <p>
            The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, and <em
                class="rfc2119">RECOMMENDED</em> in this document
            are to be interpreted as described in
            <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119"
                    title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a
                    class="bibref" data-link-type="biblio" href="#bib-rfc8174"
                    title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
            when, and only when, they appear in all capitals, as shown here.
        </p>
    </section>


    <section id="references" class="appendix">
        <h2 id="a-references"><bdi class="secno">A. </bdi>References<a class="self-link" aria-label="§"
                href="#references"></a></h2>
        <section id="normative-references">
            <h3 id="a-1-normative-references"><bdi class="secno">A.1 </bdi>Normative references<a class="self-link"
                    aria-label="§" href="#normative-references"></a></h3>
            <dl class="bibliography">
                <dt id="bib-appmanifest">[appmanifest]</dt>
                <dd><a href="https://www.w3.org/TR/appmanifest/"><cite>Web Application Manifest</cite></a>. Marcos
                    Caceres; Kenneth Christiansen; Mounir Lamouri; Anssi Kostiainen; Matt Giuca; Aaron Gustafson. W3C. 1
                    June 2021. W3C Working Draft. URL: <a
                        href="https://www.w3.org/TR/appmanifest/">https://www.w3.org/TR/appmanifest/</a></dd>
                <dt id="bib-fetch">[fetch]</dt>
                <dd><a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Anne van Kesteren. WHATWG.
                    Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-html">[html]</dt>
                <dd><a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Anne van Kesteren;
                    Domenic Denicola; Ian Hickson; Philip Jägenstedt; Simon Pieters. WHATWG. Living Standard. URL: <a
                        href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a></dd>
                <dt id="bib-infra">[infra]</dt>
                <dd><a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Anne van Kesteren; Domenic
                    Denicola. WHATWG. Living Standard. URL: <a
                        href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a></dd>
                <dt id="bib-json">[JSON]</dt>
                <dd><a href="https://datatracker.ietf.org/doc/html/rfc8259"><cite>The JavaScript Object Notation (JSON)
                            Data Interchange Format</cite></a>. T. Bray, Ed.. IETF. December 2017. Internet Standard.
                    URL: <a
                        href="https://datatracker.ietf.org/doc/html/rfc8259">https://datatracker.ietf.org/doc/html/rfc8259</a>
                </dd>
                <dt id="bib-mimesniff">[mimesniff]</dt>
                <dd><a href="https://mimesniff.spec.whatwg.org/"><cite>MIME Sniffing Standard</cite></a>. Gordon P.
                    Hemsley. WHATWG. Living Standard. URL: <a
                        href="https://mimesniff.spec.whatwg.org/">https://mimesniff.spec.whatwg.org/</a></dd>
                <dt id="bib-rfc2119">[RFC2119]</dt>
                <dd><a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate
                            Requirement Levels</cite></a>. S. Bradner. IETF. March 1997. Best Current Practice. URL: <a
                        href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
                </dd>
                <dt id="bib-rfc8174">[RFC8174]</dt>
                <dd><a href="https://datatracker.ietf.org/doc/html/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in
                            RFC 2119 Key Words</cite></a>. B. Leiba. IETF. May 2017. Best Current Practice. URL: <a
                        href="https://datatracker.ietf.org/doc/html/rfc8174">https://datatracker.ietf.org/doc/html/rfc8174</a>
                </dd>
                <dt id="bib-svg">[svg]</dt>
                <dd><a href="https://www.w3.org/TR/SVG/"><cite>Scalable Vector Graphics (SVG) 1.0
                            Specification</cite></a>. Jon Ferraiolo. W3C. 4 September 2001. W3C Recommendation. URL: <a
                        href="https://www.w3.org/TR/SVG/">https://www.w3.org/TR/SVG/</a></dd>
                <dt id="bib-url">[url]</dt>
                <dd><a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Anne van Kesteren. WHATWG.
                    Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a></dd>
                <dt id="bib-webidl">[webidl]</dt>
                <dd><a href="https://heycam.github.io/webidl/"><cite>Web IDL</cite></a>. Boris Zbarsky. W3C. 15 December
                    2016. W3C Editor's Draft. URL: <a
                        href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a></dd>
            </dl>
        </section>
    </section>
    <p role="navigation" id="back-to-top">
        <a href="#title"><abbr title="Back to Top">↑</abbr></a>
    </p>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-image-resource"
        aria-label="Links in this document to definition: image resource">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-image-resource"
                aria-label="Permalink for definition: image resource. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-image-resource-1" title="§ 2. Privacy and security considerations">§ 2. Privacy
                    and security considerations</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-resource-2" title="§ 3. Image resource">§ 3. Image resource</a> <a
                    href="#ref-for-dfn-image-resource-3" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-resource-4" title="§ 4.3 type member">§ 4.3 type member</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-resource-5" title="§ 5. Processing an ImageResource from an API">§ 5.
                    Processing an ImageResource from an API</a> <a href="#ref-for-dfn-image-resource-6"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-resource-7" title="§ 7. Fetching an image resource">§ 7. Fetching an image
                    resource</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-resource-8" title="§ 8. Deriving the accessible name">§ 8. Deriving the
                    accessible name</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-src"
        aria-label="Links in this document to definition: src">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-src"
                aria-label="Permalink for definition: src. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-src-1" title="§ 5. Processing an ImageResource from an API">§ 5. Processing an
                    ImageResource from an API</a>
            </li>
            <li>
                <a href="#ref-for-dfn-src-2" title="§ 7. Fetching an image resource">§ 7. Fetching an image resource</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-sizes"
        aria-label="Links in this document to definition: sizes">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-sizes"
                aria-label="Permalink for definition: sizes. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-sizes-1" title="§ 5. Processing an ImageResource from an API">§ 5. Processing an
                    ImageResource from an API</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-type"
        aria-label="Links in this document to definition: type">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-type"
                aria-label="Permalink for definition: type. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-type-1" title="§ 5. Processing an ImageResource from an API">§ 5. Processing an
                    ImageResource from an API</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-label"
        aria-label="Links in this document to definition: label">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-label"
                aria-label="Permalink for definition: label. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-label-1" title="§ 5. Processing an ImageResource from an API">§ 5. Processing an
                    ImageResource from an API</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-imageresource"
        aria-label="Links in this document to definition: ImageResource">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-imageresource"
                aria-label="Permalink for definition: ImageResource. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1355091221">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-imageresource-1" title="§ Abstract">§ Abstract</a> <a
                    href="#ref-for-dom-imageresource-2" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-3" title="§ 3. Image resource">§ 3. Image resource</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-4" title="§ 4. ImageResource dictionary">§ 4. ImageResource
                    dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-5" title="§ 4.1 src member">§ 4.1 src member</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-6" title="§ 4.2 sizes member">§ 4.2 sizes member</a> <a
                    href="#ref-for-dom-imageresource-7" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-8" title="§ 4.3 type member">§ 4.3 type member</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-9" title="§ 4.4 label member">§ 4.4 label member</a> <a
                    href="#ref-for-dom-imageresource-10" title="Reference 2">(2)</a> <a
                    href="#ref-for-dom-imageresource-11" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-12" title="§ 5. Processing an ImageResource from an API">§ 5.
                    Processing an ImageResource from an API</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-imageresource-src"
        aria-label="Links in this document to definition: src">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-imageresource-src"
                aria-label="Permalink for definition: src. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1355091221">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-imageresource-src-1" title="§ 4. ImageResource dictionary">§ 4. ImageResource
                    dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-src-2" title="§ 4.1 src member">§ 4.1 src member</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-src-3" title="§ 4.4 label member">§ 4.4 label member</a> <a
                    href="#ref-for-dom-imageresource-src-4" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-src-5" title="§ 5. Processing an ImageResource from an API">§ 5.
                    Processing an ImageResource from an API</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-imageresource-sizes"
        aria-label="Links in this document to definition: sizes">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-imageresource-sizes"
                aria-label="Permalink for definition: sizes. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1355091221">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-imageresource-sizes-1" title="§ 4. ImageResource dictionary">§ 4. ImageResource
                    dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-sizes-2" title="§ 4.2 sizes member">§ 4.2 sizes member</a> <a
                    href="#ref-for-dom-imageresource-sizes-3" title="Reference 2">(2)</a> <a
                    href="#ref-for-dom-imageresource-sizes-4" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-sizes-5" title="§ 5. Processing an ImageResource from an API">§ 5.
                    Processing an ImageResource from an API</a> <a href="#ref-for-dom-imageresource-sizes-6"
                    title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-imageresource-type"
        aria-label="Links in this document to definition: type">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-imageresource-type"
                aria-label="Permalink for definition: type. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1355091221">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-imageresource-type-1" title="§ 4. ImageResource dictionary">§ 4. ImageResource
                    dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-type-2" title="§ 4.3 type member">§ 4.3 type member</a> <a
                    href="#ref-for-dom-imageresource-type-3" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-type-4" title="§ 4.4 label member">§ 4.4 label member</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-type-5" title="§ 5. Processing an ImageResource from an API">§ 5.
                    Processing an ImageResource from an API</a> <a href="#ref-for-dom-imageresource-type-6"
                    title="Reference 2">(2)</a> <a href="#ref-for-dom-imageresource-type-7" title="Reference 3">(3)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-imageresource-label"
        aria-label="Links in this document to definition: label">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-imageresource-label"
                aria-label="Permalink for definition: label. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1355091221">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-imageresource-label-1" title="§ 4. ImageResource dictionary">§ 4. ImageResource
                    dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-imageresource-label-2" title="§ 4.4 label member">§ 4.4 label member</a> <a
                    href="#ref-for-dom-imageresource-label-3" title="Reference 2">(2)</a> <a
                    href="#ref-for-dom-imageresource-label-4" title="Reference 3">(3)</a> <a
                    href="#ref-for-dom-imageresource-label-5" title="Reference 4">(4)</a> <a
                    href="#ref-for-dom-imageresource-label-6" title="Reference 5">(5)</a> <a
                    href="#ref-for-dom-imageresource-label-7" title="Reference 6">(6)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-external-label"
        aria-label="Links in this document to definition: external label">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-external-label"
                aria-label="Permalink for definition: external label. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-external-label-1" title="§ 4.4 label member">§ 4.4 label member</a> <a
                    href="#ref-for-dfn-external-label-2" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-external-label-3" title="§ 8. Deriving the accessible name">§ 8. Deriving the
                    accessible name</a> <a href="#ref-for-dfn-external-label-4" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-process-an-imageresource-from-an-api"
        aria-label="Links in this document to definition: process an ImageResource from an API">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-process-an-imageresource-from-an-api"
                aria-label="Permalink for definition: process an ImageResource from an API. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-process-an-image-resource-from-json"
        aria-label="Links in this document to definition: process an image resource from JSON">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-process-an-image-resource-from-json"
                aria-label="Permalink for definition: process an image resource from JSON. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-fetching-an-image-resource"
        aria-label="Links in this document to definition: fetching an image resource">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-fetching-an-image-resource"
                aria-label="Permalink for definition: fetching an image resource. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-fetching-an-image-resource-1" title="§ 2. Privacy and security considerations">§
                    2. Privacy and security considerations</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-deriving-the-accessible-name"
        aria-label="Links in this document to definition: derive the accessible name">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-deriving-the-accessible-name"
                aria-label="Permalink for definition: derive the accessible name. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-deriving-the-accessible-name-1" title="§ 4.4 label member">§ 4.4 label member</a>
            </li>
            <li>
                <a href="#ref-for-dfn-deriving-the-accessible-name-2"
                    title="§ 5. Processing an ImageResource from an API">§ 5. Processing an ImageResource from an
                    API</a>
            </li>
            <li>
                <a href="#ref-for-dfn-deriving-the-accessible-name-3"
                    title="§ 6. Processing an image resource from JSON">§ 6. Processing an image resource from JSON</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-embedded-accessible-name"
        aria-label="Links in this document to definition: embedded accessible name">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-embedded-accessible-name"
                aria-label="Permalink for definition: embedded accessible name. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-embedded-accessible-name-1" title="§ 4.4 label member">§ 4.4 label member</a> <a
                    href="#ref-for-dfn-embedded-accessible-name-2" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-embedded-accessible-name-3" title="§ 8. Deriving the accessible name">§ 8.
                    Deriving the accessible name</a> <a href="#ref-for-dfn-embedded-accessible-name-4"
                    title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <script id="respec-dfn-panel">(() => {
            // @ts-check
            if (document.respec) {
                document.respec.ready.then(setupPanel);
            } else {
                setupPanel();
            }

            function setupPanel() {
                const listener = panelListener();
                document.body.addEventListener("keydown", listener);
                document.body.addEventListener("click", listener);
            }

            function panelListener() {
                /** @type {HTMLElement} */
                let panel = null;
                return event => {
                    const { target, type } = event;

                    if (!(target instanceof HTMLElement)) return;

                    // For keys, we only care about Enter key to activate the panel
                    // otherwise it's activated via a click.
                    if (type === "keydown" && event.key !== "Enter") return;

                    const action = deriveAction(event);

                    switch (action) {
                        case "show": {
                            hidePanel(panel);
                            /** @type {HTMLElement} */
                            const dfn = target.closest("dfn, .index-term");
                            panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
                            const coords = deriveCoordinates(event);
                            displayPanel(dfn, panel, coords);
                            break;
                        }
                        case "dock": {
                            panel.style.left = null;
                            panel.style.top = null;
                            panel.classList.add("docked");
                            break;
                        }
                        case "hide": {
                            hidePanel(panel);
                            panel = null;
                            break;
                        }
                    }
                };
            }

            /**
             * @param {MouseEvent|KeyboardEvent} event
             */
            function deriveCoordinates(event) {
                const target = /** @type HTMLElement */ (event.target);

                // We prevent synthetic AT clicks from putting
                // the dialog in a weird place. The AT events sometimes
                // lack coordinates, so they have clientX/Y = 0
                const rect = target.getBoundingClientRect();
                if (
                    event instanceof MouseEvent &&
                    event.clientX >= rect.left &&
                    event.clientY >= rect.top
                ) {
                    // The event probably happened inside the bounding rect...
                    return { x: event.clientX, y: event.clientY };
                }

                // Offset to the middle of the element
                const x = rect.x + rect.width / 2;
                // Placed at the bottom of the element
                const y = rect.y + rect.height;
                return { x, y };
            }

            /**
             * @param {Event} event
             */
            function deriveAction(event) {
                const target = /** @type {HTMLElement} */ (event.target);
                const hitALink = !!target.closest("a");
                if (target.closest("dfn:not([data-cite]), .index-term")) {
                    return hitALink ? "none" : "show";
                }
                if (target.closest(".dfn-panel")) {
                    if (hitALink) {
                        return target.classList.contains("self-link") ? "hide" : "dock";
                    }
                    const panel = target.closest(".dfn-panel");
                    return panel.classList.contains("docked") ? "hide" : "none";
                }
                if (document.querySelector(".dfn-panel:not([hidden])")) {
                    return "hide";
                }
                return "none";
            }

            /**
             * @param {HTMLElement} dfn
             * @param {HTMLElement} panel
             * @param {{ x: number, y: number }} clickPosition
             */
            function displayPanel(dfn, panel, { x, y }) {
                panel.hidden = false;
                // distance (px) between edge of panel and the pointing triangle (caret)
                const MARGIN = 20;

                const dfnRects = dfn.getClientRects();
                // Find the `top` offset when the `dfn` can be spread across multiple lines
                let closestTop = 0;
                let minDiff = Infinity;
                for (const rect of dfnRects) {
                    const { top, bottom } = rect;
                    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
                    if (diffFromClickY < minDiff) {
                        minDiff = diffFromClickY;
                        closestTop = top;
                    }
                }

                const top = window.scrollY + closestTop + dfnRects[0].height;
                const left = x - MARGIN;
                panel.style.left = `${left}px`;
                panel.style.top = `${top}px`;

                // Find if the panel is flowing out of the window
                const panelRect = panel.getBoundingClientRect();
                const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
                if (panelRect.right > SCREEN_WIDTH) {
                    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
                    const newCaretOffset = left - newLeft;
                    panel.style.left = `${newLeft}px`;
                    /** @type {HTMLElement} */
                    const caret = panel.querySelector(".caret");
                    caret.style.left = `${newCaretOffset}px`;
                }

                // As it's a dialog, we trap focus.
                // TODO: when <dialog> becomes a implemented, we should really
                // use that.
                trapFocus(panel, dfn);
            }

            /**
             * @param {HTMLElement} panel
             * @param {HTMLElement} dfn
             * @returns
             */
            function trapFocus(panel, dfn) {
                /** @type NodeListOf<HTMLAnchorElement> elements */
                const anchors = panel.querySelectorAll("a[href]");
                // No need to trap focus
                if (!anchors.length) return;

                // Move focus to first anchor element
                const first = anchors.item(0);
                first.focus();

                const trapListener = createTrapListener(anchors, panel, dfn);
                panel.addEventListener("keydown", trapListener);

                // Hiding the panel releases the trap
                const mo = new MutationObserver(records => {
                    const [record] = records;
                    const target = /** @type HTMLElement */ (record.target);
                    if (target.hidden) {
                        panel.removeEventListener("keydown", trapListener);
                        mo.disconnect();
                    }
                });
                mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
            }

            /**
             *
             * @param {NodeListOf<HTMLAnchorElement>} anchors
             * @param {HTMLElement} panel
             * @param {HTMLElement} dfn
             * @returns
             */
            function createTrapListener(anchors, panel, dfn) {
                const lastIndex = anchors.length - 1;
                let currentIndex = 0;
                return event => {
                    switch (event.key) {
                        // Hitting "Tab" traps us in a nice loop around elements.
                        case "Tab": {
                            event.preventDefault();
                            currentIndex += event.shiftKey ? -1 : +1;
                            if (currentIndex < 0) {
                                currentIndex = lastIndex;
                            } else if (currentIndex > lastIndex) {
                                currentIndex = 0;
                            }
                            anchors.item(currentIndex).focus();
                            break;
                        }

                        // Hitting "Enter" on an anchor releases the trap.
                        case "Enter":
                            hidePanel(panel);
                            break;

                        // Hitting "Escape" returns focus to dfn.
                        case "Escape":
                            hidePanel(panel);
                            dfn.focus();
                            return;
                    }
                };
            }

            /** @param {HTMLElement} panel */
            function hidePanel(panel) {
                if (!panel) return;
                panel.hidden = true;
                panel.classList.remove("docked");
            }
        })()</script>
    <script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
</body>

</html>