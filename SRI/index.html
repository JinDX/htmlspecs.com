<!DOCTYPE html>
<html lang="zh-hans" dir="ltr" typeof="bibo:Document w3p:REC"
    prefix="bibo: http://purl.org/ontology/bibo/ w3p: http://www.w3.org/2001/02pd/rec54#">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <meta property="dc:language" content="en" lang="">
    <style>
        /*

github.com style (c) Vasily Polovnyov <vast@whiteants.net>

*/

        .hljs {
            display: block;
            overflow-x: auto;
            padding: 0.5em;
            color: #333;
            background: #f8f8f8;
            -webkit-text-size-adjust: none;
        }

        .hljs-comment,
        .diff .hljs-header {
            color: #998;
            font-style: italic;
        }

        .hljs-keyword,
        .css .rule .hljs-keyword,
        .hljs-winutils,
        .nginx .hljs-title,
        .hljs-subst,
        .hljs-request,
        .hljs-status {
            color: #333;
            font-weight: bold;
        }

        .hljs-number,
        .hljs-hexcolor,
        .ruby .hljs-constant {
            color: #008080;
        }

        .hljs-string,
        .hljs-tag .hljs-value,
        .hljs-doctag,
        .tex .hljs-formula {
            color: #d14;
        }

        .hljs-title,
        .hljs-id,
        .scss .hljs-preprocessor {
            color: #900;
            font-weight: bold;
        }

        .hljs-list .hljs-keyword,
        .hljs-subst {
            font-weight: normal;
        }

        .hljs-class .hljs-title,
        .hljs-type,
        .vhdl .hljs-literal,
        .tex .hljs-command {
            color: #458;
            font-weight: bold;
        }

        .hljs-tag,
        .hljs-tag .hljs-title,
        .hljs-rule .hljs-property,
        .django .hljs-tag .hljs-keyword {
            color: #000080;
            font-weight: normal;
        }

        .hljs-attribute,
        .hljs-variable,
        .lisp .hljs-body,
        .hljs-name {
            color: #008080;
        }

        .hljs-regexp {
            color: #009926;
        }

        .hljs-symbol,
        .ruby .hljs-symbol .hljs-string,
        .lisp .hljs-keyword,
        .clojure .hljs-keyword,
        .scheme .hljs-keyword,
        .tex .hljs-special,
        .hljs-prompt {
            color: #990073;
        }

        .hljs-built_in {
            color: #0086b3;
        }

        .hljs-preprocessor,
        .hljs-pragma,
        .hljs-pi,
        .hljs-doctype,
        .hljs-shebang,
        .hljs-cdata {
            color: #999;
            font-weight: bold;
        }

        .hljs-deletion {
            background: #fdd;
        }

        .hljs-addition {
            background: #dfd;
        }

        .diff .hljs-change {
            background: #0086b3;
        }

        .hljs-chunk {
            color: #aaa;
        }
    </style>
    <style id="respec-mainstyle">
        /*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/
        /* Override code highlighter background */

        .hljs {
            background: transparent !important;
        }

        /* --- INLINES --- */

        em.rfc2119 {
            text-transform: lowercase;
            font-variant: small-caps;
            font-style: normal;
            color: #900;
        }

        h1 acronym,
        h2 acronym,
        h3 acronym,
        h4 acronym,
        h5 acronym,
        h6 acronym,
        a acronym,
        h1 abbr,
        h2 abbr,
        h3 abbr,
        h4 abbr,
        h5 abbr,
        h6 abbr,
        a abbr {
            border: none;
        }

        dfn {
            font-weight: bold;
        }

        a.internalDFN {
            color: inherit;
            border-bottom: 1px solid #99c;
            text-decoration: none;
        }

        a.externalDFN {
            color: inherit;
            border-bottom: 1px dotted #ccc;
            text-decoration: none;
        }

        a.bibref {
            text-decoration: none;
        }

        cite .bibref {
            font-style: normal;
        }

        code {
            color: #C83500;
        }

        /* --- TOC --- */

        .toc a,
        .tof a {
            text-decoration: none;
        }

        a .secno,
        a .figno {
            color: #000;
        }

        ul.tof,
        ol.tof {
            list-style: none outside none;
        }

        .caption {
            margin-top: 0.5em;
            font-style: italic;
        }

        /* --- TABLE --- */

        table.simple {
            border-spacing: 0;
            border-collapse: collapse;
            border-bottom: 3px solid #005a9c;
        }

        .simple th {
            background: #005a9c;
            color: #fff;
            padding: 3px 5px;
            text-align: left;
        }

        .simple th[scope="row"] {
            background: inherit;
            color: inherit;
            border-top: 1px solid #ddd;
        }

        .simple td {
            padding: 3px 10px;
            border-top: 1px solid #ddd;
        }

        .simple tr:nth-child(even) {
            background: #f0f6ff;
        }

        /* --- DL --- */

        .section dd>p:first-child {
            margin-top: 0;
        }

        .section dd>p:last-child {
            margin-bottom: 0;
        }

        .section dd {
            margin-bottom: 1em;
        }

        .section dl.attrs dd,
        .section dl.eldef dd {
            margin-bottom: 0;
        }

        .respec-hidden {
            display: none;
        }

        @media print {
            .removeOnSave {
                display: none;
            }
        }
    </style>
    <title>子资源完整性</title>


    <style>
        /* --- EXAMPLES --- */

        div.example-title {
            min-width: 7.5em;
            color: #b9ab2d;
        }

        div.example-title span {
            text-transform: uppercase;
        }

        aside.example,
        div.example,
        div.illegal-example {
            padding: 0.5em;
            margin: 1em 0;
            position: relative;
            clear: both;
        }

        div.illegal-example {
            color: red
        }

        div.illegal-example p {
            color: black
        }

        aside.example,
        div.example {
            padding: .5em;
            border-left-width: .5em;
            border-left-style: solid;
            border-color: #e0cb52;
            background: #fcfaee;
        }

        aside.example div.example {
            border-left-width: .1em;
            border-color: #999;
            background: #fff;
        }

        aside.example div.example div.example-title {
            color: #999;
        }
    </style>
    <style>
        /* --- ISSUES/NOTES --- */

        div.issue-title,
        div.note-title,
        div.ednote-title,
        div.warning-title {
            padding-right: 1em;
            min-width: 7.5em;
            color: #b9ab2d;
        }

        div.issue-title {
            color: #e05252;
        }

        div.note-title,
        div.ednote-title {
            color: #2b2;
        }

        div.warning-title {
            color: #f22;
        }

        div.issue-title span,
        div.note-title span,
        div.ednote-title span,
        div.warning-title span {
            text-transform: uppercase;
        }

        div.note,
        div.issue,
        div.ednote,
        div.warning {
            margin-top: 1em;
            margin-bottom: 1em;
        }

        .note>p:first-child,
        .ednote>p:first-child,
        .issue>p:first-child,
        .warning>p:first-child {
            margin-top: 0
        }

        .issue,
        .note,
        .ednote,
        .warning {
            padding: .5em;
            border-left-width: .5em;
            border-left-style: solid;
        }

        div.issue,
        div.note,
        div.ednote,
        div.warning {
            padding: 1em 1.2em 0.5em;
            margin: 1em 0;
            position: relative;
            clear: both;
        }

        span.note,
        span.ednote,
        span.issue,
        span.warning {
            padding: .1em .5em .15em;
        }

        .issue {
            border-color: #e05252;
            background: #fbe9e9;
        }

        .note,
        .ednote {
            border-color: #52e052;
            background: #e9fbe9;
        }

        .warning {
            border-color: #f11;
            border-width: .2em;
            border-style: solid;
            background: #fbe9e9;
        }

        .warning-title:before {
            content: "⚠";
            /*U+26A0 WARNING SIGN*/
            font-size: 3em;
            float: left;
            height: 100%;
            padding-right: .3em;
            vertical-align: top;
            margin-top: -0.5em;
        }

        li.task-list-item {
            list-style: none;
        }

        input.task-list-item-checkbox {
            margin: 0 0.35em 0.25em -1.6em;
            vertical-align: middle;
        }
    </style>
    <style>
        /* --- WEB IDL --- */

        pre.idl {
            border-top: 1px solid #90b8de;
            border-bottom: 1px solid #90b8de;
            padding: 1em;
            line-height: 120%;
        }

        @media print {
            pre.idl {
                white-space: pre-wrap;
            }
        }

        pre.idl::before {
            content: "WebIDL";
            display: block;
            width: 150px;
            background: #90b8de;
            color: #fff;
            font-family: sans-serif;
            padding: 3px;
            font-weight: bold;
            margin: -1em 0 1em -1em;
        }

        .idlType {
            color: #ff4500;
            font-weight: bold;
            text-decoration: none;
        }

        /*.idlModule*/
        /*.idlModuleID*/
        /*.idlInterface*/

        .idlInterfaceID,
        .idlDictionaryID,
        .idlCallbackID,
        .idlEnumID {
            font-weight: bold;
            color: #005a9c;
        }

        a.idlEnumItem {
            color: #000;
            border-bottom: 1px dotted #ccc;
            text-decoration: none;
        }

        .idlSuperclass {
            font-style: italic;
            color: #005a9c;
        }

        /*.idlAttribute*/

        .idlAttrType,
        .idlFieldType,
        .idlMemberType {
            color: #005a9c;
        }

        .idlAttrName,
        .idlFieldName,
        .idlMemberName {
            color: #ff4500;
        }

        .idlAttrName a,
        .idlFieldName a,
        .idlMemberName a {
            color: #ff4500;
            border-bottom: 1px dotted #ff4500;
            text-decoration: none;
        }

        /*.idlMethod*/

        .idlMethType,
        .idlCallbackType {
            color: #005a9c;
        }

        .idlMethName {
            color: #ff4500;
        }

        .idlMethName a {
            color: #ff4500;
            border-bottom: 1px dotted #ff4500;
            text-decoration: none;
        }

        /*.idlCtor*/

        .idlCtorName {
            color: #ff4500;
        }

        .idlCtorName a {
            color: #ff4500;
            border-bottom: 1px dotted #ff4500;
            text-decoration: none;
        }

        /*.idlParam*/

        .idlParamType {
            color: #005a9c;
        }

        .idlParamName,
        .idlDefaultValue {
            font-style: italic;
        }

        .extAttr {
            color: #666;
        }

        /*.idlSectionComment*/

        .idlSectionComment {
            color: gray;
        }

        /*.idlIterable*/

        .idlIterableKeyType,
        .idlIterableValueType {
            color: #005a9c;
        }

        /*.idlMaplike*/

        .idlMaplikeKeyType,
        .idlMaplikeValueType {
            color: #005a9c;
        }

        /*.idlConst*/

        .idlConstType {
            color: #005a9c;
        }

        .idlConstName {
            color: #ff4500;
        }

        .idlConstName a {
            color: #ff4500;
            border-bottom: 1px dotted #ff4500;
            text-decoration: none;
        }

        /*.idlException*/

        .idlExceptionID {
            font-weight: bold;
            color: #c00;
        }

        .idlTypedefID,
        .idlTypedefType {
            color: #005a9c;
        }

        .idlRaises,
        .idlRaises a.idlType,
        .idlRaises a.idlType code,
        .excName a,
        .excName a code {
            color: #c00;
            font-weight: normal;
        }

        .excName a {
            font-family: monospace;
        }

        .idlRaises a.idlType,
        .excName a.idlType {
            border-bottom: 1px dotted #c00;
        }

        .excGetSetTrue,
        .excGetSetFalse,
        .prmNullTrue,
        .prmNullFalse,
        .prmOptTrue,
        .prmOptFalse {
            width: 45px;
            text-align: center;
        }

        .excGetSetTrue,
        .prmNullTrue,
        .prmOptTrue {
            color: #0c0;
        }

        .excGetSetFalse,
        .prmNullFalse,
        .prmOptFalse {
            color: #c00;
        }

        .idlImplements a {
            font-weight: bold;
        }

        dl.attributes,
        dl.methods,
        dl.constants,
        dl.constructors,
        dl.fields,
        dl.dictionary-members {
            margin-left: 2em;
        }

        .attributes dt,
        .methods dt,
        .constants dt,
        .constructors dt,
        .fields dt,
        .dictionary-members dt {
            font-weight: normal;
        }

        .attributes dt code,
        .methods dt code,
        .constants dt code,
        .constructors dt code,
        .fields dt code,
        .dictionary-members dt code {
            font-weight: bold;
            color: #000;
            font-family: monospace;
        }

        .attributes dt code,
        .fields dt code,
        .dictionary-members dt code {
            background: #ffffd2;
        }

        .attributes dt .idlAttrType code,
        .fields dt .idlFieldType code,
        .dictionary-members dt .idlMemberType code {
            color: #005a9c;
            background: transparent;
            font-family: inherit;
            font-weight: normal;
            font-style: italic;
        }

        .methods dt code {
            background: #d9e6f8;
        }

        .constants dt code {
            background: #ddffd2;
        }

        .constructors dt code {
            background: #cfc;
        }

        .attributes dd,
        .methods dd,
        .constants dd,
        .constructors dd,
        .fields dd,
        .dictionary-members dd {
            margin-bottom: 1em;
        }

        table.parameters,
        table.exceptions {
            border-spacing: 0;
            border-collapse: collapse;
            margin: 0.5em 0;
            width: 100%;
        }

        table.parameters {
            border-bottom: 1px solid #90b8de;
        }

        table.exceptions {
            border-bottom: 1px solid #deb890;
        }

        .parameters th,
        .exceptions th {
            color: #fff;
            padding: 3px 5px;
            text-align: left;
            font-weight: normal;
            text-shadow: #666 1px 1px 0;
        }

        .parameters th {
            background: #90b8de;
        }

        .exceptions th {
            background: #deb890;
        }

        .parameters td,
        .exceptions td {
            padding: 3px 10px;
            border-top: 1px solid #ddd;
            vertical-align: top;
        }

        .parameters tr:first-child td,
        .exceptions tr:first-child td {
            border-top: none;
        }

        .parameters td.prmName,
        .exceptions td.excName,
        .exceptions td.excCodeName {
            width: 100px;
        }

        .parameters td.prmType {
            width: 120px;
        }

        table.exceptions table {
            border-spacing: 0;
            border-collapse: collapse;
            width: 100%;
        }
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-REC" rel="stylesheet">
    <!--[if lt IE 9]><script src='https://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]-->
    <script type="application/json" id="initialUserConfig">
    {
      "specStatus": "REC",
      "shortName": "SRI",
      "copyrightStart": "2014",
      "edDraftURI": "https://w3c.github.io/webappsec-subresource-integrity/",
      "crEnd": "2015-12-15",
      "previousMaturity": "PR",
      "previousPublishDate": "2016-05-10",
      "implementationReportURI": "https://github.com/w3c/webappsec-subresource-integrity/wiki/Links",
      "editors": [
      {
        "name": "Devdatta Akhawe",
        "url": "http://devd.me",
        "mailto": "dev.akhawe@gmail.com",
        "company": "Dropbox, Inc.",
        "companyURL": "https://www.dropbox.com/"
      },
      {
        "name": "Frederik Braun",
        "url": "https://frederik-braun.com/",
        "mailto": "fbraun@mozilla.com",
        "company": "Mozilla",
        "companyURL": "https://www.mozilla.org/",
        "w3cid": 68466
      },
      {
        "name": "François Marier",
        "url": "https://fmarier.org",
        "mailto": "francois@mozilla.com",
        "company": "Mozilla",
        "companyURL": "https://www.mozilla.org/"
      },
      {
        "name": "Joel Weinberger",
        "url": "https://joelweinberger.us/",
        "mailto": "jww@google.com",
        "company": "Google, Inc.",
        "companyURL": "https://google.com/"
      }],
      "otherLinks": [
      {
        "key": "Participate",
        "data": [
        {
          "value": "We are on Github.",
          "href": "https://github.com/w3c/webappsec-subresource-integrity"
        },
        {
          "value": "File a bug.",
          "href": "https://github.com/w3c/webappsec-subresource-integrity/issues"
        },
        {
          "value": "Commit history.",
          "href": "https://github.com/w3c/webappsec-subresource-integrity/commits/gh-pages"
        },
        {
          "value": "Mailing list.",
          "href": "https://lists.w3.org/Archives/Public/public-webappsec/"
        }]
      },
      {
        "key": "Implementation status",
        "data": [
        {
          "value": "Blink/Chromium",
          "href": "https://code.google.com/p/chromium/issues/detail?id=355467"
        },
        {
          "value": "Gecko",
          "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=992096"
        }]
      }],
      "wg": "Web Application Security Working Group",
      "wgURI": "http://www.w3.org/2011/webappsec/",
      "wgPublicList": "public-webappsec",
      "subjectPrefix": "[SRI]",
      "wgPatentURI": "http://www.w3.org/2004/01/pp-impl/49309/status",
      "localBiblio":
      {
        "CSP":
        {
          "title": "Content Security Policy 1.1",
          "href": "http://w3.org/TR/CSP11",
          "authors": [
            "Adam Barth",
            "Dan Veditz",
            "Mike West"
          ],
          "status": "Working Draft",
          "publisher": "W3C"
        },
        "MIMETYPE":
        {
          "title": "Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types",
          "href": "https://tools.ietf.org/html/rfc2046",
          "authors": [
            "Ned Freed",
            "Nathaniel S. Borenstein"
          ],
          "status": "Draft Standard",
          "publisher": "IETF"
        },
        "RFC4648":
        {
          "title": "The Base16, Base32, and Base64 Data Encodings",
          "href": "https://tools.ietf.org/html/rfc4648",
          "authors": [
            "Simon Josefsson"
          ],
          "status": "Proposed Standard",
          "publisher": "IETF"
        },
        "RFC6920":
        {
          "title": "Naming Things with Hashes",
          "href": "http://tools.ietf.org/html/rfc6920",
          "authors": [
            "Stephen Farrell",
            "Dirk Kutscher",
            "Christian Dannewitz",
            "Borje Ohlman",
            "Ari Keranen",
            "Phillip Hallam-Baker"
          ],
          "status": "Proposed Standard",
          "publisher": "IETF"
        }
      }
    }
  </script>
</head>

<body id="respecDocument" class="h-entry">
    <div id="respecHeader" role="contentinfo" class="head">
        <p>
            <a class="logo" href="https://www.w3.org/"><img src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C"
                    alt="W3C" height="48" width="72"></a>
        </p>
        <h1 class="title p-name" id="title" property="dcterms:title">子资源完整性</h1>
        <h2 id="w3c-recommendation-15-june-2016"><abbr title="World Wide Web Consortium">W3C</abbr> 推荐 <time
                property="dcterms:issued" class="dt-published" datetime="2016-06-23">2016年6月23日</time></h2>
        <dl>
            <dt>此版本：</dt>
            <dd><a class="u-url"
                    href="https://www.w3.org/TR/2016/REC-SRI-20160623/">http://www.w3.org/TR/2016/REC-SRI-20160623/</a>
            </dd>
            <dt>最新发布版本：</dt>
            <dd><a href="https://www.w3.org/TR/SRI/">http://www.w3.org/TR/SRI/</a></dd>
            <dt>最新编辑草案：</dt>
            <dd><a
                    href="https://w3c.github.io/webappsec-subresource-integrity/">https://w3c.github.io/webappsec-subresource-integrity/</a>
            </dd>
            <dt>实施报告：</dt>
            <dd><a
                    href="https://github.com/w3c/webappsec-subresource-integrity/wiki/Links">https://github.com/w3c/webappsec-subresource-integrity/wiki/Links</a>
            </dd>
            <dt>以前版本：</dt>
            <dd><a rel="dcterms:replaces"
                    href="https://www.w3.org/TR/2016/PR-SRI-20160510/">http://www.w3.org/TR/2016/PR-SRI-20160510/</a>
            </dd>
            <dt>编辑者：</dt>
            <dd class="p-author h-card vcard" property="bibo:editor" resource="_:editor0"><span property="rdf:first"
                    typeof="foaf:Person">
                    <meta property="foaf:name" content="Devdatta Akhawe"><a class="u-url url p-name fn"
                        property="foaf:homepage" href="http://devd.me">Devdatta Akhawe</a>, <a
                        property="foaf:workplaceHomepage" class="p-org org h-org h-card"
                        href="https://www.dropbox.com/">Dropbox, Inc.</a>, <span class="ed_mailto"><a
                            class="u-email email" property="foaf:mbox"
                            href="mailto:dev.akhawe@gmail.com">dev.akhawe@gmail.com</a></span>
                </span>
                <span property="rdf:rest" resource="_:editor1"></span>
            </dd>
            <dd class="p-author h-card vcard" resource="_:editor1" data-editor-id="68466"><span property="rdf:first"
                    typeof="foaf:Person">
                    <meta property="foaf:name" content="Frederik Braun"><a class="u-url url p-name fn"
                        property="foaf:homepage" href="https://frederik-braun.com/">Frederik Braun</a>, <a
                        property="foaf:workplaceHomepage" class="p-org org h-org h-card"
                        href="https://www.mozilla.org/">Mozilla</a>, <span class="ed_mailto"><a class="u-email email"
                            property="foaf:mbox" href="mailto:fbraun@mozilla.com">fbraun@mozilla.com</a></span>
                </span>
                <span property="rdf:rest" resource="_:editor2"></span>
            </dd>
            <dd class="p-author h-card vcard" resource="_:editor2" data-editor-id="68466"><span property="rdf:first"
                    typeof="foaf:Person">
                    <meta property="foaf:name" content="François Marier"><a class="u-url url p-name fn"
                        property="foaf:homepage" href="https://fmarier.org">François Marier</a>, <a
                        property="foaf:workplaceHomepage" class="p-org org h-org h-card"
                        href="https://www.mozilla.org/">Mozilla</a>, <span class="ed_mailto"><a class="u-email email"
                            property="foaf:mbox" href="mailto:francois@mozilla.com">francois@mozilla.com</a></span>
                </span>
                <span property="rdf:rest" resource="_:editor3"></span>
            </dd>
            <dd class="p-author h-card vcard" resource="_:editor3" data-editor-id="68466"><span property="rdf:first"
                    typeof="foaf:Person">
                    <meta property="foaf:name" content="Joel Weinberger"><a class="u-url url p-name fn"
                        property="foaf:homepage" href="https://joelweinberger.us/">Joel Weinberger</a>, <a
                        property="foaf:workplaceHomepage" class="p-org org h-org h-card"
                        href="https://google.com/">Google, Inc.</a>, <span class="ed_mailto"><a class="u-email email"
                            property="foaf:mbox" href="mailto:jww@google.com">jww@google.com</a></span>
                </span>
                <span property="rdf:rest" resource="rdf:nil"></span>
            </dd>

            <dt>参与：</dt>
            <dd>
                <a href="https://github.com/w3c/webappsec-subresource-integrity">
                    我们在Github上。
                </a>
            </dd>
            <dd>
                <a href="https://github.com/w3c/webappsec-subresource-integrity/issues">
                    提交问题。
                </a>
            </dd>
            <dd>
                <a href="https://github.com/w3c/webappsec-subresource-integrity/commits/gh-pages">
                    提交历史。
                </a>
            </dd>
            <dd>
                <a href="https://lists.w3.org/Archives/Public/public-webappsec/">
                    邮件列表。
                </a>
            </dd>
        </dl>
        <p>请注意，此文档可能有<a href="https://www.w3.org/2016/SRI-errata.html">勘误表</a>。</p>

        <p>
            此规范的英文版本是唯一规范版本。非规范性的<a href="https://www.w3.org/Consortium/Translation/">翻译版本</a>也可能有。
        </p>
        <p class="copyright">
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">版权</a> © 2014-2016

            <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a
                href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">麻省理工学院</abbr></a>，
            <a href="http://www.ercim.eu/"><abbr title="欧洲信息与数学研究联盟">ERCIM</abbr></a>，
            <a href="http://www.keio.ac.jp/">庆应大学</a>， <a href="http://ev.buaa.edu.cn/">北航</a>）。
            <abbr title="World Wide Web Consortium">W3C</abbr> <a
                href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">责任声明</a>，
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">商标</a>及
            <a rel="license" href="https://www.w3.org/Consortium/Legal/copyright-documents">文档使用</a>规则适用。
        </p>
        <hr title="标题分隔线">
    </div>

    <section property="dc:abstract" class="introductory" id="abstract">
        <h2 resource="#h-abstract" id="h-abstract"><span property="xhv:role" resource="xhv:heading">摘要</span></h2>
        <p>本规范定义了一种机制，用户代理可通过该机制验证获取的资源是否未经预期的操纵而传递。</p>
    </section>

    <section id="sotd" class="introductory">
        <h2 resource="#h-sotd" id="h-sotd"><span property="xhv:role" resource="xhv:heading">本文件的状态</span></h2>
        <p>
            <em>本节描述了本文件在发布时的状态。其他文件可能会取代本文件。可以在<a href="https://www.w3.org/TR/"><abbr
                        title="World Wide Web Consortium">W3C</abbr> 技术报告
                    索引</a>找到当前 <abbr title="World Wide Web Consortium">W3C</abbr> 的出版物和此技术报告的最新版本，网址为
                http://www.w3.org/TR/。</em>
        </p>

        <p>本文件的变更列表可在
            <a
                href="https://github.com/w3c/webappsec-subresource-integrity">https://github.com/w3c/webappsec-subresource-integrity</a>
            找到。
        </p>

        <p>
            本文件由<a href="https://www.w3.org/2011/webappsec/">Web 应用安全工作组</a>作为推荐发布。如果您希望对此文件发表意见，请将其发送至
            <a href="mailto:public-webappsec@w3.org?subject=%5BSRI%5D">public-webappsec@w3.org</a> (<a
                href="mailto:public-webappsec-request@w3.org?subject=subscribe">订阅</a>，
            <a
                href="http://lists.w3.org/Archives/Public/public-webappsec/">存档</a>)，并在电子邮件主题的开头使用<code>[SRI]</code>。欢迎所有意见。
        </p>
        <p>
            请参阅工作组的<a href="https://github.com/w3c/webappsec-subresource-integrity/wiki/Links">实施报告</a>。
        </p>
        <p>
            本文件已由 <abbr title="World Wide Web Consortium">W3C</abbr> 成员、软件开发者及其他 <abbr
                title="World Wide Web Consortium">W3C</abbr> 小组和相关方进行审核，并获得了总监的认可，作为 <abbr
                title="World Wide Web Consortium">W3C</abbr> 推荐。本文件是稳定的，可以用作参考资料或在其他文件中引用。<abbr
                title="World Wide Web Consortium">W3C</abbr> 制定推荐标准的作用是引起对该规范的关注，并推动其广泛部署。这增强了Web的功能性和互操作性。
        </p>
        <p>W3C 预计本推荐中规定的功能不会受到<a href="https://fetch.spec.whatwg.org/">Fetch</a> 的变更影响。工作组将继续跟踪Fetch规范并记录影响本规范的问题。</p>
        <p>
            本文件由依据<a id="sotd_patent" property="w3p:patentRules"
                href="https://www.w3.org/Consortium/Patent-Policy-20040205/">2004年2月5日 <abbr
                    title="World Wide Web Consortium">W3C</abbr> 专利政策</a> 运营的小组制作。
            <abbr title="World Wide Web Consortium">W3C</abbr> 维护了与该小组交付成果相关的<a
                href="https://www.w3.org/2004/01/pp-impl/49309/status"
                rel="disclosure">任何专利披露的公开列表</a>；该页面还包含披露专利的说明。任何个人如果确知某专利包含
            <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">必要声明</a>，必须根据<a
                href="https://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">W3C专利政策第6节</a>披露信息。
        </p>
        <p>本文件受<a id="w3c_process_revision" href="https://www.w3.org/2015/Process-20150901/">2015年9月1日 <abbr
                    title="World Wide Web Consortium">W3C</abbr> 流程文件</a>的管理。
        </p>

    </section>
    <nav id="toc">
        <h2 resource="#table-of-contents" id="table-of-contents" class="introductory"><span property="xhv:role"
                resource="xhv:heading">目录</span></h2>
        <ul role="directory" class="toc">
            <li class="tocline"><a class="tocxref" href="#introduction"><span class="secno">1. </span>介绍</a>
                <ul class="toc">
                    <li class="tocline"><a class="tocxref" href="#goals"><span class="secno">1.1 </span>目标</a></li>
                    <li class="tocline"><a class="tocxref" href="#use-casesexamples"><span class="secno">1.2
                            </span>用例/示例</a>
                        <ul class="toc">
                            <li class="tocline"><a class="tocxref" href="#resource-integrity"><span class="secno">1.2.1
                                    </span>资源完整性</a></li>
                        </ul>
                    </li>
                </ul>
            </li>
            <li class="tocline"><a class="tocxref" href="#conformance"><span class="secno">2. </span>一致性</a>
                <ul class="toc">
                    <li class="tocline"><a class="tocxref" href="#key-concepts-and-terminology"><span class="secno">2.1
                            </span>关键概念与术语</a></li>
                    <li class="tocline"><a class="tocxref" href="#grammatical-concepts"><span class="secno">2.2
                            </span>语法概念</a></li>
                </ul>
            </li>
            <li class="tocline"><a class="tocxref" href="#framework"><span class="secno">3. </span>框架</a>
                <ul class="toc">
                    <li class="tocline"><a class="tocxref" href="#integrity-metadata"><span class="secno">3.1
                            </span>完整性元数据</a></li>
                    <li class="tocline"><a class="tocxref" href="#cryptographic-hash-functions"><span class="secno">3.2
                            </span>加密哈希函数</a>
                        <ul class="toc">
                            <li class="tocline"><a class="tocxref" href="#agility"><span class="secno">3.2.1
                                    </span>灵活性</a></li>
                            <li class="tocline"><a class="tocxref" href="#priority"><span class="secno">3.2.2
                                    </span>优先级</a></li>
                        </ul>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#response-verification-algorithms"><span
                                class="secno">3.3 </span>响应验证算法</a>
                        <ul class="toc">
                            <li class="tocline"><a class="tocxref" href="#apply-algorithm-to-response"><span
                                        class="secno">3.3.1 </span>将<var>算法</var>应用于<var>响应</var></a>
                            </li>
                            <li class="tocline"><a class="tocxref"
                                    href="#is-response-eligible-for-integrity-validation"><span class="secno">3.3.2
                                    </span><var>响应</var>是否符合完整性验证</a></li>
                            <li class="tocline"><a class="tocxref" href="#parse-metadata"><span class="secno">3.3.3
                                    </span>解析<var>元数据</var></a></li>
                            <li class="tocline"><a class="tocxref" href="#get-the-strongest-metadata-from-set"><span
                                        class="secno">3.3.4 </span>从<var>集合</var>中获取最强的元数据</a>
                            </li>
                            <li class="tocline"><a class="tocxref" href="#does-response-match-metadatalist"><span
                                        class="secno">3.3.5 </span><var>响应</var>是否匹配<var>元数据列表</var>？</a></li>
                        </ul>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#verification-of-html-document-subresources"><span
                                class="secno">3.4 </span>验证HTML文档的子资源</a></li>
                    <li class="tocline"><a class="tocxref" href="#the-integrity-attribute"><span class="secno">3.5
                            </span><code>integrity</code>属性</a></li>
                    <li class="tocline"><a class="tocxref" href="#element-interface-extensions"><span class="secno">3.6
                            </span>元素接口扩展</a>
                        <ul class="toc">
                            <li class="tocline"><a class="tocxref" href="#htmllinkelement"><span class="secno">3.6.1
                                    </span>HTMLLinkElement</a>
                                <ul class="toc">
                                    <li class="tocline"><a class="tocxref" href="#attributes"><span
                                                class="secno">3.6.1.1 </span>属性</a></li>
                                </ul>
                            </li>
                            <li class="tocline"><a class="tocxref" href="#htmlscriptelement"><span class="secno">3.6.2
                                    </span>HTMLScriptElement</a>
                                <ul class="toc">
                                    <li class="tocline"><a class="tocxref" href="#attributes-1"><span
                                                class="secno">3.6.2.1 </span>属性</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#handling-integrity-violations"><span class="secno">3.7
                            </span>处理完整性违规</a></li>
                    <li class="tocline"><a class="tocxref" href="#elements"><span class="secno">3.8 </span>元素</a>
                        <ul class="toc">
                            <li class="tocline"><a class="tocxref" href="#the-link-element-for-stylesheets"><span
                                        class="secno">3.8.1 </span>样式表的<code>link</code>元素</a>
                            </li>
                            <li class="tocline"><a class="tocxref" href="#the-script-element"><span class="secno">3.8.2
                                    </span><code>script</code>元素</a></li>
                        </ul>
                    </li>
                </ul>
            </li>
            <li class="tocline"><a class="tocxref" href="#proxies"><span class="secno">4. </span>代理</a></li>
            <li class="tocline"><a class="tocxref" href="#security-considerations"><span class="secno">5.
                    </span>安全考虑</a>
                <ul class="toc">
                    <li class="tocline"><a class="tocxref" href="#non-secure-contexts-remain-non-secure"><span
                                class="secno">5.1 </span>非安全上下文仍然不安全</a></li>
                    <li class="tocline"><a class="tocxref" href="#hash-collision-attacks"><span class="secno">5.2
                            </span>哈希碰撞攻击</a></li>
                    <li class="tocline"><a class="tocxref" href="#cross-origin-data-leakage"><span class="secno">5.3
                            </span>跨源数据泄漏</a></li>
                </ul>
            </li>
            <li class="tocline"><a class="tocxref" href="#acknowledgements"><span class="secno">6.
                    </span>致谢</a></li>
            <li class="tocline"><a class="tocxref" href="#references"><span class="secno">A. </span>参考资料</a>
                <ul class="toc">
                    <li class="tocline"><a class="tocxref" href="#normative-references"><span class="secno">A.1
                            </span>规范性参考资料</a></li>
                </ul>
            </li>
        </ul>
    </nav>



    <section property="bibo:hasPart" resource="#introduction" typeof="bibo:Chapter" class="informative">
        <!--OddPage-->
        <h2 resource="#introduction" id="introduction"><span property="xhv:role" resource="xhv:heading"><span
                    class="secno">1. </span>介绍</span></h2>
        <p><em>本节是非规范性的。</em></p>

        <p>网络上的站点和应用很少仅由单一来源的资源组成。例如，作者从各种服务和内容交付网络（CDN）中提取脚本和样式，必须信任所交付的内容确实是他们预期加载的内容。如果攻击者通过<a
                href="https://www.ietf.org/rfc/rfc1035.txt">DNS</a>欺骗或其他手段，诱使用户从恶意服务器下载内容，作者将无能为力。同样，攻击者如果能替换CDN服务器上的文件，也可以注入任意内容。
        </p>

        <p>通过安全通道交付资源可以减轻这种风险：通过<a href="https://tools.ietf.org/html/rfc5246">TLS</a>、<a
                href="https://tools.ietf.org/html/rfc6797">HSTS</a>和<a
                href="https://tools.ietf.org/html/rfc7469">固定公钥</a>，用户代理可以相当确定它确实在与它认为的服务器通信。然而，这些机制仅验证了服务器，<em>不</em>验证内容。拥有服务器访问权限的攻击者（或管理员）可以随意操纵内容。理想情况下，作者不仅能够固定服务器的密钥，还能固定<em>内容</em>，确保只加载和执行特定资源的精确表示。
        </p>

        <p>本文档定义了这样一个验证方案，扩展了两个HTML元素，添加了一个包含作者期望加载的资源表示的加密哈希的<code>integrity</code>属性。例如，作者可能希望从共享服务器而不是自己的来源加载某个框架。指定<em>预期</em>的SHA-384哈希为<code>https://example.com/example-framework.js</code>是<code>Li9vy3DqF8tnTXuiaAJuML3ky+er10rcgNR/VqsVpcw+ThHmYcwiB1pbOxEbzJr7</code>，这意味着用户代理可以在执行JavaScript之前，验证从该URL加载的数据是否与该预期哈希匹配。这种完整性验证显著降低了攻击者替换恶意内容的风险。
        </p>

        <p>此示例可以通过在<code>script</code>元素中添加哈希传达给用户代理，如下所示：</p>

        <div class="example">
            <div class="example-title marker"><span>示例 1</span></div>
            <pre class="hljs xml"><code><span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"https://example.com/example-framework.js"</span>
        <span class="hljs-attribute">integrity</span>=<span class="hljs-value">"sha384-Li9vy3DqF8tnTXuiaAJuML3ky+er10rcgNR/VqsVpcw+ThHmYcwiB1pbOxEbzJr7"</span>
        <span class="hljs-attribute">crossorigin</span>=<span class="hljs-value">"anonymous"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
</code></pre>
        </div>

        <p>当然，脚本并不是唯一可以从完整性验证中受益的响应类型。此处指定的方案也适用于<code>link</code>，未来的版本可能会扩展到更多的类型。</p>

        <section property="bibo:hasPart" resource="#goals" typeof="bibo:Chapter">
            <h3 resource="#goals" id="goals"><span property="xhv:role" resource="xhv:heading"><span class="secno">1.1
                    </span>目标</span></h3>

            <ol>
                <li>
                    <p>第三方服务的妥协不应自动意味着每个包含其脚本的站点都受到威胁。内容作者将有机制指定他们加载的内容期望，例如，他们可以加载<em>特定</em>的脚本，而不是碰巧具有特定URL的<em>任何</em>脚本。
                    </p>
                </li>
                <li>
                    <p>验证机制应具有错误报告功能，通知作者接收到的响应无效。</p>
                </li>
            </ol>

        </section>
        <!-- /Introduction::Goals -->

        <section property="bibo:hasPart" resource="#use-casesexamples" typeof="bibo:Chapter">
            <h3 resource="#use-casesexamples" id="use-casesexamples"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">1.2 </span>用例/示例</span></h3>

            <section property="bibo:hasPart" resource="#resource-integrity" typeof="bibo:Chapter">
                <h4 resource="#resource-integrity" id="resource-integrity"><span property="xhv:role"
                        resource="xhv:heading"><span class="secno">1.2.1 </span>资源完整性</span></h4>

                <ul>
                    <li>
                        <p>作者希望使用内容交付网络（CDN）提高全球用户的性能。然而，确保CDN服务器只交付作者期望的代码非常重要。为了减轻CDN妥协（或意外的恶意行为）导致站点发生不利变化的风险，以下<a
                                href="#dfn-integrity-metadata">完整性元数据</a>被添加到页面的<code>link</code>元素中：</p>

                        <div class="example">
                            <div class="example-title marker"><span>示例 2</span></div>
                            <pre class="hljs xml"><code><span class="hljs-tag">&lt;<span class="hljs-title">link</span> <span class="hljs-attribute">rel</span>=<span class="hljs-value">"stylesheet"</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"https://site53.example.net/style.css"</span>
      <span class="hljs-attribute">integrity</span>=<span class="hljs-value">"sha384-+/M6kredJcxdsqkczBUjMLvqyHb1K/JThDXWsBVxMEeZHEaMKEOEct339VItX1zB"</span>
      <span class="hljs-attribute">crossorigin</span>=<span class="hljs-value">"anonymous"</span>&gt;</span>
</code></pre>
                        </div>
                    </li>
                    <li>
                        <p>作者希望包含第三方分析服务提供的JavaScript。为了确保只有经过仔细审核的代码被执行，作者为脚本生成了<a
                                href="#dfn-integrity-metadata">完整性元数据</a>，并将其添加到<code>script</code>元素中：</p>

                        <div class="example">
                            <div class="example-title marker"><span>示例 3</span></div>
                            <pre class="hljs xml"><code><span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"https://analytics-r-us.example.com/v1.0/include.js"</span>
        <span class="hljs-attribute">integrity</span>=<span class="hljs-value">"sha384-MBO5IDfYaE6c6Aao94oZrIOiC6CGiSN2n4QUbHNPhzk5Xhm0djZLQqTpL0HzTUxk"</span>
        <span class="hljs-attribute">crossorigin</span>=<span class="hljs-value">"anonymous"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
</code></pre>
                        </div>
                    </li>
                    <li>
                        <p>用户代理希望确保在高权限HTML上下文（例如，浏览器的新标签页）中运行的JavaScript代码在显示之前未被篡改。<a
                                href="#dfn-integrity-metadata">完整性元数据</a>减轻了在这些页面的高权限上下文中运行被修改的JavaScript的风险。</p>
                    </li>
                </ul>
            </section>
            <!-- Introduction::UseCases::Integrity -->
        </section>
        <!-- /Introduction::Use Cases -->
    </section>

    <section property="bibo:hasPart" resource="#conformance" typeof="bibo:Chapter" id="conformance">
        <!--OddPage-->
        <h2 resource="#h-conformance" id="h-conformance"><span property="xhv:role" resource="xhv:heading"><span
                    class="secno">2. </span>一致性</span></h2>
        <p>
            除了标记为非规范的章节外，本规范中的所有编写指南、图表、示例和注释都是非规范性的。本规范中的其他内容均为规范性内容。
        </p>
        <p id="respecRFC2119">关键词 <em class="rfc2119" title="MAY">MAY</em>、<em class="rfc2119" title="MUST">MUST</em> 和
            <em class="rfc2119" title="SHOULD">SHOULD</em> 按照 [<cite><a href="#bib-RFC2119"
                    class="bibref">RFC2119</a></cite>] 中的描述进行解释。
        </p>

        <p>以算法或特定步骤表达的一致性要求可以以任何方式实现，只要最终结果等效即可。特别是，本规范中定义的算法旨在便于理解，而不是为了性能。建议实现者进行优化。</p>

        <section property="bibo:hasPart" resource="#key-concepts-and-terminology" typeof="bibo:Chapter">
            <h3 resource="#key-concepts-and-terminology" id="key-concepts-and-terminology"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">2.1 </span>关键概念与术语</span></h3>

            <p>本节定义了文档中使用的几个术语。</p>

            <p>术语<dfn id="dfn-digest" data-dfn-type="dfn">摘要</dfn>指的是对任意数据块执行加密哈希函数后生成的base64编码结果。</p>

            <p>术语<dfn id="dfn-origin" data-dfn-type="dfn">源</dfn>在源规范中定义。[<cite><a href="#bib-RFC6454"
                        class="bibref">RFC6454</a></cite>]</p>

            <p><dfn id="dfn-representation-data" data-dfn-type="dfn">表示数据</dfn>和<dfn id="dfn-content-encoding"
                    data-dfn-type="dfn">内容编码</dfn>由<a
                    href="https://tools.ietf.org/html/rfc7231#section-3">RFC7231，第3节</a>定义。[<cite><a href="#bib-RFC7231"
                        class="bibref">RFC7231</a></cite>]</p>

            <p><dfn id="dfn-base64-encoding" data-dfn-type="dfn">Base64编码</dfn>定义在<a
                    href="https://tools.ietf.org/html/rfc4648#section-4">RFC 4648，第4节</a>中。[<cite><a href="#bib-RFC4648"
                        class="bibref">RFC4648</a></cite>]</p>

            <p><dfn id="dfn-sha-256" data-dfn-type="dfn">SHA-256</dfn>、<dfn id="dfn-sha-384"
                    data-dfn-type="dfn">SHA-384</dfn>和<dfn id="dfn-sha-512"
                    data-dfn-type="dfn">SHA-512</dfn>是由NIST定义的<dfn id="dfn-sha-2"
                    data-dfn-type="dfn">SHA-2</dfn>加密哈希函数集的一部分，参见<a
                    href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf">“FIPS PUB 180-4: Secure Hash
                    Standard (SHS)”</a>。</p>

        </section>

        <section property="bibo:hasPart" resource="#grammatical-concepts" typeof="bibo:Chapter">
            <h3 resource="#grammatical-concepts" id="grammatical-concepts"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">2.2 </span>语法概念</span></h3>

            <p>本文件中使用的增强型巴科斯-瑙尔形式（ABNF）符号在RFC5234中规定。[<cite><a href="#bib-ABNF" class="bibref">ABNF</a></cite>]</p>

            <p>[<cite><a href="#bib-ABNF" class="bibref">ABNF</a></cite>]的<a
                    href="https://tools.ietf.org/html/rfc5234#appendix-B.1">附录B.1</a>定义了<code><dfn id="dfn-vchar" data-dfn-type="dfn">VCHAR</dfn></code>（打印字符）。
            </p>

            <p><code><dfn id="dfn-wsp" data-dfn-type="dfn">WSP</dfn></code>（空白字符）在HTML 5规范的<a
                    href="https://www.w3.org/TR/html5/infrastructure.html#space-character">“2.4.1
                    公共解析器惯例”</a>中定义为<code>White_Space characters</code>。</p>

        </section>

    </section>

    <section property="bibo:hasPart" resource="#framework" typeof="bibo:Chapter">
        <!--OddPage-->
        <h2 resource="#framework" id="framework"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.
                </span>框架</span></h2>

        <p>此处指定的完整性验证机制归结为为资源生成足够强的加密摘要，并将该摘要传输给用户代理，以便其用于验证响应。</p>


        <section property="bibo:hasPart" resource="#integrity-metadata" typeof="bibo:Chapter">
            <h3 resource="#integrity-metadata" id="integrity-metadata"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">3.1 </span>完整性元数据</span></h3>

            <p>为了验证响应的完整性，用户代理需要<dfn id="dfn-integrity-metadata" data-dfn-type="dfn">完整性元数据</dfn>作为<a
                    href="https://fetch.spec.whatwg.org/#concept-request-integrity-metadata">请求</a>的一部分。此元数据包含以下信息：</p>

            <ul>
                <li>加密哈希函数（“alg”）</li>
                <li><a href="#dfn-digest">摘要</a>（“val”）</li>
                <li>选项（“opt”）</li>
            </ul>

            <p>必须提供哈希函数和摘要，才能验证响应的完整性。</p>

            <div class="note">
                <div id="h-note1" role="heading" aria-level="4" class="note-title marker"><span>注意</span></div>
                <p class="">目前尚未定义任何选项。然而，规范的未来版本可能会定义选项，例如MIME类型 [<cite><a href="#bib-MIMETYPE"
                            class="bibref">MIMETYPE</a></cite>]。</p>
            </div>

            <p>此元数据<em title="MUST" class="rfc2119">必须</em>按照<a
                    href="https://www.w3.org/TR/CSP2/#source-list-syntax">内容安全策略第2级规范第4.2节</a>中的<code>hash-source</code>（不带单引号）相同的格式进行编码。
            </p>

            <p>例如，给定一个仅包含字符串<code>alert(\'Hello, world.\');</code>的脚本资源，作者可能会选择<a href="#dfn-sha-2">SHA-384</a>作为哈希函数。
                结果的base64编码摘要为<code>H8BRh8j48O9oYatfu5AZzq6A9RINhZO5H16dQZngK7T62em8MUt1FLm52t+eX6xO</code>。可以如下编码：
            </p>

            <div class="example">
                <div class="example-title marker"><span>示例 4</span></div>
                <pre class="hljs gcode"><code>sha<span class="hljs-number">384</span>-H<span class="hljs-number">8</span>BRh<span class="hljs-number">8</span>j<span class="hljs-number">48</span><span class="hljs-preprocessor">O9</span>oYatfu<span class="hljs-number">5</span>AZzq<span class="hljs-number">6</span>A<span class="hljs-number">9</span>RI<span class="hljs-label">NhZO5</span>H<span class="hljs-number">16</span>dQZ<span class="hljs-label">ngK7</span>T<span class="hljs-number">62</span>e<span class="hljs-title">m8</span>MUt<span class="hljs-number">1</span>FL<span class="hljs-title">m52</span>t+eX<span class="hljs-number">6</span>xO
</code></pre>
            </div>

            <div class="note">
                <div id="h-note2" role="heading" aria-level="4" class="note-title marker"><span>注意</span></div>
                <div class="">
                    <p>可以使用许多工具生成摘要。例如，<a href="https://www.openssl.org/">OpenSSL</a>相当常见。本节中的示例是通过以下命令行生成的结果：</p>

                    <pre class="hljs gherkin"><code>echo -n <span class="hljs-string">"alert('Hello, world.');"</span> |<span class="hljs-string"> openssl dgst -sha384 -binary </span>|<span class="hljs-string"> openssl base64 -A
</span></code></pre>
                </div>
            </div>

        </section>
        <!-- /Framework::Required metadata -->

        <section property="bibo:hasPart" resource="#cryptographic-hash-functions" typeof="bibo:Chapter">
            <h3 resource="#cryptographic-hash-functions" id="cryptographic-hash-functions"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">3.2 </span>加密哈希函数</span></h3>

            <p>符合要求的用户代理<em title="MUST" class="rfc2119">必须</em>支持<a href="#dfn-sha-2">SHA-256</a>、<a
                    href="#dfn-sha-2">SHA-384</a>和<a href="#dfn-sha-2">SHA-512</a>加密哈希函数，用作请求的<a
                    href="#dfn-integrity-metadata">完整性元数据</a>的一部分，并且<em title="MAY" class="rfc2119">可以</em>支持其他哈希函数。</p>

            <p>用户代理<em title="SHOULD" class="rfc2119">应当</em>拒绝支持已知的弱哈希函数，如MD5或SHA-1，并且<em title="SHOULD"
                    class="rfc2119">应当</em>将支持的哈希函数限制为已知的抗碰撞哈希函数。此外，用户代理<em title="SHOULD"
                    class="rfc2119">应当</em>定期重新评估其支持的哈希函数，并弃用那些已变得不安全的函数。参见<a href="#hash-collision-attacks">哈希碰撞攻击</a>。
            </p>

            <section property="bibo:hasPart" resource="#agility" typeof="bibo:Chapter">
                <h4 resource="#agility" id="agility"><span property="xhv:role" resource="xhv:heading"><span
                            class="secno">3.2.1 </span>灵活性</span></h4>

                <p>可以将多个<a
                        href="#dfn-integrity-metadata">完整性元数据</a>集与单个资源关联，以便在面对未来加密发现时提供灵活性。例如，前一节中描述的资源可以通过以下任一哈希表达式进行描述：
                </p>

                <div class="example">
                    <div class="example-title marker"><span>示例 5</span></div>
                    <pre class="hljs gcode"><code>sha<span class="hljs-number">384</span>-dOTZf<span class="hljs-number">16</span>X<span class="hljs-number">8</span>p<span class="hljs-number">34</span>q<span class="hljs-number">2</span>/kYyEF<span class="hljs-title">m0</span>jh<span class="hljs-number">89</span>uTjikh<span class="hljs-label">nzjeLeF0</span>FHsEaYKb<span class="hljs-number">1</span>A<span class="hljs-number">1</span>cv+Lyv<span class="hljs-number">4</span>Hk<span class="hljs-number">8</span>vHd
sha<span class="hljs-number">512</span>-Q<span class="hljs-number">2</span>bFTOhEALk<span class="hljs-label">N8</span>hOms<span class="hljs-number">2</span>FKTDLy<span class="hljs-number">7</span>eugP<span class="hljs-number">2</span>zFZ<span class="hljs-number">1</span>T<span class="hljs-number">8</span>LCvX<span class="hljs-number">42</span>Fp<span class="hljs-number">3</span>Wo<span class="hljs-label">Nr3</span>bjZSAHeOsHrbV<span class="hljs-number">1</span>Fu<span class="hljs-number">9</span>/A<span class="hljs-number">0</span>EzCi<span class="hljs-label">nRE7</span>Af<span class="hljs-number">1</span>ofPrw==
</code></pre>
                </div>

                <p>作者可以选择同时指定两者，例如：</p>

                <div class="example">
                    <div class="example-title marker"><span>示例 6</span></div>
                    <pre class="hljs xml"><code><span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"hello_world.js"</span>
   <span class="hljs-attribute">integrity</span>=<span class="hljs-value">"sha384-dOTZf16X8p34q2/kYyEFm0jh89uTjikhnzjeLeF0FHsEaYKb1A1cv+Lyv4Hk8vHd
              sha512-Q2bFTOhEALkN8hOms2FKTDLy7eugP2zFZ1T8LCvX42Fp3WoNr3bjZSAHeOsHrbV1Fu9/A0EzCinRE7Af1ofPrw=="</span>
   <span class="hljs-attribute">crossorigin</span>=<span class="hljs-value">"anonymous"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
</code></pre>
                </div>

                <p>在这种情况下，用户代理将选择列表中最强的哈希函数，并使用该元数据来验证响应（如下面“<a href="#parse-metadata">解析元数据</a>”和“<a
                        href="#get-the-strongest-metadata-from-set">从集合中获取最强的元数据</a>”算法中所述）。</p>

                <p>当哈希函数被确定为不安全时，用户代理<em title="SHOULD" class="rfc2119">应当</em>弃用并最终移除使用不安全哈希函数的完整性验证支持。用户代理<em
                        title="MAY" class="rfc2119">可以</em>检查基于已弃用函数的响应的有效性。</p>

                <p>为了让作者能够在不受旧版用户代理阻碍的情况下切换到更强的哈希函数，使用不支持的哈希函数进行验证的行为与未提供完整性值时相同（参见下文的“<a
                        href="#does-response-match-metadatalist">响应是否匹配元数据列表</a>”算法）。鼓励作者使用强哈希函数，并在更强的哈希函数可用时开始迁移。</p>
            </section>
            <!-- /Framework::Cryptographic hash functions::Agility -->

            <section property="bibo:hasPart" resource="#priority" typeof="bibo:Chapter">
                <h4 resource="#priority" id="priority"><span property="xhv:role" resource="xhv:heading"><span
                            class="secno">3.2.2 </span>优先级</span></h4>

                <p>用户代理必须提供一种机制，用于确定两个哈希函数的相对优先级，如果优先级相等，则返回空字符串。也就是说，如果用户代理实现了一个类似于<dfn
                        id="dfn-getprioritizedhashfunction-a-b" data-dfn-type="dfn">getPrioritizedHashFunction(a,
                        b)</dfn>的函数，它将返回用户代理认为最具抗碰撞性的哈希函数。例如，<code>getPrioritizedHashFunction('sha256',
'sha512')</code>将返回<code>'sha512'</code>，而<code>getPrioritizedHashFunction('sha256',
'sha256')</code>将返回空字符串。</p>

                <div class="note">
                    <div id="h-note3" role="heading" aria-level="5" class="note-title marker"><span>注意</span></div>
                    <p class=""><dfn id="dfn-getprioritizedhashfunction"
                            data-dfn-type="dfn">getPrioritizedHashFunction</dfn>是一个内部实现细节。它不是实现者提供给Web应用的API。它仅用于简化本文档中的算法描述。
                    </p>
                </div>

            </section>
            <!-- /Framework::Cryptographic hash functions::Priority -->

        </section>
        <!-- /Framework::Cryptographic hash functions -->

        <section property="bibo:hasPart" resource="#response-verification-algorithms" typeof="bibo:Chapter">
            <h3 resource="#response-verification-algorithms" id="response-verification-algorithms"><span
                    property="xhv:role" resource="xhv:heading"><span class="secno">3.3 </span>响应验证算法</span></h3>

            <section property="bibo:hasPart" resource="#apply-algorithm-to-response" typeof="bibo:Chapter">
                <h4 resource="#apply-algorithm-to-response" id="apply-algorithm-to-response"><span property="xhv:role"
                        resource="xhv:heading"><span class="secno">3.3.1 </span>将<var>算法</var>应用于<var>响应</var></span>
                </h4>

                <ol>
                    <li>令<var>结果</var>为<a href="#apply-algorithm-to-response">应用<var>算法</var></a>到<a
                            href="https://tools.ietf.org/html/rfc7231#section-3">表示数据</a>的结果，不应用任何内容编码，除非用户代理打算以应用内容编码的方式使用该内容。在后一种情况下，令<var>结果</var>为应用<var>算法</var>到<a
                            href="https://tools.ietf.org/html/rfc7231#section-3">表示数据</a>的结果。</li>
                    <li>令<var>编码结果</var>为<var>结果</var>的base64编码。</li>
                    <li>返回<var>编码结果</var>。</li>
                </ol>
            </section>
            <!-- Algorithms::apply -->

            <section property="bibo:hasPart" resource="#is-response-eligible-for-integrity-validation"
                typeof="bibo:Chapter">
                <h4 resource="#is-response-eligible-for-integrity-validation"
                    id="is-response-eligible-for-integrity-validation"><span property="xhv:role"
                        resource="xhv:heading"><span class="secno">3.3.2 </span><var>响应</var>是否符合完整性验证</span></h4>

                <p>为了减轻攻击者通过完整性检查暴力破解值来跨源读取数据的能力，只有当响应是同源的或通过跨源资源共享明确授予加载源访问权限时，响应才有资格进行此类检查 [<cite><a href="#bib-CORS"
                            class="bibref">CORS</a></cite>]。</p>

                <div class="note">
                    <div id="h-note4" role="heading" aria-level="5" class="note-title marker"><span>注意</span></div>
                    <p class="">如<a
                            href="https://tools.ietf.org/html/rfc6454#section-4">RFC6454，第4节</a>所述，某些用户代理对每个文件URI使用全局唯一标识符。这意味着通过<code>file</code>方案URL访问的资源可能不符合完整性检查的资格。
                    </p>
                </div>

                <div class="note">
                    <div id="h-note5" role="heading" aria-level="5" class="note-title marker"><span>注意</span></div>
                    <p class="">处于<a
                            href="https://w3c.github.io/webappsec-secure-contexts/">安全上下文</a>（例如，通过HTTPS传输的文档）并不是使用完整性验证的必要条件。由于资源完整性仅是应用级别的安全工具，它不会改变用户代理的安全状态，因此安全上下文不是必须的。然而，如果在非安全上下文中使用完整性验证（例如，通过HTTP传输的文档），作者应意识到完整性验证<em>根本不提供任何安全保证</em>。因此，作者应仅在安全上下文中传递完整性元数据。有关更多讨论，请参见<a
                            href="#non-secure-contexts-remain-non-secure">非安全上下文仍然不安全</a>。</p>
                </div>

                <p>以下算法详细说明了这些限制：</p>

                <ol>
                    <li>令<var>响应</var>为<a href="https://fetch.spec.whatwg.org/#concept-fetch">获取</a><var>资源</var>的结果。
                    </li>
                    <li>如果<var>响应</var>的<a
                            href="https://fetch.spec.whatwg.org/#concept-response-type">类型</a>为<code>basic</code>、<code>cors</code>或<code>default</code>，返回<code>true</code>。
                    </li>
                    <li>返回<code>false</code>。</li>
                </ol>

                <div class="note">
                    <div id="h-note6" role="heading" aria-level="5" class="note-title marker"><span>注意</span></div>
                    <div class="">
                        <p><a href="https://fetch.spec.whatwg.org/#concept-response-type">响应类型</a>由Fetch规范定义 [<cite><a
                                    href="#bib-FETCH" class="bibref">FETCH</a></cite>]，并指以下内容：</p>

                        <ul>
                            <li><code>basic</code>是同源响应，因此请求者可以完全读取其主体。</li>
                            <li><code>cors</code>是对跨源、启用CORS的请求的有效响应，因此请求者也可以完全读取其主体。</li>
                            <li><code>default</code>是由Service Worker生成的对请求的有效响应，因此其主体也可以被请求者完全读取。</li>
                        </ul>
                    </div>
                </div>

            </section>
            <!-- Algorithms::eligible -->

            <section property="bibo:hasPart" resource="#parse-metadata" typeof="bibo:Chapter">
                <h4 resource="#parse-metadata" id="parse-metadata"><span property="xhv:role"
                        resource="xhv:heading"><span class="secno">3.3.3 </span>解析<var>元数据</var>。</span></h4>

                <p>此算法接受一个字符串，并返回<code>无元数据</code>或一组用户代理能够理解的有效哈希表达式。</p>

                <ol>
                    <li>令<var>结果</var>为一个空集合。</li>
                    <li>令<var>空</var>等于<code>true</code>。</li>
                    <li>对于每个通过<a
                            href="https://www.w3.org/TR/html5/infrastructure.html#split-a-string-on-spaces">按空格拆分<var>元数据</var></a>返回的<var>令牌</var>：
                        <ol>
                            <li>将<var>空</var>设置为<code>false</code>。</li>
                            <li>如果<var>令牌</var>不是有效的元数据，跳过剩余步骤，并继续下一个<var>令牌</var>。</li>
                            <li>根据<a href="#dfn-integrity-metadata">完整性元数据</a>中的语法解析<var>令牌</var>。</li>
                            <li>令<var>算法</var>为<var>令牌</var>的<var>alg</var>组件。</li>
                            <li>如果<var>算法</var>是用户代理识别的哈希函数，则将解析的<var>令牌</var>添加到<var>结果</var>中。</li>
                        </ol>
                    </li>
                    <li>如果<var>空</var>为<code>true</code>，返回<code>无元数据</code>，否则返回<var>结果</var>。</li>
                </ol>

            </section>
            <!-- Algorithms::parse -->

            <section property="bibo:hasPart" resource="#get-the-strongest-metadata-from-set" typeof="bibo:Chapter">
                <h4 resource="#get-the-strongest-metadata-from-set" id="get-the-strongest-metadata-from-set"><span
                        property="xhv:role" resource="xhv:heading"><span class="secno">3.3.4
                        </span>从<var>集合</var>中获取最强的元数据。</span></h4>

                <ol>
                    <li>令<var>结果</var>为一个空集合，<var>最强</var>为一个空字符串。</li>
                    <li>对于<var>集合</var>中的每个<var>项</var>：
                        <ol>
                            <li>如果<var>结果</var>是空集合，将<var>项</var>添加到<var>结果</var>中，并将<var>最强</var>设置为<var>项</var>，跳到下一个<var>项</var>。
                            </li>
                            <li>令<var>当前算法</var>为<var>最强</var>的<var>alg</var>组件。</li>
                            <li>令<var>新算法</var>为<var>项</var>的<var>alg</var>组件。</li>
                            <li>如果<a
                                    href="#dfn-getprioritizedhashfunction-a-b"><code>getPrioritizedHashFunction(currentAlgorithm, newAlgorithm)</code></a>的结果为空字符串，将<var>项</var>添加到<var>结果</var>中。如果结果为<var>新算法</var>，将<var>最强</var>设置为<var>项</var>，将<var>结果</var>设置为空集合，并将<var>项</var>添加到<var>结果</var>中。
                            </li>
                        </ol>
                    </li>
                    <li>返回<var>结果</var>。</li>
                </ol>

            </section>
            <!-- /Algorithms::get the strongest metadata -->

            <section property="bibo:hasPart" resource="#does-response-match-metadatalist" typeof="bibo:Chapter">
                <h4 resource="#does-response-match-metadatalist" id="does-response-match-metadatalist"><span
                        property="xhv:role" resource="xhv:heading"><span class="secno">3.3.5
                        </span><var>响应</var>是否匹配<var>元数据列表</var>？</span></h4>

                <ol>
                    <li>令<var>解析元数据</var>为<a href="#parse-metadata">解析<var>元数据列表</var></a>的结果。</li>
                    <li>如果<var>解析元数据</var>为<code>无元数据</code>，返回<code>true</code>。</li>
                    <li>如果<a
                            href="#is-response-eligible-for-integrity-validation"><var>响应</var>不符合完整性验证</a>，返回<code>false</code>。
                    </li>
                    <li>如果<var>解析元数据</var>为空集合，返回<code>true</code>。</li>
                    <li>令<var>元数据</var>为<a href="#get-the-strongest-metadata-from-set">从<var>解析元数据</var>中获取最强元数据</a>的结果。
                    </li>
                    <li>对于<var>元数据</var>中的每个<var>项</var>：
                        <ol>
                            <li>令<var>算法</var>为<var>项</var>的<var>alg</var>组件。</li>
                            <li>令<var>期望值</var>为<var>项</var>的<var>val</var>组件。</li>
                            <li>令<var>实际值</var>为<a
                                    href="#apply-algorithm-to-response">应用<var>算法</var>到<var>响应</var></a>的结果。</li>
                            <li>如果<var>实际值</var>与<var>期望值</var>区分大小写匹配，返回<code>true</code>。</li>
                        </ol>
                    </li>
                    <li>返回<code>false</code>。</li>
                </ol>

                <p>该算法允许用户代理接受多个有效的强哈希函数。例如，开发者可以编写如下的<code>script</code>元素：</p>

                <div class="example">
                    <div class="example-title marker"><span>示例 7</span></div>
                    <pre class="hljs xml"><code><span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"https://example.com/example-framework.js"</span>
        <span class="hljs-attribute">integrity</span>=<span class="hljs-value">"sha384-Li9vy3DqF8tnTXuiaAJuML3ky+er10rcgNR/VqsVpcw+ThHmYcwiB1pbOxEbzJr7
                   sha384-+/M6kredJcxdsqkczBUjMLvqyHb1K/JThDXWsBVxMEeZHEaMKEOEct339VItX1zB"</span>
        <span class="hljs-attribute">crossorigin</span>=<span class="hljs-value">"anonymous"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
</code></pre>
                </div>

                <p>这将允许用户代理接受两个不同的内容有效负载，一个匹配第一个SHA384哈希值，另一个匹配第二个SHA384哈希值。</p>

                <div class="note">
                    <div id="h-note7" role="heading" aria-level="5" class="note-title marker"><span>注意</span></div>
                    <p class="">用户代理可以允许用户通过用户偏好、书签、第三方对用户代理的扩展等机制修改该算法的结果。例如，由类似<a
                            href="https://www.eff.org/https-everywhere">HTTPS
                            Everywhere</a>的扩展生成的重定向可以正确加载和执行，即使资源的HTTPS版本与HTTP版本不同。</p>
                </div>

                <div class="note">
                    <div id="h-note8" role="heading" aria-level="5" class="note-title marker"><span>注意</span></div>
                    <p class="">如果<a
                            href="#is-response-eligible-for-integrity-validation">响应不符合完整性验证的资格</a>，该算法返回<code>false</code>，因为子资源完整性（SRI）需要CORS，尝试在没有CORS的情况下使用它是一个逻辑错误。此外，用户代理<em
                            title="SHOULD" class="rfc2119">应当</em>在开发者控制台报告警告信息，以解释该失败。</p>
                </div>
            </section>
            <!-- Algorithms::Match -->
        </section>
        <!-- Algorithms -->

        <section property="bibo:hasPart" resource="#verification-of-html-document-subresources" typeof="bibo:Chapter">
            <h3 resource="#verification-of-html-document-subresources" id="verification-of-html-document-subresources">
                <span property="xhv:role" resource="xhv:heading"><span class="secno">3.4 </span>验证HTML文档子资源</span>
            </h3>

            <p>各种HTML元素会导致请求将资源嵌入到文档中，或在其上下文中执行。为了支持其中一些元素的完整性元数据，<code>integrity</code>属性被添加到<code>link</code>和<code>script</code>元素的内容属性列表中。
            </p>

            <p>一个对应的<code>integrity</code> IDL属性，它<a
                    href="https://www.w3.org/TR/html5/infrastructure.html#reflect">反映</a>了每个元素的<code>integrity</code>内容属性的值，被添加到<code>HTMLLinkElement</code>和<code>HTMLScriptElement</code>接口中。
            </p>

            <div class="note">
                <div id="h-note9" role="heading" aria-level="4" class="note-title marker"><span>注意</span></div>
                <p class="">本规范的未来修订版本可能会包括对所有可能子资源的完整性支持，即<code>a</code>、<code>audio</code>、<code>embed</code>、
                    <code>iframe</code>、<code>img</code>、<code>link</code>、<code>object</code>、<code>script</code>、<code>source</code>、
                    <code>track</code>和<code>video</code>元素。
                </p>
            </div>

        </section>

        <section property="bibo:hasPart" resource="#the-integrity-attribute" typeof="bibo:Chapter">
            <h3 resource="#the-integrity-attribute" id="the-integrity-attribute"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">3.5 </span><code>integrity</code>属性</span>
            </h3>

            <p><code>integrity</code>属性表示元素的<a href="#dfn-integrity-metadata">完整性元数据</a>。属性的值<em title="MUST"
                    class="rfc2119">必须</em>是空字符串或至少一个有效的元数据，如以下ABNF语法所描述：</p>

            <pre class="hljs gherkin"><code>integrity-metadata = <span class="hljs-keyword">*</span>WSP hash-with-options <span class="hljs-keyword">*</span>( 1<span class="hljs-keyword">*</span>WSP hash-with-options ) <span class="hljs-keyword">*</span>WSP / <span class="hljs-keyword">*</span>WSP
hash-with-options  = hash-expression <span class="hljs-keyword">*</span>(<span class="hljs-string">"?"</span> option-expression)
option-expression  = <span class="hljs-keyword">*</span>VCHAR
hash-algo          = <span class="hljs-variable">&lt;hash-algo production from [Content Security Policy Level 2, section 4.2]&gt;</span>
base64-value       = <span class="hljs-variable">&lt;base64-value production from [Content Security Policy Level 2, section 4.2]&gt;</span>
hash-expression    = hash-algo <span class="hljs-string">"-"</span> base64-value
</code></pre>

            <p><code>integrity</code> IDL属性必须<a
                    href="https://www.w3.org/TR/html5/infrastructure.html#reflect">反映</a><code>integrity</code>内容属性的值。
            </p>

            <p><code>option-expression</code>与每个<code>hash-expression</code>关联，并且仅应用于其前面的<code>hash-expression</code>。
            </p>

            <p>为了确保用户代理完全向未来的选项兼容，用户代理<em title="MUST" class="rfc2119">必须</em>忽略所有无法识别的<code>option-expression</code>。
            </p>

            <div class="note">
                <div id="h-note10" role="heading" aria-level="4" class="note-title marker"><span>注意</span></div>
                <p>请注意，虽然<code>option-expression</code>已在语法中保留，但尚未定义任何选项。很可能在未来的版本中会为选项定义更具体的语法，因此在此定义为尽可能广泛。</p>
            </div>

        </section>
        <!-- /Framework::HTML::integrity -->

        <section property="bibo:hasPart" resource="#element-interface-extensions" typeof="bibo:Chapter">
            <h3 resource="#element-interface-extensions" id="element-interface-extensions"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">3.6 </span>元素接口扩展</span></h3>

            <section property="bibo:hasPart" resource="#htmllinkelement" typeof="bibo:Chapter">
                <h4 resource="#htmllinkelement" id="htmllinkelement"><span property="xhv:role"
                        resource="xhv:heading"><span class="secno">3.6.1 </span>HTMLLinkElement</span></h4>

                <pre class="idl"><span class="idlInterface" id="idl-def-HTMLLinkElement">partial interface <span class="idlInterfaceID">HTMLLinkElement</span> {
<span class="idlAttribute">                    attribute <span class="idlAttrType">DOMString</span> <span class="idlAttrName"><a href="#widl-HTMLLinkElement-integrity">integrity</a></span>;</span>
};</span></pre>

                <section property="bibo:hasPart" resource="#attributes" typeof="bibo:Chapter" id="attributes">
                    <h5 resource="#h-attributes" id="h-attributes"><span property="xhv:role"
                            resource="xhv:heading"><span class="secno">3.6.1.1 </span>属性</span></h5>
                    <dl class="attributes">
                        <dt id="widl-HTMLLinkElement-integrity"><code>integrity</code>类型为<span
                                class="idlAttrType">DOMString</span></dt>
                        <dd><code>integrity</code></dd>
                    </dl>
                </section>
            </section>
            <!-- /Framework::HTML::Interface extensions::HTMLLinkElement -->

            <section property="bibo:hasPart" resource="#htmlscriptelement" typeof="bibo:Chapter">
                <h4 resource="#htmlscriptelement" id="htmlscriptelement"><span property="xhv:role"
                        resource="xhv:heading"><span class="secno">3.6.2 </span>HTMLScriptElement</span></h4>

                <pre class="idl"><span class="idlInterface" id="idl-def-HTMLScriptElement">partial interface <span class="idlInterfaceID">HTMLScriptElement</span> {
<span class="idlAttribute">                    attribute <span class="idlAttrType">DOMString</span> <span class="idlAttrName"><a href="#widl-HTMLScriptElement-integrity">integrity</a></span>;</span>
};</span></pre>

                <section property="bibo:hasPart" resource="#attributes-1" typeof="bibo:Chapter" id="attributes-1">
                    <h5 resource="#h-attributes-1" id="h-attributes-1"><span property="xhv:role"
                            resource="xhv:heading"><span class="secno">3.6.2.1 </span>属性</span></h5>
                    <dl class="attributes">
                        <dt id="widl-HTMLScriptElement-integrity"><code>integrity</code>类型为<span
                                class="idlAttrType">DOMString</span></dt>
                        <dd><code>integrity</code></dd>
                    </dl>
                </section>
            </section>
            <!-- /Framework::HTML::Interface extensions::HTMLScriptElement -->
        </section>
        <!-- /Framework::HTML::Interface extensions -->

        <section property="bibo:hasPart" resource="#handling-integrity-violations" typeof="bibo:Chapter">
            <h3 resource="#handling-integrity-violations" id="handling-integrity-violations"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">3.7 </span>处理完整性违规</span></h3>

            <p>用户代理将拒绝渲染或执行未通过完整性检查的响应，而是返回Fetch中定义的网络错误 [<cite><a href="#bib-FETCH" class="bibref">FETCH</a></cite>]。
            </p>

            <div class="note">
                <div id="h-note11" role="heading" aria-level="4" class="note-title marker"><span>注意</span></div>
                <p>在完整性检查失败时，会触发<code>error</code>事件。希望提供规范备用资源（例如，未从CDN提供的资源，可能来自二级、受信任但较慢的源）的开发人员可以捕获此<code>error</code>事件，并提供适当的处理程序以将失败的资源替换为另一个资源。
                </p>
            </div>

        </section>

        <section property="bibo:hasPart" resource="#elements" typeof="bibo:Chapter">
            <h3 resource="#elements" id="elements"><span property="xhv:role" resource="xhv:heading"><span
                        class="secno">3.8 </span>元素</span></h3>

            <section property="bibo:hasPart" resource="#the-link-element-for-stylesheets" typeof="bibo:Chapter">
                <h4 resource="#the-link-element-for-stylesheets" id="the-link-element-for-stylesheets"><span
                        property="xhv:role" resource="xhv:heading"><span class="secno">3.8.1
                        </span><code>link</code>元素用于样式表</span></h4>

                <p>每当用户代理尝试<a
                        href="https://www.w3.org/TR/html5/document-metadata.html#concept-link-obtain">获取</a>由<code>link</code>元素指向的资源时，如果其<code>rel</code>属性包含<code>stylesheet</code>关键字，请修改步骤4为：
                </p>

                <p>对生成的绝对URL进行潜在的启用CORS的获取，模式为元素crossorigin内容属性的当前状态，源为link元素文档的源，默认源行为设置为污染，并将请求的<a
                        href="#dfn-integrity-metadata">完整性元数据</a>设置为元素<code>integrity</code>属性的值。</p>

            </section>
            <!-- /Framework::HTML::link -->

            <section property="bibo:hasPart" resource="#the-script-element" typeof="bibo:Chapter">
                <h4 resource="#the-script-element" id="the-script-element"><span property="xhv:role"
                        resource="xhv:heading"><span class="secno">3.8.2 </span><code>script</code>元素</span>
                </h4>

                <p>将HTML5中<a
                        href="https://www.w3.org/TR/html5/scripting-1.html#prepare-a-script">“准备脚本”算法</a>的步骤14.1替换为：</p>

                <ol>
                    <li>令<var>src</var>为元素<code>src</code>属性的值，请求的关联<a
                            href="#dfn-integrity-metadata">完整性元数据</a>为元素<code>integrity</code>属性的值。</li>
                </ol>

            </section>
            <!-- /Framework::HTML::Elements::script -->

        </section>
        <!-- /Framework::HTML::Elements -->

    </section>
    <!-- /Framework -->

    <section property="bibo:hasPart" resource="#proxies" typeof="bibo:Chapter">
        <!--OddPage-->
        <h2 resource="#proxies" id="proxies"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.
                </span>代理</span></h2>

        <p>优化代理和其他修改响应的中间服务器<em title="MUST" class="rfc2119">必须</em>确保与这些响应相关的摘要与新内容保持同步。一种选择是确保与资源相关的<a
                href="#dfn-integrity-metadata">完整性元数据</a>已更新。另一种选择是仅传送页面作者请求完整性验证的资源的规范版本。</p>

        <p>为了帮助通知中间服务器，提供资源的服务器<em title="SHOULD" class="rfc2119">应当</em>与资源一起发送带有<a
                href="https://tools.ietf.org/html/rfc7234#section-5.2"><code>Cache-Control</code></a>标头，并将其值设置为<a
                href="https://tools.ietf.org/html/rfc7234#section-5.2.1.6"><code>no-transform</code></a>。</p>

    </section>
    <!-- /Implementation -->

    <section property="bibo:hasPart" resource="#security-considerations" typeof="bibo:Chapter" class="informative">
        <!--OddPage-->
        <h2 resource="#security-considerations" id="security-considerations"><span property="xhv:role"
                resource="xhv:heading"><span class="secno">5. </span>安全性考虑</span></h2>
        <p><em>本节为非规范性内容。</em></p>

        <section property="bibo:hasPart" resource="#non-secure-contexts-remain-non-secure" typeof="bibo:Chapter">
            <h3 resource="#non-secure-contexts-remain-non-secure" id="non-secure-contexts-remain-non-secure"><span
                    property="xhv:role" resource="xhv:heading"><span class="secno">5.1 </span>非安全上下文仍然不安全</span></h3>

            <p>由非<a href="https://w3c.github.io/webappsec-secure-contexts/">安全上下文</a>（例如HTTP页面）传递的<a
                    href="#dfn-integrity-metadata">完整性元数据</a>仅能保护原点免受托管外部资源的服务器被入侵的情况。网络攻击者可以在传输过程中更改摘要（或完全删除它，或对文档做任何其他更改），正如他们可以更改哈希试图验证的响应一样。因此，建议作者仅将完整性元数据传递到<a
                    href="https://w3c.github.io/webappsec-secure-contexts/">安全上下文</a>。另见<a
                    href="https://www.w3.org/2001/tag/doc/web-https">保护网络安全</a>。</p>

        </section>
        <!-- /Security::Non-secure contexts remain non-secure -->

        <section property="bibo:hasPart" resource="#hash-collision-attacks" typeof="bibo:Chapter">
            <h3 resource="#hash-collision-attacks" id="hash-collision-attacks"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">5.2 </span>哈希碰撞攻击</span></h3>

            <p>摘要的强度取决于用于生成它们的哈希函数。建议用户代理拒绝支持已知弱的哈希函数，并将支持的算法限制为已知的抗碰撞算法。不推荐的哈希函数示例包括MD5和SHA-1。在撰写本文时，SHA-384是一个不错的基准。
            </p>

            <p>此外，建议用户代理定期重新评估其支持的哈希函数，并弃用已被证明不安全的函数。随着时间的推移，哈希函数可能被证明比预期的要弱得多，甚至在某些情况下被破解，因此用户代理需要关注这些进展。</p>

        </section>
        <!-- /Security::Hash collision -->

        <section property="bibo:hasPart" resource="#cross-origin-data-leakage" typeof="bibo:Chapter">
            <h3 resource="#cross-origin-data-leakage" id="cross-origin-data-leakage"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">5.3 </span>跨源数据泄漏</span></h3>

            <p>本规范要求跨源请求的<a
                    href="https://www.w3.org/TR/html5/infrastructure.html#cors-settings-attributes">CORS设置属性</a>存在于受完整性保护的跨源请求中。如果省略了这一要求，攻击者可能会违反<a
                    href="https://www.w3.org/Security/wiki/Same_Origin_Policy">同源策略</a>，并确定跨源资源是否具有特定内容。</p>

            <p>攻击者可能会尝试使用已知摘要加载资源，并观察加载失败情况。如果加载失败，攻击者可以推断出响应与哈希不匹配，从而获得其内容的一些信息。例如，这可能会揭示用户是否已登录到某个特定服务。</p>

            <p>此外，攻击者还可以通过蛮力破解特定值来攻击一个基本静态的资源。考虑如下的JSON响应：</p>

            <div class="example">
                <div class="example-title marker"><span>示例 8</span></div>
                <pre class="hljs xquery"><code>{<span class="hljs-string">'status'</span>: <span class="hljs-string">'authenticated'</span>, <span class="hljs-string">'username'</span>: <span class="hljs-string">'admin'</span>}
</code></pre>
            </div>

            <p>攻击者可以为响应中的常见用户名预计算哈希，并在反复尝试加载文档时指定这些哈希。成功的加载将确认攻击者已正确猜出了用户名。</p>

        </section>
        <!-- /Security::cross-origin -->

    </section>
    <!-- /Security -->

    <section property="bibo:hasPart" resource="#acknowledgements" typeof="bibo:Chapter">
        <!--OddPage-->
        <h2 resource="#acknowledgements" id="acknowledgements"><span property="xhv:role" resource="xhv:heading"><span
                    class="secno">6. </span>致谢</span></h2>

        <p>本内容的许多部分深受Gervase Markham的<a href="http://www.gerv.net/security/link-fingerprints/">Link
                Fingerprints</a>概念以及WHATWG的<a href="https://wiki.whatwg.org/wiki/Link_Hashes">Link Hashes</a>的启发。</p>

        <p>特别感谢Google公司的Mike West对本规范初始版本的宝贵贡献。此外，Brad Hill、Anne van Kesteren、Jonathan Kingston、Mark Nottingham、Dan
            Veditz、Eduardo Vela、Tanvi Vyas和Michal Zalewski也提供了非常宝贵的反馈意见。</p>

    </section>

    <section property="bibo:hasPart" resource="#references" typeof="bibo:Chapter" id="references" class="appendix">
        <!--OddPage-->
        <h2 resource="#h-references" id="h-references"><span property="xhv:role" resource="xhv:heading"><span
                    class="secno">A. </span>参考文献</span></h2>

        <section property="bibo:hasPart" resource="#normative-references" typeof="bibo:Chapter"
            id="normative-references">
            <h3 resource="#h-normative-references" id="h-normative-references"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">A.1 </span>规范性参考文献</span></h3>
            <dl resource="" class="bibliography">
                <dt id="bib-ABNF">[ABNF]</dt>
                <dd>D. Crocker, Ed.; P. Overell. IETF. <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc5234"><cite>增强的BNF语法规范：ABNF</cite></a>。2008年1月。互联网标准。URL:
                    <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc5234">https://tools.ietf.org/html/rfc5234</a>
                </dd>
                <dt id="bib-CORS">[CORS]</dt>
                <dd>Anne van Kesteren. W3C. <a property="dc:requires"
                        href="https://www.w3.org/TR/cors/"><cite>跨源资源共享</cite></a>。2014年1月16日。W3C推荐。URL: <a
                        property="dc:requires" href="https://www.w3.org/TR/cors/">http://www.w3.org/TR/cors/</a>
                </dd>
                <dt id="bib-FETCH">[FETCH]</dt>
                <dd>Anne van Kesteren. WHATWG. <a property="dc:requires"
                        href="https://fetch.spec.whatwg.org/"><cite>Fetch标准</cite></a>。现行标准。URL: <a
                        property="dc:requires" href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-MIMETYPE">[MIMETYPE]</dt>
                <dd>Ned Freed; Nathaniel S. Borenstein. IETF. <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc2046"><cite>多用途互联网邮件扩展（MIME）第二部分：媒体类型</cite></a>。草案标准。URL:
                    <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc2046">https://tools.ietf.org/html/rfc2046</a>
                </dd>
                <dt id="bib-RFC2119">[RFC2119]</dt>
                <dd>S. Bradner. IETF. <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc2119"><cite>用于指示要求级别的关键字</cite></a>。1997年3月。最佳当前实践。URL: <a
                        property="dc:requires"
                        href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
                </dd>
                <dt id="bib-RFC4648">[RFC4648]</dt>
                <dd>Simon Josefsson. IETF. <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc4648"><cite>Base16、Base32和Base64数据编码</cite></a>。建议标准。URL:
                    <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc4648">https://tools.ietf.org/html/rfc4648</a>
                </dd>
                <dt id="bib-RFC6454">[RFC6454]</dt>
                <dd>A. Barth. IETF. <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc6454"><cite>Web原点概念</cite></a>。2011年12月。建议标准。URL: <a
                        property="dc:requires"
                        href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a>
                </dd>
                <dt id="bib-RFC7231">[RFC7231]</dt>
                <dd>R. Fielding, Ed.; J. Reschke, Ed.. IETF. <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc7231"><cite>超文本传输协议（HTTP/1.1）：语义和内容</cite></a>。2014年6月。建议标准。URL:
                    <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc7231">https://tools.ietf.org/html/rfc7231</a>
                </dd>
            </dl>
        </section>
    </section>

    <p role="navigation" id="back-to-top"><a href="#toc"><abbr title="返回顶部">↑</abbr></a></p>
    <script src="https://www.w3.org/scripts/TR/2016/fixup.js" defer="" async=""></script>
    <script src="/dropdown.js"></script>
</body>

</html>