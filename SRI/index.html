<!DOCTYPE html>
<html lang="en" dir="ltr" typeof="bibo:Document w3p:REC"
    prefix="bibo: http://purl.org/ontology/bibo/ w3p: http://www.w3.org/2001/02pd/rec54#">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <meta property="dc:language" content="en" lang="">
    <style>
        /*

github.com style (c) Vasily Polovnyov <vast@whiteants.net>

*/

        .hljs {
            display: block;
            overflow-x: auto;
            padding: 0.5em;
            color: #333;
            background: #f8f8f8;
            -webkit-text-size-adjust: none;
        }

        .hljs-comment,
        .diff .hljs-header {
            color: #998;
            font-style: italic;
        }

        .hljs-keyword,
        .css .rule .hljs-keyword,
        .hljs-winutils,
        .nginx .hljs-title,
        .hljs-subst,
        .hljs-request,
        .hljs-status {
            color: #333;
            font-weight: bold;
        }

        .hljs-number,
        .hljs-hexcolor,
        .ruby .hljs-constant {
            color: #008080;
        }

        .hljs-string,
        .hljs-tag .hljs-value,
        .hljs-doctag,
        .tex .hljs-formula {
            color: #d14;
        }

        .hljs-title,
        .hljs-id,
        .scss .hljs-preprocessor {
            color: #900;
            font-weight: bold;
        }

        .hljs-list .hljs-keyword,
        .hljs-subst {
            font-weight: normal;
        }

        .hljs-class .hljs-title,
        .hljs-type,
        .vhdl .hljs-literal,
        .tex .hljs-command {
            color: #458;
            font-weight: bold;
        }

        .hljs-tag,
        .hljs-tag .hljs-title,
        .hljs-rule .hljs-property,
        .django .hljs-tag .hljs-keyword {
            color: #000080;
            font-weight: normal;
        }

        .hljs-attribute,
        .hljs-variable,
        .lisp .hljs-body,
        .hljs-name {
            color: #008080;
        }

        .hljs-regexp {
            color: #009926;
        }

        .hljs-symbol,
        .ruby .hljs-symbol .hljs-string,
        .lisp .hljs-keyword,
        .clojure .hljs-keyword,
        .scheme .hljs-keyword,
        .tex .hljs-special,
        .hljs-prompt {
            color: #990073;
        }

        .hljs-built_in {
            color: #0086b3;
        }

        .hljs-preprocessor,
        .hljs-pragma,
        .hljs-pi,
        .hljs-doctype,
        .hljs-shebang,
        .hljs-cdata {
            color: #999;
            font-weight: bold;
        }

        .hljs-deletion {
            background: #fdd;
        }

        .hljs-addition {
            background: #dfd;
        }

        .diff .hljs-change {
            background: #0086b3;
        }

        .hljs-chunk {
            color: #aaa;
        }
    </style>
    <style id="respec-mainstyle">
        /*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/
        /* Override code highlighter background */

        .hljs {
            background: transparent !important;
        }

        /* --- INLINES --- */

        em.rfc2119 {
            text-transform: lowercase;
            font-variant: small-caps;
            font-style: normal;
            color: #900;
        }

        h1 acronym,
        h2 acronym,
        h3 acronym,
        h4 acronym,
        h5 acronym,
        h6 acronym,
        a acronym,
        h1 abbr,
        h2 abbr,
        h3 abbr,
        h4 abbr,
        h5 abbr,
        h6 abbr,
        a abbr {
            border: none;
        }

        dfn {
            font-weight: bold;
        }

        a.internalDFN {
            color: inherit;
            border-bottom: 1px solid #99c;
            text-decoration: none;
        }

        a.externalDFN {
            color: inherit;
            border-bottom: 1px dotted #ccc;
            text-decoration: none;
        }

        a.bibref {
            text-decoration: none;
        }

        cite .bibref {
            font-style: normal;
        }

        code {
            color: #C83500;
        }

        /* --- TOC --- */

        .toc a,
        .tof a {
            text-decoration: none;
        }

        a .secno,
        a .figno {
            color: #000;
        }

        ul.tof,
        ol.tof {
            list-style: none outside none;
        }

        .caption {
            margin-top: 0.5em;
            font-style: italic;
        }

        /* --- TABLE --- */

        table.simple {
            border-spacing: 0;
            border-collapse: collapse;
            border-bottom: 3px solid #005a9c;
        }

        .simple th {
            background: #005a9c;
            color: #fff;
            padding: 3px 5px;
            text-align: left;
        }

        .simple th[scope="row"] {
            background: inherit;
            color: inherit;
            border-top: 1px solid #ddd;
        }

        .simple td {
            padding: 3px 10px;
            border-top: 1px solid #ddd;
        }

        .simple tr:nth-child(even) {
            background: #f0f6ff;
        }

        /* --- DL --- */

        .section dd>p:first-child {
            margin-top: 0;
        }

        .section dd>p:last-child {
            margin-bottom: 0;
        }

        .section dd {
            margin-bottom: 1em;
        }

        .section dl.attrs dd,
        .section dl.eldef dd {
            margin-bottom: 0;
        }

        .respec-hidden {
            display: none;
        }

        @media print {
            .removeOnSave {
                display: none;
            }
        }
    </style>
    <title>Subresource Integrity</title>


    <style>
        /* --- EXAMPLES --- */

        div.example-title {
            min-width: 7.5em;
            color: #b9ab2d;
        }

        div.example-title span {
            text-transform: uppercase;
        }

        aside.example,
        div.example,
        div.illegal-example {
            padding: 0.5em;
            margin: 1em 0;
            position: relative;
            clear: both;
        }

        div.illegal-example {
            color: red
        }

        div.illegal-example p {
            color: black
        }

        aside.example,
        div.example {
            padding: .5em;
            border-left-width: .5em;
            border-left-style: solid;
            border-color: #e0cb52;
            background: #fcfaee;
        }

        aside.example div.example {
            border-left-width: .1em;
            border-color: #999;
            background: #fff;
        }

        aside.example div.example div.example-title {
            color: #999;
        }
    </style>
    <style>
        /* --- ISSUES/NOTES --- */

        div.issue-title,
        div.note-title,
        div.ednote-title,
        div.warning-title {
            padding-right: 1em;
            min-width: 7.5em;
            color: #b9ab2d;
        }

        div.issue-title {
            color: #e05252;
        }

        div.note-title,
        div.ednote-title {
            color: #2b2;
        }

        div.warning-title {
            color: #f22;
        }

        div.issue-title span,
        div.note-title span,
        div.ednote-title span,
        div.warning-title span {
            text-transform: uppercase;
        }

        div.note,
        div.issue,
        div.ednote,
        div.warning {
            margin-top: 1em;
            margin-bottom: 1em;
        }

        .note>p:first-child,
        .ednote>p:first-child,
        .issue>p:first-child,
        .warning>p:first-child {
            margin-top: 0
        }

        .issue,
        .note,
        .ednote,
        .warning {
            padding: .5em;
            border-left-width: .5em;
            border-left-style: solid;
        }

        div.issue,
        div.note,
        div.ednote,
        div.warning {
            padding: 1em 1.2em 0.5em;
            margin: 1em 0;
            position: relative;
            clear: both;
        }

        span.note,
        span.ednote,
        span.issue,
        span.warning {
            padding: .1em .5em .15em;
        }

        .issue {
            border-color: #e05252;
            background: #fbe9e9;
        }

        .note,
        .ednote {
            border-color: #52e052;
            background: #e9fbe9;
        }

        .warning {
            border-color: #f11;
            border-width: .2em;
            border-style: solid;
            background: #fbe9e9;
        }

        .warning-title:before {
            content: "⚠";
            /*U+26A0 WARNING SIGN*/
            font-size: 3em;
            float: left;
            height: 100%;
            padding-right: .3em;
            vertical-align: top;
            margin-top: -0.5em;
        }

        li.task-list-item {
            list-style: none;
        }

        input.task-list-item-checkbox {
            margin: 0 0.35em 0.25em -1.6em;
            vertical-align: middle;
        }
    </style>
    <style>
        /* --- WEB IDL --- */

        pre.idl {
            border-top: 1px solid #90b8de;
            border-bottom: 1px solid #90b8de;
            padding: 1em;
            line-height: 120%;
        }

        @media print {
            pre.idl {
                white-space: pre-wrap;
            }
        }

        pre.idl::before {
            content: "WebIDL";
            display: block;
            width: 150px;
            background: #90b8de;
            color: #fff;
            font-family: sans-serif;
            padding: 3px;
            font-weight: bold;
            margin: -1em 0 1em -1em;
        }

        .idlType {
            color: #ff4500;
            font-weight: bold;
            text-decoration: none;
        }

        /*.idlModule*/
        /*.idlModuleID*/
        /*.idlInterface*/

        .idlInterfaceID,
        .idlDictionaryID,
        .idlCallbackID,
        .idlEnumID {
            font-weight: bold;
            color: #005a9c;
        }

        a.idlEnumItem {
            color: #000;
            border-bottom: 1px dotted #ccc;
            text-decoration: none;
        }

        .idlSuperclass {
            font-style: italic;
            color: #005a9c;
        }

        /*.idlAttribute*/

        .idlAttrType,
        .idlFieldType,
        .idlMemberType {
            color: #005a9c;
        }

        .idlAttrName,
        .idlFieldName,
        .idlMemberName {
            color: #ff4500;
        }

        .idlAttrName a,
        .idlFieldName a,
        .idlMemberName a {
            color: #ff4500;
            border-bottom: 1px dotted #ff4500;
            text-decoration: none;
        }

        /*.idlMethod*/

        .idlMethType,
        .idlCallbackType {
            color: #005a9c;
        }

        .idlMethName {
            color: #ff4500;
        }

        .idlMethName a {
            color: #ff4500;
            border-bottom: 1px dotted #ff4500;
            text-decoration: none;
        }

        /*.idlCtor*/

        .idlCtorName {
            color: #ff4500;
        }

        .idlCtorName a {
            color: #ff4500;
            border-bottom: 1px dotted #ff4500;
            text-decoration: none;
        }

        /*.idlParam*/

        .idlParamType {
            color: #005a9c;
        }

        .idlParamName,
        .idlDefaultValue {
            font-style: italic;
        }

        .extAttr {
            color: #666;
        }

        /*.idlSectionComment*/

        .idlSectionComment {
            color: gray;
        }

        /*.idlIterable*/

        .idlIterableKeyType,
        .idlIterableValueType {
            color: #005a9c;
        }

        /*.idlMaplike*/

        .idlMaplikeKeyType,
        .idlMaplikeValueType {
            color: #005a9c;
        }

        /*.idlConst*/

        .idlConstType {
            color: #005a9c;
        }

        .idlConstName {
            color: #ff4500;
        }

        .idlConstName a {
            color: #ff4500;
            border-bottom: 1px dotted #ff4500;
            text-decoration: none;
        }

        /*.idlException*/

        .idlExceptionID {
            font-weight: bold;
            color: #c00;
        }

        .idlTypedefID,
        .idlTypedefType {
            color: #005a9c;
        }

        .idlRaises,
        .idlRaises a.idlType,
        .idlRaises a.idlType code,
        .excName a,
        .excName a code {
            color: #c00;
            font-weight: normal;
        }

        .excName a {
            font-family: monospace;
        }

        .idlRaises a.idlType,
        .excName a.idlType {
            border-bottom: 1px dotted #c00;
        }

        .excGetSetTrue,
        .excGetSetFalse,
        .prmNullTrue,
        .prmNullFalse,
        .prmOptTrue,
        .prmOptFalse {
            width: 45px;
            text-align: center;
        }

        .excGetSetTrue,
        .prmNullTrue,
        .prmOptTrue {
            color: #0c0;
        }

        .excGetSetFalse,
        .prmNullFalse,
        .prmOptFalse {
            color: #c00;
        }

        .idlImplements a {
            font-weight: bold;
        }

        dl.attributes,
        dl.methods,
        dl.constants,
        dl.constructors,
        dl.fields,
        dl.dictionary-members {
            margin-left: 2em;
        }

        .attributes dt,
        .methods dt,
        .constants dt,
        .constructors dt,
        .fields dt,
        .dictionary-members dt {
            font-weight: normal;
        }

        .attributes dt code,
        .methods dt code,
        .constants dt code,
        .constructors dt code,
        .fields dt code,
        .dictionary-members dt code {
            font-weight: bold;
            color: #000;
            font-family: monospace;
        }

        .attributes dt code,
        .fields dt code,
        .dictionary-members dt code {
            background: #ffffd2;
        }

        .attributes dt .idlAttrType code,
        .fields dt .idlFieldType code,
        .dictionary-members dt .idlMemberType code {
            color: #005a9c;
            background: transparent;
            font-family: inherit;
            font-weight: normal;
            font-style: italic;
        }

        .methods dt code {
            background: #d9e6f8;
        }

        .constants dt code {
            background: #ddffd2;
        }

        .constructors dt code {
            background: #cfc;
        }

        .attributes dd,
        .methods dd,
        .constants dd,
        .constructors dd,
        .fields dd,
        .dictionary-members dd {
            margin-bottom: 1em;
        }

        table.parameters,
        table.exceptions {
            border-spacing: 0;
            border-collapse: collapse;
            margin: 0.5em 0;
            width: 100%;
        }

        table.parameters {
            border-bottom: 1px solid #90b8de;
        }

        table.exceptions {
            border-bottom: 1px solid #deb890;
        }

        .parameters th,
        .exceptions th {
            color: #fff;
            padding: 3px 5px;
            text-align: left;
            font-weight: normal;
            text-shadow: #666 1px 1px 0;
        }

        .parameters th {
            background: #90b8de;
        }

        .exceptions th {
            background: #deb890;
        }

        .parameters td,
        .exceptions td {
            padding: 3px 10px;
            border-top: 1px solid #ddd;
            vertical-align: top;
        }

        .parameters tr:first-child td,
        .exceptions tr:first-child td {
            border-top: none;
        }

        .parameters td.prmName,
        .exceptions td.excName,
        .exceptions td.excCodeName {
            width: 100px;
        }

        .parameters td.prmType {
            width: 120px;
        }

        table.exceptions table {
            border-spacing: 0;
            border-collapse: collapse;
            width: 100%;
        }
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-REC" rel="stylesheet">
    <!--[if lt IE 9]><script src='https://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]-->
    <script type="application/json" id="initialUserConfig">
    {
      "specStatus": "REC",
      "shortName": "SRI",
      "copyrightStart": "2014",
      "edDraftURI": "https://w3c.github.io/webappsec-subresource-integrity/",
      "crEnd": "2015-12-15",
      "previousMaturity": "PR",
      "previousPublishDate": "2016-05-10",
      "implementationReportURI": "https://github.com/w3c/webappsec-subresource-integrity/wiki/Links",
      "editors": [
      {
        "name": "Devdatta Akhawe",
        "url": "http://devd.me",
        "mailto": "dev.akhawe@gmail.com",
        "company": "Dropbox, Inc.",
        "companyURL": "https://www.dropbox.com/"
      },
      {
        "name": "Frederik Braun",
        "url": "https://frederik-braun.com/",
        "mailto": "fbraun@mozilla.com",
        "company": "Mozilla",
        "companyURL": "https://www.mozilla.org/",
        "w3cid": 68466
      },
      {
        "name": "François Marier",
        "url": "https://fmarier.org",
        "mailto": "francois@mozilla.com",
        "company": "Mozilla",
        "companyURL": "https://www.mozilla.org/"
      },
      {
        "name": "Joel Weinberger",
        "url": "https://joelweinberger.us/",
        "mailto": "jww@google.com",
        "company": "Google, Inc.",
        "companyURL": "https://google.com/"
      }],
      "otherLinks": [
      {
        "key": "Participate",
        "data": [
        {
          "value": "We are on Github.",
          "href": "https://github.com/w3c/webappsec-subresource-integrity"
        },
        {
          "value": "File a bug.",
          "href": "https://github.com/w3c/webappsec-subresource-integrity/issues"
        },
        {
          "value": "Commit history.",
          "href": "https://github.com/w3c/webappsec-subresource-integrity/commits/gh-pages"
        },
        {
          "value": "Mailing list.",
          "href": "https://lists.w3.org/Archives/Public/public-webappsec/"
        }]
      },
      {
        "key": "Implementation status",
        "data": [
        {
          "value": "Blink/Chromium",
          "href": "https://code.google.com/p/chromium/issues/detail?id=355467"
        },
        {
          "value": "Gecko",
          "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=992096"
        }]
      }],
      "wg": "Web Application Security Working Group",
      "wgURI": "http://www.w3.org/2011/webappsec/",
      "wgPublicList": "public-webappsec",
      "subjectPrefix": "[SRI]",
      "wgPatentURI": "http://www.w3.org/2004/01/pp-impl/49309/status",
      "localBiblio":
      {
        "CSP":
        {
          "title": "Content Security Policy 1.1",
          "href": "http://w3.org/TR/CSP11",
          "authors": [
            "Adam Barth",
            "Dan Veditz",
            "Mike West"
          ],
          "status": "Working Draft",
          "publisher": "W3C"
        },
        "MIMETYPE":
        {
          "title": "Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types",
          "href": "https://tools.ietf.org/html/rfc2046",
          "authors": [
            "Ned Freed",
            "Nathaniel S. Borenstein"
          ],
          "status": "Draft Standard",
          "publisher": "IETF"
        },
        "RFC4648":
        {
          "title": "The Base16, Base32, and Base64 Data Encodings",
          "href": "https://tools.ietf.org/html/rfc4648",
          "authors": [
            "Simon Josefsson"
          ],
          "status": "Proposed Standard",
          "publisher": "IETF"
        },
        "RFC6920":
        {
          "title": "Naming Things with Hashes",
          "href": "http://tools.ietf.org/html/rfc6920",
          "authors": [
            "Stephen Farrell",
            "Dirk Kutscher",
            "Christian Dannewitz",
            "Borje Ohlman",
            "Ari Keranen",
            "Phillip Hallam-Baker"
          ],
          "status": "Proposed Standard",
          "publisher": "IETF"
        }
      }
    }
  </script>
</head>

<body id="respecDocument" class="h-entry">
    <div id="respecHeader" role="contentinfo" class="head">
        <p>
            <a class="logo" href="https://www.w3.org/"><img src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C"
                    alt="W3C" height="48" width="72"></a>
        </p>
        <h1 class="title p-name" id="title" property="dcterms:title">Subresource Integrity</h1>
        <h2 id="w3c-recommendation-15-june-2016"><abbr title="World Wide Web Consortium">W3C</abbr> Recommendation <time
                property="dcterms:issued" class="dt-published" datetime="2016-06-23">23 June 2016</time></h2>
        <dl>
            <dt>This version:</dt>
            <dd><a class="u-url"
                    href="https://www.w3.org/TR/2016/REC-SRI-20160623/">http://www.w3.org/TR/2016/REC-SRI-20160623/</a>
            </dd>
            <dt>Latest published version:</dt>
            <dd><a href="https://www.w3.org/TR/SRI/">http://www.w3.org/TR/SRI/</a></dd>
            <dt>Latest editor's draft:</dt>
            <dd><a
                    href="https://w3c.github.io/webappsec-subresource-integrity/">https://w3c.github.io/webappsec-subresource-integrity/</a>
            </dd>
            <dt>Implementation report:</dt>
            <dd><a
                    href="https://github.com/w3c/webappsec-subresource-integrity/wiki/Links">https://github.com/w3c/webappsec-subresource-integrity/wiki/Links</a>
            </dd>
            <dt>Previous version:</dt>
            <dd><a rel="dcterms:replaces"
                    href="https://www.w3.org/TR/2016/PR-SRI-20160510/">http://www.w3.org/TR/2016/PR-SRI-20160510/</a>
            </dd>
            <dt>Editors:</dt>
            <dd class="p-author h-card vcard" property="bibo:editor" resource="_:editor0"><span property="rdf:first"
                    typeof="foaf:Person">
                    <meta property="foaf:name" content="Devdatta Akhawe"><a class="u-url url p-name fn"
                        property="foaf:homepage" href="http://devd.me">Devdatta Akhawe</a>, <a
                        property="foaf:workplaceHomepage" class="p-org org h-org h-card"
                        href="https://www.dropbox.com/">Dropbox, Inc.</a>, <span class="ed_mailto"><a
                            class="u-email email" property="foaf:mbox"
                            href="mailto:dev.akhawe@gmail.com">dev.akhawe@gmail.com</a></span>
                </span>
                <span property="rdf:rest" resource="_:editor1"></span>
            </dd>
            <dd class="p-author h-card vcard" resource="_:editor1" data-editor-id="68466"><span property="rdf:first"
                    typeof="foaf:Person">
                    <meta property="foaf:name" content="Frederik Braun"><a class="u-url url p-name fn"
                        property="foaf:homepage" href="https://frederik-braun.com/">Frederik Braun</a>, <a
                        property="foaf:workplaceHomepage" class="p-org org h-org h-card"
                        href="https://www.mozilla.org/">Mozilla</a>, <span class="ed_mailto"><a class="u-email email"
                            property="foaf:mbox" href="mailto:fbraun@mozilla.com">fbraun@mozilla.com</a></span>
                </span>
                <span property="rdf:rest" resource="_:editor2"></span>
            </dd>
            <dd class="p-author h-card vcard" resource="_:editor2" data-editor-id="68466"><span property="rdf:first"
                    typeof="foaf:Person">
                    <meta property="foaf:name" content="François Marier"><a class="u-url url p-name fn"
                        property="foaf:homepage" href="https://fmarier.org">François Marier</a>, <a
                        property="foaf:workplaceHomepage" class="p-org org h-org h-card"
                        href="https://www.mozilla.org/">Mozilla</a>, <span class="ed_mailto"><a class="u-email email"
                            property="foaf:mbox" href="mailto:francois@mozilla.com">francois@mozilla.com</a></span>
                </span>
                <span property="rdf:rest" resource="_:editor3"></span>
            </dd>
            <dd class="p-author h-card vcard" resource="_:editor3" data-editor-id="68466"><span property="rdf:first"
                    typeof="foaf:Person">
                    <meta property="foaf:name" content="Joel Weinberger"><a class="u-url url p-name fn"
                        property="foaf:homepage" href="https://joelweinberger.us/">Joel Weinberger</a>, <a
                        property="foaf:workplaceHomepage" class="p-org org h-org h-card"
                        href="https://google.com/">Google, Inc.</a>, <span class="ed_mailto"><a class="u-email email"
                            property="foaf:mbox" href="mailto:jww@google.com">jww@google.com</a></span>
                </span>
                <span property="rdf:rest" resource="rdf:nil"></span>
            </dd>


            <dt>Participate:</dt>
            <dd>
                <a href="https://github.com/w3c/webappsec-subresource-integrity">
                    We are on Github.
                </a>
            </dd>
            <dd>
                <a href="https://github.com/w3c/webappsec-subresource-integrity/issues">
                    File a bug.
                </a>
            </dd>
            <dd>
                <a href="https://github.com/w3c/webappsec-subresource-integrity/commits/gh-pages">
                    Commit history.
                </a>
            </dd>
            <dd>
                <a href="https://lists.w3.org/Archives/Public/public-webappsec/">
                    Mailing list.
                </a>
            </dd>
        </dl>
        <p>Please note there may be <a href="https://www.w3.org/2016/SRI-errata.html">errata</a> for this document.</p>

        <p>
            The English version of this specification is the only normative version. Non-normative
            <a href="https://www.w3.org/Consortium/Translation/">translations</a> may also be available.
        </p>
        <p class="copyright">
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2014-2016

            <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a
                href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
            <a href="http://www.ercim.eu/"><abbr
                    title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
            <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>).
            <abbr title="World Wide Web Consortium">W3C</abbr> <a
                href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
            <a rel="license" href="https://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules
            apply.
        </p>
        <hr title="Separator for header">
    </div>

    <section property="dc:abstract" class="introductory" id="abstract">
        <h2 resource="#h-abstract" id="h-abstract"><span property="xhv:role" resource="xhv:heading">Abstract</span></h2>
        <p>This specification defines a mechanism by which user agents may verify that a fetched resource has been
            delivered without unexpected manipulation.</p>
    </section>

    <section id="sotd" class="introductory">
        <h2 resource="#h-sotd" id="h-sotd"><span property="xhv:role" resource="xhv:heading">Status of This
                Document</span></h2>
        <p>
            <em>This section describes the status of this document at the time of its publication. Other documents may
                supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr>
                publications and the latest revision of this technical report can be found in the <a
                    href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports
                    index</a> at http://www.w3.org/TR/.</em>
        </p>

        <p>A list of changes to this document may be found at
            <a
                href="https://github.com/w3c/webappsec-subresource-integrity">https://github.com/w3c/webappsec-subresource-integrity</a>.
        </p>

        <p>
            This document was published by the <a href="https://www.w3.org/2011/webappsec/">Web Application Security
                Working Group</a> as a Recommendation. If you wish to make comments regarding this document, please send
            them to
            <a href="mailto:public-webappsec@w3.org?subject=%5BSRI%5D">public-webappsec@w3.org</a> (<a
                href="mailto:public-webappsec-request@w3.org?subject=subscribe">subscribe</a>,
            <a href="http://lists.w3.org/Archives/Public/public-webappsec/">archives</a>) with <code>[SRI]</code> at the
            start of your email's subject. All comments are welcome.
        </p>
        <p>
            Please see the Working Group's <a
                href="https://github.com/w3c/webappsec-subresource-integrity/wiki/Links">implementation
                report</a>.
        </p>
        <p>
            This document has been reviewed by <abbr title="World Wide Web Consortium">W3C</abbr> Members, by software
            developers, and by other <abbr title="World Wide Web Consortium">W3C</abbr> groups and interested parties,
            and is endorsed by the Director as a <abbr title="World Wide Web Consortium">W3C</abbr> Recommendation. It
            is a stable document and may be used as reference material or cited from another document. <abbr
                title="World Wide Web Consortium">W3C</abbr>'s role in making the Recommendation is to draw attention to
            the specification and to promote its widespread deployment. This enhances the functionality and
            interoperability of the Web.
        </p>
        <p>W3C expects the
            functionality specified in this Recommendation will not be
            affected by changes to <a href="https://fetch.spec.whatwg.org/">Fetch</a>. The Working Group will continue
            to track the Fetch
            specification and document issues that impact this specification.</p>
        <p>
            This document was produced by a group operating under the
            <a id="sotd_patent" property="w3p:patentRules"
                href="https://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <abbr
                    title="World Wide Web Consortium">W3C</abbr> Patent
                Policy</a>.
            <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a
                href="https://www.w3.org/2004/01/pp-impl/49309/status" rel="disclosure">public list of any patent
                disclosures</a> made in connection with the deliverables of the group; that page also includes
            instructions for disclosing a patent. An individual who has actual knowledge of a patent which the
            individual believes contains
            <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
                Claim(s)</a> must disclose the information in accordance with
            <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
                6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
        </p>
        <p>This document is governed by the <a id="w3c_process_revision"
                href="https://www.w3.org/2015/Process-20150901/">1 September 2015 <abbr
                    title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
        </p>

    </section>
    <nav id="toc">
        <h2 resource="#table-of-contents" id="table-of-contents" class="introductory"><span property="xhv:role"
                resource="xhv:heading">Table of Contents</span></h2>
        <ul role="directory" class="toc">
            <li class="tocline"><a class="tocxref" href="#introduction"><span class="secno">1. </span>Introduction</a>
                <ul class="toc">
                    <li class="tocline"><a class="tocxref" href="#goals"><span class="secno">1.1 </span>Goals</a></li>
                    <li class="tocline"><a class="tocxref" href="#use-casesexamples"><span class="secno">1.2 </span>Use
                            Cases/Examples</a>
                        <ul class="toc">
                            <li class="tocline"><a class="tocxref" href="#resource-integrity"><span class="secno">1.2.1
                                    </span>Resource Integrity</a></li>
                        </ul>
                    </li>
                </ul>
            </li>
            <li class="tocline"><a class="tocxref" href="#conformance"><span class="secno">2. </span>Conformance</a>
                <ul class="toc">
                    <li class="tocline"><a class="tocxref" href="#key-concepts-and-terminology"><span class="secno">2.1
                            </span>Key Concepts and Terminology</a></li>
                    <li class="tocline"><a class="tocxref" href="#grammatical-concepts"><span class="secno">2.2
                            </span>Grammatical Concepts</a></li>
                </ul>
            </li>
            <li class="tocline"><a class="tocxref" href="#framework"><span class="secno">3. </span>Framework</a>
                <ul class="toc">
                    <li class="tocline"><a class="tocxref" href="#integrity-metadata"><span class="secno">3.1
                            </span>Integrity metadata</a></li>
                    <li class="tocline"><a class="tocxref" href="#cryptographic-hash-functions"><span class="secno">3.2
                            </span>Cryptographic hash functions</a>
                        <ul class="toc">
                            <li class="tocline"><a class="tocxref" href="#agility"><span class="secno">3.2.1
                                    </span>Agility</a></li>
                            <li class="tocline"><a class="tocxref" href="#priority"><span class="secno">3.2.2
                                    </span>Priority</a></li>
                        </ul>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#response-verification-algorithms"><span
                                class="secno">3.3 </span>Response verification algorithms</a>
                        <ul class="toc">
                            <li class="tocline"><a class="tocxref" href="#apply-algorithm-to-response"><span
                                        class="secno">3.3.1 </span>Apply <var>algorithm</var> to <var>response</var></a>
                            </li>
                            <li class="tocline"><a class="tocxref"
                                    href="#is-response-eligible-for-integrity-validation"><span class="secno">3.3.2
                                    </span>Is <var>response</var> eligible for integrity validation</a></li>
                            <li class="tocline"><a class="tocxref" href="#parse-metadata"><span class="secno">3.3.3
                                    </span>Parse <var>metadata</var>.</a></li>
                            <li class="tocline"><a class="tocxref" href="#get-the-strongest-metadata-from-set"><span
                                        class="secno">3.3.4 </span>Get the strongest metadata from <var>set</var>.</a>
                            </li>
                            <li class="tocline"><a class="tocxref" href="#does-response-match-metadatalist"><span
                                        class="secno">3.3.5 </span>Does <var>response</var> match
                                    <var>metadataList</var>?</a></li>
                        </ul>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#verification-of-html-document-subresources"><span
                                class="secno">3.4 </span>Verification of HTML document subresources</a></li>
                    <li class="tocline"><a class="tocxref" href="#the-integrity-attribute"><span class="secno">3.5
                            </span>The <code>integrity</code> attribute</a></li>
                    <li class="tocline"><a class="tocxref" href="#element-interface-extensions"><span class="secno">3.6
                            </span>Element interface extensions</a>
                        <ul class="toc">
                            <li class="tocline"><a class="tocxref" href="#htmllinkelement"><span class="secno">3.6.1
                                    </span>HTMLLinkElement</a>
                                <ul class="toc">
                                    <li class="tocline"><a class="tocxref" href="#attributes"><span
                                                class="secno">3.6.1.1 </span>Attributes</a></li>
                                </ul>
                            </li>
                            <li class="tocline"><a class="tocxref" href="#htmlscriptelement"><span class="secno">3.6.2
                                    </span>HTMLScriptElement</a>
                                <ul class="toc">
                                    <li class="tocline"><a class="tocxref" href="#attributes-1"><span
                                                class="secno">3.6.2.1 </span>Attributes</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#handling-integrity-violations"><span class="secno">3.7
                            </span>Handling integrity violations</a></li>
                    <li class="tocline"><a class="tocxref" href="#elements"><span class="secno">3.8 </span>Elements</a>
                        <ul class="toc">
                            <li class="tocline"><a class="tocxref" href="#the-link-element-for-stylesheets"><span
                                        class="secno">3.8.1 </span>The <code>link</code> element for stylesheets</a>
                            </li>
                            <li class="tocline"><a class="tocxref" href="#the-script-element"><span class="secno">3.8.2
                                    </span>The <code>script</code> element</a></li>
                        </ul>
                    </li>
                </ul>
            </li>
            <li class="tocline"><a class="tocxref" href="#proxies"><span class="secno">4. </span>Proxies</a></li>
            <li class="tocline"><a class="tocxref" href="#security-considerations"><span class="secno">5.
                    </span>Security Considerations</a>
                <ul class="toc">
                    <li class="tocline"><a class="tocxref" href="#non-secure-contexts-remain-non-secure"><span
                                class="secno">5.1 </span>Non-secure contexts remain non-secure</a></li>
                    <li class="tocline"><a class="tocxref" href="#hash-collision-attacks"><span class="secno">5.2
                            </span>Hash collision attacks</a></li>
                    <li class="tocline"><a class="tocxref" href="#cross-origin-data-leakage"><span class="secno">5.3
                            </span>Cross-origin data leakage</a></li>
                </ul>
            </li>
            <li class="tocline"><a class="tocxref" href="#acknowledgements"><span class="secno">6.
                    </span>Acknowledgements</a></li>
            <li class="tocline"><a class="tocxref" href="#references"><span class="secno">A. </span>References</a>
                <ul class="toc">
                    <li class="tocline"><a class="tocxref" href="#normative-references"><span class="secno">A.1
                            </span>Normative references</a></li>
                </ul>
            </li>
        </ul>
    </nav>



    <section property="bibo:hasPart" resource="#introduction" typeof="bibo:Chapter" class="informative">
        <!--OddPage-->
        <h2 resource="#introduction" id="introduction"><span property="xhv:role" resource="xhv:heading"><span
                    class="secno">1. </span>Introduction</span></h2>
        <p><em>This section is non-normative.</em></p>

        <p>Sites and applications on the web are rarely composed of resources from only a single origin. For example,
            authors pull scripts and styles from a wide variety of services and content delivery networks, and must
            trust that the delivered representation is, in fact, what they expected to load. If an attacker can trick a
            user into downloading content from a hostile server (via <a
                href="https://www.ietf.org/rfc/rfc1035.txt">DNS</a> poisoning, or other such means), the author has no
            recourse. Likewise, an attacker who can replace the file on the Content Delivery Network (CDN) server has
            the ability to inject arbitrary content.</p>

        <p>Delivering resources over a secure channel mitigates some of this risk: with
            <a href="https://tools.ietf.org/html/rfc5246">TLS</a>, <a
                href="https://tools.ietf.org/html/rfc6797">HSTS</a>, and <a
                href="https://tools.ietf.org/html/rfc7469">pinned public keys</a>, a user agent can be fairly certain
            that it is indeed speaking with the server it believes it’s talking to. These mechanisms, however,
            authenticate <em>only</em> the server, <em>not</em> the content. An attacker (or administrator) with access
            to the server can manipulate content with impunity. Ideally, authors would not only be able to pin the keys
            of a server, but also pin the <em>content</em>, ensuring that an exact representation of a resource, and
            <em>only</em> that representation, loads and executes.
        </p>

        <p>This document specifies such a validation scheme, extending two HTML elements with an <code>integrity</code>
            attribute that contains a cryptographic hash of the representation of the resource the author expects to
            load. For instance, an author may wish to load some framework from a shared server rather than hosting it on
            their own origin. Specifying that the <em>expected</em> SHA-384 hash of
            <code>https://example.com/example-framework.js</code> is
            <code>Li9vy3DqF8tnTXuiaAJuML3ky+er10rcgNR/VqsVpcw+ThHmYcwiB1pbOxEbzJr7</code> means that the user agent can
            verify that the data it loads from that URL matches that expected hash before executing the JavaScript it
            contains. This integrity verification significantly reduces the risk that an attacker can substitute
            malicious content.
        </p>

        <p>This example can be communicated to a user agent by adding the hash to a
            <code>script</code> element, like so:
        </p>

        <div class="example">
            <div class="example-title marker"><span>Example 1</span></div>
            <pre class="hljs xml"><code><span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"https://example.com/example-framework.js"</span>
        <span class="hljs-attribute">integrity</span>=<span class="hljs-value">"sha384-Li9vy3DqF8tnTXuiaAJuML3ky+er10rcgNR/VqsVpcw+ThHmYcwiB1pbOxEbzJr7"</span>
        <span class="hljs-attribute">crossorigin</span>=<span class="hljs-value">"anonymous"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
</code></pre>
        </div>

        <p>Scripts, of course, are not the only response type which would benefit from integrity validation. The scheme
            specified here also applies to <code>link</code> and future versions of this specification are likely to
            expand this coverage.</p>

        <section property="bibo:hasPart" resource="#goals" typeof="bibo:Chapter">
            <h3 resource="#goals" id="goals"><span property="xhv:role" resource="xhv:heading"><span class="secno">1.1
                    </span>Goals</span></h3>

            <ol>
                <li>
                    <p>Compromise of a third-party service should not automatically mean compromise of every site which
                        includes its scripts. Content authors will have a mechanism by which they can specify
                        expectations for content they load, meaning for example that they could load a
                        <em>specific</em> script, and not <em>any</em> script that happens to have a particular URL.
                    </p>
                </li>
                <li>
                    <p>The verification mechanism should have error-reporting functionality which would inform the
                        author that an invalid response was received.</p>
                </li>
            </ol>

        </section>
        <!-- /Introduction::Goals -->

        <section property="bibo:hasPart" resource="#use-casesexamples" typeof="bibo:Chapter">
            <h3 resource="#use-casesexamples" id="use-casesexamples"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">1.2 </span>Use Cases/Examples</span></h3>

            <section property="bibo:hasPart" resource="#resource-integrity" typeof="bibo:Chapter">
                <h4 resource="#resource-integrity" id="resource-integrity"><span property="xhv:role"
                        resource="xhv:heading"><span class="secno">1.2.1 </span>Resource Integrity</span></h4>

                <ul>
                    <li>
                        <p>An author wishes to use a content delivery network to improve performance for
                            globally-distributed users. It is important, however, to ensure that the CDN’s servers
                            deliver <em>only</em> the code the author expects them to deliver. To mitigate the risk that
                            a CDN compromise (or unexpectedly malicious behavior) would change that site in unfortunate
                            ways, the following
                            <a href="#dfn-integrity-metadata">integrity metadata</a> is added to the <code>link</code>
                            element included on the page:
                        </p>

                        <div class="example">
                            <div class="example-title marker"><span>Example 2</span></div>
                            <pre class="hljs xml"><code><span class="hljs-tag">&lt;<span class="hljs-title">link</span> <span class="hljs-attribute">rel</span>=<span class="hljs-value">"stylesheet"</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"https://site53.example.net/style.css"</span>
      <span class="hljs-attribute">integrity</span>=<span class="hljs-value">"sha384-+/M6kredJcxdsqkczBUjMLvqyHb1K/JThDXWsBVxMEeZHEaMKEOEct339VItX1zB"</span>
      <span class="hljs-attribute">crossorigin</span>=<span class="hljs-value">"anonymous"</span>&gt;</span>
</code></pre>
                        </div>
                    </li>
                    <li>
                        <p>An author wants to include JavaScript provided by a third-party analytics service. To ensure
                            that only the code that has been carefully reviewed is executed, the author generates <a
                                href="#dfn-integrity-metadata">integrity metadata</a> for the script, and adds it to the
                            <code>script</code> element:</p>

                        <div class="example">
                            <div class="example-title marker"><span>Example 3</span></div>
                            <pre class="hljs xml"><code><span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"https://analytics-r-us.example.com/v1.0/include.js"</span>
        <span class="hljs-attribute">integrity</span>=<span class="hljs-value">"sha384-MBO5IDfYaE6c6Aao94oZrIOiC6CGiSN2n4QUbHNPhzk5Xhm0djZLQqTpL0HzTUxk"</span>
        <span class="hljs-attribute">crossorigin</span>=<span class="hljs-value">"anonymous"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
</code></pre>
                        </div>
                    </li>
                    <li>
                        <p>A user agent wishes to ensure that JavaScript code running in high-privilege HTML contexts
                            (for example, a browser’s New Tab page) aren’t manipulated before display.
                            <a href="#dfn-integrity-metadata">Integrity metadata</a> mitigates the risk that altered
                            JavaScript will run in these pages’ high-privilege contexts.
                        </p>
                    </li>
                </ul>
            </section>
            <!-- Introduction::UseCases::Integrity -->
        </section>
        <!-- /Introduction::Use Cases -->
    </section>
    <!-- /Introduction -->

    <section property="bibo:hasPart" resource="#conformance" typeof="bibo:Chapter" id="conformance">
        <!--OddPage-->
        <h2 resource="#h-conformance" id="h-conformance"><span property="xhv:role" resource="xhv:heading"><span
                    class="secno">2. </span>Conformance</span></h2>
        <p>
            As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this
            specification are non-normative. Everything else in this specification is normative.
        </p>
        <p id="respecRFC2119">The key words <em class="rfc2119" title="MAY">MAY</em>, <em class="rfc2119"
                title="MUST">MUST</em>, and <em class="rfc2119" title="SHOULD">SHOULD</em> are to be interpreted as
            described in [<cite><a href="#bib-RFC2119" class="bibref">RFC2119</a></cite>].
        </p>

        <p>Conformance requirements phrased as algorithms or specific steps can be implemented in any manner, so long as
            the end result is equivalent. In particular, the algorithms defined in this specification are intended to be
            easy to understand and are not intended to be performant. Implementers are encouraged to optimize.</p>

        <section property="bibo:hasPart" resource="#key-concepts-and-terminology" typeof="bibo:Chapter">
            <h3 resource="#key-concepts-and-terminology" id="key-concepts-and-terminology"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">2.1 </span>Key Concepts and Terminology</span></h3>

            <p>This section defines several terms used throughout the document.</p>

            <p>The term <dfn id="dfn-digest" data-dfn-type="dfn">digest</dfn> refers to the base64-encoded result of
                executing a cryptographic hash function on an arbitrary block of data.</p>

            <p>The term <dfn id="dfn-origin" data-dfn-type="dfn">origin</dfn> is defined in the Origin specification. [
                <cite><a href="#bib-RFC6454" class="bibref">RFC6454</a></cite>]
            </p>

            <p>The <dfn id="dfn-representation-data" data-dfn-type="dfn">representation data</dfn> and <dfn
                    id="dfn-content-encoding" data-dfn-type="dfn">content encoding</dfn> of a resource are defined by <a
                    href="https://tools.ietf.org/html/rfc7231#section-3">RFC7231, section 3</a>. [<cite><a
                        href="#bib-RFC7231" class="bibref">RFC7231</a></cite>]</p>

            <p>A <dfn id="dfn-base64-encoding" data-dfn-type="dfn">base64 encoding</dfn> is defined in <a
                    href="https://tools.ietf.org/html/rfc4648#section-4">RFC 4648, section 4</a>. [
                <cite><a href="#bib-RFC4648" class="bibref">RFC4648</a></cite>]
            </p>

            <p>The <dfn id="dfn-sha-256" data-dfn-type="dfn">SHA-256</dfn>, <dfn id="dfn-sha-384"
                    data-dfn-type="dfn">SHA-384</dfn>, and <dfn id="dfn-sha-512" data-dfn-type="dfn">SHA-512</dfn> are
                part of the <dfn id="dfn-sha-2" data-dfn-type="dfn">SHA-2</dfn> set of cryptographic hash functions
                defined by the NIST in <a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf">“FIPS
                    PUB 180-4: Secure Hash Standard (SHS)”</a>.</p>

        </section>

        <section property="bibo:hasPart" resource="#grammatical-concepts" typeof="bibo:Chapter">
            <h3 resource="#grammatical-concepts" id="grammatical-concepts"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">2.2 </span>Grammatical Concepts</span></h3>

            <p>The Augmented Backus-Naur Form (ABNF) notation used in this document is specified in RFC5234. [<cite><a
                        href="#bib-ABNF" class="bibref">ABNF</a></cite>]</p>

            <p><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">Appendix B.1</a> of [<cite><a href="#bib-ABNF"
                        class="bibref">ABNF</a></cite>] defines
                <code><dfn id="dfn-vchar" data-dfn-type="dfn">VCHAR</dfn></code> (printing characters).</p>

            <p><code><dfn id="dfn-wsp" data-dfn-type="dfn">WSP</dfn></code> (white space) characters are defined in
                Section
                <a href="https://www.w3.org/TR/html5/infrastructure.html#space-character">2.4.1 Common parser idioms</a>
                of the HTML 5 specification as
                <code>White_Space characters</code>.
            </p>

        </section>

    </section>

    <section property="bibo:hasPart" resource="#framework" typeof="bibo:Chapter">
        <!--OddPage-->
        <h2 resource="#framework" id="framework"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.
                </span>Framework</span></h2>

        <p>The integrity verification mechanism specified here boils down to the process of generating a sufficiently
            strong cryptographic digest for a resource, and transmitting that digest to a user agent so that it may be
            used to verify the response.</p>

        <section property="bibo:hasPart" resource="#integrity-metadata" typeof="bibo:Chapter">
            <h3 resource="#integrity-metadata" id="integrity-metadata"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">3.1 </span>Integrity metadata</span></h3>

            <p>To verify the integrity of a response, a user agent requires <dfn id="dfn-integrity-metadata"
                    data-dfn-type="dfn">integrity
                    metadata</dfn> as part of the <a
                    href="https://fetch.spec.whatwg.org/#concept-request-integrity-metadata">request</a>. This metadata
                consists of the following pieces of information:</p>

            <ul>
                <li>cryptographic hash function (“alg”)</li>
                <li><a href="#dfn-digest">digest</a> (“val”)</li>
                <li>options (“opt”)</li>
            </ul>

            <p>The hash function and digest <em title="MUST" class="rfc2119">MUST</em> be provided in order to validate
                a response’s integrity.</p>

            <div class="note">
                <div id="h-note1" role="heading" aria-level="4" class="note-title marker"><span>Note</span></div>
                <p class="">At the moment, no options are defined. However, future versions of the spec may define
                    options, such as MIME types [<cite><a href="#bib-MIMETYPE" class="bibref">MIMETYPE</a></cite>].</p>
            </div>

            <p>This metadata <em title="MUST" class="rfc2119">MUST</em> be encoded in the same format as the
                <code>hash-source</code> (without the single quotes) in <a
                    href="https://www.w3.org/TR/CSP2/#source-list-syntax">section 4.2 of the Content Security Policy
                    Level 2 specification</a>.</p>

            <p>For example, given a script resource containing only the string <code>alert(\'Hello, world.\');</code>,
                an author might choose <a href="#dfn-sha-2">SHA-384</a> as a hash function.
                <code>H8BRh8j48O9oYatfu5AZzq6A9RINhZO5H16dQZngK7T62em8MUt1FLm52t+eX6xO</code> is the base64-encoded
                digest that results. This can be encoded as follows:
            </p>

            <div class="example">
                <div class="example-title marker"><span>Example 4</span></div>
                <pre class="hljs gcode"><code>sha<span class="hljs-number">384</span>-H<span class="hljs-number">8</span>BRh<span class="hljs-number">8</span>j<span class="hljs-number">48</span><span class="hljs-preprocessor">O9</span>oYatfu<span class="hljs-number">5</span>AZzq<span class="hljs-number">6</span>A<span class="hljs-number">9</span>RI<span class="hljs-label">NhZO5</span>H<span class="hljs-number">16</span>dQZ<span class="hljs-label">ngK7</span>T<span class="hljs-number">62</span>e<span class="hljs-title">m8</span>MUt<span class="hljs-number">1</span>FL<span class="hljs-title">m52</span>t+eX<span class="hljs-number">6</span>xO
</code></pre>
            </div>

            <div class="note">
                <div id="h-note2" role="heading" aria-level="4" class="note-title marker"><span>Note</span></div>
                <div class="">
                    <p>Digests may be generated using any number of utilities. <a
                            href="https://www.openssl.org/">OpenSSL</a>, for example, is quite commonly available. The
                        example in this section is the result of the following command line:</p>

                    <pre class="hljs gherkin"><code>echo -n <span class="hljs-string">"alert('Hello, world.');"</span> |<span class="hljs-string"> openssl dgst -sha384 -binary </span>|<span class="hljs-string"> openssl base64 -A
</span></code></pre>
                </div>
            </div>

        </section>
        <!-- /Framework::Required metadata -->

        <section property="bibo:hasPart" resource="#cryptographic-hash-functions" typeof="bibo:Chapter">
            <h3 resource="#cryptographic-hash-functions" id="cryptographic-hash-functions"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">3.2 </span>Cryptographic hash functions</span></h3>

            <p>Conformant user agents <em title="MUST" class="rfc2119">MUST</em> support the <a
                    href="#dfn-sha-2">SHA-256</a>, <a href="#dfn-sha-2">SHA-384</a> and <a href="#dfn-sha-2">SHA-512</a>
                cryptographic hash functions for use as part of a request’s <a href="#dfn-integrity-metadata">integrity
                    metadata</a> and <em title="MAY" class="rfc2119">MAY</em> support additional hash functions.</p>

            <p>User agents <em title="SHOULD" class="rfc2119">SHOULD</em> refuse to support known-weak hashing functions
                like MD5 or SHA-1 and <em title="SHOULD" class="rfc2119">SHOULD</em> restrict supported hashing
                functions to those known to be collision-resistant. Additionally, user agents <em title="SHOULD"
                    class="rfc2119">SHOULD</em> re-evaluate their supported hash functions on a regular basis and
                deprecate support for those functions that have become insecure. See <a
                    href="#hash-collision-attacks">Hash collision attacks</a>.</p>

            <section property="bibo:hasPart" resource="#agility" typeof="bibo:Chapter">
                <h4 resource="#agility" id="agility"><span property="xhv:role" resource="xhv:heading"><span
                            class="secno">3.2.1 </span>Agility</span></h4>

                <p>Multiple sets of <a href="#dfn-integrity-metadata">integrity metadata</a> may be associated with a
                    single resource in order to provide agility in the face of future cryptographic discoveries. For
                    example, the resource described in the previous section may be described by either of the following
                    hash expressions:</p>

                <div class="example">
                    <div class="example-title marker"><span>Example 5</span></div>
                    <pre class="hljs gcode"><code>sha<span class="hljs-number">384</span>-dOTZf<span class="hljs-number">16</span>X<span class="hljs-number">8</span>p<span class="hljs-number">34</span>q<span class="hljs-number">2</span>/kYyEF<span class="hljs-title">m0</span>jh<span class="hljs-number">89</span>uTjikh<span class="hljs-label">nzjeLeF0</span>FHsEaYKb<span class="hljs-number">1</span>A<span class="hljs-number">1</span>cv+Lyv<span class="hljs-number">4</span>Hk<span class="hljs-number">8</span>vHd
sha<span class="hljs-number">512</span>-Q<span class="hljs-number">2</span>bFTOhEALk<span class="hljs-label">N8</span>hOms<span class="hljs-number">2</span>FKTDLy<span class="hljs-number">7</span>eugP<span class="hljs-number">2</span>zFZ<span class="hljs-number">1</span>T<span class="hljs-number">8</span>LCvX<span class="hljs-number">42</span>Fp<span class="hljs-number">3</span>Wo<span class="hljs-label">Nr3</span>bjZSAHeOsHrbV<span class="hljs-number">1</span>Fu<span class="hljs-number">9</span>/A<span class="hljs-number">0</span>EzCi<span class="hljs-label">nRE7</span>Af<span class="hljs-number">1</span>ofPrw==
</code></pre>
                </div>

                <p>Authors may choose to specify both, for example:</p>

                <div class="example">
                    <div class="example-title marker"><span>Example 6</span></div>
                    <pre class="hljs xml"><code><span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"hello_world.js"</span>
   <span class="hljs-attribute">integrity</span>=<span class="hljs-value">"sha384-dOTZf16X8p34q2/kYyEFm0jh89uTjikhnzjeLeF0FHsEaYKb1A1cv+Lyv4Hk8vHd
              sha512-Q2bFTOhEALkN8hOms2FKTDLy7eugP2zFZ1T8LCvX42Fp3WoNr3bjZSAHeOsHrbV1Fu9/A0EzCinRE7Af1ofPrw=="</span>
   <span class="hljs-attribute">crossorigin</span>=<span class="hljs-value">"anonymous"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
</code></pre>
                </div>

                <p>In this case, the user agent will choose the strongest hash function in the list, and use that
                    metadata to validate the response (as described below in the “<a href="#parse-metadata">parse
                        metadata</a>” and “<a href="#get-the-strongest-metadata-from-set">get the strongest metadata
                        from
                        set</a>” algorithms).</p>

                <p>When a hash function is determined to be insecure, user agents <em title="SHOULD"
                        class="rfc2119">SHOULD</em> deprecate and eventually remove support for integrity validation
                    using the insecure hash function. User agents <em title="MAY" class="rfc2119">MAY</em> check the
                    validity of responses using a digest based on a deprecated function.</p>

                <p>To allow authors to switch to stronger hash functions without being held back by older user agents,
                    validation using unsupported hash functions acts like no integrity value was provided (see the “<a
                        href="#does-response-match-metadatalist">Does response match metadataList</a>” algorithm below).
                    Authors are encouraged to use strong hash functions, and to begin migrating to stronger hash
                    functions as they become available.</p>
            </section>
            <!-- /Framework::Cryptographic hash functions::Agility -->

            <section property="bibo:hasPart" resource="#priority" typeof="bibo:Chapter">
                <h4 resource="#priority" id="priority"><span property="xhv:role" resource="xhv:heading"><span
                            class="secno">3.2.2 </span>Priority</span></h4>

                <p>User agents must provide a mechanism for determining the relative priority of two hash functions and
                    return the empty string if the priority is equal. That is, if a user agent implemented a function
                    like <dfn id="dfn-getprioritizedhashfunction-a-b" data-dfn-type="dfn">getPrioritizedHashFunction(a,
                        b)</dfn> it would return the hash function the user agent considers the most
                    collision-resistant. For example, <code>getPrioritizedHashFunction('sha256',
'sha512')</code> would return <code>'sha512'</code> and <code>getPrioritizedHashFunction('sha256',
'sha256')</code> would return the empty string.</p>

                <div class="note">
                    <div id="h-note3" role="heading" aria-level="5" class="note-title marker"><span>Note</span></div>
                    <p class="">The <dfn id="dfn-getprioritizedhashfunction"
                            data-dfn-type="dfn">getPrioritizedHashFunction</dfn> is an internal implementation detail.
                        It is not an API that implementors provide to web applications. It is used in this document only
                        to simplify the algorithm description.</p>
                </div>

            </section>
            <!-- /Framework::Cryptographic hash functions::Priority -->

        </section>
        <!-- /Framework::Cryptographic hash functions -->

        <section property="bibo:hasPart" resource="#response-verification-algorithms" typeof="bibo:Chapter">
            <h3 resource="#response-verification-algorithms" id="response-verification-algorithms"><span
                    property="xhv:role" resource="xhv:heading"><span class="secno">3.3 </span>Response verification
                    algorithms</span></h3>

            <section property="bibo:hasPart" resource="#apply-algorithm-to-response" typeof="bibo:Chapter">
                <h4 resource="#apply-algorithm-to-response" id="apply-algorithm-to-response"><span property="xhv:role"
                        resource="xhv:heading"><span class="secno">3.3.1 </span>Apply <var>algorithm</var> to
                        <var>response</var></span></h4>

                <ol>
                    <li>Let <var>result</var> be the result of <a href="#apply-algorithm-to-response">applying
                            <var>algorithm</var></a> to the <a
                            href="https://tools.ietf.org/html/rfc7231#section-3">representation data</a> without any
                        content-codings applied, except when the user agent intends to consume the content with
                        content-encodings applied. In the latter case, let <var>result</var> be the result of applying
                        <var>algorithm</var> to the <a
                            href="https://tools.ietf.org/html/rfc7231#section-3">representation data</a>.</li>
                    <li>Let <var>encodedResult</var> be result of base64-encoding
                        <var>result</var>.
                    </li>
                    <li>Return <var>encodedResult</var>.</li>
                </ol>
            </section>
            <!-- Algorithms::apply -->

            <section property="bibo:hasPart" resource="#is-response-eligible-for-integrity-validation"
                typeof="bibo:Chapter">
                <h4 resource="#is-response-eligible-for-integrity-validation"
                    id="is-response-eligible-for-integrity-validation"><span property="xhv:role"
                        resource="xhv:heading"><span class="secno">3.3.2 </span>Is <var>response</var> eligible for
                        integrity validation</span></h4>

                <p>In order to mitigate an attacker’s ability to read data cross-origin by brute-forcing values via
                    integrity checks, responses are only eligible for such checks if they are same-origin or are the
                    result of explicit access granted to the loading origin via Cross Origin Resource Sharing [<cite><a
                            href="#bib-CORS" class="bibref">CORS</a></cite>].</p>

                <div class="note">
                    <div id="h-note4" role="heading" aria-level="5" class="note-title marker"><span>Note</span></div>
                    <p class="">As noted in <a href="https://tools.ietf.org/html/rfc6454#section-4">RFC6454, section
                            4</a>, some user agents use globally unique identifiers for each file URI. This means that
                        resources accessed over a <code>file</code> scheme URL are unlikely to be eligible for integrity
                        checks.</p>
                </div>

                <div class="note">
                    <div id="h-note5" role="heading" aria-level="5" class="note-title marker"><span>Note</span></div>
                    <p class="">Being in a <a href="https://w3c.github.io/webappsec-secure-contexts/">Secure Context</a>
                        (e.g., a document delivered over HTTPS) is not necessary for the use of integrity validation.
                        Because resource integrity is only an application level security tool, and it does not change
                        the security state of the user agent, a Secure Context is unnecessary. However, if integrity is
                        used in something other than a Secure Context (e.g., a document delivered over HTTP), authors
                        should be aware that the integrity provides <em>no security
                            guarantees at all</em>. For this reason, authors should only deliver integrity metadata in a
                        Secure Context. See <a href="#non-secure-contexts-remain-non-secure">Non-secure contexts remain
                            non-secure</a> for more discussion.</p>
                </div>

                <p>The following algorithm details these restrictions:</p>

                <ol>
                    <li>Let <var>response</var> be the response that results from
                        <a href="https://fetch.spec.whatwg.org/#concept-fetch">fetching</a> the <var>resource</var>.
                    </li>
                    <li>If the <var>response</var> <a
                            href="https://fetch.spec.whatwg.org/#concept-response-type">type</a> is <code>basic</code>,
                        <code>cors</code> or <code>default</code>, return <code>true</code>.
                    </li>
                    <li>Return <code>false</code>.</li>
                </ol>

                <div class="note">
                    <div id="h-note6" role="heading" aria-level="5" class="note-title marker"><span>Note</span></div>
                    <div class="">
                        <p>The <a href="https://fetch.spec.whatwg.org/#concept-response-type">response types</a> are
                            defined by the Fetch specification [<cite><a href="#bib-FETCH"
                                    class="bibref">FETCH</a></cite>] and refer to the following:</p>

                        <ul>
                            <li><code>basic</code> is a same-origin response, and thus the requestor has full access to
                                read the body.</li>
                            <li><code>cors</code> is a valid response to a cross-origin, CORS-enabled request, and thus
                                again the requestor has full access to read the body.</li>
                            <li><code>default</code> is a valid response that is generated by a Service Worker as a
                                response to the request, so its body, too, is fully readable by the requestor.</li>
                        </ul>
                    </div>
                </div>

            </section>
            <!-- Algorithms::eligible -->

            <section property="bibo:hasPart" resource="#parse-metadata" typeof="bibo:Chapter">
                <h4 resource="#parse-metadata" id="parse-metadata"><span property="xhv:role"
                        resource="xhv:heading"><span class="secno">3.3.3 </span>Parse <var>metadata</var>.</span></h4>

                <p>This algorithm accepts a string, and returns either <code>no metadata</code>, or a set of valid hash
                    expressions whose hash functions are understood by the user agent.</p>

                <ol>
                    <li>Let <var>result</var> be the empty set.</li>
                    <li>Let <var>empty</var> be equal to <code>true</code>.</li>
                    <li>For each <var>token</var> returned by <a
                            href="https://www.w3.org/TR/html5/infrastructure.html#split-a-string-on-spaces">splitting
                            <var>metadata</var> on
                            spaces</a>:
                        <ol>
                            <li>Set <var>empty</var> to <code>false</code>.</li>
                            <li>If <var>token</var> is not a valid metadata, skip the remaining steps, and proceed to
                                the next token.</li>
                            <li>Parse <var>token</var> per the grammar in <a href="#dfn-integrity-metadata">integrity
                                    metadata</a>.</li>
                            <li>Let <var>algorithm</var> be the <var>alg</var> component of
                                <var>token</var>.
                            </li>
                            <li>If <var>algorithm</var> is a hash function recognized by the user agent, add the parsed
                                <var>token</var> to <var>result</var>.</li>
                        </ol>
                    </li>
                    <li>Return <code>no metadata</code> if <var>empty</var> is <code>true</code>, otherwise return
                        <var>result</var>.
                    </li>
                </ol>

            </section>
            <!-- Algorithms::parse -->

            <section property="bibo:hasPart" resource="#get-the-strongest-metadata-from-set" typeof="bibo:Chapter">
                <h4 resource="#get-the-strongest-metadata-from-set" id="get-the-strongest-metadata-from-set"><span
                        property="xhv:role" resource="xhv:heading"><span class="secno">3.3.4 </span>Get the strongest
                        metadata from <var>set</var>.</span></h4>

                <ol>
                    <li>Let <var>result</var> be the empty set and <var>strongest</var> be the empty string.
                    </li>
                    <li>For each <var>item</var> in <var>set</var>:
                        <ol>
                            <li>If <var>result</var> is the empty set, add <var>item</var> to
                                <var>result</var> and set <var>strongest</var> to <var>item</var>, skip to the next
                                <var>item</var>.
                            </li>
                            <li>Let <var>currentAlgorithm</var> be the <var>alg</var> component of
                                <var>strongest</var>.
                            </li>
                            <li>Let <var>newAlgorithm</var> be the <var>alg</var> component of
                                <var>item</var>.
                            </li>
                            <li>If the result of <a
                                    href="#dfn-getprioritizedhashfunction-a-b"><code>getPrioritizedHashFunction(currentAlgorithm, newAlgorithm)</code></a>
                                is the empty string, add <var>item</var> to <var>result</var>. If the result is
                                <var>newAlgorithm</var>, set <var>strongest</var> to
                                <var>item</var>, set <var>result</var> to the empty set, and add
                                <var>item</var> to <var>result</var>.
                            </li>
                        </ol>
                    </li>
                    <li>Return <var>result</var>.</li>
                </ol>

            </section>
            <!-- /Algorithms::get the strongest metadata -->

            <section property="bibo:hasPart" resource="#does-response-match-metadatalist" typeof="bibo:Chapter">
                <h4 resource="#does-response-match-metadatalist" id="does-response-match-metadatalist"><span
                        property="xhv:role" resource="xhv:heading"><span class="secno">3.3.5 </span>Does
                        <var>response</var> match <var>metadataList</var>?</span></h4>

                <ol>
                    <li>Let <var>parsedMetadata</var> be the result of
                        <a href="#parse-metadata">parsing <var>metadataList</var></a>.
                    </li>
                    <li>If <var>parsedMetadata</var> is <code>no metadata</code>, return <code>true</code>.</li>
                    <li>If <a href="#is-response-eligible-for-integrity-validation"><var>response</var> is not eligible
                            for integrity
                            validation</a>, return <code>false</code>.</li>
                    <li>If <var>parsedMetadata</var> is the empty set, return <code>true</code>.</li>
                    <li>Let <var>metadata</var> be the result of <a href="#get-the-strongest-metadata-from-set">getting
                            the strongest
                            metadata from <var>parsedMetadata</var></a>.</li>
                    <li>For each <var>item</var> in <var>metadata</var>:
                        <ol>
                            <li>Let <var>algorithm</var> be the <var>alg</var> component of
                                <var>item</var>.
                            </li>
                            <li>Let <var>expectedValue</var> be the <var>val</var> component of
                                <var>item</var>.
                            </li>
                            <li>Let <var>actualValue</var> be the result of <a
                                    href="#apply-algorithm-to-response">applying
                                    <var>algorithm</var> to <var>response</var></a>.</li>
                            <li>If <var>actualValue</var> is a case-sensitive match for
                                <var>expectedValue</var>, return <code>true</code>.
                            </li>
                        </ol>
                    </li>
                    <li>Return <code>false</code>.</li>
                </ol>

                <p>This algorithm allows the user agent to accept multiple, valid strong hash functions. For example, a
                    developer might write a <code>script</code> element such as:</p>

                <div class="example">
                    <div class="example-title marker"><span>Example 7</span></div>
                    <pre class="hljs xml"><code><span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"https://example.com/example-framework.js"</span>
        <span class="hljs-attribute">integrity</span>=<span class="hljs-value">"sha384-Li9vy3DqF8tnTXuiaAJuML3ky+er10rcgNR/VqsVpcw+ThHmYcwiB1pbOxEbzJr7
                   sha384-+/M6kredJcxdsqkczBUjMLvqyHb1K/JThDXWsBVxMEeZHEaMKEOEct339VItX1zB"</span>
        <span class="hljs-attribute">crossorigin</span>=<span class="hljs-value">"anonymous"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
</code></pre>
                </div>

                <p>which would allow the user agent to accept two different content payloads, one of which matches the
                    first SHA384 hash value and the other matches the second SHA384 hash value.</p>

                <div class="note">
                    <div id="h-note7" role="heading" aria-level="5" class="note-title marker"><span>Note</span></div>
                    <p class="">User agents may allow users to modify the result of this algorithm via user preferences,
                        bookmarklets, third-party additions to the user agent, and other such mechanisms. For example,
                        redirects generated by an extension like
                        <a href="https://www.eff.org/https-everywhere">HTTPS Everywhere</a> could load and execute
                        correctly, even if the HTTPS version of a resource differs from the HTTP version.
                    </p>
                </div>

                <div class="note">
                    <div id="h-note8" role="heading" aria-level="5" class="note-title marker"><span>Note</span></div>
                    <p class="">This algorithm returns <code>false</code> if the response is not <a
                            href="#is-response-eligible-for-integrity-validation">eligible</a> for integrity validation
                        since Subresource Integrity requires CORS, and it is a logical error to attempt to use it
                        without CORS. Additionally, user agents <em title="SHOULD" class="rfc2119">SHOULD</em> report a
                        warning message to the developer console to explain this failure.</p>
                </div>
            </section>
            <!-- Algorithms::Match -->
        </section>
        <!-- Algorithms -->

        <section property="bibo:hasPart" resource="#verification-of-html-document-subresources" typeof="bibo:Chapter">
            <h3 resource="#verification-of-html-document-subresources" id="verification-of-html-document-subresources">
                <span property="xhv:role" resource="xhv:heading"><span class="secno">3.4 </span>Verification of HTML
                    document subresources</span></h3>

            <p>A variety of HTML elements result in requests for resources that are to be embedded into the document, or
                executed in its context. To support integrity metadata for some of these elements, a new
                <code>integrity</code> attribute is added to the list of content attributes for the <code>link</code>
                and <code>script</code> elements.</p>

            <p>A corresponding <code>integrity</code> IDL attribute which <a
                    href="https://www.w3.org/TR/html5/infrastructure.html#reflect">reflects</a> the value each element’s
                <code>integrity</code> content attribute is added to the
                <code>HTMLLinkElement</code> and <code>HTMLScriptElement</code> interfaces.
            </p>

            <div class="note">
                <div id="h-note9" role="heading" aria-level="4" class="note-title marker"><span>Note</span></div>
                <p class="">A future revision of this specification is likely to include integrity support for all
                    possible subresources, i.e., <code>a</code>, <code>audio</code>, <code>embed</code>,
                    <code>iframe</code>, <code>img</code>,
                    <code>link</code>, <code>object</code>, <code>script</code>, <code>source</code>,
                    <code>track</code>, and <code>video</code> elements.
                </p>
            </div>

        </section>

        <section property="bibo:hasPart" resource="#the-integrity-attribute" typeof="bibo:Chapter">
            <h3 resource="#the-integrity-attribute" id="the-integrity-attribute"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">3.5 </span>The <code>integrity</code> attribute</span>
            </h3>

            <p>The <code>integrity</code> attribute represents <a href="#dfn-integrity-metadata">integrity metadata</a>
                for an element. The value of the attribute <em title="MUST" class="rfc2119">MUST</em> be either the
                empty string, or at least one valid metadata as described by the following ABNF grammar:</p>

            <pre class="hljs gherkin"><code>integrity-metadata = <span class="hljs-keyword">*</span>WSP hash-with-options <span class="hljs-keyword">*</span>( 1<span class="hljs-keyword">*</span>WSP hash-with-options ) <span class="hljs-keyword">*</span>WSP / <span class="hljs-keyword">*</span>WSP
hash-with-options  = hash-expression <span class="hljs-keyword">*</span>(<span class="hljs-string">"?"</span> option-expression)
option-expression  = <span class="hljs-keyword">*</span>VCHAR
hash-algo          = <span class="hljs-variable">&lt;hash-algo production from [Content Security Policy Level 2, section 4.2]&gt;</span>
base64-value       = <span class="hljs-variable">&lt;base64-value production from [Content Security Policy Level 2, section 4.2]&gt;</span>
hash-expression    = hash-algo <span class="hljs-string">"-"</span> base64-value
</code></pre>

            <p>The <code>integrity</code> IDL attribute must <a
                    href="https://www.w3.org/TR/html5/infrastructure.html#reflect">reflect</a> the
                <code>integrity</code> content attribute.</p>

            <p><code>option-expression</code>s are associated on a per <code>hash-expression</code> basis and are
                applied only to the <code>hash-expression</code> that immediately precedes it.</p>

            <p>In order for user agents to remain fully forwards compatible with future options, the user agent <em
                    title="MUST" class="rfc2119">MUST</em> ignore all unrecognized <code>option-expression</code>s.</p>

            <div class="note">
                <div id="h-note10" role="heading" aria-level="4" class="note-title marker"><span>Note</span></div>
                <p class="">Note that while the <code>option-expression</code> has been reserved in the syntax, no
                    options have been defined. It is likely that a future version of the spec will define a more
                    specific syntax for options, so it is defined here as broadly as possible.</p>
            </div>

        </section>
        <!-- /Framework::HTML::integrity -->

        <section property="bibo:hasPart" resource="#element-interface-extensions" typeof="bibo:Chapter">
            <h3 resource="#element-interface-extensions" id="element-interface-extensions"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">3.6 </span>Element interface extensions</span></h3>

            <section property="bibo:hasPart" resource="#htmllinkelement" typeof="bibo:Chapter">
                <h4 resource="#htmllinkelement" id="htmllinkelement"><span property="xhv:role"
                        resource="xhv:heading"><span class="secno">3.6.1 </span>HTMLLinkElement</span></h4>

                <pre class="idl"><span class="idlInterface" id="idl-def-HTMLLinkElement">partial interface <span class="idlInterfaceID">HTMLLinkElement</span> {
<span class="idlAttribute">                    attribute <span class="idlAttrType">DOMString</span> <span class="idlAttrName"><a href="#widl-HTMLLinkElement-integrity">integrity</a></span>;</span>
};</span></pre>

                <section property="bibo:hasPart" resource="#attributes" typeof="bibo:Chapter" id="attributes">
                    <h5 resource="#h-attributes" id="h-attributes"><span property="xhv:role"
                            resource="xhv:heading"><span class="secno">3.6.1.1 </span>Attributes</span></h5>
                    <dl class="attributes">
                        <dt id="widl-HTMLLinkElement-integrity"><code>integrity</code> of type <span
                                class="idlAttrType">DOMString</span></dt>
                        <dd><code>integrity</code></dd>
                    </dl>
                </section>
            </section>
            <!-- /Framework::HTML::Interface extensions::HTMLLinkElement -->

            <section property="bibo:hasPart" resource="#htmlscriptelement" typeof="bibo:Chapter">
                <h4 resource="#htmlscriptelement" id="htmlscriptelement"><span property="xhv:role"
                        resource="xhv:heading"><span class="secno">3.6.2 </span>HTMLScriptElement</span></h4>

                <pre class="idl"><span class="idlInterface" id="idl-def-HTMLScriptElement">partial interface <span class="idlInterfaceID">HTMLScriptElement</span> {
<span class="idlAttribute">                    attribute <span class="idlAttrType">DOMString</span> <span class="idlAttrName"><a href="#widl-HTMLScriptElement-integrity">integrity</a></span>;</span>
};</span></pre>

                <section property="bibo:hasPart" resource="#attributes-1" typeof="bibo:Chapter" id="attributes-1">
                    <h5 resource="#h-attributes-1" id="h-attributes-1"><span property="xhv:role"
                            resource="xhv:heading"><span class="secno">3.6.2.1 </span>Attributes</span></h5>
                    <dl class="attributes">
                        <dt id="widl-HTMLScriptElement-integrity"><code>integrity</code> of type <span
                                class="idlAttrType">DOMString</span></dt>
                        <dd><code>integrity</code></dd>
                    </dl>
                </section>
            </section>
            <!-- /Framework::HTML::Interface extensions::HTMLScriptElement -->
        </section>
        <!-- /Framework::HTML::Interface extensions -->

        <section property="bibo:hasPart" resource="#handling-integrity-violations" typeof="bibo:Chapter">
            <h3 resource="#handling-integrity-violations" id="handling-integrity-violations"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">3.7 </span>Handling integrity violations</span></h3>

            <p>The user agent will refuse to render or execute responses that fail an integrity check, instead returning
                a network error as defined in Fetch [<cite><a href="#bib-FETCH" class="bibref">FETCH</a></cite>].</p>

            <div class="note">
                <div id="h-note11" role="heading" aria-level="4" class="note-title marker"><span>Note</span></div>
                <p class="">On a failed integrity check, an <code>error</code> event is fired. Developers wishing to
                    provide a canonical fallback resource (e.g., a resource not served from a CDN, perhaps from a
                    secondary, trusted, but slower source) can catch this
                    <code>error</code> event and provide an appropriate handler to replace the failed resource with a
                    different one.
                </p>
            </div>

        </section>

        <section property="bibo:hasPart" resource="#elements" typeof="bibo:Chapter">
            <h3 resource="#elements" id="elements"><span property="xhv:role" resource="xhv:heading"><span
                        class="secno">3.8 </span>Elements</span></h3>

            <section property="bibo:hasPart" resource="#the-link-element-for-stylesheets" typeof="bibo:Chapter">
                <h4 resource="#the-link-element-for-stylesheets" id="the-link-element-for-stylesheets"><span
                        property="xhv:role" resource="xhv:heading"><span class="secno">3.8.1 </span>The
                        <code>link</code> element for stylesheets</span></h4>

                <p>Whenever a user agent attempts to <a
                        href="https://www.w3.org/TR/html5/document-metadata.html#concept-link-obtain">obtain a
                        resource</a> pointed to by a
                    <code>link</code> element that has a <code>rel</code> attribute with the keyword of
                    <code>stylesheet</code>, modify step 4 to read:
                </p>

                <p>Do a potentially CORS-enabled fetch of the resulting absolute URL, with the mode being the current
                    state of the element’s crossorigin content attribute, the origin being the origin of the link
                    element’s Document, the default origin behavior set to taint, and the <a
                        href="#dfn-integrity-metadata">integrity metadata</a> of the request set to the value of the
                    element’s <code>integrity</code> attribute.</p>

            </section>
            <!-- /Framework::HTML::link -->

            <section property="bibo:hasPart" resource="#the-script-element" typeof="bibo:Chapter">
                <h4 resource="#the-script-element" id="the-script-element"><span property="xhv:role"
                        resource="xhv:heading"><span class="secno">3.8.2 </span>The <code>script</code> element</span>
                </h4>

                <p>Replace step 14.1 of HTML5’s <a
                        href="https://www.w3.org/TR/html5/scripting-1.html#prepare-a-script">“prepare a script”
                        algorithm</a> with:</p>

                <ol>
                    <li>Let <var>src</var> be the value of the element’s <code>src</code> attribute and the request’s
                        associated <a href="#dfn-integrity-metadata">integrity metadata</a> be the value of the
                        element’s
                        <code>integrity</code> attribute.
                    </li>
                </ol>

            </section>
            <!-- /Framework::HTML::Elements::script -->

        </section>
        <!-- /Framework::HTML::Elements -->

    </section>
    <!-- /Framework -->

    <section property="bibo:hasPart" resource="#proxies" typeof="bibo:Chapter">
        <!--OddPage-->
        <h2 resource="#proxies" id="proxies"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.
                </span>Proxies</span></h2>

        <p>Optimizing proxies and other intermediate servers which modify the responses <em title="MUST"
                class="rfc2119">MUST</em> ensure that the digest associated with those responses stays in sync with the
            new content. One option is to ensure that the <a href="#dfn-integrity-metadata">integrity metadata</a>
            associated with resources is updated. Another would be simply to deliver only the canonical version of
            resources for which a page author has requested integrity verification.</p>

        <p>To help inform intermediate servers, those serving the resources <em title="SHOULD"
                class="rfc2119">SHOULD</em> send along with the resource a <a
                href="https://tools.ietf.org/html/rfc7234#section-5.2"><code>Cache-Control</code></a> header with a
            value of <a href="https://tools.ietf.org/html/rfc7234#section-5.2.1.6"><code>no-transform</code></a>.</p>

    </section>
    <!-- /Implementation -->

    <section property="bibo:hasPart" resource="#security-considerations" typeof="bibo:Chapter" class="informative">
        <!--OddPage-->
        <h2 resource="#security-considerations" id="security-considerations"><span property="xhv:role"
                resource="xhv:heading"><span class="secno">5. </span>Security Considerations</span></h2>
        <p><em>This section is non-normative.</em></p>

        <section property="bibo:hasPart" resource="#non-secure-contexts-remain-non-secure" typeof="bibo:Chapter">
            <h3 resource="#non-secure-contexts-remain-non-secure" id="non-secure-contexts-remain-non-secure"><span
                    property="xhv:role" resource="xhv:heading"><span class="secno">5.1 </span>Non-secure contexts remain
                    non-secure</span></h3>

            <p><a href="#dfn-integrity-metadata">Integrity metadata</a> delivered by a context that is not a <a
                    href="https://w3c.github.io/webappsec-secure-contexts/">Secure Context</a>, such as an HTTP page,
                only protects an origin against a compromise of the server where an external resources is hosted.
                Network attackers can alter the digest in-flight (or remove it entirely, or do absolutely anything else
                to the document), just as they could alter the response the hash is meant to validate. Thus, it is
                recommended that authors deliver integrity metadata only to a
                <a href="https://w3c.github.io/webappsec-secure-contexts/">Secure Context</a>. See also <a
                    href="https://www.w3.org/2001/tag/doc/web-https">securing the web</a>.
            </p>

        </section>
        <!-- /Security::Non-secure contexts remain non-secure -->

        <section property="bibo:hasPart" resource="#hash-collision-attacks" typeof="bibo:Chapter">
            <h3 resource="#hash-collision-attacks" id="hash-collision-attacks"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">5.2 </span>Hash collision attacks</span></h3>

            <p>Digests are only as strong as the hash function used to generate them. It is recommended that user agents
                refuse to support known-weak hashing functions and limit supported algorithms to those known to be
                collision resistant. Examples of hashing functions that are not recommended include MD5 and SHA-1. At
                the time of writing, SHA-384 is a good baseline.</p>

            <p>Moreover, it is recommended that user agents re-evaluate their supported hash functions on a regular
                basis and deprecate support for those functions shown to be insecure. Over time, hash functions may be
                shown to be much weaker than expected and, in some cases, broken, so it is important that user agents
                stay aware of these developments.</p>

        </section>
        <!-- /Security::Hash collision -->

        <section property="bibo:hasPart" resource="#cross-origin-data-leakage" typeof="bibo:Chapter">
            <h3 resource="#cross-origin-data-leakage" id="cross-origin-data-leakage"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">5.3 </span>Cross-origin data leakage</span></h3>

            <p>This specification requires the <a
                    href="https://www.w3.org/TR/html5/infrastructure.html#cors-settings-attributes">CORS settings
                    attribute</a> to be present on integrity-protected cross-origin requests. If that requirement were
                omitted, attackers could violate the <a
                    href="https://www.w3.org/Security/wiki/Same_Origin_Policy">same-origin policy</a> and determine
                whether a cross-origin resource has certain content.</p>

            <p>Attackers would attempt to load the resource with a known digest, and watch for load failures. If the
                load fails, the attacker could surmise that the response didn’t match the hash and thereby gain some
                insight into its contents. This might reveal, for example, whether or not a user is logged into a
                particular service.</p>

            <p>Moreover, attackers could brute-force specific values in an otherwise static resource. Consider a JSON
                response that looks like this:</p>

            <div class="example">
                <div class="example-title marker"><span>Example 8</span></div>
                <pre class="hljs xquery"><code>{<span class="hljs-string">'status'</span>: <span class="hljs-string">'authenticated'</span>, <span class="hljs-string">'username'</span>: <span class="hljs-string">'admin'</span>}
</code></pre>
            </div>

            <p>An attacker could precompute hashes for the response with a variety of common usernames, and specify
                those hashes while repeatedly attempting to load the document. A successful load would confirm that the
                attacker has correctly guessed the username.</p>

        </section>
        <!-- /Security::cross-origin -->

    </section>
    <!-- /Security -->

    <section property="bibo:hasPart" resource="#acknowledgements" typeof="bibo:Chapter">
        <!--OddPage-->
        <h2 resource="#acknowledgements" id="acknowledgements"><span property="xhv:role" resource="xhv:heading"><span
                    class="secno">6. </span>Acknowledgements</span></h2>

        <p>Much of the content here is inspired heavily by Gervase Markham’s <a
                href="http://www.gerv.net/security/link-fingerprints/">Link Fingerprints</a> concept, as well as
            WHATWG’s <a href="https://wiki.whatwg.org/wiki/Link_Hashes">Link Hashes</a>.</p>

        <p>A special thanks to Mike West of Google, Inc. for his invaluable contributions to the initial version of this
            spec. Additionally, Brad Hill, Anne van Kesteren, Jonathan Kingston, Mark Nottingham, Dan Veditz, Eduardo
            Vela, Tanvi Vyas, and Michal Zalewski provided invaluable feedback.</p>

    </section>

    <section property="bibo:hasPart" resource="#references" typeof="bibo:Chapter" id="references" class="appendix">
        <!--OddPage-->
        <h2 resource="#h-references" id="h-references"><span property="xhv:role" resource="xhv:heading"><span
                    class="secno">A. </span>References</span></h2>

        <section property="bibo:hasPart" resource="#normative-references" typeof="bibo:Chapter"
            id="normative-references">
            <h3 resource="#h-normative-references" id="h-normative-references"><span property="xhv:role"
                    resource="xhv:heading"><span class="secno">A.1 </span>Normative references</span></h3>
            <dl resource="" class="bibliography">
                <dt id="bib-ABNF">[ABNF]</dt>
                <dd>D. Crocker, Ed.; P. Overell. IETF. <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc5234"><cite>Augmented BNF for Syntax Specifications:
                            ABNF</cite></a>. January 2008. Internet Standard. URL: <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc5234">https://tools.ietf.org/html/rfc5234</a>
                </dd>
                <dt id="bib-CORS">[CORS]</dt>
                <dd>Anne van Kesteren. W3C. <a property="dc:requires"
                        href="https://www.w3.org/TR/cors/"><cite>Cross-Origin Resource Sharing</cite></a>. 16 January
                    2014. W3C Recommendation. URL: <a property="dc:requires"
                        href="https://www.w3.org/TR/cors/">http://www.w3.org/TR/cors/</a>
                </dd>
                <dt id="bib-FETCH">[FETCH]</dt>
                <dd>Anne van Kesteren. WHATWG. <a property="dc:requires"
                        href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a
                        property="dc:requires" href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-MIMETYPE">[MIMETYPE]</dt>
                <dd>Ned Freed; Nathaniel S. Borenstein. IETF. <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc2046"><cite>Multipurpose Internet Mail Extensions (MIME)
                            Part Two: Media Types</cite></a>. Draft Standard. URL: <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc2046">https://tools.ietf.org/html/rfc2046</a>
                </dd>
                <dt id="bib-RFC2119">[RFC2119]</dt>
                <dd>S. Bradner. IETF. <a property="dc:requires" href="https://tools.ietf.org/html/rfc2119"><cite>Key
                            words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current
                    Practice. URL: <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
                </dd>
                <dt id="bib-RFC4648">[RFC4648]</dt>
                <dd>Simon Josefsson. IETF. <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc4648"><cite>The Base16, Base32, and Base64 Data
                            Encodings</cite></a>. Proposed Standard. URL: <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc4648">https://tools.ietf.org/html/rfc4648</a>
                </dd>
                <dt id="bib-RFC6454">[RFC6454]</dt>
                <dd>A. Barth. IETF. <a property="dc:requires" href="https://tools.ietf.org/html/rfc6454"><cite>The Web
                            Origin Concept</cite></a>. December 2011. Proposed Standard. URL: <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a>
                </dd>
                <dt id="bib-RFC7231">[RFC7231]</dt>
                <dd>R. Fielding, Ed.; J. Reschke, Ed.. IETF. <a property="dc:requires"
                        href="https://tools.ietf.org/html/rfc7231"><cite>Hypertext Transfer Protocol (HTTP/1.1):
                            Semantics and Content</cite></a>. June 2014. Proposed Standard. URL: <a
                        property="dc:requires"
                        href="https://tools.ietf.org/html/rfc7231">https://tools.ietf.org/html/rfc7231</a>
                </dd>
            </dl>
        </section>
    </section>

    <p role="navigation" id="back-to-top"><a href="#toc"><abbr title="Back to Top">↑</abbr></a></p>
    <script src="https://www.w3.org/scripts/TR/2016/fixup.js" defer="" async=""></script>
</body>

</html>