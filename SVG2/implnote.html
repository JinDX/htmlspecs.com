<!DOCTYPE html>

<!--
  Scalable Vector Graphics (SVG) 2
  Appendix B: Implementation Notes

  Note: This document is generated from ../master/implnote.html.
  Run "make" from the root of the repository to regenerate it.
  -->

<html lang="zh-hans" xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta charset="UTF-8">
  <title>实施说明 — SVG 2</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Style sheets for local dev. Will be standardized in processing.
  Add attribute data-keep="" to any extra stylesheet link you do not want removed
  (or use <style>), and include it before here. -->


  <link rel="stylesheet" title="Default" href="https://www.w3.org/TR/SVG2/style/svg.css" type="text/css" media="screen">
  <link rel="alternate stylesheet" title="Only annotations for publication"
    href="https://www.w3.org/TR/SVG2/style/default_no_maturity.css" type="text/css" media="screen">
  <link rel="alternate stylesheet" title="No issues/annotations"
    href="https://www.w3.org/TR/SVG2/style/default_no_issues.css" type="text/css" media="screen">
  <link rel="stylesheet" href="//www.w3.org/StyleSheets/TR/2016/W3C-ED" type="text/css" media="screen">
  <script src="https://www.w3.org/TR/SVG2/style/link-fixup.js"></script>
  <script data-script-mathjax="" async=""
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG"></script>
</head>

<body class="chapter-implnote">

  <h1>附录 B: 实施说明</h1>
  <nav id="toc">
    <div class="header top"><a href="Overview.html">概述</a> . <a href="idl.html">上一页</a> . <a href="access.html">下一页</a>
      . <a href="eltindex.html">元素</a> . <a href="attindex.html">属性</a> . <a href="propidx.html">特性</a></div>
    <h2 id="Contents" class="contents">目录</h2>
    <ol class="toc appendix-toc">
      <li>
        <ol class="toc appendix-toc">
          <li><a href="implnote.html#Introduction"><span class="secno">B.1.</span> 引言</a></li>
          <li><a href="implnote.html#ArcImplementationNotes"><span class="secno">B.2.</span> 椭圆弧参数转换</a>
            <ol class="toc appendix-toc">
              <li><a href="implnote.html#ArcSyntax"><span class="secno">B.2.1.</span> 椭圆弧端点语法</a></li>
              <li><a href="implnote.html#ArcParameterizationAlternatives"><span class="secno">B.2.2.</span> 参数化替代方案</a>
              </li>
              <li><a href="implnote.html#ArcConversionCenterToEndpoint"><span class="secno">B.2.3.</span>
                  从中心到端点参数化的转换</a></li>
              <li><a href="implnote.html#ArcConversionEndpointToCenter"><span class="secno">B.2.4.</span>
                  从端点到中心参数化的转换</a></li>
              <li><a href="implnote.html#ArcCorrectionOutOfRangeRadii"><span class="secno">B.2.5.</span> 修正超范围半径</a>
              </li>
            </ol>
          </li>
          <li><a href="implnote.html#NumericPrecisionImplementationNotes"><span class="secno">B.3.</span>
              高精度几何生成说明</a></li>
        </ol>
      </li>
    </ol>
  </nav>

  <h2 id="Introduction" class="heading">B.1. 引言<a class="self-link" href="#Introduction"></a></h2>

  <p>以下说明描述了软件开发人员在将内容转换为SVG语言特性所需格式时可以使用的算法和其他策略。</p>

  <h2 id="ArcImplementationNotes" class="heading">B.2. 椭圆弧参数转换<a class="self-link" href="#ArcImplementationNotes"></a>
  </h2>

  <p>为了与其他路径段符号保持一致，SVG路径中的弧是根据曲线上的起始点和终止点定义的。</p>

  <p>这种椭圆弧的参数化将被称为<em>端点参数化</em>。端点参数化的一个优点是它允许所有路径命令以新“当前点”的坐标结束，从而实现一致的路径语法。</p>

  <p>然而，这并不是描述软件或数学中弧几何的唯一方法。本节描述了替代的中心参数化，以及如何从SVG的端点参数化转换到该参数化。</p>

  <div class="math">

    <h3 id="ArcSyntax" class="heading">B.2.1. 椭圆弧端点语法<a class="self-link" href="#ArcSyntax"></a></h3>

    <p>椭圆弧在SVG路径命令中由以下参数按顺序描述：</p>

    <p>(<var>x</var><sub>1</sub>, <var>y</var><sub>1</sub>) 是路径上当前点的绝对坐标，来自上一个路径命令的最后两个参数。</p>

    <p><var>r<sub>x</sub></var>和<var>r<sub>y</sub></var>是椭圆的半径（也称为其半长轴和半短轴）。</p>

    <p><var>φ</var>是当前坐标系的x轴与椭圆的x轴之间的角度。</p>

    <p><var>f<sub>A</sub></var>是大弧标志，如果选择的弧跨度小于或等于180度则为0，选择的弧跨度大于180度则为1。</p>

    <p><var>f<sub>S</sub></var>是扫掠标志，如果连接中心到弧的线通过递减角度扫掠则为0，如果通过递增角度扫掠则为1。</p>

    <p>(<var>x</var><sub>2</sub>, <var>y</var><sub>2</sub>)是弧的最终点的绝对坐标。</p>

    <h3 id="ArcParameterizationAlternatives" class="heading">B.2.2. 参数化替代方案<a class="self-link"
        href="#ArcParameterizationAlternatives"></a></h3>

    <p>椭圆弧上的任意点(<var>x</var>, <var>y</var>)可以通过二维矩阵方程描述：</p>

    (eq. 3.1)
    <div role="math" aria-describedby="math-arbitrary-point-on-elliptical-arc">
      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
        <mrow>
          <mo>(</mo>
          <mtable>
            <mtr>
              <mtd>
                <mi>x</mi>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>y</mi>
              </mtd>
            </mtr>
          </mtable>
          <mo>)</mo>
          <mo>=</mo>
          <mo>(</mo>
          <mtable>
            <mtr>
              <mtd>
                <mrow>
                  <mi>cos</mi>
                  <mo>⁡</mo>
                  <mi>φ</mi>
                </mrow>
              </mtd>
              <mtd>
                <mrow>
                  <mo>-</mo>
                  <mi>sin</mi>
                  <mo>⁡</mo>
                  <mi>φ</mi>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow>
                  <mi>sin</mi>
                  <mo>⁡</mo>
                  <mi>φ</mi>
                </mrow>
              </mtd>
              <mtd>
                <mrow>
                  <mi>cos</mi>
                  <mo>⁡</mo>
                  <mi>φ</mi>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
          <mo>)</mo>
          <mo>·</mo>
          <mo>(</mo>
          <mtable>
            <mtr>
              <mtd>
                <mrow>
                  <msub>
                    <mi>r</mi>
                    <mi>x</mi>
                  </msub>
                  <mo>⁢</mo>
                  <mi>cos</mi>
                  <mo>⁡</mo>
                  <mi>θ</mi>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow>
                  <msub>
                    <mi>r</mi>
                    <mi>y</mi>
                  </msub>
                  <mo>⁢</mo>
                  <mi>sin</mi>
                  <mo>⁡</mo>
                  <mi>θ</mi>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
          <mo>)</mo>
          <mo>+</mo>
          <mo>(</mo>
          <mtable>
            <mtr>
              <mtd>
                <msub>
                  <mi>c</mi>
                  <mi>x</mi>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>c</mi>
                  <mi>y</mi>
                </msub>
              </mtd>
            </mtr>
          </mtable>
          <mo>)</mo>
        </mrow>
      </math>
      <pre id="math-arbitrary-point-on-elliptical-arc">
    x = rx*cos(θ)*cos(φ) - ry*sin(θ)*sin(φ) + cx
    y = rx*cos(θ)*sin(φ) + ry*sin(θ)*cos(φ) + cy
  </pre>
    </div>

    <p>(<var>c<sub>x</sub></var>, <var>c<sub>y</sub></var>) 是椭圆中心的坐标。</p>

    <p><var>r<sub>x</sub></var> 和 <var>r<sub>y</sub></var> 是椭圆的半径（也称为其半长轴和半短轴）。</p>

    <div class="ready-for-wider-review">
      <p><var>φ</var> 是当前坐标系的x轴与椭圆的x轴之间的角度。</p>

      <p><var>θ</var> 是点 (<var>x</var>, <var>y</var>) 所在的弧的角度，范围为：</p>

      <ul>
        <li><var>θ</var><sub>1</sub> 是椭圆弧在拉伸和旋转操作之前的起始角度。</li>

        <li><var>θ</var><sub>2</sub> 是椭圆弧在拉伸和旋转操作之前的结束角度。</li>

        <li>Δ<var>θ</var> 是这两个角度之间的差值。</li>
      </ul>
    </div>

    <p>如果将椭圆视为经过拉伸和旋转的圆，则 <var>θ</var><sub>1</sub>、<var>θ</var><sub>2</sub> 和 Δ<var>θ</var>
      分别是弧在拉伸和旋转操作之前的起始角度、结束角度和扫掠角度。这导致了一种在图形API中常见的替代参数化，将被称为<em>中心参数化</em>。在接下来的章节中，将给出中心参数化和端点参数化之间双向映射的公式。</p>

    <h3 id="ArcConversionCenterToEndpoint" class="heading">B.2.3. 从中心到端点参数化的转换<a class="self-link"
        href="#ArcConversionCenterToEndpoint"></a></h3>

    <p>给定以下变量：</p>

    <p class="indented separated">
      <var>c<sub>x</sub></var>
      <var>c<sub>y</sub></var>
      <var>r<sub>x</sub></var>
      <var>r<sub>y</sub></var>
      <var>φ</var>
      <var>θ</var><sub>1</sub>
      Δ<var>θ</var>
    </p>

    <p>任务是找到：</p>

    <p class="indented separated">
      <var>x</var><sub>1</sub>
      <var>y</var><sub>1</sub>
      <var>x</var><sub>2</sub>
      <var>y</var><sub>2</sub>
      <var>f<sub>A</sub></var>
      <var>f<sub>S</sub></var>
    </p>

    <p>这可以通过以下公式实现：</p>


    <table style="width: 90%">
      <tr>
        <td>
          <!--<img
    alt="Equation 4.1"
    src="https://www.w3.org/TR/SVG2/images/implnote/arcs/image004.png" />-->

          <div role="math">
            <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
              <mrow>
                <mfenced open="(" close=")">
                  <mtable rowalign="center">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>x</mi>
                          <mi>1</mi>
                        </msub>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>y</mi>
                          <mi>1</mi>
                        </msub>
                      </mtd>
                    </mtr>
                  </mtable>
                </mfenced>
                <mo>=</mo>
                <mfenced open="(" close=")">
                  <mtable rowalign="center">
                    <mtr>
                      <mtd>
                        <mrow>
                          <mn>cos</mn>
                          <mi mathvariant="italic">φ</mi>
                        </mrow>
                      </mtd>
                      <mtd>
                        <mrow>
                          <mo lspace="2px" rspace="2px">-</mo>
                          <mn>sin</mn>
                          <mi mathvariant="italic">φ</mi>
                        </mrow>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mrow>
                          <mn>sin</mn>
                          <mi mathvariant="italic">φ</mi>
                        </mrow>
                      </mtd>
                      <mtd>
                        <mrow>
                          <mn>cos</mn>
                          <mi mathvariant="italic">φ</mi>
                        </mrow>
                      </mtd>
                    </mtr>
                  </mtable>
                </mfenced>
                <mo lspace="2px" rspace="2px">⋅</mo>
                <mfenced open="(" close=")">
                  <mtable rowalign="center">
                    <mtr>
                      <mtd>
                        <mrow>
                          <msub>
                            <mi>r</mi>
                            <mi>x</mi>
                          </msub>
                          <mi> </mi>
                          <mn>cos</mn>
                          <msub>
                            <mi mathvariant="italic">θ</mi>
                            <mi mathvariant="italic">1</mi>
                          </msub>
                        </mrow>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mrow>
                          <msub>
                            <mi>r</mi>
                            <mi>y</mi>
                          </msub>
                          <mi> </mi>
                          <mn>sin</mn>
                          <msub>
                            <mi mathvariant="italic">θ</mi>
                            <mi mathvariant="italic">1</mi>
                          </msub>
                        </mrow>
                      </mtd>
                    </mtr>
                  </mtable>
                </mfenced>
                <mo lspace="2px" rspace="2px">+</mo>
                <mfenced open="(" close=")">
                  <mtable rowalign="center">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>c</mi>
                          <mi>x</mi>
                        </msub>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>c</mi>
                          <mi>y</mi>
                        </msub>
                      </mtd>
                    </mtr>
                  </mtable>
                </mfenced>
              </mrow>
            </math>
          </div>

        </td>
        <td style="text-align: right">(eq. 4.1)</td>
      </tr>
      <tr>
        <td>
          <!--<img
    alt="Equation 4.2"
    src="https://www.w3.org/TR/SVG2/images/implnote/arcs/image006.png" />-->
          <div role="math">
            <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
              <mrow>
                <mfenced open="(" close=")">
                  <mtable rowalign="center">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>x</mi>
                          <mi mathvariant="italic">2</mi>
                        </msub>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>y</mi>
                          <mi mathvariant="italic">2</mi>
                        </msub>
                      </mtd>
                    </mtr>
                  </mtable>
                </mfenced>
                <mo>=</mo>
                <mfenced open="(" close=")">
                  <mtable rowalign="center">
                    <mtr>
                      <mtd>
                        <mrow>
                          <mn>cos</mn>
                          <mi mathvariant="italic" fontfamily="Lucida Sans Unicode">φ</mi>
                        </mrow>
                      </mtd>
                      <mtd>
                        <mrow>
                          <mo lspace="2px" rspace="2px">-</mo>
                          <mn>sin</mn>
                          <mi mathvariant="italic" fontfamily="Lucida Sans Unicode">φ</mi>
                        </mrow>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mrow>
                          <mn>sin</mn>
                          <mi mathvariant="italic" fontfamily="Lucida Sans Unicode">φ</mi>
                        </mrow>
                      </mtd>
                      <mtd>
                        <mrow>
                          <mn>cos</mn>
                          <mi mathvariant="italic" fontfamily="Lucida Sans Unicode">φ</mi>
                        </mrow>
                      </mtd>
                    </mtr>
                  </mtable>
                </mfenced>
                <mo lspace="2px" rspace="2px">⋅</mo>
                <mfenced open="(" close=")">
                  <mtable rowalign="center">
                    <mtr>
                      <mtd>
                        <mrow>
                          <msub>
                            <mi>r</mi>
                            <mi>x</mi>
                          </msub>
                          <mi> </mi>
                          <mn>cos</mn>
                          <mfenced open="(" close=")">
                            <mrow>
                              <msub>
                                <mi mathvariant="italic" fontfamily="Lucida Sans Unicode">θ</mi>
                                <mi mathvariant="italic">1</mi>
                              </msub>
                              <mo lspace="2px" rspace="2px">+</mo>
                              <mi mathvariant="italic" fontfamily="Lucida Sans Unicode">Δ</mi>
                              <mi mathvariant="italic" fontfamily="Lucida Sans Unicode">θ</mi>
                            </mrow>
                          </mfenced>
                        </mrow>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mrow>
                          <msub>
                            <mi>r</mi>
                            <mi>y</mi>
                          </msub>
                          <mi> </mi>
                          <mn>sin</mn>
                          <mfenced open="(" close=")">
                            <mrow>
                              <msub>
                                <mi mathvariant="italic" fontfamily="Lucida Sans Unicode">θ</mi>
                                <mi mathvariant="italic">1</mi>
                              </msub>
                              <mo lspace="2px" rspace="2px">+</mo>
                              <mi mathvariant="italic" fontfamily="Lucida Sans Unicode">Δ</mi>
                              <mi mathvariant="italic" fontfamily="Lucida Sans Unicode">θ</mi>
                            </mrow>
                          </mfenced>
                        </mrow>
                      </mtd>
                    </mtr>
                  </mtable>
                </mfenced>
                <mo lspace="2px" rspace="2px">+</mo>
                <mfenced open="(" close=")">
                  <mtable rowalign="center">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>c</mi>
                          <mi>x</mi>
                        </msub>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>c</mi>
                          <mi>y</mi>
                        </msub>
                      </mtd>
                    </mtr>
                  </mtable>
                </mfenced>
              </mrow>
            </math>
          </div>
        </td>
        <td style="text-align: right">(eq. 4.2)</td>
      </tr>
      <tr>
        <td>
          <!--<img
    alt="Equation 4.3"
    src="https://www.w3.org/TR/SVG2/images/implnote/arcs/image008.png" />-->
          <div role="math">
            <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
              <mrow>
                <msub>
                  <mi>f</mi>
                  <mi>A</mi>
                </msub>
                <mo>=</mo>
                <mfenced open="{" close="">
                  <mtable rowalign="center">
                    <mtr>
                      <mtd>
                        <mrow>
                          <mn>1</mn>
                          <mi mathvariant="italic"> </mi>
                          <mi mathvariant="italic"> </mi>
                          <mtext>if</mtext>
                          <mi mathvariant="italic"> </mi>
                          <mi mathvariant="italic"> </mi>
                          <mfenced open="|" close="|">
                            <mrow>
                              <mi>Δ</mi>
                              <mi mathvariant="italic">θ</mi>
                            </mrow>
                          </mfenced>
                          <mo mathvariant="italic">></mo>
                          <mn>180</mn>
                          <mi mathvariant="normal">°</mi>
                        </mrow>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mrow>
                          <mtext>0</mtext>
                          <mi mathvariant="italic"> </mi>
                          <mi mathvariant="italic"> </mi>
                          <mtext>if</mtext>
                          <mi mathvariant="italic"> </mi>
                          <mi mathvariant="italic"> </mi>
                          <mfenced open="|" close="|">
                            <mrow>
                              <mi>Δ</mi>
                              <mi mathvariant="italic">θ</mi>
                            </mrow>
                          </mfenced>
                          <mo lspace="3px" rspace="3px">≤</mo>
                          <mn>180</mn>
                          <mi mathvariant="normal">°</mi>
                        </mrow>
                      </mtd>
                    </mtr>
                  </mtable>
                </mfenced>
              </mrow>
            </math>
          </div>

        </td>
        <td style="text-align: right">(eq. 4.3)</td>
      </tr>
      <tr>
        <td>
          <!--<img
    alt="Equation 4.4"
    src="https://www.w3.org/TR/SVG2/images/implnote/arcs/image010.png" />-->
          <div role="math">
            <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
              <mrow>
                <msub>
                  <mi>f</mi>
                  <mi>S</mi>
                </msub>
                <mo>=</mo>
                <mfenced open="{" close="">
                  <mtable rowalign="center">
                    <mtr>
                      <mtd>
                        <mrow>
                          <mn>1</mn>
                          <mi mathvariant="italic">  </mi>
                          <mtext>if</mtext>
                          <mi mathvariant="italic">  </mi>
                          <mi>Δ</mi>
                          <mi mathvariant="italic">θ</mi>
                          <mn> </mn>
                          <mo lspace="0px" rspace="0px">></mo>
                          <mtext> </mtext>
                          <mn>0</mn>
                          <mi mathvariant="normal">°</mi>
                        </mrow>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mrow>
                          <mtext>0</mtext>
                          <mi mathvariant="italic">  </mi>
                          <mtext>if</mtext>
                          <mi mathvariant="italic">  </mi>
                          <mi>Δ</mi>
                          <mi mathvariant="italic">θ</mi>
                          <mn> </mn>
                          <mo lspace="0px" rspace="0px">&lt;</mo>
                          <mtext> </mtext>
                          <mn>0</mn>
                          <mi mathvariant="normal">°</mi>
                        </mrow>
                      </mtd>
                    </mtr>
                  </mtable>
                </mfenced>
              </mrow>
            </math>
          </div>
        </td>
        <td style="text-align: right">(eq. 4.4)</td>
      </tr>
    </table>

    <h3 id="ArcConversionEndpointToCenter" class="heading">B.2.4. 从端点到中心参数化的转换<a class="self-link"
        href="#ArcConversionEndpointToCenter"></a></h3>

    <p>给定以下变量：</p>

    <p class="indented separated">
      <var>x</var><sub>1</sub>
      <var>y</var><sub>1</sub>
      <var>x</var><sub>2</sub>
      <var>y</var><sub>2</sub>
      <var>f<sub>A</sub></var>
      <var>f<sub>S</sub></var>
      <var>r<sub>x</sub></var>
      <var>r<sub>y</sub></var>
      <var>φ</var>
    </p>

    <p>任务是找到：</p>

    <p class="indented separated">
      <var>c<sub>x</sub></var>
      <var>c<sub>y</sub></var>
      <var>θ</var><sub>1</sub>
      Δ<var>θ</var>
    </p>

    <p>方程在将原点放置在连接 (<var>x</var><sub>1</sub>, <var>y</var><sub>1</sub>) 和
      (<var>x</var><sub>2</sub>, <var>y</var><sub>2</sub>)
      的线段的中点之后会简化，接着进行旋转以使坐标轴与椭圆的轴对齐。所有变换后的坐标将用撇号表示。它们作为中间值被计算，以找到所需的中心参数化变量。该过程包括以下步骤：</p>

    <ul>
      <li>
        <p><em>步骤 1：计算</em> (<var>x</var><sub>1</sub>′, <var>y</var><sub>1</sub>′)</p>
        <table style="width: 90%">
          <tr>
            <td><!--<img
        alt="Equation 5.1"
        src="https://www.w3.org/TR/SVG2/images/implnote/arcs/image012.png" />-->
              <div role="math">
                <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                  <mrow>
                    <mfenced open="(" close=")">
                      <mtable rowalign="center">
                        <mtr>
                          <mtd>
                            <msup>
                              <msub>
                                <mi>x</mi>
                                <mi mathvariant="italic">1</mi>
                              </msub>
                              <mo mathvariant="italic" fontfamily="Lucida Sans Unicode">′</mo>
                            </msup>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <msup>
                              <msub>
                                <mi>y</mi>
                                <mi mathvariant="italic">1</mi>
                              </msub>
                              <mo mathvariant="italic" fontfamily="Lucida Sans Unicode">′</mo>
                            </msup>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mfenced>
                    <mo>=</mo>
                    <mfenced open="(" close=")">
                      <mtable rowalign="center">
                        <mtr>
                          <mtd>
                            <mrow>
                              <mn>cos</mn>
                              <mi mathvariant="italic">φ</mi>
                            </mrow>
                          </mtd>
                          <mtd>
                            <mrow>
                              <mn>sin</mn>
                              <mi mathvariant="italic">φ</mi>
                            </mrow>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <mrow>
                              <mo>-</mo>
                              <mn>sin</mn>
                              <mi mathvariant="italic">φ</mi>
                            </mrow>
                          </mtd>
                          <mtd>
                            <mrow>
                              <mn>cos</mn>
                              <mi mathvariant="italic">φ</mi>
                            </mrow>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mfenced>
                    <mo lspace="2px" rspace="2px">⋅</mo>
                    <mfenced open="(" close=")">
                      <mtable rowalign="center">
                        <mtr>
                          <mtd>
                            <mfrac>
                              <mrow>
                                <msub>
                                  <mi>x</mi>
                                  <mi mathvariant="italic">1</mi>
                                </msub>
                                <mo mathvariant="italic">-</mo>
                                <msub>
                                  <mi>x</mi>
                                  <mi mathvariant="italic">2</mi>
                                </msub>
                              </mrow>
                              <mi mathvariant="italic">2</mi>
                            </mfrac>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <mfrac>
                              <mrow>
                                <msub>
                                  <mi>y</mi>
                                  <mi mathvariant="italic">1</mi>
                                </msub>
                                <mo mathvariant="italic">-</mo>
                                <msub>
                                  <mi>y</mi>
                                  <mi mathvariant="italic">2</mi>
                                </msub>
                              </mrow>
                              <mi mathvariant="italic">2</mi>
                            </mfrac>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mfenced>
                  </mrow>
                </math>
              </div>
            </td>
            <td style="text-align: right">(eq. 5.1)</td>
          </tr>
        </table>
      </li>

      <li>
        <p><em>步骤 2：计算</em> (<var>c<sub>x</sub></var>′, <var>c<sub>y</sub></var>′)</p>
        <table style="width: 90%">
          <tr>
            <td><!--<img
        alt="Equation 5.2"
        src="https://www.w3.org/TR/SVG2/images/implnote/arcs/image014.png" />-->
              <div role="math">
                <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                  <mrow>
                    <mfenced open="(" close=")">
                      <mtable rowalign="center">
                        <mtr>
                          <mtd>
                            <msup>
                              <msub>
                                <mi>c</mi>
                                <mi>x</mi>
                              </msub>
                              <mo>′</mo>
                            </msup>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <msup>
                              <msub>
                                <mi>c</mi>
                                <mi>y</mi>
                              </msub>
                              <mo>′</mo>
                            </msup>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mfenced>
                    <mo>=</mo>
                    <mo lspace="2px" rspace="2px">±</mo>
                    <msqrt>
                      <mfrac>
                        <mrow>
                          <msup>
                            <msub>
                              <mi>r</mi>
                              <mi>x</mi>
                            </msub>
                            <mn>2</mn>
                          </msup>
                          <mtext> </mtext>
                          <msup>
                            <msub>
                              <mi>r</mi>
                              <mi>y</mi>
                            </msub>
                            <mn>2</mn>
                          </msup>
                          <mo>-</mo>
                          <msup>
                            <msub>
                              <mi>r</mi>
                              <mi>x</mi>
                            </msub>
                            <mn>2</mn>
                          </msup>
                          <msup>
                            <mfenced open="(" close=")">
                              <msup>
                                <msub>
                                  <mi>y</mi>
                                  <mn>1</mn>
                                </msub>
                                <mo>′</mo>
                              </msup>
                            </mfenced>
                            <mn>2</mn>
                          </msup>
                          <mo>-</mo>
                          <msup>
                            <msub>
                              <mi>r</mi>
                              <mi>y</mi>
                            </msub>
                            <mn>2</mn>
                          </msup>
                          <msup>
                            <mfenced open="(" close=")">
                              <msup>
                                <msub>
                                  <mi>x</mi>
                                  <mn>1</mn>
                                </msub>
                                <mo>′</mo>
                              </msup>
                            </mfenced>
                            <mn>2</mn>
                          </msup>
                        </mrow>
                        <mrow>
                          <msup>
                            <msub>
                              <mi>r</mi>
                              <mi>x</mi>
                            </msub>
                            <mn>2</mn>
                          </msup>
                          <msup>
                            <mfenced open="(" close=")">
                              <msup>
                                <msub>
                                  <mi>y</mi>
                                  <mn>1</mn>
                                </msub>
                                <mo>′</mo>
                              </msup>
                            </mfenced>
                            <mn>2</mn>
                          </msup>
                          <mo>+</mo>
                          <msup>
                            <msub>
                              <mi>r</mi>
                              <mi>y</mi>
                            </msub>
                            <mn>2</mn>
                          </msup>
                          <msup>
                            <mfenced open="(" close=")">
                              <msup>
                                <msub>
                                  <mi>x</mi>
                                  <mn>1</mn>
                                </msub>
                                <mo>′</mo>
                              </msup>
                            </mfenced>
                            <mn>2</mn>
                          </msup>
                        </mrow>
                      </mfrac>
                    </msqrt>
                    <mfenced open="(" close=")">
                      <mtable rowalign="center">
                        <mtr>
                          <mtd>
                            <mfrac>
                              <mrow>
                                <msub>
                                  <mi>r</mi>
                                  <mi>x</mi>
                                </msub>
                                <mtext> </mtext>
                                <msup>
                                  <msub>
                                    <mi>y</mi>
                                    <mn>1</mn>
                                  </msub>
                                  <mo>′</mo>
                                </msup>
                              </mrow>
                              <msub>
                                <mi>r</mi>
                                <mi>y</mi>
                              </msub>
                            </mfrac>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <mrow>
                              <mo>-</mo>
                              <mfrac>
                                <mrow>
                                  <msub>
                                    <mi>r</mi>
                                    <mi>y</mi>
                                  </msub>
                                  <mtext> </mtext>
                                  <msup>
                                    <msub>
                                      <mi>x</mi>
                                      <mn>1</mn>
                                    </msub>
                                    <mo>′</mo>
                                  </msup>
                                </mrow>
                                <msub>
                                  <mi>r</mi>
                                  <mi>x</mi>
                                </msub>
                              </mfrac>
                            </mrow>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mfenced>
                  </mrow>
                </math>
              </div>
            </td>
            <td style="text-align: right">(eq. 5.2)</td>
          </tr>
        </table>
        <p>当 <var>f<sub>A</sub></var> ≠ <var>f<sub>S</sub></var> 时选择 + 符号，如果
          <var>f<sub>A</sub></var> = <var>f<sub>S</sub></var> 时选择 − 符号。
        </p>
      </li>

      <li>
        <p><em>步骤 3：计算</em> (<var>c<sub>x</sub></var>, <var>c<sub>y</sub></var>)
          <em>从</em> (<var>c<sub>x</sub></var>′, <var>c<sub>y</sub></var>′)
        </p>

        <table style="width: 90%">
          <tr>
            <td><!--<img
        alt="Equation 5.3"
        src="https://www.w3.org/TR/SVG2/images/implnote/arcs/image016.png" />-->
              <div role="math">
                <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                  <mrow>
                    <mfenced open="(" close=")">
                      <mtable rowalign="center">
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>c</mi>
                              <mi>x</mi>
                            </msub>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>c</mi>
                              <mi>y</mi>
                            </msub>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mfenced>
                    <mo>=</mo>
                    <mfenced open="(" close=")">
                      <mtable rowalign="center">
                        <mtr>
                          <mtd>
                            <mrow>
                              <mn>cos</mn>
                              <mi mathvariant="italic">φ</mi>
                            </mrow>
                          </mtd>
                          <mtd>
                            <mrow>
                              <mo>-</mo>
                              <mn>sin</mn>
                              <mi mathvariant="italic">φ</mi>
                            </mrow>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <mrow>
                              <mn>sin</mn>
                              <mi mathvariant="italic">φ</mi>
                            </mrow>
                          </mtd>
                          <mtd>
                            <mrow>
                              <mn>cos</mn>
                              <mi mathvariant="italic">φ</mi>
                            </mrow>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mfenced>
                    <mo lspace="2px" rspace="2px">⋅</mo>
                    <mfenced open="(" close=")">
                      <mtable rowalign="center">
                        <mtr>
                          <mtd>
                            <msup>
                              <msub>
                                <mi>c</mi>
                                <mi>x</mi>
                              </msub>
                              <mo lspace="0px" form="infix">'</mo>
                            </msup>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <msup>
                              <msub>
                                <mi>c</mi>
                                <mi>y</mi>
                              </msub>
                              <mo lspace="0px" form="infix">'</mo>
                            </msup>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mfenced>
                    <mo>+</mo>
                    <mfenced open="(" close=")">
                      <mtable rowalign="center">
                        <mtr>
                          <mtd>
                            <mfrac>
                              <mrow>
                                <msub>
                                  <mi>x</mi>
                                  <mn>1</mn>
                                </msub>
                                <mo>+</mo>
                                <msub>
                                  <mi>x</mi>
                                  <mn>2</mn>
                                </msub>
                              </mrow>
                              <mn>2</mn>
                            </mfrac>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <mfrac>
                              <mrow>
                                <msub>
                                  <mi>y</mi>
                                  <mn>1</mn>
                                </msub>
                                <mo>+</mo>
                                <msub>
                                  <mi>y</mi>
                                  <mn>2</mn>
                                </msub>
                              </mrow>
                              <mn>2</mn>
                            </mfrac>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mfenced>
                  </mrow>
                </math>
              </div>
            </td>
            <td style="text-align: right">(eq. 5.3)</td>
          </tr>
        </table>
      </li>

      <li>
        <p><em>步骤 4：计算</em> <var>θ</var><sub>1</sub> 和 Δ<var>θ</var></p>
        <p>一般来说，两个向量 (<var>u<sub>x</sub></var>, <var>u<sub>y</sub></var>) 和
          (<var>v<sub>x</sub></var>, <var>v<sub>y</sub></var>) 之间的角度可以计算为</p>

        <table style="width: 90%">
          <tr>
            <td><!--<img
        alt="Equation 5.4"
        src="https://www.w3.org/TR/SVG2/images/implnote/arcs/image018.png" />-->
              <div role="math">
                <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                  <mrow>
                    <mo lspace="3px" rspace="3px">∠</mo>
                    <mfenced open="(" close=")">
                      <mtable rowalign="center">
                        <mtr>
                          <mtd>
                            <mover>
                              <mi>u</mi>
                              <mo>⇀</mo>
                            </mover>
                          </mtd>
                          <mtd>
                            <mn>,</mn>
                          </mtd>
                          <mtd>
                            <mover>
                              <mi>v</mi>
                              <mo>⇀</mo>
                            </mover>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mfenced>
                    <mo>=</mo>
                    <mo lspace="2px" rspace="2px">±</mo>
                    <mn>arccos</mn>
                    <mfenced open="(" close=")">
                      <mfrac>
                        <mrow>
                          <mover>
                            <mi>u</mi>
                            <mo>⇀</mo>
                          </mover>
                          <mo lspace="6px" rspace="6px">⋅</mo>
                          <mover>
                            <mi>v</mi>
                            <mo>⇀</mo>
                          </mover>
                        </mrow>
                        <mrow>
                          <mfenced open="‖" close="‖">
                            <mover>
                              <mi>u</mi>
                              <mo>⇀</mo>
                            </mover>
                          </mfenced>
                          <mi> </mi>
                          <mfenced open="‖" close="‖">
                            <mover>
                              <mi>v</mi>
                              <mo>⇀</mo>
                            </mover>
                          </mfenced>
                        </mrow>
                      </mfrac>
                    </mfenced>
                  </mrow>
                </math>
              </div>
            </td>
            <td style="text-align: right">(eq. 5.4)</td>
          </tr>
        </table>

        <p>这里出现的 ± 符号是
          <var>u<sub>x</sub></var> <var>v<sub>y</sub></var> − <var>u<sub>y</sub></var> <var>v<sub>x</sub></var> 的符号。
        </p>

        <p>这个角度函数可以用来表示 <var>θ</var><sub>1</sub> 和 Δ<var>θ</var> 如下：</p>


        <table style="width: 90%">
          <tr>
            <td><!--<img
        alt="Equation 5.5"
        src="https://www.w3.org/TR/SVG2/images/implnote/arcs/image020.png" />-->
              <div role="math">
                <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                  <mrow>
                    <msub>
                      <mi mathvariant="italic" fontfamily="Lucida Sans Unicode">θ</mi>
                      <mi>1</mi>
                    </msub>
                    <mo>=</mo>
                    <mo lspace="3px" rspace="3px">∠</mo>
                    <mfenced open="(" close=")">
                      <mtable rowalign="center">
                        <mtr>
                          <mtd>
                            <mfenced open="(" close=")">
                              <mtable rowalign="center">
                                <mtr>
                                  <mtd>
                                    <mn>1</mn>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mn>0</mn>
                                  </mtd>
                                </mtr>
                              </mtable>
                            </mfenced>
                          </mtd>
                          <mtd>
                            <mi mathvariant="italic">,</mi>
                          </mtd>
                          <mtd>
                            <mfenced open="(" close=")">
                              <mtable rowalign="center">
                                <mtr>
                                  <mtd>
                                    <mfrac>
                                      <mrow>
                                        <msup>
                                          <msub>
                                            <mi>x</mi>
                                            <mi mathvariant="italic">1</mi>
                                          </msub>
                                          <mo>′</mo>
                                        </msup>
                                        <mo>-</mo>
                                        <msup>
                                          <msub>
                                            <mi>c</mi>
                                            <mi>x</mi>
                                          </msub>
                                          <mo>′</mo>
                                        </msup>
                                      </mrow>
                                      <msub>
                                        <mi>r</mi>
                                        <mi>x</mi>
                                      </msub>
                                    </mfrac>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mfrac>
                                      <mrow>
                                        <msup>
                                          <msub>
                                            <mi>y</mi>
                                            <mi mathvariant="italic">1</mi>
                                          </msub>
                                          <mo>′</mo>
                                        </msup>
                                        <mo>-</mo>
                                        <msup>
                                          <msub>
                                            <mi>c</mi>
                                            <mi>y</mi>
                                          </msub>
                                          <mo>′</mo>
                                        </msup>
                                      </mrow>
                                      <msub>
                                        <mi>r</mi>
                                        <mi>y</mi>
                                      </msub>
                                    </mfrac>
                                  </mtd>
                                </mtr>
                              </mtable>
                            </mfenced>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mfenced>
                  </mrow>
                </math>
              </div>
            </td>
            <td style="text-align: right">(eq. 5.5)</td>
          </tr>
          <tr>
            <td><!--<img
        alt="Equation 5.6"
        src="https://www.w3.org/TR/SVG2/images/implnote/arcs/image022.png" />-->
              <div role="math">
                <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                  <mrow>
                    <mi>Δ</mi>
                    <mi mathvariant="italic" fontfamily="Lucida Sans Unicode">θ</mi>
                    <mo lspace="3px" rspace="3px">≡</mo>
                    <mo lspace="3px" rspace="3px">∠</mo>
                    <mfenced open="(" close=")">
                      <mtable rowalign="center">
                        <mtr>
                          <mtd>
                            <mfenced open="(" close=")">
                              <mtable rowalign="center">
                                <mtr>
                                  <mtd>
                                    <mfrac>
                                      <mrow>
                                        <msup>
                                          <msub>
                                            <mi>x</mi>
                                            <mi mathvariant="italic">1</mi>
                                          </msub>
                                          <mo>′</mo>
                                        </msup>
                                        <mo>-</mo>
                                        <msup>
                                          <msub>
                                            <mi>c</mi>
                                            <mi>x</mi>
                                          </msub>
                                          <mo>′</mo>
                                        </msup>
                                      </mrow>
                                      <msub>
                                        <mi>r</mi>
                                        <mi>x</mi>
                                      </msub>
                                    </mfrac>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mfrac>
                                      <mrow>
                                        <msup>
                                          <msub>
                                            <mi>y</mi>
                                            <mi mathvariant="italic">1</mi>
                                          </msub>
                                          <mo>′</mo>
                                        </msup>
                                        <mo>-</mo>
                                        <msup>
                                          <msub>
                                            <mi>c</mi>
                                            <mi>y</mi>
                                          </msub>
                                          <mo>′</mo>
                                        </msup>
                                      </mrow>
                                      <msub>
                                        <mi>r</mi>
                                        <mi>y</mi>
                                      </msub>
                                    </mfrac>
                                  </mtd>
                                </mtr>
                              </mtable>
                            </mfenced>
                          </mtd>
                          <mtd>
                            <mi mathvariant="italic">,</mi>
                          </mtd>
                          <mtd>
                            <mfenced open="(" close=")">
                              <mtable rowalign="center">
                                <mtr>
                                  <mtd>
                                    <mfrac>
                                      <mrow>
                                        <msup>
                                          <mrow>
                                            <mo>-</mo>
                                            <msub>
                                              <mi>x</mi>
                                              <mi mathvariant="italic">1</mi>
                                            </msub>
                                          </mrow>
                                          <mo>′</mo>
                                        </msup>
                                        <mo>-</mo>
                                        <msup>
                                          <msub>
                                            <mi>c</mi>
                                            <mi>x</mi>
                                          </msub>
                                          <mo>′</mo>
                                        </msup>
                                      </mrow>
                                      <msub>
                                        <mi>r</mi>
                                        <mi>x</mi>
                                      </msub>
                                    </mfrac>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mfrac>
                                      <mrow>
                                        <msup>
                                          <mrow>
                                            <mo>-</mo>
                                            <msub>
                                              <mi>y</mi>
                                              <mi mathvariant="italic">1</mi>
                                            </msub>
                                          </mrow>
                                          <mo>′</mo>
                                        </msup>
                                        <mo>-</mo>
                                        <msup>
                                          <msub>
                                            <mi>c</mi>
                                            <mi>y</mi>
                                          </msub>
                                          <mo>′</mo>
                                        </msup>
                                      </mrow>
                                      <msub>
                                        <mi>r</mi>
                                        <mi>y</mi>
                                      </msub>
                                    </mfrac>
                                  </mtd>
                                </mtr>
                              </mtable>
                            </mfenced>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mfenced>
                    <mi mathvariant="italic"> </mi>
                    <mn>mod 360</mn>
                    <mi>°</mi>
                  </mrow>
                </math>
              </div>
            </td>
            <td style="text-align: right">(eq. 5.6)</td>
          </tr>
        </table>

        <p>其中 Δ<var>θ</var> 固定在范围内
          −360° &lt; Δ<var>θ</var> &lt; 360°，使得：</p>

        <p class="indented">如果 <var>f<sub>S</sub></var> = 0，则 Δ<var>θ</var> &lt; 0，</p>
        <p class="indented">否则如果 <var>f<sub>S</sub></var> = 1，则 Δ<var>θ</var> > 0。</p>

        <p>换句话说，如果 <var>f<sub>S</sub></var> = 0 并且 (eq. 5.6) 的右侧大于 0，则减去 360°，
          而如果 <var>f<sub>S</sub></var> = 1 并且 (eq. 5.6) 的右侧小于 0，则加上 360°。在所有其他情况下保持不变。</p>

      </li>
    </ul>

    <h3 id="ArcCorrectionOutOfRangeRadii" class="heading">B.2.5. Correction of out-of-range radii<a class="self-link"
        href="#ArcCorrectionOutOfRangeRadii"></a></h3>

    <p>本节描述了对超出范围的 <var>r<sub>x</sub></var> 和
      <var>r<sub>y</sub></var> 进行数学调整的必要性，如<a href="paths.html#ArcOutOfRangeParameters">路径实现说明</a>中所述。
      算法上，这些调整包括以下步骤：
    </p>

    <ul>
      <li>
        <p><em>步骤 1：确保半径非零</em></p>
        <p>如果 <var>r<sub>x</sub></var> = 0 或
          <var>r<sub>y</sub></var> = 0，则将其视为从 (<var>x</var><sub>1</sub>, <var>y</var><sub>1</sub>)
          到 (<var>x</var><sub>2</sub>, <var>y</var><sub>2</sub>) 的直线，并停止。否则，
        </p>
      </li>

      <li>
        <p><em>步骤 2：确保半径为正</em></p>
        <p>取 <var>r<sub>x</sub></var> 和
          <var>r<sub>y</sub></var> 的绝对值：
        </p>
        <table style="width: 90%">
          <tr>
            <td><!--<img
        alt="Equation 6.1"
        src="https://www.w3.org/TR/SVG2/images/implnote/arcs/image024.png" />-->
              <div role="math">
                <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                  <mtable columnalign="left">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>r</mi>
                          <mi>y</mi>
                        </msub>
                        <mo lspace="3px" rspace="3px">←</mo>
                        <mfenced open="|" close="|">
                          <msub>
                            <mi>r</mi>
                            <mi>y</mi>
                          </msub>
                        </mfenced>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mrow />
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>r</mi>
                          <mi>y</mi>
                        </msub>
                        <mo lspace="3px" rspace="3px">←</mo>
                        <mfenced open="|" close="|">
                          <msub>
                            <mi>r</mi>
                            <mi>y</mi>
                          </msub>
                        </mfenced>
                      </mtd>
                    </mtr>
                  </mtable>
                </math>
              </div>
            </td>
            <td style="text-align: right">(eq. 6.1)</td>
          </tr>
        </table>
      </li>

      <li>
        <p><em>步骤 3：确保半径足够大</em></p>
        <p>使用方程 (eq. 5.1) 的带撇号的坐标值，计算</p>
        <table style="width: 90%">
          <tr>
            <td><!--<img
        alt="Equation 6.2"
        src="https://www.w3.org/TR/SVG2/images/implnote/arcs/image026.png" />-->
              <div role="math">
                <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                  <mrow>
                    <mi mathvariant="italic">Λ</mi>
                    <mo>=</mo>
                    <mfrac>
                      <msup>
                        <mfenced open="(" close=")">
                          <msup>
                            <msub>
                              <mi>x</mi>
                              <mi mathvariant="italic">1</mi>
                            </msub>
                            <mo fontfamily="Lucida Sans Unicode">′</mo>
                          </msup>
                        </mfenced>
                        <mi mathvariant="italic">2</mi>
                      </msup>
                      <msup>
                        <msub>
                          <mi>r</mi>
                          <mi>x</mi>
                        </msub>
                        <mi mathvariant="italic">2</mi>
                      </msup>
                    </mfrac>
                    <mo>+</mo>
                    <mfrac>
                      <msup>
                        <mfenced open="(" close=")">
                          <msup>
                            <msub>
                              <mi>y</mi>
                              <mi mathvariant="italic">1</mi>
                            </msub>
                            <mo fontfamily="Lucida Sans Unicode">′</mo>
                          </msup>
                        </mfenced>
                        <mi mathvariant="italic">2</mi>
                      </msup>
                      <msup>
                        <msub>
                          <mi>r</mi>
                          <mi>y</mi>
                        </msub>
                        <mi mathvariant="italic">2</mi>
                      </msup>
                    </mfrac>
                  </mrow>
                </math>
              </div>
            </td>
            <td style="text-align: right">(eq. 6.2)</td>
          </tr>
        </table>
        <p>如果上述方程的结果小于或等于 1，则无需对 <var>r<sub>x</sub></var> 和 <var>r<sub>y</sub></var> 进行进一步更改。如果上述方程的结果大于 1，则进行替换</p>

        <table style="width: 90%">
          <tr>
            <td><!--<img
        alt="Equation 6.3"
        src="https://www.w3.org/TR/SVG2/images/implnote/arcs/image028.png" />-->
              <div role="math">
                <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                  <mtable columnalign="left">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>r</mi>
                          <mi>x</mi>
                        </msub>
                        <mo lspace="3px" rspace="3px">←</mo>
                        <msqrt>
                          <mi mathvariant="italic" fontfamily="Lucida Sans Unicode">Λ</mi>
                        </msqrt>
                        <mi mathvariant="italic"> </mi>
                        <msub>
                          <mi>r</mi>
                          <mi>x</mi>
                        </msub>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mrow />
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>r</mi>
                          <mi>y</mi>
                        </msub>
                        <mo lspace="3px" rspace="3px">←</mo>
                        <msqrt>
                          <mi mathvariant="italic" fontfamily="Lucida Sans Unicode">Λ</mi>
                        </msqrt>
                        <mi mathvariant="italic"> </mi>
                        <msub>
                          <mi>r</mi>
                          <mi>y</mi>
                        </msub>
                      </mtd>
                    </mtr>
                  </mtable>
                </math>
              </div>
            </td>
            <td style="text-align: right">(eq. 6.3)</td>
          </tr>
        </table>
      </li>

      <li>
        <p><em>步骤 4：继续进行计算</em></p>
        <p>继续进行剩余的椭圆弧计算，例如 <a href="#ArcConversionEndpointToCenter">从端点到中心参数化的转换</a> 算法。
          注意：由于本节中的半径修正，方程 (5.2) 对于椭圆的中心总是至少有一个解（即根数从不为负）。如果使用方程 (eq. 6.3) 扩大半径，则 (eq. 5.2) 的根数为零，椭圆的中心恰好有一个解。</p>
      </li>
    </ul>

  </div>

  <h2 id="NumericPrecisionImplementationNotes" class="heading">B.3. 高精度几何生成说明<a class="self-link"
      href="#NumericPrecisionImplementationNotes"></a></h2>

  <p class="normativity">本节为信息性内容。</p>

  <p>SVG 的 <a href="types.html#Precision">实数精度</a> 为单精度。
    <a href="conform.html#ConformingSVGGenerators">符合标准的 SVG 生成器</a> 处理超过单精度的信息时，
    如地图和技术图纸，
    鼓励遵循本节中概述的过程，以确保在 <a href="conform.html#ConformingSVGViewers">符合标准的 SVG 查看器</a> 中一致显示。
  </p>

  <p>
    通过利用生成 CTM 时必须使用至少双精度浮点数的事实，可以获得有效精度高于单精度的表现（请参见
    <a href="conform.html#ConformingSVGViewers">符合标准的 SVG 查看器</a> 部分中的 CTM 生成处理）。
    生成内容的步骤如下：
  </p>
  <ol>
    <li>将内容拆分为瓷砖，以便在瓷砖内定位和大小每个对象所需的有效数字数量在单精度浮点数范围内。此外，在本描述中，原始内容的坐标系统将称为源空间。</li>
    <li>为每个瓷砖生成一个坐标变换矩阵，以将源空间转换为瓷砖空间，其中瓷砖空间的原点 <var>(0,0)</var> 位于瓷砖的左上角。变换矩阵的每个元素必须在单精度范围内。</li>
    <li>使用生成的坐标变换矩阵，将每个瓷砖的内容从源空间转换为瓷砖空间。结果是，每个对象的参数现在可以用单精度浮点数范围内的有效数字表示。</li>
    <li>为每个瓷砖生成一个逆变换矩阵，以便将瓷砖空间转换为源空间。这被用作下一步瓷砖元素的 <a class="property" href="coords.html#TransformProperty">transform</a>
      属性。</li>
    <li>将每个瓷砖安排为 SVG 中的单独用户坐标系统。例如，瓷砖可以表示为 <span class="element-name">‘<a
          href="struct.html#GElement"><span>g</span></a>’</span> 元素，带有由上一步生成的变换矩阵的 <a class="property"
        href="coords.html#TransformProperty">transform</a> 属性。第三步生成的拆分图形将作为它的子元素放置。</li>
  </ol>

  <table>
    <caption>
      拆分大于瓷砖的矢量图形示例
    </caption>
    <tr>
      <th>拆分前</th>
      <th>     </th>
      <th>拆分后</th>
    </tr>
    <tr>
      <td><img alt="拆分前示例" src="https://www.w3.org/TR/SVG2/images/conform/betterPrecisionTiling3.png" width="200"></td>
      <td>     </td>
      <td><img alt="拆分后示例" src="https://www.w3.org/TR/SVG2/images/conform/betterPrecisionTiling4.png" width="200"></td>
    </tr>
  </table>

  <table>
    <caption>
      提高有效数字的示例
    </caption>
    <tr>
      <th>步骤 1 : 拆分内容</th>
      <th>     </th>
      <th>步骤 5 : 以更小的有效数字和适当的平移安排瓷砖</th>
    </tr>
    <tr>
      <td><img alt="拆分内容到瓷砖示例" src="https://www.w3.org/TR/SVG2/images/conform/betterPrecisionTiling1.png" width="400">
      </td>
      <td>     </td>
      <td><img alt="平移并分配拆分内容示例" src="https://www.w3.org/TR/SVG2/images/conform/betterPrecisionTiling2.png" width="400">
      </td>
    </tr>
    <tr>
      <td colspan="3">此示例使用具有七位数字的用户坐标系统，通过瓷砖提供了八位数字的有效数字。</td>
    </tr>
  </table>


  <script src="//www.w3.org/scripts/TR/2016/fixup.js"></script>
  <script src="/dropdown.js"></script>

</body>

</html>