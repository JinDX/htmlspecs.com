<!DOCTYPE html>
<html lang="zh-hans">

<head>
    <meta charset="utf-8">
    <meta name="generator" content="ReSpec 34.1.8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <style>
        .issue-label {
            text-transform: initial
        }

        .warning>p:first-child {
            margin-top: 0
        }

        .warning {
            padding: .5em;
            border-left-width: .5em;
            border-left-style: solid
        }

        span.warning {
            padding: .1em .5em .15em
        }

        .issue.closed span.issue-number {
            text-decoration: line-through
        }

        .issue.closed span.issue-number::after {
            content: " (Closed)";
            font-size: smaller
        }

        .warning {
            border-color: #f11;
            border-width: .2em;
            border-style: solid;
            background: #fbe9e9
        }

        .warning-title:before {
            content: "⚠";
            font-size: 1.3em;
            float: left;
            padding-right: .3em;
            margin-top: -.3em
        }

        li.task-list-item {
            list-style: none
        }

        input.task-list-item-checkbox {
            margin: 0 .35em .25em -1.6em;
            vertical-align: middle
        }

        .issue a.respec-gh-label {
            padding: 5px;
            margin: 0 2px 0 2px;
            font-size: 10px;
            text-transform: none;
            text-decoration: none;
            font-weight: 700;
            border-radius: 4px;
            position: relative;
            bottom: 2px;
            border: none;
            display: inline-block
        }
    </style>
    <style>
        pre.idl {
            padding: 1em;
            position: relative
        }

        pre.idl>code {
            color: #000
        }

        @media print {
            pre.idl {
                white-space: pre-wrap
            }
        }

        .idlHeader {
            display: block;
            width: 150px;
            background: #8ccbf2;
            color: #fff;
            font-family: sans-serif;
            font-weight: 700;
            margin: -1em 0 1em -1em;
            height: 28px;
            line-height: 28px
        }

        .idlHeader a.self-link {
            margin-left: .3cm;
            text-decoration: none;
            border-bottom: none
        }

        .idlID {
            font-weight: 700;
            color: #005a9c
        }

        .idlType {
            color: #005a9c
        }

        .idlName {
            color: #ff4500
        }

        .idlName a {
            color: #ff4500;
            border-bottom: 1px dotted #ff4500;
            text-decoration: none
        }

        a.idlEnumItem {
            color: #000;
            border-bottom: 1px dotted #ccc;
            text-decoration: none
        }

        .idlSuperclass {
            font-style: italic;
            color: #005a9c
        }

        .idlDefaultValue,
        .idlParamName {
            font-style: italic
        }

        .extAttr {
            color: #666
        }

        .idlSectionComment {
            color: gray
        }

        .idlIncludes a {
            font-weight: 700
        }

        .respec-button-copy-paste:focus {
            text-decoration: none;
            border-color: #51a7e8;
            outline: 0;
            box-shadow: 0 0 5px rgba(81, 167, 232, .5)
        }

        .respec-button-copy-paste:is(:focus:hover, .selected:focus) {
            border-color: #51a7e8
        }

        .respec-button-copy-paste:is(:hover, :active, .zeroclipboard-is-hover, .zeroclipboard-is-active) {
            text-decoration: none;
            background-color: #ddd;
            background-image: linear-gradient(#eee, #ddd);
            border-color: #ccc
        }

        .respec-button-copy-paste:is(:active, .selected, .zeroclipboard-is-active) {
            background-color: #dcdcdc;
            background-image: none;
            border-color: #b5b5b5;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, .15)
        }

        .respec-button-copy-paste.selected:hover {
            background-color: #cfcfcf
        }

        .respec-button-copy-paste:is(:disabled, :disabled:hover, .disabled, .disabled:hover) {
            color: rgba(102, 102, 102, .5);
            cursor: default;
            background-color: rgba(229, 229, 229, .5);
            background-image: none;
            border-color: rgba(197, 197, 197, .5);
            box-shadow: none
        }

        @media print {
            .respec-button-copy-paste {
                visibility: hidden
            }
        }
    </style>
    <style>
        dfn {
            cursor: pointer
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            min-width: 300px;
            max-width: 500px;
            padding: .5em .75em;
            margin-top: .6em;
            font-family: "Helvetica Neue", sans-serif;
            font-size: small;
            background: #fff;
            color: #000;
            box-shadow: 0 1em 3em -.4em rgba(0, 0, 0, .3), 0 0 1px 1px rgba(0, 0, 0, .05);
            border-radius: 2px
        }

        .dfn-panel:not(.docked)>.caret {
            position: absolute;
            top: -9px
        }

        .dfn-panel:not(.docked)>.caret::after,
        .dfn-panel:not(.docked)>.caret::before {
            content: "";
            position: absolute;
            border: 10px solid transparent;
            border-top: 0;
            border-bottom: 10px solid #fff;
            top: 0
        }

        .dfn-panel:not(.docked)>.caret::before {
            border-bottom: 9px solid #a2a9b1
        }

        .dfn-panel * {
            margin: 0
        }

        .dfn-panel b {
            display: block;
            color: #000;
            margin-top: .25em
        }

        .dfn-panel ul a[href] {
            color: #333
        }

        .dfn-panel>div {
            display: flex
        }

        .dfn-panel a.self-link {
            font-weight: 700;
            margin-right: auto
        }

        .dfn-panel .marker {
            padding: .1em;
            margin-left: .5em;
            border-radius: .2em;
            text-align: center;
            white-space: nowrap;
            font-size: 90%;
            color: #040b1c
        }

        .dfn-panel .marker.dfn-exported {
            background: #d1edfd;
            box-shadow: 0 0 0 .125em #1ca5f940
        }

        .dfn-panel .marker.idl-block {
            background: #8ccbf2;
            box-shadow: 0 0 0 .125em #0670b161
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important
        }

        .dfn-panel a[href]:hover {
            border-bottom-width: 1px
        }

        .dfn-panel ul {
            padding: 0
        }

        .dfn-panel li {
            margin-left: 1em
        }

        .dfn-panel.docked {
            position: fixed;
            left: .5em;
            top: unset;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - .75em * 2 - .5em - .2em * 2);
            max-height: 30vh;
            overflow: auto
        }
    </style>


    <title>输入事件 第 1 级</title>

    <style>
        .invisible-table table {
            border: 0;
            border-spacing: 0px;
            border-collapse: collapse;
        }

        .invisible-table table td,
        .invisible-table table th {
            padding: 6px;
        }
    </style>



    <style id="respec-mainstyle">
        @keyframes pop {
            0% {
                transform: scale(1, 1)
            }

            25% {
                transform: scale(1.25, 1.25);
                opacity: .75
            }

            100% {
                transform: scale(1, 1)
            }
        }

        :is(h1, h2, h3, h4, h5, h6, a) abbr {
            border: none
        }

        dfn {
            font-weight: 700
        }

        a.internalDFN {
            color: inherit;
            border-bottom: 1px solid #99c;
            text-decoration: none
        }

        a.externalDFN {
            color: inherit;
            border-bottom: 1px dotted #ccc;
            text-decoration: none
        }

        a.bibref {
            text-decoration: none
        }

        .respec-offending-element:target {
            animation: pop .25s ease-in-out 0s 1
        }

        .respec-offending-element,
        a[href].respec-offending-element {
            text-decoration: red wavy underline
        }

        @supports not (text-decoration:red wavy underline) {
            .respec-offending-element:not(pre) {
                display: inline-block
            }

            .respec-offending-element {
                background: url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x
            }
        }

        #references :target {
            background: #eaf3ff;
            animation: pop .4s ease-in-out 0s 1
        }

        cite .bibref {
            font-style: normal
        }

        a[href].orcid {
            padding-left: 4px;
            padding-right: 4px
        }

        a[href].orcid>svg {
            margin-bottom: -2px
        }

        .toc a,
        .tof a {
            text-decoration: none
        }

        a .figno,
        a .secno {
            color: #000
        }

        ol.tof,
        ul.tof {
            list-style: none outside none
        }

        .caption {
            margin-top: .5em;
            font-style: italic
        }

        table.simple {
            border-spacing: 0;
            border-collapse: collapse;
            border-bottom: 3px solid #005a9c
        }

        .simple th {
            background: #005a9c;
            color: #fff;
            padding: 3px 5px;
            text-align: left
        }

        .simple th a {
            color: #fff;
            padding: 3px 5px;
            text-align: left
        }

        .simple th[scope=row] {
            background: inherit;
            color: inherit;
            border-top: 1px solid #ddd
        }

        .simple td {
            padding: 3px 10px;
            border-top: 1px solid #ddd
        }

        .simple tr:nth-child(even) {
            background: #f0f6ff
        }

        .section dd>p:first-child {
            margin-top: 0
        }

        .section dd>p:last-child {
            margin-bottom: 0
        }

        .section dd {
            margin-bottom: 1em
        }

        .section dl.attrs dd,
        .section dl.eldef dd {
            margin-bottom: 0
        }

        #issue-summary>ul {
            column-count: 2
        }

        #issue-summary li {
            list-style: none;
            display: inline-block
        }

        details.respec-tests-details {
            margin-left: 1em;
            display: inline-block;
            vertical-align: top
        }

        details.respec-tests-details>* {
            padding-right: 2em
        }

        details.respec-tests-details[open] {
            z-index: 999999;
            position: absolute;
            border: thin solid #cad3e2;
            border-radius: .3em;
            background-color: #fff;
            padding-bottom: .5em
        }

        details.respec-tests-details[open]>summary {
            border-bottom: thin solid #cad3e2;
            padding-left: 1em;
            margin-bottom: 1em;
            line-height: 2em
        }

        details.respec-tests-details>ul {
            width: 100%;
            margin-top: -.3em
        }

        details.respec-tests-details>li {
            padding-left: 1em
        }

        .self-link:hover {
            opacity: 1;
            text-decoration: none;
            background-color: transparent
        }

        aside.example .marker>a.self-link {
            color: inherit
        }

        .header-wrapper {
            display: flex;
            align-items: baseline
        }

        :is(h2, h3, h4, h5, h6):not(#toc>h2, #abstract>h2, #sotd>h2, .head>h2) {
            position: relative;
            left: -.5em
        }

        :is(h2, h3, h4, h5, h6):not(#toch2)+a.self-link {
            color: inherit;
            order: -1;
            position: relative;
            left: -1.1em;
            font-size: 1rem;
            opacity: .5
        }

        :is(h2, h3, h4, h5, h6)+a.self-link::before {
            content: "§";
            text-decoration: none;
            color: var(--heading-text)
        }

        :is(h2, h3)+a.self-link {
            top: -.2em
        }

        :is(h4, h5, h6)+a.self-link::before {
            color: #000
        }

        @media (max-width:767px) {
            dd {
                margin-left: 0
            }
        }

        @media print {
            .removeOnSave {
                display: none
            }
        }
    </style>
    <meta name="description" content="This specification defines additions to events for text and related
            input to allow for the monitoring and manipulation of default browser
            behavior in the context of text editor applications and other
            applications that deal with text input and text formatting. This
            specification builds on the UI events spec [UI-EVENTS].">
    <link rel="canonical" href="https://www.w3.org/TR/input-events-1/">
    <style>
        var {
            position: relative;
            cursor: pointer
        }

        var[data-type]::after,
        var[data-type]::before {
            position: absolute;
            left: 50%;
            top: -6px;
            opacity: 0;
            transition: opacity .4s;
            pointer-events: none
        }

        var[data-type]::before {
            content: "";
            transform: translateX(-50%);
            border-width: 4px 6px 0 6px;
            border-style: solid;
            border-color: transparent;
            border-top-color: #000
        }

        var[data-type]::after {
            content: attr(data-type);
            transform: translateX(-50%) translateY(-100%);
            background: #000;
            text-align: center;
            font-family: "Dank Mono", "Fira Code", monospace;
            font-style: normal;
            padding: 6px;
            border-radius: 3px;
            color: #daca88;
            text-indent: 0;
            font-weight: 400
        }

        var[data-type]:hover::after,
        var[data-type]:hover::before {
            opacity: 1
        }
    </style>
    <script id="initialUserConfig" type="application/json">{
      "specStatus": "DISC",
      "shortName": "input-events-1",
      "editors": [
        {
          "name": "Johannes Wilm",
          "mailto": "johannes@fiduswriter.org",
          "company": "Invited Expert",
          "w3cid": "75083",
          "url": "mailto:johannes@fiduswriter.org"
        }
      ],
      "formerEditors": [
        {
          "name": "Ben Peters",
          "mailto": "BenjamP@microsoft.com",
          "company": "Microsoft",
          "companyURL": "https://www.microsoft.com",
          "note": "until 23 February 2015",
          "w3cid": "69167",
          "url": "mailto:BenjamP@microsoft.com"
        }
      ],
      "group": "webediting",
      "github": "https://github.com/w3c/input-events/tree/v1",
      "otherLinks": [
        {
          "key": "Latest published version by level",
          "data": [
            {
              "value": "Level 1",
              "href": "https://www.w3.org/TR/input-events-1/"
            },
            {
              "value": "Level 2",
              "href": "https://www.w3.org/TR/input-events-2/"
            }
          ]
        },
        {
          "key": "Latest editor's draft by level",
          "data": [
            {
              "value": "Level 1",
              "href": "https://rawgit.com/w3c/input-events/v1/index.html"
            },
            {
              "value": "Level 2",
              "href": "https://w3c.github.io/input-events/"
            }
          ]
        }
      ],
      "xref": [
        "HTML"
      ],
      "publishISODate": "2023-09-27T00:00:00.000Z",
      "generatedSubtitle": "W3C Discontinued Draft 27 September 2023"
    }</script>
    <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-DISC">
</head>

<body class="h-entry informative" data-cite="HTML">
    <div class="head">
        <p class="logos"><a class="logo" href="https://www.w3.org/"><img crossorigin="" alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
            </a></p>
        <h1 id="title" class="title">输入事件 第 1 级</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types#DISC">W3C 停止草案</a> <time class="dt-published"
                datetime="2023-09-27">2023年9月28日</time></p>
        <details open="">
            <summary>有关本文件的更多详细信息</summary>
            <dl>
                <dt>此版本：</dt>
                <dd>
                    <a class="u-url"
                        href="https://www.w3.org/TR/2023/DISC-input-events-1-20230928/">https://www.w3.org/TR/2023/DISC-input-events-1-20230928/</a>
                </dd>
                <dt>最新发布版本：</dt>
                <dd>
                    <a href="https://www.w3.org/TR/input-events-1/">https://www.w3.org/TR/input-events-1/</a>
                </dd>
                <dt>最新编辑草案：</dt>
                <dd><a href="https://w3c.github.io/input-events/">https://w3c.github.io/input-events/</a></dd>
                <dt>历史记录：</dt>
                <dd>
                    <a
                        href="https://www.w3.org/standards/history/input-events-1/">https://www.w3.org/standards/history/input-events-1/</a>
                </dd>
                <dd>
                    <a href="https://github.com/w3c/input-events/commits/">提交历史</a>
                </dd>
                <dt>编辑：</dt>
                <dd class="editor p-author h-card vcard" data-editor-id="75083">
                    <a class="ed_mailto u-email email p-name" href="mailto:johannes@fiduswriter.org">Johannes Wilm</a>
                    (<span class="p-org org h-org">受邀专家</span>)
                </dd>
                <dt>前编辑：</dt>
                <dd class="editor p-author h-card vcard" data-editor-id="69167">
                    <a class="ed_mailto u-email email p-name" href="mailto:BenjamP@microsoft.com">Ben Peters</a> (<a
                        class="p-org org h-org" href="https://www.microsoft.com">微软</a>) (截至2015年2月23日)
                </dd>
                <dt>反馈：</dt>
                <dd>
                    <a href="https://github.com/w3c/input-events/tree/v1/">GitHub w3c/input-events</a>
                    (<a href="https://github.com/w3c/input-events/pulls/">拉取请求</a>，
                    <a href="https://github.com/w3c/input-events/issues/new/choose">新问题</a>，
                    <a href="https://github.com/w3c/input-events/issues/">开放问题</a>)
                </dd>
                <dt>按级别发布的最新版本</dt>
                <dd>
                    <a href="https://www.w3.org/TR/input-events-1/">第 1 级</a>
                </dd>
                <dd>
                    <a href="https://www.w3.org/TR/input-events-2/">第 2 级</a>
                </dd>
                <dt>按级别的最新编辑草案</dt>
                <dd>
                    <a href="https://rawgit.com/w3c/input-events/v1/index.html">第 1 级</a>
                </dd>
                <dd>
                    <a href="https://w3c.github.io/input-events/">第 2 级</a>
                </dd>
            </dl>
        </details>

        <p class="copyright">
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">版权</a>
            ©
            2023
            <a href="https://www.w3.org/">万维网联盟</a>。
            <abbr title="万维网联盟">W3C</abbr><sup>®</sup>
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">责任</a>、
            <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">商标</a>和
            <a rel="license" href="https://www.w3.org/Consortium/Legal/2023/software-license"
                title="W3C 软件和文档许可声明">许可文档规则</a>适用。
        </p>
        <hr title="标题分隔符">
    </div>
    <section id="abstract" class="introductory">
        <h2>摘要</h2>
        <p>
            本规范定义了文本及相关输入事件的补充，以便在文本编辑器应用程序和其他处理文本输入和文本格式的应用程序中监控和操作默认的浏览器行为。
            本规范基于 UI 事件规范 [<cite><a class="bibref" data-link-type="biblio" href="#bib-ui-events"
                    title="UI Events">UI-EVENTS</a></cite>]。
        </p>
    </section>
    <section id="sotd" class="introductory">
        <h2>本文档的状态</h2>
        <p><em>本节描述了本文档在发布时的状态。当前 <abbr title="万维网联盟">W3C</abbr> 发布的文档列表及该技术报告的最新版本可以在 <a
                    href="https://www.w3.org/TR/"><abbr title="万维网联盟">W3C</abbr>
                    技术报告索引</a>中找到：https://www.w3.org/TR/。</em></p>
        <p>
            输入事件第 1 级是输入事件的第一个版本
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-input-events"
                    title="Input Events Level 1">INPUT-EVENTS</a></cite>]。
        </p>
        <p>
            输入事件规范的 <a href="https://github.com/web-platform-tests/wpt/tree/master/input-events">测试套件</a> 和
            <a href="https://w3c.github.io/test-results/input-events/">实现报告</a> 仍在进行中。
        </p>
        <p>
            本文档由 <a href="https://www.w3.org/groups/wg/webediting">Web 编辑工作组</a> 作为已停止草案发布，使用了
            <a href="https://www.w3.org/2023/Process-20230612/#recs-and-notes">推荐标准流程</a>。
        </p>
        <p>作为已停止草案发布并不意味着 <abbr title="万维网联盟">W3C</abbr> 及其成员对此的认可。</p>
        <p>
            作为已停止草案发布意味着本文档不再有继续推进或维护的意图。因此，引用本文档仅适用于作为已放弃的工作。
        </p>
        <p>
            本文档由一个在 <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="万维网联盟">W3C</abbr> 专利政策</a>
            下运作的工作组制作。
            <abbr title="万维网联盟">W3C</abbr> 维护着与该工作组相关交付物的
            <a rel="disclosure" href="https://www.w3.org/groups/wg/webediting/ipr">任何专利披露的公共列表</a>，
            该页面还包括专利披露的说明。任何知晓包含
            <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">必要声明</a>的专利信息的个人，
            必须按照 <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">W3C 专利政策第 6 节</a> 披露该信息。
        </p>
        <p>
            本文档受 <a id="w3c_process_revision" href="https://www.w3.org/2023/Process-20230612/">2023年6月12日 W3C流程文档</a>
            管辖。
        </p>
    </section>
    <nav id="toc">
        <h2 class="introductory" id="table-of-contents">目录</h2>
        <ol class="toc">
            <li class="tocline"><a class="tocxref" href="#abstract">摘要</a></li>
            <li class="tocline"><a class="tocxref" href="#sotd">本文档的状态</a></li>
            <li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>
                    介绍
                </a></li>
            <li class="tocline"><a class="tocxref" href="#definitions"><bdi class="secno">2. </bdi>
                    定义
                </a></li>
            <li class="tocline"><a class="tocxref" href="#problems-solved"><bdi class="secno">3. </bdi>
                    解决的问题
                </a></li>
            <li class="tocline"><a class="tocxref" href="#use-cases"><bdi class="secno">4. </bdi>
                    使用案例
                </a></li>
            <li class="tocline"><a class="tocxref" href="#events-inputevents"><bdi class="secno">5. </bdi>
                    输入事件类型
                </a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#interface-InputEvent"><bdi class="secno">5.1 </bdi>
                            接口 InputEvent
                        </a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#overview"><bdi class="secno">5.1.1 </bdi>
                                    概述
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#interface-InputEvent-Attributes"><bdi
                                        class="secno">5.1.2 </bdi>
                                    属性
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#interface-InputEvent-Methods"><bdi
                                        class="secno">5.1.3 </bdi>
                                    方法
                                </a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#event-definitions"><bdi class="secno">5.2 </bdi>
                            事件定义
                        </a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#privacy-and-security-considerations"><bdi class="secno">6.
                    </bdi>
                    隐私和安全考虑
                </a></li>
            <li class="tocline"><a class="tocxref" href="#acknowledgements"><bdi class="secno">7. </bdi>
                    致谢
                </a></li>
            <li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">A. </bdi>参考资料</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">A.1
                            </bdi>参考性引用资料</a></li>
                </ol>
            </li>
        </ol>
    </nav>
    <section id="introduction">
        <div class="header-wrapper">
            <h2 id="x1-introduction"><bdi class="secno">1. </bdi>介绍</h2>
            <a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a>
        </div>

        <p>
            本文档描述了与编辑相关的两个事件的扩展 ——
            <a href="https://w3c.github.io/uievents/#event-type-input">input</a>
            和 <a href="https://w3c.github.io/uievents/#beforeinput">beforeinput</a>，它们在 UI 事件规范中有详细说明 [<cite><a
                    class="bibref" data-link-type="biblio" href="#bib-ui-events"
                    title="UI Events">UI-EVENTS</a></cite>]。这些事件的目标是允许开发者在编辑发生前后理解和/或覆盖默认的编辑行为。
        </p>
    </section>
    <section id="definitions">
        <div class="header-wrapper">
            <h2 id="x2-definitions"><bdi class="secno">2. </bdi>定义</h2>
            <a class="self-link" href="#definitions" aria-label="Permalink for Section 2."></a>
        </div>

        <dl>
            <dt>
                <code><dfn id="dfn-datatransfer" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer">DataTransfer</a></dfn></code>
            </dt>
            <dd>
                <a href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer">DataTransfer</a>
                对象为某些输入类型包含富文本和纯文本数据。 [<cite><a class="bibref" data-link-type="biblio" href="#bib-html"
                        title="HTML Standard">HTML</a></cite>]
            </dd>
            <dt>
                <dfn id="dfn-express-intention" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">表达意图</dfn>
            </dt>
            <dd>
                用户可以通过键盘、输入法、语音或类似方式
                <a data-lt="express intention" href="#dfn-express-intention" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-express-intention-1">表达意图</a>
                来执行特定的编辑操作。具体的输入操作遵循平台特定的约定映射到意图。
            </dd>
            <dt>
                <dfn id="dfn-kill-buffer" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">kill buffer</dfn>
            </dt>
            <dd>
                <p>
                    <i>此定义不是规范性的。</i>
                </p>
                <a href="#dfn-kill-buffer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-kill-buffer-1">kill
                    buffer</a> 是一个内存中的富文本内容存储，与剪贴板分开，允许临时存储通过特定删除命令删除的内容。用户可以通过表达意图来用 kill buffer 中的内容替换当前选择，表达意图时会 <dfn
                    id="dfn-yank" tabindex="0" aria-haspopup="dialog" class="respec-offending-element"
                    title="Found definition for &quot;yank&quot;, but nothing links to it. This is usually a spec bug!"
                    data-dfn-type="dfn">yank</dfn> kill buffer 的内容。
            </dd>
            <dt>
                <dfn data-plurals="characters" id="dfn-character" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">字符</dfn>
            </dt>
            <dd>
                <a href="#dfn-character" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-character-1">字符</a>
                是一个 <a href="http://www.unicode.org/reports/tr29/#Grapheme_Cluster_Boundaries">扩展字素簇</a>。[<cite><a
                        class="bibref" data-link-type="biblio" href="#bib-uax29"
                        title="Unicode Text Segmentation">UAX29</a></cite>]
            </dd>
        </dl>
    </section>
    <section id="problems-solved">
        <div class="header-wrapper">
            <h2 id="x3-problems-solved"><bdi class="secno">3. </bdi>解决的问题</h2>
            <a class="self-link" href="#problems-solved" aria-label="Permalink for Section 3."></a>
        </div>

        <p>
            <i>本节为非规范性。</i>
        </p>
        <p>
            创建基于网页的文本编辑器需要在浏览器代码之外编写大量的 JavaScript，原因包括：
        </p>
        <ol>
            <li>浏览器对某些编辑操作的处理方式并不一致。</li>
            <li>浏览器在处理某些编辑操作时往往会出现漏洞。</li>
            <li>各个网站可能会有自己处理某些编辑操作的自定义偏好。</li>
            <li>浏览器中的高级文本编辑功能开发并没有遵循 <a href="https://extensiblewebmanifesto.org/">可扩展 Web 宣言</a> 的原则，即这些功能的开发并不总是与 Web
                开发者社区的需求协调进行。</li>
        </ol>
        <p>
            本规范旨在通过提供一种简单的方法来缓解这一问题，允许 Web 开发者通过 <a href="#dfn-beforeinput" class="internalDFN" data-link-type="dfn"
                id="ref-for-dfn-beforeinput-1">beforeinput</a> 事件覆盖浏览器对所有与文本编辑相关的用户输入的处理，并通过 <a href="#dfn-input"
                class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-1">input</a> 事件监控浏览器因用户输入而在 DOM 中的更改。
        </p>
    </section>
    <section id="use-cases">
        <div class="header-wrapper">
            <h2 id="x4-use-cases"><bdi class="secno">4. </bdi>使用案例</h2>
            <a class="self-link" href="#use-cases" aria-label="Permalink for Section 4."></a>
        </div>

        <p>
            <i>本节为非规范性。</i>
        </p>
        <ol>
            <li>创建一个 JavaScript 文本编辑器，其中使用 &lt;strong&gt; 标签代替 &lt;b&gt;
                标签来标记用户标记为加粗的文本，使用任何浏览器内置的方式加粗文本，而不需要访问所有现有的浏览器。</li>
            <li>创建一个 JavaScript 文本编辑器，该编辑器在后台使用数据模型，并由 JavaScript 负责将编辑文本的更改渲染到 DOM。</li>
            <li>创建一个 JavaScript 编辑器，该编辑器只允许富文本编辑的某个子集（例如：允许加粗，但不允许斜体）。</li>
            <li>创建一个协作编辑器，JavaScript 用于根据用户意图渲染 DOM 中的更改，用户使用不同的浏览器以不同的方式表达特定的意图。</li>
            <li>创建一个具有不同用户访问选项的 JavaScript 编辑器，其中一些用户只能添加或删除文本，另一些用户只能添加或删除某些类型的格式。</li>
        </ol>
    </section>
    <section id="events-inputevents">
        <div class="header-wrapper">
            <h2 id="x5-input-event-types"><bdi class="secno">5. </bdi>输入事件类型</h2>
            <a class="self-link" href="#events-inputevents" aria-label="Permalink for Section 5."></a>
        </div>

        <p>
            在用户尝试编辑标记时，输入事件会在操作之前（beforeinput 事件）和之后（input 事件）发送。这包括内容的插入和删除，以及格式更改。
        </p>
        <p>
            输入事件会在作为编辑主机的元素上 <a href="https://www.w3.org/TR/uievents/#dispatch">调度</a> [<cite><a class="bibref"
                    data-link-type="biblio" href="#bib-ui-events" title="UI Events">UI-EVENTS</a></cite>]，这些元素包括设置了
            contenteditable 属性的元素、<a data-link-type="element"
                href="https://html.spec.whatwg.org/multipage/form-elements.html#the-textarea-element"><code>textarea</code></a>
            元素，以及允许文本输入的
            <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/input.html#the-input-element">input</a></code>
            元素。
        </p>

        <section id="interface-InputEvent">
            <div class="header-wrapper">
                <h3 id="x5-1-interface-inputevent"><bdi class="secno">5.1 </bdi>接口 InputEvent</h3>
                <a class="self-link" href="#interface-InputEvent" aria-label="Permalink for Section 5.1"></a>
            </div>

            <pre class="idl def" data-cite="WEBIDL HTML" id="webidl-827932857">
<span class="idlHeader"><a class="self-link" href="#webidl-827932857">WebIDL</a></span>
<code>
<span data-idl="" class="idlInterface" id="idl-def-inputevent-partial-1" data-title="InputEvent">partial interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-inputevent"><code>InputEvent</code></a> {<span data-idl="" class="idlAttribute" id="idl-def-inputevent-datatransfer" data-title="dataTransfer" data-dfn-for="InputEvent">
       readonly attribute<span class="idlType"> <a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer"><code>DataTransfer</code></a>?</span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-inputevent-datatransfer" id="ref-for-dom-inputevent-datatransfer-1"><code>dataTransfer</code></a>;</span><span data-idl="" class="idlMethod" id="idl-def-inputevent-gettargetranges" data-title="getTargetRanges" data-dfn-for="InputEvent"><span class="idlType">
       <a data-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="https://dom.spec.whatwg.org/#interface-staticrange">StaticRange</a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-inputevent-gettargetranges" id="ref-for-dom-inputevent-gettargetranges-1"><code>getTargetRanges</code></a>();</span>
    };</span><span data-idl="" class="idlDictionary" id="idl-def-inputeventinit-partial-1" data-title="InputEventInit">
    
    partial dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dom-inputeventinit"><code>InputEventInit</code></a> {<span data-idl="" class="idlMember" id="idl-def-inputeventinit-datatransfer" data-title="dataTransfer" data-dfn-for="InputEventInit"><span class="idlType">
       <a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer"><code>DataTransfer</code></a>?</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-inputeventinit-datatransfer" id="ref-for-dom-inputeventinit-datatransfer-1"><code>dataTransfer</code></a> = null;</span><span data-idl="" class="idlMember" id="idl-def-inputeventinit-targetranges" data-title="targetRanges" data-dfn-for="InputEventInit"><span class="idlType">
       <a data-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="https://dom.spec.whatwg.org/#interface-staticrange">StaticRange</a>&gt;</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-inputeventinit-targetranges" id="ref-for-dom-inputeventinit-targetranges-1"><code>targetRanges</code></a> = [];</span>
    };</span></code></pre>
            <p>
                <code><dfn id="dom-inputevent" data-idl="interface" data-title="InputEvent" data-dfn-for="" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a href="https://www.w3.org/TR/uievents/#interface-inputevent">InputEvent</a></dfn></code>
                和
                <code><dfn id="dom-inputeventinit" data-idl="dictionary" data-title="InputEventInit" data-dfn-for="" class="externalDFN" data-no-export="" data-dfn-type="dfn"><a href="https://www.w3.org/TR/uievents/#interface-inputevent">InputEventInit</a></dfn></code>
                对象定义于 [<cite><a class="bibref" data-link-type="biblio" href="#bib-ui-events"
                        title="UI Events">UI-EVENTS</a></cite>]。
            </p>
            <p data-dfn-for="InputEventInit">
                <dfn id="dfn-inputtype" tabindex="0" aria-haspopup="dialog" class="respec-offending-element"
                    title="Found definition for &quot;inputType&quot;, but nothing links to it. This is usually a spec bug!"
                    data-dfn-type="dfn">inputType</dfn>、<dfn data-export="" data-dfn-type="dict-member"
                    id="dom-inputeventinit-datatransfer" data-idl="field" data-title="dataTransfer"
                    data-dfn-for="InputEventInit" data-type="DataTransfer" tabindex="0"
                    aria-haspopup="dialog"><code>dataTransfer</code></dfn> 和
                <dfn data-export="" data-dfn-type="dict-member" id="dom-inputeventinit-targetranges" data-idl="field"
                    data-title="targetRanges" data-dfn-for="InputEventInit" data-type="sequence" tabindex="0"
                    aria-haspopup="dialog"><code>targetRanges</code></dfn> 属性会初始化 <a data-link-type="idl"
                    href="https://www.w3.org/TR/uievents/#interface-inputevent"><code>InputEventInit</code></a> 对象的对应属性。
            </p>

            <section id="overview">
                <div class="header-wrapper">
                    <h4 id="x5-1-1-overview"><bdi class="secno">5.1.1 </bdi>概述</h4>
                    <a class="self-link" href="#overview" aria-label="第 5.1.1 节的固定链接"></a>
                </div>

                <p><i>本节是非规范性的。</i></p>
                <p data-link-for="InputEvent">
                    下表总结了 <a href="#dfn-data" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-data-1"><code>data</code></a> 和
                    <a href="#dom-inputevent-datatransfer" class="internalDFN" data-link-type="idl"
                        id="ref-for-dom-inputevent-datatransfer-2"><code>dataTransfer</code></a>
                    属性在何时包含内容、何时为 null，以及 <a href="#dom-inputevent-gettargetranges" class="internalDFN"
                        data-link-type="idl"
                        id="ref-for-dom-inputevent-gettargetranges-2"><code>getTargetRanges()</code></a>
                    方法何时返回空数组或非空数组，取决于 inputType。
                </p>
                <table class="parameters simple">
                    <thead>
                        <tr>
                            <th>编辑主机</th>
                            <th>inputType</th>
                            <th>data</th>
                            <th>dataTransfer</th>
                            <th>getTargetRanges()</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Contenteditable</td>
                            <td>
                                <code>"insertText"</code>,
                                <code>"insertCompositionText"</code>,
                                <code>"formatSetBlockTextDirection"</code>,
                                <code>"formatSetInlineTextDirection"</code>,
                                <code>"formatBackColor"</code>,
                                <code>"formatFontColor"</code>,
                                <code>"formatFontName"</code>, <code>"insertLink"</code>
                            </td>
                            <td>是</td>
                            <td>null</td>
                            <td>非空数组</td>
                        </tr>
                        <tr>
                            <td>Contenteditable</td>
                            <td>
                                <code>"insertFromPaste"</code>,
                                <code>"insertFromPasteAsQuotation"</code>,
                                <code>"insertFromDrop"</code>,
                                <code>"insertReplacementText"</code>,
                                <code>"insertFromYank"</code>
                            </td>
                            <td>null</td>
                            <td>是</td>
                            <td>非空数组</td>
                        </tr>
                        <tr>
                            <td><code>&lt;textarea&gt;</code>, <code>&lt;input type="text"&gt;</code></td>
                            <td>
                                <code>"insertText"</code>,
                                <code>"insertCompositionText"</code>,
                                <code>"insertFromPaste"</code>,
                                <code>"insertFromPasteAsQuotation"</code>,
                                <code>"insertFromDrop"</code>,
                                <code>"insertReplacementText"</code>,
                                <code>"insertFromYank"</code>,
                                <code>"formatSetBlockTextDirection"</code>,
                                <code>"formatSetInlineTextDirection"</code>,
                                <code>"formatBackColor"</code>,
                                <code>"formatFontColor"</code>,
                                <code>"formatFontName"</code>, <code>"insertLink"</code>
                            </td>
                            <td>是</td>
                            <td>null</td>
                            <td>空数组</td>
                        </tr>
                        <tr>
                            <td>全部</td>
                            <td><code>"historyUndo"</code>, <code>"historyRedo"</code></td>
                            <td>null</td>
                            <td>null</td>
                            <td>空数组</td>
                        </tr>
                        <tr>
                            <td>Contenteditable</td>
                            <td>所有剩余</td>
                            <td>null</td>
                            <td>null</td>
                            <td>非空数组</td>
                        </tr>
                        <tr>
                            <td><code>&lt;textarea&gt;</code>, <code>&lt;input type="text"&gt;</code></td>
                            <td>所有剩余</td>
                            <td>null</td>
                            <td>null</td>
                            <td>空数组</td>
                        </tr>
                    </tbody>
                </table>
            </section>
            <section id="interface-InputEvent-Attributes" data-dfn-for="InputEvent">
                <div class="header-wrapper">
                    <h4 id="x5-1-2-attributes"><bdi class="secno">5.1.2 </bdi>属性</h4>
                    <a class="self-link" href="#interface-InputEvent-Attributes" aria-label="第 5.1.2 节的固定链接"></a>
                </div>

                <p>beforeinput 事件的可取消性取决于 inputType。</p>
                <p>
                    要选择的 inputType 取决于用户的 <a data-lt="express intention" href="#dfn-express-intention"
                        class="internalDFN" data-link-type="dfn" id="ref-for-dfn-express-intention-2">意图表达</a>，编辑是否在 IME
                    组成期间发生，以及选择的状态。
                </p>
                <p>
                    本规范定义了 <dfn id="dfn-inputtype-values" tabindex="0" aria-haspopup="dialog"
                        class="respec-offending-element"
                        title="Found definition for &quot;inputType values&quot;, but nothing links to it. This is usually a spec bug!"
                        data-dfn-type="dfn">inputType 值</dfn>，如下表中的 inputType 列所示。
                </p>
                <table class="parameters simple">
                    <thead>
                        <tr>
                            <th>inputType</th>
                            <th>用户的意图表达</th>
                            <th>IME 组成的一部分</th>
                            <th>beforeinput 可取消</th>
                            <th>选择状态</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>"insertText"</code></td>
                            <td>插入键入的纯文本</td>
                            <td>否</td>
                            <td>未定义</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"insertReplacementText"</code></td>
                            <td>通过拼写检查器、自动更正或类似方式替换现有文本</td>
                            <td>否</td>
                            <td>未定义</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"insertLineBreak"</code></td>
                            <td>插入换行符</td>
                            <td>否</td>
                            <td>未定义</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"insertParagraph"</code></td>
                            <td>插入段落分隔符</td>
                            <td>否</td>
                            <td>未定义</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"insertOrderedList"</code></td>
                            <td>插入有序列表</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"insertUnorderedList"</code></td>
                            <td>插入无序列表</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"insertHorizontalRule"</code></td>
                            <td>插入水平线</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"insertFromYank"</code></td>
                            <td>用存储在 <a href="#dfn-kill-buffer" class="internalDFN" data-link-type="dfn"
                                    id="ref-for-dfn-kill-buffer-2">kill buffer</a> 中的内容替换当前选择</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"insertFromDrop"</code></td>
                            <td>通过拖放插入内容到 DOM 中</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"insertFromPaste"</code></td>
                            <td>粘贴</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"insertFromPasteAsQuotation"</code></td>
                            <td>以引用形式粘贴内容</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"insertTranspose"</code></td>
                            <td>互换最后输入的两个 <a data-lt="character" href="#dfn-character" class="internalDFN"
                                    data-link-type="dfn" id="ref-for-dfn-character-2">字符</a></td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"insertCompositionText"</code></td>
                            <td>替换当前的组成字符串</td>
                            <td>是</td>
                            <td>否</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"insertLink"</code></td>
                            <td>插入链接</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"deleteWordBackward"</code></td>
                            <td>删除光标位置前的一个单词</td>
                            <td>否</td>
                            <td>未定义</td>
                            <td>已折叠</td>
                        </tr>
                        <tr>
                            <td><code>"deleteWordForward"</code></td>
                            <td>删除光标位置后的一个单词</td>
                            <td>否</td>
                            <td>未定义</td>
                            <td>已折叠</td>
                        </tr>
                        <tr>
                            <td><code>"deleteSoftLineBackward"</code></td>
                            <td>从光标到最近的视觉换行符之间删除</td>
                            <td>否</td>
                            <td>未定义</td>
                            <td>已折叠</td>
                        </tr>
                        <tr>
                            <td><code>"deleteSoftLineForward"</code></td>
                            <td>从光标到最近的视觉换行符之后删除</td>
                            <td>否</td>
                            <td>未定义</td>
                            <td>已折叠</td>
                        </tr>
                        <tr>
                            <td><code>"deleteEntireSoftLine"</code></td>
                            <td>从光标位置前的视觉换行符到光标位置后的视觉换行符之间删除</td>
                            <td>否</td>
                            <td>未定义</td>
                            <td>已折叠</td>
                        </tr>
                        <tr>
                            <td><code>"deleteHardLineBackward"</code></td>
                            <td>从光标位置删除到块元素的开头或
                                <code><a data-link-type="element" href="https://html.spec.whatwg.org/#the-br-element">br</a></code>
                                元素之前
                            </td>
                            <td>否</td>
                            <td>未定义</td>
                            <td>已折叠</td>
                        </tr>
                        <tr>
                            <td><code>"deleteHardLineForward"</code></td>
                            <td>从光标位置删除到块元素的末尾或
                                <code><a data-link-type="element" href="https://html.spec.whatwg.org/#the-br-element">br</a></code>
                                元素之后
                            </td>
                            <td>否</td>
                            <td>未定义</td>
                            <td>已折叠</td>
                        </tr>
                        <tr>
                            <td><code>"deleteByDrag"</code></td>
                            <td>通过拖动从 DOM 中移除内容</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"deleteByCut"</code></td>
                            <td>作为剪切的一部分删除当前选择</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"deleteContent"</code></td>
                            <td>删除选择内容而不指定删除的方向，该意图未被其他 inputType 覆盖</td>
                            <td>否</td>
                            <td>未定义</td>
                            <td>未折叠</td>
                        </tr>
                        <tr>
                            <td><code>"deleteContentBackward"</code></td>
                            <td>删除光标位置前的内容，此意图未被其他 inputType 覆盖，或删除选择并在删除后将选择折叠到起点</td>
                            <td>否</td>
                            <td>未定义</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"deleteContentForward"</code></td>
                            <td>删除光标位置后的内容，此意图未被其他 inputType 覆盖，或删除选择并在删除后将选择折叠到终点</td>
                            <td>否</td>
                            <td>未定义</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"historyUndo"</code></td>
                            <td>撤销上一次编辑操作</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"historyRedo"</code></td>
                            <td>重做上次撤销的编辑操作</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatBold"</code></td>
                            <td>启用粗体文本</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatItalic"</code></td>
                            <td>启用斜体文本</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatUnderline"</code></td>
                            <td>启用下划线文本</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatStrikeThrough"</code></td>
                            <td>启用删除线文本</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatSuperscript"</code></td>
                            <td>启用上标文本</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatSubscript"</code></td>
                            <td>启用下标文本</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatJustifyFull"</code></td>
                            <td>使当前选区完全对齐</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatJustifyCenter"</code></td>
                            <td>使当前选区居中对齐</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatJustifyRight"</code></td>
                            <td>使当前选区右对齐</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatJustifyLeft"</code></td>
                            <td>使当前选区左对齐</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatIndent"</code></td>
                            <td>缩进当前选区</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatOutdent"</code></td>
                            <td>减少当前选区缩进</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatRemove"</code></td>
                            <td>移除当前选区的所有格式</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatSetBlockTextDirection"</code></td>
                            <td>设置文本块方向</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatSetInlineTextDirection"</code></td>
                            <td>设置内联文本方向</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatBackColor"</code></td>
                            <td>更改背景颜色</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatFontColor"</code></td>
                            <td>更改字体颜色</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                        <tr>
                            <td><code>"formatFontName"</code></td>
                            <td>更改字体名称</td>
                            <td>否</td>
                            <td>是</td>
                            <td>任何</td>
                        </tr>
                    </tbody>
                </table>
                <div class="note" role="note" id="issue-container-generatedID">
                    <div role="heading" class="note-title marker" id="h-note" aria-level="5"><span>注意</span></div>
                    <div class="">
                        其他规范可能会扩展此定义。
                    </div>
                </div>
                <div class="note" role="note" id="issue-container-generatedID-0">
                    <div role="heading" class="note-title marker" id="h-note-0" aria-level="5"><span>注意</span></div>
                    <div class="">
                        上述提到的<code>inputTypes</code>的存在并不意味着任何特定的实现都会支持所有这些。
                        但是，如果某个浏览器支持可能导致DOM更改的编辑操作，它<em class="rfc2119">必须</em>
                        <a href="https://www.w3.org/TR/uievents/#dispatch">触发</a>
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-ui-events"
                                title="UI Events">UI-EVENTS</a></cite>]
                        相应的<code>beforeinput</code>和<code>input</code>事件。
                    </div>
                </div>
                <div class="note" role="note" id="issue-container-generatedID-1">
                    <div role="heading" class="note-title marker" id="h-note-1" aria-level="5"><span>注意</span></div>
                    <div class="">
                        如果选择已折叠，<code>"deleteContentBackward"</code>将用于用户请求在文本节点中删除文本时，以及在光标位于文本节点开头时用户意图删除更复杂的元素或合并段落。
                    </div>
                </div>
                <div class="note" role="note" id="issue-container-generatedID-2">
                    <div role="heading" class="note-title marker" id="h-note-2" aria-level="5"><span>注意</span></div>
                    <div class="">
                        如果选择已折叠，<code>"deleteContentForward"</code>将用于用户请求在文本节点中删除文本时，以及在光标位于文本节点末尾时用户意图删除更复杂的元素或合并段落。
                    </div>
                </div>
                <div class="note" role="note" id="issue-container-generatedID-3">
                    <div role="heading" class="note-title marker" id="h-note-3" aria-level="5"><span>注意</span></div>
                    <div class="" data-link-for="InputEvent">
                        <p><i>此注释不是规范性的。</i></p>
                        在某些平台的某些脚本中，带有折叠选择的文本节点内的向后删除操作会删除单个<a href="https://infra.spec.whatwg.org/#code-points">代码点</a>
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-infra"
                                title="Infra Standard">INFRA</a></cite>]，而不是整个<a
                            href="http://www.unicode.org/reports/tr29/#Grapheme_Cluster_Boundaries">字素簇</a>
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-uax29"
                                title="Unicode Text Segmentation">UAX29</a></cite>]。
                        可以使用<a href="#dom-inputevent-gettargetranges" class="internalDFN" data-link-type="idl"
                            id="ref-for-dom-inputevent-gettargetranges-3"><code>getTargetRanges()</code></a>方法来查明浏览器在文本节点中默认会删除多少个<a
                            href="https://infra.spec.whatwg.org/#code-points">代码点</a>
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-infra"
                                title="Infra Standard">INFRA</a></cite>]。
                    </div>
                </div>
                <div class="note" role="note" id="issue-container-generatedID-4">
                    <div role="heading" class="note-title marker" id="h-note-4" aria-level="5"><span>注意</span></div>
                    <div class="" data-link-for="InputEvent">
                        <p><i>此注释不是规范性的。</i></p>
                        在某些平台的某些脚本中，带有折叠选择的文本节点内的向前删除操作会删除整个<a
                            href="http://www.unicode.org/reports/tr29/#Grapheme_Cluster_Boundaries">字素簇</a>
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-uax29"
                                title="Unicode Text Segmentation">UAX29</a></cite>]，而不是单个<a
                            href="https://infra.spec.whatwg.org/#code-points">代码点</a>
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-infra"
                                title="Infra Standard">INFRA</a></cite>]。
                        可以使用<a href="#dom-inputevent-gettargetranges" class="internalDFN" data-link-type="idl"
                            id="ref-for-dom-inputevent-gettargetranges-4"><code>getTargetRanges()</code></a>方法来查明浏览器在文本节点中默认会删除多少个<a
                            href="https://infra.spec.whatwg.org/#code-points">代码点</a>
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-infra"
                                title="Infra Standard">INFRA</a></cite>]。
                    </div>
                </div>
                <p>
                    <dfn id="dfn-data" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><code>data</code></dfn>
                    包含与要添加到文档中的内容相关的纯文本数据。
                </p>
                <table class="parameters simple">
                    <thead>
                        <tr>
                            <th>
                                inputType
                            </th>
                            <th>
                                编辑主机
                            </th>
                            <th>
                                data
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <code>"insertText"</code> 或
                                <code>"insertCompositionText"</code>
                            </td>
                            <td>
                                任何
                            </td>
                            <td>
                                要插入的纯文本字符串
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertFromPaste"</code>,
                                <code>"insertFromPasteAsQuotation"</code>,
                                <code>"insertFromDrop"</code>,
                                <code>"insertTranspose"</code>,
                                <code>"insertReplacementText"</code> 或
                                <code>"insertFromYank"</code>
                            </td>
                            <td>
                                <code><a href="https://html.spec.whatwg.org/multipage/input.html#the-input-element">input</a></code>
                                或
                                <code><a href="https://html.spec.whatwg.org/multipage/form-elements.html#the-textarea-element">textarea</a></code>
                            </td>
                            <td>
                                要插入的纯文本字符串
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatSetInlineTextDirection"</code> 或
                                <code>"formatSetBlockTextDirection"</code>
                            </td>
                            <td>
                                任何
                            </td>
                            <td>
                                <code>"ltr"</code>, <code>"rtl"</code>, <code>"auto"</code>
                                或 <code>"null"</code>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatBackColor"</code> 或
                                <code>"formatFontColor"</code>
                            </td>
                            <td>
                                任何
                            </td>
                            <td>
                                包含建议颜色的字符串，表示<a
                                    href="https://www.w3.org/TR/cssom-1/#serialize-a-css-component-value">序列化的 CSS
                                    组件值</a>
                                [<cite><a class="bibref" data-link-type="biblio" href="#bib-cssom"
                                        title="CSS Object Model (CSSOM)">CSSOM</a></cite>]。
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatFontName"</code>
                            </td>
                            <td>
                                任何
                            </td>
                            <td>
                                建议的字体家族 CSS 属性值
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertLink"</code>
                            </td>
                            <td>
                                任何
                            </td>
                            <td>
                                建议链接的 URL
                            </td>
                        </tr>
                        <tr>
                            <td>
                                其余所有
                            </td>
                            <td>
                                任何
                            </td>
                            <td>
                                null
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>
                    <dfn data-dfn-for="InputEvent" data-export="" data-dfn-type="attribute"
                        id="dom-inputevent-datatransfer" data-idl="attribute" data-title="dataTransfer"
                        data-type="DataTransfer" data-lt="dataTransfer" data-local-lt="InputEvent.dataTransfer"
                        tabindex="0" aria-haspopup="dialog"><code>dataTransfer</code></dfn>
                    保存了有关从文档中提取或添加到文档中的富文本和纯文本数据的信息，
                    如果存在相关数据，存储在<a data-link-type="idl" data-lt="DataTransfer"
                        href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer"><code><code>DataTransfer</code></code></a>
                    对象中。
                </p>
                <table class="parameters simple">
                    <thead>
                        <tr>
                            <th>
                                inputType
                            </th>
                            <th>
                                编辑主机
                            </th>
                            <th>
                                dataTransfer
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <code>"insertFromPaste"</code>,
                                <code>"insertFromPasteAsQuotation"</code>,
                                <code>"insertFromDrop"</code>,
                                <code>"insertTranspose"</code>,
                                <code>"insertReplacementText"</code> 或
                                <code>"insertFromYank"</code>
                            </td>
                            <td>
                                <code>contenteditable</code>
                            </td>
                            <td>
                                一个预填充的 <a data-link-type="idl" data-lt="DataTransfer"
                                    href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer"><code><code>DataTransfer</code></code></a>
                                对象，以便：
                                <ol>
                                    <li>该<a data-link-type="idl" data-lt="DataTransfer"
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer"><code><code>DataTransfer</code></code></a>
                                        对象的<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#drag-data-store">拖动数据存储</a>处于
                                        <a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#concept-dnd-ro">只读</a>模式。
                                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-html"
                                                title="HTML Standard">HTML</a></cite>]
                                    </li>
                                    <li>该<a data-link-type="idl" data-lt="DataTransfer"
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer"><code><code>DataTransfer</code></code></a>
                                        对象的<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#drag-data-store-item-list">拖动数据存储项列表</a>包含一个条目，
                                        其中<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#the-drag-data-item-type-string">拖动数据项类型字符串</a>为
                                        <code>"text/html"</code>，其<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#the-drag-data-item-kind">类型</a>为
                                        <i>纯 Unicode 字符串</i>，其数据为将要粘贴、拖放或添加到内容中的 HTML 表示形式，或者来自<a
                                            href="#dfn-kill-buffer" class="internalDFN" data-link-type="dfn"
                                            id="ref-for-dfn-kill-buffer-3">kill buffer</a>的数据。
                                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-html"
                                                title="HTML Standard">HTML</a></cite>]
                                    </li>
                                    <li>该<a data-link-type="idl" data-lt="DataTransfer"
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer"><code><code>DataTransfer</code></code></a>
                                        对象的<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#the-drag-data-item-kind">拖动数据存储项列表</a>包含一个条目，
                                        其中<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#the-drag-data-item-type-string">拖动数据项类型字符串</a>为
                                        <code>"text/plain"</code>，其<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#the-drag-data-item-kind">类型</a>为
                                        <i>纯 Unicode 字符串</i>，其数据为将要粘贴、拖放或添加到内容中的纯文本表示形式。
                                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-html"
                                                title="HTML Standard">HTML</a></cite>]
                                    </li>
                                </ol>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                其余所有
                            </td>
                            <td>
                                任何
                            </td>
                            <td>
                                null
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>
                    <dfn data-dfn-for="InputEvent" data-export="" data-dfn-type="method"
                        id="dom-inputevent-gettargetranges" data-idl="operation" data-title="getTargetRanges()"
                        data-type="sequence" data-lt="getTargetRanges()"
                        data-local-lt="InputEvent.getTargetRanges|InputEvent.getTargetRanges()|getTargetRanges"
                        tabindex="0" aria-haspopup="dialog"><code>getTargetRanges()</code></dfn> 返回一个
                    <a data-link-type="dfn"
                        href="https://dom.spec.whatwg.org/#interface-staticrange">StaticRanges</a>数组，如果事件未被取消，这些范围将受到影响。
                </p>
            </section>
            <section id="interface-InputEvent-Methods" data-dfn-for="InputEvent">
                <div class="header-wrapper">
                    <h4 id="x5-1-3-methods"><bdi class="secno">5.1.3 </bdi>
                        方法
                    </h4><a class="self-link" href="#interface-InputEvent-Methods" aria-label="第 5.1.3 节的固定链接"></a>
                </div>

                <table class="parameters simple">
                    <thead>
                        <tr>
                            <th>
                                inputType
                            </th>
                            <th>
                                编辑主机
                            </th>
                            <th>
                                <code>getTargetRanges()</code>的响应
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <code>"historyUndo"</code> 或 <code>"historyRedo"</code>
                            </td>
                            <td>
                                任何
                            </td>
                            <td>
                                空数组
                            </td>
                        </tr>
                        <tr>
                            <td>
                                其余所有
                            </td>
                            <td>
                                <code>contenteditable</code>
                            </td>
                            <td>
                                一个与事件相关的 <dfn data-lt="StaticRange" id="dfn-staticrange" class="externalDFN"
                                    data-no-export="" data-dfn-type="dfn"><a
                                        href="https://dom.spec.whatwg.org/#interface-staticrange">StaticRanges</a></dfn>
                                [<cite><a class="bibref" data-link-type="biblio" href="#bib-dom"
                                        title="DOM 标准">DOM</a></cite>]
                            </td>
                        </tr>
                        <tr>
                            <td>
                                其余所有
                            </td>
                            <td>
                                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/input.html#the-input-element">input</a></code>
                                或
                                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/form-elements.html#the-textarea-element">textarea</a></code>
                            </td>
                            <td>
                                空数组
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>
                    返回除非 inputType 为 <code>"historyUndo"</code> 或 <code>"historyRedo"</code>，或者编辑主机不是
                    contenteditable 元素，在这种情况下返回空数组。
                </p>
            </section>
        </section>
        <section id="event-definitions">
            <div class="header-wrapper">
                <h3 id="x5-2-event-definitions"><bdi class="secno">5.2 </bdi>
                    事件定义
                </h3><a class="self-link" href="#event-definitions" aria-label="第 5.2 节的固定链接"></a>
            </div>

            <div class="event-definition">
                <dl>
                    <dt id="event-type-beforeinput">
                        <dfn id="dfn-beforeinput" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a
                                class="eventtype" href="#event-type-beforeinput"><code>beforeinput</code></a></dfn>
                    </dt>
                    <dd>
                        <table class="invisible-table" data-summary="此表包含有关给定事件类型语义的信息">
                            <tbody>
                                <tr>
                                    <th>
                                        类型
                                    </th>
                                    <td>
                                        <strong><code>beforeinput</code></strong>
                                    </td>
                                </tr>
                                <tr>
                                    <th>
                                        接口
                                    </th>
                                    <td>
                                        <a href="#interface-InputEvent"><code>InputEvent</code></a>
                                    </td>
                                </tr>
                                <tr>
                                    <th>
                                        同步 / 异步
                                    </th>
                                    <td>
                                        同步
                                    </td>
                                </tr>
                                <tr>
                                    <th>
                                        冒泡
                                    </th>
                                    <td>
                                        是
                                    </td>
                                </tr>
                                <tr>
                                    <th>
                                        可信目标
                                    </th>
                                    <td>
                                        启用了 <code>contenteditable</code> 属性的任何 <code>Element</code>。
                                    </td>
                                </tr>
                                <tr>
                                    <th>
                                        <a href="https://www.w3.org/TR/uievents/#default-action">默认操作</a> [<cite><a
                                                class="bibref" data-link-type="biblio" href="#bib-ui-events"
                                                title="UI Events">UI-EVENTS</a></cite>]
                                    </th>
                                    <td>
                                        视情况而定： 对于 inputType <code>"insertCompositionText"</code> 的
                                        contentEditable=typing 编辑主机，更新DOM；
                                        对于所有 inputTypes 的 <code>contentEditable="true"</code> 编辑主机，更新 DOM 元素。
                                        否则无操作。
                                    </td>
                                </tr>
                                <tr>
                                    <th>
                                        上下文<br>
                                        (可信事件)
                                    </th>
                                    <td>
                                        <ul>
                                            <li>
                                                <a href="#dfn-data" id="ref-for-dfn-data-2"><code
                                                        class="attribute-name">InputEvent.data</code></a>：
                                                包含添加到元素中的数据的字符串，如果不适用，则<em class="rfc2119">MAY</em> 为 null。
                                            </li>
                                            <li>
                                                <a href="#dom-inputevent-datatransfer"
                                                    id="ref-for-dom-inputevent-datatransfer-3"><code
                                                        class="attribute-name">InputEvent.dataTransfer</code></a>：
                                                添加或从元素中删除的富文本数据，如果不适用，则 <em class="rfc2119">MAY</em> 为 null。
                                            </li>
                                            <li>
                                                <a href="#dom-inputevent-gettargetranges" class="internalDFN"
                                                    data-link-type="idl"
                                                    id="ref-for-dom-inputevent-gettargetranges-5"><code
                                                        class="methods-name">InputEvent.getTargetRanges()</code></a>：
                                                返回事件将影响的 <a data-link-type="dfn"
                                                    href="https://dom.spec.whatwg.org/#interface-staticrange">StaticRanges</a>
                                                数组，如果事件未取消。
                                            </li>
                                        </ul>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <p>
                            当用户尝试在 contenteditable 元素中输入时，<a href="https://www.w3.org/TR/uievents/#user-agent">用户代理</a>
                            <em class="rfc2119">MUST</em>
                            <a href="https://www.w3.org/TR/uievents/#dispatch">派发</a> [<cite><a class="bibref"
                                    data-link-type="biblio" href="#bib-ui-events"
                                    title="UI Events">UI-EVENTS</a></cite>] 此事件。
                            这并不一定意味着 <a href="https://www.w3.org/TR/uievents/#user-agent">用户代理</a>
                            [<cite><a class="bibref" data-link-type="biblio" href="#bib-ui-events"
                                    title="UI Events">UI-EVENTS</a></cite>] 会随后更新 DOM。
                        </p>
                        <p>
                            由于非用户输入引起的事件（例如系统事件），<a href="https://www.w3.org/TR/uievents/#user-agent">用户代理</a> <em
                                class="rfc2119">MUST NOT</em>
                            <a href="https://www.w3.org/TR/uievents/#dispatch">派发</a> [<cite><a class="bibref"
                                    data-link-type="biblio" href="#bib-ui-events"
                                    title="UI Events">UI-EVENTS</a></cite>] 此事件。
                        </p>
                    </dd>
                </dl>
            </div>

            <div class="event-definition">
                <dl>
                    <dt id="event-type-input">
                        <dfn id="dfn-input" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a class="eventtype"
                                href="#event-type-input"><code>input</code></a></dfn>
                    </dt>
                    <dd>
                        <table class="invisible-table" data-summary="此表包含有关给定事件类型语义的信息">
                            <tbody>
                                <tr>
                                    <th>
                                        类型
                                    </th>
                                    <td>
                                        <strong><code>input</code></strong>
                                    </td>
                                </tr>
                                <tr>
                                    <th>
                                        接口
                                    </th>
                                    <td>
                                        <a href="#interface-InputEvent"><code>InputEvent</code></a>
                                    </td>
                                </tr>
                                <tr>
                                    <th>
                                        同步 / 异步
                                    </th>
                                    <td>
                                        同步
                                    </td>
                                </tr>
                                <tr>
                                    <th>
                                        冒泡
                                    </th>
                                    <td>
                                        是
                                    </td>
                                </tr>
                                <tr>
                                    <th>
                                        可信目标
                                    </th>
                                    <td>
                                        启用了 <code>contenteditable</code> 属性的任何 <code>Element</code>。
                                    </td>
                                </tr>
                                <tr>
                                    <th>
                                        <a href="https://www.w3.org/TR/uievents/#default-action">默认操作</a> [<cite><a
                                                class="bibref" data-link-type="biblio" href="#bib-ui-events"
                                                title="UI Events">UI-EVENTS</a></cite>]
                                    </th>
                                    <td>
                                        无
                                    </td>
                                </tr>
                                <tr>
                                    <th>
                                        上下文<br>
                                        (可信事件)
                                    </th>
                                    <td>
                                        <ul>
                                            <li>
                                                <a href="#dfn-data" id="ref-for-dfn-data-3"><code
                                                        class="attribute-name">InputEvent.data</code></a>：
                                                包含添加到元素中的数据的字符串，如果不适用，则 <em class="rfc2119">MAY</em> 为 null。
                                            </li>
                                            <li>
                                                <a href="#dom-inputevent-datatransfer"
                                                    id="ref-for-dom-inputevent-datatransfer-4"><code
                                                        class="attribute-name">InputEvent.dataTransfer</code></a>：
                                                添加或从元素中删除的富文本数据，如果不适用，则 <em class="rfc2119">MAY</em> 为 null。
                                            </li>
                                        </ul>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <p>
                            当用户表达更改文档内容的意图并且浏览器已处理时，<a data-link-type="dfn"
                                href="https://www.w3.org/TR/uievents/#user-agent">用户代理</a>
                            [<cite><a class="bibref" data-link-type="biblio" href="#bib-ui-events"
                                    title="UI Events">UI-EVENTS</a></cite>] <em class="rfc2119">MUST</em>
                            立即 <a data-link-type="dfn" href="https://www.w3.org/TR/uievents/#dispatch">派发</a>
                            [<cite><a class="bibref" data-link-type="biblio" href="#bib-ui-events"
                                    title="UI Events">UI-EVENTS</a></cite>] 此事件。
                        </p>
                    </dd>
                </dl>
            </div>
        </section>
    </section>
    <section id="privacy-and-security-considerations">
        <div class="header-wrapper">
            <h2 id="x6-privacy-and-security-considerations"><bdi class="secno">6. </bdi>
                隐私和安全考虑
            </h2><a class="self-link" href="#privacy-and-security-considerations" aria-label="第 6 节的固定链接"></a>
        </div>

        <p>
            <i>本节不具规范性。</i>
        </p>
        <p>
            除了现有事件（如 <a data-link-type="dfn" href="https://www.w3.org/TR/uievents/#keydown"><code>keydown</code></a> 和
            <a data-link-type="dfn" href="https://www.w3.org/TR/uievents/#keypress"><code>keypress</code></a>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-ui-events"
                    title="UI Events">UI-EVENTS</a></cite>] 事件）已经可用的
            <a data-link-type="dfn"
                href="https://www.w3.org/TR/fingerprinting-guidance/#dfn-browser-fingerprinting">指纹识别</a>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-fingerprinting-guidance"
                    title="Mitigating Browser Fingerprinting in Web Specifications">fingerprinting-guidance</a></cite>]
            技术之外，此功能没有已知的安全或隐私影响。
        </p>
        <p>
            如果该功能替代了现有的事件，它<em class="rfc2119">可能</em> 导致可用的
            <a data-link-type="dfn"
                href="https://www.w3.org/TR/fingerprinting-guidance/#dfn-browser-fingerprinting">指纹识别</a>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-fingerprinting-guidance"
                    title="Mitigating Browser Fingerprinting in Web Specifications">fingerprinting-guidance</a></cite>]
            技术减少，因为用户的意图被记录，而不是他们使用的硬件类型来
            <a data-lt="express intention" href="#dfn-express-intention" class="internalDFN" data-link-type="dfn"
                id="ref-for-dfn-express-intention-3">表达</a> 这种意图。
        </p>
    </section>

    <section id="acknowledgements">
        <div class="header-wrapper">
            <h2 id="x7-acknowledgements"><bdi class="secno">7. </bdi>
                致谢
            </h2><a class="self-link" href="#acknowledgements" aria-label="第 7 节的固定链接"></a>
        </div>

        <p>
            感谢: Michael Aufreiter, Adrian Bateman, Oliver Buchtala, Robin Berjon, Enrica Casucci, Bo Cupp, Domenic
            Denicola,
            Emil Eklund, Olivier Forget, Aryeh Gregor, Marijn Haverbeke, Yoshifumi Inoue, Koji Ishii, Gary Kacmarcik,
            Ian Kilpatrick,
            Frederico Caldeira Knabben, Takayoshi Kochi, Piotrek Koszuliński, Travis Leithead, Grisha Lyukshin, Miles
            Maxfield,
            Chaals McCathie Nevile, Masayuki Nakano, Ryosuke Niwa, Julie Parent, Ben Peters, Florian Rivoal, Morgan
            Smith,
            Hallvord R. M. Steen, Johan Sörlin, Cristian Talau, Dave Tapuska, Ojan Vafai, Léonie Watson, Xiaoqian Wu,
            Chong Zhang,
            Joanmarie, 以及所有参与编辑任务组的成员们，感谢你们的贡献和反馈。
        </p>
    </section>

    <section id="references" class="appendix">
        <div class="header-wrapper">
            <h2 id="a-references"><bdi class="secno">A. </bdi>参考资料</h2><a class="self-link" href="#references"
                aria-label="附录 A 的固定链接"></a>
        </div>
        <section id="informative-references">
            <div class="header-wrapper">
                <h3 id="a-1-informative-references"><bdi class="secno">A.1 </bdi>参考性引用资料</h3><a class="self-link"
                    href="#informative-references" aria-label="附录 A.1 的固定链接"></a>
            </div>

            <dl class="bibliography">
                <dt id="bib-cssom">[CSSOM]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/cssom-1/"><cite>CSS Object Model (CSSOM)</cite></a>. Daniel Glazman;
                    Emilio Cobos Álvarez. W3C. 2021 年 8 月 26 日. W3C 工作草案. URL: <a
                        href="https://www.w3.org/TR/cssom-1/">https://www.w3.org/TR/cssom-1/</a>
                </dd>
                <dt id="bib-dom">[DOM]</dt>
                <dd>
                    <a href="https://dom.spec.whatwg.org/"><cite>DOM 标准</cite></a>. Anne van Kesteren. WHATWG.
                    现行标准. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-fingerprinting-guidance">[fingerprinting-guidance]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/fingerprinting-guidance/"><cite>减轻 Web 规范中的浏览器指纹识别</cite></a>.
                    Nick Doty. W3C. 2019 年 3 月 28 日. W3C 工作组说明. URL: <a
                        href="https://www.w3.org/TR/fingerprinting-guidance/">https://www.w3.org/TR/fingerprinting-guidance/</a>
                </dd>
                <dt id="bib-html">[HTML]</dt>
                <dd>
                    <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML 标准</cite></a>. Anne van Kesteren;
                    Domenic Denicola; Ian Hickson; Philip Jägenstedt; Simon Pieters. WHATWG. 现行标准. URL: <a
                        href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
                </dd>
                <dt id="bib-infra">[INFRA]</dt>
                <dd>
                    <a href="https://infra.spec.whatwg.org/"><cite>Infra 标准</cite></a>. Anne van Kesteren; Domenic
                    Denicola. WHATWG. 现行标准. URL: <a
                        href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-input-events">[INPUT-EVENTS]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/input-events-1/"><cite>输入事件级别 1</cite></a>. Johannes Wilm; Ben
                    Peters.
                    W3C. 2019 年 5 月 30 日. W3C 工作草案. URL: <a
                        href="https://www.w3.org/TR/input-events-1/">https://www.w3.org/TR/input-events-1/</a>
                </dd>
                <dt id="bib-uax29">[UAX29]</dt>
                <dd>
                    <a href="https://www.unicode.org/reports/tr29/tr29-43.html"><cite>Unicode 文本分割</cite></a>. Josh
                    Hadley.
                    Unicode 联盟. 2023 年 8 月 16 日. Unicode 标准附录 #29. URL: <a
                        href="https://www.unicode.org/reports/tr29/tr29-43.html">https://www.unicode.org/reports/tr29/tr29-43.html</a>
                </dd>
                <dt id="bib-ui-events">[UI-EVENTS]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/uievents/"><cite>UI 事件</cite></a>. Gary Kacmarcik; Travis Leithead.
                    W3C.
                    2023 年 9 月 15 日. W3C 工作草案. URL: <a
                        href="https://www.w3.org/TR/uievents/">https://www.w3.org/TR/uievents/</a>
                </dd>
                <dt id="bib-webidl">[WEBIDL]</dt>
                <dd>
                    <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL 标准</cite></a>. Edgar Chen; Timothy Gu.
                    WHATWG.
                    现行标准. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
                </dd>
            </dl>
        </section>
    </section>
    <p role="navigation" id="back-to-top">
        <a href="#title"><abbr title="回到顶部">↑</abbr></a>
    </p>    
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-express-intention"
        aria-label="Links in this document to definition: express intention">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-express-intention"
                aria-label="Permalink for definition: express intention. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-express-intention-1" title="§ 2. Definitions">§ 2. Definitions</a>
            </li>
            <li>
                <a href="#ref-for-dfn-express-intention-2" title="§ 5.1.2 Attributes">§ 5.1.2 Attributes</a>
            </li>
            <li>
                <a href="#ref-for-dfn-express-intention-3" title="§ 6. Privacy and security considerations">§ 6. Privacy
                    and security considerations</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-kill-buffer"
        aria-label="Links in this document to definition: kill buffer">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-kill-buffer"
                aria-label="Permalink for definition: kill buffer. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-kill-buffer-1" title="§ 2. Definitions">§ 2. Definitions</a>
            </li>
            <li>
                <a href="#ref-for-dfn-kill-buffer-2" title="§ 5.1.2 Attributes">§ 5.1.2 Attributes</a> <a
                    href="#ref-for-dfn-kill-buffer-3" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-yank"
        aria-label="Links in this document to definition: yank">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-yank"
                aria-label="Permalink for definition: yank. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-character"
        aria-label="Links in this document to definition: character">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-character"
                aria-label="Permalink for definition: character. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-character-1" title="§ 2. Definitions">§ 2. Definitions</a>
            </li>
            <li>
                <a href="#ref-for-dfn-character-2" title="§ 5.1.2 Attributes">§ 5.1.2 Attributes</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-inputtype"
        aria-label="Links in this document to definition: inputType">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-inputtype"
                aria-label="Permalink for definition: inputType. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-inputeventinit-datatransfer"
        aria-label="Links in this document to definition: dataTransfer">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-inputeventinit-datatransfer"
                aria-label="Permalink for definition: dataTransfer. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-827932857">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-inputeventinit-datatransfer-1" title="§ 5.1 Interface InputEvent">§ 5.1 Interface
                    InputEvent</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-inputeventinit-targetranges"
        aria-label="Links in this document to definition: targetRanges">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-inputeventinit-targetranges"
                aria-label="Permalink for definition: targetRanges. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-827932857">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-inputeventinit-targetranges-1" title="§ 5.1 Interface InputEvent">§ 5.1 Interface
                    InputEvent</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-inputtype-values"
        aria-label="Links in this document to definition: inputType values">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-inputtype-values"
                aria-label="Permalink for definition: inputType values. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-data"
        aria-label="Links in this document to definition: data">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-data"
                aria-label="Permalink for definition: data. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-data-1" title="§ 5.1.1 Overview">§ 5.1.1 Overview</a>
            </li>
            <li>
                <a href="#ref-for-dfn-data-2" title="§ 5.2 Event definitions">§ 5.2 Event definitions</a> <a
                    href="#ref-for-dfn-data-3" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-inputevent-datatransfer"
        aria-label="Links in this document to definition: dataTransfer">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-inputevent-datatransfer"
                aria-label="Permalink for definition: dataTransfer. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-827932857">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-inputevent-datatransfer-1" title="§ 5.1 Interface InputEvent">§ 5.1 Interface
                    InputEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-inputevent-datatransfer-2" title="§ 5.1.1 Overview">§ 5.1.1 Overview</a>
            </li>
            <li>
                <a href="#ref-for-dom-inputevent-datatransfer-3" title="§ 5.2 Event definitions">§ 5.2 Event
                    definitions</a> <a href="#ref-for-dom-inputevent-datatransfer-4" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-inputevent-gettargetranges"
        aria-label="Links in this document to definition: getTargetRanges()">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-inputevent-gettargetranges"
                aria-label="Permalink for definition: getTargetRanges(). Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-827932857">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-inputevent-gettargetranges-1" title="§ 5.1 Interface InputEvent">§ 5.1 Interface
                    InputEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-inputevent-gettargetranges-2" title="§ 5.1.1 Overview">§ 5.1.1 Overview</a>
            </li>
            <li>
                <a href="#ref-for-dom-inputevent-gettargetranges-3" title="§ 5.1.2 Attributes">§ 5.1.2 Attributes</a> <a
                    href="#ref-for-dom-inputevent-gettargetranges-4" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-inputevent-gettargetranges-5" title="§ 5.2 Event definitions">§ 5.2 Event
                    definitions</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-beforeinput"
        aria-label="Links in this document to definition: beforeinput">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-beforeinput"
                aria-label="Permalink for definition: beforeinput. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-beforeinput-1" title="§ 3. Problems solved">§ 3. Problems solved</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-input"
        aria-label="Links in this document to definition: input">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-input"
                aria-label="Permalink for definition: input. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-input-1" title="§ 3. Problems solved">§ 3. Problems solved</a>
            </li>
        </ul>
    </div>
    <script id="respec-dfn-panel">(() => {
            // @ts-check
            if (document.respec) {
                document.respec.ready.then(setupPanel);
            } else {
                setupPanel();
            }

            function setupPanel() {
                const listener = panelListener();
                document.body.addEventListener("keydown", listener);
                document.body.addEventListener("click", listener);
            }

            function panelListener() {
                /** @type {HTMLElement} */
                let panel = null;
                return event => {
                    const { target, type } = event;

                    if (!(target instanceof HTMLElement)) return;

                    // For keys, we only care about Enter key to activate the panel
                    // otherwise it's activated via a click.
                    if (type === "keydown" && event.key !== "Enter") return;

                    const action = deriveAction(event);

                    switch (action) {
                        case "show": {
                            hidePanel(panel);
                            /** @type {HTMLElement} */
                            const dfn = target.closest("dfn, .index-term");
                            panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
                            const coords = deriveCoordinates(event);
                            displayPanel(dfn, panel, coords);
                            break;
                        }
                        case "dock": {
                            panel.style.left = null;
                            panel.style.top = null;
                            panel.classList.add("docked");
                            break;
                        }
                        case "hide": {
                            hidePanel(panel);
                            panel = null;
                            break;
                        }
                    }
                };
            }

            /**
             * @param {MouseEvent|KeyboardEvent} event
             */
            function deriveCoordinates(event) {
                const target = /** @type HTMLElement */ (event.target);

                // We prevent synthetic AT clicks from putting
                // the dialog in a weird place. The AT events sometimes
                // lack coordinates, so they have clientX/Y = 0
                const rect = target.getBoundingClientRect();
                if (
                    event instanceof MouseEvent &&
                    event.clientX >= rect.left &&
                    event.clientY >= rect.top
                ) {
                    // The event probably happened inside the bounding rect...
                    return { x: event.clientX, y: event.clientY };
                }

                // Offset to the middle of the element
                const x = rect.x + rect.width / 2;
                // Placed at the bottom of the element
                const y = rect.y + rect.height;
                return { x, y };
            }

            /**
             * @param {Event} event
             */
            function deriveAction(event) {
                const target = /** @type {HTMLElement} */ (event.target);
                const hitALink = !!target.closest("a");
                if (target.closest("dfn:not([data-cite]), .index-term")) {
                    return hitALink ? "none" : "show";
                }
                if (target.closest(".dfn-panel")) {
                    if (hitALink) {
                        return target.classList.contains("self-link") ? "hide" : "dock";
                    }
                    const panel = target.closest(".dfn-panel");
                    return panel.classList.contains("docked") ? "hide" : "none";
                }
                if (document.querySelector(".dfn-panel:not([hidden])")) {
                    return "hide";
                }
                return "none";
            }

            /**
             * @param {HTMLElement} dfn
             * @param {HTMLElement} panel
             * @param {{ x: number, y: number }} clickPosition
             */
            function displayPanel(dfn, panel, { x, y }) {
                panel.hidden = false;
                // distance (px) between edge of panel and the pointing triangle (caret)
                const MARGIN = 20;

                const dfnRects = dfn.getClientRects();
                // Find the `top` offset when the `dfn` can be spread across multiple lines
                let closestTop = 0;
                let minDiff = Infinity;
                for (const rect of dfnRects) {
                    const { top, bottom } = rect;
                    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
                    if (diffFromClickY < minDiff) {
                        minDiff = diffFromClickY;
                        closestTop = top;
                    }
                }

                const top = window.scrollY + closestTop + dfnRects[0].height;
                const left = x - MARGIN;
                panel.style.left = `${left}px`;
                panel.style.top = `${top}px`;

                // Find if the panel is flowing out of the window
                const panelRect = panel.getBoundingClientRect();
                const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
                if (panelRect.right > SCREEN_WIDTH) {
                    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
                    const newCaretOffset = left - newLeft;
                    panel.style.left = `${newLeft}px`;
                    /** @type {HTMLElement} */
                    const caret = panel.querySelector(".caret");
                    caret.style.left = `${newCaretOffset}px`;
                }

                // As it's a dialog, we trap focus.
                // TODO: when <dialog> becomes a implemented, we should really
                // use that.
                trapFocus(panel, dfn);
            }

            /**
             * @param {HTMLElement} panel
             * @param {HTMLElement} dfn
             * @returns
             */
            function trapFocus(panel, dfn) {
                /** @type NodeListOf<HTMLAnchorElement> elements */
                const anchors = panel.querySelectorAll("a[href]");
                // No need to trap focus
                if (!anchors.length) return;

                // Move focus to first anchor element
                const first = anchors.item(0);
                first.focus();

                const trapListener = createTrapListener(anchors, panel, dfn);
                panel.addEventListener("keydown", trapListener);

                // Hiding the panel releases the trap
                const mo = new MutationObserver(records => {
                    const [record] = records;
                    const target = /** @type HTMLElement */ (record.target);
                    if (target.hidden) {
                        panel.removeEventListener("keydown", trapListener);
                        mo.disconnect();
                    }
                });
                mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
            }

            /**
             *
             * @param {NodeListOf<HTMLAnchorElement>} anchors
             * @param {HTMLElement} panel
             * @param {HTMLElement} dfn
             * @returns
             */
            function createTrapListener(anchors, panel, dfn) {
                const lastIndex = anchors.length - 1;
                let currentIndex = 0;
                return event => {
                    switch (event.key) {
                        // Hitting "Tab" traps us in a nice loop around elements.
                        case "Tab": {
                            event.preventDefault();
                            currentIndex += event.shiftKey ? -1 : +1;
                            if (currentIndex < 0) {
                                currentIndex = lastIndex;
                            } else if (currentIndex > lastIndex) {
                                currentIndex = 0;
                            }
                            anchors.item(currentIndex).focus();
                            break;
                        }

                        // Hitting "Enter" on an anchor releases the trap.
                        case "Enter":
                            hidePanel(panel);
                            break;

                        // Hitting "Escape" returns focus to dfn.
                        case "Escape":
                            hidePanel(panel);
                            dfn.focus();
                            return;
                    }
                };
            }

            /** @param {HTMLElement} panel */
            function hidePanel(panel) {
                if (!panel) return;
                panel.hidden = true;
                panel.classList.remove("docked");
            }
        })()</script>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
</body>

</html>