<!DOCTYPE html>
<html lang="zh-hans">

<head>
    <meta charset="utf-8">
    <meta name="generator" content="ReSpec 35.1.0">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <style>
        span.example-title {
            text-transform: none
        }

        :is(aside, div).example,
        div.illegal-example {
            padding: .5em;
            margin: 1em 0;
            position: relative;
            clear: both
        }

        div.illegal-example {
            color: red
        }

        div.illegal-example p {
            color: #000
        }

        aside.example div.example {
            border-left-width: .1em;
            border-color: #999;
            background: #fff
        }
    </style>
    <style>
        .issue-label {
            text-transform: initial
        }

        .warning>p:first-child {
            margin-top: 0
        }

        .warning {
            padding: .5em;
            border-left-width: .5em;
            border-left-style: solid
        }

        span.warning {
            padding: .1em .5em .15em
        }

        .issue.closed span.issue-number {
            text-decoration: line-through
        }

        .issue.closed span.issue-number::after {
            content: " (Closed)";
            font-size: smaller
        }

        .warning {
            border-color: #f11;
            border-color: var(--warning-border, #f11);
            border-width: .2em;
            border-style: solid;
            background: #fbe9e9;
            background: var(--warning-bg, #fbe9e9);
            color: #000;
            color: var(--text, #000)
        }

        .warning-title:before {
            content: "⚠";
            font-size: 1.3em;
            float: left;
            padding-right: .3em;
            margin-top: -.3em
        }

        li.task-list-item {
            list-style: none
        }

        input.task-list-item-checkbox {
            margin: 0 .35em .25em -1.6em;
            vertical-align: middle
        }

        .issue a.respec-gh-label {
            padding: 5px;
            margin: 0 2px 0 2px;
            font-size: 10px;
            text-transform: none;
            text-decoration: none;
            font-weight: 700;
            border-radius: 4px;
            position: relative;
            bottom: 2px;
            border: none;
            display: inline-block
        }
    </style>
    <style>
        pre.idl {
            padding: 1em;
            position: relative
        }

        pre.idl>code {
            color: #000;
            color: var(--text, #000)
        }

        @media print {
            pre.idl {
                white-space: pre-wrap
            }
        }

        .idlHeader {
            display: block;
            width: 150px;
            background: #8ccbf2;
            background: var(--def-border, #8ccbf2);
            color: #fff;
            color: var(--defrow-border, #fff);
            font-family: sans-serif;
            font-weight: 700;
            margin: -1em 0 1em -1em;
            height: 28px;
            line-height: 28px
        }

        .idlHeader a.self-link {
            margin-left: .3cm;
            text-decoration: none;
            border-bottom: none;
            color: inherit
        }

        .idlID {
            font-weight: 700;
            color: #005a9c
        }

        .idlType {
            color: #005a9c
        }

        .idlName {
            color: #ff4500
        }

        .idlName a {
            color: #ff4500;
            border-bottom: 1px dotted #ff4500;
            text-decoration: none
        }

        a.idlEnumItem {
            color: #000;
            border-bottom: 1px dotted #ccc;
            text-decoration: none
        }

        .idlSuperclass {
            font-style: italic;
            color: #005a9c
        }

        .idlDefaultValue,
        .idlParamName {
            font-style: italic
        }

        .extAttr {
            color: #666
        }

        .idlSectionComment {
            color: gray
        }

        .idlIncludes a {
            font-weight: 700
        }

        .respec-button-copy-paste:focus {
            text-decoration: none;
            border-color: #51a7e8;
            outline: 0;
            box-shadow: 0 0 5px rgba(81, 167, 232, .5)
        }

        .respec-button-copy-paste:is(:focus:hover, .selected:focus) {
            border-color: #51a7e8
        }

        .respec-button-copy-paste:is(:hover, :active, .zeroclipboard-is-hover, .zeroclipboard-is-active) {
            text-decoration: none;
            background-color: #ddd;
            background-image: linear-gradient(#eee, #ddd);
            border-color: #ccc
        }

        .respec-button-copy-paste:is(:active, .selected, .zeroclipboard-is-active) {
            background-color: #dcdcdc;
            background-image: none;
            border-color: #b5b5b5;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, .15)
        }

        .respec-button-copy-paste.selected:hover {
            background-color: #cfcfcf
        }

        .respec-button-copy-paste:is(:disabled, :disabled:hover, .disabled, .disabled:hover) {
            color: rgba(102, 102, 102, .5);
            cursor: default;
            background-color: rgba(229, 229, 229, .5);
            background-image: none;
            border-color: rgba(197, 197, 197, .5);
            box-shadow: none
        }

        @media print {
            .respec-button-copy-paste {
                visibility: hidden
            }
        }
    </style>
    <style>
        dfn {
            cursor: pointer
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            min-width: 300px;
            max-width: 500px;
            padding: .5em .75em;
            margin-top: .6em;
            font-family: "Helvetica Neue", sans-serif;
            font-size: small;
            background: #fff;
            background: var(--indextable-hover-bg, #fff);
            color: #000;
            color: var(--text, #000);
            box-shadow: 0 1em 3em -.4em rgba(0, 0, 0, .3), 0 0 1px 1px rgba(0, 0, 0, .05);
            box-shadow: 0 1em 3em -.4em var(--tocsidebar-shadow, rgba(0, 0, 0, .3)), 0 0 1px 1px var(--tocsidebar-shadow, rgba(0, 0, 0, .05));
            border-radius: 2px
        }

        .dfn-panel:not(.docked)>.caret {
            position: absolute;
            top: -9px
        }

        .dfn-panel:not(.docked)>.caret::after,
        .dfn-panel:not(.docked)>.caret::before {
            content: "";
            position: absolute;
            border: 10px solid transparent;
            border-top: 0;
            border-bottom: 10px solid #fff;
            border-bottom-color: var(--indextable-hover-bg, #fff);
            top: 0
        }

        .dfn-panel:not(.docked)>.caret::before {
            border-bottom: 9px solid #a2a9b1;
            border-bottom-color: var(--indextable-hover-bg, #a2a9b1)
        }

        .dfn-panel * {
            margin: 0
        }

        .dfn-panel b {
            display: block;
            color: #000;
            color: var(--text, #000);
            margin-top: .25em
        }

        .dfn-panel ul a[href] {
            color: #333;
            color: var(--text, #333)
        }

        .dfn-panel>div {
            display: flex
        }

        .dfn-panel a.self-link {
            font-weight: 700;
            margin-right: auto
        }

        .dfn-panel .marker {
            padding: .1em;
            margin-left: .5em;
            border-radius: .2em;
            text-align: center;
            white-space: nowrap;
            font-size: 90%;
            color: #040b1c
        }

        .dfn-panel .marker.dfn-exported {
            background: #d1edfd;
            box-shadow: 0 0 0 .125em #1ca5f940
        }

        .dfn-panel .marker.idl-block {
            background: #8ccbf2;
            box-shadow: 0 0 0 .125em #0670b161
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important
        }

        .dfn-panel a[href]:hover {
            border-bottom-width: 1px
        }

        .dfn-panel ul {
            padding: 0
        }

        .dfn-panel li {
            margin-left: 1em
        }

        .dfn-panel.docked {
            position: fixed;
            left: .5em;
            top: unset;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - .75em * 2 - .5em - .2em * 2);
            max-height: 30vh;
            overflow: auto
        }
    </style>

    <title>指针锁定 2.0</title>



    <style id="respec-mainstyle">
        @keyframes pop {
            0% {
                transform: scale(1, 1)
            }

            25% {
                transform: scale(1.25, 1.25);
                opacity: .75
            }

            100% {
                transform: scale(1, 1)
            }
        }

        a.internalDFN {
            color: inherit;
            border-bottom: 1px solid #99c;
            text-decoration: none
        }

        a.externalDFN {
            color: inherit;
            border-bottom: 1px dotted #ccc;
            text-decoration: none
        }

        a.bibref {
            text-decoration: none
        }

        .respec-offending-element:target {
            animation: pop .25s ease-in-out 0s 1
        }

        .respec-offending-element,
        a[href].respec-offending-element {
            text-decoration: red wavy underline
        }

        @supports not (text-decoration:red wavy underline) {
            .respec-offending-element:not(pre) {
                display: inline-block
            }

            .respec-offending-element {
                background: url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x
            }
        }

        #references :target {
            background: #eaf3ff;
            animation: pop .4s ease-in-out 0s 1
        }

        cite .bibref {
            font-style: normal
        }

        a[href].orcid {
            padding-left: 4px;
            padding-right: 4px
        }

        a[href].orcid>svg {
            margin-bottom: -2px
        }

        ol.tof,
        ul.tof {
            list-style: none outside none
        }

        .caption {
            margin-top: .5em;
            font-style: italic
        }

        #issue-summary>ul {
            column-count: 2
        }

        #issue-summary li {
            list-style: none;
            display: inline-block
        }

        details.respec-tests-details {
            margin-left: 1em;
            display: inline-block;
            vertical-align: top
        }

        details.respec-tests-details>* {
            padding-right: 2em
        }

        details.respec-tests-details[open] {
            z-index: 999999;
            position: absolute;
            border: thin solid #cad3e2;
            border-radius: .3em;
            background-color: #fff;
            padding-bottom: .5em
        }

        details.respec-tests-details[open]>summary {
            border-bottom: thin solid #cad3e2;
            padding-left: 1em;
            margin-bottom: 1em;
            line-height: 2em
        }

        details.respec-tests-details>ul {
            width: 100%;
            margin-top: -.3em
        }

        details.respec-tests-details>li {
            padding-left: 1em
        }

        .self-link:hover {
            opacity: 1;
            text-decoration: none;
            background-color: transparent
        }

        aside.example .marker>a.self-link {
            color: inherit
        }

        .header-wrapper {
            display: flex;
            align-items: baseline
        }

        :is(h2, h3, h4, h5, h6):not(#toc>h2, #abstract>h2, #sotd>h2, .head>h2) {
            position: relative;
            left: -.5em
        }

        :is(h2, h3, h4, h5, h6):not(#toch2)+a.self-link {
            color: inherit;
            order: -1;
            position: relative;
            left: -1.1em;
            font-size: 1rem;
            opacity: .5
        }

        :is(h2, h3, h4, h5, h6)+a.self-link::before {
            content: "§";
            text-decoration: none;
            color: var(--heading-text)
        }

        :is(h2, h3)+a.self-link {
            top: -.2em
        }

        :is(h4, h5, h6)+a.self-link::before {
            color: #000
        }

        @media (max-width:767px) {
            dd {
                margin-left: 0
            }
        }

        @media print {
            .removeOnSave {
                display: none
            }
        }
    </style>


    <meta name="color-scheme" content="light">
    <meta name="revision" content="0e99fcf3daa23269bf2b019f5269a154088d2347">
    <link rel="canonical" href="https://www.w3.org/TR/pointerlock-2/">
    <style>
        .hljs {
            --base: #fafafa;
            --mono-1: #383a42;
            --mono-2: #686b77;
            --mono-3: #717277;
            --hue-1: #0b76c5;
            --hue-2: #336ae3;
            --hue-3: #a626a4;
            --hue-4: #42803c;
            --hue-5: #ca4706;
            --hue-5-2: #c91243;
            --hue-6: #986801;
            --hue-6-2: #9a6a01
        }

        @media (prefers-color-scheme:dark) {
            .hljs {
                --base: #282c34;
                --mono-1: #abb2bf;
                --mono-2: #818896;
                --mono-3: #5c6370;
                --hue-1: #56b6c2;
                --hue-2: #61aeee;
                --hue-3: #c678dd;
                --hue-4: #98c379;
                --hue-5: #e06c75;
                --hue-5-2: #be5046;
                --hue-6: #d19a66;
                --hue-6-2: #e6c07b
            }
        }

        .hljs {
            display: block;
            overflow-x: auto;
            padding: .5em;
            color: #383a42;
            color: var(--mono-1, #383a42);
            background: #fafafa;
            background: var(--base, #fafafa)
        }

        .hljs-comment,
        .hljs-quote {
            color: #717277;
            color: var(--mono-3, #717277);
            font-style: italic
        }

        .hljs-doctag,
        .hljs-formula,
        .hljs-keyword {
            color: #a626a4;
            color: var(--hue-3, #a626a4)
        }

        .hljs-deletion,
        .hljs-name,
        .hljs-section,
        .hljs-selector-tag,
        .hljs-subst {
            color: #ca4706;
            color: var(--hue-5, #ca4706);
            font-weight: 700
        }

        .hljs-literal {
            color: #0b76c5;
            color: var(--hue-1, #0b76c5)
        }

        .hljs-addition,
        .hljs-attribute,
        .hljs-meta-string,
        .hljs-regexp,
        .hljs-string {
            color: #42803c;
            color: var(--hue-4, #42803c)
        }

        .hljs-built_in,
        .hljs-class .hljs-title {
            color: #9a6a01;
            color: var(--hue-6-2, #9a6a01)
        }

        .hljs-attr,
        .hljs-number,
        .hljs-selector-attr,
        .hljs-selector-class,
        .hljs-selector-pseudo,
        .hljs-template-variable,
        .hljs-type,
        .hljs-variable {
            color: #986801;
            color: var(--hue-6, #986801)
        }

        .hljs-bullet,
        .hljs-link,
        .hljs-meta,
        .hljs-selector-id,
        .hljs-symbol,
        .hljs-title {
            color: #336ae3;
            color: var(--hue-2, #336ae3)
        }

        .hljs-emphasis {
            font-style: italic
        }

        .hljs-strong {
            font-weight: 700
        }

        .hljs-link {
            text-decoration: underline
        }
    </style>
    <style>
        var {
            position: relative;
            cursor: pointer
        }

        var[data-type]::after,
        var[data-type]::before {
            position: absolute;
            left: 50%;
            top: -6px;
            opacity: 0;
            transition: opacity .4s;
            pointer-events: none
        }

        var[data-type]::before {
            content: "";
            transform: translateX(-50%);
            border-width: 4px 6px 0 6px;
            border-style: solid;
            border-color: transparent;
            border-top-color: #222
        }

        var[data-type]::after {
            content: attr(data-type);
            transform: translateX(-50%) translateY(-100%);
            background: #222;
            text-align: center;
            font-family: "Dank Mono", "Fira Code", monospace;
            font-style: normal;
            padding: 6px;
            border-radius: 3px;
            color: #daca88;
            text-indent: 0;
            font-weight: 400
        }

        var[data-type]:hover::after,
        var[data-type]:hover::before {
            opacity: 1
        }
    </style>
    <script id="initialUserConfig" type="application/json">{
      "specStatus": "WD",
      "caniuse": "pointerlock",
      "previousPublishDate": "2024-05-16",
      "previousMaturity": "WD",
      "testSuiteURI": "https://github.com/web-platform-tests/wpt/tree/master/pointerlock",
      "editors": [
        {
          "name": "Mustaq Ahmed",
          "company": "Google",
          "companyURL": "http://www.google.com/",
          "w3cid": "75206"
        },
        {
          "name": "Vincent Scheib",
          "url": "http://www.scheib.net",
          "company": "Google",
          "companyURL": "http://www.google.com/",
          "w3cid": "49724"
        }
      ],
      "formerEditors": [
        {
          "name": "Navid Zolghadr",
          "company": "Google",
          "companyURL": "http://www.google.com/",
          "w3cid": "92361"
        }
      ],
      "github": "w3c/pointerlock",
      "group": "webapps",
      "xref": {
        "specs": [
          "uievents"
        ],
        "profile": "web-platform"
      },
      "shortName": "pointerlock-2",
      "gitRevision": "0e99fcf3daa23269bf2b019f5269a154088d2347",
      "publishDate": "2024-06-17",
      "publishISODate": "2024-06-17T00:00:00.000Z",
      "generatedSubtitle": "W3C Working Draft 17 June 2024"
    }</script>
    <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD">
</head>

<body data-cite="WEBIDL uievents uievents HTML INFRA URL WEBIDL DOM FETCH" class="h-entry">
    <div class="head">
        <p class="logos"><a class="logo" href="https://www.w3.org/"><img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
            </a></p>
        <h1 id="title" class="title">指针锁定 2.0</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types#WD">W3C 工作草案</a> <time class="dt-published"
                datetime="2024-06-17">2024年6月17日</time></p>
        <details open="">
            <summary>关于此文档的更多详细信息</summary>
            <dl>
                <dt>此版本：</dt>
                <dd>
                    <a class="u-url"
                        href="https://www.w3.org/TR/2024/WD-pointerlock-2-20240617/">https://www.w3.org/TR/2024/WD-pointerlock-2-20240617/</a>
                </dd>
                <dt>最新发布版本：</dt>
                <dd>
                    <a href="https://www.w3.org/TR/pointerlock-2/">https://www.w3.org/TR/pointerlock-2/</a>
                </dd>
                <dt>最新编辑草案：</dt>
                <dd><a href="https://w3c.github.io/pointerlock/">https://w3c.github.io/pointerlock/</a></dd>
                <dt>历史记录：</dt>
                <dd>
                    <a
                        href="https://www.w3.org/standards/history/pointerlock-2/">https://www.w3.org/standards/history/pointerlock-2/</a>
                </dd>
                <dd>
                    <a href="https://github.com/w3c/pointerlock/commits/">提交历史</a>
                </dd>
                <dt>测试套件：</dt>
                <dd><a
                        href="https://github.com/web-platform-tests/wpt/tree/master/pointerlock">https://github.com/web-platform-tests/wpt/tree/master/pointerlock</a>
                </dd>
                <dt>编辑：</dt>
                <dd class="editor p-author h-card vcard" data-editor-id="75206">
                    <span class="p-name fn">Mustaq Ahmed</span> (<a class="p-org org h-org"
                        href="https://www.google.com/">谷歌</a>)
                </dd>
                <dd class="editor p-author h-card vcard" data-editor-id="49724">
                    <a class="u-url url p-name fn" href="http://www.scheib.net">Vincent Scheib</a> (<a
                        class="p-org org h-org" href="https://www.google.com/">谷歌</a>)
                </dd>
                <dt>
                    前编辑：
                </dt>
                <dd class="editor p-author h-card vcard" data-editor-id="92361">
                    <span class="p-name fn">Navid Zolghadr</span> (<a class="p-org org h-org"
                        href="https://www.google.com/">谷歌</a>)
                </dd>
                <dt>反馈：</dt>
                <dd>
                    <a href="https://github.com/w3c/pointerlock/">GitHub w3c/pointerlock</a>
                    (<a href="https://github.com/w3c/pointerlock/pulls/">拉取请求</a>,
                    <a href="https://github.com/w3c/pointerlock/issues/new/choose">新问题</a>,
                    <a href="https://github.com/w3c/pointerlock/issues/">打开的问题</a>)
                </dd>
                <dt class="caniuse-title">浏览器支持：</dt>
                <dd class="caniuse-stats"><a href="https://caniuse.com/pointerlock">caniuse.com</a></dd>
            </dl>
        </details>
        <p class="copyright">
            <a href="https://www.w3.org/policies/#copyright">版权</a>
            ©
            2024
            <a href="https://www.w3.org/">万维网联盟</a>。
            <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup>
            <a href="https://www.w3.org/policies/#Legal_Disclaimer">责任</a>、
            <a href="https://www.w3.org/policies/#W3C_Trademarks">商标</a>和
            <a rel="license" href="https://www.w3.org/copyright/software-license-2023/"
                title="W3C 软件和文档通知与许可">许可文档规则</a>适用。
        </p>
        <hr title="标题分隔符">
    </div>
    <section id="abstract" class="introductory">
        <h2>摘要</h2>
        本规范定义了一个 API，提供了脚本化访问原始鼠标移动数据的功能，同时将鼠标事件的目标锁定在单个元素上，并将光标从视图中移除。对于某些类别的应用程序，尤其是第一人称视角的 3D 应用程序和 3D
        建模软件，这是一个必不可少的输入模式。
    </section>
    <section id="sotd" class="introductory">
        <h2>本文档的状态</h2>
        <p><em>本节描述了本文档在发布时的状态。当前的 <abbr title="World Wide Web Consortium">W3C</abbr>
                出版物列表和本技术报告的最新修订版可在 <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr>
                    技术报告索引</a> 中找到：https://www.w3.org/TR/。</em></p>

        <p>
            本文档的更改历史可在 <a
                href="https://github.com/w3c/pointerlock/commits/gh-pages/index.html">https://github.com/w3c/pointerlock/commits/gh-pages/index.html</a>
            查看。
        </p>
        <p>
            自 <a href="https://www.w3.org/TR/2016/WD-pointerlock-2-20161122/"><abbr
                    title="World Wide Web Consortium">W3C</abbr>
                2016年10月27日推荐</a> 以来的更改摘要：
        </p>
        <ul>
            <li>
                <a href="https://github.com/w3c/pointerlock/commit/027f57ae80cf5bdb03379203828aa234f3e7e433">
                    IDL 块更新</a>为机器<a href="https://github.com/w3c/pointerlock/issues/13">可解析</a>，无实质性更改。
            </li>
        </ul>
        <p>
            本文档由 <a href="https://www.w3.org/groups/wg/webapps">Web 应用程序工作组</a> 作为工作草案发布，
            使用了<a href="https://www.w3.org/2023/Process-20231103/#recs-and-notes">推荐路线</a>。
        </p>
        <p>作为工作草案发布并不意味着 <abbr title="World Wide Web Consortium">W3C</abbr> 及其成员的认可。</p>
        <p>
            这是一个草案文件，可能会随时更新、替换或被其他文件淘汰。在此文件不应被引用为其他用途，而应被视为进行中的工作。
        </p>
        <p>
            本文档由一个根据 <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr
                    title="World Wide Web Consortium">W3C</abbr> 专利政策</a> 运营的工作组生产。<abbr
                title="World Wide Web Consortium">W3C</abbr> 维护一个公开的<a rel="disclosure"
                href="https://www.w3.org/groups/wg/webapps/ipr">专利披露列表</a>，列出了与该组交付物有关的任何专利披露信息；该页面还包括披露专利的说明。任何个人如果知道某项专利并认为其包含<a
                href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">必要权利要求</a>，必须根据 <a
                href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">W3C 专利政策第6节</a>披露相关信息。
        </p>
        <p>
            本文档受 <a id="w3c_process_revision" href="https://www.w3.org/2023/Process-20231103/">2023年11月3日 W3C 进程文档</a>
            管辖。
        </p>
    </section>
    <nav id="toc">
        <h2 class="introductory" id="table-of-contents">目录</h2>
        <ol class="toc">
            <li class="tocline"><a class="tocxref" href="#abstract">摘要</a></li>
            <li class="tocline"><a class="tocxref" href="#sotd">本文档的状态</a></li>
            <li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi> 引言 </a></li>
            <li class="tocline">
                <a class="tocxref" href="#pointer-lock-and-interfaces"><bdi class="secno">2. </bdi> Pointer Lock 和接口</a>
                <ol class="toc">
                    <li class="tocline">
                        <a class="tocxref" href="#the-pointer-lock-state-definition">
                            <bdi class="secno">2.1 </bdi> <span>pointer lock state</span> 定义
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref" href="#pointerlockoptions-dictionary">
                            <bdi class="secno">2.2 </bdi> <code>PointerLockOptions</code> 字典
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref" href="#pointerlockchange-and-pointerlockerror-events">
                            <bdi class="secno">2.3 </bdi> <code>pointerlockchange</code> 和 <code>pointerlockerror</code>
                            事件
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref" href="#exit-pointer-lock">
                            <bdi class="secno">2.4 </bdi> 退出 Pointer Lock
                        </a>
                    </li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#requestPointerLock"><bdi class="secno">3. </bdi>扩展
                    <code>Element</code> 接口</a></li>
            <li class="tocline"><a class="tocxref" href="#extensions-to-the-document-interface"><bdi class="secno">4.
                    </bdi>扩展 <code>Document</code> 接口</a></li>
            <li class="tocline"><a class="tocxref" href="#extensions-to-the-documentorshadowroot-mixin"><bdi
                        class="secno">5. </bdi>扩展 <code>DocumentOrShadowRoot</code> 混合接口</a></li>
            <li class="tocline"><a class="tocxref" href="#extensions-to-the-mouseevent-interface"><bdi class="secno">6.
                    </bdi>扩展 <code>MouseEvent</code> 接口</a></li>
            <li class="tocline"><a class="tocxref" href="#extensions-to-the-mouseeventinit-dictionary"><bdi
                        class="secno">7. </bdi>扩展 <code>MouseEventInit</code> 字典</a></li>
            <li class="tocline"><a class="tocxref" href="#requirements"><bdi class="secno">8. </bdi>要求</a></li>
            <li class="tocline">
                <a class="tocxref" href="#use-cases">
                    <bdi class="secno">9. </bdi>用例
                </a>
                <ol class="toc">
                    <li class="tocline">
                        <a class="tocxref" href="#relative-view-port-rotation-of-free-moving-virtual-actors">
                            <bdi class="secno">9.1 </bdi>自由移动虚拟角色的相对视口旋转
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref" href="#free-rotation-of-3d-models-or-panning-of-2d-layers">
                            <bdi class="secno">9.2 </bdi>3D 模型的自由旋转或 2D 图层的平移
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref" href="#relative-movement-of-actors">
                            <bdi class="secno">9.3 </bdi>角色的相对移动
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref" href="#jog-movement-over-spinner-controls">
                            <bdi class="secno">9.4 </bdi>旋钮控件上的缓慢移动
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref" href="#synthetic-cursor-interaction-with-html-dom-ui">
                            <bdi class="secno">9.5 </bdi>与 HTML DOM UI 的合成光标交互
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref"
                            href="#view-port-panning-by-moving-a-mouse-cursor-against-the-bounds-of-a-view-port">
                            <bdi class="secno">9.6 </bdi>通过将鼠标光标移到视口边界来进行视口平移
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref" href="#game-lobby-timer-based-pointer-lock">
                            <bdi class="secno">9.7 </bdi>游戏大厅，基于计时器的 Pointer Lock
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref" href="#game-portal">
                            <bdi class="secno">9.8 </bdi>游戏门户
                        </a>
                    </li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#security"><bdi class="secno">10. </bdi>安全</a></li>
            <li class="tocline">
                <a class="tocxref" href="#frequently-asked-questions">
                    <bdi class="secno">11. </bdi>常见问题
                </a>
                <ol class="toc">
                    <li class="tocline">
                        <a class="tocxref" href="#why-not-merge-with-mouse-capture-setcapture">
                            <bdi class="secno">11.1 </bdi>为什么不与 Mouse Capture：setCapture() 合并？
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref" href="#why-not-repurpose-mouseevent-s-clientx-y-screenx-y">
                            <bdi class="secno">11.2 </bdi>为什么不重新利用 MouseEvent 的 .clientX/Y .screenX/Y？
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref" href="#why-use-movementx-y-instead-of-deltax-y">
                            <bdi class="secno">11.3 </bdi>为什么使用 .movementX/Y 而不是 .deltaX/Y？
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref" href="#why-bundle">
                            <bdi class="secno">11.4 </bdi>为什么将所有功能（隐藏光标、提供鼠标增量）打包，而不是使用 CSS 隐藏光标，始终提供增量值，并提供一个 API
                            将光标移动限制在网页的一部分？
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref" href="#high-resolution-deltas-high-frequency-updates">
                            <bdi class="secno">11.5 </bdi>高分辨率增量/高频更新？
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref"
                            href="#why-modify-mouseevent-and-reuse-existing-mouse-events-instead-of-creating-a-mouse-delta-event">
                            <bdi class="secno">11.6 </bdi>为什么修改 MouseEvent 并重用现有的鼠标事件而不是创建鼠标增量事件？
                        </a>
                    </li>
                    <li class="tocline">
                        <a class="tocxref"
                            href="#why-separate-targets-for-mouse-events-under-pointer-lock-and-keyboard-input-focus">
                            <bdi class="secno">11.7 </bdi>为什么将 Pointer Lock 下的鼠标事件目标与键盘输入焦点分开？
                        </a>
                    </li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">12. </bdi>一致性</a></li>
            <li class="tocline"><a class="tocxref" href="#acknowledgments"><bdi class="secno">A. </bdi>致谢</a></li>
            <li class="tocline">
                <a class="tocxref" href="#references"><bdi class="secno">B. </bdi>参考文献</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">B.1
                            </bdi>规范性参考</a></li>
                    <li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">B.2
                            </bdi>参考性参考</a></li>
                </ol>
            </li>
        </ol>
    </nav>
    <section id="introduction" class="informative">
        <div class="header-wrapper">
            <h2 id="x1-introduction"><bdi class="secno">1. </bdi> 引言</h2>
            <a class="self-link" href="#introduction" aria-label="第 1 节的永久链接"></a>
        </div>
        <p><em>本节为非规范性内容。</em></p>

        <p>
            Pointer Lock API 允许应用程序直接解释鼠标移动作为输入方式，而不仅仅是读取鼠标光标的位置。一个流行的例子是
            第一人称视角的三维图形应用程序（如游戏）中的运动控制：鼠标移动用于控制玩家摄像头的旋转/方向；不显示鼠标光标，
            并且移动不受传统边界（如用户代理窗口或整个屏幕）的限制，这意味着鼠标移动可以在任何方向上无限跟踪。
        </p>
        <p>
            Pointer Lock 与 Mouse Capture 相关 [<cite><a class="bibref" data-link-type="biblio" href="#bib-mdn-setcapture"
                    title="Element.setCapture()">MDN-SETCAPTURE</a></cite>]（Mouse Capture 未指定：bug
            <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=14600">14600</a>）。
            Capture 提供了在拖动鼠标时持续向目标元素传递事件的能力，但在鼠标按钮释放时停止。
            Pointer Lock 的区别在于它是持久的，不受屏幕边界限制，无论鼠标按钮状态如何都发送事件，隐藏光标，
            并且直到通过 API 调用或用户执行特定的 <a href="#dfn-default-unlock-gesture" class="internalDFN" data-link-type="dfn"
                id="ref-for-dfn-default-unlock-gesture-1">默认解锁手势</a> 才会释放。
        </p>
        <p>
            Pointer Lock 处理捕获单个资源并将其与单个元素关联。这类似于 Fullscreen API [<cite><a class="bibref" data-link-type="biblio"
                    href="#bib-fullscreen" title="Fullscreen API Standard">FULLSCREEN</a></cite>]，
            它将单个元素提升为全屏。Pointer Lock API 选择尽可能紧密地仿照 Fullscreen API 的资源捕获、状态更改和释放 API。
        </p>
        <p>
            Pointer Lock 交互模式以前称为鼠标锁定。名称更改的原因是，除了鼠标之外，许多不同的控制器类型都可以操纵屏幕上的指针光标，
            并且它们都会受到影响。
        </p>
    </section>
    <section id="pointer-lock-and-interfaces">
        <div class="header-wrapper">
            <h2 id="x2-pointer-lock-and-interfaces"><bdi class="secno">2. </bdi> 指针锁定和接口</h2>
            <a class="self-link" href="#pointer-lock-and-interfaces" aria-label="第 2 节的永久链接"></a>
        </div>

        <section id="the-pointer-lock-state-definition">
            <div class="header-wrapper">
                <h3 id="x2-1-the-pointer-lock-state-definition"><bdi class="secno">2.1 </bdi>
                    <dfn id="dfn-pointer-lock-state" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">指针锁定状态</dfn> 定义
                </h3>
                <a class="self-link" href="#the-pointer-lock-state-definition" aria-label="第 2.1 节的永久链接"></a>
            </div>

            <p>
                <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-state" class="internalDFN"
                    id="ref-for-dfn-pointer-lock-state-1">指针锁定状态</a> 是一个状态，
                在该状态下，单个 DOM 元素（我们称之为 <dfn id="dfn-pointer-lock-target" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">指针锁定目标</dfn>）接收所有鼠标事件，并且光标被隐藏。
            </p>
            <p>
                一旦进入 <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-state" class="internalDFN"
                    id="ref-for-dfn-pointer-lock-state-2">指针锁定状态</a>，
                <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                    id="ref-for-dfn-user-agent-1">用户代理</a> 将有一个 <a data-link-type="dfn|abstract-op"
                    href="#dfn-pointer-lock-target" class="internalDFN"
                    id="ref-for-dfn-pointer-lock-target-1">指针锁定目标</a>、
                一个 <dfn id="dfn-pointer-lock-options" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">指针锁定选项</dfn>，
                它是 <a data-link-type="idl" data-lt="PointerLockOptions" href="#dom-pointerlockoptions"
                    class="internalDFN" id="ref-for-dom-pointerlockoptions-1"><code>PointerLockOptions</code></a>，
                以及 <dfn id="dfn-cursor-position" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">光标位置</dfn>，这是代表进入指针锁定状态时系统鼠标光标位置的一对数字
                （与 <code>screenX</code>、<code>screenY</code> 中报告的位置相同）。<a data-link-type="dfn|abstract-op"
                    href="#dfn-pointer-lock-target" class="internalDFN"
                    id="ref-for-dfn-pointer-lock-target-2">指针锁定目标</a>
                将接收所有相关的用户生成的<a data-link-type="idl" data-lt="MouseEvent" data-type="interface"
                    href="https://www.w3.org/TR/uievents/#mouseevent"><code>MouseEvent</code></a>事件，
                即所有用户生成的<code>mousemove</code>、<code>mousedown</code>、<code>mouseup</code>、<code>click</code>、<code>dblclick</code>、<code>auxclick</code>
                和 <code>wheel</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-ui-events"
                        title="UI Events">ui-events</a></cite>]。
                在 <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-state" class="internalDFN"
                    id="ref-for-dfn-pointer-lock-state-3">指针锁定状态</a> 下，其他元素不会接收这些事件。
                不会分派需要鼠标光标概念的事件：即
                <code>mouseenter</code>、<code>mouseleave</code>、<code>mouseover</code>、<code>mouseout</code>、<code>drag</code>
                和 <code>drop</code>。
            </p>
            <div class="issue" id="issue-container-number-97">
                <div role="heading" class="issue-title marker" id="h-issue" aria-level="4">
                    <a href="https://github.com/w3c/pointerlock/issues/97"><span class="issue-number">Issue
                            97</span></a>
                    <span class="issue-label">：第 2.1 节应提及锁定对 PointerEvents 的影响</span>
                </div>
                <p dir="auto">这是在 <a href="https://github.com/w3c/pointerlock/pull/49#discussion_r468133933"
                        data-hovercard-type="pull_request"
                        data-hovercard-url="/w3c/pointerlock/pull/49/hovercard">此线程</a>中提出的：
                    <a class="issue-link js-issue-link" data-error-text="标题加载失败" data-id="468848569"
                        data-permission-text="标题是私有的" data-url="https://github.com/w3c/pointerlock/issues/49"
                        data-hovercard-type="pull_request" data-hovercard-url="/w3c/pointerlock/pull/49/hovercard"
                        href="https://github.com/w3c/pointerlock/pull/49">#49</a>：
                </p>
                <blockquote>
                    <p dir="auto">是否可以以规范的方式列出这些事件，而不仅仅是举一些例子？</p>
                    <p dir="auto">我认为当前文本是可以的，因为这里缺乏精确性只是鼠标事件规范中更大问题的症状。该问题在某些方面正在得到改善，
                        例如在 <a class="issue-link js-issue-link" data-error-text="标题加载失败" data-id="312692962"
                            data-permission-text="标题是私有的" data-url="https://github.com/w3c/uievents/issues/200"
                            data-hovercard-type="issue" data-hovercard-url="/w3c/uievents/issues/200/hovercard"
                            href="https://github.com/w3c/uievents/issues/200">w3c/uievents#200</a> 中有一些进展，
                        如果它被实现，那么最终这段内容可以作为 UI 事件规范的一部分。
                    </p>
                    <p dir="auto">但是，在此期间，如果您能准确列出这些事件，将有助于实现互操作性。</p>
                    <p dir="auto">例如，我不确定指针事件是否会受到此更改的影响。</p>
                </blockquote>
            </div>
            <p></p>
            <p>
                当处于 <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-state" class="internalDFN"
                    id="ref-for-dfn-pointer-lock-state-4">指针锁定状态</a> 时，
                如果 <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-options" class="internalDFN"
                    id="ref-for-dfn-pointer-lock-options-1">指针锁定选项</a>中的
                <a data-link-type="idl" href="#dom-pointerlockoptions-unadjustedmovement" class="internalDFN"
                    id="ref-for-dom-pointerlockoptions-unadjustedmovement-1"><code>unadjustedMovement</code></a>成员为<code>true</code>，
                则事件坐标不会受到底层平台行为（如鼠标加速）的影响。换句话说，用户代理使用底层平台提供的 API 来确保获取原始事件。
                如果<a data-link-type="idl" data-lt="PointerLockOptions" href="#dom-pointerlockoptions"
                    class="internalDFN" id="ref-for-dom-pointerlockoptions-2"><code>PointerLockOptions</code></a>的
                <a data-link-type="idl" href="#dom-pointerlockoptions-unadjustedmovement" class="internalDFN"
                    id="ref-for-dom-pointerlockoptions-unadjustedmovement-2"><code>unadjustedMovement</code></a>成员为<code>false</code>，
                则用户代理依赖底层平台的默认鼠标加速行为。
            </p>
            <p>
                在 <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-state" class="internalDFN"
                    id="ref-for-dfn-pointer-lock-state-5">指针锁定状态</a> 中，
                系统鼠标光标被隐藏，并且窗口将保持焦点，不会因鼠标移动或按键操作而失去焦点。这是通过底层操作系统 API 直接或间接实现的。
            </p>
            <div class="note" role="note" id="issue-container-generatedID">
                <div role="heading" class="note-title marker" id="h-note" aria-level="4"><span>注</span></div>
                <p class="">
                    由应用程序脚本创建的合成鼠标事件，无论锁定状态如何，行为都是一样的。
                </p>
            </div>
        </section>
        <section data-dfn-for="PointerLockOptions" id="pointerlockoptions-dictionary">
            <div class="header-wrapper">
                <h3 id="x2-2-pointerlockoptions-dictionary"><bdi class="secno">2.2 </bdi>
                    <code>PointerLockOptions</code> 字典
                </h3>
                <a class="self-link" href="#pointerlockoptions-dictionary" aria-label="第 2.2 节的永久链接"></a>
            </div>

            <pre class="idl def" id="webidl-1846476394"><span class="idlHeader"><a class="self-link" href="#webidl-1846476394">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-pointerlockoptions" data-title="PointerLockOptions">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dom-pointerlockoptions" id="ref-for-dom-pointerlockoptions-3"><code>PointerLockOptions</code></a> {<span data-idl="" class="idlMember" id="idl-def-pointerlockoptions-unadjustedmovement" data-title="unadjustedMovement" data-dfn-for="PointerLockOptions"><span class="idlType">
          <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-pointerlockoptions-unadjustedmovement" id="ref-for-dom-pointerlockoptions-unadjustedmovement-3"><code>unadjustedMovement</code></a> = false;</span>
        };</span></code></pre>
            <dl>
                <dt>
                    <dfn data-export="" data-dfn-type="dictionary" id="dom-pointerlockoptions" data-idl="dictionary"
                        data-title="PointerLockOptions" data-dfn-for="" tabindex="0" aria-haspopup="dialog">
                        <code>PointerLockOptions</code>
                    </dfn> 字典
                </dt>
                <dd>
                    <p>此选项字典用于自定义指针在锁定模式下的行为。</p>
                </dd>
                <dt>
                    <dfn data-export="" data-dfn-type="dict-member" id="dom-pointerlockoptions-unadjustedmovement"
                        data-idl="field" data-title="unadjustedMovement" data-dfn-for="PointerLockOptions"
                        data-type="boolean" tabindex="0" aria-haspopup="dialog">
                        <code>unadjustedMovement</code>
                    </dfn> 成员
                </dt>
                <dd>
                    <p>如果此值设置为<code>true</code>，则指针移动将不受底层平台的修改（如鼠标加速）的影响。</p>
                </dd>
            </dl>
        </section>
        <section id="pointerlockchange-and-pointerlockerror-events">
            <div class="header-wrapper">
                <h3 id="x2-3-pointerlockchange-and-pointerlockerror-events"><bdi class="secno">2.3 </bdi>
                    <code>pointerlockchange</code> 和 <code>pointerlockerror</code> 事件
                </h3>
                <a class="self-link" href="#pointerlockchange-and-pointerlockerror-events"
                    aria-label="第 2.3 节的永久链接"></a>
            </div>

            <p>两种事件用于传达指针锁定状态的变化或更改状态时的错误。它们分别命名为 <dfn class="event" data-dfn-type="event" id="dfn-pointerlockchange"
                    tabindex="0" aria-haspopup="dialog" data-export="">pointerlockchange</dfn> 和 <dfn class="event"
                    data-dfn-type="event" id="dfn-pointerlockerror" tabindex="0" aria-haspopup="dialog"
                    data-export="">pointerlockerror</dfn>。
                有关详细信息，请参阅 <a href="#requestPointerLock" data-matched-text="[[[#requestPointerLock]]]"
                    class="sec-ref"><bdi class="secno">3. </bdi> 对<code>Element</code> 接口的扩展</a> 中的算法。
            </p>
            <div class="note" role="note" id="issue-container-generatedID-0">
                <div role="heading" class="note-title marker" id="h-note-0" aria-level="4"><span>注</span></div>
                <p>
                    放大软件会增加屏幕上内容的大小。它使用鼠标移动放大的焦点。当启动指针锁定时，放大软件需要切换为使用键盘移动放大焦点。
                    当触发<a data-link-type="idl" data-lt="pointerlockchange" href="#dfn-pointerlockchange"
                        class="internalDFN" id="ref-for-dfn-pointerlockchange-1"><code>pointerlockchange</code></a>事件时，
                    浏览器需要确保事件传达给辅助技术，如屏幕放大器。
                </p>
            </div>
        </section>
        <section id="exit-pointer-lock">
            <div class="header-wrapper">
                <h3 id="x2-4-exit-pointer-lock"><bdi class="secno">2.4 </bdi>
                    <dfn id="dfn-exit-pointer-lock" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">退出指针锁定</dfn>
                </h3>
                <a class="self-link" href="#exit-pointer-lock" aria-label="第 2.4 节的永久链接"></a>
            </div>

            <p>退出指针锁定的过程如下：</p>
            <ol class="algorithm">
                <li>系统鼠标光标必须重新显示，并定位在<a data-link-type="dfn|abstract-op" href="#dfn-cursor-position" class="internalDFN"
                        id="ref-for-dfn-cursor-position-1">光标位置</a>。</li>
                <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-an-element-task">在</a>
                    <a data-link-type="dfn|abstract-op" data-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source">用户交互任务源</a>中
                    <a data-link-type="dfn|abstract-op" data-type="dfn"
                        href="https://dom.spec.whatwg.org/#concept-event-fire">触发一个事件</a>名为
                    <a data-link-type="idl" data-lt="pointerlockchange" href="#dfn-pointerlockchange"
                        class="internalDFN" id="ref-for-dfn-pointerlockchange-2"><code>pointerlockchange</code></a> 在
                    给定的 <var data-type="Element">元素</var> 的 <a data-link-type="dfn|abstract-op" data-type="dfn"
                        href="https://dom.spec.whatwg.org/#concept-node-document">节点文档</a> 中。
                </li>
                <li>通过将<a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-target" class="internalDFN"
                        id="ref-for-dfn-pointer-lock-target-3">指针锁定目标</a>、
                    <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-options" class="internalDFN"
                        id="ref-for-dfn-pointer-lock-options-2">指针锁定选项</a> 和
                    <a data-link-type="dfn|abstract-op" href="#dfn-cursor-position" class="internalDFN"
                        id="ref-for-dfn-cursor-position-2">光标位置</a> 设置为 null 来退出
                    <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-state" class="internalDFN"
                        id="ref-for-dfn-pointer-lock-state-6">指针锁定状态</a>。
                </li>
            </ol>
        </section>
    </section>
    <section data-dfn-for="Element" data-link-for="Element" id="requestPointerLock">
        <div class="header-wrapper">
            <h2 id="x3-extensions-to-the-element-interface"><bdi class="secno">3. </bdi>
                <code>Element</code> 接口的扩展
            </h2><a class="self-link" href="#requestPointerLock" aria-label="第3节的永久链接"></a>
        </div>

        <p>
            <a data-link-type="idl" data-lt="Element" data-type="interface"
                href="https://dom.spec.whatwg.org/#element"><code>Element</code></a> 接口被扩展，以提供
            请求指针锁定的能力。
        </p>
        <pre class="idl def" id="webidl-1328413902"><span class="idlHeader"><a class="self-link" href="#webidl-1328413902">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-element-partial-1" data-title="Element">partial interface <a data-idl="partial" data-link-type="interface" data-title="Element" class="idlID" data-dfn-for="Element" data-type="interface" href="https://dom.spec.whatwg.org/#element">Element</a> {<span data-idl="" class="idlMethod" id="idl-def-element-requestpointerlock-options" data-title="requestPointerLock" data-dfn-for="Element"><span class="idlType">
      <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-element-requestpointerlock" id="ref-for-dom-element-requestpointerlock-1"><code>requestPointerLock</code></a>(optional<span class="idlType"> <a data-link-type="idl" href="#dom-pointerlockoptions" class="internalDFN" id="ref-for-dom-pointerlockoptions-4"><code>PointerLockOptions</code></a></span> <span class="idlParamName">options</span> = {});</span>
    };</span></code></pre>
        <div class="example" id="example-1">
            <div class="marker">
                <a class="self-link" href="#example-1">示例<bdi> 1</bdi></a>
            </div>
            <pre aria-busy="false"><code class="hljs javascript"><span class="hljs-keyword">const</span> lock_element = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"lock_element"</span>);
    <span class="hljs-keyword">const</span> lock_button = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"lock"</span>);
    lock_button.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-keyword">async</span> (event) =&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">await</span> lock_element.requestPointerLock({ <span class="hljs-attr">unadjustedMovement</span>: <span class="hljs-literal">true</span> });
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"successfully locked!"</span>);
        } <span class="hljs-keyword">catch</span> (e) {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"lock failed with error: "</span>, e);
        }
    });</code></pre>
        </div>

        <dl>
            <dt>
                requestPointerLock(<a data-link-type="idl" data-lt="PointerLockOptions" href="#dom-pointerlockoptions"
                    class="internalDFN" id="ref-for-dom-pointerlockoptions-5"><code>PointerLockOptions</code></a>
                options) 方法
            </dt>
            <dd>
                <p>
                    一个名为 <a data-link-type="dfn|abstract-op" data-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/infrastructure.html#parallel-queue">并行队列</a> 的 <dfn
                        id="dfn-lock-requests-queue" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">锁请求队列</dfn>
                    用于排队所有请求。当 <dfn data-export="" data-dfn-type="method" id="dom-element-requestpointerlock"
                        data-idl="operation" data-title="requestPointerLock()" data-dfn-for="Element"
                        data-type="Promise" data-lt="requestPointerLock()|requestPointerLock(options)"
                        data-local-lt="Element.requestPointerLock|Element.requestPointerLock()|requestPointerLock"
                        tabindex="0" aria-haspopup="dialog"><code>requestPointerLock()</code></dfn> 被调用时，执行以下步骤：
                </p>
                <ol class="algorithm">
                    <li>将 <var data-type="Promise">promise</var> 设为 <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://webidl.spec.whatwg.org/#a-new-promise">一个新的 promise</a>。
                    </li>
                    <li>当一个 <a data-link-type="idl" data-type="attribute"
                            href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-window"><code>window</code></a>
                        处于 <a data-link-type="dfn|abstract-op" data-type="event"
                            href="https://html.spec.whatwg.org/multipage/indices.html#event-focus">焦点</a> 时，如果
                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://webidl.spec.whatwg.org/#this">this</a> 的
                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://dom.spec.whatwg.org/#concept-shadow-including-root">shadow-including root</a>
                        是 <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document">活动文档</a>，并且属于某个
                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/document-sequences.html#concept-document-bc">浏览上下文</a>
                        （或具有不在焦点中的
                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://dom.spec.whatwg.org/#concept-tree-ancestor">祖先</a>
                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/document-sequences.html#browsing-context">浏览上下文</a>）：
                        <ol>
                            <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-an-element-task">在</a>用户交互任务源中，
                                通过给定的 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://webidl.spec.whatwg.org/#this">this</a>，排队一个元素任务，执行以下步骤：
                                <ol>
                                    <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://dom.spec.whatwg.org/#concept-event-fire">触发一个事件</a>，
                                        名为 <a data-link-type="idl" data-lt="pointerlockerror"
                                            href="#dfn-pointerlockerror" class="internalDFN"
                                            id="ref-for-dfn-pointerlockerror-1"><code>pointerlockerror</code></a>，
                                        目标是 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://webidl.spec.whatwg.org/#this">this</a> 的
                                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://dom.spec.whatwg.org/#concept-node-document">节点文档</a>。
                                    </li>
                                    <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://webidl.spec.whatwg.org/#reject">拒绝</a> <var
                                            data-type="Promise">promise</var>，并抛出
                                        "<a data-link-type="idl" data-type="exception"
                                            href="https://webidl.spec.whatwg.org/#wrongdocumenterror"><code>WrongDocumentError</code></a>"
                                        <a data-link-type="idl" data-lt="DOMException" data-type="interface"
                                            href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a>。
                                    </li>
                                </ol>
                            </li>
                            <li>返回 <var data-type="Promise">promise</var>。</li>
                        </ol>
                        <div class="issue" id="issue-container-number-93">
                            <div role="heading" class="issue-title marker" id="h-issue-0" aria-level="3"><a
                                    href="https://github.com/w3c/pointerlock/issues/93"><span class="issue-number">Issue
                                        93</span></a><span class="issue-label">：可见状态检查</span></div>
                            <p dir="auto">该规范不应允许隐藏文档请求指针锁定。</p>
                            <p dir="auto">此外，当文档变为隐藏时，应该释放指针锁定。</p>
                        </div>
                    </li>
                    <li>如果“相关全局对象”没有
                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/interaction.html#transient-activation">短暂激活</a>，并且
                        <a data-link-type="idl" data-lt="Document" data-type="interface"
                            href="https://dom.spec.whatwg.org/#document"><code>Document</code></a>尚未释放成功的指针锁定，使用
                        <a data-link-type="idl" data-lt="exitPointerLock()" href="#dom-document-exitpointerlock"
                            class="internalDFN"
                            id="ref-for-dom-document-exitpointerlock-1"><code>exitPointerLock</code></a><code>()</code>：
                        <ol>
                            <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-an-element-task">排队一个元素任务</a>，在
                                <a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source">用户交互任务源</a>中，
                                给定 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://webidl.spec.whatwg.org/#this">this</a>，执行以下步骤：
                                <ol>
                                    <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://dom.spec.whatwg.org/#concept-event-fire">触发一个事件</a>，
                                        名为 <a data-link-type="idl" data-lt="pointerlockerror"
                                            href="#dfn-pointerlockerror" class="internalDFN"
                                            id="ref-for-dfn-pointerlockerror-2"><code>pointerlockerror</code></a>，
                                        目标是 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://webidl.spec.whatwg.org/#this">this</a> 的
                                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://dom.spec.whatwg.org/#concept-node-document">节点文档</a>。
                                    </li>
                                    <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://webidl.spec.whatwg.org/#reject">拒绝</a> <var
                                            data-type="Promise">promise</var>，并抛出
                                        "<a data-link-type="idl" data-lt="NotAllowedError" data-type="exception"
                                            href="https://webidl.spec.whatwg.org/#notallowederror"><code>NotAllowedError</code></a>"
                                        <a data-link-type="idl" data-lt="DOMException" data-type="interface"
                                            href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a>。
                                    </li>
                                </ol>
                            </li>
                            <li>返回 <var data-type="Promise">promise</var>。</li>
                        </ol>
                        <div class="note" role="note" id="issue-container-generatedID-1">
                            <div role="heading" class="note-title marker" id="h-note-1" aria-level="3"><span>注意</span>
                            </div>
                            <aside class="">
                                当单个 <a data-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/interaction.html#tracking-user-activation">用户激活</a>同时启动
                                指针锁定和全屏 [<cite><a class="bibref" data-link-type="biblio" href="#bib-fullscreen"
                                        title="Fullscreen API Standard">全屏 API 标准</a></cite>] 时，只有在全屏请求之前发出的
                                <a data-link-type="idl" data-lt="requestPointerLock()"
                                    href="#dom-element-requestpointerlock" class="internalDFN"
                                    id="ref-for-dom-element-requestpointerlock-2"><code>requestPointerLock</code></a><code>()</code>
                                调用才能成功，因为全屏是
                                <a data-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/interaction.html#activation-consuming-api">短暂激活消耗的
                                    API</a>。
                            </aside>
                        </div>
                    </li>
                    <li>如果 <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://webidl.spec.whatwg.org/#this">this</a> 的
                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://dom.spec.whatwg.org/#concept-node-document">节点文档</a>的
                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#active-sandboxing-flag-set">活动沙盒标志集</a>
                        含有 <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#sandboxed-pointer-lock-browsing-context-flag">已沙盒化的指针锁定浏览上下文标志</a>：
                        <ol>
                            <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-an-element-task">在</a>用户交互任务源中，
                                通过给定的 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://webidl.spec.whatwg.org/#this">this</a>，排队一个元素任务，执行以下步骤：
                                <ol>
                                    <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://dom.spec.whatwg.org/#concept-event-fire">触发一个事件</a>，
                                        名为 <a data-link-type="idl" data-lt="pointerlockerror"
                                            href="#dfn-pointerlockerror" class="internalDFN"
                                            id="ref-for-dfn-pointerlockerror-3"><code>pointerlockerror</code></a>，
                                        目标是 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://webidl.spec.whatwg.org/#this">this</a> 的
                                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://dom.spec.whatwg.org/#concept-node-document">节点文档</a>。
                                    </li>
                                    <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://webidl.spec.whatwg.org/#reject">拒绝</a> <var
                                            data-type="Promise">promise</var>，并抛出
                                        "<a data-link-type="idl" data-lt="SecurityError" data-type="exception"
                                            href="https://webidl.spec.whatwg.org/#securityerror"><code>SecurityError</code></a>"
                                        <a data-link-type="idl" data-lt="DOMException" data-type="interface"
                                            href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a>。
                                    </li>
                                </ol>
                            </li>
                            <li>返回 <var data-type="Promise">promise</var>。</li>
                        </ol>
                    </li>
                    <li>如果 options["<a data-link-type="idl" href="#dom-pointerlockoptions-unadjustedmovement"
                            class="internalDFN"
                            id="ref-for-dom-pointerlockoptions-unadjustedmovement-4"><code>unadjustedMovement</code></a>"]
                        为 true，且平台不支持
                        <a data-link-type="idl" href="#dom-pointerlockoptions-unadjustedmovement" class="internalDFN"
                            id="ref-for-dom-pointerlockoptions-unadjustedmovement-5"><code>unadjustedMovement</code></a>：
                        <ol>
                            <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-an-element-task">在</a>用户交互任务源中，
                                通过给定的 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://webidl.spec.whatwg.org/#this">this</a>，排队一个元素任务，执行以下步骤：
                                <ol>
                                    <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://dom.spec.whatwg.org/#concept-event-fire">触发一个事件</a>，
                                        名为 <a data-link-type="idl" data-lt="pointerlockerror"
                                            href="#dfn-pointerlockerror" class="internalDFN"
                                            id="ref-for-dfn-pointerlockerror-4"><code>pointerlockerror</code></a>，
                                        目标是 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://webidl.spec.whatwg.org/#this">this</a> 的
                                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://dom.spec.whatwg.org/#concept-node-document">节点文档</a>。
                                    </li>
                                    <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://webidl.spec.whatwg.org/#reject">拒绝</a> <var
                                            data-type="Promise">promise</var>，并抛出
                                        "<a data-link-type="idl" data-lt="NotSupportedError" data-type="exception"
                                            href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>"
                                        <a data-link-type="idl" data-lt="DOMException" data-type="interface"
                                            href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a>。
                                    </li>
                                </ol>
                            </li>
                            <li>返回 <var data-type="Promise">promise</var>。</li>
                        </ol>
                        <div class="issue" id="issue-container-number-90">
                            <div role="heading" class="issue-title marker" id="h-issue-1" aria-level="3"><a
                                    href="https://github.com/w3c/pointerlock/issues/90"><span class="issue-number">Issue
                                        90</span></a><span class="issue-label">：建议添加静态字段以指示是否支持
                                    `unadjustedMovement`。</span></div>
                            <p dir="auto">在 PR <a class="issue-link js-issue-link"
                                    data-error-text="Failed to load title" data-id="468848569"
                                    data-permission-text="Title is private"
                                    data-url="https://github.com/w3c/pointerlock/issues/49"
                                    data-hovercard-type="pull_request"
                                    data-hovercard-url="/w3c/pointerlock/pull/49/hovercard"
                                    href="https://github.com/w3c/pointerlock/pull/49">#49</a> 中引入了
                                <code class="notranslate">PointerLockOptions</code>。然而，<code
                                    class="notranslate">PointerLockOptions</code> 中的
                                <code class="notranslate">unadjustedMovement</code> 并不一定在所有平台上都支持。一个静态字段可能有助于在直接使用
                                <code class="notranslate">PointerLockOptions</code> 之前确定是否支持该功能，以避免不支持错误。
                            </p>
                        </div>
                    </li>
                    <li>将以下步骤加入 <a data-link-type="dfn|abstract-op" href="#dfn-lock-requests-queue" class="internalDFN"
                            id="ref-for-dfn-lock-requests-queue-1">锁请求队列</a>：
                        <ol>
                            <li>如果用户代理的 <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-target"
                                    class="internalDFN" id="ref-for-dfn-pointer-lock-target-4">指针锁定目标</a> 是某个元素，
                                其 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://dom.spec.whatwg.org/#concept-shadow-including-root">shadow-including
                                    root</a> 不等于 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://webidl.spec.whatwg.org/#this">this</a> 的
                                <a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://dom.spec.whatwg.org/#concept-shadow-including-root">shadow-including
                                    root</a>，那么：
                                <ol>
                                    <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-an-element-task">在</a>用户交互任务源中，
                                        通过给定的 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://webidl.spec.whatwg.org/#this">this</a>，排队一个元素任务，执行以下步骤：
                                        <ol>
                                            <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                                    href="https://dom.spec.whatwg.org/#concept-event-fire">触发一个事件</a>，
                                                名为 <a data-link-type="idl" data-lt="pointerlockerror"
                                                    href="#dfn-pointerlockerror" class="internalDFN"
                                                    id="ref-for-dfn-pointerlockerror-5"><code>pointerlockerror</code></a>，
                                                目标是 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                                    href="https://webidl.spec.whatwg.org/#this">this</a> 的
                                                <a data-link-type="dfn|abstract-op" data-type="dfn"
                                                    href="https://dom.spec.whatwg.org/#concept-node-document">节点文档</a>。
                                            </li>
                                            <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                                    href="https://webidl.spec.whatwg.org/#reject">拒绝</a>
                                                <var data-type="Promise">promise</var>，并抛出
                                                "<a data-link-type="idl" data-lt="InvalidStateError"
                                                    data-type="exception"
                                                    href="https://webidl.spec.whatwg.org/#invalidstateerror"><code>InvalidStateError</code></a>"
                                                <a data-link-type="idl" data-lt="DOMException" data-type="interface"
                                                    href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a>。
                                            </li>
                                        </ol>
                                    </li>
                                </ol>
                            </li>
                            <li>如果用户代理的 <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-target"
                                    class="internalDFN" id="ref-for-dfn-pointer-lock-target-5">指针锁定目标</a> 的
                                <a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://dom.spec.whatwg.org/#concept-shadow-including-root">shadow-including
                                    root</a> 等于 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://webidl.spec.whatwg.org/#this">this</a> 的
                                <a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://dom.spec.whatwg.org/#concept-shadow-including-root">shadow-including
                                    root</a>，并且 options 等同于当前的
                                <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-options" class="internalDFN"
                                    id="ref-for-dfn-pointer-lock-options-3">指针锁定选项</a>，那么：
                                <ol>
                                    <li>将 <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-target"
                                            class="internalDFN" id="ref-for-dfn-pointer-lock-target-6">指针锁定目标</a> 设置为
                                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://webidl.spec.whatwg.org/#this">this</a>。
                                    </li>
                                    <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-an-element-task">在</a>用户交互任务源中，
                                        通过给定的 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://webidl.spec.whatwg.org/#this">this</a>，排队一个元素任务，执行以下步骤：
                                        <ol>
                                            <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                                    href="https://dom.spec.whatwg.org/#concept-event-fire">触发一个事件</a>，
                                                名为 <a data-link-type="idl" data-lt="pointerlockchange"
                                                    href="#dfn-pointerlockchange" class="internalDFN"
                                                    id="ref-for-dfn-pointerlockchange-3"><code>pointerlockchange</code></a>，
                                                目标是 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                                    href="https://webidl.spec.whatwg.org/#this">this</a> 的
                                                <a data-link-type="dfn|abstract-op" data-type="dfn"
                                                    href="https://dom.spec.whatwg.org/#concept-node-document">节点文档</a>。
                                            </li>
                                            <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                                    href="https://webidl.spec.whatwg.org/#resolve">解决</a>
                                                <var data-type="Promise">promise</var>。
                                            </li>
                                        </ol>
                                    </li>
                                </ol>
                            </li>
                            <li>如果 <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-target"
                                    class="internalDFN" id="ref-for-dfn-pointer-lock-target-7">指针锁定目标</a> 为 null，或者
                                options 不等同于当前的
                                <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-options" class="internalDFN"
                                    id="ref-for-dfn-pointer-lock-options-4">指针锁定选项</a>，则处理锁请求并在完成时处理响应：
                                <ol>
                                    <li>如果锁请求失败：
                                        <ol>
                                            <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-an-element-task">在</a>用户交互任务源中，
                                                通过给定的 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                                    href="https://webidl.spec.whatwg.org/#this">this</a>，排队一个元素任务，执行以下步骤：
                                                <ol>
                                                    <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                                            href="https://dom.spec.whatwg.org/#concept-event-fire">触发一个事件</a>，
                                                        名为 <a data-link-type="idl" data-lt="pointerlockerror"
                                                            href="#dfn-pointerlockerror" class="internalDFN"
                                                            id="ref-for-dfn-pointerlockerror-6"><code>pointerlockerror</code></a>，
                                                        目标是 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                                            href="https://webidl.spec.whatwg.org/#this">this</a> 的
                                                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                                                            href="https://dom.spec.whatwg.org/#concept-node-document">节点文档</a>。
                                                    </li>
                                                    <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                                            href="https://webidl.spec.whatwg.org/#reject">拒绝</a>
                                                        <var data-type="Promise">promise</var>，并抛出
                                                        "<a data-link-type="idl" data-lt="NotSupportedError"
                                                            data-type="exception"
                                                            href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>"
                                                        <a data-link-type="idl" data-lt="DOMException"
                                                            data-type="interface"
                                                            href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a>。
                                                    </li>
                                                </ol>
                                            </li>
                                        </ol>
                                        <div class="issue" id="issue-container-number-91">
                                            <div role="heading" class="issue-title marker" id="h-issue-2"
                                                aria-level="3"><a
                                                    href="https://github.com/w3c/pointerlock/issues/91"><span
                                                        class="issue-number">Issue 91</span></a><span
                                                    class="issue-label">：当后续的 requestPointerLock
                                                    被拒绝时，已锁定的目标是否应退出锁定状态？</span>
                                            </div>
                                            <p dir="auto">在 PR <a class="issue-link js-issue-link"
                                                    data-error-text="Failed to load title" data-id="468848569"
                                                    data-permission-text="Title is private"
                                                    data-url="https://github.com/w3c/pointerlock/issues/49"
                                                    data-hovercard-type="pull_request"
                                                    data-hovercard-url="/w3c/pointerlock/pull/49/hovercard"
                                                    href="https://github.com/w3c/pointerlock/pull/49">#49</a> 的
                                                <code class="notranslate">requestPointerLock</code>
                                                算法中，目前缺少对以下场景的描述：<br>
                                                当后续请求失败（无论出于何种原因）时，已锁定的目标是否应退出锁定状态？
                                            </p>
                                        </div>
                                    </li>
                                    <li>如果锁请求成功：
                                        <ol>
                                            <li>进入 <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-state"
                                                    class="internalDFN"
                                                    id="ref-for-dfn-pointer-lock-state-7">指针锁定状态</a>，执行以下操作：
                                                <ol>
                                                    <li>将用户代理的 <a data-link-type="dfn|abstract-op"
                                                            href="#dfn-pointer-lock-target" class="internalDFN"
                                                            id="ref-for-dfn-pointer-lock-target-8">指针锁定目标</a> 设置为
                                                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                                                            href="https://webidl.spec.whatwg.org/#this">this</a>。
                                                    </li>
                                                    <li>将用户代理的 <a data-link-type="dfn|abstract-op"
                                                            href="#dfn-cursor-position" class="internalDFN"
                                                            id="ref-for-dfn-cursor-position-3">光标位置</a>设置为当前系统鼠标位置。
                                                    </li>
                                                    <li>将 <a data-link-type="dfn|abstract-op"
                                                            href="#dfn-pointer-lock-options" class="internalDFN"
                                                            id="ref-for-dfn-pointer-lock-options-5">指针锁定选项</a> 设置为
                                                        options。
                                                    </li>
                                                </ol>
                                            </li>
                                            <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-an-element-task">在</a>用户交互任务源中，
                                                通过给定的 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                                    href="https://webidl.spec.whatwg.org/#this">this</a>，排队一个元素任务，执行以下步骤：
                                                <ol>
                                                    <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                                            href="https://dom.spec.whatwg.org/#concept-event-fire">触发一个事件</a>，
                                                        名为 <a data-link-type="idl" data-lt="pointerlockchange"
                                                            href="#dfn-pointerlockchange" class="internalDFN"
                                                            id="ref-for-dfn-pointerlockchange-4"><code>pointerlockchange</code></a>，
                                                        目标是 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                                            href="https://webidl.spec.whatwg.org/#this">this</a> 的
                                                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                                                            href="https://dom.spec.whatwg.org/#concept-node-document">节点文档</a>。
                                                    </li>
                                                    <li><a data-link-type="dfn|abstract-op" data-type="dfn"
                                                            href="https://webidl.spec.whatwg.org/#resolve">解决</a>
                                                        <var data-type="Promise">promise</var>。
                                                    </li>
                                                </ol>
                                            </li>
                                        </ol>
                                    </li>
                                </ol>
                            </li>
                        </ol>
                        <div class="issue" id="issue-container-number-96">
                            <div role="heading" class="issue-title marker" id="h-issue-3" aria-level="3"><a
                                    href="https://github.com/w3c/pointerlock/issues/96"><span class="issue-number">Issue
                                        96</span></a><span class="issue-label">：锁请求队列处理不完整</span></div>
                            <p dir="auto">在 PR<a href="https://github.com/w3c/pointerlock/pull/49"
                                    data-hovercard-type="pull_request"
                                    data-hovercard-url="/w3c/pointerlock/pull/49/hovercard">#49</a> 的
                                requestPointerLock 算法中，目前缺少对如何处理锁请求队列中条目的描述。如果没有明确的文本，可能会导致错误的（？）假设，即所有条目将在最后同步出列。</p>
                        </div>
                    </li>
                    <li>返回 <var data-type="Promise">promise</var>。</li>
                </ol>
                <div class="note" role="note" id="issue-container-generatedID-2">
                    <div role="heading" class="note-title marker" id="h-note-2" aria-level="3"><span>注意</span></div>
                    <aside class="">
                        此算法正在积极开发中，可能会在后续更新中进行修改。
                    </aside>
                </div>
            </dd>
        </dl>
    </section>
    <section data-dfn-for="Document" data-link-for="Document" id="extensions-to-the-document-interface">
        <div class="header-wrapper">
            <h2 id="x4-extensions-to-the-document-interface"><bdi class="secno">4. </bdi>
                <code>Document</code> 接口的扩展
            </h2><a class="self-link" href="#extensions-to-the-document-interface" aria-label="第4节的永久链接。"></a>
        </div>

        <pre class="idl def" id="webidl-131603804"><span class="idlHeader"><a class="self-link" href="#webidl-131603804">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-document-partial-1" data-title="Document">partial interface <a data-idl="partial" data-link-type="interface" data-title="Document" class="idlID" data-dfn-for="Document" data-type="interface" href="https://dom.spec.whatwg.org/#document">Document</a> {<span data-idl="" class="idlAttribute" id="idl-def-document-onpointerlockchange" data-title="onpointerlockchange" data-dfn-for="Document">
          attribute<span class="idlType"> <a data-link-type="idl" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-document-onpointerlockchange" id="ref-for-dom-document-onpointerlockchange-1"><code>onpointerlockchange</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-document-onpointerlockerror" data-title="onpointerlockerror" data-dfn-for="Document">
          attribute<span class="idlType"> <a data-link-type="idl" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-document-onpointerlockerror" id="ref-for-dom-document-onpointerlockerror-1"><code>onpointerlockerror</code></a>;</span><span data-idl="" class="idlMethod" id="idl-def-document-exitpointerlock" data-title="exitPointerLock" data-dfn-for="Document"><span class="idlType">
          <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-document-exitpointerlock" id="ref-for-dom-document-exitpointerlock-2"><code>exitPointerLock</code></a>();</span>
        };</span></code></pre>
        <dl>
            <dt>
                <dfn data-export="" data-dfn-type="attribute" id="dom-document-onpointerlockchange" data-idl="attribute"
                    data-title="onpointerlockchange" data-dfn-for="Document" data-type="EventHandler"
                    data-lt="onpointerlockchange" data-local-lt="Document.onpointerlockchange" tabindex="0"
                    aria-haspopup="dialog"><code>onpointerlockchange</code></dfn> 属性
            </dt>
            <dd>
                <p>
                    一个用于 <a data-link-type="dfn|abstract-op" data-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes">事件处理器
                        idl 属性</a>
                    的 <a data-link-type="idl" href="#dfn-pointerlockchange" class="internalDFN"
                        id="ref-for-dfn-pointerlockchange-5"><code>pointerlockchange</code></a> 事件。
                </p>
            </dd>
            <dt>
                <dfn data-export="" data-dfn-type="attribute" id="dom-document-onpointerlockerror" data-idl="attribute"
                    data-title="onpointerlockerror" data-dfn-for="Document" data-type="EventHandler"
                    data-lt="onpointerlockerror" data-local-lt="Document.onpointerlockerror" tabindex="0"
                    aria-haspopup="dialog"><code>onpointerlockerror</code></dfn> 属性
            </dt>
            <dd>
                <p>
                    一个用于 <a data-link-type="dfn|abstract-op" data-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes">事件处理器
                        idl 属性</a>
                    的 <a data-link-type="idl" href="#dfn-pointerlockerror" class="internalDFN"
                        id="ref-for-dfn-pointerlockerror-7"><code>pointerlockerror</code></a> 事件。
                </p>
            </dd>
            <dt>
                <dfn data-export="" data-dfn-type="method" id="dom-document-exitpointerlock" data-idl="operation"
                    data-title="exitPointerLock()" data-dfn-for="Document" data-type="undefined"
                    data-lt="exitPointerLock()"
                    data-local-lt="Document.exitPointerLock|Document.exitPointerLock()|exitPointerLock" tabindex="0"
                    aria-haspopup="dialog"><code>exitPointerLock()</code></dfn> 方法
            </dt>
            <dd>
                <ol>
                    <li>如果用户代理的指针锁定目标为 null，则返回。</li>
                    <li>如果 <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-target" class="internalDFN"
                            id="ref-for-dfn-pointer-lock-target-9">指针锁定目标</a> 的
                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://dom.spec.whatwg.org/#concept-shadow-including-root">shadow-including
                            root</a> 不等于 <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://webidl.spec.whatwg.org/#this">this</a> 的
                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://dom.spec.whatwg.org/#concept-node-document">节点文档</a>，则返回。
                    </li>
                    <li>使用用户代理的 <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-target" class="internalDFN"
                            id="ref-for-dfn-pointer-lock-target-10">指针锁定目标</a>
                        退出指针锁定。</li>
                </ol>
            </dd>
        </dl>
    </section>
    <section data-dfn-for="DocumentOrShadowRoot" id="extensions-to-the-documentorshadowroot-mixin">
        <div class="header-wrapper">
            <h2 id="x5-extensions-to-the-documentorshadowroot-mixin"><bdi class="secno">5. </bdi>
                <code>DocumentOrShadowRoot</code> 混入的扩展
            </h2><a class="self-link" href="#extensions-to-the-documentorshadowroot-mixin" aria-label="第5节的永久链接。"></a>
        </div>

        <pre class="idl def" id="webidl-748339506"><span class="idlHeader"><a class="self-link" href="#webidl-748339506">WebIDL</a></span><code><span data-idl="" class="idlInterface mixin" id="idl-def-documentorshadowroot-partial-1" data-title="DocumentOrShadowRoot">partial interface mixin <a data-idl="partial" data-link-type="interface" data-title="DocumentOrShadowRoot" class="idlID" data-dfn-for="DocumentOrShadowRoot" data-type="interface" href="https://dom.spec.whatwg.org/#documentorshadowroot">DocumentOrShadowRoot</a> {<span data-idl="" class="idlAttribute" id="idl-def-documentorshadowroot-pointerlockelement" data-title="pointerLockElement" data-dfn-for="DocumentOrShadowRoot">
      readonly attribute<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://dom.spec.whatwg.org/#element">Element</a>?</span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-documentorshadowroot-pointerlockelement" id="ref-for-dom-documentorshadowroot-pointerlockelement-1"><code>pointerLockElement</code></a>;</span>
    };</span></code></pre>
        <dl>
            <dt>
                <dfn data-export="" data-dfn-type="attribute" id="dom-documentorshadowroot-pointerlockelement"
                    data-idl="attribute" data-title="pointerLockElement" data-dfn-for="DocumentOrShadowRoot"
                    data-type="Element" data-lt="pointerLockElement"
                    data-local-lt="DocumentOrShadowRoot.pointerLockElement" tabindex="0"
                    aria-haspopup="dialog"><code>pointerLockElement</code></dfn>
            </dt>
            <dd>
                <p>
                    当指针被锁定时，返回通过<a data-link-type="dfn|abstract-op" data-type="dfn"
                        href="https://dom.spec.whatwg.org/#retarget">重新定向</a>到元素的结果，
                    该元素是鼠标事件的目标，如果该结果和<a data-link-type="dfn|abstract-op" data-type="dfn"
                        href="https://webidl.spec.whatwg.org/#this">this</a>元素在同一棵树中，
                    否则返回 null。
                </p>
                <p>
                    如果锁定正在进行或指针未锁定，则返回 null。
                </p>
                <div class="example" id="example-retarget-pointerlock">
                    <div class="marker">
                        <a class="self-link" href="#example-retarget-pointerlock">示例<bdi> 2</bdi></a>
                    </div>
                    <pre aria-busy="false"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"host1"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">shadow-root</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"root1"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"canvas1"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">shadow-root</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"host2"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">shadow-root</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"root2"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"canvas2"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">shadow-root</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></code></pre>
                </div>
                <div class="note" role="note" id="issue-container-generatedID-3">
                    <div role="heading" class="note-title marker" id="h-note-3" aria-level="3"><span>注意</span></div>
                    <p class="">
                        此示例使用虚构的 <code>shadow-root</code> 元素表示一个
                        <a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://dom.spec.whatwg.org/#concept-element-shadow-root">shadow root</a> 实例。
                    </p>
                </div>
                <p>
                    如果 <code>#canvas1</code> 是目标，<code>document.pointerLockElement</code> 返回
                    <code>#host1</code>，而 <code>root1.pointerLockElement</code> 返回 <code>#canvas1</code>。
                    将 <code>#canvas1</code> 重新定向到 <code>#root2</code> 的结果是 <code>#host1</code>，
                    但由于 <code>#host1</code> 不在与 <code>#root2</code> 相同的树中，
                    因此对于 <code>root2.pointerLockElement</code> 将返回 null。
                </p>
            </dd>
        </dl>
    </section>
    <section data-dfn-for="MouseEvent" data-link-for="MouseEvent" data-cite="WEBIDL ui-events"
        id="extensions-to-the-mouseevent-interface">
        <div class="header-wrapper">
            <h2 id="x6-extensions-to-the-mouseevent-interface"><bdi class="secno">6. </bdi>
                <code>MouseEvent</code> 接口的扩展
            </h2><a class="self-link" href="#extensions-to-the-mouseevent-interface" aria-label="第6节的永久链接。"></a>
        </div>

        <pre class="idl def" id="webidl-1698756137"><span class="idlHeader"><a class="self-link" href="#webidl-1698756137">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-mouseevent-partial-1" data-title="MouseEvent">partial interface <a data-idl="partial" data-link-type="interface" data-title="MouseEvent" class="idlID" data-dfn-for="MouseEvent" data-type="interface" href="https://www.w3.org/TR/uievents/#mouseevent">MouseEvent</a> {<span data-idl="" class="idlAttribute" id="idl-def-mouseevent-movementx" data-title="movementX" data-dfn-for="MouseEvent">
      readonly attribute<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-mouseevent-movementx" id="ref-for-dom-mouseevent-movementx-1"><code>movementX</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-mouseevent-movementy" data-title="movementY" data-dfn-for="MouseEvent">
      readonly attribute<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-mouseevent-movementy" id="ref-for-dom-mouseevent-movementy-1"><code>movementY</code></a>;</span>
    };</span></code></pre>
        <dl>
            <dt>
                <dfn data-export="" data-dfn-type="attribute" id="dom-mouseevent-movementx" data-idl="attribute"
                    data-title="movementX" data-dfn-for="MouseEvent" data-type="double" data-lt="movementX"
                    data-local-lt="MouseEvent.movementX" tabindex="0"
                    aria-haspopup="dialog"><code>movementX</code></dfn> 属性
            </dt>
            <dt>
                <dfn data-export="" data-dfn-type="attribute" id="dom-mouseevent-movementy" data-idl="attribute"
                    data-title="movementY" data-dfn-for="MouseEvent" data-type="double" data-lt="movementY"
                    data-local-lt="MouseEvent.movementY" tabindex="0"
                    aria-haspopup="dialog"><code>movementY</code></dfn> 属性
            </dt>
            <dd>
                <p>
                    <a data-link-type="idl" data-lt="movementX" href="#dom-mouseevent-movementx" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementx-2"><code>movementX</code></a> 和
                    <a data-link-type="idl" data-lt="movementY" href="#dom-mouseevent-movementy" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementy-2"><code>movementY</code></a>
                    属性必须提供指针位置的变化，类似于在两个连续的 <code>mousemove</code> 事件
                    <code>eNow</code> 和 <code>ePrevious</code> 之间存储 <code>screenX</code> 和
                    <code>screenY</code> 的值并计算差异：<code>movementX = eNow.screenX - ePrevious.screenX</code>。
                </p>
                <p>
                    对于除 <code>mousemove</code> 以外的所有鼠标事件，<a data-link-type="idl" data-lt="movementX"
                        href="#dom-mouseevent-movementx" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementx-3"><code>movementX</code></a> 和
                    <a data-link-type="idl" data-lt="movementY" href="#dom-mouseevent-movementy" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementy-3"><code>movementY</code></a>
                    必须为零。所有运动数据必须通过 <code>mousemove</code> 事件传递，以便在任何两个鼠标事件
                    <code>earlierEvent</code> 和 <code>currentEvent</code> 之间，
                    <code>currentEvent.screenX - earlierEvent.screenX</code> 的值与
                    <a data-link-type="idl" data-lt="movementX" href="#dom-mouseevent-movementx" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementx-4"><code>movementX</code></a>
                    的所有事件的总和相等，除非指针被 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                        id="ref-for-dfn-user-agent-2">用户代理</a> 屏幕边界限制而无法更新
                    <code>screenX</code>。
                </p>
                <p>
                    <a data-link-type="idl" data-lt="movementX" href="#dom-mouseevent-movementx" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementx-5"><code>movementX</code></a> 和
                    <a data-link-type="idl" data-lt="movementY" href="#dom-mouseevent-movementy" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementy-4"><code>movementY</code></a>
                    必须在不管指针锁定状态下更新。
                </p>
                <p>
                    当未锁定时，系统光标可以退出并重新进入 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                        id="ref-for-dfn-user-agent-3">用户代理</a> 窗口。
                    如果发生这种情况且 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                        id="ref-for-dfn-user-agent-4">用户代理</a> 不是操作系统鼠标移动事件的目标，
                    那么 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                        id="ref-for-dfn-user-agent-5">用户代理</a> 将无法知道最新的指针位置，
                    <a data-link-type="idl" data-lt="movementX" href="#dom-mouseevent-movementx" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementx-6"><code>movementX</code></a> 和
                    <a data-link-type="idl" data-lt="movementY" href="#dom-mouseevent-movementy" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementy-5"><code>movementY</code></a>
                    无法计算，必须设为零。
                </p>
                <p>
                    当启用指针锁定时，<code>clientX</code>、<code>clientY</code>、<code>screenX</code> 和
                    <code>screenY</code> 必须保持恒定值，仿佛在进入指针锁定后指针没有移动。
                    但是 <a data-link-type="idl" data-lt="movementX" href="#dom-mouseevent-movementx" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementx-7"><code>movementX</code></a> 和
                    <a data-link-type="idl" data-lt="movementY" href="#dom-mouseevent-movementy" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementy-6"><code>movementY</code></a>
                    必须继续提供指针位置的变化，类似于指针未锁定时的情况。如果鼠标持续向一个方向移动，
                    则 <a data-link-type="idl" data-lt="movementX" href="#dom-mouseevent-movementx" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementx-8"><code>movementX</code></a> 和
                    <a data-link-type="idl" data-lt="movementY" href="#dom-mouseevent-movementy" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementy-7"><code>movementY</code></a>
                    的值将没有限制。鼠标光标的概念将被移除，光标不会移出窗口或受到屏幕边界的限制。
                </p>
                <p>
                    <a data-link-type="idl" data-lt="movementX" href="#dom-mouseevent-movementx" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementx-9"><code>movementX</code></a> 和
                    <a data-link-type="idl" data-lt="movementY" href="#dom-mouseevent-movementy" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementy-8"><code>movementY</code></a>
                    的未初始化值必须为 <code>0</code>。
                </p>
                <p>
                    当鼠标输入中断（例如鼠标光标离开窗口并在另一个位置重新进入）时，不应出现大的移动值。
                    如果 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                        id="ref-for-dfn-user-agent-6">用户代理</a> 在接收操作系统鼠标输入数据时遇到间隙，
                    则生成的下一个 <code>mousemove</code> 事件的
                    <a data-link-type="idl" data-lt="movementX" href="#dom-mouseevent-movementx" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementx-10"><code>movementX</code></a> 和
                    <a data-link-type="idl" data-lt="movementY" href="#dom-mouseevent-movementy" class="internalDFN"
                        id="ref-for-dom-mouseevent-movementy-9"><code>movementY</code></a>
                    必须设置为 <code>0</code>。这些间隙可能出现在例如当 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent"
                        class="internalDFN" id="ref-for-dfn-user-agent-7">用户代理</a>
                    在窗口系统 API 接收到鼠标离开事件时。作为例外，鼠标捕获可能允许
                    <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                        id="ref-for-dfn-user-agent-8">用户代理</a> 在光标移出窗口时继续接收鼠标事件。
                </p>
            </dd>
        </dl>
    </section>
    <section data-dfn-for="MouseEventInit" data-link-for="MouseEventInit" data-cite="WEBIDL ui-events"
        id="extensions-to-the-mouseeventinit-dictionary">
        <div class="header-wrapper">
            <h2 id="x7-extensions-to-the-mouseeventinit-dictionary"><bdi class="secno">7. </bdi>
                <code>MouseEventInit</code> 字典的扩展
            </h2><a class="self-link" href="#extensions-to-the-mouseeventinit-dictionary" aria-label="第7节的永久链接。"></a>
        </div>

        <pre class="idl def" id="webidl-788447252"><span class="idlHeader"><a class="self-link" href="#webidl-788447252">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-mouseeventinit-partial-1" data-title="MouseEventInit">partial dictionary <a data-idl="partial" data-link-type="dictionary" data-title="MouseEventInit" class="idlID" data-dfn-for="MouseEventInit" data-type="dictionary" href="https://www.w3.org/TR/uievents/#dictdef-mouseeventinit">MouseEventInit</a> {<span data-idl="" class="idlMember" id="idl-def-mouseeventinit-movementx" data-title="movementX" data-dfn-for="MouseEventInit"><span class="idlType">
      <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mouseeventinit-movementx" id="ref-for-dom-mouseeventinit-movementx-1"><code>movementX</code></a> = 0;</span><span data-idl="" class="idlMember" id="idl-def-mouseeventinit-movementy" data-title="movementY" data-dfn-for="MouseEventInit"><span class="idlType">
      <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mouseeventinit-movementy" id="ref-for-dom-mouseeventinit-movementy-1"><code>movementY</code></a> = 0;</span>
    };</span></code></pre>
        <dl>
            <dt>
                <dfn data-export="" data-dfn-type="dict-member" id="dom-mouseeventinit-movementx" data-idl="field"
                    data-title="movementX" data-dfn-for="MouseEventInit" data-type="double" tabindex="0"
                    aria-haspopup="dialog"><code>movementX</code></dfn> 成员
            </dt>
            <dt>
                <dfn data-export="" data-dfn-type="dict-member" id="dom-mouseeventinit-movementy" data-idl="field"
                    data-title="movementY" data-dfn-for="MouseEventInit" data-type="double" tabindex="0"
                    aria-haspopup="dialog"><code>movementY</code></dfn> 成员
            </dt>
            <dd>
                <a data-link-type="idl" data-lt="movementX" href="#dom-mouseeventinit-movementx" class="internalDFN"
                    id="ref-for-dom-mouseeventinit-movementx-2"><code>movementX</code></a> 和
                <a data-link-type="idl" data-lt="movementY" href="#dom-mouseeventinit-movementy" class="internalDFN"
                    id="ref-for-dom-mouseeventinit-movementy-2"><code>movementY</code></a>
                成员用于初始化 <a data-link-type="idl" data-lt="MouseEvent" data-type="interface"
                    href="https://www.w3.org/TR/uievents/#mouseevent"><code>MouseEvent</code></a> 的相应成员。
            </dd>
        </dl>
    </section>
    <section id="requirements">
        <div class="header-wrapper">
            <h2 id="x8-requirements"><bdi class="secno">8. </bdi>
                要求
            </h2><a class="self-link" href="#requirements" aria-label="第8节的永久链接。"></a>
        </div>

        <p>
            必须始终提供一个 <dfn id="dfn-default-unlock-gesture" tabindex="0" aria-haspopup="dialog"
                data-dfn-type="dfn">默认解锁手势</dfn>，
            用于通过 <a data-link-type="dfn|abstract-op" href="#dfn-exit-pointer-lock" class="internalDFN"
                id="ref-for-dfn-exit-pointer-lock-2">退出指针锁定</a>，
            使用 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                id="ref-for-dfn-user-agent-9">用户代理</a> 的 <a data-link-type="dfn|abstract-op"
                href="#dfn-pointer-lock-target" class="internalDFN" id="ref-for-dfn-pointer-lock-target-11">指针锁定目标</a>。
        </p>
        <div class="note" role="note" id="issue-container-generatedID-4">
            <div role="heading" class="note-title marker" id="h-note-4" aria-level="3"><span>注意</span></div>
            <aside class="">
                <p>
                    对于具有键盘输入的 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                        id="ref-for-dfn-user-agent-10">用户代理</a>，建议使用 ESC 键作为 <a data-link-type="dfn|abstract-op"
                        href="#dfn-default-unlock-gesture" class="internalDFN"
                        id="ref-for-dfn-default-unlock-gesture-2">默认解锁手势</a>。建议解锁手势也应与退出全屏使用的手势一致
                    [<cite><a class="bibref" data-link-type="biblio" href="#bib-fullscreen"
                            title="Fullscreen API Standard">FULLSCREEN</a></cite>]。
                </p>
            </aside>
        </div>
        <p>
            如果 <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-target" class="internalDFN"
                id="ref-for-dfn-pointer-lock-target-12">指针锁定目标</a>
            <a data-lt="become disconnected" data-type="dfn"
                href="https://html.spec.whatwg.org/multipage/infrastructure.html#becomes-disconnected">断开连接</a>，
            或者 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                id="ref-for-dfn-user-agent-11">用户代理</a>、
            窗口或标签页失去焦点，则必须退出指针锁定。在 <a data-link-type="dfn|abstract-op" data-type="dfn"
                href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document">活动文档</a> 元素之间移动焦点，
            包括在 <a data-link-type="dfn|abstract-op" data-type="dfn"
                href="https://html.spec.whatwg.org/multipage/document-sequences.html#concept-document-bc">浏览上下文</a> 之间，
            不会导致 <a data-link-type="dfn|abstract-op" href="#dfn-exit-pointer-lock" class="internalDFN"
                id="ref-for-dfn-exit-pointer-lock-3">退出指针锁定</a>。
            例如，使用键盘在框架或 iframe 的内容之间移动焦点不会退出。
        </p>
        <p>
            当进入或退出全屏 [<cite><a class="bibref" data-link-type="biblio" href="#bib-fullscreen"
                    title="Fullscreen API Standard">FULLSCREEN</a></cite>] 时，
            除非指针需要启用与 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                id="ref-for-dfn-user-agent-12">用户代理</a> 图形用户界面的交互，
            使用 <a data-link-type="dfn|abstract-op" href="#dfn-default-unlock-gesture" class="internalDFN"
                id="ref-for-dfn-default-unlock-gesture-3">默认解锁手势</a>
            退出了全屏和指针锁定，或者窗口或标签页失去焦点，则不得退出指针锁定。
        </p>
    </section>
    <section class="informative" id="use-cases">
        <div class="header-wrapper">
            <h2 id="x9-use-cases"><bdi class="secno">9. </bdi>
                用例
            </h2><a class="self-link" href="#use-cases" aria-label="第9节的永久链接。"></a>
        </div>
        <p><em>本节为非规范性内容。</em></p>

        <section id="relative-view-port-rotation-of-free-moving-virtual-actors">
            <div class="header-wrapper">
                <h3 id="x9-1-relative-view-port-rotation-of-free-moving-virtual-actors"><bdi class="secno">9.1 </bdi>
                    自由移动虚拟角色的相对视口旋转
                </h3><a class="self-link" href="#relative-view-port-rotation-of-free-moving-virtual-actors"
                    aria-label="第9.1节的永久链接。"></a>
            </div>

            <p>
                玩家在第一/第三人称游戏中需要控制视口的方向。一个广泛使用的方法是使用鼠标移动来控制视角。
                这种应用可以使用 Pointer Lock API 来允许对视口的偏航和俯仰进行完全自由的控制，即使用户没有按下鼠标按钮。
                这些按钮可以用于其他操作，而鼠标移动可以持续提供导航。
            </p>
        </section>
        <section id="free-rotation-of-3d-models-or-panning-of-2d-layers">
            <div class="header-wrapper">
                <h3 id="x9-2-free-rotation-of-3d-models-or-panning-of-2d-layers"><bdi class="secno">9.2 </bdi>
                    自由旋转 3D 模型或平移 2D 层
                </h3><a class="self-link" href="#free-rotation-of-3d-models-or-panning-of-2d-layers"
                    aria-label="第9.2节的永久链接。"></a>
            </div>

            <p>
                三维建模应用的用户需要旋转模型。应用程序可以使用 Pointer Lock API 允许作者在拖动操作中自由旋转模型，而不会限制运动。
                如果没有指针锁定，当鼠标光标受到屏幕边缘的限制时，拖动将停止提供运动数据。
            </p>
            <p>
                同样，绝对运动的平移操作可以在不受光标/屏幕限制的单次拖动中完成，适用于大的二维图像。
            </p>
        </section>
        <section id="relative-movement-of-actors">
            <div class="header-wrapper">
                <h3 id="x9-3-relative-movement-of-actors"><bdi class="secno">9.3 </bdi>
                    角色的相对运动
                </h3><a class="self-link" href="#relative-movement-of-actors" aria-label="第9.3节的永久链接。"></a>
            </div>

            <p>
                在快速反应游戏中，玩家控制一个球拍将球反弹回对手，同时允许该球拍根据按下的不同鼠标按钮执行动作。
                应用程序可以使用 Pointer Lock API 允许玩家快速反应，而无需担心鼠标光标离开游戏区域并点击其他系统应用程序，从而打断游戏流程。
            </p>
        </section>
        <section id="jog-movement-over-spinner-controls">
            <div class="header-wrapper">
                <h3 id="x9-4-jog-movement-over-spinner-controls"><bdi class="secno">9.4 </bdi>
                    在旋转控制器上的快进运动
                </h3><a class="self-link" href="#jog-movement-over-spinner-controls" aria-label="第9.4节的永久链接。"></a>
            </div>

            <p>
                在应用程序中修改数值时，有时用户会更喜欢通过拖动按钮手柄来增减数值。
                例如，一个带有数字输入文本框和上下箭头的旋转器，可以点击或拖动来改变数值。
                应用程序可以使用 Pointer Lock API 允许修改数值超过逻辑屏幕边界。这个方法同样适用于类似“快进”或“倒退”视频或音频流的控制。
            </p>
        </section>
        <section id="synthetic-cursor-interaction-with-html-dom-ui">
            <div class="header-wrapper">
                <h3 id="x9-5-synthetic-cursor-interaction-with-html-dom-ui"><bdi class="secno">9.5 </bdi>
                    与 HTML DOM UI 进行合成光标交互
                </h3><a class="self-link" href="#synthetic-cursor-interaction-with-html-dom-ui"
                    aria-label="第9.5节的永久链接。"></a>
            </div>

            <p>
                一些游戏使用经典光标，但他们希望对其进行限制或控制。例如，限制在游戏范围内，或者由游戏进行移动。
                锁定指针使这一点成为可能，如果应用程序创建自己的光标。但是 HTML 和 DOM 仍应可用于用户界面。
                应该允许合成鼠标事件使应用定义的光标能够与 DOM 交互。例如，以下代码应允许自定义光标在指针锁定时发送点击事件：
            </p>
            <div class="example" id="example-3">
                <div class="marker">
                    <a class="self-link" href="#example-3">示例<bdi> 3</bdi></a>
                </div>
                <pre aria-busy="false"><code class="hljs javascript"><span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
      <span class="hljs-keyword">if</span> (e._isSynthetic)
        <span class="hljs-keyword">return</span>;
      <span class="hljs-comment">// 发送一个合成点击</span>
      <span class="hljs-keyword">var</span> ee = <span class="hljs-built_in">document</span>.createEvent(<span class="hljs-string">"MouseEvents"</span>);
      ee._isSynthetic = <span class="hljs-literal">true</span>;
      x = myCursor.x;
      y = myCursor.y;
      ee.initMouseEvent(<span class="hljs-string">"click"</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">null</span>, <span class="hljs-number">1</span>,
                        x + e.screenX - e.clientX,
                        y + e.screenY - e.clientY,
                        x,
                        y);
      <span class="hljs-keyword">var</span> target = <span class="hljs-built_in">document</span>.elementFromPoint(x, y);
      <span class="hljs-keyword">if</span> (target)
        target.dispatchEvent(ee);
    });</code></pre>
            </div>
            <p>
                注意，合成点击可能不被 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                    id="ref-for-dfn-user-agent-13">用户代理</a> 允许产生与非合成点击相同的默认操作。
                但是，应用程序处理程序仍然可以采取行动，并使用现有的 HTML 和 DOM 机制提供用户界面。
            </p>
        </section>
        <section id="view-port-panning-by-moving-a-mouse-cursor-against-the-bounds-of-a-view-port">
            <div class="header-wrapper">
                <h3 id="x9-6-view-port-panning-by-moving-a-mouse-cursor-against-the-bounds-of-a-view-port"><bdi
                        class="secno">9.6 </bdi>
                    通过将鼠标光标移动到视口边界来进行视口平移
                </h3><a class="self-link"
                    href="#view-port-panning-by-moving-a-mouse-cursor-against-the-bounds-of-a-view-port"
                    aria-label="第9.6节的永久链接。"></a>
            </div>

            <p>
                即时战略游戏通常使用这种技术。当玩家将光标移动到视口边界时，如果他们通过鼠标移动“推动”边界，
                视口将根据他们移动鼠标的距离在游戏区域内平移。当在视口范围内移动鼠标光标时，它的行为与通常系统中的行为类似。
                应用程序可以选择使用指针锁定和之前的用例“与 HTML DOM UI 进行合成光标交互”来完全控制光标行为。
            </p>
        </section>
        <section id="game-lobby-timer-based-pointer-lock">
            <div class="header-wrapper">
                <h3 id="x9-7-game-lobby-timer-based-pointer-lock"><bdi class="secno">9.7 </bdi>
                    游戏大厅中基于计时器的指针锁定
                </h3><a class="self-link" href="#game-lobby-timer-based-pointer-lock" aria-label="第9.7节的永久链接。"></a>
            </div>

            <p>
                使用指针锁定的游戏可能希望在玩家在游戏大厅准备时拥有传统的用户界面和系统光标。
                游戏通常在所有玩家准备好后经过短时间的计时器后开始。理想情况下，游戏可以在不需要
                <a data-link-type="dfn|abstract-op" data-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/interaction.html#tracking-user-activation">用户激活</a>的情况下切换到指针锁定模式。
                玩家应能够无缝地从游戏大厅过渡到游戏导航。
            </p>
        </section>
        <section id="game-portal">
            <div class="header-wrapper">
                <h3 id="x9-8-game-portal"><bdi class="secno">9.8 </bdi>
                    游戏门户
                </h3><a class="self-link" href="#game-portal" aria-label="第9.8节的永久链接。"></a>
            </div>

            <p>
                游戏门户和其他网站（如 Facebook 和 Google Plus）托管供用户玩的游戏。
                这些游戏可能托管在与门户网站不同的来源。嵌入式游戏应能够在非全屏模式下锁定指针。
            </p>
        </section>
    </section>
    <section class="informative" id="security">
        <div class="header-wrapper">
            <h2 id="x10-security"><bdi class="secno">10. </bdi>
                安全
            </h2><a class="self-link" href="#security" aria-label="第10节的永久链接。"></a>
        </div>
        <p><em>本节为非规范性内容。</em></p>

        <p>
            安全问题：
        </p>
        <ul>
            <li>用户操作可能被引导到用户不打算交互的元素上。</li>
            <li>指针锁定将移除用户与 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                    id="ref-for-dfn-user-agent-14">用户代理</a>
                和操作系统控制的交互能力。</li>
            <li>脚本可以在用户退出指针锁定后反复调用 Pointer Lock，从而阻止用户的有效进展。</li>
            <li>某些 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                    id="ref-for-dfn-user-agent-15">用户代理</a>
                会在指针移动到屏幕顶部时显示全屏退出提示。指针锁定时无法进行该操作。</li>
        </ul>
        <p>
            应对措施：
        </p>
        <ul>
            <li><a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                    id="ref-for-dfn-user-agent-16">用户代理</a>
                可能会限制哪些安全源可以锁定指针。</li>
            <li><a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                    id="ref-for-dfn-user-agent-17">用户代理</a>
                可能会在锁定前提示确认，并且该偏好可能被保存为内容设置。</li>
            <li>通过 <a data-link-type="dfn|abstract-op" href="#dfn-default-unlock-gesture" class="internalDFN"
                    id="ref-for-dfn-default-unlock-gesture-4">默认解锁手势</a>
                （如 ESC 键）始终提供退出机制。</li>
            <li>可以提供持续显示的退出提示。</li>
            <li>指针锁定的重复退出可以向 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                    id="ref-for-dfn-user-agent-18">用户代理</a>
                发出信号，不进行进一步锁定，除非有更具体的用户操作（类似 Chrome 抑制重复的 alert() 调用）。</li>
            <li>切换到新标签、窗口或任何导致页面失去焦点的操作将通过 <a data-link-type="dfn|abstract-op" href="#dfn-exit-pointer-lock"
                    class="internalDFN" id="ref-for-dfn-exit-pointer-lock-4">退出指针锁定</a>
                并释放 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                    id="ref-for-dfn-user-agent-19">用户代理</a> 的
                <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-target" class="internalDFN"
                    id="ref-for-dfn-pointer-lock-target-13">指针锁定目标</a>。
            </li>
            <li>指针锁定只能在窗口聚焦于 <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                    id="ref-for-dfn-user-agent-20">用户代理</a>
                和操作系统时启用。</li>
        </ul>
        <p>
            建议：
        </p>
        <ul>
            <li>ESC 键应当通过 <a data-link-type="dfn|abstract-op" href="#dfn-exit-pointer-lock" class="internalDFN"
                    id="ref-for-dfn-exit-pointer-lock-5">退出指针锁定</a>
                并释放用户代理的 <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-target" class="internalDFN"
                    id="ref-for-dfn-pointer-lock-target-14">指针锁定目标</a>。</li>
            <li>可以像弹出窗口、地理位置和全屏设置一样，针对每个子域使用偏好设置来允许或阻止指针锁定。</li>
        </ul>
        <p>
            指针锁定是某些应用程序类型所需的用户交互模式，但如果被恶意使用，可能会带来可用性问题。
            攻击者可能会移除用户在其系统上控制鼠标光标的能力。<a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                id="ref-for-dfn-user-agent-21">用户代理</a>
            将通过始终提供退出机制、告知用户如何退出并限制指针锁定的进入方式来防止这种情况。
        </p>
        <p>
            <a data-link-type="dfn|abstract-op" href="#dfn-user-agent" class="internalDFN"
                id="ref-for-dfn-user-agent-22">用户代理</a>
            将根据设备或用户选项自行确定适当的策略，这些策略可能因设备或用户选项而有所不同。
        </p>
    </section>
    <section class="informative" id="frequently-asked-questions">
        <div class="header-wrapper">
            <h2 id="x11-frequently-asked-questions"><bdi class="secno">11. </bdi>
                常见问题解答
            </h2><a class="self-link" href="#frequently-asked-questions" aria-label="第11节的永久链接。"></a>
        </div>
        <p><em>本节为非规范性内容。</em></p>

        <section id="why-not-merge-with-mouse-capture-setcapture">
            <div class="header-wrapper">
                <h3 id="x11-1-why-not-merge-with-mouse-capture-setcapture"><bdi class="secno">11.1 </bdi>
                    为什么不与 Mouse Capture: setCapture() 合并？
                </h3><a class="self-link" href="#why-not-merge-with-mouse-capture-setcapture"
                    aria-label="第11.1节的永久链接。"></a>
            </div>

            <p>
                Mouse Capture [<cite><a class="bibref" data-link-type="biblio" href="#bib-mdn-setcapture"
                        title="Element.setCapture()">MDN-SETCAPTURE</a></cite>] 处理了鼠标拖动手势期间低安全风险的鼠标事件目标锁定。
                指针锁定移除了光标的概念，并将所有事件指向给定的目标。它们是相关的，但不同。
            </p>
            <p>
                如果浏览器实现了两者，支持功能组合是合理的：自动释放锁定的安全简化功能，以及对鼠标输入的完全控制和移除系统光标的增强功能。
                该安全特性允许应用程序在拖动事件期间仅需短暂的指针锁定时，更宽松地使用该功能。
            </p>
            <p>
                这种功能在该规范的初始版本中被省略，因为它仅帮助了窗口模式下的小众用例，但我们仍然没有解决主要用例的实现方案。
                而且，要实现这一点，浏览器必须同时实现这两者，而目前没有浏览器这样做。尚不清楚该功能应属于 .lock 还是 .setCapture。
                如果两者都实现了，任何 API 都可以很容易地扩展以提供混合功能。
            </p>
        </section>
        <section id="why-not-repurpose-mouseevent-s-clientx-y-screenx-y">
            <div class="header-wrapper">
                <h3 id="x11-2-why-not-repurpose-mouseevent-s-clientx-y-screenx-y"><bdi class="secno">11.2 </bdi>
                    为什么不重新利用 MouseEvent 的 .clientX/Y .screenX/Y？
                </h3><a class="self-link" href="#why-not-repurpose-mouseevent-s-clientx-y-screenx-y"
                    aria-label="第11.2节的永久链接。"></a>
            </div>

            <p>
                即使在非锁定状态下，鼠标移动的增量值也是有用的。根据锁定状态改变 .client 或 .screen 的含义还会导致代码中容易出现错误，
                特别是在不仔细监控锁定状态时。
            </p>
        </section>
        <section id="why-use-movementx-y-instead-of-deltax-y">
            <div class="header-wrapper">
                <h3 id="x11-3-why-use-movementx-y-instead-of-deltax-y"><bdi class="secno">11.3 </bdi>
                    为什么使用 .movementX/Y 而不是 .deltaX/Y？
                </h3><a class="self-link" href="#why-use-movementx-y-instead-of-deltax-y" aria-label="第11.3节的永久链接。"></a>
            </div>

            <p>
                当指针锁定时，“wheel”事件应与“mousemove”事件一样发送到 <a data-link-type="dfn|abstract-op" href="#dfn-pointer-lock-target"
                    class="internalDFN" id="ref-for-dfn-pointer-lock-target-15">指针锁定目标</a> 元素。
                与 DOM 3 “wheel”事件中定义的 .deltaX/Y/Z 存在命名冲突。
            </p>
        </section>
        <section id="why-bundle">
            <div class="header-wrapper">
                <h3
                    id="x11-4-why-bundle-all-functionality-hiding-cursor-providing-mouse-deltas-instead-of-using-css-to-hide-the-cursor-always-providing-delta-values-and-offering-an-api-to-restrict-the-cursor-movement-to-a-portion-of-the-web-page">
                    <bdi class="secno">11.4 </bdi>
                    为什么将所有功能（隐藏光标、提供鼠标增量）捆绑在一起，而不是使用 CSS 隐藏光标、始终提供增量值并提供限制光标移动到网页某部分的 API？
                </h3><a class="self-link" href="#why-bundle" aria-label="第11.4节的永久链接。"></a>
            </div>

            <p>
                提供更精细控制的方法是合理的。例如，“通过将鼠标光标移动到视口边界来进行视口平移”这一用例并不需要隐藏光标，
                只需限制光标并始终提供增量值即可。此外，本规范定义了从系统鼠标光标移动中获取的运动增量，
                该增量包含操作系统对鼠标移动数据的过滤和加速。应用程序可能希望访问更原始的移动数据形式，
                即在适合鼠标光标的调整之前的数据。此外，原始数据可能提供比像素级别更高的移动精度，以及更高频率的更新。
                提供原始增量运动不需要用户的特殊权限或模式，对于不需要限制光标的一些应用程序来说，可能会减少所需的安全屏障和提示。
            </p>
            <p>
                推迟这种精细控制方法的原因有两个。首先是关于鼠标移动数据的单位问题。
                本规范定义了 .movementX/Y 与鼠标未锁定时的 .screenX/Y 变化相同的值。各个 <a data-link-type="dfn|abstract-op"
                    href="#dfn-user-agent" class="internalDFN" id="ref-for-dfn-user-agent-23">用户代理</a>
                和操作系统可以轻松满足这一要求，并为应用程序开发者和用户提供一致的体验。
                此外，用户已预先配置了硬件输入和操作系统选项，从而使得系统鼠标光标控制更为舒适。
                通过将 .movementX/Y 规定为与鼠标锁定 API 应用程序相同的单位，所有用户都可以立即使用这些应用程序，因为他们已经调整了他们的偏好。
            </p>
            <p>
                其次，实现精细控制方法的运动数据和光标限制更为困难。捆绑这些功能为实现提供了自由，
                使其可以根据每个操作系统使用各种技术，并且更容易实现。在主要桌面平台（Windows、Mac OS X、Linux）上没有直接的 API
                来将光标限制到特定的矩形区域，并且尚未开发出通过例如使用 <a href="https://tronche.com/gui/x/xlib/window/attributes/">不可见窗口</a> 或
                <a href="https://en.wikipedia.org/wiki/Xlib">Xlib</a> 进行原型构建来演示这一行为。未加速的增量值已经提出通过读取原始人机界面设备（HID）数据来访问。
                例如，Windows 上的 WM_INPUT 消息，以及 Mac OS X / Linux 上的 USB 设备 API。
                挑战在于解释和规范单位为一致且可指定的尺度。此外，迄今为止考虑的大多数 API 都仅限于 USB 设备。
            </p>
            <p>
                考虑到当前规范的指针锁定 API 在未来实现这些精细控制的增量和限制功能时可以轻松继续支持，
                添加这些功能在未来是合理的。
            </p>
            <p>
                捆绑的 API 选择了实现的实用性，因为支持了预期的用例，并且不会与此处讨论的未来改进发生冲突。
            </p>
        </section>
        <section id="high-resolution-deltas-high-frequency-updates">
            <div class="header-wrapper">
                <h3 id="x11-5-high-resolution-deltas-high-frequency-updates"><bdi class="secno">11.5 </bdi>
                    高分辨率增量/高频更新？
                </h3><a class="self-link" href="#high-resolution-deltas-high-frequency-updates"
                    aria-label="第11.5节的永久链接。"></a>
            </div>

            <p>
                还没有，原因与上一个问题相同：<a href="#why-bundle">“为什么将所有功能（隐藏光标、提供鼠标增量）捆绑在一起，而不是使用 CSS 隐藏光标、
                    始终提供增量值并提供限制光标移动到网页某部分的 API？”</a>。
            </p>
        </section>
        <section id="why-modify-mouseevent-and-reuse-existing-mouse-events-instead-of-creating-a-mouse-delta-event">
            <div class="header-wrapper">
                <h3
                    id="x11-6-why-modify-mouseevent-and-reuse-existing-mouse-events-instead-of-creating-a-mouse-delta-event">
                    <bdi class="secno">11.6 </bdi>
                    为什么修改 MouseEvent 并重用现有鼠标事件而不是创建 Mouse Delta 事件？
                </h3><a class="self-link"
                    href="#why-modify-mouseevent-and-reuse-existing-mouse-events-instead-of-creating-a-mouse-delta-event"
                    aria-label="第11.6节的永久链接。"></a>
            </div>

            <p>
                在指针锁定时，许多鼠标事件仍然相关，例如 click、mousedown 等。它们都共享相同的事件数据结构 MouseEvent。
                如果通过一个新数据结构报告移动数据，那么将需要一个新事件来报告增量移动。
                新的数据结构将与 MouseEvent 有许多相似之处，例如按钮和修改键状态的便利性。
                在处理 click、down 和 up 事件时是否使用现有的 mousedown 和 mouseup？
                如果是，它们将提供无用的 .clientX/Y 和 .screenX/Y 数据，但缺乏包含当前运动数据的便利性。
                否则，当鼠标锁定时，将需要新的事件。
            </p>
            <p>
                此外，即使鼠标未锁定，movementX/Y 也是方便的。本规范要求即使光标存在，运动成员始终有效。
                这减少了在应用程序希望利用鼠标的增量运动时，跟踪最后的光标状态和 mouseover/mouseout 过渡所需的代码。
            </p>
            <p>
                将 movementX/Y 添加到 MouseEvent 的唯一缺点似乎是在指针锁定时 clientX/Y 和 screenX/Y 中的未使用值。
                这似乎不是一个重要问题。
            </p>
            <p>
                因此，选择了向 MouseEvent 添加 movementX/Y 这一最小变更，以减少 API 和实现的复杂性。
            </p>
        </section>
        <section id="why-separate-targets-for-mouse-events-under-pointer-lock-and-keyboard-input-focus">
            <div class="header-wrapper">
                <h3 id="x11-7-why-separate-targets-for-mouse-events-under-pointer-lock-and-keyboard-input-focus"><bdi
                        class="secno">11.7 </bdi>
                    为什么在指针锁定下为鼠标事件和键盘输入焦点分离目标？
                </h3><a class="self-link"
                    href="#why-separate-targets-for-mouse-events-under-pointer-lock-and-keyboard-input-focus"
                    aria-label="第11.7节的永久链接。"></a>
            </div>

            <p>
                考虑一个通过移动鼠标光标控制 3D 视图的游戏，同时用户仍可以通过文本控制台与其他用户聊天。
                应用程序接受文本输入到与分派鼠标事件的元素不同的元素是合理的。这类似于在页面上填写表单时接收 mousemove 事件的预先行为。
            </p>
        </section>
    </section>
    <section id="conformance">
        <div class="header-wrapper">
            <h2 id="x12-conformance"><bdi class="secno">12. </bdi>一致性</h2><a class="self-link" href="#conformance"
                aria-label="第12节的永久链接。"></a>
        </div>
        <p>与标记为非规范的章节一样，本规范中的所有作者指南、图表、示例和注释都是非规范的。除此之外，本规范中的所有内容都是规范性的。</p>
        <p>
            本规范定义了一些一致性标准，适用于单个产品：<dfn data-plurals="user agents" id="dfn-user-agent" tabindex="0"
                aria-haspopup="dialog" data-dfn-type="dfn">用户代理</dfn>，即实现了其中包含的接口的用户代理。
        </p>
    </section>
    <section class="appendix informative" id="acknowledgments">
        <div class="header-wrapper">
            <h2 id="a-acknowledgments"><bdi class="secno">A. </bdi>
                致谢
            </h2><a class="self-link" href="#acknowledgments" aria-label="附录A的永久链接。"></a>
        </div>
        <p><em>本节为非规范性内容。</em></p>

        <p>
            非常感谢众多对本规范讨论做出贡献的人们：
        </p>
        <ul>
            <li>Adam Barth
            </li>
            <li>Alexey Proskuryakov
            </li>
            <li>Aryeh Gregor
            </li>
            <li>Boris Zbarsky
            </li>
            <li>Brandon Andrews
            </li>
            <li>Darin Fisher
            </li>
            <li>Dimitri Glazkov
            </li>
            <li>Ella Ge
            </li>
            <li>Glenn Maynard
            </li>
            <li>Gregg Tavares
            </li>
            <li>Janice Shiu
            </li>
            <li>John Villar
            </li>
            <li>Jonas Sicking
            </li>
            <li>Kagami Sascha Rosylight
            </li>
            <li>Klaas Heidstra
            </li>
            <li>Léonie Watson
            </li>
            <li>Marcos Cáceres
            </li>
            <li>Ms2ger
            </li>
            <li>Mustaq Ahmed
            </li>
            <li>Navid Zolghadr
            </li>
            <li>Olli Pettay
            </li>
            <li>Patrick H. Lauke
            </li>
            <li>Philip Jägenstedt
            </li>
            <li>Philippe Le Hegaret
            </li>
            <li>Robert O'Callahan
            </li>
            <li>Tab Atkins Jr.
            </li>
            <li>Takayoshi Kochi
            </li>
            <li>Timeless
            </li>
            <li>Vincent Scheib
            </li>
            <li>Xiaoqian Wu
            </li>
            <li>Yves Lafon
            </li>
        </ul>
    </section>


    <section id="references" class="appendix">
        <div class="header-wrapper">
            <h2 id="b-references"><bdi class="secno">B. </bdi>参考文献</h2><a class="self-link" href="#references"
                aria-label="附录B的永久链接。"></a>
        </div>
        <section id="normative-references">
            <div class="header-wrapper">
                <h3 id="b-1-normative-references"><bdi class="secno">B.1 </bdi>规范性参考</h3><a class="self-link"
                    href="#normative-references" aria-label="附录B.1的永久链接。"></a>
            </div>

            <dl class="bibliography">
                <dt id="bib-dom">[dom]</dt>
                <dd>
                    <a href="https://dom.spec.whatwg.org/"><cite>DOM 标准</cite></a>。Anne van Kesteren。WHATWG。
                    现行标准。URL：<a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-fullscreen">[FULLSCREEN]</dt>
                <dd>
                    <a href="https://fullscreen.spec.whatwg.org/"><cite>全屏 API 标准</cite></a>。Philip Jägenstedt。WHATWG。
                    现行标准。URL：<a href="https://fullscreen.spec.whatwg.org/">https://fullscreen.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-html">[html]</dt>
                <dd>
                    <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML 标准</cite></a>。Anne van Kesteren；
                    Domenic Denicola；Ian Hickson；Philip Jägenstedt；Simon Pieters。WHATWG。
                    现行标准。URL：<a
                        href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
                </dd>
                <dt id="bib-ui-events">[ui-events]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/uievents/"><cite>UI 事件</cite></a>。Gary Kacmarcik；Travis Leithead。W3C。
                    2024年2月21日。W3C工作草案。URL：<a href="https://www.w3.org/TR/uievents/">https://www.w3.org/TR/uievents/</a>
                </dd>
                <dt id="bib-webidl">[WEBIDL]</dt>
                <dd>
                    <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL 标准</cite></a>。Edgar Chen；Timothy Gu。WHATWG。
                    现行标准。URL：<a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
                </dd>
            </dl>
        </section>
        <section id="informative-references">
            <div class="header-wrapper">
                <h3 id="b-2-informative-references"><bdi class="secno">B.2 </bdi>信息性参考</h3><a class="self-link"
                    href="#informative-references" aria-label="附录B.2的永久链接。"></a>
            </div>

            <dl class="bibliography">
                <dt id="bib-mdn-setcapture">[MDN-SETCAPTURE]</dt>
                <dd>
                    <a
                        href="https://developer.mozilla.org/en-US/docs/Web/API/Element/setCapture"><cite>Element.setCapture()</cite></a>。
                    Eric Shepherd 等人。URL：<a
                        href="https://developer.mozilla.org/en-US/docs/Web/API/Element/setCapture">https://developer.mozilla.org/en-US/docs/Web/API/Element/setCapture</a>
                </dd>
            </dl>
        </section>
    </section>
    <p role="navigation" id="back-to-top">
        <a href="#title"><abbr title="返回顶部">↑</abbr></a>
    </p>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-pointer-lock-state"
        aria-label="Links in this document to definition: pointer lock state">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-pointer-lock-state"
                aria-label="Permalink for definition: pointer lock state. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-pointer-lock-state-1" title="§ 2.1 The pointer lock state definition">§ 2.1 The
                    pointer lock state definition</a> <a href="#ref-for-dfn-pointer-lock-state-2"
                    title="Reference 2">(2)</a> <a href="#ref-for-dfn-pointer-lock-state-3" title="Reference 3">(3)</a>
                <a href="#ref-for-dfn-pointer-lock-state-4" title="Reference 4">(4)</a> <a
                    href="#ref-for-dfn-pointer-lock-state-5" title="Reference 5">(5)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pointer-lock-state-6" title="§ 2.4 Exit Pointer Lock">§ 2.4 Exit Pointer Lock</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pointer-lock-state-7" title="§ 3. Extensions to the Element Interface">§ 3.
                    Extensions to the Element Interface</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-pointer-lock-target"
        aria-label="Links in this document to definition: pointer-lock target">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-pointer-lock-target"
                aria-label="Permalink for definition: pointer-lock target. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-pointer-lock-target-1" title="§ 2.1 The pointer lock state definition">§ 2.1 The
                    pointer lock state definition</a> <a href="#ref-for-dfn-pointer-lock-target-2"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pointer-lock-target-3" title="§ 2.4 Exit Pointer Lock">§ 2.4 Exit Pointer Lock</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pointer-lock-target-4" title="§ 3. Extensions to the Element Interface">§ 3.
                    Extensions to the Element Interface</a> <a href="#ref-for-dfn-pointer-lock-target-5"
                    title="Reference 2">(2)</a> <a href="#ref-for-dfn-pointer-lock-target-6" title="Reference 3">(3)</a>
                <a href="#ref-for-dfn-pointer-lock-target-7" title="Reference 4">(4)</a> <a
                    href="#ref-for-dfn-pointer-lock-target-8" title="Reference 5">(5)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pointer-lock-target-9" title="§ 4. Extensions to the Document Interface">§ 4.
                    Extensions to the Document Interface</a> <a href="#ref-for-dfn-pointer-lock-target-10"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pointer-lock-target-11" title="§ 8. Requirements">§ 8. Requirements</a> <a
                    href="#ref-for-dfn-pointer-lock-target-12" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pointer-lock-target-13" title="§ 10. Security">§ 10. Security</a> <a
                    href="#ref-for-dfn-pointer-lock-target-14" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pointer-lock-target-15"
                    title="§ 11.3 Why use .movementX/Y instead of .deltaX/Y?">§ 11.3 Why use .movementX/Y instead of
                    .deltaX/Y?</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-pointer-lock-options"
        aria-label="Links in this document to definition: pointer-lock options">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-pointer-lock-options"
                aria-label="Permalink for definition: pointer-lock options. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-pointer-lock-options-1" title="§ 2.1 The pointer lock state definition">§ 2.1 The
                    pointer lock state definition</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pointer-lock-options-2" title="§ 2.4 Exit Pointer Lock">§ 2.4 Exit Pointer
                    Lock</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pointer-lock-options-3" title="§ 3. Extensions to the Element Interface">§ 3.
                    Extensions to the Element Interface</a> <a href="#ref-for-dfn-pointer-lock-options-4"
                    title="Reference 2">(2)</a> <a href="#ref-for-dfn-pointer-lock-options-5"
                    title="Reference 3">(3)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-cursor-position"
        aria-label="Links in this document to definition: cursor position">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-cursor-position"
                aria-label="Permalink for definition: cursor position. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-cursor-position-1" title="§ 2.4 Exit Pointer Lock">§ 2.4 Exit Pointer Lock</a> <a
                    href="#ref-for-dfn-cursor-position-2" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-cursor-position-3" title="§ 3. Extensions to the Element Interface">§ 3.
                    Extensions to the Element Interface</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-pointerlockoptions"
        aria-label="Links in this document to definition: PointerLockOptions">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-pointerlockoptions"
                aria-label="Permalink for definition: PointerLockOptions. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1846476394">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-pointerlockoptions-1" title="§ 2.1 The pointer lock state definition">§ 2.1 The
                    pointer lock state definition</a> <a href="#ref-for-dom-pointerlockoptions-2"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-pointerlockoptions-3" title="§ 2.2 PointerLockOptions dictionary">§ 2.2
                    PointerLockOptions dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-pointerlockoptions-4" title="§ 3. Extensions to the Element Interface">§ 3.
                    Extensions to the Element Interface</a> <a href="#ref-for-dom-pointerlockoptions-5"
                    title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-pointerlockoptions-unadjustedmovement"
        aria-label="Links in this document to definition: unadjustedMovement">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-pointerlockoptions-unadjustedmovement"
                aria-label="Permalink for definition: unadjustedMovement. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1846476394">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-pointerlockoptions-unadjustedmovement-1"
                    title="§ 2.1 The pointer lock state definition">§ 2.1 The pointer lock state definition</a> <a
                    href="#ref-for-dom-pointerlockoptions-unadjustedmovement-2" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dom-pointerlockoptions-unadjustedmovement-3"
                    title="§ 2.2 PointerLockOptions dictionary">§ 2.2 PointerLockOptions dictionary</a>
            </li>
            <li>
                <a href="#ref-for-dom-pointerlockoptions-unadjustedmovement-4"
                    title="§ 3. Extensions to the Element Interface">§ 3. Extensions to the Element Interface</a> <a
                    href="#ref-for-dom-pointerlockoptions-unadjustedmovement-5" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-pointerlockchange"
        aria-label="Links in this document to definition: pointerlockchange">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-pointerlockchange"
                aria-label="Permalink for definition: pointerlockchange. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-pointerlockchange-1" title="§ 2.3 pointerlockchange and pointerlockerror Events">§
                    2.3 pointerlockchange and pointerlockerror Events</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pointerlockchange-2" title="§ 2.4 Exit Pointer Lock">§ 2.4 Exit Pointer Lock</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pointerlockchange-3" title="§ 3. Extensions to the Element Interface">§ 3.
                    Extensions to the Element Interface</a> <a href="#ref-for-dfn-pointerlockchange-4"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pointerlockchange-5" title="§ 4. Extensions to the Document Interface">§ 4.
                    Extensions to the Document Interface</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-pointerlockerror"
        aria-label="Links in this document to definition: pointerlockerror">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-pointerlockerror"
                aria-label="Permalink for definition: pointerlockerror. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-pointerlockerror-1" title="§ 3. Extensions to the Element Interface">§ 3.
                    Extensions to the Element Interface</a> <a href="#ref-for-dfn-pointerlockerror-2"
                    title="Reference 2">(2)</a> <a href="#ref-for-dfn-pointerlockerror-3" title="Reference 3">(3)</a> <a
                    href="#ref-for-dfn-pointerlockerror-4" title="Reference 4">(4)</a> <a
                    href="#ref-for-dfn-pointerlockerror-5" title="Reference 5">(5)</a> <a
                    href="#ref-for-dfn-pointerlockerror-6" title="Reference 6">(6)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pointerlockerror-7" title="§ 4. Extensions to the Document Interface">§ 4.
                    Extensions to the Document Interface</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-exit-pointer-lock"
        aria-label="Links in this document to definition: Exit Pointer Lock">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-exit-pointer-lock"
                aria-label="Permalink for definition: Exit Pointer Lock. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-exit-pointer-lock-1" title="§ 4. Extensions to the Document Interface">§ 4.
                    Extensions to the Document Interface</a>
            </li>
            <li>
                <a href="#ref-for-dfn-exit-pointer-lock-2" title="§ 8. Requirements">§ 8. Requirements</a> <a
                    href="#ref-for-dfn-exit-pointer-lock-3" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-exit-pointer-lock-4" title="§ 10. Security">§ 10. Security</a> <a
                    href="#ref-for-dfn-exit-pointer-lock-5" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-exit-pointer-lock-6" title="Reference 3">(3)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-lock-requests-queue"
        aria-label="Links in this document to definition: lock requests queue">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-lock-requests-queue"
                aria-label="Permalink for definition: lock requests queue. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-lock-requests-queue-1" title="§ 3. Extensions to the Element Interface">§ 3.
                    Extensions to the Element Interface</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-element-requestpointerlock"
        aria-label="Links in this document to definition: requestPointerLock()">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-element-requestpointerlock"
                aria-label="Permalink for definition: requestPointerLock(). Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1328413902">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-element-requestpointerlock-1" title="§ 3. Extensions to the Element Interface">§
                    3. Extensions to the Element Interface</a> <a href="#ref-for-dom-element-requestpointerlock-2"
                    title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-document-onpointerlockchange"
        aria-label="Links in this document to definition: onpointerlockchange">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-document-onpointerlockchange"
                aria-label="Permalink for definition: onpointerlockchange. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-131603804">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-document-onpointerlockchange-1"
                    title="§ 4. Extensions to the Document Interface">§ 4. Extensions to the Document Interface</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-document-onpointerlockerror"
        aria-label="Links in this document to definition: onpointerlockerror">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-document-onpointerlockerror"
                aria-label="Permalink for definition: onpointerlockerror. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-131603804">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-document-onpointerlockerror-1" title="§ 4. Extensions to the Document Interface">§
                    4. Extensions to the Document Interface</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-document-exitpointerlock"
        aria-label="Links in this document to definition: exitPointerLock()">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-document-exitpointerlock"
                aria-label="Permalink for definition: exitPointerLock(). Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-131603804">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-document-exitpointerlock-1" title="§ 3. Extensions to the Element Interface">§ 3.
                    Extensions to the Element Interface</a>
            </li>
            <li>
                <a href="#ref-for-dom-document-exitpointerlock-2" title="§ 4. Extensions to the Document Interface">§ 4.
                    Extensions to the Document Interface</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dom-documentorshadowroot-pointerlockelement"
        aria-label="Links in this document to definition: pointerLockElement">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-documentorshadowroot-pointerlockelement"
                aria-label="Permalink for definition: pointerLockElement. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-748339506">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-documentorshadowroot-pointerlockelement-1"
                    title="§ 5. Extensions to the DocumentOrShadowRoot Mixin">§ 5. Extensions to the
                    DocumentOrShadowRoot Mixin</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mouseevent-movementx"
        aria-label="Links in this document to definition: movementX">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-mouseevent-movementx"
                aria-label="Permalink for definition: movementX. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1698756137">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-mouseevent-movementx-1" title="§ 6. Extensions to the MouseEvent Interface">§ 6.
                    Extensions to the MouseEvent Interface</a> <a href="#ref-for-dom-mouseevent-movementx-2"
                    title="Reference 2">(2)</a> <a href="#ref-for-dom-mouseevent-movementx-3"
                    title="Reference 3">(3)</a> <a href="#ref-for-dom-mouseevent-movementx-4"
                    title="Reference 4">(4)</a> <a href="#ref-for-dom-mouseevent-movementx-5"
                    title="Reference 5">(5)</a> <a href="#ref-for-dom-mouseevent-movementx-6"
                    title="Reference 6">(6)</a> <a href="#ref-for-dom-mouseevent-movementx-7"
                    title="Reference 7">(7)</a> <a href="#ref-for-dom-mouseevent-movementx-8"
                    title="Reference 8">(8)</a> <a href="#ref-for-dom-mouseevent-movementx-9"
                    title="Reference 9">(9)</a> <a href="#ref-for-dom-mouseevent-movementx-10"
                    title="Reference 10">(10)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mouseevent-movementy"
        aria-label="Links in this document to definition: movementY">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-mouseevent-movementy"
                aria-label="Permalink for definition: movementY. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-1698756137">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-mouseevent-movementy-1" title="§ 6. Extensions to the MouseEvent Interface">§ 6.
                    Extensions to the MouseEvent Interface</a> <a href="#ref-for-dom-mouseevent-movementy-2"
                    title="Reference 2">(2)</a> <a href="#ref-for-dom-mouseevent-movementy-3"
                    title="Reference 3">(3)</a> <a href="#ref-for-dom-mouseevent-movementy-4"
                    title="Reference 4">(4)</a> <a href="#ref-for-dom-mouseevent-movementy-5"
                    title="Reference 5">(5)</a> <a href="#ref-for-dom-mouseevent-movementy-6"
                    title="Reference 6">(6)</a> <a href="#ref-for-dom-mouseevent-movementy-7"
                    title="Reference 7">(7)</a> <a href="#ref-for-dom-mouseevent-movementy-8"
                    title="Reference 8">(8)</a> <a href="#ref-for-dom-mouseevent-movementy-9"
                    title="Reference 9">(9)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mouseeventinit-movementx"
        aria-label="Links in this document to definition: movementX">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-mouseeventinit-movementx"
                aria-label="Permalink for definition: movementX. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-788447252">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-mouseeventinit-movementx-1"
                    title="§ 7. Extensions to the MouseEventInit Dictionary">§ 7. Extensions to the MouseEventInit
                    Dictionary</a> <a href="#ref-for-dom-mouseeventinit-movementx-2" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mouseeventinit-movementy"
        aria-label="Links in this document to definition: movementY">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-mouseeventinit-movementy"
                aria-label="Permalink for definition: movementY. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-788447252">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-mouseeventinit-movementy-1"
                    title="§ 7. Extensions to the MouseEventInit Dictionary">§ 7. Extensions to the MouseEventInit
                    Dictionary</a> <a href="#ref-for-dom-mouseeventinit-movementy-2" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-default-unlock-gesture"
        aria-label="Links in this document to definition: default unlock gesture">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-default-unlock-gesture"
                aria-label="Permalink for definition: default unlock gesture. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-default-unlock-gesture-1" title="§ 1. Introduction">§ 1. Introduction</a>
            </li>
            <li>
                <a href="#ref-for-dfn-default-unlock-gesture-2" title="§ 8. Requirements">§ 8. Requirements</a> <a
                    href="#ref-for-dfn-default-unlock-gesture-3" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-default-unlock-gesture-4" title="§ 10. Security">§ 10. Security</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-user-agent"
        aria-label="Links in this document to definition: user agent">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-user-agent"
                aria-label="Permalink for definition: user agent. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-user-agent-1" title="§ 2.1 The pointer lock state definition">§ 2.1 The pointer
                    lock state definition</a>
            </li>
            <li>
                <a href="#ref-for-dfn-user-agent-2" title="§ 6. Extensions to the MouseEvent Interface">§ 6. Extensions
                    to the MouseEvent Interface</a> <a href="#ref-for-dfn-user-agent-3" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-user-agent-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-user-agent-5"
                    title="Reference 4">(4)</a> <a href="#ref-for-dfn-user-agent-6" title="Reference 5">(5)</a> <a
                    href="#ref-for-dfn-user-agent-7" title="Reference 6">(6)</a> <a href="#ref-for-dfn-user-agent-8"
                    title="Reference 7">(7)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-user-agent-9" title="§ 8. Requirements">§ 8. Requirements</a> <a
                    href="#ref-for-dfn-user-agent-10" title="Reference 2">(2)</a> <a href="#ref-for-dfn-user-agent-11"
                    title="Reference 3">(3)</a> <a href="#ref-for-dfn-user-agent-12" title="Reference 4">(4)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-user-agent-13" title="§ 9.5 Synthetic cursor interaction with HTML DOM UI">§ 9.5
                    Synthetic cursor interaction with HTML DOM UI</a>
            </li>
            <li>
                <a href="#ref-for-dfn-user-agent-14" title="§ 10. Security">§ 10. Security</a> <a
                    href="#ref-for-dfn-user-agent-15" title="Reference 2">(2)</a> <a href="#ref-for-dfn-user-agent-16"
                    title="Reference 3">(3)</a> <a href="#ref-for-dfn-user-agent-17" title="Reference 4">(4)</a> <a
                    href="#ref-for-dfn-user-agent-18" title="Reference 5">(5)</a> <a href="#ref-for-dfn-user-agent-19"
                    title="Reference 6">(6)</a> <a href="#ref-for-dfn-user-agent-20" title="Reference 7">(7)</a> <a
                    href="#ref-for-dfn-user-agent-21" title="Reference 8">(8)</a> <a href="#ref-for-dfn-user-agent-22"
                    title="Reference 9">(9)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-user-agent-23"
                    title="§ 11.4 Why bundle all functionality (hiding cursor, providing mouse deltas) instead of using CSS to hide the cursor, always providing delta values, and offering an API to restrict the cursor movement to a portion of the web page?">§
                    11.4 Why bundle all functionality (hiding cursor, providing mouse deltas) instead of using CSS to
                    hide the cursor, always providing delta values, and offering an API to restrict the cursor movement
                    to a portion of the web page?</a>
            </li>
        </ul>
    </div>
    <script id="respec-dfn-panel">(() => {
            // @ts-check
            if (document.respec) {
                document.respec.ready.then(setupPanel);
            } else {
                setupPanel();
            }

            function setupPanel() {
                const listener = panelListener();
                document.body.addEventListener("keydown", listener);
                document.body.addEventListener("click", listener);
            }

            function panelListener() {
                /** @type {HTMLElement} */
                let panel = null;
                return event => {
                    const { target, type } = event;

                    if (!(target instanceof HTMLElement)) return;

                    // For keys, we only care about Enter key to activate the panel
                    // otherwise it's activated via a click.
                    if (type === "keydown" && event.key !== "Enter") return;

                    const action = deriveAction(event);

                    switch (action) {
                        case "show": {
                            hidePanel(panel);
                            /** @type {HTMLElement} */
                            const dfn = target.closest("dfn, .index-term");
                            panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
                            const coords = deriveCoordinates(event);
                            displayPanel(dfn, panel, coords);
                            break;
                        }
                        case "dock": {
                            panel.style.left = null;
                            panel.style.top = null;
                            panel.classList.add("docked");
                            break;
                        }
                        case "hide": {
                            hidePanel(panel);
                            panel = null;
                            break;
                        }
                    }
                };
            }

            /**
             * @param {MouseEvent|KeyboardEvent} event
             */
            function deriveCoordinates(event) {
                const target = /** @type HTMLElement */ (event.target);

                // We prevent synthetic AT clicks from putting
                // the dialog in a weird place. The AT events sometimes
                // lack coordinates, so they have clientX/Y = 0
                const rect = target.getBoundingClientRect();
                if (
                    event instanceof MouseEvent &&
                    event.clientX >= rect.left &&
                    event.clientY >= rect.top
                ) {
                    // The event probably happened inside the bounding rect...
                    return { x: event.clientX, y: event.clientY };
                }

                // Offset to the middle of the element
                const x = rect.x + rect.width / 2;
                // Placed at the bottom of the element
                const y = rect.y + rect.height;
                return { x, y };
            }

            /**
             * @param {Event} event
             */
            function deriveAction(event) {
                const target = /** @type {HTMLElement} */ (event.target);
                const hitALink = !!target.closest("a");
                if (target.closest("dfn:not([data-cite]), .index-term")) {
                    return hitALink ? "none" : "show";
                }
                if (target.closest(".dfn-panel")) {
                    if (hitALink) {
                        return target.classList.contains("self-link") ? "hide" : "dock";
                    }
                    const panel = target.closest(".dfn-panel");
                    return panel.classList.contains("docked") ? "hide" : "none";
                }
                if (document.querySelector(".dfn-panel:not([hidden])")) {
                    return "hide";
                }
                return "none";
            }

            /**
             * @param {HTMLElement} dfn
             * @param {HTMLElement} panel
             * @param {{ x: number, y: number }} clickPosition
             */
            function displayPanel(dfn, panel, { x, y }) {
                panel.hidden = false;
                // distance (px) between edge of panel and the pointing triangle (caret)
                const MARGIN = 20;

                const dfnRects = dfn.getClientRects();
                // Find the `top` offset when the `dfn` can be spread across multiple lines
                let closestTop = 0;
                let minDiff = Infinity;
                for (const rect of dfnRects) {
                    const { top, bottom } = rect;
                    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
                    if (diffFromClickY < minDiff) {
                        minDiff = diffFromClickY;
                        closestTop = top;
                    }
                }

                const top = window.scrollY + closestTop + dfnRects[0].height;
                const left = x - MARGIN;
                panel.style.left = `${left}px`;
                panel.style.top = `${top}px`;

                // Find if the panel is flowing out of the window
                const panelRect = panel.getBoundingClientRect();
                const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
                if (panelRect.right > SCREEN_WIDTH) {
                    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
                    const newCaretOffset = left - newLeft;
                    panel.style.left = `${newLeft}px`;
                    /** @type {HTMLElement} */
                    const caret = panel.querySelector(".caret");
                    caret.style.left = `${newCaretOffset}px`;
                }

                // As it's a dialog, we trap focus.
                // TODO: when <dialog> becomes a implemented, we should really
                // use that.
                trapFocus(panel, dfn);
            }

            /**
             * @param {HTMLElement} panel
             * @param {HTMLElement} dfn
             * @returns
             */
            function trapFocus(panel, dfn) {
                /** @type NodeListOf<HTMLAnchorElement> elements */
                const anchors = panel.querySelectorAll("a[href]");
                // No need to trap focus
                if (!anchors.length) return;

                // Move focus to first anchor element
                const first = anchors.item(0);
                first.focus();

                const trapListener = createTrapListener(anchors, panel, dfn);
                panel.addEventListener("keydown", trapListener);

                // Hiding the panel releases the trap
                const mo = new MutationObserver(records => {
                    const [record] = records;
                    const target = /** @type HTMLElement */ (record.target);
                    if (target.hidden) {
                        panel.removeEventListener("keydown", trapListener);
                        mo.disconnect();
                    }
                });
                mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
            }

            /**
             *
             * @param {NodeListOf<HTMLAnchorElement>} anchors
             * @param {HTMLElement} panel
             * @param {HTMLElement} dfn
             * @returns
             */
            function createTrapListener(anchors, panel, dfn) {
                const lastIndex = anchors.length - 1;
                let currentIndex = 0;
                return event => {
                    switch (event.key) {
                        // Hitting "Tab" traps us in a nice loop around elements.
                        case "Tab": {
                            event.preventDefault();
                            currentIndex += event.shiftKey ? -1 : +1;
                            if (currentIndex < 0) {
                                currentIndex = lastIndex;
                            } else if (currentIndex > lastIndex) {
                                currentIndex = 0;
                            }
                            anchors.item(currentIndex).focus();
                            break;
                        }

                        // Hitting "Enter" on an anchor releases the trap.
                        case "Enter":
                            hidePanel(panel);
                            break;

                        // Hitting "Escape" returns focus to dfn.
                        case "Escape":
                            hidePanel(panel);
                            dfn.focus();
                            return;
                    }
                };
            }

            /** @param {HTMLElement} panel */
            function hidePanel(panel) {
                if (!panel) return;
                panel.hidden = true;
                panel.classList.remove("docked");
            }
        })()</script>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <script src="/dropdown.js"></script>
</body>

