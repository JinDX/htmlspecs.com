<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="zh-hans">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>RFC 7639 - ALPN HTTP 头部字段</title>
    <script>
        function getMeta(rfcno, container) {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "https://www.rfc-editor.org/rfc/rfc" + rfcno + ".json", true);
            xhr.onload = function (e) {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        var data = JSON.parse(xhr.response);

                        var cont = document.getElementById(container);
                        // empty the container
                        while (cont.firstChild) {
                            cont.removeChild(myNode.firstChild);
                        }

                        var c = data.status;
                        if (c) {
                            var bld = newElementWithText("b", c);
                            cont.appendChild(bld);
                        } else {
                            cont.appendChild(newElementWithText("i", "(document status unknown)"));
                        }

                        c = data.updated_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Updated by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.obsoleted_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Obsoleted by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.errata_url;
                        if (c) {
                            cont.appendChild(newElement("br"));
                            var link = newElementWithText("a", "errata");
                            link.setAttribute("href", c);
                            var errata = newElementWithText("i", "This document has ");
                            errata.appendChild(link);
                            errata.appendChild(newText("."));
                            cont.appendChild(errata);
                        }

                        cont.style.display = "block";
                    } else {
                        console.error(xhr.statusText);
                    }
                }
            };
            xhr.onerror = function (e) {
                console.error(xhr.status + " " + xhr.statusText);
            };
            xhr.send(null);
        }
        function appendRfcLinks(parent, updates) {
            var template = "https://www.rfc-editor.org/rfc/rfc{rfc}.html";
            for (var i = 0; i < updates.length; i++) {
                var rfc = updates[i].trim().toLowerCase();
                if (rfc.substring(0, 3) == "rfc") {
                    var no = parseInt(rfc.substring(3), 10);

                    var link = newElement("a");
                    link.setAttribute("href", template.replace("{rfc}", no));
                    link.appendChild(newText(no));
                    parent.appendChild(link);
                } else {
                    parent.appendChild(newText(rfc));
                }
                if (i != updates.length - 1) {
                    parent.appendChild(newText(", "));
                }
            }
        }

        // DOM helpers
        function newElement(name) {
            return document.createElement(name);
        }
        function newElementWithText(name, txt) {
            var e = document.createElement(name);
            e.appendChild(newText(txt));
            return e;
        }
        function newText(text) {
            return document.createTextNode(text);
        }
    </script>
    <script>
        function anchorRewrite() {
            map = {};
            if (window.location.hash.length >= 1) {
                var fragid = window.location.hash.substr(1);
                if (fragid) {
                    if (!document.getElementById(fragid)) {
                        var prefix = "rfc.";
                        var mapped = map[fragid];
                        if (mapped) {
                            window.location.hash = mapped;
                        } else if (fragid.indexOf("section-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(8).replace("-", ".p.");
                        } else if (fragid.indexOf("appendix-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(9).replace("-", ".p.");
                        } else if (fragid.indexOf("s-") == 0) {
                            var postfix = fragid.substring(2);
                            if (postfix.startsWith("abstract")) {
                                window.location.hash = prefix + postfix;
                            } else if (postfix.startsWith("note-")) {
                                window.location.hash = prefix + "note." + postfix.substring(5).replace("-", ".p.");
                            } else {
                                window.location.hash = prefix + "section." + postfix.replace("-", ".p.");
                            }
                        } else if (fragid.indexOf("p-") == 0) {
                            var r = fragid.substring(2);
                            var p = r.indexOf("-");
                            if (p >= 0) {
                                window.location.hash = prefix + "section." + r.substring(0, p) + ".p." + r.substring(p + 1);
                            }
                        }
                    }
                }
            }
        }
        window.addEventListener('hashchange', anchorRewrite);
        window.addEventListener('DOMContentLoaded', anchorRewrite);
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:type" content="article">
    <meta property="og:title" content="RFC7639">
    <meta property="og:description" content="The ALPN HTTP Header Field">
    <meta property="og:url" content="https://httpwg.org/specs/rfc7639.html">
    <meta property="og:site_name" content="IETF HTTP Working Group Specifications">
    <meta property="og:image" content="https://httpwg.org/assets/favicon/apple-icon-180x180.png">
    <link rel="stylesheet" type="text/css"
        href="https://httpwg.org/assets/node_modules/bootstrap/dist/css/bootstrap.min.css">
    <style type="text/css">
        body {
            padding-top: 80px;
            padding-bottom: 80px;
            position: relative;
        }

        .table.header th,
        .table.header td {
            border-top: none;
            padding: 0;
        }

        #sidebar {
            margin-top: -10px;
            height: 90%;
            overflow-y: auto;
            font-size: 90%;
        }

        #rfc\.meta {
            width: 40%;
            float: right
        }

        .toc ul {
            list-style: none;
        }

        .filename {
            color: rgb(119, 119, 119);
            font-size: 23px;
            font-weight: normal;
            height: auto;
            line-height: 23px;
        }

        dl {
            margin-left: 1em;
        }

        dl.dl-horizontal {
            margin-left: 0;
        }

        dl>dt {
            float: left;
            margin-right: 1em;
        }

        dl.nohang>dt {
            float: none;
        }

        dl>dd {
            margin-bottom: .5em;
        }

        dl.compact>dd {
            margin-bottom: 0em;
        }

        dl>dd>dl {
            margin-top: 0.5em;
            margin-bottom: 0em;
        }

        ul.empty {
            list-style-type: none;
        }

        ul.empty li {
            margin-top: .5em;
        }

        td.reference {
            padding-right: 1em;
            vertical-align: top;
        }

        .feedback {
            position: fixed;
            bottom: 5px;
            right: 5px;
        }

        .fbbutton {
            margin-left: 5px;
        }

        h1 a,
        h2 a,
        h3 a,
        h4 a,
        h5 a,
        h6 a {
            color: rgb(51, 51, 51);
        }

        span.tt {
            font: 11pt consolas, monospace;
            font-size-adjust: none;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="https://httpwg.org/assets/site.css">
    <link rel="Contents" href="#rfc.toc">
    <link rel="Author" href="#rfc.authors">
    <link rel="License" href="#rfc.copyrightnotice">
    <link rel="Chapter" title="1 Introduction" href="#rfc.section.1">
    <link rel="Chapter" title="2 The ALPN HTTP Header Field" href="#rfc.section.2">
    <link rel="Chapter" title="3 IANA Considerations" href="#rfc.section.3">
    <link rel="Chapter" title="4 Security Considerations" href="#rfc.section.4">
    <link rel="Chapter" title="5 References" href="#rfc.section.5">
    <link rel="Alternate" title="Plain Text Version" href="http://www.ietf.org/rfc/rfc7639.txt">
    <link rel="Help" title="RFC-Editor's Status Page" href="http://www.rfc-editor.org/info/rfc7639">
    <meta name="viewport" content="initial-scale=1">
    <meta name="generator"
        content="https://github.com/mnot/RFCBootstrap XSLT vendor: Saxonica http://www.saxonica.com/">
    <meta name="keywords" content="HTTP CONNECT, Firewall, HTTP proxy">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <meta name="dcterms.creator" content="Hutton, A.">
    <meta name="dcterms.creator" content="Uberti, J.">
    <meta name="dcterms.creator" content="Thomson, M.">
    <meta name="dcterms.identifier" content="urn:ietf:rfc:7639">
    <meta name="dcterms.issued" content="2015-08">
    <meta name="dcterms.abstract"
        content="This specification allows HTTP CONNECT requests to indicate what protocol is intended to be used within the tunnel once established, using the ALPN header field.">
    <meta name="dcterms.isPartOf" content="urn:issn:2070-1721">
    <meta name="description"
        content="This specification allows HTTP CONNECT requests to indicate what protocol is intended to be used within the tunnel once established, using the ALPN header field.">
</head>

<body onload="getMeta(7639,'rfc.meta');">
    <nav class="navbar navbar-dark bg-dark d-print-none navbar-expand-lg fixed-top ps-3 pe-3" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse"
                aria-controls="navbarToggler" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <a class="navbar-brand" href="https://httpwg.org/"><img src="https://httpwg.org/assets/http.svg"
                    height="23"></a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse">

            <div class="navbar-nav me-auto">

                <a class="nav-item ms-1 text-white" href="https://httpwg.org/specs/">📄 Documentation</a>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Work in
                        Progress</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/http-extensions/">HTTP Extensions</a></li>
                        <li class="dropdown-item"><a
                                href="https://github.com/httpwg/admin/issues?q=is%3Aissue+is%3Aopen+label%3Aadoption">Future
                                Work</a></li>
                    </ul>
                </div>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Participate</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/about/">About the HTTP Working Group</a>
                        </li>
                        <li class="divider"></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/CONTRIBUTING.html">Contribution Policy</a>
                        </li>
                        <li class="dropdown-item"><a href="http://datatracker.ietf.org/wg/httpbis/charter/">WG
                                Charter</a></li>
                        <li class="dropdown-item"><a href="http://lists.w3.org/Archives/Public/ietf-http-wg/">Group
                                Mailing List 📨</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/wg-materials/">Meeting Materials</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/admin/editors/">Document Editor
                                Resources</a></li>
                    </ul>
                </div>
            </div>

        </div>
    </nav>
    <div class="container" id="top">
        <div class="row">
            <div class="col-lg-4 order-last d-none d-lg-block" id="sidebar" role="navigation">
                <div class="navbar">
                    <div class="navbar-brand"><a href="#top"><strong>RFC </strong>7639</a></div><br clear="all">
                    <div class="">
                        <div class="toc ">
                            <ul>
                                <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.1">介绍</a>
                                    <ul>
                                        <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.section.1.1">需求语言</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#tp">ALPN HTTP 头部字段</a>
                                    <ul>
                                        <li><a href="#rfc.section.2.1">2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.section.2.1">头部字段值</a></li>
                                        <li><a href="#rfc.section.2.2">2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.section.2.2">语法</a></li>
                                        <li><a href="#rfc.section.2.3">2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.section.2.3">使用</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#IANA">IANA 注意事项</a></li>
                                <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#Security">安全注意事项</a></li>
                                <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">参考文献</a>
                                    <ul>
                                        <li><a href="#rfc.section.5.1">5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.1">规范性参考文献</a></li>
                                        <li><a href="#rfc.section.5.2">5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.2">信息性参考文献</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.authors">作者地址</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-8 order-first main" role="main">
                <header>
                    <table class="table table-condensed header" id="rfc.headerblock">
                        <tbody>
                            <tr>
                                <td class="text-left">互联网工程任务组 (IETF)</td>
                                <td class="text-right">A. Hutton</td>
                            </tr>
                            <tr>
                                <td class="text-left">请求评注: 7639</td>
                                <td class="text-right">Unify</td>
                            </tr>
                            <tr>
                                <td class="text-left">类别: Standards Track</td>
                                <td class="text-right">J. Uberti</td>
                            </tr>
                            <tr>
                                <td class="text-left">ISSN: 2070-1721</td>
                                <td class="text-right">Google</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">M. Thomson</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">Mozilla</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">2015年8月</td>
                            </tr>
                        </tbody>
                    </table>
                    <div id="rfc.title">
                        <h1>ALPN HTTP 头部字段</h1>
                    </div>
                </header>
                <hr>
                <h2 id="rfc.abstract"><a href="#rfc.abstract">摘要</a></h2>
                <div class="lead">
                    <div id="rfc.abstract.p.1">
                        <p>本规范允许 HTTP CONNECT 请求使用 ALPN 头部字段来指示在隧道建立后打算在隧道内使用的协议。</p>
                    </div>
                </div>
                <aside id="rfc.meta" class="alert alert-info"></aside>
                <section id="rfc.status">
                    <h2><a href="#rfc.status">本备忘录的状态</a></h2>
                    <div id="rfc.boilerplate.1.p.1">
                        <p>这是一个互联网标准轨道文档。</p>
                    </div>
                    <div id="rfc.boilerplate.1.p.2">
                        <p>本文档是互联网工程任务组 (IETF) 的产物，代表了 IETF 社区的共识。它已接受公开审查并已获得互联网工程指导组 (IESG) 批准发布。关于互联网标准的更多信息，请参阅 <a
                                href="https://www.rfc-editor.org/rfc/rfc5741.html#section-2">RFC 5741 的第2节</a>。</p>
                    </div>
                    <div id="rfc.boilerplate.1.p.3">
                        <p>有关本文档当前状态、任何勘误以及如何提供反馈的信息，可在 <a
                                href="http://www.rfc-editor.org/info/rfc7639">http://www.rfc-editor.org/info/rfc7639</a>
                            获取。</p>
                    </div>
                </section>
                <section id="rfc.copyrightnotice">
                    <h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2>
                    <div id="rfc.boilerplate.2.p.1">
                        <p>Copyright (c) 2015 IETF Trust and the persons identified as the document authors. All rights
                            reserved.</p>
                    </div>
                    <div id="rfc.boilerplate.2.p.2">
                        <p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF
                            Documents (<a
                                href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in
                            effect on the date of publication of this document. Please review these documents carefully,
                            as they describe your rights and restrictions with respect to this document. Code Components
                            extracted from this document must include Simplified BSD License text as described in
                            Section 4.e of the Trust Legal Provisions and are provided without warranty as described in
                            the Simplified BSD License.</p>
                    </div>
                </section>
                <div class="toc d-lg-none">
                    <ul>
                        <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.1">介绍</a>
                            <ul>
                                <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.section.1.1">需求语言</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#tp">ALPN HTTP 头部字段</a>
                            <ul>
                                <li><a href="#rfc.section.2.1">2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.section.2.1">头部字段值</a></li>
                                <li><a href="#rfc.section.2.2">2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.section.2.2">语法</a></li>
                                <li><a href="#rfc.section.2.3">2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.section.2.3">使用</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#IANA">IANA 注意事项</a>
                        </li>
                        <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#Security">安全注意事项</a></li>
                        <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">参考文献</a>
                            <ul>
                                <li><a href="#rfc.section.5.1">5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.1">规范性参考文献</a></li>
                                <li><a href="#rfc.section.5.2">5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.2">信息性参考文献</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.authors">作者地址</a></li>
                    </ul>
                </div>
                <section id="n-introduction">
                    <h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a
                            href="#n-introduction">介绍</a></h2>
                    <div id="rfc.section.1.p.1">
                        <p>HTTP CONNECT 方法（<a href="https://www.rfc-editor.org/rfc/rfc7231.html#section-4.3.6">RFC7231 第
                                4.3.6 节</a>）
                            请求接收者建立到所标识源服务器的隧道，并在隧道关闭之前双向转发数据包。此类隧道通常用于通过一个或多个代理创建端到端的虚拟连接。</p>
                    </div>
                    <div id="rfc.section.1.p.2">
                        <p>ALPN HTTP 头部字段用于标识客户端打算在使用 CONNECT 建立的隧道内使用的协议或协议集合。该字段使用应用层协议协商（ALPN）标识符 <a
                                href="#RFC7301"><cite
                                    title="Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension">[RFC7301]</cite></a>。
                        </p>
                    </div>
                    <div id="rfc.section.1.p.3">
                        <p>对于随后使用 <a href="#RFC5246"><cite
                                    title="The Transport Layer Security (TLS) Protocol Version 1.2">传输层安全（TLS）</cite></a>
                            保护的隧道，头部字段携带与 TLS 握手中所携带的应用协议标签相同的值 <a href="#RFC7301"><cite
                                    title="Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension">[RFC7301]</cite></a>。如果存在多个可能的应用协议，则应指示所有这些应用协议。
                        </p>
                    </div>
                    <div id="rfc.section.1.p.4">
                        <p>ALPN 头部字段仅表示客户端意图。此处使用 ALPN 标识符仅用于识别客户端打算在隧道中使用的应用协议或协议套件。该头字段不会进行协商。在 TLS
                            中，最终的应用协议由服务器从客户端提供的选项集中选择。其他传输层可能以不同方式协商应用协议。</p>
                    </div>
                    <div id="rfc.section.1.p.5">
                        <p>代理不会实现隧道内的协议，但它们可能基于该头部字段的值做出策略决定。例如，代理可以使用应用协议来选择适当的流量优先级策略。</p>
                    </div>
                    <section id="n-requirements-language">
                        <h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a>&nbsp;<a
                                href="#n-requirements-language">需求语言</a></h3>
                        <div id="rfc.section.1.1.p.1">
                            <p>本文件中的关键字 "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
                                "RECOMMENDED", "MAY", 和 "OPTIONAL" 应按 <a href="#RFC2119"><cite
                                        title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</cite></a>
                                中的描述来解释。</p>
                        </div>
                    </section>
                </section>
                <section id="tp">
                    <h2 id="rfc.section.2"><a href="#rfc.section.2">2.</a>&nbsp;<a href="#tp">ALPN HTTP 头部字段</a></h2>
                    <div id="rfc.section.2.p.1">
                        <p>客户端在 HTTP CONNECT 请求中包含 ALPN 头部字段，以指示客户端打算在隧道内使用的应用层协议，或可能在隧道内使用的一组协议。</p>
                    </div>
                    <section id="n-header-field-values">
                        <h3 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a>&nbsp;<a
                                href="#n-header-field-values">头部字段值</a></h3>
                        <div id="rfc.section.2.1.p.1">
                            <p>协议字段的有效值取自由 <a href="#RFC7301"><cite
                                        title="Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension">[RFC7301]</cite></a>
                                建立的“应用层协议协商（ALPN）协议 ID”注册表 <a href="#ALPN-IDS"><cite
                                        title="Application-Layer Protocol Negotiation (ALPN) Protocol ID">[ALPN-IDS]</cite></a>。
                            </p>
                        </div>
                    </section>
                    <section id="n-syntax">
                        <h3 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2.</a>&nbsp;<a href="#n-syntax">语法</a>
                        </h3>
                        <div id="rfc.section.2.2.p.1">
                            <p>下面给出 ALPN 头部字段值的 ABNF（扩充巴科斯-诺尔范式）语法。它使用 <a
                                    href="https://www.rfc-editor.org/rfc/rfc7230.html#section-1.2">RFC7230 第 1.2 节</a>
                                中定义的语法。</p>
                        </div>
                        <div id="rfc.figure.u.1">
                            <div>
                                <pre class="inline">
ALPN            = 1#protocol-id
protocol-id     = token ; percent-encoded ALPN protocol identifier
</pre>
                            </div>
                        </div>
                        <div id="rfc.section.2.2.p.2">
                            <p>ALPN 协议名是八位字节序列，对格式没有额外约束。对于 tokens 中不允许的八位字节（参见 <a href="#RFC7230"><cite
                                        title="Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing">RFC7230</cite></a>
                                第 3.2.6 节），必须按照 <a href="#RFC3986"><cite
                                        title="Uniform Resource Identifier (URI): Generic Syntax">RFC3986 第 2.1
                                        节</cite></a> 的规定进行百分号编码。因此，表示百分号字符 "%"（十六进制 25）的八位字节也必须进行百分号编码。</p>
                        </div>
                        <div id="rfc.section.2.2.p.3">
                            <p>为确保每个 ALPN 协议名有且只有一种表示方式，还适用以下附加约束：</p>
                            <ul>
                                <li>如果某个八位字节是有效的 token 字符（除了 "%" 之外），则不得对其进行百分号编码。</li>
                                <li>在使用百分号编码时，必须使用大写十六进制数字。</li>
                            </ul>
                        </div>
                        <div id="rfc.section.2.2.p.4">
                            <p>在这些约束下，接收方可以使用简单的字符串比较来匹配协议标识符。</p>
                        </div>
                        <div id="rfc.figure.u.2">
                            <p>例如：</p>
                            <div>
                                <pre class="text2">

  CONNECT www.example.com HTTP/1.1
  Host: www.example.com
  ALPN: h2, http%2F1.1
  </pre>
                            </div>
                        </div>
                    </section>
                    <section id="n-usage">
                        <h3 id="rfc.section.2.3"><a href="#rfc.section.2.3">2.3.</a>&nbsp;<a href="#n-usage">使用</a>
                        </h3>
                        <div id="rfc.section.2.3.p.1">
                            <p>在 ALPN 头部字段中使用时，ALPN 标识符用于标识整个应用协议栈，而不是单一的协议层或组件。</p>
                        </div>
                        <div id="rfc.section.2.3.p.2">
                            <p>对于承载使用 TLS 保护的协议的 CONNECT 隧道，ALPN 头部字段的值包含将在 TLS ClientHello 消息中发送的相同 ALPN 标识符列表 <a
                                    href="#RFC7301"><cite
                                        title="Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension">[RFC7301]</cite></a>。
                            </p>
                        </div>
                        <div id="rfc.section.2.3.p.3">
                            <p>在不预期发生协议协商的情况下（例如不使用 TLS 的协议），ALPN 头部字段只包含对应于拟使用的应用协议的单个 ALPN 协议标识符。如果存在另一种可能的协议协商形式，则
                                ALPN 头部字段应包含可能被协商的一组协议。</p>
                        </div>
                        <div id="rfc.section.2.3.p.4">
                            <p>代理可以使用 ALPN 头部字段的值更清晰、更高效地拒绝对 CONNECT 隧道的请求。在 HTTP 层公开协议信息允许代理更早地拒绝请求，并提供更好的错误报告（例如 403
                                状态码）。ALPN 头部字段可以被伪造，因此它不足以作为授权请求的充分依据。</p>
                        </div>
                        <div id="rfc.section.2.3.p.5">
                            <p>代理可以尝试检查数据包以确定所使用的协议。这要求代理理解每个 ALPN 标识符。像 TLS
                                这样的协议可能会隐藏协商的协议，或者协议协商细节可能会随时间变化。因此，代理不应仅因为无法识别协议而中断 CONNECT 隧道。</p>
                        </div>
                        <div id="rfc.section.2.3.p.6">
                            <p>代理可以使用 ALPN 头部字段值来改变其管理或优先处理连接的方式。</p>
                        </div>
                    </section>
                </section>
                <section id="IANA">
                    <h2 id="rfc.section.3"><a href="#rfc.section.3">3.</a>&nbsp;<a href="#IANA">IANA 注意事项</a>
                    </h2>
                    <div id="rfc.section.3.p.1">
                        <p>HTTP 头部字段在由 IANA 维护的“永久消息头字段名称”注册表中注册 <a href="#MSG-HDRS"><cite
                                    title="Permanent Message Header Field Names&gt;">[MSG-HDRS]</cite></a>。本文档根据 <a
                                href="#RFC3864"><cite
                                    title="Registration Procedures for Message Header Fields">RFC3864</cite></a> 定义并注册
                            ALPN 头部字段，具体如下：</p>
                        <dl>
                            <dt>Header Field Name:</dt>
                            <dd>ALPN</dd>
                            <dt>Protocol:</dt>
                            <dd>http</dd>
                            <dt>Status:</dt>
                            <dd>Standard</dd>
                            <dt>Reference:</dt>
                            <dd><a href="#tp" title="The ALPN HTTP Header Field">本文件第 2 节</a>（RFC 7639）</dd>
                            <dt>Change Controller:</dt>
                            <dd>IETF (iesg@ietf.org) - Internet Engineering Task Force</dd>
                        </dl>
                    </div>
                </section>
                <section id="Security">
                    <h2 id="rfc.section.4"><a href="#rfc.section.4">4.</a>&nbsp;<a href="#Security">安全注意事项</a></h2>
                    <div id="rfc.section.4.p.1">
                        <p>在使用 HTTP CONNECT 连接到 TURN（Traversal Using Relays around NAT，<a href="#RFC5766"><cite
                                    title="Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)">[RFC5766]</cite></a>）服务器的情况下，适用
                            <a href="https://www.rfc-editor.org/rfc/rfc7231.html#section-4.3.6">RFC7231 第 4.3.6 节</a>
                            中的安全注意事项。该节指出“向任意服务器建立隧道存在重大风险，特别是当目标是一个并非用于 Web 流量的知名或保留 TCP 端口时。……支持 CONNECT
                            的代理应将其使用限制在一组已知端口或可配置的安全请求目标白名单内。”
                        </p>
                    </div>
                    <div id="rfc.section.4.p.2">
                        <p>本文档中描述的 ALPN 头部字段是可选的。客户端和 HTTP
                            代理可以选择不支持它，因此要么不发送该字段，要么在存在时忽略它。如果头字段不可用或被忽略，代理就无法识别隧道的用途，并将其作为关于隧道授权决策的输入。这与客户端或代理不支持 ALPN
                            头字段的情况无异。</p>
                    </div>
                    <div id="rfc.section.4.p.3">
                        <p>ALPN 头部字段不提供保密保护。可能暴露机密或敏感信息的 ALPN 标识符不应被发送，如 <a
                                href="https://www.rfc-editor.org/rfc/rfc7301.html#section-5">RFC7301 第 5 节</a> 所述。</p>
                    </div>
                    <div id="rfc.section.4.p.4">
                        <p>ALPN 头部字段的值可以被客户端伪造。如果通过隧道发送的数据是加密的（例如使用 <a href="#RFC5246"><cite
                                    title="The Transport Layer Security (TLS) Protocol Version 1.2">TLS</cite></a>），代理可能无法直接检查数据以验证所声明的协议是否为实际使用的协议，尽管代理可能能够执行流量分析
                            <a href="#TRAFFIC"><cite
                                    title="Identifying Website Users by TLS Traffic Analysis: New Attacks and Effective Countermeasures, Revision 1">[TRAFFIC]</cite></a>。因此，代理不能在所有情况下将
                            ALPN 头部字段的值作为策略输入的唯一依据。
                        </p>
                    </div>
                </section>
                <section id="rfc.references">
                    <h2 id="rfc.section.5"><a href="#rfc.section.5">5.</a> 参考文献</h2>
                    <section>
                        <div id="rfc.references.1">
                            <h3 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a> 规范性参考文献</h3>
                            <dl class="dl-horizontal">
                                <dt id="RFC2119">[<a href="#RFC2119" class="smpl">RFC2119</a>]</dt>
                                <dd><a href="mailto:sob@harvard.edu">Bradner, S.</a>, “<a
                                        href="https://www.rfc-editor.org/rfc/rfc2119.html">Key words for use in RFCs to
                                        Indicate Requirement Levels</a>”, <a
                                        href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 2119, <a
                                        href="https://dx.doi.org/10.17487/RFC2119">DOI 10.17487/RFC2119</a>, March 1997,
                                    &lt;<a
                                        href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.
                                </dd>
                                <dt id="RFC3864">[<a href="#RFC3864" class="smpl">RFC3864</a>]</dt>
                                <dd>Klyne, G., Nottingham, M., and J. Mogul, “<a
                                        href="https://www.rfc-editor.org/rfc/rfc3864.html">Registration Procedures for
                                        Message Header Fields</a>”, <a href="https://www.rfc-editor.org/info/bcp90">BCP
                                        90</a>, RFC 3864, <a href="https://dx.doi.org/10.17487/RFC3864">DOI
                                        10.17487/RFC3864</a>, September 2004, &lt;<a
                                        href="http://www.rfc-editor.org/info/rfc3864">http://www.rfc-editor.org/info/rfc3864</a>&gt;.
                                </dd>
                                <dt id="RFC3986">[<a href="#RFC3986" class="smpl">RFC3986</a>]</dt>
                                <dd><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a
                                        href="mailto:fielding@gbiv.com">Fielding, R.</a>, and <a
                                        href="mailto:LMM@acm.org">L. Masinter</a>, “<a
                                        href="https://www.rfc-editor.org/rfc/rfc3986.html">Uniform Resource Identifier
                                        (URI): Generic Syntax</a>”, <a href="https://www.rfc-editor.org/info/std66">STD
                                        66</a>, RFC 3986, <a href="https://dx.doi.org/10.17487/RFC3986">DOI
                                        10.17487/RFC3986</a>, January 2005, &lt;<a
                                        href="http://www.rfc-editor.org/info/rfc3986">http://www.rfc-editor.org/info/rfc3986</a>&gt;.
                                </dd>
                                <dt id="RFC7230">[<a href="#RFC7230" class="smpl">RFC7230</a>]</dt>
                                <dd>Fielding, R. and J. Reschke, “<a
                                        href="https://www.rfc-editor.org/rfc/rfc7230.html">Hypertext Transfer Protocol
                                        (HTTP/1.1): Message Syntax and Routing</a>”, RFC 7230, <a
                                        href="https://dx.doi.org/10.17487/RFC7230">DOI 10.17487/RFC7230</a>, June 2014,
                                    &lt;<a
                                        href="http://www.rfc-editor.org/info/rfc7230">http://www.rfc-editor.org/info/rfc7230</a>&gt;.
                                </dd>
                                <dt id="RFC7231">[<a href="#RFC7231" class="smpl">RFC7231</a>]</dt>
                                <dd>Fielding, R. and J. Reschke, “<a
                                        href="https://www.rfc-editor.org/rfc/rfc7231.html">Hypertext Transfer Protocol
                                        (HTTP/1.1): Semantics and Content</a>”, RFC 7231, <a
                                        href="https://dx.doi.org/10.17487/RFC7231">DOI 10.17487/RFC7231</a>, June 2014,
                                    &lt;<a
                                        href="http://www.rfc-editor.org/info/rfc7231">http://www.rfc-editor.org/info/rfc7231</a>&gt;.
                                </dd>
                                <dt id="RFC7301">[<a href="#RFC7301" class="smpl">RFC7301</a>]</dt>
                                <dd>Friedl, S., Popov, A., Langley, A., and E. Stephan, “<a
                                        href="https://www.rfc-editor.org/rfc/rfc7301.html">Transport Layer Security
                                        (TLS) Application-Layer Protocol Negotiation Extension</a>”, RFC 7301, <a
                                        href="https://dx.doi.org/10.17487/RFC7301">DOI 10.17487/RFC7301</a>, July 2014,
                                    &lt;<a
                                        href="http://www.rfc-editor.org/info/rfc7301">http://www.rfc-editor.org/info/rfc7301</a>&gt;.
                                </dd>
                            </dl>
                        </div>
                    </section>
                    <section>
                        <div id="rfc.references.2">
                            <h3 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2.</a> 信息性参考文献</h3>
                            <dl class="dl-horizontal">
                                <dt id="ALPN-IDS">[<a href="#ALPN-IDS" class="smpl">ALPN-IDS</a>]</dt>
                                <dd>IANA, “<a
                                        href="http://www.iana.org/assignments/tls-extensiontype-values">Application-Layer
                                        Protocol Negotiation (ALPN) Protocol ID</a>”, &lt;<a
                                        href="http://www.iana.org/assignments/tls-extensiontype-values">http://www.iana.org/assignments/tls-extensiontype-values</a>&gt;.
                                </dd>
                                <dt id="MSG-HDRS">[<a href="#MSG-HDRS" class="smpl">MSG-HDRS</a>]</dt>
                                <dd>IANA, “<a href="https://www.iana.org/assignments/message-headers">Permanent Message
                                        Header Field Names&gt;</a>”, &lt;<a
                                        href="https://www.iana.org/assignments/message-headers">https://www.iana.org/assignments/message-headers</a>&gt;.
                                </dd>
                                <dt id="RFC5246">[<a href="#RFC5246" class="smpl">RFC5246</a>]</dt>
                                <dd>Dierks, T. and E. Rescorla, “<a
                                        href="https://www.rfc-editor.org/rfc/rfc5246.html">The Transport Layer Security
                                        (TLS) Protocol Version 1.2</a>”, RFC 5246, <a
                                        href="https://dx.doi.org/10.17487/RFC5246">DOI 10.17487/RFC5246</a>, August
                                    2008, &lt;<a
                                        href="http://www.rfc-editor.org/info/rfc5246">http://www.rfc-editor.org/info/rfc5246</a>&gt;.
                                </dd>
                                <dt id="RFC5766">[<a href="#RFC5766" class="smpl">RFC5766</a>]</dt>
                                <dd>Mahy, R., Matthews, P., and J. Rosenberg, “<a
                                        href="https://www.rfc-editor.org/rfc/rfc5766.html">Traversal Using Relays around
                                        NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)</a>”,
                                    RFC 5766, <a href="https://dx.doi.org/10.17487/RFC5766">DOI 10.17487/RFC5766</a>,
                                    April 2010, &lt;<a
                                        href="http://www.rfc-editor.org/info/rfc5766">http://www.rfc-editor.org/info/rfc5766</a>&gt;.
                                </dd>
                                <dt id="TRAFFIC">[<a href="#TRAFFIC" class="smpl">TRAFFIC</a>]</dt>
                                <dd>Pironti, A., Strub, P-Y., and K. Bhargavan, “<a
                                        href="https://alfredo.pironti.eu/research/publications/full/identifying-website-users-tls-traffic-analysis-new-attacks-and-effective-counterme">Identifying
                                        Website Users by TLS Traffic Analysis: New Attacks and Effective
                                        Countermeasures, Revision 1</a>”, 2012, &lt;<a
                                        href="https://alfredo.pironti.eu/research/publications/full/identifying-website-users-tls-traffic-analysis-new-attacks-and-effective-counterme">https://alfredo.pironti.eu/research/publications/full/identifying-website-users-tls-traffic-analysis-new-attacks-and-effective-counterme</a>&gt;.
                                </dd>
                            </dl>
                        </div>
                    </section>
                </section>
                <section id="rfc.authors" class="avoidbreakinside">
                    <h2><a href="#rfc.authors">作者地址</a></h2>
                    <address><b>Andrew Hutton</b><br>Unify<br>Technology Drive<br>Nottingham, NG9 1LA<br>United
                        Kingdom<br>EMail: <a href="mailto:andrew.hutton@unify.com">andrew.hutton@unify.com</a></address>
                    <address><b>Justin Uberti</b><br>Google<br>747 6th Street South<br>Kirkland, WA 98033<br>United
                        States<br>EMail: <a href="mailto:justin@uberti.name">justin@uberti.name</a></address>
                    <address><b>Martin Thomson</b><br>Mozilla<br>331 East Evelyn Avenue<br>Mountain View, CA
                        94041<br>United States<br>EMail: <a
                            href="mailto:martin.thomson@gmail.com">martin.thomson@gmail.com</a></address>
                </section>
            </div>
        </div>
    </div>
    <script src="https://httpwg.org/assets/node_modules/jquery/dist/jquery.min.js"></script>
    <script src="https://httpwg.org/assets/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="https://htmlspecs.com/dropdown.js"></script>
</body>

</html>