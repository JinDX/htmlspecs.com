<!DOCTYPE html>
<html lang="zh-hans" class="RFC">

<head>
    <meta charset="utf-8">
    <meta content="Common,Latin" name="scripts">
    <meta content="initial-scale=1.0" name="viewport">
    <title>RFC 9298 - 在 HTTP 中代理 UDP</title>
    <meta content="David Schinazi" name="author">
    <meta content="
       本文档描述了如何在 HTTP 中代理 UDP，类似于 HTTP CONNECT 方法允许在 HTTP 中代理 TCP。更具体地说，本文档定义了一种协议，允许 HTTP 客户端通过充当代理的 HTTP 服务器为 UDP 通信创建隧道。 
    " name="description">
    <meta content="xml2rfc 3.14.1" name="generator">
    <meta content="quic" name="keyword">
    <meta content="http" name="keyword">
    <meta content="datagram" name="keyword">
    <meta content="udp" name="keyword">
    <meta content="proxy" name="keyword">
    <meta content="tunnels" name="keyword">
    <meta content="quic in quic" name="keyword">
    <meta content="turtles all the way down" name="keyword">
    <meta content="masque" name="keyword">
    <meta content="http-ng" name="keyword">
    <meta content="9298" name="rfc.number">
    <!-- Generator version information:
  xml2rfc 3.14.1
    Python 3.9.13
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.1
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    kitchen 1.2.6
    lxml 4.9.0
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    weasyprint 56.1
-->
    <link href="rfc9298.xml" rel="alternate" type="application/rfc+xml">
    <link href="#copyright" rel="license">
    <style type="text/css">
        /*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

        /* fonts */
        @import url('https://fonts.googleapis.com/css?family=Noto+Sans');
        /* Sans-serif */
        @import url('https://fonts.googleapis.com/css?family=Noto+Serif');
        /* Serif (print) */
        @import url('https://fonts.googleapis.com/css?family=Roboto+Mono');
        /* Monospace */

        @viewport {
            zoom: 1.0;
            width: extend-to-zoom;
        }

        @-ms-viewport {
            width: extend-to-zoom;
            zoom: 1.0;
        }

        /* general and mobile first */
        html {}

        body {
            max-width: 90%;
            margin: 1.5em auto;
            color: #222;
            background-color: #fff;
            font-size: 14px;
            font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
            line-height: 1.6;
            scroll-behavior: smooth;
        }

        .ears {
            display: none;
        }

        /* headings */
        #title,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            margin: 1em 0 0.5em;
            font-weight: bold;
            line-height: 1.3;
        }

        #title {
            clear: both;
            border-bottom: 1px solid #ddd;
            margin: 0 0 0.5em 0;
            padding: 1em 0 0.5em;
        }

        .author {
            padding-bottom: 4px;
        }

        h1 {
            font-size: 26px;
            margin: 1em 0;
        }

        h2 {
            font-size: 22px;
            margin-top: -20px;
            /* provide offset for in-page anchors */
            padding-top: 33px;
        }

        h3 {
            font-size: 18px;
            margin-top: -36px;
            /* provide offset for in-page anchors */
            padding-top: 42px;
        }

        h4 {
            font-size: 16px;
            margin-top: -36px;
            /* provide offset for in-page anchors */
            padding-top: 42px;
        }

        h5,
        h6 {
            font-size: 14px;
        }

        #n-copyright-notice {
            border-bottom: 1px solid #ddd;
            padding-bottom: 1em;
            margin-bottom: 1em;
        }

        /* general structure */
        p {
            padding: 0;
            margin: 0 0 1em 0;
            text-align: left;
        }

        div,
        span {
            position: relative;
        }

        div {
            margin: 0;
        }

        .alignRight.art-text {
            background-color: #f9f9f9;
            border: 1px solid #eee;
            border-radius: 3px;
            padding: 1em 1em 0;
            margin-bottom: 1.5em;
        }

        .alignRight.art-text pre {
            padding: 0;
        }

        .alignRight {
            margin: 1em 0;
        }

        .alignRight>*:first-child {
            border: none;
            margin: 0;
            float: right;
            clear: both;
        }

        .alignRight>*:nth-child(2) {
            clear: both;
            display: block;
            border: none;
        }

        svg {
            display: block;
        }

        .alignCenter.art-text {
            background-color: #f9f9f9;
            border: 1px solid #eee;
            border-radius: 3px;
            padding: 1em 1em 0;
            margin-bottom: 1.5em;
        }

        .alignCenter.art-text pre {
            padding: 0;
        }

        .alignCenter {
            margin: 1em 0;
        }

        .alignCenter>*:first-child {
            display: table;
            border: none;
            margin: 0 auto;
        }

        /* lists */
        ol,
        ul {
            padding: 0;
            margin: 0 0 1em 2em;
        }

        ol ol,
        ul ul,
        ol ul,
        ul ol {
            margin-left: 1em;
        }

        li {
            margin: 0 0 0.25em 0;
        }

        .ulCompact li {
            margin: 0;
        }

        ul.empty,
        .ulEmpty {
            list-style-type: none;
        }

        ul.empty li,
        .ulEmpty li {
            margin-top: 0.5em;
        }

        ul.ulBare,
        li.ulBare {
            margin-left: 0em !important;
        }

        ul.compact,
        .ulCompact,
        ol.compact,
        .olCompact {
            line-height: 100%;
            margin: 0 0 0 2em;
        }

        /* definition lists */
        dl {}

        dl>dt {
            float: left;
            margin-right: 1em;
        }

        /* 
dl.nohang > dt {
  float: none;
}
*/
        dl>dd {
            margin-bottom: .8em;
            min-height: 1.3em;
        }

        dl.compact>dd,
        .dlCompact>dd {
            margin-bottom: 0em;
        }

        dl>dd>dl {
            margin-top: 0.5em;
            margin-bottom: 0em;
        }

        /* links */
        a {
            text-decoration: none;
        }

        a[href] {
            color: #22e;
            /* Arlen: WCAG 2019 */
        }

        a[href]:hover {
            background-color: #f2f2f2;
        }

        figcaption a[href],
        a[href].selfRef {
            color: #222;
        }

        /* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

        /* Figures */
        tt,
        code,
        pre,
        code {
            background-color: #f9f9f9;
            font-family: 'Roboto Mono', monospace;
        }

        pre {
            border: 1px solid #eee;
            margin: 0;
            padding: 1em;
        }

        img {
            max-width: 100%;
        }

        figure {
            margin: 0;
        }

        figure blockquote {
            margin: 0.8em 0.4em 0.4em;
        }

        figcaption {
            font-style: italic;
            margin: 0 0 1em 0;
        }

        @media screen {
            pre {
                overflow-x: auto;
                max-width: 100%;
                max-width: calc(100% - 22px);
            }
        }

        /* aside, blockquote */
        aside,
        blockquote {
            margin-left: 0;
            padding: 1.2em 2em;
        }

        blockquote {
            background-color: #f9f9f9;
            color: #111;
            /* Arlen: WCAG 2019 */
            border: 1px solid #ddd;
            border-radius: 3px;
            margin: 1em 0;
        }

        cite {
            display: block;
            text-align: right;
            font-style: italic;
        }

        /* tables */
        table {
            width: 100%;
            margin: 0 0 1em;
            border-collapse: collapse;
            border: 1px solid #eee;
        }

        th,
        td {
            text-align: left;
            vertical-align: top;
            padding: 0.5em 0.75em;
        }

        th {
            text-align: left;
            background-color: #e9e9e9;
        }

        tr:nth-child(2n+1)>td {
            background-color: #f5f5f5;
        }

        table caption {
            font-style: italic;
            margin: 0;
            padding: 0;
            text-align: left;
        }

        table p {
            /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
            margin: 0;
        }

        /* pilcrow */
        a.pilcrow {
            color: #666;
            /* Arlen: AHDJ 2019 */
            text-decoration: none;
            visibility: hidden;
            user-select: none;
            -ms-user-select: none;
            -o-user-select: none;
            -moz-user-select: none;
            -khtml-user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }

        @media screen {

            aside:hover>a.pilcrow,
            p:hover>a.pilcrow,
            blockquote:hover>a.pilcrow,
            div:hover>a.pilcrow,
            li:hover>a.pilcrow,
            pre:hover>a.pilcrow {
                visibility: visible;
            }

            a.pilcrow:hover {
                background-color: transparent;
            }
        }

        /* misc */
        hr {
            border: 0;
            border-top: 1px solid #eee;
        }

        .bcp14 {
            font-variant: small-caps;
        }

        .role {
            font-variant: all-small-caps;
        }

        /* info block */
        #identifiers {
            margin: 0;
            font-size: 0.9em;
        }

        #identifiers dt {
            width: 3em;
            clear: left;
        }

        #identifiers dd {
            float: left;
            margin-bottom: 0;
        }

        /* Fix PDF info block run off issue */
        @media print {
            #identifiers dd {
                float: none;
            }
        }

        #identifiers .authors .author {
            display: inline-block;
            margin-right: 1.5em;
        }

        #identifiers .authors .org {
            font-style: italic;
        }

        /* The prepared/rendered info at the very bottom of the page */
        .docInfo {
            color: #666;
            /* Arlen: WCAG 2019 */
            font-size: 0.9em;
            font-style: italic;
            margin-top: 2em;
        }

        .docInfo .prepared {
            float: left;
        }

        .docInfo .prepared {
            float: right;
        }

        /* table of contents */
        #toc {
            padding: 0.75em 0 2em 0;
            margin-bottom: 1em;
        }

        nav.toc ul {
            margin: 0 0.5em 0 0;
            padding: 0;
            list-style: none;
        }

        nav.toc li {
            line-height: 1.3em;
            margin: 0.75em 0;
            padding-left: 1.2em;
            text-indent: -1.2em;
        }

        /* references */
        .references dt {
            text-align: right;
            font-weight: bold;
            min-width: 7em;
        }

        .references dd {
            margin-left: 8em;
            overflow: auto;
        }

        .refInstance {
            margin-bottom: 1.25em;
        }

        .references .ascii {
            margin-bottom: 0.25em;
        }

        /* index */
        .index ul {
            margin: 0 0 0 1em;
            padding: 0;
            list-style: none;
        }

        .index ul ul {
            margin: 0;
        }

        .index li {
            margin: 0;
            text-indent: -2em;
            padding-left: 2em;
            padding-bottom: 5px;
        }

        .indexIndex {
            margin: 0.5em 0 1em;
        }

        .index a {
            font-weight: 700;
        }

        /* make the index two-column on all but the smallest screens */
        @media (min-width: 600px) {
            .index ul {
                -moz-column-count: 2;
                -moz-column-gap: 20px;
            }

            .index ul ul {
                -moz-column-count: 1;
                -moz-column-gap: 0;
            }
        }

        /* authors */
        address.vcard {
            font-style: normal;
            margin: 1em 0;
        }

        address.vcard .nameRole {
            font-weight: 700;
            margin-left: 0;
        }

        address.vcard .label {
            font-family: "Noto Sans", Arial, Helvetica, sans-serif;
            margin: 0.5em 0;
        }

        address.vcard .type {
            display: none;
        }

        .alternative-contact {
            margin: 1.5em 0 1em;
        }

        hr.addr {
            border-top: 1px dashed;
            margin: 0;
            color: #ddd;
            max-width: calc(100% - 16px);
        }

        /* temporary notes */
        .rfcEditorRemove::before {
            position: absolute;
            top: 0.2em;
            right: 0.2em;
            padding: 0.2em;
            content: "The RFC Editor will remove this note";
            color: #9e2a00;
            /* Arlen: WCAG 2019 */
            background-color: #ffd;
            /* Arlen: WCAG 2019 */
        }

        .rfcEditorRemove {
            position: relative;
            padding-top: 1.8em;
            background-color: #ffd;
            /* Arlen: WCAG 2019 */
            border-radius: 3px;
        }

        .cref {
            background-color: #ffd;
            /* Arlen: WCAG 2019 */
            padding: 2px 4px;
        }

        .crefSource {
            font-style: italic;
        }

        /* alternative layout for smaller screens */
        @media screen and (max-width: 1023px) {
            body {
                padding-top: 2em;
            }

            #title {
                padding: 1em 0;
            }

            h1 {
                font-size: 24px;
            }

            h2 {
                font-size: 20px;
                margin-top: -18px;
                /* provide offset for in-page anchors */
                padding-top: 38px;
            }

            #identifiers dd {
                max-width: 60%;
            }

            #toc {
                position: fixed;
                z-index: 2;
                top: 0;
                right: 0;
                padding: 0;
                margin: 0;
                background-color: inherit;
                border-bottom: 1px solid #ccc;
            }

            #toc h2 {
                margin: -1px 0 0 0;
                padding: 4px 0 4px 6px;
                padding-right: 1em;
                min-width: 190px;
                font-size: 1.1em;
                text-align: right;
                background-color: #444;
                color: white;
                cursor: pointer;
            }

            #toc h2::before {
                /* css hamburger */
                float: right;
                position: relative;
                width: 1em;
                height: 1px;
                left: -164px;
                margin: 6px 0 0 0;
                background: white none repeat scroll 0 0;
                box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
                content: "";
            }

            #toc nav {
                display: none;
                padding: 0.5em 1em 1em;
                overflow: auto;
                height: calc(100vh - 48px);
                border-left: 1px solid #ddd;
            }
        }

        /* alternative layout for wide screens */
        @media screen and (min-width: 1024px) {
            body {
                max-width: 724px;
                margin: 42px auto;
                padding-left: 1.5em;
                padding-right: 29em;
            }

            #toc {
                position: fixed;
                top: 42px;
                right: 42px;
                width: 25%;
                margin: 0;
                padding: 0 1em;
                z-index: 1;
            }

            #toc h2 {
                border-top: none;
                border-bottom: 1px solid #ddd;
                font-size: 1em;
                font-weight: normal;
                margin: 0;
                padding: 0.25em 1em 1em 0;
            }

            #toc nav {
                display: block;
                height: calc(90vh - 84px);
                bottom: 0;
                padding: 0.5em 0 0;
                overflow: auto;
            }

            img {
                /* future proofing */
                max-width: 100%;
                height: auto;
            }
        }

        /* pagination */
        @media print {
            body {

                width: 100%;
            }

            p {
                orphans: 3;
                widows: 3;
            }

            #n-copyright-notice {
                border-bottom: none;
            }

            #toc,
            #n-introduction {
                page-break-before: always;
            }

            #toc {
                border-top: none;
                padding-top: 0;
            }

            figure,
            pre {
                page-break-inside: avoid;
            }

            figure {
                overflow: scroll;
            }

            pre.breakable {
                break-inside: auto;
            }

            h1,
            h2,
            h3,
            h4,
            h5,
            h6 {
                page-break-after: avoid;
            }

            h2+*,
            h3+*,
            h4+*,
            h5+*,
            h6+* {
                page-break-before: avoid;
            }

            pre {
                white-space: pre-wrap;
                word-wrap: break-word;
                font-size: 10pt;
            }

            table {
                border: 1px solid #ddd;
            }

            td {
                border-top: 1px solid #ddd;
            }
        }

        /* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
        /*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

        @page :first {
            padding-top: 0;

            @top-left {
                content: normal;
                border: none;
            }

            @top-center {
                content: normal;
                border: none;
            }

            @top-right {
                content: normal;
                border: none;
            }
        }

        @page {
            size: A4;
            margin-bottom: 45mm;
            padding-top: 20px;
            /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
            /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

        }

        /* Changes introduced to fix issues found during implementation */
        /* Make sure links are clickable even if overlapped by following H* */
        a {
            z-index: 2;
        }

        /* Separate body from document info even without intervening H1 */
        section {
            clear: both;
        }


        /* Top align author divs, to avoid names without organization dropping level with org names */
        .author {
            vertical-align: top;
        }

        /* Leave room in document info to show Internet-Draft on one line */
        #identifiers dt {
            width: 8em;
        }

        /* Don't waste quite as much whitespace between label and value in doc info */
        #identifiers dd {
            margin-left: 1em;
        }

        /* Give floating toc a background color (needed when it's a div inside section */
        #toc {
            background-color: white;
        }

        /* Make the collapsed ToC header render white on gray also when it's a link */
        @media screen and (max-width: 1023px) {

            #toc h2 a,
            #toc h2 a:link,
            #toc h2 a:focus,
            #toc h2 a:hover,
            #toc a.toplink,
            #toc a.toplink:hover {
                color: white;
                background-color: #444;
                text-decoration: none;
            }
        }

        /* Give the bottom of the ToC some whitespace */
        @media screen and (min-width: 1024px) {
            #toc {
                padding: 0 0 1em 1em;
            }
        }

        /* Style section numbers with more space between number and title */
        .section-number {
            padding-right: 0.5em;
        }

        /* prevent monospace from becoming overly large */
        tt,
        code,
        pre,
        code {
            font-size: 95%;
        }

        /* Fix the height/width aspect for ascii art*/
        pre.sourcecode,
        .art-text pre {
            line-height: 1.12;
        }


        /* Add styling for a link in the ToC that points to the top of the document */
        a.toplink {
            float: right;
            margin-right: 0.5em;
        }

        /* Fix the dl styling to match the RFC 7992 attributes */
        dl>dt,
        dl.dlParallel>dt {
            float: left;
            margin-right: 1em;
        }

        dl.dlNewline>dt {
            float: none;
        }

        /* Provide styling for table cell text alignment */
        table td.text-left,
        table th.text-left {
            text-align: left;
        }

        table td.text-center,
        table th.text-center {
            text-align: center;
        }

        table td.text-right,
        table th.text-right {
            text-align: right;
        }

        /* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
        .alternative-contact {
            margin: 0.5em 0 0.25em 0;
        }

        address .non-ascii {
            margin: 0 0 0 2em;
        }

        /* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
        table {
            width: auto;
        }

        /* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
        .references dd {
            overflow: visible;
        }

        /* Control caption placement */
        caption {
            caption-side: bottom;
        }

        /* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

        address.vcard {
            max-width: 30em;
            margin-right: auto;
        }

        /* For address alignment dependent on LTR or RTL scripts */
        address div.left {
            text-align: left;
        }

        address div.right {
            text-align: right;
        }

        /* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
        table.right {
            margin-left: auto;
            margin-right: 0;
        }

        table.center {
            margin-left: auto;
            margin-right: auto;
        }

        table.left {
            margin-left: 0;
            margin-right: auto;
        }

        /* Give the table caption label the same styling as the figcaption */
        caption a[href] {
            color: #222;
        }

        @media print {
            .toplink {
                display: none;
            }

            /* avoid overwriting the top border line with the ToC header */
            #toc {
                padding-top: 1px;
            }

            /* Avoid page breaks inside dl and author address entries */
            .vcard {
                page-break-inside: avoid;
            }

        }

        /* Tweak the bcp14 keyword presentation */
        .bcp14 {
            font-variant: small-caps;
            font-weight: bold;
            font-size: 0.9em;
        }

        /* Tweak the invisible space above H* in order not to overlay links in text above */
        h2 {
            margin-top: -18px;
            /* provide offset for in-page anchors */
            padding-top: 31px;
        }

        h3 {
            margin-top: -18px;
            /* provide offset for in-page anchors */
            padding-top: 24px;
        }

        h4 {
            margin-top: -18px;
            /* provide offset for in-page anchors */
            padding-top: 24px;
        }

        /* Float artwork pilcrow to the right */
        @media screen {
            .artwork a.pilcrow {
                display: block;
                line-height: 0.7;
                margin-top: 0.15em;
            }
        }

        /* Make pilcrows on dd visible */
        @media screen {
            dd:hover>a.pilcrow {
                visibility: visible;
            }
        }

        /* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
        .alignLeft.art-text,
        .alignCenter.art-text,
        .alignRight.art-text {
            margin-bottom: 0;
        }

        .alignLeft,
        .alignCenter,
        .alignRight {
            margin: 1em 0 0 0;
        }

        /* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
        @media print {
            a.pilcrow {
                display: none;
            }
        }

        /* Styling for the external metadata */
        div#external-metadata {
            background-color: #eee;
            padding: 0.5em;
            margin-bottom: 0.5em;
            display: none;
        }

        div#internal-metadata {
            padding: 0.5em;
            /* to match the external-metadata padding */
        }

        /* Styling for title RFC Number */
        h1#rfcnum {
            clear: both;
            margin: 0 0 -1em;
            padding: 1em 0 0 0;
        }

        /* Make .olPercent look the same as <ol><li> */
        dl.olPercent>dd {
            margin-bottom: 0.25em;
            min-height: initial;
        }

        /* Give aside some styling to set it apart */
        aside {
            border-left: 1px solid #ddd;
            margin: 1em 0 1em 2em;
            padding: 0.2em 2em;
        }

        aside>dl,
        aside>ol,
        aside>ul,
        aside>table,
        aside>p {
            margin-bottom: 0.5em;
        }

        /* Additional page break settings */
        @media print {

            figcaption,
            table caption {
                page-break-before: avoid;
            }
        }

        /* Font size adjustments for print */
        @media print {
            body {
                font-size: 10pt;
                line-height: normal;
                max-width: 96%;
            }

            h1 {
                font-size: 1.72em;
                padding-top: 1.5em;
            }

            /* 1*1.2*1.2*1.2 */
            h2 {
                font-size: 1.44em;
                padding-top: 1.5em;
            }

            /* 1*1.2*1.2 */
            h3 {
                font-size: 1.2em;
                padding-top: 1.5em;
            }

            /* 1*1.2 */
            h4 {
                font-size: 1em;
                padding-top: 1.5em;
            }

            h5,
            h6 {
                font-size: 1em;
                margin: initial;
                padding: 0.5em 0 0.3em;
            }
        }

        /* Sourcecode margin in print, when there's no pilcrow */
        @media print {

            .artwork,
            .sourcecode {
                margin-bottom: 1em;
            }
        }

        /* Avoid narrow tables forcing too narrow table captions, which may render badly */
        table {
            min-width: 20em;
        }

        /* ol type a */
        ol.type-a {
            list-style-type: lower-alpha;
        }

        ol.type-A {
            list-style-type: upper-alpha;
        }

        ol.type-i {
            list-style-type: lower-roman;
        }

        ol.type-I {
            list-style-type: lower-roman;
        }

        /* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
        table {
            border: 1px solid #ddd;
        }

        td {
            border-top: 1px solid #ddd;
        }

        tr:nth-child(2n+1)>td {
            background-color: #f8f8f8;
        }

        /* Use style rules to govern display of the TOC. */
        @media screen and (max-width: 1023px) {
            #toc nav {
                display: none;
            }

            #toc.active nav {
                display: block;
            }
        }

        /* Add support for keepWithNext */
        .keepWithNext {
            break-after: avoid-page;
            break-after: avoid-page;
        }

        /* Add support for keepWithPrevious */
        .keepWithPrevious {
            break-before: avoid-page;
        }

        /* Change the approach to avoiding breaks inside artwork etc. */
        figure,
        pre,
        table,
        .artwork,
        .sourcecode {
            break-before: auto;
            break-after: auto;
        }

        /* Avoid breaks between <dt> and <dd> */
        dl {
            break-before: auto;
            break-inside: auto;
        }

        dt {
            break-before: auto;
            break-after: avoid-page;
        }

        dd {
            break-before: avoid-page;
            break-after: auto;
            orphans: 3;
            widows: 3
        }

        span.break,
        dd.break {
            margin-bottom: 0;
            min-height: 0;
            break-before: auto;
            break-inside: auto;
            break-after: auto;
        }

        /* Undo break-before ToC */
        @media print {
            #toc {
                break-before: auto;
            }
        }

        /* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
        ul.compact p,
        .ulCompact p,
        ol.compact p,
        .olCompact p {
            margin: 0;
        }

        /* But the list as a whole needs the extra space at the end */
        section ul.compact,
        section .ulCompact,
        section ol.compact,
        section .olCompact {
            margin-bottom: 1em;
            /* same as p not within ul.compact etc. */
        }

        /* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
        tt,
        code {
            background-color: transparent;
        }

        p tt,
        p code,
        li tt,
        li code {
            background-color: #f8f8f8;
        }

        /* Tweak the pre margin -- 0px doesn't come out well */
        pre {
            margin-top: 0.5px;
        }

        /* Tweak the comact list text */
        ul.compact,
        .ulCompact,
        ol.compact,
        .olCompact,
        dl.compact,
        .dlCompact {
            line-height: normal;
        }

        /* Don't add top margin for nested lists */
        li>ul,
        li>ol,
        li>dl,
        dd>ul,
        dd>ol,
        dd>dl,
        dl>dd>dl {
            margin-top: initial;
        }

        /* Elements that should not be rendered on the same line as a <dt> */
        /* This should match the element list in writer.text.TextWriter.render_dl() */
        dd>div.artwork:first-child,
        dd>aside:first-child,
        dd>figure:first-child,
        dd>ol:first-child,
        dd>div:first-child>pre.sourcecode,
        dd>table:first-child,
        dd>ul:first-child {
            clear: left;
        }

        /* fix for weird browser behaviour when <dd/> is empty */
        dt+dd:empty::before {
            content: "\00a0";
        }

        /* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
        li>p {
            margin-bottom: 0.5em
        }

        /* Don't let p margin spill out from inside list items */
        li>p:last-of-type {
            margin-bottom: 0;
        }
    </style>
    <link href="https://www.rfc-editor.org/rfc/rfc-local.css" rel="stylesheet" type="text/css">
    <link href="https://dx.doi.org/10.17487/rfc9298" rel="alternate">
    <link href="urn:issn:2070-1721" rel="alternate">
    <link href="https://datatracker.ietf.org/doc/draft-ietf-masque-connect-udp-latest" rel="prev">
</head>

<body>
    <script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
    <table class="ears">
        <thead>
            <tr>
                <td class="left">RFC 9298</td>
                <td class="center">在 HTTP 中代理 UDP</td>
                <td class="right">2022年8月</td>
            </tr>
        </thead>
        <tfoot>
            <tr>
                <td class="left">Schinazi</td>
                <td class="center">标准轨道</td>
                <td class="right">[页码]</td>
            </tr>
        </tfoot>
    </table>
    <div id="external-metadata" class="document-information"></div>
    <div id="internal-metadata" class="document-information">
        <dl id="identifiers">
            <dt class="label-stream">流:</dt>
            <dd class="stream">Internet Engineering Task Force (IETF)</dd>
            <dt class="label-rfc">RFC:</dt>
            <dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9298" class="eref">9298</a></dd>
            <dt class="label-category">类别:</dt>
            <dd class="category">标准轨道</dd>
            <dt class="label-published">发布:</dt>
            <dd class="published">
                <time datetime="2022-08" class="published">2022年8月</time>
            </dd>
            <dt class="label-issn">ISSN:</dt>
            <dd class="issn">2070-1721</dd>
            <dt class="label-authors">作者:</dt>
            <dd class="authors">
                <div class="author">
                    <div class="author-name">D. Schinazi</div>
                    <div class="org">Google LLC</div>
                </div>
            </dd>
        </dl>
    </div>
    <h1 id="rfcnum">RFC 9298</h1>
    <h1 id="title">在 HTTP 中代理 UDP</h1>
    <section id="section-abstract">
        <h2 id="abstract"><a href="#abstract" class="selfRef">摘要</a></h2>
        <p id="section-abstract-1">本文档描述了如何在 HTTP 中代理 UDP，类似于 HTTP CONNECT 方法允许在 HTTP 中代理 TCP。更具体地说，本文档定义了一种协议，允许 HTTP
            客户端通过充当代理的 HTTP 服务器为 UDP 通信创建隧道。<a href="#section-abstract-1" class="pilcrow">¶</a></p>
    </section>
    <div id="status-of-memo">
        <section id="section-boilerplate.1">
            <h2 id="name-status-of-this-memo">
                <a href="#name-status-of-this-memo" class="section-name selfRef">本备忘录状态</a>
            </h2>
            <p id="section-boilerplate.1-1">
                这是一个互联网标准轨道文档。<a href="#section-boilerplate.1-1" class="pilcrow">¶</a>
            </p>
            <p id="section-boilerplate.1-2">
                本文档是互联网工程任务组（IETF）的产物。它代表了 IETF 社区的共识。该文档已接受公开评审并已获互联网工程指导组（IESG）批准发布。有关互联网标准的更多信息，请参阅 RFC 7841 的第 2
                节。<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
            <p id="section-boilerplate.1-3">
                有关本文件当前状态、任何勘误以及如何提供反馈的信息，可在 <span><a
                        href="https://www.rfc-editor.org/info/rfc9298">https://www.rfc-editor.org/info/rfc9298</a></span>
                获得。<a href="#section-boilerplate.1-3" class="pilcrow">¶</a>
            </p>
        </section>
    </div>
    <div id="copyright">
        <section id="section-boilerplate.2">
            <h2 id="name-copyright-notice">
                <a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
            </h2>
            <p id="section-boilerplate.2-1">
                Copyright (c) 2022 IETF Trust and the persons identified as the
                document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
            <p id="section-boilerplate.2-2">
                This document is subject to BCP 78 and the IETF Trust's Legal
                Provisions Relating to IETF Documents
                (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>)
                in effect on the date of
                publication of this document. Please review these documents
                carefully, as they describe your rights and restrictions with
                respect to this document. Code Components extracted from this
                document must include Revised BSD License text as described in
                Section 4.e of the Trust Legal Provisions and are provided without
                warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2"
                    class="pilcrow">¶</a></p>
        </section>
    </div>
    <div id="toc">
        <section id="section-toc.1">
            <a href="#" onclick="scroll(0,0)" class="toplink">▲</a>
            <h2 id="name-table-of-contents">
                <a href="#name-table-of-contents" class="section-name selfRef">目录</a>
            </h2>
            <nav class="toc">
                <ul class="compact toc ulBare ulEmpty">
                    <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
                        <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>. <a
                                href="#name-introduction" class="xref">引言</a></p>
                        <ul class="compact toc ulBare ulEmpty">
                            <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1"
                                        class="xref">1.1</a>. <a href="#name-conventions-and-definitions"
                                        class="xref">约定与定义</a></p>
                            </li>
                        </ul>
                    </li>
                    <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
                        <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>. <a
                                href="#name-client-configuration" class="xref">客户端配置</a></p>
                    </li>
                    <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
                        <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>. <a
                                href="#name-tunneling-udp-over-http" class="xref">通过 HTTP 隧道传输 UDP</a></p>
                        <ul class="compact toc ulBare ulEmpty">
                            <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>. <a
                                        href="#name-udp-proxy-handling" class="xref">UDP 代理处理</a></p>
                            </li>
                            <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>. <a
                                        href="#name-http-11-request" class="xref">HTTP/1.1 请求</a></p>
                            </li>
                            <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>. <a
                                        href="#name-http-11-response" class="xref">HTTP/1.1 响应</a></p>
                            </li>
                            <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>. <a
                                        href="#name-http-2-and-http-3-requests" class="xref">HTTP/2 与 HTTP/3 请求</a></p>
                            </li>
                            <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>. <a
                                        href="#name-http-2-and-http-3-responses" class="xref">HTTP/2 与 HTTP/3 响应</a></p>
                            </li>
                        </ul>
                    </li>
                    <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
                        <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>. <a
                                href="#name-context-identifiers" class="xref">上下文标识符</a></p>
                    </li>
                    <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
                        <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>. <a
                                href="#name-http-datagram-payload-forma" class="xref">HTTP 数据报负载格式</a>
                        </p>
                    </li>
                    <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
                        <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>. <a
                                href="#name-performance-considerations" class="xref">性能注意事项</a></p>
                        <ul class="compact toc ulBare ulEmpty">
                            <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>. <a
                                        href="#name-mtu-considerations" class="xref">MTU 注意事项</a></p>
                            </li>
                            <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>. <a
                                        href="#name-tunneling-of-ecn-marks" class="xref">ECN 标记的隧道传递</a></p>
                            </li>
                        </ul>
                    </li>
                    <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
                        <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>. <a
                                href="#name-security-considerations" class="xref">安全性考虑</a></p>
                    </li>
                    <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
                        <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>. <a
                                href="#name-iana-considerations" class="xref">IANA 考量</a></p>
                        <ul class="compact toc ulBare ulEmpty">
                            <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>. <a
                                        href="#name-http-upgrade-token" class="xref">HTTP Upgrade 令牌</a></p>
                            </li>
                            <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>. <a
                                        href="#name-well-known-uri" class="xref">Well-Known URI</a></p>
                            </li>
                        </ul>
                    </li>
                    <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
                        <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>. <a href="#name-references"
                                class="xref">参考文献</a></p>
                        <ul class="compact toc ulBare ulEmpty">
                            <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>. <a
                                        href="#name-normative-references" class="xref">规范性参考文献</a></p>
                            </li>
                            <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>. <a
                                        href="#name-informative-references" class="xref">信息性参考文献</a></p>
                            </li>
                        </ul>
                    </li>
                    <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
                        <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref"></a><a
                                href="#name-acknowledgments" class="xref">致谢</a></p>
                    </li>
                    <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
                        <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="xref"></a><a
                                href="#name-authors-address" class="xref">作者联系方式</a></p>
                    </li>
                </ul>
            </nav>
        </section>
    </div>
    <div id="introduction">
        <section id="section-1">
            <h2 id="name-introduction">
                <a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction"
                    class="section-name selfRef">引言</a>
            </h2>
            <p id="section-1-1">虽然 HTTP 提供了 CONNECT 方法（参见 <span><a
                        href="https://www.rfc-editor.org/rfc/rfc9110#section-9.3.6" class="relref">RFC9110 第 9.3.6
                        节</a>）</span>
                用于创建到代理的 TCP <span>[<a href="#RFC9293" class="xref">TCP</a>]</span> 隧道，但在本规范之前，
                它并不具备用于 UDP <span>[<a href="#RFC0768" class="xref">UDP</a>]</span> 流量的相应方法。<a href="#section-1-1"
                    class="pilcrow">¶</a></p>
            <p id="section-1-2">本文档描述了一个用于通过充当 UDP 专用代理的服务器在 HTTP 上对 UDP 进行隧道传输的协议。UDP 隧道通常用于创建端到端的虚拟连接，然后可以使用 QUIC
                <span>[<a href="#RFC9000" class="xref">QUIC</a>]</span> 或其他运行在 UDP 之上的协议对其进行保护。与 HTTP CONNECT 方法不同，UDP
                代理本身由包含目标地址的绝对 URL 标识。客户端使用 URI 模板 <span>[<a href="#RFC6570" class="xref">TEMPLATE</a>]</span> 生成这些
                URL，如 <a href="#client-config" class="xref">第 2 节</a> 所述。<a href="#section-1-2" class="pilcrow">¶</a>
            </p>
            <p id="section-1-3">该协议通过使用 HTTP 数据报 <span>[<a href="#RFC9297" class="xref">HTTP-DGRAM</a>]</span> 支持所有现有版本的
                HTTP。当使用 HTTP/2 <span>[<a href="#RFC9113" class="xref">HTTP/2</a>]</span> 或 HTTP/3 <span>[<a
                        href="#RFC9114" class="xref">HTTP/3</a>]</span> 时，它使用如 <span>[<a href="#RFC8441"
                        class="xref">EXT-CONNECT2</a>]</span> 和 <span>[<a href="#RFC9220"
                        class="xref">EXT-CONNECT3</a>]</span> 所述的 HTTP 扩展 CONNECT。当使用 HTTP/1.x <span>[<a href="#RFC9112"
                        class="xref">HTTP/1.1</a>]</span> 时，它使用 <span><a
                        href="https://www.rfc-editor.org/rfc/rfc9110#section-7.8" class="relref">RFC9110 第 7.8
                        节</a></span> 定义的 HTTP Upgrade。<a href="#section-1-3" class="pilcrow">¶</a>
            </p>
            <div id="conventions">
                <section id="section-1.1">
                    <h3 id="name-conventions-and-definitions">
                        <a href="#section-1.1" class="section-number selfRef">1.1. </a><a
                            href="#name-conventions-and-definitions" class="section-name selfRef">约定与定义</a>
                    </h3>
                    <p id="section-1.1-1">文中关键字 "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST
                            NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
                        "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span
                            class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span
                            class="bcp14">NOT RECOMMENDED</span>",
                        "<span class="bcp14">MAY</span>", 和 "<span class="bcp14">OPTIONAL</span>" 的解释应当遵循 BCP 14
                        <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> 与 <span>[<a href="#RFC8174"
                                class="xref">RFC8174</a>]</span> 中的定义，仅当这些词以全部大写形式出现时适用。<a href="#section-1.1-1"
                            class="pilcrow">¶</a>
                    </p>
                    <p id="section-1.1-2">在本文档中，我们使用术语 "UDP proxy" 指代作为客户端 UDP 隧道请求的处理者的 HTTP 服务器，该服务器为目标服务器打开 UDP
                        套接字并生成对此请求的响应。如果客户端与 UDP 代理之间存在 HTTP 中介（如 <span><a
                                href="https://www.rfc-editor.org/rfc/rfc9110#section-3.7" class="relref">RFC9110 第 3.7
                                节</a></span> 所定义），本文档中将这些称为“中介”。<a href="#section-1.1-2" class="pilcrow">¶</a></p>
                    <p id="section-1.1-3">注意，当使用的 HTTP 版本不支持流复用（例如 HTTP/1.1）时，本文档中任何对“流”的引用均表示整个连接。<a
                            href="#section-1.1-3" class="pilcrow">¶</a></p>
                </section>
            </div>
        </section>
    </div>
    <div id="client-config">
        <section id="section-2">
            <h2 id="name-client-configuration">
                <a href="#section-2" class="section-number selfRef">2. </a><a href="#name-client-configuration"
                    class="section-name selfRef">客户端配置</a>
            </h2>
            <p id="section-2-1">HTTP 客户端使用包含变量 "target_host" 和 "target_port" 的 URI 模板 <span>[<a href="#RFC6570"
                        class="xref">TEMPLATE</a>]</span> 配置以使用 UDP 代理。下面给出示例：<a href="#section-2-1"
                    class="pilcrow">¶</a>
            </p>
            <span id="name-uri-template-examples"></span>
            <div id="fig-template-examples">
                <figure id="figure-1">
                    <div class="alignLeft art-ascii-art art-text artwork" id="section-2-2.1">
                        <pre>
https://example.org/.well-known/masque/udp/{target_host}/{target_port}/
https://proxy.example.org:4443/masque?h={target_host}&amp;p={target_port}
https://proxy.example.org:4443/masque{?target_host,target_port}
</pre>
                    </div>
                    <figcaption><a href="#figure-1" class="selfRef">图 1</a>:
                        <a href="#name-uri-template-examples" class="selfRef">URI 模板示例</a>
                    </figcaption>
                </figure>
            </div>
            <p id="section-2-3">以下要求适用于该 URI 模板：<a href="#section-2-3" class="pilcrow">¶</a></p>
            <ul class="normal">
                <li class="normal" id="section-2-4.1">URI 模板 <span class="bcp14">MUST</span> 为 3 级或更低级别的模板。<a
                        href="#section-2-4.1" class="pilcrow">¶</a>
                </li>
                <li class="normal" id="section-2-4.2">URI 模板 <span class="bcp14">MUST</span> 必须为绝对形式，并且 <span
                        class="bcp14">MUST</span> 包含非空的 scheme、authority 和 path 组件。<a href="#section-2-4.2"
                        class="pilcrow">¶</a>
                </li>
                <li class="normal" id="section-2-4.3">URI 模板的 path 组件 <span class="bcp14">MUST</span> 以斜杠 ("/") 开头。<a
                        href="#section-2-4.3" class="pilcrow">¶</a>
                </li>
                <li class="normal" id="section-2-4.4">所有模板变量 <span class="bcp14">MUST</span> 位于 URI 的路径或查询组件内。<a
                        href="#section-2-4.4" class="pilcrow">¶</a>
                </li>
                <li class="normal" id="section-2-4.5">URI 模板 <span class="bcp14">MUST</span> 必须包含两个变量 "target_host" 和
                    "target_port"，并且 <span class="bcp14">MAY</span> 包含其他变量。<a href="#section-2-4.5"
                        class="pilcrow">¶</a>
                </li>
                <li class="normal" id="section-2-4.6">URI 模板 <span class="bcp14">MUST NOT</span> 包含任何非 ASCII 的 Unicode
                    字符，且 <span class="bcp14">MUST</span> 仅包含 0x21-0x7E 范围内的 ASCII 字符（注意允许使用百分号编码；见 <span><a
                            href="https://www.rfc-editor.org/rfc/rfc3986#section-2.1" class="relref">RFC3986 第 2.1
                            节</a></span>）。<a href="#section-2-4.6" class="pilcrow">¶</a>
                </li>
                <li class="normal" id="section-2-4.7">URI 模板 <span class="bcp14">MUST NOT</span> 使用保留扩展（"+"
                    操作符）、片段扩展（"#" 操作符）、带点前缀的标签扩展、带斜杠前缀的路径段扩展，或带分号前缀的路径样式参数扩展。<a href="#section-2-4.7"
                        class="pilcrow">¶</a>
                </li>
            </ul>
            <p id="section-2-5">客户端 <span class="bcp14">SHOULD</span> 验证上述要求；然而，客户端 <span class="bcp14">MAY</span>
                使用不具备此类特定验证的一般用途 URI 模板实现。如果客户端检测到任何 URI 模板不满足上述要求，客户端 <span class="bcp14">MUST</span> 拒绝该配置并在不向 UDP
                代理发送请求的情况下中止该请求。<a href="#section-2-5" class="pilcrow">¶</a></p>
            <p id="section-2-6">原始的 HTTP CONNECT 方法允许传递目标主机和端口，但不包含 scheme、代理 authority、path 或
                query。因此，一些代理配置界面仅允许用户配置代理主机和代理端口。受此类限制约束的本规范的客户端实现 <span class="bcp14">MAY</span> 尝试使用默认模板 访问 UDP
                代理能力，该默认模板定义为 "https://$PROXY_HOST:$PROXY_PORT/.well-known/masque/udp/{target_host}/{target_port}/"，其中
                $PROXY_HOST 和 $PROXY_PORT 分别为配置的 UDP 代理主机和端口。若需与此类客户端互操作，UDP 代理部署 <span class="bcp14">SHOULD</span>
                在该位置提供服务。<a href="#section-2-6" class="pilcrow">¶</a></p>
        </section>
    </div>
    <div id="tunneling-udp-over-http">
        <section id="section-3">
            <h2 id="name-tunneling-udp-over-http">
                <a href="#section-3" class="section-number selfRef">3. </a><a href="#name-tunneling-udp-over-http"
                    class="section-name selfRef">通过 HTTP 隧道传输 UDP</a>
            </h2>
            <p id="section-3-1">为了协商用于在 HTTP 上传输 UDP 的隧道，本文档定义了 "connect-udp" HTTP Upgrade 令牌。由此建立的 UDP 隧道使用 Capsule
                协议（参见 <span><a href="https://www.rfc-editor.org/rfc/rfc9297#section-3.2" class="relref">RFC9297 第 3.2
                        节</a>）并采用在 <a href="#format" class="xref">第 5 节</a></span> 定义的 HTTP 数据报格式。<a href="#section-3-1"
                    class="pilcrow">¶</a></p>
            <p id="section-3-2">要为与单个 HTTP 流关联的 UDP 隧道发起协商，客户端发出包含 "connect-udp" upgrade 令牌的请求。隧道的目标由客户端通过 URI 模板的
                "target_host" 和 "target_port" 变量向 UDP 代理指示；参见 <a href="#client-config" class="xref">第 2 节</a>。<a
                    href="#section-3-2" class="pilcrow">¶</a></p>
            <p id="section-3-3">"target_host" 支持使用 DNS 名称、IPv6 字面量和 IPv4 字面量。注意不支持 IPv6 作用域地址标识符。使用 <span>[<a
                        href="#RFC3986" class="xref">URI</a>]</span> 中的术语 IPv6address、IPv4address、reg-name 和
                port，"target_host" 与 "target_port" 变量 <span class="bcp14">MUST</span> 遵循 <a href="#target-format"
                    class="xref">图 2</a> 中的格式，使用 <span>[<a href="#RFC2234" class="xref">ABNF</a>]</span> 的记法。此外：<a
                    href="#section-3-3" class="pilcrow">¶</a></p>
            <ul class="normal">
                <li class="normal" id="section-3-4.1">"target_host" 与 "target_port" 变量均 <span class="bcp14">MUST
                        NOT</span> 为空。<a href="#section-3-4.1" class="pilcrow">¶</a>
                </li>
                <li class="normal" id="section-3-4.2">如果 "target_host" 包含 IPv6 字面量，冒号 (":") <span
                        class="bcp14">MUST</span> 进行百分号编码。例如，如果目标主机是 "2001:db8::42"，则在 URI 中编码为 "2001%3Adb8%3A%3A42"。<a
                        href="#section-3-4.2" class="pilcrow">¶</a>
                </li>
                <li class="normal" id="section-3-4.3">"target_port" <span class="bcp14">MUST</span> 表示一个在 1 到
                    65535（含）之间的整数。<a href="#section-3-4.3" class="pilcrow">¶</a>
                </li>
            </ul>
            <span id="name-uri-template-variable-forma"></span>
            <div id="target-format">
                <figure id="figure-2">
                    <div class="alignLeft art-ascii-art art-text artwork" id="section-3-5.1">
                        <pre>
target_host = IPv6address / IPv4address / reg-name
target_port = port
</pre>
                    </div>
                    <figcaption><a href="#figure-2" class="selfRef">图 2</a>:
                        <a href="#name-uri-template-variable-forma" class="selfRef">URI 模板变量格式</a>
                    </figcaption>
                </figure>
            </div>
            <p id="section-3-6">在发送其 UDP 代理请求时，客户端 <span class="bcp14">SHALL</span> 执行 URI 模板展开以确定请求的路径和查询部分。<a
                    href="#section-3-6" class="pilcrow">¶</a>
            </p>
            <p id="section-3-7">如果请求成功，UDP 代理承诺将接收的 HTTP 数据报转换为 UDP 数据包，反之亦然，直到隧道被关闭为止。<a href="#section-3-7"
                    class="pilcrow">¶</a></p>
            <p id="section-3-8">根据 Capsule Protocol 的定义（参见 <span><a
                        href="https://www.rfc-editor.org/rfc/rfc9297#section-3.2" class="relref">第 3.2 节</a>，见 [<a
                        href="#RFC9297" class="xref">HTTP-DGRAM</a>]</span>），UDP 代理请求不携带任何消息内容。
                同样，成功的 UDP 代理响应也不携带任何消息内容。<a href="#section-3-8" class="pilcrow">¶</a></p>
            <div id="handling">
                <section id="section-3.1">
                    <h3 id="name-udp-proxy-handling">
                        <a href="#section-3.1" class="section-number selfRef">3.1. </a><a
                            href="#name-udp-proxy-handling" class="section-name selfRef">UDP 代理处理</a>
                    </h3>
                    <p id="section-3.1-1">在接收到 UDP 代理请求后：<a href="#section-3.1-1" class="pilcrow">¶</a></p>
                    <ul class="normal">
                        <li class="normal" id="section-3.1-2.1">如果接收方配置为使用另一个 HTTP 代理，它将充当中介并将该请求转发到另一个 HTTP
                            服务器。注意，如果中介使用与接收请求时不同的 HTTP 版本转发请求，可能需要重新编码请求，因为不同版本的请求编码不同（见下文）。<a href="#section-3.1-2.1"
                                class="pilcrow">¶</a>
                        </li>
                        <li class="normal" id="section-3.1-2.2">否则，接收方将作为 UDP 代理。它从已从请求头重构的 URI 中提取 "target_host" 与
                            "target_port" 变量，解码它们的百分号编码，并通过直接向所请求的目标打开 UDP 套接字来建立隧道。<a href="#section-3.1-2.2"
                                class="pilcrow">¶</a>
                        </li>
                    </ul>
                    <p id="section-3.1-3">与 TCP 不同，UDP 是无连接的。打开 UDP 套接字的 UDP
                        代理无法知道目标是否可达。因此，它需要在不等待来自目标的数据包的情况下对请求做出响应。然而，如果 "target_host" 是 DNS 名称，UDP 代理 <span
                            class="bcp14">MUST</span> 在回复 HTTP 请求之前执行 DNS 解析。如果在该过程中发生错误，UDP 代理 <span
                            class="bcp14">MUST</span> 拒绝该请求并 <span class="bcp14">SHOULD</span> 使用适当的 Proxy-Status 头字段
                        <span>[<a href="#RFC9209" class="xref">PROXY-STATUS</a>]</span> 提供详细信息。例如，如果 DNS 解析返回错误，代理可以使用
                        <span><a href="https://www.rfc-editor.org/rfc/rfc9209#section-2.3.2" class="relref">PROXY-STATUS
                                第 2.3.2 节</a></span> 中的 dns_error 代理错误类型。<a href="#section-3.1-3" class="pilcrow">¶</a>
                    </p>
                    <p id="section-3.1-4">如果操作系统支持，UDP 代理可以使用已连接的 UDP 套接字，因为这样代理可以依赖内核只将与正确五元组匹配的 UDP 数据包交付给它。如果 UDP
                        代理使用非连接套接字，则它 <span class="bcp14">MUST</span> 验证收到的数据包的 IP 源地址和 UDP 源端口以确保它们与客户端请求匹配。不匹配的数据包
                        <span class="bcp14">MUST</span> 由 UDP 代理丢弃。<a href="#section-3.1-4" class="pilcrow">¶</a>
                    </p>
                    <p id="section-3.1-5">套接字的生命周期与请求流绑定。UDP 代理 <span class="bcp14">MUST</span> 在请求流打开时保持套接字打开。如果操作系统通知
                        UDP 代理其套接字不再可用，代理 <span class="bcp14">MUST</span> 关闭请求流。例如，当收到 ICMP 目标不可达消息时可能发生这种情况；参见 <span><a
                                href="https://www.rfc-editor.org/rfc/rfc4443#section-3.1" class="relref">ICMP6 第 3.1
                                节</a></span>。UDP 代理 <span class="bcp14">MAY</span> 选择因一段时间不活动而关闭套接字，但它们 <span
                            class="bcp14">MUST</span> 在关闭套接字时关闭请求流。选择在不活动后一段时间关闭套接字的 UDP 代理 <span class="bcp14">SHOULD
                            NOT</span> 使用低于两分钟的期限；参见 <span><a href="https://www.rfc-editor.org/rfc/rfc4787#section-4.3"
                                class="relref">BEHAVE 第 4.3 节</a></span>。<a href="#section-3.1-5" class="pilcrow">¶</a>
                    </p>
                    <p id="section-3.1-6">成功的响应（如 <a href="#resp1" class="xref">第 3.3 节</a> 和 <a href="#resp23"
                            class="xref">第 3.5 节</a> 定义）表示 UDP 代理已向请求的目标打开套接字并愿意代理 UDP 有效载荷。任何非成功响应均表示请求已失败；因此，客户端 <span
                            class="bcp14">MUST</span> 中止该请求。<a href="#section-3.1-6" class="pilcrow">¶</a></p>
                    <p id="section-3.1-7">UDP 代理 <span class="bcp14">MUST NOT</span> 在将 HTTP 数据报转发到 UDP 套接字时引入 IP
                        层的分片；过大的数据报应被静默丢弃。在 IPv4 中，应在可能时设置 Don't Fragment (DF) 位 <span
                            class="bcp14">MUST</span>，以防止路径上的分片。未来的扩展 <span class="bcp14">MAY</span> 移除这些要求。<a
                            href="#section-3.1-7" class="pilcrow">¶</a></p>
                    <p id="section-3.1-8">UDP 代理的实现者应参考 <span>[<a href="#RFC8085" class="xref">UDP-USAGE</a>]</span>
                        中的指导。<a href="#section-3.1-8" class="pilcrow">¶</a></p>
                </section>
            </div>
            <div id="req1">
                <section id="section-3.2">
                    <h3 id="name-http-11-request">
                        <a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-http-11-request"
                            class="section-name selfRef">HTTP/1.1 请求</a>
                    </h3>
                    <p id="section-3.2-1">当使用 HTTP/1.1 <span>[<a href="#RFC9112" class="xref">HTTP/1.1</a>]</span> 时，UDP
                        代理请求需满足以下要求：<a href="#section-3.2-1" class="pilcrow">¶</a></p>
                    <ul class="normal">
                        <li class="normal" id="section-3.2-2.1">方法 <span class="bcp14">SHALL</span> 为 "GET"。<a
                                href="#section-3.2-2.1" class="pilcrow">¶</a>
                        </li>
                        <li class="normal" id="section-3.2-2.2">请求 <span class="bcp14">SHALL</span> 包含一个 Host 头字段，包含 UDP
                            代理的源。<a href="#section-3.2-2.2" class="pilcrow">¶</a>
                        </li>
                        <li class="normal" id="section-3.2-2.3">请求 <span class="bcp14">SHALL</span> 包含一个值为 "Upgrade" 的
                            Connection 头字段（注意根据 <span><a href="https://www.rfc-editor.org/rfc/rfc9110#section-7.6.1"
                                    class="relref">RFC9110 第 7.6.1 节</a></span> 的规定，该要求大小写不敏感）。<a
                                href="#section-3.2-2.3" class="pilcrow">¶</a>
                        </li>
                        <li class="normal" id="section-3.2-2.4">请求 <span class="bcp14">SHALL</span> 包含一个值为 "connect-udp"
                            的 Upgrade 头字段。<a href="#section-3.2-2.4" class="pilcrow">¶</a>
                        </li>
                    </ul>
                    <p id="section-3.2-3">不符合这些限制的 UDP 代理请求为格式错误。接收方对于此类格式错误请求 <span class="bcp14">MUST</span> 返回错误并
                        <span class="bcp14">SHOULD</span> 使用 400 (Bad Request) 状态码。<a href="#section-3.2-3"
                            class="pilcrow">¶</a>
                    </p>
                    <p id="section-3.2-4">例如，如果客户端配置的 URI 模板为
                        "https://example.org/.well-known/masque/udp/{target_host}/{target_port}/" 并希望打开到目标 192.0.2.6:443
                        的 UDP 代理隧道，它可以发送如下请求：<a href="#section-3.2-4" class="pilcrow">¶</a></p>
                    <span id="name-example-http-11-request"></span>
                    <div id="fig-req-h1">
                        <figure id="figure-3">
                            <div class="alignLeft art-text artwork" id="section-3.2-5.1">
                                <pre>
GET https://example.org/.well-known/masque/udp/192.0.2.6/443/ HTTP/1.1
Host: example.org
Connection: Upgrade
Upgrade: connect-udp
Capsule-Protocol: ?1
</pre>
                            </div>
                            <figcaption><a href="#figure-3" class="selfRef">图 3</a>:
                                <a href="#name-example-http-11-request" class="selfRef">HTTP/1.1 请求示例</a>
                            </figcaption>
                        </figure>
                    </div>
                    <p id="section-3.2-6">在 HTTP/1.1 中，该协议使用 GET 方法以模拟 WebSocket 协议 <span>[<a href="#RFC6455"
                                class="xref">WEBSOCKET</a>]</span> 的设计。<a href="#section-3.2-6" class="pilcrow">¶</a>
                    </p>
                </section>
            </div>
            <div id="resp1">
                <section id="section-3.3">
                    <h3 id="name-http-11-response">
                        <a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-http-11-response"
                            class="section-name selfRef">HTTP/1.1 响应</a>
                    </h3>
                    <p id="section-3.3-1">UDP 代理 <span class="bcp14">SHALL</span> 通过回复满足以下要求来表示成功响应：<a
                            href="#section-3.3-1" class="pilcrow">¶</a></p>
                    <ul class="normal">
                        <li class="normal" id="section-3.3-2.1">响应的 HTTP 状态码 <span class="bcp14">SHALL</span> 为 101
                            (Switching Protocols)。<a href="#section-3.3-2.1" class="pilcrow">¶</a>
                        </li>
                        <li class="normal" id="section-3.3-2.2">响应 <span class="bcp14">SHALL</span> 包含一个值为 "Upgrade" 的
                            Connection 头字段（注意根据 <span><a href="https://www.rfc-editor.org/rfc/rfc9110#section-7.6.1"
                                    class="relref">RFC9110 第 7.6.1 节</a></span> 的规定，该要求大小写不敏感）。<a
                                href="#section-3.3-2.2" class="pilcrow">¶</a>
                        </li>
                        <li class="normal" id="section-3.3-2.3">响应 <span class="bcp14">SHALL</span> 包含单个值为 "connect-udp"
                            的 Upgrade 头字段。<a href="#section-3.3-2.3" class="pilcrow">¶</a>
                        </li>
                        <li class="normal" id="section-3.3-2.4">响应 <span class="bcp14">SHALL</span> 满足启动 Capsule 协议的
                            HTTP 响应要求；见 <span><a href="https://www.rfc-editor.org/rfc/rfc9297#section-3.2"
                                    class="relref">RFC9297 第 3.2 节</a></span>。<a href="#section-3.3-2.4"
                                class="pilcrow">¶</a>
                        </li>
                    </ul>
                    <p id="section-3.3-3">如果未满足这些要求，客户端 <span class="bcp14">MUST</span> 将此代理尝试视为失败并中止连接。<a
                            href="#section-3.3-3" class="pilcrow">¶</a></p>
                    <p id="section-3.3-4">例如，UDP 代理可以响应如下：<a href="#section-3.3-4" class="pilcrow">¶</a></p>
                    <span id="name-example-http-11-response"></span>
                    <div id="fig-resp-h1">
                        <figure id="figure-4">
                            <div id="section-3.3-5.1">
                                <pre class="lang-http-message sourcecode">
HTTP/1.1 101 Switching Protocols
Connection: Upgrade
Upgrade: connect-udp
Capsule-Protocol: ?1
</pre>
                            </div>
                            <figcaption><a href="#figure-4" class="selfRef">图 4</a>:
                                <a href="#name-example-http-11-response" class="selfRef">HTTP/1.1 响应示例</a>
                            </figcaption>
                        </figure>
                    </div>
                </section>
            </div>
            <div id="req23">
                <section id="section-3.4">
                    <h3 id="name-http-2-and-http-3-requests">
                        <a href="#section-3.4" class="section-number selfRef">3.4. </a><a
                            href="#name-http-2-and-http-3-requests" class="section-name selfRef">HTTP/2 与 HTTP/3 请求</a>
                    </h3>
                    <p id="section-3.4-1">当使用 HTTP/2 <span>[<a href="#RFC9113" class="xref">HTTP/2</a>]</span> 或
                        HTTP/3 <span>[<a href="#RFC9114" class="xref">HTTP/3</a>]</span> 时，UDP 代理请求使用 HTTP 扩展 CONNECT。
                        这要求服务器发送一个 HTTP Setting，如 <span>[<a href="#RFC8441" class="xref">EXT-CONNECT2</a>]</span> 和
                        <span>[<a href="#RFC9220" class="xref">EXT-CONNECT3</a>]</span> 所规定，并且请求使用带有以下要求的 HTTP 伪头字段：<a
                            href="#section-3.4-1" class="pilcrow">¶</a>
                    </p>
                    <ul class="normal">
                        <li class="normal" id="section-3.4-2.1">:method 伪头字段 <span class="bcp14">SHALL</span> 为
                            "CONNECT"。<a href="#section-3.4-2.1" class="pilcrow">¶</a>
                        </li>
                        <li class="normal" id="section-3.4-2.2">:protocol 伪头字段 <span class="bcp14">SHALL</span> 为
                            "connect-udp"。<a href="#section-3.4-2.2" class="pilcrow">¶</a>
                        </li>
                        <li class="normal" id="section-3.4-2.3">:authority 伪头字段 <span class="bcp14">SHALL</span> 包含 UDP
                            代理的 authority。<a href="#section-3.4-2.3" class="pilcrow">¶</a>
                        </li>
                        <li class="normal" id="section-3.4-2.4">:path 与 :scheme 伪头字段 <span class="bcp14">SHALL
                                NOT</span> 为空。它们的值 <span class="bcp14">SHALL</span> 包含在 URI 模板展开过程完成后所得的 scheme 和
                            path。<a href="#section-3.4-2.4" class="pilcrow">¶</a>
                        </li>
                    </ul>
                    <p id="section-3.4-3">不符合这些限制的 UDP 代理请求为格式错误（参见 <span><a
                                href="https://www.rfc-editor.org/rfc/rfc9113#section-8.1.1" class="relref">RFC9113 第
                                8.1.1 节</a> 的说明</span> 与 <span><a
                                href="https://www.rfc-editor.org/rfc/rfc9114#section-4.1.2" class="relref">RFC9114 第
                                4.1.2 节</a> 的说明</span>）。<a href="#section-3.4-3" class="pilcrow">¶</a></p>
                    <p id="section-3.4-4">例如，如果客户端配置的 URI 模板为
                        "https://example.org/.well-known/masque/udp/{target_host}/{target_port}/" 并希望打开到目标 192.0.2.6:443
                        的 UDP 代理隧道，
                        它可以发送如下请求：<a href="#section-3.4-4" class="pilcrow">¶</a></p>
                    <span id="name-example-http-2-request"></span>
                    <div id="fig-req-h2">
                        <figure id="figure-5">
                            <div id="section-3.4-5.1">
                                <pre class="lang-http-message sourcecode">
HEADERS
:method = CONNECT
:protocol = connect-udp
:scheme = https
:path = /.well-known/masque/udp/192.0.2.6/443/
:authority = example.org
capsule-protocol = ?1
</pre>
                            </div>
                            <figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
                                <a href="#name-example-http-2-request" class="selfRef">HTTP/2 请求示例</a>
                            </figcaption>
                        </figure>
                    </div>
                </section>
            </div>
            <div id="resp23">
                <section id="section-3.5">
                    <h3 id="name-http-2-and-http-3-responses">
                        <a href="#section-3.5" class="section-number selfRef">3.5. </a><a
                            href="#name-http-2-and-http-3-responses" class="section-name selfRef">HTTP/2 与 HTTP/3 响应</a>
                    </h3>
                    <p id="section-3.5-1">UDP 代理 <span class="bcp14">SHALL</span> 通过满足以下要求来指示成功响应：<a
                            href="#section-3.5-1" class="pilcrow">¶</a></p>
                    <ul class="normal">
                        <li class="normal" id="section-3.5-2.1">响应的 HTTP 状态码 <span class="bcp14">SHALL</span> 位于
                            2xx（成功）范围内。<a href="#section-3.5-2.1" class="pilcrow">¶</a>
                        </li>
                        <li class="normal" id="section-3.5-2.2">响应 <span class="bcp14">SHALL</span> 满足启动 Capsule 协议的
                            HTTP 响应要求；参见 <span><a href="https://www.rfc-editor.org/rfc/rfc9297#section-3.2"
                                    class="relref">RFC9297 第 3.2 节</a> 的说明</span>。<a href="#section-3.5-2.2"
                                class="pilcrow">¶</a>
                        </li>
                    </ul>
                    <p id="section-3.5-3">如果未满足这些要求，客户端 <span class="bcp14">MUST</span> 将此代理尝试视为失败并中止请求。<a
                            href="#section-3.5-3" class="pilcrow">¶</a></p>
                    <p id="section-3.5-4">例如，UDP 代理可以响应如下：<a href="#section-3.5-4" class="pilcrow">¶</a></p>
                    <span id="name-example-http-2-response"></span>
                    <div id="fig-resp-h2">
                        <figure id="figure-6">
                            <div id="section-3.5-5.1">
                                <pre class="lang-http-message sourcecode">
HEADERS
:status = 200
capsule-protocol = ?1
</pre>
                            </div>
                            <figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
                                <a href="#name-example-http-2-response" class="selfRef">HTTP/2 响应示例</a>
                            </figcaption>
                        </figure>
                    </div>
                </section>
            </div>
        </section>
    </div>
    <div id="context-id">
        <section id="section-4">
            <h2 id="name-context-identifiers">
                <a href="#section-4" class="section-number selfRef">4. </a><a href="#name-context-identifiers"
                    class="section-name selfRef">上下文标识符</a>
            </h2>
            <p id="section-4-1">本文件定义的在 HTTP 中代理 UDP 的机制允许未来扩展交换携带与 UDP 有别语义的 HTTP 数据报。这些扩展有的可以为 UDP 有效载荷增加附加数据，有的可以交换与
                UDP 有效载荷完全独立的数据。为实现此目的，所有与 UDP 代理请求流相关的 HTTP 数据报都以 Context ID 字段开头；参见 <a href="#format" class="xref">第 5
                    节</a>。<a href="#section-4-1" class="pilcrow">¶</a></p>
            <p id="section-4-2">Context ID 为 62 位整数（0 到 2<sup>62</sup>-1）。Context ID 以可变长度整数编码；参见 <span><a
                        href="https://www.rfc-editor.org/rfc/rfc9000#section-16" class="relref">RFC9000 第 16
                        节</a></span>。值 0 的 Context ID 为 UDP 有效载荷保留，非零值为动态分配。非零的偶数 Context ID 由客户端分配，奇数 Context ID
                由代理分配。Context ID 的命名空间绑定到给定的 HTTP 请求；在不同请求中可以同时分配相同数值的 Context ID，且可能具有不同语义。Context ID <span
                    class="bcp14">MUST NOT</span> 在给定的 HTTP 命名空间内被重新分配，但 <span class="bcp14">MAY</span> 以任意顺序分配。对偶数和奇数
                Context ID 的分配限制存在以避免端点之间需要同步。然而，一旦分配了 Context ID，这些限制不再适用于该 Context ID 的使用；任何客户端或 UDP
                代理均可使用它，无论最初由哪一端分配。<a href="#section-4-2" class="pilcrow">¶</a></p>
            <p id="section-4-3">注册是端点将给定 Context ID 的语义和格式告知其对端的动作。本文档不定义注册如何发生。未来的扩展 <span class="bcp14">MAY</span> 使用
                HTTP 头字段或 capsule 来注册 Context ID。根据所使用的方法，可能会出现带有尚未注册的 Context ID
                的数据报被接收的情况。例如，这可能由于承载数据报的分组与承载注册消息的分组在传输过程中发生重排序导致。<a href="#section-4-3" class="pilcrow">¶</a></p>
        </section>
    </div>
    <div id="format">
        <section id="section-5">
            <h2 id="name-http-datagram-payload-forma">
                <a href="#section-5" class="section-number selfRef">5. </a><a href="#name-http-datagram-payload-forma"
                    class="section-name selfRef">HTTP 数据报负载格式</a>
            </h2>
            <p id="section-5-1">当 HTTP 数据报（参见 <span><a href="https://www.rfc-editor.org/rfc/rfc9297#section-2"
                        class="relref">RFC9297 第 2 节</a></span>）与 UDP 代理请求流相关联时，
                HTTP Datagram Payload 字段具有在 <a href="#dgram-format" class="xref">图 7</a> 中定义的格式，使用 <span><a
                        href="https://www.rfc-editor.org/rfc/rfc9000#section-1.3" class="relref">RFC9000 第 1.3
                        节</a></span> 的记法。注意，当 HTTP 数据报使用 QUIC DATAGRAM 帧 <span>[<a href="#RFC9221"
                        class="xref">QUIC-DGRAM</a>]</span> 编码时，下述 Context ID 字段直接跟在 Quarter Stream ID 字段之后，而 Quarter
                Stream ID 位于 QUIC DATAGRAM 帧负载的开始；参见 <span><a href="https://www.rfc-editor.org/rfc/rfc9297#section-2.1"
                        class="relref">RFC9297 第 2.1 节</a></span>。<a href="#section-5-1" class="pilcrow">¶</a>
            </p>
            <span id="name-udp-proxying-http-datagram-"></span>
            <div id="dgram-format">
                <figure id="figure-7">
                    <div class="alignLeft art-ascii-art art-text artwork" id="section-5-2.1">
                        <pre>
UDP Proxying HTTP Datagram Payload {
  Context ID (i),
  UDP Proxying Payload (..),
}
</pre>
                    </div>
                    <figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
                        <a href="#name-udp-proxying-http-datagram-" class="selfRef">UDP 代理 HTTP 数据报格式</a>
                    </figcaption>
                </figure>
            </div>
            <span class="break"></span>
            <dl class="dlCompact dlParallel" id="section-5-3">
                <dt id="section-5-3.1">Context ID:</dt>
                <dd style="margin-left: 1.5em" id="section-5-3.2">
                    <p id="section-5-3.2.1">一个可变长度整数（参见 <span><a
                                href="https://www.rfc-editor.org/rfc/rfc9000#section-16" class="relref">RFC9000 第 16
                                节</a>
                            的说明</span>），包含 Context ID 的数值。如果接收到携带未知 Context ID 的 HTTP/3 数据报，接收方 <span
                            class="bcp14">SHALL</span> 要么静默丢弃该数据报，要么在等待相应 Context ID 注册期间暂时缓冲该数据报（大约一个往返时间量级）。<a
                            href="#section-5-3.2.1" class="pilcrow">¶</a></p>
                </dd>
                <dd class="break"></dd>
                <dt id="section-5-3.3">UDP Proxying Payload:</dt>
                <dd style="margin-left: 1.5em" id="section-5-3.4">
                    <p id="section-5-3.4.1">数据报的有效载荷，其语义取决于前一字段的值。注意该字段可以为空。<a href="#section-5-3.4.1"
                            class="pilcrow">¶</a></p>
                </dd>
                <dd class="break"></dd>
            </dl>
            <p id="section-5-4">使用 Context ID 为零的 HTTP 数据报对 UDP 数据包进行编码。当 Context ID 字段为零时，UDP Proxying Payload 字段包含 UDP
                数据包的未修改有效载荷（在 <span>[<a href="#RFC0768" class="xref">UDP</a>]</span> 中称为数据八位组）。<a href="#section-5-4"
                    class="pilcrow">¶</a>
            </p>
            <p id="section-5-5">由于 UDP 头的定义（参见 <span>[<a href="#RFC0768" class="xref">UDP</a>]</span>），无法编码超过 65527 字节的
                UDP 有效载荷。因此，端点 <span class="bcp14">MUST NOT</span> 发送 UDP Proxying Payload 字段长度超过 65527 的使用 Context ID
                为零的 HTTP 数据报。接收到使用 Context ID 为零且 UDP Proxying Payload 字段长度超过 65527 的 HTTP 数据报的端点 <span
                    class="bcp14">MUST</span> 中止对应的流。如果 UDP 代理知道由于其底层链路 MTU 限制只能发送特定长度的 UDP 包，那么它别无选择，只能丢弃那些 UDP
                Proxying Payload 字段长度超过该限制的传入 HTTP 数据报。如果被丢弃的 HTTP 数据报是由 DATAGRAM capsule 传输的，接收方 <span
                    class="bcp14">SHOULD</span> 在不缓冲该 capsule 内容的情况下丢弃该 capsule。<a href="#section-5-5"
                    class="pilcrow">¶</a></p>
            <p id="section-5-6">如果 UDP 代理在收到相应请求之前收到 HTTP 数据报，它 <span class="bcp14">SHALL</span> 要么静默丢弃该 HTTP
                数据报，要么在等待对应请求期间暂时缓冲它（大约一个往返时间量级）。<a href="#section-5-6" class="pilcrow">¶</a></p>
            <p id="section-5-7">注意，缓冲数据报（无论是因为尚未收到请求，还是因为 Context ID 尚未知）都会消耗资源。缓冲数据报的接收方 <span
                    class="bcp14">SHOULD</span> 应用缓冲限制以降低发生资源耗尽的风险。例如，接收方可以限制缓冲数据报的总数或按每流、每上下文或每连接累计缓冲数据报的大小。<a
                    href="#section-5-7" class="pilcrow">¶</a></p>
            <p id="section-5-8">客户端 <span class="bcp14">MAY</span> 在收到其 UDP 代理请求的响应之前，乐观地开始在 HTTP 数据报中发送 UDP
                数据包。然而，实现者应注意，如果代理对请求响应失败，或者代理在请求到达之前收到被代理的数据包并选择不进行缓冲，则这些被代理的数据包可能不会被 UDP 代理处理。<a href="#section-5-8"
                    class="pilcrow">¶</a></p>
        </section>
    </div>
    <div id="performance">
        <section id="section-6">
            <h2 id="name-performance-considerations">
                <a href="#section-6" class="section-number selfRef">6. </a><a href="#name-performance-considerations"
                    class="section-name selfRef">性能注意事项</a>
            </h2>
            <p id="section-6-1">突发性流量常常导致时间相关的分组丢失；反过来，这会导致在 UDP 上运行的协议的拥塞控制器做出次优反应。为避免这种情况，UDP 代理 <span
                    class="bcp14">SHOULD</span> 力求避免增加 UDP 流量的突发性；它们 <span class="bcp14">SHOULD NOT</span>
                为了增加批量处理而对数据包进行排队。<a href="#section-6-1" class="pilcrow">¶</a></p>
            <p id="section-6-2">当被代理的在 UDP 上运行的协议使用拥塞控制（例如 <span>[<a href="#RFC9000" class="xref">QUIC</a>]</span>）时，
                被代理流量至少会遭遇两个嵌套的拥塞控制器。底层的 HTTP 连接 <span class="bcp14">MUST NOT</span>
                在没有渠道外的、能够绝对确定内部流量已受拥塞控制的方式的情况下禁用拥塞控制。<a href="#section-6-2" class="pilcrow">¶</a></p>
            <p id="section-6-3">如果包含 UDP 代理请求流的连接上的客户端或 UDP 代理禁用了拥塞控制，则它 <span class="bcp14">MUST NOT</span> 在该连接上声明对
                ECN <span>[<a href="#RFC3168" class="xref">ECN</a>]</span> 的支持。也就是说，它 <span class="bcp14">MUST</span>
                将所有 IP 头标记为 Not-ECT。它 <span class="bcp14">MAY</span> 继续通过 QUIC 的 ACK_ECN 帧或 TCP 的 ECE 位报告 ECN
                反馈，因为对端可能并未禁用拥塞控制。<a href="#section-6-3" class="pilcrow">¶</a></p>
            <p id="section-6-4">当被代理的在 UDP 上运行的协议使用丢失恢复（例如 <span>[<a href="#RFC9000" class="xref">QUIC</a>]</span>），且底层
                HTTP 连接运行在 TCP 之上时，被代理流量将至少遭遇两层嵌套的丢失恢复机制。这可能会降低性能，因为两者有时可能独立地重传相同数据。为避免此情况，UDP 代理 <span
                    class="bcp14">SHOULD</span> 在 HTTP/3 上执行，以便利用 QUIC DATAGRAM 帧。<a href="#section-6-4"
                    class="pilcrow">¶</a></p>
            <div id="mtu-considerations">
                <section id="section-6.1">
                    <h3 id="name-mtu-considerations">
                        <a href="#section-6.1" class="section-number selfRef">6.1. </a><a
                            href="#name-mtu-considerations" class="section-name selfRef">MTU 注意事项</a>
                    </h3>
                    <p id="section-6.1-1">当在带有 QUIC Datagram 扩展 <span>[<a href="#RFC9221"
                                class="xref">QUIC-DGRAM</a>]</span> 的 HTTP/3 中使用时，UDP 有效载荷在 QUIC DATAGRAM
                        帧中传输。由于这些帧不能分片，它们只能承载由 QUIC 连接配置和路径 MTU (PMTU) 决定的最大长度的有效载荷。如果 UDP 代理在使用 QUIC DATAGRAM
                        帧并且从目标接收到的 UDP 有效载荷无法放入 QUIC DATAGRAM 帧中，则 UDP 代理 <span class="bcp14">SHOULD NOT</span> 在
                        DATAGRAM capsule 中发送该 UDP 有效载荷，因为这会破坏像 DPLPMTUD 之类的方法所依赖的端到端不可靠性特性 <span>[<a href="#RFC8899"
                                class="xref">DPLPMTUD</a>]</span>。在此场景下，UDP 代理 <span class="bcp14">SHOULD</span> 丢弃该 UDP
                        有效载荷并向目标发送 ICMP Packet Too Big 消息；参见 <span><a
                                href="https://www.rfc-editor.org/rfc/rfc4443#section-3.2" class="relref">ICMP6 第 3.2
                                节</a></span>。<a href="#section-6.1-1" class="pilcrow">¶</a>
                    </p>
                </section>
            </div>
            <div id="tunneling-of-ecn-marks">
                <section id="section-6.2">
                    <h3 id="name-tunneling-of-ecn-marks">
                        <a href="#section-6.2" class="section-number selfRef">6.2. </a><a
                            href="#name-tunneling-of-ecn-marks" class="section-name selfRef">ECN 标记的隧道传递</a>
                    </h3>
                    <p id="section-6.2-1">UDP 代理并不创建 IP-in-IP 隧道，因此 <span>[<a href="#RFC6040"
                                class="xref">ECN-TUNNEL</a>]</span> 中关于在内外 IP 头之间传递 ECN 标记的指导不适用。UDP 代理隧道中不存在内层 IP 头。<a
                            href="#section-6.2-1" class="pilcrow">¶</a>
                    </p>
                    <p id="section-6.2-2">在本规范中请注意，UDP 代理客户端无法控制 UDP 代理发送到目标的 UDP 包的 ECN 代码点，并且 UDP 代理也无法向客户端通报每个来自目标的
                        UDP 包的标记情况。<a href="#section-6.2-2" class="pilcrow">¶</a></p>
                    <p id="section-6.2-3">UDP 代理 <span class="bcp14">MUST</span> 忽略从目标接收的 UDP 包的 IP 头中的 ECN 位，并且在其发送到目标的
                        UDP 包上 <span class="bcp14">MUST</span> 将 ECN 位设置为 Not-ECT。这些与客户端与 UDP 代理之间发送的数据包的 ECN 标记无关。<a
                            href="#section-6.2-3" class="pilcrow">¶</a></p>
                </section>
            </div>
        </section>
    </div>
    <div id="security">
        <section id="section-7">
            <h2 id="name-security-considerations">
                <a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations"
                    class="section-name selfRef">安全性考虑</a>
            </h2>
            <p id="section-7-1">允许任意客户端建立到任意目标的隧道存在重大风险，因为这可能允许不法分子发送流量并使其归因于 UDP 代理。支持 UDP 代理的 HTTP
                服务器应限制其使用，仅允许经过认证的用户使用。<a href="#section-7-1" class="pilcrow">¶</a></p>
            <p id="section-7-2">存在基于传入请求源 IP 地址执行访问控制检查的软件和网络部署。例如，某些软件若来自 127.0.0.1 则允许未认证的配置更改。此类软件可能运行在与 UDP
                代理相同的主机上或同一广播域中。被代理的 UDP 流量将以来自 UDP 代理的源 IP 地址到达目标。如果该源地址被用于访问控制，UDP 代理客户端可能利用 UDP
                代理提升其访问权限，超出其原本应有的权限。除非 UDP 代理禁止对易受攻击的目标（例如 UDP 代理自身的地址、本地主机、链路本地、多播和广播地址）进行 UDP 代理请求，否则这可能导致未经授权的访问。UDP
                代理在拒绝此类请求时可以使用来自 <span><a href="https://www.rfc-editor.org/rfc/rfc9209#section-2.3.5"
                        class="relref">PROXY-STATUS 第 2.3.5 节</a></span> 的 destination_ip_prohibited 代理错误类型。<a
                    href="#section-7-2" class="pilcrow">¶</a></p>
            <p id="section-7-3">在将其作为滥用基础设施以支持拒绝服务（DoS）攻击时，UDP 代理与 TCP CONNECT
                代理具有许多相似性。两者都可以隐藏攻击者的源地址不被攻击目标看到。在无状态的大量流量攻击（例如 TCP SYN 洪泛或 UDP 洪泛）中，两种类型的代理都会将流量传递给目标。对于通过 TCP CONNECT
                代理发送的有状态大量流量攻击（例如 HTTP 洪泛），代理仅在目标通过 TCP SYN-ACK 表示愿意接收数据时才会发送数据。一旦到目标的路径被洪泛，TCP CONNECT
                代理将不再接收来自目标的回复并停止发送数据。由于 UDP 不在 UDP 代理与目标之间建立共享状态，UDP 代理在此类情况下可能会继续向目标发送数据。虽然 UDP
                代理可以在观察到来自目标的响应之前限制其愿意转发的 UDP 包数，但当攻击目标为会响应的开放 UDP 端口时，这对防止 DoS 攻击的保护有限，因为协议的响应会被解释为目标愿意接收
                UDP，且此类数据包限制也可能对合法流量产生问题。<a href="#section-7-3" class="pilcrow">¶</a></p>
            <p id="section-7-4">适用于 <span><a href="https://www.rfc-editor.org/rfc/rfc9297#section-4"
                        class="relref">RFC9297 第 4 节</a></span> 中所描述的 HTTP 数据报的安全性考虑也适用于此处。由于可通过 UDP 隧道传输 IP
                分组，<span>[<a href="#RFC6169" class="xref">TUNNEL-SECURITY</a>]</span> 中的指导也可能适用。<a href="#section-7-4"
                    class="pilcrow">¶</a>
            </p>
        </section>
    </div>
    <div id="iana">
        <section id="section-8">
            <h2 id="name-iana-considerations">
                <a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations"
                    class="section-name selfRef">IANA 考量</a>
            </h2>
            <div id="iana-upgrade">
                <section id="section-8.1">
                    <h3 id="name-http-upgrade-token">
                        <a href="#section-8.1" class="section-number selfRef">8.1. </a><a
                            href="#name-http-upgrade-token" class="section-name selfRef">HTTP Upgrade 令牌</a>
                    </h3>
                    <p id="section-8.1-1">IANA 已在维护的 “HTTP Upgrade Tokens” 注册表中注册了 "connect-udp" 一项，地址为 &lt;<span><a
                                href="https://www.iana.org/assignments/http-upgrade-tokens">https://www.iana.org/assignments/http-upgrade-tokens</a></span>&gt;。<a
                            href="#section-8.1-1" class="pilcrow">¶</a></p>
                    <span class="break"></span>
                    <dl class="dlCompact dlParallel" id="section-8.1-2">
                        <dt id="section-8.1-2.1">Value:</dt>
                        <dd style="margin-left: 1.5em" id="section-8.1-2.2">
                            <p id="section-8.1-2.2.1">connect-udp<a href="#section-8.1-2.2.1" class="pilcrow">¶</a></p>
                        </dd>
                        <dd class="break"></dd>
                        <dt id="section-8.1-2.3">Description:</dt>
                        <dd style="margin-left: 1.5em" id="section-8.1-2.4">
                            <p id="section-8.1-2.4.1">UDP 有效载荷的代理化<a href="#section-8.1-2.4.1" class="pilcrow">¶</a></p>
                        </dd>
                        <dd class="break"></dd>
                        <dt id="section-8.1-2.5">Expected Version Tokens:</dt>
                        <dd style="margin-left: 1.5em" id="section-8.1-2.6">
                            <p id="section-8.1-2.6.1">None<a href="#section-8.1-2.6.1" class="pilcrow">¶</a></p>
                        </dd>
                        <dd class="break"></dd>
                        <dt id="section-8.1-2.7">Reference:</dt>
                        <dd style="margin-left: 1.5em" id="section-8.1-2.8">
                            <p id="section-8.1-2.8.1">RFC 9298<a href="#section-8.1-2.8.1" class="pilcrow">¶</a></p>
                        </dd>
                        <dd class="break"></dd>
                    </dl>
                </section>
            </div>
            <div id="iana-uri">
                <section id="section-8.2">
                    <h3 id="name-well-known-uri">
                        <a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-well-known-uri"
                            class="section-name selfRef">Well-Known URI</a>
                    </h3>
                    <p id="section-8.2-1">IANA 已在维护的 “Well-Known URIs” 注册表中注册了 "masque"，地址为 &lt;<span><a
                                href="https://www.iana.org/assignments/well-known-uris">https://www.iana.org/assignments/well-known-uris</a></span>&gt;。<a
                            href="#section-8.2-1" class="pilcrow">¶</a></p>
                    <span class="break"></span>
                    <dl class="dlCompact dlParallel" id="section-8.2-2">
                        <dt id="section-8.2-2.1">URI Suffix:</dt>
                        <dd style="margin-left: 1.5em" id="section-8.2-2.2">
                            <p id="section-8.2-2.2.1">masque<a href="#section-8.2-2.2.1" class="pilcrow">¶</a></p>
                        </dd>
                        <dd class="break"></dd>
                        <dt id="section-8.2-2.3">Change Controller:</dt>
                        <dd style="margin-left: 1.5em" id="section-8.2-2.4">
                            <p id="section-8.2-2.4.1">IETF<a href="#section-8.2-2.4.1" class="pilcrow">¶</a></p>
                        </dd>
                        <dd class="break"></dd>
                        <dt id="section-8.2-2.5">Reference:</dt>
                        <dd style="margin-left: 1.5em" id="section-8.2-2.6">
                            <p id="section-8.2-2.6.1">RFC 9298<a href="#section-8.2-2.6.1" class="pilcrow">¶</a></p>
                        </dd>
                        <dd class="break"></dd>
                        <dt id="section-8.2-2.7">Status:</dt>
                        <dd style="margin-left: 1.5em" id="section-8.2-2.8">
                            <p id="section-8.2-2.8.1">permanent<a href="#section-8.2-2.8.1" class="pilcrow">¶</a></p>
                        </dd>
                        <dd class="break"></dd>
                        <dt id="section-8.2-2.9">Related Information:</dt>
                        <dd style="margin-left: 1.5em" id="section-8.2-2.10">
                            <p id="section-8.2-2.10.1">包含所有以路径前缀 "/.well-known/masque/udp/" 标识的资源<a
                                    href="#section-8.2-2.10.1" class="pilcrow">¶</a></p>
                        </dd>
                        <dd class="break"></dd>
                    </dl>
                </section>
            </div>
        </section>
    </div>
    <section id="section-9">
        <h2 id="name-references">
            <a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references"
                class="section-name selfRef">参考文献</a>
        </h2>
        <section id="section-9.1">
            <h3 id="name-normative-references">
                <a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references"
                    class="section-name selfRef">规范性参考文献</a>
            </h3>
            <dl class="references">
                <dt id="RFC2234">[ABNF]</dt>
                <dd>
                    <span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span
                        class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span
                        class="seriesInfo">RFC 2234</span>, <span class="seriesInfo">DOI 10.17487/RFC2234</span>, <time
                        datetime="1997-11" class="refDate">1997 年 11 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc2234">https://www.rfc-editor.org/info/rfc2234</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC3168">[ECN]</dt>
                <dd>
                    <span class="refAuthor">Ramakrishnan, K.</span>, <span class="refAuthor">Floyd, S.</span>, and <span
                        class="refAuthor">D. Black</span>, <span class="refTitle">"The Addition of Explicit Congestion
                        Notification (ECN) to IP"</span>, <span class="seriesInfo">RFC 3168</span>, <span
                        class="seriesInfo">DOI 10.17487/RFC3168</span>, <time datetime="2001-09" class="refDate">2001 年
                        9 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc3168">https://www.rfc-editor.org/info/rfc3168</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC8441">[EXT-CONNECT2]</dt>
                <dd>
                    <span class="refAuthor">McManus, P.</span>, <span class="refTitle">"Bootstrapping WebSockets with
                        HTTP/2"</span>, <span class="seriesInfo">RFC 8441</span>, <span class="seriesInfo">DOI
                        10.17487/RFC8441</span>, <time datetime="2018-09" class="refDate">2018 年 9 月</time>,
                    <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc8441">https://www.rfc-editor.org/info/rfc8441</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC9220">[EXT-CONNECT3]</dt>
                <dd>
                    <span class="refAuthor">Hamilton, R.</span>, <span class="refTitle">"Bootstrapping WebSockets with
                        HTTP/3"</span>, <span class="seriesInfo">RFC 9220</span>, <span class="seriesInfo">DOI
                        10.17487/RFC9220</span>, <time datetime="2022-06" class="refDate">2022 年 6 月</time>,
                    <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc9220">https://www.rfc-editor.org/info/rfc9220</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC9110">[HTTP]</dt>
                <dd>
                    <span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M.,
                        Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP
                        Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC
                        9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06"
                        class="refDate">2022 年 6 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC9297">[HTTP-DGRAM]</dt>
                <dd>
                    <span class="refAuthor">Schinazi, D.</span> and <span class="refAuthor">L. Pardue</span>, <span
                        class="refTitle">"HTTP Datagrams and the Capsule Protocol"</span>, <span class="seriesInfo">RFC
                        9297</span>, <span class="seriesInfo">DOI 10.17487/RFC9297</span>, <time datetime="2022-08"
                        class="refDate">2022 年 8 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc9297">https://www.rfc-editor.org/info/rfc9297</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC9112">[HTTP/1.1]</dt>
                <dd>
                    <span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M.,
                        Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span
                        class="refTitle">"HTTP/1.1"</span>, <span class="seriesInfo">STD 99</span>, <span
                        class="seriesInfo">RFC 9112</span>, <span class="seriesInfo">DOI 10.17487/RFC9112</span>, <time
                        datetime="2022-06" class="refDate">2022 年 6 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc9112">https://www.rfc-editor.org/info/rfc9112</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC9113">[HTTP/2]</dt>
                <dd>
                    <span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">C. Benfield, Ed.</span>,
                    <span class="refTitle">"HTTP/2"</span>, <span class="seriesInfo">RFC 9113</span>, <span
                        class="seriesInfo">DOI 10.17487/RFC9113</span>, <time datetime="2022-06" class="refDate">2022 年
                        6 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc9113">https://www.rfc-editor.org/info/rfc9113</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC9114">[HTTP/3]</dt>
                <dd>
                    <span class="refAuthor">Bishop, M., Ed.</span>, <span class="refTitle">"HTTP/3"</span>, <span
                        class="seriesInfo">RFC 9114</span>, <span class="seriesInfo">DOI 10.17487/RFC9114</span>, <time
                        datetime="2022-06" class="refDate">2022 年 6 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc9114">https://www.rfc-editor.org/info/rfc9114</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC9209">[PROXY-STATUS]</dt>
                <dd>
                    <span class="refAuthor">Nottingham, M.</span> and <span class="refAuthor">P. Sikora</span>, <span
                        class="refTitle">"The Proxy-Status HTTP Response Header Field"</span>, <span
                        class="seriesInfo">RFC 9209</span>, <span class="seriesInfo">DOI 10.17487/RFC9209</span>, <time
                        datetime="2022-06" class="refDate">2022 年 6 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc9209">https://www.rfc-editor.org/info/rfc9209</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC9000">[QUIC]</dt>
                <dd>
                    <span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>,
                    <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span
                        class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time
                        datetime="2021-05" class="refDate">2021 年 5 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc9000">https://www.rfc-editor.org/info/rfc9000</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC9221">[QUIC-DGRAM]</dt>
                <dd>
                    <span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Kinnear, E.</span>, and <span
                        class="refAuthor">D. Schinazi</span>, <span class="refTitle">"An Unreliable Datagram Extension
                        to QUIC"</span>, <span class="seriesInfo">RFC 9221</span>, <span class="seriesInfo">DOI
                        10.17487/RFC9221</span>, <time datetime="2022-03" class="refDate">2022 年 3 月</time>,
                    <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc9221">https://www.rfc-editor.org/info/rfc9221</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC2119">[RFC2119]</dt>
                <dd>
                    <span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to
                        Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span
                        class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time
                        datetime="1997-03" class="refDate">1997 年 3 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC8174">[RFC8174]</dt>
                <dd>
                    <span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs
                        Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span
                        class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time
                        datetime="2017-05" class="refDate">2017 年 5 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC9293">[TCP]</dt>
                <dd>
                    <span class="refAuthor">Eddy, W., Ed.</span>, <span class="refTitle">"Transmission Control Protocol
                        (TCP)"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 9293</span>,
                    <span class="seriesInfo">DOI 10.17487/RFC9293</span>, <time datetime="2022-08" class="refDate">2022
                        年 8 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc9293">https://www.rfc-editor.org/info/rfc9293</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC6570">[TEMPLATE]</dt>
                <dd>
                    <span class="refAuthor">Gregorio, J.</span>, <span class="refAuthor">Fielding, R.</span>, <span
                        class="refAuthor">Hadley, M.</span>, <span class="refAuthor">Nottingham, M.</span>, and <span
                        class="refAuthor">D. Orchard</span>, <span class="refTitle">"URI Template"</span>, <span
                        class="seriesInfo">RFC 6570</span>, <span class="seriesInfo">DOI 10.17487/RFC6570</span>, <time
                        datetime="2012-03" class="refDate">2012 年 3 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc6570">https://www.rfc-editor.org/info/rfc6570</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC0768">[UDP]</dt>
                <dd>
                    <span class="refAuthor">Postel, J.</span>, <span class="refTitle">"User Datagram Protocol"</span>,
                    <span class="seriesInfo">STD 6</span>, <span class="seriesInfo">RFC 768</span>, <span
                        class="seriesInfo">DOI 10.17487/RFC0768</span>, <time datetime="1980-08" class="refDate">1980 年
                        8 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc768">https://www.rfc-editor.org/info/rfc768</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC3986">[URI]</dt>
                <dd>
                    <span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and
                    <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier
                        (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span
                        class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time
                        datetime="2005-01" class="refDate">2005 年 1 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
            </dl>
        </section>
        <section id="section-9.2">
            <h3 id="name-informative-references">
                <a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references"
                    class="section-name selfRef">信息性参考文献</a>
            </h3>
            <dl class="references">
                <dt id="RFC4787">[BEHAVE]</dt>
                <dd>
                    <span class="refAuthor">Audet, F., Ed.</span> and <span class="refAuthor">C. Jennings</span>, <span
                        class="refTitle">"Network Address Translation (NAT) Behavioral Requirements for Unicast
                        UDP"</span>, <span class="seriesInfo">BCP 127</span>, <span class="seriesInfo">RFC 4787</span>,
                    <span class="seriesInfo">DOI 10.17487/RFC4787</span>, <time datetime="2007-01" class="refDate">2007
                        年 1 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc4787">https://www.rfc-editor.org/info/rfc4787</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC8899">[DPLPMTUD]</dt>
                <dd>
                    <span class="refAuthor">Fairhurst, G.</span>, <span class="refAuthor">Jones, T.</span>, <span
                        class="refAuthor">Tüxen, M.</span>, <span class="refAuthor">Rüngeler, I.</span>, and <span
                        class="refAuthor">T. Völker</span>, <span class="refTitle">"Packetization Layer Path MTU
                        Discovery for Datagram Transports"</span>, <span class="seriesInfo">RFC 8899</span>, <span
                        class="seriesInfo">DOI 10.17487/RFC8899</span>, <time datetime="2020-09" class="refDate">2020 年
                        9 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc8899">https://www.rfc-editor.org/info/rfc8899</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC6040">[ECN-TUNNEL]</dt>
                <dd>
                    <span class="refAuthor">Briscoe, B.</span>, <span class="refTitle">"Tunnelling of Explicit
                        Congestion Notification"</span>, <span class="seriesInfo">RFC 6040</span>, <span
                        class="seriesInfo">DOI 10.17487/RFC6040</span>, <time datetime="2010-11" class="refDate">2010 年
                        11 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc6040">https://www.rfc-editor.org/info/rfc6040</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="I-D.schwartz-httpbis-helium">[HELIUM]</dt>
                <dd>
                    <span class="refAuthor">Schwartz, B. M.</span>, <span class="refTitle">"Hybrid Encapsulation Layer
                        for IP and UDP Messages (HELIUM)"</span>, <span class="refContent">Work in Progress</span>,
                    <span class="seriesInfo">Internet-Draft, draft-schwartz-httpbis-helium-00</span>, <time
                        datetime="2018-06-25" class="refDate">2018 年 6 月 25 日</time>, <span>&lt;<a
                            href="https://datatracker.ietf.org/doc/html/draft-schwartz-httpbis-helium-00">https://datatracker.ietf.org/doc/html/draft-schwartz-httpbis-helium-00</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="I-D.pardue-httpbis-http-network-tunnelling">[HiNT]</dt>
                <dd>
                    <span class="refAuthor">Pardue, L.</span>, <span class="refTitle">"HTTP-initiated Network Tunnelling
                        (HiNT)"</span>, <span class="refContent">Work in Progress</span>, <span
                        class="seriesInfo">Internet-Draft, draft-pardue-httpbis-http-network-tunnelling-00</span>, <time
                        datetime="2018-07-02" class="refDate">2018 年 7 月 2 日</time>, <span>&lt;<a
                            href="https://datatracker.ietf.org/doc/html/draft-pardue-httpbis-http-network-tunnelling-00">https://datatracker.ietf.org/doc/html/draft-pardue-httpbis-http-network-tunnelling-00</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC4443">[ICMP6]</dt>
                <dd>
                    <span class="refAuthor">Conta, A.</span>, <span class="refAuthor">Deering, S.</span>, and <span
                        class="refAuthor">M. Gupta, Ed.</span>, <span class="refTitle">"Internet Control Message
                        Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"</span>, <span
                        class="seriesInfo">STD 89</span>, <span class="seriesInfo">RFC 4443</span>, <span
                        class="seriesInfo">DOI 10.17487/RFC4443</span>, <time datetime="2006-03" class="refDate">2006 年
                        3 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc4443">https://www.rfc-editor.org/info/rfc4443</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="I-D.schinazi-masque">[MASQUE-ORIGINAL]</dt>
                <dd>
                    <span class="refAuthor">Schinazi, D.</span>, <span class="refTitle">"The MASQUE Protocol"</span>,
                    <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft,
                        draft-schinazi-masque-00</span>, <time class="refDate" datetime="2019-02-28">2019 年 2 月 28
                        日</time>, <span>&lt;<a
                            href="https://datatracker.ietf.org/doc/html/draft-schinazi-masque-00">https://datatracker.ietf.org/doc/html/draft-schinazi-masque-00</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC6169">[TUNNEL-SECURITY]</dt>
                <dd>
                    <span class="refAuthor">Krishnan, S.</span>, <span class="refAuthor">Thaler, D.</span>, and <span
                        class="refAuthor">J. Hoagland</span>, <span class="refTitle">"Security Concerns with IP
                        Tunneling"</span>, <span class="seriesInfo">RFC 6169</span>, <span class="seriesInfo">DOI
                        10.17487/RFC6169</span>, <time datetime="2011-04" class="refDate">2011 年 4 月</time>,
                    <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc6169">https://www.rfc-editor.org/info/rfc6169</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC8085">[UDP-USAGE]</dt>
                <dd>
                    <span class="refAuthor">Eggert, L.</span>, <span class="refAuthor">Fairhurst, G.</span>, and <span
                        class="refAuthor">G. Shepherd</span>, <span class="refTitle">"UDP Usage Guidelines"</span>,
                    <span class="seriesInfo">BCP 145</span>, <span class="seriesInfo">RFC 8085</span>, <span
                        class="seriesInfo">DOI 10.17487/RFC8085</span>, <time datetime="2017-03" class="refDate">2017 年
                        3 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc8085">https://www.rfc-editor.org/info/rfc8085</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
                <dt id="RFC6455">[WEBSOCKET]</dt>
                <dd>
                    <span class="refAuthor">Fette, I.</span> and <span class="refAuthor">A. Melnikov</span>, <span
                        class="refTitle">"The WebSocket Protocol"</span>, <span class="seriesInfo">RFC 6455</span>,
                    <span class="seriesInfo">DOI 10.17487/RFC6455</span>, <time datetime="2011-12" class="refDate">2011
                        年 12 月</time>, <span>&lt;<a
                            href="https://www.rfc-editor.org/info/rfc6455">https://www.rfc-editor.org/info/rfc6455</a>&gt;</span>.
                </dd>
                <dd class="break"></dd>
            </dl>
        </section>
    </section>
    <div id="acknowledgments">
        <section id="appendix-A">
            <h2 id="name-acknowledgments">
                <a href="#name-acknowledgments" class="section-name selfRef">致谢</a>
            </h2>
            <p id="appendix-A-1">本文档为 MASQUE 工作组的产物，作者感谢所有 MASQUE 愛好者的贡献。该提案直接或间接地受许多人的先前工作启发，特别是 <span>[<a
                        href="#I-D.schwartz-httpbis-helium" class="xref">HELIUM</a>]</span>（作者 Ben Schwartz）、<span>[<a
                        href="#I-D.pardue-httpbis-http-network-tunnelling" class="xref">HiNT</a>]</span>（作者 Lucas
                Pardue）以及作者本人最初的 MASQUE 协议草案 <span>[<a href="#I-D.schinazi-masque"
                        class="xref">MASQUE-ORIGINAL</a>]</span>。<a href="#appendix-A-1" class="pilcrow">¶</a></p>
            <p id="appendix-A-2">作者感谢 <span class="contact-name">Eric Rescorla</span> 建议使用 HTTP 方法来代理 UDP。作者还感谢 <span
                    class="contact-name">Mark Nottingham</span> 和 <span class="contact-name">Lucas Pardue</span>
                对本文档的诸多改进。本文档中的可扩展性设计源自 HTTP 数据报设计团队，该团队成员包括 <span class="contact-name">Alan Frindell</span>、<span
                    class="contact-name">Alex Chernyakhovsky</span>、<span class="contact-name">Ben Schwartz</span>、<span
                    class="contact-name">Eric Rescorla</span>、<span class="contact-name">Lucas Pardue</span>、<span
                    class="contact-name">Marcus Ihlar</span>、<span class="contact-name">Martin Thomson</span>、<span
                    class="contact-name">Mike Bishop</span>、<span class="contact-name">Tommy Pauly</span>、<span
                    class="contact-name">Victor Vasiliev</span> 以及本文档作者。<a href="#appendix-A-2" class="pilcrow">¶</a>
            </p>
        </section>
    </div>
    <div id="authors-addresses">
        <section id="appendix-B">
            <h2 id="name-authors-address">
                <a href="#name-authors-address" class="section-name selfRef">作者联系方式</a>
            </h2>
            <address class="vcard">
                <div dir="auto" class="left"><span class="fn nameRole">David Schinazi</span></div>
                <div dir="auto" class="left"><span class="org">Google LLC</span></div>
                <div dir="auto" class="left"><span class="street-address">1600 Amphitheatre Parkway</span></div>
                <div dir="auto" class="left">
                    <span class="locality">Mountain View</span>, <span class="region">CA</span> <span
                        class="postal-code">94043</span>
                </div>
                <div dir="auto" class="left"><span class="country-name">United States of America</span></div>
                <div class="email">
                    <span>Email:</span>
                    <a href="mailto:dschinazi.ietf@gmail.com" class="email">dschinazi.ietf@gmail.com</a>
                </div>
            </address>
        </section>
    </div>
    <script>const toc = document.getElementById("toc");
        toc.querySelector("h2").addEventListener("click", e => {
            toc.classList.toggle("active");
        });
        toc.querySelector("nav").addEventListener("click", e => {
            toc.classList.remove("active");
        });
    </script>
    <script src="https://htmlspecs.com/dropdown.js"></script>
</body>

</html>