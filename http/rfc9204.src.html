<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>RFC 9204 - QPACK: Field Compression for HTTP/3</title>
    <script>
        function getMeta(rfcno, container) {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "https://www.rfc-editor.org/rfc/rfc" + rfcno + ".json", true);
            xhr.onload = function (e) {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        var data = JSON.parse(xhr.response);

                        var cont = document.getElementById(container);
                        // empty the container
                        while (cont.firstChild) {
                            cont.removeChild(myNode.firstChild);
                        }

                        var c = data.status;
                        if (c) {
                            var bld = newElementWithText("b", c);
                            cont.appendChild(bld);
                        } else {
                            cont.appendChild(newElementWithText("i", "(document status unknown)"));
                        }

                        c = data.updated_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Updated by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.obsoleted_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Obsoleted by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.errata_url;
                        if (c) {
                            cont.appendChild(newElement("br"));
                            var link = newElementWithText("a", "errata");
                            link.setAttribute("href", c);
                            var errata = newElementWithText("i", "This document has ");
                            errata.appendChild(link);
                            errata.appendChild(newText("."));
                            cont.appendChild(errata);
                        }

                        cont.style.display = "block";
                    } else {
                        console.error(xhr.statusText);
                    }
                }
            };
            xhr.onerror = function (e) {
                console.error(xhr.status + " " + xhr.statusText);
            };
            xhr.send(null);
        }
        function appendRfcLinks(parent, updates) {
            var template = "https://www.rfc-editor.org/rfc/rfc{rfc}.html";
            for (var i = 0; i < updates.length; i++) {
                var rfc = updates[i].trim().toLowerCase();
                if (rfc.substring(0, 3) == "rfc") {
                    var no = parseInt(rfc.substring(3), 10);

                    var link = newElement("a");
                    link.setAttribute("href", template.replace("{rfc}", no));
                    link.appendChild(newText(no));
                    parent.appendChild(link);
                } else {
                    parent.appendChild(newText(rfc));
                }
                if (i != updates.length - 1) {
                    parent.appendChild(newText(", "));
                }
            }
        }

        // DOM helpers
        function newElement(name) {
            return document.createElement(name);
        }
        function newElementWithText(name, txt) {
            var e = document.createElement(name);
            e.appendChild(newText(txt));
            return e;
        }
        function newText(text) {
            return document.createTextNode(text);
        }
    </script>
    <script>
        function anchorRewrite() {
            map = {};
            if (window.location.hash.length >= 1) {
                var fragid = window.location.hash.substr(1);
                if (fragid) {
                    if (!document.getElementById(fragid)) {
                        var prefix = "rfc.";
                        var mapped = map[fragid];
                        if (mapped) {
                            window.location.hash = mapped;
                        } else if (fragid.indexOf("section-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(8).replace("-", ".p.");
                        } else if (fragid.indexOf("appendix-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(9).replace("-", ".p.");
                        } else if (fragid.indexOf("s-") == 0) {
                            var postfix = fragid.substring(2);
                            if (postfix.startsWith("abstract")) {
                                window.location.hash = prefix + postfix;
                            } else if (postfix.startsWith("note-")) {
                                window.location.hash = prefix + "note." + postfix.substring(5).replace("-", ".p.");
                            } else {
                                window.location.hash = prefix + "section." + postfix.replace("-", ".p.");
                            }
                        } else if (fragid.indexOf("p-") == 0) {
                            var r = fragid.substring(2);
                            var p = r.indexOf("-");
                            if (p >= 0) {
                                window.location.hash = prefix + "section." + r.substring(0, p) + ".p." + r.substring(p + 1);
                            }
                        }
                    }
                }
            }
        }
        window.addEventListener('hashchange', anchorRewrite);
        window.addEventListener('DOMContentLoaded', anchorRewrite);
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:type" content="article">
    <meta property="og:title" content="RFC9204">
    <meta property="og:description" content="QPACK: Field Compression for HTTP/3">
    <meta property="og:url" content="https://httpwg.org/specs/rfc9204.html">
    <meta property="og:site_name" content="IETF HTTP Working Group Specifications">
    <meta property="og:image" content="https://httpwg.org/assets/favicon/apple-icon-180x180.png">
    <link rel="stylesheet" type="text/css" href="/assets/node_modules/bootstrap/dist/css/bootstrap.min.css">
    <style type="text/css">
        body {
            padding-top: 80px;
            padding-bottom: 80px;
            position: relative;
        }

        .table.header th,
        .table.header td {
            border-top: none;
            padding: 0;
        }

        #sidebar {
            margin-top: -10px;
            height: 90%;
            overflow-y: auto;
            font-size: 90%;
        }

        #rfc\.meta {
            width: 40%;
            float: right
        }

        .toc ul {
            list-style: none;
        }

        .filename {
            color: rgb(119, 119, 119);
            font-size: 23px;
            font-weight: normal;
            height: auto;
            line-height: 23px;
        }

        dl {
            margin-left: 1em;
        }

        dl.dl-horizontal: {
            margin-left: 0;
        }

        dl>dt {
            float: left;
            margin-right: 1em;
        }

        dl.nohang>dt {
            float: none;
        }

        dl>dd {
            margin-bottom: .5em;
        }

        dl.compact>dd {
            margin-bottom: 0em;
        }

        dl>dd>dl {
            margin-top: 0.5em;
            margin-bottom: 0em;
        }

        ul.empty {
            list-style-type: none;
        }

        ul.empty li {
            margin-top: .5em;
        }

        td.reference {
            padding-right: 1em;
            vertical-align: top;
        }

        .feedback {
            position: fixed;
            bottom: 5px;
            right: 5px;
        }

        .fbbutton {
            margin-left: 5px;
        }

        h1 a,
        h2 a,
        h3 a,
        h4 a,
        h5 a,
        h6 a {
            color: rgb(51, 51, 51);
        }

        span.tt {
            font: 11pt consolas, monospace;
            font-size-adjust: none;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="/assets/site.css">
    <link rel="Contents" href="#rfc.toc">
    <link rel="Author" href="#rfc.authors">
    <link rel="License" href="#rfc.copyrightnotice">
    <link rel="Chapter" title="1 Introduction" href="#rfc.section.1">
    <link rel="Chapter" title="2 Compression Process Overview" href="#rfc.section.2">
    <link rel="Chapter" title="3 Reference Tables" href="#rfc.section.3">
    <link rel="Chapter" title="4 Wire Format" href="#rfc.section.4">
    <link rel="Chapter" title="5 Configuration" href="#rfc.section.5">
    <link rel="Chapter" title="6 Error Handling" href="#rfc.section.6">
    <link rel="Chapter" title="7 Security Considerations" href="#rfc.section.7">
    <link rel="Chapter" title="8 IANA Considerations" href="#rfc.section.8">
    <link rel="Chapter" title="9 References" href="#rfc.section.9">
    <link rel="Appendix" title="A Static Table" href="#rfc.section.A">
    <link rel="Appendix" title="B Encoding and Decoding Examples" href="#rfc.section.B">
    <link rel="Appendix" title="C Sample Single-Pass Encoding Algorithm" href="#rfc.section.C">
    <link rel="Appendix" title="Acknowledgments" href="#rfc.section.unnumbered-4">
    <link href="https://dx.doi.org/10.17487/rfc9204" rel="alternate">
    <link href="urn:issn:2070-1721" rel="alternate">
    <link href="https://datatracker.ietf.org/doc/draft-ietf-quic-qpack-latest" rel="prev">
    <link rel="Alternate" title="Plain Text Version" href="http://www.ietf.org/rfc/rfc9204.txt">
    <link rel="Help" title="RFC-Editor's Status Page" href="https://www.rfc-editor.org/info/rfc9204">
    <meta name="viewport" content="initial-scale=1">
    <meta name="generator"
        content="https://github.com/mnot/RFCBootstrap XSLT vendor: Saxonica http://www.saxonica.com/">
    <meta name="keywords" content="compression, HTTP/3, HPACK, header, field, trailer">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <meta name="dcterms.creator" content="Krasic, C.">
    <meta name="dcterms.creator" content="Bishop, M.">
    <meta name="dcterms.creator" content="Frindell, A.">
    <meta name="dcterms.identifier" content="urn:ietf:rfc:9204">
    <meta name="dcterms.issued" content="2022-06">
    <meta name="dcterms.abstract"
        content="This specification defines QPACK: a compression format for efficiently representing HTTP fields that is to be used in HTTP/3. This is a variation of HPACK compression that seeks to reduce head-of-line blocking.">
    <meta name="dcterms.isPartOf" content="urn:issn:2070-1721">
    <meta name="description"
        content="This specification defines QPACK: a compression format for efficiently representing HTTP fields that is to be used in HTTP/3. This is a variation of HPACK compression that seeks to reduce head-of-line blocking.">
</head>

<body onload="getMeta(9204,&#34;rfc.meta&#34;);">
    <nav class="navbar navbar-dark bg-dark d-print-none navbar-expand-lg fixed-top ps-3 pe-3" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse"
                aria-controls="navbarToggler" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <a class="navbar-brand" href="https://httpwg.org/"><img src="https://httpwg.org/assets/http.svg"
                    height="23"></a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse">

            <div class="navbar-nav me-auto">

                <a class="nav-item ms-1 text-white" href="https://httpwg.org/specs/">📄 Documentation</a>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Work in
                        Progress</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/http-extensions/">HTTP Extensions</a></li>
                        <li class="dropdown-item"><a
                                href="https://github.com/httpwg/admin/issues?q=is%3Aissue+is%3Aopen+label%3Aadoption">Future
                                Work</a></li>
                    </ul>
                </div>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Participate</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/about/">About the HTTP Working Group</a>
                        </li>
                        <li class="divider"></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/CONTRIBUTING.html">Contribution Policy</a>
                        </li>
                        <li class="dropdown-item"><a href="http://datatracker.ietf.org/wg/httpbis/charter/">WG
                                Charter</a></li>
                        <li class="dropdown-item"><a href="http://lists.w3.org/Archives/Public/ietf-http-wg/">Group
                                Mailing List 📨</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/wg-materials/">Meeting Materials</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/admin/editors/">Document Editor
                                Resources</a></li>
                    </ul>
                </div>
            </div>

        </div>
    </nav>
    <div class="container" id="top">
        <div class="row">
            <div class="col-lg-4 order-last d-none d-lg-block" id="sidebar" role="navigation">
                <div class="navbar">
                    <div class="navbar-brand"><a href="#top"><strong>RFC </strong>9204</a></div><br clear="all">
                    <div class="">
                        <div class="toc ">
                            <ul>
                                <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#introduction">Introduction</a>
                                    <ul>
                                        <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#conventions-and-definitions">Conventions and Definitions</a></li>
                                        <li><a href="#rfc.section.1.2">1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#notational-conventions">Notational Conventions</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#compression-process-overview">Compression Process Overview</a>
                                    <ul>
                                        <li><a href="#rfc.section.2.1">2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#encoder">Encoder</a>
                                            <ul>
                                                <li><a href="#rfc.section.2.1.1">2.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#blocked-insertion">Limits on Dynamic Table Insertions</a>
                                                </li>
                                                <li><a href="#rfc.section.2.1.2">2.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#blocked-streams">Blocked Streams</a></li>
                                                <li><a href="#rfc.section.2.1.3">2.1.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#avoiding-flow-control-deadlocks">Avoiding Flow-Control
                                                        Deadlocks</a></li>
                                                <li><a href="#rfc.section.2.1.4">2.1.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#known-received-count">Known Received Count</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.2.2">2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#decoder">Decoder</a>
                                            <ul>
                                                <li><a href="#rfc.section.2.2.1">2.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#blocked-decoding">Blocked Decoding</a></li>
                                                <li><a href="#rfc.section.2.2.2">2.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#state-synchronization">State Synchronization</a></li>
                                                <li><a href="#rfc.section.2.2.3">2.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#invalid-references">Invalid References</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#reference-tables">Reference Tables</a>
                                    <ul>
                                        <li><a href="#rfc.section.3.1">3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#header-table-static">Static Table</a></li>
                                        <li><a href="#rfc.section.3.2">3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#header-table-dynamic">Dynamic Table</a>
                                            <ul>
                                                <li><a href="#rfc.section.3.2.1">3.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#dynamic-table-size">Dynamic Table Size</a></li>
                                                <li><a href="#rfc.section.3.2.2">3.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#eviction">Dynamic Table Capacity and Eviction</a></li>
                                                <li><a href="#rfc.section.3.2.3">3.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#maximum-dynamic-table-capacity">Maximum Dynamic Table
                                                        Capacity</a></li>
                                                <li><a href="#rfc.section.3.2.4">3.2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#indexing">Absolute Indexing</a></li>
                                                <li><a href="#rfc.section.3.2.5">3.2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#relative-indexing">Relative Indexing</a></li>
                                                <li><a href="#rfc.section.3.2.6">3.2.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#post-base">Post-Base Indexing</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#wire-format">Wire
                                        Format</a>
                                    <ul>
                                        <li><a href="#rfc.section.4.1">4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#primitives">Primitives</a>
                                            <ul>
                                                <li><a href="#rfc.section.4.1.1">4.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#prefixed-integers">Prefixed Integers</a></li>
                                                <li><a href="#rfc.section.4.1.2">4.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#string-literals">String Literals</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.4.2">4.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#enc-dec-stream-def">Encoder and Decoder Streams</a></li>
                                        <li><a href="#rfc.section.4.3">4.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#encoder-instructions">Encoder Instructions</a>
                                            <ul>
                                                <li><a href="#rfc.section.4.3.1">4.3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#set-dynamic-capacity">Set Dynamic Table Capacity</a></li>
                                                <li><a href="#rfc.section.4.3.2">4.3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#insert-with-name-reference">Insert with Name
                                                        Reference</a></li>
                                                <li><a href="#rfc.section.4.3.3">4.3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#insert-with-literal-name">Insert with Literal Name</a>
                                                </li>
                                                <li><a href="#rfc.section.4.3.4">4.3.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#duplicate">Duplicate</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.4.4">4.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#decoder-instructions">Decoder Instructions</a>
                                            <ul>
                                                <li><a href="#rfc.section.4.4.1">4.4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#header-acknowledgment">Section Acknowledgment</a></li>
                                                <li><a href="#rfc.section.4.4.2">4.4.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#stream-cancellation">Stream Cancellation</a></li>
                                                <li><a href="#rfc.section.4.4.3">4.4.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#insert-count-increment">Insert Count Increment</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.4.5">4.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#field-line-representations">Field Line Representations</a>
                                            <ul>
                                                <li><a href="#rfc.section.4.5.1">4.5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#header-prefix">Encoded Field Section Prefix</a></li>
                                                <li><a href="#rfc.section.4.5.2">4.5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#indexed-field-line">Indexed Field Line</a></li>
                                                <li><a href="#rfc.section.4.5.3">4.5.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#indexed-field-line-with-post-base-index">Indexed Field
                                                        Line with Post-Base Index</a></li>
                                                <li><a href="#rfc.section.4.5.4">4.5.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#literal-name-reference">Literal Field Line with Name
                                                        Reference</a></li>
                                                <li><a href="#rfc.section.4.5.5">4.5.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#literal-field-line-with-post-base-name-reference">Literal
                                                        Field Line with Post-Base Name Reference</a></li>
                                                <li><a href="#rfc.section.4.5.6">4.5.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#literal-field-line-with-literal-name">Literal Field Line
                                                        with Literal Name</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#configuration">Configuration</a></li>
                                <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#error-handling">Error
                                        Handling</a></li>
                                <li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#security-considerations">Security Considerations</a>
                                    <ul>
                                        <li><a href="#rfc.section.7.1">7.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#probing-dynamic-table-state">Probing Dynamic Table State</a>
                                            <ul>
                                                <li><a href="#rfc.section.7.1.1">7.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#applicability-to-qpack-and-http">Applicability to QPACK
                                                        and HTTP</a></li>
                                                <li><a href="#rfc.section.7.1.2">7.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#mitigation">Mitigation</a></li>
                                                <li><a href="#rfc.section.7.1.3">7.1.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#never-indexed-literals">Never-Indexed Literals</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.7.2">7.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#static-huffman-encoding">Static Huffman Encoding</a></li>
                                        <li><a href="#rfc.section.7.3">7.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#memory-consumption">Memory Consumption</a></li>
                                        <li><a href="#rfc.section.7.4">7.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#implementation-limits">Implementation Limits</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.8">8.</a>&nbsp;&nbsp;&nbsp;<a href="#iana-considerations">IANA
                                        Considerations</a>
                                    <ul>
                                        <li><a href="#rfc.section.8.1">8.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#settings-registration">Settings Registration</a></li>
                                        <li><a href="#rfc.section.8.2">8.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#stream-type-registration">Stream Type Registration</a></li>
                                        <li><a href="#rfc.section.8.3">8.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#error-code-registration">Error Code Registration</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.9">9.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references">References</a>
                                    <ul>
                                        <li><a href="#rfc.section.9.1">9.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.2">Normative References</a></li>
                                        <li><a href="#rfc.section.9.2">9.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.3">Informative References</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.A">Appendix A.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#static-table">Static Table</a></li>
                                <li><a href="#rfc.section.B">Appendix B.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#encoding-and-decoding-examples">Encoding and Decoding Examples</a>
                                    <ul>
                                        <li><a href="#rfc.section.B.1">B.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#literal-field-line-with-name-reference">Literal Field Line with
                                                Name Reference</a></li>
                                        <li><a href="#rfc.section.B.2">B.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#dynamic-table">Dynamic Table</a></li>
                                        <li><a href="#rfc.section.B.3">B.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#speculative-insert">Speculative Insert</a></li>
                                        <li><a href="#rfc.section.B.4">B.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#duplicate-instruction-stream-cancellation">Duplicate Instruction,
                                                Stream Cancellation</a></li>
                                        <li><a href="#rfc.section.B.5">B.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#dynamic-table-insert-eviction">Dynamic Table Insert, Eviction</a>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.C">Appendix C.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#sample-single-pass-encoding-algorithm">Sample Single-Pass Encoding
                                        Algorithm</a></li>
                                <li><a href="#acknowledgments">Acknowledgments</a></li>
                                <li><a href="#rfc.authors">Authors' Addresses</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-8 order-first main" role="main">
                <header>
                    <table class="table table-condensed header" id="rfc.headerblock">
                        <tbody>
                            <tr>
                                <td class="text-left">Internet Engineering Task Force (IETF)</td>
                                <td class="text-right">C. Krasic</td>
                            </tr>
                            <tr>
                                <td class="text-left">Request for Comments: 9204</td>
                                <td class="text-right">M. Bishop</td>
                            </tr>
                            <tr>
                                <td class="text-left">Category: Standards Track</td>
                                <td class="text-right">Akamai Technologies</td>
                            </tr>
                            <tr>
                                <td class="text-left">ISSN: 2070-1721</td>
                                <td class="text-right">A. Frindell, Editor</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">Facebook</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">June 2022</td>
                            </tr>
                        </tbody>
                    </table>
                    <div id="rfc.title">
                        <h1>QPACK: Field Compression for HTTP/3</h1>
                    </div>
                </header>
                <hr>
                <h2 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h2>
                <div class="lead">
                    <div id="rfc.abstract.p.1">
                        <p>This specification defines QPACK: a compression format for efficiently representing HTTP
                            fields that is to be used in HTTP/3. This is a variation of HPACK compression that seeks to
                            reduce head-of-line blocking.</p>
                    </div>
                </div>
                <aside id="rfc.meta" class="alert alert-info"></aside>
                <section id="rfc.status">
                    <h2><a href="#rfc.status">Status of This Memo</a></h2>
                    <div id="rfc.boilerplate.1.p.1">
                        <p>This is an Internet Standards Track document.</p>
                    </div>
                    <div id="rfc.boilerplate.1.p.2">
                        <p>This document is a product of the Internet Engineering Task Force (IETF). It represents the
                            consensus of the IETF community. It has received public review and has been approved for
                            publication by the Internet Engineering Steering Group (IESG). Further information on
                            Internet Standards is available in <a
                                href="https://www.rfc-editor.org/rfc/rfc7841.html#section-2">Section 2 of RFC 7841</a>.
                        </p>
                    </div>
                    <div id="rfc.boilerplate.1.p.3">
                        <p>Information about the current status of this document, any errata, and how to provide
                            feedback on it may be obtained at <a
                                href="https://www.rfc-editor.org/info/rfc9204">https://www.rfc-editor.org/info/rfc9204</a>.
                        </p>
                    </div>
                </section>
                <section id="rfc.copyrightnotice">
                    <h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2>
                    <div id="rfc.boilerplate.2.p.1">
                        <p>Copyright (c) 2022 IETF Trust and the persons identified as the document authors. All rights
                            reserved.</p>
                    </div>
                    <div id="rfc.boilerplate.2.p.2">
                        <p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF
                            Documents (<a
                                href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>)
                            in effect on the date of publication of this document. Please review these documents
                            carefully, as they describe your rights and restrictions with respect to this document. Code
                            Components extracted from this document must include Revised BSD License text as described
                            in Section 4.e of the Trust Legal Provisions and are provided without warranty as described
                            in the Revised BSD License.</p>
                    </div>
                </section>
                <div class="toc d-lg-none">
                    <ul>
                        <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#introduction">Introduction</a>
                            <ul>
                                <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#conventions-and-definitions">Conventions and Definitions</a></li>
                                <li><a href="#rfc.section.1.2">1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#notational-conventions">Notational Conventions</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a
                                href="#compression-process-overview">Compression Process Overview</a>
                            <ul>
                                <li><a href="#rfc.section.2.1">2.1.</a>&nbsp;&nbsp;&nbsp;<a href="#encoder">Encoder</a>
                                    <ul>
                                        <li><a href="#rfc.section.2.1.1">2.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#blocked-insertion">Limits on Dynamic Table Insertions</a></li>
                                        <li><a href="#rfc.section.2.1.2">2.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#blocked-streams">Blocked Streams</a></li>
                                        <li><a href="#rfc.section.2.1.3">2.1.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#avoiding-flow-control-deadlocks">Avoiding Flow-Control
                                                Deadlocks</a></li>
                                        <li><a href="#rfc.section.2.1.4">2.1.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#known-received-count">Known Received Count</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.2.2">2.2.</a>&nbsp;&nbsp;&nbsp;<a href="#decoder">Decoder</a>
                                    <ul>
                                        <li><a href="#rfc.section.2.2.1">2.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#blocked-decoding">Blocked Decoding</a></li>
                                        <li><a href="#rfc.section.2.2.2">2.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#state-synchronization">State Synchronization</a></li>
                                        <li><a href="#rfc.section.2.2.3">2.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#invalid-references">Invalid References</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#reference-tables">Reference
                                Tables</a>
                            <ul>
                                <li><a href="#rfc.section.3.1">3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#header-table-static">Static Table</a></li>
                                <li><a href="#rfc.section.3.2">3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#header-table-dynamic">Dynamic Table</a>
                                    <ul>
                                        <li><a href="#rfc.section.3.2.1">3.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#dynamic-table-size">Dynamic Table Size</a></li>
                                        <li><a href="#rfc.section.3.2.2">3.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#eviction">Dynamic Table Capacity and Eviction</a></li>
                                        <li><a href="#rfc.section.3.2.3">3.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#maximum-dynamic-table-capacity">Maximum Dynamic Table
                                                Capacity</a></li>
                                        <li><a href="#rfc.section.3.2.4">3.2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#indexing">Absolute Indexing</a></li>
                                        <li><a href="#rfc.section.3.2.5">3.2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#relative-indexing">Relative Indexing</a></li>
                                        <li><a href="#rfc.section.3.2.6">3.2.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#post-base">Post-Base Indexing</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#wire-format">Wire Format</a>
                            <ul>
                                <li><a href="#rfc.section.4.1">4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#primitives">Primitives</a>
                                    <ul>
                                        <li><a href="#rfc.section.4.1.1">4.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#prefixed-integers">Prefixed Integers</a></li>
                                        <li><a href="#rfc.section.4.1.2">4.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#string-literals">String Literals</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.4.2">4.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#enc-dec-stream-def">Encoder and Decoder Streams</a></li>
                                <li><a href="#rfc.section.4.3">4.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#encoder-instructions">Encoder Instructions</a>
                                    <ul>
                                        <li><a href="#rfc.section.4.3.1">4.3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#set-dynamic-capacity">Set Dynamic Table Capacity</a></li>
                                        <li><a href="#rfc.section.4.3.2">4.3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#insert-with-name-reference">Insert with Name Reference</a></li>
                                        <li><a href="#rfc.section.4.3.3">4.3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#insert-with-literal-name">Insert with Literal Name</a></li>
                                        <li><a href="#rfc.section.4.3.4">4.3.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#duplicate">Duplicate</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.4.4">4.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#decoder-instructions">Decoder Instructions</a>
                                    <ul>
                                        <li><a href="#rfc.section.4.4.1">4.4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#header-acknowledgment">Section Acknowledgment</a></li>
                                        <li><a href="#rfc.section.4.4.2">4.4.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#stream-cancellation">Stream Cancellation</a></li>
                                        <li><a href="#rfc.section.4.4.3">4.4.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#insert-count-increment">Insert Count Increment</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.4.5">4.5.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#field-line-representations">Field Line Representations</a>
                                    <ul>
                                        <li><a href="#rfc.section.4.5.1">4.5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#header-prefix">Encoded Field Section Prefix</a></li>
                                        <li><a href="#rfc.section.4.5.2">4.5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#indexed-field-line">Indexed Field Line</a></li>
                                        <li><a href="#rfc.section.4.5.3">4.5.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#indexed-field-line-with-post-base-index">Indexed Field Line with
                                                Post-Base Index</a></li>
                                        <li><a href="#rfc.section.4.5.4">4.5.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#literal-name-reference">Literal Field Line with Name
                                                Reference</a></li>
                                        <li><a href="#rfc.section.4.5.5">4.5.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#literal-field-line-with-post-base-name-reference">Literal Field
                                                Line with Post-Base Name Reference</a></li>
                                        <li><a href="#rfc.section.4.5.6">4.5.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#literal-field-line-with-literal-name">Literal Field Line with
                                                Literal Name</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#configuration">Configuration</a>
                        </li>
                        <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#error-handling">Error
                                Handling</a></li>
                        <li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a href="#security-considerations">Security
                                Considerations</a>
                            <ul>
                                <li><a href="#rfc.section.7.1">7.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#probing-dynamic-table-state">Probing Dynamic Table State</a>
                                    <ul>
                                        <li><a href="#rfc.section.7.1.1">7.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#applicability-to-qpack-and-http">Applicability to QPACK and
                                                HTTP</a></li>
                                        <li><a href="#rfc.section.7.1.2">7.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#mitigation">Mitigation</a></li>
                                        <li><a href="#rfc.section.7.1.3">7.1.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#never-indexed-literals">Never-Indexed Literals</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.7.2">7.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#static-huffman-encoding">Static Huffman Encoding</a></li>
                                <li><a href="#rfc.section.7.3">7.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#memory-consumption">Memory Consumption</a></li>
                                <li><a href="#rfc.section.7.4">7.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#implementation-limits">Implementation Limits</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.8">8.</a>&nbsp;&nbsp;&nbsp;<a href="#iana-considerations">IANA
                                Considerations</a>
                            <ul>
                                <li><a href="#rfc.section.8.1">8.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#settings-registration">Settings Registration</a></li>
                                <li><a href="#rfc.section.8.2">8.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#stream-type-registration">Stream Type Registration</a></li>
                                <li><a href="#rfc.section.8.3">8.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#error-code-registration">Error Code Registration</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.9">9.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">References</a>
                            <ul>
                                <li><a href="#rfc.section.9.1">9.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.2">Normative References</a></li>
                                <li><a href="#rfc.section.9.2">9.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.3">Informative References</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.A">Appendix A.</a>&nbsp;&nbsp;&nbsp;<a href="#static-table">Static
                                Table</a></li>
                        <li><a href="#rfc.section.B">Appendix B.</a>&nbsp;&nbsp;&nbsp;<a
                                href="#encoding-and-decoding-examples">Encoding and Decoding Examples</a>
                            <ul>
                                <li><a href="#rfc.section.B.1">B.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#literal-field-line-with-name-reference">Literal Field Line with Name
                                        Reference</a></li>
                                <li><a href="#rfc.section.B.2">B.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#dynamic-table">Dynamic Table</a></li>
                                <li><a href="#rfc.section.B.3">B.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#speculative-insert">Speculative Insert</a></li>
                                <li><a href="#rfc.section.B.4">B.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#duplicate-instruction-stream-cancellation">Duplicate Instruction, Stream
                                        Cancellation</a></li>
                                <li><a href="#rfc.section.B.5">B.5.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#dynamic-table-insert-eviction">Dynamic Table Insert, Eviction</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.C">Appendix C.</a>&nbsp;&nbsp;&nbsp;<a
                                href="#sample-single-pass-encoding-algorithm">Sample Single-Pass Encoding Algorithm</a>
                        </li>
                        <li><a href="#acknowledgments">Acknowledgments</a></li>
                        <li><a href="#rfc.authors">Authors' Addresses</a></li>
                    </ul>
                </div>
                <hr class="hidden-print">
                <section id="introduction">
                    <h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a
                            href="#introduction">Introduction</a></h2>
                    <div id="rfc.section.1.p.1">
                        <p>The QUIC transport protocol (<a href="#QUIC-TRANSPORT"><cite
                                    title="QUIC: A UDP-Based Multiplexed and Secure Transport">[QUIC-TRANSPORT]</cite></a>)
                            is designed to support HTTP semantics, and its design subsumes many of the features of
                            HTTP/2 (<a href="#HTTP2"><cite title="HTTP/2">[HTTP/2]</cite></a>). HTTP/2 uses HPACK (<a
                                href="#RFC7541"><cite title="HPACK: Header Compression for HTTP/2">[RFC7541]</cite></a>)
                            for compression of the header and trailer sections. If HPACK were used for HTTP/3 (<a
                                href="#HTTP3"><cite title="HTTP/3">[HTTP/3]</cite></a>), it would induce head-of-line
                            blocking for field sections due to built-in assumptions of a total ordering across frames on
                            all streams.</p>
                    </div>
                    <div id="rfc.section.1.p.2">
                        <p>QPACK reuses core concepts from HPACK, but is redesigned to allow correctness in the presence
                            of out-of-order delivery, with flexibility for implementations to balance between resilience
                            against head-of-line blocking and optimal compression ratio. The design goals are to closely
                            approach the compression ratio of HPACK with substantially less head-of-line blocking under
                            the same loss conditions.</p>
                    </div>
                    <section id="conventions-and-definitions">
                        <h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a>&nbsp;<a
                                href="#conventions-and-definitions">Conventions and Definitions</a></h3>
                        <div id="rfc.section.1.1.p.1">
                            <p>The key words "<em class="bcp14">MUST</em>", "<em class="bcp14">MUST NOT</em>", "<em
                                    class="bcp14">REQUIRED</em>", "<em class="bcp14">SHALL</em>", "<em
                                    class="bcp14">SHALL NOT</em>", "<em class="bcp14">SHOULD</em>", "<em
                                    class="bcp14">SHOULD NOT</em>", "<em class="bcp14">RECOMMENDED</em>", "<em
                                    class="bcp14">NOT RECOMMENDED</em>", "<em class="bcp14">MAY</em>", and "<em
                                    class="bcp14">OPTIONAL</em>" in this document are to be interpreted as described in
                                <span class="nobr">BCP 14</span> <a href="#RFC2119"><cite
                                        title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a>
                                <a href="#RFC8174"><cite
                                        title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">[RFC8174]</cite></a>
                                when, and only when, they appear in all capitals, as shown here.
                            </p>
                        </div>
                        <div id="rfc.section.1.1.p.2" class="avoidbreakafter">
                            <p>The following terms are used in this document:</p>
                        </div>
                        <div id="rfc.section.1.1.p.3">
                            <dl>
                                <dt>HTTP fields:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>Metadata sent as part of an HTTP message. The term encompasses both header and
                                        trailer fields. Colloquially, the term "headers" has often been used to refer to
                                        HTTP header fields and trailer fields; this document uses "fields" for
                                        generality.</div>
                                </dd>
                                <dt>HTTP field line:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A name-value pair sent as part of an HTTP field section. See Sections <a
                                            href="https://www.rfc-editor.org/rfc/rfc9110.html#section-6.3">6.3</a> and
                                        <a href="https://www.rfc-editor.org/rfc/rfc9110.html#section-6.5">6.5</a> of <a
                                            href="#HTTP"><cite title="HTTP Semantics">[HTTP]</cite></a>.
                                    </div>
                                </dd>
                                <dt>HTTP field value:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>Data associated with a field name, composed from all field line values with
                                        that field name in that section, concatenated together with comma separators.
                                    </div>
                                </dd>
                                <dt>Field section:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>An ordered collection of HTTP field lines associated with an HTTP message. A
                                        field section can contain multiple field lines with the same name. It can also
                                        contain duplicate field lines. An HTTP message can include both header and
                                        trailer sections.</div>
                                </dd>
                                <dt>Representation:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>An instruction that represents a field line, possibly by reference to the
                                        dynamic and static tables.</div>
                                </dd>
                                <dt>Encoder:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>An implementation that encodes field sections.</div>
                                </dd>
                                <dt>Decoder:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>An implementation that decodes encoded field sections.</div>
                                </dd>
                                <dt>Absolute Index:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A unique index for each entry in the dynamic table.</div>
                                </dd>
                                <dt>Base:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A reference point for relative and post-Base indices. Representations that
                                        reference dynamic table entries are relative to a Base.</div>
                                </dd>
                                <dt>Insert Count:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The total number of entries inserted in the dynamic table.</div>
                                </dd>
                            </dl>
                        </div>
                        <div id="rfc.section.1.1.p.4">
                            <p>Note that QPACK is a name, not an abbreviation.</p>
                        </div>
                    </section>
                    <section id="notational-conventions">
                        <h3 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2.</a>&nbsp;<a
                                href="#notational-conventions">Notational Conventions</a></h3>
                        <div id="rfc.section.1.2.p.1" class="avoidbreakafter">
                            <p>Diagrams in this document use the format described in <a
                                    href="https://www.rfc-editor.org/rfc/rfc2360.html#section-3.1">Section 3.1</a> of <a
                                    href="#RFC2360"><cite
                                        title="Guide for Internet Standards Writers">[RFC2360]</cite></a>, with the
                                following additional conventions:</p>
                        </div>
                        <div id="rfc.section.1.2.p.2">
                            <dl>
                                <dt>x (A)</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>Indicates that x is A bits long.</div>
                                </dd>
                                <dt>x (A+)</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>Indicates that x uses the prefixed integer encoding defined in <a
                                            href="#prefixed-integers" title="Prefixed Integers">Section 4.1.1</a>,
                                        beginning with an A-bit prefix.</div>
                                </dd>
                                <dt>x ...</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>Indicates that x is variable length and extends to the end of the region.</div>
                                </dd>
                            </dl>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="compression-process-overview">
                    <h2 id="rfc.section.2" class="np"><a href="#rfc.section.2">2.</a>&nbsp;<a
                            href="#compression-process-overview">Compression Process Overview</a></h2>
                    <div id="rfc.section.2.p.1">
                        <p>Like HPACK, QPACK uses two tables for associating field lines ("headers") to indices. The
                            static table (<a href="#header-table-static" title="Static Table">Section 3.1</a>) is
                            predefined and contains common header field lines (some of them with an empty value). The
                            dynamic table (<a href="#header-table-dynamic" title="Dynamic Table">Section 3.2</a>) is
                            built up over the course of the connection and can be used by the encoder to index both
                            header and trailer field lines in the encoded field sections.</p>
                    </div>
                    <div id="rfc.section.2.p.2">
                        <p>QPACK defines unidirectional streams for sending instructions from encoder to decoder and
                            vice versa.</p>
                    </div>
                    <section id="encoder">
                        <h3 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a>&nbsp;<a href="#encoder">Encoder</a>
                        </h3>
                        <div id="rfc.section.2.1.p.1">
                            <p>An encoder converts a header or trailer section into a series of representations by
                                emitting either an indexed or a literal representation for each field line in the list;
                                see <a href="#field-line-representations" title="Field Line Representations">Section
                                    4.5</a>. Indexed representations achieve high compression by replacing the literal
                                name and possibly the value with an index to either the static or dynamic table.
                                References to the static table and literal representations do not require any dynamic
                                state and never risk head-of-line blocking. References to the dynamic table risk
                                head-of-line blocking if the encoder has not received an acknowledgment indicating the
                                entry is available at the decoder.</p>
                        </div>
                        <div id="rfc.section.2.1.p.2">
                            <p>An encoder <em class="bcp14">MAY</em> insert any entry in the dynamic table it chooses;
                                it is not limited to field lines it is compressing.</p>
                        </div>
                        <div id="rfc.section.2.1.p.3">
                            <p>QPACK preserves the ordering of field lines within each field section. An encoder <em
                                    class="bcp14">MUST</em> emit field representations in the order they appear in the
                                input field section.</p>
                        </div>
                        <div id="rfc.section.2.1.p.4">
                            <p>QPACK is designed to place the burden of optional state tracking on the encoder,
                                resulting in relatively simple decoders.</p>
                        </div>
                        <section id="blocked-insertion">
                            <h4 id="rfc.section.2.1.1"><a href="#rfc.section.2.1.1">2.1.1.</a>&nbsp;<a
                                    href="#blocked-insertion">Limits on Dynamic Table Insertions</a></h4>
                            <div id="rfc.section.2.1.1.p.1">
                                <p>Inserting entries into the dynamic table might not be possible if the table contains
                                    entries that cannot be evicted.</p>
                            </div>
                            <div id="rfc.section.2.1.1.p.2">
                                <p>A dynamic table entry cannot be evicted immediately after insertion, even if it has
                                    never been referenced. Once the insertion of a dynamic table entry has been
                                    acknowledged and there are no outstanding references to the entry in unacknowledged
                                    representations, the entry becomes evictable. Note that references on the encoder
                                    stream never preclude the eviction of an entry, because those references are
                                    guaranteed to be processed before the instruction evicting the entry.</p>
                            </div>
                            <div id="rfc.section.2.1.1.p.3">
                                <p>If the dynamic table does not contain enough room for a new entry without evicting
                                    other entries, and the entries that would be evicted are not evictable, the encoder
                                    <em class="bcp14">MUST NOT</em> insert that entry into the dynamic table (including
                                    duplicates of existing entries). In order to avoid this, an encoder that uses the
                                    dynamic table has to keep track of each dynamic table entry referenced by each field
                                    section until those representations are acknowledged by the decoder; see <a
                                        href="#header-acknowledgment" title="Section Acknowledgment">Section 4.4.1</a>.
                                </p>
                            </div>
                            <section id="avoiding-prohibited-insertions">
                                <h5 id="rfc.section.2.1.1.1"><a href="#rfc.section.2.1.1.1">2.1.1.1.</a>&nbsp;<a
                                        href="#avoiding-prohibited-insertions">Avoiding Prohibited Insertions</a></h5>
                                <div id="rfc.section.2.1.1.1.p.1">
                                    <p>To ensure that the encoder is not prevented from adding new entries, the encoder
                                        can avoid referencing entries that are close to eviction. Rather than reference
                                        such an entry, the encoder can emit a Duplicate instruction (<a
                                            href="#duplicate" title="Duplicate">Section 4.3.4</a>) and reference the
                                        duplicate instead.</p>
                                </div>
                                <div id="rfc.section.2.1.1.1.p.2">
                                    <p>Determining which entries are too close to eviction to reference is an encoder
                                        preference. One heuristic is to target a fixed amount of available space in the
                                        dynamic table: either unused space or space that can be reclaimed by evicting
                                        non-blocking entries. To achieve this, the encoder can maintain a draining
                                        index, which is the smallest absolute index (<a href="#indexing"
                                            title="Absolute Indexing">Section 3.2.4</a>) in the dynamic table that it
                                        will emit a reference for. As new entries are inserted, the encoder increases
                                        the draining index to maintain the section of the table that it will not
                                        reference. If the encoder does not create new references to entries with an
                                        absolute index lower than the draining index, the number of unacknowledged
                                        references to those entries will eventually become zero, allowing them to be
                                        evicted.</p>
                                </div>
                                <div id="fig-draining-index"></div>
                                <div id="rfc.figure.1">
                                    <div>
                                        <pre>
             &lt;-- Newer Entries          Older Entries --&gt;
               (Larger Indices)       (Smaller Indices)
   +--------+---------------------------------+----------+
   | Unused |          Referenceable          | Draining |
   | Space  |             Entries             | Entries  |
   +--------+---------------------------------+----------+
            ^                                 ^          ^
            |                                 |          |
      Insertion Point                 Draining Index  Dropping
                                                       Point
</pre>
                                    </div>
                                </div>
                                <p class="figure">Figure 1: Draining Dynamic Table Entries</p>
                            </section>
                        </section>
                        <section id="blocked-streams">
                            <h4 id="rfc.section.2.1.2"><a href="#rfc.section.2.1.2">2.1.2.</a>&nbsp;<a
                                    href="#blocked-streams">Blocked Streams</a></h4>
                            <div id="rfc.section.2.1.2.p.1">
                                <p>Because QUIC does not guarantee order between data on different streams, a decoder
                                    might encounter a representation that references a dynamic table entry that it has
                                    not yet received.</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.2">
                                <p>Each encoded field section contains a Required Insert Count (<a href="#header-prefix"
                                        title="Encoded Field Section Prefix">Section 4.5.1</a>), the lowest possible
                                    value for the Insert Count with which the field section can be decoded. For a field
                                    section encoded using references to the dynamic table, the Required Insert Count is
                                    one larger than the largest absolute index of all referenced dynamic table entries.
                                    For a field section encoded with no references to the dynamic table, the Required
                                    Insert Count is zero.</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.3">
                                <p>When the decoder receives an encoded field section with a Required Insert Count
                                    greater than its own Insert Count, the stream cannot be processed immediately and is
                                    considered "blocked"; see <a href="#blocked-decoding"
                                        title="Blocked Decoding">Section 2.2.1</a>.</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.4">
                                <p>The decoder specifies an upper bound on the number of streams that can be blocked
                                    using the SETTINGS_QPACK_BLOCKED_STREAMS setting; see <a href="#configuration"
                                        title="Configuration">Section 5</a>. An encoder <em class="bcp14">MUST</em>
                                    limit the number of streams that could become blocked to the value of
                                    SETTINGS_QPACK_BLOCKED_STREAMS at all times. If a decoder encounters more blocked
                                    streams than it promised to support, it <em class="bcp14">MUST</em> treat this as a
                                    connection error of type QPACK_DECOMPRESSION_FAILED.</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.5">
                                <p>Note that the decoder might not become blocked on every stream that risks becoming
                                    blocked.</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.6">
                                <p>An encoder can decide whether to risk having a stream become blocked. If permitted by
                                    the value of SETTINGS_QPACK_BLOCKED_STREAMS, compression efficiency can often be
                                    improved by referencing dynamic table entries that are still in transit, but if
                                    there is loss or reordering, the stream can become blocked at the decoder. An
                                    encoder can avoid the risk of blocking by only referencing dynamic table entries
                                    that have been acknowledged, but this could mean using literals. Since literals make
                                    the encoded field section larger, this can result in the encoder becoming blocked on
                                    congestion or flow-control limits.</p>
                            </div>
                        </section>
                        <section id="avoiding-flow-control-deadlocks">
                            <h4 id="rfc.section.2.1.3"><a href="#rfc.section.2.1.3">2.1.3.</a>&nbsp;<a
                                    href="#avoiding-flow-control-deadlocks">Avoiding Flow-Control Deadlocks</a></h4>
                            <div id="rfc.section.2.1.3.p.1">
                                <p>Writing instructions on streams that are limited by flow control can produce
                                    deadlocks.</p>
                            </div>
                            <div id="rfc.section.2.1.3.p.2">
                                <p>A decoder might stop issuing flow-control credit on the stream that carries an
                                    encoded field section until the necessary updates are received on the encoder
                                    stream. If the granting of flow-control credit on the encoder stream (or the
                                    connection as a whole) depends on the consumption and release of data on the stream
                                    carrying the encoded field section, a deadlock might result.</p>
                            </div>
                            <div id="rfc.section.2.1.3.p.3">
                                <p>More generally, a stream containing a large instruction can become deadlocked if the
                                    decoder withholds flow-control credit until the instruction is completely received.
                                </p>
                            </div>
                            <div id="rfc.section.2.1.3.p.4">
                                <p>To avoid these deadlocks, an encoder <em class="bcp14">SHOULD NOT</em> write an
                                    instruction unless sufficient stream and connection flow-control credit is available
                                    for the entire instruction.</p>
                            </div>
                        </section>
                        <section id="known-received-count">
                            <h4 id="rfc.section.2.1.4"><a href="#rfc.section.2.1.4">2.1.4.</a>&nbsp;<a
                                    href="#known-received-count">Known Received Count</a></h4>
                            <div id="rfc.section.2.1.4.p.1">
                                <p>The Known Received Count is the total number of dynamic table insertions and
                                    duplications acknowledged by the decoder. The encoder tracks the Known Received
                                    Count in order to identify which dynamic table entries can be referenced without
                                    potentially blocking a stream. The decoder tracks the Known Received Count in order
                                    to be able to send Insert Count Increment instructions.</p>
                            </div>
                            <div id="rfc.section.2.1.4.p.2">
                                <p>A Section Acknowledgment instruction (<a href="#header-acknowledgment"
                                        title="Section Acknowledgment">Section 4.4.1</a>) implies that the decoder has
                                    received all dynamic table state necessary to decode the field section. If the
                                    Required Insert Count of the acknowledged field section is greater than the current
                                    Known Received Count, the Known Received Count is updated to that Required Insert
                                    Count value.</p>
                            </div>
                            <div id="rfc.section.2.1.4.p.3">
                                <p>An Insert Count Increment instruction (<a href="#insert-count-increment"
                                        title="Insert Count Increment">Section 4.4.3</a>) increases the Known Received
                                    Count by its Increment parameter. See <a href="#new-table-entries"
                                        title="New Table Entries">Section 2.2.2.3</a> for guidance.</p>
                            </div>
                        </section>
                    </section>
                    <section id="decoder">
                        <h3 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2.</a>&nbsp;<a href="#decoder">Decoder</a>
                        </h3>
                        <div id="rfc.section.2.2.p.1">
                            <p>As in HPACK, the decoder processes a series of representations and emits the
                                corresponding field sections. It also processes instructions received on the encoder
                                stream that modify the dynamic table. Note that encoded field sections and encoder
                                stream instructions arrive on separate streams. This is unlike HPACK, where encoded
                                field sections (header blocks) can contain instructions that modify the dynamic table,
                                and there is no dedicated stream of HPACK instructions.</p>
                        </div>
                        <div id="rfc.section.2.2.p.2">
                            <p>The decoder <em class="bcp14">MUST</em> emit field lines in the order their
                                representations appear in the encoded field section.</p>
                        </div>
                        <section id="blocked-decoding">
                            <h4 id="rfc.section.2.2.1"><a href="#rfc.section.2.2.1">2.2.1.</a>&nbsp;<a
                                    href="#blocked-decoding">Blocked Decoding</a></h4>
                            <div id="rfc.section.2.2.1.p.1">
                                <p>Upon receipt of an encoded field section, the decoder examines the Required Insert
                                    Count. When the Required Insert Count is less than or equal to the decoder's Insert
                                    Count, the field section can be processed immediately. Otherwise, the stream on
                                    which the field section was received becomes blocked.</p>
                            </div>
                            <div id="rfc.section.2.2.1.p.2">
                                <p>While blocked, encoded field section data <em class="bcp14">SHOULD</em> remain in the
                                    blocked stream's flow-control window. This data is unusable until the stream becomes
                                    unblocked, and releasing the flow control prematurely makes the decoder vulnerable
                                    to memory exhaustion attacks. A stream becomes unblocked when the Insert Count
                                    becomes greater than or equal to the Required Insert Count for all encoded field
                                    sections the decoder has started reading from the stream.</p>
                            </div>
                            <div id="rfc.section.2.2.1.p.3">
                                <p>When processing encoded field sections, the decoder expects the Required Insert Count
                                    to equal the lowest possible value for the Insert Count with which the field section
                                    can be decoded, as prescribed in <a href="#blocked-streams"
                                        title="Blocked Streams">Section 2.1.2</a>. If it encounters a Required Insert
                                    Count smaller than expected, it <em class="bcp14">MUST</em> treat this as a
                                    connection error of type QPACK_DECOMPRESSION_FAILED; see <a
                                        href="#invalid-references" title="Invalid References">Section 2.2.3</a>. If it
                                    encounters a Required Insert Count larger than expected, it <em
                                        class="bcp14">MAY</em> treat this as a connection error of type
                                    QPACK_DECOMPRESSION_FAILED.</p>
                            </div>
                        </section>
                        <section id="state-synchronization">
                            <h4 id="rfc.section.2.2.2"><a href="#rfc.section.2.2.2">2.2.2.</a>&nbsp;<a
                                    href="#state-synchronization">State Synchronization</a></h4>
                            <div id="rfc.section.2.2.2.p.1">
                                <p>The decoder signals the following events by emitting decoder instructions (<a
                                        href="#decoder-instructions" title="Decoder Instructions">Section 4.4</a>) on
                                    the decoder stream.</p>
                            </div>
                            <section id="completed-processing-of-a-field-section">
                                <h5 id="rfc.section.2.2.2.1"><a href="#rfc.section.2.2.2.1">2.2.2.1.</a>&nbsp;<a
                                        href="#completed-processing-of-a-field-section">Completed Processing of a Field
                                        Section</a></h5>
                                <div id="rfc.section.2.2.2.1.p.1">
                                    <p>After the decoder finishes decoding a field section encoded using representations
                                        containing dynamic table references, it <em class="bcp14">MUST</em> emit a
                                        Section Acknowledgment instruction (<a href="#header-acknowledgment"
                                            title="Section Acknowledgment">Section 4.4.1</a>). A stream may carry
                                        multiple field sections in the case of intermediate responses, trailers, and
                                        pushed requests. The encoder interprets each Section Acknowledgment instruction
                                        as acknowledging the earliest unacknowledged field section containing dynamic
                                        table references sent on the given stream.</p>
                                </div>
                            </section>
                            <section id="abandonment-of-a-stream">
                                <h5 id="rfc.section.2.2.2.2"><a href="#rfc.section.2.2.2.2">2.2.2.2.</a>&nbsp;<a
                                        href="#abandonment-of-a-stream">Abandonment of a Stream</a></h5>
                                <div id="rfc.section.2.2.2.2.p.1">
                                    <p>When an endpoint receives a stream reset before the end of a stream or before all
                                        encoded field sections are processed on that stream, or when it abandons reading
                                        of a stream, it generates a Stream Cancellation instruction; see <a
                                            href="#stream-cancellation" title="Stream Cancellation">Section 4.4.2</a>.
                                        This signals to the encoder that all references to the dynamic table on that
                                        stream are no longer outstanding. A decoder with a maximum dynamic table
                                        capacity (<a href="#maximum-dynamic-table-capacity"
                                            title="Maximum Dynamic Table Capacity">Section 3.2.3</a>) equal to zero <em
                                            class="bcp14">MAY</em> omit sending Stream Cancellations, because the
                                        encoder cannot have any dynamic table references. An encoder cannot infer from
                                        this instruction that any updates to the dynamic table have been received.</p>
                                </div>
                                <div id="rfc.section.2.2.2.2.p.2">
                                    <p>The Section Acknowledgment and Stream Cancellation instructions permit the
                                        encoder to remove references to entries in the dynamic table. When an entry with
                                        an absolute index lower than the Known Received Count has zero references, then
                                        it is considered evictable; see <a href="#blocked-insertion"
                                            title="Limits on Dynamic Table Insertions">Section 2.1.1</a>.</p>
                                </div>
                            </section>
                            <section id="new-table-entries">
                                <h5 id="rfc.section.2.2.2.3"><a href="#rfc.section.2.2.2.3">2.2.2.3.</a>&nbsp;<a
                                        href="#new-table-entries">New Table Entries</a></h5>
                                <div id="rfc.section.2.2.2.3.p.1">
                                    <p>After receiving new table entries on the encoder stream, the decoder chooses when
                                        to emit Insert Count Increment instructions; see <a
                                            href="#insert-count-increment" title="Insert Count Increment">Section
                                            4.4.3</a>. Emitting this instruction after adding each new dynamic table
                                        entry will provide the timeliest feedback to the encoder, but could be redundant
                                        with other decoder feedback. By delaying an Insert Count Increment instruction,
                                        the decoder might be able to coalesce multiple Insert Count Increment
                                        instructions or replace them entirely with Section Acknowledgments; see <a
                                            href="#header-acknowledgment" title="Section Acknowledgment">Section
                                            4.4.1</a>. However, delaying too long may lead to compression inefficiencies
                                        if the encoder waits for an entry to be acknowledged before using it.</p>
                                </div>
                            </section>
                        </section>
                        <section id="invalid-references">
                            <h4 id="rfc.section.2.2.3"><a href="#rfc.section.2.2.3">2.2.3.</a>&nbsp;<a
                                    href="#invalid-references">Invalid References</a></h4>
                            <div id="rfc.section.2.2.3.p.1">
                                <p>If the decoder encounters a reference in a field line representation to a dynamic
                                    table entry that has already been evicted or that has an absolute index greater than
                                    or equal to the declared Required Insert Count (<a href="#header-prefix"
                                        title="Encoded Field Section Prefix">Section 4.5.1</a>), it <em
                                        class="bcp14">MUST</em> treat this as a connection error of type
                                    QPACK_DECOMPRESSION_FAILED.</p>
                            </div>
                            <div id="rfc.section.2.2.3.p.2">
                                <p>If the decoder encounters a reference in an encoder instruction to a dynamic table
                                    entry that has already been evicted, it <em class="bcp14">MUST</em> treat this as a
                                    connection error of type QPACK_ENCODER_STREAM_ERROR.</p>
                            </div>
                        </section>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="reference-tables">
                    <h2 id="rfc.section.3" class="np"><a href="#rfc.section.3">3.</a>&nbsp;<a
                            href="#reference-tables">Reference Tables</a></h2>
                    <div id="rfc.section.3.p.1">
                        <p>Unlike in HPACK, entries in the QPACK static and dynamic tables are addressed separately. The
                            following sections describe how entries in each table are addressed.</p>
                    </div>
                    <section id="header-table-static">
                        <h3 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a>&nbsp;<a
                                href="#header-table-static">Static Table</a></h3>
                        <div id="rfc.section.3.1.p.1">
                            <p>The static table consists of a predefined list of field lines, each of which has a fixed
                                index over time. Its entries are defined in <a href="#static-table"
                                    title="Static Table">Appendix A</a>.</p>
                        </div>
                        <div id="rfc.section.3.1.p.2">
                            <p>All entries in the static table have a name and a value. However, values can be empty
                                (that is, have a length of 0). Each entry is identified by a unique index.</p>
                        </div>
                        <div id="rfc.section.3.1.p.3">
                            <p>Note that the QPACK static table is indexed from 0, whereas the HPACK static table is
                                indexed from 1.</p>
                        </div>
                        <div id="rfc.section.3.1.p.4">
                            <p>When the decoder encounters an invalid static table index in a field line representation,
                                it <em class="bcp14">MUST</em> treat this as a connection error of type
                                QPACK_DECOMPRESSION_FAILED. If this index is received on the encoder stream, this <em
                                    class="bcp14">MUST</em> be treated as a connection error of type
                                QPACK_ENCODER_STREAM_ERROR.</p>
                        </div>
                    </section>
                    <section id="header-table-dynamic">
                        <h3 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a>&nbsp;<a
                                href="#header-table-dynamic">Dynamic Table</a></h3>
                        <div id="rfc.section.3.2.p.1">
                            <p>The dynamic table consists of a list of field lines maintained in first-in, first-out
                                order. A QPACK encoder and decoder share a dynamic table that is initially empty. The
                                encoder adds entries to the dynamic table and sends them to the decoder via instructions
                                on the encoder stream; see <a href="#encoder-instructions"
                                    title="Encoder Instructions">Section 4.3</a>.</p>
                        </div>
                        <div id="rfc.section.3.2.p.2">
                            <p>The dynamic table can contain duplicate entries (i.e., entries with the same name and
                                same value). Therefore, duplicate entries <em class="bcp14">MUST NOT</em> be treated as
                                an error by the decoder.</p>
                        </div>
                        <div id="rfc.section.3.2.p.3">
                            <p>Dynamic table entries can have empty values.</p>
                        </div>
                        <section id="dynamic-table-size">
                            <h4 id="rfc.section.3.2.1"><a href="#rfc.section.3.2.1">3.2.1.</a>&nbsp;<a
                                    href="#dynamic-table-size">Dynamic Table Size</a></h4>
                            <div id="rfc.section.3.2.1.p.1">
                                <p>The size of the dynamic table is the sum of the size of its entries.</p>
                            </div>
                            <div id="rfc.section.3.2.1.p.2">
                                <p>The size of an entry is the sum of its name's length in bytes, its value's length in
                                    bytes, and 32 additional bytes. The size of an entry is calculated using the length
                                    of its name and value without Huffman encoding applied.</p>
                            </div>
                        </section>
                        <section id="eviction">
                            <h4 id="rfc.section.3.2.2"><a href="#rfc.section.3.2.2">3.2.2.</a>&nbsp;<a
                                    href="#eviction">Dynamic Table Capacity and Eviction</a></h4>
                            <div id="rfc.section.3.2.2.p.1">
                                <p>The encoder sets the capacity of the dynamic table, which serves as the upper limit
                                    on its size. The initial capacity of the dynamic table is zero. The encoder sends a
                                    Set Dynamic Table Capacity instruction (<a href="#set-dynamic-capacity"
                                        title="Set Dynamic Table Capacity">Section 4.3.1</a>) with a non-zero capacity
                                    to begin using the dynamic table.</p>
                            </div>
                            <div id="rfc.section.3.2.2.p.2">
                                <p>Before a new entry is added to the dynamic table, entries are evicted from the end of
                                    the dynamic table until the size of the dynamic table is less than or equal to
                                    (table capacity - size of new entry). The encoder <em class="bcp14">MUST NOT</em>
                                    cause a dynamic table entry to be evicted unless that entry is evictable; see <a
                                        href="#blocked-insertion" title="Limits on Dynamic Table Insertions">Section
                                        2.1.1</a>. The new entry is then added to the table. It is an error if the
                                    encoder attempts to add an entry that is larger than the dynamic table capacity; the
                                    decoder <em class="bcp14">MUST</em> treat this as a connection error of type
                                    QPACK_ENCODER_STREAM_ERROR.</p>
                            </div>
                            <div id="rfc.section.3.2.2.p.3">
                                <p>A new entry can reference an entry in the dynamic table that will be evicted when
                                    adding this new entry into the dynamic table. Implementations are cautioned to avoid
                                    deleting the referenced name or value if the referenced entry is evicted from the
                                    dynamic table prior to inserting the new entry.</p>
                            </div>
                            <div id="rfc.section.3.2.2.p.4">
                                <p>Whenever the dynamic table capacity is reduced by the encoder (<a
                                        href="#set-dynamic-capacity" title="Set Dynamic Table Capacity">Section
                                        4.3.1</a>), entries are evicted from the end of the dynamic table until the size
                                    of the dynamic table is less than or equal to the new table capacity. This mechanism
                                    can be used to completely clear entries from the dynamic table by setting a capacity
                                    of 0, which can subsequently be restored.</p>
                            </div>
                        </section>
                        <section id="maximum-dynamic-table-capacity">
                            <h4 id="rfc.section.3.2.3"><a href="#rfc.section.3.2.3">3.2.3.</a>&nbsp;<a
                                    href="#maximum-dynamic-table-capacity">Maximum Dynamic Table Capacity</a></h4>
                            <div id="rfc.section.3.2.3.p.1">
                                <p>To bound the memory requirements of the decoder, the decoder limits the maximum value
                                    the encoder is permitted to set for the dynamic table capacity. In HTTP/3, this
                                    limit is determined by the value of SETTINGS_QPACK_MAX_TABLE_CAPACITY sent by the
                                    decoder; see <a href="#configuration" title="Configuration">Section 5</a>. The
                                    encoder <em class="bcp14">MUST NOT</em> set a dynamic table capacity that exceeds
                                    this maximum, but it can choose to use a lower dynamic table capacity; see <a
                                        href="#set-dynamic-capacity" title="Set Dynamic Table Capacity">Section
                                        4.3.1</a>.</p>
                            </div>
                            <div id="rfc.section.3.2.3.p.2">
                                <p>For clients using 0-RTT data in HTTP/3, the server's maximum table capacity is the
                                    remembered value of the setting or zero if the value was not previously sent. When
                                    the client's 0-RTT value of the SETTING is zero, the server <em
                                        class="bcp14">MAY</em> set it to a non-zero value in its SETTINGS frame. If the
                                    remembered value is non-zero, the server <em class="bcp14">MUST</em> send the same
                                    non-zero value in its SETTINGS frame. If it specifies any other value, or omits
                                    SETTINGS_QPACK_MAX_TABLE_CAPACITY from SETTINGS, the encoder must treat this as a
                                    connection error of type QPACK_DECODER_STREAM_ERROR.</p>
                            </div>
                            <div id="rfc.section.3.2.3.p.3">
                                <p>For clients not using 0-RTT data (whether 0-RTT is not attempted or is rejected) and
                                    for all HTTP/3 servers, the maximum table capacity is 0 until the encoder processes
                                    a SETTINGS frame with a non-zero value of SETTINGS_QPACK_MAX_TABLE_CAPACITY.</p>
                            </div>
                            <div id="rfc.section.3.2.3.p.4">
                                <p>When the maximum table capacity is zero, the encoder <em class="bcp14">MUST NOT</em>
                                    insert entries into the dynamic table and <em class="bcp14">MUST NOT</em> send any
                                    encoder instructions on the encoder stream.</p>
                            </div>
                        </section>
                        <section id="indexing">
                            <h4 id="rfc.section.3.2.4"><a href="#rfc.section.3.2.4">3.2.4.</a>&nbsp;<a
                                    href="#indexing">Absolute Indexing</a></h4>
                            <div id="rfc.section.3.2.4.p.1">
                                <p>Each entry possesses an absolute index that is fixed for the lifetime of that entry.
                                    The first entry inserted has an absolute index of 0; indices increase by one with
                                    each insertion.</p>
                            </div>
                        </section>
                        <section id="relative-indexing">
                            <h4 id="rfc.section.3.2.5"><a href="#rfc.section.3.2.5">3.2.5.</a>&nbsp;<a
                                    href="#relative-indexing">Relative Indexing</a></h4>
                            <div id="rfc.section.3.2.5.p.1">
                                <p>Relative indices begin at zero and increase in the opposite direction from the
                                    absolute index. Determining which entry has a relative index of 0 depends on the
                                    context of the reference.</p>
                            </div>
                            <div id="rfc.section.3.2.5.p.2">
                                <p>In encoder instructions (<a href="#encoder-instructions"
                                        title="Encoder Instructions">Section 4.3</a>), a relative index of 0 refers to
                                    the most recently inserted value in the dynamic table. Note that this means the
                                    entry referenced by a given relative index will change while interpreting
                                    instructions on the encoder stream.</p>
                            </div>
                            <div id="rfc.figure.2">
                                <div>
                                    <pre>
      +-----+---------------+-------+
      | n-1 |      ...      |   d   |  Absolute Index
      + - - +---------------+ - - - +
      |  0  |      ...      | n-d-1 |  Relative Index
      +-----+---------------+-------+
      ^                             |
      |                             V
Insertion Point               Dropping Point

n = count of entries inserted
d = count of entries dropped
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 2: Example Dynamic Table Indexing - Encoder Stream</p>
                            <div id="rfc.section.3.2.5.p.3">
                                <p>Unlike in encoder instructions, relative indices in field line representations are
                                    relative to the Base at the beginning of the encoded field section; see <a
                                        href="#header-prefix" title="Encoded Field Section Prefix">Section 4.5.1</a>.
                                    This ensures that references are stable even if encoded field sections and dynamic
                                    table updates are processed out of order.</p>
                            </div>
                            <div id="rfc.section.3.2.5.p.4">
                                <p>In a field line representation, a relative index of 0 refers to the entry with
                                    absolute index equal to Base - 1.</p>
                            </div>
                            <div id="rfc.figure.3">
                                <div>
                                    <pre>
               Base
                |
                V
    +-----+-----+-----+-----+-------+
    | n-1 | n-2 | n-3 | ... |   d   |  Absolute Index
    +-----+-----+  -  +-----+   -   +
                |  0  | ... | n-d-3 |  Relative Index
                +-----+-----+-------+

n = count of entries inserted
d = count of entries dropped
In this example, Base = n - 2
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 3: Example Dynamic Table Indexing - Relative Index in
                                Representation</p>
                        </section>
                        <section id="post-base">
                            <h4 id="rfc.section.3.2.6"><a href="#rfc.section.3.2.6">3.2.6.</a>&nbsp;<a
                                    href="#post-base">Post-Base Indexing</a></h4>
                            <div id="rfc.section.3.2.6.p.1">
                                <p>Post-Base indices are used in field line representations for entries with absolute
                                    indices greater than or equal to Base, starting at 0 for the entry with absolute
                                    index equal to Base and increasing in the same direction as the absolute index.</p>
                            </div>
                            <div id="rfc.section.3.2.6.p.2">
                                <p>Post-Base indices allow an encoder to process a field section in a single pass and
                                    include references to entries added while processing this (or other) field sections.
                                </p>
                            </div>
                            <div id="rfc.figure.4">
                                <div>
                                    <pre>
               Base
                |
                V
    +-----+-----+-----+-----+-----+
    | n-1 | n-2 | n-3 | ... |  d  |  Absolute Index
    +-----+-----+-----+-----+-----+
    |  1  |  0  |                    Post-Base Index
    +-----+-----+

n = count of entries inserted
d = count of entries dropped
In this example, Base = n - 2
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 4: Example Dynamic Table Indexing - Post-Base Index in
                                Representation</p>
                        </section>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="wire-format">
                    <h2 id="rfc.section.4" class="np"><a href="#rfc.section.4">4.</a>&nbsp;<a href="#wire-format">Wire
                            Format</a></h2>
                    <section id="primitives">
                        <h3 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a>&nbsp;<a
                                href="#primitives">Primitives</a></h3>
                        <section id="prefixed-integers">
                            <h4 id="rfc.section.4.1.1"><a href="#rfc.section.4.1.1">4.1.1.</a>&nbsp;<a
                                    href="#prefixed-integers">Prefixed Integers</a></h4>
                            <div id="rfc.section.4.1.1.p.1">
                                <p>The prefixed integer from <a
                                        href="https://www.rfc-editor.org/rfc/rfc7541.html#section-5.1">Section 5.1</a>
                                    of <a href="#RFC7541"><cite
                                            title="HPACK: Header Compression for HTTP/2">[RFC7541]</cite></a> is used
                                    heavily throughout this document. The format from <a href="#RFC7541"><cite
                                            title="HPACK: Header Compression for HTTP/2">[RFC7541]</cite></a> is used
                                    unmodified. Note, however, that QPACK uses some prefix sizes not actually used in
                                    HPACK.</p>
                            </div>
                            <div id="rfc.section.4.1.1.p.2">
                                <p>QPACK implementations <em class="bcp14">MUST</em> be able to decode integers up to
                                    and including 62 bits long.</p>
                            </div>
                        </section>
                        <section id="string-literals">
                            <h4 id="rfc.section.4.1.2"><a href="#rfc.section.4.1.2">4.1.2.</a>&nbsp;<a
                                    href="#string-literals">String Literals</a></h4>
                            <div id="rfc.section.4.1.2.p.1">
                                <p>The string literal defined by <a
                                        href="https://www.rfc-editor.org/rfc/rfc7541.html#section-5.2">Section 5.2</a>
                                    of <a href="#RFC7541"><cite
                                            title="HPACK: Header Compression for HTTP/2">[RFC7541]</cite></a> is also
                                    used throughout. This string format includes optional Huffman encoding.</p>
                            </div>
                            <div id="rfc.section.4.1.2.p.2">
                                <p>HPACK defines string literals to begin on a byte boundary. They begin with a single
                                    bit flag, denoted as 'H' in this document (indicating whether the string is Huffman
                                    encoded), followed by the string length encoded as a 7-bit prefix integer, and
                                    finally the indicated number of bytes of data. When Huffman encoding is enabled, the
                                    Huffman table from <a
                                        href="https://www.rfc-editor.org/rfc/rfc7541.html#appendix-B">Appendix B</a> of
                                    <a href="#RFC7541"><cite
                                            title="HPACK: Header Compression for HTTP/2">[RFC7541]</cite></a> is used
                                    without modification and the indicated length is the size of the string after
                                    encoding.
                                </p>
                            </div>
                            <div id="rfc.section.4.1.2.p.3">
                                <p>This document expands the definition of string literals by permitting them to begin
                                    other than on a byte boundary. An "N-bit prefix string literal" begins mid-byte,
                                    with the first (8-N) bits allocated to a previous field. The string uses one bit for
                                    the Huffman flag, followed by the length of the encoded string as a (N-1)-bit prefix
                                    integer. The prefix size, N, can have a value between 2 and 8, inclusive. The
                                    remainder of the string literal is unmodified.</p>
                            </div>
                            <div id="rfc.section.4.1.2.p.4">
                                <p>A string literal without a prefix length noted is an 8-bit prefix string literal and
                                    follows the definitions in <a href="#RFC7541"><cite
                                            title="HPACK: Header Compression for HTTP/2">[RFC7541]</cite></a> without
                                    modification.</p>
                            </div>
                        </section>
                    </section>
                    <section id="enc-dec-stream-def">
                        <h3 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a>&nbsp;<a
                                href="#enc-dec-stream-def">Encoder and Decoder Streams</a></h3>
                        <div id="rfc.section.4.2.p.1" class="avoidbreakafter">
                            <p>QPACK defines two unidirectional stream types:</p>
                        </div>
                        <div id="rfc.section.4.2.p.2">
                            <ul>
                                <li>An encoder stream is a unidirectional stream of type 0x02. It carries an unframed
                                    sequence of encoder instructions from encoder to decoder.</li>
                                <li>A decoder stream is a unidirectional stream of type 0x03. It carries an unframed
                                    sequence of decoder instructions from decoder to encoder.</li>
                            </ul>
                        </div>
                        <div id="rfc.section.4.2.p.3">
                            <p>HTTP/3 endpoints contain a QPACK encoder and decoder. Each endpoint <em
                                    class="bcp14">MUST</em> initiate, at most, one encoder stream and, at most, one
                                decoder stream. Receipt of a second instance of either stream type <em
                                    class="bcp14">MUST</em> be treated as a connection error of type
                                H3_STREAM_CREATION_ERROR.</p>
                        </div>
                        <div id="rfc.section.4.2.p.4">
                            <p>The sender <em class="bcp14">MUST NOT</em> close either of these streams, and the
                                receiver <em class="bcp14">MUST NOT</em> request that the sender close either of these
                                streams. Closure of either unidirectional stream type <em class="bcp14">MUST</em> be
                                treated as a connection error of type H3_CLOSED_CRITICAL_STREAM.</p>
                        </div>
                        <div id="rfc.section.4.2.p.5">
                            <p>An endpoint <em class="bcp14">MAY</em> avoid creating an encoder stream if it will not be
                                used (for example, if its encoder does not wish to use the dynamic table or if the
                                maximum size of the dynamic table permitted by the peer is zero).</p>
                        </div>
                        <div id="rfc.section.4.2.p.6">
                            <p>An endpoint <em class="bcp14">MAY</em> avoid creating a decoder stream if its decoder
                                sets the maximum capacity of the dynamic table to zero.</p>
                        </div>
                        <div id="rfc.section.4.2.p.7">
                            <p>An endpoint <em class="bcp14">MUST</em> allow its peer to create an encoder stream and a
                                decoder stream even if the connection's settings prevent their use.</p>
                        </div>
                    </section>
                    <section id="encoder-instructions">
                        <h3 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3.</a>&nbsp;<a
                                href="#encoder-instructions">Encoder Instructions</a></h3>
                        <div id="rfc.section.4.3.p.1">
                            <p>An encoder sends encoder instructions on the encoder stream to set the capacity of the
                                dynamic table and add dynamic table entries. Instructions adding table entries can use
                                existing entries to avoid transmitting redundant information. The name can be
                                transmitted as a reference to an existing entry in the static or the dynamic table or as
                                a string literal. For entries that already exist in the dynamic table, the full entry
                                can also be used by reference, creating a duplicate entry.</p>
                        </div>
                        <section id="set-dynamic-capacity">
                            <h4 id="rfc.section.4.3.1"><a href="#rfc.section.4.3.1">4.3.1.</a>&nbsp;<a
                                    href="#set-dynamic-capacity">Set Dynamic Table Capacity</a></h4>
                            <div id="rfc.section.4.3.1.p.1">
                                <p>An encoder informs the decoder of a change to the dynamic table capacity using an
                                    instruction that starts with the '001' 3-bit pattern. This is followed by the new
                                    dynamic table capacity represented as an integer with a 5-bit prefix; see <a
                                        href="#prefixed-integers" title="Prefixed Integers">Section 4.1.1</a>.</p>
                            </div>
                            <div id="fig-set-capacity"></div>
                            <div id="rfc.figure.5">
                                <div>
                                    <pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 0 | 1 |   Capacity (5+)   |
+---+---+---+-------------------+
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 5: Set Dynamic Table Capacity</p>
                            <div id="rfc.section.4.3.1.p.2">
                                <p>The new capacity <em class="bcp14">MUST</em> be lower than or equal to the limit
                                    described in <a href="#maximum-dynamic-table-capacity"
                                        title="Maximum Dynamic Table Capacity">Section 3.2.3</a>. In HTTP/3, this limit
                                    is the value of the SETTINGS_QPACK_MAX_TABLE_CAPACITY parameter (<a
                                        href="#configuration" title="Configuration">Section 5</a>) received from the
                                    decoder. The decoder <em class="bcp14">MUST</em> treat a new dynamic table capacity
                                    value that exceeds this limit as a connection error of type
                                    QPACK_ENCODER_STREAM_ERROR.</p>
                            </div>
                            <div id="rfc.section.4.3.1.p.3">
                                <p>Reducing the dynamic table capacity can cause entries to be evicted; see <a
                                        href="#eviction" title="Dynamic Table Capacity and Eviction">Section 3.2.2</a>.
                                    This <em class="bcp14">MUST NOT</em> cause the eviction of entries that are not
                                    evictable; see <a href="#blocked-insertion"
                                        title="Limits on Dynamic Table Insertions">Section 2.1.1</a>. Changing the
                                    capacity of the dynamic table is not acknowledged as this instruction does not
                                    insert an entry.</p>
                            </div>
                        </section>
                        <section id="insert-with-name-reference">
                            <h4 id="rfc.section.4.3.2"><a href="#rfc.section.4.3.2">4.3.2.</a>&nbsp;<a
                                    href="#insert-with-name-reference">Insert with Name Reference</a></h4>
                            <div id="rfc.section.4.3.2.p.1">
                                <p>An encoder adds an entry to the dynamic table where the field name matches the field
                                    name of an entry stored in the static or the dynamic table using an instruction that
                                    starts with the '1' 1-bit pattern. The second ('T') bit indicates whether the
                                    reference is to the static or dynamic table. The 6-bit prefix integer (<a
                                        href="#prefixed-integers" title="Prefixed Integers">Section 4.1.1</a>) that
                                    follows is used to locate the table entry for the field name. When T=1, the number
                                    represents the static table index; when T=0, the number is the relative index of the
                                    entry in the dynamic table.</p>
                            </div>
                            <div id="rfc.section.4.3.2.p.2">
                                <p>The field name reference is followed by the field value represented as a string
                                    literal; see <a href="#string-literals" title="String Literals">Section 4.1.2</a>.
                                </p>
                            </div>
                            <div id="rfc.figure.6">
                                <div>
                                    <pre>
     0   1   2   3   4   5   6   7
   +---+---+---+---+---+---+---+---+
   | 1 | T |    Name Index (6+)    |
   +---+---+-----------------------+
   | H |     Value Length (7+)     |
   +---+---------------------------+
   |  Value String (Length bytes)  |
   +-------------------------------+
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 6: Insert Field Line -- Indexed Name</p>
                        </section>
                        <section id="insert-with-literal-name">
                            <h4 id="rfc.section.4.3.3"><a href="#rfc.section.4.3.3">4.3.3.</a>&nbsp;<a
                                    href="#insert-with-literal-name">Insert with Literal Name</a></h4>
                            <div id="rfc.section.4.3.3.p.1">
                                <p>An encoder adds an entry to the dynamic table where both the field name and the field
                                    value are represented as string literals using an instruction that starts with the
                                    '01' 2-bit pattern.</p>
                            </div>
                            <div id="rfc.section.4.3.3.p.2">
                                <p>This is followed by the name represented as a 6-bit prefix string literal and the
                                    value represented as an 8-bit prefix string literal; see <a href="#string-literals"
                                        title="String Literals">Section 4.1.2</a>.</p>
                            </div>
                            <div id="rfc.figure.7">
                                <div>
                                    <pre>
     0   1   2   3   4   5   6   7
   +---+---+---+---+---+---+---+---+
   | 0 | 1 | H | Name Length (5+)  |
   +---+---+---+-------------------+
   |  Name String (Length bytes)   |
   +---+---------------------------+
   | H |     Value Length (7+)     |
   +---+---------------------------+
   |  Value String (Length bytes)  |
   +-------------------------------+
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 7: Insert Field Line -- New Name</p>
                        </section>
                        <section id="duplicate">
                            <h4 id="rfc.section.4.3.4"><a href="#rfc.section.4.3.4">4.3.4.</a>&nbsp;<a
                                    href="#duplicate">Duplicate</a></h4>
                            <div id="rfc.section.4.3.4.p.1">
                                <p>An encoder duplicates an existing entry in the dynamic table using an instruction
                                    that starts with the '000' 3-bit pattern. This is followed by the relative index of
                                    the existing entry represented as an integer with a 5-bit prefix; see <a
                                        href="#prefixed-integers" title="Prefixed Integers">Section 4.1.1</a>.</p>
                            </div>
                            <div id="fig-index-with-duplication"></div>
                            <div id="rfc.figure.8">
                                <div>
                                    <pre>
     0   1   2   3   4   5   6   7
   +---+---+---+---+---+---+---+---+
   | 0 | 0 | 0 |    Index (5+)     |
   +---+---+---+-------------------+
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 8: Duplicate</p>
                            <div id="rfc.section.4.3.4.p.2">
                                <p>The existing entry is reinserted into the dynamic table without resending either the
                                    name or the value. This is useful to avoid adding a reference to an older entry,
                                    which might block inserting new entries.</p>
                            </div>
                        </section>
                    </section>
                    <section id="decoder-instructions">
                        <h3 id="rfc.section.4.4"><a href="#rfc.section.4.4">4.4.</a>&nbsp;<a
                                href="#decoder-instructions">Decoder Instructions</a></h3>
                        <div id="rfc.section.4.4.p.1">
                            <p>A decoder sends decoder instructions on the decoder stream to inform the encoder about
                                the processing of field sections and table updates to ensure consistency of the dynamic
                                table.</p>
                        </div>
                        <section id="header-acknowledgment">
                            <h4 id="rfc.section.4.4.1"><a href="#rfc.section.4.4.1">4.4.1.</a>&nbsp;<a
                                    href="#header-acknowledgment">Section Acknowledgment</a></h4>
                            <div id="rfc.section.4.4.1.p.1">
                                <p>After processing an encoded field section whose declared Required Insert Count is not
                                    zero, the decoder emits a Section Acknowledgment instruction. The instruction starts
                                    with the '1' 1-bit pattern, followed by the field section's associated stream ID
                                    encoded as a 7-bit prefix integer; see <a href="#prefixed-integers"
                                        title="Prefixed Integers">Section 4.1.1</a>.</p>
                            </div>
                            <div id="rfc.section.4.4.1.p.2">
                                <p>This instruction is used as described in Sections <a href="#known-received-count"
                                        title="Known Received Count">2.1.4</a> and <a href="#state-synchronization"
                                        title="State Synchronization">2.2.2</a>.</p>
                            </div>
                            <div id="fig-header-ack"></div>
                            <div id="rfc.figure.9">
                                <div>
                                    <pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 1 |      Stream ID (7+)       |
+---+---------------------------+
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 9: Section Acknowledgment</p>
                            <div id="rfc.section.4.4.1.p.3">
                                <p>If an encoder receives a Section Acknowledgment instruction referring to a stream on
                                    which every encoded field section with a non-zero Required Insert Count has already
                                    been acknowledged, this <em class="bcp14">MUST</em> be treated as a connection error
                                    of type QPACK_DECODER_STREAM_ERROR.</p>
                            </div>
                            <div id="rfc.section.4.4.1.p.4">
                                <p>The Section Acknowledgment instruction might increase the Known Received Count; see
                                    <a href="#known-received-count" title="Known Received Count">Section 2.1.4</a>.
                                </p>
                            </div>
                        </section>
                        <section id="stream-cancellation">
                            <h4 id="rfc.section.4.4.2"><a href="#rfc.section.4.4.2">4.4.2.</a>&nbsp;<a
                                    href="#stream-cancellation">Stream Cancellation</a></h4>
                            <div id="rfc.section.4.4.2.p.1">
                                <p>When a stream is reset or reading is abandoned, the decoder emits a Stream
                                    Cancellation instruction. The instruction starts with the '01' 2-bit pattern,
                                    followed by the stream ID of the affected stream encoded as a 6-bit prefix integer.
                                </p>
                            </div>
                            <div id="rfc.section.4.4.2.p.2">
                                <p>This instruction is used as described in <a href="#state-synchronization"
                                        title="State Synchronization">Section 2.2.2</a>.</p>
                            </div>
                            <div id="fig-stream-cancel"></div>
                            <div id="rfc.figure.10">
                                <div>
                                    <pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 1 |     Stream ID (6+)    |
+---+---+-----------------------+
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 10: Stream Cancellation</p>
                        </section>
                        <section id="insert-count-increment">
                            <h4 id="rfc.section.4.4.3"><a href="#rfc.section.4.4.3">4.4.3.</a>&nbsp;<a
                                    href="#insert-count-increment">Insert Count Increment</a></h4>
                            <div id="rfc.section.4.4.3.p.1">
                                <p>The Insert Count Increment instruction starts with the '00' 2-bit pattern, followed
                                    by the Increment encoded as a 6-bit prefix integer. This instruction increases the
                                    Known Received Count (<a href="#known-received-count"
                                        title="Known Received Count">Section 2.1.4</a>) by the value of the Increment
                                    parameter. The decoder should send an Increment value that increases the Known
                                    Received Count to the total number of dynamic table insertions and duplications
                                    processed so far.</p>
                            </div>
                            <div id="fig-size-sync"></div>
                            <div id="rfc.figure.11">
                                <div>
                                    <pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 0 |     Increment (6+)    |
+---+---+-----------------------+
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 11: Insert Count Increment</p>
                            <div id="rfc.section.4.4.3.p.2">
                                <p>An encoder that receives an Increment field equal to zero, or one that increases the
                                    Known Received Count beyond what the encoder has sent, <em class="bcp14">MUST</em>
                                    treat this as a connection error of type QPACK_DECODER_STREAM_ERROR.</p>
                            </div>
                        </section>
                    </section>
                    <section id="field-line-representations">
                        <h3 id="rfc.section.4.5"><a href="#rfc.section.4.5">4.5.</a>&nbsp;<a
                                href="#field-line-representations">Field Line Representations</a></h3>
                        <div id="rfc.section.4.5.p.1">
                            <p>An encoded field section consists of a prefix and a possibly empty sequence of
                                representations defined in this section. Each representation corresponds to a single
                                field line. These representations reference the static table or the dynamic table in a
                                particular state, but they do not modify that state.</p>
                        </div>
                        <div id="rfc.section.4.5.p.2">
                            <p>Encoded field sections are carried in frames on streams defined by the enclosing
                                protocol.</p>
                        </div>
                        <section id="header-prefix">
                            <h4 id="rfc.section.4.5.1"><a href="#rfc.section.4.5.1">4.5.1.</a>&nbsp;<a
                                    href="#header-prefix">Encoded Field Section Prefix</a></h4>
                            <div id="rfc.section.4.5.1.p.1">
                                <p>Each encoded field section is prefixed with two integers. The Required Insert Count
                                    is encoded as an integer with an 8-bit prefix using the encoding described in <a
                                        href="#ric" title="Required Insert Count">Section 4.5.1.1</a>. The Base is
                                    encoded as a Sign bit ('S') and a Delta Base value with a 7-bit prefix; see <a
                                        href="#base" title="Base">Section 4.5.1.2</a>.</p>
                            </div>
                            <div id="fig-base-index"></div>
                            <div id="rfc.figure.12">
                                <div>
                                    <pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
|   Required Insert Count (8+)  |
+---+---------------------------+
| S |      Delta Base (7+)      |
+---+---------------------------+
|      Encoded Field Lines    ...
+-------------------------------+
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 12: Encoded Field Section</p>
                            <section id="ric">
                                <h5 id="rfc.section.4.5.1.1"><a href="#rfc.section.4.5.1.1">4.5.1.1.</a>&nbsp;<a
                                        href="#ric">Required Insert Count</a></h5>
                                <div id="rfc.section.4.5.1.1.p.1">
                                    <p>Required Insert Count identifies the state of the dynamic table needed to process
                                        the encoded field section. Blocking decoders use the Required Insert Count to
                                        determine when it is safe to process the rest of the field section.</p>
                                </div>
                                <div id="rfc.section.4.5.1.1.p.2" class="avoidbreakafter">
                                    <p>The encoder transforms the Required Insert Count as follows before encoding:</p>
                                </div>
                                <div id="rfc.section.4.5.1.1.p.3">
                                    <pre class="text">
   if ReqInsertCount == 0:
      EncInsertCount = 0
   else:
      EncInsertCount = (ReqInsertCount mod (2 * MaxEntries)) + 1
</pre>
                                </div>
                                <div id="rfc.section.4.5.1.1.p.4" class="avoidbreakafter">
                                    <p>Here <span class="tt">MaxEntries</span> is the maximum number of entries that the
                                        dynamic table can have. The smallest entry has empty name and value strings and
                                        has the size of 32. Hence, <span class="tt">MaxEntries</span> is calculated as:
                                    </p>
                                </div>
                                <div id="rfc.section.4.5.1.1.p.5">
                                    <pre class="text">
   MaxEntries = floor( MaxTableCapacity / 32 )
</pre>
                                </div>
                                <div id="rfc.section.4.5.1.1.p.6">
                                    <p><span class="tt">MaxTableCapacity</span> is the maximum capacity of the dynamic
                                        table as specified by the decoder; see <a href="#maximum-dynamic-table-capacity"
                                            title="Maximum Dynamic Table Capacity">Section 3.2.3</a>.</p>
                                </div>
                                <div id="rfc.section.4.5.1.1.p.7">
                                    <p>This encoding limits the length of the prefix on long-lived connections.</p>
                                </div>
                                <div id="rfc.section.4.5.1.1.p.8">
                                    <p>The decoder can reconstruct the Required Insert Count using an algorithm such as
                                        the following. If the decoder encounters a value of EncodedInsertCount that
                                        could not have been produced by a conformant encoder, it <em
                                            class="bcp14">MUST</em> treat this as a connection error of type
                                        QPACK_DECOMPRESSION_FAILED.</p>
                                </div>
                                <div id="rfc.section.4.5.1.1.p.9">
                                    <p><span class="tt">TotalNumberOfInserts</span> is the total number of inserts into
                                        the decoder's dynamic table.</p>
                                </div>
                                <div id="rfc.section.4.5.1.1.p.10">
                                    <pre class="text">
   FullRange = 2 * MaxEntries
   if EncodedInsertCount == 0:
      ReqInsertCount = 0
   else:
      if EncodedInsertCount &gt; FullRange:
         Error
      MaxValue = TotalNumberOfInserts + MaxEntries

      # MaxWrapped is the largest possible value of
      # ReqInsertCount that is 0 mod 2 * MaxEntries
      MaxWrapped = floor(MaxValue / FullRange) * FullRange
      ReqInsertCount = MaxWrapped + EncodedInsertCount - 1

      # If ReqInsertCount exceeds MaxValue, the Encoder's value
      # must have wrapped one fewer time
      if ReqInsertCount &gt; MaxValue:
         if ReqInsertCount &lt;= FullRange:
            Error
         ReqInsertCount -= FullRange

      # Value of 0 must be encoded as 0.
      if ReqInsertCount == 0:
         Error
</pre>
                                </div>
                                <div id="rfc.section.4.5.1.1.p.11">
                                    <p>For example, if the dynamic table is 100 bytes, then the Required Insert Count
                                        will be encoded modulo 6. If a decoder has received 10 inserts, then an encoded
                                        value of 4 indicates that the Required Insert Count is 9 for the field section.
                                    </p>
                                </div>
                            </section>
                            <section id="base">
                                <h5 id="rfc.section.4.5.1.2"><a href="#rfc.section.4.5.1.2">4.5.1.2.</a>&nbsp;<a
                                        href="#base">Base</a></h5>
                                <div id="rfc.section.4.5.1.2.p.1">
                                    <p>The Base is used to resolve references in the dynamic table as described in <a
                                            href="#relative-indexing" title="Relative Indexing">Section 3.2.5</a>.</p>
                                </div>
                                <div id="rfc.section.4.5.1.2.p.2" class="avoidbreakafter">
                                    <p>To save space, the Base is encoded relative to the Required Insert Count using a
                                        one-bit Sign ('S' in <a href="#fig-base-index"
                                            title="Encoded Field Section">Figure 12</a>) and the Delta Base value. A
                                        Sign bit of 0 indicates that the Base is greater than or equal to the value of
                                        the Required Insert Count; the decoder adds the value of Delta Base to the
                                        Required Insert Count to determine the value of the Base. A Sign bit of 1
                                        indicates that the Base is less than the Required Insert Count; the decoder
                                        subtracts the value of Delta Base from the Required Insert Count and also
                                        subtracts one to determine the value of the Base. That is:</p>
                                </div>
                                <div id="rfc.section.4.5.1.2.p.3">
                                    <pre class="text">
   if Sign == 0:
      Base = ReqInsertCount + DeltaBase
   else:
      Base = ReqInsertCount - DeltaBase - 1
</pre>
                                </div>
                                <div id="rfc.section.4.5.1.2.p.4">
                                    <p>A single-pass encoder determines the Base before encoding a field section. If the
                                        encoder inserted entries in the dynamic table while encoding the field section
                                        and is referencing them, Required Insert Count will be greater than the Base, so
                                        the encoded difference is negative and the Sign bit is set to 1. If the field
                                        section was not encoded using representations that reference the most recent
                                        entry in the table and did not insert any new entries, the Base will be greater
                                        than the Required Insert Count, so the encoded difference will be positive and
                                        the Sign bit is set to 0.</p>
                                </div>
                                <div id="rfc.section.4.5.1.2.p.5">
                                    <p>The value of Base <em class="bcp14">MUST NOT</em> be negative. Though the
                                        protocol might operate correctly with a negative Base using post-Base indexing,
                                        it is unnecessary and inefficient. An endpoint <em class="bcp14">MUST</em> treat
                                        a field block with a Sign bit of 1 as invalid if the value of Required Insert
                                        Count is less than or equal to the value of Delta Base.</p>
                                </div>
                                <div id="rfc.section.4.5.1.2.p.6">
                                    <p>An encoder that produces table updates before encoding a field section might set
                                        Base to the value of Required Insert Count. In such a case, both the Sign bit
                                        and the Delta Base will be set to zero.</p>
                                </div>
                                <div id="rfc.section.4.5.1.2.p.7">
                                    <p>A field section that was encoded without references to the dynamic table can use
                                        any value for the Base; setting Delta Base to zero is one of the most efficient
                                        encodings.</p>
                                </div>
                                <div id="rfc.section.4.5.1.2.p.8">
                                    <p>For example, with a Required Insert Count of 9, a decoder receives a Sign bit of
                                        1 and a Delta Base of 2. This sets the Base to 6 and enables post-Base indexing
                                        for three entries. In this example, a relative index of 1 refers to the fifth
                                        entry that was added to the table; a post-Base index of 1 refers to the eighth
                                        entry.</p>
                                </div>
                            </section>
                        </section>
                        <section id="indexed-field-line">
                            <h4 id="rfc.section.4.5.2"><a href="#rfc.section.4.5.2">4.5.2.</a>&nbsp;<a
                                    href="#indexed-field-line">Indexed Field Line</a></h4>
                            <div id="rfc.section.4.5.2.p.1">
                                <p>An indexed field line representation identifies an entry in the static table or an
                                    entry in the dynamic table with an absolute index less than the value of the Base.
                                </p>
                            </div>
                            <div id="rfc.figure.13">
                                <div>
                                    <pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 1 | T |      Index (6+)       |
+---+---+-----------------------+
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 13: Indexed Field Line</p>
                            <div id="rfc.section.4.5.2.p.2">
                                <p>This representation starts with the '1' 1-bit pattern, followed by the 'T' bit,
                                    indicating whether the reference is into the static or dynamic table. The 6-bit
                                    prefix integer (<a href="#prefixed-integers" title="Prefixed Integers">Section
                                        4.1.1</a>) that follows is used to locate the table entry for the field line.
                                    When T=1, the number represents the static table index; when T=0, the number is the
                                    relative index of the entry in the dynamic table.</p>
                            </div>
                        </section>
                        <section id="indexed-field-line-with-post-base-index">
                            <h4 id="rfc.section.4.5.3"><a href="#rfc.section.4.5.3">4.5.3.</a>&nbsp;<a
                                    href="#indexed-field-line-with-post-base-index">Indexed Field Line with Post-Base
                                    Index</a></h4>
                            <div id="rfc.section.4.5.3.p.1">
                                <p>An indexed field line with post-Base index representation identifies an entry in the
                                    dynamic table with an absolute index greater than or equal to the value of the Base.
                                </p>
                            </div>
                            <div id="rfc.figure.14">
                                <div>
                                    <pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 0 | 0 | 1 |  Index (4+)   |
+---+---+---+---+---------------+
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 14: Indexed Field Line with Post-Base Index</p>
                            <div id="rfc.section.4.5.3.p.2">
                                <p>This representation starts with the '0001' 4-bit pattern. This is followed by the
                                    post-Base index (<a href="#post-base" title="Post-Base Indexing">Section 3.2.6</a>)
                                    of the matching field line, represented as an integer with a 4-bit prefix; see <a
                                        href="#prefixed-integers" title="Prefixed Integers">Section 4.1.1</a>.</p>
                            </div>
                        </section>
                        <section id="literal-name-reference">
                            <h4 id="rfc.section.4.5.4"><a href="#rfc.section.4.5.4">4.5.4.</a>&nbsp;<a
                                    href="#literal-name-reference">Literal Field Line with Name Reference</a></h4>
                            <div id="rfc.section.4.5.4.p.1">
                                <p>A literal field line with name reference representation encodes a field line where
                                    the field name matches the field name of an entry in the static table or the field
                                    name of an entry in the dynamic table with an absolute index less than the value of
                                    the Base.</p>
                            </div>
                            <div id="rfc.figure.15">
                                <div>
                                    <pre>
     0   1   2   3   4   5   6   7
   +---+---+---+---+---+---+---+---+
   | 0 | 1 | N | T |Name Index (4+)|
   +---+---+---+---+---------------+
   | H |     Value Length (7+)     |
   +---+---------------------------+
   |  Value String (Length bytes)  |
   +-------------------------------+
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 15: Literal Field Line with Name Reference</p>
                            <div id="rfc.section.4.5.4.p.2">
                                <p>This representation starts with the '01' 2-bit pattern. The following bit, 'N',
                                    indicates whether an intermediary is permitted to add this field line to the dynamic
                                    table on subsequent hops. When the 'N' bit is set, the encoded field line <em
                                        class="bcp14">MUST</em> always be encoded with a literal representation. In
                                    particular, when a peer sends a field line that it received represented as a literal
                                    field line with the 'N' bit set, it <em class="bcp14">MUST</em> use a literal
                                    representation to forward this field line. This bit is intended for protecting field
                                    values that are not to be put at risk by compressing them; see <a
                                        href="#probing-dynamic-table-state" title="Probing Dynamic Table State">Section
                                        7.1</a> for more details.</p>
                            </div>
                            <div id="rfc.section.4.5.4.p.3">
                                <p>The fourth ('T') bit indicates whether the reference is to the static or dynamic
                                    table. The 4-bit prefix integer (<a href="#prefixed-integers"
                                        title="Prefixed Integers">Section 4.1.1</a>) that follows is used to locate the
                                    table entry for the field name. When T=1, the number represents the static table
                                    index; when T=0, the number is the relative index of the entry in the dynamic table.
                                </p>
                            </div>
                            <div id="rfc.section.4.5.4.p.4">
                                <p>Only the field name is taken from the dynamic table entry; the field value is encoded
                                    as an 8-bit prefix string literal; see <a href="#string-literals"
                                        title="String Literals">Section 4.1.2</a>.</p>
                            </div>
                        </section>
                        <section id="literal-field-line-with-post-base-name-reference">
                            <h4 id="rfc.section.4.5.5"><a href="#rfc.section.4.5.5">4.5.5.</a>&nbsp;<a
                                    href="#literal-field-line-with-post-base-name-reference">Literal Field Line with
                                    Post-Base Name Reference</a></h4>
                            <div id="rfc.section.4.5.5.p.1">
                                <p>A literal field line with post-Base name reference representation encodes a field
                                    line where the field name matches the field name of a dynamic table entry with an
                                    absolute index greater than or equal to the value of the Base.</p>
                            </div>
                            <div id="rfc.figure.16">
                                <div>
                                    <pre>
     0   1   2   3   4   5   6   7
   +---+---+---+---+---+---+---+---+
   | 0 | 0 | 0 | 0 | N |NameIdx(3+)|
   +---+---+---+---+---+-----------+
   | H |     Value Length (7+)     |
   +---+---------------------------+
   |  Value String (Length bytes)  |
   +-------------------------------+
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 16: Literal Field Line with Post-Base Name Reference</p>
                            <div id="rfc.section.4.5.5.p.2">
                                <p>This representation starts with the '0000' 4-bit pattern. The fifth bit is the 'N'
                                    bit as described in <a href="#literal-name-reference"
                                        title="Literal Field Line with Name Reference">Section 4.5.4</a>. This is
                                    followed by a post-Base index of the dynamic table entry (<a href="#post-base"
                                        title="Post-Base Indexing">Section 3.2.6</a>) encoded as an integer with a 3-bit
                                    prefix; see <a href="#prefixed-integers" title="Prefixed Integers">Section
                                        4.1.1</a>.</p>
                            </div>
                            <div id="rfc.section.4.5.5.p.3">
                                <p>Only the field name is taken from the dynamic table entry; the field value is encoded
                                    as an 8-bit prefix string literal; see <a href="#string-literals"
                                        title="String Literals">Section 4.1.2</a>.</p>
                            </div>
                        </section>
                        <section id="literal-field-line-with-literal-name">
                            <h4 id="rfc.section.4.5.6"><a href="#rfc.section.4.5.6">4.5.6.</a>&nbsp;<a
                                    href="#literal-field-line-with-literal-name">Literal Field Line with Literal
                                    Name</a></h4>
                            <div id="rfc.section.4.5.6.p.1">
                                <p>The literal field line with literal name representation encodes a field name and a
                                    field value as string literals.</p>
                            </div>
                            <div id="rfc.figure.17">
                                <div>
                                    <pre>
     0   1   2   3   4   5   6   7
   +---+---+---+---+---+---+---+---+
   | 0 | 0 | 1 | N | H |NameLen(3+)|
   +---+---+---+---+---+-----------+
   |  Name String (Length bytes)   |
   +---+---------------------------+
   | H |     Value Length (7+)     |
   +---+---------------------------+
   |  Value String (Length bytes)  |
   +-------------------------------+
</pre>
                                </div>
                            </div>
                            <p class="figure">Figure 17: Literal Field Line with Literal Name</p>
                            <div id="rfc.section.4.5.6.p.2">
                                <p>This representation starts with the '001' 3-bit pattern. The fourth bit is the 'N'
                                    bit as described in <a href="#literal-name-reference"
                                        title="Literal Field Line with Name Reference">Section 4.5.4</a>. The name
                                    follows, represented as a 4-bit prefix string literal, then the value, represented
                                    as an 8-bit prefix string literal; see <a href="#string-literals"
                                        title="String Literals">Section 4.1.2</a>.</p>
                            </div>
                        </section>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="configuration">
                    <h2 id="rfc.section.5" class="np"><a href="#rfc.section.5">5.</a>&nbsp;<a
                            href="#configuration">Configuration</a></h2>
                    <div id="rfc.section.5.p.1" class="avoidbreakafter">
                        <p>QPACK defines two settings for the HTTP/3 SETTINGS frame:</p>
                    </div>
                    <div id="rfc.section.5.p.2">
                        <dl>
                            <dt>SETTINGS_QPACK_MAX_TABLE_CAPACITY (0x01):</dt>
                            <dd style="margin-left: 1.5em">
                                <div>The default value is zero. See <a href="#header-table-dynamic"
                                        title="Dynamic Table">Section 3.2</a> for usage. This is the equivalent of the
                                    SETTINGS_HEADER_TABLE_SIZE from HTTP/2.</div>
                            </dd>
                            <dt>SETTINGS_QPACK_BLOCKED_STREAMS (0x07):</dt>
                            <dd style="margin-left: 1.5em">
                                <div>The default value is zero. See <a href="#blocked-streams"
                                        title="Blocked Streams">Section 2.1.2</a>.</div>
                            </dd>
                        </dl>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="error-handling">
                    <h2 id="rfc.section.6" class="np"><a href="#rfc.section.6">6.</a>&nbsp;<a
                            href="#error-handling">Error Handling</a></h2>
                    <div id="rfc.section.6.p.1" class="avoidbreakafter">
                        <p>The following error codes are defined for HTTP/3 to indicate failures of QPACK that prevent
                            the stream or connection from continuing:</p>
                    </div>
                    <div id="rfc.section.6.p.2">
                        <dl>
                            <dt>QPACK_DECOMPRESSION_FAILED (0x0200):</dt>
                            <dd style="margin-left: 1.5em">
                                <div>The decoder failed to interpret an encoded field section and is not able to
                                    continue decoding that field section.</div>
                            </dd>
                            <dt>QPACK_ENCODER_STREAM_ERROR (0x0201):</dt>
                            <dd style="margin-left: 1.5em">
                                <div>The decoder failed to interpret an encoder instruction received on the encoder
                                    stream.</div>
                            </dd>
                            <dt>QPACK_DECODER_STREAM_ERROR (0x0202):</dt>
                            <dd style="margin-left: 1.5em">
                                <div>The encoder failed to interpret a decoder instruction received on the decoder
                                    stream.</div>
                            </dd>
                        </dl>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="security-considerations">
                    <h2 id="rfc.section.7" class="np"><a href="#rfc.section.7">7.</a>&nbsp;<a
                            href="#security-considerations">Security Considerations</a></h2>
                    <div id="rfc.section.7.p.1" class="avoidbreakafter">
                        <p>This section describes potential areas of security concern with QPACK:</p>
                    </div>
                    <div id="rfc.section.7.p.2">
                        <ul>
                            <li>Use of compression as a length-based oracle for verifying guesses about secrets that are
                                compressed into a shared compression context.</li>
                            <li>Denial of service resulting from exhausting processing or memory capacity at a decoder.
                            </li>
                        </ul>
                    </div>
                    <section id="probing-dynamic-table-state">
                        <h3 id="rfc.section.7.1"><a href="#rfc.section.7.1">7.1.</a>&nbsp;<a
                                href="#probing-dynamic-table-state">Probing Dynamic Table State</a></h3>
                        <div id="rfc.section.7.1.p.1">
                            <p>QPACK reduces the encoded size of field sections by exploiting the redundancy inherent in
                                protocols like HTTP. The ultimate goal of this is to reduce the amount of data that is
                                required to send HTTP requests or responses.</p>
                        </div>
                        <div id="rfc.section.7.1.p.2">
                            <p>The compression context used to encode header and trailer fields can be probed by an
                                attacker who can both define fields to be encoded and transmitted and observe the length
                                of those fields once they are encoded. When an attacker can do both, they can adaptively
                                modify requests in order to confirm guesses about the dynamic table state. If a guess is
                                compressed into a shorter length, the attacker can observe the encoded length and infer
                                that the guess was correct.</p>
                        </div>
                        <div id="rfc.section.7.1.p.3">
                            <p>This is possible even over the Transport Layer Security Protocol (<a href="#TLS"><cite
                                        title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS]</cite></a>)
                                and the QUIC Transport Protocol (<a href="#QUIC-TRANSPORT"><cite
                                        title="QUIC: A UDP-Based Multiplexed and Secure Transport">[QUIC-TRANSPORT]</cite></a>),
                                because while TLS and QUIC provide confidentiality protection for content, they only
                                provide a limited amount of protection for the length of that content.</p>
                        </div>
                        <div id="rfc.section.7.1.p.4">
                            <aside>
                                <div id="rfc.section.7.1.p.4.1">
                                    <p>Note: Padding schemes only provide limited protection against an attacker with
                                        these capabilities, potentially only forcing an increased number of guesses to
                                        learn the length associated with a given guess. Padding schemes also work
                                        directly against compression by increasing the number of bits that are
                                        transmitted.</p>
                                </div>
                            </aside>
                        </div>
                        <div id="rfc.section.7.1.p.5">
                            <p>Attacks like CRIME (<a href="#CRIME"><cite title="CRIME">[CRIME]</cite></a>) demonstrated
                                the existence of these general attacker capabilities. The specific attack exploited the
                                fact that DEFLATE (<a href="#RFC1951"><cite
                                        title="DEFLATE Compressed Data Format Specification version 1.3">[RFC1951]</cite></a>)
                                removes redundancy based on prefix matching. This permitted the attacker to confirm
                                guesses a character at a time, reducing an exponential-time attack into a linear-time
                                attack.</p>
                        </div>
                        <section id="applicability-to-qpack-and-http">
                            <h4 id="rfc.section.7.1.1"><a href="#rfc.section.7.1.1">7.1.1.</a>&nbsp;<a
                                    href="#applicability-to-qpack-and-http">Applicability to QPACK and HTTP</a></h4>
                            <div id="rfc.section.7.1.1.p.1">
                                <p>QPACK mitigates, but does not completely prevent, attacks modeled on CRIME (<a
                                        href="#CRIME"><cite title="CRIME">[CRIME]</cite></a>) by forcing a guess to
                                    match an entire field line rather than individual characters. An attacker can only
                                    learn whether a guess is correct or not, so the attacker is reduced to a brute-force
                                    guess for the field values associated with a given field name.</p>
                            </div>
                            <div id="rfc.section.7.1.1.p.2">
                                <p>Therefore, the viability of recovering specific field values depends on the entropy
                                    of values. As a result, values with high entropy are unlikely to be recovered
                                    successfully. However, values with low entropy remain vulnerable.</p>
                            </div>
                            <div id="rfc.section.7.1.1.p.3">
                                <p>Attacks of this nature are possible any time that two mutually distrustful entities
                                    control requests or responses that are placed onto a single HTTP/3 connection. If
                                    the shared QPACK compressor permits one entity to add entries to the dynamic table,
                                    and the other to refer to those entries while encoding chosen field lines, then the
                                    attacker (the second entity) can learn the state of the table by observing the
                                    length of the encoded output.</p>
                            </div>
                            <div id="rfc.section.7.1.1.p.4" class="avoidbreakafter">
                                <p>For example, requests or responses from mutually distrustful entities can occur when
                                    an intermediary either:</p>
                            </div>
                            <div id="rfc.section.7.1.1.p.5">
                                <ul>
                                    <li>sends requests from multiple clients on a single connection toward an origin
                                        server, or</li>
                                    <li>takes responses from multiple origin servers and places them on a shared
                                        connection toward a client.</li>
                                </ul>
                            </div>
                            <div id="rfc.section.7.1.1.p.6">
                                <p>Web browsers also need to assume that requests made on the same connection by
                                    different web origins (<a href="#RFC6454"><cite
                                            title="The Web Origin Concept">[RFC6454]</cite></a>) are made by mutually
                                    distrustful entities. Other scenarios involving mutually distrustful entities are
                                    also possible.</p>
                            </div>
                        </section>
                        <section id="mitigation">
                            <h4 id="rfc.section.7.1.2"><a href="#rfc.section.7.1.2">7.1.2.</a>&nbsp;<a
                                    href="#mitigation">Mitigation</a></h4>
                            <div id="rfc.section.7.1.2.p.1">
                                <p>Users of HTTP that require confidentiality for header or trailer fields can use
                                    values with entropy sufficient to make guessing infeasible. However, this is
                                    impractical as a general solution because it forces all users of HTTP to take steps
                                    to mitigate attacks. It would impose new constraints on how HTTP is used.</p>
                            </div>
                            <div id="rfc.section.7.1.2.p.2">
                                <p>Rather than impose constraints on users of HTTP, an implementation of QPACK can
                                    instead constrain how compression is applied in order to limit the potential for
                                    dynamic table probing.</p>
                            </div>
                            <div id="rfc.section.7.1.2.p.3">
                                <p>An ideal solution segregates access to the dynamic table based on the entity that is
                                    constructing the message. Field values that are added to the table are attributed to
                                    an entity, and only the entity that created a particular value can extract that
                                    value.</p>
                            </div>
                            <div id="rfc.section.7.1.2.p.4">
                                <p>To improve compression performance of this option, certain entries might be tagged as
                                    being public. For example, a web browser might make the values of the
                                    Accept-Encoding header field available in all requests.</p>
                            </div>
                            <div id="rfc.section.7.1.2.p.5">
                                <p>An encoder without good knowledge of the provenance of field values might instead
                                    introduce a penalty for many field lines with the same field name and different
                                    values. This penalty could cause a large number of attempts to guess a field value
                                    to result in the field not being compared to the dynamic table entries in future
                                    messages, effectively preventing further guesses.</p>
                            </div>
                            <div id="rfc.section.7.1.2.p.6">
                                <p>This response might be made inversely proportional to the length of the field value.
                                    Disabling access to the dynamic table for a given field name might occur for shorter
                                    values more quickly or with higher probability than for longer values.</p>
                            </div>
                            <div id="rfc.section.7.1.2.p.7">
                                <p>This mitigation is most effective between two endpoints. If messages are re-encoded
                                    by an intermediary without knowledge of which entity constructed a given message,
                                    the intermediary could inadvertently merge compression contexts that the original
                                    encoder had specifically kept separate.</p>
                            </div>
                            <div id="rfc.section.7.1.2.p.8">
                                <aside>
                                    <div id="rfc.section.7.1.2.p.8.1">
                                        <p>Note: Simply removing entries corresponding to the field from the dynamic
                                            table can be ineffectual if the attacker has a reliable way of causing
                                            values to be reinstalled. For example, a request to load an image in a web
                                            browser typically includes the Cookie header field (a potentially highly
                                            valued target for this sort of attack), and websites can easily force an
                                            image to be loaded, thereby refreshing the entry in the dynamic table.</p>
                                    </div>
                                </aside>
                            </div>
                        </section>
                        <section id="never-indexed-literals">
                            <h4 id="rfc.section.7.1.3"><a href="#rfc.section.7.1.3">7.1.3.</a>&nbsp;<a
                                    href="#never-indexed-literals">Never-Indexed Literals</a></h4>
                            <div id="rfc.section.7.1.3.p.1">
                                <p>Implementations can also choose to protect sensitive fields by not compressing them
                                    and instead encoding their value as literals.</p>
                            </div>
                            <div id="rfc.section.7.1.3.p.2">
                                <p>Refusing to insert a field line into the dynamic table is only effective if doing so
                                    is avoided on all hops. The never-indexed literal bit (see <a
                                        href="#literal-name-reference"
                                        title="Literal Field Line with Name Reference">Section 4.5.4</a>) can be used to
                                    signal to intermediaries that a particular value was intentionally sent as a
                                    literal.</p>
                            </div>
                            <div id="rfc.section.7.1.3.p.3">
                                <p>An intermediary <em class="bcp14">MUST NOT</em> re-encode a value that uses a literal
                                    representation with the 'N' bit set with another representation that would index it.
                                    If QPACK is used for re-encoding, a literal representation with the 'N' bit set <em
                                        class="bcp14">MUST</em> be used. If HPACK is used for re-encoding, the
                                    never-indexed literal representation (see <a
                                        href="https://www.rfc-editor.org/rfc/rfc7541.html#section-6.2.3">Section
                                        6.2.3</a> of <a href="#RFC7541"><cite
                                            title="HPACK: Header Compression for HTTP/2">[RFC7541]</cite></a>) <em
                                        class="bcp14">MUST</em> be used.</p>
                            </div>
                            <div id="rfc.section.7.1.3.p.4">
                                <p>The choice to mark that a field value should never be indexed depends on several
                                    factors. Since QPACK does not protect against guessing an entire field value, short
                                    or low-entropy values are more readily recovered by an adversary. Therefore, an
                                    encoder might choose not to index values with low entropy.</p>
                            </div>
                            <div id="rfc.section.7.1.3.p.5">
                                <p>An encoder might also choose not to index values for fields that are considered to be
                                    highly valuable or sensitive to recovery, such as the Cookie or Authorization header
                                    fields.</p>
                            </div>
                            <div id="rfc.section.7.1.3.p.6">
                                <p>On the contrary, an encoder might prefer indexing values for fields that have little
                                    or no value if they were exposed. For instance, a User-Agent header field does not
                                    commonly vary between requests and is sent to any server. In that case, confirmation
                                    that a particular User-Agent value has been used provides little value.</p>
                            </div>
                            <div id="rfc.section.7.1.3.p.7">
                                <p>Note that these criteria for deciding to use a never-indexed literal representation
                                    will evolve over time as new attacks are discovered.</p>
                            </div>
                        </section>
                    </section>
                    <section id="static-huffman-encoding">
                        <h3 id="rfc.section.7.2"><a href="#rfc.section.7.2">7.2.</a>&nbsp;<a
                                href="#static-huffman-encoding">Static Huffman Encoding</a></h3>
                        <div id="rfc.section.7.2.p.1">
                            <p>There is no currently known attack against a static Huffman encoding. A study has shown
                                that using a static Huffman encoding table created an information leakage; however, this
                                same study concluded that an attacker could not take advantage of this information
                                leakage to recover any meaningful amount of information (see <a href="#PETAL"><cite
                                        title="PETAL: Preset Encoding Table Information Leakage">[PETAL]</cite></a>).
                            </p>
                        </div>
                    </section>
                    <section id="memory-consumption">
                        <h3 id="rfc.section.7.3"><a href="#rfc.section.7.3">7.3.</a>&nbsp;<a
                                href="#memory-consumption">Memory Consumption</a></h3>
                        <div id="rfc.section.7.3.p.1">
                            <p>An attacker can try to cause an endpoint to exhaust its memory. QPACK is designed to
                                limit both the peak and stable amounts of memory allocated by an endpoint.</p>
                        </div>
                        <div id="rfc.section.7.3.p.2">
                            <p>QPACK uses the definition of the maximum size of the dynamic table and the maximum number
                                of blocking streams to limit the amount of memory the encoder can cause the decoder to
                                consume. In HTTP/3, these values are controlled by the decoder through the settings
                                parameters SETTINGS_QPACK_MAX_TABLE_CAPACITY and SETTINGS_QPACK_BLOCKED_STREAMS,
                                respectively (see <a href="#maximum-dynamic-table-capacity"
                                    title="Maximum Dynamic Table Capacity">Section 3.2.3</a> and <a
                                    href="#blocked-streams" title="Blocked Streams">Section 2.1.2</a>). The limit on the
                                size of the dynamic table takes into account the size of the data stored in the dynamic
                                table, plus a small allowance for overhead. The limit on the number of blocked streams
                                is only a proxy for the maximum amount of memory required by the decoder. The actual
                                maximum amount of memory will depend on how much memory the decoder uses to track each
                                blocked stream.</p>
                        </div>
                        <div id="rfc.section.7.3.p.3">
                            <p>A decoder can limit the amount of state memory used for the dynamic table by setting an
                                appropriate value for the maximum size of the dynamic table. In HTTP/3, this is realized
                                by setting an appropriate value for the SETTINGS_QPACK_MAX_TABLE_CAPACITY parameter. An
                                encoder can limit the amount of state memory it uses by choosing a smaller dynamic table
                                size than the decoder allows and signaling this to the decoder (see <a
                                    href="#set-dynamic-capacity" title="Set Dynamic Table Capacity">Section 4.3.1</a>).
                            </p>
                        </div>
                        <div id="rfc.section.7.3.p.4">
                            <p>A decoder can limit the amount of state memory used for blocked streams by setting an
                                appropriate value for the maximum number of blocked streams. In HTTP/3, this is realized
                                by setting an appropriate value for the SETTINGS_QPACK_BLOCKED_STREAMS parameter.
                                Streams that risk becoming blocked consume no additional state memory on the encoder.
                            </p>
                        </div>
                        <div id="rfc.section.7.3.p.5">
                            <p>An encoder allocates memory to track all dynamic table references in unacknowledged field
                                sections. An implementation can directly limit the amount of state memory by only using
                                as many references to the dynamic table as it wishes to track; no signaling to the
                                decoder is required. However, limiting references to the dynamic table will reduce
                                compression effectiveness.</p>
                        </div>
                        <div id="rfc.section.7.3.p.6">
                            <p>The amount of temporary memory consumed by an encoder or decoder can be limited by
                                processing field lines sequentially. A decoder implementation does not need to retain a
                                complete list of field lines while decoding a field section. An encoder implementation
                                does not need to retain a complete list of field lines while encoding a field section if
                                it is using a single-pass algorithm. Note that it might be necessary for an application
                                to retain a complete list of field lines for other reasons; even if QPACK does not force
                                this to occur, application constraints might make this necessary.</p>
                        </div>
                        <div id="rfc.section.7.3.p.7">
                            <p>While the negotiated limit on the dynamic table size accounts for much of the memory that
                                can be consumed by a QPACK implementation, data that cannot be immediately sent due to
                                flow control is not affected by this limit. Implementations should limit the size of
                                unsent data, especially on the decoder stream where flexibility to choose what to send
                                is limited. Possible responses to an excess of unsent data might include limiting the
                                ability of the peer to open new streams, reading only from the encoder stream, or
                                closing the connection.</p>
                        </div>
                    </section>
                    <section id="implementation-limits">
                        <h3 id="rfc.section.7.4"><a href="#rfc.section.7.4">7.4.</a>&nbsp;<a
                                href="#implementation-limits">Implementation Limits</a></h3>
                        <div id="rfc.section.7.4.p.1">
                            <p>An implementation of QPACK needs to ensure that large values for integers, long encoding
                                for integers, or long string literals do not create security weaknesses.</p>
                        </div>
                        <div id="rfc.section.7.4.p.2">
                            <p>An implementation has to set a limit for the values it accepts for integers, as well as
                                for the encoded length; see <a href="#prefixed-integers"
                                    title="Prefixed Integers">Section 4.1.1</a>. In the same way, it has to set a limit
                                to the length it accepts for string literals; see <a href="#string-literals"
                                    title="String Literals">Section 4.1.2</a>. These limits <em
                                    class="bcp14">SHOULD</em> be large enough to process the largest individual field
                                the HTTP implementation can be configured to accept.</p>
                        </div>
                        <div id="rfc.section.7.4.p.3">
                            <p>If an implementation encounters a value larger than it is able to decode, this <em
                                    class="bcp14">MUST</em> be treated as a stream error of type
                                QPACK_DECOMPRESSION_FAILED if on a request stream or a connection error of the
                                appropriate type if on the encoder or decoder stream.</p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="iana-considerations">
                    <h2 id="rfc.section.8" class="np"><a href="#rfc.section.8">8.</a>&nbsp;<a
                            href="#iana-considerations">IANA Considerations</a></h2>
                    <div id="rfc.section.8.p.1">
                        <p>This document makes multiple registrations in the registries defined by <a
                                href="#HTTP3"><cite title="HTTP/3">[HTTP/3]</cite></a>. The allocations created by this
                            document are all assigned permanent status and list a change controller of the IETF and a
                            contact of the HTTP working group (ietf-http-wg@w3.org).</p>
                    </div>
                    <section id="settings-registration">
                        <h3 id="rfc.section.8.1"><a href="#rfc.section.8.1">8.1.</a>&nbsp;<a
                                href="#settings-registration">Settings Registration</a></h3>
                        <div id="rfc.section.8.1.p.1">
                            <p>This document specifies two settings. The entries in the following table are registered
                                in the "HTTP/3 Settings" registry established in <a href="#HTTP3"><cite
                                        title="HTTP/3">[HTTP/3]</cite></a>.</p>
                        </div>
                        <div class="table table-condensed table-striped">
                            <table class="v3 text-center">
                                <caption>Table 1: Additions to the HTTP/3 Settings Registry</caption>
                                <thead>
                                    <tr>
                                        <th class="text-left" colspan="1" rowspan="1">Setting Name</th>
                                        <th class="center" colspan="1" rowspan="1">Code</th>
                                        <th class="text-left" colspan="1" rowspan="1">Specification</th>
                                        <th class="text-left" colspan="1" rowspan="1">Default</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">QPACK_MAX_TABLE_CAPACITY</td>
                                        <td class="center" colspan="1" rowspan="1">0x01</td>
                                        <td class="text-left" colspan="1" rowspan="1"><a href="#configuration"
                                                title="Configuration">Section 5</a></td>
                                        <td class="text-left" colspan="1" rowspan="1">0</td>
                                    </tr>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">QPACK_BLOCKED_STREAMS</td>
                                        <td class="center" colspan="1" rowspan="1">0x07</td>
                                        <td class="text-left" colspan="1" rowspan="1"><a href="#configuration"
                                                title="Configuration">Section 5</a></td>
                                        <td class="text-left" colspan="1" rowspan="1">0</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div id="rfc.section.8.1.p.2">
                            <p>For formatting reasons, the setting names here are abbreviated by removing the
                                'SETTINGS_' prefix.</p>
                        </div>
                    </section>
                    <section id="stream-type-registration">
                        <h3 id="rfc.section.8.2"><a href="#rfc.section.8.2">8.2.</a>&nbsp;<a
                                href="#stream-type-registration">Stream Type Registration</a></h3>
                        <div id="rfc.section.8.2.p.1">
                            <p>This document specifies two stream types. The entries in the following table are
                                registered in the "HTTP/3 Stream Types" registry established in <a href="#HTTP3"><cite
                                        title="HTTP/3">[HTTP/3]</cite></a>.</p>
                        </div>
                        <div class="table table-condensed table-striped">
                            <table class="v3 text-center">
                                <caption>Table 2: Additions to the HTTP/3 Stream Types Registry</caption>
                                <thead>
                                    <tr>
                                        <th class="text-left" colspan="1" rowspan="1">Stream Type</th>
                                        <th class="center" colspan="1" rowspan="1">Code</th>
                                        <th class="text-left" colspan="1" rowspan="1">Specification</th>
                                        <th class="text-left" colspan="1" rowspan="1">Sender</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">QPACK Encoder Stream</td>
                                        <td class="center" colspan="1" rowspan="1">0x02</td>
                                        <td class="text-left" colspan="1" rowspan="1"><a href="#enc-dec-stream-def"
                                                title="Encoder and Decoder Streams">Section 4.2</a></td>
                                        <td class="text-left" colspan="1" rowspan="1">Both</td>
                                    </tr>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">QPACK Decoder Stream</td>
                                        <td class="center" colspan="1" rowspan="1">0x03</td>
                                        <td class="text-left" colspan="1" rowspan="1"><a href="#enc-dec-stream-def"
                                                title="Encoder and Decoder Streams">Section 4.2</a></td>
                                        <td class="text-left" colspan="1" rowspan="1">Both</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </section>
                    <section id="error-code-registration">
                        <h3 id="rfc.section.8.3"><a href="#rfc.section.8.3">8.3.</a>&nbsp;<a
                                href="#error-code-registration">Error Code Registration</a></h3>
                        <div id="rfc.section.8.3.p.1">
                            <p>This document specifies three error codes. The entries in the following table are
                                registered in the "HTTP/3 Error Codes" registry established in <a href="#HTTP3"><cite
                                        title="HTTP/3">[HTTP/3]</cite></a>.</p>
                        </div>
                        <div class="table table-condensed table-striped">
                            <table class="v3 text-center">
                                <caption>Table 3: Additions to the HTTP/3 Error Codes Registry</caption>
                                <thead>
                                    <tr>
                                        <th class="text-left" colspan="1" rowspan="1">Name</th>
                                        <th class="text-left" colspan="1" rowspan="1">Code</th>
                                        <th class="text-left" colspan="1" rowspan="1">Description</th>
                                        <th class="text-left" colspan="1" rowspan="1">Specification</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">QPACK_DECOMPRESSION_FAILED</td>
                                        <td class="text-left" colspan="1" rowspan="1">0x0200</td>
                                        <td class="text-left" colspan="1" rowspan="1">Decoding of a field section failed
                                        </td>
                                        <td class="text-left" colspan="1" rowspan="1"><a href="#error-handling"
                                                title="Error Handling">Section 6</a></td>
                                    </tr>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">QPACK_ENCODER_STREAM_ERROR</td>
                                        <td class="text-left" colspan="1" rowspan="1">0x0201</td>
                                        <td class="text-left" colspan="1" rowspan="1">Error on the encoder stream</td>
                                        <td class="text-left" colspan="1" rowspan="1"><a href="#error-handling"
                                                title="Error Handling">Section 6</a></td>
                                    </tr>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">QPACK_DECODER_STREAM_ERROR</td>
                                        <td class="text-left" colspan="1" rowspan="1">0x0202</td>
                                        <td class="text-left" colspan="1" rowspan="1">Error on the decoder stream</td>
                                        <td class="text-left" colspan="1" rowspan="1"><a href="#error-handling"
                                                title="Error Handling">Section 6</a></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </section>
                </section>
                <section class="np">
                    <div id="rfc.references">
                        <h2 id="rfc.section.9"><a href="#rfc.section.9">9.</a> References</h2>
                        <section>
                            <div id="rfc.references.2">
                                <h3 id="rfc.section.9.1"><a href="#rfc.section.9.1">9.1.</a> Normative References</h3>
                                <dl class="dl-horizontal">
                                    <dt id="HTTP">[<a href="#HTTP" class="smpl">HTTP</a>]</dt>
                                    <dd>Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke, Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9110.html">HTTP Semantics</a>”, <a
                                            href="https://www.rfc-editor.org/info/std97">STD 97</a>, RFC 9110, <a
                                            href="https://dx.doi.org/10.17487/RFC9110">DOI 10.17487/RFC9110</a>, June
                                        2022, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;.
                                    </dd>
                                    <dt id="HTTP3">[<a href="#HTTP3" class="smpl">HTTP/3</a>]</dt>
                                    <dd>Bishop, M., Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9114.html">HTTP/3</a>”, RFC 9114, <a
                                            href="https://dx.doi.org/10.17487/RFC9114">DOI 10.17487/RFC9114</a>, June
                                        2022, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9114">https://www.rfc-editor.org/info/rfc9114</a>&gt;.
                                    </dd>
                                    <dt id="QUIC-TRANSPORT">[<a href="#QUIC-TRANSPORT" class="smpl">QUIC-TRANSPORT</a>]
                                    </dt>
                                    <dd>Iyengar, J., Ed. and M. Thomson, Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9000.html">QUIC: A UDP-Based
                                            Multiplexed and Secure Transport</a>”, RFC 9000, <a
                                            href="https://dx.doi.org/10.17487/RFC9000">DOI 10.17487/RFC9000</a>, May
                                        2021, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9000">https://www.rfc-editor.org/info/rfc9000</a>&gt;.
                                    </dd>
                                    <dt id="RFC2119">[<a href="#RFC2119" class="smpl">RFC2119</a>]</dt>
                                    <dd>Bradner, S., “<a href="https://www.rfc-editor.org/rfc/rfc2119.html">Key words
                                            for use in RFCs to Indicate Requirement Levels</a>”, <a
                                            href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 2119, <a
                                            href="https://dx.doi.org/10.17487/RFC2119">DOI 10.17487/RFC2119</a>, March
                                        1997, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.
                                    </dd>
                                    <dt id="RFC2360">[<a href="#RFC2360" class="smpl">RFC2360</a>]</dt>
                                    <dd>Scott, G., “<a href="https://www.rfc-editor.org/rfc/rfc2360.html">Guide for
                                            Internet Standards Writers</a>”, <a
                                            href="https://www.rfc-editor.org/info/bcp22">BCP 22</a>, RFC 2360, <a
                                            href="https://dx.doi.org/10.17487/RFC2360">DOI 10.17487/RFC2360</a>, June
                                        1998, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc2360">https://www.rfc-editor.org/info/rfc2360</a>&gt;.
                                    </dd>
                                    <dt id="RFC7541">[<a href="#RFC7541" class="smpl">RFC7541</a>]</dt>
                                    <dd>Peon, R. and H. Ruellan, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc7541.html">HPACK: Header Compression
                                            for HTTP/2</a>”, RFC 7541, <a href="https://dx.doi.org/10.17487/RFC7541">DOI
                                            10.17487/RFC7541</a>, May 2015, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7541">https://www.rfc-editor.org/info/rfc7541</a>&gt;.
                                    </dd>
                                    <dt id="RFC8174">[<a href="#RFC8174" class="smpl">RFC8174</a>]</dt>
                                    <dd>Leiba, B., “<a href="https://www.rfc-editor.org/rfc/rfc8174.html">Ambiguity of
                                            Uppercase vs Lowercase in RFC 2119 Key Words</a>”, <a
                                            href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 8174, <a
                                            href="https://dx.doi.org/10.17487/RFC8174">DOI 10.17487/RFC8174</a>, May
                                        2017, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.
                                    </dd>
                                </dl>
                            </div>
                        </section>
                        <section>
                            <div id="rfc.references.3">
                                <h3 id="rfc.section.9.2"><a href="#rfc.section.9.2">9.2.</a> Informative References</h3>
                                <dl class="dl-horizontal">
                                    <dt id="CRIME">[<a href="#CRIME" class="smpl">CRIME</a>]</dt>
                                    <dd>Wikipedia, “<a
                                            href="http://en.wikipedia.org/w/index.php?title=CRIME&amp;oldid=660948120">CRIME</a>”,
                                        May 2015, &lt;<a
                                            href="http://en.wikipedia.org/w/index.php?title=CRIME&amp;oldid=660948120">http://en.wikipedia.org/w/index.php?title=CRIME&amp;oldid=660948120</a>&gt;.
                                    </dd>
                                    <dt id="HTTP2">[<a href="#HTTP2" class="smpl">HTTP/2</a>]</dt>
                                    <dd>Thomson, M., Ed. and C. Benfield, Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9113.html">HTTP/2</a>”, RFC 9113, <a
                                            href="https://dx.doi.org/10.17487/RFC9113">DOI 10.17487/RFC9113</a>, June
                                        2022, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9113">https://www.rfc-editor.org/info/rfc9113</a>&gt;.
                                    </dd>
                                    <dt id="PETAL">[<a href="#PETAL" class="smpl">PETAL</a>]</dt>
                                    <dd>Tan, J. and J. Nahata, “<a
                                            href="http://www.pdl.cmu.edu/PDL-FTP/associated/CMU-PDL-13-106.pdf">PETAL:
                                            Preset Encoding Table Information Leakage</a>”, April 2013, &lt;<a
                                            href="http://www.pdl.cmu.edu/PDL-FTP/associated/CMU-PDL-13-106.pdf">http://www.pdl.cmu.edu/PDL-FTP/associated/CMU-PDL-13-106.pdf</a>&gt;.
                                    </dd>
                                    <dt id="RFC1951">[<a href="#RFC1951" class="smpl">RFC1951</a>]</dt>
                                    <dd>Deutsch, P., “<a href="https://www.rfc-editor.org/rfc/rfc1951.html">DEFLATE
                                            Compressed Data Format Specification version 1.3</a>”, RFC 1951, <a
                                            href="https://dx.doi.org/10.17487/RFC1951">DOI 10.17487/RFC1951</a>, May
                                        1996, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc1951">https://www.rfc-editor.org/info/rfc1951</a>&gt;.
                                    </dd>
                                    <dt id="RFC6454">[<a href="#RFC6454" class="smpl">RFC6454</a>]</dt>
                                    <dd>Barth, A., “<a href="https://www.rfc-editor.org/rfc/rfc6454.html">The Web Origin
                                            Concept</a>”, RFC 6454, <a href="https://dx.doi.org/10.17487/RFC6454">DOI
                                            10.17487/RFC6454</a>, December 2011, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc6454">https://www.rfc-editor.org/info/rfc6454</a>&gt;.
                                    </dd>
                                    <dt id="TLS">[<a href="#TLS" class="smpl">TLS</a>]</dt>
                                    <dd>Rescorla, E., “<a href="https://www.rfc-editor.org/rfc/rfc8446.html">The
                                            Transport Layer Security (TLS) Protocol Version 1.3</a>”, RFC 8446, <a
                                            href="https://dx.doi.org/10.17487/RFC8446">DOI 10.17487/RFC8446</a>, August
                                        2018, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;.
                                    </dd>
                                </dl>
                            </div>
                        </section>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="static-table">
                    <h2 id="rfc.section.A" class="np"><a href="#rfc.section.A">Appendix A.</a>&nbsp;<a
                            href="#static-table">Static Table</a></h2>
                    <div id="rfc.section.A.p.1">
                        <p>This table was generated by analyzing actual Internet traffic in 2018 and including the most
                            common header fields, after filtering out some unsupported and non-standard values. Due to
                            this methodology, some of the entries may be inconsistent or appear multiple times with
                            similar but not identical values. The order of the entries is optimized to encode the most
                            common header fields with the smallest number of bytes.</p>
                    </div>
                    <div class="table table-condensed table-striped">
                        <table class="v3 text-center">
                            <caption>Table 4: Static Table</caption>
                            <thead>
                                <tr>
                                    <th class="text-left" colspan="1" rowspan="1">Index</th>
                                    <th class="text-left" colspan="1" rowspan="1">Name</th>
                                    <th class="text-left" colspan="1" rowspan="1">Value</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">0</td>
                                    <td class="text-left" colspan="1" rowspan="1">:authority</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">1</td>
                                    <td class="text-left" colspan="1" rowspan="1">:path</td>
                                    <td class="text-left" colspan="1" rowspan="1">/</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">2</td>
                                    <td class="text-left" colspan="1" rowspan="1">age</td>
                                    <td class="text-left" colspan="1" rowspan="1">0</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">3</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-disposition</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">4</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-length</td>
                                    <td class="text-left" colspan="1" rowspan="1">0</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">5</td>
                                    <td class="text-left" colspan="1" rowspan="1">cookie</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">6</td>
                                    <td class="text-left" colspan="1" rowspan="1">date</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">7</td>
                                    <td class="text-left" colspan="1" rowspan="1">etag</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">8</td>
                                    <td class="text-left" colspan="1" rowspan="1">if-modified-since</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">9</td>
                                    <td class="text-left" colspan="1" rowspan="1">if-none-match</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">10</td>
                                    <td class="text-left" colspan="1" rowspan="1">last-modified</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">11</td>
                                    <td class="text-left" colspan="1" rowspan="1">link</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">12</td>
                                    <td class="text-left" colspan="1" rowspan="1">location</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">13</td>
                                    <td class="text-left" colspan="1" rowspan="1">referer</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">14</td>
                                    <td class="text-left" colspan="1" rowspan="1">set-cookie</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">15</td>
                                    <td class="text-left" colspan="1" rowspan="1">:method</td>
                                    <td class="text-left" colspan="1" rowspan="1">CONNECT</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">16</td>
                                    <td class="text-left" colspan="1" rowspan="1">:method</td>
                                    <td class="text-left" colspan="1" rowspan="1">DELETE</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">17</td>
                                    <td class="text-left" colspan="1" rowspan="1">:method</td>
                                    <td class="text-left" colspan="1" rowspan="1">GET</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">18</td>
                                    <td class="text-left" colspan="1" rowspan="1">:method</td>
                                    <td class="text-left" colspan="1" rowspan="1">HEAD</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">19</td>
                                    <td class="text-left" colspan="1" rowspan="1">:method</td>
                                    <td class="text-left" colspan="1" rowspan="1">OPTIONS</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">20</td>
                                    <td class="text-left" colspan="1" rowspan="1">:method</td>
                                    <td class="text-left" colspan="1" rowspan="1">POST</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">21</td>
                                    <td class="text-left" colspan="1" rowspan="1">:method</td>
                                    <td class="text-left" colspan="1" rowspan="1">PUT</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">22</td>
                                    <td class="text-left" colspan="1" rowspan="1">:scheme</td>
                                    <td class="text-left" colspan="1" rowspan="1">http</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">23</td>
                                    <td class="text-left" colspan="1" rowspan="1">:scheme</td>
                                    <td class="text-left" colspan="1" rowspan="1">https</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">24</td>
                                    <td class="text-left" colspan="1" rowspan="1">:status</td>
                                    <td class="text-left" colspan="1" rowspan="1">103</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">25</td>
                                    <td class="text-left" colspan="1" rowspan="1">:status</td>
                                    <td class="text-left" colspan="1" rowspan="1">200</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">26</td>
                                    <td class="text-left" colspan="1" rowspan="1">:status</td>
                                    <td class="text-left" colspan="1" rowspan="1">304</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">27</td>
                                    <td class="text-left" colspan="1" rowspan="1">:status</td>
                                    <td class="text-left" colspan="1" rowspan="1">404</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">28</td>
                                    <td class="text-left" colspan="1" rowspan="1">:status</td>
                                    <td class="text-left" colspan="1" rowspan="1">503</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">29</td>
                                    <td class="text-left" colspan="1" rowspan="1">accept</td>
                                    <td class="text-left" colspan="1" rowspan="1">*/*</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">30</td>
                                    <td class="text-left" colspan="1" rowspan="1">accept</td>
                                    <td class="text-left" colspan="1" rowspan="1">application/dns-message</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">31</td>
                                    <td class="text-left" colspan="1" rowspan="1">accept-encoding</td>
                                    <td class="text-left" colspan="1" rowspan="1">gzip, deflate, br</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">32</td>
                                    <td class="text-left" colspan="1" rowspan="1">accept-ranges</td>
                                    <td class="text-left" colspan="1" rowspan="1">bytes</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">33</td>
                                    <td class="text-left" colspan="1" rowspan="1">access-control-allow-headers</td>
                                    <td class="text-left" colspan="1" rowspan="1">cache-control</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">34</td>
                                    <td class="text-left" colspan="1" rowspan="1">access-control-allow-headers</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-type</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">35</td>
                                    <td class="text-left" colspan="1" rowspan="1">access-control-allow-origin</td>
                                    <td class="text-left" colspan="1" rowspan="1">*</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">36</td>
                                    <td class="text-left" colspan="1" rowspan="1">cache-control</td>
                                    <td class="text-left" colspan="1" rowspan="1">max-age=0</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">37</td>
                                    <td class="text-left" colspan="1" rowspan="1">cache-control</td>
                                    <td class="text-left" colspan="1" rowspan="1">max-age=2592000</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">38</td>
                                    <td class="text-left" colspan="1" rowspan="1">cache-control</td>
                                    <td class="text-left" colspan="1" rowspan="1">max-age=604800</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">39</td>
                                    <td class="text-left" colspan="1" rowspan="1">cache-control</td>
                                    <td class="text-left" colspan="1" rowspan="1">no-cache</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">40</td>
                                    <td class="text-left" colspan="1" rowspan="1">cache-control</td>
                                    <td class="text-left" colspan="1" rowspan="1">no-store</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">41</td>
                                    <td class="text-left" colspan="1" rowspan="1">cache-control</td>
                                    <td class="text-left" colspan="1" rowspan="1">public, max-age=31536000</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">42</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-encoding</td>
                                    <td class="text-left" colspan="1" rowspan="1">br</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">43</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-encoding</td>
                                    <td class="text-left" colspan="1" rowspan="1">gzip</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">44</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-type</td>
                                    <td class="text-left" colspan="1" rowspan="1">application/dns-message</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">45</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-type</td>
                                    <td class="text-left" colspan="1" rowspan="1">application/javascript</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">46</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-type</td>
                                    <td class="text-left" colspan="1" rowspan="1">application/json</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">47</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-type</td>
                                    <td class="text-left" colspan="1" rowspan="1">application/x-www-form-urlencoded</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">48</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-type</td>
                                    <td class="text-left" colspan="1" rowspan="1">image/gif</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">49</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-type</td>
                                    <td class="text-left" colspan="1" rowspan="1">image/jpeg</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">50</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-type</td>
                                    <td class="text-left" colspan="1" rowspan="1">image/png</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">51</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-type</td>
                                    <td class="text-left" colspan="1" rowspan="1">text/css</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">52</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-type</td>
                                    <td class="text-left" colspan="1" rowspan="1">text/html; charset=utf-8</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">53</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-type</td>
                                    <td class="text-left" colspan="1" rowspan="1">text/plain</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">54</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-type</td>
                                    <td class="text-left" colspan="1" rowspan="1">text/plain;charset=utf-8</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">55</td>
                                    <td class="text-left" colspan="1" rowspan="1">range</td>
                                    <td class="text-left" colspan="1" rowspan="1">bytes=0-</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">56</td>
                                    <td class="text-left" colspan="1" rowspan="1">strict-transport-security</td>
                                    <td class="text-left" colspan="1" rowspan="1">max-age=31536000</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">57</td>
                                    <td class="text-left" colspan="1" rowspan="1">strict-transport-security</td>
                                    <td class="text-left" colspan="1" rowspan="1">max-age=31536000; includesubdomains
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">58</td>
                                    <td class="text-left" colspan="1" rowspan="1">strict-transport-security</td>
                                    <td class="text-left" colspan="1" rowspan="1">max-age=31536000; includesubdomains;
                                        preload</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">59</td>
                                    <td class="text-left" colspan="1" rowspan="1">vary</td>
                                    <td class="text-left" colspan="1" rowspan="1">accept-encoding</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">60</td>
                                    <td class="text-left" colspan="1" rowspan="1">vary</td>
                                    <td class="text-left" colspan="1" rowspan="1">origin</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">61</td>
                                    <td class="text-left" colspan="1" rowspan="1">x-content-type-options</td>
                                    <td class="text-left" colspan="1" rowspan="1">nosniff</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">62</td>
                                    <td class="text-left" colspan="1" rowspan="1">x-xss-protection</td>
                                    <td class="text-left" colspan="1" rowspan="1">1; mode=block</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">63</td>
                                    <td class="text-left" colspan="1" rowspan="1">:status</td>
                                    <td class="text-left" colspan="1" rowspan="1">100</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">64</td>
                                    <td class="text-left" colspan="1" rowspan="1">:status</td>
                                    <td class="text-left" colspan="1" rowspan="1">204</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">65</td>
                                    <td class="text-left" colspan="1" rowspan="1">:status</td>
                                    <td class="text-left" colspan="1" rowspan="1">206</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">66</td>
                                    <td class="text-left" colspan="1" rowspan="1">:status</td>
                                    <td class="text-left" colspan="1" rowspan="1">302</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">67</td>
                                    <td class="text-left" colspan="1" rowspan="1">:status</td>
                                    <td class="text-left" colspan="1" rowspan="1">400</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">68</td>
                                    <td class="text-left" colspan="1" rowspan="1">:status</td>
                                    <td class="text-left" colspan="1" rowspan="1">403</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">69</td>
                                    <td class="text-left" colspan="1" rowspan="1">:status</td>
                                    <td class="text-left" colspan="1" rowspan="1">421</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">70</td>
                                    <td class="text-left" colspan="1" rowspan="1">:status</td>
                                    <td class="text-left" colspan="1" rowspan="1">425</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">71</td>
                                    <td class="text-left" colspan="1" rowspan="1">:status</td>
                                    <td class="text-left" colspan="1" rowspan="1">500</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">72</td>
                                    <td class="text-left" colspan="1" rowspan="1">accept-language</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">73</td>
                                    <td class="text-left" colspan="1" rowspan="1">access-control-allow-credentials</td>
                                    <td class="text-left" colspan="1" rowspan="1">FALSE</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">74</td>
                                    <td class="text-left" colspan="1" rowspan="1">access-control-allow-credentials</td>
                                    <td class="text-left" colspan="1" rowspan="1">TRUE</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">75</td>
                                    <td class="text-left" colspan="1" rowspan="1">access-control-allow-headers</td>
                                    <td class="text-left" colspan="1" rowspan="1">*</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">76</td>
                                    <td class="text-left" colspan="1" rowspan="1">access-control-allow-methods</td>
                                    <td class="text-left" colspan="1" rowspan="1">get</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">77</td>
                                    <td class="text-left" colspan="1" rowspan="1">access-control-allow-methods</td>
                                    <td class="text-left" colspan="1" rowspan="1">get, post, options</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">78</td>
                                    <td class="text-left" colspan="1" rowspan="1">access-control-allow-methods</td>
                                    <td class="text-left" colspan="1" rowspan="1">options</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">79</td>
                                    <td class="text-left" colspan="1" rowspan="1">access-control-expose-headers</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-length</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">80</td>
                                    <td class="text-left" colspan="1" rowspan="1">access-control-request-headers</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-type</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">81</td>
                                    <td class="text-left" colspan="1" rowspan="1">access-control-request-method</td>
                                    <td class="text-left" colspan="1" rowspan="1">get</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">82</td>
                                    <td class="text-left" colspan="1" rowspan="1">access-control-request-method</td>
                                    <td class="text-left" colspan="1" rowspan="1">post</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">83</td>
                                    <td class="text-left" colspan="1" rowspan="1">alt-svc</td>
                                    <td class="text-left" colspan="1" rowspan="1">clear</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">84</td>
                                    <td class="text-left" colspan="1" rowspan="1">authorization</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">85</td>
                                    <td class="text-left" colspan="1" rowspan="1">content-security-policy</td>
                                    <td class="text-left" colspan="1" rowspan="1">script-src 'none'; object-src 'none';
                                        base-uri 'none'</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">86</td>
                                    <td class="text-left" colspan="1" rowspan="1">early-data</td>
                                    <td class="text-left" colspan="1" rowspan="1">1</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">87</td>
                                    <td class="text-left" colspan="1" rowspan="1">expect-ct</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">88</td>
                                    <td class="text-left" colspan="1" rowspan="1">forwarded</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">89</td>
                                    <td class="text-left" colspan="1" rowspan="1">if-range</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">90</td>
                                    <td class="text-left" colspan="1" rowspan="1">origin</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">91</td>
                                    <td class="text-left" colspan="1" rowspan="1">purpose</td>
                                    <td class="text-left" colspan="1" rowspan="1">prefetch</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">92</td>
                                    <td class="text-left" colspan="1" rowspan="1">server</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">93</td>
                                    <td class="text-left" colspan="1" rowspan="1">timing-allow-origin</td>
                                    <td class="text-left" colspan="1" rowspan="1">*</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">94</td>
                                    <td class="text-left" colspan="1" rowspan="1">upgrade-insecure-requests</td>
                                    <td class="text-left" colspan="1" rowspan="1">1</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">95</td>
                                    <td class="text-left" colspan="1" rowspan="1">user-agent</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">96</td>
                                    <td class="text-left" colspan="1" rowspan="1">x-forwarded-for</td>
                                    <td class="text-left" colspan="1" rowspan="1"></td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">97</td>
                                    <td class="text-left" colspan="1" rowspan="1">x-frame-options</td>
                                    <td class="text-left" colspan="1" rowspan="1">deny</td>
                                </tr>
                                <tr>
                                    <td class="text-left" colspan="1" rowspan="1">98</td>
                                    <td class="text-left" colspan="1" rowspan="1">x-frame-options</td>
                                    <td class="text-left" colspan="1" rowspan="1">sameorigin</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div id="rfc.section.A.p.2">
                        <p>Any line breaks that appear within field names or values are due to formatting.</p>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="encoding-and-decoding-examples">
                    <h2 id="rfc.section.B" class="np"><a href="#rfc.section.B">Appendix B.</a>&nbsp;<a
                            href="#encoding-and-decoding-examples">Encoding and Decoding Examples</a></h2>
                    <div id="rfc.section.B.p.1">
                        <p>The following examples represent a series of exchanges between an encoder and a decoder. The
                            exchanges are designed to exercise most QPACK instructions and highlight potentially common
                            patterns and their impact on dynamic table state. The encoder sends three encoded field
                            sections containing one field line each, as well as two speculative inserts that are not
                            referenced.</p>
                    </div>
                    <div id="rfc.section.B.p.2">
                        <p>The state of the encoder's dynamic table is shown, along with its current size. Each entry is
                            shown with the Absolute Index of the entry (Abs), the current number of outstanding encoded
                            field sections with references to that entry (Ref), along with the name and value. Entries
                            above the 'acknowledged' line have been acknowledged by the decoder.</p>
                    </div>
                    <section id="literal-field-line-with-name-reference">
                        <h3 id="rfc.section.B.1"><a href="#rfc.section.B.1">B.1.</a>&nbsp;<a
                                href="#literal-field-line-with-name-reference">Literal Field Line with Name
                                Reference</a></h3>
                        <div id="rfc.section.B.1.p.1">
                            <p>The encoder sends an encoded field section containing a literal representation of a field
                                with a static name reference.</p>
                        </div>
                        <div id="rfc.section.B.1.p.2">
                            <pre>
Data                | Interpretation
                             | Encoder's Dynamic Table

Stream: 0
0000                | Required Insert Count = 0, Base = 0
510b 2f69 6e64 6578 | Literal Field Line with Name Reference
2e68 746d 6c        |  Static Table, Index=1
                    |  (:path=/index.html)

                              Abs Ref Name        Value
                              ^-- acknowledged --^
                              Size=0
</pre>
                        </div>
                    </section>
                    <section id="dynamic-table">
                        <h3 id="rfc.section.B.2"><a href="#rfc.section.B.2">B.2.</a>&nbsp;<a
                                href="#dynamic-table">Dynamic Table</a></h3>
                        <div id="rfc.section.B.2.p.1">
                            <p>The encoder sets the dynamic table capacity, inserts a header with a dynamic name
                                reference, then sends a potentially blocking, encoded field section referencing this new
                                entry. The decoder acknowledges processing the encoded field section, which implicitly
                                acknowledges all dynamic table insertions up to the Required Insert Count.</p>
                        </div>
                        <div id="rfc.section.B.2.p.2">
                            <pre>
Stream: Encoder
3fbd01              | Set Dynamic Table Capacity=220
c00f 7777 772e 6578 | Insert With Name Reference
616d 706c 652e 636f | Static Table, Index=0
6d                  |  (:authority=www.example.com)
c10c 2f73 616d 706c | Insert With Name Reference
652f 7061 7468      |  Static Table, Index=1
                    |  (:path=/sample/path)

                              Abs Ref Name        Value
                              ^-- acknowledged --^
                               0   0  :authority  www.example.com
                               1   0  :path       /sample/path
                              Size=106

Stream: 4
0381                | Required Insert Count = 2, Base = 0
10                  | Indexed Field Line With Post-Base Index
                    |  Absolute Index = Base(0) + Index(0) = 0
                    |  (:authority=www.example.com)
11                  | Indexed Field Line With Post-Base Index
                    |  Absolute Index = Base(0) + Index(1) = 1
                    |  (:path=/sample/path)

                              Abs Ref Name        Value
                              ^-- acknowledged --^
                               0   1  :authority  www.example.com
                               1   1  :path       /sample/path
                              Size=106

Stream: Decoder
84                  | Section Acknowledgment (stream=4)

                              Abs Ref Name        Value
                               0   0  :authority  www.example.com
                               1   0  :path       /sample/path
                              ^-- acknowledged --^
                              Size=106
</pre>
                        </div>
                    </section>
                    <section id="speculative-insert">
                        <h3 id="rfc.section.B.3"><a href="#rfc.section.B.3">B.3.</a>&nbsp;<a
                                href="#speculative-insert">Speculative Insert</a></h3>
                        <div id="rfc.section.B.3.p.1">
                            <p>The encoder inserts a header into the dynamic table with a literal name. The decoder
                                acknowledges receipt of the entry. The encoder does not send any encoded field sections.
                            </p>
                        </div>
                        <div id="rfc.section.B.3.p.2">
                            <pre>
Stream: Encoder
4a63 7573 746f 6d2d | Insert With Literal Name
6b65 790c 6375 7374 |  (custom-key=custom-value)
6f6d 2d76 616c 7565 |

                              Abs Ref Name        Value
                               0   0  :authority  www.example.com
                               1   0  :path       /sample/path
                              ^-- acknowledged --^
                               2   0  custom-key  custom-value
                              Size=160

Stream: Decoder
01                  | Insert Count Increment (1)

                              Abs Ref Name        Value
                               0   0  :authority  www.example.com
                               1   0  :path       /sample/path
                               2   0  custom-key  custom-value
                              ^-- acknowledged --^
                              Size=160

</pre>
                        </div>
                    </section>
                    <section id="duplicate-instruction-stream-cancellation">
                        <h3 id="rfc.section.B.4"><a href="#rfc.section.B.4">B.4.</a>&nbsp;<a
                                href="#duplicate-instruction-stream-cancellation">Duplicate Instruction, Stream
                                Cancellation</a></h3>
                        <div id="rfc.section.B.4.p.1">
                            <p>The encoder duplicates an existing entry in the dynamic table, then sends an encoded
                                field section referencing the dynamic table entries including the duplicated entry. The
                                packet containing the encoder stream data is delayed. Before the packet arrives, the
                                decoder cancels the stream and notifies the encoder that the encoded field section was
                                not processed.</p>
                        </div>
                        <div id="rfc.section.B.4.p.2">
                            <pre>
Stream: Encoder
02                  | Duplicate (Relative Index = 2)
                    |  Absolute Index =
                    |   Insert Count(3) - Index(2) - 1 = 0

                              Abs Ref Name        Value
                               0   0  :authority  www.example.com
                               1   0  :path       /sample/path
                               2   0  custom-key  custom-value
                              ^-- acknowledged --^
                               3   0  :authority  www.example.com
                              Size=217

Stream: 8
0500                | Required Insert Count = 4, Base = 4
80                  | Indexed Field Line, Dynamic Table
                    |  Absolute Index = Base(4) - Index(0) - 1 = 3
                    |  (:authority=www.example.com)
c1                  | Indexed Field Line, Static Table Index = 1
                    |  (:path=/)
81                  | Indexed Field Line, Dynamic Table
                    |  Absolute Index = Base(4) - Index(1) - 1 = 2
                    |  (custom-key=custom-value)

                              Abs Ref Name        Value
                               0   0  :authority  www.example.com
                               1   0  :path       /sample/path
                               2   1  custom-key  custom-value
                              ^-- acknowledged --^
                               3   1  :authority  www.example.com
                              Size=217

Stream: Decoder
48                  | Stream Cancellation (Stream=8)

                              Abs Ref Name        Value
                               0   0  :authority  www.example.com
                               1   0  :path       /sample/path
                               2   0  custom-key  custom-value
                              ^-- acknowledged --^
                               3   0  :authority  www.example.com
                              Size=217
</pre>
                        </div>
                    </section>
                    <section id="dynamic-table-insert-eviction">
                        <h3 id="rfc.section.B.5"><a href="#rfc.section.B.5">B.5.</a>&nbsp;<a
                                href="#dynamic-table-insert-eviction">Dynamic Table Insert, Eviction</a></h3>
                        <div id="rfc.section.B.5.p.1">
                            <p>The encoder inserts another header into the dynamic table, which evicts the oldest entry.
                                The encoder does not send any encoded field sections.</p>
                        </div>
                        <div id="rfc.section.B.5.p.2">
                            <pre>
Stream: Encoder
810d 6375 7374 6f6d | Insert With Name Reference
2d76 616c 7565 32   |  Dynamic Table, Relative Index = 1
                    |  Absolute Index =
                    |   Insert Count(4) - Index(1) - 1 = 2
                    |  (custom-key=custom-value2)

                              Abs Ref Name        Value
                               1   0  :path       /sample/path
                               2   0  custom-key  custom-value
                              ^-- acknowledged --^
                               3   0  :authority  www.example.com
                               4   0  custom-key  custom-value2
                              Size=215
</pre>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="sample-single-pass-encoding-algorithm">
                    <h2 id="rfc.section.C" class="np"><a href="#rfc.section.C">Appendix C.</a>&nbsp;<a
                            href="#sample-single-pass-encoding-algorithm">Sample Single-Pass Encoding Algorithm</a></h2>
                    <div id="rfc.section.C.p.1">
                        <p>Pseudocode for single-pass encoding, excluding handling of duplicates, non-blocking mode,
                            available encoder stream flow control and reference tracking.</p>
                    </div>
                    <div id="rfc.section.C.p.2">
                        <pre class="text">
# Helper functions:
# ====
# Encode an integer with the specified prefix and length
encodeInteger(buffer, prefix, value, prefixLength)

# Encode a dynamic table insert instruction with optional static
# or dynamic name index (but not both)
encodeInsert(buffer, staticNameIndex, dynamicNameIndex, fieldLine)

# Encode a static index reference
encodeStaticIndexReference(buffer, staticIndex)

# Encode a dynamic index reference relative to Base
encodeDynamicIndexReference(buffer, dynamicIndex, base)

# Encode a literal with an optional static name index
encodeLiteral(buffer, staticNameIndex, fieldLine)

# Encode a literal with a dynamic name index relative to Base
encodeDynamicLiteral(buffer, dynamicNameIndex, base, fieldLine)

# Encoding Algorithm
# ====
base = dynamicTable.getInsertCount()
requiredInsertCount = 0
for line in fieldLines:
  staticIndex = staticTable.findIndex(line)
  if staticIndex is not None:
    encodeStaticIndexReference(streamBuffer, staticIndex)
    continue

  dynamicIndex = dynamicTable.findIndex(line)
  if dynamicIndex is None:
    # No matching entry.  Either insert+index or encode literal
    staticNameIndex = staticTable.findName(line.name)
    if staticNameIndex is None:
       dynamicNameIndex = dynamicTable.findName(line.name)

    if shouldIndex(line) and dynamicTable.canIndex(line):
      encodeInsert(encoderBuffer, staticNameIndex,
                   dynamicNameIndex, line)
      dynamicIndex = dynamicTable.add(line)

  if dynamicIndex is None:
    # Could not index it, literal
    if dynamicNameIndex is not None:
      # Encode literal with dynamic name, possibly above Base
      encodeDynamicLiteral(streamBuffer, dynamicNameIndex,
                           base, line)
      requiredInsertCount = max(requiredInsertCount,
                                dynamicNameIndex)
    else:
      # Encodes a literal with a static name or literal name
      encodeLiteral(streamBuffer, staticNameIndex, line)
  else:
    # Dynamic index reference
    assert(dynamicIndex is not None)
    requiredInsertCount = max(requiredInsertCount, dynamicIndex)
    # Encode dynamicIndex, possibly above Base
    encodeDynamicIndexReference(streamBuffer, dynamicIndex, base)

# encode the prefix
if requiredInsertCount == 0:
  encodeInteger(prefixBuffer, 0x00, 0, 8)
  encodeInteger(prefixBuffer, 0x00, 0, 7)
else:
  wireRIC = (
    requiredInsertCount
    % (2 * getMaxEntries(maxTableCapacity))
  ) + 1;
  encodeInteger(prefixBuffer, 0x00, wireRIC, 8)
  if base &gt;= requiredInsertCount:
    encodeInteger(prefixBuffer, 0x00,
                  base - requiredInsertCount, 7)
  else:
    encodeInteger(prefixBuffer, 0x80,
                  requiredInsertCount - base - 1, 7)

return encoderBuffer, prefixBuffer + streamBuffer
</pre>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="acknowledgments">
                    <h2 id="rfc.section.unnumbered-4" class="np"><a href="#acknowledgments">Acknowledgments</a></h2>
                    <div id="rfc.section.unnumbered-4.p.1">
                        <p>The IETF QUIC Working Group received an enormous amount of support from many people.</p>
                    </div>
                    <div id="rfc.section.unnumbered-4.p.2">
                        <p>The compression design team did substantial work exploring the problem space and influencing
                            the initial draft version of this document. The contributions of design team members Roberto
                            Peon, Martin Thomson, and Dmitri Tikhonov are gratefully acknowledged.</p>
                    </div>
                    <div id="rfc.section.unnumbered-4.p.3" class="avoidbreakafter">
                        <p>The following people also provided substantial contributions to this document:</p>
                    </div>
                    <div id="rfc.section.unnumbered-4.p.4">
                        <ul>
                            <li>
                                <div>
                                    <p>Bence Beky</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Alessandro Ghedini</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Ryan Hamilton</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Robin Marx</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Patrick McManus</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>奥 一穂 (Kazuho Oku)</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Lucas Pardue</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Biren Roy</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Ian Swett</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div id="rfc.section.unnumbered-4.p.5">
                        <p>This document draws heavily on the text of <a href="#RFC7541"><cite
                                    title="HPACK: Header Compression for HTTP/2">[RFC7541]</cite></a>. The indirect
                            input of those authors is also gratefully acknowledged.</p>
                    </div>
                    <div id="rfc.section.unnumbered-4.p.6">
                        <p>Buck Krasic's contribution was supported by Google during his employment there.</p>
                    </div>
                    <div id="rfc.section.unnumbered-4.p.7">
                        <p>A portion of Mike Bishop's contribution was supported by Microsoft during his employment
                            there.</p>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="rfc.authors" class="np">
                    <h2><a href="#rfc.authors">Authors' Addresses</a></h2>
                    <address><b>Charles 'Buck' Krasic</b><br>EMail: <a href="mailto:krasic@acm.org">krasic@acm.org</a>
                    </address>
                    <address><b>Mike Bishop</b><br>Akamai Technologies<br>EMail: <a
                            href="mailto:mbishop@evequefou.be">mbishop@evequefou.be</a></address>
                    <address><b>Alan Frindell</b> (editor)<br>Facebook<br>EMail: <a
                            href="mailto:afrind@fb.com">afrind@fb.com</a></address>
                </section>
            </div>
        </div>
    </div>
    <script src="/assets/node_modules/jquery/dist/jquery.min.js"></script>
    <script src="/assets/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
</body>

</html>