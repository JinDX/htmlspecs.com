<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>RFC 9421 - HTTP Message Signatures</title>
    <script>
        function getMeta(rfcno, container) {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "https://www.rfc-editor.org/rfc/rfc" + rfcno + ".json", true);
            xhr.onload = function (e) {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        var data = JSON.parse(xhr.response);

                        var cont = document.getElementById(container);
                        // empty the container
                        while (cont.firstChild) {
                            cont.removeChild(myNode.firstChild);
                        }

                        var c = data.status;
                        if (c) {
                            var bld = newElementWithText("b", c);
                            cont.appendChild(bld);
                        } else {
                            cont.appendChild(newElementWithText("i", "(document status unknown)"));
                        }

                        c = data.updated_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Updated by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.obsoleted_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Obsoleted by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.errata_url;
                        if (c) {
                            cont.appendChild(newElement("br"));
                            var link = newElementWithText("a", "errata");
                            link.setAttribute("href", c);
                            var errata = newElementWithText("i", "This document has ");
                            errata.appendChild(link);
                            errata.appendChild(newText("."));
                            cont.appendChild(errata);
                        }

                        cont.style.display = "block";
                    } else {
                        console.error(xhr.statusText);
                    }
                }
            };
            xhr.onerror = function (e) {
                console.error(xhr.status + " " + xhr.statusText);
            };
            xhr.send(null);
        }
        function appendRfcLinks(parent, updates) {
            var template = "https://www.rfc-editor.org/rfc/rfc{rfc}.html";
            for (var i = 0; i < updates.length; i++) {
                var rfc = updates[i].trim().toLowerCase();
                if (rfc.substring(0, 3) == "rfc") {
                    var no = parseInt(rfc.substring(3), 10);

                    var link = newElement("a");
                    link.setAttribute("href", template.replace("{rfc}", no));
                    link.appendChild(newText(no));
                    parent.appendChild(link);
                } else {
                    parent.appendChild(newText(rfc));
                }
                if (i != updates.length - 1) {
                    parent.appendChild(newText(", "));
                }
            }
        }

        // DOM helpers
        function newElement(name) {
            return document.createElement(name);
        }
        function newElementWithText(name, txt) {
            var e = document.createElement(name);
            e.appendChild(newText(txt));
            return e;
        }
        function newText(text) {
            return document.createTextNode(text);
        }
    </script>
    <script>
        function anchorRewrite() {
            map = {};
            if (window.location.hash.length >= 1) {
                var fragid = window.location.hash.substr(1);
                if (fragid) {
                    if (!document.getElementById(fragid)) {
                        var prefix = "rfc.";
                        var mapped = map[fragid];
                        if (mapped) {
                            window.location.hash = mapped;
                        } else if (fragid.indexOf("section-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(8).replace("-", ".p.");
                        } else if (fragid.indexOf("appendix-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(9).replace("-", ".p.");
                        } else if (fragid.indexOf("s-") == 0) {
                            var postfix = fragid.substring(2);
                            if (postfix.startsWith("abstract")) {
                                window.location.hash = prefix + postfix;
                            } else if (postfix.startsWith("note-")) {
                                window.location.hash = prefix + "note." + postfix.substring(5).replace("-", ".p.");
                            } else {
                                window.location.hash = prefix + "section." + postfix.replace("-", ".p.");
                            }
                        } else if (fragid.indexOf("p-") == 0) {
                            var r = fragid.substring(2);
                            var p = r.indexOf("-");
                            if (p >= 0) {
                                window.location.hash = prefix + "section." + r.substring(0, p) + ".p." + r.substring(p + 1);
                            }
                        }
                    }
                }
            }
        }
        window.addEventListener('hashchange', anchorRewrite);
        window.addEventListener('DOMContentLoaded', anchorRewrite);
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:type" content="article">
    <meta property="og:title" content="RFC9421">
    <meta property="og:description" content="HTTP Message Signatures">
    <meta property="og:url" content="https://httpwg.org/specs/rfc9421.html">
    <meta property="og:site_name" content="IETF HTTP Working Group Specifications">
    <meta property="og:image" content="https://httpwg.org/assets/favicon/apple-icon-180x180.png">
    <link rel="stylesheet" type="text/css" href="/assets/node_modules/bootstrap/dist/css/bootstrap.min.css">
    <style type="text/css">
        body {
            padding-top: 80px;
            padding-bottom: 80px;
            position: relative;
        }

        .table.header th,
        .table.header td {
            border-top: none;
            padding: 0;
        }

        #sidebar {
            margin-top: -10px;
            height: 90%;
            overflow-y: auto;
            font-size: 90%;
        }

        #rfc\.meta {
            width: 40%;
            float: right
        }

        .toc ul {
            list-style: none;
        }

        .filename {
            color: rgb(119, 119, 119);
            font-size: 23px;
            font-weight: normal;
            height: auto;
            line-height: 23px;
        }

        dl {
            margin-left: 1em;
        }

        dl.dl-horizontal: {
            margin-left: 0;
        }

        dl>dt {
            float: left;
            margin-right: 1em;
        }

        dl.nohang>dt {
            float: none;
        }

        dl>dd {
            margin-bottom: .5em;
        }

        dl.compact>dd {
            margin-bottom: 0em;
        }

        dl>dd>dl {
            margin-top: 0.5em;
            margin-bottom: 0em;
        }

        ul.empty {
            list-style-type: none;
        }

        ul.empty li {
            margin-top: .5em;
        }

        td.reference {
            padding-right: 1em;
            vertical-align: top;
        }

        .feedback {
            position: fixed;
            bottom: 5px;
            right: 5px;
        }

        .fbbutton {
            margin-left: 5px;
        }

        h1 a,
        h2 a,
        h3 a,
        h4 a,
        h5 a,
        h6 a {
            color: rgb(51, 51, 51);
        }

        span.tt {
            font: 11pt consolas, monospace;
            font-size-adjust: none;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="/assets/site.css">
    <link rel="Contents" href="#rfc.toc">
    <link rel="Author" href="#rfc.authors">
    <link rel="License" href="#rfc.copyrightnotice">
    <link rel="Chapter" title="1 Introduction" href="#rfc.section.1">
    <link rel="Chapter" title="2 HTTP Message Components" href="#rfc.section.2">
    <link rel="Chapter" title="3 HTTP Message Signatures" href="#rfc.section.3">
    <link rel="Chapter" title="4 Including a Message Signature in a Message" href="#rfc.section.4">
    <link rel="Chapter" title="5 Requesting Signatures" href="#rfc.section.5">
    <link rel="Chapter" title="6 IANA Considerations" href="#rfc.section.6">
    <link rel="Chapter" title="7 Security Considerations" href="#rfc.section.7">
    <link rel="Chapter" title="8 Privacy Considerations" href="#rfc.section.8">
    <link rel="Chapter" title="9 References" href="#rfc.section.9">
    <link rel="Appendix" title="A Detecting HTTP Message Signatures" href="#rfc.section.A">
    <link rel="Appendix" title="B Examples" href="#rfc.section.B">
    <link rel="Appendix" title="Acknowledgements" href="#rfc.section.unnumbered-4">
    <link href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-message-signatures-19" rel="prev">
    <link href="https://dx.doi.org/10.17487/rfc9421" rel="alternate">
    <link href="urn:issn:2070-1721" rel="alternate">
    <link rel="Alternate" title="Plain Text Version" href="http://www.ietf.org/rfc/rfc9421.txt">
    <link rel="Help" title="RFC-Editor's Status Page" href="https://www.rfc-editor.org/info/rfc9421">
    <meta name="viewport" content="initial-scale=1">
    <meta name="generator"
        content="https://github.com/mnot/RFCBootstrap XSLT vendor: Saxonica http://www.saxonica.com/">
    <meta name="keywords" content="PKI">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <meta name="dcterms.creator" content="Backman, A.">
    <meta name="dcterms.creator" content="Richer, J.">
    <meta name="dcterms.creator" content="Sporny, M.">
    <meta name="dcterms.identifier" content="urn:ietf:rfc:9421">
    <meta name="dcterms.issued" content="2024-02">
    <meta name="dcterms.abstract"
        content="This document describes a mechanism for creating, encoding, and verifying digital signatures or message authentication codes over components of an HTTP message. This mechanism supports use cases where the full HTTP message may not be known to the signer and where the message may be transformed (e.g., by intermediaries) before reaching the verifier. This document also describes a means for requesting that a signature be applied to a subsequent HTTP message in an ongoing HTTP exchange.">
    <meta name="dcterms.isPartOf" content="urn:issn:2070-1721">
    <meta name="description"
        content="This document describes a mechanism for creating, encoding, and verifying digital signatures or message authentication codes over components of an HTTP message. This mechanism supports use cases where the full HTTP message may not be known to the signer and where the message may be transformed (e.g., by intermediaries) before reaching the verifier. This document also describes a means for requesting that a signature be applied to a subsequent HTTP message in an ongoing HTTP exchange.">
</head>

<body onload="getMeta(9421,&#34;rfc.meta&#34;);">
    <nav class="navbar navbar-dark bg-dark d-print-none navbar-expand-lg fixed-top ps-3 pe-3" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse"
                aria-controls="navbarToggler" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <a class="navbar-brand" href="https://httpwg.org/"><img src="https://httpwg.org/assets/http.svg"
                    height="23"></a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse">

            <div class="navbar-nav me-auto">

                <a class="nav-item ms-1 text-white" href="https://httpwg.org/specs/">📄 Documentation</a>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Work in
                        Progress</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/http-extensions/">HTTP Extensions</a></li>
                        <li class="dropdown-item"><a
                                href="https://github.com/httpwg/admin/issues?q=is%3Aissue+is%3Aopen+label%3Aadoption">Future
                                Work</a></li>
                    </ul>
                </div>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Participate</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/about/">About the HTTP Working Group</a>
                        </li>
                        <li class="divider"></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/CONTRIBUTING.html">Contribution Policy</a>
                        </li>
                        <li class="dropdown-item"><a href="http://datatracker.ietf.org/wg/httpbis/charter/">WG
                                Charter</a></li>
                        <li class="dropdown-item"><a href="http://lists.w3.org/Archives/Public/ietf-http-wg/">Group
                                Mailing List 📨</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/wg-materials/">Meeting Materials</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/admin/editors/">Document Editor
                                Resources</a></li>
                    </ul>
                </div>
            </div>

        </div>
    </nav>
    <div class="container" id="top">
        <div class="row">
            <div class="col-lg-4 order-last d-none d-lg-block" id="sidebar" role="navigation">
                <div class="navbar">
                    <div class="navbar-brand"><a href="#top"><strong>RFC </strong>9421</a></div><br clear="all">
                    <div class="">
                        <div class="toc ">
                            <ul>
                                <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#intro">Introduction</a>
                                    <ul>
                                        <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#definitions">Conventions and Terminology</a></li>
                                        <li><a href="#rfc.section.1.2">1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#requirements">Requirements</a></li>
                                        <li><a href="#rfc.section.1.3">1.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#transforms">HTTP Message Transformations</a></li>
                                        <li><a href="#rfc.section.1.4">1.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#application">Application of HTTP Message Signatures</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#covered-components">HTTP
                                        Message Components</a>
                                    <ul>
                                        <li><a href="#rfc.section.2.1">2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-fields">HTTP Fields</a>
                                            <ul>
                                                <li><a href="#rfc.section.2.1.1">2.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#http-field-structured">Strict Serialization of HTTP
                                                        Structured Fields</a></li>
                                                <li><a href="#rfc.section.2.1.2">2.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#http-field-dictionary">Dictionary Structured Field
                                                        Members</a></li>
                                                <li><a href="#rfc.section.2.1.3">2.1.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#http-field-byte-sequence">Binary-Wrapped HTTP Fields</a>
                                                </li>
                                                <li><a href="#rfc.section.2.1.4">2.1.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#http-trailer">Trailer Fields</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.2.2">2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#derived-components">Derived Components</a>
                                            <ul>
                                                <li><a href="#rfc.section.2.2.1">2.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-request-method">Method</a></li>
                                                <li><a href="#rfc.section.2.2.2">2.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-target-uri">Target URI</a></li>
                                                <li><a href="#rfc.section.2.2.3">2.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-request-authority">Authority</a></li>
                                                <li><a href="#rfc.section.2.2.4">2.2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-request-scheme">Scheme</a></li>
                                                <li><a href="#rfc.section.2.2.5">2.2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-request-target">Request Target</a></li>
                                                <li><a href="#rfc.section.2.2.6">2.2.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-request-path">Path</a></li>
                                                <li><a href="#rfc.section.2.2.7">2.2.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-request-query">Query</a></li>
                                                <li><a href="#rfc.section.2.2.8">2.2.8.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-request-query-param">Query Parameters</a></li>
                                                <li><a href="#rfc.section.2.2.9">2.2.9.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#content-status-code">Status Code</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.2.3">2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signature-params">Signature Parameters</a></li>
                                        <li><a href="#rfc.section.2.4">2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-response">Signing Request Components in a
                                                Response Message</a></li>
                                        <li><a href="#rfc.section.2.5">2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#create-sig-input">Creating the Signature Base</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#message-signatures">HTTP
                                        Message Signatures</a>
                                    <ul>
                                        <li><a href="#rfc.section.3.1">3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#sign">Creating a Signature</a></li>
                                        <li><a href="#rfc.section.3.2">3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#verify">Verifying a Signature</a>
                                            <ul>
                                                <li><a href="#rfc.section.3.2.1">3.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#verify-requirements">Enforcing Application
                                                        Requirements</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.3.3">3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signature-methods">Signature Algorithms</a>
                                            <ul>
                                                <li><a href="#rfc.section.3.3.1">3.3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#method-rsa-pss-sha512">RSASSA-PSS Using SHA-512</a></li>
                                                <li><a href="#rfc.section.3.3.2">3.3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#method-rsa-v1_5-sha256">RSASSA-PKCS1-v1_5 Using
                                                        SHA-256</a></li>
                                                <li><a href="#rfc.section.3.3.3">3.3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#method-hmac-sha256">HMAC Using SHA-256</a></li>
                                                <li><a href="#rfc.section.3.3.4">3.3.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#method-ecdsa-p256-sha256">ECDSA Using Curve P-256 DSS and
                                                        SHA-256</a></li>
                                                <li><a href="#rfc.section.3.3.5">3.3.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#method-ecdsa-p384-sha384">ECDSA Using Curve P-384 DSS and
                                                        SHA-384</a></li>
                                                <li><a href="#rfc.section.3.3.6">3.3.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#method-ed25519">EdDSA Using Curve edwards25519</a></li>
                                                <li><a href="#rfc.section.3.3.7">3.3.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#method-jose">JSON Web Signature (JWS) Algorithms</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#attach-signature">Including a Message Signature in a Message</a>
                                    <ul>
                                        <li><a href="#rfc.section.4.1">4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signature-input-header">The Signature-Input HTTP Field</a></li>
                                        <li><a href="#rfc.section.4.2">4.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signature-header">The Signature HTTP Field</a></li>
                                        <li><a href="#rfc.section.4.3">4.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signature-multiple">Multiple Signatures</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#request-signature">Requesting Signatures</a>
                                    <ul>
                                        <li><a href="#rfc.section.5.1">5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#accept-signature-header">The Accept-Signature Field</a></li>
                                        <li><a href="#rfc.section.5.2">5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#processing-an-accept-signature">Processing an
                                                Accept-Signature</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#iana">IANA
                                        Considerations</a>
                                    <ul>
                                        <li><a href="#rfc.section.6.1">6.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-field-name-registration">HTTP Field Name Registration</a>
                                        </li>
                                        <li><a href="#rfc.section.6.2">6.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#hsa-registry">HTTP Signature Algorithms Registry</a>
                                            <ul>
                                                <li><a href="#rfc.section.6.2.1">6.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-hsa-template">Registration Template</a></li>
                                                <li><a href="#rfc.section.6.2.2">6.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-hsa-contents">Initial Contents</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.6.3">6.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#param-registry">HTTP Signature Metadata Parameters Registry</a>
                                            <ul>
                                                <li><a href="#rfc.section.6.3.1">6.3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-param-template">Registration Template</a></li>
                                                <li><a href="#rfc.section.6.3.2">6.3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-param-contents">Initial Contents</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.6.4">6.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-registry">HTTP Signature Derived Component Names
                                                Registry</a>
                                            <ul>
                                                <li><a href="#rfc.section.6.4.1">6.4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-content-template">Registration Template</a></li>
                                                <li><a href="#rfc.section.6.4.2">6.4.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-content-contents">Initial Contents</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.6.5">6.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#component-param-registry">HTTP Signature Component Parameters
                                                Registry</a>
                                            <ul>
                                                <li><a href="#rfc.section.6.5.1">6.5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-component-param-template">Registration Template</a>
                                                </li>
                                                <li><a href="#rfc.section.6.5.2">6.5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#iana-component-param-contents">Initial Contents</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a href="#security">Security
                                        Considerations</a>
                                    <ul>
                                        <li><a href="#rfc.section.7.1">7.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#general-considerations">General Considerations</a>
                                            <ul>
                                                <li><a href="#rfc.section.7.1.1">7.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-ignore">Skipping Signature Verification</a></li>
                                                <li><a href="#rfc.section.7.1.2">7.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-tls">Use of TLS</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.7.2">7.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#message-processing-and-selection">Message Processing and
                                                Selection</a>
                                            <ul>
                                                <li><a href="#rfc.section.7.2.1">7.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-coverage">Insufficient Coverage</a></li>
                                                <li><a href="#rfc.section.7.2.2">7.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-replay">Signature Replay</a></li>
                                                <li><a href="#rfc.section.7.2.3">7.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-components">Choosing Message Components</a></li>
                                                <li><a href="#rfc.section.7.2.4">7.2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-not-fields">Choosing Signature Parameters and
                                                        Derived Components over HTTP Fields</a></li>
                                                <li><a href="#rfc.section.7.2.5">7.2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-labels">Signature Labels</a></li>
                                                <li><a href="#rfc.section.7.2.6">7.2.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-multiple">Multiple Signature Confusion</a></li>
                                                <li><a href="#rfc.section.7.2.7">7.2.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-signature-tag">Collision of Application-Specific
                                                        Signature Tag</a></li>
                                                <li><a href="#rfc.section.7.2.8">7.2.8.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-message-content">Message Content</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.7.3">7.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#cryptographic-considerations">Cryptographic Considerations</a>
                                            <ul>
                                                <li><a href="#rfc.section.7.3.1">7.3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-collision">Cryptography and Signature
                                                        Collision</a></li>
                                                <li><a href="#rfc.section.7.3.2">7.3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-keys">Key Theft</a></li>
                                                <li><a href="#rfc.section.7.3.3">7.3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-symmetric">Symmetric Cryptography</a></li>
                                                <li><a href="#rfc.section.7.3.4">7.3.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-keymixup">Key Specification Mixup</a></li>
                                                <li><a href="#rfc.section.7.3.5">7.3.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-nondeterministic">Non-deterministic Signature
                                                        Primitives</a></li>
                                                <li><a href="#rfc.section.7.3.6">7.3.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-keydowngrade">Key and Algorithm Specification
                                                        Downgrades</a></li>
                                                <li><a href="#rfc.section.7.3.7">7.3.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-sign-signature">Signing Signature Values</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.7.4">7.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#matching-covered-components-to-message">Matching Signature
                                                Parameters to the Target Message</a>
                                            <ul>
                                                <li><a href="#rfc.section.7.4.1">7.4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-modify">Modification of Required Message
                                                        Parameters</a></li>
                                                <li><a href="#rfc.section.7.4.2">7.4.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-mismatch">Matching Values of Covered Components
                                                        to Values in the Target Message</a></li>
                                                <li><a href="#rfc.section.7.4.3">7.4.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-message-component-context">Message Component
                                                        Source and Context</a></li>
                                                <li><a href="#rfc.section.7.4.4">7.4.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-context-multiple-signatures">Multiple Message
                                                        Component Contexts</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.7.5">7.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-processing">HTTP Processing</a>
                                            <ul>
                                                <li><a href="#rfc.section.7.5.1">7.5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-lazy-header-parser">Processing Invalid HTTP
                                                        Field Names as Derived Component Names</a></li>
                                                <li><a href="#rfc.section.7.5.2">7.5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-field-values">Semantically Equivalent Field
                                                        Values</a></li>
                                                <li><a href="#rfc.section.7.5.3">7.5.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-structured">Parsing Structured Field Values</a>
                                                </li>
                                                <li><a href="#rfc.section.7.5.4">7.5.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-versions">HTTP Versions and Component
                                                        Ambiguity</a></li>
                                                <li><a href="#rfc.section.7.5.5">7.5.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-canonicalization">Canonicalization Attacks</a>
                                                </li>
                                                <li><a href="#rfc.section.7.5.6">7.5.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-non-list">Non-List Field Values</a></li>
                                                <li><a href="#rfc.section.7.5.7">7.5.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-multiple-fields">Padding Attacks with Multiple
                                                        Field Values</a></li>
                                                <li><a href="#rfc.section.7.5.8">7.5.8.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#security-query-elements">Ambiguous Handling of Query
                                                        Elements</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.8">8.</a>&nbsp;&nbsp;&nbsp;<a href="#privacy">Privacy
                                        Considerations</a>
                                    <ul>
                                        <li><a href="#rfc.section.8.1">8.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#privacy-identify-keys">Identification through Keys</a></li>
                                        <li><a href="#rfc.section.8.2">8.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#privacy-confidentiality">Signatures do not provide
                                                confidentiality</a></li>
                                        <li><a href="#rfc.section.8.3">8.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#privacy-oracle">Oracles</a></li>
                                        <li><a href="#rfc.section.8.4">8.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#privacy-required">Required Content</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.9">9.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references">References</a>
                                    <ul>
                                        <li><a href="#rfc.section.9.1">9.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.2">Normative References</a></li>
                                        <li><a href="#rfc.section.9.2">9.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.3">Informative References</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.A">Appendix A.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#detection">Detecting HTTP Message Signatures</a></li>
                                <li><a href="#rfc.section.B">Appendix B.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#examples">Examples</a>
                                    <ul>
                                        <li><a href="#rfc.section.B.1">B.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#example-keys">Example Keys</a>
                                            <ul>
                                                <li><a href="#rfc.section.B.1.1">B.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#example-key-rsa-test">Example RSA Key</a></li>
                                                <li><a href="#rfc.section.B.1.2">B.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#example-key-rsa-pss-test">Example RSA-PSS Key</a></li>
                                                <li><a href="#rfc.section.B.1.3">B.1.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#example-key-ecc-p256">Example ECC P-256 Test Key</a></li>
                                                <li><a href="#rfc.section.B.1.4">B.1.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#example-key-ed25519">Example Ed25519 Test Key</a></li>
                                                <li><a href="#rfc.section.B.1.5">B.1.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#example-shared-secret">Example Shared Secret</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.B.2">B.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#test-cases">Test Cases</a>
                                            <ul>
                                                <li><a href="#rfc.section.B.2.1">B.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#minimal-signature-using-rsa-pss-sha512">Minimal Signature
                                                        Using rsa-pss-sha512</a></li>
                                                <li><a href="#rfc.section.B.2.2">B.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#selective-covered-components-using-rsa-pss-sha512">Selective
                                                        Covered Components Using rsa-pss-sha512</a></li>
                                                <li><a href="#rfc.section.B.2.3">B.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#full-coverage-using-rsa-pss-sha512">Full Coverage Using
                                                        rsa-pss-sha512</a></li>
                                                <li><a href="#rfc.section.B.2.4">B.2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#signing-a-response-using-ecdsa-p256-sha256">Signing a
                                                        Response Using ecdsa-p256-sha256</a></li>
                                                <li><a href="#rfc.section.B.2.5">B.2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#signing-a-request-using-hmac-sha256">Signing a Request
                                                        Using hmac-sha256</a></li>
                                                <li><a href="#rfc.section.B.2.6">B.2.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                        href="#signing-a-request-using-ed25519">Signing a Request Using
                                                        ed25519</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#rfc.section.B.3">B.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#tls-terminating-proxies">TLS-Terminating Proxies</a></li>
                                        <li><a href="#rfc.section.B.4">B.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#example-transform">HTTP Message Transformations</a></li>
                                    </ul>
                                </li>
                                <li><a href="#acknowledgements">Acknowledgements</a></li>
                                <li><a href="#rfc.authors">Authors' Addresses</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-8 order-first main" role="main">
                <header>
                    <table class="table table-condensed header" id="rfc.headerblock">
                        <tbody>
                            <tr>
                                <td class="text-left">Internet Engineering Task Force (IETF)</td>
                                <td class="text-right">A. Backman, Editor</td>
                            </tr>
                            <tr>
                                <td class="text-left">Request for Comments: 9421</td>
                                <td class="text-right">Amazon</td>
                            </tr>
                            <tr>
                                <td class="text-left">Category: Standards Track</td>
                                <td class="text-right">J. Richer, Editor</td>
                            </tr>
                            <tr>
                                <td class="text-left">ISSN: 2070-1721</td>
                                <td class="text-right">Bespoke Engineering</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">M. Sporny</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">Digital Bazaar</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">February 2024</td>
                            </tr>
                        </tbody>
                    </table>
                    <div id="rfc.title">
                        <h1>HTTP Message Signatures</h1>
                    </div>
                </header>
                <hr>
                <h2 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h2>
                <div class="lead">
                    <div id="rfc.abstract.p.1">
                        <p>This document describes a mechanism for creating, encoding, and verifying digital signatures
                            or message authentication codes over components of an HTTP message. This mechanism supports
                            use cases where the full HTTP message may not be known to the signer and where the message
                            may be transformed (e.g., by intermediaries) before reaching the verifier. This document
                            also describes a means for requesting that a signature be applied to a subsequent HTTP
                            message in an ongoing HTTP exchange.</p>
                    </div>
                </div>
                <aside id="rfc.meta" class="alert alert-info"></aside>
                <section id="rfc.status">
                    <h2><a href="#rfc.status">Status of This Memo</a></h2>
                    <div id="rfc.boilerplate.1.p.1">
                        <p>This is an Internet Standards Track document.</p>
                    </div>
                    <div id="rfc.boilerplate.1.p.2">
                        <p>This document is a product of the Internet Engineering Task Force (IETF). It represents the
                            consensus of the IETF community. It has received public review and has been approved for
                            publication by the Internet Engineering Steering Group (IESG). Further information on
                            Internet Standards is available in <a
                                href="https://www.rfc-editor.org/rfc/rfc7841.html#section-2">Section 2 of RFC 7841</a>.
                        </p>
                    </div>
                    <div id="rfc.boilerplate.1.p.3">
                        <p>Information about the current status of this document, any errata, and how to provide
                            feedback on it may be obtained at <a
                                href="https://www.rfc-editor.org/info/rfc9421">https://www.rfc-editor.org/info/rfc9421</a>.
                        </p>
                    </div>
                </section>
                <section id="rfc.copyrightnotice">
                    <h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2>
                    <div id="rfc.boilerplate.2.p.1">
                        <p>Copyright (c) 2024 IETF Trust and the persons identified as the document authors. All rights
                            reserved.</p>
                    </div>
                    <div id="rfc.boilerplate.2.p.2">
                        <p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF
                            Documents (<a
                                href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>)
                            in effect on the date of publication of this document. Please review these documents
                            carefully, as they describe your rights and restrictions with respect to this document. Code
                            Components extracted from this document must include Revised BSD License text as described
                            in Section 4.e of the Trust Legal Provisions and are provided without warranty as described
                            in the Revised BSD License.</p>
                    </div>
                </section>
                <div class="toc d-lg-none">
                    <ul>
                        <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#intro">Introduction</a>
                            <ul>
                                <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#definitions">Conventions and Terminology</a></li>
                                <li><a href="#rfc.section.1.2">1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#requirements">Requirements</a></li>
                                <li><a href="#rfc.section.1.3">1.3.</a>&nbsp;&nbsp;&nbsp;<a href="#transforms">HTTP
                                        Message Transformations</a></li>
                                <li><a href="#rfc.section.1.4">1.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#application">Application of HTTP Message Signatures</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#covered-components">HTTP Message
                                Components</a>
                            <ul>
                                <li><a href="#rfc.section.2.1">2.1.</a>&nbsp;&nbsp;&nbsp;<a href="#http-fields">HTTP
                                        Fields</a>
                                    <ul>
                                        <li><a href="#rfc.section.2.1.1">2.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-field-structured">Strict Serialization of HTTP Structured
                                                Fields</a></li>
                                        <li><a href="#rfc.section.2.1.2">2.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-field-dictionary">Dictionary Structured Field Members</a>
                                        </li>
                                        <li><a href="#rfc.section.2.1.3">2.1.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-field-byte-sequence">Binary-Wrapped HTTP Fields</a></li>
                                        <li><a href="#rfc.section.2.1.4">2.1.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-trailer">Trailer Fields</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.2.2">2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#derived-components">Derived Components</a>
                                    <ul>
                                        <li><a href="#rfc.section.2.2.1">2.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-method">Method</a></li>
                                        <li><a href="#rfc.section.2.2.2">2.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-target-uri">Target URI</a></li>
                                        <li><a href="#rfc.section.2.2.3">2.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-authority">Authority</a></li>
                                        <li><a href="#rfc.section.2.2.4">2.2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-scheme">Scheme</a></li>
                                        <li><a href="#rfc.section.2.2.5">2.2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-target">Request Target</a></li>
                                        <li><a href="#rfc.section.2.2.6">2.2.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-path">Path</a></li>
                                        <li><a href="#rfc.section.2.2.7">2.2.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-query">Query</a></li>
                                        <li><a href="#rfc.section.2.2.8">2.2.8.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-request-query-param">Query Parameters</a></li>
                                        <li><a href="#rfc.section.2.2.9">2.2.9.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#content-status-code">Status Code</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.2.3">2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#signature-params">Signature Parameters</a></li>
                                <li><a href="#rfc.section.2.4">2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#content-request-response">Signing Request Components in a Response
                                        Message</a></li>
                                <li><a href="#rfc.section.2.5">2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#create-sig-input">Creating the Signature Base</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#message-signatures">HTTP Message
                                Signatures</a>
                            <ul>
                                <li><a href="#rfc.section.3.1">3.1.</a>&nbsp;&nbsp;&nbsp;<a href="#sign">Creating a
                                        Signature</a></li>
                                <li><a href="#rfc.section.3.2">3.2.</a>&nbsp;&nbsp;&nbsp;<a href="#verify">Verifying a
                                        Signature</a>
                                    <ul>
                                        <li><a href="#rfc.section.3.2.1">3.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#verify-requirements">Enforcing Application Requirements</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.3.3">3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#signature-methods">Signature Algorithms</a>
                                    <ul>
                                        <li><a href="#rfc.section.3.3.1">3.3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#method-rsa-pss-sha512">RSASSA-PSS Using SHA-512</a></li>
                                        <li><a href="#rfc.section.3.3.2">3.3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#method-rsa-v1_5-sha256">RSASSA-PKCS1-v1_5 Using SHA-256</a></li>
                                        <li><a href="#rfc.section.3.3.3">3.3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#method-hmac-sha256">HMAC Using SHA-256</a></li>
                                        <li><a href="#rfc.section.3.3.4">3.3.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#method-ecdsa-p256-sha256">ECDSA Using Curve P-256 DSS and
                                                SHA-256</a></li>
                                        <li><a href="#rfc.section.3.3.5">3.3.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#method-ecdsa-p384-sha384">ECDSA Using Curve P-384 DSS and
                                                SHA-384</a></li>
                                        <li><a href="#rfc.section.3.3.6">3.3.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#method-ed25519">EdDSA Using Curve edwards25519</a></li>
                                        <li><a href="#rfc.section.3.3.7">3.3.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#method-jose">JSON Web Signature (JWS) Algorithms</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#attach-signature">Including a
                                Message Signature in a Message</a>
                            <ul>
                                <li><a href="#rfc.section.4.1">4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#signature-input-header">The Signature-Input HTTP Field</a></li>
                                <li><a href="#rfc.section.4.2">4.2.</a>&nbsp;&nbsp;&nbsp;<a href="#signature-header">The
                                        Signature HTTP Field</a></li>
                                <li><a href="#rfc.section.4.3">4.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#signature-multiple">Multiple Signatures</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#request-signature">Requesting
                                Signatures</a>
                            <ul>
                                <li><a href="#rfc.section.5.1">5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#accept-signature-header">The Accept-Signature Field</a></li>
                                <li><a href="#rfc.section.5.2">5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#processing-an-accept-signature">Processing an Accept-Signature</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#iana">IANA Considerations</a>
                            <ul>
                                <li><a href="#rfc.section.6.1">6.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#http-field-name-registration">HTTP Field Name Registration</a></li>
                                <li><a href="#rfc.section.6.2">6.2.</a>&nbsp;&nbsp;&nbsp;<a href="#hsa-registry">HTTP
                                        Signature Algorithms Registry</a>
                                    <ul>
                                        <li><a href="#rfc.section.6.2.1">6.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-hsa-template">Registration Template</a></li>
                                        <li><a href="#rfc.section.6.2.2">6.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-hsa-contents">Initial Contents</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.6.3">6.3.</a>&nbsp;&nbsp;&nbsp;<a href="#param-registry">HTTP
                                        Signature Metadata Parameters Registry</a>
                                    <ul>
                                        <li><a href="#rfc.section.6.3.1">6.3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-param-template">Registration Template</a></li>
                                        <li><a href="#rfc.section.6.3.2">6.3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-param-contents">Initial Contents</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.6.4">6.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#content-registry">HTTP Signature Derived Component Names Registry</a>
                                    <ul>
                                        <li><a href="#rfc.section.6.4.1">6.4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-content-template">Registration Template</a></li>
                                        <li><a href="#rfc.section.6.4.2">6.4.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-content-contents">Initial Contents</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.6.5">6.5.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#component-param-registry">HTTP Signature Component Parameters
                                        Registry</a>
                                    <ul>
                                        <li><a href="#rfc.section.6.5.1">6.5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-component-param-template">Registration Template</a></li>
                                        <li><a href="#rfc.section.6.5.2">6.5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#iana-component-param-contents">Initial Contents</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a href="#security">Security
                                Considerations</a>
                            <ul>
                                <li><a href="#rfc.section.7.1">7.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#general-considerations">General Considerations</a>
                                    <ul>
                                        <li><a href="#rfc.section.7.1.1">7.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-ignore">Skipping Signature Verification</a></li>
                                        <li><a href="#rfc.section.7.1.2">7.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-tls">Use of TLS</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.7.2">7.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#message-processing-and-selection">Message Processing and Selection</a>
                                    <ul>
                                        <li><a href="#rfc.section.7.2.1">7.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-coverage">Insufficient Coverage</a></li>
                                        <li><a href="#rfc.section.7.2.2">7.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-replay">Signature Replay</a></li>
                                        <li><a href="#rfc.section.7.2.3">7.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-components">Choosing Message Components</a></li>
                                        <li><a href="#rfc.section.7.2.4">7.2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-not-fields">Choosing Signature Parameters and Derived
                                                Components over HTTP Fields</a></li>
                                        <li><a href="#rfc.section.7.2.5">7.2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-labels">Signature Labels</a></li>
                                        <li><a href="#rfc.section.7.2.6">7.2.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-multiple">Multiple Signature Confusion</a></li>
                                        <li><a href="#rfc.section.7.2.7">7.2.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-signature-tag">Collision of Application-Specific
                                                Signature Tag</a></li>
                                        <li><a href="#rfc.section.7.2.8">7.2.8.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-message-content">Message Content</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.7.3">7.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#cryptographic-considerations">Cryptographic Considerations</a>
                                    <ul>
                                        <li><a href="#rfc.section.7.3.1">7.3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-collision">Cryptography and Signature Collision</a></li>
                                        <li><a href="#rfc.section.7.3.2">7.3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-keys">Key Theft</a></li>
                                        <li><a href="#rfc.section.7.3.3">7.3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-symmetric">Symmetric Cryptography</a></li>
                                        <li><a href="#rfc.section.7.3.4">7.3.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-keymixup">Key Specification Mixup</a></li>
                                        <li><a href="#rfc.section.7.3.5">7.3.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-nondeterministic">Non-deterministic Signature
                                                Primitives</a></li>
                                        <li><a href="#rfc.section.7.3.6">7.3.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-keydowngrade">Key and Algorithm Specification
                                                Downgrades</a></li>
                                        <li><a href="#rfc.section.7.3.7">7.3.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-sign-signature">Signing Signature Values</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.7.4">7.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#matching-covered-components-to-message">Matching Signature Parameters to
                                        the Target Message</a>
                                    <ul>
                                        <li><a href="#rfc.section.7.4.1">7.4.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-modify">Modification of Required Message Parameters</a>
                                        </li>
                                        <li><a href="#rfc.section.7.4.2">7.4.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-mismatch">Matching Values of Covered Components to
                                                Values in the Target Message</a></li>
                                        <li><a href="#rfc.section.7.4.3">7.4.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-message-component-context">Message Component Source and
                                                Context</a></li>
                                        <li><a href="#rfc.section.7.4.4">7.4.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-context-multiple-signatures">Multiple Message Component
                                                Contexts</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.7.5">7.5.</a>&nbsp;&nbsp;&nbsp;<a href="#http-processing">HTTP
                                        Processing</a>
                                    <ul>
                                        <li><a href="#rfc.section.7.5.1">7.5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-lazy-header-parser">Processing Invalid HTTP Field Names
                                                as Derived Component Names</a></li>
                                        <li><a href="#rfc.section.7.5.2">7.5.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-field-values">Semantically Equivalent Field Values</a>
                                        </li>
                                        <li><a href="#rfc.section.7.5.3">7.5.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-structured">Parsing Structured Field Values</a></li>
                                        <li><a href="#rfc.section.7.5.4">7.5.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-versions">HTTP Versions and Component Ambiguity</a></li>
                                        <li><a href="#rfc.section.7.5.5">7.5.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-canonicalization">Canonicalization Attacks</a></li>
                                        <li><a href="#rfc.section.7.5.6">7.5.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-non-list">Non-List Field Values</a></li>
                                        <li><a href="#rfc.section.7.5.7">7.5.7.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-multiple-fields">Padding Attacks with Multiple Field
                                                Values</a></li>
                                        <li><a href="#rfc.section.7.5.8">7.5.8.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#security-query-elements">Ambiguous Handling of Query Elements</a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.8">8.</a>&nbsp;&nbsp;&nbsp;<a href="#privacy">Privacy
                                Considerations</a>
                            <ul>
                                <li><a href="#rfc.section.8.1">8.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#privacy-identify-keys">Identification through Keys</a></li>
                                <li><a href="#rfc.section.8.2">8.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#privacy-confidentiality">Signatures do not provide confidentiality</a>
                                </li>
                                <li><a href="#rfc.section.8.3">8.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#privacy-oracle">Oracles</a></li>
                                <li><a href="#rfc.section.8.4">8.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#privacy-required">Required Content</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.9">9.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">References</a>
                            <ul>
                                <li><a href="#rfc.section.9.1">9.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.2">Normative References</a></li>
                                <li><a href="#rfc.section.9.2">9.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.3">Informative References</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.A">Appendix A.</a>&nbsp;&nbsp;&nbsp;<a href="#detection">Detecting
                                HTTP Message Signatures</a></li>
                        <li><a href="#rfc.section.B">Appendix B.</a>&nbsp;&nbsp;&nbsp;<a href="#examples">Examples</a>
                            <ul>
                                <li><a href="#rfc.section.B.1">B.1.</a>&nbsp;&nbsp;&nbsp;<a href="#example-keys">Example
                                        Keys</a>
                                    <ul>
                                        <li><a href="#rfc.section.B.1.1">B.1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#example-key-rsa-test">Example RSA Key</a></li>
                                        <li><a href="#rfc.section.B.1.2">B.1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#example-key-rsa-pss-test">Example RSA-PSS Key</a></li>
                                        <li><a href="#rfc.section.B.1.3">B.1.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#example-key-ecc-p256">Example ECC P-256 Test Key</a></li>
                                        <li><a href="#rfc.section.B.1.4">B.1.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#example-key-ed25519">Example Ed25519 Test Key</a></li>
                                        <li><a href="#rfc.section.B.1.5">B.1.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#example-shared-secret">Example Shared Secret</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.B.2">B.2.</a>&nbsp;&nbsp;&nbsp;<a href="#test-cases">Test
                                        Cases</a>
                                    <ul>
                                        <li><a href="#rfc.section.B.2.1">B.2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#minimal-signature-using-rsa-pss-sha512">Minimal Signature Using
                                                rsa-pss-sha512</a></li>
                                        <li><a href="#rfc.section.B.2.2">B.2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#selective-covered-components-using-rsa-pss-sha512">Selective
                                                Covered Components Using rsa-pss-sha512</a></li>
                                        <li><a href="#rfc.section.B.2.3">B.2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#full-coverage-using-rsa-pss-sha512">Full Coverage Using
                                                rsa-pss-sha512</a></li>
                                        <li><a href="#rfc.section.B.2.4">B.2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signing-a-response-using-ecdsa-p256-sha256">Signing a Response
                                                Using ecdsa-p256-sha256</a></li>
                                        <li><a href="#rfc.section.B.2.5">B.2.5.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signing-a-request-using-hmac-sha256">Signing a Request Using
                                                hmac-sha256</a></li>
                                        <li><a href="#rfc.section.B.2.6">B.2.6.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#signing-a-request-using-ed25519">Signing a Request Using
                                                ed25519</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.B.3">B.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#tls-terminating-proxies">TLS-Terminating Proxies</a></li>
                                <li><a href="#rfc.section.B.4">B.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#example-transform">HTTP Message Transformations</a></li>
                            </ul>
                        </li>
                        <li><a href="#acknowledgements">Acknowledgements</a></li>
                        <li><a href="#rfc.authors">Authors' Addresses</a></li>
                    </ul>
                </div>
                <hr class="hidden-print">
                <section id="intro">
                    <h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a
                            href="#intro">Introduction</a></h2>
                    <div id="rfc.section.1.p.1">
                        <p>Message integrity and authenticity are security properties that are critical to the secure
                            operation of many HTTP applications. Application developers typically rely on the transport
                            layer to provide these properties, by operating their application over TLS <a
                                href="#RFC8446"><cite
                                    title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS]</cite></a>.
                            However, TLS only guarantees these properties over a single TLS connection, and the path
                            between the client and application may be composed of multiple independent TLS connections
                            (for example, if the application is hosted behind a TLS-terminating gateway or if the client
                            is behind a TLS Inspection appliance). In such cases, TLS cannot guarantee end-to-end
                            message integrity or authenticity between the client and application. Additionally, some
                            operating environments present obstacles that make it impractical to use TLS (such as the
                            presentation of client certificates from a browser) or to use features necessary to provide
                            message authenticity. Furthermore, some applications require the binding of a higher-level
                            application-specific key to the HTTP message, separate from any TLS certificates in use.
                            Consequently, while TLS can meet message integrity and authenticity needs for many
                            HTTP-based applications, it is not a universal solution.</p>
                    </div>
                    <div id="rfc.section.1.p.2">
                        <p>Additionally, many applications need to be able to generate and verify signatures despite
                            incomplete knowledge of the HTTP message as seen on the wire, due to the use of libraries,
                            proxies, or application frameworks that alter or hide portions of the message from the
                            application at the time of signing or verification. These applications need a means to
                            protect the parts of the message that are most relevant to the application without having to
                            violate layering and abstraction.</p>
                    </div>
                    <div id="rfc.section.1.p.3">
                        <p>Finally, object-based signature mechanisms such as JSON Web Signature <a
                                href="#RFC7515"><cite title="JSON Web Signature (JWS)">[JWS]</cite></a> require the
                            intact conveyance of the exact information that was signed. When applying such technologies
                            to an HTTP message, elements of the HTTP message need to be duplicated in the object payload
                            either directly or through the inclusion of a hash. This practice introduces complexity,
                            since the repeated information needs to be carefully checked for consistency when the
                            signature is verified.</p>
                    </div>
                    <div id="rfc.section.1.p.4">
                        <p>This document defines a mechanism for providing end-to-end integrity and authenticity for
                            components of an HTTP message by using a detached signature on HTTP messages. The mechanism
                            allows applications to create digital signatures or message authentication codes (MACs) over
                            only the components of the message that are meaningful and appropriate for the application.
                            Strict canonicalization rules ensure that the verifier can verify the signature even if the
                            message has been transformed in many of the ways permitted by HTTP.</p>
                    </div>
                    <div id="rfc.section.1.p.5" class="avoidbreakafter">
                        <p>The signing mechanism described in this document consists of three parts:</p>
                    </div>
                    <div id="rfc.section.1.p.6">
                        <ul>
                            <li>A common nomenclature and canonicalization rule set for the different protocol elements
                                and other components of HTTP messages, used to create the signature base (<a
                                    href="#covered-components" title="HTTP Message Components">Section 2</a>).</li>
                            <li>Algorithms for generating and verifying signatures over HTTP message components using
                                this signature base through the application of cryptographic primitives (<a
                                    href="#message-signatures" title="HTTP Message Signatures">Section 3</a>).</li>
                            <li>A mechanism for attaching a signature and related metadata to an HTTP message and for
                                parsing attached signatures and metadata from HTTP messages. To facilitate this, this
                                document defines the "Signature-Input" and "Signature" fields (<a
                                    href="#attach-signature" title="Including a Message Signature in a Message">Section
                                    4</a>).</li>
                        </ul>
                    </div>
                    <div id="rfc.section.1.p.7">
                        <p>This document also provides a mechanism for negotiating the use of signatures in one or more
                            subsequent messages via the "Accept-Signature" field (<a href="#request-signature"
                                title="Requesting Signatures">Section 5</a>). This optional negotiation mechanism can be
                            used along with opportunistic or application-driven message signatures by either party.</p>
                    </div>
                    <div id="rfc.section.1.p.8">
                        <p>The mechanisms defined in this document are important tools that can be used to build an
                            overall security mechanism for an application. This toolkit provides some powerful
                            capabilities but is not sufficient in creating an overall security story. In particular, the
                            requirements listed in <a href="#application"
                                title="Application of HTTP Message Signatures">Section 1.4</a> and the security
                            considerations discussed in <a href="#security" title="Security Considerations">Section
                                7</a> are of high importance to all implementors of this specification. For example,
                            this specification does not define a means to directly cover HTTP message content (defined
                            in <a href="https://www.rfc-editor.org/rfc/rfc9110.html#section-6.4">Section 6.4</a> of <a
                                href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>); rather, it relies on
                            the Digest specification <a href="#RFC9530"><cite title="Digest Fields">[DIGEST]</cite></a>
                            to provide a hash of the message content, as discussed in <a
                                href="#security-message-content" title="Message Content">Section 7.2.8</a>.</p>
                    </div>
                    <section id="definitions">
                        <h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a>&nbsp;<a
                                href="#definitions">Conventions and Terminology</a></h3>
                        <div id="rfc.section.1.1.p.1">
                            <p>The key words "<em class="bcp14">MUST</em>", "<em class="bcp14">MUST NOT</em>", "<em
                                    class="bcp14">REQUIRED</em>", "<em class="bcp14">SHALL</em>", "<em
                                    class="bcp14">SHALL NOT</em>", "<em class="bcp14">SHOULD</em>", "<em
                                    class="bcp14">SHOULD NOT</em>", "<em class="bcp14">RECOMMENDED</em>", "<em
                                    class="bcp14">NOT RECOMMENDED</em>", "<em class="bcp14">MAY</em>", and "<em
                                    class="bcp14">OPTIONAL</em>" in this document are to be interpreted as described in
                                <span class="nobr">BCP 14</span> <a href="#RFC2119"><cite
                                        title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a>
                                <a href="#RFC8174"><cite
                                        title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">[RFC8174]</cite></a>
                                when, and only when, they appear in all capitals, as shown here.
                            </p>
                        </div>
                        <div id="rfc.section.1.1.p.2">
                            <p>The terms "HTTP message", "HTTP request", "HTTP response", "target URI", "gateway",
                                "header field", "intermediary", "request target", "trailer field", "sender", "method",
                                and "recipient" are used as defined in <a href="#RFC9110"><cite
                                        title="HTTP Semantics">[HTTP]</cite></a>.</p>
                        </div>
                        <div id="rfc.section.1.1.p.3">
                            <p>For brevity, the term "signature" on its own is used in this document to refer to both
                                digital signatures (which use asymmetric cryptography) and keyed MACs (which use
                                symmetric cryptography). Similarly, the verb "sign" refers to the generation of either a
                                digital signature or keyed MAC over a given signature base. The qualified term "digital
                                signature" refers specifically to the output of an asymmetric cryptographic signing
                                operation.</p>
                        </div>
                        <div id="rfc.section.1.1.p.4">
                            <p>This document uses the following terminology from <a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3">Section 3</a> of <a
                                    href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a> to
                                specify data types: List, Inner List, Dictionary, Item, String, Integer, Byte Sequence,
                                and Boolean.</p>
                        </div>
                        <div id="rfc.section.1.1.p.5">
                            <p>This document defines several string constructions using ABNF <a href="#RFC5234"><cite
                                        title="Augmented BNF for Syntax Specifications: ABNF">[ABNF]</cite></a> and uses
                                the following ABNF rules: <span class="tt">VCHAR</span>, <span class="tt">SP</span>,
                                <span class="tt">DQUOTE</span>, and <span class="tt">LF</span>. This document uses the
                                following ABNF rules from <a href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>: <span
                                    class="tt">sf-string</span>, <span class="tt">inner-list</span>, and <span
                                    class="tt">parameters</span>. This document uses the following ABNF rules from <a
                                    href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a> and <a
                                    href="#RFC9112"><cite title="HTTP/1.1">[HTTP/1.1]</cite></a>: <span
                                    class="tt">field-content</span>, <span class="tt">obs-fold</span>, and <span
                                    class="tt">obs-text</span>.
                            </p>
                        </div>
                        <div id="rfc.section.1.1.p.6" class="avoidbreakafter">
                            <p>In addition to those listed above, this document uses the following terms:</p>
                        </div>
                        <div id="rfc.section.1.1.p.7">
                            <dl class="nohang">
                                <dt>HTTP Message Signature:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A digital signature or keyed MAC that covers one or more portions of an HTTP
                                        message. Note that a given HTTP message can contain multiple HTTP message
                                        signatures.</div>
                                </dd>
                                <dt>Signer:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The entity that is generating or has generated an HTTP message signature. Note
                                        that multiple entities can act as signers and apply separate HTTP message
                                        signatures to a given HTTP message.</div>
                                </dd>
                                <dt>Verifier:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>An entity that is verifying or has verified an HTTP message signature against
                                        an HTTP message. Note that an HTTP message signature may be verified multiple
                                        times, potentially by different entities.</div>
                                </dd>
                                <dt>HTTP Message Component:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A portion of an HTTP message that is capable of being covered by an HTTP
                                        message signature.</div>
                                </dd>
                                <dt>Derived Component:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>An HTTP message component derived from the HTTP message through the use of a
                                        specified algorithm or process. See <a href="#derived-components"
                                            title="Derived Components">Section 2.2</a>.</div>
                                </dd>
                                <dt>HTTP Message Component Name:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A String that identifies an HTTP message component's source, such as a field
                                        name or derived component name.</div>
                                </dd>
                                <dt>HTTP Message Component Identifier:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The combination of an HTTP message component name and any parameters. This
                                        combination uniquely identifies a specific HTTP message component with respect
                                        to a particular HTTP message signature and the HTTP message it applies to.</div>
                                </dd>
                                <dt>HTTP Message Component Value:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The value associated with a given component identifier within the context of a
                                        particular HTTP message. Component values are derived from the HTTP message and
                                        are usually subject to a canonicalization process.</div>
                                </dd>
                                <dt>Covered Components:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>An ordered set of HTTP message component identifiers for fields (<a
                                            href="#http-fields" title="HTTP Fields">Section 2.1</a>) and derived
                                        components (<a href="#derived-components" title="Derived Components">Section
                                            2.2</a>) that indicates the set of message components covered by the
                                        signature, never including the <span class="tt">@signature-params</span>
                                        identifier itself. The order of this set is preserved and communicated between
                                        the signer and verifier to facilitate reconstruction of the signature base.
                                    </div>
                                </dd>
                                <dt>Signature Base:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The sequence of bytes generated by the signer and verifier using the covered
                                        components set and the HTTP message. The signature base is processed by the
                                        cryptographic algorithm to produce or verify the HTTP message signature.</div>
                                </dd>
                                <dt>HTTP Message Signature Algorithm:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A cryptographic algorithm that describes the signing and verification process
                                        for the signature, defined in terms of the <span class="tt">HTTP_SIGN</span> and
                                        <span class="tt">HTTP_VERIFY</span> primitives described in <a
                                            href="#signature-methods" title="Signature Algorithms">Section 3.3</a>.
                                    </div>
                                </dd>
                                <dt>Key Material:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The key material required to create or verify the signature. The key material
                                        is often identified with an explicit key identifier, allowing the signer to
                                        indicate to the verifier which key was used.</div>
                                </dd>
                                <dt>Creation Time:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A timestamp representing the point in time that the signature was generated, as
                                        asserted by the signer.</div>
                                </dd>
                                <dt>Expiration Time:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A timestamp representing the point in time after which the signature should no
                                        longer be accepted by the verifier, as asserted by the signer.</div>
                                </dd>
                                <dt>Target Message:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The HTTP message to which an HTTP message signature is applied.</div>
                                </dd>
                                <dt>Signature Context:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The data source from which the HTTP message component values are drawn. The
                                        context includes the target message and any additional information the signer or
                                        verifier might have, such as the full target URI of a request or the related
                                        request message for a response.</div>
                                </dd>
                            </dl>
                        </div>
                        <div id="rfc.section.1.1.p.8">
                            <p>The term "UNIX timestamp" refers to what Section 4.16 of <a href="#POSIX"><cite
                                        title="The Open Group Base Specifications Issue 7, 2018 edition">[POSIX.1]</cite></a>
                                calls "seconds since the Epoch".</p>
                        </div>
                        <div id="rfc.section.1.1.p.9">
                            <p>This document contains non-normative examples of partial and complete HTTP messages. Some
                                examples use a single trailing backslash (<span class="tt">\</span>) to indicate line
                                wrapping for long values, as per <a href="#RFC8792"><cite
                                        title="Handling Long Lines in Content of Internet-Drafts and RFCs">[RFC8792]</cite></a>.
                                The <span class="tt">\</span> character and leading spaces on wrapped lines are not part
                                of the value.</p>
                        </div>
                    </section>
                    <section id="requirements">
                        <h3 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2.</a>&nbsp;<a
                                href="#requirements">Requirements</a></h3>
                        <div id="rfc.section.1.2.p.1">
                            <p>HTTP permits, and sometimes requires, intermediaries to transform messages in a variety
                                of ways. This can result in a recipient receiving a message that is not
                                bitwise-equivalent to the message that was originally sent. In such a case, the
                                recipient will be unable to verify integrity protections over the raw bytes of the
                                sender's HTTP message, as verifying digital signatures or MACs requires both signer and
                                verifier to have the exact same signature base. Since the exact raw bytes of the message
                                cannot be relied upon as a reliable source for a signature base, the signer and verifier
                                have to independently create the signature base from their respective versions of the
                                message, via a mechanism that is resilient to safe changes that do not alter the meaning
                                of the message.</p>
                        </div>
                        <div id="rfc.section.1.2.p.2">
                            <p>For a variety of reasons, it is impractical to strictly define what constitutes a safe
                                change versus an unsafe one. Applications use HTTP in a wide variety of ways and may
                                disagree on whether a particular piece of information in a message (e.g., the message
                                content, the method, or a particular header field) is relevant. Thus, a general-purpose
                                solution needs to provide signers with some degree of control over which message
                                components are signed.</p>
                        </div>
                        <div id="rfc.section.1.2.p.3">
                            <p>HTTP applications may be running in environments that do not provide complete access to
                                or control over HTTP messages (such as a web browser's JavaScript environment) or may be
                                using libraries that abstract away the details of the protocol (such as <a
                                    href="https://openjdk.java.net/groups/net/httpclient/intro.html">the Java HTTP
                                    Client (HttpClient) library</a>). These applications need to be able to generate and
                                verify signatures despite incomplete knowledge of the HTTP message.</p>
                        </div>
                    </section>
                    <section id="transforms">
                        <h3 id="rfc.section.1.3"><a href="#rfc.section.1.3">1.3.</a>&nbsp;<a href="#transforms">HTTP
                                Message Transformations</a></h3>
                        <div id="rfc.section.1.3.p.1" class="avoidbreakafter">
                            <p>As mentioned earlier, HTTP explicitly permits, and in some cases requires,
                                implementations to transform messages in a variety of ways. Implementations are required
                                to tolerate many of these transformations. What follows is a non-normative and
                                non-exhaustive list of transformations that could occur under HTTP, provided as context:
                            </p>
                        </div>
                        <div id="rfc.section.1.3.p.2">
                            <ul>
                                <li>Reordering of fields with different field names (<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.3">Section 5.3</a>
                                    of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>).</li>
                                <li>Combination of fields with the same field name (<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.2">Section 5.2</a>
                                    of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>).</li>
                                <li>Removal of fields listed in the Connection header field (<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.6.1">Section
                                        7.6.1</a> of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>).
                                </li>
                                <li>Addition of fields that indicate control options (<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.6.1">Section
                                        7.6.1</a> of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>).
                                </li>
                                <li>Addition or removal of a transfer coding (<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.7">Section 7.7</a>
                                    of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>).</li>
                                <li>Addition of fields such as Via (<a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.6.3">Section
                                        7.6.3</a> of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>)
                                    and Forwarded (<a
                                        href="https://www.rfc-editor.org/rfc/rfc7239.html#section-4">Section 4</a> of <a
                                        href="#RFC7239"><cite title="Forwarded HTTP Extension">[RFC7239]</cite></a>).
                                </li>
                                <li>Conversion between different versions of HTTP (e.g., HTTP/1.x to HTTP/2, or vice
                                    versa).</li>
                                <li>Changes in case (e.g., "Origin" to "origin") of any case-insensitive components such
                                    as field names, request URI scheme, or host.</li>
                                <li>Changes to the request target and authority that, when applied together, do not
                                    result in a change to the message's target URI, as defined in <a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.1">Section 7.1</a>
                                    of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>.</li>
                            </ul>
                        </div>
                        <div id="rfc.section.1.3.p.3" class="avoidbreakafter">
                            <p>Additionally, there are some transformations that are either deprecated or otherwise not
                                allowed but that could still occur in the wild. These transformations can still be
                                handled without breaking the signature; they include such actions as:</p>
                        </div>
                        <div id="rfc.section.1.3.p.4">
                            <ul>
                                <li>Use, addition, or removal of leading or trailing whitespace in a field value.</li>
                                <li>Use, addition, or removal of <span class="tt">obs-fold</span> in field values (<a
                                        href="https://www.rfc-editor.org/rfc/rfc9112.html#section-5.2">Section 5.2</a>
                                    of <a href="#RFC9112"><cite title="HTTP/1.1">[HTTP/1.1]</cite></a>).</li>
                            </ul>
                        </div>
                        <div id="rfc.section.1.3.p.5">
                            <p>We can identify these types of transformations as transformations that should not prevent
                                signature verification, even when performed on message components covered by the
                                signature. Additionally, all changes to components not covered by the signature should
                                not prevent signature verification.</p>
                        </div>
                        <div id="rfc.section.1.3.p.6">
                            <p>Some examples of these kinds of transformations, and the effect they have on the message
                                signature, are found in <a href="#example-transform"
                                    title="HTTP Message Transformations">Appendix B.4</a>.</p>
                        </div>
                        <div id="rfc.section.1.3.p.7">
                            <p>Other transformations, such as parsing and reserializing the field values of a covered
                                component or changing the value of a derived component, can cause a signature to no
                                longer validate against a target message. Applications of this specification need to
                                take care to ensure that the transformations expected by the application are adequately
                                handled by the choice of covered components.</p>
                        </div>
                    </section>
                    <section id="application">
                        <h3 id="rfc.section.1.4"><a href="#rfc.section.1.4">1.4.</a>&nbsp;<a
                                href="#application">Application of HTTP Message Signatures</a></h3>
                        <div id="rfc.section.1.4.p.1" class="avoidbreakafter">
                            <p>HTTP message signatures are designed to be a general-purpose tool applicable in a wide
                                variety of circumstances and applications. In order to properly and safely apply HTTP
                                message signatures, an application or profile of this specification <em
                                    class="bcp14">MUST</em> specify, at a minimum, all of the following items:</p>
                        </div>
                        <div id="rfc.section.1.4.p.2">
                            <ul>
                                <li>The set of component identifiers (<a href="#covered-components"
                                        title="HTTP Message Components">Section 2</a>) and signature parameters (<a
                                        href="#signature-params" title="Signature Parameters">Section 2.3</a>) that are
                                    expected and required to be included in the covered components list. For example, an
                                    authorization protocol could mandate that the Authorization field be covered to
                                    protect the authorization credentials and mandate that the signature parameters
                                    contain a <span class="tt">created</span> parameter (<a href="#signature-params"
                                        title="Signature Parameters">Section 2.3</a>), while an API expecting
                                    semantically relevant HTTP message content could require the Content-Digest field
                                    defined in <a href="#RFC9530"><cite title="Digest Fields">[DIGEST]</cite></a> to be
                                    present and covered as well as mandate a value for the <span class="tt">tag</span>
                                    parameter (<a href="#signature-params" title="Signature Parameters">Section 2.3</a>)
                                    that is specific to the API being protected.</li>
                                <li>The expected Structured Field types <a href="#RFC8941"><cite
                                            title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a> of
                                    any required or expected covered component fields or parameters.</li>
                                <li>A means of retrieving the key material used to verify the signature. An application
                                    will usually use the <span class="tt">keyid</span> parameter of the signature
                                    parameters (<a href="#signature-params" title="Signature Parameters">Section
                                        2.3</a>) and define rules for resolving a key from there, though the appropriate
                                    key could be known from other means such as preregistration of a signer's key.</li>
                                <li>The set of allowable signature algorithms to be used by signers and accepted by
                                    verifiers.</li>
                                <li>A means of determining that the signature algorithm used to verify the signature is
                                    appropriate for the key material and context of the message. For example, the
                                    process could use the <span class="tt">alg</span> parameter of the signature
                                    parameters (<a href="#signature-params" title="Signature Parameters">Section
                                        2.3</a>) to state the algorithm explicitly, derive the algorithm from the key
                                    material, or use some preconfigured algorithm agreed upon by the signer and
                                    verifier.</li>
                                <li>A means of determining that a given key and algorithm used for a signature are
                                    appropriate for the context of the message. For example, a server expecting only
                                    ECDSA signatures should know to reject any RSA signatures, or a server expecting
                                    asymmetric cryptography should know to reject any symmetric cryptography.</li>
                                <li>A means of determining the context for derivation of message components from an HTTP
                                    message and its application context. While this is normally the target HTTP message
                                    itself, the context could include additional information known to the application
                                    through configuration, such as an external hostname.</li>
                                <li>If binding between a request and response is needed using the mechanism provided in
                                    <a href="#content-request-response"
                                        title="Signing Request Components in a Response Message">Section 2.4</a>, all
                                    elements of the request message and the response message that would be required to
                                    provide properties of such a binding.
                                </li>
                                <li>The error messages and codes that are returned from the verifier to the signer when
                                    the signature is invalid, the key material is inappropriate, the validity time
                                    window is out of specification, a component value cannot be calculated, or any other
                                    errors occur during the signature verification process. For example, if a signature
                                    is being used as an authentication mechanism, an HTTP status code of 401
                                    (Unauthorized) or 403 (Forbidden) could be appropriate. If the response is from an
                                    HTTP API, a response with an HTTP status code such as 400 (Bad Request) could
                                    include more details <a href="#RFC7807"><cite
                                            title="Problem Details for HTTP APIs">[RFC7807]</cite></a> <a
                                        href="#RFC9457"><cite
                                            title="Problem Details for HTTP APIs">[RFC9457]</cite></a>, such as an
                                    indicator that the wrong key material was used.</li>
                            </ul>
                        </div>
                        <div id="rfc.section.1.4.p.3">
                            <p>When choosing these parameters, an application of HTTP message signatures has to ensure
                                that the verifier will have access to all required information needed to recreate the
                                signature base. For example, a server behind a reverse proxy would need to know the
                                original request URI to make use of the derived component <span
                                    class="tt">@target-uri</span>, even though the apparent target URI would be changed
                                by the reverse proxy (see also <a href="#security-message-component-context"
                                    title="Message Component Source and Context">Section 7.4.3</a>). Additionally, an
                                application using signatures in responses would need to ensure that clients receiving
                                signed responses have access to all the signed portions of the message, including any
                                portions of the request that were signed by the server using the <span
                                    class="tt">req</span> ("request-response") parameter (<a
                                    href="#content-request-response"
                                    title="Signing Request Components in a Response Message">Section 2.4</a>).</p>
                        </div>
                        <div id="rfc.section.1.4.p.4">
                            <p>Details regarding this kind of profiling are within the purview of the application and
                                outside the scope of this specification; however, some additional considerations are
                                discussed in <a href="#security" title="Security Considerations">Section 7</a>. In
                                particular, when choosing the required set of component identifiers, care has to be
                                taken to make sure that the coverage is sufficient for the application, as discussed in
                                <span class="nobr">Sections </span><a href="#security-coverage"
                                    title="Insufficient Coverage">7.2.1</a> and <a href="#security-message-content"
                                    title="Message Content">7.2.8</a>. This specification defines only part of a full
                                security system for an application. When building a complete security system based on
                                this tool, it is important to perform a security analysis of the entire system, of which
                                HTTP message signatures is a part. Historical systems, such as AWS Signature Version 4
                                <a href="#AWS-SIGv4"><cite
                                        title="Authenticating Requests (AWS Signature Version 4)">[AWS-SIGv4]</cite></a>,
                                can provide inspiration and examples of how to apply similar mechanisms to an
                                application, though review of such historical systems does not negate the need for a
                                security analysis of an application of HTTP message signatures.
                            </p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="covered-components">
                    <h2 id="rfc.section.2" class="np"><a href="#rfc.section.2">2.</a>&nbsp;<a
                            href="#covered-components">HTTP Message Components</a></h2>
                    <div id="rfc.section.2.p.1">
                        <p>In order to allow signers and verifiers to establish which components are covered by a
                            signature, this document defines component identifiers for components covered by an HTTP
                            message signature, a set of rules for deriving and canonicalizing the values associated with
                            these component identifiers from the HTTP message, and the means for combining these
                            canonicalized values into a signature base.</p>
                    </div>
                    <div id="rfc.section.2.p.2">
                        <p>The signature context for deriving these values <em class="bcp14">MUST</em> be accessible to
                            both the signer and the verifier of the message. The context <em class="bcp14">MUST</em> be
                            the same across all components in a given signature. For example, it would be an error to
                            use the raw query string for the <span class="tt">@query</span> derived component but
                            combined query and form parameters for the <span class="tt">@query-param</span> derived
                            component. For more considerations regarding the message component context, see <a
                                href="#security-message-component-context"
                                title="Message Component Source and Context">Section 7.4.3</a>.</p>
                    </div>
                    <div id="rfc.section.2.p.3">
                        <p>A component identifier is composed of a component name and any parameters associated with
                            that name. Each component name is either an HTTP field name (<a href="#http-fields"
                                title="HTTP Fields">Section 2.1</a>) or a registered derived component name (<a
                                href="#derived-components" title="Derived Components">Section 2.2</a>). The possible
                            parameters for a component identifier are dependent on the component identifier. The "HTTP
                            Signature Component Parameters" registry, which catalogs all possible parameters, is defined
                            in <a href="#component-param-registry"
                                title="HTTP Signature Component Parameters Registry">Section 6.5</a>.</p>
                    </div>
                    <div id="rfc.section.2.p.4">
                        <p>Within a single list of covered components, each component identifier <em
                                class="bcp14">MUST</em> occur only once. One component identifier is distinct from
                            another if the component name differs or if any of the parameters differ for the same
                            component name. Multiple component identifiers having the same component name <em
                                class="bcp14">MAY</em> be included if they have parameters that make them distinct, such
                            as <span class="tt">"foo";bar</span> and <span class="tt">"foo";baz</span>. The order of
                            parameters <em class="bcp14">MUST</em> be preserved when processing a component identifier
                            (such as when parsing during verification), but the order of parameters is not significant
                            when comparing two component identifiers for equality checks. That is to say, <span
                                class="tt">"foo";bar;baz</span> cannot be in the same message as <span
                                class="tt">"foo";baz;bar</span>, since these two component identifiers are equivalent,
                            but a system processing one form is not allowed to transform it into the other form.</p>
                    </div>
                    <div id="rfc.section.2.p.5">
                        <p>The component value associated with a component identifier is defined by the identifier
                            itself. Component values <em class="bcp14">MUST NOT</em> contain newline (<span
                                class="tt">\n</span>) characters. Some HTTP message components can undergo
                            transformations that change the bitwise value without altering the meaning of the
                            component's value (for example, when combining field values). Message component values
                            therefore need to be canonicalized before they are signed, to ensure that a signature can be
                            verified despite such intermediary transformations. This document defines rules for each
                            component identifier that transform the identifier's associated component value into such a
                            canonical form.</p>
                    </div>
                    <div id="rfc.section.2.p.6">
                        <p>The following sections define component identifier names, their parameters, their associated
                            values, and the canonicalization rules for their values. The method for combining message
                            components into the signature base is defined in <a href="#create-sig-input"
                                title="Creating the Signature Base">Section 2.5</a>.</p>
                    </div>
                    <section id="http-fields">
                        <h3 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a>&nbsp;<a href="#http-fields">HTTP
                                Fields</a></h3>
                        <div id="rfc.section.2.1.p.1">
                            <p>The component name for an HTTP field is the lowercased form of its field name as defined
                                in <a href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.1">Section 5.1</a> of
                                <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>. While HTTP field
                                names are case insensitive, implementations <em class="bcp14">MUST</em> use lowercased
                                field names (e.g., <span class="tt">content-type</span>, <span class="tt">date</span>,
                                <span class="tt">etag</span>) when using them as component names.
                            </p>
                        </div>
                        <div id="rfc.section.2.1.p.2">
                            <p>The component value for an HTTP field is the field value for the named field as defined
                                in <a href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.5">Section 5.5</a> of
                                <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>. The field value <em
                                    class="bcp14">MUST</em> be taken from the named header field of the target message
                                unless this behavior is overridden by additional parameters and rules, such as the <span
                                    class="tt">req</span> and <span class="tt">tr</span> flags, below. For most fields,
                                the field value is an ASCII string as recommended by <a href="#RFC9110"><cite
                                        title="HTTP Semantics">[HTTP]</cite></a>, and the component value is exactly
                                that string. Other encodings could exist in some implementations, and all non-ASCII
                                field values <em class="bcp14">MUST</em> be encoded to ASCII before being added to the
                                signature base. The <span class="tt">bs</span> parameter, as described in <a
                                    href="#http-field-byte-sequence" title="Binary-Wrapped HTTP Fields">Section
                                    2.1.3</a>, provides a method for wrapping such problematic field values.
                            </p>
                        </div>
                        <div id="rfc.section.2.1.p.3">
                            <p>Unless overridden by additional parameters and rules, HTTP field values <em
                                    class="bcp14">MUST</em> be combined into a single value as defined in <a
                                    href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.2">Section 5.2</a> of <a
                                    href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a> to create the
                                component value. Specifically, HTTP fields sent as multiple fields <em
                                    class="bcp14">MUST</em> be combined by concatenating the values using a single comma
                                and a single space as a separator ("," + " "). Note that intermediaries are allowed to
                                combine values of HTTP fields with any amount of whitespace between the commas, and if
                                this behavior is not accounted for by the verifier, the signature can fail, since the
                                signer and verifier will see a different component value in their respective signature
                                bases. For robustness, it is <em class="bcp14">RECOMMENDED</em> that signed messages
                                include only a single instance of any field covered under the signature, particularly
                                with the value for any list-based fields serialized using the algorithm below. This
                                approach increases the chances of the field value remaining untouched through
                                intermediaries. Where that approach is not possible and multiple instances of a field
                                need to be sent separately, it is <em class="bcp14">RECOMMENDED</em> that signers and
                                verifiers process any list-based fields taking all individual field values and combining
                                them based on the strict algorithm below, to counter possible intermediary behavior.
                                When the field in question is a Structured Field of type List or Dictionary, this effect
                                can be accomplished more directly by requiring the strict Structured Field serialization
                                of the field value, as described in <a href="#http-field-structured"
                                    title="Strict Serialization of HTTP Structured Fields">Section 2.1.1</a>.</p>
                        </div>
                        <div id="rfc.section.2.1.p.4">
                            <p>Note that some HTTP fields, such as Set-Cookie <a href="#RFC6265"><cite
                                        title="HTTP State Management Mechanism">[COOKIE]</cite></a>, do not follow a
                                syntax that allows for the combination of field values in this manner (such that the
                                combined output is unambiguous from multiple inputs). Even though the component value is
                                never parsed by the message signature process and is used only as part of the signature
                                base (<a href="#create-sig-input" title="Creating the Signature Base">Section 2.5</a>),
                                caution needs to be taken when including such fields in signatures, since the combined
                                value could be ambiguous. The <span class="tt">bs</span> parameter, as described in <a
                                    href="#http-field-byte-sequence" title="Binary-Wrapped HTTP Fields">Section
                                    2.1.3</a>, provides a method for wrapping such problematic fields. See <a
                                    href="#security-non-list" title="Non-List Field Values">Section 7.5.6</a> for more
                                discussion regarding this issue.</p>
                        </div>
                        <div id="rfc.section.2.1.p.5" class="avoidbreakafter">
                            <p>If the correctly combined value is not directly available for a given field by an
                                implementation, the following algorithm will produce canonicalized results for
                                list-based fields:</p>
                        </div>
                        <div id="rfc.section.2.1.p.6">
                            <ol type="1">
                                <li>Create an ordered list of the field values of each instance of the field in the
                                    message, in the order they occur (or will occur) in the message.</li>
                                <li>Strip leading and trailing whitespace from each item in the list. Note that since
                                    HTTP field values are not allowed to contain leading and trailing whitespace, this
                                    would be a no-op in a compliant implementation.</li>
                                <li>Remove any obsolete line folding within the line, and replace it with a single space
                                    (" "), as discussed in <a
                                        href="https://www.rfc-editor.org/rfc/rfc9112.html#section-5.2">Section 5.2</a>
                                    of <a href="#RFC9112"><cite title="HTTP/1.1">[HTTP/1.1]</cite></a>. Note that this
                                    behavior is specific to HTTP/1.1 and does not apply to other versions of the HTTP
                                    specification, which do not allow internal line folding.</li>
                                <li>Concatenate the list of values with a single comma (",") and a single space (" ")
                                    between each item.</li>
                            </ol>
                        </div>
                        <div id="rfc.section.2.1.p.7">
                            <p>The resulting string is the component value for the field.</p>
                        </div>
                        <div id="rfc.section.2.1.p.8">
                            <p>Note that some HTTP fields have values with multiple valid serializations that have
                                equivalent semantics, such as allowing case-insensitive values that intermediaries could
                                change. Applications signing and processing such fields <em class="bcp14">MUST</em>
                                consider how to handle the values of such fields to ensure that the signer and verifier
                                can derive the same value, as discussed in <a href="#security-field-values"
                                    title="Semantically Equivalent Field Values">Section 7.5.2</a>.</p>
                        </div>
                        <div id="rfc.section.2.1.p.9" class="avoidbreakafter">
                            <p>The following are non-normative examples of component values for header fields, given the
                                following example HTTP message fragment:</p>
                        </div>
                        <div id="rfc.section.2.1.p.10">
                            <pre class="text">
Host: www.example.com
Date: Tue, 20 Apr 2021 02:07:56 GMT
X-OWS-Header:   Leading and trailing whitespace.
X-Obs-Fold-Header: Obsolete
    line folding.
Cache-Control: max-age=60
Cache-Control:    must-revalidate
Example-Dict:  a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre>
                        </div>
                        <div id="rfc.section.2.1.p.11" class="avoidbreakafter">
                            <p>The following example shows the component values for these example header fields,
                                presented using the signature base format defined in <a href="#create-sig-input"
                                    title="Creating the Signature Base">Section 2.5</a>:</p>
                        </div>
                        <div id="rfc.section.2.1.p.12">
                            <pre>
"host": www.example.com
"date": Tue, 20 Apr 2021 02:07:56 GMT
"x-ows-header": Leading and trailing whitespace.
"x-obs-fold-header": Obsolete line folding.
"cache-control": max-age=60, must-revalidate
"example-dict": a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre>
                        </div>
                        <div id="rfc.section.2.1.p.13" class="avoidbreakafter">
                            <p>Empty HTTP fields can also be signed when present in a message. The canonicalized value
                                is the empty string. This means that the following empty header field, with (SP)
                                indicating a single trailing space character before the empty field value:</p>
                        </div>
                        <div id="rfc.section.2.1.p.14">
                            <pre>
X-Empty-Header:(SP)
</pre>
                        </div>
                        <div id="rfc.section.2.1.p.15">
                            <p>is serialized by the signature base generation algorithm (<a href="#create-sig-input"
                                    title="Creating the Signature Base">Section 2.5</a>) with an empty string value
                                following the colon and space added after the component identifier.</p>
                        </div>
                        <div id="rfc.section.2.1.p.16">
                            <pre>
"x-empty-header":(SP)
</pre>
                        </div>
                        <div id="rfc.section.2.1.p.17" class="avoidbreakafter">
                            <p>Any HTTP field component identifiers <em class="bcp14">MAY</em> have the following
                                parameters in specific circumstances, each described in detail in their own sections:
                            </p>
                        </div>
                        <div id="rfc.section.2.1.p.18">
                            <dl>
                                <dt><span class="tt">sf</span></dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A Boolean flag indicating that the component value is serialized using strict
                                        encoding of the Structured Field value (<a href="#http-field-structured"
                                            title="Strict Serialization of HTTP Structured Fields">Section 2.1.1</a>).
                                    </div>
                                </dd>
                                <dt><span class="tt">key</span></dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A String parameter used to select a single member value from a Dictionary
                                        Structured Field (<a href="#http-field-dictionary"
                                            title="Dictionary Structured Field Members">Section 2.1.2</a>).</div>
                                </dd>
                                <dt><span class="tt">bs</span></dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A Boolean flag indicating that individual field values are encoded using Byte
                                        Sequence data structures before being combined into the component value (<a
                                            href="#http-field-byte-sequence" title="Binary-Wrapped HTTP Fields">Section
                                            2.1.3</a>).</div>
                                </dd>
                                <dt><span class="tt">req</span></dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A Boolean flag for signed responses indicating that the component value is
                                        derived from the request that triggered this response message and not from the
                                        response message directly. Note that this parameter can also be applied to any
                                        derived component identifiers that target the request (<a
                                            href="#content-request-response"
                                            title="Signing Request Components in a Response Message">Section 2.4</a>).
                                    </div>
                                </dd>
                                <dt><span class="tt">tr</span></dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A Boolean flag indicating that the field value is taken from the trailers of
                                        the message as defined in <a
                                            href="https://www.rfc-editor.org/rfc/rfc9110.html#section-6.5">Section
                                            6.5</a> of <a href="#RFC9110"><cite
                                                title="HTTP Semantics">[HTTP]</cite></a>. If this flag is absent, the
                                        field value is taken from the header fields of the message as defined in <a
                                            href="https://www.rfc-editor.org/rfc/rfc9110.html#section-6.3">Section
                                            6.3</a> of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>
                                        (<a href="#http-trailer" title="Trailer Fields">Section 2.1.4</a>).</div>
                                </dd>
                            </dl>
                        </div>
                        <div id="rfc.section.2.1.p.19">
                            <p>Multiple parameters <em class="bcp14">MAY</em> be specified together, though some
                                combinations are redundant or incompatible. For example, the <span class="tt">sf</span>
                                parameter's functionality is already covered when the <span class="tt">key</span>
                                parameter is used on a Dictionary item, since <span class="tt">key</span> requires
                                strict serialization of the value. The <span class="tt">bs</span> parameter, which
                                requires the raw bytes of the field values from the message, is not compatible with the
                                use of the <span class="tt">sf</span> or <span class="tt">key</span> parameters, which
                                require the parsed data structures of the field values after combination.</p>
                        </div>
                        <div id="rfc.section.2.1.p.20">
                            <p>Additional parameters can be defined in the "HTTP Signature Component Parameters"
                                registry established in <a href="#component-param-registry"
                                    title="HTTP Signature Component Parameters Registry">Section 6.5</a>.</p>
                        </div>
                        <section id="http-field-structured">
                            <h4 id="rfc.section.2.1.1"><a href="#rfc.section.2.1.1">2.1.1.</a>&nbsp;<a
                                    href="#http-field-structured">Strict Serialization of HTTP Structured Fields</a>
                            </h4>
                            <div id="rfc.section.2.1.1.p.1">
                                <p>If the value of an HTTP field is known by the application to be a Structured Field
                                    type (as defined in <a href="#RFC8941"><cite
                                            title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a> or
                                    its extensions or updates) and the expected type of the Structured Field is known,
                                    the signer <em class="bcp14">MAY</em> include the <span class="tt">sf</span>
                                    parameter in the component identifier. If this parameter is included with a
                                    component identifier, the HTTP field value <em class="bcp14">MUST</em> be serialized
                                    using the formal serialization rules specified in <a
                                        href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4">Section 4</a> of <a
                                        href="#RFC8941"><cite
                                            title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a> (or
                                    the applicable formal serialization section of its extensions or updates) applicable
                                    to the type of the HTTP field. Note that this process will replace any optional
                                    internal whitespace with a single space character, among other potential
                                    transformations of the value.</p>
                            </div>
                            <div id="rfc.section.2.1.1.p.2">
                                <p>If multiple field values occur within a message, these values <em
                                        class="bcp14">MUST</em> be combined into a single List or Dictionary structure
                                    before serialization.</p>
                            </div>
                            <div id="rfc.section.2.1.1.p.3">
                                <p>If the application does not know the type of the field or does not know how to
                                    serialize the type of the field, the use of this flag will produce an error. As a
                                    consequence, the signer can only reliably sign fields using this flag when the
                                    verifier's system knows the type as well.</p>
                            </div>
                            <div id="rfc.section.2.1.1.p.4" class="avoidbreakafter">
                                <p>For example, the following Dictionary field is a valid serialization:</p>
                            </div>
                            <div id="rfc.section.2.1.1.p.5">
                                <pre class="text">
Example-Dict:  a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre>
                            </div>
                            <div id="rfc.section.2.1.1.p.6" class="avoidbreakafter">
                                <p>If included in the signature base without parameters, its value would be:</p>
                            </div>
                            <div id="rfc.section.2.1.1.p.7">
                                <pre>
"example-dict": a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre>
                            </div>
                            <div id="rfc.section.2.1.1.p.8" class="avoidbreakafter">
                                <p>However, if the <span class="tt">sf</span> parameter is added, the value is
                                    reserialized as follows:</p>
                            </div>
                            <div id="rfc.section.2.1.1.p.9">
                                <pre>
"example-dict";sf: a=1, b=2;x=1;y=2, c=(a b c)
</pre>
                            </div>
                            <div id="rfc.section.2.1.1.p.10">
                                <p>The resulting string is used as the component value; see <a href="#http-fields"
                                        title="HTTP Fields">Section 2.1</a>.</p>
                            </div>
                        </section>
                        <section id="http-field-dictionary">
                            <h4 id="rfc.section.2.1.2"><a href="#rfc.section.2.1.2">2.1.2.</a>&nbsp;<a
                                    href="#http-field-dictionary">Dictionary Structured Field Members</a></h4>
                            <div id="rfc.section.2.1.2.p.1">
                                <p>If a given field is known by the application to be a Dictionary Structured Field, an
                                    individual member in the value of that Dictionary is identified by using the
                                    parameter <span class="tt">key</span> and the Dictionary member key as a String
                                    value.</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.2">
                                <p>If multiple field values occur within a message, these values <em
                                        class="bcp14">MUST</em> be combined into a single Dictionary structure before
                                    serialization.</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.3">
                                <p>An individual member value of a Dictionary Structured Field is canonicalized by
                                    applying the serialization algorithm described in <a
                                        href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4.1.2">Section
                                        4.1.2</a> of <a href="#RFC8941"><cite
                                            title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a> on
                                    the <span class="tt">member_value</span> and its parameters, not including the
                                    Dictionary key itself. Specifically, the value is serialized as an Item or Inner
                                    List (the two possible values of a Dictionary member), with all parameters and
                                    possible subfields serialized using the strict serialization rules defined in <a
                                        href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4">Section 4</a> of <a
                                        href="#RFC8941"><cite
                                            title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a> (or
                                    the applicable section of its extensions or updates).</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.4">
                                <p>Each parameterized key for a given field <em class="bcp14">MUST NOT</em> appear more
                                    than once in the signature base. Parameterized keys <em class="bcp14">MAY</em>
                                    appear in any order in the signature base, regardless of the order they occur in the
                                    source Dictionary.</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.5">
                                <p>If a Dictionary key is named as a covered component but it does not occur in the
                                    Dictionary, this <em class="bcp14">MUST</em> cause an error in the signature base
                                    generation.</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.6" class="avoidbreakafter">
                                <p>The following are non-normative examples of canonicalized values for Dictionary
                                    Structured Field members, given the following example header field, whose value is
                                    known by the application to be a Dictionary:</p>
                            </div>
                            <div id="rfc.section.2.1.2.p.7">
                                <pre class="text">
Example-Dict:  a=1, b=2;x=1;y=2, c=(a   b    c), d
</pre>
                            </div>
                            <div id="rfc.section.2.1.2.p.8" class="avoidbreakafter">
                                <p>The following example shows canonicalized values for different component identifiers
                                    of this field, presented using the signature base format discussed in <a
                                        href="#create-sig-input" title="Creating the Signature Base">Section 2.5</a>:
                                </p>
                            </div>
                            <div id="rfc.section.2.1.2.p.9">
                                <pre>
"example-dict";key="a": 1
"example-dict";key="d": ?1
"example-dict";key="b": 2;x=1;y=2
"example-dict";key="c": (a b c)
</pre>
                            </div>
                            <div id="rfc.section.2.1.2.p.10">
                                <p>Note that the value for <span class="tt">key="c"</span> has been reserialized
                                    according to the strict <span class="tt">member_value</span> algorithm, and the
                                    value for <span class="tt">key="d"</span> has been serialized as a Boolean value.
                                </p>
                            </div>
                        </section>
                        <section id="http-field-byte-sequence">
                            <h4 id="rfc.section.2.1.3"><a href="#rfc.section.2.1.3">2.1.3.</a>&nbsp;<a
                                    href="#http-field-byte-sequence">Binary-Wrapped HTTP Fields</a></h4>
                            <div id="rfc.section.2.1.3.p.1">
                                <p>If the value of the HTTP field in question is known by the application to cause
                                    problems with serialization, particularly with the combination of multiple values
                                    into a single line as discussed in <a href="#security-non-list"
                                        title="Non-List Field Values">Section 7.5.6</a>, the signer <em
                                        class="bcp14">SHOULD</em> include the <span class="tt">bs</span> parameter in a
                                    component identifier to indicate that the values of the field need to be wrapped as
                                    binary structures before being combined.</p>
                            </div>
                            <div id="rfc.section.2.1.3.p.2" class="avoidbreakafter">
                                <p>If this parameter is included with a component identifier, the component value <em
                                        class="bcp14">MUST</em> be calculated using the following algorithm:</p>
                            </div>
                            <div id="rfc.section.2.1.3.p.3">
                                <ol type="1">
                                    <li>Let the input be the ordered set of values for a field, in the order they appear
                                        in the message.</li>
                                    <li>Create an empty List for accumulating processed field values.</li>
                                    <li>
                                        <div class="avoidbreakafter">
                                            <p>For each field value in the set:</p>
                                        </div>
                                        <div>
                                            <dl>
                                                <dt>11.</dt>
                                                <dd>Strip leading and trailing whitespace from the field value. Note
                                                    that since HTTP field values are not allowed to contain leading and
                                                    trailing whitespace, this would be a no-op in a compliant
                                                    implementation.</dd>
                                                <dt>12.</dt>
                                                <dd>Remove any obsolete line folding within the line, and replace it
                                                    with a single space (" "), as discussed in <a
                                                        href="https://www.rfc-editor.org/rfc/rfc9112.html#section-5.2">Section
                                                        5.2</a> of <a href="#RFC9112"><cite
                                                            title="HTTP/1.1">[HTTP/1.1]</cite></a>. Note that this
                                                    behavior is specific to <a href="#RFC9112"><cite
                                                            title="HTTP/1.1">[HTTP/1.1]</cite></a> and does not apply to
                                                    other versions of the HTTP specification.</dd>
                                                <dt>13.</dt>
                                                <dd>Encode the bytes of the resulting field value as a Byte Sequence.
                                                    Note that most fields are restricted to ASCII characters, but other
                                                    octets could be included in the value in some implementations.</dd>
                                                <dt>14.</dt>
                                                <dd>Add the Byte Sequence to the List accumulator.</dd>
                                            </dl>
                                        </div>
                                    </li>
                                    <li>The intermediate result is a List of Byte Sequence values.</li>
                                    <li>Follow the strict serialization of a List as described in <a
                                            href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4.1.1">Section
                                            4.1.1</a> of <a href="#RFC8941"><cite
                                                title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>,
                                        and return this output.</li>
                                </ol>
                            </div>
                            <div id="rfc.section.2.1.3.p.4" class="avoidbreakafter">
                                <p>For example, the following field with internal commas prevents the distinct field
                                    values from being safely combined:</p>
                            </div>
                            <div id="rfc.section.2.1.3.p.5">
                                <pre class="text">
Example-Header: value, with, lots
Example-Header: of, commas
</pre>
                            </div>
                            <div id="rfc.section.2.1.3.p.6" class="avoidbreakafter">
                                <p>In our example, the same field can be sent with a semantically different single
                                    value:</p>
                            </div>
                            <div id="rfc.section.2.1.3.p.7">
                                <pre class="text">
Example-Header: value, with, lots, of, commas
</pre>
                            </div>
                            <div id="rfc.section.2.1.3.p.8" class="avoidbreakafter">
                                <p>Both of these versions are treated differently by the application. However, if
                                    included in the signature base without parameters, the component value would be the
                                    same in both cases:</p>
                            </div>
                            <div id="rfc.section.2.1.3.p.9">
                                <pre>
"example-header": value, with, lots, of, commas
</pre>
                            </div>
                            <div id="rfc.section.2.1.3.p.10" class="avoidbreakafter">
                                <p>However, if the <span class="tt">bs</span> parameter is added, the two separate
                                    instances are encoded and serialized as follows:</p>
                            </div>
                            <div id="rfc.section.2.1.3.p.11">
                                <pre>
"example-header";bs: :dmFsdWUsIHdpdGgsIGxvdHM=:, :b2YsIGNvbW1hcw==:
</pre>
                            </div>
                            <div id="rfc.section.2.1.3.p.12" class="avoidbreakafter">
                                <p>For the single-instance field above, the encoding with the <span class="tt">bs</span>
                                    parameter is:</p>
                            </div>
                            <div id="rfc.section.2.1.3.p.13">
                                <pre>
"example-header";bs: :dmFsdWUsIHdpdGgsIGxvdHMsIG9mLCBjb21tYXM=:
</pre>
                            </div>
                            <div id="rfc.section.2.1.3.p.14">
                                <p>This component value is distinct from the multiple-instance field above, preventing a
                                    collision that could potentially be exploited.</p>
                            </div>
                        </section>
                        <section id="http-trailer">
                            <h4 id="rfc.section.2.1.4"><a href="#rfc.section.2.1.4">2.1.4.</a>&nbsp;<a
                                    href="#http-trailer">Trailer Fields</a></h4>
                            <div id="rfc.section.2.1.4.p.1">
                                <p>If the signer wants to include a trailer field in the signature, the signer <em
                                        class="bcp14">MUST</em> include the <span class="tt">tr</span> Boolean parameter
                                    to indicate that the value <em class="bcp14">MUST</em> be taken from the trailer
                                    fields and not from the header fields.</p>
                            </div>
                            <div id="rfc.section.2.1.4.p.2" class="avoidbreakafter">
                                <p>For example, given the following message:</p>
                            </div>
                            <div id="rfc.section.2.1.4.p.3">
                                <pre class="text">
HTTP/1.1 200 OK
Content-Type: text/plain
Transfer-Encoding: chunked
Trailer: Expires

4
HTTP
7
Message
a
Signatures
0
Expires: Wed, 9 Nov 2022 07:28:00 GMT
</pre>
                            </div>
                            <div id="rfc.section.2.1.4.p.4" class="avoidbreakafter">
                                <p>The signer decides to add both the Trailer header field and the Expires trailer field
                                    to the signature base, along with the status code derived component:</p>
                            </div>
                            <div id="rfc.section.2.1.4.p.5">
                                <pre>
"@status": 200
"trailer": Expires
"expires";tr: Wed, 9 Nov 2022 07:28:00 GMT
</pre>
                            </div>
                            <div id="rfc.section.2.1.4.p.6">
                                <p>If a field is available as both a header and a trailer in a message, both values <em
                                        class="bcp14">MAY</em> be signed, but the values <em class="bcp14">MUST</em> be
                                    signed separately. The values of header fields and trailer fields of the same name
                                    <em class="bcp14">MUST NOT</em> be combined for purposes of the signature.
                                </p>
                            </div>
                            <div id="rfc.section.2.1.4.p.7">
                                <p>Since trailer fields could be merged into the header fields or dropped entirely by
                                    intermediaries as per <a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-6.5.1">Section
                                        6.5.1</a> of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>,
                                    it is <em class="bcp14">NOT RECOMMENDED</em> to include trailers in the signature
                                    unless the signer knows that the verifier will have access to the values of the
                                    trailers as sent.</p>
                            </div>
                        </section>
                    </section>
                    <section id="derived-components">
                        <h3 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2.</a>&nbsp;<a
                                href="#derived-components">Derived Components</a></h3>
                        <div id="rfc.section.2.2.p.1">
                            <p>In addition to HTTP fields, there are a number of different components that can be
                                derived from the control data, signature context, or other aspects of the HTTP message
                                being signed. Such derived components can be included in the signature base by defining
                                a component name, possible parameters, message targets, and the derivation method for
                                its component value.</p>
                        </div>
                        <div id="rfc.section.2.2.p.2">
                            <p>Derived component names <em class="bcp14">MUST</em> start with the "at" (<span
                                    class="tt">@</span>) character. This differentiates derived component names from
                                HTTP field names, which cannot contain the <span class="tt">@</span> character as per <a
                                    href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.1">Section 5.1</a> of <a
                                    href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>. Processors of HTTP
                                message signatures <em class="bcp14">MUST</em> treat derived component names separately
                                from field names, as discussed in <a href="#security-lazy-header-parser"
                                    title="Processing Invalid HTTP Field Names as Derived Component Names">Section
                                    7.5.1</a>.</p>
                        </div>
                        <div id="rfc.section.2.2.p.3" class="avoidbreakafter">
                            <p>This specification defines the following derived components:</p>
                        </div>
                        <div id="rfc.section.2.2.p.4">
                            <dl>
                                <dt>@method</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The method used for a request (<a href="#content-request-method"
                                            title="Method">Section 2.2.1</a>).</div>
                                </dd>
                                <dt>@target-uri</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The full target URI for a request (<a href="#content-target-uri"
                                            title="Target URI">Section 2.2.2</a>).</div>
                                </dd>
                                <dt>@authority</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The authority of the target URI for a request (<a
                                            href="#content-request-authority" title="Authority">Section 2.2.3</a>).
                                    </div>
                                </dd>
                                <dt>@scheme</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The scheme of the target URI for a request (<a href="#content-request-scheme"
                                            title="Scheme">Section 2.2.4</a>).</div>
                                </dd>
                                <dt>@request-target</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The request target (<a href="#content-request-target"
                                            title="Request Target">Section 2.2.5</a>).</div>
                                </dd>
                                <dt>@path</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The absolute path portion of the target URI for a request (<a
                                            href="#content-request-path" title="Path">Section 2.2.6</a>).</div>
                                </dd>
                                <dt>@query</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The query portion of the target URI for a request (<a
                                            href="#content-request-query" title="Query">Section 2.2.7</a>).</div>
                                </dd>
                                <dt>@query-param</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A parsed and encoded query parameter of the target URI for a request (<a
                                            href="#content-request-query-param" title="Query Parameters">Section
                                            2.2.8</a>).</div>
                                </dd>
                                <dt>@status</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>The status code for a response (<a href="#content-status-code"
                                            title="Status Code">Section 2.2.9</a>).</div>
                                </dd>
                            </dl>
                        </div>
                        <div id="rfc.section.2.2.p.5">
                            <p>Additional derived component names are defined in the "HTTP Signature Derived Component
                                Names" registry (<a href="#content-registry"
                                    title="HTTP Signature Derived Component Names Registry">Section 6.4</a>).</p>
                        </div>
                        <div id="rfc.section.2.2.p.6">
                            <p>Derived component values are taken from the context of the target message for the
                                signature. This context includes information about the message itself, such as its
                                control data, as well as any additional state and context held by the signer or
                                verifier. In particular, when signing a response, the signer can include any derived
                                components from the originating request by using the <span class="tt">req</span>
                                parameter (<a href="#content-request-response"
                                    title="Signing Request Components in a Response Message">Section 2.4</a>).</p>
                        </div>
                        <div id="rfc.section.2.2.p.7">
                            <dl>
                                <dt>request:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>Values derived from, and results applied to, an HTTP request message as
                                        described in <a
                                            href="https://www.rfc-editor.org/rfc/rfc9110.html#section-3.4">Section
                                            3.4</a> of <a href="#RFC9110"><cite
                                                title="HTTP Semantics">[HTTP]</cite></a>. If the target message of the
                                        signature is a response, derived components that target request messages can be
                                        included by using the <span class="tt">req</span> parameter as defined in <a
                                            href="#content-request-response"
                                            title="Signing Request Components in a Response Message">Section 2.4</a>.
                                    </div>
                                </dd>
                                <dt>response:</dt>
                                <dd style="margin-left: 1.5em">
                                    <div>Values derived from, and results applied to, an HTTP response message as
                                        described in <a
                                            href="https://www.rfc-editor.org/rfc/rfc9110.html#section-3.4">Section
                                            3.4</a> of <a href="#RFC9110"><cite
                                                title="HTTP Semantics">[HTTP]</cite></a>.</div>
                                </dd>
                                <dt>request, response:</dt>
                                <dd style="margin-left: 1.5em">Values derived from, and results applied to, either a
                                    request message or a response message.</dd>
                            </dl>
                        </div>
                        <div id="rfc.section.2.2.p.8">
                            <p>A derived component definition <em class="bcp14">MUST</em> define all target message
                                types to which it can be applied.</p>
                        </div>
                        <div id="rfc.section.2.2.p.9">
                            <p>Derived component values <em class="bcp14">MUST</em> be limited to printable characters
                                and spaces and <em class="bcp14">MUST NOT</em> contain any newline characters. Derived
                                component values <em class="bcp14">MUST NOT</em> start or end with whitespace
                                characters.</p>
                        </div>
                        <section id="content-request-method">
                            <h4 id="rfc.section.2.2.1"><a href="#rfc.section.2.2.1">2.2.1.</a>&nbsp;<a
                                    href="#content-request-method">Method</a></h4>
                            <div id="rfc.section.2.2.1.p.1">
                                <p>The <span class="tt">@method</span> derived component refers to the HTTP method of a
                                    request message. The component value is canonicalized by taking the value of the
                                    method as a string. Note that the method name is case sensitive as per <a
                                        href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>, <a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-9.1">Section 9.1</a>.
                                    While conventionally standardized method names are uppercase <a
                                        href="#RFC0020"><cite
                                            title="ASCII format for network interchange">[ASCII]</cite></a>, no
                                    transformation to the input method value's case is performed.</p>
                            </div>
                            <div id="rfc.section.2.2.1.p.2" class="avoidbreakafter">
                                <p>For example, the following request message:</p>
                            </div>
                            <div id="rfc.section.2.2.1.p.3">
                                <pre class="text">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.1.p.4" class="avoidbreakafter">
                                <p>would result in the following <span class="tt">@method</span> component value:</p>
                            </div>
                            <div id="rfc.section.2.2.1.p.5">
                                <pre>
POST
</pre>
                            </div>
                            <div id="rfc.section.2.2.1.p.6" class="avoidbreakafter">
                                <p>and the following signature base line:</p>
                            </div>
                            <div id="rfc.section.2.2.1.p.7">
                                <pre>
"@method": POST
</pre>
                            </div>
                        </section>
                        <section id="content-target-uri">
                            <h4 id="rfc.section.2.2.2"><a href="#rfc.section.2.2.2">2.2.2.</a>&nbsp;<a
                                    href="#content-target-uri">Target URI</a></h4>
                            <div id="rfc.section.2.2.2.p.1">
                                <p>The <span class="tt">@target-uri</span> derived component refers to the target URI of
                                    a request message. The component value is the target URI of the request (<a
                                        href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>, <a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.1">Section 7.1</a>),
                                    assembled from all available URI components, including the authority.</p>
                            </div>
                            <div id="rfc.section.2.2.2.p.2" class="avoidbreakafter">
                                <p>For example, the following message sent over HTTPS:</p>
                            </div>
                            <div id="rfc.section.2.2.2.p.3">
                                <pre class="text">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.2.p.4" class="avoidbreakafter">
                                <p>would result in the following <span class="tt">@target-uri</span> component value:
                                </p>
                            </div>
                            <div id="rfc.section.2.2.2.p.5">
                                <pre>
https://www.example.com/path?param=value
</pre>
                            </div>
                            <div id="rfc.section.2.2.2.p.6" class="avoidbreakafter">
                                <p>and the following signature base line:</p>
                            </div>
                            <div id="rfc.section.2.2.2.p.7">
                                <pre>
"@target-uri": https://www.example.com/path?param=value
</pre>
                            </div>
                        </section>
                        <section id="content-request-authority">
                            <h4 id="rfc.section.2.2.3"><a href="#rfc.section.2.2.3">2.2.3.</a>&nbsp;<a
                                    href="#content-request-authority">Authority</a></h4>
                            <div id="rfc.section.2.2.3.p.1">
                                <p>The <span class="tt">@authority</span> derived component refers to the authority
                                    component of the target URI of the HTTP request message, as defined in <a
                                        href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>, <a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.2">Section 7.2</a>.
                                    In HTTP/1.1, this is usually conveyed using the Host header field, while in HTTP/2
                                    and HTTP/3 it is conveyed using the :authority pseudo-header. The value is the fully
                                    qualified authority component of the request, comprised of the host and, optionally,
                                    port of the request target, as a string. The component value <em
                                        class="bcp14">MUST</em> be normalized according to the rules provided in <a
                                        href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>, <a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-4.2.3">Section
                                        4.2.3</a>. Namely, the hostname is normalized to lowercase, and the default port
                                    is omitted.</p>
                            </div>
                            <div id="rfc.section.2.2.3.p.2" class="avoidbreakafter">
                                <p>For example, the following request message:</p>
                            </div>
                            <div id="rfc.section.2.2.3.p.3">
                                <pre class="text">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.3.p.4" class="avoidbreakafter">
                                <p>would result in the following <span class="tt">@authority</span> component value:</p>
                            </div>
                            <div id="rfc.section.2.2.3.p.5">
                                <pre>
www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.3.p.6" class="avoidbreakafter">
                                <p>and the following signature base line:</p>
                            </div>
                            <div id="rfc.section.2.2.3.p.7">
                                <pre>
"@authority": www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.3.p.8">
                                <p>The <span class="tt">@authority</span> derived component <em
                                        class="bcp14">SHOULD</em> be used instead of signing the Host header field
                                    directly. See <a href="#security-not-fields"
                                        title="Choosing Signature Parameters and Derived Components over HTTP Fields">Section
                                        7.2.4</a>.</p>
                            </div>
                        </section>
                        <section id="content-request-scheme">
                            <h4 id="rfc.section.2.2.4"><a href="#rfc.section.2.2.4">2.2.4.</a>&nbsp;<a
                                    href="#content-request-scheme">Scheme</a></h4>
                            <div id="rfc.section.2.2.4.p.1">
                                <p>The <span class="tt">@scheme</span> derived component refers to the scheme of the
                                    target URL of the HTTP request message. The component value is the scheme as a
                                    lowercase string as defined in <a href="#RFC9110"><cite
                                            title="HTTP Semantics">[HTTP]</cite></a>, <a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-4.2">Section 4.2</a>.
                                    While the scheme itself is case insensitive, it <em class="bcp14">MUST</em> be
                                    normalized to lowercase for inclusion in the signature base.</p>
                            </div>
                            <div id="rfc.section.2.2.4.p.2" class="avoidbreakafter">
                                <p>For example, the following request message sent over plain HTTP:</p>
                            </div>
                            <div id="rfc.section.2.2.4.p.3">
                                <pre class="text">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.4.p.4" class="avoidbreakafter">
                                <p>would result in the following <span class="tt">@scheme</span> component value:</p>
                            </div>
                            <div id="rfc.section.2.2.4.p.5">
                                <pre>
http
</pre>
                            </div>
                            <div id="rfc.section.2.2.4.p.6" class="avoidbreakafter">
                                <p>and the following signature base line:</p>
                            </div>
                            <div id="rfc.section.2.2.4.p.7">
                                <pre>
"@scheme": http
</pre>
                            </div>
                        </section>
                        <section id="content-request-target">
                            <h4 id="rfc.section.2.2.5"><a href="#rfc.section.2.2.5">2.2.5.</a>&nbsp;<a
                                    href="#content-request-target">Request Target</a></h4>
                            <div id="rfc.section.2.2.5.p.1">
                                <p>The <span class="tt">@request-target</span> derived component refers to the full
                                    request target of the HTTP request message, as defined in <a href="#RFC9110"><cite
                                            title="HTTP Semantics">[HTTP]</cite></a>, <a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.1">Section 7.1</a>.
                                    The component value of the request target can take different forms, depending on the
                                    type of request, as described below.</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.2">
                                <p>For HTTP/1.1, the component value is equivalent to the request target portion of the
                                    request line. However, this value is more difficult to reliably construct in other
                                    versions of HTTP. Therefore, it is <em class="bcp14">NOT RECOMMENDED</em> that this
                                    component be used when versions of HTTP other than 1.1 might be in use.</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.3">
                                <p>The origin form value is a combination of the absolute path and query components of
                                    the request URL.</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.4" class="avoidbreakafter">
                                <p>For example, the following request message:</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.5">
                                <pre class="text">
POST /path?param=value HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.6" class="avoidbreakafter">
                                <p>would result in the following <span class="tt">@request-target</span> component
                                    value:</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.7">
                                <pre>
/path?param=value
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.8" class="avoidbreakafter">
                                <p>and the following signature base line:</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.9">
                                <pre>
"@request-target": /path?param=value
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.10" class="avoidbreakafter">
                                <p>The following request to an HTTP proxy with the absolute-form value, containing the
                                    fully qualified target URI:</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.11">
                                <pre class="text">
GET https://www.example.com/path?param=value HTTP/1.1
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.12" class="avoidbreakafter">
                                <p>would result in the following <span class="tt">@request-target</span> component
                                    value:</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.13">
                                <pre>
https://www.example.com/path?param=value
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.14" class="avoidbreakafter">
                                <p>and the following signature base line:</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.15">
                                <pre>
"@request-target": https://www.example.com/path?param=value
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.16" class="avoidbreakafter">
                                <p>The following CONNECT request with an authority-form value, containing the host and
                                    port of the target:</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.17">
                                <pre class="text">
CONNECT www.example.com:80 HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.18" class="avoidbreakafter">
                                <p>would result in the following <span class="tt">@request-target</span> component
                                    value:</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.19">
                                <pre>
www.example.com:80
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.20" class="avoidbreakafter">
                                <p>and the following signature base line:</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.21">
                                <pre>
"@request-target": www.example.com:80
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.22" class="avoidbreakafter">
                                <p>The following OPTIONS request message with the asterisk-form value, containing a
                                    single asterisk (<span class="tt">*</span>) character:</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.23">
                                <pre class="text">
OPTIONS * HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.24" class="avoidbreakafter">
                                <p>would result in the following <span class="tt">@request-target</span> component
                                    value:</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.25">
                                <pre>
*
</pre>
                            </div>
                            <div id="rfc.section.2.2.5.p.26" class="avoidbreakafter">
                                <p>and the following signature base line:</p>
                            </div>
                            <div id="rfc.section.2.2.5.p.27">
                                <pre>
"@request-target": *
</pre>
                            </div>
                        </section>
                        <section id="content-request-path">
                            <h4 id="rfc.section.2.2.6"><a href="#rfc.section.2.2.6">2.2.6.</a>&nbsp;<a
                                    href="#content-request-path">Path</a></h4>
                            <div id="rfc.section.2.2.6.p.1">
                                <p>The <span class="tt">@path</span> derived component refers to the target path of the
                                    HTTP request message. The component value is the absolute path of the request target
                                    defined by <a href="#RFC3986"><cite
                                            title="Uniform Resource Identifier (URI): Generic Syntax">[URI]</cite></a>,
                                    with no query component and no trailing question mark (<span class="tt">?</span>)
                                    character. The value is normalized according to the rules provided in <a
                                        href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>, <a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-4.2.3">Section
                                        4.2.3</a>. Namely, an empty path string is normalized as a single slash (<span
                                        class="tt">/</span>) character. Path components are represented by their values
                                    before decoding any percent-encoded octets, as described in the simple string
                                    comparison rules provided in <a
                                        href="https://www.rfc-editor.org/rfc/rfc3986.html#section-6.2.1">Section
                                        6.2.1</a> of <a href="#RFC3986"><cite
                                            title="Uniform Resource Identifier (URI): Generic Syntax">[URI]</cite></a>.
                                </p>
                            </div>
                            <div id="rfc.section.2.2.6.p.2" class="avoidbreakafter">
                                <p>For example, the following request message:</p>
                            </div>
                            <div id="rfc.section.2.2.6.p.3">
                                <pre class="text">
GET /path?param=value HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.6.p.4" class="avoidbreakafter">
                                <p>would result in the following <span class="tt">@path</span> component value:</p>
                            </div>
                            <div id="rfc.section.2.2.6.p.5">
                                <pre>
/path
</pre>
                            </div>
                            <div id="rfc.section.2.2.6.p.6" class="avoidbreakafter">
                                <p>and the following signature base line:</p>
                            </div>
                            <div id="rfc.section.2.2.6.p.7">
                                <pre>
"@path": /path
</pre>
                            </div>
                        </section>
                        <section id="content-request-query">
                            <h4 id="rfc.section.2.2.7"><a href="#rfc.section.2.2.7">2.2.7.</a>&nbsp;<a
                                    href="#content-request-query">Query</a></h4>
                            <div id="rfc.section.2.2.7.p.1">
                                <p>The <span class="tt">@query</span> derived component refers to the query component of
                                    the HTTP request message. The component value is the entire normalized query string
                                    defined by <a href="#RFC3986"><cite
                                            title="Uniform Resource Identifier (URI): Generic Syntax">[URI]</cite></a>,
                                    including the leading <span class="tt">?</span> character. The value is read using
                                    the simple string comparison rules provided in <a
                                        href="https://www.rfc-editor.org/rfc/rfc3986.html#section-6.2.1">Section
                                        6.2.1</a> of <a href="#RFC3986"><cite
                                            title="Uniform Resource Identifier (URI): Generic Syntax">[URI]</cite></a>.
                                    Namely, percent-encoded octets are not decoded.</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.2" class="avoidbreakafter">
                                <p>For example, the following request message:</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.3">
                                <pre class="text">
GET /path?param=value&amp;foo=bar&amp;baz=bat%2Dman HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.7.p.4" class="avoidbreakafter">
                                <p>would result in the following <span class="tt">@query</span> component value:</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.5">
                                <pre>
?param=value&amp;foo=bar&amp;baz=bat%2Dman
</pre>
                            </div>
                            <div id="rfc.section.2.2.7.p.6" class="avoidbreakafter">
                                <p>and the following signature base line:</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.7">
                                <pre>
"@query": ?param=value&amp;foo=bar&amp;baz=bat%2Dman
</pre>
                            </div>
                            <div id="rfc.section.2.2.7.p.8" class="avoidbreakafter">
                                <p>The following request message:</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.9">
                                <pre class="text">
POST /path?queryString HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.7.p.10" class="avoidbreakafter">
                                <p>would result in the following <span class="tt">@query</span> component value:</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.11">
                                <pre>
?queryString
</pre>
                            </div>
                            <div id="rfc.section.2.2.7.p.12" class="avoidbreakafter">
                                <p>and the following signature base line:</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.13">
                                <pre>
"@query": ?queryString
</pre>
                            </div>
                            <div id="rfc.section.2.2.7.p.14" class="avoidbreakafter">
                                <p>Just like including an empty path component, the signer can include an empty query
                                    component to indicate that this component is not used in the message. If the query
                                    string is absent from the request message, the component value is the leading <span
                                        class="tt">?</span> character alone:</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.15">
                                <pre>
?
</pre>
                            </div>
                            <div id="rfc.section.2.2.7.p.16" class="avoidbreakafter">
                                <p>resulting in the following signature base line:</p>
                            </div>
                            <div id="rfc.section.2.2.7.p.17">
                                <pre>
"@query": ?
</pre>
                            </div>
                        </section>
                        <section id="content-request-query-param">
                            <h4 id="rfc.section.2.2.8"><a href="#rfc.section.2.2.8">2.2.8.</a>&nbsp;<a
                                    href="#content-request-query-param">Query Parameters</a></h4>
                            <div id="rfc.section.2.2.8.p.1">
                                <p>If the query portion of a request target URI uses HTML form parameters in the format
                                    defined in <span class="nobr">Section </span><a
                                        href="https://url.spec.whatwg.org/https://url.spec.whatwg.org/#application/x-www-form-urlencoded">5</a>
                                    of <a href="#HTMLURL"><cite title="URL (Living Standard)">[HTMLURL]</cite></a>, the
                                    <span class="tt">@query-param</span> derived component allows addressing of these
                                    individual query parameters. The query parameters <em class="bcp14">MUST</em> be
                                    parsed according to <span class="nobr">Section </span><a
                                        href="https://url.spec.whatwg.org/https://url.spec.whatwg.org/#urlencoded-parsing">5.1</a>
                                    of <a href="#HTMLURL"><cite title="URL (Living Standard)">[HTMLURL]</cite></a>,
                                    resulting in a list of (<span class="tt">nameString</span>, <span
                                        class="tt">valueString</span>) tuples. The <em class="bcp14">REQUIRED</em> <span
                                        class="tt">name</span> parameter of each component identifier contains the
                                    encoded <span class="tt">nameString</span> of a single query parameter as a String
                                    value. The component value of a single named parameter is the encoded <span
                                        class="tt">valueString</span> of that single query parameter. Several different
                                    named query parameters <em class="bcp14">MAY</em> be included in the covered
                                    components. Single named parameters <em class="bcp14">MAY</em> occur in any order in
                                    the covered components, regardless of the order they occur in the query string.
                                </p>
                            </div>
                            <div id="rfc.section.2.2.8.p.2" class="avoidbreakafter">
                                <p>The value of the <span class="tt">name</span> parameter and the component value of a
                                    single named parameter are calculated via the following process:</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.3">
                                <ol type="1">
                                    <li>Parse the <span class="tt">nameString</span> or <span
                                            class="tt">valueString</span> of the named query parameter defined by <span
                                            class="nobr">Section </span><a
                                            href="https://url.spec.whatwg.org/https://url.spec.whatwg.org/#urlencoded-parsing">5.1</a>
                                        of <a href="#HTMLURL"><cite title="URL (Living Standard)">[HTMLURL]</cite></a>;
                                        this is the value after percent-encoded octets are decoded.</li>
                                    <li>Encode the <span class="tt">nameString</span> or <span
                                            class="tt">valueString</span> using the "percent-encode after encoding"
                                        process defined by <span class="nobr">Section </span><a
                                            href="https://url.spec.whatwg.org/https://url.spec.whatwg.org/#urlencoded-serializing">5.2</a>
                                        of <a href="#HTMLURL"><cite title="URL (Living Standard)">[HTMLURL]</cite></a>;
                                        this results in an ASCII string <a href="#RFC0020"><cite
                                                title="ASCII format for network interchange">[ASCII]</cite></a>.</li>
                                    <li>Output the ASCII string.</li>
                                </ol>
                            </div>
                            <div id="rfc.section.2.2.8.p.4">
                                <p>Note that the component value does not include any leading question mark (<span
                                        class="tt">?</span>) characters, equals sign (<span class="tt">=</span>)
                                    characters, or separating ampersand (<span class="tt">&amp;</span>) characters.
                                    Named query parameters with an empty <span class="tt">valueString</span> have an
                                    empty string as the component value. Note that due to inconsistencies in
                                    implementations, some query parameter parsing libraries drop such empty values.</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.5">
                                <p>If a query parameter is named as a covered component but it does not occur in the
                                    query parameters, this <em class="bcp14">MUST</em> cause an error in the signature
                                    base generation.</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.6" class="avoidbreakafter">
                                <p>For example, for the following request:</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.7">
                                <pre class="text">
GET /path?param=value&amp;foo=bar&amp;baz=batman&amp;qux= HTTP/1.1
Host: www.example.com
</pre>
                            </div>
                            <div id="rfc.section.2.2.8.p.8" class="avoidbreakafter">
                                <p>Indicating the <span class="tt">baz</span>, <span class="tt">qux</span>, and <span
                                        class="tt">param</span> named query parameters would result in the following
                                    <span class="tt">@query-param</span> component values:
                                </p>
                            </div>
                            <div id="rfc.section.2.2.8.p.9">
                                <p><em>baz</em>: <span class="tt">batman</span></p>
                            </div>
                            <div id="rfc.section.2.2.8.p.10">
                                <p><em>qux</em>: an empty string</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.11">
                                <p><em>param</em>: <span class="tt">value</span></p>
                            </div>
                            <div id="rfc.section.2.2.8.p.12" class="avoidbreakafter">
                                <p>and the following signature base lines, with (SP) indicating a single trailing space
                                    character before the empty component value:</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.13">
                                <pre>
"@query-param";name="baz": batman
"@query-param";name="qux":(SP)
"@query-param";name="param": value
</pre>
                            </div>
                            <div id="rfc.section.2.2.8.p.14">
                                <p>This derived component has some limitations. Specifically, the algorithms provided in
                                    <span class="nobr">Section </span><a
                                        href="https://url.spec.whatwg.org/https://url.spec.whatwg.org/#application/x-www-form-urlencoded">5</a>
                                    of <a href="#HTMLURL"><cite title="URL (Living Standard)">[HTMLURL]</cite></a> only
                                    support query parameters using percent-escaped UTF-8 encoding. Other encodings are
                                    not supported. Additionally, multiple instances of a named parameter are not
                                    reliably supported in the wild. If a parameter name occurs multiple times in a
                                    request, the named query parameter <em class="bcp14">MUST NOT</em> be included. If
                                    multiple parameters are common within an application, it is <em
                                        class="bcp14">RECOMMENDED</em> to sign the entire query string using the <span
                                        class="tt">@query</span> component identifier defined in <a
                                        href="#content-request-query" title="Query">Section 2.2.7</a>.
                                </p>
                            </div>
                            <div id="rfc.section.2.2.8.p.15" class="avoidbreakafter">
                                <p>The encoding process allows query parameters that include newlines or other
                                    problematic characters in their values, or with alternative encodings such as using
                                    the plus (+) character to represent spaces. For the query parameters in this
                                    message:</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.16">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

GET /parameters?var=this%20is%20a%20big%0Amultiline%20value&amp;\
  bar=with+plus+whitespace&amp;fa%C3%A7ade%22%3A%20=something HTTP/1.1
Host: www.example.com
Date: Tue, 20 Apr 2021 02:07:56 GMT
</pre>
                            </div>
                            <div id="rfc.section.2.2.8.p.17" class="avoidbreakafter">
                                <p>The resulting values are encoded as follows:</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.18">
                                <pre>
"@query-param";name="var": this%20is%20a%20big%0Amultiline%20value
"@query-param";name="bar": with%20plus%20whitespace
"@query-param";name="fa%C3%A7ade%22%3A%20": something
</pre>
                            </div>
                            <div id="rfc.section.2.2.8.p.19" class="avoidbreakafter">
                                <p>If the encoding were not applied, the resultant values would be:</p>
                            </div>
                            <div id="rfc.section.2.2.8.p.20">
                                <pre>
"@query-param";name="var": this is a big
multiline value
"@query-param";name="bar": with plus whitespace
"@query-param";name="façade\": ": something
</pre>
                            </div>
                            <div id="rfc.section.2.2.8.p.21">
                                <p>This base string contains characters that violate the constraints on component names
                                    and values and is therefore invalid.</p>
                            </div>
                        </section>
                        <section id="content-status-code">
                            <h4 id="rfc.section.2.2.9"><a href="#rfc.section.2.2.9">2.2.9.</a>&nbsp;<a
                                    href="#content-status-code">Status Code</a></h4>
                            <div id="rfc.section.2.2.9.p.1">
                                <p>The <span class="tt">@status</span> derived component refers to the three-digit
                                    numeric HTTP status code of a response message as defined in <a
                                        href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>, <a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-15">Section 15</a>.
                                    The component value is the serialized three-digit integer of the HTTP status code,
                                    with no descriptive text.</p>
                            </div>
                            <div id="rfc.section.2.2.9.p.2" class="avoidbreakafter">
                                <p>For example, the following response message:</p>
                            </div>
                            <div id="rfc.section.2.2.9.p.3">
                                <pre class="text">
HTTP/1.1 200 OK
Date: Fri, 26 Mar 2010 00:05:00 GMT
</pre>
                            </div>
                            <div id="rfc.section.2.2.9.p.4" class="avoidbreakafter">
                                <p>would result in the following <span class="tt">@status</span> component value:</p>
                            </div>
                            <div id="rfc.section.2.2.9.p.5">
                                <pre>
200
</pre>
                            </div>
                            <div id="rfc.section.2.2.9.p.6" class="avoidbreakafter">
                                <p>and the following signature base line:</p>
                            </div>
                            <div id="rfc.section.2.2.9.p.7">
                                <pre>
"@status": 200
</pre>
                            </div>
                            <div id="rfc.section.2.2.9.p.8">
                                <p>The <span class="tt">@status</span> component identifier <em class="bcp14">MUST
                                        NOT</em> be used in a request message.</p>
                            </div>
                        </section>
                    </section>
                    <section id="signature-params">
                        <h3 id="rfc.section.2.3"><a href="#rfc.section.2.3">2.3.</a>&nbsp;<a
                                href="#signature-params">Signature Parameters</a></h3>
                        <div id="rfc.section.2.3.p.1">
                            <p>HTTP message signatures have metadata properties that provide information regarding the
                                signature's generation and verification, consisting of the ordered set of covered
                                components and the ordered set of parameters, where the parameters include a timestamp
                                of signature creation, identifiers for verification key material, and other utilities.
                                This metadata is represented by a special message component in the signature base for
                                signature parameters; this special message component is treated slightly differently
                                from other message components. Specifically, the signature parameters message component
                                is <em class="bcp14">REQUIRED</em> as the last line of the signature base (<a
                                    href="#create-sig-input" title="Creating the Signature Base">Section 2.5</a>), and
                                the component identifier <em class="bcp14">MUST NOT</em> be enumerated within the set of
                                covered components for any signature, including itself.</p>
                        </div>
                        <div id="rfc.section.2.3.p.2">
                            <p>The signature parameters component name is <span class="tt">@signature-params</span>.</p>
                        </div>
                        <div id="rfc.section.2.3.p.3" class="avoidbreakafter">
                            <p>The signature parameters component value is the serialization of the signature parameters
                                for this signature, including the covered components ordered set with all associated
                                parameters. These parameters include any of the following:</p>
                        </div>
                        <div id="rfc.section.2.3.p.4">
                            <dl>
                                <dt><span class="tt">created</span>:</dt>
                                <dd style="margin-left: 1.5em">Creation time as a UNIX timestamp value of type Integer.
                                    Sub-second precision is not supported. The inclusion of this parameter is <em
                                        class="bcp14">RECOMMENDED</em>.</dd>
                                <dt><span class="tt">expires</span>:</dt>
                                <dd style="margin-left: 1.5em">Expiration time as a UNIX timestamp value of type
                                    Integer. Sub-second precision is not supported.</dd>
                                <dt><span class="tt">nonce</span>:</dt>
                                <dd style="margin-left: 1.5em">A random unique value generated for this signature as a
                                    String value.</dd>
                                <dt><span class="tt">alg</span>:</dt>
                                <dd style="margin-left: 1.5em">The HTTP message signature algorithm from the "HTTP
                                    Signature Algorithms" registry, as a String value.</dd>
                                <dt><span class="tt">keyid</span>:</dt>
                                <dd style="margin-left: 1.5em">The identifier for the key material as a String value.
                                </dd>
                                <dt><span class="tt">tag</span>:</dt>
                                <dd style="margin-left: 1.5em">An application-specific tag for the signature as a String
                                    value. This value is used by applications to help identify signatures relevant for
                                    specific applications or protocols.</dd>
                            </dl>
                        </div>
                        <div id="rfc.section.2.3.p.5">
                            <p>Additional parameters can be defined in the "HTTP Signature Metadata Parameters" registry
                                (<a href="#param-registry" title="HTTP Signature Metadata Parameters Registry">Section
                                    6.3</a>). Note that the parameters are not in any general order, but once an
                                ordering is chosen for a given set of parameters, it cannot be changed without altering
                                the signature parameters value.</p>
                        </div>
                        <div id="rfc.section.2.3.p.6" class="avoidbreakafter">
                            <p>The signature parameters component value is serialized as a parameterized Inner List
                                using the rules provided in <a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4">Section 4</a> of <a
                                    href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a> as
                                follows:</p>
                        </div>
                        <div id="rfc.section.2.3.p.7">
                            <ol type="1">
                                <li>Let the output be an empty string.</li>
                                <li>Determine an order for the component identifiers of the covered components, not
                                    including the <span class="tt">@signature-params</span> component identifier itself.
                                    Once this order is chosen, it cannot be changed. This order <em
                                        class="bcp14">MUST</em> be the same order as that used in creating the signature
                                    base (<a href="#create-sig-input" title="Creating the Signature Base">Section
                                        2.5</a>).</li>
                                <li>Serialize the component identifiers of the covered components, including all
                                    parameters, as an ordered Inner List of String values according to <a
                                        href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4.1.1.1">Section
                                        4.1.1.1</a> of <a href="#RFC8941"><cite
                                            title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>;
                                    then, append this to the output. Note that the component identifiers can include
                                    their own parameters, and these parameters are ordered sets. Once an order is chosen
                                    for a component's parameters, the order cannot be changed.</li>
                                <li>Determine an order for any signature parameters. Once this order is chosen, it
                                    cannot be changed.</li>
                                <li>Append the parameters to the Inner List in order according to <a
                                        href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4.1.1.2">Section
                                        4.1.1.2</a> of <a href="#RFC8941"><cite
                                            title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>,
                                    skipping parameters that are not available or not used for this message signature.
                                </li>
                                <li>The output contains the signature parameters component value.</li>
                            </ol>
                        </div>
                        <div id="rfc.section.2.3.p.8">
                            <p>Note that the Inner List serialization from <a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4.1.1.1">Section
                                    4.1.1.1</a> of <a href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a> is used
                                for the covered component value instead of the List serialization from <a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4.1.1">Section 4.1.1</a>
                                of <a href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a> in order
                                to facilitate parallelism with this value's inclusion in the Signature-Input field, as
                                discussed in <a href="#signature-input-header"
                                    title="The Signature-Input HTTP Field">Section 4.1</a>.</p>
                        </div>
                        <div id="rfc.section.2.3.p.9" class="avoidbreakafter">
                            <p>This example shows the serialized component value for the parameters of an example
                                message signature:</p>
                        </div>
                        <div id="rfc.section.2.3.p.10">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

("@target-uri" "@authority" "date" "cache-control")\
  ;keyid="test-key-rsa-pss";alg="rsa-pss-sha512";\
  created=1618884475;expires=1618884775
</pre>
                        </div>
                        <div id="rfc.section.2.3.p.11">
                            <p>Note that an HTTP message could contain multiple signatures (<a
                                    href="#signature-multiple" title="Multiple Signatures">Section 4.3</a>), but only
                                the signature parameters used for a single signature are included in a given signature
                                parameters entry.</p>
                        </div>
                    </section>
                    <section id="content-request-response">
                        <h3 id="rfc.section.2.4"><a href="#rfc.section.2.4">2.4.</a>&nbsp;<a
                                href="#content-request-response">Signing Request Components in a Response Message</a>
                        </h3>
                        <div id="rfc.section.2.4.p.1">
                            <p>When a request message results in a signed response message, the signer can include
                                portions of the request message in the signature base by adding the <span
                                    class="tt">req</span> parameter to the component identifier.</p>
                        </div>
                        <div id="rfc.section.2.4.p.2">
                            <dl>
                                <dt><span class="tt">req</span></dt>
                                <dd style="margin-left: 1.5em">
                                    <div>A Boolean flag indicating that the component value is derived from the request
                                        that triggered this response message and not from the response message directly.
                                    </div>
                                </dd>
                            </dl>
                        </div>
                        <div id="rfc.section.2.4.p.3">
                            <p>This parameter can be applied to both HTTP fields and derived components that target the
                                request, with the same semantics. The component value for a message component using this
                                parameter is calculated in the same manner as it is normally, but data is pulled from
                                the request message instead of the target response message to which the signature is
                                applied.</p>
                        </div>
                        <div id="rfc.section.2.4.p.4">
                            <p>Note that the same component name <em class="bcp14">MAY</em> be included with and without
                                the <span class="tt">req</span> parameter in a single signature base, indicating the
                                same named component from both the request message and the response message.</p>
                        </div>
                        <div id="rfc.section.2.4.p.5">
                            <p>The <span class="tt">req</span> parameter <em class="bcp14">MAY</em> be combined with
                                other parameters as appropriate for the component identifier, such as the <span
                                    class="tt">key</span> parameter for a Dictionary field.</p>
                        </div>
                        <div id="rfc.section.2.4.p.6" class="avoidbreakafter">
                            <p>For example, when serving a response for this request:</p>
                        </div>
                        <div id="rfc.section.2.4.p.7">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Type: application/json
Content-Length: 18

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.2.4.p.8" class="avoidbreakafter">
                            <p>This would result in the following unsigned response message:</p>
                        </div>
                        <div id="rfc.section.2.4.p.9">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 503 Service Unavailable
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 62
Content-Digest: sha-512=:0Y6iCBzGg5rZtoXS95Ijz03mslf6KAMCloESHObfwn\
  HJDbkkWWQz6PhhU9kxsTbARtY2PTBOzq24uJFpHsMuAg==:

{"busy": true, "message": "Your call is very important to us"}
</pre>
                        </div>
                        <div id="rfc.section.2.4.p.10">
                            <p>The server signs the response with its own key, including the <span
                                    class="tt">@status</span> code and several header fields in the covered components.
                                While this covers a reasonable amount of the response for this application, the server
                                additionally includes several components derived from the original request message that
                                triggered this response. In this example, the server includes the method, authority,
                                path, and content digest from the request in the covered components of the response. The
                                Content-Digest for both the request and the response is included under the response
                                signature. For the application in this example, the query is deemed not to be relevant
                                to the response and is therefore not covered. Other applications would make different
                                decisions based on application needs, as discussed in <a href="#application"
                                    title="Application of HTTP Message Signatures">Section 1.4</a>.</p>
                        </div>
                        <div id="rfc.section.2.4.p.11" class="avoidbreakafter">
                            <p>The signature base for this example is:</p>
                        </div>
                        <div id="rfc.section.2.4.p.12">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

"@status": 503
"content-digest": sha-512=:0Y6iCBzGg5rZtoXS95Ijz03mslf6KAMCloESHObf\
  wnHJDbkkWWQz6PhhU9kxsTbARtY2PTBOzq24uJFpHsMuAg==:
"content-type": application/json
"@authority";req: example.com
"@method";req: POST
"@path";req: /foo
"content-digest";req: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A\
  2svX+TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"@signature-params": ("@status" "content-digest" "content-type" \
  "@authority";req "@method";req "@path";req "content-digest";req)\
  ;created=1618884479;keyid="test-key-ecc-p256"
</pre>
                        </div>
                        <div id="rfc.section.2.4.p.13" class="avoidbreakafter">
                            <p>The signed response message is:</p>
                        </div>
                        <div id="rfc.section.2.4.p.14">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 503 Service Unavailable
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 62
Content-Digest: sha-512=:0Y6iCBzGg5rZtoXS95Ijz03mslf6KAMCloESHObfwn\
  HJDbkkWWQz6PhhU9kxsTbARtY2PTBOzq24uJFpHsMuAg==:
Signature-Input: reqres=("@status" "content-digest" "content-type" \
  "@authority";req "@method";req "@path";req "content-digest";req)\
  ;created=1618884479;keyid="test-key-ecc-p256"
Signature: reqres=:dMT/A/76ehrdBTD/2Xx8QuKV6FoyzEP/I9hdzKN8LQJLNgzU\
  4W767HK05rx1i8meNQQgQPgQp8wq2ive3tV5Ag==:

{"busy": true, "message": "Your call is very important to us"}
</pre>
                        </div>
                        <div id="rfc.section.2.4.p.15">
                            <p>Note that the ECDSA signature algorithm in use here is non-deterministic, meaning that a
                                different signature value will be created every time the algorithm is run. The signature
                                value provided here can be validated against the given keys, but newly generated
                                signature values are not expected to match the example. See <a
                                    href="#security-nondeterministic"
                                    title="Non-deterministic Signature Primitives">Section 7.3.5</a>.</p>
                        </div>
                        <div id="rfc.section.2.4.p.16">
                            <p>Since the component values from the request are not repeated in the response message, the
                                requester <em class="bcp14">MUST</em> keep the original message component values around
                                long enough to validate the signature of the response that uses this component
                                identifier parameter. In most cases, this means the requester needs to keep the original
                                request message around, since the signer could choose to include any portions of the
                                request in its response, according to the needs of the application. Since it is possible
                                for an intermediary to alter a request message before it is processed by the server,
                                applications need to take care not to sign such altered values, as the client would not
                                be able to validate the resulting signature.</p>
                        </div>
                        <div id="rfc.section.2.4.p.17" class="avoidbreakafter">
                            <p>It is also possible for a server to create a signed response in response to a signed
                                request. For this example of a signed request:</p>
                        </div>
                        <div id="rfc.section.2.4.p.18">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Type: application/json
Content-Length: 18
Signature-Input: sig1=("@method" "@authority" "@path" "@query" \
  "content-digest" "content-type" "content-length")\
  ;created=1618884475;keyid="test-key-rsa-pss"
Signature: sig1=:e8UJ5wMiRaonlth5ERtE8GIiEH7Akcr493nQ07VPNo6y3qvjdK\
  t0fo8VHO8xXDjmtYoatGYBGJVlMfIp06eVMEyNW2I4vN7XDAz7m5v1108vGzaDljr\
  d0H8+SJ28g7bzn6h2xeL/8q+qUwahWA/JmC8aOC9iVnwbOKCc0WSrLgWQwTY6VLp4\
  2Qt7jjhYT5W7/wCvfK9A1VmHH1lJXsV873Z6hpxesd50PSmO+xaNeYvDLvVdZlhtw\
  5PCtUYzKjHqwmaQ6DEuM8udRjYsoNqp2xZKcuCO1nKc0V3RjpqMZLuuyVbHDAbCzr\
  0pg2d2VM/OC33JAU7meEjjaNz+d7LWPg==:

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.2.4.p.19" class="avoidbreakafter">
                            <p>The server could choose to sign portions of this response, including several portions of
                                the request, resulting in this signature base:</p>
                        </div>
                        <div id="rfc.section.2.4.p.20">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

"@status": 503
"content-digest": sha-512=:0Y6iCBzGg5rZtoXS95Ijz03mslf6KAMCloESHObf\
  wnHJDbkkWWQz6PhhU9kxsTbARtY2PTBOzq24uJFpHsMuAg==:
"content-type": application/json
"@authority";req: example.com
"@method";req: POST
"@path";req: /foo
"@query";req: ?param=Value&amp;Pet=dog
"content-digest";req: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A\
  2svX+TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"content-type";req: application/json
"content-length";req: 18
"@signature-params": ("@status" "content-digest" "content-type" \
  "@authority";req "@method";req "@path";req "@query";req \
  "content-digest";req "content-type";req "content-length";req)\
  ;created=1618884479;keyid="test-key-ecc-p256"
</pre>
                        </div>
                        <div id="rfc.section.2.4.p.21" class="avoidbreakafter">
                            <p>and the following signed response:</p>
                        </div>
                        <div id="rfc.section.2.4.p.22">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 503 Service Unavailable
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 62
Content-Digest: sha-512=:0Y6iCBzGg5rZtoXS95Ijz03mslf6KAMCloESHObfwn\
  HJDbkkWWQz6PhhU9kxsTbARtY2PTBOzq24uJFpHsMuAg==:
Signature-Input: reqres=("@status" "content-digest" "content-type" \
  "@authority";req "@method";req "@path";req "@query";req \
  "content-digest";req "content-type";req "content-length";req)\
  ;created=1618884479;keyid="test-key-ecc-p256"
Signature: reqres=:C73J41GVKc+TYXbSobvZf0CmNcptRiWN+NY1Or0A36ISg6ym\
  dRN6ZgR2QfrtopFNzqAyv+CeWrMsNbcV2Ojsgg==:

{"busy": true, "message": "Your call is very important to us"}
</pre>
                        </div>
                        <div id="rfc.section.2.4.p.23">
                            <p>Note that the ECDSA signature algorithm in use here is non-deterministic, meaning that a
                                different signature value will be created every time the algorithm is run. The signature
                                value provided here can be validated against the given keys, but newly generated
                                signature values are not expected to match the example. See <a
                                    href="#security-nondeterministic"
                                    title="Non-deterministic Signature Primitives">Section 7.3.5</a>.</p>
                        </div>
                        <div id="rfc.section.2.4.p.24">
                            <p>Applications signing a response to a signed request <em class="bcp14">SHOULD</em> sign
                                all of the components of the request signature value to provide sufficient coverage and
                                protection against a class of collision attacks, as discussed in <a
                                    href="#security-sign-signature" title="Signing Signature Values">Section 7.3.7</a>.
                                The server in this example has included all components listed in the Signature-Input
                                field of the client's signature on the request in the response signature, in addition to
                                components of the response.</p>
                        </div>
                        <div id="rfc.section.2.4.p.25">
                            <p>While it is syntactically possible to include the Signature and Signature-Input fields of
                                the request message in the signature components of a response to a message using this
                                mechanism, this practice is <em class="bcp14">NOT RECOMMENDED</em>. This is because
                                signatures of signatures do not provide transitive coverage of covered components as one
                                might expect, and the practice is susceptible to several attacks as discussed in <a
                                    href="#security-sign-signature" title="Signing Signature Values">Section 7.3.7</a>.
                                An application that needs to signal successful processing or receipt of a signature
                                would need to carefully specify alternative mechanisms for sending such a signal
                                securely.</p>
                        </div>
                        <div id="rfc.section.2.4.p.26">
                            <p>The response signature can only ever cover what is included in the request message when
                                using this flag. Consequently, if an application needs to include the message content of
                                the request under the signature of its response, the client needs to include a means for
                                covering that content, such as a Content-Digest field. See the discussion in <a
                                    href="#security-message-content" title="Message Content">Section 7.2.8</a> for more
                                information.</p>
                        </div>
                        <div id="rfc.section.2.4.p.27">
                            <p>The <span class="tt">req</span> parameter <em class="bcp14">MUST NOT</em> be used for any
                                component in a signature that targets a request message.</p>
                        </div>
                    </section>
                    <section id="create-sig-input">
                        <h3 id="rfc.section.2.5"><a href="#rfc.section.2.5">2.5.</a>&nbsp;<a
                                href="#create-sig-input">Creating the Signature Base</a></h3>
                        <div id="rfc.section.2.5.p.1">
                            <p>The signature base is an ASCII string <a href="#RFC0020"><cite
                                        title="ASCII format for network interchange">[ASCII]</cite></a> containing the
                                canonicalized HTTP message components covered by the signature. The input to the
                                signature base creation algorithm is the ordered set of covered component identifiers
                                and their associated values, along with any additional signature parameters discussed in
                                <a href="#signature-params" title="Signature Parameters">Section 2.3</a>.
                            </p>
                        </div>
                        <div id="rfc.section.2.5.p.2">
                            <p>Component identifiers are serialized using the strict serialization rules defined by <a
                                    href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>, <a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-4">Section 4</a>. The
                                component identifier has a component name, which is a String Item value serialized using
                                the <span class="tt">sf-string</span> ABNF rule. The component identifier <em
                                    class="bcp14">MAY</em> also include defined parameters that are serialized using the
                                <span class="tt">parameters</span> ABNF rule. The signature parameters line defined in
                                <a href="#signature-params" title="Signature Parameters">Section 2.3</a> follows this
                                same pattern, but the component identifier is a String Item with a fixed value and no
                                parameters, and the component value is always an Inner List with optional parameters.
                            </p>
                        </div>
                        <div id="rfc.section.2.5.p.3">
                            <p>Note that this means the serialization of the component name itself is encased in double
                                quotes, with parameters following as a semicolon-separated list, such as <span
                                    class="tt">"cache-control"</span>, <span class="tt">"@authority"</span>, <span
                                    class="tt">"@signature-params"</span>, or <span
                                    class="tt">"example-dictionary";key="foo"</span>.</p>
                        </div>
                        <div id="rfc.section.2.5.p.4" class="avoidbreakafter">
                            <p>The output is the ordered set of bytes that form the signature base, which conforms to
                                the following ABNF:</p>
                        </div>
                        <div id="rfc.section.2.5.p.5">
                            <pre class="inline">
signature-base = *( signature-base-line LF ) signature-params-line
signature-base-line = component-identifier ":" SP
    ( derived-component-value / *field-content )
    ; no obs-fold nor obs-text
component-identifier = component-name parameters
component-name = sf-string
derived-component-value = *( VCHAR / SP )
signature-params-line = DQUOTE "@signature-params" DQUOTE
     ":" SP inner-list
</pre>
                        </div>
                        <div id="rfc.section.2.5.p.6">
                            <p>To create the signature base, the signer or verifier concatenates entries for each
                                component identifier in the signature's covered components (including their parameters)
                                using the following algorithm. All errors produced as described <em
                                    class="bcp14">MUST</em> fail the algorithm immediately, without outputting a
                                signature base.</p>
                        </div>
                        <div id="rfc.section.2.5.p.7">
                            <ol type="1">
                                <li>Let the output be an empty string.</li>
                                <li>
                                    <div class="avoidbreakafter">
                                        <p>For each message component item in the covered components set (in order):</p>
                                    </div>
                                    <div>
                                        <dl>
                                            <dt>11.</dt>
                                            <dd>If the component identifier (including its parameters) has already been
                                                added to the signature base, produce an error.</dd>
                                            <dt>12.</dt>
                                            <dd>Append the component identifier for the covered component serialized
                                                according to the <span class="tt">component-identifier</span> ABNF rule.
                                                Note that this serialization places the component name in double quotes
                                                and appends any parameters outside of the quotes.</dd>
                                            <dt>13.</dt>
                                            <dd>Append a single colon (<span class="tt">:</span>).</dd>
                                            <dt>14.</dt>
                                            <dd>Append a single space (" ").</dd>
                                            <dt>15.</dt>
                                            <dd>
                                                <div>
                                                    <p>Determine the component value for the component identifier.</p>
                                                </div>
                                                <div>
                                                    <ul>
                                                        <li>If the component identifier has a parameter that is not
                                                            understood, produce an error.</li>
                                                        <li>If the component identifier has parameters that are mutually
                                                            incompatible with one another, such as <span
                                                                class="tt">bs</span> and <span class="tt">sf</span>,
                                                            produce an error.</li>
                                                        <li>If the component identifier contains the <span
                                                                class="tt">req</span> parameter and the target message
                                                            is a request, produce an error.</li>
                                                        <li>If the component identifier contains the <span
                                                                class="tt">req</span> parameter and the target message
                                                            is a response, the context for the component value is the
                                                            related request message of the target response message.
                                                            Otherwise, the context for the component value is the target
                                                            message.</li>
                                                        <li>If the component name starts with an "at" (<span
                                                                class="tt">@</span>) character, derive the component's
                                                            value from the message according to the specific rules
                                                            defined for the derived component, as provided in <a
                                                                href="#derived-components"
                                                                title="Derived Components">Section 2.2</a>, including
                                                            processing of any known valid parameters. If the derived
                                                            component name is unknown or the value cannot be derived,
                                                            produce an error.</li>
                                                        <li>If the component name does not start with an "at" (<span
                                                                class="tt">@</span>) character, canonicalize the HTTP
                                                            field value as described in <a href="#http-fields"
                                                                title="HTTP Fields">Section 2.1</a>, including
                                                            processing of any known valid parameters. If the field
                                                            cannot be found in the message or the value cannot be
                                                            obtained in the context, produce an error.</li>
                                                    </ul>
                                                </div>
                                            </dd>
                                            <dt>16.</dt>
                                            <dd>Append the covered component's canonicalized component value.</dd>
                                            <dt>17.</dt>
                                            <dd>Append a single newline (<span class="tt">\n</span>).</dd>
                                        </dl>
                                    </div>
                                </li>
                                <li>
                                    <div class="avoidbreakafter">
                                        <p>Append the signature parameters component (<a href="#signature-params"
                                                title="Signature Parameters">Section 2.3</a>) according to the <span
                                                class="tt">signature-params-line</span> rule as follows:</p>
                                    </div>
                                    <div>
                                        <dl>
                                            <dt>11.</dt>
                                            <dd>Append the component identifier for the signature parameters serialized
                                                according to the <span class="tt">component-identifier</span> rule,
                                                i.e., the exact value <span class="tt">"@signature-params"</span>
                                                (including double quotes).</dd>
                                            <dt>12.</dt>
                                            <dd>Append a single colon (<span class="tt">:</span>).</dd>
                                            <dt>13.</dt>
                                            <dd>Append a single space (" ").</dd>
                                            <dt>14.</dt>
                                            <dd>Append the signature parameters' canonicalized component values as
                                                defined in <a href="#signature-params"
                                                    title="Signature Parameters">Section 2.3</a>, i.e., Inner List
                                                Structured Field values with parameters.</dd>
                                        </dl>
                                    </div>
                                </li>
                                <li>Produce an error if the output string contains any non-ASCII characters <a
                                        href="#RFC0020"><cite
                                            title="ASCII format for network interchange">[ASCII]</cite></a>.</li>
                                <li>Return the output string.</li>
                            </ol>
                        </div>
                        <div id="rfc.section.2.5.p.8" class="avoidbreakafter">
                            <p>If covered components reference a component identifier that cannot be resolved to a
                                component value in the message, the implementation <em class="bcp14">MUST</em> produce
                                an error and not create a signature base. Such situations include, but are not limited
                                to, the following:</p>
                        </div>
                        <div id="rfc.section.2.5.p.9">
                            <ul>
                                <li>The signer or verifier does not understand the derived component name.</li>
                                <li>The component name identifies a field that is not present in the message or whose
                                    value is malformed.</li>
                                <li>The component identifier includes a parameter that is unknown or does not apply to
                                    the component identifier to which it is attached.</li>
                                <li>The component identifier indicates that a Structured Field serialization is used
                                    (via the <span class="tt">sf</span> parameter), but the field in question is known
                                    to not be a Structured Field or the type of Structured Field is not known to the
                                    implementation.</li>
                                <li>The component identifier is a Dictionary member identifier that references a field
                                    that is not present in the message, that is not a Dictionary Structured Field, or
                                    whose value is malformed.</li>
                                <li>The component identifier is a Dictionary member identifier or a named query
                                    parameter identifier that references a member that is not present in the component
                                    value or whose value is malformed. For example, the identifier is <span
                                        class="tt">"example-dict";key="c"</span>, and the value of the Example-Dict
                                    header field is <span class="tt">a=1, b=2</span>, which does not have the <span
                                        class="tt">c</span> value.</li>
                            </ul>
                        </div>
                        <div id="rfc.section.2.5.p.10" class="avoidbreakafter">
                            <p>In the following non-normative example, the HTTP message being signed is the following
                                request:</p>
                        </div>
                        <div id="rfc.section.2.5.p.11">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.2.5.p.12" class="avoidbreakafter">
                            <p>The covered components consist of the <span class="tt">@method</span>, <span
                                    class="tt">@authority</span>, and <span class="tt">@path</span> derived components
                                followed by the <span class="tt">Content-Digest</span>, <span
                                    class="tt">Content-Length</span>, and <span class="tt">Content-Type</span> HTTP
                                header fields, in order. The signature parameters consist of a creation timestamp of
                                <span class="tt">1618884473</span> and a key identifier of <span
                                    class="tt">test-key-rsa-pss</span>. Note that no explicit <span
                                    class="tt">alg</span> parameter is given here, since the verifier is known by the
                                application to use the RSA-PSS algorithm based on the identified key. The signature base
                                for this message with these parameters is:
                            </p>
                        </div>
                        <div id="example-sig-input"></div>
                        <div id="rfc.figure.1">
                            <div>
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

"@method": POST
"@authority": example.com
"@path": /foo
"content-digest": sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX\
  +TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"content-length": 18
"content-type": application/json
"@signature-params": ("@method" "@authority" "@path" \
  "content-digest" "content-length" "content-type")\
  ;created=1618884473;keyid="test-key-rsa-pss"
</pre>
                            </div>
                        </div>
                        <p class="figure">Figure 1: Non-normative Example Signature Base</p>
                        <div id="rfc.section.2.5.p.13">
                            <p>Note that the example signature base above does not include the final newline that ends
                                the displayed example, nor do other example signature bases displayed elsewhere in this
                                specification.</p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="message-signatures">
                    <h2 id="rfc.section.3" class="np"><a href="#rfc.section.3">3.</a>&nbsp;<a
                            href="#message-signatures">HTTP Message Signatures</a></h2>
                    <div id="rfc.section.3.p.1">
                        <p>An HTTP message signature is a signature over a string generated from a subset of the
                            components of an HTTP message in addition to metadata about the signature itself. When
                            successfully verified against an HTTP message, an HTTP message signature provides
                            cryptographic proof that the message is semantically equivalent to the message for which the
                            signature was generated, with respect to the subset of message components that was signed.
                        </p>
                    </div>
                    <section id="sign">
                        <h3 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a>&nbsp;<a href="#sign">Creating a
                                Signature</a></h3>
                        <div id="rfc.section.3.1.p.1">
                            <p>Creation of an HTTP message signature is a process that takes as its input the signature
                                context (including the target message) and the requirements for the application. The
                                output is a signature value and set of signature parameters that can be communicated to
                                the verifier by adding them to the message.</p>
                        </div>
                        <div id="rfc.section.3.1.p.2" class="avoidbreakafter">
                            <p>In order to create a signature, a signer <em class="bcp14">MUST</em> apply the following
                                algorithm:</p>
                        </div>
                        <div id="rfc.section.3.1.p.3">
                            <ol type="1">
                                <li>The signer chooses an HTTP signature algorithm and key material for signing from the
                                    set of potential signing algorithms. The set of potential algorithms is determined
                                    by the application and is out of scope for this document. The signer <em
                                        class="bcp14">MUST</em> choose key material that is appropriate for the
                                    signature's algorithm and that conforms to any requirements defined by the
                                    algorithm, such as key size or format. The mechanism by which the signer chooses the
                                    algorithm and key material is out of scope for this document.</li>
                                <li>The signer sets the signature's creation time to the current time.</li>
                                <li>If applicable, the signer sets the signature's expiration time property to the time
                                    at which the signature is to expire. The expiration is a hint to the verifier,
                                    expressing the time at which the signer is no longer willing to vouch for the
                                    signature. An appropriate expiration length, and the processing requirements of this
                                    parameter, are application specific.</li>
                                <li>
                                    <div>
                                        <p>The signer creates an ordered set of component identifiers representing the
                                            message components to be covered by the signature and attaches signature
                                            metadata parameters to this set. The serialized value of this set is later
                                            used as the value of the Signature-Input field as described in <a
                                                href="#signature-input-header"
                                                title="The Signature-Input HTTP Field">Section 4.1</a>.</p>
                                    </div>
                                    <div>
                                        <ul>
                                            <li>Once an order of covered components is chosen, the order <em
                                                    class="bcp14">MUST NOT</em> change for the life of the signature.
                                            </li>
                                            <li>Each covered component identifier <em class="bcp14">MUST</em> be either
                                                <span class="nobr">(1) an</span> HTTP field (<a href="#http-fields"
                                                    title="HTTP Fields">Section 2.1</a>) in the signature context or
                                                <span class="nobr">(2) a</span> derived component listed in <a
                                                    href="#derived-components" title="Derived Components">Section
                                                    2.2</a> or in the "HTTP Signature Derived Component Names" registry.
                                            </li>
                                            <li>Signers of a request <em class="bcp14">SHOULD</em> include some or all
                                                of the message control data in the covered components, such as the <span
                                                    class="tt">@method</span>, <span class="tt">@authority</span>, <span
                                                    class="tt">@target-uri</span>, or some combination thereof.</li>
                                            <li>Signers <em class="bcp14">SHOULD</em> include the <span
                                                    class="tt">created</span> signature metadata parameter to indicate
                                                when the signature was created.</li>
                                            <li>The <span class="tt">@signature-params</span> derived component
                                                identifier <em class="bcp14">MUST NOT</em> be present in the list of
                                                covered component identifiers. The derived component is required to
                                                always be the last line in the signature base, ensuring that a signature
                                                always covers its own metadata and the metadata cannot be substituted.
                                            </li>
                                            <li>Further guidance on what to include in this set and in what order is out
                                                of scope for this document.</li>
                                        </ul>
                                    </div>
                                </li>
                                <li>The signer creates the signature base using these parameters and the signature base
                                    creation algorithm (<a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a>).</li>
                                <li>The signer uses the <span class="tt">HTTP_SIGN</span> primitive function to sign the
                                    signature base with the chosen signing algorithm using the key material chosen by
                                    the signer. The <span class="tt">HTTP_SIGN</span> primitive and several concrete
                                    applications of signing algorithms are defined in <a href="#signature-methods"
                                        title="Signature Algorithms">Section 3.3</a>.</li>
                                <li>The byte array output of the signature function is the HTTP message signature output
                                    value to be included in the Signature field as defined in <a
                                        href="#signature-header" title="The Signature HTTP Field">Section 4.2</a>.</li>
                            </ol>
                        </div>
                        <div id="rfc.section.3.1.p.4" class="avoidbreakafter">
                            <p>For example, given the HTTP message and signature parameters in the example in <a
                                    href="#create-sig-input" title="Creating the Signature Base">Section 2.5</a>, the
                                example signature base is signed with the <span class="tt">test-key-rsa-pss</span> key
                                (see <a href="#example-key-rsa-pss-test" title="Example RSA-PSS Key">Appendix B.1.2</a>)
                                and the RSASSA-PSS algorithm described in <a href="#method-rsa-pss-sha512"
                                    title="RSASSA-PSS Using SHA-512">Section 3.3.1</a>, giving the following message
                                signature output value, encoded in Base64:</p>
                        </div>
                        <div id="example-sig-value"></div>
                        <div id="rfc.figure.2">
                            <div>
                                <pre>
NOTE: '\' line wrapping per RFC 8792

HIbjHC5rS0BYaa9v4QfD4193TORw7u9edguPh0AW3dMq9WImrlFrCGUDih47vAxi4L2\
YRZ3XMJc1uOKk/J0ZmZ+wcta4nKIgBkKq0rM9hs3CQyxXGxHLMCy8uqK488o+9jrptQ\
+xFPHK7a9sRL1IXNaagCNN3ZxJsYapFj+JXbmaI5rtAdSfSvzPuBCh+ARHBmWuNo1Uz\
VVdHXrl8ePL4cccqlazIJdC4QEjrF+Sn4IxBQzTZsL9y9TP5FsZYzHvDqbInkTNigBc\
E9cKOYNFCn4D/WM7F6TNuZO9EgtzepLWcjTymlHzK7aXq6Am6sfOrpIC49yXjj3ae6H\
RalVc/g==
</pre>
                            </div>
                        </div>
                        <p class="figure">Figure 2: Non-normative Example Signature Value</p>
                        <div id="rfc.section.3.1.p.5">
                            <p>Note that the RSA-PSS algorithm in use here is non-deterministic, meaning that a
                                different signature value will be created every time the algorithm is run. The signature
                                value provided here can be validated against the given keys, but newly generated
                                signature values are not expected to match the example. See <a
                                    href="#security-nondeterministic"
                                    title="Non-deterministic Signature Primitives">Section 7.3.5</a>.</p>
                        </div>
                    </section>
                    <section id="verify">
                        <h3 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a>&nbsp;<a href="#verify">Verifying a
                                Signature</a></h3>
                        <div id="rfc.section.3.2.p.1">
                            <p>Verification of an HTTP message signature is a process that takes as its input the
                                signature context (including the target message, particularly its Signature and
                                Signature-Input fields) and the requirements for the application. The output of the
                                verification is either a positive verification or an error.</p>
                        </div>
                        <div id="rfc.section.3.2.p.2" class="avoidbreakafter">
                            <p>In order to verify a signature, a verifier <em class="bcp14">MUST</em> apply the
                                following algorithm:</p>
                        </div>
                        <div id="rfc.section.3.2.p.3">
                            <ol type="1">
                                <li>
                                    <div>
                                        <p>Parse the Signature and Signature-Input fields as described in <span
                                                class="nobr">Sections </span><a href="#signature-input-header"
                                                title="The Signature-Input HTTP Field">4.1</a> and <a
                                                href="#signature-header" title="The Signature HTTP Field">4.2</a>, and
                                            extract the signatures to be verified and their labels.</p>
                                    </div>
                                    <div>
                                        <dl>
                                            <dt>11.</dt>
                                            <dd>If there is more than one signature value present, determine which
                                                signature should be processed for this message based on the policy and
                                                configuration of the verifier. If an applicable signature is not found,
                                                produce an error.</dd>
                                            <dt>12.</dt>
                                            <dd>If the chosen Signature field value does not have a corresponding
                                                Signature-Input field value (i.e., one with the same label), produce an
                                                error.</dd>
                                        </dl>
                                    </div>
                                </li>
                                <li>Parse the values of the chosen Signature-Input field as a parameterized Inner List
                                    to get the ordered list of covered components and the signature parameters for the
                                    signature to be verified.</li>
                                <li>Parse the value of the corresponding Signature field to get the byte array value of
                                    the signature to be verified.</li>
                                <li>Examine the signature parameters to confirm that the signature meets the
                                    requirements described in this document, as well as any additional requirements
                                    defined by the application such as which message components are required to be
                                    covered by the signature (<a href="#verify-requirements"
                                        title="Enforcing Application Requirements">Section 3.2.1</a>).</li>
                                <li>Determine the verification key material for this signature. If the key material is
                                    known through external means such as static configuration or external protocol
                                    negotiation, the verifier will use the applicable technique to obtain the key
                                    material from this external knowledge. If the key is identified in the signature
                                    parameters, the verifier will dereference the key identifier to appropriate key
                                    material to use with the signature. The verifier has to determine the
                                    trustworthiness of the key material for the context in which the signature is
                                    presented. If a key is identified that the verifier does not know or trust for this
                                    request or that does not match something preconfigured, the verification <em
                                        class="bcp14">MUST</em> fail.</li>
                                <li>
                                    <div class="avoidbreakafter">
                                        <p>Determine the algorithm to apply for verification:</p>
                                    </div>
                                    <div>
                                        <dl>
                                            <dt>11.</dt>
                                            <dd>Start with the set of allowable algorithms known to the application. If
                                                any of the following steps select an algorithm that is not in this set,
                                                the signature validation fails.</dd>
                                            <dt>12.</dt>
                                            <dd>If the algorithm is known through external means such as static
                                                configuration or external protocol negotiation, the verifier will use
                                                that algorithm.</dd>
                                            <dt>13.</dt>
                                            <dd>If the algorithm can be determined from the keying material, such as
                                                through an algorithm field on the key value itself, the verifier will
                                                use that algorithm.</dd>
                                            <dt>14.</dt>
                                            <dd>If the algorithm is explicitly stated in the signature parameters using
                                                a value from the "HTTP Signature Algorithms" registry, the verifier will
                                                use the referenced algorithm.</dd>
                                            <dt>15.</dt>
                                            <dd>If the algorithm is specified in more than one location (e.g., a
                                                combination of static configuration, the algorithm signature parameter,
                                                and the key material itself), the resolved algorithms <em
                                                    class="bcp14">MUST</em> be the same. If the algorithms are not the
                                                same, the verifier <em class="bcp14">MUST</em> fail the verification.
                                            </dd>
                                        </dl>
                                    </div>
                                </li>
                                <li>Use the received HTTP message and the parsed signature parameters to recreate the
                                    signature base, using the algorithm defined in <a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a>. The value of the <span
                                        class="tt">@signature-params</span> input is the value of the Signature-Input
                                    field for this signature serialized according to the rules described in <a
                                        href="#signature-params" title="Signature Parameters">Section 2.3</a>. Note that
                                    this does not include the signature's label from the Signature-Input field.</li>
                                <li>If the key material is appropriate for the algorithm, apply the appropriate <span
                                        class="tt">HTTP_VERIFY</span> cryptographic verification algorithm to the
                                    signature, recalculated signature base, key material, and signature value. The <span
                                        class="tt">HTTP_VERIFY</span> primitive and several concrete algorithms are
                                    defined in <a href="#signature-methods" title="Signature Algorithms">Section
                                        3.3</a>.</li>
                                <li>The results of the verification algorithm function are the final results of the
                                    cryptographic verification function.</li>
                            </ol>
                        </div>
                        <div id="rfc.section.3.2.p.4">
                            <p>If any of the above steps fail or produce an error, the signature validation fails.</p>
                        </div>
                        <div id="rfc.section.3.2.p.5" class="avoidbreakafter">
                            <p>For example, verifying the signature with the label <span class="tt">sig1</span> of the
                                following message with the <span class="tt">test-key-rsa-pss</span> key (see <a
                                    href="#example-key-rsa-pss-test" title="Example RSA-PSS Key">Appendix B.1.2</a>) and
                                the RSASSA-PSS algorithm described in <a href="#method-rsa-pss-sha512"
                                    title="RSASSA-PSS Using SHA-512">Section 3.3.1</a>:</p>
                        </div>
                        <div id="rfc.section.3.2.p.6">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18
Signature-Input: sig1=("@method" "@authority" "@path" \
  "content-digest" "content-length" "content-type")\
  ;created=1618884473;keyid="test-key-rsa-pss"
Signature: sig1=:HIbjHC5rS0BYaa9v4QfD4193TORw7u9edguPh0AW3dMq9WImrl\
  FrCGUDih47vAxi4L2YRZ3XMJc1uOKk/J0ZmZ+wcta4nKIgBkKq0rM9hs3CQyxXGxH\
  LMCy8uqK488o+9jrptQ+xFPHK7a9sRL1IXNaagCNN3ZxJsYapFj+JXbmaI5rtAdSf\
  SvzPuBCh+ARHBmWuNo1UzVVdHXrl8ePL4cccqlazIJdC4QEjrF+Sn4IxBQzTZsL9y\
  9TP5FsZYzHvDqbInkTNigBcE9cKOYNFCn4D/WM7F6TNuZO9EgtzepLWcjTymlHzK7\
  aXq6Am6sfOrpIC49yXjj3ae6HRalVc/g==:

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.3.2.p.7">
                            <p>With the additional requirements that at least the method, authority, path,
                                content-digest, content-length, and content-type entries be signed, and that the
                                signature creation timestamp be recent enough at the time of verification, the
                                verification passes.</p>
                        </div>
                        <section id="verify-requirements">
                            <h4 id="rfc.section.3.2.1"><a href="#rfc.section.3.2.1">3.2.1.</a>&nbsp;<a
                                    href="#verify-requirements">Enforcing Application Requirements</a></h4>
                            <div id="rfc.section.3.2.1.p.1">
                                <p>The verification requirements specified in this document are intended as a baseline
                                    set of restrictions that are generally applicable to all use cases. Applications
                                    using HTTP message signatures <em class="bcp14">MAY</em> impose requirements above
                                    and beyond those specified by this document, as appropriate for their use case.</p>
                            </div>
                            <div id="rfc.section.3.2.1.p.2" class="avoidbreakafter">
                                <p>Some non-normative examples of additional requirements an application might define
                                    are:</p>
                            </div>
                            <div id="rfc.section.3.2.1.p.3">
                                <ul>
                                    <li>Requiring a specific set of header fields to be signed (e.g., Authorization,
                                        Content-Digest).</li>
                                    <li>Enforcing a maximum signature age from the time of the <span
                                            class="tt">created</span> timestamp.</li>
                                    <li>Rejecting signatures past the expiration time in the <span
                                            class="tt">expires</span> timestamp. Note that the expiration time is a hint
                                        from the signer and that a verifier can always reject a signature ahead of its
                                        expiration time.</li>
                                    <li>Prohibiting certain signature metadata parameters, such as runtime algorithm
                                        signaling with the <span class="tt">alg</span> parameter when the algorithm is
                                        determined from the key information.</li>
                                    <li>Ensuring successful dereferencing of the <span class="tt">keyid</span> parameter
                                        to valid and appropriate key material.</li>
                                    <li>Prohibiting the use of certain algorithms or mandating the use of a specific
                                        algorithm.</li>
                                    <li>Requiring keys to be of a certain size (e.g., 2048 bits vs. 1024 bits).</li>
                                    <li>Enforcing uniqueness of the <span class="tt">nonce</span> parameter.</li>
                                    <li>Requiring an application-specific value for the <span class="tt">tag</span>
                                        parameter.</li>
                                </ul>
                            </div>
                            <div id="rfc.section.3.2.1.p.4">
                                <p>Application-specific requirements are expected and encouraged. When an application
                                    defines additional requirements, it <em class="bcp14">MUST</em> enforce them during
                                    the signature verification process, and signature verification <em
                                        class="bcp14">MUST</em> fail if the signature does not conform to the
                                    application's requirements.</p>
                            </div>
                            <div id="rfc.section.3.2.1.p.5">
                                <p>Applications <em class="bcp14">MUST</em> enforce the requirements defined in this
                                    document. Regardless of use case, applications <em class="bcp14">MUST NOT</em>
                                    accept signatures that do not conform to these requirements.</p>
                            </div>
                        </section>
                    </section>
                    <section id="signature-methods">
                        <h3 id="rfc.section.3.3"><a href="#rfc.section.3.3">3.3.</a>&nbsp;<a
                                href="#signature-methods">Signature Algorithms</a></h3>
                        <div id="rfc.section.3.3.p.1">
                            <p>An HTTP message signature <em class="bcp14">MUST</em> use a cryptographic digital
                                signature or MAC method that is appropriate for the key material, environment, and needs
                                of the signer and verifier. This specification does not strictly limit the available
                                signature algorithms, and any signature algorithm that meets these basic requirements
                                <em class="bcp14">MAY</em> be used by an application of HTTP message signatures.
                            </p>
                        </div>
                        <div id="rfc.section.3.3.p.2" class="avoidbreakafter">
                            <p>For each signing method, <span class="tt">HTTP_SIGN</span> takes as its input the
                                signature base defined in <a href="#create-sig-input"
                                    title="Creating the Signature Base">Section 2.5</a> as a byte array (<span
                                    class="tt">M</span>) and the signing key material (<span class="tt">Ks</span>), and
                                outputs the resultant signature as a byte array (<span class="tt">S</span>):</p>
                        </div>
                        <div id="rfc.section.3.3.p.3">
                            <pre>
HTTP_SIGN (M, Ks)  -&gt;  S
</pre>
                        </div>
                        <div id="rfc.section.3.3.p.4" class="avoidbreakafter">
                            <p>For each verification method, <span class="tt">HTTP_VERIFY</span> takes as its input the
                                regenerated signature base defined in <a href="#create-sig-input"
                                    title="Creating the Signature Base">Section 2.5</a> as a byte array (<span
                                    class="tt">M</span>), the verification key material (<span class="tt">Kv</span>),
                                and the presented signature to be verified as a byte array (<span class="tt">S</span>),
                                and outputs the verification result (<span class="tt">V</span>) as a Boolean:</p>
                        </div>
                        <div id="rfc.section.3.3.p.5">
                            <pre>
HTTP_VERIFY (M, Kv, S) -&gt; V
</pre>
                        </div>
                        <div id="rfc.section.3.3.p.6">
                            <p>The following sections contain several common signature algorithms and demonstrate how
                                these cryptographic primitives map to the <span class="tt">HTTP_SIGN</span> and <span
                                    class="tt">HTTP_VERIFY</span> definitions above. Which method to use can be
                                communicated through the explicit algorithm (<span class="tt">alg</span>) signature
                                parameter (<a href="#signature-params" title="Signature Parameters">Section 2.3</a>), by
                                reference to the key material, or through mutual agreement between the signer and
                                verifier. Signature algorithms selected using the <span class="tt">alg</span> parameter
                                <em class="bcp14">MUST</em> use values from the "HTTP Signature Algorithms" registry (<a
                                    href="#hsa-registry" title="HTTP Signature Algorithms Registry">Section 6.2</a>).
                            </p>
                        </div>
                        <section id="method-rsa-pss-sha512">
                            <h4 id="rfc.section.3.3.1"><a href="#rfc.section.3.3.1">3.3.1.</a>&nbsp;<a
                                    href="#method-rsa-pss-sha512">RSASSA-PSS Using SHA-512</a></h4>
                            <div id="rfc.section.3.3.1.p.1">
                                <p>To sign using this algorithm, the signer applies the <span class="tt">RSASSA-PSS-SIGN
                                        (K, M)</span> function defined in <a href="#RFC8017"><cite
                                            title="PKCS #1: RSA Cryptography Specifications Version 2.2">[RFC8017]</cite></a>
                                    with the signer's private signing key (<span class="tt">K</span>) and the signature
                                    base (<span class="tt">M</span>) (<a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a>). The mask generation
                                    function is <span class="tt">MGF1</span> as specified in <a href="#RFC8017"><cite
                                            title="PKCS #1: RSA Cryptography Specifications Version 2.2">[RFC8017]</cite></a>
                                    with a hash function of SHA-512 <a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>.
                                    The salt length (<span class="tt">sLen</span>) is 64 bytes. The hash function (<span
                                        class="tt">Hash</span>) SHA-512 <a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>
                                    is applied to the signature base to create the digest content to which the digital
                                    signature is applied. The resulting signed content byte array (<span
                                        class="tt">S</span>) is the HTTP message signature output used in <a
                                        href="#sign" title="Creating a Signature">Section 3.1</a>.</p>
                            </div>
                            <div id="rfc.section.3.3.1.p.2">
                                <p>To verify using this algorithm, the verifier applies the <span
                                        class="tt">RSASSA-PSS-VERIFY ((n, e), M, S)</span> function <a
                                        href="#RFC8017"><cite
                                            title="PKCS #1: RSA Cryptography Specifications Version 2.2">[RFC8017]</cite></a>
                                    using the public key portion of the verification key material (<span class="tt">n,
                                        e</span>) and the signature base (<span class="tt">M</span>) recreated as
                                    described in <a href="#verify" title="Verifying a Signature">Section 3.2</a>. The
                                    mask generation function is <span class="tt">MGF1</span> as specified in <a
                                        href="#RFC8017"><cite
                                            title="PKCS #1: RSA Cryptography Specifications Version 2.2">[RFC8017]</cite></a>
                                    with a hash function of SHA-512 <a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>.
                                    The salt length (<span class="tt">sLen</span>) is 64 bytes. The hash function (<span
                                        class="tt">Hash</span>) SHA-512 <a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>
                                    is applied to the signature base to create the digest content to which the
                                    verification function is applied. The verifier extracts the HTTP message signature
                                    to be verified (<span class="tt">S</span>) as described in <a href="#verify"
                                        title="Verifying a Signature">Section 3.2</a>. The results of the verification
                                    function indicate whether the signature presented is valid.</p>
                            </div>
                            <div id="rfc.section.3.3.1.p.3">
                                <p>Note that the output of the RSASSA-PSS algorithm is non-deterministic; therefore, it
                                    is not correct to recalculate a new signature on the signature base and compare the
                                    results to an existing signature. Instead, the verification algorithm defined here
                                    needs to be used. See <a href="#security-nondeterministic"
                                        title="Non-deterministic Signature Primitives">Section 7.3.5</a>.</p>
                            </div>
                            <div id="rfc.section.3.3.1.p.4">
                                <p>The use of this algorithm can be indicated at runtime using the <span
                                        class="tt">rsa-pss-sha512</span> value for the <span class="tt">alg</span>
                                    signature parameter.</p>
                            </div>
                        </section>
                        <section id="method-rsa-v1_5-sha256">
                            <h4 id="rfc.section.3.3.2"><a href="#rfc.section.3.3.2">3.3.2.</a>&nbsp;<a
                                    href="#method-rsa-v1_5-sha256">RSASSA-PKCS1-v1_5 Using SHA-256</a></h4>
                            <div id="rfc.section.3.3.2.p.1">
                                <p>To sign using this algorithm, the signer applies the <span
                                        class="tt">RSASSA-PKCS1-V1_5-SIGN (K, M)</span> function defined in <a
                                        href="#RFC8017"><cite
                                            title="PKCS #1: RSA Cryptography Specifications Version 2.2">[RFC8017]</cite></a>
                                    with the signer's private signing key (<span class="tt">K</span>) and the signature
                                    base (<span class="tt">M</span>) (<a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a>). The hash SHA-256 <a
                                        href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>
                                    is applied to the signature base to create the digest content to which the digital
                                    signature is applied. The resulting signed content byte array (<span
                                        class="tt">S</span>) is the HTTP message signature output used in <a
                                        href="#sign" title="Creating a Signature">Section 3.1</a>.</p>
                            </div>
                            <div id="rfc.section.3.3.2.p.2">
                                <p>To verify using this algorithm, the verifier applies the <span
                                        class="tt">RSASSA-PKCS1-V1_5-VERIFY ((n, e), M, S)</span> function <a
                                        href="#RFC8017"><cite
                                            title="PKCS #1: RSA Cryptography Specifications Version 2.2">[RFC8017]</cite></a>
                                    using the public key portion of the verification key material (<span class="tt">n,
                                        e</span>) and the signature base (<span class="tt">M</span>) recreated as
                                    described in <a href="#verify" title="Verifying a Signature">Section 3.2</a>. The
                                    hash function SHA-256 <a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>
                                    is applied to the signature base to create the digest content to which the
                                    verification function is applied. The verifier extracts the HTTP message signature
                                    to be verified (<span class="tt">S</span>) as described in <a href="#verify"
                                        title="Verifying a Signature">Section 3.2</a>. The results of the verification
                                    function indicate whether the signature presented is valid.</p>
                            </div>
                            <div id="rfc.section.3.3.2.p.3">
                                <p>The use of this algorithm can be indicated at runtime using the <span
                                        class="tt">rsa-v1_5-sha256</span> value for the <span class="tt">alg</span>
                                    signature parameter.</p>
                            </div>
                        </section>
                        <section id="method-hmac-sha256">
                            <h4 id="rfc.section.3.3.3"><a href="#rfc.section.3.3.3">3.3.3.</a>&nbsp;<a
                                    href="#method-hmac-sha256">HMAC Using SHA-256</a></h4>
                            <div id="rfc.section.3.3.3.p.1">
                                <p>To sign and verify using this algorithm, the signer applies the <span
                                        class="tt">HMAC</span> function <a href="#RFC2104"><cite
                                            title="HMAC: Keyed-Hashing for Message Authentication">[RFC2104]</cite></a>
                                    with the shared signing key (<span class="tt">K</span>) and the signature base
                                    (<span class="tt">text</span>) (<a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a>). The hash function SHA-256
                                    <a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>
                                    is applied to the signature base to create the digest content to which the HMAC is
                                    applied, giving the signature result.
                                </p>
                            </div>
                            <div id="rfc.section.3.3.3.p.2">
                                <p>For signing, the resulting value is the HTTP message signature output used in <a
                                        href="#sign" title="Creating a Signature">Section 3.1</a>.</p>
                            </div>
                            <div id="rfc.section.3.3.3.p.3">
                                <p>For verification, the verifier extracts the HTTP message signature to be verified
                                    (<span class="tt">S</span>) as described in <a href="#verify"
                                        title="Verifying a Signature">Section 3.2</a>. The output of the HMAC function
                                    is compared bytewise to the value of the HTTP message signature, and the results of
                                    the comparison determine the validity of the signature presented.</p>
                            </div>
                            <div id="rfc.section.3.3.3.p.4">
                                <p>The use of this algorithm can be indicated at runtime using the <span
                                        class="tt">hmac-sha256</span> value for the <span class="tt">alg</span>
                                    signature parameter.</p>
                            </div>
                        </section>
                        <section id="method-ecdsa-p256-sha256">
                            <h4 id="rfc.section.3.3.4"><a href="#rfc.section.3.3.4">3.3.4.</a>&nbsp;<a
                                    href="#method-ecdsa-p256-sha256">ECDSA Using Curve P-256 DSS and SHA-256</a></h4>
                            <div id="rfc.section.3.3.4.p.1">
                                <p>To sign using this algorithm, the signer applies the <span class="tt">ECDSA</span>
                                    signature algorithm defined in <a href="#FIPS186-5"><cite
                                            title="Digital Signature Standard (DSS)">[FIPS186-5]</cite></a> using curve
                                    P-256 with the signer's private signing key and the signature base (<a
                                        href="#create-sig-input" title="Creating the Signature Base">Section 2.5</a>).
                                    The hash SHA-256 <a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>
                                    is applied to the signature base to create the digest content to which the digital
                                    signature is applied (<span class="tt">M</span>). The signature algorithm returns
                                    two integer values: <span class="tt">r</span> and <span class="tt">s</span>. These
                                    are both encoded as big-endian unsigned integers, zero-padded to 32 octets each.
                                    These encoded values are concatenated into a single 64-octet array consisting of the
                                    encoded value of <span class="tt">r</span> followed by the encoded value of <span
                                        class="tt">s</span>. The resulting concatenation of <span class="tt">(r,
                                        s)</span> is a byte array of the HTTP message signature output used in <a
                                        href="#sign" title="Creating a Signature">Section 3.1</a>.</p>
                            </div>
                            <div id="rfc.section.3.3.4.p.2">
                                <p>To verify using this algorithm, the verifier applies the <span
                                        class="tt">ECDSA</span> signature algorithm defined in <a
                                        href="#FIPS186-5"><cite
                                            title="Digital Signature Standard (DSS)">[FIPS186-5]</cite></a> using the
                                    public key portion of the verification key material and the signature base recreated
                                    as described in <a href="#verify" title="Verifying a Signature">Section 3.2</a>. The
                                    hash function SHA-256 <a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>
                                    is applied to the signature base to create the digest content to which the signature
                                    verification function is applied (<span class="tt">M</span>). The verifier extracts
                                    the HTTP message signature to be verified (<span class="tt">S</span>) as described
                                    in <a href="#verify" title="Verifying a Signature">Section 3.2</a>. This value is a
                                    64-octet array consisting of the encoded values of <span class="tt">r</span> and
                                    <span class="tt">s</span> concatenated in order. These are both encoded as
                                    big-endian unsigned integers, zero-padded to 32 octets each. The resulting signature
                                    value <span class="tt">(r, s)</span> is used as input to the signature verification
                                    function. The results of the verification function indicate whether the signature
                                    presented is valid.
                                </p>
                            </div>
                            <div id="rfc.section.3.3.4.p.3">
                                <p>Note that the output of ECDSA signature algorithms is non-deterministic; therefore,
                                    it is not correct to recalculate a new signature on the signature base and compare
                                    the results to an existing signature. Instead, the verification algorithm defined
                                    here needs to be used. See <a href="#security-nondeterministic"
                                        title="Non-deterministic Signature Primitives">Section 7.3.5</a>.</p>
                            </div>
                            <div id="rfc.section.3.3.4.p.4">
                                <p>The use of this algorithm can be indicated at runtime using the <span
                                        class="tt">ecdsa-p256-sha256</span> value for the <span class="tt">alg</span>
                                    signature parameter.</p>
                            </div>
                        </section>
                        <section id="method-ecdsa-p384-sha384">
                            <h4 id="rfc.section.3.3.5"><a href="#rfc.section.3.3.5">3.3.5.</a>&nbsp;<a
                                    href="#method-ecdsa-p384-sha384">ECDSA Using Curve P-384 DSS and SHA-384</a></h4>
                            <div id="rfc.section.3.3.5.p.1">
                                <p>To sign using this algorithm, the signer applies the <span class="tt">ECDSA</span>
                                    signature algorithm defined in <a href="#FIPS186-5"><cite
                                            title="Digital Signature Standard (DSS)">[FIPS186-5]</cite></a> using curve
                                    P-384 with the signer's private signing key and the signature base (<a
                                        href="#create-sig-input" title="Creating the Signature Base">Section 2.5</a>).
                                    The hash SHA-384 <a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>
                                    is applied to the signature base to create the digest content to which the digital
                                    signature is applied (<span class="tt">M</span>). The signature algorithm returns
                                    two integer values: <span class="tt">r</span> and <span class="tt">s</span>. These
                                    are both encoded as big-endian unsigned integers, zero-padded to 48 octets each.
                                    These encoded values are concatenated into a single 96-octet array consisting of the
                                    encoded value of <span class="tt">r</span> followed by the encoded value of <span
                                        class="tt">s</span>. The resulting concatenation of <span class="tt">(r,
                                        s)</span> is a byte array of the HTTP message signature output used in <a
                                        href="#sign" title="Creating a Signature">Section 3.1</a>.</p>
                            </div>
                            <div id="rfc.section.3.3.5.p.2">
                                <p>To verify using this algorithm, the verifier applies the <span
                                        class="tt">ECDSA</span> signature algorithm defined in <a
                                        href="#FIPS186-5"><cite
                                            title="Digital Signature Standard (DSS)">[FIPS186-5]</cite></a> using the
                                    public key portion of the verification key material and the signature base recreated
                                    as described in <a href="#verify" title="Verifying a Signature">Section 3.2</a>. The
                                    hash function SHA-384 <a href="#RFC6234"><cite
                                            title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">[RFC6234]</cite></a>
                                    is applied to the signature base to create the digest content to which the signature
                                    verification function is applied (<span class="tt">M</span>). The verifier extracts
                                    the HTTP message signature to be verified (<span class="tt">S</span>) as described
                                    in <a href="#verify" title="Verifying a Signature">Section 3.2</a>. This value is a
                                    96-octet array consisting of the encoded values of <span class="tt">r</span> and
                                    <span class="tt">s</span> concatenated in order. These are both encoded as
                                    big-endian unsigned integers, zero-padded to 48 octets each. The resulting signature
                                    value <span class="tt">(r, s)</span> is used as input to the signature verification
                                    function. The results of the verification function indicate whether the signature
                                    presented is valid.
                                </p>
                            </div>
                            <div id="rfc.section.3.3.5.p.3">
                                <p>Note that the output of ECDSA signature algorithms is non-deterministic; therefore,
                                    it is not correct to recalculate a new signature on the signature base and compare
                                    the results to an existing signature. Instead, the verification algorithm defined
                                    here needs to be used. See <a href="#security-nondeterministic"
                                        title="Non-deterministic Signature Primitives">Section 7.3.5</a>.</p>
                            </div>
                            <div id="rfc.section.3.3.5.p.4">
                                <p>The use of this algorithm can be indicated at runtime using the <span
                                        class="tt">ecdsa-p384-sha384</span> value for the <span class="tt">alg</span>
                                    signature parameter.</p>
                            </div>
                        </section>
                        <section id="method-ed25519">
                            <h4 id="rfc.section.3.3.6"><a href="#rfc.section.3.3.6">3.3.6.</a>&nbsp;<a
                                    href="#method-ed25519">EdDSA Using Curve edwards25519</a></h4>
                            <div id="rfc.section.3.3.6.p.1">
                                <p>To sign using this algorithm, the signer applies the <span class="tt">Ed25519</span>
                                    algorithm defined in <a
                                        href="https://www.rfc-editor.org/rfc/rfc8032.html#section-5.1.6">Section
                                        5.1.6</a> of <a href="#RFC8032"><cite
                                            title="Edwards-Curve Digital Signature Algorithm (EdDSA)">[RFC8032]</cite></a>
                                    with the signer's private signing key and the signature base (<a
                                        href="#create-sig-input" title="Creating the Signature Base">Section 2.5</a>).
                                    The signature base is taken as the input message (<span class="tt">M</span>) with no
                                    prehash function. The signature is a 64-octet concatenation of <span
                                        class="tt">R</span> and <span class="tt">S</span> as specified in <a
                                        href="https://www.rfc-editor.org/rfc/rfc8032.html#section-5.1.6">Section
                                        5.1.6</a> of <a href="#RFC8032"><cite
                                            title="Edwards-Curve Digital Signature Algorithm (EdDSA)">[RFC8032]</cite></a>,
                                    and this is taken as a byte array for the HTTP message signature output used in <a
                                        href="#sign" title="Creating a Signature">Section 3.1</a>.</p>
                            </div>
                            <div id="rfc.section.3.3.6.p.2">
                                <p>To verify using this algorithm, the signer applies the <span
                                        class="tt">Ed25519</span> algorithm defined in <a
                                        href="https://www.rfc-editor.org/rfc/rfc8032.html#section-5.1.7">Section
                                        5.1.7</a> of <a href="#RFC8032"><cite
                                            title="Edwards-Curve Digital Signature Algorithm (EdDSA)">[RFC8032]</cite></a>
                                    using the public key portion of the verification key material (<span
                                        class="tt">A</span>) and the signature base recreated as described in <a
                                        href="#verify" title="Verifying a Signature">Section 3.2</a>. The signature base
                                    is taken as the input message (<span class="tt">M</span>) with no prehash function.
                                    The signature to be verified is processed as the 64-octet concatenation of <span
                                        class="tt">R</span> and <span class="tt">S</span> as specified in <a
                                        href="https://www.rfc-editor.org/rfc/rfc8032.html#section-5.1.7">Section
                                        5.1.7</a> of <a href="#RFC8032"><cite
                                            title="Edwards-Curve Digital Signature Algorithm (EdDSA)">[RFC8032]</cite></a>.
                                    The results of the verification function indicate whether the signature presented is
                                    valid.</p>
                            </div>
                            <div id="rfc.section.3.3.6.p.3">
                                <p>The use of this algorithm can be indicated at runtime using the <span
                                        class="tt">ed25519</span> value for the <span class="tt">alg</span> signature
                                    parameter.</p>
                            </div>
                        </section>
                        <section id="method-jose">
                            <h4 id="rfc.section.3.3.7"><a href="#rfc.section.3.3.7">3.3.7.</a>&nbsp;<a
                                    href="#method-jose">JSON Web Signature (JWS) Algorithms</a></h4>
                            <div id="rfc.section.3.3.7.p.1">
                                <p>If the signing algorithm is a JSON Object Signing and Encryption (JOSE) signing
                                    algorithm from the "JSON Web Signature and Encryption Algorithms" registry
                                    established by <a href="#RFC7518"><cite
                                            title="JSON Web Algorithms (JWA)">[RFC7518]</cite></a>, the JWS algorithm
                                    definition determines the signature and hashing algorithms to apply for both signing
                                    and verification.</p>
                            </div>
                            <div id="rfc.section.3.3.7.p.2">
                                <p>For both signing and verification, the HTTP message's signature base (<a
                                        href="#create-sig-input" title="Creating the Signature Base">Section 2.5</a>) is
                                    used as the entire "JWS Signing Input". The JOSE Header <a href="#RFC7515"><cite
                                            title="JSON Web Signature (JWS)">[JWS]</cite></a> <a href="#RFC7517"><cite
                                            title="JSON Web Key (JWK)">[RFC7517]</cite></a> is not used, and the
                                    signature base is not first encoded in Base64 before applying the algorithm. The
                                    output of the JWS Signature is taken as a byte array prior to the Base64url encoding
                                    used in JOSE.</p>
                            </div>
                            <div id="rfc.section.3.3.7.p.3">
                                <p>The JWS algorithm <em class="bcp14">MUST NOT</em> be "<span class="tt">none</span>"
                                    and <em class="bcp14">MUST NOT</em> be any algorithm with a JOSE Implementation
                                    Requirement of "<span class="tt">Prohibited</span>".</p>
                            </div>
                            <div id="rfc.section.3.3.7.p.4">
                                <p>JSON Web Algorithm (JWA) values from the "JSON Web Signature and Encryption
                                    Algorithms" registry are not included as signature parameters. Typically, the JWS
                                    algorithm can be signaled using JSON Web Keys (JWKs) or other mechanisms common to
                                    JOSE implementations. In fact, JWA values are not registered in the "HTTP Signature
                                    Algorithms" registry (<a href="#hsa-registry"
                                        title="HTTP Signature Algorithms Registry">Section 6.2</a>), and so the explicit
                                    <span class="tt">alg</span> signature parameter is not used at all when using JOSE
                                    signing algorithms.
                                </p>
                            </div>
                        </section>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="attach-signature">
                    <h2 id="rfc.section.4" class="np"><a href="#rfc.section.4">4.</a>&nbsp;<a
                            href="#attach-signature">Including a Message Signature in a Message</a></h2>
                    <div id="rfc.section.4.p.1">
                        <p>HTTP message signatures can be included within an HTTP message via the Signature-Input and
                            Signature fields, both defined within this specification.</p>
                    </div>
                    <div id="rfc.section.4.p.2">
                        <p>The Signature-Input field identifies the covered components and parameters that describe how
                            the signature was generated, while the Signature field contains the signature value. Each
                            field <em class="bcp14">MAY</em> contain multiple labeled values.</p>
                    </div>
                    <div id="rfc.section.4.p.3">
                        <p>An HTTP message signature is identified by a label within an HTTP message. This label <em
                                class="bcp14">MUST</em> be unique within a given HTTP message and <em
                                class="bcp14">MUST</em> be used in both the Signature-Input field and the Signature
                            field. The label is chosen by the signer, except where a specific label is dictated by
                            protocol negotiations such as those described in <a href="#request-signature"
                                title="Requesting Signatures">Section 5</a>.</p>
                    </div>
                    <div id="rfc.section.4.p.4">
                        <p>An HTTP message signature <em class="bcp14">MUST</em> use both the Signature-Input field and
                            the Signature field, and each field <em class="bcp14">MUST</em> contain the same labels. The
                            presence of a label in one field but not the other is an error.</p>
                    </div>
                    <section id="signature-input-header">
                        <h3 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a>&nbsp;<a
                                href="#signature-input-header">The Signature-Input HTTP Field</a></h3>
                        <div id="rfc.section.4.1.p.1" class="avoidbreakafter">
                            <p>The Signature-Input field is a Dictionary Structured Field (defined in <a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.2">Section 3.2</a> of <a
                                    href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>)
                                containing the metadata for one or more message signatures generated from components
                                within the HTTP message. Each member describes a single message signature. The member's
                                key is the label that uniquely identifies the message signature within the HTTP message.
                                The member's value is the covered components ordered set serialized as an Inner List,
                                including all signature metadata parameters identified by the label:</p>
                        </div>
                        <div id="rfc.section.4.1.p.2">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig1=("@method" "@target-uri" "@authority" \
  "content-digest" "cache-control");\
  created=1618884475;keyid="test-key-rsa-pss"
</pre>
                        </div>
                        <div id="rfc.section.4.1.p.3">
                            <p>To facilitate signature validation, the Signature-Input field value <em
                                    class="bcp14">MUST</em> contain the same serialized value used in generating the
                                signature base's <span class="tt">@signature-params</span> value defined in <a
                                    href="#signature-params" title="Signature Parameters">Section 2.3</a>. Note that in
                                a Structured Field value, list order and parameter order have to be preserved.</p>
                        </div>
                        <div id="rfc.section.4.1.p.4">
                            <p>The signer <em class="bcp14">MAY</em> include the Signature-Input field as a trailer to
                                facilitate signing a message after its content has been processed by the signer.
                                However, since intermediaries are allowed to drop trailers as per <a
                                    href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>, it is <em
                                    class="bcp14">RECOMMENDED</em> that the Signature-Input field be included only as a
                                header field to avoid signatures being inadvertently stripped from a message.</p>
                        </div>
                        <div id="rfc.section.4.1.p.5">
                            <p>Multiple Signature-Input fields <em class="bcp14">MAY</em> be included in a single HTTP
                                message. The signature labels <em class="bcp14">MUST</em> be unique across all field
                                values.</p>
                        </div>
                    </section>
                    <section id="signature-header">
                        <h3 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a>&nbsp;<a
                                href="#signature-header">The Signature HTTP Field</a></h3>
                        <div id="rfc.section.4.2.p.1" class="avoidbreakafter">
                            <p>The Signature field is a Dictionary Structured Field (defined in <a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.2">Section 3.2</a> of <a
                                    href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>)
                                containing one or more message signatures generated from the signature context of the
                                target message. The member's key is the label that uniquely identifies the message
                                signature within the HTTP message. The member's value is a Byte Sequence containing the
                                signature value for the message signature identified by the label:</p>
                        </div>
                        <div id="rfc.section.4.2.p.2">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature: sig1=:P0wLUszWQjoi54udOtydf9IWTfNhy+r53jGFj9XZuP4uKwxyJo\
  1RSHi+oEF1FuX6O29d+lbxwwBao1BAgadijW+7O/PyezlTnqAOVPWx9GlyntiCiHz\
  C87qmSQjvu1CFyFuWSjdGa3qLYYlNm7pVaJFalQiKWnUaqfT4LyttaXyoyZW84jS8\
  gyarxAiWI97mPXU+OVM64+HVBHmnEsS+lTeIsEQo36T3NFf2CujWARPQg53r58Rmp\
  Z+J9eKR2CD6IJQvacn5A4Ix5BUAVGqlyp8JYm+S/CWJi31PNUjRRCusCVRj05NrxA\
  BNFv3r5S9IXf2fYJK+eyW4AiGVMvMcOg==:
</pre>
                        </div>
                        <div id="rfc.section.4.2.p.3">
                            <p>The signer <em class="bcp14">MAY</em> include the Signature field as a trailer to
                                facilitate signing a message after its content has been processed by the signer.
                                However, since intermediaries are allowed to drop trailers as per <a
                                    href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>, it is <em
                                    class="bcp14">RECOMMENDED</em> that the Signature field be included only as a header
                                field to avoid signatures being inadvertently stripped from a message.</p>
                        </div>
                        <div id="rfc.section.4.2.p.4">
                            <p>Multiple Signature fields <em class="bcp14">MAY</em> be included in a single HTTP
                                message. The signature labels <em class="bcp14">MUST</em> be unique across all field
                                values.</p>
                        </div>
                    </section>
                    <section id="signature-multiple">
                        <h3 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3.</a>&nbsp;<a
                                href="#signature-multiple">Multiple Signatures</a></h3>
                        <div id="rfc.section.4.3.p.1">
                            <p>Multiple distinct signatures <em class="bcp14">MAY</em> be included in a single message.
                                Each distinct signature <em class="bcp14">MUST</em> have a unique label. These multiple
                                signatures could all be added by the same signer, or they could come from several
                                different signers. For example, a signer may include multiple signatures signing the
                                same message components with different keys or algorithms to support verifiers with
                                different capabilities, or a reverse proxy may include information about the client in
                                fields when forwarding the request to a service host, including a signature over the
                                client's original signature values.</p>
                        </div>
                        <div id="rfc.section.4.3.p.2" class="avoidbreakafter">
                            <p>The following non-normative example starts with a signed request from the client. A
                                reverse proxy takes this request and validates the client's signature:</p>
                        </div>
                        <div id="rfc.section.4.3.p.3">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Signature-Input: sig1=("@method" "@authority" "@path" \
  "content-digest" "content-type" "content-length")\
  ;created=1618884475;keyid="test-key-ecc-p256"
Signature: sig1=:X5spyd6CFnAG5QnDyHfqoSNICd+BUP4LYMz2Q0JXlb//4Ijpzp\
  +kve2w4NIyqeAuM7jTDX+sNalzA8ESSaHD3A==:

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.4.3.p.4" class="avoidbreakafter">
                            <p>The proxy then alters the message before forwarding it on to the origin server, changing
                                the target host and adding the Forwarded header field defined in <a
                                    href="#RFC7239"><cite title="Forwarded HTTP Extension">[RFC7239]</cite></a>:</p>
                        </div>
                        <div id="rfc.section.4.3.p.5">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: origin.host.internal.example
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 18
Forwarded: for=192.0.2.123;host=example.com;proto=https
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Signature-Input: sig1=("@method" "@authority" "@path" \
  "content-digest" "content-type" "content-length")\
  ;created=1618884475;keyid="test-key-ecc-p256"
Signature: sig1=:X5spyd6CFnAG5QnDyHfqoSNICd+BUP4LYMz2Q0JXlb//4Ijpzp\
  +kve2w4NIyqeAuM7jTDX+sNalzA8ESSaHD3A==:

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.4.3.p.6" class="avoidbreakafter">
                            <p>The proxy is in a position to validate the incoming client's signature and make its own
                                statement to the origin server about the nature of the request that it is forwarding by
                                adding its own signature over the new message before passing it along to the origin
                                server. The proxy also includes all the elements from the original message that are
                                relevant to the origin server's processing. In many cases, the proxy will want to cover
                                all the same components that were covered by the client's signature, which is the case
                                in the following example. Note that in this example, the proxy is signing over the new
                                authority value, which it has changed. The proxy also adds the Forwarded header field to
                                its own signature value. The proxy identifies its own key and algorithm and, in this
                                example, includes an expiration for the signature to indicate to downstream systems that
                                the proxy will not vouch for this signed message past this short time window. This
                                results in a signature base of:</p>
                        </div>
                        <div id="rfc.section.4.3.p.7">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

"@method": POST
"@authority": origin.host.internal.example
"@path": /foo
"content-digest": sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX\
  +TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"content-type": application/json
"content-length": 18
"forwarded": for=192.0.2.123;host=example.com;proto=https
"@signature-params": ("@method" "@authority" "@path" \
  "content-digest" "content-type" "content-length" "forwarded")\
  ;created=1618884480;keyid="test-key-rsa";alg="rsa-v1_5-sha256"\
  ;expires=1618884540
</pre>
                        </div>
                        <div id="rfc.section.4.3.p.8" class="avoidbreakafter">
                            <p>and a signature output value of:</p>
                        </div>
                        <div id="rfc.section.4.3.p.9">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

S6ZzPXSdAMOPjN/6KXfXWNO/f7V6cHm7BXYUh3YD/fRad4BCaRZxP+JH+8XY1I6+8Cy\
+CM5g92iHgxtRPz+MjniOaYmdkDcnL9cCpXJleXsOckpURl49GwiyUpZ10KHgOEe11s\
x3G2gxI8S0jnxQB+Pu68U9vVcasqOWAEObtNKKZd8tSFu7LB5YAv0RAGhB8tmpv7sFn\
Im9y+7X5kXQfi8NMaZaA8i2ZHwpBdg7a6CMfwnnrtflzvZdXAsD3LH2TwevU+/PBPv0\
B6NMNk93wUs/vfJvye+YuI87HU38lZHowtznbLVdp770I6VHR6WfgS9ddzirrswsE1w\
5o0LV/g==
</pre>
                        </div>
                        <div id="rfc.section.4.3.p.10" class="avoidbreakafter">
                            <p>These values are added to the HTTP request message by the proxy. The original signature
                                is included under the label <span class="tt">sig1</span>, and the reverse proxy's
                                signature is included under the label <span class="tt">proxy_sig</span>. The proxy uses
                                the key <span class="tt">test-key-rsa</span> to create its signature using the <span
                                    class="tt">rsa-v1_5-sha256</span> signature algorithm, while the client's original
                                signature was made using the key <span class="tt">test-key-rsa-pss</span> and an RSA-PSS
                                signature algorithm:</p>
                        </div>
                        <div id="rfc.section.4.3.p.11">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: origin.host.internal.example
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 18
Forwarded: for=192.0.2.123;host=example.com;proto=https
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Signature-Input: sig1=("@method" "@authority" "@path" \
    "content-digest" "content-type" "content-length")\
    ;created=1618884475;keyid="test-key-ecc-p256", \
  proxy_sig=("@method" "@authority" "@path" "content-digest" \
    "content-type" "content-length" "forwarded")\
    ;created=1618884480;keyid="test-key-rsa";alg="rsa-v1_5-sha256"\
    ;expires=1618884540
Signature: sig1=:X5spyd6CFnAG5QnDyHfqoSNICd+BUP4LYMz2Q0JXlb//4Ijpzp\
    +kve2w4NIyqeAuM7jTDX+sNalzA8ESSaHD3A==:, \
  proxy_sig=:S6ZzPXSdAMOPjN/6KXfXWNO/f7V6cHm7BXYUh3YD/fRad4BCaRZxP+\
    JH+8XY1I6+8Cy+CM5g92iHgxtRPz+MjniOaYmdkDcnL9cCpXJleXsOckpURl49G\
    wiyUpZ10KHgOEe11sx3G2gxI8S0jnxQB+Pu68U9vVcasqOWAEObtNKKZd8tSFu7\
    LB5YAv0RAGhB8tmpv7sFnIm9y+7X5kXQfi8NMaZaA8i2ZHwpBdg7a6CMfwnnrtf\
    lzvZdXAsD3LH2TwevU+/PBPv0B6NMNk93wUs/vfJvye+YuI87HU38lZHowtznbL\
    Vdp770I6VHR6WfgS9ddzirrswsE1w5o0LV/g==:

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.4.3.p.12">
                            <p>While the proxy could additionally include the client's Signature field value and
                                Signature-Input fields from the original message in the new signature's covered
                                components, this practice is <em class="bcp14">NOT RECOMMENDED</em> due to known
                                weaknesses in signing signature values as discussed in <a
                                    href="#security-sign-signature" title="Signing Signature Values">Section 7.3.7</a>.
                                The proxy is in a position to validate the client's signature; the changes the proxy
                                makes to the message will invalidate the existing signature when the message is seen by
                                the origin server. In this example, it is possible for the origin server to have
                                additional information in its signature context to account for the change in authority,
                                though this practice requires additional configuration and extra care as discussed in <a
                                    href="#security-context-multiple-signatures"
                                    title="Multiple Message Component Contexts">Section 7.4.4</a>. In other
                                applications, the origin server will not be able to verify the original signature itself
                                but will still want to verify that the proxy has done the appropriate validation of the
                                client's signature. An application that needs to signal successful processing or receipt
                                of a signature would need to carefully specify alternative mechanisms for sending such a
                                signal securely.</p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="request-signature">
                    <h2 id="rfc.section.5" class="np"><a href="#rfc.section.5">5.</a>&nbsp;<a
                            href="#request-signature">Requesting Signatures</a></h2>
                    <div id="rfc.section.5.p.1">
                        <p>While a signer is free to attach a signature to a request or response without prompting, it
                            is often desirable for a potential verifier to signal that it expects a signature from a
                            potential signer using the Accept-Signature field.</p>
                    </div>
                    <div id="rfc.section.5.p.2">
                        <p>When the Accept-Signature field is sent in an HTTP request message, the field indicates that
                            the client desires the server to sign the response using the identified parameters, and the
                            target message is the response to this request. All responses from resources that support
                            such signature negotiation <em class="bcp14">SHOULD</em> either be uncacheable or contain a
                            Vary header field that lists Accept-Signature, in order to prevent a cache from returning a
                            response with a signature intended for a different request.</p>
                    </div>
                    <div id="rfc.section.5.p.3">
                        <p>When the Accept-Signature field is used in an HTTP response message, the field indicates that
                            the server desires the client to sign its next request to the server with the identified
                            parameters, and the target message is the client's next request. The client can choose to
                            also continue signing future requests to the same server in the same way.</p>
                    </div>
                    <div id="rfc.section.5.p.4">
                        <p>The target message of an Accept-Signature field <em class="bcp14">MUST</em> include all
                            labeled signatures indicated in the Accept-Signature field, each covering the same
                            identified components of the Accept-Signature field.</p>
                    </div>
                    <div id="rfc.section.5.p.5">
                        <p>The sender of an Accept-Signature field <em class="bcp14">MUST</em> include only identifiers
                            that are appropriate for the type of the target message. For example, if the target message
                            is a request, the covered components cannot include the <span class="tt">@status</span>
                            component identifier.</p>
                    </div>
                    <section id="accept-signature-header">
                        <h3 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a>&nbsp;<a
                                href="#accept-signature-header">The Accept-Signature Field</a></h3>
                        <div id="rfc.section.5.1.p.1">
                            <p>The Accept-Signature field is a Dictionary Structured Field (defined in <a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.2">Section 3.2</a> of <a
                                    href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>)
                                containing the metadata for one or more requested message signatures to be generated
                                from message components of the target HTTP message. Each member describes a single
                                message signature. The member's key is the label that uniquely identifies the requested
                                message signature within the context of the target HTTP message.</p>
                        </div>
                        <div id="rfc.section.5.1.p.2" class="avoidbreakafter">
                            <p>The member's value is the serialization of the desired covered components of the target
                                message, including any allowed component metadata parameters, using the serialization
                                process defined in <a href="#signature-params" title="Signature Parameters">Section
                                    2.3</a>:</p>
                        </div>
                        <div id="rfc.section.5.1.p.3">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Accept-Signature: sig1=("@method" "@target-uri" "@authority" \
  "content-digest" "cache-control");\
  keyid="test-key-rsa-pss";created;tag="app-123"
</pre>
                        </div>
                        <div id="rfc.section.5.1.p.4">
                            <p>The list of component identifiers indicates the exact set of component identifiers to be
                                included in the requested signature, including all applicable component parameters.</p>
                        </div>
                        <div id="rfc.section.5.1.p.5" class="avoidbreakafter">
                            <p>The signature request <em class="bcp14">MAY</em> include signature metadata parameters
                                that indicate desired behavior for the signer. The following behavior is defined by this
                                specification:</p>
                        </div>
                        <div id="rfc.section.5.1.p.6">
                            <dl>
                                <dt><span class="tt">created</span>:</dt>
                                <dd style="margin-left: 1.5em">The signer is requested to generate and include a
                                    creation time. This parameter has no associated value when sent as a signature
                                    request.</dd>
                                <dt><span class="tt">expires</span>:</dt>
                                <dd style="margin-left: 1.5em">The signer is requested to generate and include an
                                    expiration time. This parameter has no associated value when sent as a signature
                                    request.</dd>
                                <dt><span class="tt">nonce</span>:</dt>
                                <dd style="margin-left: 1.5em">The signer is requested to include the value of this
                                    parameter as the signature <span class="tt">nonce</span> in the target signature.
                                </dd>
                                <dt><span class="tt">alg</span>:</dt>
                                <dd style="margin-left: 1.5em">The signer is requested to use the indicated signature
                                    algorithm from the "HTTP Signature Algorithms" registry to create the target
                                    signature.</dd>
                                <dt><span class="tt">keyid</span>:</dt>
                                <dd style="margin-left: 1.5em">The signer is requested to use the indicated key material
                                    to create the target signature.</dd>
                                <dt><span class="tt">tag</span>:</dt>
                                <dd style="margin-left: 1.5em">The signer is requested to include the value of this
                                    parameter as the signature <span class="tt">tag</span> in the target signature.</dd>
                            </dl>
                        </div>
                    </section>
                    <section id="processing-an-accept-signature">
                        <h3 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2.</a>&nbsp;<a
                                href="#processing-an-accept-signature">Processing an Accept-Signature</a></h3>
                        <div id="rfc.section.5.2.p.1" class="avoidbreakafter">
                            <p>The receiver of an Accept-Signature field fulfills that header as follows:</p>
                        </div>
                        <div id="rfc.section.5.2.p.2">
                            <ol type="1">
                                <li>Parse the field value as a Dictionary.</li>
                                <li>
                                    <div class="avoidbreakafter">
                                        <p>For each member of the Dictionary:</p>
                                    </div>
                                    <div>
                                        <dl>
                                            <dt>11.</dt>
                                            <dd>The key is taken as the label of the output signature as specified in <a
                                                    href="#signature-input-header"
                                                    title="The Signature-Input HTTP Field">Section 4.1</a>.</dd>
                                            <dt>12.</dt>
                                            <dd>Parse the value of the member to obtain the set of covered component
                                                identifiers.</dd>
                                            <dt>13.</dt>
                                            <dd>Determine that the covered components are applicable to the target
                                                message. If not, the process fails and returns an error.</dd>
                                            <dt>14.</dt>
                                            <dd>Process the requested parameters, such as the signing algorithm and key
                                                material. If any requested parameters cannot be fulfilled or if the
                                                requested parameters conflict with those deemed appropriate to the
                                                target message, the process fails and returns an error.</dd>
                                            <dt>15.</dt>
                                            <dd>Select and generate any additional parameters necessary for completing
                                                the signature.</dd>
                                            <dt>16.</dt>
                                            <dd>Create the HTTP message signature over the target message.</dd>
                                            <dt>17.</dt>
                                            <dd>Create the Signature-Input and Signature field values, and associate
                                                them with the label.</dd>
                                        </dl>
                                    </div>
                                </li>
                                <li>Optionally create any additional Signature-Input and Signature field values, with
                                    unique labels not found in the Accept-Signature field.</li>
                                <li>Combine all labeled Signature-Input and Signature field values, and attach both
                                    fields to the target message.</li>
                            </ol>
                        </div>
                        <div id="rfc.section.5.2.p.3">
                            <p>By this process, a signature applied to a target message <em class="bcp14">MUST</em> have
                                the same label, <em class="bcp14">MUST</em> include the same set of covered components,
                                <em class="bcp14">MUST</em> process all requested parameters, and <em
                                    class="bcp14">MAY</em> have additional parameters.
                            </p>
                        </div>
                        <div id="rfc.section.5.2.p.4">
                            <p>The receiver of an Accept-Signature field <em class="bcp14">MAY</em> ignore any signature
                                request that does not fit application parameters.</p>
                        </div>
                        <div id="rfc.section.5.2.p.5">
                            <p>The target message <em class="bcp14">MAY</em> include additional signatures not specified
                                by the Accept-Signature field. For example, to cover additional message components, the
                                signer can create a second signature that includes the additional components as well as
                                the signature output of the requested signature.</p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="iana">
                    <h2 id="rfc.section.6" class="np"><a href="#rfc.section.6">6.</a>&nbsp;<a href="#iana">IANA
                            Considerations</a></h2>
                    <div id="rfc.section.6.p.1">
                        <p>IANA has updated one registry and created four new registries, according to the following
                            sections.</p>
                    </div>
                    <section id="http-field-name-registration">
                        <h3 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a>&nbsp;<a
                                href="#http-field-name-registration">HTTP Field Name Registration</a></h3>
                        <div id="rfc.section.6.1.p.1" class="avoidbreakafter">
                            <p>IANA has updated the entries in the "Hypertext Transfer Protocol (HTTP) Field Name
                                Registry" as follows:</p>
                        </div>
                        <div class="table table-condensed table-striped">
                            <table class="v3 text-center">
                                <caption>Table 1: Updates to the Hypertext Transfer Protocol (HTTP) Field Name Registry
                                </caption>
                                <thead>
                                    <tr>
                                        <th class="text-left" colspan="1" rowspan="1">Field Name</th>
                                        <th class="text-left" colspan="1" rowspan="1">Status</th>
                                        <th class="text-left" colspan="1" rowspan="1">Reference</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">Signature-Input</td>
                                        <td class="text-left" colspan="1" rowspan="1">permanent</td>
                                        <td class="text-left" colspan="1" rowspan="1"><a href="#signature-input-header"
                                                title="The Signature-Input HTTP Field">Section 4.1</a> of RFC 9421</td>
                                    </tr>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">Signature</td>
                                        <td class="text-left" colspan="1" rowspan="1">permanent</td>
                                        <td class="text-left" colspan="1" rowspan="1"><a href="#signature-header"
                                                title="The Signature HTTP Field">Section 4.2</a> of RFC 9421</td>
                                    </tr>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">Accept-Signature</td>
                                        <td class="text-left" colspan="1" rowspan="1">permanent</td>
                                        <td class="text-left" colspan="1" rowspan="1"><a href="#accept-signature-header"
                                                title="The Accept-Signature Field">Section 5.1</a> of RFC 9421</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </section>
                    <section id="hsa-registry">
                        <h3 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2.</a>&nbsp;<a href="#hsa-registry">HTTP
                                Signature Algorithms Registry</a></h3>
                        <div id="rfc.section.6.2.p.1">
                            <p>This document defines HTTP signature algorithms, for which IANA has created and now
                                maintains a new registry titled "HTTP Signature Algorithms". Initial values for this
                                registry are given in <a href="#iana-hsa-contents" title="Initial Contents">Section
                                    6.2.2</a>. Future assignments and modifications to existing assignments are to be
                                made through the Specification Required registration policy <a href="#RFC8126"><cite
                                        title="Guidelines for Writing an IANA Considerations Section in RFCs">[RFC8126]</cite></a>.
                            </p>
                        </div>
                        <div id="rfc.section.6.2.p.2">
                            <p>The algorithms listed in this registry identify some possible cryptographic algorithms
                                for applications to use with this specification, but the entries neither represent an
                                exhaustive list of possible algorithms nor indicate fitness for purpose with any
                                particular application of this specification. An application is free to implement any
                                algorithm that suits its needs, provided the signer and verifier can agree to the
                                parameters of that algorithm in a secure and deterministic fashion. When an application
                                needs to signal the use of a particular algorithm at runtime using the <span
                                    class="tt">alg</span> signature parameter, this registry provides a mapping between
                                the value of that parameter and a particular algorithm. However, the use of the <span
                                    class="tt">alg</span> parameter needs to be treated with caution to avoid various
                                forms of algorithm confusion and substitution attacks, as discussed in <a
                                    href="#security" title="Security Considerations">Section 7</a>.</p>
                        </div>
                        <div id="rfc.section.6.2.p.3">
                            <p>The Status value should reflect standardization status and the broad opinion of relevant
                                interest groups such as the IETF or security-related Standards Development Organizations
                                (SDOs). When an algorithm is first registered, the designated expert (DE) should set the
                                Status field to "Active" if there is consensus for the algorithm to be generally
                                recommended as secure or "Provisional" if the algorithm has not reached that consensus,
                                e.g., for an experimental algorithm. A status of "Provisional" does not mean that the
                                algorithm is known to be insecure but instead indicates that the algorithm has not
                                reached consensus regarding its properties. If at a future time the algorithm as
                                registered is found to have flaws, the registry entry can be updated and the algorithm
                                can be marked as "Deprecated" to indicate that the algorithm has been found to have
                                problems. This status does not preclude an application from using a particular
                                algorithm; rather, it serves to provide a warning regarding possible known issues with
                                an algorithm that need to be considered by the application. The DE can further ensure
                                that the registration includes an explanation and reference for the Status value; this
                                is particularly important for deprecated algorithms.</p>
                        </div>
                        <div id="rfc.section.6.2.p.4" class="avoidbreakafter">
                            <p>The DE is expected to do the following:</p>
                        </div>
                        <div id="rfc.section.6.2.p.5">
                            <ul>
                                <li>Ensure that the algorithms referenced by a registered algorithm identifier are fully
                                    defined with all parameters (e.g., salt, hash, required key length) fixed by the
                                    defining text.</li>
                                <li>Ensure that the algorithm definition fully specifies the <span
                                        class="tt">HTTP_SIGN</span> and <span class="tt">HTTP_VERIFY</span> primitive
                                    functions, including how all defined inputs and outputs map to the underlying
                                    cryptographic algorithm.</li>
                                <li>Reject any registrations that are aliases of existing registrations.</li>
                                <li>Ensure that all registrations follow the template presented in <a
                                        href="#iana-hsa-template" title="Registration Template">Section 6.2.1</a>; this
                                    includes ensuring that the length of the name is not excessive while still being
                                    unique and recognizable.</li>
                            </ul>
                        </div>
                        <div id="rfc.section.6.2.p.6">
                            <p>This specification creates algorithm identifiers by including major parameters in the
                                identifier String in order to make the algorithm name unique and recognizable by
                                developers. However, algorithm identifiers in this registry are to be interpreted as
                                whole String values and not as a combination of parts. That is to say, it is expected
                                that implementors understand <span class="tt">rsa-pss-sha512</span> as referring to one
                                specific algorithm with its hash, mask, and salt values set as defined in the defining
                                text that establishes the identifier in question. Implementors do not parse out the
                                <span class="tt">rsa</span>, <span class="tt">pss</span>, and <span
                                    class="tt">sha512</span> portions of the identifier to determine parameters of the
                                signing algorithm from the String, and the registration of one combination of parameters
                                does not imply the registration of other combinations.
                            </p>
                        </div>
                        <section id="iana-hsa-template">
                            <h4 id="rfc.section.6.2.1"><a href="#rfc.section.6.2.1">6.2.1.</a>&nbsp;<a
                                    href="#iana-hsa-template">Registration Template</a></h4>
                            <div id="rfc.section.6.2.1.p.1">
                                <dl class="nohang">
                                    <dt>Algorithm Name:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>An identifier for the HTTP signature algorithm. The name <em
                                                class="bcp14">MUST</em> be an ASCII string that conforms to the <span
                                                class="tt">sf-string</span> ABNF rule in <a
                                                href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.3.3">Section
                                                3.3.3</a> of <a href="#RFC8941"><cite
                                                    title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>
                                            and <em class="bcp14">SHOULD NOT</em> exceed 20 characters in length. The
                                            identifier <em class="bcp14">MUST</em> be unique within the context of the
                                            registry.</div>
                                    </dd>
                                    <dt>Description:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>A brief description of the algorithm used to sign the signature base.</div>
                                    </dd>
                                    <dt>Status:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>The status of the algorithm. <em class="bcp14">MUST</em> start with one of
                                            the following values and <em class="bcp14">MAY</em> contain additional
                                            explanatory text. The options are:</div>
                                        <div>
                                            <dl>
                                                <dt>"Active":</dt>
                                                <dd style="margin-left: 1.5em">For algorithms without known problems.
                                                    The signature algorithm is fully specified, and its security
                                                    properties are understood.</dd>
                                                <dt>"Provisional":</dt>
                                                <dd style="margin-left: 1.5em">For unproven algorithms. The signature
                                                    algorithm is fully specified, but its security properties are not
                                                    known or proven.</dd>
                                                <dt>"Deprecated":</dt>
                                                <dd style="margin-left: 1.5em">For algorithms with known security
                                                    issues. The signature algorithm is no longer recommended for general
                                                    use and might be insecure or unsafe in some known circumstances.
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                    <dt>Reference:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>Reference to the document or documents that specify the algorithm,
                                            preferably including a URI that can be used to retrieve a copy of the
                                            document(s). An indication of the relevant sections may also be included but
                                            is not required.</div>
                                    </dd>
                                </dl>
                            </div>
                        </section>
                        <section id="iana-hsa-contents">
                            <h4 id="rfc.section.6.2.2"><a href="#rfc.section.6.2.2">6.2.2.</a>&nbsp;<a
                                    href="#iana-hsa-contents">Initial Contents</a></h4>
                            <div id="rfc.section.6.2.2.p.1">
                                <p>The table below contains the initial contents of the "HTTP Signature Algorithms"
                                    registry.</p>
                            </div>
                            <div class="table table-condensed table-striped">
                                <table class="v3 text-center">
                                    <caption>Table 2: Initial Contents of the HTTP Signature Algorithms Registry
                                    </caption>
                                    <thead>
                                        <tr>
                                            <th class="text-left" colspan="1" rowspan="1">Algorithm Name</th>
                                            <th class="text-left" colspan="1" rowspan="1">Description</th>
                                            <th class="text-left" colspan="1" rowspan="1">Status</th>
                                            <th class="text-left" colspan="1" rowspan="1">Reference</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">rsa-pss-sha512</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">RSASSA-PSS using SHA-512</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#method-rsa-pss-sha512"
                                                    title="RSASSA-PSS Using SHA-512">Section 3.3.1</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">rsa-v1_5-sha256</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">RSASSA-PKCS1-v1_5 using
                                                SHA-256</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#method-rsa-v1_5-sha256"
                                                    title="RSASSA-PKCS1-v1_5 Using SHA-256">Section 3.3.2</a> of RFC
                                                9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">hmac-sha256</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">HMAC using SHA-256</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#method-hmac-sha256"
                                                    title="HMAC Using SHA-256">Section 3.3.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">ecdsa-p256-sha256</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">ECDSA using curve P-256 DSS
                                                and SHA-256</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#method-ecdsa-p256-sha256"
                                                    title="ECDSA Using Curve P-256 DSS and SHA-256">Section 3.3.4</a> of
                                                RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">ecdsa-p384-sha384</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">ECDSA using curve P-384 DSS
                                                and SHA-384</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#method-ecdsa-p384-sha384"
                                                    title="ECDSA Using Curve P-384 DSS and SHA-384">Section 3.3.5</a> of
                                                RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">ed25519</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">EdDSA using curve edwards25519
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#method-ed25519"
                                                    title="EdDSA Using Curve edwards25519">Section 3.3.6</a> of RFC 9421
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </section>
                    </section>
                    <section id="param-registry">
                        <h3 id="rfc.section.6.3"><a href="#rfc.section.6.3">6.3.</a>&nbsp;<a href="#param-registry">HTTP
                                Signature Metadata Parameters Registry</a></h3>
                        <div id="rfc.section.6.3.p.1">
                            <p>This document defines the signature parameters structure (<a href="#signature-params"
                                    title="Signature Parameters">Section 2.3</a>), which may have parameters containing
                                metadata about a message signature. IANA has created and now maintains a new registry
                                titled "HTTP Signature Metadata Parameters" to record and maintain the set of parameters
                                defined for use with member values in the signature parameters structure. Initial values
                                for this registry are given in <a href="#iana-param-contents"
                                    title="Initial Contents">Section 6.3.2</a>. Future assignments and modifications to
                                existing assignments are to be made through the Expert Review registration policy <a
                                    href="#RFC8126"><cite
                                        title="Guidelines for Writing an IANA Considerations Section in RFCs">[RFC8126]</cite></a>.
                            </p>
                        </div>
                        <div id="rfc.section.6.3.p.2" class="avoidbreakafter">
                            <p>The DE is expected to do the following:</p>
                        </div>
                        <div id="rfc.section.6.3.p.3">
                            <ul>
                                <li>Ensure that the name follows the template presented in <a
                                        href="#iana-param-template" title="Registration Template">Section 6.3.1</a>;
                                    this includes ensuring that the length of the name is not excessive while still
                                    being unique and recognizable for its defined function.</li>
                                <li>Ensure that the defined functionality is clear and does not conflict with other
                                    registered parameters.</li>
                                <li>Ensure that the definition of the metadata parameter includes its behavior when used
                                    as part of the normal signature process as well as when used in an Accept-Signature
                                    field.</li>
                            </ul>
                        </div>
                        <section id="iana-param-template">
                            <h4 id="rfc.section.6.3.1"><a href="#rfc.section.6.3.1">6.3.1.</a>&nbsp;<a
                                    href="#iana-param-template">Registration Template</a></h4>
                            <div id="rfc.section.6.3.1.p.1">
                                <dl class="nohang">
                                    <dt>Name:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>An identifier for the HTTP signature metadata parameter. The name <em
                                                class="bcp14">MUST</em> be an ASCII string that conforms to the <span
                                                class="tt">key</span> ABNF rule defined in <a
                                                href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.1.2">Section
                                                3.1.2</a> of <a href="#RFC8941"><cite
                                                    title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>
                                            and <em class="bcp14">SHOULD NOT</em> exceed 20 characters in length. The
                                            identifier <em class="bcp14">MUST</em> be unique within the context of the
                                            registry.</div>
                                    </dd>
                                    <dt>Description:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>A brief description of the metadata parameter and what it represents.</div>
                                    </dd>
                                    <dt>Reference:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>Reference to the document or documents that specify the parameter,
                                            preferably including a URI that can be used to retrieve a copy of the
                                            document(s). An indication of the relevant sections may also be included but
                                            is not required.</div>
                                    </dd>
                                </dl>
                            </div>
                        </section>
                        <section id="iana-param-contents">
                            <h4 id="rfc.section.6.3.2"><a href="#rfc.section.6.3.2">6.3.2.</a>&nbsp;<a
                                    href="#iana-param-contents">Initial Contents</a></h4>
                            <div id="rfc.section.6.3.2.p.1">
                                <p>The table below contains the initial contents of the "HTTP Signature Metadata
                                    Parameters" registry. Each row in the table represents a distinct entry in the
                                    registry.</p>
                            </div>
                            <div class="table table-condensed table-striped">
                                <table class="v3 text-center">
                                    <caption>Table 3: Initial Contents of the HTTP Signature Metadata Parameters
                                        Registry</caption>
                                    <thead>
                                        <tr>
                                            <th class="text-left" colspan="1" rowspan="1">Name</th>
                                            <th class="text-left" colspan="1" rowspan="1">Description</th>
                                            <th class="text-left" colspan="1" rowspan="1">Reference</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">alg</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">Explicitly declared signature
                                                algorithm</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#signature-params"
                                                    title="Signature Parameters">Section 2.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">created</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">Timestamp of signature
                                                creation</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#signature-params"
                                                    title="Signature Parameters">Section 2.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">expires</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">Timestamp of proposed
                                                signature expiration</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#signature-params"
                                                    title="Signature Parameters">Section 2.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">keyid</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">Key identifier for the signing
                                                and verification keys used to create this signature</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#signature-params"
                                                    title="Signature Parameters">Section 2.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">nonce</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">A single-use nonce value</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#signature-params"
                                                    title="Signature Parameters">Section 2.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">tag</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">An application-specific tag
                                                for a signature</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#signature-params"
                                                    title="Signature Parameters">Section 2.3</a> of RFC 9421</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </section>
                    </section>
                    <section id="content-registry">
                        <h3 id="rfc.section.6.4"><a href="#rfc.section.6.4">6.4.</a>&nbsp;<a
                                href="#content-registry">HTTP Signature Derived Component Names Registry</a></h3>
                        <div id="rfc.section.6.4.p.1">
                            <p>This document defines a method for canonicalizing HTTP message components, including
                                components that can be derived from the context of the target message outside of the
                                HTTP fields. These derived components are identified by a unique String, known as the
                                component name. Component names for derived components always start with the "at" (@)
                                symbol to distinguish them from HTTP field names. IANA has created and now maintains a
                                new registry titled "HTTP Signature Derived Component Names" to record and maintain the
                                set of non-field component names and the methods used to produce their associated
                                component values. Initial values for this registry are given in <a
                                    href="#iana-content-contents" title="Initial Contents">Section 6.4.2</a>. Future
                                assignments and modifications to existing assignments are to be made through the Expert
                                Review registration policy <a href="#RFC8126"><cite
                                        title="Guidelines for Writing an IANA Considerations Section in RFCs">[RFC8126]</cite></a>.
                            </p>
                        </div>
                        <div id="rfc.section.6.4.p.2" class="avoidbreakafter">
                            <p>The DE is expected to do the following:</p>
                        </div>
                        <div id="rfc.section.6.4.p.3">
                            <ul>
                                <li>Ensure that the name follows the template presented in <a
                                        href="#iana-content-template" title="Registration Template">Section 6.4.1</a>;
                                    this includes ensuring that the length of the name is not excessive while still
                                    being unique and recognizable for its defined function.</li>
                                <li>Ensure that the component value represented by the registration request can be
                                    deterministically derived from the target HTTP message.</li>
                                <li>Ensure that any parameters defined for the registration request are clearly
                                    documented, along with their effects on the component value.</li>
                            </ul>
                        </div>
                        <div id="rfc.section.6.4.p.4">
                            <p>The DE should ensure that a registration is sufficiently distinct from existing derived
                                component definitions to warrant its registration.</p>
                        </div>
                        <div id="rfc.section.6.4.p.5">
                            <p>When setting a registered item's status to "Deprecated", the DE should ensure that a
                                reason for the deprecation is documented, along with instructions for moving away from
                                the deprecated functionality.</p>
                        </div>
                        <section id="iana-content-template">
                            <h4 id="rfc.section.6.4.1"><a href="#rfc.section.6.4.1">6.4.1.</a>&nbsp;<a
                                    href="#iana-content-template">Registration Template</a></h4>
                            <div id="rfc.section.6.4.1.p.1">
                                <dl class="nohang">
                                    <dt>Name:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>A name for the HTTP derived component. The name <em class="bcp14">MUST</em>
                                            begin with the "at" (<span class="tt">@</span>) character followed by an
                                            ASCII string consisting only of lowercase characters (<span
                                                class="tt">"a"</span>-<span class="tt">"z"</span>), digits (<span
                                                class="tt">"0"</span>-<span class="tt">"9"</span>), and hyphens (<span
                                                class="tt">"-"</span>), and <em class="bcp14">SHOULD NOT</em> exceed 20
                                            characters in length. The name <em class="bcp14">MUST</em> be unique within
                                            the context of the registry.</div>
                                    </dd>
                                    <dt>Description:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>A description of the derived component.</div>
                                    </dd>
                                    <dt>Status:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>A brief text description of the status of the algorithm. The description
                                            <em class="bcp14">MUST</em> begin with one of "Active" or "Deprecated" and
                                            <em class="bcp14">MAY</em> provide further context or explanation as to the
                                            reason for the status. A value of "Deprecated" indicates that the derived
                                            component name is no longer recommended for use.
                                        </div>
                                    </dd>
                                    <dt>Target:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>The valid message targets for the derived parameter. <em
                                                class="bcp14">MUST</em> be one of the values "Request", "Response", or
                                            "Request, Response". The semantics of these entries are defined in <a
                                                href="#derived-components" title="Derived Components">Section 2.2</a>.
                                        </div>
                                    </dd>
                                    <dt>Reference:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>Reference to the document or documents that specify the derived component,
                                            preferably including a URI that can be used to retrieve a copy of the
                                            document(s). An indication of the relevant sections may also be included but
                                            is not required.</div>
                                    </dd>
                                </dl>
                            </div>
                        </section>
                        <section id="iana-content-contents">
                            <h4 id="rfc.section.6.4.2"><a href="#rfc.section.6.4.2">6.4.2.</a>&nbsp;<a
                                    href="#iana-content-contents">Initial Contents</a></h4>
                            <div id="rfc.section.6.4.2.p.1">
                                <p>The table below contains the initial contents of the "HTTP Signature Derived
                                    Component Names" registry.</p>
                            </div>
                            <div class="table table-condensed table-striped">
                                <table class="v3 text-center">
                                    <caption>Table 4: Initial Contents of the HTTP Signature Derived Component Names
                                        Registry</caption>
                                    <thead>
                                        <tr>
                                            <th class="text-left" colspan="1" rowspan="1">Name</th>
                                            <th class="text-left" colspan="1" rowspan="1">Description</th>
                                            <th class="text-left" colspan="1" rowspan="1">Status</th>
                                            <th class="text-left" colspan="1" rowspan="1">Target</th>
                                            <th class="text-left" colspan="1" rowspan="1">Reference</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@signature-params</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">Reserved for signature
                                                parameters line in signature base</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request, Response</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#signature-params"
                                                    title="Signature Parameters">Section 2.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@method</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">The HTTP request method</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-method" title="Method">Section 2.2.1</a> of
                                                RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@authority</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">The HTTP authority, or target
                                                host</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-authority" title="Authority">Section
                                                    2.2.3</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@scheme</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">The URI scheme of the request
                                                URI</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-scheme" title="Scheme">Section 2.2.4</a> of
                                                RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@target-uri</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">The full target URI of the
                                                request</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#content-target-uri"
                                                    title="Target URI">Section 2.2.2</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@request-target</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">The request target of the
                                                request</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-target" title="Request Target">Section
                                                    2.2.5</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">@path</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">The full path of the request
                                                URI</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-path" title="Path">Section 2.2.6</a> of RFC
                                                9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">@query</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">The full query of the request
                                                URI</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-query" title="Query">Section 2.2.7</a> of RFC
                                                9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@query-param</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">A single named query parameter
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Request</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-query-param" title="Query Parameters">Section
                                                    2.2.8</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span
                                                    class="tt">@status</span></td>
                                            <td class="text-left" colspan="1" rowspan="1">The status code of the
                                                response</td>
                                            <td class="text-left" colspan="1" rowspan="1">Active</td>
                                            <td class="text-left" colspan="1" rowspan="1">Response</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#content-status-code"
                                                    title="Status Code">Section 2.2.9</a> of RFC 9421</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </section>
                    </section>
                    <section id="component-param-registry">
                        <h3 id="rfc.section.6.5"><a href="#rfc.section.6.5">6.5.</a>&nbsp;<a
                                href="#component-param-registry">HTTP Signature Component Parameters Registry</a></h3>
                        <div id="rfc.section.6.5.p.1">
                            <p>This document defines several kinds of component identifiers, some of which can be
                                parameterized in specific circumstances to provide unique modified behavior. IANA has
                                created and now maintains a new registry titled "HTTP Signature Component Parameters" to
                                record and maintain the set of parameter names, the component identifiers they are
                                associated with, and the modifications these parameters make to the component value.
                                Definitions of parameters <em class="bcp14">MUST</em> define the targets to which they
                                apply (such as specific field types, derived components, or contexts). Initial values
                                for this registry are given in <a href="#iana-component-param-contents"
                                    title="Initial Contents">Section 6.5.2</a>. Future assignments and modifications to
                                existing assignments are to be made through the Expert Review registration policy <a
                                    href="#RFC8126"><cite
                                        title="Guidelines for Writing an IANA Considerations Section in RFCs">[RFC8126]</cite></a>.
                            </p>
                        </div>
                        <div id="rfc.section.6.5.p.2" class="avoidbreakafter">
                            <p>The DE is expected to do the following:</p>
                        </div>
                        <div id="rfc.section.6.5.p.3">
                            <ul>
                                <li>Ensure that the name follows the template presented in <a
                                        href="#iana-component-param-template" title="Registration Template">Section
                                        6.5.1</a>; this includes ensuring that the length of the name is not excessive
                                    while still being unique and recognizable for its defined function.</li>
                                <li>Ensure that the definition of the field sufficiently defines any interactions or
                                    incompatibilities with other existing parameters known at the time of the
                                    registration request.</li>
                                <li>Ensure that the component value defined by the component identifier with the
                                    parameter applied can be deterministically derived from the target HTTP message in
                                    cases where the parameter changes the component value.</li>
                            </ul>
                        </div>
                        <section id="iana-component-param-template">
                            <h4 id="rfc.section.6.5.1"><a href="#rfc.section.6.5.1">6.5.1.</a>&nbsp;<a
                                    href="#iana-component-param-template">Registration Template</a></h4>
                            <div id="rfc.section.6.5.1.p.1">
                                <dl class="nohang">
                                    <dt>Name:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>A name for the parameter. The name <em class="bcp14">MUST</em> be an ASCII
                                            string that conforms to the <span class="tt">key</span> ABNF rule defined in
                                            <a href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.1.2">Section
                                                3.1.2</a> of <a href="#RFC8941"><cite
                                                    title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>
                                            and <em class="bcp14">SHOULD NOT</em> exceed 20 characters in length. The
                                            name <em class="bcp14">MUST</em> be unique within the context of the
                                            registry.
                                        </div>
                                    </dd>
                                    <dt>Description:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>A description of the parameter's function.</div>
                                    </dd>
                                    <dt>Reference:</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>Reference to the document or documents that specify the derived component,
                                            preferably including a URI that can be used to retrieve a copy of the
                                            document(s). An indication of the relevant sections may also be included but
                                            is not required.</div>
                                    </dd>
                                </dl>
                            </div>
                        </section>
                        <section id="iana-component-param-contents">
                            <h4 id="rfc.section.6.5.2"><a href="#rfc.section.6.5.2">6.5.2.</a>&nbsp;<a
                                    href="#iana-component-param-contents">Initial Contents</a></h4>
                            <div id="rfc.section.6.5.2.p.1">
                                <p>The table below contains the initial contents of the "HTTP Signature Component
                                    Parameters" registry.</p>
                            </div>
                            <div class="table table-condensed table-striped">
                                <table class="v3 text-center">
                                    <caption>Table 5: Initial Contents of the HTTP Signature Component Parameters
                                        Registry</caption>
                                    <thead>
                                        <tr>
                                            <th class="text-left" colspan="1" rowspan="1">Name</th>
                                            <th class="text-left" colspan="1" rowspan="1">Description</th>
                                            <th class="text-left" colspan="1" rowspan="1">Reference</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">sf</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">Strict Structured Field
                                                serialization</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#http-field-structured"
                                                    title="Strict Serialization of HTTP Structured Fields">Section
                                                    2.1.1</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">key</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">Single key value of Dictionary
                                                Structured Fields</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#http-field-dictionary"
                                                    title="Dictionary Structured Field Members">Section 2.1.2</a> of RFC
                                                9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">bs</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">Byte Sequence wrapping
                                                indicator</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#http-field-byte-sequence"
                                                    title="Binary-Wrapped HTTP Fields">Section 2.1.3</a> of RFC 9421
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">tr</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">Trailer</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a href="#http-trailer"
                                                    title="Trailer Fields">Section 2.1.4</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">req</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">Related request indicator</td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-response"
                                                    title="Signing Request Components in a Response Message">Section
                                                    2.4</a> of RFC 9421</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" colspan="1" rowspan="1"><span class="tt">name</span>
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1">Single named query parameter
                                            </td>
                                            <td class="text-left" colspan="1" rowspan="1"><a
                                                    href="#content-request-query-param" title="Query Parameters">Section
                                                    2.2.8</a> of RFC 9421</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </section>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="security">
                    <h2 id="rfc.section.7" class="np"><a href="#rfc.section.7">7.</a>&nbsp;<a href="#security">Security
                            Considerations</a></h2>
                    <div id="rfc.section.7.p.1" class="avoidbreakafter">
                        <p>In order for an HTTP message to be considered <em>covered</em> by a signature, all of the
                            following conditions have to be true:</p>
                    </div>
                    <div id="rfc.section.7.p.2">
                        <ul>
                            <li>A signature is expected or allowed on the message by the verifier.</li>
                            <li>The signature exists on the message.</li>
                            <li>The signature is verified against the identified key material and algorithm.</li>
                            <li>The key material and algorithm are appropriate for the context of the message.</li>
                            <li>The signature is within expected time boundaries.</li>
                            <li>The signature covers the expected content, including any critical components.</li>
                            <li>The list of covered components is applicable to the context of the message.</li>
                        </ul>
                    </div>
                    <div id="rfc.section.7.p.3">
                        <p>In addition to the application requirement definitions listed in <a href="#application"
                                title="Application of HTTP Message Signatures">Section 1.4</a>, the following security
                            considerations provide discussion and context regarding the requirements of creating and
                            verifying signatures on HTTP messages.</p>
                    </div>
                    <section id="general-considerations">
                        <h3 id="rfc.section.7.1"><a href="#rfc.section.7.1">7.1.</a>&nbsp;<a
                                href="#general-considerations">General Considerations</a></h3>
                        <section id="security-ignore">
                            <h4 id="rfc.section.7.1.1"><a href="#rfc.section.7.1.1">7.1.1.</a>&nbsp;<a
                                    href="#security-ignore">Skipping Signature Verification</a></h4>
                            <div id="rfc.section.7.1.1.p.1">
                                <p>HTTP message signatures only provide security if the signature is verified by the
                                    verifier. Since the message to which the signature is attached remains a valid HTTP
                                    message without the Signature or Signature-Input fields, it is possible for a
                                    verifier to ignore the output of the verification function and still process the
                                    message. Common reasons for this could be relaxed requirements in a development
                                    environment or a temporary suspension of enforcing verification while debugging an
                                    overall system. Such temporary suspensions are difficult to detect under
                                    positive-example testing, since a good signature will always trigger a valid
                                    response whether or not it has been checked.</p>
                            </div>
                            <div id="rfc.section.7.1.1.p.2">
                                <p>To detect this, verifiers should be tested using both valid and invalid signatures,
                                    ensuring that an invalid signature fails as expected.</p>
                            </div>
                        </section>
                        <section id="security-tls">
                            <h4 id="rfc.section.7.1.2"><a href="#rfc.section.7.1.2">7.1.2.</a>&nbsp;<a
                                    href="#security-tls">Use of TLS</a></h4>
                            <div id="rfc.section.7.1.2.p.1">
                                <p>The use of HTTP message signatures does not negate the need for TLS or its equivalent
                                    to protect information in transit. Message signatures provide message integrity over
                                    the covered message components but do not provide any confidentiality for
                                    communication between parties.</p>
                            </div>
                            <div id="rfc.section.7.1.2.p.2">
                                <p>TLS provides such confidentiality between the TLS endpoints. As part of this, TLS
                                    also protects the signature data itself from being captured by an attacker. This is
                                    an important step in preventing signature replay (<a href="#security-replay"
                                        title="Signature Replay">Section 7.2.2</a>).</p>
                            </div>
                            <div id="rfc.section.7.1.2.p.3">
                                <p>When TLS is used, it needs to be deployed according to the recommendations provided
                                    in <a href="#BCP195">[BCP195]</a>.</p>
                            </div>
                        </section>
                    </section>
                    <section id="message-processing-and-selection">
                        <h3 id="rfc.section.7.2"><a href="#rfc.section.7.2">7.2.</a>&nbsp;<a
                                href="#message-processing-and-selection">Message Processing and Selection</a></h3>
                        <section id="security-coverage">
                            <h4 id="rfc.section.7.2.1"><a href="#rfc.section.7.2.1">7.2.1.</a>&nbsp;<a
                                    href="#security-coverage">Insufficient Coverage</a></h4>
                            <div id="rfc.section.7.2.1.p.1">
                                <p>Any portions of the message not covered by the signature are susceptible to
                                    modification by an attacker without affecting the signature. An attacker can take
                                    advantage of this by introducing or modifying a header field or other message
                                    component that will change the processing of the message but will not be covered by
                                    the signature. Such an altered message would still pass signature verification, but
                                    when the verifier processes the message as a whole, the unsigned content injected by
                                    the attacker would subvert the trust conveyed by the valid signature and change the
                                    outcome of processing the message.</p>
                            </div>
                            <div id="rfc.section.7.2.1.p.2">
                                <p>To combat this, an application of this specification should require as much of the
                                    message as possible to be signed, within the limits of the application and
                                    deployment. The verifier should only trust message components that have been signed.
                                    Verifiers could also strip out any sensitive unsigned portions of the message before
                                    processing of the message continues.</p>
                            </div>
                        </section>
                        <section id="security-replay">
                            <h4 id="rfc.section.7.2.2"><a href="#rfc.section.7.2.2">7.2.2.</a>&nbsp;<a
                                    href="#security-replay">Signature Replay</a></h4>
                            <div id="rfc.section.7.2.2.p.1">
                                <p>Since HTTP message signatures allow sub-portions of the HTTP message to be signed, it
                                    is possible for two different HTTP messages to validate against the same signature.
                                    The most extreme form of this would be a signature over no message components. If
                                    such a signature were intercepted, it could be replayed at will by an attacker,
                                    attached to any HTTP message. Even with sufficient component coverage, a given
                                    signature could be applied to two similar HTTP messages, allowing a message to be
                                    replayed by an attacker with the signature intact.</p>
                            </div>
                            <div id="rfc.section.7.2.2.p.2">
                                <p>To counteract these kinds of attacks, it's first important for the signer to cover
                                    sufficient portions of the message to differentiate it from other messages. In
                                    addition, the signature can use the <span class="tt">nonce</span> signature
                                    parameter to provide a per-message unique value to allow the verifier to detect
                                    replay of the signature itself if a nonce value is repeated. Furthermore, the signer
                                    can provide a timestamp for when the signature was created and a time at which the
                                    signer considers the signature to be expired, limiting the utility of a captured
                                    signature value.</p>
                            </div>
                            <div id="rfc.section.7.2.2.p.3">
                                <p>If a verifier wants to trigger a new signature from a signer, it can send the
                                    Accept-Signature header field with a new <span class="tt">nonce</span> parameter. An
                                    attacker that is simply replaying a signature would not be able to generate a new
                                    signature with the chosen nonce value.</p>
                            </div>
                        </section>
                        <section id="security-components">
                            <h4 id="rfc.section.7.2.3"><a href="#rfc.section.7.2.3">7.2.3.</a>&nbsp;<a
                                    href="#security-components">Choosing Message Components</a></h4>
                            <div id="rfc.section.7.2.3.p.1">
                                <p>Applications of HTTP message signatures need to decide which message components will
                                    be covered by the signature. Depending on the application, some components could be
                                    expected to be changed by intermediaries prior to the signature's verification. If
                                    these components are covered, such changes would, by design, break the signature.
                                </p>
                            </div>
                            <div id="rfc.section.7.2.3.p.2">
                                <p>However, this document allows for flexibility in determining which components are
                                    signed precisely so that a given application can choose the appropriate portions of
                                    the message that need to be signed, avoiding problematic components. For example, a
                                    web application framework that relies on rewriting query parameters might avoid
                                    using the <span class="tt">@query</span> derived component in favor of sub-indexing
                                    the query value using <span class="tt">@query-param</span> derived components
                                    instead.</p>
                            </div>
                            <div id="rfc.section.7.2.3.p.3">
                                <p>Some components are expected to be changed by intermediaries and ought not to be
                                    signed under most circumstances. The Via and Forwarded header fields, for example,
                                    are expected to be manipulated by proxies and other middleboxes, including replacing
                                    or entirely dropping existing values. These fields should not be covered by the
                                    signature, except in very limited and tightly coupled scenarios.</p>
                            </div>
                            <div id="rfc.section.7.2.3.p.4">
                                <p>Additional considerations for choosing signature aspects are discussed in <a
                                        href="#application" title="Application of HTTP Message Signatures">Section
                                        1.4</a>.</p>
                            </div>
                        </section>
                        <section id="security-not-fields">
                            <h4 id="rfc.section.7.2.4"><a href="#rfc.section.7.2.4">7.2.4.</a>&nbsp;<a
                                    href="#security-not-fields">Choosing Signature Parameters and Derived Components
                                    over HTTP Fields</a></h4>
                            <div id="rfc.section.7.2.4.p.1" class="avoidbreakafter">
                                <p>Some HTTP fields have values and interpretations that are similar to HTTP signature
                                    parameters or derived components. In most cases, it is more desirable to sign the
                                    non-field alternative. In particular, the following fields should usually not be
                                    included in the signature unless the application specifically requires it:</p>
                            </div>
                            <div id="rfc.section.7.2.4.p.2">
                                <dl>
                                    <dt>"date"</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>The Date header field value represents the timestamp of the HTTP message.
                                            However, the creation time of the signature itself is encoded in the <span
                                                class="tt">created</span> signature parameter. These two values can be
                                            different, depending on how the signature and the HTTP message are created
                                            and serialized. Applications processing signatures for valid time windows
                                            should use the <span class="tt">created</span> signature parameter for such
                                            calculations. An application could also put limits on how much skew there is
                                            between the Date field and the <span class="tt">created</span> signature
                                            parameter, in order to limit the application of a generated signature to
                                            different HTTP messages. See also <span class="nobr">Sections </span><a
                                                href="#security-replay" title="Signature Replay">7.2.2</a> and <a
                                                href="#security-coverage" title="Insufficient Coverage">7.2.1</a>.</div>
                                    </dd>
                                    <dt>"host"</dt>
                                    <dd style="margin-left: 1.5em">
                                        <div>The Host header field is specific to HTTP/1.1, and its functionality is
                                            subsumed by the <span class="tt">@authority</span> derived component,
                                            defined in <a href="#content-request-authority" title="Authority">Section
                                                2.2.3</a>. In order to preserve the value across different HTTP
                                            versions, applications should always use the <span
                                                class="tt">@authority</span> derived component. See also <a
                                                href="#security-versions"
                                                title="HTTP Versions and Component Ambiguity">Section 7.5.4</a>.</div>
                                    </dd>
                                </dl>
                            </div>
                        </section>
                        <section id="security-labels">
                            <h4 id="rfc.section.7.2.5"><a href="#rfc.section.7.2.5">7.2.5.</a>&nbsp;<a
                                    href="#security-labels">Signature Labels</a></h4>
                            <div id="rfc.section.7.2.5.p.1">
                                <p>HTTP message signature values are identified in the Signature and Signature-Input
                                    field values by unique labels. These labels are chosen only when attaching the
                                    signature values to the message and are not accounted for during the signing
                                    process. An intermediary is allowed to relabel an existing signature when processing
                                    the message.</p>
                            </div>
                            <div id="rfc.section.7.2.5.p.2">
                                <p>Therefore, applications should not rely on specific labels being present, and
                                    applications should not put semantic meaning on the labels themselves. Instead,
                                    additional signature parameters can be used to convey whatever additional meaning is
                                    required to be attached to, and covered by, the signature. In particular, the <span
                                        class="tt">tag</span> parameter can be used to define an application-specific
                                    value as described in <a href="#security-signature-tag"
                                        title="Collision of Application-Specific Signature Tag">Section 7.2.7</a>.</p>
                            </div>
                        </section>
                        <section id="security-multiple">
                            <h4 id="rfc.section.7.2.6"><a href="#rfc.section.7.2.6">7.2.6.</a>&nbsp;<a
                                    href="#security-multiple">Multiple Signature Confusion</a></h4>
                            <div id="rfc.section.7.2.6.p.1">
                                <p>Since multiple signatures can be applied to one message (<a
                                        href="#signature-multiple" title="Multiple Signatures">Section 4.3</a>), it is
                                    possible for an attacker to attach their own signature to a captured message without
                                    modifying existing signatures. This new signature could be completely valid based on
                                    the attacker's key, or it could be an invalid signature for any number of reasons.
                                    Each of these situations needs to be accounted for.</p>
                            </div>
                            <div id="rfc.section.7.2.6.p.2">
                                <p>A verifier processing a set of valid signatures needs to account for all of the
                                    signers, identified by the signing keys. Only signatures from expected signers
                                    should be accepted, regardless of the cryptographic validity of the signature
                                    itself.</p>
                            </div>
                            <div id="rfc.section.7.2.6.p.3">
                                <p>A verifier processing a set of signatures on a message also needs to determine what
                                    to do when one or more of the signatures are not valid. If a message is accepted
                                    when at least one signature is valid, then a verifier could drop all invalid
                                    signatures from the request before processing the message further. Alternatively, if
                                    the verifier rejects a message for a single invalid signature, an attacker could use
                                    this to deny service to otherwise valid messages by injecting invalid signatures
                                    alongside the valid signatures.</p>
                            </div>
                        </section>
                        <section id="security-signature-tag">
                            <h4 id="rfc.section.7.2.7"><a href="#rfc.section.7.2.7">7.2.7.</a>&nbsp;<a
                                    href="#security-signature-tag">Collision of Application-Specific Signature Tag</a>
                            </h4>
                            <div id="rfc.section.7.2.7.p.1">
                                <p>Multiple applications and protocols could apply HTTP signatures on the same message
                                    simultaneously. In fact, this is a desired feature in many circumstances; see <a
                                        href="#signature-multiple" title="Multiple Signatures">Section 4.3</a>. A naive
                                    verifier could become confused while processing multiple signatures, either
                                    accepting or rejecting a message based on an unrelated or irrelevant signature. In
                                    order to help an application select which signatures apply to its own processing,
                                    the application can declare a specific value for the <span class="tt">tag</span>
                                    signature parameter as defined in <a href="#signature-params"
                                        title="Signature Parameters">Section 2.3</a>. For example, a signature targeting
                                    an application gateway could require <span class="tt">tag="app-gateway"</span> as
                                    part of the signature parameters for that application.</p>
                            </div>
                            <div id="rfc.section.7.2.7.p.2">
                                <p>The use of the <span class="tt">tag</span> parameter does not prevent an attacker
                                    from also using the same value as a target application, since the parameter's value
                                    is public and otherwise unrestricted. As a consequence, a verifier should only use a
                                    value of the <span class="tt">tag</span> parameter to limit which signatures to
                                    check. Each signature still needs to be examined by the verifier to ensure that
                                    sufficient coverage is provided, as discussed in <a href="#security-coverage"
                                        title="Insufficient Coverage">Section 7.2.1</a>.</p>
                            </div>
                        </section>
                        <section id="security-message-content">
                            <h4 id="rfc.section.7.2.8"><a href="#rfc.section.7.2.8">7.2.8.</a>&nbsp;<a
                                    href="#security-message-content">Message Content</a></h4>
                            <div id="rfc.section.7.2.8.p.1">
                                <p>On its own, this specification does not provide coverage for the content of an HTTP
                                    message under the signature, in either a request or a response. However, <a
                                        href="#RFC9530"><cite title="Digest Fields">[DIGEST]</cite></a> defines a set of
                                    fields that allow a cryptographic digest of the content to be represented in a
                                    field. Once this field is created, it can be included just like any other field as
                                    defined in <a href="#http-fields" title="HTTP Fields">Section 2.1</a>.</p>
                            </div>
                            <div id="rfc.section.7.2.8.p.2" class="avoidbreakafter">
                                <p>For example, in the following response message:</p>
                            </div>
                            <div id="rfc.section.7.2.8.p.3">
                                <pre class="text">
HTTP/1.1 200 OK
Content-Type: application/json

{"hello": "world"}
</pre>
                            </div>
                            <div id="rfc.section.7.2.8.p.4" class="avoidbreakafter">
                                <p>The digest of the content can be added to the Content-Digest field as follows:</p>
                            </div>
                            <div id="rfc.section.7.2.8.p.5">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 200 OK
Content-Type: application/json
Content-Digest: \
  sha-256=:X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=:

{"hello": "world"}
</pre>
                            </div>
                            <div id="rfc.section.7.2.8.p.6" class="avoidbreakafter">
                                <p>This field can be included in a signature base just like any other field along with
                                    the basic signature parameters:</p>
                            </div>
                            <div id="rfc.section.7.2.8.p.7">
                                <pre>
"@status": 200
"content-digest": \
  sha-256=:X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=:
"@signature-input": ("@status" "content-digest")
</pre>
                            </div>
                            <div id="rfc.section.7.2.8.p.8">
                                <p>From here, the signing process proceeds as usual.</p>
                            </div>
                            <div id="rfc.section.7.2.8.p.9">
                                <p>Upon verification, it is important that the verifier validate not only the signature
                                    but also the value of the Content-Digest field itself against the actual received
                                    content. Unless the verifier performs this step, it would be possible for an
                                    attacker to substitute the message content but leave the Content-Digest field value
                                    untouched to pass the signature. Since only the field value is covered by the
                                    signature directly, checking only the signature is not sufficient protection against
                                    such a substitution attack.</p>
                            </div>
                            <div id="rfc.section.7.2.8.p.10">
                                <p>As discussed in <a href="#RFC9530"><cite title="Digest Fields">[DIGEST]</cite></a>,
                                    the value of the Content-Digest field is dependent on the content encoding of the
                                    message. If an intermediary changes the content encoding, the resulting
                                    Content-Digest value would change. This would in turn invalidate the signature. Any
                                    intermediary performing such an action would need to apply a new signature with the
                                    updated Content-Digest field value, similar to the reverse proxy use case discussed
                                    in <a href="#signature-multiple" title="Multiple Signatures">Section 4.3</a>.</p>
                            </div>
                            <div id="rfc.section.7.2.8.p.11">
                                <p>Applications that make use of the <span class="tt">req</span> parameter (<a
                                        href="#content-request-response"
                                        title="Signing Request Components in a Response Message">Section 2.4</a>) also
                                    need to be aware of the limitations of this functionality. Specifically, if a client
                                    does not include something like a Content-Digest header field in the request, the
                                    server is unable to include a signature that covers the request's content.</p>
                            </div>
                        </section>
                    </section>
                    <section id="cryptographic-considerations">
                        <h3 id="rfc.section.7.3"><a href="#rfc.section.7.3">7.3.</a>&nbsp;<a
                                href="#cryptographic-considerations">Cryptographic Considerations</a></h3>
                        <section id="security-collision">
                            <h4 id="rfc.section.7.3.1"><a href="#rfc.section.7.3.1">7.3.1.</a>&nbsp;<a
                                    href="#security-collision">Cryptography and Signature Collision</a></h4>
                            <div id="rfc.section.7.3.1.p.1">
                                <p>This document does not define any of its own cryptographic primitives and instead
                                    relies on other specifications to define such elements. If the signature algorithm
                                    or key used to process the signature base is vulnerable to any attacks, the
                                    resulting signature will also be susceptible to these same attacks.</p>
                            </div>
                            <div id="rfc.section.7.3.1.p.2">
                                <p>A common attack against signature systems is to force a signature collision, where
                                    the same signature value successfully verifies against multiple different inputs.
                                    Since this specification relies on reconstruction of the signature base from an HTTP
                                    message and the list of components signed is fixed in the signature, it is difficult
                                    but not impossible for an attacker to effect such a collision. An attacker would
                                    need to manipulate the HTTP message and its covered message components in order to
                                    make the collision effective.</p>
                            </div>
                            <div id="rfc.section.7.3.1.p.3">
                                <p>To counter this, only vetted keys and signature algorithms should be used to sign
                                    HTTP messages. The "HTTP Signature Algorithms" registry is one source of trusted
                                    signature algorithms for applications to apply to their messages.</p>
                            </div>
                            <div id="rfc.section.7.3.1.p.4">
                                <p>While it is possible for an attacker to substitute the signature parameters value or
                                    the signature value separately, the signature base generation algorithm (<a
                                        href="#create-sig-input" title="Creating the Signature Base">Section 2.5</a>)
                                    always covers the signature parameters as the final value in the signature base
                                    using a deterministic serialization method. This step strongly binds the signature
                                    base with the signature value in a way that makes it much more difficult for an
                                    attacker to perform a partial substitution on the signature base.</p>
                            </div>
                        </section>
                        <section id="security-keys">
                            <h4 id="rfc.section.7.3.2"><a href="#rfc.section.7.3.2">7.3.2.</a>&nbsp;<a
                                    href="#security-keys">Key Theft</a></h4>
                            <div id="rfc.section.7.3.2.p.1">
                                <p>A foundational assumption of signature-based cryptographic systems is that the
                                    signing key is not compromised by an attacker. If the keys used to sign the message
                                    are exfiltrated or stolen, the attacker will be able to generate their own
                                    signatures using those keys. As a consequence, signers have to protect any signing
                                    key material from exfiltration, capture, and use by an attacker.</p>
                            </div>
                            <div id="rfc.section.7.3.2.p.2">
                                <p>To combat this, signers can rotate keys over time to limit the amount of time that
                                    stolen keys are useful. Signers can also use key escrow and storage systems to limit
                                    the attack surface against keys. Furthermore, the use of asymmetric signing
                                    algorithms exposes key material less than the use of symmetric signing algorithms
                                    (<a href="#security-symmetric" title="Symmetric Cryptography">Section 7.3.3</a>).
                                </p>
                            </div>
                        </section>
                        <section id="security-symmetric">
                            <h4 id="rfc.section.7.3.3"><a href="#rfc.section.7.3.3">7.3.3.</a>&nbsp;<a
                                    href="#security-symmetric">Symmetric Cryptography</a></h4>
                            <div id="rfc.section.7.3.3.p.1">
                                <p>This document allows both asymmetric and symmetric cryptography to be applied to HTTP
                                    messages. By their nature, symmetric cryptographic methods require the same key
                                    material to be known by both the signer and verifier. This effectively means that a
                                    verifier is capable of generating a valid signature, since they have access to the
                                    same key material. An attacker that is able to compromise a verifier would be able
                                    to then impersonate a signer.</p>
                            </div>
                            <div id="rfc.section.7.3.3.p.2">
                                <p>Where possible, asymmetric methods or secure key agreement mechanisms should be used
                                    in order to avoid this type of attack. When symmetric methods are used, distribution
                                    of the key material needs to be protected by the overall system. One technique for
                                    this is the use of separate cryptographic modules that separate the verification
                                    process (and therefore the key material) from other code, minimizing the vulnerable
                                    attack surface. Another technique is the use of key derivation functions that allow
                                    the signer and verifier to agree on unique keys for each message without having to
                                    share the key values directly.</p>
                            </div>
                            <div id="rfc.section.7.3.3.p.3">
                                <p>Additionally, if symmetric algorithms are allowed within a system, special care must
                                    be taken to avoid key downgrade attacks (<a href="#security-keydowngrade"
                                        title="Key and Algorithm Specification Downgrades">Section 7.3.6</a>).</p>
                            </div>
                        </section>
                        <section id="security-keymixup">
                            <h4 id="rfc.section.7.3.4"><a href="#rfc.section.7.3.4">7.3.4.</a>&nbsp;<a
                                    href="#security-keymixup">Key Specification Mixup</a></h4>
                            <div id="rfc.section.7.3.4.p.1">
                                <p>The existence of a valid signature on an HTTP message is not sufficient to prove that
                                    the message has been signed by the appropriate party. It is up to the verifier to
                                    ensure that a given key and algorithm are appropriate for the message in question.
                                    If the verifier does not perform such a step, an attacker could substitute their own
                                    signature using their own key on a message and force a verifier to accept and
                                    process it. To combat this, the verifier needs to ensure not only that the signature
                                    can be validated for a message but that the key and algorithm used are appropriate.
                                </p>
                            </div>
                        </section>
                        <section id="security-nondeterministic">
                            <h4 id="rfc.section.7.3.5"><a href="#rfc.section.7.3.5">7.3.5.</a>&nbsp;<a
                                    href="#security-nondeterministic">Non-deterministic Signature Primitives</a></h4>
                            <div id="rfc.section.7.3.5.p.1">
                                <p>Some cryptographic primitives, such as RSA-PSS and ECDSA, have non-deterministic
                                    outputs, which include some amount of entropy within the algorithm. For such
                                    algorithms, multiple signatures generated in succession will not match. A lazy
                                    implementation of a verifier could ignore this distinction and simply check for the
                                    same value being created by re-signing the signature base. Such an implementation
                                    would work for deterministic algorithms such as HMAC and EdDSA but fail to verify
                                    valid signatures made using non-deterministic algorithms. It is therefore important
                                    that a verifier always use the correctly defined verification function for the
                                    algorithm in question and not do a simple comparison.</p>
                            </div>
                        </section>
                        <section id="security-keydowngrade">
                            <h4 id="rfc.section.7.3.6"><a href="#rfc.section.7.3.6">7.3.6.</a>&nbsp;<a
                                    href="#security-keydowngrade">Key and Algorithm Specification Downgrades</a></h4>
                            <div id="rfc.section.7.3.6.p.1">
                                <p>Applications of this specification need to protect against key specification
                                    downgrade attacks. For example, the same RSA key can be used for both RSA-PSS and
                                    RSA v1.5 signatures. If an application expects a key to only be used with RSA-PSS,
                                    it needs to reject signatures for any key that uses the weaker RSA 1.5
                                    specification.</p>
                            </div>
                            <div id="rfc.section.7.3.6.p.2">
                                <p>Another example of a downgrade attack would be when an asymmetric algorithm is
                                    expected, such as RSA-PSS, but an attacker substitutes a signature using a symmetric
                                    algorithm, such as HMAC. A naive verifier implementation could use the value of the
                                    public RSA key as the input to the HMAC verification function. Since the public key
                                    is known to the attacker, this would allow the attacker to create a valid HMAC
                                    signature against this known key. To prevent this, the verifier needs to ensure that
                                    both the key material and the algorithm are appropriate for the usage in question.
                                    Additionally, while this specification does allow runtime specification of the
                                    algorithm using the <span class="tt">alg</span> signature parameter, applications
                                    are encouraged to use other mechanisms such as static configuration or a
                                    higher-protocol-level algorithm specification instead, preventing an attacker from
                                    substituting the algorithm specified.</p>
                            </div>
                        </section>
                        <section id="security-sign-signature">
                            <h4 id="rfc.section.7.3.7"><a href="#rfc.section.7.3.7">7.3.7.</a>&nbsp;<a
                                    href="#security-sign-signature">Signing Signature Values</a></h4>
                            <div id="rfc.section.7.3.7.p.1">
                                <p>When applying the <span class="tt">req</span> parameter (<a
                                        href="#content-request-response"
                                        title="Signing Request Components in a Response Message">Section 2.4</a>) or
                                    multiple signatures (<a href="#signature-multiple"
                                        title="Multiple Signatures">Section 4.3</a>) to a message, it is possible to
                                    sign the value of an existing Signature field, thereby covering the bytes of the
                                    existing signature output in the new signature's value. While it would seem that
                                    this practice would transitively cover the components under the original signature
                                    in a verifiable fashion, the attacks described in <a href="#JACKSON2019"><cite
                                            title="Seems Legit: Automated Analysis of Subtle Attacks on Protocols that Use Signatures">[JACKSON2019]</cite></a>
                                    can be used to impersonate a signature output value on an unrelated message.</p>
                            </div>
                            <div id="rfc.section.7.3.7.p.2">
                                <p>In this example, Alice intends to send a signed request to Bob, and Bob wants to
                                    provide a signed response to Alice that includes a cryptographic proof that Bob is
                                    responding to Alice's incoming message. Mallory wants to intercept this traffic and
                                    replace Alice's message with her own, without Alice being aware that the
                                    interception has taken place.</p>
                            </div>
                            <div id="rfc.section.7.3.7.p.3">
                                <ol type="1">
                                    <li>Alice creates a message <span class="tt">Req_A</span> and applies a signature
                                        <span class="tt">Sig_A</span> using her private key <span
                                            class="tt">Key_A_Sign</span>.
                                    </li>
                                    <li>Alice believes she is sending <span class="tt">Req_A</span> to Bob.</li>
                                    <li>Mallory intercepts <span class="tt">Req_A</span> and reads the value <span
                                            class="tt">Sig_A</span> from this message.</li>
                                    <li>Mallory generates a different message <span class="tt">Req_M</span> to send to
                                        Bob instead.</li>
                                    <li>Mallory crafts a signing key <span class="tt">Key_M_Sign</span> such that she
                                        can create a valid signature <span class="tt">Sig_M</span> over her request
                                        <span class="tt">Req_M</span> using this key, but the byte value of <span
                                            class="tt">Sig_M</span> exactly equals that of <span
                                            class="tt">Sig_A</span>.
                                    </li>
                                    <li>Mallory sends <span class="tt">Req_M</span> with <span class="tt">Sig_M</span>
                                        to Bob.</li>
                                    <li>Bob validates <span class="tt">Sig_M</span> against Mallory's verification key
                                        <span class="tt">Key_M_Verify</span>. At no time does Bob think that he's
                                        responding to Alice.
                                    </li>
                                    <li>Bob responds with response message <span class="tt">Res_B</span> to <span
                                            class="tt">Req_M</span> and creates signature <span class="tt">Sig_B</span>
                                        over this message using his key <span class="tt">Key_B_Sign</span>. Bob includes
                                        the value of <span class="tt">Sig_M</span> under <span class="tt">Sig_B</span>'s
                                        covered components but does not include anything else from the request message.
                                    </li>
                                    <li>Mallory receives the response <span class="tt">Res_B</span> from Bob, including
                                        the signature <span class="tt">Sig_B</span> value. Mallory replays this response
                                        to Alice.</li>
                                    <li>Alice reads <span class="tt">Res_B</span> from Mallory and verifies <span
                                            class="tt">Sig_B</span> using Bob's verification key <span
                                            class="tt">Key_B_Verify</span>. Alice includes the bytes of her original
                                        signature <span class="tt">Sig_A</span> in the signature base, and the signature
                                        verifies.</li>
                                    <li>Alice is led to believe that Bob has responded to her message and believes she
                                        has cryptographic proof of this happening, but in fact Bob responded to
                                        Mallory's malicious request and Alice is none the wiser.</li>
                                </ol>
                            </div>
                            <div id="rfc.section.7.3.7.p.4">
                                <p>To mitigate this, Bob can sign more portions of the request message than just the
                                    Signature field, in order to more fully differentiate Alice's message from
                                    Mallory's. Applications using this feature, particularly for non-repudiation
                                    purposes, can stipulate that any components required in the original signature also
                                    be covered separately in the second signature. For signed messages, requiring
                                    coverage of the corresponding Signature-Input field of the first signature ensures
                                    that unique items such as nonces and timestamps are also covered sufficiently by the
                                    second signature.</p>
                            </div>
                        </section>
                    </section>
                    <section id="matching-covered-components-to-message">
                        <h3 id="rfc.section.7.4"><a href="#rfc.section.7.4">7.4.</a>&nbsp;<a
                                href="#matching-covered-components-to-message">Matching Signature Parameters to the
                                Target Message</a></h3>
                        <section id="security-modify">
                            <h4 id="rfc.section.7.4.1"><a href="#rfc.section.7.4.1">7.4.1.</a>&nbsp;<a
                                    href="#security-modify">Modification of Required Message Parameters</a></h4>
                            <div id="rfc.section.7.4.1.p.1">
                                <p>An attacker could effectively deny a service by modifying an otherwise benign
                                    signature parameter or signed message component. While rejecting a modified message
                                    is the desired behavior, consistently failing signatures could lead to <span
                                        class="nobr">(1) the</span> verifier turning off signature checking in order to
                                    make systems work again (see <a href="#security-ignore"
                                        title="Skipping Signature Verification">Section 7.1.1</a>) or <span
                                        class="nobr">(2) the</span> application minimizing the requirements related to
                                    the signed component.</p>
                            </div>
                            <div id="rfc.section.7.4.1.p.2">
                                <p>If such failures are common within an application, the signer and verifier should
                                    compare their generated signature bases with each other to determine which part of
                                    the message is being modified. If an expected modification is found, the signer and
                                    verifier can agree on an alternative set of requirements that will pass. However,
                                    the signer and verifier should not remove the requirement to sign the modified
                                    component when it is suspected that an attacker is modifying the component.</p>
                            </div>
                        </section>
                        <section id="security-mismatch">
                            <h4 id="rfc.section.7.4.2"><a href="#rfc.section.7.4.2">7.4.2.</a>&nbsp;<a
                                    href="#security-mismatch">Matching Values of Covered Components to Values in the
                                    Target Message</a></h4>
                            <div id="rfc.section.7.4.2.p.1">
                                <p>The verifier needs to make sure that the signed message components match those in the
                                    message itself. For example, the <span class="tt">@method</span> derived component
                                    requires that the value within the signature base be the same as the HTTP method
                                    used when presenting this message. This specification encourages this by requiring
                                    the verifier to derive the signature base from the message, but lazy caching or
                                    conveyance of a raw signature base to a processing subsystem could lead to
                                    downstream verifiers accepting a message that does not match the presented
                                    signature.</p>
                            </div>
                            <div id="rfc.section.7.4.2.p.2">
                                <p>To counter this, the component that generates the signature base needs to be trusted
                                    by both the signer and verifier within a system.</p>
                            </div>
                        </section>
                        <section id="security-message-component-context">
                            <h4 id="rfc.section.7.4.3"><a href="#rfc.section.7.4.3">7.4.3.</a>&nbsp;<a
                                    href="#security-message-component-context">Message Component Source and Context</a>
                            </h4>
                            <div id="rfc.section.7.4.3.p.1">
                                <p>The signature context for deriving message component values includes the target HTTP
                                    message itself, any associated messages (such as the request that triggered a
                                    response), and additional information that the signer or verifier has access to.
                                    Both signers and verifiers need to carefully consider the source of all information
                                    when creating component values for the signature base and take care not to take
                                    information from untrusted sources. Otherwise, an attacker could leverage such a
                                    loosely defined message context to inject their own values into the signature base
                                    string, overriding or corrupting the intended values.</p>
                            </div>
                            <div id="rfc.section.7.4.3.p.2">
                                <p>For example, in most situations, the target URI of the message is as defined in <a
                                        href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>, <a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-7.1">Section 7.1</a>.
                                    However, let's say that there is an application that requires signing of the <span
                                        class="tt">@authority</span> of the incoming request, but the application doing
                                    the processing is behind a reverse proxy. Such an application would expect a change
                                    in the <span class="tt">@authority</span> value, and it could be configured to know
                                    the external target URI as seen by the client on the other side of the proxy. This
                                    application would use this configured value as its target URI for the purposes of
                                    deriving message component values such as <span class="tt">@authority</span> instead
                                    of using the target URI of the incoming message.</p>
                            </div>
                            <div id="rfc.section.7.4.3.p.3">
                                <p>This approach is not without problems, as a misconfigured system could accept signed
                                    requests intended for different components in the system. For this scenario, an
                                    intermediary could instead add its own signature to be verified by the application
                                    directly, as demonstrated in <a href="#signature-multiple"
                                        title="Multiple Signatures">Section 4.3</a>. This alternative approach requires
                                    a more active intermediary but relies less on the target application knowing
                                    external configuration values.</p>
                            </div>
                            <div id="rfc.section.7.4.3.p.4">
                                <p>As another example, <a href="#content-request-response"
                                        title="Signing Request Components in a Response Message">Section 2.4</a> defines
                                    a method for signing response messages and also including portions of the request
                                    message that triggered the response. In this case, the context for component value
                                    calculation is the combination of the response and request messages, not just the
                                    single message to which the signature is applied. For this feature, the <span
                                        class="tt">req</span> flag allows both signers to explicitly signal which part
                                    of the context is being sourced for a component identifier's value. Implementations
                                    need to ensure that only the intended message is being referred to for each
                                    component; otherwise, an attacker could attempt to subvert a signature by
                                    manipulating one side or the other.</p>
                            </div>
                        </section>
                        <section id="security-context-multiple-signatures">
                            <h4 id="rfc.section.7.4.4"><a href="#rfc.section.7.4.4">7.4.4.</a>&nbsp;<a
                                    href="#security-context-multiple-signatures">Multiple Message Component Contexts</a>
                            </h4>
                            <div id="rfc.section.7.4.4.p.1">
                                <p>It is possible that the context for deriving message component values could be
                                    distinct for each signature present within a single message. This is particularly
                                    the case when proxies mutate messages and include signatures over the mutated
                                    values, in addition to any existing signatures. For example, a reverse proxy can
                                    replace a public hostname in a request to a service with the hostname for the
                                    individual service host to which it is forwarding the request. If both the client
                                    and the reverse proxy add signatures covering <span class="tt">@authority</span>,
                                    the service host will see two signatures on the request, each signing different
                                    values for the <span class="tt">@authority</span> message component, reflecting the
                                    change to that component as the message made its way from the client to the service
                                    host.</p>
                            </div>
                            <div id="rfc.section.7.4.4.p.2">
                                <p>In such a case, it's common for the internal service to verify only one of the
                                    signatures or to use externally configured information, as discussed in <a
                                        href="#security-message-component-context"
                                        title="Message Component Source and Context">Section 7.4.3</a>. However, a
                                    verifier processing both signatures has to use a different message component context
                                    for each signature, since the component value for the <span
                                        class="tt">@authority</span> component will be different for each signature.
                                    Verifiers like this need to be aware of both the reverse proxy's context for
                                    incoming messages and the target service's context for the message coming from the
                                    reverse proxy. The verifier needs to take particular care to apply the correct
                                    context to the correct signature; otherwise, an attacker could use knowledge of this
                                    complex setup to confuse the inputs to the verifier.</p>
                            </div>
                            <div id="rfc.section.7.4.4.p.3">
                                <p>Such verifiers also need to ensure that any differences in message component contexts
                                    between signatures are expected and permitted. For example, in the above scenario,
                                    the reverse proxy could include the original hostname in a Forwarded header field
                                    and could sign <span class="tt">@authority</span>, forwarded, and the client's entry
                                    in the Signature field. The verifier can use the hostname from the Forwarded header
                                    field to confirm that the hostname was transformed as expected.</p>
                            </div>
                        </section>
                    </section>
                    <section id="http-processing">
                        <h3 id="rfc.section.7.5"><a href="#rfc.section.7.5">7.5.</a>&nbsp;<a
                                href="#http-processing">HTTP Processing</a></h3>
                        <section id="security-lazy-header-parser">
                            <h4 id="rfc.section.7.5.1"><a href="#rfc.section.7.5.1">7.5.1.</a>&nbsp;<a
                                    href="#security-lazy-header-parser">Processing Invalid HTTP Field Names as Derived
                                    Component Names</a></h4>
                            <div id="rfc.section.7.5.1.p.1">
                                <p>The definition of HTTP field names does not allow for the use of the <span
                                        class="tt">@</span> character anywhere in the name. As such, since all derived
                                    component names start with the <span class="tt">@</span> character, these namespaces
                                    should be completely separate. However, some HTTP implementations are not
                                    sufficiently strict about the characters accepted in HTTP field names. In such
                                    implementations, a sender (or attacker) could inject a header field starting with an
                                    <span class="tt">@</span> character and have it passed through to the application
                                    code. These invalid header fields could be used to override a portion of the derived
                                    message content and substitute an arbitrary value, providing a potential place for
                                    an attacker to mount a signature collision (<a href="#security-collision"
                                        title="Cryptography and Signature Collision">Section 7.3.1</a>) attack or other
                                    functional substitution attack (such as using the signature from a GET request on a
                                    crafted POST request).
                                </p>
                            </div>
                            <div id="rfc.section.7.5.1.p.2">
                                <p>To combat this, when selecting values for a message component, if the component name
                                    starts with the <span class="tt">@</span> character, it needs to be processed as a
                                    derived component and never processed as an HTTP field. Only if the component name
                                    does not start with the <span class="tt">@</span> character can it be taken from the
                                    fields of the message. The algorithm discussed in <a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a> provides a safe order of
                                    operations.</p>
                            </div>
                        </section>
                        <section id="security-field-values">
                            <h4 id="rfc.section.7.5.2"><a href="#rfc.section.7.5.2">7.5.2.</a>&nbsp;<a
                                    href="#security-field-values">Semantically Equivalent Field Values</a></h4>
                            <div id="rfc.section.7.5.2.p.1">
                                <p>The signature base generation algorithm (<a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a>) uses the value of an HTTP
                                    field as its component value. In the common case, this amounts to taking the actual
                                    bytes of the field value as the component value for both the signer and verifier.
                                    However, some field values allow for transformation of the values in semantically
                                    equivalent ways that alter the bytes used in the value itself. For example, a field
                                    definition can declare some or all of its values to be case insensitive or to have
                                    special handling of internal whitespace characters. Other fields have expected
                                    transformations from intermediaries, such as the removal of comments in the Via
                                    header field. In such cases, a verifier could be tripped up by using the equivalent
                                    transformed field value, which would differ from the byte value used by the signer.
                                    The verifier would have a difficult time finding this class of errors, since the
                                    value of the field is still acceptable for the application but the actual bytes
                                    required by the signature base would not match.</p>
                            </div>
                            <div id="rfc.section.7.5.2.p.2">
                                <p>When processing such fields, the signer and verifier have to agree on how to handle
                                    such transformations, if at all. One option is to not sign problematic fields, but
                                    care must be taken to ensure that there is still sufficient signature coverage (<a
                                        href="#security-coverage" title="Insufficient Coverage">Section 7.2.1</a>) for
                                    the application. Another option is to define an application-specific
                                    canonicalization value for the field before it is added to the HTTP message, such as
                                    to always remove internal comments before signing or to always transform values to
                                    lowercase. Since these transformations are applied prior to the field being used as
                                    input to the signature base generation algorithm, the signature base will still
                                    simply contain the byte value of the field as it appears within the message. If the
                                    transformations were to be applied after the value is extracted from the message but
                                    before it is added to the signature base, different attack surfaces such as value
                                    substitution attacks could be launched against the application. All
                                    application-specific additional rules are outside the scope of this specification,
                                    and by their very nature these transformations would harm interoperability of the
                                    implementation outside of this specific application. It is recommended that
                                    applications avoid the use of such additional rules wherever possible.</p>
                            </div>
                        </section>
                        <section id="security-structured">
                            <h4 id="rfc.section.7.5.3"><a href="#rfc.section.7.5.3">7.5.3.</a>&nbsp;<a
                                    href="#security-structured">Parsing Structured Field Values</a></h4>
                            <div id="rfc.section.7.5.3.p.1">
                                <p>Several parts of this specification rely on the parsing of Structured Field values <a
                                        href="#RFC8941"><cite
                                            title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a> --
                                    in particular, strict serialization of HTTP Structured Field values (<a
                                        href="#http-field-structured"
                                        title="Strict Serialization of HTTP Structured Fields">Section 2.1.1</a>),
                                    referencing members of a Dictionary Structured Field (<a
                                        href="#http-field-dictionary"
                                        title="Dictionary Structured Field Members">Section 2.1.2</a>), and processing
                                    the <span class="tt">@signature-input</span> value when verifying a signature (<a
                                        href="#verify" title="Verifying a Signature">Section 3.2</a>). While Structured
                                    Field values are designed to be relatively simple to parse, a naive or broken
                                    implementation of such a parser could lead to subtle attack surfaces being exposed
                                    in the implementation.</p>
                            </div>
                            <div id="rfc.section.7.5.3.p.2">
                                <p>For example, if a buggy parser of the <span class="tt">@signature-input</span> value
                                    does not enforce proper closing of quotes around string values within the list of
                                    component identifiers, an attacker could take advantage of this and inject
                                    additional content into the signature base through manipulating the Signature-Input
                                    field value on a message.</p>
                            </div>
                            <div id="rfc.section.7.5.3.p.3">
                                <p>To counteract this, implementations should use fully compliant and trusted parsers
                                    for all Structured Field processing, on both the signer side and the verifier side.
                                </p>
                            </div>
                        </section>
                        <section id="security-versions">
                            <h4 id="rfc.section.7.5.4"><a href="#rfc.section.7.5.4">7.5.4.</a>&nbsp;<a
                                    href="#security-versions">HTTP Versions and Component Ambiguity</a></h4>
                            <div id="rfc.section.7.5.4.p.1">
                                <p>Some message components are expressed in different ways across HTTP versions. For
                                    example, the authority of the request target is sent using the Host header field in
                                    HTTP/1.1 but with the <span class="tt">:authority</span> pseudo-header in HTTP/2. If
                                    a signer sends an HTTP/1.1 message and signs the Host header field but the message
                                    is translated to HTTP/2 before it reaches the verifier, the signature will not
                                    validate, as the Host header field could be dropped.</p>
                            </div>
                            <div id="rfc.section.7.5.4.p.2">
                                <p>It is for this reason that HTTP message signatures define a set of derived components
                                    that define a single way to get the value in question, such as the <span
                                        class="tt">@authority</span> derived component (<a
                                        href="#content-request-authority" title="Authority">Section 2.2.3</a>) in lieu
                                    of the Host header field. Applications should therefore prefer derived components
                                    for such options where possible.</p>
                            </div>
                        </section>
                        <section id="security-canonicalization">
                            <h4 id="rfc.section.7.5.5"><a href="#rfc.section.7.5.5">7.5.5.</a>&nbsp;<a
                                    href="#security-canonicalization">Canonicalization Attacks</a></h4>
                            <div id="rfc.section.7.5.5.p.1">
                                <p>Any ambiguity in the generation of the signature base could provide an attacker with
                                    leverage to substitute or break a signature on a message. Some message component
                                    values, particularly HTTP field values, are potentially susceptible to broken
                                    implementations that could lead to unexpected and insecure behavior. Naive
                                    implementations of this specification might implement HTTP field processing by
                                    taking the single value of a field and using it as the direct component value
                                    without processing it appropriately.</p>
                            </div>
                            <div id="rfc.section.7.5.5.p.2">
                                <p>For example, if the handling of <span class="tt">obs-fold</span> field values does
                                    not remove the internal line folding and whitespace, additional newlines could be
                                    introduced into the signature base by the signer, providing a potential place for an
                                    attacker to mount a signature collision (<a href="#security-collision"
                                        title="Cryptography and Signature Collision">Section 7.3.1</a>) attack.
                                    Alternatively, if header fields that appear multiple times are not joined into a
                                    single string value, as required by this specification, similar attacks can be
                                    mounted, as a signed component value would show up in the signature base more than
                                    once and could be substituted or otherwise attacked in this way.</p>
                            </div>
                            <div id="rfc.section.7.5.5.p.3">
                                <p>To counter this, the entire field value processing algorithm needs to be implemented
                                    by all implementations of signers and verifiers.</p>
                            </div>
                        </section>
                        <section id="security-non-list">
                            <h4 id="rfc.section.7.5.6"><a href="#rfc.section.7.5.6">7.5.6.</a>&nbsp;<a
                                    href="#security-non-list">Non-List Field Values</a></h4>
                            <div id="rfc.section.7.5.6.p.1">
                                <p>When an HTTP field occurs multiple times in a single message, these values need to be
                                    combined into a single one-line string value to be included in the HTTP signature
                                    base, as described in <a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a>. Not all HTTP fields can be
                                    combined into a single value in this way and still be a valid value for the field.
                                    For the purposes of generating the signature base, the message component value is
                                    never meant to be read back out of the signature base string or used in the
                                    application. Therefore, it is considered best practice to treat the signature base
                                    generation algorithm separately from processing the field values by the application,
                                    particularly for fields that are known to have this property. If the field values
                                    that are being signed do not validate, the signed message should also be rejected.
                                </p>
                            </div>
                            <div id="rfc.section.7.5.6.p.2" class="avoidbreakafter">
                                <p>If an HTTP field allows for unquoted commas within its values, combining multiple
                                    field values can lead to a situation where two semantically different messages
                                    produce the same line in a signature base. For example, take the following
                                    hypothetical header field with an internal comma in its syntax, here used to define
                                    two separate lists of values:</p>
                            </div>
                            <div id="rfc.section.7.5.6.p.3">
                                <pre class="text">
Example-Header: value, with, lots
Example-Header: of, commas
</pre>
                            </div>
                            <div id="rfc.section.7.5.6.p.4" class="avoidbreakafter">
                                <p>For this header field, sending all of these values as a single field value results in
                                    a single list of values:</p>
                            </div>
                            <div id="rfc.section.7.5.6.p.5">
                                <pre class="text">
Example-Header: value, with, lots, of, commas
</pre>
                            </div>
                            <div id="rfc.section.7.5.6.p.6" class="avoidbreakafter">
                                <p>Both of these messages would create the following line in the signature base:</p>
                            </div>
                            <div id="rfc.section.7.5.6.p.7">
                                <pre>
"example-header": value, with, lots, of, commas
</pre>
                            </div>
                            <div id="rfc.section.7.5.6.p.8">
                                <p>Since two semantically distinct inputs can create the same output in the signature
                                    base, special care has to be taken when handling such values.</p>
                            </div>
                            <div id="rfc.section.7.5.6.p.9">
                                <p>Specifically, the Set-Cookie field <a href="#RFC6265"><cite
                                            title="HTTP State Management Mechanism">[COOKIE]</cite></a> defines an
                                    internal syntax that does not conform to the List syntax provided in <a
                                        href="#RFC8941"><cite
                                            title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>. In
                                    particular, some portions allow unquoted commas, and the field is typically sent as
                                    multiple separate field lines with distinct values when sending multiple cookies.
                                    When multiple Set-Cookie fields are sent in the same message, it is not generally
                                    possible to combine these into a single line and be able to parse and use the
                                    results, as discussed in <a href="#RFC9110"><cite
                                            title="HTTP Semantics">[HTTP]</cite></a>, <a
                                        href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.3">Section 5.3</a>.
                                    Therefore, all the cookies need to be processed from their separate field values,
                                    without being combined, while the signature base needs to be processed from the
                                    special combined value generated solely for this purpose. If the cookie value is
                                    invalid, the signed message ought to be rejected, as this is a possible padding
                                    attack as described in <a href="#security-multiple-fields"
                                        title="Padding Attacks with Multiple Field Values">Section 7.5.7</a>.</p>
                            </div>
                            <div id="rfc.section.7.5.6.p.10">
                                <p>To deal with this, an application can choose to limit signing of problematic fields
                                    like Set-Cookie, such as including the field in a signature only when a single field
                                    value is present and the results would be unambiguous. Similar caution needs to be
                                    taken with all fields that could have non-deterministic mappings into the signature
                                    base. Signers can also make use of the <span class="tt">bs</span> parameter to armor
                                    such fields, as described in <a href="#http-field-byte-sequence"
                                        title="Binary-Wrapped HTTP Fields">Section 2.1.3</a>.</p>
                            </div>
                        </section>
                        <section id="security-multiple-fields">
                            <h4 id="rfc.section.7.5.7"><a href="#rfc.section.7.5.7">7.5.7.</a>&nbsp;<a
                                    href="#security-multiple-fields">Padding Attacks with Multiple Field Values</a></h4>
                            <div id="rfc.section.7.5.7.p.1">
                                <p>Since HTTP field values need to be combined into a single string value to be included
                                    in the HTTP signature base (see <a href="#create-sig-input"
                                        title="Creating the Signature Base">Section 2.5</a>), it is possible for an
                                    attacker to inject an additional value for a given field and add this to the
                                    signature base of the verifier.</p>
                            </div>
                            <div id="rfc.section.7.5.7.p.2">
                                <p>In most circumstances, this causes the signature validation to fail as expected,
                                    since the new signature base value will not match the one used by the signer to
                                    create the signature. However, it is theoretically possible for the attacker to
                                    inject both a garbage value into a field and a desired value into another field in
                                    order to force a particular input. This is a variation of the collision attack
                                    described in <a href="#security-collision"
                                        title="Cryptography and Signature Collision">Section 7.3.1</a>, where the
                                    attacker accomplishes their change in the message by adding to existing field
                                    values.</p>
                            </div>
                            <div id="rfc.section.7.5.7.p.3">
                                <p>To counter this, an application needs to validate the content of the fields covered
                                    in the signature in addition to ensuring that the signature itself validates. With
                                    such protections, the attacker's padding attack would be rejected by the field value
                                    processor, even in the case where the attacker could force a signature collision.
                                </p>
                            </div>
                        </section>
                        <section id="security-query-elements">
                            <h4 id="rfc.section.7.5.8"><a href="#rfc.section.7.5.8">7.5.8.</a>&nbsp;<a
                                    href="#security-query-elements">Ambiguous Handling of Query Elements</a></h4>
                            <div id="rfc.section.7.5.8.p.1">
                                <p>The HTML form parameters format defined in <span class="nobr">Section </span><a
                                        href="https://url.spec.whatwg.org/https://url.spec.whatwg.org/#application/x-www-form-urlencoded">5</a>
                                    of <a href="#HTMLURL"><cite title="URL (Living Standard)">[HTMLURL]</cite></a> is
                                    widely deployed and supported by many application frameworks. For convenience, some
                                    of these frameworks in particular combine query parameters that are found in the
                                    HTTP query and those found in the message content, particularly for POST messages
                                    with a Content-Type value of "application/x-www-form-urlencoded". The <span
                                        class="tt">@query-param</span> derived component identifier defined in <a
                                        href="#content-request-query-param" title="Query Parameters">Section 2.2.8</a>
                                    draws its values only from the query section of the target URI of the request. As
                                    such, it would be possible for an attacker to shadow or replace query parameters in
                                    a request by overriding a signed query parameter with an unsigned form parameter, or
                                    vice versa.</p>
                            </div>
                            <div id="rfc.section.7.5.8.p.2">
                                <p>To counter this, an application needs to make sure that values used for the signature
                                    base and the application are drawn from a consistent context, in this case the query
                                    component of the target URI. Additionally, when the HTTP request has content, an
                                    application should sign the message content as well, as discussed in <a
                                        href="#security-message-content" title="Message Content">Section 7.2.8</a>.</p>
                            </div>
                        </section>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="privacy">
                    <h2 id="rfc.section.8" class="np"><a href="#rfc.section.8">8.</a>&nbsp;<a href="#privacy">Privacy
                            Considerations</a></h2>
                    <section id="privacy-identify-keys">
                        <h3 id="rfc.section.8.1"><a href="#rfc.section.8.1">8.1.</a>&nbsp;<a
                                href="#privacy-identify-keys">Identification through Keys</a></h3>
                        <div id="rfc.section.8.1.p.1">
                            <p>If a signer uses the same key with multiple verifiers or uses the same key over time with
                                a single verifier, the ongoing use of that key can be used to track the signer
                                throughout the set of verifiers that messages are sent to. Since cryptographic keys are
                                meant to be functionally unique, the use of the same key over time is a strong indicator
                                that it is the same party signing multiple messages.</p>
                        </div>
                        <div id="rfc.section.8.1.p.2">
                            <p>In many applications, this is a desirable trait, and it allows HTTP message signatures to
                                be used as part of authenticating the signer to the verifier. However, it could also
                                result in unintentional tracking that a signer might not be aware of. To counter this
                                kind of tracking, a signer can use a different key for each verifier that it is in
                                communication with. Sometimes, a signer could also rotate their key when sending
                                messages to a given verifier. These approaches do not negate the need for other
                                anti-tracking techniques to be applied as necessary.</p>
                        </div>
                    </section>
                    <section id="privacy-confidentiality">
                        <h3 id="rfc.section.8.2"><a href="#rfc.section.8.2">8.2.</a>&nbsp;<a
                                href="#privacy-confidentiality">Signatures do not provide confidentiality</a></h3>
                        <div id="rfc.section.8.2.p.1">
                            <p>HTTP message signatures do not provide confidentiality for any of the information
                                protected by the signature. The content of the HTTP message, including the value of all
                                fields and the value of the signature itself, is presented in plaintext to any party
                                with access to the message.</p>
                        </div>
                        <div id="rfc.section.8.2.p.2">
                            <p>To provide confidentiality at the transport level, TLS or its equivalent can be used, as
                                discussed in <a href="#security-tls" title="Use of TLS">Section 7.1.2</a>.</p>
                        </div>
                    </section>
                    <section id="privacy-oracle">
                        <h3 id="rfc.section.8.3"><a href="#rfc.section.8.3">8.3.</a>&nbsp;<a
                                href="#privacy-oracle">Oracles</a></h3>
                        <div id="rfc.section.8.3.p.1">
                            <p>It is important to balance the need for providing useful feedback to developers regarding
                                error conditions without providing additional information to an attacker. For example, a
                                naive but helpful server implementation might try to indicate the required key
                                identifier needed for requesting a resource. If someone knows who controls that key, a
                                correlation can be made between the resource's existence and the party identified by the
                                key. Access to such information could be used by an attacker as a means to target the
                                legitimate owner of the resource for further attacks.</p>
                        </div>
                    </section>
                    <section id="privacy-required">
                        <h3 id="rfc.section.8.4"><a href="#rfc.section.8.4">8.4.</a>&nbsp;<a
                                href="#privacy-required">Required Content</a></h3>
                        <div id="rfc.section.8.4.p.1">
                            <p>A core design tenet of this specification is that all message components covered by the
                                signature need to be available to the verifier in order to recreate the signature base
                                and verify the signature. As a consequence, if an application of this specification
                                requires that a particular field be signed, the verifier will need access to the value
                                of that field.</p>
                        </div>
                        <div id="rfc.section.8.4.p.2">
                            <p>For example, in some complex systems with intermediary processors, this could cause
                                surprising behavior where, for fear of breaking the signature, an intermediary cannot
                                remove privacy-sensitive information from a message before forwarding it on for
                                processing. One way to mitigate this specific situation would be for the intermediary to
                                verify the signature itself and then modify the message to remove the privacy-sensitive
                                information. The intermediary can add its own signature at this point to signal to the
                                next destination that the incoming signature was validated, as shown in the example in
                                <a href="#signature-multiple" title="Multiple Signatures">Section 4.3</a>.
                            </p>
                        </div>
                    </section>
                </section>
                <section class="np">
                    <div id="rfc.references">
                        <h2 id="rfc.section.9"><a href="#rfc.section.9">9.</a> References</h2>
                        <section>
                            <div id="rfc.references.2">
                                <h3 id="rfc.section.9.1"><a href="#rfc.section.9.1">9.1.</a> Normative References</h3>
                                <dl class="dl-horizontal">
                                    <dt id="RFC5234">[<a href="#RFC5234" class="smpl">ABNF</a>]</dt>
                                    <dd>Crocker, D., Ed. and P. Overell, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc5234.html">Augmented BNF for Syntax
                                            Specifications: ABNF</a>”, <a
                                            href="https://www.rfc-editor.org/info/std68">STD 68</a>, RFC 5234, <a
                                            href="https://dx.doi.org/10.17487/RFC5234">DOI 10.17487/RFC5234</a>, January
                                        2008, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;.
                                    </dd>
                                    <dt id="RFC0020">[<a href="#RFC0020" class="smpl">ASCII</a>]</dt>
                                    <dd>Cerf, V., “<a href="https://www.rfc-editor.org/rfc/rfc20.html">ASCII format for
                                            network interchange</a>”, <a
                                            href="https://www.rfc-editor.org/info/std80">STD 80</a>, RFC 20, <a
                                            href="https://dx.doi.org/10.17487/RFC0020">DOI 10.17487/RFC0020</a>, October
                                        1969, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc20">https://www.rfc-editor.org/info/rfc20</a>&gt;.
                                    </dd>
                                    <dt id="FIPS186-5">[<a href="#FIPS186-5" class="smpl">FIPS186-5</a>]</dt>
                                    <dd>NIST, “<a href="https://doi.org/10.6028/NIST.FIPS.186-5">Digital Signature
                                            Standard (DSS)</a>”, <a
                                            href="https://dx.doi.org/10.6028/NIST.FIPS.186-5">DOI
                                            10.6028/NIST.FIPS.186-5</a>, February 2023, &lt;<a
                                            href="https://doi.org/10.6028/NIST.FIPS.186-5">https://doi.org/10.6028/NIST.FIPS.186-5</a>&gt;.
                                    </dd>
                                    <dt id="HTMLURL">[<a href="#HTMLURL" class="smpl">HTMLURL</a>]</dt>
                                    <dd>WHATWG, “<a href="https://url.spec.whatwg.org/">URL (Living Standard)</a>”,
                                        January 2024, &lt;<a
                                            href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>&gt;.
                                    </dd>
                                    <dt id="RFC9112">[<a href="#RFC9112" class="smpl">HTTP/1.1</a>]</dt>
                                    <dd>Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke, Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9112.html">HTTP/1.1</a>”, <a
                                            href="https://www.rfc-editor.org/info/std99">STD 99</a>, RFC 9112, <a
                                            href="https://dx.doi.org/10.17487/RFC9112">DOI 10.17487/RFC9112</a>, June
                                        2022, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9112">https://www.rfc-editor.org/info/rfc9112</a>&gt;.
                                    </dd>
                                    <dt id="RFC9110">[<a href="#RFC9110" class="smpl">HTTP</a>]</dt>
                                    <dd>Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke, Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9110.html">HTTP Semantics</a>”, <a
                                            href="https://www.rfc-editor.org/info/std97">STD 97</a>, RFC 9110, <a
                                            href="https://dx.doi.org/10.17487/RFC9110">DOI 10.17487/RFC9110</a>, June
                                        2022, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;.
                                    </dd>
                                    <dt id="POSIX">[<a href="#POSIX" class="smpl">POSIX.1</a>]</dt>
                                    <dd>IEEE, “<a href="https://pubs.opengroup.org/onlinepubs/9699919799/">The Open
                                            Group Base Specifications Issue 7, 2018 edition</a>”, 2018, &lt;<a
                                            href="https://pubs.opengroup.org/onlinepubs/9699919799/">https://pubs.opengroup.org/onlinepubs/9699919799/</a>&gt;.
                                    </dd>
                                    <dt id="RFC2104">[<a href="#RFC2104" class="smpl">RFC2104</a>]</dt>
                                    <dd>Krawczyk, H., Bellare, M., and R. Canetti, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc2104.html">HMAC: Keyed-Hashing for
                                            Message Authentication</a>”, RFC 2104, <a
                                            href="https://dx.doi.org/10.17487/RFC2104">DOI 10.17487/RFC2104</a>,
                                        February 1997, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;.
                                    </dd>
                                    <dt id="RFC2119">[<a href="#RFC2119" class="smpl">RFC2119</a>]</dt>
                                    <dd>Bradner, S., “<a href="https://www.rfc-editor.org/rfc/rfc2119.html">Key words
                                            for use in RFCs to Indicate Requirement Levels</a>”, <a
                                            href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 2119, <a
                                            href="https://dx.doi.org/10.17487/RFC2119">DOI 10.17487/RFC2119</a>, March
                                        1997, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.
                                    </dd>
                                    <dt id="RFC6234">[<a href="#RFC6234" class="smpl">RFC6234</a>]</dt>
                                    <dd>Eastlake 3rd, D. and T. Hansen, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc6234.html">US Secure Hash Algorithms
                                            (SHA and SHA-based HMAC and HKDF)</a>”, RFC 6234, <a
                                            href="https://dx.doi.org/10.17487/RFC6234">DOI 10.17487/RFC6234</a>, May
                                        2011, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;.
                                    </dd>
                                    <dt id="RFC7517">[<a href="#RFC7517" class="smpl">RFC7517</a>]</dt>
                                    <dd>Jones, M., “<a href="https://www.rfc-editor.org/rfc/rfc7517.html">JSON Web Key
                                            (JWK)</a>”, RFC 7517, <a href="https://dx.doi.org/10.17487/RFC7517">DOI
                                            10.17487/RFC7517</a>, May 2015, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7517">https://www.rfc-editor.org/info/rfc7517</a>&gt;.
                                    </dd>
                                    <dt id="RFC7518">[<a href="#RFC7518" class="smpl">RFC7518</a>]</dt>
                                    <dd>Jones, M., “<a href="https://www.rfc-editor.org/rfc/rfc7518.html">JSON Web
                                            Algorithms (JWA)</a>”, RFC 7518, <a
                                            href="https://dx.doi.org/10.17487/RFC7518">DOI 10.17487/RFC7518</a>, May
                                        2015, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;.
                                    </dd>
                                    <dt id="RFC8017">[<a href="#RFC8017" class="smpl">RFC8017</a>]</dt>
                                    <dd>Moriarty, K., Ed., Kaliski, B., Jonsson, J., and A. Rusch, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc8017.html">PKCS #1: RSA Cryptography
                                            Specifications Version 2.2</a>”, RFC 8017, <a
                                            href="https://dx.doi.org/10.17487/RFC8017">DOI 10.17487/RFC8017</a>,
                                        November 2016, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;.
                                    </dd>
                                    <dt id="RFC8032">[<a href="#RFC8032" class="smpl">RFC8032</a>]</dt>
                                    <dd>Josefsson, S. and I. Liusvaara, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc8032.html">Edwards-Curve Digital
                                            Signature Algorithm (EdDSA)</a>”, RFC 8032, <a
                                            href="https://dx.doi.org/10.17487/RFC8032">DOI 10.17487/RFC8032</a>, January
                                        2017, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;.
                                    </dd>
                                    <dt id="RFC8174">[<a href="#RFC8174" class="smpl">RFC8174</a>]</dt>
                                    <dd>Leiba, B., “<a href="https://www.rfc-editor.org/rfc/rfc8174.html">Ambiguity of
                                            Uppercase vs Lowercase in RFC 2119 Key Words</a>”, <a
                                            href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 8174, <a
                                            href="https://dx.doi.org/10.17487/RFC8174">DOI 10.17487/RFC8174</a>, May
                                        2017, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.
                                    </dd>
                                    <dt id="RFC8941">[<a href="#RFC8941" class="smpl">STRUCTURED-FIELDS</a>]</dt>
                                    <dd>Nottingham, M. and P-H. Kamp, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc8941.html">Structured Field Values
                                            for HTTP</a>”, RFC 8941, <a href="https://dx.doi.org/10.17487/RFC8941">DOI
                                            10.17487/RFC8941</a>, February 2021, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8941">https://www.rfc-editor.org/info/rfc8941</a>&gt;.
                                    </dd>
                                    <dt id="RFC3986">[<a href="#RFC3986" class="smpl">URI</a>]</dt>
                                    <dd>Berners-Lee, T., Fielding, R., and L. Masinter, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc3986.html">Uniform Resource
                                            Identifier (URI): Generic Syntax</a>”, <a
                                            href="https://www.rfc-editor.org/info/std66">STD 66</a>, RFC 3986, <a
                                            href="https://dx.doi.org/10.17487/RFC3986">DOI 10.17487/RFC3986</a>, January
                                        2005, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;.
                                    </dd>
                                </dl>
                            </div>
                        </section>
                        <section>
                            <div id="rfc.references.3">
                                <h3 id="rfc.section.9.2"><a href="#rfc.section.9.2">9.2.</a> Informative References</h3>
                                <dl class="dl-horizontal">
                                    <dt id="AWS-SIGv4">[<a href="#AWS-SIGv4" class="smpl">AWS-SIGv4</a>]</dt>
                                    <dd>Amazon Simple Storage Service, “<a
                                            href="https://docs.aws.amazon.com/AmazonS3/latest/API/sig-v4-authenticating-requests.html">Authenticating
                                            Requests (AWS Signature Version 4)</a>”, March 2006, &lt;<a
                                            href="https://docs.aws.amazon.com/AmazonS3/latest/API/sig-v4-authenticating-requests.html">https://docs.aws.amazon.com/AmazonS3/latest/API/sig-v4-authenticating-requests.html</a>&gt;.
                                    </dd>
                                    <dt id="BCP195">[BCP195]</dt>
                                    <dd id="RFC8996">Moriarty, K. and S. Farrell, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc8996.html">Deprecating TLS 1.0 and
                                            TLS 1.1</a>”, <a href="https://www.rfc-editor.org/info/bcp195">BCP 195</a>,
                                        RFC 8996, <a href="https://dx.doi.org/10.17487/RFC8996">DOI
                                            10.17487/RFC8996</a>, March 2021.</dd>
                                    <dd id="RFC9325">Sheffer, Y., Saint-Andre, P., and T. Fossati, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9325.html">Recommendations for
                                            Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer
                                            Security (DTLS)</a>”, <a href="https://www.rfc-editor.org/info/bcp195">BCP
                                            195</a>, RFC 9325, <a href="https://dx.doi.org/10.17487/RFC9325">DOI
                                            10.17487/RFC9325</a>, November 2022.</dd>
                                    <dd>&lt;<a
                                            href="https://www.rfc-editor.org/info/bcp195">https://www.rfc-editor.org/info/bcp195</a>&gt;
                                    </dd>
                                    <dt id="RFC9440">[<a href="#RFC9440" class="smpl">CLIENT-CERT</a>]</dt>
                                    <dd>Campbell, B. and M. Bishop, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9440.html">Client-Cert HTTP Header
                                            Field</a>”, RFC 9440, <a href="https://dx.doi.org/10.17487/RFC9440">DOI
                                            10.17487/RFC9440</a>, July 2023, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9440">https://www.rfc-editor.org/info/rfc9440</a>&gt;.
                                    </dd>
                                    <dt id="RFC6265">[<a href="#RFC6265" class="smpl">COOKIE</a>]</dt>
                                    <dd>Barth, A., “<a href="https://www.rfc-editor.org/rfc/rfc6265.html">HTTP State
                                            Management Mechanism</a>”, RFC 6265, <a
                                            href="https://dx.doi.org/10.17487/RFC6265">DOI 10.17487/RFC6265</a>, April
                                        2011, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc6265">https://www.rfc-editor.org/info/rfc6265</a>&gt;.
                                    </dd>
                                    <dt id="RFC9530">[<a href="#RFC9530" class="smpl">DIGEST</a>]</dt>
                                    <dd>Polli, R. and L. Pardue, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9530.html">Digest Fields</a>”, RFC
                                        9530, <a href="https://dx.doi.org/10.17487/RFC9530">DOI 10.17487/RFC9530</a>,
                                        February 2024, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9530">https://www.rfc-editor.org/info/rfc9530</a>&gt;.
                                    </dd>
                                    <dt id="JACKSON2019">[<a href="#JACKSON2019" class="smpl">JACKSON2019</a>]</dt>
                                    <dd>Jackson, D., Cremers, C., Cohn-Gordon, K., and R. Sasse, “<a
                                            href="https://dl.acm.org/doi/10.1145/3319535.3339813">Seems Legit: Automated
                                            Analysis of Subtle Attacks on Protocols that Use Signatures</a>”, <a
                                            href="https://dx.doi.org/10.1145/3319535.3339813">DOI
                                            10.1145/3319535.3339813</a>, CCS '19: Proceedings of the 2019 ACM SIGSAC
                                        Conference on Computer and Communications Security, pp. 2165-2180, November
                                        2019, &lt;<a
                                            href="https://dl.acm.org/doi/10.1145/3319535.3339813">https://dl.acm.org/doi/10.1145/3319535.3339813</a>&gt;.
                                    </dd>
                                    <dt id="RFC7515">[<a href="#RFC7515" class="smpl">JWS</a>]</dt>
                                    <dd>Jones, M., Bradley, J., and N. Sakimura, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc7515.html">JSON Web Signature
                                            (JWS)</a>”, RFC 7515, <a href="https://dx.doi.org/10.17487/RFC7515">DOI
                                            10.17487/RFC7515</a>, May 2015, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;.
                                    </dd>
                                    <dt id="RFC7239">[<a href="#RFC7239" class="smpl">RFC7239</a>]</dt>
                                    <dd>Petersson, A. and M. Nilsson, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc7239.html">Forwarded HTTP
                                            Extension</a>”, RFC 7239, <a href="https://dx.doi.org/10.17487/RFC7239">DOI
                                            10.17487/RFC7239</a>, June 2014, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7239">https://www.rfc-editor.org/info/rfc7239</a>&gt;.
                                    </dd>
                                    <dt id="RFC7468">[<a href="#RFC7468" class="smpl">RFC7468</a>]</dt>
                                    <dd>Josefsson, S. and S. Leonard, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc7468.html">Textual Encodings of
                                            PKIX, PKCS, and CMS Structures</a>”, RFC 7468, <a
                                            href="https://dx.doi.org/10.17487/RFC7468">DOI 10.17487/RFC7468</a>, April
                                        2015, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7468">https://www.rfc-editor.org/info/rfc7468</a>&gt;.
                                    </dd>
                                    <dt id="RFC7807">[<a href="#RFC7807" class="smpl">RFC7807</a>]</dt>
                                    <dd>Nottingham, M. and E. Wilde, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc7807.html">Problem Details for HTTP
                                            APIs</a>”, RFC 7807, <a href="https://dx.doi.org/10.17487/RFC7807">DOI
                                            10.17487/RFC7807</a>, March 2016, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7807">https://www.rfc-editor.org/info/rfc7807</a>&gt;.
                                    </dd>
                                    <dt id="RFC8126">[<a href="#RFC8126" class="smpl">RFC8126</a>]</dt>
                                    <dd>Cotton, M., Leiba, B., and T. Narten, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc8126.html">Guidelines for Writing an
                                            IANA Considerations Section in RFCs</a>”, <a
                                            href="https://www.rfc-editor.org/info/bcp26">BCP 26</a>, RFC 8126, <a
                                            href="https://dx.doi.org/10.17487/RFC8126">DOI 10.17487/RFC8126</a>, June
                                        2017, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;.
                                    </dd>
                                    <dt id="RFC8792">[<a href="#RFC8792" class="smpl">RFC8792</a>]</dt>
                                    <dd>Watsen, K., Auerswald, E., Farrel, A., and Q. Wu, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc8792.html">Handling Long Lines in
                                            Content of Internet-Drafts and RFCs</a>”, RFC 8792, <a
                                            href="https://dx.doi.org/10.17487/RFC8792">DOI 10.17487/RFC8792</a>, June
                                        2020, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8792">https://www.rfc-editor.org/info/rfc8792</a>&gt;.
                                    </dd>
                                    <dt id="RFC9457">[<a href="#RFC9457" class="smpl">RFC9457</a>]</dt>
                                    <dd>Nottingham, M., Wilde, E., and S. Dalal, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9457.html">Problem Details for HTTP
                                            APIs</a>”, RFC 9457, <a href="https://dx.doi.org/10.17487/RFC9457">DOI
                                            10.17487/RFC9457</a>, July 2023, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9457">https://www.rfc-editor.org/info/rfc9457</a>&gt;.
                                    </dd>
                                    <dt id="I-D.cavage-http-signatures">[<a href="#I-D.cavage-http-signatures"
                                            class="smpl">SIGNING-HTTP-MESSAGES</a>]</dt>
                                    <dd>Cavage, M. and M. Sporny, “<a
                                            href="https://datatracker.ietf.org/doc/html/draft-cavage-http-signatures-12">Signing
                                            HTTP Messages</a>”, <a
                                            href="https://datatracker.ietf.org/doc/draft-cavage-http-signatures">Work in
                                            Progress</a>, draft-cavage-http-signatures-12, Work in Progress, October
                                        2019, &lt;<a
                                            href="https://datatracker.ietf.org/doc/html/draft-cavage-http-signatures-12">https://datatracker.ietf.org/doc/html/draft-cavage-http-signatures-12</a>&gt;.
                                    </dd>
                                    <dt id="SIGNING-HTTP-REQS-OAUTH">[<a href="#SIGNING-HTTP-REQS-OAUTH"
                                            class="smpl">SIGNING-HTTP-REQS-OAUTH</a>]</dt>
                                    <dd>Richer, J., Ed., Bradley, J., and H. Tschofenig, “<a
                                            href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-signed-http-request-03">A
                                            Method for Signing HTTP Requests for OAuth</a>”, <a
                                            href="https://datatracker.ietf.org/doc/draft-ietf-oauth-signed-http-request">Work
                                            in Progress</a>, draft-ietf-oauth-signed-http-request-03, Work in Progress,
                                        August 2016, &lt;<a
                                            href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-signed-http-request-03">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-signed-http-request-03</a>&gt;.
                                    </dd>
                                    <dt id="RFC8446">[<a href="#RFC8446" class="smpl">TLS</a>]</dt>
                                    <dd>Rescorla, E., “<a href="https://www.rfc-editor.org/rfc/rfc8446.html">The
                                            Transport Layer Security (TLS) Protocol Version 1.3</a>”, RFC 8446, <a
                                            href="https://dx.doi.org/10.17487/RFC8446">DOI 10.17487/RFC8446</a>, August
                                        2018, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;.
                                    </dd>
                                </dl>
                            </div>
                        </section>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="detection">
                    <h2 id="rfc.section.A" class="np"><a href="#rfc.section.A">Appendix A.</a>&nbsp;<a
                            href="#detection">Detecting HTTP Message Signatures</a></h2>
                    <div id="rfc.section.A.p.1">
                        <p>There have been many attempts to create signed HTTP messages in the past, including other
                            non-standardized definitions of the Signature field that is used within this specification.
                            It is recommended that developers wishing to support this specification, other published
                            documents, or other historical drafts do so carefully and deliberately, as incompatibilities
                            between this specification and other documents or various versions of other drafts could
                            lead to unexpected problems.</p>
                    </div>
                    <div id="rfc.section.A.p.2">
                        <p>It is recommended that implementors first detect and validate the Signature-Input field
                            defined in this specification to detect that the mechanism described in this document is in
                            use and not an alternative. If the Signature-Input field is present, all Signature fields
                            can be parsed and interpreted in the context of this specification.</p>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="examples">
                    <h2 id="rfc.section.B" class="np"><a href="#rfc.section.B">Appendix B.</a>&nbsp;<a
                            href="#examples">Examples</a></h2>
                    <div id="rfc.section.B.p.1">
                        <p>The following non-normative examples are provided as a means of testing implementations of
                            HTTP message signatures. The signed messages given can be used to create the signature base
                            with the stated parameters, creating signatures using the stated algorithms and keys.</p>
                    </div>
                    <div id="rfc.section.B.p.2">
                        <p>The private keys given can be used to generate signatures, though since several of the
                            demonstrated algorithms are non-deterministic, the results of a signature are expected to be
                            different from the exact bytes of the examples. The public keys given can be used to
                            validate all signed examples.</p>
                    </div>
                    <section id="example-keys">
                        <h3 id="rfc.section.B.1"><a href="#rfc.section.B.1">B.1.</a>&nbsp;<a
                                href="#example-keys">Example Keys</a></h3>
                        <div id="rfc.section.B.1.p.1">
                            <p>This section provides cryptographic keys that are referenced in example signatures
                                throughout this document. These keys <em class="bcp14">MUST NOT</em> be used for any
                                purpose other than testing.</p>
                        </div>
                        <div id="rfc.section.B.1.p.2">
                            <p>The key identifiers for each key are used throughout the examples in this specification.
                                It is assumed for these examples that the signer and verifier can unambiguously
                                dereference all key identifiers used here and that the keys and algorithms used are
                                appropriate for the context in which the signature is presented.</p>
                        </div>
                        <div id="rfc.section.B.1.p.3" class="avoidbreakafter">
                            <p>The components for each private key, in PEM format <a href="#RFC7468"><cite
                                        title="Textual Encodings of PKIX, PKCS, and CMS Structures">[RFC7468]</cite></a>,
                                can be displayed by executing the following OpenSSL command:</p>
                        </div>
                        <div id="rfc.section.B.1.p.4">
                            <pre>
openssl pkey -text
</pre>
                        </div>
                        <div id="rfc.section.B.1.p.5">
                            <p>This command was tested with all the example keys on OpenSSL version 1.1.1m. Note that
                                some systems cannot produce or use all of these keys directly and may require additional
                                processing. All keys are also made available in JWK format.</p>
                        </div>
                        <section id="example-key-rsa-test">
                            <h4 id="rfc.section.B.1.1"><a href="#rfc.section.B.1.1">B.1.1.</a>&nbsp;<a
                                    href="#example-key-rsa-test">Example RSA Key</a></h4>
                            <div id="rfc.section.B.1.1.p.1">
                                <p>The following key is a 2048-bit RSA public and private key pair, referred to in this
                                    document as <span class="tt">test-key-rsa</span>. This key is encoded in PEM format,
                                    with no encryption.</p>
                            </div>
                            <div id="rfc.section.B.1.1.p.2">
                                <pre>
-----BEGIN RSA PUBLIC KEY-----
MIIBCgKCAQEAhAKYdtoeoy8zcAcR874L8cnZxKzAGwd7v36APp7Pv6Q2jdsPBRrw
WEBnez6d0UDKDwGbc6nxfEXAy5mbhgajzrw3MOEt8uA5txSKobBpKDeBLOsdJKFq
MGmXCQvEG7YemcxDTRPxAleIAgYYRjTSd/QBwVW9OwNFhekro3RtlinV0a75jfZg
kne/YiktSvLG34lw2zqXBDTC5NHROUqGTlML4PlNZS5Ri2U4aCNx2rUPRcKIlE0P
uKxI4T+HIaFpv8+rdV6eUgOrB2xeI1dSFFn/nnv5OoZJEIB+VmuKn3DCUcCZSFlQ
PSXSfBDiUGhwOw76WuSSsf1D4b/vLoJ10wIDAQAB
-----END RSA PUBLIC KEY-----

-----BEGIN RSA PRIVATE KEY-----
MIIEqAIBAAKCAQEAhAKYdtoeoy8zcAcR874L8cnZxKzAGwd7v36APp7Pv6Q2jdsP
BRrwWEBnez6d0UDKDwGbc6nxfEXAy5mbhgajzrw3MOEt8uA5txSKobBpKDeBLOsd
JKFqMGmXCQvEG7YemcxDTRPxAleIAgYYRjTSd/QBwVW9OwNFhekro3RtlinV0a75
jfZgkne/YiktSvLG34lw2zqXBDTC5NHROUqGTlML4PlNZS5Ri2U4aCNx2rUPRcKI
lE0PuKxI4T+HIaFpv8+rdV6eUgOrB2xeI1dSFFn/nnv5OoZJEIB+VmuKn3DCUcCZ
SFlQPSXSfBDiUGhwOw76WuSSsf1D4b/vLoJ10wIDAQABAoIBAG/JZuSWdoVHbi56
vjgCgkjg3lkO1KrO3nrdm6nrgA9P9qaPjxuKoWaKO1cBQlE1pSWp/cKncYgD5WxE
CpAnRUXG2pG4zdkzCYzAh1i+c34L6oZoHsirK6oNcEnHveydfzJL5934egm6p8DW
+m1RQ70yUt4uRc0YSor+q1LGJvGQHReF0WmJBZHrhz5e63Pq7lE0gIwuBqL8SMaA
yRXtK+JGxZpImTq+NHvEWWCu09SCq0r838ceQI55SvzmTkwqtC+8AT2zFviMZkKR
Qo6SPsrqItxZWRty2izawTF0Bf5S2VAx7O+6t3wBsQ1sLptoSgX3QblELY5asI0J
YFz7LJECgYkAsqeUJmqXE3LP8tYoIjMIAKiTm9o6psPlc8CrLI9CH0UbuaA2JCOM
cCNq8SyYbTqgnWlB9ZfcAm/cFpA8tYci9m5vYK8HNxQr+8FS3Qo8N9RJ8d0U5Csw
DzMYfRghAfUGwmlWj5hp1pQzAuhwbOXFtxKHVsMPhz1IBtF9Y8jvgqgYHLbmyiu1
mwJ5AL0pYF0G7x81prlARURwHo0Yf52kEw1dxpx+JXER7hQRWQki5/NsUEtv+8RT
qn2m6qte5DXLyn83b1qRscSdnCCwKtKWUug5q2ZbwVOCJCtmRwmnP131lWRYfj67
B/xJ1ZA6X3GEf4sNReNAtaucPEelgR2nsN0gKQKBiGoqHWbK1qYvBxX2X3kbPDkv
9C+celgZd2PW7aGYLCHq7nPbmfDV0yHcWjOhXZ8jRMjmANVR/eLQ2EfsRLdW69bn
f3ZD7JS1fwGnO3exGmHO3HZG+6AvberKYVYNHahNFEw5TsAcQWDLRpkGybBcxqZo
81YCqlqidwfeO5YtlO7etx1xLyqa2NsCeG9A86UjG+aeNnXEIDk1PDK+EuiThIUa
/2IxKzJKWl1BKr2d4xAfR0ZnEYuRrbeDQYgTImOlfW6/GuYIxKYgEKCFHFqJATAG
IxHrq1PDOiSwXd2GmVVYyEmhZnbcp8CxaEMQoevxAta0ssMK3w6UsDtvUvYvF22m
qQKBiD5GwESzsFPy3Ga0MvZpn3D6EJQLgsnrtUPZx+z2Ep2x0xc5orneB5fGyF1P
WtP+fG5Q6Dpdz3LRfm+KwBCWFKQjg7uTxcjerhBWEYPmEMKYwTJF5PBG9/ddvHLQ
EQeNC8fHGg4UXU8mhHnSBt3EA10qQJfRDs15M38eG2cYwB1PZpDHScDnDA0=
-----END RSA PRIVATE KEY-----
</pre>
                            </div>
                            <div id="rfc.section.B.1.1.p.3" class="avoidbreakafter">
                                <p>The same public and private key pair in JWK format:</p>
                            </div>
                            <div id="rfc.section.B.1.1.p.4">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

{
  "kty": "RSA",
  "kid": "test-key-rsa",
  "p": "sqeUJmqXE3LP8tYoIjMIAKiTm9o6psPlc8CrLI9CH0UbuaA2JCOMcCNq8Sy\
  YbTqgnWlB9ZfcAm_cFpA8tYci9m5vYK8HNxQr-8FS3Qo8N9RJ8d0U5CswDzMYfRgh\
  AfUGwmlWj5hp1pQzAuhwbOXFtxKHVsMPhz1IBtF9Y8jvgqgYHLbmyiu1mw",
  "q": "vSlgXQbvHzWmuUBFRHAejRh_naQTDV3GnH4lcRHuFBFZCSLn82xQS2_7xFO\
  qfabqq17kNcvKfzdvWpGxxJ2cILAq0pZS6DmrZlvBU4IkK2ZHCac_XfWVZFh-PrsH\
  _EnVkDpfcYR_iw1F40C1q5w8R6WBHaew3SAp",
  "d": "b8lm5JZ2hUduLnq-OAKCSODeWQ7Uqs7eet2bqeuAD0_2po-PG4qhZoo7VwF\
  CUTWlJan9wqdxiAPlbEQKkCdFRcbakbjN2TMJjMCHWL5zfgvqhmgeyKsrqg1wSce9\
  7J1_Mkvn3fh6CbqnwNb6bVFDvTJS3i5FzRhKiv6rUsYm8ZAdF4XRaYkFkeuHPl7rc\
  -ruUTSAjC4GovxIxoDJFe0r4kbFmkiZOr40e8RZYK7T1IKrSvzfxx5AjnlK_OZOTC\
  q0L7wBPbMW-IxmQpFCjpI-yuoi3FlZG3LaLNrBMXQF_lLZUDHs77q3fAGxDWwum2h\
  KBfdBuUQtjlqwjQlgXPsskQ",
  "e": "AQAB",
  "qi": "PkbARLOwU_LcZrQy9mmfcPoQlAuCyeu1Q9nH7PYSnbHTFzmiud4Hl8bIXU\
  9a0_58blDoOl3PctF-b4rAEJYUpCODu5PFyN6uEFYRg-YQwpjBMkXk8Eb39128ctA\
  RB40Lx8caDhRdTyaEedIG3cQDXSpAl9EOzXkzfx4bZxjAHU9mkMdJwOcMDQ",
  "dp": "aiodZsrWpi8HFfZfeRs8OS_0L5x6WBl3Y9btoZgsIeruc9uZ8NXTIdxaM6\
  FdnyNEyOYA1VH94tDYR-xEt1br1ud_dkPslLV_Aac7d7EaYc7cdkb7oC9t6sphVg0\
  dqE0UTDlOwBxBYMtGmQbJsFzGpmjzVgKqWqJ3B947li2U7t63HXEvKprY2w",
  "dq": "b0DzpSMb5p42dcQgOTU8Mr4S6JOEhRr_YjErMkpaXUEqvZ3jEB9HRmcRi5\
  Gtt4NBiBMiY6V9br8a5gjEpiAQoIUcWokBMAYjEeurU8M6JLBd3YaZVVjISaFmdty\
  nwLFoQxCh6_EC1rSywwrfDpSwO29S9i8Xbaap",
  "n": "hAKYdtoeoy8zcAcR874L8cnZxKzAGwd7v36APp7Pv6Q2jdsPBRrwWEBnez6\
  d0UDKDwGbc6nxfEXAy5mbhgajzrw3MOEt8uA5txSKobBpKDeBLOsdJKFqMGmXCQvE\
  G7YemcxDTRPxAleIAgYYRjTSd_QBwVW9OwNFhekro3RtlinV0a75jfZgkne_YiktS\
  vLG34lw2zqXBDTC5NHROUqGTlML4PlNZS5Ri2U4aCNx2rUPRcKIlE0PuKxI4T-HIa\
  Fpv8-rdV6eUgOrB2xeI1dSFFn_nnv5OoZJEIB-VmuKn3DCUcCZSFlQPSXSfBDiUGh\
  wOw76WuSSsf1D4b_vLoJ10w"
}
</pre>
                            </div>
                        </section>
                        <section id="example-key-rsa-pss-test">
                            <h4 id="rfc.section.B.1.2"><a href="#rfc.section.B.1.2">B.1.2.</a>&nbsp;<a
                                    href="#example-key-rsa-pss-test">Example RSA-PSS Key</a></h4>
                            <div id="rfc.section.B.1.2.p.1">
                                <p>The following key is a 2048-bit RSA public and private key pair, referred to in this
                                    document as <span class="tt">test-key-rsa-pss</span>. This key is PKCS #8 encoded in
                                    PEM format, with no encryption.</p>
                            </div>
                            <div id="rfc.section.B.1.2.p.2">
                                <pre>
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAr4tmm3r20Wd/PbqvP1s2
+QEtvpuRaV8Yq40gjUR8y2Rjxa6dpG2GXHbPfvMs8ct+Lh1GH45x28Rw3Ry53mm+
oAXjyQ86OnDkZ5N8lYbggD4O3w6M6pAvLkhk95AndTrifbIFPNU8PPMO7OyrFAHq
gDsznjPFmTOtCEcN2Z1FpWgchwuYLPL+Wokqltd11nqqzi+bJ9cvSKADYdUAAN5W
Utzdpiy6LbTgSxP7ociU4Tn0g5I6aDZJ7A8Lzo0KSyZYoA485mqcO0GVAdVw9lq4
aOT9v6d+nb4bnNkQVklLQ3fVAvJm+xdDOp9LCNCN48V2pnDOkFV6+U9nV5oyc6XI
2wIDAQAB
-----END PUBLIC KEY-----

-----BEGIN PRIVATE KEY-----
MIIEvgIBADALBgkqhkiG9w0BAQoEggSqMIIEpgIBAAKCAQEAr4tmm3r20Wd/Pbqv
P1s2+QEtvpuRaV8Yq40gjUR8y2Rjxa6dpG2GXHbPfvMs8ct+Lh1GH45x28Rw3Ry5
3mm+oAXjyQ86OnDkZ5N8lYbggD4O3w6M6pAvLkhk95AndTrifbIFPNU8PPMO7Oyr
FAHqgDsznjPFmTOtCEcN2Z1FpWgchwuYLPL+Wokqltd11nqqzi+bJ9cvSKADYdUA
AN5WUtzdpiy6LbTgSxP7ociU4Tn0g5I6aDZJ7A8Lzo0KSyZYoA485mqcO0GVAdVw
9lq4aOT9v6d+nb4bnNkQVklLQ3fVAvJm+xdDOp9LCNCN48V2pnDOkFV6+U9nV5oy
c6XI2wIDAQABAoIBAQCUB8ip+kJiiZVKF8AqfB/aUP0jTAqOQewK1kKJ/iQCXBCq
pbo360gvdt05H5VZ/RDVkEgO2k73VSsbulqezKs8RFs2tEmU+JgTI9MeQJPWcP6X
aKy6LIYs0E2cWgp8GADgoBs8llBq0UhX0KffglIeek3n7Z6Gt4YFge2TAcW2WbN4
XfK7lupFyo6HHyWRiYHMMARQXLJeOSdTn5aMBP0PO4bQyk5ORxTUSeOciPJUFktQ
HkvGbym7KryEfwH8Tks0L7WhzyP60PL3xS9FNOJi9m+zztwYIXGDQuKM2GDsITeD
2mI2oHoPMyAD0wdI7BwSVW18p1h+jgfc4dlexKYRAoGBAOVfuiEiOchGghV5vn5N
RDNscAFnpHj1QgMr6/UG05RTgmcLfVsI1I4bSkbrIuVKviGGf7atlkROALOG/xRx
DLadgBEeNyHL5lz6ihQaFJLVQ0u3U4SB67J0YtVO3R6lXcIjBDHuY8SjYJ7Ci6Z6
vuDcoaEujnlrtUhaMxvSfcUJAoGBAMPsCHXte1uWNAqYad2WdLjPDlKtQJK1diCm
rqmB2g8QE99hDOHItjDBEdpyFBKOIP+NpVtM2KLhRajjcL9Ph8jrID6XUqikQuVi
4J9FV2m42jXMuioTT13idAILanYg8D3idvy/3isDVkON0X3UAVKrgMEne0hJpkPL
FYqgetvDAoGBAKLQ6JZMbSe0pPIJkSamQhsehgL5Rs51iX4m1z7+sYFAJfhvN3Q/
OGIHDRp6HjMUcxHpHw7U+S1TETxePwKLnLKj6hw8jnX2/nZRgWHzgVcY+sPsReRx
NJVf+Cfh6yOtznfX00p+JWOXdSY8glSSHJwRAMog+hFGW1AYdt7w80XBAoGBAImR
NUugqapgaEA8TrFxkJmngXYaAqpA0iYRA7kv3S4QavPBUGtFJHBNULzitydkNtVZ
3w6hgce0h9YThTo/nKc+OZDZbgfN9s7cQ75x0PQCAO4fx2P91Q+mDzDUVTeG30mE
t2m3S0dGe47JiJxifV9P3wNBNrZGSIF3mrORBVNDAoGBAI0QKn2Iv7Sgo4T/XjND
dl2kZTXqGAk8dOhpUiw/HdM3OGWbhHj2NdCzBliOmPyQtAr770GITWvbAI+IRYyF
S7Fnk6ZVVVHsxjtaHy1uJGFlaZzKR4AGNaUTOJMs6NadzCmGPAxNQQOCqoUjn4XR
rOjr9w349JooGXhOxbu8nOxX
-----END PRIVATE KEY-----
</pre>
                            </div>
                            <div id="rfc.section.B.1.2.p.3" class="avoidbreakafter">
                                <p>The same public and private key pair in JWK format:</p>
                            </div>
                            <div id="rfc.section.B.1.2.p.4">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

{
  "kty": "RSA",
  "kid": "test-key-rsa-pss",
  "p": "5V-6ISI5yEaCFXm-fk1EM2xwAWekePVCAyvr9QbTlFOCZwt9WwjUjhtKRus\
  i5Uq-IYZ_tq2WRE4As4b_FHEMtp2AER43IcvmXPqKFBoUktVDS7dThIHrsnRi1U7d\
  HqVdwiMEMe5jxKNgnsKLpnq-4NyhoS6OeWu1SFozG9J9xQk",
  "q": "w-wIde17W5Y0Cphp3ZZ0uM8OUq1AkrV2IKauqYHaDxAT32EM4ci2MMER2nI\
  UEo4g_42lW0zYouFFqONwv0-HyOsgPpdSqKRC5WLgn0VXabjaNcy6KhNPXeJ0Agtq\
  diDwPeJ2_L_eKwNWQ43RfdQBUquAwSd7SEmmQ8sViqB628M",
  "d": "lAfIqfpCYomVShfAKnwf2lD9I0wKjkHsCtZCif4kAlwQqqW6N-tIL3bdOR-\
  VWf0Q1ZBIDtpO91UrG7pansyrPERbNrRJlPiYEyPTHkCT1nD-l2isuiyGLNBNnFoK\
  fBgA4KAbPJZQatFIV9Cn34JSHnpN5-2ehreGBYHtkwHFtlmzeF3yu5bqRcqOhx8lk\
  YmBzDAEUFyyXjknU5-WjAT9DzuG0MpOTkcU1EnjnIjyVBZLUB5Lxm8puyq8hH8B_E\
  5LNC-1oc8j-tDy98UvRTTiYvZvs87cGCFxg0LijNhg7CE3g9piNqB6DzMgA9MHSOw\
  cElVtfKdYfo4H3OHZXsSmEQ",
  "e": "AQAB",
  "qi": "jRAqfYi_tKCjhP9eM0N2XaRlNeoYCTx06GlSLD8d0zc4ZZuEePY10LMGWI\
  6Y_JC0CvvvQYhNa9sAj4hFjIVLsWeTplVVUezGO1ofLW4kYWVpnMpHgAY1pRM4kyz\
  o1p3MKYY8DE1BA4KqhSOfhdGs6Ov3Dfj0migZeE7Fu7yc7Fc",
  "dp": "otDolkxtJ7Sk8gmRJqZCGx6GAvlGznWJfibXPv6xgUAl-G83dD84YgcNGn\
  oeMxRzEekfDtT5LVMRPF4_AoucsqPqHDyOdfb-dlGBYfOBVxj6w-xF5HE0lV_4J-H\
  rI63Od9fTSn4lY5d1JjyCVJIcnBEAyiD6EUZbUBh23vDzRcE",
  "dq": "iZE1S6CpqmBoQDxOsXGQmaeBdhoCqkDSJhEDuS_dLhBq88FQa0UkcE1QvO\
  K3J2Q21VnfDqGBx7SH1hOFOj-cpz45kNluB832ztxDvnHQ9AIA7h_HY_3VD6YPMNR\
  VN4bfSYS3abdLR0Z7jsmInGJ9X0_fA0E2tkZIgXeas5EFU0M",
  "n": "r4tmm3r20Wd_PbqvP1s2-QEtvpuRaV8Yq40gjUR8y2Rjxa6dpG2GXHbPfvM\
  s8ct-Lh1GH45x28Rw3Ry53mm-oAXjyQ86OnDkZ5N8lYbggD4O3w6M6pAvLkhk95An\
  dTrifbIFPNU8PPMO7OyrFAHqgDsznjPFmTOtCEcN2Z1FpWgchwuYLPL-Wokqltd11\
  nqqzi-bJ9cvSKADYdUAAN5WUtzdpiy6LbTgSxP7ociU4Tn0g5I6aDZJ7A8Lzo0KSy\
  ZYoA485mqcO0GVAdVw9lq4aOT9v6d-nb4bnNkQVklLQ3fVAvJm-xdDOp9LCNCN48V\
  2pnDOkFV6-U9nV5oyc6XI2w"
}
</pre>
                            </div>
                        </section>
                        <section id="example-key-ecc-p256">
                            <h4 id="rfc.section.B.1.3"><a href="#rfc.section.B.1.3">B.1.3.</a>&nbsp;<a
                                    href="#example-key-ecc-p256">Example ECC P-256 Test Key</a></h4>
                            <div id="rfc.section.B.1.3.p.1">
                                <p>The following key is a public and private elliptical curve key pair over the curve
                                    P-256, referred to in this document as <span class="tt">test-key-ecc-p256</span>.
                                    This key is encoded in PEM format, with no encryption.</p>
                            </div>
                            <div id="rfc.section.B.1.3.p.2">
                                <pre>
-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEqIVYZVLCrPZHGHjP17CTW0/+D9Lf
w0EkjqF7xB4FivAxzic30tMM4GF+hR6Dxh71Z50VGGdldkkDXZCnTNnoXQ==
-----END PUBLIC KEY-----

-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIFKbhfNZfpDsW43+0+JjUr9K+bTeuxopu653+hBaXGA7oAoGCCqGSM49
AwEHoUQDQgAEqIVYZVLCrPZHGHjP17CTW0/+D9Lfw0EkjqF7xB4FivAxzic30tMM
4GF+hR6Dxh71Z50VGGdldkkDXZCnTNnoXQ==
-----END EC PRIVATE KEY-----
</pre>
                            </div>
                            <div id="rfc.section.B.1.3.p.3" class="avoidbreakafter">
                                <p>The same public and private key pair in JWK format:</p>
                            </div>
                            <div id="rfc.section.B.1.3.p.4">
                                <pre class="text">
{
  "kty": "EC",
  "crv": "P-256",
  "kid": "test-key-ecc-p256",
  "d": "UpuF81l-kOxbjf7T4mNSv0r5tN67Gim7rnf6EFpcYDs",
  "x": "qIVYZVLCrPZHGHjP17CTW0_-D9Lfw0EkjqF7xB4FivA",
  "y": "Mc4nN9LTDOBhfoUeg8Ye9WedFRhnZXZJA12Qp0zZ6F0"
}
</pre>
                            </div>
                        </section>
                        <section id="example-key-ed25519">
                            <h4 id="rfc.section.B.1.4"><a href="#rfc.section.B.1.4">B.1.4.</a>&nbsp;<a
                                    href="#example-key-ed25519">Example Ed25519 Test Key</a></h4>
                            <div id="rfc.section.B.1.4.p.1">
                                <p>The following key is an elliptical curve key over the Edwards curve ed25519, referred
                                    to in this document as <span class="tt">test-key-ed25519</span>. This key is PKCS #8
                                    encoded in PEM format, with no encryption.</p>
                            </div>
                            <div id="rfc.section.B.1.4.p.2">
                                <pre>
-----BEGIN PUBLIC KEY-----
MCowBQYDK2VwAyEAJrQLj5P/89iXES9+vFgrIy29clF9CC/oPPsw3c5D0bs=
-----END PUBLIC KEY-----

-----BEGIN PRIVATE KEY-----
MC4CAQAwBQYDK2VwBCIEIJ+DYvh6SEqVTm50DFtMDoQikTmiCqirVv9mWG9qfSnF
-----END PRIVATE KEY-----
</pre>
                            </div>
                            <div id="rfc.section.B.1.4.p.3" class="avoidbreakafter">
                                <p>The same public and private key pair in JWK format:</p>
                            </div>
                            <div id="rfc.section.B.1.4.p.4">
                                <pre class="text">
{
  "kty": "OKP",
  "crv": "Ed25519",
  "kid": "test-key-ed25519",
  "d": "n4Ni-HpISpVObnQMW0wOhCKROaIKqKtW_2ZYb2p9KcU",
  "x": "JrQLj5P_89iXES9-vFgrIy29clF9CC_oPPsw3c5D0bs"
}
</pre>
                            </div>
                        </section>
                        <section id="example-shared-secret">
                            <h4 id="rfc.section.B.1.5"><a href="#rfc.section.B.1.5">B.1.5.</a>&nbsp;<a
                                    href="#example-shared-secret">Example Shared Secret</a></h4>
                            <div id="rfc.section.B.1.5.p.1" class="avoidbreakafter">
                                <p>The following shared secret is 64 randomly generated bytes encoded in Base64,
                                    referred to in this document as <span class="tt">test-shared-secret</span>:</p>
                            </div>
                            <div id="rfc.section.B.1.5.p.2">
                                <pre>
NOTE: '\' line wrapping per RFC 8792

uzvJfB4u3N0Jy4T7NZ75MDVcr8zSTInedJtkgcu46YW4XByzNJjxBdtjUkdJPBt\
  bmHhIDi6pcl8jsasjlTMtDQ==
</pre>
                            </div>
                        </section>
                    </section>
                    <section id="test-cases">
                        <h3 id="rfc.section.B.2"><a href="#rfc.section.B.2">B.2.</a>&nbsp;<a href="#test-cases">Test
                                Cases</a></h3>
                        <div id="rfc.section.B.2.p.1" class="avoidbreakafter">
                            <p>This section provides non-normative examples that may be used as test cases to validate
                                implementation correctness. These examples are based on the following HTTP messages:</p>
                        </div>
                        <div id="rfc.section.B.2.p.2" class="avoidbreakafter">
                            <p>For requests, this <span class="tt">test-request</span> message is used:</p>
                        </div>
                        <div id="rfc.section.B.2.p.3">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.B.2.p.4" class="avoidbreakafter">
                            <p>For responses, this <span class="tt">test-response</span> message is used:</p>
                        </div>
                        <div id="rfc.section.B.2.p.5">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 200 OK
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Digest: sha-512=:mEWXIS7MaLRuGgxOBdODa3xqM1XdEvxoYhvlCFJ41Q\
  JgJc4GTsPp29l5oGX69wWdXymyU0rjJuahq4l5aGgfLQ==:
Content-Length: 23

{"message": "good dog"}
</pre>
                        </div>
                        <section id="minimal-signature-using-rsa-pss-sha512">
                            <h4 id="rfc.section.B.2.1"><a href="#rfc.section.B.2.1">B.2.1.</a>&nbsp;<a
                                    href="#minimal-signature-using-rsa-pss-sha512">Minimal Signature Using
                                    rsa-pss-sha512</a></h4>
                            <div id="rfc.section.B.2.1.p.1">
                                <p>This example presents a minimal signature using the <span
                                        class="tt">rsa-pss-sha512</span> algorithm over <span
                                        class="tt">test-request</span>, covering none of the components of the HTTP
                                    message but providing a timestamped signature proof of possession of the key with a
                                    signer-provided nonce.</p>
                            </div>
                            <div id="rfc.section.B.2.1.p.2" class="avoidbreakafter">
                                <p>The corresponding signature base is:</p>
                            </div>
                            <div id="rfc.section.B.2.1.p.3">
                                <pre>
NOTE: '\' line wrapping per RFC 8792

"@signature-params": ();created=1618884473;keyid="test-key-rsa-pss"\
  ;nonce="b3k2pp5k7z-50gnwp.yemd"
</pre>
                            </div>
                            <div id="rfc.section.B.2.1.p.4" class="avoidbreakafter">
                                <p>This results in the following Signature-Input and Signature header fields being added
                                    to the message under the signature label <span class="tt">sig-b21</span>:</p>
                            </div>
                            <div id="rfc.section.B.2.1.p.5">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b21=();created=1618884473\
  ;keyid="test-key-rsa-pss";nonce="b3k2pp5k7z-50gnwp.yemd"
Signature: sig-b21=:d2pmTvmbncD3xQm8E9ZV2828BjQWGgiwAaw5bAkgibUopem\
  LJcWDy/lkbbHAve4cRAtx31Iq786U7it++wgGxbtRxf8Udx7zFZsckzXaJMkA7ChG\
  52eSkFxykJeNqsrWH5S+oxNFlD4dzVuwe8DhTSja8xxbR/Z2cOGdCbzR72rgFWhzx\
  2VjBqJzsPLMIQKhO4DGezXehhWwE56YCE+O6c0mKZsfxVrogUvA4HELjVKWmAvtl6\
  UnCh8jYzuVG5WSb/QEVPnP5TmcAnLH1g+s++v6d4s8m0gCw1fV5/SITLq9mhho8K3\
  +7EPYTU8IU1bLhdxO5Nyt8C8ssinQ98Xw9Q==:
</pre>
                            </div>
                            <div id="rfc.section.B.2.1.p.6">
                                <p>Note that since the covered components list is empty, this signature could be applied
                                    by an attacker to an unrelated HTTP message. In this example, the <span
                                        class="tt">nonce</span> parameter is included to prevent the same signature from
                                    being replayed more than once, but if an attacker intercepts the signature and
                                    prevents its delivery to the verifier, the attacker could apply this signature to
                                    another message. Therefore, the use of an empty covered components set is
                                    discouraged. See <a href="#security-coverage" title="Insufficient Coverage">Section
                                        7.2.1</a> for more discussion.</p>
                            </div>
                            <div id="rfc.section.B.2.1.p.7">
                                <p>Note that the RSA-PSS algorithm in use here is non-deterministic, meaning that a
                                    different signature value will be created every time the algorithm is run. The
                                    signature value provided here can be validated against the given keys, but newly
                                    generated signature values are not expected to match the example. See <a
                                        href="#security-nondeterministic"
                                        title="Non-deterministic Signature Primitives">Section 7.3.5</a>.</p>
                            </div>
                        </section>
                        <section id="selective-covered-components-using-rsa-pss-sha512">
                            <h4 id="rfc.section.B.2.2"><a href="#rfc.section.B.2.2">B.2.2.</a>&nbsp;<a
                                    href="#selective-covered-components-using-rsa-pss-sha512">Selective Covered
                                    Components Using rsa-pss-sha512</a></h4>
                            <div id="rfc.section.B.2.2.p.1">
                                <p>This example covers additional components (the authority, the Content-Digest header
                                    field, and a single named query parameter) in <span class="tt">test-request</span>
                                    using the <span class="tt">rsa-pss-sha512</span> algorithm. This example also adds a
                                    <span class="tt">tag</span> parameter with the application-specific value of <span
                                        class="tt">header-example</span>.
                                </p>
                            </div>
                            <div id="rfc.section.B.2.2.p.2" class="avoidbreakafter">
                                <p>The corresponding signature base is:</p>
                            </div>
                            <div id="rfc.section.B.2.2.p.3">
                                <pre>
NOTE: '\' line wrapping per RFC 8792

"@authority": example.com
"content-digest": sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX\
  +TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"@query-param";name="Pet": dog
"@signature-params": ("@authority" "content-digest" \
  "@query-param";name="Pet")\
  ;created=1618884473;keyid="test-key-rsa-pss"\
  ;tag="header-example"
</pre>
                            </div>
                            <div id="rfc.section.B.2.2.p.4" class="avoidbreakafter">
                                <p>This results in the following Signature-Input and Signature header fields being added
                                    to the message under the label <span class="tt">sig-b22</span>:</p>
                            </div>
                            <div id="rfc.section.B.2.2.p.5">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b22=("@authority" "content-digest" \
  "@query-param";name="Pet");created=1618884473\
  ;keyid="test-key-rsa-pss";tag="header-example"
Signature: sig-b22=:LjbtqUbfmvjj5C5kr1Ugj4PmLYvx9wVjZvD9GsTT4F7GrcQ\
  EdJzgI9qHxICagShLRiLMlAJjtq6N4CDfKtjvuJyE5qH7KT8UCMkSowOB4+ECxCmT\
  8rtAmj/0PIXxi0A0nxKyB09RNrCQibbUjsLS/2YyFYXEu4TRJQzRw1rLEuEfY17SA\
  RYhpTlaqwZVtR8NV7+4UKkjqpcAoFqWFQh62s7Cl+H2fjBSpqfZUJcsIk4N6wiKYd\
  4je2U/lankenQ99PZfB4jY3I5rSV2DSBVkSFsURIjYErOs0tFTQosMTAoxk//0RoK\
  UqiYY8Bh0aaUEb0rQl3/XaVe4bXTugEjHSw==:
</pre>
                            </div>
                            <div id="rfc.section.B.2.2.p.6">
                                <p>Note that the RSA-PSS algorithm in use here is non-deterministic, meaning that a
                                    different signature value will be created every time the algorithm is run. The
                                    signature value provided here can be validated against the given keys, but newly
                                    generated signature values are not expected to match the example. See <a
                                        href="#security-nondeterministic"
                                        title="Non-deterministic Signature Primitives">Section 7.3.5</a>.</p>
                            </div>
                        </section>
                        <section id="full-coverage-using-rsa-pss-sha512">
                            <h4 id="rfc.section.B.2.3"><a href="#rfc.section.B.2.3">B.2.3.</a>&nbsp;<a
                                    href="#full-coverage-using-rsa-pss-sha512">Full Coverage Using rsa-pss-sha512</a>
                            </h4>
                            <div id="rfc.section.B.2.3.p.1">
                                <p>This example covers all applicable message components in <span
                                        class="tt">test-request</span> (including the content type and length) plus many
                                    derived components, again using the <span class="tt">rsa-pss-sha512</span>
                                    algorithm. Note that the Host header field is not covered because the <span
                                        class="tt">@authority</span> derived component is included instead.</p>
                            </div>
                            <div id="rfc.section.B.2.3.p.2" class="avoidbreakafter">
                                <p>The corresponding signature base is:</p>
                            </div>
                            <div id="rfc.section.B.2.3.p.3">
                                <pre>
NOTE: '\' line wrapping per RFC 8792

"date": Tue, 20 Apr 2021 02:07:55 GMT
"@method": POST
"@path": /foo
"@query": ?param=Value&amp;Pet=dog
"@authority": example.com
"content-type": application/json
"content-digest": sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX\
  +TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"content-length": 18
"@signature-params": ("date" "@method" "@path" "@query" \
  "@authority" "content-type" "content-digest" "content-length")\
  ;created=1618884473;keyid="test-key-rsa-pss"
</pre>
                            </div>
                            <div id="rfc.section.B.2.3.p.4" class="avoidbreakafter">
                                <p>This results in the following Signature-Input and Signature header fields being added
                                    to the message under the label <span class="tt">sig-b23</span>:</p>
                            </div>
                            <div id="rfc.section.B.2.3.p.5">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b23=("date" "@method" "@path" "@query" \
  "@authority" "content-type" "content-digest" "content-length")\
  ;created=1618884473;keyid="test-key-rsa-pss"
Signature: sig-b23=:bbN8oArOxYoyylQQUU6QYwrTuaxLwjAC9fbY2F6SVWvh0yB\
  iMIRGOnMYwZ/5MR6fb0Kh1rIRASVxFkeGt683+qRpRRU5p2voTp768ZrCUb38K0fU\
  xN0O0iC59DzYx8DFll5GmydPxSmme9v6ULbMFkl+V5B1TP/yPViV7KsLNmvKiLJH1\
  pFkh/aYA2HXXZzNBXmIkoQoLd7YfW91kE9o/CCoC1xMy7JA1ipwvKvfrs65ldmlu9\
  bpG6A9BmzhuzF8Eim5f8ui9eH8LZH896+QIF61ka39VBrohr9iyMUJpvRX2Zbhl5Z\
  JzSRxpJyoEZAFL2FUo5fTIztsDZKEgM4cUA==:
</pre>
                            </div>
                            <div id="rfc.section.B.2.3.p.6">
                                <p>Note in this example that the value of the Date header field and the value of the
                                    <span class="tt">created</span> signature parameter need not be the same. This is
                                    due to the fact that the Date header field is added when creating the HTTP message
                                    and the <span class="tt">created</span> parameter is populated when creating the
                                    signature over that message, and these two times could vary. If the Date header
                                    field is covered by the signature, it is up to the verifier to determine whether its
                                    value has to match that of the <span class="tt">created</span> parameter or not. See
                                    <a href="#security-not-fields"
                                        title="Choosing Signature Parameters and Derived Components over HTTP Fields">Section
                                        7.2.4</a> for more discussion.
                                </p>
                            </div>
                            <div id="rfc.section.B.2.3.p.7">
                                <p>Note that the RSA-PSS algorithm in use here is non-deterministic, meaning that a
                                    different signature value will be created every time the algorithm is run. The
                                    signature value provided here can be validated against the given keys, but newly
                                    generated signature values are not expected to match the example. See <a
                                        href="#security-nondeterministic"
                                        title="Non-deterministic Signature Primitives">Section 7.3.5</a>.</p>
                            </div>
                        </section>
                        <section id="signing-a-response-using-ecdsa-p256-sha256">
                            <h4 id="rfc.section.B.2.4"><a href="#rfc.section.B.2.4">B.2.4.</a>&nbsp;<a
                                    href="#signing-a-response-using-ecdsa-p256-sha256">Signing a Response Using
                                    ecdsa-p256-sha256</a></h4>
                            <div id="rfc.section.B.2.4.p.1">
                                <p>This example covers portions of the <span class="tt">test-response</span> message
                                    using the <span class="tt">ecdsa-p256-sha256</span> algorithm and the key <span
                                        class="tt">test-key-ecc-p256</span>.</p>
                            </div>
                            <div id="rfc.section.B.2.4.p.2" class="avoidbreakafter">
                                <p>The corresponding signature base is:</p>
                            </div>
                            <div id="rfc.section.B.2.4.p.3">
                                <pre>
NOTE: '\' line wrapping per RFC 8792

"@status": 200
"content-type": application/json
"content-digest": sha-512=:mEWXIS7MaLRuGgxOBdODa3xqM1XdEvxoYhvlCFJ4\
  1QJgJc4GTsPp29l5oGX69wWdXymyU0rjJuahq4l5aGgfLQ==:
"content-length": 23
"@signature-params": ("@status" "content-type" "content-digest" \
  "content-length");created=1618884473;keyid="test-key-ecc-p256"
</pre>
                            </div>
                            <div id="rfc.section.B.2.4.p.4" class="avoidbreakafter">
                                <p>This results in the following Signature-Input and Signature header fields being added
                                    to the message under the label <span class="tt">sig-b24</span>:</p>
                            </div>
                            <div id="rfc.section.B.2.4.p.5">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b24=("@status" "content-type" \
  "content-digest" "content-length");created=1618884473\
  ;keyid="test-key-ecc-p256"
Signature: sig-b24=:wNmSUAhwb5LxtOtOpNa6W5xj067m5hFrj0XQ4fvpaCLx0NK\
  ocgPquLgyahnzDnDAUy5eCdlYUEkLIj+32oiasw==:
</pre>
                            </div>
                            <div id="rfc.section.B.2.4.p.6">
                                <p>Note that the ECDSA signature algorithm in use here is non-deterministic, meaning
                                    that a different signature value will be created every time the algorithm is run.
                                    The signature value provided here can be validated against the given keys, but newly
                                    generated signature values are not expected to match the example. See <a
                                        href="#security-nondeterministic"
                                        title="Non-deterministic Signature Primitives">Section 7.3.5</a>.</p>
                            </div>
                        </section>
                        <section id="signing-a-request-using-hmac-sha256">
                            <h4 id="rfc.section.B.2.5"><a href="#rfc.section.B.2.5">B.2.5.</a>&nbsp;<a
                                    href="#signing-a-request-using-hmac-sha256">Signing a Request Using hmac-sha256</a>
                            </h4>
                            <div id="rfc.section.B.2.5.p.1">
                                <p>This example covers portions of the <span class="tt">test-request</span> message
                                    using the <span class="tt">hmac-sha256</span> algorithm and the secret <span
                                        class="tt">test-shared-secret</span>.</p>
                            </div>
                            <div id="rfc.section.B.2.5.p.2" class="avoidbreakafter">
                                <p>The corresponding signature base is:</p>
                            </div>
                            <div id="rfc.section.B.2.5.p.3">
                                <pre>
NOTE: '\' line wrapping per RFC 8792

"date": Tue, 20 Apr 2021 02:07:55 GMT
"@authority": example.com
"content-type": application/json
"@signature-params": ("date" "@authority" "content-type")\
  ;created=1618884473;keyid="test-shared-secret"
</pre>
                            </div>
                            <div id="rfc.section.B.2.5.p.4" class="avoidbreakafter">
                                <p>This results in the following Signature-Input and Signature header fields being added
                                    to the message under the label <span class="tt">sig-b25</span>:</p>
                            </div>
                            <div id="rfc.section.B.2.5.p.5">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b25=("date" "@authority" "content-type")\
  ;created=1618884473;keyid="test-shared-secret"
Signature: sig-b25=:pxcQw6G3AjtMBQjwo8XzkZf/bws5LelbaMk5rGIGtE8=:
</pre>
                            </div>
                            <div id="rfc.section.B.2.5.p.6">
                                <p>Before using symmetric signatures in practice, see the discussion regarding security
                                    trade-offs in <a href="#security-symmetric" title="Symmetric Cryptography">Section
                                        7.3.3</a>.</p>
                            </div>
                        </section>
                        <section id="signing-a-request-using-ed25519">
                            <h4 id="rfc.section.B.2.6"><a href="#rfc.section.B.2.6">B.2.6.</a>&nbsp;<a
                                    href="#signing-a-request-using-ed25519">Signing a Request Using ed25519</a></h4>
                            <div id="rfc.section.B.2.6.p.1">
                                <p>This example covers portions of the <span class="tt">test-request</span> message
                                    using the <span class="tt">Ed25519</span> algorithm and the key <span
                                        class="tt">test-key-ed25519</span>.</p>
                            </div>
                            <div id="rfc.section.B.2.6.p.2" class="avoidbreakafter">
                                <p>The corresponding signature base is:</p>
                            </div>
                            <div id="rfc.section.B.2.6.p.3">
                                <pre>
NOTE: '\' line wrapping per RFC 8792

"date": Tue, 20 Apr 2021 02:07:55 GMT
"@method": POST
"@path": /foo
"@authority": example.com
"content-type": application/json
"content-length": 18
"@signature-params": ("date" "@method" "@path" "@authority" \
  "content-type" "content-length");created=1618884473\
  ;keyid="test-key-ed25519"
</pre>
                            </div>
                            <div id="rfc.section.B.2.6.p.4" class="avoidbreakafter">
                                <p>This results in the following Signature-Input and Signature header fields being added
                                    to the message under the label <span class="tt">sig-b26</span>:</p>
                            </div>
                            <div id="rfc.section.B.2.6.p.5">
                                <pre class="text">
NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b26=("date" "@method" "@path" "@authority" \
  "content-type" "content-length");created=1618884473\
  ;keyid="test-key-ed25519"
Signature: sig-b26=:wqcAqbmYJ2ji2glfAMaRy4gruYYnx2nEFN2HN6jrnDnQCK1\
  u02Gb04v9EDgwUPiu4A0w6vuQv5lIp5WPpBKRCw==:
</pre>
                            </div>
                        </section>
                    </section>
                    <section id="tls-terminating-proxies">
                        <h3 id="rfc.section.B.3"><a href="#rfc.section.B.3">B.3.</a>&nbsp;<a
                                href="#tls-terminating-proxies">TLS-Terminating Proxies</a></h3>
                        <div id="rfc.section.B.3.p.1">
                            <p>In this example, there is a TLS-terminating reverse proxy sitting in front of the
                                resource. The client does not sign the request but instead uses mutual TLS to make its
                                call. The terminating proxy validates the TLS stream and injects a Client-Cert header
                                field according to <a href="#RFC9440"><cite
                                        title="Client-Cert HTTP Header Field">[CLIENT-CERT]</cite></a>, and then applies
                                a signature to this field. By signing this header field, a reverse proxy not only can
                                attest to its own validation of the initial request's TLS parameters but can also
                                authenticate itself to the backend system independently of the client's actions.</p>
                        </div>
                        <div id="rfc.section.B.3.p.2" class="avoidbreakafter">
                            <p>The client makes the following request to the TLS-terminating proxy using mutual TLS:</p>
                        </div>
                        <div id="rfc.section.B.3.p.3">
                            <pre class="text">
POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.B.3.p.4" class="avoidbreakafter">
                            <p>The proxy processes the TLS connection and extracts the client's TLS certificate to a
                                Client-Cert header field and passes it along to the internal service hosted at <span
                                    class="tt">service.internal.example</span>. This results in the following unsigned
                                request:</p>
                        </div>
                        <div id="rfc.section.B.3.p.5">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: service.internal.example
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18
Client-Cert: :MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQKD\
  BJMZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQT\
  AeFw0yMDAxMTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDMFk\
  wEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXmck\
  C8vdgJ1p5Be5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQYDV\
  R0TBAIwADAfBgNVHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8BAf\
  8EBAMCBsAwEwYDVR0lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQGV\
  4YW1wbGUuY29tMAoGCCqGSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0Q6\
  bMjeSkC3dFCOOB8TAiEAx/kHSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=:

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.B.3.p.6" class="avoidbreakafter">
                            <p>Without a signature, the internal service would need to trust that the incoming
                                connection has the right information. By signing the Client-Cert header field and other
                                portions of the internal request, the internal service can be assured that the correct
                                party, the trusted proxy, has processed the request and presented it to the correct
                                service. The proxy's signature base consists of the following:</p>
                        </div>
                        <div id="rfc.section.B.3.p.7">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

"@path": /foo
"@query": ?param=Value&amp;Pet=dog
"@method": POST
"@authority": service.internal.example
"client-cert": :MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQ\
  KDBJMZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBD\
  QTAeFw0yMDAxMTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDM\
  FkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXm\
  ckC8vdgJ1p5Be5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQY\
  DVR0TBAIwADAfBgNVHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8B\
  Af8EBAMCBsAwEwYDVR0lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQ\
  GV4YW1wbGUuY29tMAoGCCqGSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0\
  Q6bMjeSkC3dFCOOB8TAiEAx/kHSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=:
"@signature-params": ("@path" "@query" "@method" "@authority" \
  "client-cert");created=1618884473;keyid="test-key-ecc-p256"
</pre>
                        </div>
                        <div id="rfc.section.B.3.p.8" class="avoidbreakafter">
                            <p>This results in the following signature:</p>
                        </div>
                        <div id="rfc.section.B.3.p.9">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

xVMHVpawaAC/0SbHrKRs9i8I3eOs5RtTMGCWXm/9nvZzoHsIg6Mce9315T6xoklyy0y\
zhD9ah4JHRwMLOgmizw==
</pre>
                        </div>
                        <div id="rfc.section.B.3.p.10" class="avoidbreakafter">
                            <p>which results in the following signed request sent from the proxy to the internal service
                                with the proxy's signature under the label <span class="tt">ttrp</span>:</p>
                        </div>
                        <div id="rfc.section.B.3.p.11">
                            <pre>
NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: service.internal.example
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18
Client-Cert: :MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQKD\
  BJMZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQT\
  AeFw0yMDAxMTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDMFk\
  wEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXmck\
  C8vdgJ1p5Be5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQYDV\
  R0TBAIwADAfBgNVHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8BAf\
  8EBAMCBsAwEwYDVR0lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQGV\
  4YW1wbGUuY29tMAoGCCqGSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0Q6\
  bMjeSkC3dFCOOB8TAiEAx/kHSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=:
Signature-Input: ttrp=("@path" "@query" "@method" "@authority" \
  "client-cert");created=1618884473;keyid="test-key-ecc-p256"
Signature: ttrp=:xVMHVpawaAC/0SbHrKRs9i8I3eOs5RtTMGCWXm/9nvZzoHsIg6\
  Mce9315T6xoklyy0yzhD9ah4JHRwMLOgmizw==:

{"hello": "world"}
</pre>
                        </div>
                        <div id="rfc.section.B.3.p.12">
                            <p>The internal service can validate the proxy's signature and therefore be able to trust
                                that the client's certificate has been appropriately processed.</p>
                        </div>
                    </section>
                    <section id="example-transform">
                        <h3 id="rfc.section.B.4"><a href="#rfc.section.B.4">B.4.</a>&nbsp;<a
                                href="#example-transform">HTTP Message Transformations</a></h3>
                        <div id="rfc.section.B.4.p.1">
                            <p>HTTP allows intermediaries and applications to transform an HTTP message without
                                affecting the semantics of the message itself. HTTP message signatures are designed to
                                be robust against many of these transformations in different circumstances.</p>
                        </div>
                        <div id="rfc.section.B.4.p.2" class="avoidbreakafter">
                            <p>For example, the following HTTP request message has been signed using the <span
                                    class="tt">Ed25519</span> algorithm and the key <span
                                    class="tt">test-key-ed25519</span>:</p>
                        </div>
                        <div id="rfc.section.B.4.p.3">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

GET /demo?name1=Value1&amp;Name2=value2 HTTP/1.1
Host: example.org
Date: Fri, 15 Jul 2022 14:24:55 GMT
Accept: application/json
Accept: */*
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre>
                        </div>
                        <div id="rfc.section.B.4.p.4" class="avoidbreakafter">
                            <p>The signature base string for this message is:</p>
                        </div>
                        <div id="rfc.section.B.4.p.5">
                            <pre>
"@method": GET
"@path": /demo
"@authority": example.org
"accept": application/json, */*
"@signature-params": ("@method" "@path" "@authority" "accept")\
  ;created=1618884473;keyid="test-key-ed25519"
</pre>
                        </div>
                        <div id="rfc.section.B.4.p.6" class="avoidbreakafter">
                            <p>The following message has been altered by adding the Accept-Language header field as well
                                as adding a query parameter. However, since neither the Accept-Language header field nor
                                the query is covered by the signature, the same signature is still valid:</p>
                        </div>
                        <div id="rfc.section.B.4.p.7">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

GET /demo?name1=Value1&amp;Name2=value2&amp;param=added HTTP/1.1
Host: example.org
Date: Fri, 15 Jul 2022 14:24:55 GMT
Accept: application/json
Accept: */*
Accept-Language: en-US,en;q=0.5
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre>
                        </div>
                        <div id="rfc.section.B.4.p.8" class="avoidbreakafter">
                            <p>The following message has been altered by removing the Date header field, adding a
                                Referer header field, and collapsing the Accept header field into a single line. The
                                Date and Referer header fields are not covered by the signature, and the collapsing of
                                the Accept header field is an allowed transformation that is already accounted for by
                                the canonicalization algorithm for HTTP field values. The same signature is still valid:
                            </p>
                        </div>
                        <div id="rfc.section.B.4.p.9">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

GET /demo?name1=Value1&amp;Name2=value2 HTTP/1.1
Host: example.org
Referer: https://developer.example.org/demo
Accept: application/json, */*
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre>
                        </div>
                        <div id="rfc.section.B.4.p.10" class="avoidbreakafter">
                            <p>The following message has been altered by reordering the field values of the original
                                message but not reordering the individual Accept header fields. The same signature is
                                still valid:</p>
                        </div>
                        <div id="rfc.section.B.4.p.11">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

GET /demo?name1=Value1&amp;Name2=value2 HTTP/1.1
Accept: application/json
Accept: */*
Date: Fri, 15 Jul 2022 14:24:55 GMT
Host: example.org
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre>
                        </div>
                        <div id="rfc.section.B.4.p.12" class="avoidbreakafter">
                            <p>The following message has been altered by changing the method to POST and the authority
                                to "example.com" (inside the Host header field). Since both the method and authority are
                                covered by the signature, the same signature is NOT still valid:</p>
                        </div>
                        <div id="rfc.section.B.4.p.13">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

POST /demo?name1=Value1&amp;Name2=value2 HTTP/1.1
Host: example.com
Date: Fri, 15 Jul 2022 14:24:55 GMT
Accept: application/json
Accept: */*
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre>
                        </div>
                        <div id="rfc.section.B.4.p.14" class="avoidbreakafter">
                            <p>The following message has been altered by changing the order of the two instances of the
                                Accept header field. Since the order of fields with the same name is semantically
                                significant in HTTP, this changes the value used in the signature base, and the same
                                signature is NOT still valid:</p>
                        </div>
                        <div id="rfc.section.B.4.p.15">
                            <pre class="text">
NOTE: '\' line wrapping per RFC 8792

GET /demo?name1=Value1&amp;Name2=value2 HTTP/1.1
Host: example.org
Date: Fri, 15 Jul 2022 14:24:55 GMT
Accept: */*
Accept: application/json
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="acknowledgements">
                    <h2 id="rfc.section.unnumbered-4" class="np"><a href="#acknowledgements">Acknowledgements</a></h2>
                    <div id="rfc.section.unnumbered-4.p.1">
                        <p>This specification was initially based on <a href="#I-D.cavage-http-signatures"><cite
                                    title="Signing HTTP Messages">[SIGNING-HTTP-MESSAGES]</cite></a>. The editors would
                            like to thank the authors of <a href="#I-D.cavage-http-signatures"><cite
                                    title="Signing HTTP Messages">[SIGNING-HTTP-MESSAGES]</cite></a> -- Mark Cavage and
                            Manu Sporny -- for their work on that Internet-Draft and their continuing contributions.
                            This specification also includes contributions from <a href="#SIGNING-HTTP-REQS-OAUTH"><cite
                                    title="A Method for Signing HTTP Requests for OAuth">[SIGNING-HTTP-REQS-OAUTH]</cite></a>
                            and other similar efforts.</p>
                    </div>
                    <div id="rfc.section.unnumbered-4.p.2">
                        <p>The editors would also like to thank the following individuals (listed in alphabetical order)
                            for feedback, insight, and implementation of this document and its predecessors: Mark
                            Adamcin, Mark Allen, Paul Annesley, Karl Böhlmark, Stéphane Bortzmeyer, Sarven Capadisli,
                            Liam Dennehy, Stephen Farrell, Phillip Hallam-Baker, Tyler Ham, Eric Holmes, Andrey Kislyuk,
                            Adam Knight, Dave Lehn, Ilari Liusvaara, Dave Longley, James H. Manger, Kathleen Moriarty,
                            Yoav Nir, Mark Nottingham, Adrian Palmer, Lucas Pardue, Roberto Polli, Julian Reschke,
                            Michael Richardson, Wojciech Rygielski, Rich Salz, Adam Scarr, Cory J. Slep, Dirk Stein,
                            Henry Story, Lukasz Szewc, Chris Webber, and Jeffrey Yasskin.</p>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="rfc.authors" class="np">
                    <h2><a href="#rfc.authors">Authors' Addresses</a></h2>
                    <address><b>Annabelle Backman</b> (editor)<br>Amazon<br>P.O. Box 81226<br>Seattle, WA
                        98108-1226<br>United States of America<br>EMail: <a
                            href="mailto:richanna@amazon.com">richanna@amazon.com</a><br>URI: <a
                            href="https://www.amazon.com/">https://www.amazon.com/</a></address>
                    <address><b>Justin Richer</b> (editor)<br>Bespoke Engineering<br>EMail: <a
                            href="mailto:ietf@justin.richer.org">ietf@justin.richer.org</a><br>URI: <a
                            href="https://bspk.io/">https://bspk.io/</a></address>
                    <address><b>Manu Sporny</b><br>Digital Bazaar<br>203 Roanoke Street W.<br>Blacksburg, VA
                        24060<br>United States of America<br>EMail: <a
                            href="mailto:msporny@digitalbazaar.com">msporny@digitalbazaar.com</a></address>
                </section>
            </div>
        </div>
    </div>
    <script src="/assets/node_modules/jquery/dist/jquery.min.js"></script>
    <script src="/assets/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
</body>

</html>