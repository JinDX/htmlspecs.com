<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>RFC 9440 - Client-Cert HTTP Header Field</title>
    <script>
        function getMeta(rfcno, container) {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "https://www.rfc-editor.org/rfc/rfc" + rfcno + ".json", true);
            xhr.onload = function (e) {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        var data = JSON.parse(xhr.response);

                        var cont = document.getElementById(container);
                        // empty the container
                        while (cont.firstChild) {
                            cont.removeChild(myNode.firstChild);
                        }

                        var c = data.status;
                        if (c) {
                            var bld = newElementWithText("b", c);
                            cont.appendChild(bld);
                        } else {
                            cont.appendChild(newElementWithText("i", "(document status unknown)"));
                        }

                        c = data.updated_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Updated by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.obsoleted_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Obsoleted by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.errata_url;
                        if (c) {
                            cont.appendChild(newElement("br"));
                            var link = newElementWithText("a", "errata");
                            link.setAttribute("href", c);
                            var errata = newElementWithText("i", "This document has ");
                            errata.appendChild(link);
                            errata.appendChild(newText("."));
                            cont.appendChild(errata);
                        }

                        cont.style.display = "block";
                    } else {
                        console.error(xhr.statusText);
                    }
                }
            };
            xhr.onerror = function (e) {
                console.error(xhr.status + " " + xhr.statusText);
            };
            xhr.send(null);
        }
        function appendRfcLinks(parent, updates) {
            var template = "https://www.rfc-editor.org/rfc/rfc{rfc}.html";
            for (var i = 0; i < updates.length; i++) {
                var rfc = updates[i].trim().toLowerCase();
                if (rfc.substring(0, 3) == "rfc") {
                    var no = parseInt(rfc.substring(3), 10);

                    var link = newElement("a");
                    link.setAttribute("href", template.replace("{rfc}", no));
                    link.appendChild(newText(no));
                    parent.appendChild(link);
                } else {
                    parent.appendChild(newText(rfc));
                }
                if (i != updates.length - 1) {
                    parent.appendChild(newText(", "));
                }
            }
        }

        // DOM helpers
        function newElement(name) {
            return document.createElement(name);
        }
        function newElementWithText(name, txt) {
            var e = document.createElement(name);
            e.appendChild(newText(txt));
            return e;
        }
        function newText(text) {
            return document.createTextNode(text);
        }
    </script>
    <script>
        function anchorRewrite() {
            map = {};
            if (window.location.hash.length >= 1) {
                var fragid = window.location.hash.substr(1);
                if (fragid) {
                    if (!document.getElementById(fragid)) {
                        var prefix = "rfc.";
                        var mapped = map[fragid];
                        if (mapped) {
                            window.location.hash = mapped;
                        } else if (fragid.indexOf("section-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(8).replace("-", ".p.");
                        } else if (fragid.indexOf("appendix-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(9).replace("-", ".p.");
                        } else if (fragid.indexOf("s-") == 0) {
                            var postfix = fragid.substring(2);
                            if (postfix.startsWith("abstract")) {
                                window.location.hash = prefix + postfix;
                            } else if (postfix.startsWith("note-")) {
                                window.location.hash = prefix + "note." + postfix.substring(5).replace("-", ".p.");
                            } else {
                                window.location.hash = prefix + "section." + postfix.replace("-", ".p.");
                            }
                        } else if (fragid.indexOf("p-") == 0) {
                            var r = fragid.substring(2);
                            var p = r.indexOf("-");
                            if (p >= 0) {
                                window.location.hash = prefix + "section." + r.substring(0, p) + ".p." + r.substring(p + 1);
                            }
                        }
                    }
                }
            }
        }
        window.addEventListener('hashchange', anchorRewrite);
        window.addEventListener('DOMContentLoaded', anchorRewrite);
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:type" content="article">
    <meta property="og:title" content="RFC9440">
    <meta property="og:description" content="Client-Cert HTTP Header Field">
    <meta property="og:url" content="https://httpwg.org/specs/rfc9440.html">
    <meta property="og:site_name" content="IETF HTTP Working Group Specifications">
    <meta property="og:image" content="https://httpwg.org/assets/favicon/apple-icon-180x180.png">
    <link rel="stylesheet" type="text/css" href="/assets/node_modules/bootstrap/dist/css/bootstrap.min.css">
    <style type="text/css">
        body {
            padding-top: 80px;
            padding-bottom: 80px;
            position: relative;
        }

        .table.header th,
        .table.header td {
            border-top: none;
            padding: 0;
        }

        #sidebar {
            margin-top: -10px;
            height: 90%;
            overflow-y: auto;
            font-size: 90%;
        }

        #rfc\.meta {
            width: 40%;
            float: right
        }

        .toc ul {
            list-style: none;
        }

        .filename {
            color: rgb(119, 119, 119);
            font-size: 23px;
            font-weight: normal;
            height: auto;
            line-height: 23px;
        }

        dl {
            margin-left: 1em;
        }

        dl.dl-horizontal: {
            margin-left: 0;
        }

        dl>dt {
            float: left;
            margin-right: 1em;
        }

        dl.nohang>dt {
            float: none;
        }

        dl>dd {
            margin-bottom: .5em;
        }

        dl.compact>dd {
            margin-bottom: 0em;
        }

        dl>dd>dl {
            margin-top: 0.5em;
            margin-bottom: 0em;
        }

        ul.empty {
            list-style-type: none;
        }

        ul.empty li {
            margin-top: .5em;
        }

        td.reference {
            padding-right: 1em;
            vertical-align: top;
        }

        .feedback {
            position: fixed;
            bottom: 5px;
            right: 5px;
        }

        .fbbutton {
            margin-left: 5px;
        }

        h1 a,
        h2 a,
        h3 a,
        h4 a,
        h5 a,
        h6 a {
            color: rgb(51, 51, 51);
        }

        span.tt {
            font: 11pt consolas, monospace;
            font-size-adjust: none;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="/assets/site.css">
    <link rel="Contents" href="#rfc.toc">
    <link rel="Author" href="#rfc.authors">
    <link rel="License" href="#rfc.copyrightnotice">
    <link rel="Chapter" title="1 Introduction" href="#rfc.section.1">
    <link rel="Chapter" title="2 HTTP Header Fields and Processing Rules" href="#rfc.section.2">
    <link rel="Chapter" title="3 Deployment Considerations" href="#rfc.section.3">
    <link rel="Chapter" title="4 Security Considerations" href="#rfc.section.4">
    <link rel="Chapter" title="5 IANA Considerations" href="#rfc.section.5">
    <link rel="Chapter" title="6 References" href="#rfc.section.6">
    <link rel="Appendix" title="A Example" href="#rfc.section.A">
    <link rel="Appendix" title="B Select Design Considerations" href="#rfc.section.B">
    <link rel="Appendix" title="Acknowledgements" href="#rfc.section.unnumbered-4">
    <link href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-client-cert-field-06" rel="prev">
    <link href="https://dx.doi.org/10.17487/rfc9440" rel="alternate">
    <link href="urn:issn:2070-1721" rel="alternate">
    <link rel="Alternate" title="Plain Text Version" href="http://www.ietf.org/rfc/rfc9440.txt">
    <link rel="Help" title="RFC-Editor's Status Page" href="https://www.rfc-editor.org/info/rfc9440">
    <meta name="viewport" content="initial-scale=1">
    <meta name="generator"
        content="https://github.com/mnot/RFCBootstrap XSLT vendor: Saxonica http://www.saxonica.com/">
    <meta name="keywords" content="http, client certificate">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <meta name="dcterms.creator" content="Campbell, B.">
    <meta name="dcterms.creator" content="Bishop, M.">
    <meta name="dcterms.identifier" content="urn:ietf:rfc:9440">
    <meta name="dcterms.issued" content="2023-07">
    <meta name="dcterms.abstract"
        content="This document describes HTTP extension header fields that allow a TLS terminating reverse proxy (TTRP) to convey the client certificate information of a mutually authenticated TLS connection to the origin server in a common and predictable manner.">
    <meta name="dcterms.isPartOf" content="urn:issn:2070-1721">
    <meta name="description"
        content="This document describes HTTP extension header fields that allow a TLS terminating reverse proxy (TTRP) to convey the client certificate information of a mutually authenticated TLS connection to the origin server in a common and predictable manner.">
</head>

<body onload="getMeta(9440,&#34;rfc.meta&#34;);">
    <nav class="navbar navbar-dark bg-dark d-print-none navbar-expand-lg fixed-top ps-3 pe-3" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse"
                aria-controls="navbarToggler" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <a class="navbar-brand" href="https://httpwg.org/"><img src="https://httpwg.org/assets/http.svg"
                    height="23"></a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse">

            <div class="navbar-nav me-auto">

                <a class="nav-item ms-1 text-white" href="https://httpwg.org/specs/">📄 Documentation</a>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Work in
                        Progress</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/http-extensions/">HTTP Extensions</a></li>
                        <li class="dropdown-item"><a
                                href="https://github.com/httpwg/admin/issues?q=is%3Aissue+is%3Aopen+label%3Aadoption">Future
                                Work</a></li>
                    </ul>
                </div>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Participate</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/about/">About the HTTP Working Group</a>
                        </li>
                        <li class="divider"></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/CONTRIBUTING.html">Contribution Policy</a>
                        </li>
                        <li class="dropdown-item"><a href="http://datatracker.ietf.org/wg/httpbis/charter/">WG
                                Charter</a></li>
                        <li class="dropdown-item"><a href="http://lists.w3.org/Archives/Public/ietf-http-wg/">Group
                                Mailing List 📨</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/wg-materials/">Meeting Materials</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/admin/editors/">Document Editor
                                Resources</a></li>
                    </ul>
                </div>
            </div>

        </div>
    </nav>
    <div class="container" id="top">
        <div class="row">
            <div class="col-lg-4 order-last d-none d-lg-block" id="sidebar" role="navigation">
                <div class="navbar">
                    <div class="navbar-brand"><a href="#top"><strong>RFC </strong>9440</a></div><br clear="all">
                    <div class="">
                        <div class="toc ">
                            <ul>
                                <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#Introduction">Introduction</a>
                                    <ul>
                                        <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#requirements-notation-and-conventions">Requirements Notation and
                                                Conventions</a></li>
                                        <li><a href="#rfc.section.1.2">1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#terminology-and-applicability">Terminology and Applicability</a>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#headers">HTTP Header
                                        Fields and Processing Rules</a>
                                    <ul>
                                        <li><a href="#rfc.section.2.1">2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#encoding">Encoding</a></li>
                                        <li><a href="#rfc.section.2.2">2.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#header">Client-Cert HTTP Header Field</a></li>
                                        <li><a href="#rfc.section.2.3">2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#chain-header">Client-Cert-Chain HTTP Header Field</a></li>
                                        <li><a href="#rfc.section.2.4">2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#processing-rules">Processing Rules</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#deployment">Deployment
                                        Considerations</a>
                                    <ul>
                                        <li><a href="#rfc.section.3.1">3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#header-field-compression">Header Field Compression</a></li>
                                        <li><a href="#rfc.section.3.2">3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#message-header-size">Message Header Size</a></li>
                                        <li><a href="#rfc.section.3.3">3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#tls-session-resumption">TLS Session Resumption</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#sec">Security
                                        Considerations</a></li>
                                <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#iana-considerations">IANA
                                        Considerations</a>
                                    <ul>
                                        <li><a href="#rfc.section.5.1">5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#http-field-name-registrations">HTTP Field Name Registrations</a>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references">References</a>
                                    <ul>
                                        <li><a href="#rfc.section.6.1">6.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.2">Normative References</a></li>
                                        <li><a href="#rfc.section.6.2">6.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.3">Informative References</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.A">Appendix A.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#example">Example</a></li>
                                <li><a href="#rfc.section.B">Appendix B.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#select-design-considerations">Select Design Considerations</a>
                                    <ul>
                                        <li><a href="#rfc.section.B.1">B.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#field-injection">Field Injection</a></li>
                                        <li><a href="#rfc.section.B.2">B.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#the-forwarded-http-extension">The Forwarded HTTP Extension</a>
                                        </li>
                                        <li><a href="#rfc.section.B.3">B.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#the-whole-certificate-and-certificate-chain">The Whole
                                                Certificate and Certificate Chain</a></li>
                                    </ul>
                                </li>
                                <li><a href="#acknowledgements">Acknowledgements</a></li>
                                <li><a href="#rfc.authors">Authors' Addresses</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-8 order-first main" role="main">
                <header>
                    <table class="table table-condensed header" id="rfc.headerblock">
                        <tbody>
                            <tr>
                                <td class="text-left">Internet Engineering Task Force (IETF)</td>
                                <td class="text-right">B. Campbell</td>
                            </tr>
                            <tr>
                                <td class="text-left">Request for Comments: 9440</td>
                                <td class="text-right">Ping Identity</td>
                            </tr>
                            <tr>
                                <td class="text-left">Category: Informational</td>
                                <td class="text-right">M. Bishop, Editor</td>
                            </tr>
                            <tr>
                                <td class="text-left">ISSN: 2070-1721</td>
                                <td class="text-right">Akamai</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">July 2023</td>
                            </tr>
                        </tbody>
                    </table>
                    <div id="rfc.title">
                        <h1>Client-Cert HTTP Header Field</h1>
                    </div>
                </header>
                <hr>
                <h2 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h2>
                <div class="lead">
                    <div id="rfc.abstract.p.1">
                        <p>This document describes HTTP extension header fields that allow a TLS terminating reverse
                            proxy (TTRP) to convey the client certificate information of a mutually authenticated TLS
                            connection to the origin server in a common and predictable manner.</p>
                    </div>
                </div>
                <aside id="rfc.meta" class="alert alert-info"></aside>
                <section id="rfc.status">
                    <h2><a href="#rfc.status">Status of This Memo</a></h2>
                    <div id="rfc.boilerplate.1.p.1">
                        <p>This document is not an Internet Standards Track specification; it is published for
                            informational purposes.</p>
                    </div>
                    <div id="rfc.boilerplate.1.p.2">
                        <p>This document is a product of the Internet Engineering Task Force (IETF). It represents the
                            consensus of the IETF community. It has received public review and has been approved for
                            publication by the Internet Engineering Steering Group (IESG). Not all documents approved by
                            the IESG are candidates for any level of Internet Standard; see <a
                                href="https://www.rfc-editor.org/rfc/rfc7841.html#section-2">Section 2 of RFC 7841</a>.
                        </p>
                    </div>
                    <div id="rfc.boilerplate.1.p.3">
                        <p>Information about the current status of this document, any errata, and how to provide
                            feedback on it may be obtained at <a
                                href="https://www.rfc-editor.org/info/rfc9440">https://www.rfc-editor.org/info/rfc9440</a>.
                        </p>
                    </div>
                </section>
                <section id="rfc.copyrightnotice">
                    <h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2>
                    <div id="rfc.boilerplate.2.p.1">
                        <p>Copyright (c) 2023 IETF Trust and the persons identified as the document authors. All rights
                            reserved.</p>
                    </div>
                    <div id="rfc.boilerplate.2.p.2">
                        <p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF
                            Documents (<a
                                href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>)
                            in effect on the date of publication of this document. Please review these documents
                            carefully, as they describe your rights and restrictions with respect to this document. Code
                            Components extracted from this document must include Revised BSD License text as described
                            in Section 4.e of the Trust Legal Provisions and are provided without warranty as described
                            in the Revised BSD License.</p>
                    </div>
                </section>
                <div class="toc d-lg-none">
                    <ul>
                        <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#Introduction">Introduction</a>
                            <ul>
                                <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#requirements-notation-and-conventions">Requirements Notation and
                                        Conventions</a></li>
                                <li><a href="#rfc.section.1.2">1.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#terminology-and-applicability">Terminology and Applicability</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#headers">HTTP Header Fields and
                                Processing Rules</a>
                            <ul>
                                <li><a href="#rfc.section.2.1">2.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#encoding">Encoding</a></li>
                                <li><a href="#rfc.section.2.2">2.2.</a>&nbsp;&nbsp;&nbsp;<a href="#header">Client-Cert
                                        HTTP Header Field</a></li>
                                <li><a href="#rfc.section.2.3">2.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#chain-header">Client-Cert-Chain HTTP Header Field</a></li>
                                <li><a href="#rfc.section.2.4">2.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#processing-rules">Processing Rules</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#deployment">Deployment
                                Considerations</a>
                            <ul>
                                <li><a href="#rfc.section.3.1">3.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#header-field-compression">Header Field Compression</a></li>
                                <li><a href="#rfc.section.3.2">3.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#message-header-size">Message Header Size</a></li>
                                <li><a href="#rfc.section.3.3">3.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#tls-session-resumption">TLS Session Resumption</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#sec">Security Considerations</a>
                        </li>
                        <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#iana-considerations">IANA
                                Considerations</a>
                            <ul>
                                <li><a href="#rfc.section.5.1">5.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#http-field-name-registrations">HTTP Field Name Registrations</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">References</a>
                            <ul>
                                <li><a href="#rfc.section.6.1">6.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.2">Normative References</a></li>
                                <li><a href="#rfc.section.6.2">6.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.3">Informative References</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.A">Appendix A.</a>&nbsp;&nbsp;&nbsp;<a href="#example">Example</a>
                        </li>
                        <li><a href="#rfc.section.B">Appendix B.</a>&nbsp;&nbsp;&nbsp;<a
                                href="#select-design-considerations">Select Design Considerations</a>
                            <ul>
                                <li><a href="#rfc.section.B.1">B.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#field-injection">Field Injection</a></li>
                                <li><a href="#rfc.section.B.2">B.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#the-forwarded-http-extension">The Forwarded HTTP Extension</a></li>
                                <li><a href="#rfc.section.B.3">B.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#the-whole-certificate-and-certificate-chain">The Whole Certificate and
                                        Certificate Chain</a></li>
                            </ul>
                        </li>
                        <li><a href="#acknowledgements">Acknowledgements</a></li>
                        <li><a href="#rfc.authors">Authors' Addresses</a></li>
                    </ul>
                </div>
                <hr class="hidden-print">
                <section id="Introduction">
                    <h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a
                            href="#Introduction">Introduction</a></h2>
                    <div id="rfc.section.1.p.1">
                        <p>A fairly common deployment pattern for HTTPS applications is to have the origin HTTP
                            application servers sit behind a reverse proxy that terminates TLS connections from clients.
                            The proxy is accessible to the Internet and dispatches client requests to the appropriate
                            origin server within a private or protected network. The origin servers are not directly
                            accessible by clients and are only reachable through the reverse proxy. The backend details
                            of this type of deployment are typically opaque to clients who make requests to the proxy
                            server and see responses as though they originated from the proxy server itself. Although
                            HTTPS is also usually employed between the proxy and the origin server, the TLS connection
                            that the client establishes for HTTPS is only between itself and the reverse proxy server.
                        </p>
                    </div>
                    <div id="rfc.section.1.p.2">
                        <p>The deployment pattern is found in a number of varieties such as n-tier architectures,
                            content delivery networks, application load-balancing services, and ingress controllers.</p>
                    </div>
                    <div id="rfc.section.1.p.3">
                        <p>Although not exceedingly prevalent, TLS client certificate authentication is sometimes
                            employed, and in such cases the origin server often requires information about the client
                            certificate for its application logic. Such logic might include access control decisions,
                            audit logging, and binding issued tokens or cookies to a certificate, including the
                            respective validation of such bindings. The specific details needed from the certificate
                            also vary with the application requirements. In order for these types of application
                            deployments to work in practice, the reverse proxy needs to convey information about the
                            client certificate to the origin application server. At the time of writing, a common way
                            this information is conveyed is by using non-standard fields to carry the certificate (in
                            some encoding) or individual parts thereof in the HTTP request that is dispatched to the
                            origin server. This solution works, but interoperability between independently developed
                            components can be cumbersome or even impossible depending on the implementation choices
                            respectively made (like what field names are used or are configurable, which parts of the
                            certificate are exposed, or how the certificate is encoded). A well-known predictable
                            approach to this commonly occurring functionality could improve and simplify
                            interoperability between independent implementations.</p>
                    </div>
                    <div id="rfc.section.1.p.4">
                        <p>The scope of this document is to describe existing practice while codifying specific details
                            sufficient to facilitate improved and lower-touch interoperability. As such, this document
                            describes two HTTP header fields, "Client-Cert" and "Client-Cert-Chain", which a TLS
                            terminating reverse proxy (TTRP) adds to requests sent to the backend origin servers. The
                            Client-Cert field value contains the end-entity client certificate from the mutually
                            authenticated TLS connection between the originating client and the TTRP. Optionally, the
                            Client-Cert-Chain field value contains the certificate chain used for validation of the
                            end-entity certificate. This enables the backend origin server to utilize the client
                            certificate information in its application logic. While there may be additional proxies or
                            hops between the TTRP and the origin server (potentially even with mutually authenticated
                            TLS connections between them), the scope of the Client-Cert header field is intentionally
                            limited to exposing to the origin server the certificate that was presented by the
                            originating client in its connection to the TTRP.</p>
                    </div>
                    <section id="requirements-notation-and-conventions">
                        <h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a>&nbsp;<a
                                href="#requirements-notation-and-conventions">Requirements Notation and Conventions</a>
                        </h3>
                        <div id="rfc.section.1.1.p.1">
                            <p>The key words "<em class="bcp14">MUST</em>", "<em class="bcp14">MUST NOT</em>", "<em
                                    class="bcp14">REQUIRED</em>", "<em class="bcp14">SHALL</em>", "<em
                                    class="bcp14">SHALL NOT</em>", "<em class="bcp14">SHOULD</em>", "<em
                                    class="bcp14">SHOULD NOT</em>", "<em class="bcp14">RECOMMENDED</em>", "<em
                                    class="bcp14">NOT RECOMMENDED</em>", "<em class="bcp14">MAY</em>", and "<em
                                    class="bcp14">OPTIONAL</em>" in this document are to be interpreted as described in
                                <span class="nobr">BCP 14</span> <a href="#RFC2119"><cite
                                        title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a>
                                <a href="#RFC8174"><cite
                                        title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">[RFC8174]</cite></a>
                                when, and only when, they appear in all capitals, as shown here.
                            </p>
                        </div>
                    </section>
                    <section id="terminology-and-applicability">
                        <h3 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2.</a>&nbsp;<a
                                href="#terminology-and-applicability">Terminology and Applicability</a></h3>
                        <div id="rfc.section.1.2.p.1">
                            <p>This document uses the following terminology from <a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3">Section 3</a> of <a
                                    href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a> to
                                specify syntax and parsing: List and Byte Sequence.</p>
                        </div>
                        <div id="rfc.section.1.2.p.2">
                            <p>Phrases like "TLS client certificate authentication" or "mutually authenticated TLS" are
                                used throughout this document to refer to the process whereby, in addition to the normal
                                TLS server authentication with a certificate, a client presents its X.509 certificate <a
                                    href="#RFC5280"><cite
                                        title="Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile">[RFC5280]</cite></a>
                                and proves possession of the corresponding private key to a server when negotiating a
                                TLS connection or the resumption of such a connection. In contemporary versions of TLS
                                <a href="#RFC8446"><cite
                                        title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS]</cite></a>
                                <a href="#RFC5246"><cite
                                        title="The Transport Layer Security (TLS) Protocol Version 1.2">[TLS1.2]</cite></a>,
                                mutual authentication requires the client to send the Certificate and CertificateVerify
                                messages during the handshake and the server to verify the CertificateVerify and
                                Finished messages.
                            </p>
                        </div>
                        <div id="rfc.section.1.2.p.3">
                            <p>HTTP/2 restricts TLS 1.2 renegotiation (<a
                                    href="https://www.rfc-editor.org/rfc/rfc9113.html#section-9.2.1">Section 9.2.1</a>
                                of <a href="#RFC9113"><cite title="HTTP/2">[HTTP/2]</cite></a>) and prohibits TLS 1.3
                                post-handshake authentication (<a
                                    href="https://www.rfc-editor.org/rfc/rfc9113.html#section-9.2.3">Section 9.2.3</a>
                                of <a href="#RFC9113"><cite title="HTTP/2">[HTTP/2]</cite></a>). However, they are
                                sometimes used to implement reactive client certificate authentication in HTTP/1.1 <a
                                    href="#RFC9112"><cite title="HTTP/1.1">[HTTP/1.1]</cite></a> where the server
                                decides whether to request a client certificate based on the HTTP request. HTTP
                                application data sent on such a connection after receipt and verification of the client
                                certificate is also mutually authenticated and thus suitable for the mechanisms
                                described in this document. With post-handshake authentication, there is also the
                                possibility, though unlikely in practice, of multiple certificates and certificate
                                chains from the client on a connection. In this case, only the certificate and chain of
                                the last post-handshake authentication are to be utilized for the header fields
                                described herein.</p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="headers">
                    <h2 id="rfc.section.2" class="np"><a href="#rfc.section.2">2.</a>&nbsp;<a href="#headers">HTTP
                            Header Fields and Processing Rules</a></h2>
                    <div id="rfc.section.2.p.1">
                        <p>This document designates the following headers, defined further in Sections <a href="#header"
                                title="Client-Cert HTTP Header Field">2.2</a> and <a href="#chain-header"
                                title="Client-Cert-Chain HTTP Header Field">2.3</a>, respectively, to carry the client
                            certificate information of a mutually authenticated TLS connection. The headers convey the
                            information from the reverse proxy to the origin server.</p>
                    </div>
                    <div id="rfc.section.2.p.2">
                        <dl class="nohang">
                            <dt>Client-Cert:</dt>
                            <dd style="margin-left: 1.5em">The end-entity certificate used by the client in the TLS
                                handshake with the reverse proxy.</dd>
                            <dt>Client-Cert-Chain:</dt>
                            <dd style="margin-left: 1.5em">The certificate chain used for validation of the end-entity
                                certificate provided by the client in the TLS handshake with the reverse proxy.</dd>
                        </dl>
                    </div>
                    <section id="encoding">
                        <h3 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a>&nbsp;<a
                                href="#encoding">Encoding</a></h3>
                        <div id="rfc.section.2.1.p.1">
                            <p>The headers in this document encode certificates as Byte Sequences (<a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.3.5">Section 3.3.5</a>
                                of <a href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>) where
                                the value of the binary data is a DER-encoded <a href="#ITU.X690"><cite
                                        title="Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)">[ITU.X690]</cite></a>
                                X.509 certificate <a href="#RFC5280"><cite
                                        title="Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile">[RFC5280]</cite></a>.
                                In effect, this means that the binary DER certificate is encoded using base64 (without
                                line breaks, spaces, or other characters outside the base64 alphabet) and delimited with
                                colons on either side.</p>
                        </div>
                        <div id="rfc.section.2.1.p.2">
                            <p>Note that certificates are often stored in an encoded textual format, such as the one
                                described in <a href="https://www.rfc-editor.org/rfc/rfc7468.html#section-5.1">Section
                                    5.1</a> of <a href="#RFC7468"><cite
                                        title="Textual Encodings of PKIX, PKCS, and CMS Structures">[RFC7468]</cite></a>,
                                which is already nearly compatible with a Byte Sequence. If certificates are encoded as
                                such, it will be sufficient to replace "---(BEGIN|END) CERTIFICATE---" with ":" and
                                remove line breaks in order to generate an appropriate item.</p>
                        </div>
                    </section>
                    <section id="header">
                        <h3 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2.</a>&nbsp;<a href="#header">Client-Cert
                                HTTP Header Field</a></h3>
                        <div id="rfc.section.2.2.p.1">
                            <p>In the context of a TLS terminating reverse proxy deployment, the proxy makes the TLS
                                client certificate available to the backend application with the Client-Cert HTTP header
                                field. This field contains the end-entity certificate used by the client in the TLS
                                handshake.</p>
                        </div>
                        <div id="rfc.section.2.2.p.2">
                            <p>Client-Cert is a Byte Sequence with the value of the header encoded as described in <a
                                    href="#encoding" title="Encoding">Section 2.1</a>.</p>
                        </div>
                        <div id="rfc.section.2.2.p.3">
                            <p>The Client-Cert header field is only for use in HTTP requests and <em class="bcp14">MUST
                                    NOT</em> be used in HTTP responses. It is a singleton header field value as defined
                                in <a href="https://www.rfc-editor.org/rfc/rfc9110.html#section-5.5">Section 5.5</a> of
                                <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>, which <em
                                    class="bcp14">MUST NOT</em> have a list of values or occur multiple times in a
                                request.
                            </p>
                        </div>
                        <div id="rfc.section.2.2.p.4">
                            <p><a href="#example-header" title="Header Field in HTTP Request to Origin Server">Figure
                                    2</a> in <a href="#example" title="Example">Appendix A</a> has an example of the
                                Client-Cert header field.</p>
                        </div>
                    </section>
                    <section id="chain-header">
                        <h3 id="rfc.section.2.3"><a href="#rfc.section.2.3">2.3.</a>&nbsp;<a
                                href="#chain-header">Client-Cert-Chain HTTP Header Field</a></h3>
                        <div id="rfc.section.2.3.p.1">
                            <p>In the context of a TLS terminating reverse proxy deployment, the proxy <em
                                    class="bcp14">MAY</em> make the certificate chain available to the backend
                                application with the Client-Cert-Chain HTTP header field.</p>
                        </div>
                        <div id="rfc.section.2.3.p.2">
                            <p>Client-Cert-Chain is a List (<a
                                    href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.1">Section 3.1</a> of <a
                                    href="#RFC8941"><cite
                                        title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>). Each
                                item in the List <em class="bcp14">MUST</em> be a Byte Sequence encoded as described in
                                <a href="#encoding" title="Encoding">Section 2.1</a>. The order is the same as the
                                ordering in TLS (as described in <a
                                    href="https://www.rfc-editor.org/rfc/rfc8446.html#section-4.4.2">Section 4.4.2</a>
                                of <a href="#RFC8446"><cite
                                        title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS]</cite></a>).
                            </p>
                        </div>
                        <div id="rfc.section.2.3.p.3">
                            <p>Client-Cert-Chain <em class="bcp14">MUST NOT</em> appear unless Client-Cert is also
                                present, and it does not itself include the end-entity certificate that is already
                                present in Client-Cert. The root certificate <em class="bcp14">MAY</em> be omitted from
                                Client-Cert-Chain, provided that the target origin server is known to possess the
                                omitted trust anchor.</p>
                        </div>
                        <div id="rfc.section.2.3.p.4">
                            <p>The Client-Cert-Chain header field is only for use in HTTP requests and <em
                                    class="bcp14">MUST NOT</em> be used in HTTP responses. It <em class="bcp14">MAY</em>
                                have a list of values or occur multiple times in a request. For header compression
                                purposes, it might be advantageous to split lists into multiple instances.</p>
                        </div>
                        <div id="rfc.section.2.3.p.5">
                            <p><a href="#example-chain-header"
                                    title="Certificate Chain in HTTP Request to Origin Server">Figure 3</a> in <a
                                    href="#example" title="Example">Appendix A</a> has an example of the
                                Client-Cert-Chain header field.</p>
                        </div>
                    </section>
                    <section id="processing-rules">
                        <h3 id="rfc.section.2.4"><a href="#rfc.section.2.4">2.4.</a>&nbsp;<a
                                href="#processing-rules">Processing Rules</a></h3>
                        <div id="rfc.section.2.4.p.1">
                            <p>This section outlines the applicable processing rules for a TTRP that has negotiated a
                                mutually authenticated TLS connection to convey the client certificate from that
                                connection to the backend origin servers. This technique is to be used as a
                                configuration or deployment option, and the processing rules described herein are for
                                servers operating with that option enabled.</p>
                        </div>
                        <div id="rfc.section.2.4.p.2" class="avoidbreakafter">
                            <p>A TTRP negotiates the use of a mutually authenticated TLS connection with the client,
                                such as is described in <a href="#RFC8446"><cite
                                        title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS]</cite></a>
                                or <a href="#RFC5246"><cite
                                        title="The Transport Layer Security (TLS) Protocol Version 1.2">[TLS1.2]</cite></a>,
                                and validates the client certificate per its policy and trusted certificate authorities.
                                Each HTTP request on the underlying TLS connection is dispatched to the origin server
                                with the following modifications:</p>
                        </div>
                        <div id="rfc.section.2.4.p.3">
                            <ol type="1">
                                <li>The client certificate is placed in the Client-Cert header field of the dispatched
                                    request, as described in <a href="#header"
                                        title="Client-Cert HTTP Header Field">Section 2.2</a>.</li>
                                <li>If so configured, the validation chain of the client certificate is placed in the
                                    Client-Cert-Chain header field of the request, as described in <a
                                        href="#chain-header" title="Client-Cert-Chain HTTP Header Field">Section
                                        2.3</a>.</li>
                                <li>Any occurrence of the Client-Cert or Client-Cert-Chain header fields in the original
                                    incoming request <em class="bcp14">MUST</em> be removed or overwritten before
                                    forwarding the request. An incoming request that has a Client-Cert or
                                    Client-Cert-Chain header field <em class="bcp14">MAY</em> be rejected with an HTTP
                                    400 response.</li>
                            </ol>
                        </div>
                        <div id="rfc.section.2.4.p.4">
                            <p>Requests to the TTRP made over a TLS connection where the use of client certificate
                                authentication was not negotiated <em class="bcp14">MUST</em> be sanitized by removing
                                any and all occurrences of the Client-Cert and Client-Cert-Chain header fields prior to
                                dispatching the request to the backend server.</p>
                        </div>
                        <div id="rfc.section.2.4.p.5">
                            <p>Backend origin servers may then use the Client-Cert header field of the request to
                                determine if the connection from the client to the TTRP was mutually authenticated and,
                                if so, the certificate thereby presented by the client. Access control decisions based
                                on the client certificate (or lack thereof) can be conveyed by selecting response
                                content as appropriate or with an HTTP 403 response, if the certificate is deemed
                                unacceptable for the given context. Note that TLS clients that rely on error indications
                                at the TLS layer for an unacceptable certificate will not receive those signals.</p>
                        </div>
                        <div id="rfc.section.2.4.p.6">
                            <p>When the value of the Client-Cert request header field is used to select a response
                                (e.g., the response content is access-controlled), the response <em
                                    class="bcp14">MUST</em> either be uncacheable (e.g., by sending Cache-Control:
                                no-store) or be designated for selective reuse only for subsequent requests with the
                                same Client-Cert header field value by sending a "Vary: Client-Cert" response header. If
                                a TTRP encounters a response with Client-Cert or Client-Cert-Chain in the Vary header
                                field (<a href="https://www.rfc-editor.org/rfc/rfc9110.html#section-12.5.5">Section
                                    12.5.5</a> of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>), it
                                <em class="bcp14">SHOULD</em> prevent the user agent from caching the response by
                                transforming the value of the Vary response header field to "*".
                            </p>
                        </div>
                        <div id="rfc.section.2.4.p.7">
                            <p>Forward proxies and other intermediaries <em class="bcp14">MUST NOT</em> add the
                                Client-Cert or Client-Cert-Chain header fields to requests or modify an existing
                                Client-Cert or Client-Cert-Chain header field. Similarly, clients <em class="bcp14">MUST
                                    NOT</em> employ the Client-Cert or Client-Cert-Chain header field in requests.</p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="deployment">
                    <h2 id="rfc.section.3" class="np"><a href="#rfc.section.3">3.</a>&nbsp;<a
                            href="#deployment">Deployment Considerations</a></h2>
                    <section id="header-field-compression">
                        <h3 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a>&nbsp;<a
                                href="#header-field-compression">Header Field Compression</a></h3>
                        <div id="rfc.section.3.1.p.1">
                            <p>If the connection between the TTRP and origin is capable of field compression (e.g.,
                                HPACK <a href="#RFC7541"><cite
                                        title="HPACK: Header Compression for HTTP/2">[HPACK]</cite></a> or QPACK <a
                                    href="#RFC9204"><cite
                                        title="QPACK: Field Compression for HTTP/3">[QPACK]</cite></a>), and the TTRP
                                multiplexes more than one client's requests into that connection, the size and variation
                                of Client-Cert and Client-Cert-Chain field values can reduce compression efficiency
                                significantly. An origin could mitigate the efficiency loss by increasing the size of
                                the dynamic table. If the TTRP determines that the origin dynamic table is not
                                sufficiently large, it may find it beneficial to always send the field value as a
                                literal rather than entering it into the table.</p>
                        </div>
                    </section>
                    <section id="message-header-size">
                        <h3 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a>&nbsp;<a
                                href="#message-header-size">Message Header Size</a></h3>
                        <div id="rfc.section.3.2.p.1">
                            <p>A server in receipt of a larger message header than it is willing to handle can send an
                                HTTP 431 (Request Header Fields Too Large) status code per <a
                                    href="https://www.rfc-editor.org/rfc/rfc6585.html#section-5">Section 5</a> of <a
                                    href="#RFC6585"><cite title="Additional HTTP Status Codes">[RFC6585]</cite></a>. Due
                                to the typical size of the field values containing certificate data, recipients may need
                                to be configured to allow for a larger maximum header size. An intermediary generating
                                client certificate header fields on connections that allow for advertising the maximum
                                acceptable header size (e.g., HTTP/2 <a href="#RFC9113"><cite
                                        title="HTTP/2">[HTTP/2]</cite></a> or HTTP/3 <a href="#RFC9114"><cite
                                        title="HTTP/3">[HTTP/3]</cite></a>) should account for the additional size of
                                the header of the requests it sends, versus the requests it receives, by advertising a
                                value to its clients that is sufficiently smaller so as to allow for the addition of
                                certificate data.</p>
                        </div>
                    </section>
                    <section id="tls-session-resumption">
                        <h3 id="rfc.section.3.3"><a href="#rfc.section.3.3">3.3.</a>&nbsp;<a
                                href="#tls-session-resumption">TLS Session Resumption</a></h3>
                        <div id="rfc.section.3.3.p.1">
                            <p>Some TLS implementations do not retain client certificate information when resuming.
                                Providing inconsistent values of Client-Cert and Client-Cert-Chain when resuming might
                                lead to errors, so implementations that are unable to provide these values <em
                                    class="bcp14">SHOULD</em> either disable resumption for connections with client
                                certificates or initially omit a Client-Cert or Client-Cert-Chain field if it might not
                                be available after resuming.</p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="sec">
                    <h2 id="rfc.section.4" class="np"><a href="#rfc.section.4">4.</a>&nbsp;<a href="#sec">Security
                            Considerations</a></h2>
                    <div id="rfc.section.4.p.1">
                        <p>The header fields described herein enable a TTRP and backend or origin server to function
                            together as though, from the client's perspective, they are a single logical server-side
                            deployment of HTTPS over a mutually authenticated TLS connection. However, use of the header
                            fields outside that intended use case may undermine the protections afforded by TLS client
                            certificate authentication. Therefore, steps such as those described below need to be taken
                            to prevent unintended use, both in sending the header field and in relying on its value.</p>
                    </div>
                    <div id="rfc.section.4.p.2">
                        <p>Producing and consuming the Client-Cert and Client-Cert-Chain header fields <em
                                class="bcp14">SHOULD</em> be configurable options, respectively, in a TTRP and backend
                            server (or in an individual application in that server). The default configuration for both
                            should be to not use the header fields, thus requiring an "opt-in" to the functionality.</p>
                    </div>
                    <div id="rfc.section.4.p.3">
                        <p>In order to prevent field injection, backend servers <em class="bcp14">MUST</em> only accept
                            the Client-Cert and Client-Cert-Chain header fields from a trusted TTRP (or other proxy in a
                            trusted path from the TTRP). A TTRP <em class="bcp14">MUST</em> sanitize the incoming
                            request before forwarding it on by removing or overwriting any existing instances of the
                            fields. Otherwise, arbitrary clients can control the field values as seen and used by the
                            backend server. It is important to note that neglecting to prevent field injection does not
                            "fail safe" in that the nominal functionality will still work as expected even when
                            malicious actions are possible. As such, extra care is recommended in ensuring that proper
                            field sanitation is in place.</p>
                    </div>
                    <div id="rfc.section.4.p.4">
                        <p>The communication between a TTRP and backend server needs to be secured against eavesdropping
                            and modification by unintended parties.</p>
                    </div>
                    <div id="rfc.section.4.p.5">
                        <p>The configuration options and request sanitization are necessary functionalities of the
                            respective servers. The other requirements can be met in a number of ways, which will vary
                            based on specific deployments. The communication between a TTRP and backend or origin
                            server, for example, might be authenticated in some way with the insertion and consumption
                            of the Client-Cert and Client-Cert-Chain header fields occurring only on that connection.
                            Appendix B.3 of <a href="#I-D.ietf-httpbis-message-signatures"><cite
                                    title="HTTP Message Signatures">[HTTPSIG]</cite></a> gives one example of this with
                            an application of HTTP Message Signatures. Alternatively, the network topology might dictate
                            a private network such that the backend application is only able to accept requests from the
                            TTRP and the proxy can only make requests to that server. Other deployments that meet the
                            requirements set forth herein are also possible.</p>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="iana-considerations">
                    <h2 id="rfc.section.5" class="np"><a href="#rfc.section.5">5.</a>&nbsp;<a
                            href="#iana-considerations">IANA Considerations</a></h2>
                    <section id="http-field-name-registrations">
                        <h3 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a>&nbsp;<a
                                href="#http-field-name-registrations">HTTP Field Name Registrations</a></h3>
                        <div id="rfc.section.5.1.p.1" class="avoidbreakafter">
                            <p>IANA has registered the following entries in the "Hypertext Transfer Protocol (HTTP)
                                Field Name Registry" defined by "HTTP Semantics" <a href="#RFC9110"><cite
                                        title="HTTP Semantics">[HTTP]</cite></a>:</p>
                        </div>
                        <div class="table table-condensed table-striped" id="table_1">
                            <table class="v3 text-center">
                                <caption>Table 1: Hypertext Transfer Protocol (HTTP) Field Name Registry</caption>
                                <thead>
                                    <tr>
                                        <th class="text-left" colspan="1" rowspan="1">Field Name</th>
                                        <th class="text-left" colspan="1" rowspan="1">Status</th>
                                        <th class="text-left" colspan="1" rowspan="1">Reference</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">Client-Cert</td>
                                        <td class="text-left" colspan="1" rowspan="1">permanent</td>
                                        <td class="text-left" colspan="1" rowspan="1">RFC 9440, <a href="#headers"
                                                title="HTTP Header Fields and Processing Rules">Section 2</a></td>
                                    </tr>
                                    <tr>
                                        <td class="text-left" colspan="1" rowspan="1">Client-Cert-Chain</td>
                                        <td class="text-left" colspan="1" rowspan="1">permanent</td>
                                        <td class="text-left" colspan="1" rowspan="1">RFC 9440, <a href="#headers"
                                                title="HTTP Header Fields and Processing Rules">Section 2</a></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </section>
                </section>
                <section class="np">
                    <div id="rfc.references">
                        <h2 id="rfc.section.6"><a href="#rfc.section.6">6.</a> References</h2>
                        <section>
                            <div id="rfc.references.2">
                                <h3 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a> Normative References</h3>
                                <dl class="dl-horizontal">
                                    <dt id="RFC9110">[<a href="#RFC9110" class="smpl">HTTP</a>]</dt>
                                    <dd>Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke, Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9110.html">HTTP Semantics</a>”, <a
                                            href="https://www.rfc-editor.org/info/std97">STD 97</a>, RFC 9110, <a
                                            href="https://dx.doi.org/10.17487/RFC9110">DOI 10.17487/RFC9110</a>, June
                                        2022, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;.
                                    </dd>
                                    <dt id="ITU.X690">[<a href="#ITU.X690" class="smpl">ITU.X690</a>]</dt>
                                    <dd>ITU-T, “<a href="https://www.itu.int/rec/T-REC-X.690/en">Information technology
                                            - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER),
                                            Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)</a>”,
                                        ITU-T Recommendation X.690, February 2021, &lt;<a
                                            href="https://www.itu.int/rec/T-REC-X.690/en">https://www.itu.int/rec/T-REC-X.690/en</a>&gt;.
                                    </dd>
                                    <dt id="RFC2119">[<a href="#RFC2119" class="smpl">RFC2119</a>]</dt>
                                    <dd>Bradner, S., “<a href="https://www.rfc-editor.org/rfc/rfc2119.html">Key words
                                            for use in RFCs to Indicate Requirement Levels</a>”, <a
                                            href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 2119, <a
                                            href="https://dx.doi.org/10.17487/RFC2119">DOI 10.17487/RFC2119</a>, March
                                        1997, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.
                                    </dd>
                                    <dt id="RFC5280">[<a href="#RFC5280" class="smpl">RFC5280</a>]</dt>
                                    <dd>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk,
                                        “<a href="https://www.rfc-editor.org/rfc/rfc5280.html">Internet X.509 Public Key
                                            Infrastructure Certificate and Certificate Revocation List (CRL)
                                            Profile</a>”, RFC 5280, <a href="https://dx.doi.org/10.17487/RFC5280">DOI
                                            10.17487/RFC5280</a>, May 2008, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;.
                                    </dd>
                                    <dt id="RFC8174">[<a href="#RFC8174" class="smpl">RFC8174</a>]</dt>
                                    <dd>Leiba, B., “<a href="https://www.rfc-editor.org/rfc/rfc8174.html">Ambiguity of
                                            Uppercase vs Lowercase in RFC 2119 Key Words</a>”, <a
                                            href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 8174, <a
                                            href="https://dx.doi.org/10.17487/RFC8174">DOI 10.17487/RFC8174</a>, May
                                        2017, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.
                                    </dd>
                                    <dt id="RFC8941">[<a href="#RFC8941" class="smpl">STRUCTURED-FIELDS</a>]</dt>
                                    <dd>Nottingham, M. and P-H. Kamp, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc8941.html">Structured Field Values
                                            for HTTP</a>”, RFC 8941, <a href="https://dx.doi.org/10.17487/RFC8941">DOI
                                            10.17487/RFC8941</a>, February 2021, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8941">https://www.rfc-editor.org/info/rfc8941</a>&gt;.
                                    </dd>
                                </dl>
                            </div>
                        </section>
                        <section>
                            <div id="rfc.references.3">
                                <h3 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2.</a> Informative References</h3>
                                <dl class="dl-horizontal">
                                    <dt id="RFC7541">[<a href="#RFC7541" class="smpl">HPACK</a>]</dt>
                                    <dd>Peon, R. and H. Ruellan, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc7541.html">HPACK: Header Compression
                                            for HTTP/2</a>”, RFC 7541, <a href="https://dx.doi.org/10.17487/RFC7541">DOI
                                            10.17487/RFC7541</a>, May 2015, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7541">https://www.rfc-editor.org/info/rfc7541</a>&gt;.
                                    </dd>
                                    <dt id="RFC9112">[<a href="#RFC9112" class="smpl">HTTP/1.1</a>]</dt>
                                    <dd>Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke, Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9112.html">HTTP/1.1</a>”, <a
                                            href="https://www.rfc-editor.org/info/std99">STD 99</a>, RFC 9112, <a
                                            href="https://dx.doi.org/10.17487/RFC9112">DOI 10.17487/RFC9112</a>, June
                                        2022, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9112">https://www.rfc-editor.org/info/rfc9112</a>&gt;.
                                    </dd>
                                    <dt id="RFC9113">[<a href="#RFC9113" class="smpl">HTTP/2</a>]</dt>
                                    <dd>Thomson, M., Ed. and C. Benfield, Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9113.html">HTTP/2</a>”, RFC 9113, <a
                                            href="https://dx.doi.org/10.17487/RFC9113">DOI 10.17487/RFC9113</a>, June
                                        2022, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9113">https://www.rfc-editor.org/info/rfc9113</a>&gt;.
                                    </dd>
                                    <dt id="RFC9114">[<a href="#RFC9114" class="smpl">HTTP/3</a>]</dt>
                                    <dd>Bishop, M., Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9114.html">HTTP/3</a>”, RFC 9114, <a
                                            href="https://dx.doi.org/10.17487/RFC9114">DOI 10.17487/RFC9114</a>, June
                                        2022, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9114">https://www.rfc-editor.org/info/rfc9114</a>&gt;.
                                    </dd>
                                    <dt id="I-D.ietf-httpbis-message-signatures">[<a
                                            href="#I-D.ietf-httpbis-message-signatures" class="smpl">HTTPSIG</a>]</dt>
                                    <dd>Backman, A., Ed., Richer, J., Ed., and M. Sporny, “<a
                                            href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-message-signatures-17">HTTP
                                            Message Signatures</a>”, <a
                                            href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-message-signatures">Work
                                            in Progress</a>, draft-ietf-httpbis-message-signatures-17, Work in Progress,
                                        May 2023, &lt;<a
                                            href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-message-signatures-17">https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-message-signatures-17</a>&gt;.
                                    </dd>
                                    <dt id="RFC9204">[<a href="#RFC9204" class="smpl">QPACK</a>]</dt>
                                    <dd>Krasic, C., Bishop, M., and A. Frindell, Ed., “<a
                                            href="https://www.rfc-editor.org/rfc/rfc9204.html">QPACK: Field Compression
                                            for HTTP/3</a>”, RFC 9204, <a href="https://dx.doi.org/10.17487/RFC9204">DOI
                                            10.17487/RFC9204</a>, June 2022, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc9204">https://www.rfc-editor.org/info/rfc9204</a>&gt;.
                                    </dd>
                                    <dt id="RFC6585">[<a href="#RFC6585" class="smpl">RFC6585</a>]</dt>
                                    <dd>Nottingham, M. and R. Fielding, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc6585.html">Additional HTTP Status
                                            Codes</a>”, RFC 6585, <a href="https://dx.doi.org/10.17487/RFC6585">DOI
                                            10.17487/RFC6585</a>, April 2012, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc6585">https://www.rfc-editor.org/info/rfc6585</a>&gt;.
                                    </dd>
                                    <dt id="RFC7239">[<a href="#RFC7239" class="smpl">RFC7239</a>]</dt>
                                    <dd>Petersson, A. and M. Nilsson, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc7239.html">Forwarded HTTP
                                            Extension</a>”, RFC 7239, <a href="https://dx.doi.org/10.17487/RFC7239">DOI
                                            10.17487/RFC7239</a>, June 2014, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7239">https://www.rfc-editor.org/info/rfc7239</a>&gt;.
                                    </dd>
                                    <dt id="RFC7468">[<a href="#RFC7468" class="smpl">RFC7468</a>]</dt>
                                    <dd>Josefsson, S. and S. Leonard, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc7468.html">Textual Encodings of
                                            PKIX, PKCS, and CMS Structures</a>”, RFC 7468, <a
                                            href="https://dx.doi.org/10.17487/RFC7468">DOI 10.17487/RFC7468</a>, April
                                        2015, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc7468">https://www.rfc-editor.org/info/rfc7468</a>&gt;.
                                    </dd>
                                    <dt id="RFC8705">[<a href="#RFC8705" class="smpl">RFC8705</a>]</dt>
                                    <dd>Campbell, B., Bradley, J., Sakimura, N., and T. Lodderstedt, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc8705.html">OAuth 2.0 Mutual-TLS
                                            Client Authentication and Certificate-Bound Access Tokens</a>”, RFC 8705, <a
                                            href="https://dx.doi.org/10.17487/RFC8705">DOI 10.17487/RFC8705</a>,
                                        February 2020, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8705">https://www.rfc-editor.org/info/rfc8705</a>&gt;.
                                    </dd>
                                    <dt id="RFC5246">[<a href="#RFC5246" class="smpl">TLS1.2</a>]</dt>
                                    <dd>Dierks, T. and E. Rescorla, “<a
                                            href="https://www.rfc-editor.org/rfc/rfc5246.html">The Transport Layer
                                            Security (TLS) Protocol Version 1.2</a>”, RFC 5246, <a
                                            href="https://dx.doi.org/10.17487/RFC5246">DOI 10.17487/RFC5246</a>, August
                                        2008, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc5246">https://www.rfc-editor.org/info/rfc5246</a>&gt;.
                                    </dd>
                                    <dt id="RFC8446">[<a href="#RFC8446" class="smpl">TLS</a>]</dt>
                                    <dd>Rescorla, E., “<a href="https://www.rfc-editor.org/rfc/rfc8446.html">The
                                            Transport Layer Security (TLS) Protocol Version 1.3</a>”, RFC 8446, <a
                                            href="https://dx.doi.org/10.17487/RFC8446">DOI 10.17487/RFC8446</a>, August
                                        2018, &lt;<a
                                            href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;.
                                    </dd>
                                </dl>
                            </div>
                        </section>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="example">
                    <h2 id="rfc.section.A" class="np"><a href="#rfc.section.A">Appendix A.</a>&nbsp;<a
                            href="#example">Example</a></h2>
                    <div id="rfc.section.A.p.1">
                        <p>In a hypothetical example where a TLS client would present the client and intermediate
                            certificate from <a href="#example-chain"
                                title="Certificate Chain (with Client Certificate First)">Figure 1</a> when establishing
                            a mutually authenticated TLS connection with the TTRP, the proxy would send the Client-Cert
                            field shown in <a href="#example-header"
                                title="Header Field in HTTP Request to Origin Server">Figure 2</a> to the backend. Note
                            that line breaks and extra spaces have been added to the field value in Figures <a
                                href="#example-header" title="Header Field in HTTP Request to Origin Server">2</a> and
                            <a href="#example-chain-header"
                                title="Certificate Chain in HTTP Request to Origin Server">3</a> for display and
                            formatting purposes only.
                        </p>
                    </div>
                    <div id="example-chain"></div>
                    <div id="rfc.figure.1">
                        <div>
                            <pre class="text">
-----BEGIN CERTIFICATE-----
MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQKDBJMZXQncyBB
dXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQTAeFw0yMDAx
MTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDMFkwEwYHKoZI
zj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXmckC8vdgJ1p
5Be5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQYDVR0TBAIw
ADAfBgNVHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8BAf8EBAMC
BsAwEwYDVR0lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQGV4YW1w
bGUuY29tMAoGCCqGSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0Q6bMje
SkC3dFCOOB8TAiEAx/kHSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIB5jCCAYugAwIBAgIBFjAKBggqhkjOPQQDAjBWMQswCQYDVQQGEwJVUzEbMBkG
A1UECgwSTGV0J3MgQXV0aGVudGljYXRlMSowKAYDVQQDDCFMZXQncyBBdXRoZW50
aWNhdGUgUm9vdCBBdXRob3JpdHkwHhcNMjAwMTE0MjEzMjMwWhcNMzAwMTExMjEz
MjMwWjA6MRswGQYDVQQKDBJMZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxB
IEludGVybWVkaWF0ZSBDQTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJf+aA54
RC5pyLAR5yfXVYmNpgd+CGUTDp2KOGhc0gK91zxhHesEYkdXkpS2UN8Kati+yHtW
CV3kkhCngGyv7RqjZjBkMB0GA1UdDgQWBBRm3WjLa38lbEYCuiCPct0ZaSED2DAf
BgNVHSMEGDAWgBTEA2Q6eecKu9g9yb5glbkhhVINGDASBgNVHRMBAf8ECDAGAQH/
AgEAMA4GA1UdDwEB/wQEAwIBhjAKBggqhkjOPQQDAgNJADBGAiEA5pLvaFwRRkxo
mIAtDIwg9D7gC1xzxBl4r28EzmSO1pcCIQCJUShpSXO9HDIQMUgH69fNDEMHXD3R
RX5gP7kuu2KGMg==
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIICBjCCAaygAwIBAgIJAKS0yiqKtlhoMAoGCCqGSM49BAMCMFYxCzAJBgNVBAYT
AlVTMRswGQYDVQQKDBJMZXQncyBBdXRoZW50aWNhdGUxKjAoBgNVBAMMIUxldCdz
IEF1dGhlbnRpY2F0ZSBSb290IEF1dGhvcml0eTAeFw0yMDAxMTQyMTI1NDVaFw00
MDAxMDkyMTI1NDVaMFYxCzAJBgNVBAYTAlVTMRswGQYDVQQKDBJMZXQncyBBdXRo
ZW50aWNhdGUxKjAoBgNVBAMMIUxldCdzIEF1dGhlbnRpY2F0ZSBSb290IEF1dGhv
cml0eTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABFoaHU+Z5bPKmGzlYXtCf+E6
HYj62fORaHDOrt+yyh3H/rTcs7ynFfGn+gyFsrSP3Ez88rajv+U2NfD0o0uZ4Pmj
YzBhMB0GA1UdDgQWBBTEA2Q6eecKu9g9yb5glbkhhVINGDAfBgNVHSMEGDAWgBTE
A2Q6eecKu9g9yb5glbkhhVINGDAPBgNVHRMBAf8EBTADAQH/MA4GA1UdDwEB/wQE
AwIBhjAKBggqhkjOPQQDAgNIADBFAiEAmAeg1ycKHriqHnaD4M/UDBpQRpkmdcRF
YGMg1Qyrkx4CIB4ivz3wQcQkGhcsUZ1SOImd/lq1Q0FLf09rGfLQPWDc
-----END CERTIFICATE-----
</pre>
                        </div>
                    </div>
                    <p class="figure">Figure 1: Certificate Chain (with Client Certificate First)</p>
                    <div id="example-header"></div>
                    <div id="rfc.figure.2">
                        <div>
                            <pre class="text">
Client-Cert: :MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQKDBJ
 MZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQTAeFw0
 yMDAxMTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDMFkwEwYHKoZ
 Izj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXmckC8vdgJ1p5Be
 5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQYDVR0TBAIwADAfBgN
 VHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8BAf8EBAMCBsAwEwYDVR0
 lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQGV4YW1wbGUuY29tMAoGCCq
 GSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0Q6bMjeSkC3dFCOOB8TAiEAx/k
 HSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=:
</pre>
                        </div>
                    </div>
                    <p class="figure">Figure 2: Header Field in HTTP Request to Origin Server</p>
                    <div id="rfc.section.A.p.2">
                        <p>If the proxy were configured to also include the certificate chain, it would also include the
                            Client-Cert-Chain header field. Note that while the following example does illustrate the
                            TTRP inserting the root certificate, many deployments will opt to omit the trust anchor.</p>
                    </div>
                    <div id="example-chain-header"></div>
                    <div id="rfc.figure.3">
                        <div>
                            <pre class="text">
Client-Cert-Chain: :MIIB5jCCAYugAwIBAgIBFjAKBggqhkjOPQQDAjBWMQsw
 CQYDVQQGEwJVUzEbMBkGA1UECgwSTGV0J3MgQXV0aGVudGljYXRlMSowKAYDVQQ
 DDCFMZXQncyBBdXRoZW50aWNhdGUgUm9vdCBBdXRob3JpdHkwHhcNMjAwMTE0Mj
 EzMjMwWhcNMzAwMTExMjEzMjMwWjA6MRswGQYDVQQKDBJMZXQncyBBdXRoZW50a
 WNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQTBZMBMGByqGSM49AgEG
 CCqGSM49AwEHA0IABJf+aA54RC5pyLAR5yfXVYmNpgd+CGUTDp2KOGhc0gK91zx
 hHesEYkdXkpS2UN8Kati+yHtWCV3kkhCngGyv7RqjZjBkMB0GA1UdDgQWBBRm3W
 jLa38lbEYCuiCPct0ZaSED2DAfBgNVHSMEGDAWgBTEA2Q6eecKu9g9yb5glbkhh
 VINGDASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjAKBggqhkjO
 PQQDAgNJADBGAiEA5pLvaFwRRkxomIAtDIwg9D7gC1xzxBl4r28EzmSO1pcCIQC
 JUShpSXO9HDIQMUgH69fNDEMHXD3RRX5gP7kuu2KGMg==:, :MIICBjCCAaygAw
 IBAgIJAKS0yiqKtlhoMAoGCCqGSM49BAMCMFYxCzAJBgNVBAYTAlVTMRswGQYDV
 QQKDBJMZXQncyBBdXRoZW50aWNhdGUxKjAoBgNVBAMMIUxldCdzIEF1dGhlbnRp
 Y2F0ZSBSb290IEF1dGhvcml0eTAeFw0yMDAxMTQyMTI1NDVaFw00MDAxMDkyMTI
 1NDVaMFYxCzAJBgNVBAYTAlVTMRswGQYDVQQKDBJMZXQncyBBdXRoZW50aWNhdG
 UxKjAoBgNVBAMMIUxldCdzIEF1dGhlbnRpY2F0ZSBSb290IEF1dGhvcml0eTBZM
 BMGByqGSM49AgEGCCqGSM49AwEHA0IABFoaHU+Z5bPKmGzlYXtCf+E6HYj62fOR
 aHDOrt+yyh3H/rTcs7ynFfGn+gyFsrSP3Ez88rajv+U2NfD0o0uZ4PmjYzBhMB0
 GA1UdDgQWBBTEA2Q6eecKu9g9yb5glbkhhVINGDAfBgNVHSMEGDAWgBTEA2Q6ee
 cKu9g9yb5glbkhhVINGDAPBgNVHRMBAf8EBTADAQH/MA4GA1UdDwEB/wQEAwIBh
 jAKBggqhkjOPQQDAgNIADBFAiEAmAeg1ycKHriqHnaD4M/UDBpQRpkmdcRFYGMg
 1Qyrkx4CIB4ivz3wQcQkGhcsUZ1SOImd/lq1Q0FLf09rGfLQPWDc:
</pre>
                        </div>
                    </div>
                    <p class="figure">Figure 3: Certificate Chain in HTTP Request to Origin Server</p>
                </section>
                <hr class="hidden-print">
                <section id="select-design-considerations">
                    <h2 id="rfc.section.B" class="np"><a href="#rfc.section.B">Appendix B.</a>&nbsp;<a
                            href="#select-design-considerations">Select Design Considerations</a></h2>
                    <section id="field-injection">
                        <h3 id="rfc.section.B.1"><a href="#rfc.section.B.1">B.1.</a>&nbsp;<a
                                href="#field-injection">Field Injection</a></h3>
                        <div id="rfc.section.B.1.p.1">
                            <p>This document requires that the TTRP sanitize the fields of the incoming request by
                                removing or overwriting any existing instances of the Client-Cert and Client-Cert-Chain
                                header fields before dispatching that request to the backend application. Otherwise, a
                                client could inject its own values that would appear to the backend to have come from
                                the TTRP. Although numerous other methods of detecting and preventing field injection
                                are possible, such as the use of a unique secret value as part of the field name or
                                value or the application of a signature, HMAC, or AEAD, there is no common general
                                mechanism. The potential problem of client field injection is not at all unique to the
                                functionality of this document; therefore, it would be inappropriate for this document
                                to define a one-off solution. Since a generic common solution does not currently exist,
                                stripping and sanitizing the fields is the de facto means of protecting against field
                                injection in practice. Sanitizing the fields is sufficient when properly implemented and
                                is a normative requirement of <a href="#sec" title="Security Considerations">Section
                                    4</a>.</p>
                        </div>
                    </section>
                    <section id="the-forwarded-http-extension">
                        <h3 id="rfc.section.B.2"><a href="#rfc.section.B.2">B.2.</a>&nbsp;<a
                                href="#the-forwarded-http-extension">The Forwarded HTTP Extension</a></h3>
                        <div id="rfc.section.B.2.p.1">
                            <p>The Forwarded HTTP header field defined in <a href="#RFC7239"><cite
                                        title="Forwarded HTTP Extension">[RFC7239]</cite></a> allows proxy components to
                                disclose information lost in the proxying process. The TLS client certificate
                                information of concern to this document could have been communicated with an extension
                                parameter to the Forwarded field; however, doing so would have had some disadvantages
                                that this document endeavored to avoid. The Forwarded field syntax allows for
                                information about a full chain of proxied HTTP requests, whereas the Client-Cert and
                                Client-Cert-Chain header fields of this document are concerned only with conveying
                                information about the certificate presented by the originating client on the TLS
                                connection to the TTRP (which appears as the server from that client's perspective) to
                                backend applications. The multi-hop syntax of the Forwarded field is expressive but also
                                more complicated, which would make processing it more cumbersome and, more importantly,
                                would make properly sanitizing its content, as required by <a href="#sec"
                                    title="Security Considerations">Section 4</a> to prevent field injection,
                                considerably more difficult and error-prone. Thus, this document opted for a flatter and
                                more straightforward structure.</p>
                        </div>
                    </section>
                    <section id="the-whole-certificate-and-certificate-chain">
                        <h3 id="rfc.section.B.3"><a href="#rfc.section.B.3">B.3.</a>&nbsp;<a
                                href="#the-whole-certificate-and-certificate-chain">The Whole Certificate and
                                Certificate Chain</a></h3>
                        <div id="rfc.section.B.3.p.1">
                            <p>Different applications will have varying requirements about what information from the
                                client certificate is needed, such as the subject and/or issuer distinguished name,
                                subject alternative name(s), serial number, subject public key info, fingerprint, etc.
                                Furthermore, some applications, such as that described in <a href="#RFC8705"><cite
                                        title="OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens">[RFC8705]</cite></a>,
                                make use of the entire certificate. In order to accommodate the latter and ensure wide
                                applicability by not trying to cherry-pick particular certificate information, this
                                document opted to pass the full, encoded certificate as the value of the Client-Cert
                                field.</p>
                        </div>
                        <div id="rfc.section.B.3.p.2">
                            <p>The validation of the client certificate and chain of the mutually authenticated TLS
                                connection is typically performed by the TTRP during the handshake. With the
                                responsibility of certificate validation falling on the TTRP, the end-entity certificate
                                is oftentimes sufficient for the needs of the origin server. The separate
                                Client-Cert-Chain field can convey the certificate chain for origin server deployments
                                that require this additional information.</p>
                        </div>
                    </section>
                </section>
                <hr class="hidden-print">
                <section id="acknowledgements">
                    <h2 id="rfc.section.unnumbered-4" class="np"><a href="#acknowledgements">Acknowledgements</a></h2>
                    <div id="rfc.section.unnumbered-4.p.1" class="avoidbreakafter">
                        <p>The authors would like to thank the following individuals who have contributed to this
                            document in various ways, ranging from just being generally supportive of bringing forth the
                            document to providing specific feedback or content:</p>
                    </div>
                    <div id="rfc.section.unnumbered-4.p.2">
                        <ul>
                            <li>
                                <div>
                                    <p>Evan Anderson</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Annabelle Backman</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Alan Frindell</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Rory Hewitt</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Fredrik Jeansson</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Benjamin Kaduk</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Torsten Lodderstedt</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Kathleen Moriarty</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Mark Nottingham</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Erik Nygren</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Mike Ounsworth</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Lucas Pardue</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Matt Peterson</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Eric Rescorla</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Justin Richer</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Michael Richardson</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Joe Salowey</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Rich Salz</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Mohit Sethi</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Rifaat Shekh-Yusef</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Travis Spencer</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Nick Sullivan</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Willy Tarreau</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Martin Thomson</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Peter Wu</p>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <p>Hans Zandbelt</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </section>
                <hr class="hidden-print">
                <section id="rfc.authors" class="np">
                    <h2><a href="#rfc.authors">Authors' Addresses</a></h2>
                    <address><b>Brian Campbell</b><br>Ping Identity<br>EMail: <a
                            href="mailto:bcampbell@pingidentity.com">bcampbell@pingidentity.com</a></address>
                    <address><b>Mike Bishop</b> (editor)<br>Akamai<br>EMail: <a
                            href="mailto:mbishop@evequefou.be">mbishop@evequefou.be</a></address>
                </section>
            </div>
        </div>
    </div>
    <script src="/assets/node_modules/jquery/dist/jquery.min.js"></script>
    <script src="/assets/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
</body>

</html>