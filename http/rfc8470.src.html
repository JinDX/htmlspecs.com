<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>RFC 8470 - Using Early Data in HTTP</title>
    <script>
        var buttonsAdded = false;

        function initFeedback() {
            var fb = document.createElement("div");
            fb.className = "btn btn-primary feedback hidden-print";
            fb.setAttribute("onclick", "feedback();");
            fb.appendChild(document.createTextNode("feedback"));

            document.body.appendChild(fb);
        }

        function feedback() {
            toggleButtonsToElementsByName("h2");
            toggleButtonsToElementsByName("h3");
            toggleButtonsToElementsByName("h4");
            toggleButtonsToElementsByName("h5");

            buttonsAdded = !buttonsAdded;
        }

        function toggleButtonsToElementsByName(name) {
            var list = document.getElementsByTagName(name);
            for (var i = 0; i < list.length; i++) {
                toggleButton(list.item(i));
            }
        }

        function toggleButton(node) {
            if (!buttonsAdded) {

                // docname
                var template = "mailto:ietf-http-wg@w3.org?subject={docname},%20%22{section}%22\&amp;body=%3c{ref}%3e:";

                var id = node.getAttribute("id");
                // try also parent
                if (id == null || id == "") {
                    var id = node.parentNode.getAttribute("id");
                }
                // better id available?
                var titlelinks = node.getElementsByTagName("a");
                for (var i = 0; i < titlelinks.length; i++) {
                    var tl = titlelinks.item(i);
                    if (tl.getAttribute("id")) {
                        id = tl.getAttribute("id");
                    }
                }

                // ref
                var ref = window.location.toString();
                var hash = ref.indexOf("#");
                if (hash != -1) {
                    ref = ref.substring(0, hash);
                }
                if (id != null && id != "") {
                    ref += "#" + id;
                }

                // docname
                var docname = "";

                // section
                var section = node.textContent;
                section = section.replace("\u00a0", " ").trim();

                // build URI from template
                var uri = template.replace("{docname}", encodeURIComponent(docname));
                uri = uri.replace("{section}", encodeURIComponent(section));
                uri = uri.replace("{ref}", encodeURIComponent(ref));

                var button = document.createElement("a");
                button.className = "btn btn-primary fbbutton hidden-print";
                button.setAttribute("href", uri);
                button.appendChild(document.createTextNode("send feedback"));
                node.appendChild(button);
            }
            else {
                var buttons = node.getElementsByTagName("a");
                for (var i = 0; i < buttons.length; i++) {
                    var b = buttons.item(i);
                    if (b.className == "btn btn-primary fbbutton hidden-print") {
                        node.removeChild(b);
                    }
                }
            }
        }</script>
    <script>
        function getMeta(rfcno, container) {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "https://www.rfc-editor.org/rfc/rfc" + rfcno + ".json", true);
            xhr.onload = function (e) {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        var data = JSON.parse(xhr.response);

                        var cont = document.getElementById(container);
                        // empty the container
                        while (cont.firstChild) {
                            cont.removeChild(myNode.firstChild);
                        }

                        var c = data.status;
                        if (c) {
                            var bld = newElementWithText("b", c);
                            cont.appendChild(bld);
                        } else {
                            cont.appendChild(newElementWithText("i", "(document status unknown)"));
                        }

                        c = data.updated_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Updated by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.obsoleted_by;
                        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
                            cont.appendChild(newElement("br"));
                            cont.appendChild(newText("Obsoleted by: "));
                            appendRfcLinks(cont, c);
                        }

                        c = data.errata_url;
                        if (c) {
                            cont.appendChild(newElement("br"));
                            var link = newElementWithText("a", "errata");
                            link.setAttribute("href", c);
                            var errata = newElementWithText("i", "This document has ");
                            errata.appendChild(link);
                            errata.appendChild(newText("."));
                            cont.appendChild(errata);
                        }

                        cont.style.display = "block";
                    } else {
                        console.error(xhr.statusText);
                    }
                }
            };
            xhr.onerror = function (e) {
                console.error(xhr.status + " " + xhr.statusText);
            };
            xhr.send(null);
        }
        function appendRfcLinks(parent, updates) {
            var template = "https://www.rfc-editor.org/rfc/rfc{rfc}.html";
            for (var i = 0; i < updates.length; i++) {
                var rfc = updates[i].trim().toLowerCase();
                if (rfc.substring(0, 3) == "rfc") {
                    var no = parseInt(rfc.substring(3), 10);

                    var link = newElement("a");
                    link.setAttribute("href", template.replace("{rfc}", no));
                    link.appendChild(newText(no));
                    parent.appendChild(link);
                } else {
                    parent.appendChild(newText(rfc));
                }
                if (i != updates.length - 1) {
                    parent.appendChild(newText(", "));
                }
            }
        }

        // DOM helpers
        function newElement(name) {
            return document.createElement(name);
        }
        function newElementWithText(name, txt) {
            var e = document.createElement(name);
            e.appendChild(newText(txt));
            return e;
        }
        function newText(text) {
            return document.createTextNode(text);
        }
    </script>
    <script>
        function anchorRewrite() {
            map = {};
            if (window.location.hash.length >= 1) {
                var fragid = window.location.hash.substr(1);
                if (fragid) {
                    if (!document.getElementById(fragid)) {
                        var prefix = "rfc.";
                        var mapped = map[fragid];
                        if (mapped) {
                            window.location.hash = mapped;
                        } else if (fragid.indexOf("section-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(8).replace("-", ".p.");
                        } else if (fragid.indexOf("appendix-") == 0) {
                            window.location.hash = prefix + "section." + fragid.substring(9).replace("-", ".p.");
                        } else if (fragid.indexOf("s-") == 0) {
                            var postfix = fragid.substring(2);
                            if (postfix.startsWith("abstract")) {
                                window.location.hash = prefix + postfix;
                            } else if (postfix.startsWith("note-")) {
                                window.location.hash = prefix + "note." + postfix.substring(5).replace("-", ".p.");
                            } else {
                                window.location.hash = prefix + "section." + postfix.replace("-", ".p.");
                            }
                        } else if (fragid.indexOf("p-") == 0) {
                            var r = fragid.substring(2);
                            var p = r.indexOf("-");
                            if (p >= 0) {
                                window.location.hash = prefix + "section." + r.substring(0, p) + ".p." + r.substring(p + 1);
                            }
                        }
                    }
                }
            }
        }
        window.addEventListener('hashchange', anchorRewrite);
        window.addEventListener('DOMContentLoaded', anchorRewrite);
    </script>
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <script>try {
            PR['registerLangHandler'](
                PR['createSimpleLexer'](
                    [
                        // comment
                        [PR['PR_COMMENT'], /^;[^\x00-\x1f]*/, null, ";"],
                    ],
                    [
                        // string literals
                        [PR['PR_STRING'], /^(\%s|\%i)?"[^"\x00-\x1f]*"/, null],
                        // binary literals
                        [PR['PR_LITERAL'], /^\%b[01]+((-[01]+)|(\.[01]+)*)/, null],
                        // decimal literals
                        [PR['PR_LITERAL'], /^\%d[0-9]+((-[0-9]+)|(\.[0-9]+)*)/, null],
                        // hex literals
                        [PR['PR_LITERAL'], /^(\%x[A-Za-z0-9]+((-[A-Za-z0-9]+)|(\.[A-Za-z0-9]+)*))/, null],
                        // prose rule
                        [PR['PR_NOCODE'], /^<[^>\x00-\x1f]*>/, null],
                        // rule name
                        [PR['PR_TYPE'], /^([A-Za-z][A-Za-z0-9-]*)/, null],
                        [PR['PR_PUNCTUATION'], /^[=\(\)\*\/\[\]#]/, null],
                    ]),
                ['ietf_abnf']);
        } catch (e) { }
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:type" content="article">
    <meta property="og:title" content="RFC8470">
    <meta property="og:description" content="Using Early Data in HTTP">
    <meta property="og:url" content="https://httpwg.org/specs/rfc8470.html">
    <meta property="og:site_name" content="IETF HTTP Working Group Specifications">
    <meta property="og:image" content="https://httpwg.org/assets/favicon/apple-icon-180x180.png">
    <link rel="stylesheet" type="text/css" href="/assets/node_modules/bootstrap/dist/css/bootstrap.min.css">
    <style type="text/css">
        body {
            padding-top: 80px;
            padding-bottom: 80px;
            position: relative;
        }

        .table.header th,
        .table.header td {
            border-top: none;
            padding: 0;
        }

        #sidebar {
            margin-top: -10px;
            height: 90%;
            overflow-y: auto;
            font-size: 90%;
        }

        #rfc\.meta {
            width: 40%;
            float: right
        }

        .toc ul {
            list-style: none;
        }

        .filename {
            color: rgb(119, 119, 119);
            font-size: 23px;
            font-weight: normal;
            height: auto;
            line-height: 23px;
        }

        dl {
            margin-left: 1em;
        }

        dl.dl-horizontal: {
            margin-left: 0;
        }

        dl>dt {
            float: left;
            margin-right: 1em;
        }

        dl.nohang>dt {
            float: none;
        }

        dl>dd {
            margin-bottom: .5em;
        }

        dl.compact>dd {
            margin-bottom: 0em;
        }

        dl>dd>dl {
            margin-top: 0.5em;
            margin-bottom: 0em;
        }

        ul.empty {
            list-style-type: none;
        }

        ul.empty li {
            margin-top: .5em;
        }

        td.reference {
            padding-right: 1em;
            vertical-align: top;
        }

        .feedback {
            position: fixed;
            bottom: 5px;
            right: 5px;
        }

        .fbbutton {
            margin-left: 5px;
        }

        h1 a,
        h2 a,
        h3 a,
        h4 a,
        h5 a,
        h6 a {
            color: rgb(51, 51, 51);
        }

        span.tt {
            font: 11pt consolas, monospace;
            font-size-adjust: none;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="/assets/site.css">
    <link rel="Contents" href="#rfc.toc">
    <link rel="Author" href="#rfc.authors">
    <link rel="License" href="#rfc.copyrightnotice">
    <link rel="Chapter" title="1 Introduction" href="#rfc.section.1">
    <link rel="Chapter" title="2 Early Data in HTTP" href="#rfc.section.2">
    <link rel="Chapter" title="3 Supporting Early Data in HTTP Servers" href="#rfc.section.3">
    <link rel="Chapter" title="4 Using Early Data in HTTP Clients" href="#rfc.section.4">
    <link rel="Chapter" title="5 Extensions for Early Data in HTTP" href="#rfc.section.5">
    <link rel="Chapter" title="6 Security Considerations" href="#rfc.section.6">
    <link rel="Chapter" title="7 IANA Considerations" href="#rfc.section.7">
    <link rel="Chapter" title="8 References" href="#rfc.section.8">
    <link rel="Appendix" title="Acknowledgments" href="#rfc.section.unnumbered-1">
    <link rel="Alternate" title="Plain Text Version" href="http://www.ietf.org/rfc/rfc8470.txt">
    <link rel="Help" title="RFC-Editor's Status Page" href="https://www.rfc-editor.org/info/rfc8470">
    <meta name="viewport" content="initial-scale=1">
    <meta name="generator"
        content="https://github.com/mnot/RFCBootstrap XSLT vendor: Saxonica http://www.saxonica.com/">
    <meta name="keywords" content="Internet-Draft">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <meta name="dcterms.creator" content="Thomson, M.">
    <meta name="dcterms.creator" content="Nottingham, M.">
    <meta name="dcterms.creator" content="Tarreau, W.">
    <meta name="dcterms.identifier" content="urn:ietf:rfc:8470">
    <meta name="dcterms.issued" content="2018-09">
    <meta name="dcterms.abstract"
        content="Using TLS early data creates an exposure to the possibility of a replay attack. This document defines mechanisms that allow clients to communicate with servers about HTTP requests that are sent in early data. Techniques are described that use these mechanisms to mitigate the risk of replay.">
    <meta name="dcterms.isPartOf" content="urn:issn:2070-1721">
    <meta name="description"
        content="Using TLS early data creates an exposure to the possibility of a replay attack. This document defines mechanisms that allow clients to communicate with servers about HTTP requests that are sent in early data. Techniques are described that use these mechanisms to mitigate the risk of replay.">
</head>

<body onload="getMeta(8470,&#34;rfc.meta&#34;);initFeedback();">
    <nav class="navbar navbar-dark bg-dark d-print-none navbar-expand-lg fixed-top ps-3 pe-3" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse"
                aria-controls="navbarToggler" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <a class="navbar-brand" href="https://httpwg.org/"><img src="https://httpwg.org/assets/http.svg"
                    height="23"></a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse">

            <div class="navbar-nav me-auto">

                <a class="nav-item ms-1 text-white" href="https://httpwg.org/specs/">📄 Documentation</a>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Work in
                        Progress</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/http-extensions/">HTTP Extensions</a></li>
                        <li class="dropdown-item"><a
                                href="https://github.com/httpwg/admin/issues?q=is%3Aissue+is%3Aopen+label%3Aadoption">Future
                                Work</a></li>
                    </ul>
                </div>

                <div class="dropdown ms-4">
                    <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Participate</a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item"><a href="https://httpwg.org/about/">About the HTTP Working Group</a>
                        </li>
                        <li class="divider"></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/CONTRIBUTING.html">Contribution Policy</a>
                        </li>
                        <li class="dropdown-item"><a href="http://datatracker.ietf.org/wg/httpbis/charter/">WG
                                Charter</a></li>
                        <li class="dropdown-item"><a href="http://lists.w3.org/Archives/Public/ietf-http-wg/">Group
                                Mailing List 📨</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/wg-materials/">Meeting Materials</a></li>
                        <li class="dropdown-item"><a href="https://httpwg.org/admin/editors/">Document Editor
                                Resources</a></li>
                    </ul>
                </div>
            </div>

        </div>
    </nav>
    <div class="container" id="top">
        <div class="row">
            <div class="col-lg-4 order-last d-none d-lg-block" id="sidebar" role="navigation">
                <div class="navbar">
                    <div class="navbar-brand"><a href="#top"><strong>RFC </strong>8470</a></div><br clear="all">
                    <div class="">
                        <div class="toc ">
                            <ul>
                                <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#introduction">Introduction</a>
                                    <ul>
                                        <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#conventions-and-definitions">Conventions and Definitions</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#early-data-in-http">Early
                                        Data in HTTP</a></li>
                                <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#supporting-early-data-in-http-servers">Supporting Early Data in HTTP
                                        Servers</a></li>
                                <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#using-early-data-in-http-clients">Using Early Data in HTTP Clients</a>
                                </li>
                                <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#extensions-for-early-data-in-http">Extensions for Early Data in HTTP</a>
                                    <ul>
                                        <li><a href="#rfc.section.5.1">5.1.</a>&nbsp;&nbsp;&nbsp;<a href="#header">The
                                                Early-Data Header Field</a></li>
                                        <li><a href="#rfc.section.5.2">5.2.</a>&nbsp;&nbsp;&nbsp;<a href="#status">The
                                                425 (Too Early) Status Code</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#security-considerations">Security Considerations</a>
                                    <ul>
                                        <li><a href="#rfc.section.6.1">6.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#gateways-and-early-data">Gateways and Early Data</a></li>
                                        <li><a href="#rfc.section.6.2">6.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#be-consistent">Consistent Handling of Early Data</a></li>
                                        <li><a href="#rfc.section.6.3">6.3.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#denial-of-service">Denial of Service</a></li>
                                        <li><a href="#rfc.section.6.4">6.4.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#out-of-order-delivery">Out-of-Order Delivery</a></li>
                                    </ul>
                                </li>
                                <li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a href="#iana-considerations">IANA
                                        Considerations</a></li>
                                <li><a href="#rfc.section.8">8.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references">References</a>
                                    <ul>
                                        <li><a href="#rfc.section.8.1">8.1.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.1">Normative References</a></li>
                                        <li><a href="#rfc.section.8.2">8.2.</a>&nbsp;&nbsp;&nbsp;<a
                                                href="#rfc.references.2">Informative References</a></li>
                                    </ul>
                                </li>
                                <li><a href="#acknowledgments">Acknowledgments</a></li>
                                <li><a href="#rfc.authors">Authors' Addresses</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-8 order-first main" role="main">
                <header>
                    <table class="table table-condensed header" id="rfc.headerblock">
                        <tbody>
                            <tr>
                                <td class="text-left">Internet Engineering Task Force (IETF)</td>
                                <td class="text-right">M. Thomson</td>
                            </tr>
                            <tr>
                                <td class="text-left">Request for Comments: 8470</td>
                                <td class="text-right">Mozilla</td>
                            </tr>
                            <tr>
                                <td class="text-left">Category: Standards Track</td>
                                <td class="text-right">M. Nottingham</td>
                            </tr>
                            <tr>
                                <td class="text-left">ISSN: 2070-1721</td>
                                <td class="text-right">Fastly</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">W. Tarreau</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">HAProxy Technologies</td>
                            </tr>
                            <tr>
                                <td class="text-left"></td>
                                <td class="text-right">September 2018</td>
                            </tr>
                        </tbody>
                    </table>
                    <div id="rfc.title">
                        <h1>Using Early Data in HTTP</h1>
                    </div>
                </header>
                <hr>
                <h2 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h2>
                <div class="lead">
                    <div id="rfc.abstract.p.1">
                        <p>Using TLS early data creates an exposure to the possibility of a replay attack. This document
                            defines mechanisms that allow clients to communicate with servers about HTTP requests that
                            are sent in early data. Techniques are described that use these mechanisms to mitigate the
                            risk of replay.</p>
                    </div>
                </div>
                <aside id="rfc.meta" class="alert alert-info"></aside>
                <section id="rfc.status">
                    <h2><a href="#rfc.status">Status of this Memo</a></h2>
                    <div id="rfc.boilerplate.1.p.1">
                        <p>This is an Internet Standards Track document.</p>
                    </div>
                    <div id="rfc.boilerplate.1.p.2">
                        <p>This document is a product of the Internet Engineering Task Force (IETF). It represents the
                            consensus of the IETF community. It has received public review and has been approved for
                            publication by the Internet Engineering Steering Group (IESG). Further information on
                            Internet Standards is available in <a
                                href="https://www.rfc-editor.org/rfc/rfc7841.html#section-2">Section 2 of RFC 7841</a>.
                        </p>
                    </div>
                    <div id="rfc.boilerplate.1.p.3">
                        <p>Information about the current status of this document, any errata, and how to provide
                            feedback on it may be obtained at <a
                                href="https://www.rfc-editor.org/info/rfc8470">https://www.rfc-editor.org/info/rfc8470</a>.
                        </p>
                    </div>
                </section>
                <section id="rfc.copyrightnotice">
                    <h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2>
                    <div id="rfc.boilerplate.2.p.1">
                        <p>Copyright (c) 2018 IETF Trust and the persons identified as the document authors. All rights
                            reserved.</p>
                    </div>
                    <div id="rfc.boilerplate.2.p.2">
                        <p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF
                            Documents (<a
                                href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>)
                            in effect on the date of publication of this document. Please review these documents
                            carefully, as they describe your rights and restrictions with respect to this document. Code
                            Components extracted from this document must include Simplified BSD License text as
                            described in Section 4.e of the Trust Legal Provisions and are provided without warranty as
                            described in the Simplified BSD License.</p>
                    </div>
                </section>
                <div class="toc d-lg-none">
                    <ul>
                        <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#introduction">Introduction</a>
                            <ul>
                                <li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#conventions-and-definitions">Conventions and Definitions</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#early-data-in-http">Early Data in
                                HTTP</a></li>
                        <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a
                                href="#supporting-early-data-in-http-servers">Supporting Early Data in HTTP Servers</a>
                        </li>
                        <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a
                                href="#using-early-data-in-http-clients">Using Early Data in HTTP Clients</a></li>
                        <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a
                                href="#extensions-for-early-data-in-http">Extensions for Early Data in HTTP</a>
                            <ul>
                                <li><a href="#rfc.section.5.1">5.1.</a>&nbsp;&nbsp;&nbsp;<a href="#header">The
                                        Early-Data Header Field</a></li>
                                <li><a href="#rfc.section.5.2">5.2.</a>&nbsp;&nbsp;&nbsp;<a href="#status">The 425 (Too
                                        Early) Status Code</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#security-considerations">Security
                                Considerations</a>
                            <ul>
                                <li><a href="#rfc.section.6.1">6.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#gateways-and-early-data">Gateways and Early Data</a></li>
                                <li><a href="#rfc.section.6.2">6.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#be-consistent">Consistent Handling of Early Data</a></li>
                                <li><a href="#rfc.section.6.3">6.3.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#denial-of-service">Denial of Service</a></li>
                                <li><a href="#rfc.section.6.4">6.4.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#out-of-order-delivery">Out-of-Order Delivery</a></li>
                            </ul>
                        </li>
                        <li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a href="#iana-considerations">IANA
                                Considerations</a></li>
                        <li><a href="#rfc.section.8">8.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">References</a>
                            <ul>
                                <li><a href="#rfc.section.8.1">8.1.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.1">Normative References</a></li>
                                <li><a href="#rfc.section.8.2">8.2.</a>&nbsp;&nbsp;&nbsp;<a
                                        href="#rfc.references.2">Informative References</a></li>
                            </ul>
                        </li>
                        <li><a href="#acknowledgments">Acknowledgments</a></li>
                        <li><a href="#rfc.authors">Authors' Addresses</a></li>
                    </ul>
                </div>
                <section id="introduction">
                    <h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a
                            href="#introduction">Introduction</a></h2>
                    <div id="rfc.section.1.p.1">
                        <p>TLS 1.3 <a href="#TLS13"><cite
                                    title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS13]</cite></a>
                            introduces the concept of early data (also known as zero round-trip time (0-RTT) data). If
                            the client has spoken to the same server recently, early data allows a client to send data
                            to a server in the first round trip of a connection, without waiting for the TLS handshake
                            to complete.</p>
                    </div>
                    <div id="rfc.section.1.p.2">
                        <p>When used with HTTP <a href="#HTTP"><cite
                                    title="Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing">[HTTP]</cite></a>,
                            early data allows clients to send requests immediately, thus avoiding the one or two
                            round-trip delays needed for the TLS handshake. This is a significant performance
                            enhancement; however, it has significant limitations.</p>
                    </div>
                    <div id="rfc.section.1.p.3">
                        <p>The primary risk of using early data is that an attacker might capture and replay the
                            request(s) it contains. TLS <a href="#TLS13"><cite
                                    title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS13]</cite></a>
                            describes techniques that can be used to reduce the likelihood that an attacker can
                            successfully replay a request, but these techniques can be difficult to deploy and still
                            leave some possibility of a successful attack.</p>
                    </div>
                    <div id="rfc.section.1.p.4">
                        <p>Note that this is different from automated or user-initiated retries; replays are initiated
                            by an attacker without the awareness of the client.</p>
                    </div>
                    <div id="rfc.section.1.p.5">
                        <p>To help mitigate the risk of replays in HTTP, this document gives an overview of techniques
                            for controlling these risks in servers and defines requirements for clients when sending
                            requests in early data.</p>
                    </div>
                    <div id="rfc.section.1.p.6">
                        <p>The advice in this document also applies to use of 0-RTT in HTTP over QUIC <a
                                href="#HQ"><cite title="Hypertext Transfer Protocol (HTTP) over QUIC">[HQ]</cite></a>.
                        </p>
                    </div>
                    <section id="conventions-and-definitions">
                        <h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a>&nbsp;<a
                                href="#conventions-and-definitions">Conventions and Definitions</a></h3>
                        <div id="rfc.section.1.1.p.1">
                            <p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD
                                NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be
                                interpreted as described in BCP 14 <a href="#RFC2119"><cite
                                        title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a>
                                <a href="#RFC8174"><cite
                                        title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">[RFC8174]</cite></a>
                                when, and only when, they appear in all capitals, as shown here.
                            </p>
                        </div>
                    </section>
                </section>
                <section id="early-data-in-http">
                    <h2 id="rfc.section.2"><a href="#rfc.section.2">2.</a>&nbsp;<a href="#early-data-in-http">Early Data
                            in HTTP</a></h2>
                    <div id="rfc.section.2.p.1">
                        <p>Conceptually, early data is concatenated with other application data to form a single stream.
                            This can mean that requests are entirely contained within early data or that only part of a
                            request is early. In a multiplexed protocol, like HTTP/2 <a href="#RFC7540"><cite
                                    title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a> or
                            HTTP/QUIC <a href="#HQ"><cite
                                    title="Hypertext Transfer Protocol (HTTP) over QUIC">[HQ]</cite></a>, multiple
                            requests might be partially delivered in early data.</p>
                    </div>
                    <div id="rfc.section.2.p.2">
                        <p>The model that this document assumes is that once the TLS handshake completes, the early data
                            received on that TLS connection is known to not be a replayed copy of that data. However, it
                            is important to note that this does not mean that early data will not be or has not been
                            replayed on another connection.</p>
                    </div>
                </section>
                <section id="supporting-early-data-in-http-servers">
                    <h2 id="rfc.section.3"><a href="#rfc.section.3">3.</a>&nbsp;<a
                            href="#supporting-early-data-in-http-servers">Supporting Early Data in HTTP Servers</a></h2>
                    <div id="rfc.section.3.p.1">
                        <p>A server decides whether or not to offer a client the ability to send early data on future
                            connections when sending the TLS session ticket.</p>
                    </div>
                    <div id="rfc.section.3.p.2">
                        <p>TLS <a href="#TLS13"><cite
                                    title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS13]</cite></a>
                            mandates the use of replay detection strategies that reduce the ability of an attacker to
                            successfully replay early data. These anti-replay techniques reduce but don’t completely
                            eliminate the chance of data being replayed and ensure a fixed upper limit to the number of
                            replays.</p>
                    </div>
                    <div id="rfc.section.3.p.3" class="avoidbreakafter">
                        <p>When a server enables early data, there are a number of techniques it can use to mitigate the
                            risks of replay:</p>
                    </div>
                    <div id="rfc.section.3.p.4">
                        <ol>
                            <li>The server can reject early data at the TLS layer. A server cannot selectively reject
                                early data, so this results in all requests sent in early data being discarded.</li>
                            <li>The server can choose to delay processing of early data until after the TLS handshake
                                completes. By deferring processing, it can ensure that only a successfully completed
                                connection is used for the request(s) therein. This provides the server with some
                                assurance that the early data was not replayed. If the server receives multiple requests
                                in early data, it can determine whether to defer HTTP processing on a per-request basis.
                            </li>
                            <li>The server can cause a client to retry individual requests and not use early data by
                                responding with the 425 (Too Early) status code (<a href="#status"
                                    title="The 425 (Too Early) Status Code">Section 5.2</a>) in cases where the risk of
                                replay is judged too great.</li>
                        </ol>
                    </div>
                    <div id="rfc.section.3.p.5">
                        <p>All of these techniques are equally effective; a server can use the method that best suits
                            it.</p>
                    </div>
                    <div id="rfc.section.3.p.6">
                        <p>For a given request, the level of tolerance to replay risk is specific to the resource it
                            operates upon (and therefore only known to the origin server). The primary risk associated
                            with using early data is in the actions a server takes when processing a request; processing
                            a duplicated request might result in duplicated effects and side effects. <a
                                href="https://www.rfc-editor.org/rfc/rfc8446.html#appendix-E.5">Appendix E.5</a> of <a
                                href="#TLS13"><cite
                                    title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS13]</cite></a>
                            also describes other effects produced by processing duplicated requests.</p>
                    </div>
                    <div id="rfc.section.3.p.7">
                        <p>The request method’s safety (<a href="#RFC7231"><cite
                                    title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">[RFC7231]</cite></a>,
                            <a href="https://www.rfc-editor.org/rfc/rfc7231.html#section-4.2.1">Section 4.2.1</a>) is
                            one way to determine this. However, some resources produce side effects with safe methods,
                            so this cannot be universally relied upon.
                        </p>
                    </div>
                    <div id="rfc.section.3.p.8">
                        <p>It is RECOMMENDED that origin servers allow resources to explicitly configure whether early
                            data is appropriate in requests. Absent such explicit information, origin servers MUST
                            either reject early data or implement the techniques described in this document for ensuring
                            that requests are not processed prior to TLS handshake completion.</p>
                    </div>
                    <div id="rfc.section.3.p.9">
                        <p>A request might be sent partially in early data with the remainder of the request being sent
                            after the handshake completes. This does not necessarily affect handling of that request;
                            what matters is when the server starts acting upon the contents of a request. Any time any
                            server instance might initiate processing prior to completion of the handshake, all server
                            instances need to account for the possibility of replay of early data and how that could
                            affect that processing (see also <a href="#be-consistent"
                                title="Consistent Handling of Early Data">Section 6.2</a>).</p>
                    </div>
                    <div id="rfc.section.3.p.10">
                        <p>A server can partially process requests that are incomplete. Parsing header fields -- without
                            acting on the values -- and determining request routing is likely to be safe from side
                            effects but other actions might not be.</p>
                    </div>
                    <div id="rfc.section.3.p.11">
                        <p>Intermediary servers do not have sufficient information to decide whether early data can be
                            processed, so <a href="#status" title="The 425 (Too Early) Status Code">Section 5.2</a>
                            describes a way for the origin to signal to them that a particular request isn’t appropriate
                            for early data. Intermediaries that accept early data MUST implement that mechanism.</p>
                    </div>
                    <div id="rfc.section.3.p.12">
                        <p>Note that a server cannot choose to selectively reject early data at the TLS layer. TLS only
                            permits a server to either accept all early data or none of it. Once a server has decided to
                            accept early data, it MUST process all requests in early data, even if the server rejects
                            the request by sending a 425 (Too Early) response.</p>
                    </div>
                    <div id="rfc.section.3.p.13">
                        <p>A server can limit the amount of early data with the <span
                                class="tt">max_early_data_size</span> field of the <span class="tt">early_data</span>
                            TLS extension. This can be used to avoid committing an arbitrary amount of memory for
                            requests that it might defer until the handshake completes.</p>
                    </div>
                </section>
                <section id="using-early-data-in-http-clients">
                    <h2 id="rfc.section.4"><a href="#rfc.section.4">4.</a>&nbsp;<a
                            href="#using-early-data-in-http-clients">Using Early Data in HTTP Clients</a></h2>
                    <div id="rfc.section.4.p.1">
                        <p>A client that wishes to use early data commences by sending HTTP requests immediately after
                            sending the TLS ClientHello.</p>
                    </div>
                    <div id="rfc.section.4.p.2">
                        <p>By their nature, clients have control over whether a given request is sent in early data,
                            thereby giving the client control over risk of replay. Absent other information, clients MAY
                            send requests with safe HTTP methods (<a href="#RFC7231"><cite
                                    title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">[RFC7231]</cite></a>,
                            <a href="https://www.rfc-editor.org/rfc/rfc7231.html#section-4.2.1">Section 4.2.1</a>) in
                            early data when it is available and MUST NOT send unsafe methods (or methods whose safety is
                            not known) in early data.
                        </p>
                    </div>
                    <div id="rfc.section.4.p.3">
                        <p>If the server rejects early data at the TLS layer, a client MUST start sending again as
                            though the connection were new. This could entail using a different negotiated protocol <a
                                href="#ALPN"><cite
                                    title="Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension">[ALPN]</cite></a>
                            than the one optimistically used for the early data. Any requests sent in early data will
                            need to be sent again, unless the client decides to abandon those requests.</p>
                    </div>
                    <div id="rfc.section.4.p.4">
                        <p>Automatic retry creates the potential for a replay attack. An attacker intercepts a
                            connection that uses early data and copies the early data to another server instance. The
                            second server instance accepts and processes the early data, even though it will not
                            complete the TLS handshake. The attacker then allows the original connection to complete.
                            Even if the early data is detected as a duplicate and rejected, the first server instance
                            might allow the connection to complete. If the client then retries requests that were sent
                            in early data, the request will be processed twice.</p>
                    </div>
                    <div id="rfc.section.4.p.5">
                        <p>Replays are also possible if there are multiple server instances that will accept early data
                            or if the same server accepts early data multiple times (though the latter would be in
                            violation of requirements in <a
                                href="https://www.rfc-editor.org/rfc/rfc8446.html#section-8">Section 8</a> of <a
                                href="#TLS13"><cite
                                    title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS13]</cite></a>).
                        </p>
                    </div>
                    <div id="rfc.section.4.p.6">
                        <p>Clients that use early data MUST retry requests upon receipt of a 425 (Too Early) status
                            code; see <a href="#status" title="The 425 (Too Early) Status Code">Section 5.2</a>.</p>
                    </div>
                    <div id="rfc.section.4.p.7">
                        <p>An intermediary MUST NOT use early data when forwarding a request unless early data was used
                            on a previous hop, or it knows that the request can be retried safely without consequences
                            (typically, using out-of-band configuration). Absent better information, that means that an
                            intermediary can only use early data if the request either arrived in early data or arrived
                            with the Early-Data header field set to “1” (see <a href="#header"
                                title="The Early-Data Header Field">Section 5.1</a>).</p>
                    </div>
                </section>
                <section id="extensions-for-early-data-in-http">
                    <h2 id="rfc.section.5"><a href="#rfc.section.5">5.</a>&nbsp;<a
                            href="#extensions-for-early-data-in-http">Extensions for Early Data in HTTP</a></h2>
                    <div id="rfc.section.5.p.1">
                        <p>Because HTTP requests can span multiple “hops”, it is necessary to explicitly communicate
                            whether a request has been sent in early data on a previous hop. Likewise, it is necessary
                            to have some means of explicitly triggering a retry when early data is not desired. Finally,
                            it is necessary to know whether the client will actually perform such a retry.</p>
                    </div>
                    <div id="rfc.section.5.p.2" class="avoidbreakafter">
                        <p>To meet these needs, two signaling mechanisms are defined:</p>
                    </div>
                    <div id="rfc.section.5.p.3">
                        <ul>
                            <li>The Early-Data header field is included in requests that might have been forwarded by an
                                intermediary prior to the completion of the TLS handshake with its client.</li>
                            <li>The 425 (Too Early) status code is defined for a server to indicate that a request could
                                not be processed due to the consequences of a possible replay attack.</li>
                        </ul>
                    </div>
                    <div id="rfc.section.5.p.4">
                        <p>They are designed to enable better coordination of the use of early data between the user
                            agent and origin server, and also when a gateway (also “reverse proxy”, “Content Delivery
                            Network”, or “surrogate”) is present.</p>
                    </div>
                    <div id="rfc.section.5.p.5">
                        <p>Gateways typically don’t have specific information about whether a given request can be
                            processed safely when it is sent in early data. In many cases, only the origin server has
                            the necessary information to decide whether the risk of replay is acceptable. These
                            extensions allow coordination between a gateway and its origin server.</p>
                    </div>
                    <section id="header">
                        <h3 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a>&nbsp;<a href="#header">The
                                Early-Data Header Field</a></h3>
                        <div id="rfc.section.5.1.p.1">
                            <p>The Early-Data request header field indicates that the request has been conveyed in early
                                data and that a client understands the 425 (Too Early) status code.</p>
                        </div>
                        <div id="rfc.section.5.1.p.2" class="avoidbreakafter">
                            <p>It has just one valid value: “1”. Its syntax is defined by the following ABNF <a
                                    href="#ABNF"><cite
                                        title="Augmented BNF for Syntax Specifications: ABNF">[ABNF]</cite></a>:</p>
                        </div>
                        <div id="rfc.figure.u.1">
                            <div>
                                <pre class="inline prettyprint lang-ietf_abnf">
Early-Data = "1"
</pre>
                            </div>
                        </div>
                        <div id="rfc.section.5.1.p.3" class="avoidbreakafter">
                            <p>For example:</p>
                        </div>
                        <div id="rfc.figure.u.2">
                            <div>
                                <pre class="text">
GET /resource HTTP/1.0
Host: example.com
Early-Data: 1

</pre>
                            </div>
                        </div>
                        <div id="rfc.section.5.1.p.4">
                            <p>An intermediary that forwards a request prior to the completion of the TLS handshake with
                                its client MUST send it with the Early-Data header field set to “1” (i.e., it adds it if
                                not present in the request). An intermediary MUST use the Early-Data header field if the
                                request might have been subject to a replay and might already have been forwarded by it
                                or another instance (see <a href="#be-consistent"
                                    title="Consistent Handling of Early Data">Section 6.2</a>).</p>
                        </div>
                        <div id="rfc.section.5.1.p.5">
                            <p>An intermediary MUST NOT remove this header field if it is present in a request.
                                Early-Data MUST NOT appear in a Connection header field.</p>
                        </div>
                        <div id="rfc.section.5.1.p.6">
                            <p>The Early-Data header field is not intended for use by user agents (that is, the original
                                initiator of a request). Sending a request in early data implies that the client
                                understands this specification and is willing to retry a request in response to a 425
                                (Too Early) status code. A user agent that sends a request in early data does not need
                                to include the Early-Data header field.</p>
                        </div>
                        <div id="rfc.section.5.1.p.7">
                            <p>A server cannot make a request that contains the Early-Data header field safe for
                                processing by waiting for the handshake to complete. A request that is marked with
                                Early-Data was sent in early data on a previous hop. Requests that contain the
                                Early-Data header field and cannot be safely processed MUST be rejected using the 425
                                (Too Early) status code.</p>
                        </div>
                        <div id="rfc.section.5.1.p.8">
                            <p>The Early-Data header field carries a single bit of information, and clients MUST include
                                at most one instance. Multiple or invalid instances of the header field MUST be treated
                                as equivalent to a single instance with a value of 1 by a server.</p>
                        </div>
                        <div id="rfc.section.5.1.p.9">
                            <p>An Early-Data header field MUST NOT be included in responses or request trailers.</p>
                        </div>
                    </section>
                    <section id="status">
                        <h3 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2.</a>&nbsp;<a href="#status">The 425 (Too
                                Early) Status Code</a></h3>
                        <div id="rfc.section.5.2.p.1">
                            <p>A 425 (Too Early) status code indicates that the server is unwilling to risk processing a
                                request that might be replayed.</p>
                        </div>
                        <div id="rfc.section.5.2.p.2">
                            <p>User agents that send a request in early data are expected to retry the request when
                                receiving a 425 (Too Early) response status code. A user agent SHOULD retry
                                automatically, but any retries MUST NOT be sent in early data.</p>
                        </div>
                        <div id="rfc.section.5.2.p.3">
                            <p>In all cases, an intermediary can forward a 425 (Too Early) status code. Intermediaries
                                MUST forward a 425 (Too Early) status code if the request that it received and forwarded
                                contained an Early-Data header field. Otherwise, an intermediary that receives a request
                                in early data MAY automatically retry that request in response to a 425 (Too Early)
                                status code, but it MUST wait for the TLS handshake to complete on the connection where
                                it received the request.</p>
                        </div>
                        <div id="rfc.section.5.2.p.4">
                            <p>The server cannot assume that a client is able to retry a request unless the request is
                                received in early data or the Early-Data header field is set to “1”. A server SHOULD NOT
                                emit the 425 status code unless one of these conditions is met.</p>
                        </div>
                        <div id="rfc.section.5.2.p.5">
                            <p>The 425 (Too Early) status code is not cacheable by default. Its payload is not the
                                representation of any identified resource.</p>
                        </div>
                    </section>
                </section>
                <section id="security-considerations">
                    <h2 id="rfc.section.6"><a href="#rfc.section.6">6.</a>&nbsp;<a
                            href="#security-considerations">Security Considerations</a></h2>
                    <div id="rfc.section.6.p.1">
                        <p>Using early data exposes a client to the risk that their request is replayed. A retried or
                            replayed request can produce different side effects on the server. In addition to those side
                            effects, replays and retries might be used for traffic analysis to recover information about
                            requests or the resources those requests target. In particular, a request that is replayed
                            might result in a different response, which might be observable from the length of protected
                            data even if the content remains confidential.</p>
                    </div>
                    <section id="gateways-and-early-data">
                        <h3 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a>&nbsp;<a
                                href="#gateways-and-early-data">Gateways and Early Data</a></h3>
                        <div id="rfc.section.6.1.p.1">
                            <p>A gateway MUST NOT forward requests that were received in early data unless it knows that
                                the origin server it will forward to understands the Early-Data header field and will
                                correctly generate a 425 (Too Early) status code. A gateway that is uncertain about
                                origin server support for a given request SHOULD either delay forwarding the request
                                until the TLS handshake with its client completes or send a 425 (Too Early) status code
                                in response.</p>
                        </div>
                        <div id="rfc.section.6.1.p.2">
                            <p>A gateway without at least one potential origin server that supports the Early-Data
                                header field expends significant effort for what can at best be a modest performance
                                benefit from enabling early data. If no origin server supports early data, it is more
                                efficient to disable early data entirely.</p>
                        </div>
                    </section>
                    <section id="be-consistent">
                        <h3 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2.</a>&nbsp;<a
                                href="#be-consistent">Consistent Handling of Early Data</a></h3>
                        <div id="rfc.section.6.2.p.1">
                            <p>Consistent treatment of a request that arrives in, or partially in, early data is
                                critical to avoiding inappropriate processing of replayed requests. If a request is not
                                safe to process before the TLS handshake completes, then all instances of the server
                                (including gateways) need to agree and either reject the request or delay processing.
                            </p>
                        </div>
                        <div id="rfc.section.6.2.p.2">
                            <p>Disabling early data, delaying requests, or rejecting requests with the 425 (Too Early)
                                status code are all equally good measures for mitigating replay attacks on requests that
                                might be vulnerable to replay. Server instances can implement any of these measures and
                                be considered consistent, even if different instances use different methods. Critically,
                                this means that it is possible to employ different mitigations in reaction to other
                                conditions, such as server load.</p>
                        </div>
                        <div id="rfc.section.6.2.p.3">
                            <p>A server MUST NOT act on early data before the handshake completes if it and any other
                                server instance could make a different decision about how to handle the same data.</p>
                        </div>
                    </section>
                    <section id="denial-of-service">
                        <h3 id="rfc.section.6.3"><a href="#rfc.section.6.3">6.3.</a>&nbsp;<a
                                href="#denial-of-service">Denial of Service</a></h3>
                        <div id="rfc.section.6.3.p.1">
                            <p>Accepting early data exposes a server to potential denial of service through the replay
                                of requests that are expensive to handle. A server that is under load SHOULD prefer
                                rejecting TLS early data as a whole rather than accepting early data and selectively
                                processing requests. Generating a 503 (Service Unavailable) or 425 (Too Early) status
                                code often leads to clients retrying requests, which could result in increased load.</p>
                        </div>
                    </section>
                    <section id="out-of-order-delivery">
                        <h3 id="rfc.section.6.4"><a href="#rfc.section.6.4">6.4.</a>&nbsp;<a
                                href="#out-of-order-delivery">Out-of-Order Delivery</a></h3>
                        <div id="rfc.section.6.4.p.1">
                            <p>In protocols that deliver data out of order (such as QUIC <a href="#HQ"><cite
                                        title="Hypertext Transfer Protocol (HTTP) over QUIC">[HQ]</cite></a>), early
                                data can arrive after the handshake completes. A server MAY process requests received in
                                early data after handshake completion only if it can rely on other instances correctly
                                handling replays of the same requests.</p>
                        </div>
                    </section>
                </section>
                <section id="iana-considerations">
                    <h2 id="rfc.section.7"><a href="#rfc.section.7">7.</a>&nbsp;<a href="#iana-considerations">IANA
                            Considerations</a></h2>
                    <div id="rfc.section.7.p.1">
                        <p>This document registers the Early-Data header field in the “Permanent Message Header Field
                            Names” registry located at &lt;<a
                                href="https://www.iana.org/assignments/message-headers">https://www.iana.org/assignments/message-headers</a>&gt;.
                        </p>
                    </div>
                    <div id="rfc.section.7.p.2">
                        <dl class="compact">
                            <dt>Header field name:</dt>
                            <dd>Early-Data</dd>
                            <dt>Applicable protocol:</dt>
                            <dd>http</dd>
                            <dt>Status:</dt>
                            <dd>standard</dd>
                            <dt>Author/Change controller:</dt>
                            <dd>IETF</dd>
                            <dt>Specification document(s):</dt>
                            <dd>This document</dd>
                            <dt>Related information:</dt>
                            <dd>(empty)</dd>
                        </dl>
                    </div>
                    <div id="rfc.section.7.p.3">
                        <p>This document registers the 425 (Too Early) status code in the “HTTP Status Codes” registry
                            located at &lt;<a
                                href="https://www.iana.org/assignments/http-status-codes">https://www.iana.org/assignments/http-status-codes</a>&gt;.
                        </p>
                    </div>
                    <div id="rfc.section.7.p.4">
                        <dl class="compact">
                            <dt>Value:</dt>
                            <dd>425</dd>
                            <dt>Description:</dt>
                            <dd>Too Early</dd>
                            <dt>Reference:</dt>
                            <dd>This document</dd>
                        </dl>
                    </div>
                </section>
                <section id="rfc.references">
                    <h2 id="rfc.section.8"><a href="#rfc.section.8">8.</a> References</h2>
                    <section>
                        <div id="rfc.references.1">
                            <h3 id="rfc.section.8.1"><a href="#rfc.section.8.1">8.1.</a> Normative References</h3>
                            <dl class="dl-horizontal">
                                <dt id="ABNF">[<a href="#ABNF" class="smpl">ABNF</a>]</dt>
                                <dd>Crocker, D., Ed. and P. Overell, “<a
                                        href="https://www.rfc-editor.org/rfc/rfc5234.html">Augmented BNF for Syntax
                                        Specifications: ABNF</a>”, <a href="https://www.rfc-editor.org/info/std68">STD
                                        68</a>, RFC 5234, <a href="https://dx.doi.org/10.17487/RFC5234">DOI
                                        10.17487/RFC5234</a>, January 2008, &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;.
                                </dd>
                                <dt id="HTTP">[<a href="#HTTP" class="smpl">HTTP</a>]</dt>
                                <dd>Fielding, R., Ed. and J. Reschke, Ed., “<a
                                        href="https://www.rfc-editor.org/rfc/rfc7230.html">Hypertext Transfer Protocol
                                        (HTTP/1.1): Message Syntax and Routing</a>”, RFC 7230, <a
                                        href="https://dx.doi.org/10.17487/RFC7230">DOI 10.17487/RFC7230</a>, June 2014,
                                    &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;.
                                </dd>
                                <dt id="RFC2119">[<a href="#RFC2119" class="smpl">RFC2119</a>]</dt>
                                <dd>Bradner, S., “<a href="https://www.rfc-editor.org/rfc/rfc2119.html">Key words for
                                        use in RFCs to Indicate Requirement Levels</a>”, <a
                                        href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 2119, <a
                                        href="https://dx.doi.org/10.17487/RFC2119">DOI 10.17487/RFC2119</a>, March 1997,
                                    &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.
                                </dd>
                                <dt id="RFC7231">[<a href="#RFC7231" class="smpl">RFC7231</a>]</dt>
                                <dd>Fielding, R., Ed. and J. Reschke, Ed., “<a
                                        href="https://www.rfc-editor.org/rfc/rfc7231.html">Hypertext Transfer Protocol
                                        (HTTP/1.1): Semantics and Content</a>”, RFC 7231, <a
                                        href="https://dx.doi.org/10.17487/RFC7231">DOI 10.17487/RFC7231</a>, June 2014,
                                    &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc7231">https://www.rfc-editor.org/info/rfc7231</a>&gt;.
                                </dd>
                                <dt id="RFC8174">[<a href="#RFC8174" class="smpl">RFC8174</a>]</dt>
                                <dd>Leiba, B., “<a href="https://www.rfc-editor.org/rfc/rfc8174.html">Ambiguity of
                                        Uppercase vs Lowercase in RFC 2119 Key Words</a>”, <a
                                        href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 8174, <a
                                        href="https://dx.doi.org/10.17487/RFC8174">DOI 10.17487/RFC8174</a>, May 2017,
                                    &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.
                                </dd>
                                <dt id="TLS13">[<a href="#TLS13" class="smpl">TLS13</a>]</dt>
                                <dd>Rescorla, E., “<a href="https://www.rfc-editor.org/rfc/rfc8446.html">The Transport
                                        Layer Security (TLS) Protocol Version 1.3</a>”, RFC 8446, <a
                                        href="https://dx.doi.org/10.17487/RFC8446">DOI 10.17487/RFC8446</a>, August
                                    2018, &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;.
                                </dd>
                            </dl>
                        </div>
                    </section>
                    <section>
                        <div id="rfc.references.2">
                            <h3 id="rfc.section.8.2"><a href="#rfc.section.8.2">8.2.</a> Informative References</h3>
                            <dl class="dl-horizontal">
                                <dt id="ALPN">[<a href="#ALPN" class="smpl">ALPN</a>]</dt>
                                <dd>Friedl, S., Popov, A., Langley, A., and E. Stephan, “<a
                                        href="https://www.rfc-editor.org/rfc/rfc7301.html">Transport Layer Security
                                        (TLS) Application-Layer Protocol Negotiation Extension</a>”, RFC 7301, <a
                                        href="https://dx.doi.org/10.17487/RFC7301">DOI 10.17487/RFC7301</a>, July 2014,
                                    &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc7301">https://www.rfc-editor.org/info/rfc7301</a>&gt;.
                                </dd>
                                <dt id="HQ">[<a href="#HQ" class="smpl">HQ</a>]</dt>
                                <dd>Bishop, M., “<a
                                        href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-http-14">Hypertext
                                        Transfer Protocol (HTTP) over QUIC</a>”, <a
                                        href="https://datatracker.ietf.org/doc/draft-ietf-quic-http">Work in
                                        Progress</a>, draft-ietf-quic-http-14, August 2018.</dd>
                                <dt id="RFC7540">[<a href="#RFC7540" class="smpl">RFC7540</a>]</dt>
                                <dd>Belshe, M., Peon, R., and M. Thomson, Ed., “<a
                                        href="https://www.rfc-editor.org/rfc/rfc7540.html">Hypertext Transfer Protocol
                                        Version 2 (HTTP/2)</a>”, RFC 7540, <a
                                        href="https://dx.doi.org/10.17487/RFC7540">DOI 10.17487/RFC7540</a>, May 2015,
                                    &lt;<a
                                        href="https://www.rfc-editor.org/info/rfc7540">https://www.rfc-editor.org/info/rfc7540</a>&gt;.
                                </dd>
                            </dl>
                        </div>
                    </section>
                </section>
                <section id="acknowledgments">
                    <h2 id="rfc.section.unnumbered-1"><a href="#acknowledgments">Acknowledgments</a></h2>
                    <div id="rfc.section.unnumbered-1.p.1">
                        <p>This document was not easy to produce. The following people made substantial contributions to
                            the quality and completeness of the document: David Benjamin, Subodh Iyengar, Benjamin
                            Kaduk, Ilari Liusavaara, Kazuho Oku, Eric Rescorla, Kyle Rose, and Victor Vasiliev.</p>
                    </div>
                </section>
                <section id="rfc.authors" class="avoidbreakinside">
                    <h2><a href="#rfc.authors">Authors' Addresses</a></h2>
                    <address><b>Martin Thomson</b><br>Mozilla<br>EMail: <a
                            href="mailto:martin.thomson@gmail.com">martin.thomson@gmail.com</a></address>
                    <address><b>Mark Nottingham</b><br>Fastly<br>EMail: <a href="mailto:mnot@mnot.net">mnot@mnot.net</a>
                    </address>
                    <address><b>Willy Tarreau</b><br>HAProxy Technologies<br>EMail: <a
                            href="mailto:willy@haproxy.org">willy@haproxy.org</a></address>
                </section>
            </div>
        </div>
    </div>
    <script src="/assets/node_modules/jquery/dist/jquery.min.js"></script>
    <script src="/assets/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
</body>

</html>