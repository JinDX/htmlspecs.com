<!doctype html>
<html lang="zh-hans">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>混合内容</title>
    <meta content="CRD" name="w3c-status">
    <meta content="Bikeshed version f043d3484, updated Fri Feb 17 10:53:48 2023 -0800" name="generator">
    <link href="https://www.w3.org/TR/mixed-content/" rel="canonical">
    <meta content="ac66459e091d5eb76df05d26bee9e95af4275bb4" name="document-revision">
    <style>
        /* style-autolinks */
        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: var(--a-normal-text);
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }
    </style>
    <style>
        /* style-counters */
        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* style-dfn-panel */
        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            width: 20em;
            min-width: min-content;
            max-width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0;
        }

        .dfn-panel li {
            list-style: inside;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled {
            cursor: pointer;
        }
    </style>
    <style>
        /* style-issues */
        a[href].issue-return {
            float: right;
            float: inline-end;
            color: var(--issueheading-text);
            font-weight: bold;
            text-decoration: none;
        }
    </style>
    <style>
        /* style-md-lists */
        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* style-selflinks */

        :root {
            --selflink-text: white;
            --selflink-bg: gray;
            --selflink-hover-text: black;
        }

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        .example>a.self-link,
        .note>a.self-link,
        .issue>a.self-link {
            /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
            left: auto;
            right: 0;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: var(--selflink-bg);
            color: var(--selflink-text);
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: var(--selflink-hover-text);
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-CRD" rel="stylesheet">

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo">
            <a class="logo" href="https://www.w3.org/">
                <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
            </a>
        </p>
        <h1>混合内容</h1>
        <p id="w3c-state">
            <a href="https://www.w3.org/standards/types#CRD">W3C 候选推荐草案</a>，
            <time class="dt-updated" datetime="2023-02-23">2023年2月23日</time>
        </p>
        <details open>
            <summary>关于本文档的更多信息</summary>
            <div data-fill-with="spec-metadata">
                <dl>
                    <dt>此版本:
                    <dd>
                        <a class="u-url" href="https://www.w3.org/TR/2023/CRD-mixed-content-20230223/">
                            https://www.w3.org/TR/2023/CRD-mixed-content-20230223/
                        </a>
                    <dt>最新发布版本:
                    <dd>
                        <a href="https://www.w3.org/TR/mixed-content/">https://www.w3.org/TR/mixed-content/</a>
                    <dt>编辑草案:
                    <dd>
                        <a
                            href="https://w3c.github.io/webappsec-mixed-content/">https://w3c.github.io/webappsec-mixed-content/</a>
                    <dt>先前版本:
                    <dd>
                        <a href="https://www.w3.org/TR/2021/CRD-mixed-content-20211004/" rel="prev">
                            https://www.w3.org/TR/2021/CRD-mixed-content-20211004/
                        </a>
                    <dt>历史:
                    <dd>
                        <a class="u-url" href="https://www.w3.org/standards/history/mixed-content">
                            https://www.w3.org/standards/history/mixed-content
                        </a>
                    <dt>反馈:
                    <dd>
                        <span>
                            <a href="mailto:public-webappsec@w3.org?subject=%5Bmixed-content%5D%20YOUR%20TOPIC%20HERE">
                                public-webappsec@w3.org
                            </a>
                            邮件主题请写为
                            “<kbd>[mixed-content] <i data-lt>…消息主题…</i></kbd>”
                            (<a href="https://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">存档</a>)
                        </span>
                    <dd>
                        <a href="https://github.com/w3c/webappsec-mixed-content/issues">GitHub:</a>
                    <dd>
                        <a href="https://github.com/w3c/webappsec-mixed-content/issues/new">提交问题</a>
                        (<a href="https://github.com/w3c/webappsec-mixed-content/issues">开放问题</a>)
                    <dt>实现报告:
                    <dd>
                        <a href="https://wpt.fyi/results/mixed-content">https://wpt.fyi/results/mixed-content</a>
                    <dt class="editor">编辑者:
                    <dd class="editor p-author h-card vcard" data-editor-id="76989">
                        <a class="p-name fn u-email email" href="mailto:estark@google.com">Emily Stark</a>
                        (<span class="p-org org">Google Inc.</span>)
                    <dd class="editor p-author h-card vcard" data-editor-id="56384">
                        <a class="p-name fn u-email email" href="mailto:mkwst@google.com">Mike West</a>
                        (<span class="p-org org">Google Inc.</span>)
                    <dd class="editor p-author h-card vcard" data-editor-id="117196">
                        <a class="p-name fn u-email email" href="mailto:carlosil@google.com">Carlos Ibarra Lopez</a>
                        (<span class="p-org org">Google Inc.</span>)
                    <dt>参与:
                    <dd>
                        <a href="https://github.com/w3c/webappsec-mixed-content/issues/new">提交问题</a>
                        (<a href="https://github.com/w3c/webappsec-mixed-content/issues">开放问题</a>)
                </dl>
            </div>
        </details>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a
                href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2023 <a
                href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr
                title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a
                href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a
                href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a
                href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" rel="license">permissive
                document license</a> rules apply. </p>
        <hr title="Separator for header">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">摘要</span></h2>
        <p>
            本规范描述了用户代理在加密和经过认证的文档中，如何处理通过未加密或未经认证的连接获取的内容。
        </p>
    </div>
    <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">本文件状态</span></h2>
    <div data-fill-with="status">
        <p>
            <em>
                本节描述了本文档在发布时的状态。当前W3C出版物列表和本技术报告的最新修订版可在
                <a href="https://www.w3.org/TR/">W3C技术报告索引 https://www.w3.org/TR/</a> 查询。
            </em>
        </p>
        <p>
            本文档由
            <a href="https://www.w3.org/groups/wg/webappsec">Web应用安全工作组</a>
            按照
            <a href="https://www.w3.org/2021/Process-20211102/#recs-and-notes">推荐流程</a>
            作为候选推荐草案发布。本文档计划成为W3C推荐标准。
        </p>
        <p>
            (<a href="https://lists.w3.org/Archives/Public/public-webappsec/">存档</a>)
            公共邮件列表
            <a
                href="mailto:public-webappsec@w3.org?Subject=%5Bmixed-content%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a>
            （参见<a href="https://www.w3.org/Mail/Request">说明</a>）为本规范讨论的首选渠道。发送电子邮件时，
            主题请带上“mixed-content”，建议格式：“[mixed-content] <em>…评论摘要…</em>”
        </p>
        <p>
            作为候选推荐发布并不代表
            <abbr title="World Wide Web Consortium">W3C</abbr>
            及其成员的认可。候选推荐草案整合了工作组打算在后续快照中包含的前一候选推荐的修改。本文件为草稿，随时可能更新、替换或废弃。引用本文件仅应视为工作进展，不应作为正式依据。
        </p>
        <p>
            本文档进入拟推荐阶段的准入条件是至少有两个独立且互操作的用户代理实现了本规范的所有特性，并通过工作组制定的测试套件中的用户代理测试。工作组将准备实现报告以跟踪进展。
        </p>
        <p>
            本文档由遵循<a href="https://www.w3.org/Consortium/Patent-Policy/">W3C专利政策</a>
            的工作组编写。W3C维护了与本组交付物相关的
            <a href="https://www.w3.org/groups/wg/webappsec/ipr" rel="disclosure">公开专利披露列表</a>；
            该页面也包含披露专利的说明。个人如获知包含
            <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">必要权利要求</a>
            的专利，应依<a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">
                W3C专利政策第6节</a>披露相关信息。
        </p>
        <p>
            本文档受
            <a href="https://www.w3.org/2021/Process-20211102/" id="w3c_process_revision">2021年11月2日W3C流程文档</a>
            管辖。
        </p>
        <p></p>
    </div>
    <div data-fill-with="at-risk"></div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目录</h2>
        <ol class="toc" role="directory">
            <li><a href="#intro"><span class="secno">1</span> <span class="content">引言</span></a>
            <li><a href="#terms"><span class="secno">2</span> <span class="content">关键概念与术语</span></a>
            <li>
                <a href="#categories"><span class="secno">3</span> <span class="content">内容类别</span></a>
                <ol class="toc">
                    <li><a href="#category-upgradeable"><span class="secno">3.1</span> <span
                                class="content">可升级内容</span></a>
                    <li><a href="#category-blockable"><span class="secno">3.2</span> <span
                                class="content">可阻止内容</span></a>
                </ol>
            <li>
                <a href="#algorithms"><span class="secno">4</span> <span class="content">算法</span></a>
                <ol class="toc">
                    <li><a href="#upgrade-algorithm"><span class="secno">4.1</span> <span class="content">如有需要，将混合内容
                                <var>请求</var> 升级为 <span>潜在可信的URL</span></span></a>
                    <li><a href="#existing-mix-algorithms"><span class="secno">4.2</span> <span
                                class="content">对先前算法的修改</span></a>
                    <li><a href="#categorize-settings-object"><span class="secno">4.3</span> <span
                                class="content"><var>settings</var> 是否禁止混合安全上下文？</span></a>
                    <li><a href="#should-block-fetch"><span class="secno">4.4</span> <span class="content">是否应将
                                <var>请求</var> 拦截为混合内容？</span></a>
                    <li><a href="#should-block-response"><span class="secno">4.5</span> <span class="content"> 是否应将
                                <var>请求</var> 的 <var>响应</var> 拦截为混合内容？</span></a>
                </ol>
            <li>
                <a href="#integration"><span class="secno">5</span> <span class="content">集成</span></a>
                <ol class="toc">
                    <li><a href="#fetch"><span class="secno">5.1</span> <span class="content">对 Fetch 的修改</span></a>
                    <li><a href="#html"><span class="secno">5.2</span> <span class="content">对 HTML 的修改</span></a>
                </ol>
            <li>
                <a href="#obsolescences"><span class="secno">6</span> <span class="content">废弃内容</span></a>
                <ol class="toc">
                    <li><a href="#strict-checking"><span class="secno">6.1</span> <span
                                class="content"><code>严格混合内容检查</code></span></a>
                </ol>
            <li>
                <a href="#security-considerations"><span class="secno">7</span> <span class="content">安全与隐私考量</span></a>
                <ol class="toc">
                    <li><a href="#requirements-forms"><span class="secno">7.1</span> <span
                                class="content">表单提交</span></a>
                    <li><a href="#requirements-user-controls"><span class="secno">7.2</span> <span
                                class="content">用户控制</span></a>
                </ol>
            <li><a href="#acknowledgements"><span class="secno">8</span> <span class="content">致谢</span></a>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本规范定义的术语</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">引用定义的术语</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考文献</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">规范性引用</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">资料性引用</span></a>
                </ol>
        </ol>
    </nav>
    <main>
        <section>
            <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span
                    class="content">引言</span><a class="self-link" href="#intro"></a></h2>
            <p><em>本节为非规范性内容。</em></p>
            <p>当用户通过安全通道（例如 HTTPS）成功加载来自 <code>example.com</code> 的网页时，用户可以获得在用户代理与 <code>example.com</code>
                之间传输的数据未被中间实体窃听或篡改的保证。然而，如果网页通过不安全的连接加载了脚本或图片等子资源，这一保证就会被削弱。例如，不安全加载的脚本可能允许攻击者代表用户读取或修改数据。不安全加载的图片则可能允许攻击者向用户传递错误信息（如伪造的股票图表）、修改客户端状态（如设置
                cookie），或诱导用户采取非预期操作（如更改按钮标签）。这些请求被称为混合内容。</p>
            <p>本规范详细说明了用户代理如何通过阻止某些类型的混合内容，并在某些场景下采取更严格的行为，来降低这些风险。</p>
            <p>然而，本规范的早期版本并未完全保护用户数据的机密性和完整性。不安全的内容（如图片、音频和视频）目前仍可在安全环境中被默认加载。安全页面甚至可以发起逃离用户代理沙箱的不安全下载。</p>
            <p>此外，当加载混合内容时，用户并没有明确的安全指示。当网页加载混合内容时，浏览器仅显示“中间”安全指示（如移除锁形图标），无法让用户清楚地判断是否应该信任该页面。这种用户体验也未能充分激励开发者避免混合内容，因为网页加载混合内容的现象依然普遍。如果全部阻止混合内容，将为用户提供更简单的认知模型——网页要么是通过安全通道加载的，要么不是——并鼓励开发者以安全方式加载网页所需的混合内容。
            </p>
            <p>因此，本规范进行了更新，以在尽量减少兼容性问题的同时，为用户提供更好的安全与隐私保障以及更佳的安全体验。本规范不再建议浏览器简单地严格阻止所有混合内容，而是建议采用 <i>混合内容自动升级</i>：</p>
            <ul>
                <li data-md>
                    <p>用户代理当前尚未阻止的混合内容应自动升级为通过安全通道传输。</p>
                <li data-md>
                    <p>如果请求无法自动升级，则会被阻止。</p>
            </ul>
            <p>自动升级可避免在安全网页中加载不安全资源，同时最大限度减少开发者为避免出错所需的工作量。</p>
            <p>本规范仅建议对当前未被默认阻止的混合内容子资源类型进行自动升级，不建议对已被默认阻止的内容类型进行自动升级。这样做是为了尽量减少对网页可见性的影响；我们只希望在有助于实现默认阻止所有混合内容目标时才自动升级内容。
            </p>
            <p>本规范还明确引入了 <i>混合下载</i>
                的概念。混合下载指的是由安全环境发起、但通过不安全连接下载的资源，且用户代理将其作为下载处理。用户代理应阻止混合下载，因为它们可能会逃离用户代理的沙箱（如可执行文件），或包含敏感信息（如银行账单）。这尤其具有误导性，因为用户代理通常会在发起和完成混合下载时，向用户显示他们正处于安全页面。
            </p>
        </section>
        <section>
            <h2 class="heading settled" data-level="2" id="terms"><span class="secno">2. </span><span
                    class="content">关键概念与术语</span><a class="self-link" href="#terms"></a></h2>
            <dl>
                <dt> <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-local-lt="mixed"
                        id="mixed-content">混合内容</dfn>
                <dd>
                    当一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                        id="ref-for-concept-request">请求</a> 的 <a data-link-type="dfn"
                        href="https://fetch.spec.whatwg.org/#concept-request-url"
                        id="ref-for-concept-request-url">URL</a> 不是 <a data-link-type="dfn"
                        href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url"
                        id="ref-for-potentially-trustworthy-url">潜在可信的 URL</a> <a data-link-type="biblio"
                        href="#biblio-secure-contexts"
                        title="Secure Contexts">[SECURE-CONTEXTS]</a>，<strong>且</strong>负责加载它的上下文禁止混合安全上下文（有关后者的规范性定义详见
                    <a href="#categorize-settings-object">§ 4.3 设置是否禁止混合安全上下文？</a>），则该请求为<strong>混合内容</strong>。
                    <p>当一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response"
                            id="ref-for-concept-response">响应</a> 是 <a data-link-type="dfn"
                            href="#unauthenticated-response"
                            id="ref-for-unauthenticated-response">未经认证的响应</a>，<strong>且</strong>负责加载它的上下文要求禁止混合安全上下文时，该响应为<strong>混合内容</strong>。
                    </p>
                    <div class="example" id="example-664a3624">
                        <a class="self-link" href="#example-664a3624"></a> 在限制混合内容的上下文中（例如
                        <code>https://secure.example.com/</code>）：
                        <ol>
                            <li data-md>
                                <p>请求脚本 <code>http://example.com/script.js</code> 是<strong>混合内容</strong>。由于脚本 <a
                                        data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                                        id="ref-for-concept-request①">请求</a>属于<a data-link-type="dfn"
                                        href="#blockable-mixed-content"
                                        id="ref-for-blockable-mixed-content">可阻止</a>类型，用户代理将返回网络错误，而不会加载该资源。</p>
                            <li data-md>
                                <p>请求图片 <code>http://example.com/image.png</code> 是<strong>混合内容</strong>。由于图片 <a
                                        data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                                        id="ref-for-concept-request②">请求</a>属于<a data-link-type="dfn"
                                        href="#upgradeable-mixed-content"
                                        id="ref-for-upgradeable-mixed-content">可升级</a>类型，用户代理可能会将 URL 重写为
                                    <code>https://example.com/image.png</code>，否则将阻止加载。
                                </p>
                        </ol>
                    </div>
                    <p class="note" role="note"><span class="marker">注：</span>"混合内容"最初定义于 <a
                            href="https://www.w3.org/TR/wsc-ui/#securepage">第5.3节</a>，见 <a data-link-type="biblio"
                            href="#biblio-wsc-ui"
                            title="Web Security Context: User Interface Guidelines">[WSC-UI]</a>。本文档对最初定义进行了更新。</p>
                    <p class="note" role="note"><span class="marker">注：</span> <a data-link-type="biblio"
                            href="#biblio-xml" title="Extensible Markup Language (XML) 1.0 (Fifth Edition)">[XML]</a>
                        也定义了一个无关的<a
                            href="https://www.w3.org/TR/2008/REC-xml-20081126/#sec-mixed-content">“混合内容”</a>概念。虽然有潜在混淆，但考虑到该术语在安全领域被用户代理广泛采用超过十年，实际混淆风险较低。
                    </p>
                <dt> <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-local-lt="unauthenticated"
                        data-lt="unauthenticated response" id="unauthenticated-response">未经认证的响应<span
                            id="insecure-origin"></span><span id="insecure-url"></span></dfn>
                <dd> 我们可以 <i lang="la">事后</i> 知道一个 <a data-link-type="dfn"
                        href="https://fetch.spec.whatwg.org/#concept-response"
                        id="ref-for-concept-response①">响应</a>（<var>response</var>）是未经认证的，如果 <var>response</var>
                    的 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url"
                        id="ref-for-concept-response-url">URL</a> 不是 <a data-link-type="dfn"
                        href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url"
                        id="ref-for-potentially-trustworthy-url①">潜在可信的 URL</a>。
                <dt><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="embedding-document">嵌入文档</dfn>
                <dd> 给定一个 <code
                        class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code>
                    <var>A</var>，<var>A</var> 的<strong>嵌入文档</strong>是 <var>A</var> 的<a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/document-sequences.html#concept-document-bc"
                        id="ref-for-concept-document-bc">浏览上下文</a>的<a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/document-sequences.html#doc-container-document"
                        id="ref-for-doc-container-document">容器文档</a> <a data-link-type="biblio" href="#biblio-html"
                        title="HTML Standard">[HTML]</a>。
                <dt><dfn data-dfn-type="dfn" data-export id="mixed-download">混合下载<a class="self-link"
                            href="#mixed-download"></a></dfn>
                <dd> 混合下载指的是由安全环境发起、但通过不安全连接下载的资源，且用户代理将其作为下载处理。
            </dl>
            <p class="note" role="note"> <dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    data-local-lt="a priori authenticated" id="a-priori-authenticated-url"><i lang="la">先验</i>认证的URL<a
                        class="self-link" href="#a-priori-authenticated-url"></a></dfn> 等同于 <a data-link-type="dfn"
                    href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url"
                    id="ref-for-potentially-trustworthy-url②">潜在可信的 URL</a> <a data-link-type="biblio"
                    href="#biblio-secure-contexts" title="Secure Contexts">[SECURE-CONTEXTS]</a>。 </p>
        </section>
        <section>
            <h2 class="heading settled" data-level="3" id="categories"><span class="secno">3. </span><span
                    class="content">内容类别</span><a class="self-link" href="#categories"></a></h2>
            <p>在理想情况下，每个用户代理都应当无例外地阻止所有<a data-link-type="dfn" href="#mixed-content"
                    id="ref-for-mixed-content">混合内容</a>。然而，在当今的互联网环境下，这样做并不现实；用户代理需要采取更细致的限制措施，以避免大量网站的用户体验受损。</p>
            <p>基于这一考虑，我们将混合内容分为两类：<a href="#category-upgradeable">§ 3.1 可升级内容</a> 和 <a href="#category-blockable">§ 3.2
                    可阻止内容</a>。</p>
            <section>
                <h3 class="heading settled" data-level="3.1" id="category-upgradeable"><span class="secno">3.1.
                    </span><span class="content">可升级内容</span><a class="self-link" href="#category-upgradeable"></a></h3>
                <p class="note" role="note"> 可升级内容在本规范早期版本中曾被称为 <em>可选阻止</em> 内容。
                </p>
                <p>当作为<a data-link-type="dfn" href="#mixed-content"
                        id="ref-for-mixed-content①">混合内容</a>允许其使用的风险小于阻止其使用可能导致大范围网站功能故障的风险时，该混合内容被定义为<dfn
                        class="dfn-paneled" data-dfn-type="dfn" data-export data-local-lt="upgradeable"
                        data-lt="upgradeable mixed content"
                        id="upgradeable-mixed-content">可升级</dfn>。这通常是因为该类型资源的混合使用非常普遍，且资源本身风险较低。被划为可升级内容并不意味着它们是<em>安全的</em>，只是相较于其他类型的资源，它们的危害性没有那么巨大。例如，图像和图标常常是应用界面的核心元素。如果攻击者调换了“删除邮件”和“回复”图标，将对用户造成实际影响。
                </p>
                <p>此类别包括：</p>
                <ul>
                    <li data-md>
                        <p>发起者为空字符串且<a data-link-type="dfn"
                                href="https://fetch.spec.whatwg.org/#concept-request-destination"
                                id="ref-for-concept-request-destination">目标类型</a>为 "<code>image</code>" 的请求。</p>
                        <p class="note" role="note"><span class="marker">注：</span> 这对应于大多数通过
                            <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element" id="ref-for-the-img-element">img</a></code>
                            标签加载的图片（包括作为图片加载的 SVG 文档，因为这些文档被阻止执行脚本或加载子资源）以及 CSS
                            (<a class="property css" data-link-type="property"
                                href="https://www.w3.org/TR/css-backgrounds-3/#propdef-background-image"
                                id="ref-for-propdef-background-image">background-image</a>、<a class="property css"
                                data-link-type="property"
                                href="https://www.w3.org/TR/css-backgrounds-3/#propdef-border-image"
                                id="ref-for-propdef-border-image">border-image</a> 等)。不包括
                            <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element" id="ref-for-the-img-element①">img</a></code>
                            元素使用 <a data-link-type="dfn"
                                href="https://html.spec.whatwg.org/multipage/images.html#use-srcset-or-picture"
                                id="ref-for-use-srcset-or-picture">srcset 或 picture</a> 属性的情况。
                        </p>
                    <li data-md>
                        <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination"
                                id="ref-for-concept-request-destination①">目标类型</a>为 "<code>video</code>" 的请求。</p>
                        <p class="note" role="note"><span class="marker">注：</span> 这对应于使用
                            <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/media.html#video" id="ref-for-video">video</a></code>
                            和
                            <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-source-element" id="ref-for-the-source-element">source</a></code>
                            标签加载的视频。
                        </p>
                    <li data-md>
                        <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination"
                                id="ref-for-concept-request-destination②">目标类型</a>为 "<code>audio</code>" 的请求。</p>
                        <p class="note" role="note"><span class="marker">注：</span> 这对应于使用
                            <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/media.html#audio" id="ref-for-audio">audio</a></code>
                            和
                            <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-source-element" id="ref-for-the-source-element①">source</a></code>
                            标签加载的音频。
                        </p>
                </ul>
                <p>我们在<a href="#should-block-fetch" id="ref-for-should-block-fetch">§ 4.4
                        是否应将请求拦截为混合内容？</a>进一步限制了该类别，对所有启用 CORS 的请求强制失败。这意味着，例如，带有 <code>&lt;img crossorigin ...></code>
                    的混合内容图片将被阻止。这很好地体现了只有在内容无法被完全阻止时才归入该类别的一般原则。工作组计划随着时间推移将更多内容划分为可阻止子集。</p>
            </section>
            <section>
                <h3 class="heading settled" data-level="3.2" id="category-blockable"><span class="secno">3.2.
                    </span><span class="content">可阻止内容</span><a class="self-link" href="#category-blockable"></a></h3>
                <p>所有不属于上述<a data-link-type="dfn" href="#upgradeable-mixed-content"
                        id="ref-for-upgradeable-mixed-content①">可升级</a>类型的混合内容，都被归为<dfn class="dfn-paneled"
                        data-dfn-type="dfn" data-export data-local-lt="blockable" data-lt="blockable mixed content"
                        id="blockable-mixed-content">可阻止</dfn>类型。典型例子包括脚本、<a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/infrastructure.html#plugin"
                        id="ref-for-plugin">插件</a>数据、通过 <code
                        class="idl"><a data-link-type="idl" href="https://xhr.spec.whatwg.org/#xmlhttprequest" id="ref-for-xmlhttprequest">XMLHttpRequest</a></code>
                    发起的数据请求等。
                </p>
                <p class="note" role="note"><span class="marker">注：</span> <a data-link-type="dfn"
                        href="https://fetch.spec.whatwg.org/#navigation-request"
                        id="ref-for-navigation-request">导航请求</a> 可能指向<a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context"
                        id="ref-for-top-level-browsing-context">顶级浏览上下文</a>，这些不被认为是混合内容。详情请参见<a
                        href="#should-block-fetch" id="ref-for-should-block-fetch①">§ 4.4 是否应将请求拦截为混合内容？</a>。</p>
                <p class="note" role="note"><span class="marker">注：</span> 插件发起的请求也属于可阻止类型。但我们认识到，用户代理并不总能拦截这些请求。例如
                    NPAPI 插件通常拥有直接的网络访问权限，可以完全绕过用户代理。我们建议用户代理在可能时阻止这些请求，同时建议插件厂商自行实现混合内容检查，以降低本规范所述风险。</p>
            </section>
        </section>
        <section>
            <h2 class="heading settled" data-level="4" id="algorithms"><span class="secno">4. </span><span
                    class="content">算法</span><a class="self-link" href="#algorithms"></a></h2>
            <section>
                <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="4.1"
                    data-lt="Upgrade a mixed content request to a potentially trustworthy URL, if appropriate"
                    id="upgrade-algorithm"><span class="secno">4.1. </span><span class="content">如有需要，将混合内容
                        <var>请求</var> 升级为
                        <a data-link-type="dfn"
                            href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url"
                            id="ref-for-potentially-trustworthy-url③">潜在可信的URL</a>
                    </span><a class="self-link" href="#upgrade-algorithm" id="ref-for-upgrade-algorithm"></a></h3>
                <p class="note" role="note"><span class="marker">注：</span> Fetch 规范将挂钩此算法以将可升级的混合内容升级至 HTTPS。</p>
                <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                        id="ref-for-concept-request③">请求</a> <var>request</var>，此算法会在请求被认定为可升级混合内容时，按下述算法重写其
                    <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url"
                        id="ref-for-concept-request-url①">URL</a>：
                </p>
                <ol>
                    <li>
                        若满足以下任一条件，则直接返回，不修改 <var>request</var>：
                        <ol>
                            <li> <var>request</var> 的 <a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#concept-request-url"
                                    id="ref-for-concept-request-url②">URL</a> 是 <a data-link-type="dfn"
                                    href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url"
                                    id="ref-for-potentially-trustworthy-url④">潜在可信的URL</a>。
                            <li> <var>request</var> 的 <a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#concept-request-url"
                                    id="ref-for-concept-request-url③">URL</a> 的 <a data-link-type="dfn"
                                    href="https://url.spec.whatwg.org/#concept-url-host"
                                    id="ref-for-concept-url-host">主机</a>为 <a data-link-type="dfn"
                                    href="https://url.spec.whatwg.org/#ip-address" id="ref-for-ip-address">IP 地址</a>。
                            <li> <a href="#categorize-settings-object">§ 4.3 设置是否禁止混合安全上下文？</a> 应用于 <var>request</var> 的
                                <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client"
                                    id="ref-for-concept-request-client">client</a> 时返回“<code>不限制混合安全上下文</code>”。
                            <li> <var>request</var> 的 <a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#concept-request-destination"
                                    id="ref-for-concept-request-destination③">目标类型(destination)</a> 不是
                                "<code>image</code>"、"<code>audio</code>" 或 "<code>video</code>"。
                            <li>
                                <var>request</var> 的 <a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#concept-request-destination"
                                    id="ref-for-concept-request-destination④">目标类型</a> 为 "<code>image</code>"
                                且 <var>request</var> 的 <a data-link-type="dfn"
                                    href="https://fetch.spec.whatwg.org/#concept-request-initiator"
                                    id="ref-for-concept-request-initiator①">initiator</a> 为 "<code>imageset</code>"。
                                <p class="note" role="note"><span class="marker">注：</span>
                                    出于历史原因，"<code>imageset</code>"
                                    不会被升级。在某些类型的混合内容被升级前，规范将混合内容分为可阻止和可选阻止，后者只针对不常见的内容类型。"<code>imageset</code>"
                                    属于前者，因此升级功能并未覆盖此前定义为可阻止的内容。</p>
                        </ol>
                    <li>
                        如果 <var>request</var> 的 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request-url"
                            id="ref-for-concept-request-url④">URL</a> 的 <a data-link-type="dfn"
                            href="https://url.spec.whatwg.org/#concept-url-scheme"
                            id="ref-for-concept-url-scheme">协议(scheme)</a> 为 <code>http</code>，
                        则将其 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url"
                            id="ref-for-concept-request-url⑤">URL</a> 的 <a data-link-type="dfn"
                            href="https://url.spec.whatwg.org/#concept-url-scheme"
                            id="ref-for-concept-url-scheme①">协议</a> 设置为 <code>https</code>，然后返回。
                        <p class="note" role="note"><span class="marker">注：</span> 按 <a data-link-type="biblio"
                                href="#biblio-url" title="URL Standard">[url]</a> 规范，不修改端口号，因为当协议为 <code>http</code>
                            时端口会被设为 null，协议变为 <code>https</code> 后将默认解释为 443。</p>
                </ol>
            </section>
            <section>
                <h3 class="heading settled" data-level="4.2" id="existing-mix-algorithms"><span class="secno">4.2.
                    </span><span class="content">对先前算法的修改</span><a class="self-link"
                        href="#existing-mix-algorithms"></a></h3>
                <p class="note" role="note"><span class="marker">注：</span>
                    本节包括对规范早期版本算法的修改——忽略可选阻止与可阻止混合内容的区分，因为所有可选阻止混合内容现在都将被自动升级。</p>
                <section>
                    <h3 class="heading settled" data-level="4.3" id="categorize-settings-object"><span
                            class="secno">4.3. </span><span class="content"><var>settings</var> 是否禁止混合安全上下文？</span><a
                            class="self-link" href="#categorize-settings-object"></a></h3>
                    <p>文档和 worker 都有 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                            id="ref-for-environment-settings-object">环境设置对象</a>，可通过以下算法判断是否限制混合内容。该算法返回
                        “<code>禁止混合安全上下文</code>”或“<code>不禁止混合安全上下文</code>”：</p>
                    <p>给定一个 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                            id="ref-for-environment-settings-object①">环境设置对象</a>
                        (<var>settings</var>)：</p>
                    <ol>
                        <li data-md>
                            <p>如果 <var>settings</var> 的 <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                                    id="ref-for-concept-settings-object-origin">来源(origin)</a> 是 <a data-link-type="dfn"
                                    href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-origin"
                                    id="ref-for-potentially-trustworthy-origin">潜在可信来源</a>，则返回
                                “<code>禁止混合安全上下文</code>”。</p>
                        <li data-md>
                            <p>如果 <var>settings</var> 的 <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                                    id="ref-for-concept-settings-object-global">全局对象(global object)</a> 为 <code
                                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-window" id="ref-for-dom-window">window</a></code>，
                                则：</p>
                            <ol>
                                <li data-md>
                                    <p>将 <var>document</var> 设为 <var>settings</var> 的 <a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                                            id="ref-for-concept-settings-object-global①">全局对象</a>的 <a
                                            data-link-type="dfn">关联文档</a>。</p>
                                <li data-md>
                                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                            id="ref-for-list-iterate">对于每个</a> <a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/document-sequences.html#navigable"
                                            id="ref-for-navigable">可导航对象(navigable)</a> <var>navigable</var>，位于
                                        <var>document</var> 的 <a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/document-sequences.html#ancestor-navigables"
                                            id="ref-for-ancestor-navigables">祖先 navigables</a> 中：
                                    </p>
                                    <ol>
                                        <li data-md>
                                            <p>如果 <var>navigable</var> 的 <a data-link-type="dfn"
                                                    href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document"
                                                    id="ref-for-nav-document">活动文档</a>的 <a data-link-type="dfn"
                                                    href="https://dom.spec.whatwg.org/#concept-document-origin"
                                                    id="ref-for-concept-document-origin">来源(origin)</a> 是 <a
                                                    data-link-type="dfn"
                                                    href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-origin"
                                                    id="ref-for-potentially-trustworthy-origin①">潜在可信来源</a>，
                                                则返回 “<code>禁止混合安全上下文</code>”。</p>
                                    </ol>
                            </ol>
                        <li data-md>
                            <p>返回 “<code>不限制混合安全上下文</code>”。</p>
                    </ol>
                    <div class="note" role="note">
                        如果文档有 <a data-link-type="dfn" href="#embedding-document"
                            id="ref-for-embedding-document">嵌入文档</a>，用户代理需要检查的不仅是文档本身，还要检查其所在的
                        <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context"
                            id="ref-for-top-level-browsing-context①">顶级浏览上下文</a>，因为用户对所加载资源安全状态的预期由此上下文决定。例如：
                        <div class="example" id="example-4c853e3e"><a class="self-link" href="#example-4c853e3e"></a>
                            <code>http://a.com</code> 加载 <code>http://evil.com</code>。该不安全请求会被允许，因为 <code>a.com</code>
                            并未通过安全连接加载。
                        </div>
                        <div class="example" id="example-c38c3226"><a class="self-link" href="#example-c38c3226"></a>
                            <code>https://a.com</code> 加载 <code>http://evil.com</code>。该不安全请求将被阻止，因为 <code>a.com</code>
                            是通过安全连接加载的。
                        </div>
                        <div class="example" id="example-1ec6834e"><a class="self-link" href="#example-1ec6834e"></a>
                            <code>http://a.com</code> 框架 <code>https://b.com</code>，后者加载
                            <code>http://evil.com</code>。此时对 <code>evil.com</code> 的不安全请求会被阻止，因为 <code>b.com</code>
                            是通过安全连接加载的，即使 <code>a.com</code> 不是。
                        </div>
                        <div class="example" id="example-202f3835"><a class="self-link" href="#example-202f3835"></a>
                            <code>https://a.com</code> 框架一个 <code>data:</code> URL，后者加载
                            <code>http://evil.com</code>。这种情况下对 <code>evil.com</code> 的不安全请求也会被阻止，因为 <code>a.com</code>
                            是通过安全连接加载的，即使被框架的 <code>data:</code> URL 在顶级上下文中加载时不会阻止混合内容。
                        </div>
                    </div>
                </section>
                <section>
                    <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="4.4"
                        data-lt="Should fetching request be blocked as mixed content?" id="should-block-fetch"><span
                            class="secno">4.4. </span><span class="content">是否应将 <var>请求</var> 拦截为混合内容？</span><a
                            class="self-link" href="#should-block-fetch" id="ref-for-should-block-fetch②"></a></h3>
                    <p class="note" role="note"><span class="marker">注：</span> Fetch 规范挂钩此算法判断请求是否应被完全阻止（例如，请求为<a
                            data-link-type="dfn" href="#blockable-mixed-content"
                            id="ref-for-blockable-mixed-content①">可阻止</a>内容，并且可<em>假定</em>其不会通过安全连接加载）。</p>
                    <p>给定一个 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                            id="ref-for-concept-request④">请求</a> <var>request</var>，用户代理根据以下算法判断 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤">请求</a>
                        <var>request</var> 是否应继续：
                    </p>
                    <ol>
                        <li>
                            若满足以下任一条件，则返回 <strong>允许</strong>：
                            <ol>
                                <li> <a href="#categorize-settings-object">§ 4.3 设置是否禁止混合安全上下文？</a> 应用于
                                    <var>request</var> 的 <a data-link-type="dfn"
                                        href="https://fetch.spec.whatwg.org/#concept-request-client"
                                        id="ref-for-concept-request-client①">client</a> 时返回“<code>不限制混合安全上下文</code>”。
                                <li> <var>request</var> 的 <a data-link-type="dfn"
                                        href="https://fetch.spec.whatwg.org/#concept-request-url"
                                        id="ref-for-concept-request-url⑥">URL</a> 是 <a data-link-type="dfn"
                                        href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url"
                                        id="ref-for-potentially-trustworthy-url⑤">潜在可信的URL</a>。
                                <li> 用户代理被指示允许<a data-link-type="dfn" href="#mixed-content"
                                        id="ref-for-mixed-content②">混合内容</a>（见 <a
                                        href="#requirements-user-controls">§ 7.2 用户控制</a>）。
                                <li>
                                    <var>request</var> 的 <a data-link-type="dfn"
                                        href="https://fetch.spec.whatwg.org/#concept-request-destination"
                                        id="ref-for-concept-request-destination⑤">目标类型(destination)</a>为
                                    "<code>document</code>"，且 <var>request</var> 的 <a data-link-type="dfn"
                                        href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context"
                                        id="ref-for-concept-environment-target-browsing-context">目标浏览上下文</a>无
                                    <a data-link-type="dfn">父级浏览上下文</a>。
                                    <p class="note" role="note"><span class="marker">注：</span>
                                        我们将顶级导航排除在混合内容检查之外，但用户代理可以选择对不安全表单提交强制混合内容检查（见<a
                                            href="#requirements-forms">§ 7.1 表单提交</a>）。</p>
                            </ol>
                        <li> 返回 <strong>阻止</strong>。
                    </ol>
                </section>
                <section>
                    <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="4.5"
                        data-lt="Should response to request be blocked as mixed content?" id="should-block-response">
                        <span class="secno">4.5. </span><span class="content">是否应将 <var>请求</var> 的 <var>响应</var>
                            拦截为混合内容？</span><a class="self-link" href="#should-block-response"
                            id="ref-for-should-block-response"></a>
                    </h3>
                    <p class="note" role="note"><span class="marker">注：</span> <a href="#should-block-fetch"
                            id="ref-for-should-block-fetch③">即使请求通过</a>，我们仍可能基于响应连接状态（例如请求为<a data-link-type="dfn"
                            href="#blockable-mixed-content" id="ref-for-blockable-mixed-content②">可阻止</a>但连接为
                        <a data-link-type="dfn" href="#unauthenticated-response"
                            id="ref-for-unauthenticated-response①">未经认证</a>），决定是否阻止响应；同时需确保 Service Worker 不会为
                        <a data-link-type="dfn" href="#blockable-mixed-content"
                            id="ref-for-blockable-mixed-content③">可阻止</a>请求意外返回
                        <a data-link-type="dfn" href="#unauthenticated-response"
                            id="ref-for-unauthenticated-response②">未经认证响应</a>。本算法用于做出此判断。
                    </p>
                    <p>给定 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request"
                            id="ref-for-concept-request⑥">请求</a> <var>request</var> 和 <a data-link-type="dfn"
                            href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②">响应</a>
                        <var>response</var>，用户代理根据以下算法判断应返回哪种响应：
                    </p>
                    <ol>
                        <li>
                            若满足以下任一条件，则返回 <strong>允许</strong>：
                            <ol>
                                <li> <a href="#categorize-settings-object">§ 4.3 设置是否禁止混合安全上下文？</a> 应用于
                                    <var>request</var> 的 <a data-link-type="dfn"
                                        href="https://fetch.spec.whatwg.org/#concept-request-client"
                                        id="ref-for-concept-request-client②">client</a> 时返回“<code>不限制混合内容</code>”。
                                <li> <var>response</var> 的 <a data-link-type="dfn"
                                        href="https://fetch.spec.whatwg.org/#concept-response-url"
                                        id="ref-for-concept-response-url①">url</a> 是 <a data-link-type="dfn"
                                        href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url"
                                        id="ref-for-potentially-trustworthy-url⑥">潜在可信的URL</a>。
                                <li> 用户代理被指示允许<a data-link-type="dfn" href="#mixed-content"
                                        id="ref-for-mixed-content③">混合内容</a>（见 <a
                                        href="#requirements-user-controls">§ 7.2 用户控制</a>）。
                                <li>
                                    <var>request</var> 的 <a data-link-type="dfn"
                                        href="https://fetch.spec.whatwg.org/#concept-request-destination"
                                        id="ref-for-concept-request-destination⑥">目标类型(destination)</a>为
                                    "<code>document</code>"，且 <var>request</var> 的 <a data-link-type="dfn"
                                        href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context"
                                        id="ref-for-concept-environment-target-browsing-context①">目标浏览上下文</a>无
                                    <a data-link-type="dfn">父级浏览上下文</a>。
                                    <p class="note" role="note"><span class="marker">注：</span>
                                        我们将顶级导航排除在混合内容检查之外，但用户代理可以选择对不安全表单提交强制混合内容检查（见<a
                                            href="#requirements-forms">§ 7.1 表单提交</a>）。</p>
                            </ol>
                        <li>返回 <strong>阻止</strong>。
                    </ol>
                </section>
            </section>
        </section>
        <section>
            <h2 class="heading settled" data-level="5" id="integration"><span class="secno">5. </span><span
                    class="content">集成</span><a class="self-link" href="#integration"></a></h2>
            <h3 class="heading settled" data-level="5.1" id="fetch"><span class="secno">5.1. </span><span
                    class="content">对 Fetch 的修改</span><a class="self-link" href="#fetch"></a></h3>
            <p><a href="https://fetch.spec.whatwg.org/#main-fetch"><cite>Fetch</cite> § 4.1 Main fetch</a>
                应修改为在第3步和第4步之间调用
                <a href="#upgrade-algorithm" id="ref-for-upgrade-algorithm①">§ 4.1
                    如有需要，将混合内容请求升级为潜在可信的URL</a>，即，在应用混合内容阻止机制之前，将可升级的混合内容自动升级为 HTTPS。
            </p>
            <h3 class="heading settled" data-level="5.2" id="html"><span class="secno">5.2. </span><span
                    class="content">对 HTML 的修改</span><a class="self-link" href="#html"></a></h3>
            <p><a data-link-type="dfn">处理导航响应</a>应作如下修改：第3步在 <var>source</var> 的 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document"
                    id="ref-for-nav-document①">活动文档</a>的 <a data-link-type="dfn"
                    href="https://dom.spec.whatwg.org/#concept-document-url" id="ref-for-concept-document-url">URL</a> 是
                <a data-link-type="dfn" href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url"
                    id="ref-for-potentially-trustworthy-url⑦">潜在可信的URL</a>且 <var>response</var> 的 <a
                    data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url-list"
                    id="ref-for-concept-response-url-list">URL 列表</a>中存在任何不是
                <a data-link-type="dfn" href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url"
                    id="ref-for-potentially-trustworthy-url⑧">潜在可信的URL</a> 时，应中止下载并返回。
            </p>
            <p>类似地，<a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/links.html#downloading-hyperlinks"
                    id="ref-for-downloading-hyperlinks">下载超链接</a>的算法应做如下修改：第6.2步应改为：若 <var>subject</var> 的
                <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document"
                    id="ref-for-concept-node-document">节点文档</a>的 <a data-link-type="dfn"
                    href="https://dom.spec.whatwg.org/#concept-document-url" id="ref-for-concept-document-url①">URL</a>
                是 <a data-link-type="dfn" href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url"
                    id="ref-for-potentially-trustworthy-url⑨">潜在可信的URL</a>，且 <var>response</var> 的
                <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url-list"
                    id="ref-for-concept-response-url-list①">URL 列表</a>中存在任何不是
                <a data-link-type="dfn" href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url"
                    id="ref-for-potentially-trustworthy-url①⓪">潜在可信的URL</a>
                （其中 <var>response</var> 为获取 <var>request</var> 的结果），则应返回并中止下载。
            </p>
            <p class="note" role="note"><span class="marker">注：</span>
                下载类资源不会像其他类型混合内容一样被自动升级，因为用户代理在请求资源之前未必知道该资源将会被下载。</p>
            <p class="note" role="note"><span class="marker">注：</span>
                资源在用户代理决定是否因连接不安全而中止下载之前就已被下载。因此，即使最终用户代理阻止了下载，敏感信息也有可能被传输到网络。这通常无法避免，因为用户代理往往要等收到最终响应后才知道资源会被下载，但通过阻止资源，用户代理可以促进网站运营者通过安全连接分发下载资源。
            </p>
        </section>
        <section>
            <h2 class="heading settled" data-level="6" id="obsolescences"><span class="secno">6. </span><span
                    class="content">废弃内容</span><a class="self-link" href="#obsolescences"></a></h2>
            <h3 class="heading settled" data-level="6.1" id="strict-checking"><span class="secno">6.1. </span><span
                    class="content"><code>严格混合内容检查</code></span><a class="self-link" href="#strict-checking"></a></h3>
            <p>本规范的早期版本定义了 <code>block-all-mixed-content</code> CSP 指令。该指令现已废弃，因为所有混合内容在无法自动升级时都会被阻止。</p>
            <p class="note" role="note"><span class="marker">注：</span> <code>upgrade-insecure-requests</code> (<a
                    data-link-type="biblio" href="#biblio-upgrade-insecure-requests"
                    title="Upgrade Insecure Requests">[upgrade-insecure-requests]</a>)
                指令并未废弃，因为它允许开发者升级可阻止内容。本规范仅默认升级可升级内容。</p>
        </section>
        <section>
            <h2 class="heading settled" data-level="7" id="security-considerations"><span class="secno">7. </span><span
                    class="content">安全与隐私考量</span><a class="self-link" href="#security-considerations"></a></h2>
            <p>总体而言，自动升级可升级混合内容预期将带来正面的安全和隐私效益，能保护更多用户流量免遭网络窃听和篡改。</p>
            <p>通过加载开发者未预期的资源，可能会在网页中引入安全或隐私问题。例如，假设网站引用了 <code>http://www.example.com/image.jpg</code> 的一张无害图片，但
                <code>https://www.example.com/image.jpg</code>
                出于某种原因被重定向到了跟踪网站。此时浏览器就会在没有开发者和用户明确同意的情况下，引入隐私问题。不过，这种情况被认为极为罕见。通过仅自动升级可升级内容、不自动升级可阻止内容，可以降低风险。可阻止内容可能带来更大风险，比如加载过时且存在漏洞的
                JavaScript 库。
            </p>
            <section>
                <h3 class="heading settled" data-level="7.1" id="requirements-forms"><span class="secno">7.1.
                    </span><span class="content">表单提交</span><a class="self-link" href="#requirements-forms"></a></h3>
                <p>如果 <a href="#categorize-settings-object">§ 4.3 设置是否禁止混合安全上下文？</a> 应用于 <code
                        class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①">Document</a></code>
                    的
                    <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                        id="ref-for-relevant-settings-object">相关设置对象</a>时返回 <code>限制混合内容</code>，则用户代理可选择在页面存在一个或多个
                    <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/forms.html#the-form-element" id="ref-for-the-form-element">form</a></code>
                    元素，且其 <a data-link-type="element-attr"
                        href="https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#attr-fs-action"
                        id="ref-for-attr-fs-action">action</a> 属性值不是
                    <a data-link-type="dfn" href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url"
                        id="ref-for-potentially-trustworthy-url①①">潜在可信URL</a> 时，向用户发出警告。
                </p>
                <p>用户代理可选择在提交
                    <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/forms.html#the-form-element" id="ref-for-the-form-element①">form</a></code>
                    元素时，若其 <a data-link-type="element-attr"
                        href="https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#attr-fs-action"
                        id="ref-for-attr-fs-action①">action</a> 属性值不是
                    <a data-link-type="dfn" href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url"
                        id="ref-for-potentially-trustworthy-url①②">潜在可信URL</a> 时，向用户发出警告并允许用户中止提交。如果用户代理在提交到非
                    <a data-link-type="dfn" href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url"
                        id="ref-for-potentially-trustworthy-url①③">潜在可信URL</a> 时发出警告，则也应在表单 action 重定向到非潜在可信 URL
                    时发出警告并允许用户中止提交，以防表单信息泄露。
                </p>
                <p>此外，用户代理可将来自此类 <code
                        class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②">Document</a></code>
                    的表单提交视为<a data-link-type="dfn" href="#blockable-mixed-content"
                        id="ref-for-blockable-mixed-content④">可阻止</a>请求，即使提交发生在<a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context"
                        id="ref-for-top-level-browsing-context②">顶级浏览上下文</a>中。</p>
            </section>
        </section>
        <section>
            <h3 class="heading settled" data-level="7.2" id="requirements-user-controls"><span class="secno">7.2.
                </span><span class="content">用户控制</span><a class="self-link" href="#requirements-user-controls"></a>
            </h3>
            用户代理可为用户提供能力，允许其在特定页面上覆盖阻止<a data-link-type="dfn" href="#blockable-mixed-content"
                id="ref-for-blockable-mixed-content⑤">可阻止</a>混合内容的决定。
            <p class="note" role="note"><span class="marker">注：</span> 实际上，用户代理可能无法完全不提供这样的后门。不过，允许混合脚本尤其危险，任何用户代理 <a
                    href="http://tools.ietf.org/html/rfc6919#section-3">确实不应</a>
                <a data-link-type="biblio" href="#biblio-rfc6919"
                    title="Further Key Words for Use in RFCs to Indicate Requirement Levels">[RFC6919]</a>
                在没有充分说明与风险沟通的情况下向用户呈现此类选项。
            </p>
            <p>用户代理可为用户提供能力，允许其在特定页面上覆盖自动升级<a data-link-type="dfn" href="#upgradeable-mixed-content"
                    id="ref-for-upgradeable-mixed-content②">可升级</a>混合内容的决定。</p>
            <p>用户代理提供的任何此类控制也必须通过辅助技术的可访问性 API 向辅助技术用户开放。</p>
        </section>
        <section>
            <h2 class="heading settled" data-level="8" id="acknowledgements"><span class="secno">8. </span><span
                    class="content">致谢</span><a class="self-link" href="#acknowledgements"></a></h2>
            <p>除了来自 WebAppSec 工作组的宝贵反馈外，Chrome 安全团队在准备本规范过程中也做出了巨大贡献。特别感谢 Chris Palmer、Chris Evans、Ryan Sleevi、Michal
                Zalewski、Ken Buchanan 和 Tom Sepez 给予的早期反馈。Anne van Kesteren 解释了 Fetch，帮助定义了本规范的接口，并对第二版更新提出了宝贵建议。Brian
                Smith 帮助规范保持聚焦、简洁和合理。</p>
        </section>
    </main>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本规范定义的术语</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#a-priori-authenticated-url">先验认证</a><span>，见 § 2</span>
        <li><a href="#a-priori-authenticated-url">先验认证URL</a><span>，见 § 2</span>
        <li><a href="#blockable-mixed-content">可阻止</a><span>，见 § 3.2</span>
        <li><a href="#blockable-mixed-content">可阻止混合内容</a><span>，见 § 3.2</span>
        <li><a href="#embedding-document">嵌入文档</a><span>，见 § 2</span>
        <li><a href="#mixed-content">混合</a><span>，见 § 2</span>
        <li><a href="#mixed-content">混合内容</a><span>，见 § 2</span>
        <li><a href="#mixed-download">混合下载</a><span>，见 § 2</span>
        <li><a href="#should-block-fetch">是否应将请求拦截为混合内容？</a><span>，见 § 4.2</span>
        <li><a href="#should-block-response">是否应将请求的响应拦截为混合内容？</a><span>，见 § 4.2</span>
        <li><a href="#unauthenticated-response">未经认证</a><span>，见 § 2</span>
        <li><a href="#unauthenticated-response">未经认证响应</a><span>，见 § 2</span>
        <li><a href="#upgradeable-mixed-content">可升级</a><span>，见 § 3.1</span>
        <li><a href="#upgradeable-mixed-content">可升级混合内容</a><span>，见 § 3.1</span>
        <li><a href="#upgrade-algorithm">如有需要，将混合内容请求升级为潜在可信的URL</a><span>，见 § 4</span>
    </ul>
    <aside aria-labelledby="infopaneltitle-for-6f4bad3ae2bdf5420e49c663f6bbb320" class="dfn-panel"
        data-for="6f4bad3ae2bdf5420e49c663f6bbb320" id="infopanel-for-6f4bad3ae2bdf5420e49c663f6bbb320">
        <span id="infopaneltitle-for-6f4bad3ae2bdf5420e49c663f6bbb320" style="display:none">Info about the
            'background-image' external reference.</span><a
            href="https://www.w3.org/TR/css-backgrounds-3/#propdef-background-image">https://www.w3.org/TR/css-backgrounds-3/#propdef-background-image</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-propdef-background-image">3.1. Upgradeable Content</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-3c6357381e6fe657f2972a7848344f1b" class="dfn-panel"
        data-for="3c6357381e6fe657f2972a7848344f1b" id="infopanel-for-3c6357381e6fe657f2972a7848344f1b">
        <span id="infopaneltitle-for-3c6357381e6fe657f2972a7848344f1b" style="display:none">Info about the
            'border-image' external reference.</span><a
            href="https://www.w3.org/TR/css-backgrounds-3/#propdef-border-image">https://www.w3.org/TR/css-backgrounds-3/#propdef-border-image</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-propdef-border-image">3.1. Upgradeable Content</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-07886e33695d0e7b473ef18f656ad7ac" class="dfn-panel"
        data-for="07886e33695d0e7b473ef18f656ad7ac" id="infopanel-for-07886e33695d0e7b473ef18f656ad7ac">
        <span id="infopaneltitle-for-07886e33695d0e7b473ef18f656ad7ac" style="display:none">Info about the 'Document'
            external reference.</span><a
            href="https://dom.spec.whatwg.org/#document">https://dom.spec.whatwg.org/#document</a><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-document">2. Key Concepts and Terminology</a>
            <li><a href="#ref-for-document①">7.1. Form Submission</a> <a href="#ref-for-document②">(2)</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-e374c2a979dc7a73f7d03be0623d67e6" class="dfn-panel"
        data-for="e374c2a979dc7a73f7d03be0623d67e6" id="infopanel-for-e374c2a979dc7a73f7d03be0623d67e6">
        <span id="infopaneltitle-for-e374c2a979dc7a73f7d03be0623d67e6" style="display:none">Info about the 'node
            document' external reference.</span><a
            href="https://dom.spec.whatwg.org/#concept-node-document">https://dom.spec.whatwg.org/#concept-node-document</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-node-document">5.2. Modifications to HTML</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-9c5cdbb5c3dd225a70ea0af45a02c608" class="dfn-panel"
        data-for="9c5cdbb5c3dd225a70ea0af45a02c608" id="infopanel-for-9c5cdbb5c3dd225a70ea0af45a02c608">
        <span id="infopaneltitle-for-9c5cdbb5c3dd225a70ea0af45a02c608" style="display:none">Info about the 'origin'
            external reference.</span><a
            href="https://dom.spec.whatwg.org/#concept-document-origin">https://dom.spec.whatwg.org/#concept-document-origin</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-document-origin">4.3.
                    Does settings prohibit mixed security contexts? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-2fc74f43c6d7f15a4a2fbfbece346388" class="dfn-panel"
        data-for="2fc74f43c6d7f15a4a2fbfbece346388" id="infopanel-for-2fc74f43c6d7f15a4a2fbfbece346388">
        <span id="infopaneltitle-for-2fc74f43c6d7f15a4a2fbfbece346388" style="display:none">Info about the 'url'
            external reference.</span><a
            href="https://dom.spec.whatwg.org/#concept-document-url">https://dom.spec.whatwg.org/#concept-document-url</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-document-url">5.2. Modifications to HTML</a> <a
                    href="#ref-for-concept-document-url①">(2)</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-136f2700e84634abd2f3d42487ba7f41" class="dfn-panel"
        data-for="136f2700e84634abd2f3d42487ba7f41" id="infopanel-for-136f2700e84634abd2f3d42487ba7f41">
        <span id="infopaneltitle-for-136f2700e84634abd2f3d42487ba7f41" style="display:none">Info about the 'client'
            external reference.</span><a
            href="https://fetch.spec.whatwg.org/#concept-request-client">https://fetch.spec.whatwg.org/#concept-request-client</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-request-client">4.1. Upgrade a mixed content request to a potentially
                    trustworthy URL, if appropriate</a>
            <li><a href="#ref-for-concept-request-client①">4.4.
                    Should fetching request be blocked as mixed content? </a>
            <li><a href="#ref-for-concept-request-client②">4.5.
                    Should response to request be blocked as mixed
                    content? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-89ba93986b2df9b70ab56597f4c96beb" class="dfn-panel"
        data-for="89ba93986b2df9b70ab56597f4c96beb" id="infopanel-for-89ba93986b2df9b70ab56597f4c96beb">
        <span id="infopaneltitle-for-89ba93986b2df9b70ab56597f4c96beb" style="display:none">Info about the 'destination'
            external reference.</span><a
            href="https://fetch.spec.whatwg.org/#concept-request-destination">https://fetch.spec.whatwg.org/#concept-request-destination</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-request-destination">3.1. Upgradeable Content</a> <a
                    href="#ref-for-concept-request-destination①">(2)</a> <a
                    href="#ref-for-concept-request-destination②">(3)</a>
            <li><a href="#ref-for-concept-request-destination③">4.1. Upgrade a mixed content request to a potentially
                    trustworthy URL, if appropriate</a> <a href="#ref-for-concept-request-destination④">(2)</a>
            <li><a href="#ref-for-concept-request-destination⑤">4.4.
                    Should fetching request be blocked as mixed content? </a>
            <li><a href="#ref-for-concept-request-destination⑥">4.5.
                    Should response to request be blocked as mixed
                    content? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-fbcfa904ec1519986ad26d2b61d17047" class="dfn-panel"
        data-for="fbcfa904ec1519986ad26d2b61d17047" id="infopanel-for-fbcfa904ec1519986ad26d2b61d17047">
        <span id="infopaneltitle-for-fbcfa904ec1519986ad26d2b61d17047" style="display:none">Info about the 'initiator'
            external reference.</span><a
            href="https://fetch.spec.whatwg.org/#concept-request-initiator">https://fetch.spec.whatwg.org/#concept-request-initiator</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-request-initiator">3.1. Upgradeable Content</a>
            <li><a href="#ref-for-concept-request-initiator①">4.1. Upgrade a mixed content request to a potentially
                    trustworthy URL, if appropriate</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-e9338f70c9fffeed408c8d866e03c566" class="dfn-panel"
        data-for="e9338f70c9fffeed408c8d866e03c566" id="infopanel-for-e9338f70c9fffeed408c8d866e03c566">
        <span id="infopaneltitle-for-e9338f70c9fffeed408c8d866e03c566" style="display:none">Info about the 'navigation
            request' external reference.</span><a
            href="https://fetch.spec.whatwg.org/#navigation-request">https://fetch.spec.whatwg.org/#navigation-request</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-navigation-request">3.2. Blockable Content</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-491791562dd138987138e7051a96c07c" class="dfn-panel"
        data-for="491791562dd138987138e7051a96c07c" id="infopanel-for-491791562dd138987138e7051a96c07c">
        <span id="infopaneltitle-for-491791562dd138987138e7051a96c07c" style="display:none">Info about the 'request'
            external reference.</span><a
            href="https://fetch.spec.whatwg.org/#concept-request">https://fetch.spec.whatwg.org/#concept-request</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-request">2. Key Concepts and Terminology</a> <a
                    href="#ref-for-concept-request①">(2)</a> <a href="#ref-for-concept-request②">(3)</a>
            <li><a href="#ref-for-concept-request③">4.1. Upgrade a mixed content request to a potentially trustworthy
                    URL, if appropriate</a>
            <li><a href="#ref-for-concept-request④">4.4.
                    Should fetching request be blocked as mixed content? </a> <a
                    href="#ref-for-concept-request⑤">(2)</a>
            <li><a href="#ref-for-concept-request⑥">4.5.
                    Should response to request be blocked as mixed
                    content? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-d203414c2b48c23fddab90ef753bb7cf" class="dfn-panel"
        data-for="d203414c2b48c23fddab90ef753bb7cf" id="infopanel-for-d203414c2b48c23fddab90ef753bb7cf">
        <span id="infopaneltitle-for-d203414c2b48c23fddab90ef753bb7cf" style="display:none">Info about the 'response'
            external reference.</span><a
            href="https://fetch.spec.whatwg.org/#concept-response">https://fetch.spec.whatwg.org/#concept-response</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-response">2. Key Concepts and Terminology</a> <a
                    href="#ref-for-concept-response①">(2)</a>
            <li><a href="#ref-for-concept-response②">4.5.
                    Should response to request be blocked as mixed
                    content? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-6f4775873c70787775f9c70f0f110709" class="dfn-panel"
        data-for="6f4775873c70787775f9c70f0f110709" id="infopanel-for-6f4775873c70787775f9c70f0f110709">
        <span id="infopaneltitle-for-6f4775873c70787775f9c70f0f110709" style="display:none">Info about the 'url (for
            request)' external reference.</span><a
            href="https://fetch.spec.whatwg.org/#concept-request-url">https://fetch.spec.whatwg.org/#concept-request-url</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-request-url">2. Key Concepts and Terminology</a>
            <li><a href="#ref-for-concept-request-url①">4.1. Upgrade a mixed content request to a potentially
                    trustworthy URL, if appropriate</a> <a href="#ref-for-concept-request-url②">(2)</a> <a
                    href="#ref-for-concept-request-url③">(3)</a> <a href="#ref-for-concept-request-url④">(4)</a> <a
                    href="#ref-for-concept-request-url⑤">(5)</a>
            <li><a href="#ref-for-concept-request-url⑥">4.4.
                    Should fetching request be blocked as mixed content? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-3e7b167935ca300cf96cb89f946d5476" class="dfn-panel"
        data-for="3e7b167935ca300cf96cb89f946d5476" id="infopanel-for-3e7b167935ca300cf96cb89f946d5476">
        <span id="infopaneltitle-for-3e7b167935ca300cf96cb89f946d5476" style="display:none">Info about the 'url (for
            response)' external reference.</span><a
            href="https://fetch.spec.whatwg.org/#concept-response-url">https://fetch.spec.whatwg.org/#concept-response-url</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-response-url">2. Key Concepts and Terminology</a>
            <li><a href="#ref-for-concept-response-url①">4.5.
                    Should response to request be blocked as mixed
                    content? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-3e104d6fbc4918ce1a80a293b8ad9d99" class="dfn-panel"
        data-for="3e104d6fbc4918ce1a80a293b8ad9d99" id="infopanel-for-3e104d6fbc4918ce1a80a293b8ad9d99">
        <span id="infopaneltitle-for-3e104d6fbc4918ce1a80a293b8ad9d99" style="display:none">Info about the 'url list'
            external reference.</span><a
            href="https://fetch.spec.whatwg.org/#concept-response-url-list">https://fetch.spec.whatwg.org/#concept-response-url-list</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-response-url-list">5.2. Modifications to HTML</a> <a
                    href="#ref-for-concept-response-url-list①">(2)</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-ab4bc3ee65d74e23763fccddf74bd772" class="dfn-panel"
        data-for="ab4bc3ee65d74e23763fccddf74bd772" id="infopanel-for-ab4bc3ee65d74e23763fccddf74bd772">
        <span id="infopaneltitle-for-ab4bc3ee65d74e23763fccddf74bd772" style="display:none">Info about the 'action'
            external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#attr-fs-action">https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#attr-fs-action</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-attr-fs-action">7.1. Form Submission</a> <a href="#ref-for-attr-fs-action①">(2)</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-de11cdc07a64c79878f1c3074e81554a" class="dfn-panel"
        data-for="de11cdc07a64c79878f1c3074e81554a" id="infopanel-for-de11cdc07a64c79878f1c3074e81554a">
        <span id="infopaneltitle-for-de11cdc07a64c79878f1c3074e81554a" style="display:none">Info about the 'active
            document' external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document">https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-nav-document">4.3.
                    Does settings prohibit mixed security contexts? </a>
            <li><a href="#ref-for-nav-document①">5.2. Modifications to HTML</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-576fb603e242351f14a2481ef4416814" class="dfn-panel"
        data-for="576fb603e242351f14a2481ef4416814" id="infopanel-for-576fb603e242351f14a2481ef4416814">
        <span id="infopaneltitle-for-576fb603e242351f14a2481ef4416814" style="display:none">Info about the 'ancestor
            navigables' external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/document-sequences.html#ancestor-navigables">https://html.spec.whatwg.org/multipage/document-sequences.html#ancestor-navigables</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-ancestor-navigables">4.3.
                    Does settings prohibit mixed security contexts? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-f8cb243adf07aaf1d10636b3de4677bc" class="dfn-panel"
        data-for="f8cb243adf07aaf1d10636b3de4677bc" id="infopanel-for-f8cb243adf07aaf1d10636b3de4677bc">
        <span id="infopaneltitle-for-f8cb243adf07aaf1d10636b3de4677bc" style="display:none">Info about the 'audio'
            external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/media.html#audio">https://html.spec.whatwg.org/multipage/media.html#audio</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-audio">3.1. Upgradeable Content</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-3eaa51ed66e1d8aa0c39a4f1fead29c0" class="dfn-panel"
        data-for="3eaa51ed66e1d8aa0c39a4f1fead29c0" id="infopanel-for-3eaa51ed66e1d8aa0c39a4f1fead29c0">
        <span id="infopaneltitle-for-3eaa51ed66e1d8aa0c39a4f1fead29c0" style="display:none">Info about the 'browsing
            context' external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/document-sequences.html#concept-document-bc">https://html.spec.whatwg.org/multipage/document-sequences.html#concept-document-bc</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-document-bc">2. Key Concepts and Terminology</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-ace20983857fa58836ad7b1826c67329" class="dfn-panel"
        data-for="ace20983857fa58836ad7b1826c67329" id="infopanel-for-ace20983857fa58836ad7b1826c67329">
        <span id="infopaneltitle-for-ace20983857fa58836ad7b1826c67329" style="display:none">Info about the 'container
            document' external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/document-sequences.html#doc-container-document">https://html.spec.whatwg.org/multipage/document-sequences.html#doc-container-document</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-doc-container-document">2. Key Concepts and Terminology</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-9f37605fd755103623b4a88c2da47a51" class="dfn-panel"
        data-for="9f37605fd755103623b4a88c2da47a51" id="infopanel-for-9f37605fd755103623b4a88c2da47a51">
        <span id="infopaneltitle-for-9f37605fd755103623b4a88c2da47a51" style="display:none">Info about the 'download the
            hyperlink' external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/links.html#downloading-hyperlinks">https://html.spec.whatwg.org/multipage/links.html#downloading-hyperlinks</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-downloading-hyperlinks">5.2. Modifications to HTML</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-d815dc723d8b4fe4b1166e2013ec62b7" class="dfn-panel"
        data-for="d815dc723d8b4fe4b1166e2013ec62b7" id="infopanel-for-d815dc723d8b4fe4b1166e2013ec62b7">
        <span id="infopaneltitle-for-d815dc723d8b4fe4b1166e2013ec62b7" style="display:none">Info about the 'environment
            settings object' external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-environment-settings-object">4.3.
                    Does settings prohibit mixed security contexts? </a> <a
                    href="#ref-for-environment-settings-object①">(2)</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-992c747fdc079c2fc405b782219bd226" class="dfn-panel"
        data-for="992c747fdc079c2fc405b782219bd226" id="infopanel-for-992c747fdc079c2fc405b782219bd226">
        <span id="infopaneltitle-for-992c747fdc079c2fc405b782219bd226" style="display:none">Info about the 'form'
            external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/forms.html#the-form-element">https://html.spec.whatwg.org/multipage/forms.html#the-form-element</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-the-form-element">7.1. Form Submission</a> <a
                    href="#ref-for-the-form-element①">(2)</a> <a href="#ref-for-the-form-element②">(3)</a> <a
                    href="#ref-for-the-form-element③">(4)</a> <a href="#ref-for-the-form-element④">(5)</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-53ea12fcca4eab4ccddd5da403fd6e4b" class="dfn-panel"
        data-for="53ea12fcca4eab4ccddd5da403fd6e4b" id="infopanel-for-53ea12fcca4eab4ccddd5da403fd6e4b">
        <span id="infopaneltitle-for-53ea12fcca4eab4ccddd5da403fd6e4b" style="display:none">Info about the 'global
            object' external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-settings-object-global">4.3.
                    Does settings prohibit mixed security contexts? </a> <a
                    href="#ref-for-concept-settings-object-global①">(2)</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-abfedd7f01779095e32057f505b061f5" class="dfn-panel"
        data-for="abfedd7f01779095e32057f505b061f5" id="infopanel-for-abfedd7f01779095e32057f505b061f5">
        <span id="infopaneltitle-for-abfedd7f01779095e32057f505b061f5" style="display:none">Info about the 'img'
            external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element">https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-the-img-element">3.1. Upgradeable Content</a> <a
                    href="#ref-for-the-img-element①">(2)</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-9b61a10aca6020532301db95d903ae46" class="dfn-panel"
        data-for="9b61a10aca6020532301db95d903ae46" id="infopanel-for-9b61a10aca6020532301db95d903ae46">
        <span id="infopaneltitle-for-9b61a10aca6020532301db95d903ae46" style="display:none">Info about the 'navigable'
            external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/document-sequences.html#navigable">https://html.spec.whatwg.org/multipage/document-sequences.html#navigable</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-navigable">4.3.
                    Does settings prohibit mixed security contexts? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-a95cc6f0be910557a60537e0256920b2" class="dfn-panel"
        data-for="a95cc6f0be910557a60537e0256920b2" id="infopanel-for-a95cc6f0be910557a60537e0256920b2">
        <span id="infopaneltitle-for-a95cc6f0be910557a60537e0256920b2" style="display:none">Info about the 'origin'
            external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-settings-object-origin">4.3.
                    Does settings prohibit mixed security contexts? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-033c64ff29717735074540e5f846d1f4" class="dfn-panel"
        data-for="033c64ff29717735074540e5f846d1f4" id="infopanel-for-033c64ff29717735074540e5f846d1f4">
        <span id="infopaneltitle-for-033c64ff29717735074540e5f846d1f4" style="display:none">Info about the 'plugin'
            external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/infrastructure.html#plugin">https://html.spec.whatwg.org/multipage/infrastructure.html#plugin</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-plugin">3.2. Blockable Content</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-bfb9cb6617f81a424ab20212af73bae3" class="dfn-panel"
        data-for="bfb9cb6617f81a424ab20212af73bae3" id="infopanel-for-bfb9cb6617f81a424ab20212af73bae3">
        <span id="infopaneltitle-for-bfb9cb6617f81a424ab20212af73bae3" style="display:none">Info about the 'relevant
            settings object' external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-relevant-settings-object">7.1. Form Submission</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-1b1c01b5236a0afa73e64d0b1639dc16" class="dfn-panel"
        data-for="1b1c01b5236a0afa73e64d0b1639dc16" id="infopanel-for-1b1c01b5236a0afa73e64d0b1639dc16">
        <span id="infopaneltitle-for-1b1c01b5236a0afa73e64d0b1639dc16" style="display:none">Info about the 'source'
            external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-source-element">https://html.spec.whatwg.org/multipage/embedded-content.html#the-source-element</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-the-source-element">3.1. Upgradeable Content</a> <a
                    href="#ref-for-the-source-element①">(2)</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-88acb424f236089050e7f4c429bc07ea" class="dfn-panel"
        data-for="88acb424f236089050e7f4c429bc07ea" id="infopanel-for-88acb424f236089050e7f4c429bc07ea">
        <span id="infopaneltitle-for-88acb424f236089050e7f4c429bc07ea" style="display:none">Info about the 'target
            browsing context' external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-environment-target-browsing-context">4.4.
                    Should fetching request be blocked as mixed content? </a>
            <li><a href="#ref-for-concept-environment-target-browsing-context①">4.5.
                    Should response to request be blocked as mixed
                    content? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-c104b697744f6f246969dcc26b898f11" class="dfn-panel"
        data-for="c104b697744f6f246969dcc26b898f11" id="infopanel-for-c104b697744f6f246969dcc26b898f11">
        <span id="infopaneltitle-for-c104b697744f6f246969dcc26b898f11" style="display:none">Info about the 'top-level
            browsing context' external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context">https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-top-level-browsing-context">3.2. Blockable Content</a>
            <li><a href="#ref-for-top-level-browsing-context①">4.3.
                    Does settings prohibit mixed security contexts? </a>
            <li><a href="#ref-for-top-level-browsing-context②">7.1. Form Submission</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-837717c5f9554fab61697eb8308dbb9c" class="dfn-panel"
        data-for="837717c5f9554fab61697eb8308dbb9c" id="infopanel-for-837717c5f9554fab61697eb8308dbb9c">
        <span id="infopaneltitle-for-837717c5f9554fab61697eb8308dbb9c" style="display:none">Info about the 'use srcset
            or picture' external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/images.html#use-srcset-or-picture">https://html.spec.whatwg.org/multipage/images.html#use-srcset-or-picture</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-use-srcset-or-picture">3.1. Upgradeable Content</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-fec6bca317a97af3ec1a865ccbce94de" class="dfn-panel"
        data-for="fec6bca317a97af3ec1a865ccbce94de" id="infopanel-for-fec6bca317a97af3ec1a865ccbce94de">
        <span id="infopaneltitle-for-fec6bca317a97af3ec1a865ccbce94de" style="display:none">Info about the 'video'
            external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/media.html#video">https://html.spec.whatwg.org/multipage/media.html#video</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-video">3.1. Upgradeable Content</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-70cc826a4635f67d3a89efe7d82b5c3d" class="dfn-panel"
        data-for="70cc826a4635f67d3a89efe7d82b5c3d" id="infopanel-for-70cc826a4635f67d3a89efe7d82b5c3d">
        <span id="infopaneltitle-for-70cc826a4635f67d3a89efe7d82b5c3d" style="display:none">Info about the 'window'
            external reference.</span><a
            href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-window">https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-window</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-window">4.3.
                    Does settings prohibit mixed security contexts? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-8b9e78ceedde26e69095bd6f6cce47bf" class="dfn-panel"
        data-for="8b9e78ceedde26e69095bd6f6cce47bf" id="infopanel-for-8b9e78ceedde26e69095bd6f6cce47bf">
        <span id="infopaneltitle-for-8b9e78ceedde26e69095bd6f6cce47bf" style="display:none">Info about the 'for each'
            external reference.</span><a
            href="https://infra.spec.whatwg.org/#list-iterate">https://infra.spec.whatwg.org/#list-iterate</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-list-iterate">4.3.
                    Does settings prohibit mixed security contexts? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-b12755d8fc4aa71b329893a894bb3bd9" class="dfn-panel"
        data-for="b12755d8fc4aa71b329893a894bb3bd9" id="infopanel-for-b12755d8fc4aa71b329893a894bb3bd9">
        <span id="infopaneltitle-for-b12755d8fc4aa71b329893a894bb3bd9" style="display:none">Info about the 'potentially
            trustworthy origin' external reference.</span><a
            href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-origin">https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-origin</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-potentially-trustworthy-origin">4.3.
                    Does settings prohibit mixed security contexts? </a> <a
                    href="#ref-for-potentially-trustworthy-origin①">(2)</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-14aaec4f01e0bc2562ddda413ba5b8ec" class="dfn-panel"
        data-for="14aaec4f01e0bc2562ddda413ba5b8ec" id="infopanel-for-14aaec4f01e0bc2562ddda413ba5b8ec">
        <span id="infopaneltitle-for-14aaec4f01e0bc2562ddda413ba5b8ec" style="display:none">Info about the 'potentially
            trustworthy url' external reference.</span><a
            href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url">https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-url</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-potentially-trustworthy-url">2. Key Concepts and Terminology</a> <a
                    href="#ref-for-potentially-trustworthy-url①">(2)</a> <a
                    href="#ref-for-potentially-trustworthy-url②">(3)</a>
            <li><a href="#ref-for-potentially-trustworthy-url③">4.1. Upgrade a mixed content request to a potentially
                    trustworthy URL, if appropriate</a> <a href="#ref-for-potentially-trustworthy-url④">(2)</a>
            <li><a href="#ref-for-potentially-trustworthy-url⑤">4.4.
                    Should fetching request be blocked as mixed content? </a>
            <li><a href="#ref-for-potentially-trustworthy-url⑥">4.5.
                    Should response to request be blocked as mixed
                    content? </a>
            <li><a href="#ref-for-potentially-trustworthy-url⑦">5.2. Modifications to HTML</a> <a
                    href="#ref-for-potentially-trustworthy-url⑧">(2)</a> <a
                    href="#ref-for-potentially-trustworthy-url⑨">(3)</a> <a
                    href="#ref-for-potentially-trustworthy-url①⓪">(4)</a>
            <li><a href="#ref-for-potentially-trustworthy-url①①">7.1. Form Submission</a> <a
                    href="#ref-for-potentially-trustworthy-url①②">(2)</a> <a
                    href="#ref-for-potentially-trustworthy-url①③">(3)</a> <a
                    href="#ref-for-potentially-trustworthy-url①④">(4)</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-8135e1bba65282312a7812610e7057a1" class="dfn-panel"
        data-for="8135e1bba65282312a7812610e7057a1" id="infopanel-for-8135e1bba65282312a7812610e7057a1">
        <span id="infopaneltitle-for-8135e1bba65282312a7812610e7057a1" style="display:none">Info about the 'host'
            external reference.</span><a
            href="https://url.spec.whatwg.org/#concept-url-host">https://url.spec.whatwg.org/#concept-url-host</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-url-host">4.1. Upgrade a mixed content request to a potentially trustworthy
                    URL, if appropriate</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-8ee6ec97a9613cdab6e4124425c1a8a0" class="dfn-panel"
        data-for="8ee6ec97a9613cdab6e4124425c1a8a0" id="infopanel-for-8ee6ec97a9613cdab6e4124425c1a8a0">
        <span id="infopaneltitle-for-8ee6ec97a9613cdab6e4124425c1a8a0" style="display:none">Info about the 'ip address'
            external reference.</span><a
            href="https://url.spec.whatwg.org/#ip-address">https://url.spec.whatwg.org/#ip-address</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-ip-address">4.1. Upgrade a mixed content request to a potentially trustworthy URL, if
                    appropriate</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-67f83ca6d3c695660bfc2f054f534ffb" class="dfn-panel"
        data-for="67f83ca6d3c695660bfc2f054f534ffb" id="infopanel-for-67f83ca6d3c695660bfc2f054f534ffb">
        <span id="infopaneltitle-for-67f83ca6d3c695660bfc2f054f534ffb" style="display:none">Info about the 'scheme'
            external reference.</span><a
            href="https://url.spec.whatwg.org/#concept-url-scheme">https://url.spec.whatwg.org/#concept-url-scheme</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-url-scheme">4.1. Upgrade a mixed content request to a potentially trustworthy
                    URL, if appropriate</a> <a href="#ref-for-concept-url-scheme①">(2)</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-8b5987171529763b1248361035725e68" class="dfn-panel"
        data-for="8b5987171529763b1248361035725e68" id="infopanel-for-8b5987171529763b1248361035725e68">
        <span id="infopaneltitle-for-8b5987171529763b1248361035725e68" style="display:none">Info about the
            'XMLHttpRequest' external reference.</span><a
            href="https://xhr.spec.whatwg.org/#xmlhttprequest">https://xhr.spec.whatwg.org/#xmlhttprequest</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-xmlhttprequest">3.2. Blockable Content</a>
        </ul>
    </aside>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">引用定义的术语</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[CSS-BACKGROUNDS-3]</a> 定义了下列术语：
            <ul>
                <li><span class="dfn-paneled" id="6f4bad3ae2bdf5420e49c663f6bbb320">background-image（背景图片）</span>
                <li><span class="dfn-paneled" id="3c6357381e6fe657f2972a7848344f1b">border-image（边框图片）</span>
            </ul>
        <li>
            <a data-link-type="biblio">[DOM]</a> 定义了下列术语：
            <ul>
                <li><span class="dfn-paneled" id="07886e33695d0e7b473ef18f656ad7ac">Document（文档）</span>
                <li><span class="dfn-paneled" id="e374c2a979dc7a73f7d03be0623d67e6">node document（节点文档）</span>
                <li><span class="dfn-paneled" id="9c5cdbb5c3dd225a70ea0af45a02c608">origin（源）</span>
                <li><span class="dfn-paneled" id="2fc74f43c6d7f15a4a2fbfbece346388">url（URL）</span>
            </ul>
        <li>
            <a data-link-type="biblio">[FETCH]</a> 定义了下列术语：
            <ul>
                <li><span class="dfn-paneled" id="136f2700e84634abd2f3d42487ba7f41">client（客户端）</span>
                <li><span class="dfn-paneled" id="89ba93986b2df9b70ab56597f4c96beb">destination（目标）</span>
                <li><span class="dfn-paneled" id="fbcfa904ec1519986ad26d2b61d17047">initiator（发起者）</span>
                <li><span class="dfn-paneled" id="e9338f70c9fffeed408c8d866e03c566">navigation request（导航请求）</span>
                <li><span class="dfn-paneled" id="491791562dd138987138e7051a96c07c">request（请求）</span>
                <li><span class="dfn-paneled" id="d203414c2b48c23fddab90ef753bb7cf">response（响应）</span>
                <li><span class="dfn-paneled" id="6f4775873c70787775f9c70f0f110709">url <small>（请求）</small></span>
                <li><span class="dfn-paneled" id="3e7b167935ca300cf96cb89f946d5476">url <small>（响应）</small></span>
                <li><span class="dfn-paneled" id="3e104d6fbc4918ce1a80a293b8ad9d99">url list（URL 列表）</span>
            </ul>
        <li>
            <a data-link-type="biblio">[HTML]</a> 定义了下列术语：
            <ul>
                <li><span class="dfn-paneled" id="ab4bc3ee65d74e23763fccddf74bd772">action（动作）</span>
                <li><span class="dfn-paneled" id="de11cdc07a64c79878f1c3074e81554a">active document（活动文档）</span>
                <li><span class="dfn-paneled" id="576fb603e242351f14a2481ef4416814">ancestor navigables（祖先可导航项）</span>
                <li><span class="dfn-paneled" id="f8cb243adf07aaf1d10636b3de4677bc">audio（音频）</span>
                <li><span class="dfn-paneled" id="3eaa51ed66e1d8aa0c39a4f1fead29c0">browsing context（浏览上下文）</span>
                <li><span class="dfn-paneled" id="ace20983857fa58836ad7b1826c67329">container document（容器文档）</span>
                <li><span class="dfn-paneled" id="9f37605fd755103623b4a88c2da47a51">download the hyperlink（下载超链接）</span>
                <li><span class="dfn-paneled" id="d815dc723d8b4fe4b1166e2013ec62b7">environment settings
                        object（环境设置对象）</span>
                <li><span class="dfn-paneled" id="992c747fdc079c2fc405b782219bd226">form（表单）</span>
                <li><span class="dfn-paneled" id="53ea12fcca4eab4ccddd5da403fd6e4b">global object（全局对象）</span>
                <li><span class="dfn-paneled" id="abfedd7f01779095e32057f505b061f5">img（图片）</span>
                <li><span class="dfn-paneled" id="9b61a10aca6020532301db95d903ae46">navigable（可导航对象）</span>
                <li><span class="dfn-paneled" id="a95cc6f0be910557a60537e0256920b2">origin（源）</span>
                <li><span class="dfn-paneled" id="033c64ff29717735074540e5f846d1f4">plugin（插件）</span>
                <li><span class="dfn-paneled" id="bfb9cb6617f81a424ab20212af73bae3">relevant settings
                        object（相关设置对象）</span>
                <li><span class="dfn-paneled" id="1b1c01b5236a0afa73e64d0b1639dc16">source（源）</span>
                <li><span class="dfn-paneled" id="88acb424f236089050e7f4c429bc07ea">target browsing
                        context（目标浏览上下文）</span>
                <li><span class="dfn-paneled" id="c104b697744f6f246969dcc26b898f11">top-level browsing
                        context（顶级浏览上下文）</span>
                <li><span class="dfn-paneled" id="837717c5f9554fab61697eb8308dbb9c">use srcset or picture（使用 srcset 或
                        picture）</span>
                <li><span class="dfn-paneled" id="fec6bca317a97af3ec1a865ccbce94de">video（视频）</span>
                <li><span class="dfn-paneled" id="70cc826a4635f67d3a89efe7d82b5c3d">window（窗口）</span>
            </ul>
        <li>
            <a data-link-type="biblio">[INFRA]</a> 定义了下列术语：
            <ul>
                <li><span class="dfn-paneled" id="8b9e78ceedde26e69095bd6f6cce47bf">for each（遍历）</span>
            </ul>
        <li>
            <a data-link-type="biblio">[SECURE-CONTEXTS]</a> 定义了下列术语：
            <ul>
                <li><span class="dfn-paneled" id="b12755d8fc4aa71b329893a894bb3bd9">potentially trustworthy
                        origin（潜在可信来源）</span>
                <li><span class="dfn-paneled" id="14aaec4f01e0bc2562ddda413ba5b8ec">potentially trustworthy url（潜在可信
                        URL）</span>
            </ul>
        <li>
            <a data-link-type="biblio">[URL]</a> 定义了下列术语：
            <ul>
                <li><span class="dfn-paneled" id="8135e1bba65282312a7812610e7057a1">host（主机）</span>
                <li><span class="dfn-paneled" id="8ee6ec97a9613cdab6e4124425c1a8a0">ip address（IP 地址）</span>
                <li><span class="dfn-paneled" id="67f83ca6d3c695660bfc2f054f534ffb">scheme（协议）</span>
            </ul>
        <li>
            <a data-link-type="biblio">[XHR]</a> 定义了下列术语：
            <ul>
                <li><span class="dfn-paneled" id="8b5987171529763b1248361035725e68">XMLHttpRequest</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">规范性引用</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-dom">[DOM]
        <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM 标准</cite></a>. Living Standard.
            URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
        <dt id="biblio-fetch">[FETCH]
        <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch 标准</cite></a>. Living
            Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
        <dt id="biblio-html">[HTML]
        <dd>Anne van Kesteren 等. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML 标准</cite></a>.
            Living Standard. URL: <a
                href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        <dt id="biblio-infra">[INFRA]
        <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra
                    标准</cite></a>. Living Standard. URL: <a
                href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
        <dt id="biblio-secure-contexts">[SECURE-CONTEXTS]
        <dd>Mike West. <a href="https://www.w3.org/TR/secure-contexts/"><cite>安全上下文（Secure Contexts）</cite></a>.
            2021年9月18日. CR. URL: <a
                href="https://www.w3.org/TR/secure-contexts/">https://www.w3.org/TR/secure-contexts/</a>
        <dt id="biblio-url">[URL]
        <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL 标准</cite></a>. Living Standard.
            URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
        <dt id="biblio-xhr">[XHR]
        <dd>Anne van Kesteren. <a href="https://xhr.spec.whatwg.org/"><cite>XMLHttpRequest 标准</cite></a>. Living
            Standard. URL: <a href="https://xhr.spec.whatwg.org/">https://xhr.spec.whatwg.org/</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">资料性引用</span><a class="self-link"
            href="#informative"></a></h3>
    <dl>
        <dt id="biblio-css-backgrounds-3">[CSS-BACKGROUNDS-3]
        <dd>Bert Bos; Elika Etemad; Brad Kemper. <a href="https://www.w3.org/TR/css-backgrounds-3/"><cite>CSS
                    背景与边框模块3</cite></a>. 2023年2月14日. CR. URL: <a
                href="https://www.w3.org/TR/css-backgrounds-3/">https://www.w3.org/TR/css-backgrounds-3/</a>
        <dt id="biblio-rfc6919">[RFC6919]
        <dd>R. Barnes; S. Kent; E. Rescorla. <a
                href="https://www.rfc-editor.org/rfc/rfc6919"><cite>在RFC中表示需求级别的更多关键词</cite></a>. 2013年4月1日. 实验性. URL:
            <a href="https://www.rfc-editor.org/rfc/rfc6919">https://www.rfc-editor.org/rfc/rfc6919</a>
        <dt id="biblio-upgrade-insecure-requests">[UPGRADE-INSECURE-REQUESTS]
        <dd>Mike West. <a href="https://www.w3.org/TR/upgrade-insecure-requests/"><cite>升级不安全请求</cite></a>. 2015年10月8日.
            CR. URL: <a
                href="https://www.w3.org/TR/upgrade-insecure-requests/">https://www.w3.org/TR/upgrade-insecure-requests/</a>
        <dt id="biblio-wsc-ui">[WSC-UI]
        <dd>Thomas Roessler; Anil Saldhana. <a href="https://www.w3.org/TR/wsc-ui/"><cite>Web 安全上下文：用户界面指南</cite></a>.
            2010年8月12日. REC. URL: <a href="https://www.w3.org/TR/wsc-ui/">https://www.w3.org/TR/wsc-ui/</a>
        <dt id="biblio-xml">[XML]
        <dd>Tim Bray 等. <a href="https://www.w3.org/TR/xml/"><cite>可扩展标记语言（XML）1.0（第五版）</cite></a>. 2008年11月26日. REC.
            URL: <a href="https://www.w3.org/TR/xml/">https://www.w3.org/TR/xml/</a>
    </dl>
    <aside aria-labelledby="infopaneltitle-for-mixed-content" class="dfn-panel" data-for="mixed-content"
        id="infopanel-for-mixed-content">
        <span id="infopaneltitle-for-mixed-content" style="display:none">Info about the 'mixed content'
            definition.</span><b><a href="#mixed-content">#mixed-content</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-mixed-content">3. Content Categories</a>
            <li><a href="#ref-for-mixed-content①">3.1. Upgradeable Content</a>
            <li><a href="#ref-for-mixed-content②">4.4.
                    Should fetching request be blocked as mixed content? </a>
            <li><a href="#ref-for-mixed-content③">4.5.
                    Should response to request be blocked as mixed
                    content? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-unauthenticated-response" class="dfn-panel"
        data-for="unauthenticated-response" id="infopanel-for-unauthenticated-response">
        <span id="infopaneltitle-for-unauthenticated-response" style="display:none">Info about the '
            unauthenticated response
            ' definition.</span><b><a href="#unauthenticated-response">#unauthenticated-response</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-unauthenticated-response">2. Key Concepts and Terminology</a>
            <li><a href="#ref-for-unauthenticated-response①">4.5.
                    Should response to request be blocked as mixed
                    content? </a> <a href="#ref-for-unauthenticated-response②">(2)</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-embedding-document" class="dfn-panel" data-for="embedding-document"
        id="infopanel-for-embedding-document">
        <span id="infopaneltitle-for-embedding-document" style="display:none">Info about the 'embedding document'
            definition.</span><b><a href="#embedding-document">#embedding-document</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-embedding-document">4.3.
                    Does settings prohibit mixed security contexts? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-upgradeable-mixed-content" class="dfn-panel"
        data-for="upgradeable-mixed-content" id="infopanel-for-upgradeable-mixed-content">
        <span id="infopaneltitle-for-upgradeable-mixed-content" style="display:none">Info about the 'upgradeable'
            definition.</span><b><a href="#upgradeable-mixed-content">#upgradeable-mixed-content</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-upgradeable-mixed-content">2. Key Concepts and Terminology</a>
            <li><a href="#ref-for-upgradeable-mixed-content①">3.2. Blockable Content</a>
            <li><a href="#ref-for-upgradeable-mixed-content②">7.2. User Controls</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-blockable-mixed-content" class="dfn-panel"
        data-for="blockable-mixed-content" id="infopanel-for-blockable-mixed-content">
        <span id="infopaneltitle-for-blockable-mixed-content" style="display:none">Info about the 'blockable'
            definition.</span><b><a href="#blockable-mixed-content">#blockable-mixed-content</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-blockable-mixed-content">2. Key Concepts and Terminology</a>
            <li><a href="#ref-for-blockable-mixed-content①">4.4.
                    Should fetching request be blocked as mixed content? </a>
            <li><a href="#ref-for-blockable-mixed-content②">4.5.
                    Should response to request be blocked as mixed
                    content? </a> <a href="#ref-for-blockable-mixed-content③">(2)</a>
            <li><a href="#ref-for-blockable-mixed-content④">7.1. Form Submission</a>
            <li><a href="#ref-for-blockable-mixed-content⑤">7.2. User Controls</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-upgrade-algorithm" class="dfn-panel" data-for="upgrade-algorithm"
        id="infopanel-for-upgrade-algorithm">
        <span id="infopaneltitle-for-upgrade-algorithm" style="display:none">Info about the '4.1. Upgrade a mixed
            content request to a potentially trustworthy URL, if appropriate' definition.</span><b><a
                href="#upgrade-algorithm">#upgrade-algorithm</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-upgrade-algorithm">4.1. Upgrade a mixed content request to a potentially trustworthy
                    URL, if appropriate</a>
            <li><a href="#ref-for-upgrade-algorithm">5.1. Modifications to Fetch</a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-should-block-fetch" class="dfn-panel" data-for="should-block-fetch"
        id="infopanel-for-should-block-fetch">
        <span id="infopaneltitle-for-should-block-fetch" style="display:none">Info about the '4.4.
            Should fetching request be blocked as mixed content?
            ' definition.</span><b><a href="#should-block-fetch">#should-block-fetch</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-should-block-fetch">3.1. Upgradeable Content</a>
            <li><a href="#ref-for-should-block-fetch">3.2. Blockable Content</a>
            <li><a href="#ref-for-should-block-fetch">4.4.
                    Should fetching request be blocked as mixed content? </a>
            <li><a href="#ref-for-should-block-fetch">4.5.
                    Should response to request be blocked as mixed
                    content? </a>
        </ul>
    </aside>
    <aside aria-labelledby="infopaneltitle-for-should-block-response" class="dfn-panel" data-for="should-block-response"
        id="infopanel-for-should-block-response">
        <span id="infopaneltitle-for-should-block-response" style="display:none">Info about the '4.5.
            Should response to request be blocked as mixed
            content?
            ' definition.</span><b><a href="#should-block-response">#should-block-response</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-should-block-response">4.5.
                    Should response to request be blocked as mixed
                    content? </a>
        </ul>
    </aside>
    <script>/* script-dfn-panel */
        "use strict";
        {
            function queryAll(sel) {
                return [].slice.call(document.querySelectorAll(sel));
            }

            // Add popup behavior to all dfns to show the corresponding dfn-panel.
            var dfns = document.querySelectorAll('.dfn-paneled');
            for (let dfn of dfns) { insertDfnPopupAction(dfn); }

            document.body.addEventListener("click", (e) => {
                // If not handled already, just hide all dfn panels.
                hideAllDfnPanels();
            });

            function hideAllDfnPanels() {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => hideDfnPanel(el));
            }

            function showDfnPanel(dfnPanel, dfn) {
                hideAllDfnPanels(); // Only display one at this time.
                dfn.setAttribute("aria-expanded", "true");
                dfnPanel.classList.add("on");
                dfnPanel.style.left = "5px";
                dfnPanel.style.top = "0px";
                const panelRect = dfnPanel.getBoundingClientRect();
                const panelWidth = panelRect.right - panelRect.left;
                if (panelRect.right > document.body.scrollWidth) {
                    // Panel's overflowing the screen.
                    // Just drop it below the dfn and flip it rightward instead.
                    // This still wont' fix things if the screen is *really* wide,
                    // but fixing that's a lot harder without 'anchor()'.
                    dfnPanel.style.top = "1.5em";
                    dfnPanel.style.left = "auto";
                    dfnPanel.style.right = "0px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel(dfnPanel, dfn) {
                if (!dfn) {
                    dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
                }
                dfn.setAttribute("aria-expanded", "false")
                dfnPanel.classList.remove("on");
                dfnPanel.classList.remove("activated");
            }

            function toggleDfnPanel(dfnPanel, dfn) {
                if (dfnPanel.classList.contains("on")) {
                    hideDfnPanel(dfnPanel, dfn);
                } else {
                    showDfnPanel(dfnPanel, dfn);
                }
            }

            function insertDfnPopupAction(dfn) {
                // Find dfn panel
                const dfnPanel = document.querySelector(`.dfn-panel[data-for='${dfn.id}']`);
                if (dfnPanel) {
                    const panelWrapper = document.createElement('span');
                    panelWrapper.appendChild(dfnPanel);
                    panelWrapper.style.position = "relative";
                    panelWrapper.style.height = "0px";
                    dfn.insertAdjacentElement("afterend", panelWrapper);
                    dfn.setAttribute('role', 'button');
                    dfn.setAttribute('aria-expanded', 'false')
                    dfn.tabIndex = 0;
                    dfn.classList.add('has-dfn-panel');
                    dfn.addEventListener('click', (event) => {
                        showDfnPanel(dfnPanel, dfn);
                        event.stopPropagation();
                    });
                    dfn.addEventListener('keypress', (event) => {
                        const kc = event.keyCode;
                        // 32->Space, 13->Enter
                        if (kc == 32 || kc == 13) {
                            toggleDfnPanel(dfnPanel, dfn);
                            event.stopPropagation();
                            event.preventDefault();
                        }
                    });

                    dfnPanel.addEventListener('click', (event) => {
                        pinDfnPanel(dfnPanel);
                        event.stopPropagation();
                    });

                    dfnPanel.addEventListener('keydown', (event) => {
                        if (event.keyCode == 27) { // Escape key
                            hideDfnPanel(dfnPanel, dfn);
                            event.stopPropagation();
                            event.preventDefault();
                        }
                    })

                } else {
                    console.log("Couldn't find .dfn-panel[data-for='" + dfn.id + "']");
                }
            }
        }
    </script>
    <script src="/dropdown.js"></script>