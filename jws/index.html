

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-hans" lang="zh-hans">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfchandler version 0.2" />
      <meta name="citation_author" content="M. Jones"/>
      <meta name="citation_author" content="J. Bradley"/>
      <meta name="citation_author" content="N. Sakimura"/>
      <meta name="citation_publication_date" content="May, 2015"/>
      <meta name="citation_title" content="JSON Web Signature (JWS)"/>
      <meta name="citation_doi" content="10.17487/RFC7515"/>
      <meta name="citation_issn" content="2070-1721"/>
      <meta name="citation_technical_report_number" content="rfc7515"/>
      <meta name="citation_pdf_url" content="https://www.rfc-editor.org/rfc/pdfrfc/rfc7515.txt.pdf"/>
<title>RFC 7515：JSON Web 签名（JWS）</title>    
        

        <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
           /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->    <script type="text/javascript"><!--
    function addHeaderTags() {
        var spans = document.getElementsByTagName("span");
        for (var i=0; i < spans.length; i++) {
            var elem = spans[i];
            if (elem) {
                var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";               
                }
            }
        }
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script></head>
<body>
<span class="pre noprint docinfo">[<a href="https://www.rfc-editor.org" title="RFC Editor">RFC Home</a>] [<a href="/rfc/rfc7515.txt">TEXT</a>|<a href="/rfc/pdfrfc/rfc7515.txt.pdf">PDF</a>|<a href="/rfc/rfc7515.html">HTML</a>] [<a href='https://datatracker.ietf.org/doc/rfc7515' title='IETF Datatracker information for this document'>Tracker</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=7515&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>] [<a class="boldtext" href="/errata/rfc7515" target="_blank">Errata</a>] [<a href='https://www.rfc-editor.org/info/rfc7515' title='Info page'>Info page</a>]         </span><br/><span class="pre noprint docinfo">                                                                        </span><br /><span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br /><span class="pre noprint docinfo">                                                            <span style='color: #C00;'>Errata Exist</span></span><pre>Internet Engineering Task Force (IETF)                          M. Jones
Request for Comments: 7515                                     Microsoft
Category: Standards Track                                     J. Bradley
ISSN: 2070-1721                                            Ping Identity
                                                             N. Sakimura
                                                                     NRI
                                                                May 2015


                        <span class="h1">JSON Web 签名（JWS）</span>

摘要

   JSON Web 签名（JWS）表示使用基于 JSON 的数据结构，通过数字签名或
   消息认证码（MAC）来保护的内容。用于本规范的密码算法和标识符在独立的
   JSON Web 算法（JWA）规范以及该规范定义的 IANA 注册表中进行了描述。
   相关的加密能力在独立的 JSON Web 加密（JWE）规范中进行了描述。

本备忘录的状态

   本文档是 Internet 标准轨道文档。

   本文档是 Internet 工程任务组（IETF）的成果，代表了 IETF 社区的共识。
   本文档已通过公开评审，并获得 Internet 工程指导组（IESG）的批准发布。
   有关 Internet 标准的更多信息，请参见
   <a href="./rfc5741#section-2">RFC 5741 的第&nbsp;2&nbsp;节</a>。

   有关本文档的当前状态、任何勘误信息以及如何提供反馈的信息，可通过
   <a href="https://www.rfc-editor.org/info/rfc7515">http://www.rfc-editor.org/info/rfc7515</a>
   获取。

















<span class="grey">Jones, et al.                Standards Track                    [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. 引言 ....................................................<a href="#page-4">4</a>
      <a href="#section-1.1">1.1</a>. 记法约定 .....................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. 术语 .....................................................<a href="#page-5">5</a>
   <a href="#section-3">3</a>. JSON Web 签名（JWS）概述 ...............................<a href="#page-7">7</a>
      <a href="#section-3.1">3.1</a>. JWS 紧凑序列化概述 .........................<a href="#page-7">7</a>
      <a href="#section-3.2">3.2</a>. JWS JSON 序列化概述 ............................<a href="#page-8">8</a>
      <a href="#section-3.3">3.3</a>. JWS 示例 ................................................<a href="#page-8">8</a>
   <a href="#section-4">4</a>. JOSE 标头 .....................................................<a href="#page-9">9</a>
      <a href="#section-4.1">4.1</a>. 已注册的标头参数名称 .........................<a href="#page-10">10</a>
           <a href="#section-4.1.1">4.1.1</a>. “alg”（算法）标头参数 .................<a href="#page-10">10</a>
           <a href="#section-4.1.2">4.1.2</a>. “jku”（JWK 集 URL）标头参数 ...............<a href="#page-10">10</a>
           <a href="#section-4.1.3">4.1.3</a>. “jwk”（JSON Web Key）标头参数 ..............<a href="#page-11">11</a>
           <a href="#section-4.1.4">4.1.4</a>. “kid”（密钥 ID）标头参数 ....................<a href="#page-11">11</a>
           <a href="#section-4.1.5">4.1.5</a>. “x5u”（X.509 URL）标头参数 .................<a href="#page-11">11</a>
           <a href="#section-4.1.6">4.1.6</a>. “x5c”（X.509 证书链）标头参数 ...<a href="#page-11">11</a>
           4.1.7. “x5t”（X.509 证书 SHA-1 指纹）
                  标头参数 ...................................<a href="#page-12">12</a>
           4.1.8. “x5t#S256”（X.509 证书 SHA-256
                  指纹）标头参数 .......................<a href="#page-12">12</a>
           <a href="#section-4.1.9">4.1.9</a>. “typ”（类型）标头参数 ......................<a href="#page-12">12</a>
           <a href="#section-4.1.10">4.1.10</a>. “cty”（内容类型）标头参数 .............<a href="#page-13">13</a>
           <a href="#section-4.1.11">4.1.11</a>. “crit”（关键）标头参数 ................<a href="#page-14">14</a>
      <a href="#section-4.2">4.2</a>. 公共标头参数名称 .............................<a href="#page-14">14</a>
      <a href="#section-4.3">4.3</a>. 私有标头参数名称 ............................<a href="#page-14">14</a>
   <a href="#section-5">5</a>. 生成和处理 JWS ...................................<a href="#page-15">15</a>
      <a href="#section-5.1">5.1</a>. 消息签名或 MAC 计算 ......................<a href="#page-15">15</a>
      <a href="#section-5.2">5.2</a>. 消息签名或 MAC 验证 .......................<a href="#page-16">16</a>
      <a href="#section-5.3">5.3</a>. 字符串比较规则 ...................................<a href="#page-17">17</a>
   <a href="#section-6">6</a>. 密钥标识 .............................................<a href="#page-18">18</a>





<span class="grey">Jones, et al.                Standards Track                    [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   <a href="#section-7">7</a>. 序列化 .................................................<a href="#page-19">19</a>
      <a href="#section-7.1">7.1</a>. JWS 紧凑序列化 .................................<a href="#page-19">19</a>
      <a href="#section-7.2">7.2</a>. JWS JSON 序列化 ....................................<a href="#page-19">19</a>
           <a href="#section-7.2.1">7.2.1</a>. 通用 JWS JSON 序列化语法 ..............<a href="#page-20">20</a>
           <a href="#section-7.2.2">7.2.2</a>. 扁平化 JWS JSON 序列化语法 ............<a href="#page-21">21</a>
   <a href="#section-8">8</a>. TLS 要求 ...............................................<a href="#page-22">22</a>
   <a href="#section-9">9</a>. IANA 注意事项 ............................................<a href="#page-22">22</a>
      9.1. JSON Web 签名与加密标头
           参数注册表 .......................................<a href="#page-23">23</a>
           <a href="#section-9.1.1">9.1.1</a>. 注册模板 ..............................<a href="#page-23">23</a>
           <a href="#section-9.1.2">9.1.2</a>. 初始注册表内容 ..........................<a href="#page-24">24</a>
      <a href="#section-9.2">9.2</a>. 媒体类型注册 ...................................<a href="#page-26">26</a>
           <a href="#section-9.2.1">9.2.1</a>. 注册表内容 ..................................<a href="#page-26">26</a>
   <a href="#section-10">10</a>. 安全注意事项 .......................................<a href="#page-27">27</a>
      <a href="#section-10.1">10.1</a>. 密钥熵与随机值 ............................<a href="#page-27">27</a>
      <a href="#section-10.2">10.2</a>. 密钥保护 ...........................................<a href="#page-28">28</a>
      <a href="#section-10.3">10.3</a>. 密钥来源认证 ................................<a href="#page-28">28</a>
      <a href="#section-10.4">10.4</a>. 密码算法灵活性 ....................................<a href="#page-28">28</a>
      <a href="#section-10.5">10.5</a>. 数字签名与 MAC 之间的差异 ..........<a href="#page-28">28</a>
      <a href="#section-10.6">10.6</a>. 算法验证 .....................................<a href="#page-29">29</a>
      <a href="#section-10.7">10.7</a>. 算法保护 .....................................<a href="#page-29">29</a>
      <a href="#section-10.8">10.8</a>. 选择明文攻击 .................................<a href="#page-30">30</a>
      <a href="#section-10.9">10.9</a>. 定时攻击 ...........................................<a href="#page-30">30</a>
      <a href="#section-10.10">10.10</a>. 重放保护 .......................................<a href="#page-30">30</a>
      <a href="#section-10.11">10.11</a>. SHA-1 证书指纹 ...........................<a href="#page-30">30</a>
      <a href="#section-10.12">10.12</a>. JSON 安全注意事项 ............................<a href="#page-31">31</a>
      <a href="#section-10.13">10.13</a>. Unicode 比较安全注意事项 ..............<a href="#page-31">31</a>
   <a href="#section-11">11</a>. 参考文献 ....................................................<a href="#page-32">32</a>
      <a href="#section-11.1">11.1</a>. 规范性引用 .....................................<a href="#page-32">32</a>
      <a href="#section-11.2">11.2</a>. 参考性引用 ...................................<a href="#page-34">34</a>
   <a href="#appendix-A">附录 A</a>.  JWS 示例 .........................................<a href="#page-36">36</a>
     <a href="#appendix-A.1">A.1</a>.  使用 HMAC SHA-256 的 JWS 示例 ............................<a href="#page-36">36</a>
       <a href="#appendix-A.1.1">A.1.1</a>.  编码 ..............................................<a href="#page-36">36</a>
       <a href="#appendix-A.1.2">A.1.2</a>.  验证 ............................................<a href="#page-38">38</a>
     <a href="#appendix-A.2">A.2</a>.  使用 RSASSA-PKCS1-v1_5 SHA-256 的 JWS 示例 ...............<a href="#page-38">38</a>
       <a href="#appendix-A.2.1">A.2.1</a>.  编码 ..............................................<a href="#page-38">38</a>
       <a href="#appendix-A.2.2">A.2.2</a>.  验证 ............................................<a href="#page-42">42</a>
     <a href="#appendix-A.3">A.3</a>.  使用 ECDSA P-256 SHA-256 的 JWS 示例 .....................<a href="#page-42">42</a>
       <a href="#appendix-A.3.1">A.3.1</a>.  编码 ..............................................<a href="#page-42">42</a>
       <a href="#appendix-A.3.2">A.3.2</a>.  验证 ............................................<a href="#page-44">44</a>
     <a href="#appendix-A.4">A.4</a>.  使用 ECDSA P-521 SHA-512 的 JWS 示例 .....................<a href="#page-45">45</a>
       <a href="#appendix-A.4.1">A.4.1</a>.  编码 ..............................................<a href="#page-45">45</a>
       <a href="#appendix-A.4.2">A.4.2</a>.  验证 ............................................<a href="#page-47">47</a>
     <a href="#appendix-A.5">A.5</a>.  未加保护的 JWS 示例 .....................................<a href="#page-47">47</a>
     <a href="#appendix-A.6">A.6</a>.  使用通用 JWS JSON 序列化的 JWS 示例 ..........<a href="#page-48">48</a>
       <a href="#appendix-A.6.1">A.6.1</a>.  每签名受保护的 JWS 标头 ...................<a href="#page-48">48</a>
       <a href="#appendix-A.6.2">A.6.2</a>.  每签名未受保护的 JWS 标头 .................<a href="#page-49">49</a>
       <a href="#appendix-A.6.3">A.6.3</a>.  完整的 JOSE 标头值 ...........................<a href="#page-49">49</a>



<span class="grey">Jones, et al.                Standards Track                    [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


       <a href="#appendix-A.6.4">A.6.4</a>.  完整的 JWS JSON 序列化表示 ........<a href="#page-50">50</a>
     <a href="#appendix-A.7">A.7</a>.  使用扁平化 JWS JSON 序列化的 JWS 示例 ........<a href="#page-51">51</a>
   <a href="#appendix-B">附录 B</a>.  “x5c”（X.509 证书链）示例 ..............<a href="#page-52">52</a>
   <a href="#appendix-C">附录 C</a>.  关于在不使用填充的情况下实现 base64url 编码的说明
                ..............................................<a href="#page-54">54</a>
   <a href="#appendix-D">附录 D</a>.  关于密钥选择的说明 ...............................<a href="#page-55">55</a>
   <a href="#appendix-E">附录 E</a>.  “crit” 标头参数的负面测试用例 .......<a href="#page-57">57</a>
   <a href="#appendix-F">附录 F</a>.  分离内容 .....................................<a href="#page-57">57</a>
   致谢 ..................................................<a href="#page-58">58</a>
   作者地址 ................................................<a href="#page-58">58</a>

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  引言</span>

   JSON Web 签名（JWS）表示使用基于 JSON 的
   [<a href="./rfc7159" title="&quot;The JavaScript Object Notation (JSON) Data Interchange Format&quot;">RFC7159</a>] 数据结构，通过数字签名或
   消息认证码（MAC）来保护的内容。JWS 的密码机制为任意
   八位字节序列提供完整性保护。有关数字签名与 MAC 之间差异的讨论，
   请参见 <a href="#section-10.5">第 10.5 节</a>。

   定义了两种紧密相关的 JWS 序列化方式。JWS 紧凑序列化是一种紧凑、
   URL 安全的表示形式，适用于诸如 HTTP Authorization 标头和
   URI 查询参数等空间受限的环境。JWS JSON 序列化将 JWS 表示为
   JSON 对象，并支持对同一内容应用多个签名和/或 MAC。
   二者共享相同的密码学基础。

   用于本规范的密码算法和标识符在独立的
   JSON Web 算法（JWA）
   [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>] 规范以及该规范定义的 IANA 注册表中进行了描述。
   相关的加密能力在独立的
   JSON Web 加密（JWE）
   [<a href="#ref-JWE" title="&quot;JSON Web Encryption (JWE)&quot;">JWE</a>] 规范中进行了描述。

   本规范所定义的名称较短，这是因为一个核心目标是使最终表示保持紧凑。

<span class="h3"><a class="selflink" id="section-1.1" href="#section-1.1">1.1</a>.  记法约定</span>

   本文档中的关键词 “MUST”、“MUST NOT”、“REQUIRED”、“SHALL”、“SHALL NOT”、
   “SHOULD”、“SHOULD NOT”、“RECOMMENDED”、“NOT RECOMMENDED”、“MAY” 和
   “OPTIONAL” 应按照
   《用于 RFC 中表示需求级别的关键词》
   [<a href="./rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>]
   中的说明进行解释。仅当这些术语以全大写形式出现时，才适用该解释。

   BASE64URL(OCTETS) 表示 OCTETS 的 base64url 编码，定义见
   <a href="#section-2">第 2 节</a>。



<span class="grey">Jones, et al.                Standards Track                    [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   UTF8(STRING) 表示 STRING 的 UTF-8
   [<a href="./rfc3629" title="&quot;UTF-8, a transformation format of ISO 10646&quot;">RFC3629</a>]
   表示形式的八位字节，其中 STRING 是由零个或多个 Unicode
   [<a href="#ref-UNICODE" title="&quot;The Unicode Standard&quot;">UNICODE</a>] 字符组成的序列。

   ASCII(STRING) 表示 STRING 的 ASCII
   [<a href="./rfc20" title="&quot;ASCII format for Network Interchange&quot;">RFC20</a>]
   表示形式的八位字节，其中 STRING 是由零个或多个 ASCII
   字符组成的序列。

   两个值 A 和 B 的连接表示为 A || B。

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  术语</span>

   以下术语由本规范定义：

   JSON Web Signature (JWS)
      表示数字签名或使用 MAC 保护的消息的数据结构。

   JOSE 标头
      包含用于描述所采用的密码操作和参数的参数的 JSON 对象。
      JOSE（JSON 对象签名与加密）标头由一组标头参数组成。

   JWS 载荷
      需要被保护的八位字节序列——即消息本身。
      载荷可以包含任意的八位字节序列。

   JWS 签名
      针对 JWS 受保护标头和 JWS 载荷生成的数字签名或 MAC。

   标头参数
      JOSE 标头中的一个名称/值对成员。

   JWS 受保护标头
      包含由 JWS 签名数字签名或 MAC 操作进行完整性保护的
      标头参数的 JSON 对象。
      对于 JWS 紧凑序列化，它构成整个 JOSE 标头；
      对于 JWS JSON 序列化，它是 JOSE 标头的一个组成部分。

   JWS 未受保护标头
      包含未进行完整性保护的标头参数的 JSON 对象。
      仅在使用 JWS JSON 序列化时才可能存在。







<span class="grey">Jones, et al.                Standards Track                    [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


      Base64url 编码
      使用 <a href="./rfc4648#section-5">RFC 4648 第 5 节</a> [<a href="./rfc4648" title="&quot;The Base16, Base32, and Base64 Data Encodings&quot;">RFC4648</a>] 中定义的
      URL 和文件名安全字符集进行的 Base64 编码，并省略所有结尾的
      “=” 字符（如 <a href="#section-3.2">第 3.2 节</a> 所允许），且不包含任何换行、
      空白或其他附加字符。注意，空八位字节序列的 base64url
      编码结果为空字符串。（有关在不使用填充的情况下实现 base64url
      编码的说明，参见 <a href="#appendix-C">附录 C</a>。）

   JWS 签名输入
      用于数字签名或 MAC 计算的输入。其值为
      ASCII(BASE64URL(UTF8(JWS 受保护标头)) || '.' ||
      BASE64URL(JWS 载荷))。

   JWS 紧凑序列化
      将 JWS 表示为紧凑、URL 安全字符串的一种表示形式。

   JWS JSON 序列化
      将 JWS 表示为 JSON 对象的一种表示形式。与 JWS 紧凑序列化不同，
      JWS JSON 序列化允许对同一内容应用多个数字签名和/或 MAC。
      该表示形式既未针对紧凑性进行优化，也不是 URL 安全的。

   未加保护的 JWS
      不提供完整性保护的 JWS。未加保护的 JWS 使用
      “alg” 值 “none”。

   抗碰撞名称
      一种命名空间中的名称，其分配方式使其与其他名称发生冲突的可能性
      极低。抗碰撞命名空间的示例包括：域名、ITU-T X.660 和
      X.670 建议系列中定义的对象标识符（OID），以及
      通用唯一标识符（UUID）
      [<a href="./rfc4122" title="&quot;A Universally Unique IDentifier (UUID) URN Namespace&quot;">RFC4122</a>]。
      在使用行政委派的命名空间时，名称的定义者需要采取合理的预防措施，
      以确保其控制用于定义该名称的那一部分命名空间。

   StringOrURI
      一个 JSON 字符串值，并附加以下要求：虽然 MAY 使用任意字符串值，
      但任何包含 “:” 字符的值 MUST 是一个 URI
      [<a href="./rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>]。
      StringOrURI 值作为区分大小写的字符串进行比较，不进行任何转换或规范化。






<span class="grey">Jones, et al.                Standards Track                    [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   “JSON Web 加密（JWE）”、“JWE 紧凑序列化（JWE Compact Serialization）”
以及“JWE JSON 序列化（JWE JSON Serialization）”这些术语由
JWE 规范定义
[<a href="#ref-JWE" title="&quot;JSON Web Encryption (JWE)&quot;">JWE</a>]。

“数字签名（Digital Signature）”和“消息认证码（Message Authentication Code，MAC）”
这两个术语由《Internet Security Glossary, Version 2》
定义
[<a href="./rfc4949" title="&quot;Internet Security Glossary, Version 2&quot;">RFC4949</a>]。

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  JSON Web 签名（JWS）概述</span>

   JWS 使用 JSON 数据结构和 base64url 编码来表示经过数字签名
   或 MAC 保护的内容。按照
   <a href="./rfc7159#section-2">RFC 7159 第&nbsp;2 节</a>
   [<a href="./rfc7159" title="&quot;The JavaScript Object Notation (JSON) Data Interchange Format&quot;">RFC7159</a>]，
   这些 JSON 数据结构可以在任何 JSON 值或结构字符之前或之后
   包含空白字符和/或换行符。一个 JWS 表示以下这些逻辑值
   （每一项均在 <a href="#section-2">第 2 节</a> 中定义）：

   o  JOSE 头部（JOSE Header）
   o  JWS 载荷（JWS Payload）
   o  JWS 签名（JWS Signature）

   对于一个 JWS，JOSE 头部的成员是以下各值成员的并集
   （每一项均在 <a href="#section-2">第 2 节</a> 中定义）：

   o  JWS 受保护头部（JWS Protected Header）
   o  JWS 非受保护头部（JWS Unprotected Header）

   本文档为 JWS 定义了两种序列化形式：一种是紧凑、URL 安全的
   序列化形式，称为 JWS 紧凑序列化（JWS Compact Serialization）；
   另一种是称为 JWS JSON 序列化（JWS JSON Serialization）的
   JSON 序列化形式。在这两种序列化中，JWS 受保护头部、JWS 载荷
   以及 JWS 签名都要进行 base64url 编码，因为 JSON 本身无法
   直接表示任意的八位字节序列。

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  JWS 紧凑序列化概述</span>

   在 JWS 紧凑序列化中，不使用 JWS 非受保护头部。
   在这种情况下，JOSE 头部与 JWS 受保护头部是相同的。

   在 JWS 紧凑序列化中，一个 JWS 表示为以下内容的拼接：

      BASE64URL(UTF8(JWS Protected Header)) || '.' ||
      BASE64URL(JWS Payload) || '.' ||
      BASE64URL(JWS Signature)

   有关 JWS 紧凑序列化的更多信息，请参见
   <a href="#section-7.1">第 7.1 节</a>。

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  JWS JSON 序列化概述</span>

   在 JWS JSON 序列化中，JWS 受保护头部和 JWS 非受保护头部
   中的一个或两个 MUST 存在。在这种情况下，JOSE 头部的成员
   是实际存在的 JWS 受保护头部和 JWS 非受保护头部成员的并集。

   在 JWS JSON 序列化中，一个 JWS 表示为一个 JSON 对象，
   该对象包含以下四个成员中的部分或全部：

   o  "protected"，其值为 BASE64URL(UTF8(JWS Protected Header))
   o  "header"，其值为 JWS 非受保护头部
   o  "payload"，其值为 BASE64URL(JWS Payload)
   o  "signature"，其值为 BASE64URL(JWS Signature)

   这三个经过 base64url 编码的结果字符串以及 JWS 非受保护头部
   的值，作为成员表示在一个 JSON 对象中。
   其中某些值的包含是 OPTIONAL 的。
   JWS JSON 序列化还可以表示多个签名和/或 MAC 值，
   而不仅仅是一个。
   有关 JWS JSON 序列化的更多信息，请参见
   <a href="#section-7.2">第 7.2 节</a>。

<span class="h3"><a class="selflink" id="section-3.3" href="#section-3.3">3.3</a>.  JWS 示例</span>

   本节提供了一个 JWS 示例。
   其计算过程在 <a href="#appendix-A.1">附录 A.1</a> 中有更详细的描述，
   包括用于表示所使用的 JSON 值的精确八位字节序列以及所使用的密钥值。

   以下示例中的 JWS 受保护头部声明被编码的对象是一个
   JSON Web Token
   [<a href="#ref-JWT" title="&quot;JSON Web Token (JWT)&quot;">JWT</a>]，
   并且 JWS 受保护头部和 JWS 载荷使用
   HMAC SHA-256
   [<a href="./rfc2104" title="&quot;HMAC: Keyed-Hashing for Message Authentication&quot;">RFC2104</a>]
   [<a href="#ref-SHS" title="&quot;Secure Hash Standard (SHS)&quot;">SHS</a>]
   算法进行保护：

     {"typ":"JWT",
      "alg":"HS256"}

   将该 JWS 受保护头部编码为
   BASE64URL(UTF8(JWS Protected Header)) 后，
   得到如下值：

     eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9

   以下 JSON 对象的 UTF-8 表示形式被用作 JWS 载荷。
   （请注意，载荷可以是任意内容，并不一定是 JSON 对象的表示。）



     {"iss":"joe",
      "exp":1300819380,
      "http://example.com/is_root":true}

   将该 JWS 载荷编码为 BASE64URL(JWS Payload) 后，
   得到如下值
   （仅为显示目的加入了换行）：

     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ

   使用 <a href="#appendix-A.1">附录 A.1</a> 中指定的密钥，
   采用 HMAC SHA-256 算法，
   对 JWS 签名输入
   ASCII(BASE64URL(UTF8(JWS Protected Header)) || '.' || BASE64URL(JWS Payload))
   进行 HMAC 计算，
   并将结果进行 base64url 编码，
   得到如下 BASE64URL(JWS Signature) 值：

     dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk

   按照 Header.Payload.Signature 的顺序，
   在各部分之间使用句点字符（'.'）进行拼接，
   即得到使用 JWS 紧凑序列化形式的完整 JWS 表示
   （仅为显示目的加入了换行）：

     eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ
     .
     dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk

   有关更多示例，请参见 <a href="#appendix-A">附录 A</a>，
   其中还包括在 A.6 和 A.7 节中使用 JWS JSON 序列化的示例。

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  JOSE 头部</span>

   对于一个 JWS，用于表示 JOSE 头部的 JSON 对象中的成员
   描述了应用于 JWS 受保护头部和 JWS 载荷的数字签名或 MAC，
   以及可选的其他 JWS 属性。
   JOSE 头部中的头部参数名称 MUST 是唯一的；
   JWS 解析器 MUST 要么拒绝包含重复头部参数名称的 JWS，
   要么使用一个 JSON 解析器，
   该解析器仅返回按字词顺序出现的最后一个重复成员名称，
   如 ECMAScript 5.1
   [<a href="#ref-ECMAScript" title="&quot;ECMAScript Language Specification, 5.1 Edition&quot;">ECMAScript</a>]
   中 <a href="#section-15.12">第 15.12 节</a>
   （“JSON 对象”）所规定的那样。

   实现 MUST 理解本规范中定义并被指定为
   “MUST be understood”的特定头部参数，
   并按照本规范中定义的方式对其进行处理。
   本规范中定义的所有其他未被如此指定的头部参数，
   在未被理解时 MUST 被忽略。
   除非按照 <a href="#section-4.1.11">第 4.1.11 节</a>
   被列为关键（critical）头部参数，
   否则本规范未定义的所有头部参数，
   在未被理解时 MUST 被忽略。

   头部参数名称分为三类：
   已注册头部参数名称（Registered Header Parameter names）、
   公共头部参数名称（Public Header Parameter names）
   以及私有头部参数名称（Private Header Parameter names）。

<span class="h3"><a class="selflink" id="section-4.1" href="#section-4.1">4.1</a>.  已注册头部参数名称</span>

   以下用于 JWS 的头部参数名称，
   已在 <a href="#section-9.1">第 9.1 节</a>
   建立的 IANA
   “JSON Web Signature and Encryption Header Parameters”
   注册表中注册，
   其含义如以下各小节所定义。

   如该公共注册表所示，
   JWS 与 JWE 共享一个公共的头部参数空间；
   当某个参数同时被两个规范使用时，
   其使用方式 MUST 在两个规范之间保持兼容。

<span class="h4"><a class="selflink" id="section-4.1.1" href="#section-4.1.1">4.1.1</a>.  “alg”（算法）头部参数</span>

   “alg”（algorithm）头部参数用于标识
   用来保护 JWS 的密码算法。
   如果 “alg” 的值不表示一个受支持的算法，
   或者与对内容进行数字签名或 MAC 的一方
   相关联的该算法所需的密钥不存在，
   则 JWS 签名值是无效的。
   “alg” 的值 SHOULD 要么是在
   [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>]
   建立的 IANA
   “JSON Web Signature and Encryption Algorithms”
   注册表中注册的值，
   要么是一个包含碰撞抗性名称
   （Collision-Resistant Name）的值。
   “alg” 的值是一个区分大小写的 ASCII 字符串，
   其内容为一个 StringOrURI 值。
   该头部参数 MUST 存在，
   并且 MUST 被实现理解和处理。

   可用于此目的的已定义 “alg” 值列表，
   可在
   [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>]
   建立的 IANA
   “JSON Web Signature and Encryption Algorithms”
   注册表中找到；
   该注册表的初始内容是
   [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>]
   第 3.1 节中定义的那些值。

<span class="h4"><a class="selflink" id="section-4.1.2" href="#section-4.1.2">4.1.2</a>.  “jku”（JWK 集 URL）头部参数</span>

   “jku”（JWK Set URL）头部参数是一个 URI
   [<a href="./rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>]，
   它引用一个资源，
   该资源表示一个以 JSON 编码的公钥集合，
   其中的某个公钥与用于对 JWS 进行数字签名的密钥相对应。
   这些密钥 MUST 被编码为一个 JWK 集
   [<a href="#ref-JWK" title="&quot;JSON Web Key (JWK)&quot;">JWK</a>]。
   用于获取该资源的协议 MUST 提供完整性保护；
   用于检索 JWK 集的 HTTP GET 请求
   MUST 使用传输层安全协议（Transport Layer Security）




<span class="grey">Jones, et al.                Standards Track                   [Page 10]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-11" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   （TLS）
[<a href="./rfc2818" title="&quot;HTTP Over TLS&quot;">RFC2818</a>]
[<a href="./rfc5246" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.2&quot;">RFC5246</a>]；
并且 MUST 按照
<a href="./rfc6125#section-6">RFC 6125 第&nbsp;6 节</a>
[<a href="./rfc6125" title="&quot;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)&quot;">RFC6125</a>]
对服务器的身份进行验证。
另外，请参见
<a href="#section-8">第 8 节</a>
中关于 TLS 要求的说明。
使用该头部参数是 OPTIONAL 的。

<span class="h4"><a class="selflink" id="section-4.1.3" href="#section-4.1.3">4.1.3</a>.  “jwk”（JSON Web Key）头部参数</span>

   “jwk”（JSON Web Key）头部参数是与用于对 JWS 进行数字签名的密钥
   相对应的公钥。该密钥以 JSON Web Key 的形式表示
   [<a href="#ref-JWK" title="&quot;JSON Web Key (JWK)&quot;">JWK</a>]。
   使用该头部参数是 OPTIONAL 的。

<span class="h4"><a class="selflink" id="section-4.1.4" href="#section-4.1.4">4.1.4</a>.  “kid”（密钥 ID）头部参数</span>

   “kid”（key ID）头部参数是一个提示，用于指明
   用于保护 JWS 的是哪一个密钥。
   该参数允许生成方明确地向接收方指示密钥的变更。
   “kid” 值的结构未作规定。
   其值 MUST 是一个区分大小写的字符串。
   使用该头部参数是 OPTIONAL 的。

   当与 JWK 一起使用时，
   “kid” 值用于匹配 JWK 中的 “kid” 参数值。

<span class="h4"><a class="selflink" id="section-4.1.5" href="#section-4.1.5">4.1.5</a>.  “x5u”（X.509 URL）头部参数</span>

   “x5u”（X.509 URL）头部参数是一个 URI
   [<a href="./rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>]，
   它引用一个资源，
   该资源用于获取与用于对 JWS 进行数字签名的密钥
   相对应的 X.509 公钥证书或证书链
   [<a href="./rfc5280" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>]。
   被标识的资源 MUST 提供符合
   <a href="./rfc5280">RFC 5280</a>
   [<a href="./rfc5280" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>]
   的证书或证书链表示，
   其形式为 PEM 编码，
   并且每个证书 MUST 按照
   <a href="./rfc4945#section-6.1">RFC 4945 第&nbsp;6.1 节</a>
   [<a href="./rfc4945" title="&quot;The Internet IP Security PKI Profile of IKEv1/ISAKMP, IKEv2, and PKIX&quot;">RFC4945</a>]
   中规定的方式进行分隔。
   包含与用于对 JWS 进行数字签名的密钥相对应的公钥的证书
   MUST 是第一个证书。
   其后 MAY 跟随附加证书，
   每个后续证书都是用于对前一个证书进行认证的证书。
   用于获取该资源的协议 MUST 提供完整性保护；
   用于检索该证书的 HTTP GET 请求 MUST 使用 TLS
   [<a href="./rfc2818" title="&quot;HTTP Over TLS&quot;">RFC2818</a>]
   [<a href="./rfc5246" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.2&quot;">RFC5246</a>]；
   并且 MUST 按照
   <a href="./rfc6125#section-6">RFC 6125 第&nbsp;6 节</a>
   [<a href="./rfc6125" title="&quot;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)&quot;">RFC6125</a>]
   对服务器身份进行验证。
   另外，请参见
   <a href="#section-8">第 8 节</a>
   中关于 TLS 要求的说明。
   使用该头部参数是 OPTIONAL 的。

<span class="h4"><a class="selflink" id="section-4.1.6" href="#section-4.1.6">4.1.6</a>.  “x5c”（X.509 证书链）头部参数</span>

   “x5c”（X.509 证书链）头部参数包含
   与用于对 JWS 进行数字签名的密钥相对应的
   X.509 公钥证书或证书链
   [<a href="./rfc5280" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>]。
   该证书或证书链表示为一个 JSON 数组，

   证书值字符串。
   数组中的每个字符串都是
   base64 编码的
   （<a href="./rfc4648#section-4">RFC 4648 第&nbsp;4 节</a> —— 而非 base64url 编码）
   DER
   [<a href="#ref-ITU.X690.2008">ITU.X690.2008</a>]
   PKIX 证书值。
   包含与用于对 JWS 进行数字签名的密钥相对应的公钥的证书
   MUST 是第一个证书。
   其后 MAY 跟随附加证书，
   每个后续证书都是用于对前一个证书进行认证的证书。
   接收方 MUST 按照
   <a href="./rfc5280">RFC 5280</a>
   [<a href="./rfc5280" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>]
   对证书链进行验证，
   并且如果发生任何验证失败，
   MUST 将该证书或证书链视为无效。
   使用该头部参数是 OPTIONAL 的。

   有关 “x5c” 值的示例，请参见
   <a href="#appendix-B">附录 B</a>。

<span class="h4"><a class="selflink" id="section-4.1.7" href="#section-4.1.7">4.1.7</a>.  “x5t”（X.509 证书 SHA-1 指纹）头部参数</span>

   “x5t”（X.509 证书 SHA-1 指纹）头部参数是
   与用于对 JWS 进行数字签名的密钥相对应的
   X.509 证书
   [<a href="./rfc5280" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>]
   的 DER 编码的
   base64url 编码的 SHA-1 指纹
   （又称摘要）。
   请注意，证书指纹有时也被称为证书指印
   （certificate fingerprint）。
   使用该头部参数是 OPTIONAL 的。

<span class="h4"><a class="selflink" id="section-4.1.8" href="#section-4.1.8">4.1.8</a>.  “x5t#S256”（X.509 证书 SHA-256 指纹）头部</span>
<span class="h4">        参数</span>

   “x5t#S256”（X.509 证书 SHA-256 指纹）头部参数是
   与用于对 JWS 进行数字签名的密钥相对应的
   X.509 证书
   [<a href="./rfc5280" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>]
   的 DER 编码的
   base64url 编码的 SHA-256 指纹
   （又称摘要）。
   请注意，证书指纹有时也被称为证书指印。
   使用该头部参数是 OPTIONAL 的。

<span class="h4"><a class="selflink" id="section-4.1.9" href="#section-4.1.9">4.1.9</a>.  “typ”（类型）头部参数</span>

   “typ”（type）头部参数用于由 JWS 应用声明
   该完整 JWS 的媒体类型
   [<a href="#ref-IANA.MediaTypes">IANA.MediaTypes</a>]。
   该参数旨在用于这样一种场景：
   当一个应用数据结构中可能包含多种对象，
   而该数据结构中包含一个 JWS 时，
   应用可以使用该值来区分
   可能存在的不同类型的对象。
   当对象的类型已经已知时，
   该参数通常不会被应用使用。
   该参数会被 JWS 实现忽略；
   对该参数的任何处理均由 JWS 应用执行。
   使用该头部参数是 OPTIONAL 的。

   根据 <a href="./rfc2045">RFC 2045</a>
   [<a href="./rfc2045" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies&quot;">RFC2045</a>]，
   所有媒体类型值、子类型值以及参数名称
   都是不区分大小写的。
   然而，参数值是区分大小写的，
   除非针对特定参数另有规定。

   为了在常见情况下保持消息的紧凑性，
   RECOMMENDED 在 “typ” 头部参数中，
   当媒体类型值中未出现其他 '/' 字符时，
   生成方省略媒体类型值中的
   “application/” 前缀。
   使用该媒体类型值的接收方 MUST 将其视为
   对于任何不包含 '/' 的 “typ” 值，
   都在其前面隐式地添加了 “application/”。
   例如，
   SHOULD 使用值为 “example” 的 “typ”
   来表示媒体类型 “application/example”，
   而媒体类型
   “application/example;part="1/2"”
   则不能被缩写为
   “example;part="1/2"”。

   “typ” 值 “JOSE” 可由应用用于指示
   该对象是使用 JWS 紧凑序列化
   或 JWE 紧凑序列化的 JWS 或 JWE。
   “typ” 值 “JOSE+JSON” 可由应用用于指示
   该对象是使用 JWS JSON 序列化
   或 JWE JSON 序列化的 JWS 或 JWE。
   应用也可以使用其他类型值。

<span class="h4"><a class="selflink" id="section-4.1.10" href="#section-4.1.10">4.1.10</a>.  “cty”（内容类型）头部参数</span>

   “cty”（content type）头部参数用于由 JWS 应用声明
   被保护内容（即载荷）的媒体类型
   [<a href="#ref-IANA.MediaTypes">IANA.MediaTypes</a>]。
   该参数旨在用于这样一种场景：
   当 JWS 载荷中可能包含多种对象时，
   应用可以使用该值来区分
   可能存在的不同类型的对象。
   当对象的类型已经已知时，
   该参数通常不会被应用使用。
   该参数会被 JWS 实现忽略；
   对该参数的任何处理均由 JWS 应用执行。
   使用该头部参数是 OPTIONAL 的。

   根据 <a href="./rfc2045">RFC 2045</a>
   [<a href="./rfc2045" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies&quot;">RFC2045</a>]，
   所有媒体类型值、子类型值以及参数名称
   都是不区分大小写的。
   然而，参数值是区分大小写的，
   除非针对特定参数另有规定。

   为了在常见情况下保持消息的紧凑性，
   RECOMMENDED 在 “cty” 头部参数中，
   当媒体类型值中未出现其他 '/' 字符时，
   生成方省略媒体类型值中的
   “application/” 前缀。
   使用该媒体类型值的接收方 MUST 将其视为
   对于任何不包含 '/' 的 “cty” 值，
   都在其前面隐式地添加了 “application/”。
   例如，
   SHOULD 使用值为 “example” 的 “cty”
   来表示媒体类型 “application/example”，
   而媒体类型
   “application/example;part="1/2"”
   则不能被缩写为
   “example;part="1/2"”。

<span class="h4"><a class="selflink" id="section-4.1.11" href="#section-4.1.11">4.1.11</a>.  “crit”（关键）头部参数</span>

   “crit”（critical）头部参数表示
   使用了本规范和/或
   [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>]
   的扩展，
   并且这些扩展 MUST 被理解和处理。
   其值是一个数组，
   列出了在 JOSE 头部中
   使用这些扩展的头部参数名称。
   如果接收方无法理解并支持
   所列出的任何一个扩展头部参数，
   则该 JWS 是无效的。
   生成方 MUST NOT 在 “crit” 列表中
   包含由本规范或
   [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>]
   定义并用于 JWS 的头部参数名称、
   重复的名称，
   或者未作为 JOSE 头部中的头部参数名称出现的名称。
   生成方 MUST NOT 使用空列表 “[]”
   作为 “crit” 的值。
   如果关键列表中包含任何
   由本规范或
   [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>]
   定义并用于 JWS 的头部参数名称，
   或者违反了其他任何使用约束，
   接收方 MAY 将该 JWS 视为无效。
   当使用该头部参数时，
   它 MUST 受到完整性保护；
   因此，它 MUST 仅出现在
   JWS 受保护头部中。
   使用该头部参数是 OPTIONAL 的。
   该头部参数 MUST 被实现理解并处理。

   一个示例用法，
   以及一个假设的 “exp”（过期时间）字段如下：

     {"alg":"ES256",
      "crit":["exp"],
      "exp":1363284000
     }

<span class="h3"><a class="selflink" id="section-4.2" href="#section-4.2">4.2</a>.  公共头部参数名称</span>

   使用 JWS 的各方可以定义额外的头部参数名称。
   然而，为了防止冲突，
   任何新的头部参数名称
   SHOULD 要么在
   <a href="#section-9.1">第 9.1 节</a>
   建立的 IANA
   “JSON Web Signature and Encryption Header Parameters”
   注册表中注册，
   要么是一个公共名称
   （即包含碰撞抗性名称的值）。
   在这两种情况下，
   名称或值的定义者都需要采取合理的预防措施，
   以确保他们控制着
   用于定义该头部参数名称的命名空间部分。

   新的头部参数 SHOULD 谨慎引入，
   因为它们可能导致 JWS 之间无法互操作。

<span class="h3"><a class="selflink" id="section-4.3" href="#section-4.3">4.3</a>.  私有头部参数名称</span>

   JWS 的生成方和使用方
   可以约定使用私有名称的头部参数
   （即不是已注册头部参数名称
   （<a href="#section-4.1">第 4.1 节</a>））
   或公共头部参数名称
   （<a href="#section-4.2">第 4.2 节</a>）。
   与公共头部参数名称不同，
   私有头部参数名称存在发生冲突的风险，
   因此 SHOULD 谨慎使用。

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  生成与使用 JWS</span>

<span class="h3"><a class="selflink" id="section-5.1" href="#section-5.1">5.1</a>.  消息签名或 MAC 的计算</span>

   为了创建一个 JWS，
   需要执行以下步骤。
   在各步骤的输入与输出之间
   不存在依赖关系的情况下，
   步骤的执行顺序并不重要。

   1.  创建将用作 JWS 载荷的内容。

   2.  计算编码后的载荷值
       BASE64URL(JWS Payload)。

   3.  创建包含所需头部参数集合的
       JSON 对象，
       这些对象共同构成 JOSE 头部
       （JWS 受保护头部和/或
       JWS 非受保护头部）。

   4.  计算编码后的头部值
       BASE64URL(UTF8(JWS Protected Header))。
       如果 JWS 受保护头部不存在
       （这只可能发生在使用
       JWS JSON 序列化且不存在
       “protected” 成员的情况下），
       则该值为空字符串。

   5.  按照所使用的特定算法中定义的方式，
       对 JWS 签名输入
       ASCII(BASE64URL(UTF8(JWS Protected Header)) || '.' ||
       BASE64URL(JWS Payload))
       计算 JWS 签名。
       “alg”（算法）头部参数
       MUST 存在于 JOSE 头部中，
       并且其算法值 MUST
       准确地表示用于构造
       JWS 签名的算法。

   6.  计算编码后的签名值
       BASE64URL(JWS Signature)。

   7.  如果使用 JWS JSON 序列化，
       则针对执行的每一次
       数字签名或 MAC 操作
       重复该过程（步骤 3–6）。

   8.  创建所需的序列化输出。
       该结果的 JWS 紧凑序列化形式为
       BASE64URL(UTF8(JWS Protected Header)) || '.' ||
       BASE64URL(JWS Payload) || '.' ||
       BASE64URL(JWS Signature)。
       JWS JSON 序列化形式
       在 <a href="#section-7.2">第 7.2 节</a>
       中进行了描述。







<span class="grey">Jones, et al.                Standards Track                   [Page 15]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-16" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h3"><a class="selflink" id="section-5.2" href="#section-5.2">5.2</a>.  消息签名或 MAC 验证</span>

   在验证 JWS 时，将执行以下步骤。在步骤的输入和输出之间不存在依赖关系的情况下，
   步骤的顺序并不重要。如果列出的任何一个步骤失败，则签名或 MAC 将无法通过验证。

   当存在多个 JWS Signature 值时，应用需要决定必须成功验证哪些 JWS Signature 值
   才能接受该 JWS。在某些情况下，必须全部成功验证，否则该 JWS 将被视为无效。
   在其他情况下，只需某一个特定的 JWS Signature 值成功验证即可。
   然而，在所有情况下，至少必须有一个 JWS Signature 值成功验证，
   否则 JWS MUST 被视为无效。

   1.  解析 JWS 表示形式，以提取 JWS 各组成部分的序列化值。
       在使用 JWS 紧凑序列化（JWS Compact Serialization）时，
       这些组成部分是 JWS Protected Header、JWS Payload 和 JWS Signature
       的 base64url 编码表示；在使用 JWS JSON 序列化（JWS JSON Serialization）时，
       这些组成部分还包括未编码的 JWS Unprotected Header 值。
       在使用 JWS 紧凑序列化时，JWS Protected Header、JWS Payload
       和 JWS Signature 按该顺序表示为 base64url 编码的值，
       每个值之间使用一个句点（'.'）字符分隔，
       因此总共正好使用两个分隔句点字符。
       JWS JSON 序列化在 <a href="#section-7.2">第 7.2 节</a> 中描述。

   2.  对 JWS Protected Header 的编码表示进行 Base64url 解码，
       并遵循不得使用换行符、空白字符或其他附加字符的限制。

   3.  验证得到的八位字节序列是一个完全有效的、
       符合 <a href="./rfc7159">RFC 7159</a> [<a href="./rfc7159" title="&quot;The JavaScript Object Notation (JSON) Data Interchange Format&quot;">RFC7159</a>] 的 UTF-8 编码 JSON 对象表示；
       将该 JSON 对象作为 JWS Protected Header。

   4.  如果使用 JWS 紧凑序列化，则将 JOSE Header 设为 JWS Protected Header。
       否则，在使用 JWS JSON 序列化时，
       将 JOSE Header 设为对应的 JWS Protected Header
       与 JWS Unprotected Header 成员的并集，
       这两者都必须是完全有效的 JSON 对象。
       在此步骤中，需验证生成的 JOSE Header
       不包含重复的 Header Parameter 名称。
       在使用 JWS





<span class="grey">Jones, et al.                Standards Track                   [Page 16]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-17" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


       JSON 序列化时，该限制还包括：
       同一个 Header Parameter 名称 MUST NOT 同时出现在
       共同组成 JOSE Header 的不同 JSON 对象值中。

   5.  验证实现是否理解并且能够处理其必须支持的所有字段，
       无论这些字段是由本规范、所使用的算法，
       还是由 "crit" Header Parameter 值所要求的；
       同时还需验证这些参数的取值也是被理解和支持的。

   6.  对 JWS Payload 的编码表示进行 Base64url 解码，
       并遵循不得使用换行符、空白字符或其他附加字符的限制。

   7.  对 JWS Signature 的编码表示进行 Base64url 解码，
       并遵循不得使用换行符、空白字符或其他附加字符的限制。

   8.  按照所使用算法定义的方式，
       针对 JWS Signing Input
       ASCII(BASE64URL(UTF8(JWS Protected Header)) || '.' ||
       BASE64URL(JWS Payload))
       验证 JWS Signature。
       所使用的算法 MUST 由 Header Parameter "alg"（algorithm）
       的值准确表示，并且该参数 MUST 存在。
       有关算法验证的安全注意事项，请参见
       <a href="#section-10.6">第 10.6 节</a>。
       记录验证是否成功。

   9.  如果使用的是 JWS JSON 序列化，
       则对表示中包含的每一个数字签名或 MAC 值
       重复该过程（步骤 4–8）。

   10. 如果第 9 步中的所有验证均未成功，
       则 JWS MUST 被视为无效。
       否则，在 JWS JSON 序列化的情况下，
       向应用返回一个结果，指明哪些验证成功、哪些失败。
       在 JWS 紧凑序列化的情况下，
       结果只需指示 JWS 是否成功通过验证即可。

   最后需要注意的是，
   在给定的上下文中可以使用哪些算法由应用自行决定。
   即使某个 JWS 可以成功通过验证，
   如果 JWS 中使用的算法对应用而言不可接受，
   应用也 SHOULD 将该 JWS 视为无效。

<span class="h3"><a class="selflink" id="section-5.3" href="#section-5.3">5.3</a>.  字符串比较规则</span>

   处理 JWS 不可避免地需要将已知字符串
   与 JSON 对象中的成员和取值进行比较。
   例如，在检查算法时，
   会将 Unicode 字符串 "alg"
   与 JOSE Header 中的成员名称进行比较，
   以确定是否存在匹配的



<span class="grey">Jones, et al.                Standards Track                   [Page 17]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-18" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Header Parameter 名称。
   随后，将使用相同的过程来确定
   "alg" Header Parameter 的值
   是否表示一个受支持的算法。

   JSON 中用于成员名称比较的规则
   在 <a href="./rfc7159#section-8.3">RFC 7159 的第 8.3 节</a>
   [<a href="./rfc7159" title="&quot;The JavaScript Object Notation (JSON) Data Interchange Format&quot;">RFC7159</a>] 中进行了描述。
   由于执行的字符串比较操作仅包括相等与不相等，
   因此可以使用相同的规则
   来比较成员名称和成员值与已知字符串。

   除非某个成员的定义明确指出
   该成员值需要使用不同的比较规则，
   否则这些比较规则 MUST 用于所有 JSON 字符串比较。
   本规范中定义的成员值中，
   只有 "typ" 和 "cty" 不使用这些比较规则。

   某些应用可能会在区分大小写的值中
   包含大小写不敏感的信息，
   例如在 "kid"（key ID）值中包含 DNS 名称。
   在这些情况下，
   如果多个参与方需要生成相同的值以便进行比较，
   应用可能需要为大小写不敏感的部分
   定义一种规范化的表示约定，
   例如统一转换为小写。
   （不过，如果所有其他参与方都逐字使用
   生成方输出的值，
   而不尝试将其与独立生成的值进行比较，
   那么生成方所使用的大小写就无关紧要。）

   另请参见 <a href="#section-10.12">第 10.12 节</a> 中的 JSON 安全注意事项，
   以及 <a href="#section-10.13">第 10.13 节</a> 中的 Unicode 安全注意事项。

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  密钥标识</span>

   JWS 的接收方必须能够确定
   用于数字签名或 MAC 操作的密钥。
   所使用的密钥可以通过
   <a href="#section-4.1">第 4.1 节</a> 中描述的 Header Parameter 方法进行标识，
   也可以通过本规范范围之外的方法进行标识。
   具体而言，可以使用 Header Parameter
   "jku"、"jwk"、"kid"、"x5u"、"x5c"、"x5t" 和 "x5t#S256"
   来标识所使用的密钥。
   如果这些参数所传达的信息
   将被用于信任决策，
   则这些 Header Parameter MUST 受到完整性保护；
   然而，如果信任决策中使用的唯一信息是密钥本身，
   则这些参数不必受到完整性保护，
   因为以导致使用不同密钥的方式更改它们
   将会导致验证失败。

   除非应用使用其他方式或约定来确定所使用的密钥，
   否则生成方 SHOULD 在 Header Parameter 中
   包含足够的信息以标识所使用的密钥。
   当所使用的算法需要密钥（除 "none" 之外的所有算法均如此），
   且无法确定所使用的密钥时，
   签名或 MAC 验证将失败。

   用于交换任何共享对称密钥的方法
   超出了本规范的范围。

   另请参见 <a href="#appendix-D">附录 D</a>，
   其中包含关于可能的密钥选择算法的说明。

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  序列化</span>

   JWS 使用两种序列化形式之一：
   JWS 紧凑序列化或 JWS JSON 序列化。
   使用本规范的应用需要指定
   该应用所使用的序列化形式及其特性。
   例如，应用可能会指定仅使用 JWS JSON 序列化，
   或仅支持单个签名或 MAC 值的 JWS JSON 序列化，
   或支持多个签名和/或 MAC 值。
   JWS 实现只需要实现其所支持应用所需的功能即可。

<span class="h3"><a class="selflink" id="section-7.1" href="#section-7.1">7.1</a>.  JWS 紧凑序列化</span>

   JWS 紧凑序列化将经过数字签名或 MAC 处理的内容
   表示为一个紧凑、URL 安全的字符串。
   该字符串为：

      BASE64URL(UTF8(JWS Protected Header)) || '.' ||
      BASE64URL(JWS Payload) || '.' ||
      BASE64URL(JWS Signature)

   JWS 紧凑序列化仅支持一个签名/MAC，
   并且不提供表示 JWS Unprotected Header 值的语法。

<span class="h3"><a class="selflink" id="section-7.2" href="#section-7.2">7.2</a>.  JWS JSON 序列化</span>

   JWS JSON 序列化将经过数字签名或 MAC 处理的内容
   表示为一个 JSON 对象。
   该表示形式既未针对紧凑性进行优化，
   也不是 URL 安全的。

   JWS JSON 序列化定义了两种密切相关的语法：
   一种是完全通用的语法，
   可用于对内容施加多个数字签名和/或 MAC 操作；
   另一种是扁平化语法，
   针对单个数字签名或 MAC 的情况进行了优化。






<span class="grey">Jones, et al.                Standards Track                   [Page 19]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-20" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h4"><a class="selflink" id="section-7.2.1" href="#section-7.2.1">7.2.1</a>.  通用 JWS JSON 序列化语法</span>

   以下成员被定义用于
   通用 JWS JSON 序列化语法中
   顶层 JSON 对象：

   payload
      "payload" 成员 MUST 存在，
      并包含 BASE64URL(JWS Payload) 的值。

   signatures
      "signatures" 成员的值 MUST 是一个 JSON 对象数组。
      每个对象表示
      针对 JWS Payload 和 JWS Protected Header 的
      一个签名或 MAC。

   以下成员被定义用于
   "signatures" 数组元素中的 JSON 对象：

   protected
      当 JWS Protected Header 值非空时，
      "protected" 成员 MUST 存在，
      并包含 BASE64URL(UTF8(JWS Protected Header)) 的值；
      否则，该成员 MUST 不存在。
      这些 Header Parameter 值受到完整性保护。

   header
      当 JWS Unprotected Header 值非空时，
      "header" 成员 MUST 存在，
      并包含 JWS Unprotected Header 的值；
      否则，该成员 MUST 不存在。
      该值以未编码的 JSON 对象表示，而不是字符串。
      这些 Header Parameter 值不受完整性保护。

   signature
      "signature" 成员 MUST 存在，
      并包含 BASE64URL(JWS Signature) 的值。

   对于每一个签名/MAC 计算，
   "protected" 和 "header" 成员中
   至少 MUST 存在一个，
   以便传达 "alg" Header Parameter 值。

   在上述 JSON 对象中可以存在其他成员；
   如果实现无法理解这些成员，
   则 MUST 忽略它们。

   在创建或验证单个签名或 MAC 值时使用的
   Header Parameter 值
   是可能存在的两组 Header Parameter 值的并集：
   (1) 在签名/MAC 数组元素的 "protected" 成员中表示的
       JWS Protected Header；
   (2) 在签名/MAC 数组元素的 "header" 成员中的
       JWS Unprotected Header。



<span class="grey">Jones, et al.                Standards Track                   [Page 20]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-21" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   这两组 Header Parameter 的并集
   构成了 JOSE Header。
   两个位置中的 Header Parameter 名称 MUST 是不相交的。

   每一个 JWS Signature 值
   都使用对应 JOSE Header 值中的参数
   以与 JWS 紧凑序列化相同的方式进行计算。
   这一特性使得
   "signatures" 数组中表示的每一个 JWS Signature 值
   都与在 JWS 紧凑序列化中、
   使用相同参数计算得到的值完全一致，
   前提是用于该签名/MAC 计算的
   JWS Protected Header 值
   （即表示受完整性保护的 Header Parameter 值）
   与 JWS 紧凑序列化中使用的值相匹配。

   总结而言，
   使用通用 JWS JSON 序列化的 JWS 语法如下：

     {
      "payload":"&lt;payload contents&gt;",
      "signatures":[
       {"protected":"&lt;integrity-protected header 1 contents&gt;",
        "header":&lt;non-integrity-protected header 1 contents&gt;,
        "signature":"&lt;signature 1 contents&gt;"},
       ...
       {"protected":"&lt;integrity-protected header N contents&gt;",
        "header":&lt;non-integrity-protected header N contents&gt;,
        "signature":"&lt;signature N contents&gt;"}]
     }

   有关使用通用 JWS JSON 序列化语法的示例，
   请参见 <a href="#appendix-A.6">附录 A.6</a>。

<span class="h4"><a class="selflink" id="section-7.2.2" href="#section-7.2.2">7.2.2</a>.  扁平化 JWS JSON 序列化语法</span>

   扁平化 JWS JSON 序列化语法基于通用语法，
   但对其进行了扁平化处理，
   以针对单个数字签名/MAC 的情况进行优化。
   其方式是移除 "signatures" 成员，
   并将原本定义在 "signatures" 数组中的成员
   （即 "protected"、"header" 和 "signature" 成员）
   放置在顶层 JSON 对象中
   （与 "payload" 成员处于同一层级）。

   在使用该语法时，
   MUST NOT 出现 "signatures" 成员。
   除了这一语法差异之外，
   使用扁平化语法的 JWS JSON 序列化对象
   在处理方式上与使用通用语法的对象完全相同。





<span class="grey">Jones, et al.                Standards Track                   [Page 21]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-22" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   总结而言，
   使用扁平化 JWS JSON 序列化的 JWS 语法如下：

     {
      "payload":"&lt;payload contents&gt;",
      "protected":"&lt;integrity-protected header contents&gt;",
      "header":&lt;non-integrity-protected header contents&gt;,
      "signature":"&lt;signature contents&gt;"
     }

   有关使用扁平化 JWS JSON 序列化语法的示例，
   请参见 <a href="#appendix-A.7">附录 A.7</a>。

<span class="h2"><a class="selflink" id="section-8" href="#section-8">8</a>.  TLS 要求</span>

   支持 "jku" 和/或 "x5u" Header Parameter 的实现
   MUST 支持 TLS。
   应当实现哪些 TLS 版本
   会随着时间推移而变化，
   并取决于实现时的广泛部署情况
   以及已知的安全漏洞。
   在撰写本规范时，
   TLS 版本 1.2
   [<a href="./rfc5246" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.2&quot;">RFC5246</a>]
   是最新版本。

   为防止信息泄露和篡改，
   MUST 使用 TLS
   以及提供机密性和完整性保护的密码套件
   来实现机密性保护。
   有关当前被认为适合使用的密码套件，
   请参阅 IETF TLS 工作组的最新出版物，
   包括 <a href="./rfc6176">RFC 6176</a>
   [<a href="./rfc6176" title="&quot;Prohibiting Secure Sockets Layer (SSL) Version 2.0&quot;">RFC6176</a>]。
   另请参见
   《Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)》
   [<a href="./rfc7525" title="&quot;Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)&quot;">RFC7525</a>]，
   其中给出了
   提升使用 TLS 的软件和服务安全性的建议。

   在使用 TLS 时，
   MUST 按照
   <a href="./rfc6125#section-6">RFC 6125 第 6 节</a>
   [<a href="./rfc6125" title="&quot;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)&quot;">RFC6125</a>]
   中描述的流程，
   验证 TLS 服务器证书中编码的服务提供者身份。

<span class="h2"><a class="selflink" id="section-9" href="#section-9">9</a>.  IANA 注意事项</span>

   本规范所建立的所有注册表
   均使用以下注册流程。

   数值在 jose-reg-review@ietf.org 邮件列表上
   经过为期三周的审查期后，
   在一个或多个指定专家的建议下，
   以“Specification Required”
   [<a href="./rfc5226" title="">RFC5226</a>] 的方式进行注册。
   然而，为了允许在正式发布之前分配数值，
   只要指定专家确信该规范将会发布，
   便可以批准注册。





<span class="grey">Jones, et al.                Standards Track                   [Page 22]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-23" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Registration requests sent to the mailing list for review should use
   an appropriate subject (e.g., "Request to register header parameter:
   example").

   Within the review period, the Designated Experts will either approve
   or deny the registration request, communicating this decision to the
   review list and IANA.  Denials should include an explanation and, if
   applicable, suggestions as to how to make the request successful.
   Registration requests that are undetermined for a period longer than
   21 days can be brought to the IESG's attention (using the
   iesg@ietf.org mailing list) for resolution.

   Criteria that should be applied by the Designated Experts includes
   determining whether the proposed registration duplicates existing
   functionality, whether it is likely to be of general applicability or
   useful only for a single application, and whether the registration
   description is clear.

   IANA must only accept registry updates from the Designated Experts
   and should direct all requests for registration to the review mailing
   list.

   It is suggested that multiple Designated Experts be appointed who are
   able to represent the perspectives of different applications using
   this specification, in order to enable broadly informed review of
   registration decisions.  In cases where a registration decision could
   be perceived as creating a conflict of interest for a particular
   Expert, that Expert should defer to the judgment of the other
   Experts.

<span class="h3"><a class="selflink" id="section-9.1" href="#section-9.1">9.1</a>.  JSON Web Signature and Encryption Header Parameters Registry</span>

   This specification establishes the IANA "JSON Web Signature and
   Encryption Header Parameters" registry for Header Parameter names.
   The registry records the Header Parameter name and a reference to the
   specification that defines it.  The same Header Parameter name can be
   registered multiple times, provided that the parameter usage is
   compatible between the specifications.  Different registrations of
   the same Header Parameter name will typically use different Header
   Parameter Usage Locations values.

<span class="h4"><a class="selflink" id="section-9.1.1" href="#section-9.1.1">9.1.1</a>.  Registration Template</span>

   Header Parameter Name:
      The name requested (e.g., "kid").  Because a core goal of this
      specification is for the resulting representations to be compact,
      it is RECOMMENDED that the name be short -- not to exceed 8
      characters without a compelling reason to do so.  This name is



<span class="grey">Jones, et al.                Standards Track                   [Page 23]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-24" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


      case sensitive.  Names may not match other registered names in a
      case-insensitive manner unless the Designated Experts state that
      there is a compelling reason to allow an exception.

   Header Parameter Description:
      Brief description of the Header Parameter (e.g., "Key ID").

   Header Parameter Usage Location(s):
      The Header Parameter usage locations, which should be one or more
      of the values "JWS" or "JWE".

   Change Controller:
      For Standards Track RFCs, list the "IESG".  For others, give the
      name of the responsible party.  Other details (e.g., postal
      address, email address, home page URI) may also be included.

   Specification Document(s):
      Reference to the document or documents that specify the parameter,
      preferably including URIs that can be used to retrieve copies of
      the documents.  An indication of the relevant sections may also be
      included but is not required.

<span class="h4"><a class="selflink" id="section-9.1.2" href="#section-9.1.2">9.1.2</a>.  Initial Registry Contents</span>

   This section registers the Header Parameter names defined in
   <a href="#section-4.1">Section 4.1</a> in this registry.

   o  Header Parameter Name: "alg"
   o  Header Parameter Description: Algorithm
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.1">Section&nbsp;4.1.1 of RFC 7515</a>

   o  Header Parameter Name: "jku"
   o  Header Parameter Description: JWK Set URL
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.2">Section&nbsp;4.1.2 of RFC 7515</a>

   o  Header Parameter Name: "jwk"
   o  Header Parameter Description: JSON Web Key
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.3">Section&nbsp;4.1.3 of RFC 7515</a>







<span class="grey">Jones, et al.                Standards Track                   [Page 24]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-25" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   o  Header Parameter Name: "kid"
   o  Header Parameter Description: Key ID
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.4">Section&nbsp;4.1.4 of RFC 7515</a>

   o  Header Parameter Name: "x5u"
   o  Header Parameter Description: X.509 URL
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.5">Section&nbsp;4.1.5 of RFC 7515</a>

   o  Header Parameter Name: "x5c"
   o  Header Parameter Description: X.509 Certificate Chain
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.6">Section&nbsp;4.1.6 of RFC 7515</a>

   o  Header Parameter Name: "x5t"
   o  Header Parameter Description: X.509 Certificate SHA-1 Thumbprint
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.7">Section&nbsp;4.1.7 of RFC 7515</a>

   o  Header Parameter Name: "x5t#S256"
   o  Header Parameter Description: X.509 Certificate SHA-256 Thumbprint
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.8">Section&nbsp;4.1.8 of RFC 7515</a>

   o  Header Parameter Name: "typ"
   o  Header Parameter Description: Type
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.9">Section&nbsp;4.1.9 of RFC 7515</a>

   o  Header Parameter Name: "cty"
   o  Header Parameter Description: Content Type
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.10">Section&nbsp;4.1.10 of RFC 7515</a>

   o  Header Parameter Name: "crit"
   o  Header Parameter Description: Critical
   o  Header Parameter Usage Location(s): JWS
   o  Change Controller: IESG
   o  Specification Document(s): <a href="./rfc7515#section-4.1.11">Section&nbsp;4.1.11 of RFC 7515</a>




<span class="grey">Jones, et al.                Standards Track                   [Page 25]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-26" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h3"><a class="selflink" id="section-9.2" href="#section-9.2">9.2</a>.  Media Type Registration</span>

<span class="h4"><a class="selflink" id="section-9.2.1" href="#section-9.2.1">9.2.1</a>.  Registry Contents</span>

   This section registers the "application/jose" media type [<a href="./rfc2046" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types&quot;">RFC2046</a>] in
   the "Media Types" registry [<a href="#ref-IANA.MediaTypes">IANA.MediaTypes</a>] in the manner described
   in <a href="./rfc6838">RFC 6838</a> [<a href="./rfc6838" title="&quot;Media Type Specifications and Registration Procedures&quot;">RFC6838</a>], which can be used to indicate that the content
   is a JWS or JWE using the JWS Compact Serialization or the JWE
   Compact Serialization.  This section also registers the "application/
   jose+json" media type in the "Media Types" registry, which can be
   used to indicate that the content is a JWS or JWE using the JWS JSON
   Serialization or the JWE JSON Serialization.

   o  Type name: application
   o  Subtype name: jose
   o  Required parameters: n/a
   o  Optional parameters: n/a
   o  Encoding considerations: 8bit; application/jose values are encoded
      as a series of base64url-encoded values (some of which may be the
      empty string), each separated from the next by a single period
      ('.') character.
   o  Security considerations: See the Security Considerations section
      of <a href="./rfc7515">RFC 7515</a>.
   o  Interoperability considerations: n/a
   o  Published specification: <a href="./rfc7515">RFC 7515</a>
   o  Applications that use this media type: OpenID Connect, Mozilla
      Persona, Salesforce, Google, Android, Windows Azure, Xbox One,
      Amazon Web Services, and numerous others that use JWTs
   o  Fragment identifier considerations: n/a
   o  Additional information:

         Magic number(s): n/a
         File extension(s): n/a
         Macintosh file type code(s): n/a

   o  Person &amp; email address to contact for further information:
      Michael B. Jones, mbj@microsoft.com
   o  Intended usage: COMMON
   o  Restrictions on usage: none
   o  Author: Michael B. Jones, mbj@microsoft.com
   o  Change Controller: IESG
   o  Provisional registration?  No









<span class="grey">Jones, et al.                Standards Track                   [Page 26]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-27" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   o  Type name: application
   o  Subtype name: jose+json
   o  Required parameters: n/a
   o  Optional parameters: n/a
   o  Encoding considerations: 8bit; application/jose+json values are
      represented as a JSON Object; UTF-8 encoding SHOULD be employed
      for the JSON object.
   o  Security considerations: See the Security Considerations section
      of <a href="./rfc7515">RFC 7515</a>
   o  Interoperability considerations: n/a
   o  Published specification: <a href="./rfc7515">RFC 7515</a>
   o  Applications that use this media type: Nimbus JOSE + JWT library
   o  Fragment identifier considerations: n/a
   o  Additional information:

         Magic number(s): n/a
         File extension(s): n/a
         Macintosh file type code(s): n/a

   o  Person &amp; email address to contact for further information:
      Michael B. Jones, mbj@microsoft.com
   o  Intended usage: COMMON
   o  Restrictions on usage: none
   o  Author: Michael B. Jones, mbj@microsoft.com
   o  Change Controller: IESG
   o  Provisional registration?  No

<span class="h2"><a class="selflink" id="section-10" href="#section-10">10</a>.  Security Considerations</span>

   All of the security issues that are pertinent to any cryptographic
   application must be addressed by JWS/JWE/JWK agents.  Among these
   issues are protecting the user's asymmetric private and symmetric
   secret keys and employing countermeasures to various attacks.

   All the security considerations in "XML Signature Syntax and
   Processing Version 2.0" [<a href="#ref-W3C.NOTE-xmldsig-core2-20130411">W3C.NOTE-xmldsig-core2-20130411</a>], also apply
   to this specification, other than those that are XML specific.
   Likewise, many of the best practices documented in "XML Signature
   Best Practices" [<a href="#ref-W3C.NOTE-xmldsig-bestpractices-20130411">W3C.NOTE-xmldsig-bestpractices-20130411</a>] also apply
   to this specification, other than those that are XML specific.

<span class="h3"><a class="selflink" id="section-10.1" href="#section-10.1">10.1</a>.  Key Entropy and Random Values</span>

   Keys are only as strong as the amount of entropy used to generate
   them.  A minimum of 128 bits of entropy should be used for all keys,
   and depending upon the application context, more may be required.





<span class="grey">Jones, et al.                Standards Track                   [Page 27]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-28" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Implementations must randomly generate public/private key pairs, MAC
   keys, and padding values.  The use of inadequate pseudorandom number
   generators (PRNGs) to generate cryptographic keys can result in
   little or no security.  An attacker may find it much easier to
   reproduce the PRNG environment that produced the keys, searching the
   resulting small set of possibilities rather than brute-force
   searching the whole key space.  The generation of quality random
   numbers is difficult.  <a href="./rfc4086">RFC 4086</a> [<a href="./rfc4086" title="&quot;Randomness Requirements for Security&quot;">RFC4086</a>] offers important guidance
   in this area.

<span class="h3"><a class="selflink" id="section-10.2" href="#section-10.2">10.2</a>.  Key Protection</span>

   Implementations must protect the signer's private key.  Compromise of
   the signer's private key permits an attacker to masquerade as the
   signer.

   Implementations must protect the MAC key.  Compromise of the MAC key
   may result in undetectable modification of the authenticated content.

<span class="h3"><a class="selflink" id="section-10.3" href="#section-10.3">10.3</a>.  Key Origin Authentication</span>

   The key management technique employed to obtain public keys must
   authenticate the origin of the key; otherwise, it is unknown what
   party signed the message.

   Likewise, the key management technique employed to distribute MAC
   keys must provide data origin authentication; otherwise, the contents
   are delivered with integrity from an unknown source.

<span class="h3"><a class="selflink" id="section-10.4" href="#section-10.4">10.4</a>.  Cryptographic Agility</span>

   See Section 8.1 of [<a href="#ref-JWA" title="&quot;JSON Web Algorithms (JWA)&quot;">JWA</a>] for security considerations on cryptographic
   agility.

<span class="h3"><a class="selflink" id="section-10.5" href="#section-10.5">10.5</a>.  Differences between Digital Signatures and MACs</span>

   While MACs and digital signatures can both be used for integrity
   checking, there are some significant differences between the security
   properties that each of them provides.  These need to be taken into
   consideration when designing protocols and selecting the algorithms
   to be used in protocols.

   Both signatures and MACs provide for integrity checking -- verifying
   that the message has not been modified since the integrity value was
   computed.  However, MACs provide for origination identification only
   under specific circumstances.  It can normally be assumed that a
   private key used for a signature is only in the hands of a single
   entity (although perhaps a distributed entity, in the case of



<span class="grey">Jones, et al.                Standards Track                   [Page 28]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-29" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   replicated servers); however, a MAC key needs to be in the hands of
   all the entities that use it for integrity computation and checking.
   Validation of a MAC only provides corroboration that the message was
   generated by one of the parties that knows the symmetric MAC key.
   This means that origination can only be determined if a MAC key is
   known only to two entities and the recipient knows that it did not
   create the message.  MAC validation cannot be used to prove
   origination to a third party.

<span class="h3"><a class="selflink" id="section-10.6" href="#section-10.6">10.6</a>.  Algorithm Validation</span>

   The digital signature representations for some algorithms include
   information about the algorithm used inside the signature value.  For
   instance, signatures produced with RSASSA-PKCS1-v1_5 [<a href="./rfc3447" title="&quot;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1&quot;">RFC3447</a>] encode
   the hash function used, and many libraries actually use the hash
   algorithm specified inside the signature when validating the
   signature.  When using such libraries, as part of the algorithm
   validation performed, implementations MUST ensure that the algorithm
   information encoded in the signature corresponds to that specified
   with the "alg" Header Parameter.  If this is not done, an attacker
   could claim to have used a strong hash algorithm while actually using
   a weak one represented in the signature value.

<span class="h3"><a class="selflink" id="section-10.7" href="#section-10.7">10.7</a>.  Algorithm Protection</span>

   In some usages of JWS, there is a risk of algorithm substitution
   attacks, in which an attacker can use an existing digital signature
   value with a different signature algorithm to make it appear that a
   signer has signed something that it has not.  These attacks have been
   discussed in detail in the context of Cryptographic Message Syntax
   (CMS) [<a href="./rfc6211" title="&quot;Cryptographic Message Syntax (CMS) Algorithm Identifier Protection Attribute&quot;">RFC6211</a>].  This risk arises when all of the following are
   true:

   o  Verifiers of a signature support multiple algorithms.

   o  Given an existing signature, an attacker can find another payload
      that produces the same signature value with a different algorithm.

   o  The payload crafted by the attacker is valid in the application
      context.

   There are several ways for an application to mitigate algorithm
   substitution attacks:

   o  Use only digital signature algorithms that are not vulnerable to
      substitution attacks.  Substitution attacks are only feasible if
      an attacker can compute pre-images for a hash function accepted by




<span class="grey">Jones, et al.                Standards Track                   [Page 29]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-30" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


      the recipient.  All JWA-defined signature algorithms use SHA-2
      hashes, for which there are no known pre-image attacks, as of the
      time of this writing.

   o  Require that the "alg" Header Parameter be carried in the JWS
      Protected Header.  (This is always the case when using the JWS
      Compact Serialization and is the approach taken by CMS [<a href="./rfc6211" title="&quot;Cryptographic Message Syntax (CMS) Algorithm Identifier Protection Attribute&quot;">RFC6211</a>].)

   o  Include a field containing the algorithm in the application
      payload, and require that it be matched with the "alg" Header
      Parameter during verification.  (This is the approach taken by
      PKIX [<a href="./rfc5280" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>].)

<span class="h3"><a class="selflink" id="section-10.8" href="#section-10.8">10.8</a>.  Chosen Plaintext Attacks</span>

   Creators of JWSs should not allow third parties to insert arbitrary
   content into the message without adding entropy not controlled by the
   third party.

<span class="h3"><a class="selflink" id="section-10.9" href="#section-10.9">10.9</a>.  Timing Attacks</span>

   When cryptographic algorithms are implemented in such a way that
   successful operations take a different amount of time than
   unsuccessful operations, attackers may be able to use the time
   difference to obtain information about the keys employed.  Therefore,
   such timing differences must be avoided.

<span class="h3"><a class="selflink" id="section-10.10" href="#section-10.10">10.10</a>.  Replay Protection</span>

   While not directly in scope for this specification, note that
   applications using JWS (or JWE) objects can thwart replay attacks by
   including a unique message identifier as integrity-protected content
   in the JWS (or JWE) message and having the recipient verify that the
   message has not been previously received or acted upon.

<span class="h3"><a class="selflink" id="section-10.11" href="#section-10.11">10.11</a>.  SHA-1 Certificate Thumbprints</span>

   A SHA-1 hash is used when computing "x5t" (X.509 certificate SHA-1
   thumbprint) values, for compatibility reasons.  Should an effective
   means of producing SHA-1 hash collisions be developed and should an
   attacker wish to interfere with the use of a known certificate on a
   given system, this could be accomplished by creating another
   certificate whose SHA-1 hash value is the same and adding it to the
   certificate store used by the intended victim.  A prerequisite to
   this attack succeeding is the attacker having write access to the
   intended victim's certificate store.





<span class="grey">Jones, et al.                Standards Track                   [Page 30]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-31" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Alternatively, the "x5t#S256" (X.509 certificate SHA-256 thumbprint)
   Header Parameter could be used instead of "x5t".  However, at the
   time of this writing, no development platform is known to support
   SHA-256 certificate thumbprints.

<span class="h3"><a class="selflink" id="section-10.12" href="#section-10.12">10.12</a>.  JSON Security Considerations</span>

   Strict JSON [<a href="./rfc7159" title="&quot;The JavaScript Object Notation (JSON) Data Interchange Format&quot;">RFC7159</a>] validation is a security requirement.  If
   malformed JSON is received, then the intent of the producer is
   impossible to reliably discern.  Ambiguous and potentially
   exploitable situations could arise if the JSON parser used does not
   reject malformed JSON syntax.  In particular, any JSON inputs not
   conforming to the JSON-text syntax defined in <a href="./rfc7159">RFC 7159</a> MUST be
   rejected in their entirety by JSON parsers.

   <a href="#section-4">Section 4</a> of "The JavaScript Object Notation (JSON) Data Interchange
   Format" [<a href="./rfc7159" title="&quot;The JavaScript Object Notation (JSON) Data Interchange Format&quot;">RFC7159</a>] states, "The names within an object SHOULD be
   unique", whereas this specification states that

      The Header Parameter names within the JOSE Header MUST be unique;
      JWS parsers MUST either reject JWSs with duplicate Header
      Parameter names or use a JSON parser that returns only the
      lexically last duplicate member name, as specified in
      <a href="#section-15.12">Section 15.12</a> ("The JSON Object") of ECMAScript 5.1 [<a href="#ref-ECMAScript" title="&quot;ECMAScript Language Specification, 5.1 Edition&quot;">ECMAScript</a>].

   Thus, this specification requires that the "SHOULD" in <a href="./rfc7159#section-4">Section&nbsp;4 of
   [RFC7159]</a> be treated as a "MUST" by producers and that it be either
   treated as a "MUST" or treated in the manner specified in ECMAScript
   5.1 by consumers.  Ambiguous and potentially exploitable situations
   could arise if the JSON parser used does not enforce the uniqueness
   of member names or returns an unpredictable value for duplicate
   member names.

   Some JSON parsers might not reject input that contains extra
   significant characters after a valid input.  For instance, the input
   "{"tag":"value"}ABCD" contains a valid JSON-text object followed by
   the extra characters "ABCD".  Implementations MUST consider JWSs
   containing such input to be invalid.

<span class="h3"><a class="selflink" id="section-10.13" href="#section-10.13">10.13</a>.  Unicode Comparison Security Considerations</span>

   Header Parameter names and algorithm names are Unicode strings.  For
   security reasons, the representations of these names must be compared
   verbatim after performing any escape processing (as per <a href="./rfc7159#section-8.3">Section&nbsp;8.3
   of RFC 7159</a> [<a href="./rfc7159" title="&quot;The JavaScript Object Notation (JSON) Data Interchange Format&quot;">RFC7159</a>]).  This means, for instance, that these JSON
   strings must compare as being equal ("sig", "\u0073ig"), whereas
   these must all compare as being not equal to the first set or to each
   other ("SIG", "Sig", "si\u0047").



<span class="grey">Jones, et al.                Standards Track                   [Page 31]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-32" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   JSON strings can contain characters outside the Unicode Basic
   Multilingual Plane.  For instance, the G clef character (U+1D11E) may
   be represented in a JSON string as "\uD834\uDD1E".  Ideally, JWS
   implementations SHOULD ensure that characters outside the Basic
   Multilingual Plane are preserved and compared correctly;
   alternatively, if this is not possible due to these characters
   exercising limitations present in the underlying JSON implementation,
   then input containing them MUST be rejected.

<span class="h2"><a class="selflink" id="section-11" href="#section-11">11</a>.  References</span>

<span class="h3"><a class="selflink" id="section-11.1" href="#section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-ECMAScript">ECMAScript</a>] Ecma International, "ECMAScript Language Specification,
                5.1 Edition", ECMA 262, June 2011,
                &lt;<a href="http://www.ecma-international.org/ecma-262/5.1/ECMA-262.pdf">http://www.ecma-international.org/ecma-262/5.1/</a>
                <a href="http://www.ecma-international.org/ecma-262/5.1/ECMA-262.pdf">ECMA-262.pdf</a>&gt;.

   [<a id="ref-IANA.MediaTypes">IANA.MediaTypes</a>]
                IANA, "Media Types",
                &lt;<a href="http://www.iana.org/assignments/media-types">http://www.iana.org/assignments/media-types</a>&gt;.

   [<a id="ref-ITU.X690.2008">ITU.X690.2008</a>]
                International Telecommunications Union, "Information
                Technology - ASN.1 encoding rules: Specification of
                Basic Encoding Rules (BER), Canonical Encoding Rules
                (CER) and Distinguished Encoding Rules (DER)", ITU-T
                Recommendation X.690, 2008.

   [<a id="ref-JWA">JWA</a>]        Jones, M., "JSON Web Algorithms (JWA)", <a href="./rfc7518">RFC 7518</a>,
                DOI 10.17487/RFC7518, May 2015,
                &lt;<a href="https://www.rfc-editor.org/info/rfc7518">http://www.rfc-editor.org/info/rfc7518</a>&gt;.

   [<a id="ref-JWK">JWK</a>]        Jones, M., "JSON Web Key (JWK)", <a href="./rfc7517">RFC 7517</a>,
                DOI 10.17487/RFC7517, May 2015,
                &lt;<a href="https://www.rfc-editor.org/info/rfc7517">http://www.rfc-editor.org/info/rfc7517</a>&gt;.

   [<a id="ref-RFC20">RFC20</a>]      Cerf, V., "ASCII format for Network Interchange",
                STD 80, <a href="./rfc20">RFC 20</a>, DOI 10.17487/RFC0020, October 1969,
                &lt;<a href="https://www.rfc-editor.org/info/rfc20">http://www.rfc-editor.org/info/rfc20</a>&gt;.

   [<a id="ref-RFC2045">RFC2045</a>]    Freed, N. and N. Borenstein, "Multipurpose Internet Mail
                Extensions (MIME) Part One: Format of Internet Message
                Bodies", <a href="./rfc2045">RFC 2045</a>, DOI 10.17487/RFC2045, November 1996,
                &lt;<a href="https://www.rfc-editor.org/info/rfc2045">http://www.rfc-editor.org/info/rfc2045</a>&gt;.






<span class="grey">Jones, et al.                Standards Track                   [Page 32]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-33" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   [<a id="ref-RFC2046">RFC2046</a>]    Freed, N. and N. Borenstein, "Multipurpose Internet Mail
                Extensions (MIME) Part Two: Media Types", <a href="./rfc2046">RFC 2046</a>,
                DOI 10.17487/RFC2046, November 1996,
                &lt;<a href="https://www.rfc-editor.org/info/rfc2046">http://www.rfc-editor.org/info/rfc2046</a>&gt;.

   [<a id="ref-RFC2119">RFC2119</a>]    Bradner, S., "Key words for use in RFCs to Indicate
                Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>,
                DOI 10.17487/RFC2119, March 1997,
                &lt;<a href="https://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC2818">RFC2818</a>]    Rescorla, E., "HTTP Over TLS", <a href="./rfc2818">RFC 2818</a>,
                DOI 10.17487/RFC2818, May 2000,
                &lt;<a href="https://www.rfc-editor.org/info/rfc2818">http://www.rfc-editor.org/info/rfc2818</a>&gt;.

   [<a id="ref-RFC3629">RFC3629</a>]    Yergeau, F., "UTF-8, a transformation format of ISO
                10646", STD 63, <a href="./rfc3629">RFC 3629</a>, DOI 10.17487/RFC3629, November
                2003, &lt;<a href="https://www.rfc-editor.org/info/rfc3629">http://www.rfc-editor.org/info/rfc3629</a>&gt;.

   [<a id="ref-RFC3986">RFC3986</a>]    Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
                Resource Identifier (URI): Generic Syntax", STD 66,
                <a href="./rfc3986">RFC 3986</a>, DOI 10.17487/RFC3986, January 2005,
                &lt;<a href="https://www.rfc-editor.org/info/rfc3986">http://www.rfc-editor.org/info/rfc3986</a>&gt;.

   [<a id="ref-RFC4648">RFC4648</a>]    Josefsson, S., "The Base16, Base32, and Base64 Data
                Encodings", <a href="./rfc4648">RFC 4648</a>, DOI 10.17487/RFC4648, October
                2006, &lt;<a href="https://www.rfc-editor.org/info/rfc4648">http://www.rfc-editor.org/info/rfc4648</a>&gt;.

   [<a id="ref-RFC4945">RFC4945</a>]    Korver, B., "The Internet IP Security PKI Profile of
                IKEv1/ISAKMP, IKEv2, and PKIX", <a href="./rfc4945">RFC 4945</a>,
                DOI 10.17487/RFC4945, August 2007,
                &lt;<a href="https://www.rfc-editor.org/info/rfc4945">http://www.rfc-editor.org/info/rfc4945</a>&gt;.

   [<a id="ref-RFC4949">RFC4949</a>]    Shirey, R., "Internet Security Glossary, Version 2",
                FYI 36, <a href="./rfc4949">RFC 4949</a>, DOI 10.17487/RFC4949, August 2007,
                &lt;<a href="https://www.rfc-editor.org/info/rfc4949">http://www.rfc-editor.org/info/rfc4949</a>&gt;.

   [<a id="ref-RFC5246">RFC5246</a>]    Dierks, T. and E. Rescorla, "The Transport Layer
                Security (TLS) Protocol Version 1.2", <a href="./rfc5246">RFC 5246</a>,
                DOI 10.17487/RFC5246, August 2008,
                &lt;<a href="https://www.rfc-editor.org/info/rfc5246">http://www.rfc-editor.org/info/rfc5246</a>&gt;.

   [<a id="ref-RFC5280">RFC5280</a>]    Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
                Housley, R., and W. Polk, "Internet X.509 Public Key
                Infrastructure Certificate and Certificate Revocation
                List (CRL) Profile", <a href="./rfc5280">RFC 5280</a>, DOI 10.17487/RFC5280, May
                2008, &lt;<a href="https://www.rfc-editor.org/info/rfc5280">http://www.rfc-editor.org/info/rfc5280</a>&gt;.





<span class="grey">Jones, et al.                Standards Track                   [Page 33]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-34" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   [<a id="ref-RFC6125">RFC6125</a>]    Saint-Andre, P. and J. Hodges, "Representation and
                Verification of Domain-Based Application Service
                Identity within Internet Public Key Infrastructure Using
                X.509 (PKIX) Certificates in the Context of Transport
                Layer Security (TLS)", <a href="./rfc6125">RFC 6125</a>, DOI 10.17487/RFC6125,
                March 2011, &lt;<a href="https://www.rfc-editor.org/info/rfc6125">http://www.rfc-editor.org/info/rfc6125</a>&gt;.

   [<a id="ref-RFC6176">RFC6176</a>]    Turner, S. and T. Polk, "Prohibiting Secure Sockets
                Layer (SSL) Version 2.0", <a href="./rfc6176">RFC 6176</a>,
                DOI 10.17487/RFC6176, March 2011,
                &lt;<a href="https://www.rfc-editor.org/info/rfc6176">http://www.rfc-editor.org/info/rfc6176</a>&gt;.

   [<a id="ref-RFC7159">RFC7159</a>]    Bray, T., Ed., "The JavaScript Object Notation (JSON)
                Data Interchange Format", <a href="./rfc7159">RFC 7159</a>,
                DOI 10.17487/RFC7159, March 2014,
                &lt;<a href="https://www.rfc-editor.org/info/rfc7159">http://www.rfc-editor.org/info/rfc7159</a>&gt;.

   [<a id="ref-UNICODE">UNICODE</a>]    The Unicode Consortium, "The Unicode Standard",
                &lt;<a href="http://www.unicode.org/versions/latest/">http://www.unicode.org/versions/latest/</a>&gt;.

<span class="h3"><a class="selflink" id="section-11.2" href="#section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-CanvasApp">CanvasApp</a>]  Facebook, "Canvas Applications",
                &lt;<a href="https://developers.facebook.com/docs/authentication/canvas">http://developers.facebook.com/docs/authentication/</a>
                <a href="https://developers.facebook.com/docs/authentication/canvas">canvas</a>&gt;.

   [<a id="ref-JSS">JSS</a>]        Bradley, J. and N. Sakimura, Ed., "JSON Simple Sign",
                September 2010, &lt;<a href="http://jsonenc.info/jss/1.0/">http://jsonenc.info/jss/1.0/</a>&gt;.

   [<a id="ref-JWE">JWE</a>]        Jones, M. and J. Hildebrand, "JSON Web Encryption
                (JWE)", <a href="./rfc7516">RFC 7516</a>, DOI 10.17487/RFC7516, May 2015,
                &lt;<a href="https://www.rfc-editor.org/info/rfc7516">http://www.rfc-editor.org/info/rfc7516</a>&gt;.

   [<a id="ref-JWT">JWT</a>]        Jones, M., Bradley, J., and N. Sakimura, "JSON Web Token
                (JWT)", <a href="./rfc7519">RFC 7519</a>, DOI 10.17487/RFC7519, May 2015,
                &lt;<a href="https://www.rfc-editor.org/info/rfc7519">http://www.rfc-editor.org/info/rfc7519</a>&gt;.

   [<a id="ref-MagicSignatures">MagicSignatures</a>]
                Panzer, J., Ed., Laurie, B., and D. Balfanz, "Magic
                Signatures", January 2011,
                &lt;<a href="https://salmon-protocol.googlecode.com/svn/trunk/draft-panzer-magicsig-01.html">http://salmon-protocol.googlecode.com/svn/trunk/</a>
                <a href="https://salmon-protocol.googlecode.com/svn/trunk/draft-panzer-magicsig-01.html">draft-panzer-magicsig-01.html</a>&gt;.

   [<a id="ref-RFC2104">RFC2104</a>]    Krawczyk, H., Bellare, M., and R. Canetti, "HMAC:
                Keyed-Hashing for Message Authentication", <a href="./rfc2104">RFC 2104</a>,
                DOI 10.17487/RFC2104, February 1997,
                &lt;<a href="https://www.rfc-editor.org/info/rfc2104">http://www.rfc-editor.org/info/rfc2104</a>&gt;.




<span class="grey">Jones, et al.                Standards Track                   [Page 34]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-35" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   [<a id="ref-RFC3447">RFC3447</a>]    Jonsson, J. and B. Kaliski, "Public-Key Cryptography
                Standards (PKCS) #1: RSA Cryptography Specifications
                Version 2.1", <a href="./rfc3447">RFC 3447</a>, DOI 10.17487/RFC3447, February
                2003, &lt;<a href="https://www.rfc-editor.org/info/rfc3447">http://www.rfc-editor.org/info/rfc3447</a>&gt;.

   [<a id="ref-RFC4086">RFC4086</a>]    Eastlake 3rd, D., Schiller, J., and S. Crocker,
                "Randomness Requirements for Security", <a href="https://www.rfc-editor.org/bcp/bcp106">BCP 106</a>,
                <a href="./rfc4086">RFC 4086</a>, DOI 10.17487/RFC4086, June 2005,
                &lt;<a href="https://www.rfc-editor.org/info/rfc4086">http://www.rfc-editor.org/info/rfc4086</a>&gt;.

   [<a id="ref-RFC4122">RFC4122</a>]    Leach, P., Mealling, M., and R. Salz, "A Universally
                Unique IDentifier (UUID) URN Namespace", <a href="./rfc4122">RFC 4122</a>,
                DOI 10.17487/RFC4122, July 2005,
                &lt;<a href="https://www.rfc-editor.org/info/rfc4122">http://www.rfc-editor.org/info/rfc4122</a>&gt;.

   [<a id="ref-RFC5226">RFC5226</a>]    Narten, T. and H. Alvestrand, "Guidelines for Writing an
                IANA Considerations Section in RFCs", <a href="https://www.rfc-editor.org/bcp/bcp26">BCP 26</a>, <a href="./rfc5226">RFC 5226</a>,
                DOI 10.17487/RFC5226, May 2008,
                &lt;<a href="https://www.rfc-editor.org/info/rfc5226">http://www.rfc-editor.org/info/rfc5226</a>&gt;.

   [<a id="ref-RFC6211">RFC6211</a>]    Schaad, J., "Cryptographic Message Syntax (CMS)
                Algorithm Identifier Protection Attribute", <a href="./rfc6211">RFC 6211</a>,
                DOI 10.17487/RFC6211, April 2011,
                &lt;<a href="https://www.rfc-editor.org/info/rfc6211">http://www.rfc-editor.org/info/rfc6211</a>&gt;.

   [<a id="ref-RFC6838">RFC6838</a>]    Freed, N., Klensin, J., and T. Hansen, "Media Type
                Specifications and Registration Procedures", <a href="https://www.rfc-editor.org/bcp/bcp13">BCP 13</a>,
                <a href="./rfc6838">RFC 6838</a>, DOI 10.17487/RFC6838, January 2013,
                &lt;<a href="https://www.rfc-editor.org/info/rfc6838">http://www.rfc-editor.org/info/rfc6838</a>&gt;.

   [<a id="ref-RFC7525">RFC7525</a>]    Sheffer, Y., Holz, R., and P. Saint-Andre,
                "Recommendations for Secure Use of Transport Layer
                Security (TLS) and Datagram Transport Layer Security
                (DTLS)", <a href="https://www.rfc-editor.org/bcp/bcp195">BCP 195</a>, <a href="./rfc7525">RFC 7525</a>, DOI 10.17487/RFC7525, May
                2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7525">http://www.rfc-editor.org/info/rfc7525</a>&gt;.

   [<a id="ref-SHS">SHS</a>]        National Institute of Standards and Technology, "Secure
                Hash Standard (SHS)", FIPS PUB 180-4, March 2012,
                &lt;<a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf">http://csrc.nist.gov/publications/fips/fips180-4/</a>
                <a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf">fips-180-4.pdf</a>&gt;.

   [<a id="ref-W3C.NOTE-xmldsig-bestpractices-20130411">W3C.NOTE-xmldsig-bestpractices-20130411</a>]
                Hirsch, F. and P. Datta, "XML Signature Best Practices",
                World Wide Web Consortium Note
                NOTE-xmldsig-bestpractices-20130411, April 2013,
                &lt;<a href="http://www.w3.org/TR/2013/NOTE-xmldsig-bestpractices-20130411/">http://www.w3.org/TR/2013/</a>
                <a href="http://www.w3.org/TR/2013/NOTE-xmldsig-bestpractices-20130411/">NOTE-xmldsig-bestpractices-20130411/</a>&gt;.




<span class="grey">Jones, et al.                Standards Track                   [Page 35]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-36" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   [<a id="ref-W3C.NOTE-xmldsig-core2-20130411">W3C.NOTE-xmldsig-core2-20130411</a>]
                Eastlake, D., Reagle, J., Solo, D., Hirsch, F.,
                Roessler, T., Yiu, K., Datta, P., and S. Cantor, "XML
                Signature Syntax and Processing Version 2.0", World Wide
                Web Consortium Note NOTE-xmldsig-core2-20130411, April
                2013,
                &lt;<a href="http://www.w3.org/TR/2013/NOTE-xmldsig-core2-20130411/">http://www.w3.org/TR/2013/NOTE-xmldsig-core2-20130411/</a>&gt;.












































<span class="grey">Jones, et al.                Standards Track                   [Page 36]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-37" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h2"><a class="selflink" id="appendix-A" href="#appendix-A">Appendix A</a>.  JWS Examples</span>

   This section provides several examples of JWSs.  While the first
   three examples all represent JSON Web Tokens (JWTs) [<a href="#ref-JWT" title="&quot;JSON Web Token (JWT)&quot;">JWT</a>], the
   payload can be any octet sequence, as shown in <a href="#appendix-A.4">Appendix A.4</a>.

<span class="h3"><a class="selflink" id="appendix-A.1" href="#appendix-A.1">A.1</a>.  Example JWS Using HMAC SHA-256</span>

<span class="h4"><a class="selflink" id="appendix-A.1.1" href="#appendix-A.1.1">A.1.1</a>.  Encoding</span>

   The following example JWS Protected Header declares that the data
   structure is a JWT [<a href="#ref-JWT" title="&quot;JSON Web Token (JWT)&quot;">JWT</a>] and the JWS Signing Input is secured using
   the HMAC SHA-256 algorithm.

     {"typ":"JWT",
      "alg":"HS256"}

   To remove potential ambiguities in the representation of the JSON
   object above, the actual octet sequence representing UTF8(JWS
   Protected Header) used in this example is also included below.  (Note
   that ambiguities can arise due to differing platform representations
   of line breaks (CRLF versus LF), differing spacing at the beginning
   and ends of lines, whether the last line has a terminating line break
   or not, and other causes.  In the representation used in this
   example, the first line has no leading or trailing spaces, a CRLF
   line break (13, 10) occurs between the first and second lines, the
   second line has one leading space (32) and no trailing spaces, and
   the last line does not have a terminating line break.)  The octets
   representing UTF8(JWS Protected Header) in this example (using JSON
   array notation) are:

   [123, 34, 116, 121, 112, 34, 58, 34, 74, 87, 84, 34, 44, 13, 10, 32,
   34, 97, 108, 103, 34, 58, 34, 72, 83, 50, 53, 54, 34, 125]

   Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
   Header)) gives this value:

     eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9

   The JWS Payload used in this example is the octets of the UTF-8
   representation of the JSON object below.  (Note that the payload can
   be any base64url-encoded octet sequence and need not be a base64url-
   encoded JSON object.)

     {"iss":"joe",
      "exp":1300819380,
      "http://example.com/is_root":true}




<span class="grey">Jones, et al.                Standards Track                   [Page 37]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-38" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   The following octet sequence, which is the UTF-8 representation used
   in this example for the JSON object above, is the JWS Payload:

   [123, 34, 105, 115, 115, 34, 58, 34, 106, 111, 101, 34, 44, 13, 10,
   32, 34, 101, 120, 112, 34, 58, 49, 51, 48, 48, 56, 49, 57, 51, 56,
   48, 44, 13, 10, 32, 34, 104, 116, 116, 112, 58, 47, 47, 101, 120, 97,
   109, 112, 108, 101, 46, 99, 111, 109, 47, 105, 115, 95, 114, 111,
   111, 116, 34, 58, 116, 114, 117, 101, 125]

   Encoding this JWS Payload as BASE64URL(UTF8(JWS Payload)) gives this
   value (with line breaks for display purposes only):

     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ

   Combining these as BASE64URL(UTF8(JWS Protected Header)) || '.' ||
   BASE64URL(JWS Payload) gives this string (with line breaks for
   display purposes only):

     eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ

   The resulting JWS Signing Input value, which is the ASCII
   representation of above string, is the following octet sequence
   (using JSON array notation):

   [101, 121, 74, 48, 101, 88, 65, 105, 79, 105, 74, 75, 86, 49, 81,
   105, 76, 65, 48, 75, 73, 67, 74, 104, 98, 71, 99, 105, 79, 105, 74,
   73, 85, 122, 73, 49, 78, 105, 74, 57, 46, 101, 121, 74, 112, 99, 51,
   77, 105, 79, 105, 74, 113, 98, 50, 85, 105, 76, 65, 48, 75, 73, 67,
   74, 108, 101, 72, 65, 105, 79, 106, 69, 122, 77, 68, 65, 52, 77, 84,
   107, 122, 79, 68, 65, 115, 68, 81, 111, 103, 73, 109, 104, 48, 100,
   72, 65, 54, 76, 121, 57, 108, 101, 71, 70, 116, 99, 71, 120, 108, 76,
   109, 78, 118, 98, 83, 57, 112, 99, 49, 57, 121, 98, 50, 57, 48, 73,
   106, 112, 48, 99, 110, 86, 108, 102, 81]

   HMACs are generated using keys.  This example uses the symmetric key
   represented in JSON Web Key [<a href="#ref-JWK" title="&quot;JSON Web Key (JWK)&quot;">JWK</a>] format below (with line breaks
   within values for display purposes only):

     {"kty":"oct",
      "k":"AyM1SysPpbyDfgZld3umj1qzKObwVMkoqQ-EstJQLr_T-1qS0gZH75
           aKtMN3Yj0iPS4hcgUuTwjAzZr1Z9CAow"
     }





<span class="grey">Jones, et al.                Standards Track                   [Page 38]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-39" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Running the HMAC SHA-256 algorithm on the JWS Signing Input with this
   key yields this JWS Signature octet sequence:

   [116, 24, 223, 180, 151, 153, 224, 37, 79, 250, 96, 125, 216, 173,
   187, 186, 22, 212, 37, 77, 105, 214, 191, 240, 91, 88, 5, 88, 83,
   132, 141, 121]

   Encoding this JWS Signature as BASE64URL(JWS Signature) gives this
   value:

     dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk

   Concatenating these values in the order Header.Payload.Signature with
   period ('.') characters between the parts yields this complete JWS
   representation using the JWS Compact Serialization (with line breaks
   for display purposes only):

     eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ
     .
     dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk

<span class="h4"><a class="selflink" id="appendix-A.1.2" href="#appendix-A.1.2">A.1.2</a>.  Validating</span>

   Since the "alg" Header Parameter is "HS256", we validate the HMAC
   SHA-256 value contained in the JWS Signature.

   To validate the HMAC value, we repeat the previous process of using
   the correct key and the JWS Signing Input (which is the initial
   substring of the JWS Compact Serialization representation up until
   but not including the second period character) as input to the HMAC
   SHA-256 function and then taking the output and determining if it
   matches the JWS Signature (which is base64url decoded from the value
   encoded in the JWS representation).  If it matches exactly, the HMAC
   has been validated.

<span class="h3"><a class="selflink" id="appendix-A.2" href="#appendix-A.2">A.2</a>.  Example JWS Using RSASSA-PKCS1-v1_5 SHA-256</span>

<span class="h4"><a class="selflink" id="appendix-A.2.1" href="#appendix-A.2.1">A.2.1</a>.  Encoding</span>

   The JWS Protected Header in this example is different from the
   previous example in two ways.  First, because a different algorithm
   is being used, the "alg" value is different.  Second, for
   illustration purposes only, the optional "typ" (type) Header
   Parameter is not used.  (This difference is not related to the
   algorithm employed.)  The JWS Protected Header used is:



<span class="grey">Jones, et al.                Standards Track                   [Page 39]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-40" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


     {"alg":"RS256"}

   The octets representing UTF8(JWS Protected Header) in this example
   (using JSON array notation) are:

   [123, 34, 97, 108, 103, 34, 58, 34, 82, 83, 50, 53, 54, 34, 125]

   Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
   Header)) gives this value:

     eyJhbGciOiJSUzI1NiJ9

   The JWS Payload used in this example, which follows, is the same as
   in the previous example.  Since the BASE64URL(JWS Payload) value will
   therefore be the same, its computation is not repeated here.

     {"iss":"joe",
      "exp":1300819380,
      "http://example.com/is_root":true}

   Combining these as BASE64URL(UTF8(JWS Protected Header)) || '.' ||
   BASE64URL(JWS Payload) gives this string (with line breaks for
   display purposes only):

     eyJhbGciOiJSUzI1NiJ9
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ

   The resulting JWS Signing Input value, which is the ASCII
   representation of above string, is the following octet sequence:

   [101, 121, 74, 104, 98, 71, 99, 105, 79, 105, 74, 83, 85, 122, 73,
   49, 78, 105, 74, 57, 46, 101, 121, 74, 112, 99, 51, 77, 105, 79, 105,
   74, 113, 98, 50, 85, 105, 76, 65, 48, 75, 73, 67, 74, 108, 101, 72,
   65, 105, 79, 106, 69, 122, 77, 68, 65, 52, 77, 84, 107, 122, 79, 68,
   65, 115, 68, 81, 111, 103, 73, 109, 104, 48, 100, 72, 65, 54, 76,
   121, 57, 108, 101, 71, 70, 116, 99, 71, 120, 108, 76, 109, 78, 118,
   98, 83, 57, 112, 99, 49, 57, 121, 98, 50, 57, 48, 73, 106, 112, 48,
   99, 110, 86, 108, 102, 81]











<span class="grey">Jones, et al.                Standards Track                   [Page 40]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-41" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   This example uses the RSA key represented in JSON Web Key [<a href="#ref-JWK" title="&quot;JSON Web Key (JWK)&quot;">JWK</a>]
   format below (with line breaks within values for display purposes
   only):

     {"kty":"RSA",
      "n":"ofgWCuLjybRlzo0tZWJjNiuSfb4p4fAkd_wWJcyQoTbji9k0l8W26mPddx
           HmfHQp-Vaw-4qPCJrcS2mJPMEzP1Pt0Bm4d4QlL-yRT-SFd2lZS-pCgNMs
           D1W_YpRPEwOWvG6b32690r2jZ47soMZo9wGzjb_7OMg0LOL-bSf63kpaSH
           SXndS5z5rexMdbBYUsLA9e-KXBdQOS-UTo7WTBEMa2R2CapHg665xsmtdV
           MTBQY4uDZlxvb3qCo5ZwKh9kG4LT6_I5IhlJH7aGhyxXFvUK-DWNmoudF8
           NAco9_h9iaGNj8q2ethFkMLs91kzk2PAcDTW9gb54h4FRWyuXpoQ",
      "e":"AQAB",
      "d":"Eq5xpGnNCivDflJsRQBXHx1hdR1k6Ulwe2JZD50LpXyWPEAeP88vLNO97I
           jlA7_GQ5sLKMgvfTeXZx9SE-7YwVol2NXOoAJe46sui395IW_GO-pWJ1O0
           BkTGoVEn2bKVRUCgu-GjBVaYLU6f3l9kJfFNS3E0QbVdxzubSu3Mkqzjkn
           439X0M_V51gfpRLI9JYanrC4D4qAdGcopV_0ZHHzQlBjudU2QvXt4ehNYT
           CBr6XCLQUShb1juUO1ZdiYoFaFQT5Tw8bGUl_x_jTj3ccPDVZFD9pIuhLh
           BOneufuBiB4cS98l2SR_RQyGWSeWjnczT0QU91p1DhOVRuOopznQ",
      "p":"4BzEEOtIpmVdVEZNCqS7baC4crd0pqnRH_5IB3jw3bcxGn6QLvnEtfdUdi
           YrqBdss1l58BQ3KhooKeQTa9AB0Hw_Py5PJdTJNPY8cQn7ouZ2KKDcmnPG
           BY5t7yLc1QlQ5xHdwW1VhvKn-nXqhJTBgIPgtldC-KDV5z-y2XDwGUc",
      "q":"uQPEfgmVtjL0Uyyx88GZFF1fOunH3-7cepKmtH4pxhtCoHqpWmT8YAmZxa
           ewHgHAjLYsp1ZSe7zFYHj7C6ul7TjeLQeZD_YwD66t62wDmpe_HlB-TnBA
           -njbglfIsRLtXlnDzQkv5dTltRJ11BKBBypeeF6689rjcJIDEz9RWdc",
      "dp":"BwKfV3Akq5_MFZDFZCnW-wzl-CCo83WoZvnLQwCTeDv8uzluRSnm71I3Q
           CLdhrqE2e9YkxvuxdBfpT_PI7Yz-FOKnu1R6HsJeDCjn12Sk3vmAktV2zb
           34MCdy7cpdTh_YVr7tss2u6vneTwrA86rZtu5Mbr1C1XsmvkxHQAdYo0",
      "dq":"h_96-mK1R_7glhsum81dZxjTnYynPbZpHziZjeeHcXYsXaaMwkOlODsWa
           7I9xXDoRwbKgB719rrmI2oKr6N3Do9U0ajaHF-NKJnwgjMd2w9cjz3_-ky
           NlxAr2v4IKhGNpmM5iIgOS1VZnOZ68m6_pbLBSp3nssTdlqvd0tIiTHU",
      "qi":"IYd7DHOhrWvxkwPQsRM2tOgrjbcrfvtQJipd-DlcxyVuuM9sQLdgjVk2o
           y26F0EmpScGLq2MowX7fhd_QJQ3ydy5cY7YIBi87w93IKLEdfnbJtoOPLU
           W0ITrJReOgo1cq9SbsxYawBgfp_gh6A5603k2-ZQwVK0JKSHuLFkuQ3U"
     }

















<span class="grey">Jones, et al.                Standards Track                   [Page 41]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-42" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   The RSA private key is then passed to the RSA signing function, which
   also takes the hash type, SHA-256, and the JWS Signing Input as
   inputs.  The result of the digital signature is an octet sequence,
   which represents a big-endian integer.  In this example, it is:

   [112, 46, 33, 137, 67, 232, 143, 209, 30, 181, 216, 45, 191, 120, 69,
   243, 65, 6, 174, 27, 129, 255, 247, 115, 17, 22, 173, 209, 113, 125,
   131, 101, 109, 66, 10, 253, 60, 150, 238, 221, 115, 162, 102, 62, 81,
   102, 104, 123, 0, 11, 135, 34, 110, 1, 135, 237, 16, 115, 249, 69,
   229, 130, 173, 252, 239, 22, 216, 90, 121, 142, 232, 198, 109, 219,
   61, 184, 151, 91, 23, 208, 148, 2, 190, 237, 213, 217, 217, 112, 7,
   16, 141, 178, 129, 96, 213, 248, 4, 12, 167, 68, 87, 98, 184, 31,
   190, 127, 249, 217, 46, 10, 231, 111, 36, 242, 91, 51, 187, 230, 244,
   74, 230, 30, 177, 4, 10, 203, 32, 4, 77, 62, 249, 18, 142, 212, 1,
   48, 121, 91, 212, 189, 59, 65, 238, 202, 208, 102, 171, 101, 25, 129,
   253, 228, 141, 247, 127, 55, 45, 195, 139, 159, 175, 221, 59, 239,
   177, 139, 93, 163, 204, 60, 46, 176, 47, 158, 58, 65, 214, 18, 202,
   173, 21, 145, 18, 115, 160, 95, 35, 185, 232, 56, 250, 175, 132, 157,
   105, 132, 41, 239, 90, 30, 136, 121, 130, 54, 195, 212, 14, 96, 69,
   34, 165, 68, 200, 242, 122, 122, 45, 184, 6, 99, 209, 108, 247, 202,
   234, 86, 222, 64, 92, 178, 33, 90, 69, 178, 194, 85, 102, 181, 90,
   193, 167, 72, 160, 112, 223, 200, 163, 42, 70, 149, 67, 208, 25, 238,
   251, 71]

   Encoding the signature as BASE64URL(JWS Signature) produces this
   value (with line breaks for display purposes only):

     cC4hiUPoj9Eetdgtv3hF80EGrhuB__dzERat0XF9g2VtQgr9PJbu3XOiZj5RZmh7
     AAuHIm4Bh-0Qc_lF5YKt_O8W2Fp5jujGbds9uJdbF9CUAr7t1dnZcAcQjbKBYNX4
     BAynRFdiuB--f_nZLgrnbyTyWzO75vRK5h6xBArLIARNPvkSjtQBMHlb1L07Qe7K
     0GarZRmB_eSN9383LcOLn6_dO--xi12jzDwusC-eOkHWEsqtFZESc6BfI7noOPqv
     hJ1phCnvWh6IeYI2w9QOYEUipUTI8np6LbgGY9Fs98rqVt5AXLIhWkWywlVmtVrB
     p0igcN_IoypGlUPQGe77Rw


















<span class="grey">Jones, et al.                Standards Track                   [Page 42]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-43" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Concatenating these values in the order Header.Payload.Signature with
   period ('.') characters between the parts yields this complete JWS
   representation using the JWS Compact Serialization (with line breaks
   for display purposes only):

     eyJhbGciOiJSUzI1NiJ9
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ
     .
     cC4hiUPoj9Eetdgtv3hF80EGrhuB__dzERat0XF9g2VtQgr9PJbu3XOiZj5RZmh7
     AAuHIm4Bh-0Qc_lF5YKt_O8W2Fp5jujGbds9uJdbF9CUAr7t1dnZcAcQjbKBYNX4
     BAynRFdiuB--f_nZLgrnbyTyWzO75vRK5h6xBArLIARNPvkSjtQBMHlb1L07Qe7K
     0GarZRmB_eSN9383LcOLn6_dO--xi12jzDwusC-eOkHWEsqtFZESc6BfI7noOPqv
     hJ1phCnvWh6IeYI2w9QOYEUipUTI8np6LbgGY9Fs98rqVt5AXLIhWkWywlVmtVrB
     p0igcN_IoypGlUPQGe77Rw

<span class="h4"><a class="selflink" id="appendix-A.2.2" href="#appendix-A.2.2">A.2.2</a>.  Validating</span>

   Since the "alg" Header Parameter is "RS256", we validate the RSASSA-
   PKCS1-v1_5 SHA-256 digital signature contained in the JWS Signature.

   Validating the JWS Signature is a bit different from the previous
   example.  We pass the public key (n, e), the JWS Signature (which is
   base64url decoded from the value encoded in the JWS representation),
   and the JWS Signing Input (which is the initial substring of the JWS
   Compact Serialization representation up until but not including the
   second period character) to an RSASSA-PKCS1-v1_5 signature verifier
   that has been configured to use the SHA-256 hash function.

<span class="h3"><a class="selflink" id="appendix-A.3" href="#appendix-A.3">A.3</a>.  Example JWS Using ECDSA P-256 SHA-256</span>

<span class="h4"><a class="selflink" id="appendix-A.3.1" href="#appendix-A.3.1">A.3.1</a>.  Encoding</span>

   The JWS Protected Header for this example differs from the previous
   example because a different algorithm is being used.  The JWS
   Protected Header used is:

     {"alg":"ES256"}

   The octets representing UTF8(JWS Protected Header) in this example
   (using JSON array notation) are:

   [123, 34, 97, 108, 103, 34, 58, 34, 69, 83, 50, 53, 54, 34, 125]







<span class="grey">Jones, et al.                Standards Track                   [Page 43]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-44" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
   Header)) gives this value:

     eyJhbGciOiJFUzI1NiJ9

   The JWS Payload used in this example, which follows, is the same as
   in the previous examples.  Since the BASE64URL(JWS Payload) value
   will therefore be the same, its computation is not repeated here.

     {"iss":"joe",
      "exp":1300819380,
      "http://example.com/is_root":true}

   Combining these as BASE64URL(UTF8(JWS Protected Header)) || '.' ||
   BASE64URL(JWS Payload) gives this string (with line breaks for
   display purposes only):

     eyJhbGciOiJFUzI1NiJ9
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ

   The resulting JWS Signing Input value, which is the ASCII
   representation of above string, is the following octet sequence:

   [101, 121, 74, 104, 98, 71, 99, 105, 79, 105, 74, 70, 85, 122, 73,
   49, 78, 105, 74, 57, 46, 101, 121, 74, 112, 99, 51, 77, 105, 79, 105,
   74, 113, 98, 50, 85, 105, 76, 65, 48, 75, 73, 67, 74, 108, 101, 72,
   65, 105, 79, 106, 69, 122, 77, 68, 65, 52, 77, 84, 107, 122, 79, 68,
   65, 115, 68, 81, 111, 103, 73, 109, 104, 48, 100, 72, 65, 54, 76,
   121, 57, 108, 101, 71, 70, 116, 99, 71, 120, 108, 76, 109, 78, 118,
   98, 83, 57, 112, 99, 49, 57, 121, 98, 50, 57, 48, 73, 106, 112, 48,
   99, 110, 86, 108, 102, 81]

   This example uses the Elliptic Curve key represented in JSON Web Key
   [<a href="#ref-JWK" title="&quot;JSON Web Key (JWK)&quot;">JWK</a>] format below:

     {"kty":"EC",
      "crv":"P-256",
      "x":"f83OJ3D2xF1Bg8vub9tLe1gHMzV76e8Tus9uPHvRVEU",
      "y":"x_FEzRu9m36HLN_tue659LNpXW6pCyStikYjKIWI5a0",
      "d":"jpsQnnGQmL-YBIffH1136cspYG6-0iY7X1fCE9-E9LI"
     }

   The Elliptic Curve Digital Signature Algorithm (ECDSA) private part d
   is then passed to an ECDSA signing function, which also takes the
   curve type, P-256, the hash type, SHA-256, and the JWS Signing Input
   as inputs.  The result of the digital signature is the Elliptic Curve



<span class="grey">Jones, et al.                Standards Track                   [Page 44]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-45" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   (EC) point (R, S), where R and S are unsigned integers.  In this
   example, the R and S values, given as octet sequences representing
   big-endian integers are:

   +--------+----------------------------------------------------------+
   | Result | Value                                                    |
   | Name   |                                                          |
   +--------+----------------------------------------------------------+
   | R      | [14, 209, 33, 83, 121, 99, 108, 72, 60, 47, 127, 21, 88, |
   |        | 7, 212, 2, 163, 178, 40, 3, 58, 249, 124, 126, 23, 129,  |
   |        | 154, 195, 22, 158, 166, 101]                             |
   | S      | [197, 10, 7, 211, 140, 60, 112, 229, 216, 241, 45, 175,  |
   |        | 8, 74, 84, 128, 166, 101, 144, 197, 242, 147, 80, 154,   |
   |        | 143, 63, 127, 138, 131, 163, 84, 213]                    |
   +--------+----------------------------------------------------------+

   The JWS Signature is the value R || S.  Encoding the signature as
   BASE64URL(JWS Signature) produces this value (with line breaks for
   display purposes only):

     DtEhU3ljbEg8L38VWAfUAqOyKAM6-Xx-F4GawxaepmXFCgfTjDxw5djxLa8ISlSA
     pmWQxfKTUJqPP3-Kg6NU1Q

   Concatenating these values in the order Header.Payload.Signature with
   period ('.') characters between the parts yields this complete JWS
   representation using the JWS Compact Serialization (with line breaks
   for display purposes only):

     eyJhbGciOiJFUzI1NiJ9
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ
     .
     DtEhU3ljbEg8L38VWAfUAqOyKAM6-Xx-F4GawxaepmXFCgfTjDxw5djxLa8ISlSA
     pmWQxfKTUJqPP3-Kg6NU1Q

<span class="h4"><a class="selflink" id="appendix-A.3.2" href="#appendix-A.3.2">A.3.2</a>.  Validating</span>

   Since the "alg" Header Parameter is "ES256", we validate the ECDSA
   P-256 SHA-256 digital signature contained in the JWS Signature.

   Validating the JWS Signature is a bit different from the previous
   examples.  We need to split the 64 member octet sequence of the JWS
   Signature (which is base64url decoded from the value encoded in the
   JWS representation) into two 32 octet sequences, the first
   representing R and the second S.  We then pass the public key (x, y),
   the signature (R, S), and the JWS Signing Input (which is the initial
   substring of the JWS Compact Serialization representation up until



<span class="grey">Jones, et al.                Standards Track                   [Page 45]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-46" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   but not including the second period character) to an ECDSA signature
   verifier that has been configured to use the P-256 curve with the
   SHA-256 hash function.

<span class="h3"><a class="selflink" id="appendix-A.4" href="#appendix-A.4">A.4</a>.  Example JWS Using ECDSA P-521 SHA-512</span>

<span class="h4"><a class="selflink" id="appendix-A.4.1" href="#appendix-A.4.1">A.4.1</a>.  Encoding</span>

   The JWS Protected Header for this example differs from the previous
   example because different ECDSA curves and hash functions are used.
   The JWS Protected Header used is:

     {"alg":"ES512"}

   The octets representing UTF8(JWS Protected Header) in this example
   (using JSON array notation) are:

   [123, 34, 97, 108, 103, 34, 58, 34, 69, 83, 53, 49, 50, 34, 125]

   Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
   Header)) gives this value:

     eyJhbGciOiJFUzUxMiJ9

   The JWS Payload used in this example is the ASCII string "Payload".
   The representation of this string is the following octet sequence:

   [80, 97, 121, 108, 111, 97, 100]

   Encoding this JWS Payload as BASE64URL(JWS Payload) gives this value:

     UGF5bG9hZA

   Combining these as BASE64URL(UTF8(JWS Protected Header)) || '.' ||
   BASE64URL(JWS Payload) gives this string:

     eyJhbGciOiJFUzUxMiJ9.UGF5bG9hZA

   The resulting JWS Signing Input value, which is the ASCII
   representation of above string, is the following octet sequence:

   [101, 121, 74, 104, 98, 71, 99, 105, 79, 105, 74, 70, 85, 122, 85,
   120, 77, 105, 74, 57, 46, 85, 71, 70, 53, 98, 71, 57, 104, 90, 65]








<span class="grey">Jones, et al.                Standards Track                   [Page 46]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-47" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   This example uses the Elliptic Curve key represented in JSON Web Key
   [<a href="#ref-JWK" title="&quot;JSON Web Key (JWK)&quot;">JWK</a>] format below (with line breaks within values for display
   purposes only):

     {"kty":"EC",
      "crv":"P-521",
      "x":"AekpBQ8ST8a8VcfVOTNl353vSrDCLLJXmPk06wTjxrrjcBpXp5EOnYG_
           NjFZ6OvLFV1jSfS9tsz4qUxcWceqwQGk",
      "y":"ADSmRA43Z1DSNx_RvcLI87cdL07l6jQyyBXMoxVg_l2Th-x3S1WDhjDl
           y79ajL4Kkd0AZMaZmh9ubmf63e3kyMj2",
      "d":"AY5pb7A0UFiB3RELSD64fTLOSV_jazdF7fLYyuTw8lOfRhWg6Y6rUrPA
           xerEzgdRhajnu0ferB0d53vM9mE15j2C"
     }

   The ECDSA private part d is then passed to an ECDSA signing function,
   which also takes the curve type, P-521, the hash type, SHA-512, and
   the JWS Signing Input as inputs.  The result of the digital signature
   is the EC point (R, S), where R and S are unsigned integers.  In this
   example, the R and S values, given as octet sequences representing
   big-endian integers are:

   +--------+----------------------------------------------------------+
   | Result | Value                                                    |
   | Name   |                                                          |
   +--------+----------------------------------------------------------+
   | R      | [1, 220, 12, 129, 231, 171, 194, 209, 232, 135, 233,     |
   |        | 117, 247, 105, 122, 210, 26, 125, 192, 1, 217, 21, 82,   |
   |        | 91, 45, 240, 255, 83, 19, 34, 239, 71, 48, 157, 147,     |
   |        | 152, 105, 18, 53, 108, 163, 214, 68, 231, 62, 153, 150,  |
   |        | 106, 194, 164, 246, 72, 143, 138, 24, 50, 129, 223, 133, |
   |        | 206, 209, 172, 63, 237, 119, 109]                        |
   | S      | [0, 111, 6, 105, 44, 5, 41, 208, 128, 61, 152, 40, 92,   |
   |        | 61, 152, 4, 150, 66, 60, 69, 247, 196, 170, 81, 193,     |
   |        | 199, 78, 59, 194, 169, 16, 124, 9, 143, 42, 142, 131,    |
   |        | 48, 206, 238, 34, 175, 83, 203, 220, 159, 3, 107, 155,   |
   |        | 22, 27, 73, 111, 68, 68, 21, 238, 144, 229, 232, 148,    |
   |        | 188, 222, 59, 242, 103]                                  |
   +--------+----------------------------------------------------------+

   The JWS Signature is the value R || S.  Encoding the signature as
   BASE64URL(JWS Signature) produces this value (with line breaks for
   display purposes only):

     AdwMgeerwtHoh-l192l60hp9wAHZFVJbLfD_UxMi70cwnZOYaRI1bKPWROc-mZZq
     wqT2SI-KGDKB34XO0aw_7XdtAG8GaSwFKdCAPZgoXD2YBJZCPEX3xKpRwcdOO8Kp
     EHwJjyqOgzDO7iKvU8vcnwNrmxYbSW9ERBXukOXolLzeO_Jn





<span class="grey">Jones, et al.                Standards Track                   [Page 47]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-48" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Concatenating these values in the order Header.Payload.Signature with
   period ('.') characters between the parts yields this complete JWS
   representation using the JWS Compact Serialization (with line breaks
   for display purposes only):

     eyJhbGciOiJFUzUxMiJ9
     .
     UGF5bG9hZA
     .
     AdwMgeerwtHoh-l192l60hp9wAHZFVJbLfD_UxMi70cwnZOYaRI1bKPWROc-mZZq
     wqT2SI-KGDKB34XO0aw_7XdtAG8GaSwFKdCAPZgoXD2YBJZCPEX3xKpRwcdOO8Kp
     EHwJjyqOgzDO7iKvU8vcnwNrmxYbSW9ERBXukOXolLzeO_Jn

<span class="h4"><a class="selflink" id="appendix-A.4.2" href="#appendix-A.4.2">A.4.2</a>.  Validating</span>

   Since the "alg" Header Parameter is "ES512", we validate the ECDSA
   P-521 SHA-512 digital signature contained in the JWS Signature.

   Validating this JWS Signature is very similar to the previous
   example.  We need to split the 132-member octet sequence of the JWS
   Signature into two 66-octet sequences, the first representing R and
   the second S.  We then pass the public key (x, y), the signature (R,
   S), and the JWS Signing Input to an ECDSA signature verifier that has
   been configured to use the P-521 curve with the SHA-512 hash
   function.

<span class="h3"><a class="selflink" id="appendix-A.5" href="#appendix-A.5">A.5</a>.  Example Unsecured JWS</span>

   The following example JWS Protected Header declares that the encoded
   object is an Unsecured JWS:

     {"alg":"none"}

   Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
   Header)) gives this value:

     eyJhbGciOiJub25lIn0

   The JWS Payload used in this example, which follows, is the same as
   in the previous examples.  Since the BASE64URL(JWS Payload) value
   will therefore be the same, its computation is not repeated here.

     {"iss":"joe",
      "exp":1300819380,
      "http://example.com/is_root":true}

   The JWS Signature is the empty octet string and BASE64URL(JWS
   Signature) is the empty string.



<span class="grey">Jones, et al.                Standards Track                   [Page 48]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-49" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Concatenating these values in the order Header.Payload.Signature with
   period ('.') characters between the parts yields this complete JWS
   representation using the JWS Compact Serialization (with line breaks
   for display purposes only):

     eyJhbGciOiJub25lIn0
     .
     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ
     .

<span class="h3"><a class="selflink" id="appendix-A.6" href="#appendix-A.6">A.6</a>.  Example JWS Using General JWS JSON Serialization</span>

   This section contains an example using the general JWS JSON
   Serialization syntax.  This example demonstrates the capability for
   conveying multiple digital signatures and/or MACs for the same
   payload.

   The JWS Payload used in this example is the same as that used in the
   examples in <a href="#appendix-A.2">Appendix A.2</a> and <a href="#appendix-A.3">Appendix A.3</a> (with line breaks for
   display purposes only):

     eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
     cGxlLmNvbS9pc19yb290Ijp0cnVlfQ

   Two digital signatures are used in this example: the first using
   RSASSA-PKCS1-v1_5 SHA-256 and the second using ECDSA P-256 SHA-256.
   For the first, the JWS Protected Header and key are the same as in
   <a href="#appendix-A.2">Appendix A.2</a>, resulting in the same JWS Signature value; therefore,
   its computation is not repeated here.  For the second, the JWS
   Protected Header and key are the same as in <a href="#appendix-A.3">Appendix A.3</a>, resulting
   in the same JWS Signature value; therefore, its computation is not
   repeated here.

<span class="h4"><a class="selflink" id="appendix-A.6.1" href="#appendix-A.6.1">A.6.1</a>.  JWS Per-Signature Protected Headers</span>

   The JWS Protected Header value used for the first signature is:

     {"alg":"RS256"}

   Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
   Header)) gives this value:

     eyJhbGciOiJSUzI1NiJ9

   The JWS Protected Header value used for the second signature is:

     {"alg":"ES256"}



<span class="grey">Jones, et al.                Standards Track                   [Page 49]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-50" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
   Header)) gives this value:

     eyJhbGciOiJFUzI1NiJ9

<span class="h4"><a class="selflink" id="appendix-A.6.2" href="#appendix-A.6.2">A.6.2</a>.  JWS Per-Signature Unprotected Headers</span>

   Key ID values are supplied for both keys using per-signature Header
   Parameters.  The two JWS Unprotected Header values used to represent
   these key IDs are:

     {"kid":"2010-12-29"}

   and

     {"kid":"e9bc097a-ce51-4036-9562-d2ade882db0d"}

<span class="h4"><a class="selflink" id="appendix-A.6.3" href="#appendix-A.6.3">A.6.3</a>.  Complete JOSE Header Values</span>

   Combining the JWS Protected Header and JWS Unprotected Header values
   supplied, the JOSE Header values used for the first and second
   signatures, respectively, are:

     {"alg":"RS256",
      "kid":"2010-12-29"}

   and

     {"alg":"ES256",
      "kid":"e9bc097a-ce51-4036-9562-d2ade882db0d"}





















<span class="grey">Jones, et al.                Standards Track                   [Page 50]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-51" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h4"><a class="selflink" id="appendix-A.6.4" href="#appendix-A.6.4">A.6.4</a>.  Complete JWS JSON Serialization Representation</span>

   The complete JWS JSON Serialization for these values is as follows
   (with line breaks within values for display purposes only):

     {
      "payload":
       "eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGF
        tcGxlLmNvbS9pc19yb290Ijp0cnVlfQ",
      "signatures":[
       {"protected":"eyJhbGciOiJSUzI1NiJ9",
        "header":
         {"kid":"2010-12-29"},
        "signature":
         "cC4hiUPoj9Eetdgtv3hF80EGrhuB__dzERat0XF9g2VtQgr9PJbu3XOiZj5RZ
          mh7AAuHIm4Bh-0Qc_lF5YKt_O8W2Fp5jujGbds9uJdbF9CUAr7t1dnZcAcQjb
          KBYNX4BAynRFdiuB--f_nZLgrnbyTyWzO75vRK5h6xBArLIARNPvkSjtQBMHl
          b1L07Qe7K0GarZRmB_eSN9383LcOLn6_dO--xi12jzDwusC-eOkHWEsqtFZES
          c6BfI7noOPqvhJ1phCnvWh6IeYI2w9QOYEUipUTI8np6LbgGY9Fs98rqVt5AX
          LIhWkWywlVmtVrBp0igcN_IoypGlUPQGe77Rw"},
       {"protected":"eyJhbGciOiJFUzI1NiJ9",
        "header":
         {"kid":"e9bc097a-ce51-4036-9562-d2ade882db0d"},
        "signature":
         "DtEhU3ljbEg8L38VWAfUAqOyKAM6-Xx-F4GawxaepmXFCgfTjDxw5djxLa8IS
          lSApmWQxfKTUJqPP3-Kg6NU1Q"}]
     }
























<span class="grey">Jones, et al.                Standards Track                   [Page 51]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-52" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h3"><a class="selflink" id="appendix-A.7" href="#appendix-A.7">A.7</a>.  Example JWS Using Flattened JWS JSON Serialization</span>

   This section contains an example using the flattened JWS JSON
   Serialization syntax.  This example demonstrates the capability for
   conveying a single digital signature or MAC in a flattened JSON
   structure.

   The values in this example are the same as those in the second
   signature of the previous example in <a href="#appendix-A.6">Appendix A.6</a>.

   The complete JWS JSON Serialization for these values is as follows
   (with line breaks within values for display purposes only):

     {
      "payload":
       "eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGF
        tcGxlLmNvbS9pc19yb290Ijp0cnVlfQ",
      "protected":"eyJhbGciOiJFUzI1NiJ9",
      "header":
       {"kid":"e9bc097a-ce51-4036-9562-d2ade882db0d"},
      "signature":
       "DtEhU3ljbEg8L38VWAfUAqOyKAM6-Xx-F4GawxaepmXFCgfTjDxw5djxLa8IS
        lSApmWQxfKTUJqPP3-Kg6NU1Q"
     }



























<span class="grey">Jones, et al.                Standards Track                   [Page 52]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-53" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h2"><a class="selflink" id="appendix-B" href="#appendix-B">Appendix B</a>.  "x5c" (X.509 Certificate Chain) Example</span>

   The JSON array below is an example of a certificate chain that could
   be used as the value of an "x5c" (X.509 certificate chain) Header
   Parameter, per <a href="#section-4.1.6">Section 4.1.6</a> (with line breaks within values for
   display purposes only):

     ["MIIE3jCCA8agAwIBAgICAwEwDQYJKoZIhvcNAQEFBQAwYzELMAkGA1UEBhMCVVM
       xITAfBgNVBAoTGFRoZSBHbyBEYWRkeSBHcm91cCwgSW5jLjExMC8GA1UECxMoR2
       8gRGFkZHkgQ2xhc3MgMiBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTAeFw0wNjExM
       TYwMTU0MzdaFw0yNjExMTYwMTU0MzdaMIHKMQswCQYDVQQGEwJVUzEQMA4GA1UE
       CBMHQXJpem9uYTETMBEGA1UEBxMKU2NvdHRzZGFsZTEaMBgGA1UEChMRR29EYWR
       keS5jb20sIEluYy4xMzAxBgNVBAsTKmh0dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYW
       RkeS5jb20vcmVwb3NpdG9yeTEwMC4GA1UEAxMnR28gRGFkZHkgU2VjdXJlIENlc
       nRpZmljYXRpb24gQXV0aG9yaXR5MREwDwYDVQQFEwgwNzk2OTI4NzCCASIwDQYJ
       KoZIhvcNAQEBBQADggEPADCCAQoCggEBAMQt1RWMnCZM7DI161+4WQFapmGBWTt
       wY6vj3D3HKrjJM9N55DrtPDAjhI6zMBS2sofDPZVUBJ7fmd0LJR4h3mUpfjWoqV
       Tr9vcyOdQmVZWt7/v+WIbXnvQAjYwqDL1CBM6nPwT27oDyqu9SoWlm2r4arV3aL
       GbqGmu75RpRSgAvSMeYddi5Kcju+GZtCpyz8/x4fKL4o/K1w/O5epHBp+YlLpyo
       7RJlbmr2EkRTcDCVw5wrWCs9CHRK8r5RsL+H0EwnWGu1NcWdrxcx+AuP7q2BNgW
       JCJjPOq8lh8BJ6qf9Z/dFjpfMFDniNoW1fho3/Rb2cRGadDAW/hOUoz+EDU8CAw
       EAAaOCATIwggEuMB0GA1UdDgQWBBT9rGEyk2xF1uLuhV+auud2mWjM5zAfBgNVH
       SMEGDAWgBTSxLDSkdRMEXGzYcs9of7dqGrU4zASBgNVHRMBAf8ECDAGAQH/AgEA
       MDMGCCsGAQUFBwEBBCcwJTAjBggrBgEFBQcwAYYXaHR0cDovL29jc3AuZ29kYWR
       keS5jb20wRgYDVR0fBD8wPTA7oDmgN4Y1aHR0cDovL2NlcnRpZmljYXRlcy5nb2
       RhZGR5LmNvbS9yZXBvc2l0b3J5L2dkcm9vdC5jcmwwSwYDVR0gBEQwQjBABgRVH
       SAAMDgwNgYIKwYBBQUHAgEWKmh0dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5j
       b20vcmVwb3NpdG9yeTAOBgNVHQ8BAf8EBAMCAQYwDQYJKoZIhvcNAQEFBQADggE
       BANKGwOy9+aG2Z+5mC6IGOgRQjhVyrEp0lVPLN8tESe8HkGsz2ZbwlFalEzAFPI
       UyIXvJxwqoJKSQ3kbTJSMUA2fCENZvD117esyfxVgqwcSeIaha86ykRvOe5GPLL
       5CkKSkB2XIsKd83ASe8T+5o0yGPwLPk9Qnt0hCqU7S+8MxZC9Y7lhyVJEnfzuz9
       p0iRFEUOOjZv2kWzRaJBydTXRE4+uXR21aITVSzGh6O1mawGhId/dQb8vxRMDsx
       uxN89txJx9OjxUUAiKEngHUuHqDTMBqLdElrRhjZkAzVvb3du6/KFUJheqwNTrZ
       EjYx8WnM25sgVjOuH0aBsXBTWVU+4=",
      "MIIE+zCCBGSgAwIBAgICAQ0wDQYJKoZIhvcNAQEFBQAwgbsxJDAiBgNVBAcTG1Z
       hbGlDZXJ0IFZhbGlkYXRpb24gTmV0d29yazEXMBUGA1UEChMOVmFsaUNlcnQsIE
       luYy4xNTAzBgNVBAsTLFZhbGlDZXJ0IENsYXNzIDIgUG9saWN5IFZhbGlkYXRpb
       24gQXV0aG9yaXR5MSEwHwYDVQQDExhodHRwOi8vd3d3LnZhbGljZXJ0LmNvbS8x
       IDAeBgkqhkiG9w0BCQEWEWluZm9AdmFsaWNlcnQuY29tMB4XDTA0MDYyOTE3MDY
       yMFoXDTI0MDYyOTE3MDYyMFowYzELMAkGA1UEBhMCVVMxITAfBgNVBAoTGFRoZS
       BHbyBEYWRkeSBHcm91cCwgSW5jLjExMC8GA1UECxMoR28gRGFkZHkgQ2xhc3MgM
       iBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTCCASAwDQYJKoZIhvcNAQEBBQADggEN
       ADCCAQgCggEBAN6d1+pXGEmhW+vXX0iG6r7d/+TvZxz0ZWizV3GgXne77ZtJ6XC
       APVYYYwhv2vLM0D9/AlQiVBDYsoHUwHU9S3/Hd8M+eKsaA7Ugay9qK7HFiH7Eux
       6wwdhFJ2+qN1j3hybX2C32qRe3H3I2TqYXP2WYktsqbl2i/ojgC95/5Y0V4evLO
       tXiEqITLdiOr18SPaAIBQi2XKVlOARFmR6jYGB0xUGlcmIbYsUfb18aQr4CUWWo
       riMYavx4A6lNf4DD+qta/KFApMoZFv6yyO9ecw3ud72a9nmYvLEHZ6IVDd2gWMZ
       Eewo+YihfukEHU1jPEX44dMX4/7VpkI+EdOqXG68CAQOjggHhMIIB3TAdBgNVHQ



<span class="grey">Jones, et al.                Standards Track                   [Page 53]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-54" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


       4EFgQU0sSw0pHUTBFxs2HLPaH+3ahq1OMwgdIGA1UdIwSByjCBx6GBwaSBvjCBu
       zEkMCIGA1UEBxMbVmFsaUNlcnQgVmFsaWRhdGlvbiBOZXR3b3JrMRcwFQYDVQQK
       Ew5WYWxpQ2VydCwgSW5jLjE1MDMGA1UECxMsVmFsaUNlcnQgQ2xhc3MgMiBQb2x
       pY3kgVmFsaWRhdGlvbiBBdXRob3JpdHkxITAfBgNVBAMTGGh0dHA6Ly93d3cudm
       FsaWNlcnQuY29tLzEgMB4GCSqGSIb3DQEJARYRaW5mb0B2YWxpY2VydC5jb22CA
       QEwDwYDVR0TAQH/BAUwAwEB/zAzBggrBgEFBQcBAQQnMCUwIwYIKwYBBQUHMAGG
       F2h0dHA6Ly9vY3NwLmdvZGFkZHkuY29tMEQGA1UdHwQ9MDswOaA3oDWGM2h0dHA
       6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS9yb290LmNybD
       BLBgNVHSAERDBCMEAGBFUdIAAwODA2BggrBgEFBQcCARYqaHR0cDovL2NlcnRpZ
       mljYXRlcy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5MA4GA1UdDwEB/wQEAwIBBjAN
       BgkqhkiG9w0BAQUFAAOBgQC1QPmnHfbq/qQaQlpE9xXUhUaJwL6e4+PrxeNYiY+
       Sn1eocSxI0YGyeR+sBjUZsE4OWBsUs5iB0QQeyAfJg594RAoYC5jcdnplDQ1tgM
       QLARzLrUc+cb53S8wGd9D0VmsfSxOaFIqII6hR8INMqzW/Rn453HWkrugp++85j
       09VZw==",
      "MIIC5zCCAlACAQEwDQYJKoZIhvcNAQEFBQAwgbsxJDAiBgNVBAcTG1ZhbGlDZXJ
       0IFZhbGlkYXRpb24gTmV0d29yazEXMBUGA1UEChMOVmFsaUNlcnQsIEluYy4xNT
       AzBgNVBAsTLFZhbGlDZXJ0IENsYXNzIDIgUG9saWN5IFZhbGlkYXRpb24gQXV0a
       G9yaXR5MSEwHwYDVQQDExhodHRwOi8vd3d3LnZhbGljZXJ0LmNvbS8xIDAeBgkq
       hkiG9w0BCQEWEWluZm9AdmFsaWNlcnQuY29tMB4XDTk5MDYyNjAwMTk1NFoXDTE
       5MDYyNjAwMTk1NFowgbsxJDAiBgNVBAcTG1ZhbGlDZXJ0IFZhbGlkYXRpb24gTm
       V0d29yazEXMBUGA1UEChMOVmFsaUNlcnQsIEluYy4xNTAzBgNVBAsTLFZhbGlDZ
       XJ0IENsYXNzIDIgUG9saWN5IFZhbGlkYXRpb24gQXV0aG9yaXR5MSEwHwYDVQQD
       ExhodHRwOi8vd3d3LnZhbGljZXJ0LmNvbS8xIDAeBgkqhkiG9w0BCQEWEWluZm9
       AdmFsaWNlcnQuY29tMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDOOnHK5a
       vIWZJV16vYdA757tn2VUdZZUcOBVXc65g2PFxTXdMwzzjsvUGJ7SVCCSRrCl6zf
       N1SLUzm1NZ9WlmpZdRJEy0kTRxQb7XBhVQ7/nHk01xC+YDgkRoKWzk2Z/M/VXwb
       P7RfZHM047QSv4dk+NoS/zcnwbNDu+97bi5p9wIDAQABMA0GCSqGSIb3DQEBBQU
       AA4GBADt/UG9vUJSZSWI4OB9L+KXIPqeCgfYrx+jFzug6EILLGACOTb2oWH+heQ
       C1u+mNr0HZDzTuIYEZoDJJKPTEjlbVUjP9UNV+mWwD5MlM/Mtsq2azSiGM5bUMM
       j4QssxsodyamEwCW/POuZ6lcg5Ktz885hZo+L7tdEy8W9ViH0Pd"]





















<span class="grey">Jones, et al.                Standards Track                   [Page 54]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-55" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h2"><a class="selflink" id="appendix-C" href="#appendix-C">Appendix C</a>.  Notes on Implementing base64url Encoding without Padding</span>

   This appendix describes how to implement base64url encoding and
   decoding functions without padding based upon standard base64
   encoding and decoding functions that do use padding.

   To be concrete, example C# code implementing these functions is shown
   below.  Similar code could be used in other languages.

     static string base64urlencode(byte [] arg)
     {
       string s = Convert.ToBase64String(arg); // Regular base64 encoder
       s = s.Split('=')[0]; // Remove any trailing '='s
       s = s.Replace('+', '-'); // 62nd char of encoding
       s = s.Replace('/', '_'); // 63rd char of encoding
       return s;
     }

     static byte [] base64urldecode(string arg)
     {
       string s = arg;
       s = s.Replace('-', '+'); // 62nd char of encoding
       s = s.Replace('_', '/'); // 63rd char of encoding
       switch (s.Length % 4) // Pad with trailing '='s
       {
         case 0: break; // No pad chars in this case
         case 2: s += "=="; break; // Two pad chars
         case 3: s += "="; break; // One pad char
         default: throw new System.Exception(
           "Illegal base64url string!");
       }
       return Convert.FromBase64String(s); // Standard base64 decoder
     }

   As per the example code above, the number of '=' padding characters
   that needs to be added to the end of a base64url-encoded string
   without padding to turn it into one with padding is a deterministic
   function of the length of the encoded string.  Specifically, if the
   length mod 4 is 0, no padding is added; if the length mod 4 is 2, two
   '=' padding characters are added; if the length mod 4 is 3, one '='
   padding character is added; if the length mod 4 is 1, the input is
   malformed.









<span class="grey">Jones, et al.                Standards Track                   [Page 55]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-56" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


   An example correspondence between unencoded and encoded values
   follows.  The octet sequence below encodes into the string below,
   which when decoded, reproduces the octet sequence.

   3 236 255 224 193
   A-z_4ME

<span class="h2"><a class="selflink" id="appendix-D" href="#appendix-D">Appendix D</a>.  Notes on Key Selection</span>

   This appendix describes a set of possible algorithms for selecting
   the key to be used to validate the digital signature or MAC of a JWS
   or for selecting the key to be used to decrypt a JWE.  This guidance
   describes a family of possible algorithms rather than a single
   algorithm, because in different contexts, not all the sources of keys
   will be used, they can be tried in different orders, and sometimes
   not all the collected keys will be tried; hence, different algorithms
   will be used in different application contexts.

   The steps below are described for illustration purposes only;
   specific applications can and are likely to use different algorithms
   or perform some of the steps in different orders.  Specific
   applications will frequently have a much simpler method of
   determining the keys to use, as there may be one or two key selection
   methods that are profiled for the application's use.  This appendix
   supplements the normative information on key location in <a href="#section-6">Section 6</a>.

   These algorithms include the following steps.  Note that the steps
   can be performed in any order and do not need to be treated as
   distinct.  For example, keys can be tried as soon as they are found,
   rather than collecting all the keys before trying any.

   1.  Collect the set of potentially applicable keys.  Sources of keys
       may include:

       *  Keys supplied by the application protocol being used.

       *  Keys referenced by the "jku" (JWK Set URL) Header Parameter.

       *  The key provided by the "jwk" (JSON Web Key) Header Parameter.

       *  The key referenced by the "x5u" (X.509 URL) Header Parameter.

       *  The key provided by the "x5c" (X.509 certificate chain) Header
          Parameter.

       *  Other applicable keys available to the application.





<span class="grey">Jones, et al.                Standards Track                   [Page 56]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-57" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


       The order for collecting and trying keys from different key
       sources is typically application dependent.  For example,
       frequently, all keys from a one set of locations, such as local
       caches, will be tried before collecting and trying keys from
       other locations.

   2.  Filter the set of collected keys.  For instance, some
       applications will use only keys referenced by "kid" (key ID) or
       "x5t" (X.509 certificate SHA-1 thumbprint) parameters.  If the
       application uses the JWK "alg" (algorithm), "use" (public key
       use), or "key_ops" (key operations) parameters, keys with
       inappropriate values of those parameters would be excluded.
       Additionally, keys might be filtered to include or exclude keys
       with certain other member values in an application-specific
       manner.  For some applications, no filtering will be applied.

   3.  Order the set of collected keys.  For instance, keys referenced
       by "kid" (key ID) or "x5t" (X.509 certificate SHA-1 thumbprint)
       parameters might be tried before keys with neither of these
       values.  Likewise, keys with certain member values might be
       ordered before keys with other member values.  For some
       applications, no ordering will be applied.

   4.  Make trust decisions about the keys.  Signatures made with keys
       not meeting the application's trust criteria would not be
       accepted.  Such criteria might include, but is not limited to,
       the source of the key, whether the TLS certificate validates for
       keys retrieved from URLs, whether a key in an X.509 certificate
       is backed by a valid certificate chain, and other information
       known by the application.

   5.  Attempt signature or MAC validation for a JWS or decryption of a
       JWE with some or all of the collected and possibly filtered and/
       or ordered keys.  A limit on the number of keys to be tried might
       be applied.  This process will normally terminate following a
       successful validation or decryption.

   Note that it is reasonable for some applications to perform signature
   or MAC validation prior to making a trust decision about a key, since
   keys for which the validation fails need no trust decision.











<span class="grey">Jones, et al.                Standards Track                   [Page 57]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-58" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


<span class="h2"><a class="selflink" id="appendix-E" href="#appendix-E">Appendix E</a>.  Negative Test Case for "crit" Header Parameter</span>

   Conforming implementations must reject input containing critical
   extensions that are not understood or cannot be processed.  The
   following JWS must be rejected by all implementations, because it
   uses an extension Header Parameter name "<a href="http://example.invalid/UNDEFINED">http://example.invalid/</a>
   <a href="http://example.invalid/UNDEFINED">UNDEFINED</a>" that they do not understand.  Any other similar input, in
   which the use of the value "<a href="http://example.invalid/UNDEFINED">http://example.invalid/UNDEFINED</a>" is
   substituted for any other Header Parameter name not understood by the
   implementation, must also be rejected.

   The JWS Protected Header value for this JWS is:

     {"alg":"none",
      "crit":["<a href="http://example.invalid/UNDEFINED">http://example.invalid/UNDEFINED</a>"],
      "<a href="http://example.invalid/UNDEFINED">http://example.invalid/UNDEFINED</a>":true
     }

   The complete JWS that must be rejected is as follows (with line
   breaks for display purposes only):

     eyJhbGciOiJub25lIiwNCiAiY3JpdCI6WyJodHRwOi8vZXhhbXBsZS5jb20vVU5ERU
     ZJTkVEIl0sDQogImh0dHA6Ly9leGFtcGxlLmNvbS9VTkRFRklORUQiOnRydWUNCn0.
     RkFJTA.

<span class="h2"><a class="selflink" id="appendix-F" href="#appendix-F">Appendix F</a>.  Detached Content</span>

   In some contexts, it is useful to integrity-protect content that is
   not itself contained in a JWS.  One way to do this is to create a JWS
   in the normal fashion using a representation of the content as the
   payload but then delete the payload representation from the JWS and
   send this modified object to the recipient rather than the JWS.  When
   using the JWS Compact Serialization, the deletion is accomplished by
   replacing the second field (which contains BASE64URL(JWS Payload))
   value with the empty string; when using the JWS JSON Serialization,
   the deletion is accomplished by deleting the "payload" member.  This
   method assumes that the recipient can reconstruct the exact payload
   used in the JWS.  To use the modified object, the recipient
   reconstructs the JWS by re-inserting the payload representation into
   the modified object and uses the resulting JWS in the usual manner.
   Note that this method needs no support from JWS libraries, as
   applications can use this method by modifying the inputs and outputs
   of standard JWS libraries.








<span class="grey">Jones, et al.                Standards Track                   [Page 58]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-59" ></span>
<span class="grey"><a href="./rfc7515">RFC 7515</a>                JSON Web Signature (JWS)                May 2015</span>


Acknowledgements

   Solutions for signing JSON content were previously explored by Magic
   Signatures [<a href="#ref-MagicSignatures">MagicSignatures</a>], JSON Simple Sign [<a href="#ref-JSS" title="&quot;JSON Simple Sign&quot;">JSS</a>], and Canvas
   Applications [<a href="#ref-CanvasApp" title="&quot;Canvas Applications&quot;">CanvasApp</a>], all of which influenced this document.

   Thanks to Axel Nennker for his early implementation and feedback on
   the JWS and JWE specifications.

   This specification is the work of the JOSE working group, which
   includes dozens of active and dedicated participants.  In particular,
   the following individuals contributed ideas, feedback, and wording
   that influenced this specification:

   Dirk Balfanz, Richard Barnes, Brian Campbell, Alissa Cooper, Breno de
   Medeiros, Stephen Farrell, Yaron Y. Goland, Dick Hardt, Joe
   Hildebrand, Jeff Hodges, Russ Housley, Edmund Jay, Tero Kivinen, Ben
   Laurie, Ted Lemon, James Manger, Matt Miller, Kathleen Moriarty, Tony
   Nadalin, Hideki Nara, Axel Nennker, John Panzer, Ray Polk, Emmanuel
   Raviart, Eric Rescorla, Pete Resnick, Jim Schaad, Paul Tarjan, Hannes
   Tschofenig, and Sean Turner.

   Jim Schaad and Karen O'Donoghue chaired the JOSE working group and
   Sean Turner, Stephen Farrell, and Kathleen Moriarty served as
   Security Area Directors during the creation of this specification.

Authors' Addresses

   Michael B. Jones
   Microsoft

   EMail: mbj@microsoft.com
   URI:   <a href="http://self-issued.info/">http://self-issued.info/</a>


   John Bradley
   Ping Identity

   EMail: ve7jtb@ve7jtb.com
   URI:   <a href="http://www.thread-safe.com/">http://www.thread-safe.com/</a>


   Nat Sakimura
   Nomura Research Institute

   EMail: n-sakimura@nri.co.jp
   URI:   <a href="http://nat.sakimura.org/">http://nat.sakimura.org/</a>




Jones, et al.                Standards Track                   [Page 59]
</pre>

</body>
</html>

