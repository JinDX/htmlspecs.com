<!DOCTYPE html>
<html lang="zh-hans">

<head>
    <meta charset="utf-8">
    <meta name="generator" content="ReSpec 35.1.2">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <style>
        .issue-label {
            text-transform: initial
        }

        .warning>p:first-child {
            margin-top: 0
        }

        .warning {
            padding: .5em;
            border-left-width: .5em;
            border-left-style: solid
        }

        span.warning {
            padding: .1em .5em .15em
        }

        .issue.closed span.issue-number {
            text-decoration: line-through
        }

        .issue.closed span.issue-number::after {
            content: " (Closed)";
            font-size: smaller
        }

        .warning {
            border-color: #f11;
            border-color: var(--warning-border, #f11);
            border-width: .2em;
            border-style: solid;
            background: #fbe9e9;
            background: var(--warning-bg, #fbe9e9);
            color: #000;
            color: var(--text, #000)
        }

        .warning-title:before {
            content: "⚠";
            font-size: 1.3em;
            float: left;
            padding-right: .3em;
            margin-top: -.3em
        }

        li.task-list-item {
            list-style: none
        }

        input.task-list-item-checkbox {
            margin: 0 .35em .25em -1.6em;
            vertical-align: middle
        }

        .issue a.respec-gh-label {
            padding: 5px;
            margin: 0 2px 0 2px;
            font-size: 10px;
            text-transform: none;
            text-decoration: none;
            font-weight: 700;
            border-radius: 4px;
            position: relative;
            bottom: 2px;
            border: none;
            display: inline-block
        }
    </style>
    <style>
        pre.idl {
            padding: 1em;
            position: relative
        }

        pre.idl>code {
            color: #000;
            color: var(--text, #000)
        }

        @media print {
            pre.idl {
                white-space: pre-wrap
            }
        }

        .idlHeader {
            display: block;
            width: 150px;
            background: #8ccbf2;
            background: var(--def-border, #8ccbf2);
            color: #fff;
            color: var(--defrow-border, #fff);
            font-family: sans-serif;
            font-weight: 700;
            margin: -1em 0 1em -1em;
            height: 28px;
            line-height: 28px
        }

        .idlHeader a.self-link {
            margin-left: .3cm;
            text-decoration: none;
            border-bottom: none;
            color: inherit
        }

        .idlID {
            font-weight: 700;
            color: #005a9c
        }

        .idlType {
            color: #005a9c
        }

        .idlName {
            color: #ff4500
        }

        .idlName a {
            color: #ff4500;
            border-bottom: 1px dotted #ff4500;
            text-decoration: none
        }

        a.idlEnumItem {
            color: #000;
            border-bottom: 1px dotted #ccc;
            text-decoration: none
        }

        .idlSuperclass {
            font-style: italic;
            color: #005a9c
        }

        .idlDefaultValue,
        .idlParamName {
            font-style: italic
        }

        .extAttr {
            color: #666
        }

        .idlSectionComment {
            color: gray
        }

        .idlIncludes a {
            font-weight: 700
        }

        .respec-button-copy-paste:focus {
            text-decoration: none;
            border-color: #51a7e8;
            outline: 0;
            box-shadow: 0 0 5px rgba(81, 167, 232, .5)
        }

        .respec-button-copy-paste:is(:focus:hover, .selected:focus) {
            border-color: #51a7e8
        }

        .respec-button-copy-paste:is(:hover, :active, .zeroclipboard-is-hover, .zeroclipboard-is-active) {
            text-decoration: none;
            background-color: #ddd;
            background-image: linear-gradient(#eee, #ddd);
            border-color: #ccc
        }

        .respec-button-copy-paste:is(:active, .selected, .zeroclipboard-is-active) {
            background-color: #dcdcdc;
            background-image: none;
            border-color: #b5b5b5;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, .15)
        }

        .respec-button-copy-paste.selected:hover {
            background-color: #cfcfcf
        }

        .respec-button-copy-paste:is(:disabled, :disabled:hover, .disabled, .disabled:hover) {
            color: rgba(102, 102, 102, .5);
            cursor: default;
            background-color: rgba(229, 229, 229, .5);
            background-image: none;
            border-color: rgba(197, 197, 197, .5);
            box-shadow: none
        }

        @media print {
            .respec-button-copy-paste {
                visibility: hidden
            }
        }
    </style>
    <style>
        dfn {
            cursor: pointer
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            min-width: 300px;
            max-width: 500px;
            padding: .5em .75em;
            margin-top: .6em;
            font-family: "Helvetica Neue", sans-serif;
            font-size: small;
            background: #fff;
            background: var(--indextable-hover-bg, #fff);
            color: #000;
            color: var(--text, #000);
            box-shadow: 0 1em 3em -.4em rgba(0, 0, 0, .3), 0 0 1px 1px rgba(0, 0, 0, .05);
            box-shadow: 0 1em 3em -.4em var(--tocsidebar-shadow, rgba(0, 0, 0, .3)), 0 0 1px 1px var(--tocsidebar-shadow, rgba(0, 0, 0, .05));
            border-radius: 2px
        }

        .dfn-panel:not(.docked)>.caret {
            position: absolute;
            top: -9px
        }

        .dfn-panel:not(.docked)>.caret::after,
        .dfn-panel:not(.docked)>.caret::before {
            content: "";
            position: absolute;
            border: 10px solid transparent;
            border-top: 0;
            border-bottom: 10px solid #fff;
            border-bottom-color: var(--indextable-hover-bg, #fff);
            top: 0
        }

        .dfn-panel:not(.docked)>.caret::before {
            border-bottom: 9px solid #a2a9b1;
            border-bottom-color: var(--indextable-hover-bg, #a2a9b1)
        }

        .dfn-panel * {
            margin: 0
        }

        .dfn-panel b {
            display: block;
            color: #000;
            color: var(--text, #000);
            margin-top: .25em
        }

        .dfn-panel ul a[href] {
            color: #333;
            color: var(--text, #333)
        }

        .dfn-panel>div {
            display: flex
        }

        .dfn-panel a.self-link {
            font-weight: 700;
            margin-right: auto
        }

        .dfn-panel .marker {
            padding: .1em;
            margin-left: .5em;
            border-radius: .2em;
            text-align: center;
            white-space: nowrap;
            font-size: 90%;
            color: #040b1c
        }

        .dfn-panel .marker.dfn-exported {
            background: #d1edfd;
            box-shadow: 0 0 0 .125em #1ca5f940
        }

        .dfn-panel .marker.idl-block {
            background: #8ccbf2;
            box-shadow: 0 0 0 .125em #0670b161
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important
        }

        .dfn-panel a[href]:hover {
            border-bottom-width: 1px
        }

        .dfn-panel ul {
            padding: 0
        }

        .dfn-panel li {
            margin-left: 1em
        }

        .dfn-panel.docked {
            position: fixed;
            left: .5em;
            top: unset;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - .75em * 2 - .5em - .2em * 2);
            max-height: 30vh;
            overflow: auto
        }
    </style>


    <title>输入事件规范 第2级</title>


    <style>
        .invisible-table table {
            border: 0;
            border-spacing: 0px;
            border-collapse: collapse;
        }

        .invisible-table table td,
        .invisible-table table th {
            padding: 6px;
        }
    </style>



    <style id="respec-mainstyle">
        @keyframes pop {
            0% {
                transform: scale(1, 1)
            }

            25% {
                transform: scale(1.25, 1.25);
                opacity: .75
            }

            100% {
                transform: scale(1, 1)
            }
        }

        a.internalDFN {
            color: inherit;
            border-bottom: 1px solid #99c;
            text-decoration: none
        }

        a.externalDFN {
            color: inherit;
            border-bottom: 1px dotted #ccc;
            text-decoration: none
        }

        a.bibref {
            text-decoration: none
        }

        .respec-offending-element:target {
            animation: pop .25s ease-in-out 0s 1
        }

        .respec-offending-element,
        a[href].respec-offending-element {
            text-decoration: red wavy underline
        }

        @supports not (text-decoration:red wavy underline) {
            .respec-offending-element:not(pre) {
                display: inline-block
            }

            .respec-offending-element {
                background: url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x
            }
        }

        #references :target {
            background: #eaf3ff;
            animation: pop .4s ease-in-out 0s 1
        }

        cite .bibref {
            font-style: normal
        }

        a[href].orcid {
            padding-left: 4px;
            padding-right: 4px
        }

        a[href].orcid>svg {
            margin-bottom: -2px
        }

        ol.tof,
        ul.tof {
            list-style: none outside none
        }

        .caption {
            margin-top: .5em;
            font-style: italic
        }

        #issue-summary>ul {
            column-count: 2
        }

        #issue-summary li {
            list-style: none;
            display: inline-block
        }

        details.respec-tests-details {
            margin-left: 1em;
            display: inline-block;
            vertical-align: top
        }

        details.respec-tests-details>* {
            padding-right: 2em
        }

        details.respec-tests-details[open] {
            z-index: 999999;
            position: absolute;
            border: thin solid #cad3e2;
            border-radius: .3em;
            background-color: #fff;
            padding-bottom: .5em
        }

        details.respec-tests-details[open]>summary {
            border-bottom: thin solid #cad3e2;
            padding-left: 1em;
            margin-bottom: 1em;
            line-height: 2em
        }

        details.respec-tests-details>ul {
            width: 100%;
            margin-top: -.3em
        }

        details.respec-tests-details>li {
            padding-left: 1em
        }

        .self-link:hover {
            opacity: 1;
            text-decoration: none;
            background-color: transparent
        }

        aside.example .marker>a.self-link {
            color: inherit
        }

        .header-wrapper {
            display: flex;
            align-items: baseline
        }

        :is(h2, h3, h4, h5, h6):not(#toc>h2, #abstract>h2, #sotd>h2, .head>h2) {
            position: relative;
            left: -.5em
        }

        :is(h2, h3, h4, h5, h6):not(#toch2)+a.self-link {
            color: inherit;
            order: -1;
            position: relative;
            left: -1.1em;
            font-size: 1rem;
            opacity: .5
        }

        :is(h2, h3, h4, h5, h6)+a.self-link::before {
            content: "§";
            text-decoration: none;
            color: var(--heading-text)
        }

        :is(h2, h3)+a.self-link {
            top: -.2em
        }

        :is(h4, h5, h6)+a.self-link::before {
            color: #000
        }

        @media (max-width:767px) {
            dd {
                margin-left: 0
            }
        }

        @media print {
            .removeOnSave {
                display: none
            }
        }
    </style>
    <meta name="color-scheme" content="light">
    <meta name="revision" content="95b658390da72f021eaf20bd6c6da98b0120702d">
    <meta name="description"
        content="本规范定义了文本及相关输入事件的扩展，以便在文本编辑器应用程序和其他处理文本输入及文本格式化的应用程序中，监控和操作默认的浏览器行为。本规范基于UI事件规范 [UI-EVENTS]。">
    <link rel="canonical" href="https://www.w3.org/TR/input-events-2/">
    <style>
        var {
            position: relative;
            cursor: pointer
        }

        var[data-type]::after,
        var[data-type]::before {
            position: absolute;
            left: 50%;
            top: -6px;
            opacity: 0;
            transition: opacity .4s;
            pointer-events: none
        }

        var[data-type]::before {
            content: "";
            transform: translateX(-50%);
            border-width: 4px 6px 0 6px;
            border-style: solid;
            border-color: transparent;
            border-top-color: #222
        }

        var[data-type]::after {
            content: attr(data-type);
            transform: translateX(-50%) translateY(-100%);
            background: #222;
            text-align: center;
            font-family: "Dank Mono", "Fira Code", monospace;
            font-style: normal;
            padding: 6px;
            border-radius: 3px;
            color: #daca88;
            text-indent: 0;
            font-weight: 400
        }

        var[data-type]:hover::after,
        var[data-type]:hover::before {
            opacity: 1
        }
    </style>
    <script id="initialUserConfig" type="application/json">{
      "specStatus": "WD",
      "github": "w3c/input-events",
      "level": 2,
      "group": "webediting",
      "wgPublicList": "public-editing-tf",
      "editors": [
        {
          "name": "Johannes Wilm",
          "mailto": "johannes@fiduswriter.org",
          "company": "Invited Expert",
          "w3cid": "75083",
          "url": "mailto:johannes@fiduswriter.org"
        }
      ],
      "formerEditors": [
        {
          "name": "Ben Peters",
          "company": "Microsoft",
          "companyURL": "https://www.microsoft.com",
          "retiredDate": "2015-02-23"
        }
      ],
      "otherLinks": [
        {
          "key": "Latest published version by level",
          "data": [
            {
              "value": "Level 2",
              "href": "https://www.w3.org/TR/input-events-2/"
            }
          ]
        },
        {
          "key": "Latest editor's draft by level",
          "data": [
            {
              "value": "Level 2",
              "href": "https://w3c.github.io/input-events/"
            }
          ]
        }
      ],
      "xref": [
        "dom",
        "html",
        "infra",
        "mimesniff",
        "uievents",
        "i18n-glossary"
      ],
      "gitRevision": "95b658390da72f021eaf20bd6c6da98b0120702d",
      "publishDate": "2024-09-25",
      "publishISODate": "2024-09-25T00:00:00.000Z",
      "generatedSubtitle": "W3C Working Draft 25 September 2024"
    }</script>
    <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD">
</head>

<body class="h-entry" data-cite="WEBIDL dom html infra mimesniff uievents i18n-glossary">
    <div class="head">
        <p class="logos"><a class="logo" href="https://www.w3.org/"><img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
            </a></p>
        <h1 id="title" class="title">输入事件规范 第2级</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types#WD">W3C 工作草案</a> <time class="dt-published"
                datetime="2024-09-25">2024年9月25日</time></p>
        <details open="">
            <summary>有关此文档的更多详细信息</summary>
            <dl>
                <dt>此版本:</dt>
                <dd>
                    <a class="u-url"
                        href="https://www.w3.org/TR/2024/WD-input-events-2-20240925/">https://www.w3.org/TR/2024/WD-input-events-2-20240925/</a>
                </dd>
                <dt>最新发布版本:</dt>
                <dd>
                    <a href="https://www.w3.org/TR/input-events-2/">https://www.w3.org/TR/input-events-2/</a>
                </dd>
                <dt>最新编辑草案:</dt>
                <dd><a href="https://w3c.github.io/input-events/">https://w3c.github.io/input-events/</a></dd>
                <dt>历史记录:</dt>
                <dd>
                    <a
                        href="https://www.w3.org/standards/history/input-events-2/">https://www.w3.org/standards/history/input-events-2/</a>
                </dd>
                <dd>
                    <a href="https://github.com/w3c/input-events/commits/">提交历史</a>
                </dd>

                <dt>编辑:</dt>
                <dd class="editor p-author h-card vcard" data-editor-id="75083">
                    <a class="ed_mailto u-email email p-name" href="mailto:johannes@fiduswriter.org">Johannes Wilm</a>
                    (<span class="p-org org h-org">受邀专家</span>)
                </dd>
                <dt>
                    前任编辑:
                </dt>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Ben Peters</span> (<a class="p-org org h-org"
                        href="https://www.microsoft.com">微软</a>) - 截至 <time datetime="2015-02-23">2015年2月23日</time>
                </dd>

                <dt>反馈:</dt>
                <dd>
                    <a href="https://github.com/w3c/input-events/">GitHub w3c/input-events</a>
                    (<a href="https://github.com/w3c/input-events/pulls/">拉取请求</a>，
                    <a href="https://github.com/w3c/input-events/issues/new/choose">新问题</a>，
                    <a href="https://github.com/w3c/input-events/issues/">开放问题</a>)
                </dd>
                <dd><a
                        href="mailto:public-editing-tf@w3.org?subject=%5Binput-events-2%5D%20YOUR%20TOPIC%20HERE">public-editing-tf@w3.org</a>
                    主题行 <kbd>[input-events-2] <em>… 主题内容 …</em></kbd> (<a rel="discussion"
                        href="https://lists.w3.org/Archives/Public/public-editing-tf">存档</a>)</dd>

                <dt>按级别发布的最新版本</dt>
                <dd>
                    <a href="https://www.w3.org/TR/input-events-2/">第2级</a>
                </dd>
                <dt>按级别发布的最新编辑草案</dt>
                <dd>
                    <a href="https://w3c.github.io/input-events/">第2级</a>
                </dd>
            </dl>
        </details>

        <p class="copyright">
            <a href="https://www.w3.org/policies/#copyright">版权</a>
            ©
            2024

            <a href="https://www.w3.org/">万维网联盟</a>。
            <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup>
            <a href="https://www.w3.org/policies/#Legal_Disclaimer">责任声明</a>，
            <a href="https://www.w3.org/policies/#W3C_Trademarks">商标</a>和
            <a rel="license" href="https://www.w3.org/copyright/software-license-2023/"
                title="W3C软件和文档许可">宽松的文档许可</a>规则适用。
        </p>
        <hr title="页眉分隔符">
    </div>
    <section id="abstract" class="introductory">
        <h2>摘要</h2>
        <p>
            本规范定义了文本及相关输入的事件扩展，以便在文本编辑器应用程序和其他处理文本输入及文本格式化的应用程序中，监控和操作默认的浏览器行为。本规范基于UI事件规范 [<cite><a class="bibref"
                    data-link-type="biblio" href="#bib-ui-events" title="UI Events">UI-EVENTS</a></cite>]。
        </p>
    </section>
    <section id="sotd" class="introductory">
        <h2>本文件的状态</h2>
        <p><em>本节描述了本文件在发布时的状态。当前 <abbr title="World Wide Web Consortium">W3C</abbr> 的出版物列表以及本技术报告的最新修订版本可以在 <a
                    href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> 技术报告索引</a>
                中找到：https://www.w3.org/TR/。</em></p>
        <p>
            输入事件规范 第2级 取代了输入事件的第一个版本 [<cite><a class="bibref" data-link-type="biblio" href="#bib-input-events"
                    title="Input Events Level 1">INPUT-EVENTS</a></cite>]，并包含：
        </p>
        <ul>
            <li>用于 beforeinput 事件的 inputtypes，用于 IME 组合过程的开始和结束，允许隔离 IME 组合过程。
            </li>
            <li>对 beforeinput 事件的可取消性提出了更多要求，因此除了在 IME 组合过程中发出的那些事件外，所有 beforeinput 事件都是可取消的。
            </li>
        </ul>
        <p>
            输入事件规范的 <a href="https://github.com/web-platform-tests/wpt/tree/master/input-events">测试套件</a> 和 <a
                href="https://w3c.github.io/test-results/input-events/">实现报告</a> 仍在进行中。
        </p>
        <p>
            本文件由 <a href="https://www.w3.org/groups/wg/webediting">Web 编辑工作组</a> 作为工作草案发布，使用了<a
                href="https://www.w3.org/policies/process/20231103/#recs-and-notes">推荐轨道</a>。
        </p>
        <p>发布为工作草案并不意味着 <abbr title="World Wide Web Consortium">W3C</abbr> 及其成员的认可。</p>
        <p>
            这是一个草稿文档，可能会在任何时候被更新、替换或被其他文档取代。因此，不适合将此文档引用为正式成果。
        </p>
        <p>
            本文件由在 <a href="https://www.w3.org/policies/patent-policy/"><abbr
                    title="World Wide Web Consortium">W3C</abbr> 专利政策</a> 下运行的工作组编制。
            <abbr title="World Wide Web Consortium">W3C</abbr> 维护了一个与该工作组交付物相关的 <a rel="disclosure"
                href="https://www.w3.org/groups/wg/webediting/ipr">公开专利披露列表</a>，该页面还包括披露专利的说明。个人如有实际知识并认为专利包含 <a
                href="https://www.w3.org/policies/patent-policy/#def-essential">必要权利要求</a>，则必须按照 <a
                href="https://www.w3.org/policies/patent-policy/#sec-Disclosure">W3C 专利政策第6节</a> 的规定披露相关信息。
        </p>
        <p>
            本文件受 <a id="w3c_process_revision" href="https://www.w3.org/policies/process/20231103/">2023年11月3日 <abbr
                    title="World Wide Web Consortium">W3C</abbr> 流程文件</a> 的约束。
        </p>
    </section>
    <nav id="toc">
        <h2 class="introductory" id="table-of-contents">目录</h2>
        <ol class="toc">
            <li class="tocline"><a class="tocxref" href="#abstract">摘要</a></li>
            <li class="tocline"><a class="tocxref" href="#sotd">本文件的状态</a></li>
            <li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>简介</a></li>
            <li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">2. </bdi>一致性</a></li>
            <li class="tocline"><a class="tocxref" href="#definitions"><bdi class="secno">3. </bdi>定义</a></li>
            <li class="tocline"><a class="tocxref" href="#problems-solved"><bdi class="secno">4. </bdi>解决的问题</a></li>
            <li class="tocline"><a class="tocxref" href="#use-cases"><bdi class="secno">5. </bdi>使用案例</a></li>
            <li class="tocline"><a class="tocxref" href="#events-inputevents"><bdi class="secno">6. </bdi>输入事件类型</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#interface-InputEvent"><bdi class="secno">6.1 </bdi>接口
                            InputEvent</a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#overview"><bdi class="secno">6.1.1
                                    </bdi>概述</a></li>
                            <li class="tocline"><a class="tocxref" href="#interface-InputEvent-Attributes"><bdi
                                        class="secno">6.1.2 </bdi>属性</a></li>
                            <li class="tocline"><a class="tocxref" href="#interface-InputEvent-Methods"><bdi
                                        class="secno">6.1.3 </bdi>方法</a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#event-definitions"><bdi class="secno">6.2
                            </bdi>事件定义</a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#input-event-order-during-composition"><bdi class="secno">7.
                    </bdi>输入事件在合成期间的顺序</a></li>
            <li class="tocline"><a class="tocxref" href="#event-order-when-using-insertfrompaste"><bdi class="secno">8.
                    </bdi>使用<code>"insertFromPaste"</code>时的事件顺序</a></li>
            <li class="tocline"><a class="tocxref" href="#privacy-and-security-considerations"><bdi class="secno">9.
                    </bdi>隐私和安全考虑</a></li>
            <li class="tocline"><a class="tocxref" href="#acknowledgements"><bdi class="secno">10. </bdi>致谢</a></li>
            <li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">A. </bdi>参考文献</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">A.1
                            </bdi>规范性引用</a></li>
                    <li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">A.2
                            </bdi>参考性引用</a></li>
                </ol>
            </li>
        </ol>
    </nav>
    <section id="introduction">
        <div class="header-wrapper">
            <h2 id="x1-introduction"><bdi class="secno">1. </bdi>简介</h2><a class="self-link" href="#introduction"
                aria-label="本节永久链接"></a>
        </div>

        <p>
            本文档描述了与编辑相关的两个事件的扩展 -
            <a href="https://w3c.github.io/uievents/#event-type-input">input</a>
            和 <a href="https://w3c.github.io/uievents/#beforeinput">beforeinput</a>，这些事件在 UI 事件规范中进行了描述 [<cite><a
                    class="bibref" data-link-type="biblio" href="#bib-ui-events"
                    title="UI Events">UI-EVENTS</a></cite>]。这些事件的目的是允许开发者理解和/或覆盖编辑行为的默认处理，编辑操作在执行前或执行后。
        </p>
    </section>
    <section id="conformance">
        <div class="header-wrapper">
            <h2 id="x2-conformance"><bdi class="secno">2. </bdi>一致性</h2><a class="self-link" href="#conformance"
                aria-label="本节永久链接"></a>
        </div>
        <p>除标记为非规范性的章节外，本规范中的所有作者指南、图表、示例和注释均为非规范性内容。其他所有内容均为规范性内容。</p>
        <p>
            本文档中的 <em class="rfc2119">MAY</em>、<em class="rfc2119">MUST</em> 和 <em class="rfc2119">MUST NOT</em> 等关键字应按照
            <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a> [<cite><a class="bibref"
                    data-link-type="biblio" href="#bib-rfc2119"
                    title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a
                    class="bibref" data-link-type="biblio" href="#bib-rfc8174"
                    title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
            的定义进行解释，且仅当它们以全部大写形式出现时，按照此处的描述解释。
        </p>
    </section>
    <section id="definitions">
        <div class="header-wrapper">
            <h2 id="x3-definitions"><bdi class="secno">3. </bdi>定义</h2><a class="self-link" href="#definitions"
                aria-label="本节永久链接"></a>
        </div>

        <dl>
            <dt>
                <dfn id="dfn-express-intention" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">表达意图</dfn>
            </dt>
            <dd>
                用户可以通过键盘、输入法（IME）、语音或类似方法<a data-lt="express intention" href="#dfn-express-intention"
                    class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-express-intention-1">表达执行特定编辑操作的意图</a>。特定的输入操作根据平台特定的约定映射为意图。
            </dd>
            <dt>
                <dfn id="dfn-kill-buffer" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">杀死缓冲区</dfn>
            </dt>
            <dd>
                <p><i>此定义为非规范性内容。</i></p>
                <a href="#dfn-kill-buffer" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-kill-buffer-1">杀死缓冲区</a>
                是一个与剪贴板分开的内存存储区域，用于暂存通过特定删除命令删除的富文本内容。用户可以通过表达“提取杀死缓冲区”的意图，将杀死缓冲区中的内容替换当前选中的内容。
            </dd>
        </dl>
    </section>
    <section id="problems-solved">
        <div class="header-wrapper">
            <h2 id="x4-problems-solved"><bdi class="secno">4. </bdi>解决的问题</h2><a class="self-link"
                href="#problems-solved" aria-label="本节永久链接"></a>
        </div>

        <p><i>本节为非规范性内容。</i></p>
        <p>创建一个基于Web的文本编辑器需要在浏览器代码之上编写大量的JavaScript，部分原因是：</p>
        <ol>
            <li>各个浏览器对编辑操作的处理方式不尽相同。</li>
            <li>浏览器在处理某些编辑操作时通常存在问题。</li>
            <li>各个网站可能对某些编辑操作有自定义的处理偏好。</li>
            <li>浏览器在开发高级文本编辑功能时未完全遵循<a
                    href="https://extensiblewebmanifesto.org/">可扩展Web宣言</a>中提出的原则，因为这些功能的开发未始终与Web开发者社区的需求相协调。</li>
        </ol>
        <p>
            本规范旨在通过提供一种简单的方法，允许Web开发者通过 <a href="#dfn-beforeinput" class="internalDFN" data-link-type="dfn"
                id="ref-for-dfn-beforeinput-1">beforeinput</a> 事件覆盖浏览器对所有与文本编辑相关的用户输入的处理，并通过 <a href="#dfn-input"
                class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-1">input</a>
            事件监控浏览器因用户输入而对DOM的更改，从而缓解这一问题。
        </p>
    </section>

    <section id="use-cases">
        <div class="header-wrapper">
            <h2 id="x5-use-cases"><bdi class="secno">5. </bdi>使用案例</h2><a class="self-link" href="#use-cases"
                aria-label="本节永久链接"></a>
        </div>

        <p><i>本节为非规范性内容。</i></p>
        <ol>
            <li>创建一个JavaScript文本编辑器，其中使用<strong>&lt;strong&gt;</strong>标签代替<strong>&lt;b&gt;</strong>标签来标记用户选择为粗体的文本，使用浏览器内置的任何方式来标记文本为粗体，而不需要访问所有现有的浏览器。
            </li>
            <li>创建一个JavaScript文本编辑器，该编辑器在后台使用数据模型，JavaScript负责将对编辑文本的更改渲染到DOM中。</li>
            <li>创建一个只允许部分富文本编辑的JavaScript编辑器（例如：允许使用粗体，但不允许使用斜体）。</li>
            <li>创建一个协作编辑器，JavaScript根据用户意图渲染对DOM的更改，用户使用不同的浏览器来表达具体意图的方式各不相同。</li>
            <li>创建一个具有不同用户访问选项的JavaScript编辑器，其中一些用户只能添加或删除文本，而其他用户只能添加或删除某些类型的格式。</li>
        </ol>
    </section>
    <section id="events-inputevents">
        <div class="header-wrapper">
            <h2 id="x6-input-event-types"><bdi class="secno">6. </bdi>输入事件类型</h2><a class="self-link"
                href="#events-inputevents" aria-label="第6节的永久链接"></a>
        </div>

        <p>输入事件在用户尝试编辑标记之前（beforeinput事件）和之后（input事件）发送。这包括内容的插入和删除，以及格式更改。</p>
        <p>
            输入事件在充当<a data-link-type="dfn|abstract-op" data-type="dfn"
                href="https://html.spec.whatwg.org/multipage/interaction.html#editing-host">编辑主机</a>的元素上触发，
            包括设置了contenteditable属性的元素，<code><a data-link-type="element" data-type="element" href="https://html.spec.whatwg.org/multipage/form-elements.html#the-textarea-element">textarea</a></code>元素和允许文本输入的<code><a data-link-type="element" href="#dfn-input" class="internalDFN" id="ref-for-dfn-input-2">input</a></code>元素。
        </p>

        <section id="interface-InputEvent">
            <div class="header-wrapper">
                <h3 id="x6-1-interface-inputevent"><bdi class="secno">6.1 </bdi>接口 InputEvent</h3><a class="self-link"
                    href="#interface-InputEvent" aria-label="第6.1节的永久链接"></a>
            </div>

            <pre class="idl def" id="webidl-827932857"><span class="idlHeader"><a class="self-link" href="#webidl-827932857">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-inputevent-partial-1" data-title="InputEvent">partial interface <a data-idl="partial" data-link-type="interface" data-title="InputEvent" class="idlID" data-dfn-for="InputEvent" data-type="interface" href="https://www.w3.org/TR/uievents/#inputevent">InputEvent</a> {<span data-idl="" class="idlAttribute" id="idl-def-inputevent-datatransfer" data-title="dataTransfer" data-dfn-for="InputEvent">
       readonly attribute<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer">DataTransfer</a>?</span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-inputevent-datatransfer" id="ref-for-dom-inputevent-datatransfer-1"><code>dataTransfer</code></a>;</span><span data-idl="" class="idlMethod" id="idl-def-inputevent-gettargetranges" data-title="getTargetRanges" data-dfn-for="InputEvent"><span class="idlType">
       <a data-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="https://dom.spec.whatwg.org/#interface-staticrange">StaticRange</a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-inputevent-gettargetranges" id="ref-for-dom-inputevent-gettargetranges-1"><code>getTargetRanges</code></a>();</span>
    };</span><span data-idl="" class="idlDictionary" id="idl-def-inputeventinit-partial-1" data-title="InputEventInit">
    
    partial dictionary <a data-idl="partial" data-link-type="dictionary" data-title="InputEventInit" class="idlID" data-dfn-for="InputEventInit" data-type="dictionary" href="https://www.w3.org/TR/uievents/#dictdef-inputeventinit">InputEventInit</a> {<span data-idl="" class="idlMember" id="idl-def-inputeventinit-datatransfer" data-title="dataTransfer" data-dfn-for="InputEventInit"><span class="idlType">
       <a data-link-type="idl" data-type="interface" href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer">DataTransfer</a>?</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-inputeventinit-datatransfer" id="ref-for-dom-inputeventinit-datatransfer-1"><code>dataTransfer</code></a> = null;</span><span data-idl="" class="idlMember" id="idl-def-inputeventinit-targetranges" data-title="targetRanges" data-dfn-for="InputEventInit"><span class="idlType">
       <a data-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="https://dom.spec.whatwg.org/#interface-staticrange">StaticRange</a>&gt;</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-inputeventinit-targetranges" id="ref-for-dom-inputeventinit-targetranges-1"><code>targetRanges</code></a> = [];</span>
    };</span></code></pre>

            <p data-dfn-for="InputEventInit">
                <a data-link-type="idl" data-type="attribute"
                    href="https://www.w3.org/TR/uievents/#dom-inputevent-inputtype"><code>inputType</code></a>、<dfn
                    data-export="" data-dfn-type="dict-member" id="dom-inputeventinit-datatransfer" data-idl="field"
                    data-title="dataTransfer" data-dfn-for="InputEventInit" data-type="DataTransfer" tabindex="0"
                    aria-haspopup="dialog"><code>dataTransfer</code></dfn>和<dfn data-lt="targetRange|targetRanges"
                    data-plurals="targetrange" data-export="" data-dfn-type="dict-member"
                    id="dom-inputeventinit-targetranges" data-idl="field" data-title="targetRanges"
                    data-dfn-for="InputEventInit" data-type="sequence" tabindex="0"
                    aria-haspopup="dialog"><code>targetRanges</code></dfn> 属性用于初始化<a data-link-type="idl"
                    data-lt="InputEventInit" data-type="dictionary"
                    href="https://www.w3.org/TR/uievents/#dictdef-inputeventinit"><code>InputEventInit</code></a>对象的相应属性。
            </p>

            <section id="overview">
                <div class="header-wrapper">
                    <h4 id="x6-1-1-overview"><bdi class="secno">6.1.1 </bdi>概览</h4><a class="self-link" href="#overview"
                        aria-label="第6.1.1节的永久链接"></a>
                </div>

                <p><i>本节为非规范性内容。</i></p>
                <p data-link-for="InputEvent">
                    下表总结了<code>data</code>
                    和<code>dataTransfer</code>属性何时包含内容、何时为null，以及<code>getTargetRanges()</code>方法何时返回空数组或非空数组，具体取决于<code>inputType</code>。
                </p>
                <table class="parameters simple">
                    <thead>
                        <tr>
                            <th>
                                编辑主机
                            </th>
                            <th>
                                inputType
                            </th>
                            <th>
                                data
                            </th>
                            <th>
                                dataTransfer
                            </th>
                            <th>
                                getTargetRanges()
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                Contenteditable
                            </td>
                            <td>
                                <code>"insertText"</code>,
                                <code>"insertCompositionText"</code>,
                                <code>"formatSetBlockTextDirection"</code>,
                                <code>"formatSetInlineTextDirection"</code>,
                                <code>"formatBackColor"</code>,
                                <code>"formatFontColor"</code>,
                                <code>"formatFontName"</code>, <code>"insertLink"</code>
                            </td>
                            <td>
                                Yes
                            </td>
                            <td>
                                null
                            </td>
                            <td>
                                非空数组
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Contenteditable
                            </td>
                            <td>
                                <code>"insertFromPaste"</code>,
                                <code>"insertFromPasteAsQuotation"</code>,
                                <code>"insertFromDrop"</code>,
                                <code>"insertReplacementText"</code>,
                                <code>"insertFromYank"</code>
                            </td>
                            <td>
                                null
                            </td>
                            <td>
                                Yes
                            </td>
                            <td>
                                非空数组
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>&lt;textarea&gt;</code>, <code>&lt;input type="text"&gt;</code>
                            </td>
                            <td>
                                <code>"insertText"</code>,
                                <code>"insertCompositionText"</code>,
                                <code>"insertFromPaste"</code>,
                                <code>"insertFromPasteAsQuotation"</code>,
                                <code>"insertFromDrop"</code>,
                                <code>"insertReplacementText"</code>,
                                <code>"insertFromYank"</code>,
                                <code>"formatSetBlockTextDirection"</code>,
                                <code>"formatSetInlineTextDirection"</code>,
                                <code>"formatBackColor"</code>,
                                <code>"formatFontColor"</code>,
                                <code>"formatFontName"</code>, <code>"insertLink"</code>
                            </td>
                            <td>
                                Yes
                            </td>
                            <td>
                                null
                            </td>
                            <td>
                                空数组
                            </td>
                        </tr>
                        <tr>
                            <td>
                                所有
                            </td>
                            <td>
                                <code>"historyUndo"</code>, <code>"historyRedo"</code>
                            </td>
                            <td>
                                null
                            </td>
                            <td>
                                null
                            </td>
                            <td>
                                空数组
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Contenteditable
                            </td>
                            <td>
                                所有剩余
                            </td>
                            <td>
                                null
                            </td>
                            <td>
                                null
                            </td>
                            <td>
                                非空数组
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>&lt;textarea&gt;</code>, <code>&lt;input type="text"&gt;</code>
                            </td>
                            <td>
                                所有剩余
                            </td>
                            <td>
                                null
                            </td>
                            <td>
                                null
                            </td>
                            <td>
                                空数组
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>
            <section id="interface-InputEvent-Attributes" data-dfn-for="InputEvent">
                <div class="header-wrapper">
                    <h4 id="x6-1-2-attributes"><bdi class="secno">6.1.2 </bdi>
                        属性
                    </h4><a class="self-link" href="#interface-InputEvent-Attributes" aria-label="第6.1.2节的永久链接"></a>
                </div>

                <p>
                    beforeinput事件是否可取消取决于inputType。
                </p>
                <p>
                    inputType的选择取决于用户的<a data-lt="express intention" href="#dfn-express-intention" class="internalDFN"
                        data-link-type="dfn" id="ref-for-dfn-express-intention-2">意图表达</a>，编辑是否在IME组合过程中进行，以及选择的状态。
                </p>
                <p>
                    本规范将inputType值定义为下表中的inputType列中的值。
                </p>
                <table class="parameters simple">
                    <thead>
                        <tr>
                            <th>
                                inputType
                            </th>
                            <th>
                                用户的意图表达
                            </th>
                            <th>
                                IME组合的一部分
                            </th>
                            <th>
                                beforeinput是否可取消
                            </th>
                            <th>
                                选择的状态
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <code>"insertText"</code>
                            </td>
                            <td>
                                插入键入的纯文本
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertReplacementText"</code>
                            </td>
                            <td>
                                通过拼写检查器、自动更正、写作建议或类似方式插入或替换现有文本
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertLineBreak"</code>
                            </td>
                            <td>
                                插入换行符
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertParagraph"</code>
                            </td>
                            <td>
                                插入段落符
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertOrderedList"</code>
                            </td>
                            <td>
                                插入编号列表
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertUnorderedList"</code>
                            </td>
                            <td>
                                插入项目符号列表
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertHorizontalRule"</code>
                            </td>
                            <td>
                                插入水平线
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertFromYank"</code>
                            </td>
                            <td>
                                用存储在<a href="#dfn-kill-buffer" class="internalDFN" data-link-type="dfn"
                                    id="ref-for-dfn-kill-buffer-2">kill buffer</a>中的内容替换当前选择
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertFromDrop"</code>
                            </td>
                            <td>
                                通过拖放插入内容
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertFromPaste"</code>
                            </td>
                            <td>
                                从剪贴板粘贴内容或从客户端提供的图像库粘贴图像
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertFromPasteAsQuotation"</code>
                            </td>
                            <td>
                                作为引用从剪贴板粘贴内容
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertTranspose"</code>
                            </td>
                            <td>
                                颠倒输入的最后两个<a data-link-type="dfn|abstract-op" data-type="dfn"
                                    href="https://www.w3.org/TR/i18n-glossary/#dfn-grapheme-cluster"
                                    class="respec-offending-element" title="引用非规范术语。"
                                    id="respec-offender-normative-reference-to-non-normative-term">字素簇</a>。
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertCompositionText"</code>
                            </td>
                            <td>
                                替换当前组合字符串
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertLink"</code>
                            </td>
                            <td>
                                插入链接
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"deleteWordBackward"</code>
                            </td>
                            <td>
                                删除光标位置前的单词
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                折叠
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"deleteWordForward"</code>
                            </td>
                            <td>
                                删除光标位置后的单词
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                折叠
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"deleteSoftLineBackward"</code>
                            </td>
                            <td>
                                从光标位置删除到最近的视觉换行符之前
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                折叠
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"deleteSoftLineForward"</code>
                            </td>
                            <td>
                                从光标位置删除到最近的视觉换行符之后
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                折叠
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"deleteEntireSoftLine"</code>
                            </td>
                            <td>
                                从光标位置之前的最近视觉换行符删除到光标位置之后的最近视觉换行符
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                折叠
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"deleteHardLineBackward"</code>
                            </td>
                            <td>
                                从光标位置删除到块元素的最近开头或
                                <code><a data-link-type="element" href="https://html.spec.whatwg.org/#the-br-element">br</a></code>
                                元素之前
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                折叠
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"deleteHardLineForward"</code>
                            </td>
                            <td>
                                从光标位置删除到块元素的最近结尾或
                                <code><a data-link-type="element" href="https://html.spec.whatwg.org/#the-br-element">br</a></code>
                                元素之后
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                折叠
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"deleteByDrag"</code>
                            </td>
                            <td>
                                通过拖动从DOM中删除内容
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"deleteByCut"</code>
                            </td>
                            <td>
                                作为剪切的一部分删除当前选择
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"deleteContent"</code>
                            </td>
                            <td>
                                删除选择而不指定删除的方向，并且此意图不被另一个inputType涵盖
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                未折叠
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"deleteContentBackward"</code>
                            </td>
                            <td>
                                删除光标位置前的内容，并且此意图不被另一个inputType涵盖，或者删除选择，选择在删除后折叠到其开始位置
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"deleteContentForward"</code>
                            </td>
                            <td>
                                删除光标位置后的内容，并且此意图不被另一个inputType涵盖，或者删除选择，选择在删除后折叠到其结束位置
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"historyUndo"</code>
                            </td>
                            <td>
                                撤销最后的编辑操作
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"historyRedo"</code>
                            </td>
                            <td>
                                重做最后撤销的编辑操作
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatBold"</code>
                            </td>
                            <td>
                                启动粗体文本
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatItalic"</code>
                            </td>
                            <td>
                                启动斜体文本
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatUnderline"</code>
                            </td>
                            <td>
                                启动下划线文本
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatStrikeThrough"</code>
                            </td>
                            <td>
                                启动删除线文本
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatSuperscript"</code>
                            </td>
                            <td>
                                启动上标文本
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatSubscript"</code>
                            </td>
                            <td>
                                启动下标文本
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatJustifyFull"</code>
                            </td>
                            <td>
                                将当前选择完全对齐
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatJustifyCenter"</code>
                            </td>
                            <td>
                                将当前选择居中对齐
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatJustifyRight"</code>
                            </td>
                            <td>
                                将当前选择右对齐
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatJustifyLeft"</code>
                            </td>
                            <td>
                                将当前选择左对齐
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatIndent"</code>
                            </td>
                            <td>
                                缩进当前选择
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatOutdent"</code>
                            </td>
                            <td>
                                减少当前选择的缩进
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatRemove"</code>
                            </td>
                            <td>
                                删除当前选择的所有格式
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatSetBlockTextDirection"</code>
                            </td>
                            <td>
                                设置文本块方向
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatSetInlineTextDirection"</code>
                            </td>
                            <td>
                                设置文本行方向
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatBackColor"</code>
                            </td>
                            <td>
                                更改背景颜色
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatFontColor"</code>
                            </td>
                            <td>
                                更改字体颜色
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatFontName"</code>
                            </td>
                            <td>
                                更改字体家族
                            </td>
                            <td>
                                否
                            </td>
                            <td>
                                是
                            </td>
                            <td>
                                任何
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div class="note" role="note" id="issue-container-generatedID">
                    <div role="heading" class="note-title marker" id="h-note" aria-level="5"><span>注意</span></div>
                    <div class="">
                        其他规范可能会扩展此定义。
                    </div>
                </div>
                <div class="note" role="note" id="issue-container-generatedID-0">
                    <div role="heading" class="note-title marker" id="h-note-0" aria-level="5"><span>注意</span></div>
                    <div class="">
                        上述<code>inputTypes</code>的存在并不意味着任何给定的实现将支持所有这些。
                        但如果给定的浏览器支持可能导致DOM更改的编辑操作，则它<em class="rfc2119">必须</em><a data-link-type="dfn|abstract-op"
                            data-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch">分派</a>
                        相应的<code>beforeinput</code>和<code>input</code>事件。
                    </div>
                </div>
                <div class="note" role="note" id="issue-container-generatedID-1">
                    <div role="heading" class="note-title marker" id="h-note-1" aria-level="5"><span>注意</span></div>
                    <div class="">
                        如果选择被折叠，<code>"deleteContentBackward"</code>将用于用户请求在文本节点内删除文本时，以及当用户表示删除更复杂的元素或在光标位于文本节点开头时合并段落时。
                    </div>
                </div>
                <div class="note" role="note" id="issue-container-generatedID-2">
                    <div role="heading" class="note-title marker" id="h-note-2" aria-level="5"><span>注意</span></div>
                    <div class="">
                        如果选择被折叠，<code>"deleteContentForward"</code>将用于用户请求在文本节点内删除文本时，以及当用户表示删除更复杂的元素或在光标位于文本节点末尾时合并段落时。
                    </div>
                </div>
                <p>
                    <dfn id="dfn-data" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><code>data</code></dfn>
                    保存与要添加到文档中的内容相关的纯文本数据。
                </p>
                <table class="parameters simple">
                    <thead>
                        <tr>
                            <th>
                                inputType
                            </th>
                            <th>
                                编辑主机
                            </th>
                            <th>
                                data
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <code>"insertText"</code> 或
                                <code>"insertCompositionText"</code>
                            </td>
                            <td>
                                任意
                            </td>
                            <td>
                                要插入的纯文本字符串
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertFromPaste"</code>，
                                <code>"insertFromPasteAsQuotation"</code>，
                                <code>"insertFromDrop"</code>，
                                <code>"insertTranspose"</code>，
                                <code>"insertReplacementText"</code> 或
                                <code>"insertFromYank"</code>
                            </td>
                            <td>
                                <code><a href="https://html.spec.whatwg.org/multipage/input.html#the-input-element">input</a></code>
                                或
                                <code><a href="https://html.spec.whatwg.org/multipage/form-elements.html#the-textarea-element">textarea</a></code>
                            </td>
                            <td>
                                要插入的纯文本字符串
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatSetInlineTextDirection"</code> 或
                                <code>"formatSetBlockTextDirection"</code>
                            </td>
                            <td>
                                任意
                            </td>
                            <td>
                                <code>"ltr"</code>，<code>"rtl"</code>，<code>"auto"</code>
                                或<code>"null"</code>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatBackColor"</code> 或
                                <code>"formatFontColor"</code>
                            </td>
                            <td>
                                任意
                            </td>
                            <td>
                                包含<a
                                    href="https://www.w3.org/TR/cssom-1/#serialize-a-css-component-value">序列化CSS组件值</a>的字符串
                                [<cite><a class="bibref" data-link-type="biblio" href="#bib-cssom"
                                        title="CSS对象模型（CSSOM）">CSSOM</a></cite>] 用于建议的颜色
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"formatFontName"</code>
                            </td>
                            <td>
                                任意
                            </td>
                            <td>
                                提议的字体家族CSS属性值
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code>"insertLink"</code>
                            </td>
                            <td>
                                任意
                            </td>
                            <td>
                                提议的链接URL
                            </td>
                        </tr>
                        <tr>
                            <td>
                                所有其他
                            </td>
                            <td>
                                任意
                            </td>
                            <td>
                                null
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>
                    <dfn data-dfn-for="InputEvent" data-export="" data-dfn-type="attribute"
                        id="dom-inputevent-datatransfer" data-idl="attribute" data-title="dataTransfer"
                        data-type="DataTransfer" data-lt="dataTransfer" data-local-lt="InputEvent.dataTransfer"
                        tabindex="0"
                        aria-haspopup="dialog"><code>dataTransfer</code></dfn>保存关于从文档中提取或添加到文档中的富文本和纯文本数据的信息，如果有相关数据的话。
                </p>
                <table class="parameters simple">
                    <thead>
                        <tr>
                            <th>
                                inputType
                            </th>
                            <th>
                                编辑主机
                            </th>
                            <th>
                                dataTransfer
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <code>"insertFromPaste"</code>，
                                <code>"insertFromPasteAsQuotation"</code>，
                                <code>"insertFromDrop"</code>，
                                <code>"insertTranspose"</code>，
                                <code>"insertReplacementText"</code> 或
                                <code>"insertFromYank"</code>
                            </td>
                            <td>
                                <code>contenteditable</code>
                            </td>
                            <td>
                                一个预填充的<a data-link-type="idl" data-lt="DataTransfer" data-type="interface"
                                    href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer"><code>DataTransfer</code></a>对象：
                                <ol>
                                    <li>
                                        <a data-link-type="idl" data-lt="DataTransfer" data-type="interface"
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer"><code>DataTransfer</code></a>
                                        对象的<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#drag-data-store">拖放数据存储</a>
                                        处于<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#concept-dnd-ro">只读</a>
                                        模式。 [<cite><a class="bibref" data-link-type="biblio" href="#bib-html"
                                                title="HTML标准">HTML</a></cite>]
                                    </li>
                                    <li>如果粘贴的内容是文件，<a data-link-type="idl" data-lt="DataTransfer" data-type="interface"
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer"><code>DataTransfer</code></a>
                                        对象的<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#the-drag-data-item-kind">拖放数据存储项列表</a>
                                        包含一个条目，其中<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#the-drag-data-item-type-string">拖放数据项类型字符串</a>
                                        是该文件的<a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://mimesniff.spec.whatwg.org/#mime-type">MIME类型</a>，
                                        <a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#the-drag-data-item-kind">kind</a>
                                        是<i>文件</i>，数据是一个<a href="https://www.w3.org/TR/FileAPI/#dfn-file">文件对象</a>，
                                        对应于粘贴的文件。 [<cite><a class="bibref" data-link-type="biblio" href="#bib-html"
                                                title="HTML标准">HTML</a></cite>]
                                    </li>
                                    <li>
                                        <a data-link-type="idl" data-lt="DataTransfer" data-type="interface"
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer"><code>DataTransfer</code></a>
                                        对象的<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#drag-data-store-item-list">拖放数据存储项列表</a>
                                        包含一个条目，<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#the-drag-data-item-type-string">拖放数据项类型字符串</a>
                                        为<code>"text/html"</code>，
                                        <a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#the-drag-data-item-kind">kind</a>
                                        是<i>纯Unicode字符串</i>，数据是剪贴板中或<a href="#dfn-kill-buffer" class="internalDFN"
                                            data-link-type="dfn" id="ref-for-dfn-kill-buffer-3">kill
                                            buffer</a>中的HTML表示形式，用于丢弃或以其他方式添加的内容。
                                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-html"
                                                title="HTML标准">HTML</a></cite>]
                                    </li>
                                    <li>
                                        <a data-link-type="idl" data-lt="DataTransfer" data-type="interface"
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer"><code>DataTransfer</code></a>
                                        对象的<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#drag-data-store-item-list">拖放数据存储项列表</a>
                                        包含一个条目，<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#the-drag-data-item-type-string">拖放数据项类型字符串</a>
                                        为<code>"text/plain"</code>，
                                        <a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#the-drag-data-item-kind">kind</a>
                                        是<i>纯Unicode字符串</i>，数据是要粘贴、丢弃或以其他方式添加的内容的纯文本表示。 [<cite><a class="bibref"
                                                data-link-type="biblio" href="#bib-html" title="HTML标准">HTML</a></cite>]
                                    </li>
                                    <li>如果要粘贴的内容是链接，<a data-link-type="idl" data-lt="DataTransfer" data-type="interface"
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#datatransfer"><code>DataTransfer</code></a>
                                        对象的<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#the-drag-data-store-item-kind">拖放数据存储项列表</a>
                                        包含一个条目，<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#the-drag-data-item-type-string">拖放数据项类型字符串</a>
                                        为<code>"text/uri-list"</code>，其<a
                                            href="https://html.spec.whatwg.org/multipage/dnd.html#the-drag-data-item-kind">kind</a>
                                        是<i>纯Unicode字符串</i>，数据是要丢弃或以其他方式添加的链接的纯文本表示。 [<cite><a class="bibref"
                                                data-link-type="biblio" href="#bib-html" title="HTML标准">HTML</a></cite>]
                                    </li>
                                </ol>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                所有其他
                            </td>
                            <td>
                                任意
                            </td>
                            <td>
                                null
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>
                    <dfn data-dfn-for="InputEvent" data-lt="targetRange|getTargetRanges()" data-export=""
                        data-dfn-type="method" id="dom-inputevent-gettargetranges" data-idl="operation"
                        data-title="getTargetRanges()" data-type="sequence"
                        data-local-lt="InputEvent.getTargetRanges|InputEvent.getTargetRanges()|getTargetRanges"
                        tabindex="0" aria-haspopup="dialog"><code>getTargetRanges()</code></dfn>返回一个
                    <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#interface-staticrange">StaticRanges</a>
                    数组，表示如果事件未被取消，将被修改的文本。返回的
                    <a data-link-type="dfn"
                        href="https://dom.spec.whatwg.org/#interface-staticrange">StaticRanges</a><em
                        class="rfc2119">必须</em>仅涵盖浏览器通常会替换的<a
                        href="https://infra.spec.whatwg.org/#code-points">代码点</a>，即使它们只是
                    <a data-link-type="dfn|abstract-op" data-type="dfn"
                        href="https://www.w3.org/TR/i18n-glossary/#dfn-grapheme-cluster"
                        class="respec-offending-element" title="引用非规范术语。"
                        id="respec-offender-normative-reference-to-non-normative-term-0">字素簇</a>的一部分。
                </p>
                <div class="note" role="note" id="issue-container-generatedID-3">
                    <div role="heading" class="note-title marker" id="h-note-3" aria-level="5"><span>注意</span></div>
                    <div class="" data-link-for="InputEvent">
                        <p>
                            <i>此说明不是规范性的。</i>
                        </p>根据脚本和平台，在文本节点中折叠的选择向前或向后删除可能会影响一个或多个
                        <a data-type="dfn" href="https://infra.spec.whatwg.org/#code-point">代码点</a>
                        或整个<a data-link-type="dfn|abstract-op" data-type="dfn"
                            href="https://www.w3.org/TR/i18n-glossary/#dfn-grapheme-cluster">字素簇</a>。例如，在包含“café”的文本节点中向后删除可能会删除重音符号或整个“é”字符，这取决于脚本和平台。
                    </div>
                </div>
            </section>
            <section id="interface-InputEvent-Methods" data-dfn-for="InputEvent">
                <div class="header-wrapper">
                    <h4 id="x6-1-3-methods"><bdi class="secno">6.1.3 </bdi>
                        方法
                    </h4><a class="self-link" href="#interface-InputEvent-Methods" aria-label="第 6.1.3 节的永久链接"></a>
                </div>

                <table class="parameters simple">
                    <thead>
                        <tr>
                            <th>
                                inputType
                            </th>
                            <th>
                                编辑主机
                            </th>
                            <th>
                                <code>getTargetRanges()</code> 的响应
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <code>"historyUndo"</code> 或 <code>"historyRedo"</code>
                            </td>
                            <td>
                                任意
                            </td>
                            <td>
                                空数组
                            </td>
                        </tr>
                        <tr>
                            <td>
                                其他所有
                            </td>
                            <td>
                                <code>contenteditable</code>
                            </td>
                            <td>
                                一个包含 <dfn data-lt="StaticRange" id="dfn-staticrange" class="externalDFN"
                                    data-no-export="" data-dfn-type="dfn"><a
                                        href="https://dom.spec.whatwg.org/#interface-staticrange">StaticRanges</a></dfn>
                                的数组
                                [<cite><a class="bibref" data-link-type="biblio" href="#bib-dom"
                                        title="DOM 标准">DOM</a></cite>]
                                与事件相关联
                            </td>
                        </tr>
                        <tr>
                            <td>
                                其他所有
                            </td>
                            <td>
                                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/input.html#the-input-element">input</a></code>
                                或
                                <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/form-elements.html#the-textarea-element">textarea</a></code>
                            </td>
                            <td>
                                空数组
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>
                    返回值，除非 inputType 是 <code>"historyUndo"</code> 或 <code>"historyRedo"</code>，或者 <a
                        data-link-type="dfn|abstract-op" data-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/interaction.html#editing-host">编辑主机</a> 不是
                    contenteditable 元素，在这种情况下，它返回一个空数组。
                </p>
            </section>
        </section>
        <section id="event-definitions">
            <div class="header-wrapper">
                <h3 id="x6-2-event-definitions"><bdi class="secno">6.2 </bdi>事件定义</h3>
                <a class="self-link" href="#event-definitions" aria-label="第 6.2 节的永久链接"></a>
            </div>

            <div class="event-definition">
                <dl>
                    <dt id="event-type-beforeinput">
                        <dfn id="dfn-beforeinput" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">
                            <a class="eventtype" href="#event-type-beforeinput"><code>beforeinput</code></a>
                        </dfn>
                    </dt>
                    <dd>
                        <table class="invisible-table" data-summary="此表包含有关给定事件类型语义的信息">
                            <tbody>
                                <tr>
                                    <th>类型</th>
                                    <td><strong><code>beforeinput</code></strong></td>
                                </tr>
                                <tr>
                                    <th>接口</th>
                                    <td><a href="#interface-InputEvent"><code>InputEvent</code></a></td>
                                </tr>
                                <tr>
                                    <th>同步/异步</th>
                                    <td>同步</td>
                                </tr>
                                <tr>
                                    <th>冒泡</th>
                                    <td>是</td>
                                </tr>
                                <tr>
                                    <th>可信目标</th>
                                    <td>任何作为 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/interaction.html#editing-host">编辑主机</a>
                                        的 <code>Element</code>。
                                    </td>
                                </tr>
                                <tr>
                                    <th>
                                        <a href="https://www.w3.org/TR/uievents/#default-action">默认操作</a>
                                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-ui-events"
                                                title="UI Events">UI-EVENTS</a></cite>]
                                    </th>
                                    <td>
                                        <ul>
                                            <li>对于 inputType <code>"insertCompositionText"</code> 和
                                                <code>"deleteCompositionText"</code> 的 contentEditable=typing 编辑主机：'更新
                                                DOM'。
                                            </li>
                                            <li>对于 <code>contentEditable="true"</code> 的
                                                <a data-link-type="dfn|abstract-op" data-type="dfn"
                                                    href="https://html.spec.whatwg.org/multipage/interaction.html#editing-host">编辑主机</a>：
                                                '更新 DOM'。
                                            </li>
                                            <li>对于 <a
                                                    href="https://w3c.github.io/edit-context/#dfn-editcontext-editing-host">
                                                    EditContext 编辑主机</a> 及其
                                                <a
                                                    href="https://w3c.github.io/edit-context/#dfn-editcontext-handled-inputtype">
                                                    EditContext 处理的 inputTypes</a>：根据 <a
                                                    href="https://w3c.github.io/edit-context/#dfn-handle-input-for-editcontext">
                                                    EditContext 处理输入</a>。
                                            </li>
                                            <li>其他情况下无操作。</li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <th>上下文<br>(可信事件)</th>
                                    <td>
                                        <ul>
                                            <li><a href="#dfn-data" id="ref-for-dfn-data-2"><code
                                                        class="attribute-name">InputEvent.data</code></a>：包含添加到元素中的数据字符串，如果不适用则可能为空。
                                            </li>
                                            <li>
                                                <a href="#dom-inputevent-datatransfer"
                                                    id="ref-for-dom-inputevent-datatransfer-3">
                                                    <code class="attribute-name">InputEvent.dataTransfer</code></a>：
                                                richtext 数据添加或从元素中移除，如果不适用则可能为空。
                                            </li>
                                            <li>
                                                <a href="#dom-inputevent-gettargetranges" class="internalDFN"
                                                    data-link-type="idl" id="ref-for-dom-inputevent-gettargetranges-3">
                                                    <code class="methods-name">InputEvent.getTargetRanges()</code></a>：
                                                返回将被更改影响的 <a data-link-type="dfn"
                                                    href="https://dom.spec.whatwg.org/#interface-staticrange">StaticRanges</a>
                                                数组，如果事件未被取消。
                                            </li>
                                        </ul>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <p>
                            用户代理 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                href="https://infra.spec.whatwg.org/#user-agent">MUST</a> 在用户尝试在 contenteditable
                            元素中输入时 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                href="https://dom.spec.whatwg.org/#concept-event-dispatch">调度</a> 此事件。此事件并不一定意味着
                            用户代理将更新 DOM。
                        </p>
                        <p>
                            用户代理 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                href="https://infra.spec.whatwg.org/#user-agent">MUST NOT</a> 因非用户输入尝试（如系统事件）而
                            <a data-link-type="dfn|abstract-op" data-type="dfn"
                                href="https://dom.spec.whatwg.org/#concept-event-dispatch">调度</a>
                            此事件。
                        </p>
                    </dd>
                </dl>
            </div>

            <div class="event-definition">
                <dl>
                    <dt id="event-type-input">
                        <dfn id="dfn-input" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">
                            <a class="eventtype" href="#event-type-input"><code>input</code></a>
                        </dfn>
                    </dt>
                    <dd>
                        <table class="invisible-table" data-summary="此表包含有关给定事件类型语义的信息">
                            <tbody>
                                <tr>
                                    <th>类型</th>
                                    <td><strong><code>input</code></strong></td>
                                </tr>
                                <tr>
                                    <th>接口</th>
                                    <td><a href="#interface-InputEvent"><code>InputEvent</code></a></td>
                                </tr>
                                <tr>
                                    <th>同步/异步</th>
                                    <td>同步</td>
                                </tr>
                                <tr>
                                    <th>冒泡</th>
                                    <td>是</td>
                                </tr>
                                <tr>
                                    <th>可信目标</th>
                                    <td>任何启用了 <code>contenteditable</code> 属性的 <code>Element</code>。</td>
                                </tr>
                                <tr>
                                    <th>
                                        <a href="https://www.w3.org/TR/uievents/#default-action">默认操作</a>
                                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-ui-events"
                                                title="UI Events">UI-EVENTS</a></cite>]
                                    </th>
                                    <td>无</td>
                                </tr>
                                <tr>
                                    <th>上下文<br>(可信事件)</th>
                                    <td>
                                        <ul>
                                            <li>
                                                <a href="#dfn-data" id="ref-for-dfn-data-3"><code
                                                        class="attribute-name">
                                                    InputEvent.data</code></a>：包含添加到元素中的数据字符串，如果不适用则可能为空。
                                            </li>
                                            <li>
                                                <a href="#dom-inputevent-datatransfer"
                                                    id="ref-for-dom-inputevent-datatransfer-4">
                                                    <code class="attribute-name">InputEvent.dataTransfer</code></a>：
                                                richtext 数据添加或从元素中移除，如果不适用则可能为空。
                                            </li>
                                        </ul>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <p>
                            用户代理 <a data-link-type="dfn|abstract-op" data-type="dfn"
                                href="https://infra.spec.whatwg.org/#user-agent">MUST</a> 在用户表达更改文档内容意图并且浏览器处理完该意图后立即
                            <a data-link-type="dfn|abstract-op" data-type="dfn"
                                href="https://dom.spec.whatwg.org/#concept-event-dispatch">调度</a> 该事件。如果浏览器未做 DOM
                            更改，无论是因为编辑主机是
                            <a href="https://w3c.github.io/edit-context/#dfn-editcontext-editing-host">
                                EditContext 编辑主机</a>，还是因为用户代理认为不需要 DOM 更改，用户代理 <em class="rfc2119">MUST NOT</em> 调度此事件。
                        </p>
                    </dd>
                </dl>
            </div>
        </section>
    </section>
    <section id="input-event-order-during-composition">
        <div class="header-wrapper">
            <h2 id="x7-input-event-order-during-composition"><bdi class="secno">7. </bdi>输入事件在合成期间的顺序</h2>
            <a class="self-link" href="#input-event-order-during-composition" aria-label="第 7 节的永久链接"></a>
        </div>

        <p>
            合成的开始通过调度 <a data-link-type="dfn"
                href="https://www.w3.org/TR/uievents/#compositionstart">compositionstart</a> 事件标记。
        </p>
        <p>
            在合成会话期间，每当文本合成系统更新其活动文本段落时，都会调度 <a data-link-type="dfn"
                href="https://www.w3.org/TR/uievents/#compositionupdate">compositionupdate</a> 事件。
        </p>
        <p>
            在每个 <a data-link-type="dfn" href="https://www.w3.org/TR/uievents/#compositionupdate">compositionupdate</a>
            事件之后，会调度一对 <a data-link-type="idl" data-lt="beforeinput" href="#dfn-beforeinput" class="internalDFN"
                id="ref-for-dfn-beforeinput-2"><code>beforeinput</code></a> 和 <a data-link-type="idl" data-lt="input"
                href="#dfn-input" class="internalDFN" id="ref-for-dfn-input-3"><code>input</code></a> 事件。
            <a data-link-type="idl" data-lt="beforeinput" href="#dfn-beforeinput" class="internalDFN"
                id="ref-for-dfn-beforeinput-3"><code>beforeinput</code></a> 和 <a data-link-type="idl" data-lt="input"
                href="#dfn-input" class="internalDFN" id="ref-for-dfn-input-4"><code>input</code></a> 事件：
        </p>
        <ul>
            <li>不可取消</li>
            <li><a data-link-type="idl" data-type="attribute"
                    href="https://www.w3.org/TR/uievents/#dom-inputevent-inputtype"><code>inputType</code></a> 设置为
                <code>"insertCompositionText"</code>
            </li>
            <li><a data-link-type="idl" data-lt="data" href="#dfn-data" class="internalDFN"
                    id="ref-for-dfn-data-4"><code><code>data</code></code></a> 属性等于 <a data-link-type="dfn"
                    href="https://www.w3.org/TR/uievents/#compositionupdate">compositionupdate</a> 事件的 <code>data</code>
            </li>
            <li><a data-link-type="idl" href="#dom-inputevent-gettargetranges" class="internalDFN"
                    id="ref-for-dom-inputevent-gettargetranges-4"><code>targetRange</code></a> 包围了合成的活动文本段落</li>
        </ul>
        <p>
            活动文本段落的 DOM 内容在调度 <a data-link-type="idl" data-lt="beforeinput" href="#dfn-beforeinput" class="internalDFN"
                id="ref-for-dfn-beforeinput-4"><code>beforeinput</code></a> 事件后，<a data-link-type="idl" data-lt="input"
                href="#dfn-input" class="internalDFN" id="ref-for-dfn-input-5"><code>input</code></a> 事件之前更新。
        </p>
        <p>
            合成会话的结束通过调度 <a data-link-type="dfn" href="https://www.w3.org/TR/uievents/#compositionend">compositionend</a>
            事件标记。
        </p>
    </section>
    <section id="event-order-when-using-insertfrompaste">
        <div class="header-wrapper">
            <h2 id="x8-event-order-when-using-insertfrompaste"><bdi class="secno">8. </bdi>使用
                <code>"insertFromPaste"</code> 时的事件顺序
            </h2>
            <a class="self-link" href="#event-order-when-using-insertfrompaste" aria-label="第 8 节的永久链接"></a>
        </div>

        <p>
            当调度 <code>"insertFromPaste"</code> <a data-link-type="idl" data-lt="beforeinput" href="#dfn-beforeinput"
                class="internalDFN" id="ref-for-dfn-beforeinput-5"><code>beforeinput</code></a> 事件时，它 <em
                class="rfc2119">必须</em> 之前已经调度了 <a
                href="https://www.w3.org/TR/clipboard-apis/#clipboard-event-paste">paste</a> 事件。[<cite><a class="bibref"
                    data-link-type="biblio" href="#bib-clipboard-apis"
                    title="Clipboard API and events">CLIPBOARD-APIS</a></cite>]
        </p>
    </section>
    <section id="privacy-and-security-considerations">
        <div class="header-wrapper">
            <h2 id="x9-privacy-and-security-considerations"><bdi class="secno">9. </bdi>隐私和安全考虑</h2>
            <a class="self-link" href="#privacy-and-security-considerations" aria-label="第 9 节的永久链接"></a>
        </div>

        <p><i>本节不是规范性的。</i></p>
        <p>
            除了现有事件（如 <a data-link-type="dfn" href="https://www.w3.org/TR/uievents/#keydown"><code>keydown</code></a> 和
            <a data-link-type="dfn" href="https://www.w3.org/TR/uievents/#keypress"><code>keypress</code></a> [<cite><a
                    class="bibref" data-link-type="biblio" href="#bib-ui-events" title="UI Events">UI-EVENTS</a></cite>]
            事件）中已存在的
            <a data-link-type="dfn"
                href="https://www.w3.org/TR/fingerprinting-guidance/#dfn-browser-fingerprinting">浏览器指纹识别</a>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-fingerprinting-guidance"
                    title="Mitigating Browser Fingerprinting in Web Specifications">fingerprinting-guidance</a></cite>]
            技术外，此功能没有已知的安全或隐私影响。
        </p>
        <p>
            如果此功能替换现有事件，它 <em class="rfc2119">可能</em> 导致可用的
            <a data-link-type="dfn"
                href="https://www.w3.org/TR/fingerprinting-guidance/#dfn-browser-fingerprinting">指纹识别</a>
            技术减少，因为记录的是用户的意图，而不是他们使用的特定硬件类型来
            <a data-lt="express intention" href="#dfn-express-intention" class="internalDFN" data-link-type="dfn"
                id="ref-for-dfn-express-intention-3">表达</a> 这个意图。
        </p>
    </section>
    <section id="acknowledgements">
        <div class="header-wrapper">
            <h2 id="x10-acknowledgements"><bdi class="secno">10. </bdi>致谢</h2>
            <a class="self-link" href="#acknowledgements" aria-label="第 10 节的永久链接"></a>
        </div>

        <p>
            感谢：Michael Aufreiter, Adrian Bateman, Oliver Buchtala, Robin Berjon, Enrica Casucci, Bo Cupp, Domenic
            Denicola, Emil Eklund, Olivier Forget, Aryeh Gregor, Marijn Haverbeke, Yoshifumi Inoue, Koji Ishii, Gary
            Kacmarcik, Ian Kilpatrick, Frederico Caldeira Knabben, Takayoshi Kochi, Piotrek Koszuliński, Travis
            Leithead, Grisha Lyukshin, Miles Maxfield, Chaals McCathie Nevile, Masayuki Nakano, Ryosuke Niwa, Julie
            Parent, Ben Peters, Florian Rivoal, Morgan Smith, Hallvord R. M. Steen, Johan Sörlin, Cristian Talau, Dave
            Tapuska, Ojan Vafai, Léonie Watson, Xiaoqian Wu, Chong Zhang, Joanmarie 以及编辑任务组中的所有人为他们的意见和反馈。
        </p>
    </section>


    <section id="references" class="appendix">
        <div class="header-wrapper">
            <h2 id="a-references"><bdi class="secno">A. </bdi>参考文献</h2>
            <a class="self-link" href="#references" aria-label="附录 A 的永久链接"></a>
        </div>
        <section id="normative-references">
            <div class="header-wrapper">
                <h3 id="a-1-normative-references"><bdi class="secno">A.1 </bdi>规范性引用</h3>
                <a class="self-link" href="#normative-references" aria-label="附录 A.1 的永久链接"></a>
            </div>

            <dl class="bibliography">
                <dt id="bib-clipboard-apis">[CLIPBOARD-APIS]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/clipboard-apis/"><cite>剪贴板 API 和事件</cite></a>。Gary Kacmarcik; Anupam
                    Snigdha。W3C。2023 年 5 月 16 日。W3C 工作草案。URL: <a
                        href="https://www.w3.org/TR/clipboard-apis/">https://www.w3.org/TR/clipboard-apis/</a>
                </dd>
                <dt id="bib-cssom">[CSSOM]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/cssom-1/"><cite>CSS 对象模型 (CSSOM)</cite></a>。Daniel Glazman; Emilio
                    Cobos Álvarez。W3C。2021 年 8 月 26 日。W3C 工作草案。URL: <a
                        href="https://www.w3.org/TR/cssom-1/">https://www.w3.org/TR/cssom-1/</a>
                </dd>
                <dt id="bib-dom">[DOM]</dt>
                <dd>
                    <a href="https://dom.spec.whatwg.org/"><cite>DOM 标准</cite></a>。Anne van Kesteren。WHATWG。现行标准。URL: <a
                        href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-fileapi">[FileAPI]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/FileAPI/"><cite>文件 API</cite></a>。Marijn Kruisselbrink。W3C。2024 年 5 月
                    24 日。W3C 工作草案。URL: <a href="https://www.w3.org/TR/FileAPI/">https://www.w3.org/TR/FileAPI/</a>
                </dd>
                <dt id="bib-fingerprinting-guidance">[fingerprinting-guidance]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/fingerprinting-guidance/"><cite>减少 Web 规范中的浏览器指纹识别</cite></a>。Nick
                    Doty。W3C。2019 年 3 月 28 日。W3C 工作组注释。URL: <a
                        href="https://www.w3.org/TR/fingerprinting-guidance/">https://www.w3.org/TR/fingerprinting-guidance/</a>
                </dd>
                <dt id="bib-html">[HTML]</dt>
                <dd>
                    <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML 标准</cite></a>。Anne van Kesteren;
                    Domenic Denicola; Ian Hickson; Philip Jägenstedt; Simon Pieters。WHATWG。现行标准。URL: <a
                        href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
                </dd>
                <dt id="bib-infra">[infra]</dt>
                <dd>
                    <a href="https://infra.spec.whatwg.org/"><cite>基础标准</cite></a>。Anne van Kesteren; Domenic
                    Denicola。WHATWG。现行标准。URL: <a
                        href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-mimesniff">[mimesniff]</dt>
                <dd>
                    <a href="https://mimesniff.spec.whatwg.org/"><cite>MIME 嗅探标准</cite></a>。Gordon P.
                    Hemsley。WHATWG。现行标准。URL: <a
                        href="https://mimesniff.spec.whatwg.org/">https://mimesniff.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-rfc2119">[RFC2119]</dt>
                <dd>
                    <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>在 RFC 中指示要求级别的关键字使用</cite></a>。S.
                    Bradner。IETF。1997 年 3 月。最佳当前实践。URL: <a
                        href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
                </dd>
                <dt id="bib-rfc8174">[RFC8174]</dt>
                <dd>
                    <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>RFC 2119 关键字中的大小写歧义</cite></a>。B.
                    Leiba。IETF。2017 年 5 月。最佳当前实践。URL: <a
                        href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
                </dd>
                <dt id="bib-ui-events">[UI-EVENTS]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/uievents/"><cite>用户界面事件</cite></a>。Gary Kacmarcik; Travis
                    Leithead。W3C。2024 年 9 月 7 日。W3C 工作草案。URL: <a
                        href="https://www.w3.org/TR/uievents/">https://www.w3.org/TR/uievents/</a>
                </dd>
                <dt id="bib-webidl">[WEBIDL]</dt>
                <dd>
                    <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL 标准</cite></a>。Edgar Chen; Timothy
                    Gu。WHATWG。现行标准。URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
                </dd>
            </dl>
        </section>
        <section id="informative-references">
            <div class="header-wrapper">
                <h3 id="a-2-informative-references"><bdi class="secno">A.2 </bdi>参考性引用</h3>
                <a class="self-link" href="#informative-references" aria-label="附录 A.2 的永久链接"></a>
            </div>

            <dl class="bibliography">
                <dt id="bib-i18n-glossary">[i18n-glossary]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/i18n-glossary/"><cite>国际化术语表</cite></a>。Richard Ishida; Addison
                    Phillips。W3C。2024 年 4 月 22 日。W3C 工作组注释。URL: <a
                        href="https://www.w3.org/TR/i18n-glossary/">https://www.w3.org/TR/i18n-glossary/</a>
                </dd>
                <dt id="bib-input-events">[INPUT-EVENTS]</dt>
                <dd>
                    <a href="https://www.w3.org/TR/input-events-1/"><cite>输入事件 第 1 级</cite></a>。Johannes Wilm。W3C。2023 年
                    9 月 28 日。W3C 工作草案。URL: <a
                        href="https://www.w3.org/TR/input-events-1/">https://www.w3.org/TR/input-events-1/</a>
                </dd>
            </dl>
        </section>
    </section>
    <p role="navigation" id="back-to-top">
        <a href="#title"><abbr title="回到顶部">↑</abbr></a>
    </p>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-express-intention"
        aria-label="Links in this document to definition: express intention">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-express-intention"
                aria-label="Permalink for definition: express intention. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-express-intention-1" title="§ 3. Definitions">§ 3. Definitions</a>
            </li>
            <li>
                <a href="#ref-for-dfn-express-intention-2" title="§ 6.1.2 Attributes">§ 6.1.2 Attributes</a>
            </li>
            <li>
                <a href="#ref-for-dfn-express-intention-3" title="§ 9. Privacy and security considerations">§ 9. Privacy
                    and security considerations</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-kill-buffer"
        aria-label="Links in this document to definition: kill buffer">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-kill-buffer"
                aria-label="Permalink for definition: kill buffer. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-kill-buffer-1" title="§ 3. Definitions">§ 3. Definitions</a>
            </li>
            <li>
                <a href="#ref-for-dfn-kill-buffer-2" title="§ 6.1.2 Attributes">§ 6.1.2 Attributes</a> <a
                    href="#ref-for-dfn-kill-buffer-3" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-inputeventinit-datatransfer"
        aria-label="Links in this document to definition: dataTransfer">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-inputeventinit-datatransfer"
                aria-label="Permalink for definition: dataTransfer. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-827932857">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-inputeventinit-datatransfer-1" title="§ 6.1 Interface InputEvent">§ 6.1 Interface
                    InputEvent</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-inputeventinit-targetranges"
        aria-label="Links in this document to definition: targetRanges">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-inputeventinit-targetranges"
                aria-label="Permalink for definition: targetRanges. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-827932857">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-inputeventinit-targetranges-1" title="§ 6.1 Interface InputEvent">§ 6.1 Interface
                    InputEvent</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-data"
        aria-label="Links in this document to definition: data">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-data"
                aria-label="Permalink for definition: data. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-data-1" title="§ 6.1.1 Overview">§ 6.1.1 Overview</a>
            </li>
            <li>
                <a href="#ref-for-dfn-data-2" title="§ 6.2 Event definitions">§ 6.2 Event definitions</a> <a
                    href="#ref-for-dfn-data-3" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-data-4" title="§ 7. Input Event Order During Composition">§ 7. Input Event Order
                    During Composition</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-inputevent-datatransfer"
        aria-label="Links in this document to definition: dataTransfer">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-inputevent-datatransfer"
                aria-label="Permalink for definition: dataTransfer. Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-827932857">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-inputevent-datatransfer-1" title="§ 6.1 Interface InputEvent">§ 6.1 Interface
                    InputEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-inputevent-datatransfer-2" title="§ 6.1.1 Overview">§ 6.1.1 Overview</a>
            </li>
            <li>
                <a href="#ref-for-dom-inputevent-datatransfer-3" title="§ 6.2 Event definitions">§ 6.2 Event
                    definitions</a> <a href="#ref-for-dom-inputevent-datatransfer-4" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-inputevent-gettargetranges"
        aria-label="Links in this document to definition: getTargetRanges()">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dom-inputevent-gettargetranges"
                aria-label="Permalink for definition: getTargetRanges(). Activate to close this dialog.">Permalink</a>
            <span class="marker dfn-exported"
                title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block"
                title="Jump to IDL declaration" href="#webidl-827932857">IDL</a>
        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dom-inputevent-gettargetranges-1" title="§ 6.1 Interface InputEvent">§ 6.1 Interface
                    InputEvent</a>
            </li>
            <li>
                <a href="#ref-for-dom-inputevent-gettargetranges-2" title="§ 6.1.1 Overview">§ 6.1.1 Overview</a>
            </li>
            <li>
                <a href="#ref-for-dom-inputevent-gettargetranges-3" title="§ 6.2 Event definitions">§ 6.2 Event
                    definitions</a>
            </li>
            <li>
                <a href="#ref-for-dom-inputevent-gettargetranges-4" title="§ 7. Input Event Order During Composition">§
                    7. Input Event Order During Composition</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-beforeinput"
        aria-label="Links in this document to definition: beforeinput">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-beforeinput"
                aria-label="Permalink for definition: beforeinput. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-beforeinput-1" title="§ 4. Problems solved">§ 4. Problems solved</a>
            </li>
            <li>
                <a href="#ref-for-dfn-beforeinput-2" title="§ 7. Input Event Order During Composition">§ 7. Input Event
                    Order During Composition</a> <a href="#ref-for-dfn-beforeinput-3" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-beforeinput-4" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-beforeinput-5" title="§ 8. Event order when using &quot;insertFromPaste&quot;">§
                    8. Event order when using "insertFromPaste"</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-input"
        aria-label="Links in this document to definition: input">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-input"
                aria-label="Permalink for definition: input. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-input-1" title="§ 4. Problems solved">§ 4. Problems solved</a>
            </li>
            <li>
                <a href="#ref-for-dfn-input-2" title="§ 6. Input Event Types">§ 6. Input Event Types</a>
            </li>
            <li>
                <a href="#ref-for-dfn-input-3" title="§ 7. Input Event Order During Composition">§ 7. Input Event Order
                    During Composition</a> <a href="#ref-for-dfn-input-4" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-input-5" title="Reference 3">(3)</a>
            </li>
        </ul>
    </div>
    <script id="respec-dfn-panel">(() => {
            // @ts-check
            if (document.respec) {
                document.respec.ready.then(setupPanel);
            } else {
                setupPanel();
            }

            function setupPanel() {
                const listener = panelListener();
                document.body.addEventListener("keydown", listener);
                document.body.addEventListener("click", listener);
            }

            function panelListener() {
                /** @type {HTMLElement} */
                let panel = null;
                return event => {
                    const { target, type } = event;

                    if (!(target instanceof HTMLElement)) return;

                    // For keys, we only care about Enter key to activate the panel
                    // otherwise it's activated via a click.
                    if (type === "keydown" && event.key !== "Enter") return;

                    const action = deriveAction(event);

                    switch (action) {
                        case "show": {
                            hidePanel(panel);
                            /** @type {HTMLElement} */
                            const dfn = target.closest("dfn, .index-term");
                            panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
                            const coords = deriveCoordinates(event);
                            displayPanel(dfn, panel, coords);
                            break;
                        }
                        case "dock": {
                            panel.style.left = null;
                            panel.style.top = null;
                            panel.classList.add("docked");
                            break;
                        }
                        case "hide": {
                            hidePanel(panel);
                            panel = null;
                            break;
                        }
                    }
                };
            }

            /**
             * @param {MouseEvent|KeyboardEvent} event
             */
            function deriveCoordinates(event) {
                const target = /** @type HTMLElement */ (event.target);

                // We prevent synthetic AT clicks from putting
                // the dialog in a weird place. The AT events sometimes
                // lack coordinates, so they have clientX/Y = 0
                const rect = target.getBoundingClientRect();
                if (
                    event instanceof MouseEvent &&
                    event.clientX >= rect.left &&
                    event.clientY >= rect.top
                ) {
                    // The event probably happened inside the bounding rect...
                    return { x: event.clientX, y: event.clientY };
                }

                // Offset to the middle of the element
                const x = rect.x + rect.width / 2;
                // Placed at the bottom of the element
                const y = rect.y + rect.height;
                return { x, y };
            }

            /**
             * @param {Event} event
             */
            function deriveAction(event) {
                const target = /** @type {HTMLElement} */ (event.target);
                const hitALink = !!target.closest("a");
                if (target.closest("dfn:not([data-cite]), .index-term")) {
                    return hitALink ? "none" : "show";
                }
                if (target.closest(".dfn-panel")) {
                    if (hitALink) {
                        return target.classList.contains("self-link") ? "hide" : "dock";
                    }
                    const panel = target.closest(".dfn-panel");
                    return panel.classList.contains("docked") ? "hide" : "none";
                }
                if (document.querySelector(".dfn-panel:not([hidden])")) {
                    return "hide";
                }
                return "none";
            }

            /**
             * @param {HTMLElement} dfn
             * @param {HTMLElement} panel
             * @param {{ x: number, y: number }} clickPosition
             */
            function displayPanel(dfn, panel, { x, y }) {
                panel.hidden = false;
                // distance (px) between edge of panel and the pointing triangle (caret)
                const MARGIN = 20;

                const dfnRects = dfn.getClientRects();
                // Find the `top` offset when the `dfn` can be spread across multiple lines
                let closestTop = 0;
                let minDiff = Infinity;
                for (const rect of dfnRects) {
                    const { top, bottom } = rect;
                    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
                    if (diffFromClickY < minDiff) {
                        minDiff = diffFromClickY;
                        closestTop = top;
                    }
                }

                const top = window.scrollY + closestTop + dfnRects[0].height;
                const left = x - MARGIN;
                panel.style.left = `${left}px`;
                panel.style.top = `${top}px`;

                // Find if the panel is flowing out of the window
                const panelRect = panel.getBoundingClientRect();
                const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
                if (panelRect.right > SCREEN_WIDTH) {
                    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
                    const newCaretOffset = left - newLeft;
                    panel.style.left = `${newLeft}px`;
                    /** @type {HTMLElement} */
                    const caret = panel.querySelector(".caret");
                    caret.style.left = `${newCaretOffset}px`;
                }

                // As it's a dialog, we trap focus.
                // TODO: when <dialog> becomes a implemented, we should really
                // use that.
                trapFocus(panel, dfn);
            }

            /**
             * @param {HTMLElement} panel
             * @param {HTMLElement} dfn
             * @returns
             */
            function trapFocus(panel, dfn) {
                /** @type NodeListOf<HTMLAnchorElement> elements */
                const anchors = panel.querySelectorAll("a[href]");
                // No need to trap focus
                if (!anchors.length) return;

                // Move focus to first anchor element
                const first = anchors.item(0);
                first.focus();

                const trapListener = createTrapListener(anchors, panel, dfn);
                panel.addEventListener("keydown", trapListener);

                // Hiding the panel releases the trap
                const mo = new MutationObserver(records => {
                    const [record] = records;
                    const target = /** @type HTMLElement */ (record.target);
                    if (target.hidden) {
                        panel.removeEventListener("keydown", trapListener);
                        mo.disconnect();
                    }
                });
                mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
            }

            /**
             *
             * @param {NodeListOf<HTMLAnchorElement>} anchors
             * @param {HTMLElement} panel
             * @param {HTMLElement} dfn
             * @returns
             */
            function createTrapListener(anchors, panel, dfn) {
                const lastIndex = anchors.length - 1;
                let currentIndex = 0;
                return event => {
                    switch (event.key) {
                        // Hitting "Tab" traps us in a nice loop around elements.
                        case "Tab": {
                            event.preventDefault();
                            currentIndex += event.shiftKey ? -1 : +1;
                            if (currentIndex < 0) {
                                currentIndex = lastIndex;
                            } else if (currentIndex > lastIndex) {
                                currentIndex = 0;
                            }
                            anchors.item(currentIndex).focus();
                            break;
                        }

                        // Hitting "Enter" on an anchor releases the trap.
                        case "Enter":
                            hidePanel(panel);
                            break;

                        // Hitting "Escape" returns focus to dfn.
                        case "Escape":
                            hidePanel(panel);
                            dfn.focus();
                            return;
                    }
                };
            }

            /** @param {HTMLElement} panel */
            function hidePanel(panel) {
                if (!panel) return;
                panel.hidden = true;
                panel.classList.remove("docked");
            }
        })()</script>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <script src="/dropdown.js"></script>
</body>

</html>