<!DOCTYPE html><html class=split lang=en-US-x-hixie><script src=/link-fixup.js defer=""></script><meta charset=utf-8><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name=viewport><title>HTML 标准，适用于网页开发者的版本</title><meta content=#3c790a name=theme-color><meta content="light dark" name=color-scheme><link rel=stylesheet href=https://resources.whatwg.org/standard-shared-with-dev.css crossorigin=""><link rel=icon href=https://resources.whatwg.org/logo.svg crossorigin=""><link rel=stylesheet href=/dev/styles.css crossorigin=""><script>
    function toggleStatus(div) {
      div.parentNode.classList.toggle('wrapped');
    }
    function setLinkFragment(link) {
      link.hash = location.hash;
    }
  </script><body>
  <script async="" src=/dev/search.js></script>
  
  
  <header id=head class="head with-buttons">
    <a href=https://whatwg.org/ class=logo><img width=100 alt=WHATWG crossorigin="" class=darkmode-aware src=https://resources.whatwg.org/logo.svg height=100></a>
    
    <hgroup><h1><a rel=home href=/dev/>HTML: 现行标准</a></h1><p id=dev-edition-h2>适用于网页开发者的版本 — 上次更新 <span class=pubdate>7 September 2024</span></hgroup>
    

    <div id=search>
      <input placeholder="搜索。按 '/' 键" autocomplete=off name=query id=query type=search>
      <ol id=results></ol>
    </div>
  </header>

  

  

  

  
  

  
  

  

  <nav><a href=web-messaging.html>← 9.3 Cross-document messaging</a> — <a href=./>Table of Contents</a> — <a href=worklets.html>11 Worklets →</a></nav><ol class=toc><li><a href=workers.html#workers><span class=secno>10</span> Web workers</a><ol><li><a href=workers.html#introduction-13><span class=secno>10.1</span> Introduction</a><ol><li><a href=workers.html#scope-2><span class=secno>10.1.1</span> Scope</a><li><a href=workers.html#examples-6><span class=secno>10.1.2</span> Examples</a><ol><li><a href=workers.html#a-background-number-crunching-worker><span class=secno>10.1.2.1</span> A background number-crunching worker</a><li><a href=workers.html#module-worker-example><span class=secno>10.1.2.2</span> Using a JavaScript module as a worker</a><li><a href=workers.html#shared-workers-introduction><span class=secno>10.1.2.3</span> Shared workers introduction</a><li><a href=workers.html#shared-state-using-a-shared-worker><span class=secno>10.1.2.4</span> Shared state using a shared worker</a><li><a href=workers.html#delegation><span class=secno>10.1.2.5</span> Delegation</a><li><a href=workers.html#providing-libraries><span class=secno>10.1.2.6</span> Providing libraries</a></ol><li><a href=workers.html#tutorials><span class=secno>10.1.3</span> Tutorials</a><ol><li><a href=workers.html#creating-a-dedicated-worker><span class=secno>10.1.3.1</span> Creating a dedicated worker</a><li><a href=workers.html#communicating-with-a-dedicated-worker><span class=secno>10.1.3.2</span> Communicating with a dedicated worker</a><li><a href=workers.html#shared-workers><span class=secno>10.1.3.3</span> Shared workers</a></ol></ol><li><a href=workers.html#infrastructure-2><span class=secno>10.2</span> Infrastructure</a><ol><li><a href=workers.html#the-global-scope><span class=secno>10.2.1</span> The global scope</a><ol><li><a href=workers.html#the-workerglobalscope-common-interface><span class=secno>10.2.1.1</span> The <code>WorkerGlobalScope</code> common interface</a><li><a href=workers.html#dedicated-workers-and-the-dedicatedworkerglobalscope-interface><span class=secno>10.2.1.2</span> Dedicated workers and the <code>DedicatedWorkerGlobalScope</code> interface</a><li><a href=workers.html#shared-workers-and-the-sharedworkerglobalscope-interface><span class=secno>10.2.1.3</span> Shared workers and the <code>SharedWorkerGlobalScope</code> interface</a></ol><li><a href=workers.html#worker-event-loop><span class=secno>10.2.2</span> The event loop</a><li><a href=workers.html#runtime-script-errors-2><span class=secno>10.2.3</span> Runtime script errors</a><li><a href=workers.html#creating-workers><span class=secno>10.2.4</span> Creating workers</a><ol><li><a href=workers.html#properties-present-on-both-worker-and-sharedworker><span class=secno>10.2.4.1</span> Properties present on both <code>Worker</code> and <code>SharedWorker</code></a><li><a href=workers.html#dedicated-workers-and-the-worker-interface><span class=secno>10.2.4.2</span> Dedicated workers and the <code>Worker</code> interface</a><li><a href=workers.html#shared-workers-and-the-sharedworker-interface><span class=secno>10.2.4.3</span> Shared workers and the <code>SharedWorker</code> interface</a></ol><li><a href=workers.html#navigator.hardwareconcurrency><span class=secno>10.2.5</span> Concurrent hardware capabilities</a></ol><li><a href=workers.html#apis-available-to-workers><span class=secno>10.3</span> APIs available to workers</a><ol><li><a href=workers.html#the-workernavigator-object><span class=secno>10.3.1</span> The <code>WorkerNavigator</code> interface</a><li><a href=workers.html#worker-locations><span class=secno>10.3.2</span> The <code>WorkerLocation</code> interface</a></ol></ol></ol><h2 data-lt="web worker" data-export="" id=workers data-dfn-type=dfn><span class=secno>10</span> Web workers<a href=#workers class=self-link></a></h2><div class="mdn-anno wrapped"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API title="Web Workers makes it possible to run a script operation in a background thread separate from the main execution thread of a web application. The advantage of this is that laborious processing can be performed in a separate thread, allowing the main (usually the UI) thread to run without being blocked/slowed down.">Web_Workers_API</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>3.5+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>2+</span></span><hr><span class="opera yes"><span>Opera</span><span>10.6+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>10+</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>5+</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android yes"><span>Opera Android</span><span>11+</span></span></div></div><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers title="Web Workers are a simple means for web content to run scripts in background threads. The worker thread can perform tasks without interfering with the user interface. In addition, they can perform I/O using XMLHttpRequest (although the responseXML and channel attributes are always null) or fetch (with no such restrictions). Once created, a worker can send messages to the JavaScript code that created it by posting messages to an event handler specified by that code (and vice versa).">Web_Workers_API/Using_web_workers</a></div></div>

  <h3 id=introduction-13><span class=secno>10.1</span> Introduction<a href=#introduction-13 class=self-link></a></h3>

  <h4 id=scope-2><span class=secno>10.1.1</span> Scope<a href=#scope-2 class=self-link></a></h4>

  

  <p>This specification defines an API for running scripts in the background independently of any
    user interface scripts.</p>

  <p>This allows for long-running scripts that are not interrupted by scripts that respond to clicks
    or other user interactions, and allows long tasks to be executed without yielding to keep the page
    responsive.</p>

  <p>Workers (as these background scripts are called herein) are relatively heavy-weight, and are
    not intended to be used in large numbers. For example, it would be inappropriate to launch one
    worker for each pixel of a four megapixel image. The examples below show some appropriate uses of
    workers.</p>

  <p>Generally, workers are expected to be long-lived, have a high start-up performance cost, and a
    high per-instance memory cost.</p>


  <h4 id=examples-6><span class=secno>10.1.2</span> Examples<a href=#examples-6 class=self-link></a></h4>

  

  <p>There are a variety of uses that workers can be put to. The following subsections show various
    examples of this use.</p>


  <h5 id=a-background-number-crunching-worker><span class=secno>10.1.2.1</span> A background number-crunching worker<a href=#a-background-number-crunching-worker class=self-link></a></h5>

  

  <p>The simplest use of workers is for performing a computationally
    expensive task without interrupting the user interface.</p>

  <p>In this example, the main document spawns a worker to (naïvely) compute prime numbers, and
    progressively displays the most recently found prime number.</p>

  <p>The main page is as follows:</p>

  <pre><code class=html>&lt;!DOCTYPE HTML>
&lt;html lang="en">
 &lt;head>
  &lt;meta charset="utf-8">
  &lt;title>Worker example: One-core computation&lt;/title>
 &lt;/head>
 &lt;body>
  &lt;p>The highest prime number discovered so far is: &lt;output id="result">&lt;/output>&lt;/p>
  &lt;script>
   var worker = new Worker('worker.js');
   worker.onmessage = function (event) {
     document.getElementById('result').textContent = event.data;
   };
  &lt;/script>
 &lt;/body>
&lt;/html>
</code></pre>

  <p>The <code id=a-background-number-crunching-worker:dom-worker><a href=#dom-worker>Worker()</a></code> constructor call creates a worker and returns a
    <code id=a-background-number-crunching-worker:worker-2><a href=#worker-2>Worker</a></code> object representing that worker, which is used to communicate with the worker.
    That object's <code id=a-background-number-crunching-worker:handler-worker-onmessage><a href=#handler-worker-onmessage>onmessage</a></code> event handler allows the
    code to receive messages from the worker.
  </p>

  <p>The worker itself is as follows:</p>

  <pre><code class=js>var n = 1;
search: while (true) {
  n += 1;
  for (var i = 2; i &lt;= Math.sqrt(n); i += 1)
    if (n % i == 0)
     continue search;
  // found a prime!
  postMessage(n);
}
</code></pre>

  <p>The bulk of this code is simply an unoptimized search for a prime number. The <code id=a-background-number-crunching-worker:dom-dedicatedworkerglobalscope-postmessage><a href=#dom-dedicatedworkerglobalscope-postmessage>postMessage()</a></code> method is used to send a
    message back to the page when a prime is found.</p>

  <p><a href=/demos/workers/primes/page.html>View this example online</a>.</p>


  <h5 id=module-worker-example><span class=secno>10.1.2.2</span> Using a JavaScript module as a worker<a href=#module-worker-example class=self-link></a></h5>

  

  <p>All of our examples so far show workers that run <span>classic
      scripts</span>. Workers can instead be instantiated using <span>module
      scripts</span>, which have the usual benefits: the ability to use the JavaScript
    <code>import</code> statement to import other modules; strict mode by default; and
    top-level declarations not polluting the worker's global scope.
  </p>

  <p>As the <code>import</code> statement is available, the <code id=module-worker-example:dom-workerglobalscope-importscripts><a href=#dom-workerglobalscope-importscripts>importScripts()</a></code> method will automatically fail
    inside module workers.</p>

  <p>In this example, the main document uses a worker to do off-main-thread image manipulation.
    It imports the filters used from another module.</p>

  <p>The main page is as follows:</p>

  <pre><code class=html>&lt;!DOCTYPE html>
&lt;html lang="en">
&lt;meta charset="utf-8">
&lt;title>Worker example: image decoding&lt;/title>

&lt;p>
  &lt;label>
    Type an image URL to decode
    &lt;input type="url" id="image-url" list="image-list">
    &lt;datalist id="image-list">
      &lt;option value="https://html.spec.whatwg.org/images/drawImage.png">
      &lt;option value="https://html.spec.whatwg.org/images/robots.jpeg">
      &lt;option value="https://html.spec.whatwg.org/images/arcTo2.png">
    &lt;/datalist>
  &lt;/label>
&lt;/p>

&lt;p>
  &lt;label>
    Choose a filter to apply
    &lt;select id="filter">
      &lt;option value="none">none&lt;/option>
      &lt;option value="grayscale">grayscale&lt;/option>
      &lt;option value="brighten">brighten by 20%&lt;/option>
    &lt;/select>
  &lt;/label>
&lt;/p>

&lt;div id="output">&lt;/div>

&lt;script type="module">
  const worker = new Worker("worker.js", { type: "module" });
  worker.onmessage = receiveFromWorker;

  const url = document.querySelector("#image-url");
  const filter = document.querySelector("#filter");
  const output = document.querySelector("#output");

  url.oninput = updateImage;
  filter.oninput = sendToWorker;

  let imageData, context;

  function updateImage() {
    const img = new Image();
    img.src = url.value;

    img.onload = () => {
      const canvas = document.createElement("canvas");
      canvas.width = img.width;
      canvas.height = img.height;

      context = canvas.getContext("2d");
      context.drawImage(img, 0, 0);
      imageData = context.getImageData(0, 0, canvas.width, canvas.height);

      sendToWorker();
      output.replaceChildren(canvas);
    };
  }

  function sendToWorker() {
    worker.postMessage({ imageData, filter: filter.value });
  }

  function receiveFromWorker(e) {
    context.putImageData(e.data, 0, 0);
  }
&lt;/script>
</code></pre>

  <p>The worker file is then:</p>

  <pre><code class=js>import * as filters from "./filters.js";

self.onmessage = e => {
  const { imageData, filter } = e.data;
  filters[filter](imageData);
  self.postMessage(imageData, [imageData.data.buffer]);
};
</code></pre>

  <p>Which imports the file <code>filters.js</code>:</p>

  <pre><code class=js>export function none() {}

export function grayscale({ data: d }) {
  for (let i = 0; i &lt; d.length; i += 4) {
    const [r, g, b] = [d[i], d[i + 1], d[i + 2]];

    // CIE luminance for the RGB
    // The human eye is bad at seeing red and blue, so we de-emphasize them.
    d[i] = d[i + 1] = d[i + 2] = 0.2126 * r + 0.7152 * g + 0.0722 * b;
  }
};

export function brighten({ data: d }) {
  for (let i = 0; i &lt; d.length; ++i) {
    d[i] *= 1.2;
  }
};
</code></pre>

  <p><a href=/demos/workers/modules/page.html>View this example online</a>.</p>


  <h5 id=shared-workers-introduction><span class=secno>10.1.2.3</span> Shared workers introduction<a href=#shared-workers-introduction class=self-link></a></h5><div class="mdn-anno wrapped"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker title="The SharedWorker interface represents a specific kind of worker that can be accessed from several browsing contexts, such as several windows, iframes or even workers. They implement an interface different than dedicated workers and have a different global scope, SharedWorkerGlobalScope.">SharedWorker</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>29+</span></span><span class="safari yes"><span>Safari</span><span>16+</span></span><span class="chrome yes"><span>Chrome</span><span>5+</span></span><hr><span class="opera yes"><span>Opera</span><span>10.6+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge unknown"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>Internet Explorer</span><span>No</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>33+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>16+</span></span><span class="chrome_android no"><span>Chrome Android</span><span>No</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>4.0–5.0</span></span><span class="opera_android no"><span>Opera Android</span><span>11–14</span></span></div></div></div>

  

  <p>This section introduces shared workers using a Hello World example. Shared workers use slightly
    different APIs, since each worker can have multiple connections.</p>

  <p>This first example shows how you connect to a worker and how a worker can send a message back
    to the page when it connects to it. Received messages are displayed in a log.</p>

  <p>Here is the HTML page:</p>

  <pre><code class=html>&lt;!DOCTYPE HTML>
&lt;html lang="en">
&lt;meta charset="utf-8">
&lt;title>Shared workers: demo 1&lt;/title>
&lt;pre id="log">Log:&lt;/pre>
&lt;script>
  var worker = new SharedWorker('test.js');
  var log = document.getElementById('log');
  worker.port.onmessage = function(e) { // note: not worker.onmessage!
    log.textContent += '\n' + e.data;
  }
&lt;/script>
</code></pre>

  <p>Here is the JavaScript worker:</p>

  <pre><code class=js>onconnect = function(e) {
  var port = e.ports[0];
  port.postMessage('Hello World!');
}
</code></pre>

  <p><a href=/demos/workers/shared/001/test.html>View this example online</a>.</p>

  <hr>

  <p>This second example extends the first one by changing two things: first, messages are received
    using <code>addEventListener()</code> instead of an <a href=webappapis.html#event-handler-idl-attributes id=shared-workers-introduction:event-handler-idl-attributes>event handler IDL attribute</a>, and second, a message is sent <em>to</em> the
    worker, causing the worker to send another message in return. Received messages are again
    displayed in a log.</p>

  <p>Here is the HTML page:</p>

  <pre><code class=html>&lt;!DOCTYPE HTML>
&lt;html lang="en">
&lt;meta charset="utf-8">
&lt;title>Shared workers: demo 2&lt;/title>
&lt;pre id="log">Log:&lt;/pre>
&lt;script>
  var worker = new SharedWorker('test.js');
  var log = document.getElementById('log');
  worker.port.addEventListener('message', function(e) {
    log.textContent += '\n' + e.data;
  }, false);
  worker.port.start(); // note: need this when using addEventListener
  worker.port.postMessage('ping');
&lt;/script>
</code></pre>

  <p>Here is the JavaScript worker:</p>

  <pre><code class=js>onconnect = function(e) {
  var port = e.ports[0];
  port.postMessage('Hello World!');
  port.onmessage = function(e) {
    port.postMessage('pong'); // not e.ports[0].postMessage!
    // e.target.postMessage('pong'); would work also
  }
}
</code></pre>

  <p><a href=/demos/workers/shared/002/test.html>View this example online</a>.</p>

  <hr>

  <p>Finally, the example is extended to show how two pages can connect to the same worker; in this
    case, the second page is merely in an <code id=shared-workers-introduction:the-iframe-element><a href=iframe-embed-object.html#the-iframe-element>iframe</a></code> on the first page, but the same
    principle would apply to an entirely separate page in a separate <a id=shared-workers-introduction:top-level-traversable href=document-sequences.html#top-level-traversable>top-level
      traversable</a>.</p>

  <p>Here is the outer HTML page:</p>

  <pre><code class=html>&lt;!DOCTYPE HTML>
&lt;html lang="en">
&lt;meta charset="utf-8">
&lt;title>Shared workers: demo 3&lt;/title>
&lt;pre id="log">Log:&lt;/pre>
&lt;script>
  var worker = new SharedWorker('test.js');
  var log = document.getElementById('log');
  worker.port.addEventListener('message', function(e) {
    log.textContent += '\n' + e.data;
  }, false);
  worker.port.start();
  worker.port.postMessage('ping');
&lt;/script>
&lt;iframe src="inner.html">&lt;/iframe>
</code></pre>

  <p>Here is the inner HTML page:</p>

  <pre><code class=html>&lt;!DOCTYPE HTML>
&lt;html lang="en">
&lt;meta charset="utf-8">
&lt;title>Shared workers: demo 3 inner frame&lt;/title>
&lt;pre id=log>Inner log:&lt;/pre>
&lt;script>
  var worker = new SharedWorker('test.js');
  var log = document.getElementById('log');
  worker.port.onmessage = function(e) {
   log.textContent += '\n' + e.data;
  }
&lt;/script>
</code></pre>

  <p>Here is the JavaScript worker:</p>

  <pre><code class=js>var count = 0;
onconnect = function(e) {
  count += 1;
  var port = e.ports[0];
  port.postMessage('Hello World! You are connection #' + count);
  port.onmessage = function(e) {
    port.postMessage('pong');
  }
}
</code></pre>

  <p><a href=/demos/workers/shared/003/test.html>View this example online</a>.</p>


  <h5 id=shared-state-using-a-shared-worker><span class=secno>10.1.2.4</span> Shared state using a shared worker<a href=#shared-state-using-a-shared-worker class=self-link></a></h5>

  

  <p>In this example, multiple windows (viewers) can be opened that are all viewing the same map.
    All the windows share the same map information, with a single worker coordinating all the viewers.
    Each viewer can move around independently, but if they set any data on the map, all the viewers
    are updated.</p>

  <p>The main page isn't interesting, it merely provides a way to open the viewers:</p>

  <pre><code class=html>&lt;!DOCTYPE HTML>
&lt;html lang="en">
 &lt;head>
  &lt;meta charset="utf-8">
  &lt;title>Workers example: Multiviewer&lt;/title>
  &lt;script>
   function openViewer() {
     window.open('viewer.html');
   }
  &lt;/script>
 &lt;/head>
 &lt;body>
  &lt;p>&lt;button type=button onclick="openViewer()">Open a new
  viewer&lt;/button>&lt;/p>
  &lt;p>Each viewer opens in a new window. You can have as many viewers
  as you like, they all view the same data.&lt;/p>
 &lt;/body>
&lt;/html>
</code></pre>

  <p>The viewer is more involved:</p>

  <pre><code class=html>&lt;!DOCTYPE HTML>
&lt;html lang="en">
 &lt;head>
  &lt;meta charset="utf-8">
  &lt;title>Workers example: Multiviewer viewer&lt;/title>
  &lt;script>
   var worker = new SharedWorker('worker.js', 'core');

   // CONFIGURATION
   function configure(event) {
     if (event.data.substr(0, 4) != 'cfg ') return;
     var name = event.data.substr(4).split(' ', 1)[0];
     // update display to mention our name is name
     document.getElementsByTagName('h1')[0].textContent += ' ' + name;
     // no longer need this listener
     worker.port.removeEventListener('message', configure, false);
   }
   worker.port.addEventListener('message', configure, false);

   // MAP
   function paintMap(event) {
     if (event.data.substr(0, 4) != 'map ') return;
     var data = event.data.substr(4).split(',');
     // display tiles data[0] .. data[8]
     var canvas = document.getElementById('map');
     var context = canvas.getContext('2d');
     for (var y = 0; y &lt; 3; y += 1) {
       for (var x = 0; x &lt; 3; x += 1) {
         var tile = data[y * 3 + x];
         if (tile == '0')
           context.fillStyle = 'green';
         else
           context.fillStyle = 'maroon';
         context.fillRect(x * 50, y * 50, 50, 50);
       }
     }
   }
   worker.port.addEventListener('message', paintMap, false);

   // PUBLIC CHAT
   function updatePublicChat(event) {
     if (event.data.substr(0, 4) != 'txt ') return;
     var name = event.data.substr(4).split(' ', 1)[0];
     var message = event.data.substr(4 + name.length + 1);
     // display "&lt;name> message" in public chat
     var public = document.getElementById('public');
     var p = document.createElement('p');
     var n = document.createElement('button');
     n.textContent = '&lt;' + name + '> ';
     n.onclick = function () { worker.port.postMessage('msg ' + name); };
     p.appendChild(n);
     var m = document.createElement('span');
     m.textContent = message;
     p.appendChild(m);
     public.appendChild(p);
   }
   worker.port.addEventListener('message', updatePublicChat, false);

   // PRIVATE CHAT
   function startPrivateChat(event) {
     if (event.data.substr(0, 4) != 'msg ') return;
     var name = event.data.substr(4).split(' ', 1)[0];
     var port = event.ports[0];
     // display a private chat UI
     var ul = document.getElementById('private');
     var li = document.createElement('li');
     var h3 = document.createElement('h3');
     h3.textContent = 'Private chat with ' + name;
     li.appendChild(h3);
     var div = document.createElement('div');
     var addMessage = function(name, message) {
       var p = document.createElement('p');
       var n = document.createElement('strong');
       n.textContent = '&lt;' + name + '> ';
       p.appendChild(n);
       var t = document.createElement('span');
       t.textContent = message;
       p.appendChild(t);
       div.appendChild(p);
     };
     port.onmessage = function (event) {
       addMessage(name, event.data);
     };
     li.appendChild(div);
     var form = document.createElement('form');
     var p = document.createElement('p');
     var input = document.createElement('input');
     input.size = 50;
     p.appendChild(input);
     p.appendChild(document.createTextNode(' '));
     var button = document.createElement('button');
     button.textContent = 'Post';
     p.appendChild(button);
     form.onsubmit = function () {
       port.postMessage(input.value);
       addMessage('me', input.value);
       input.value = '';
       return false;
     };
     form.appendChild(p);
     li.appendChild(form);
     ul.appendChild(li);
   }
   worker.port.addEventListener('message', startPrivateChat, false);

   worker.port.start();
  &lt;/script>
 &lt;/head>
 &lt;body>
  &lt;h1>Viewer&lt;/h1>
  &lt;h2>Map&lt;/h2>
  &lt;p>&lt;canvas id="map" height=150 width=150>&lt;/canvas>&lt;/p>
  &lt;p>
   &lt;button type=button onclick="worker.port.postMessage('mov left')">Left&lt;/button>
   &lt;button type=button onclick="worker.port.postMessage('mov up')">Up&lt;/button>
   &lt;button type=button onclick="worker.port.postMessage('mov down')">Down&lt;/button>
   &lt;button type=button onclick="worker.port.postMessage('mov right')">Right&lt;/button>
   &lt;button type=button onclick="worker.port.postMessage('set 0')">Set 0&lt;/button>
   &lt;button type=button onclick="worker.port.postMessage('set 1')">Set 1&lt;/button>
  &lt;/p>
  &lt;h2>Public Chat&lt;/h2>
  &lt;div id="public">&lt;/div>
  &lt;form onsubmit="worker.port.postMessage('txt ' + message.value); message.value = ''; return false;">
   &lt;p>
    &lt;input type="text" name="message" size="50">
    &lt;button>Post&lt;/button>
   &lt;/p>
  &lt;/form>
  &lt;h2>Private Chat&lt;/h2>
  &lt;ul id="private">&lt;/ul>
 &lt;/body>
&lt;/html>
</code></pre>

  <p>There are several key things worth noting about the way the viewer is written.</p>

  <p><strong>Multiple listeners</strong>. Instead of a single message processing function, the code
    here attaches multiple event listeners, each one performing a quick check to see if it is relevant
    for the message. In this example it doesn't make much difference, but if multiple authors wanted
    to collaborate using a single port to communicate with a worker, it would allow for independent
    code instead of changes having to all be made to a single event handling function.</p>

  <p>Registering event listeners in this way also allows you to unregister specific listeners when
    you are done with them, as is done with the <code>configure()</code> method in this
    example.</p>

  <p>Finally, the worker:</p>

  <pre><code class=js>
var nextName = 0;
function getNextName() {
  // this could use more friendly names
  // but for now just return a number
  return nextName++;
}

var map = [
 [0, 0, 0, 0, 0, 0, 0],
 [1, 1, 0, 1, 0, 1, 1],
 [0, 1, 0, 1, 0, 0, 0],
 [0, 1, 0, 1, 0, 1, 1],
 [0, 0, 0, 1, 0, 0, 0],
 [1, 0, 0, 1, 1, 1, 1],
 [1, 1, 0, 1, 1, 0, 1],
];

function wrapX(x) {
  if (x &lt; 0) return wrapX(x + map[0].length);
  if (x >= map[0].length) return wrapX(x - map[0].length);
  return x;
}

function wrapY(y) {
  if (y &lt; 0) return wrapY(y + map.length);
  if (y >= map[0].length) return wrapY(y - map.length);
  return y;
}

function wrap(val, min, max) {
  if (val &lt; min)
    return val + (max-min)+1;
  if (val > max)
    return val - (max-min)-1;
  return val;
}

function sendMapData(viewer) {
  var data = '';
  for (var y = viewer.y-1; y &lt;= viewer.y+1; y += 1) {
    for (var x = viewer.x-1; x &lt;= viewer.x+1; x += 1) {
      if (data != '')
        data += ',';
      data += map[wrap(y, 0, map[0].length-1)][wrap(x, 0, map.length-1)];
    }
  }
  viewer.port.postMessage('map ' + data);
}

var viewers = {};
onconnect = function (event) {
  var name = getNextName();
  event.ports[0]._data = { port: event.ports[0], name: name, x: 0, y: 0, };
  viewers[name] = event.ports[0]._data;
  event.ports[0].postMessage('cfg ' + name);
  event.ports[0].onmessage = getMessage;
  sendMapData(event.ports[0]._data);
};

function getMessage(event) {
  switch (event.data.substr(0, 4)) {
    case 'mov ':
      var direction = event.data.substr(4);
      var dx = 0;
      var dy = 0;
      switch (direction) {
        case 'up': dy = -1; break;
        case 'down': dy = 1; break;
        case 'left': dx = -1; break;
        case 'right': dx = 1; break;
      }
      event.target._data.x = wrapX(event.target._data.x + dx);
      event.target._data.y = wrapY(event.target._data.y + dy);
      sendMapData(event.target._data);
      break;
    case 'set ':
      var value = event.data.substr(4);
      map[event.target._data.y][event.target._data.x] = value;
      for (var viewer in viewers)
        sendMapData(viewers[viewer]);
      break;
    case 'txt ':
      var name = event.target._data.name;
      var message = event.data.substr(4);
      for (var viewer in viewers)
        viewers[viewer].port.postMessage('txt ' + name + ' ' + message);
      break;
    case 'msg ':
      var party1 = event.target._data;
      var party2 = viewers[event.data.substr(4).split(' ', 1)[0]];
      if (party2) {
        var channel = new MessageChannel();
        party1.port.postMessage('msg ' + party2.name, [channel.port1]);
        party2.port.postMessage('msg ' + party1.name, [channel.port2]);
      }
      break;
  }
}
</code></pre>

  <p><strong>Connecting to multiple pages</strong>. The script uses the <code id=shared-state-using-a-shared-worker:handler-sharedworkerglobalscope-onconnect><a href=#handler-sharedworkerglobalscope-onconnect>onconnect</a></code> event listener to listen for
    multiple connections.</p>

  <p><strong>Direct channels</strong>. When the worker receives a "msg" message from one viewer
    naming another viewer, it sets up a direct connection between the two, so that the two viewers can
    communicate directly without the worker having to proxy all the messages.</p>

  <p><a href=/demos/workers/multiviewer/page.html>View this example online</a>.</p>


  <h5 id=delegation><span class=secno>10.1.2.5</span> Delegation<a href=#delegation class=self-link></a></h5>

  

  <p>With multicore CPUs becoming prevalent, one way to obtain better performance is to split
    computationally expensive tasks amongst multiple workers. In this example, a computationally
    expensive task that is to be performed for every number from 1 to 10,000,000 is farmed out to ten
    subworkers.</p>

  <p>The main page is as follows, it just reports the result:</p>

  <pre><code class=html>&lt;!DOCTYPE HTML>
&lt;html lang="en">
 &lt;head>
  &lt;meta charset="utf-8">
  &lt;title>Worker example: Multicore computation&lt;/title>
 &lt;/head>
 &lt;body>
  &lt;p>Result: &lt;output id="result">&lt;/output>&lt;/p>
  &lt;script>
   var worker = new Worker('worker.js');
   worker.onmessage = function (event) {
     document.getElementById('result').textContent = event.data;
   };
  &lt;/script>
 &lt;/body>
&lt;/html>
</code></pre>

  <p>The worker itself is as follows:</p>

  <pre><code class=js>// settings
var num_workers = 10;
var items_per_worker = 1000000;

// start the workers
var result = 0;
var pending_workers = num_workers;
for (var i = 0; i &lt; num_workers; i += 1) {
  var worker = new Worker('core.js');
  worker.postMessage(i * items_per_worker);
  worker.postMessage((i+1) * items_per_worker);
  worker.onmessage = storeResult;
}

// handle the results
function storeResult(event) {
  result += 1*event.data;
  pending_workers -= 1;
  if (pending_workers &lt;= 0)
    postMessage(result); // finished!
}
</code></pre>

  <p>It consists of a loop to start the subworkers, and then a handler
    that waits for all the subworkers to respond.</p>

  <p>The subworkers are implemented as follows:</p>

  <pre><code class=js>var start;
onmessage = getStart;
function getStart(event) {
  start = 1*event.data;
  onmessage = getEnd;
}

var end;
function getEnd(event) {
  end = 1*event.data;
  onmessage = null;
  work();
}

function work() {
  var result = 0;
  for (var i = start; i &lt; end; i += 1) {
    // perform some complex calculation here
    result += 1;
  }
  postMessage(result);
  close();
}
</code></pre>

  <p>They receive two numbers in two events, perform the computation for the range of numbers thus
    specified, and then report the result back to the parent.</p>

  <p><a href=/demos/workers/multicore/page.html>View this example online</a>.</p>


  <h5 id=providing-libraries><span class=secno>10.1.2.6</span> Providing libraries<a href=#providing-libraries class=self-link></a></h5>

  

  <p>Suppose that a cryptography library is made available that provides three tasks:</p>

  <dl><dt>Generate a public/private key pair<dd>Takes a port, on which it will send two messages, first the public key and then the private
      key.<dt>Given a plaintext and a public key, return the corresponding ciphertext<dd>Takes a port, to which any number of messages can be sent, the first giving the public key,
      and the remainder giving the plaintext, each of which is encrypted and then sent on that same
      channel as the ciphertext. The user can close the port when it is done encrypting content.<dt>Given a ciphertext and a private key, return the corresponding plaintext<dd>Takes a port, to which any number of messages can be sent, the first giving the private key,
      and the remainder giving the ciphertext, each of which is decrypted and then sent on that same
      channel as the plaintext. The user can close the port when it is done decrypting content.</dl>

  <p>The library itself is as follows:</p>

  <pre><code class=js>function handleMessage(e) {
  if (e.data == "genkeys")
    genkeys(e.ports[0]);
  else if (e.data == "encrypt")
    encrypt(e.ports[0]);
  else if (e.data == "decrypt")
    decrypt(e.ports[0]);
}

function genkeys(p) {
  var keys = _generateKeyPair();
  p.postMessage(keys[0]);
  p.postMessage(keys[1]);
}

function encrypt(p) {
  var key, state = 0;
  p.onmessage = function (e) {
    if (state == 0) {
      key = e.data;
      state = 1;
    } else {
      p.postMessage(_encrypt(key, e.data));
    }
  };
}

function decrypt(p) {
  var key, state = 0;
  p.onmessage = function (e) {
    if (state == 0) {
      key = e.data;
      state = 1;
    } else {
      p.postMessage(_decrypt(key, e.data));
    }
  };
}

// support being used as a shared worker as well as a dedicated worker
if ('onmessage' in this) // dedicated worker
  onmessage = handleMessage;
else // shared worker
  onconnect = function (e) { e.port.onmessage = handleMessage; }


// the "crypto" functions:

function _generateKeyPair() {
  return [Math.random(), Math.random()];
}

function _encrypt(k, s) {
  return 'encrypted-' + k + ' ' + s;
}

function _decrypt(k, s) {
  return s.substr(s.indexOf(' ')+1);
}
</code></pre>

  <p>Note that the crypto functions here are just stubs and don't do real cryptography.</p>

  <p>This library could be used as follows:</p>

  <pre><code class=html>&lt;!DOCTYPE HTML>
&lt;html lang="en">
 &lt;head>
  &lt;meta charset="utf-8">
  &lt;title>Worker example: Crypto library&lt;/title>
  &lt;script>
   const cryptoLib = new Worker('libcrypto-v1.js'); // or could use 'libcrypto-v2.js'
   function startConversation(source, message) {
     const messageChannel = new MessageChannel();
     source.postMessage(message, [messageChannel.port2]);
     return messageChannel.port1;
   }
   function getKeys() {
     let state = 0;
     startConversation(cryptoLib, "genkeys").onmessage = function (e) {
       if (state === 0)
         document.getElementById('public').value = e.data;
       else if (state === 1)
         document.getElementById('private').value = e.data;
       state += 1;
     };
   }
   function enc() {
     const port = startConversation(cryptoLib, "encrypt");
     port.postMessage(document.getElementById('public').value);
     port.postMessage(document.getElementById('input').value);
     port.onmessage = function (e) {
       document.getElementById('input').value = e.data;
       port.close();
     };
   }
   function dec() {
     const port = startConversation(cryptoLib, "decrypt");
     port.postMessage(document.getElementById('private').value);
     port.postMessage(document.getElementById('input').value);
     port.onmessage = function (e) {
       document.getElementById('input').value = e.data;
       port.close();
     };
   }
  &lt;/script>
  &lt;style>
   textarea { display: block; }
  &lt;/style>
 &lt;/head>
 &lt;body onload="getKeys()">
  &lt;fieldset>
   &lt;legend>Keys&lt;/legend>
   &lt;p>&lt;label>Public Key: &lt;textarea id="public">&lt;/textarea>&lt;/label>&lt;/p>
   &lt;p>&lt;label>Private Key: &lt;textarea id="private">&lt;/textarea>&lt;/label>&lt;/p>
  &lt;/fieldset>
  &lt;p>&lt;label>Input: &lt;textarea id="input">&lt;/textarea>&lt;/label>&lt;/p>
  &lt;p>&lt;button onclick="enc()">Encrypt&lt;/button> &lt;button onclick="dec()">Decrypt&lt;/button>&lt;/p>
 &lt;/body>
&lt;/html>
</code></pre>

  <p>A later version of the API, though, might want to offload all the crypto work onto subworkers.
    This could be done as follows:</p>

  <pre><code class=js>function handleMessage(e) {
  if (e.data == "genkeys")
    genkeys(e.ports[0]);
  else if (e.data == "encrypt")
    encrypt(e.ports[0]);
  else if (e.data == "decrypt")
    decrypt(e.ports[0]);
}

function genkeys(p) {
  var generator = new Worker('libcrypto-v2-generator.js');
  generator.postMessage('', [p]);
}

function encrypt(p) {
  p.onmessage = function (e) {
    var key = e.data;
    var encryptor = new Worker('libcrypto-v2-encryptor.js');
    encryptor.postMessage(key, [p]);
  };
}

function encrypt(p) {
  p.onmessage = function (e) {
    var key = e.data;
    var decryptor = new Worker('libcrypto-v2-decryptor.js');
    decryptor.postMessage(key, [p]);
  };
}

// support being used as a shared worker as well as a dedicated worker
if ('onmessage' in this) // dedicated worker
  onmessage = handleMessage;
else // shared worker
  onconnect = function (e) { e.ports[0].onmessage = handleMessage };
</code></pre>

  <p>The little subworkers would then be as follows.</p>

  <p>For generating key pairs:</p>

  <pre><code class=js>onmessage = function (e) {
  var k = _generateKeyPair();
  e.ports[0].postMessage(k[0]);
  e.ports[0].postMessage(k[1]);
  close();
}

function _generateKeyPair() {
  return [Math.random(), Math.random()];
}
</code></pre>

  <p>For encrypting:</p>

  <pre><code class=js>onmessage = function (e) {
  var key = e.data;
  e.ports[0].onmessage = function (e) {
    var s = e.data;
    postMessage(_encrypt(key, s));
  }
}

function _encrypt(k, s) {
  return 'encrypted-' + k + ' ' + s;
}
</code></pre>

  <p>For decrypting:</p>

  <pre><code class=js>onmessage = function (e) {
  var key = e.data;
  e.ports[0].onmessage = function (e) {
    var s = e.data;
    postMessage(_decrypt(key, s));
  }
}

function _decrypt(k, s) {
  return s.substr(s.indexOf(' ')+1);
}
</code></pre>

  <p>Notice how the users of the API don't have to even know that this is happening — the API
    hasn't changed; the library can delegate to subworkers without changing its API, even though it is
    accepting data using message channels.</p>

  <p><a href=/demos/workers/crypto/page.html>View this example online</a>.</p>


  <h4 id=tutorials><span class=secno>10.1.3</span> Tutorials<a href=#tutorials class=self-link></a></h4>

  <h5 id=creating-a-dedicated-worker><span class=secno>10.1.3.1</span> Creating a dedicated worker<a href=#creating-a-dedicated-worker class=self-link></a></h5>

  

  <p>Creating a worker requires a URL to a JavaScript file. The <code id=creating-a-dedicated-worker:dom-worker><a href=#dom-worker>Worker()</a></code> constructor is invoked with the URL to that file as its only
    argument; a worker is then created and returned:</p>

  <pre><code class=js>var worker = new Worker('helper.js');</code></pre>

  <p>If you want your worker script to be interpreted as a <span>module script</span> instead of
    the default <span>classic script</span>, you need to use a slightly different signature:</p>

  <pre><code class=js>var worker = new Worker('helper.mjs', { type: "module" });</code></pre>


  <h5 id=communicating-with-a-dedicated-worker><span class=secno>10.1.3.2</span> Communicating with a dedicated worker<a href=#communicating-with-a-dedicated-worker class=self-link></a></h5>

  

  <p>Dedicated workers use <code id=communicating-with-a-dedicated-worker:messageport><a href=web-messaging.html#messageport>MessagePort</a></code> objects behind the scenes, and thus support all
    the same features, such as sending structured data, transferring binary data, and transferring
    other ports.</p>

  <p>To receive messages from a dedicated worker, use the <code id=communicating-with-a-dedicated-worker:handler-worker-onmessage><a href=#handler-worker-onmessage>onmessage</a></code> <a href=webappapis.html#event-handler-idl-attributes id=communicating-with-a-dedicated-worker:event-handler-idl-attributes>event
      handler IDL attribute</a> on the <code id=communicating-with-a-dedicated-worker:worker-2><a href=#worker-2>Worker</a></code> object:</p>

  <pre><code class=js>worker.onmessage = function (event) { ... };</code></pre>

  <p>You can also use the <code id=communicating-with-a-dedicated-worker:dom-eventtarget-addeventlistener><a data-x-internal=dom-eventtarget-addeventlistener href=https://dom.spec.whatwg.org/#dom-eventtarget-addeventlistener>addEventListener()</a></code>
    method.</p>

  <p class=note>The implicit <code id=communicating-with-a-dedicated-worker:messageport-2><a href=web-messaging.html#messageport>MessagePort</a></code> used by dedicated workers has its <span>port
      message queue</span> implicitly enabled when it is created, so there is no equivalent to the
    <code id=communicating-with-a-dedicated-worker:messageport-3><a href=web-messaging.html#messageport>MessagePort</a></code> interface's <code id=communicating-with-a-dedicated-worker:dom-messageport-start><a href=web-messaging.html#dom-messageport-start>start()</a></code> method on
    the <code id=communicating-with-a-dedicated-worker:worker-2-2><a href=#worker-2>Worker</a></code> interface.
  </p>

  <p>To <em>send</em> data to a worker, use the <code id=communicating-with-a-dedicated-worker:dom-worker-postmessage><a href=#dom-worker-postmessage>postMessage()</a></code> method. Structured data can be sent over this
    communication channel. To send <code id=communicating-with-a-dedicated-worker:idl-arraybuffer><a data-x-internal=idl-arraybuffer href=https://webidl.spec.whatwg.org/#idl-ArrayBuffer>ArrayBuffer</a></code> objects
    efficiently (by transferring them rather than cloning them), list them in an array in the second
    argument.</p>

  <pre><code class=js>worker.postMessage({
  operation: 'find-edges',
  input: buffer, // an ArrayBuffer object
  threshold: 0.6,
}, [buffer]);</code></pre>

  <p>To receive a message inside the worker, the <code id=communicating-with-a-dedicated-worker:handler-dedicatedworkerglobalscope-onmessage><a href=#handler-dedicatedworkerglobalscope-onmessage>onmessage</a></code> <a href=webappapis.html#event-handler-idl-attributes id=communicating-with-a-dedicated-worker:event-handler-idl-attributes-2>event handler IDL attribute</a> is used.</p>

  <pre><code class=js>onmessage = function (event) { ... };</code></pre>

  <p>You can again also use the <code id=communicating-with-a-dedicated-worker:dom-eventtarget-addeventlistener-2><a data-x-internal=dom-eventtarget-addeventlistener href=https://dom.spec.whatwg.org/#dom-eventtarget-addeventlistener>addEventListener()</a></code> method.</p>

  <p>In either case, the data is provided in the event object's <code id=communicating-with-a-dedicated-worker:dom-messageevent-data><a href=comms.html#dom-messageevent-data>data</a></code> attribute.</p>

  <p>To send messages back, you again use <code id=communicating-with-a-dedicated-worker:dom-dedicatedworkerglobalscope-postmessage><a href=#dom-dedicatedworkerglobalscope-postmessage>postMessage()</a></code>. It supports the
    structured data in the same manner.</p>

  <pre><code class=js>postMessage(event.data.input, [event.data.input]); // transfer the buffer back</code></pre>


  <h5 id=shared-workers data-dfn-type=dfn data-lt="shared worker"><span class=secno>10.1.3.3</span> Shared workers<a href=#shared-workers class=self-link></a></h5><div class="mdn-anno wrapped"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker title="The SharedWorker interface represents a specific kind of worker that can be accessed from several browsing contexts, such as several windows, iframes or even workers. They implement an interface different than dedicated workers and have a different global scope, SharedWorkerGlobalScope.">SharedWorker</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>29+</span></span><span class="safari yes"><span>Safari</span><span>16+</span></span><span class="chrome yes"><span>Chrome</span><span>5+</span></span><hr><span class="opera yes"><span>Opera</span><span>10.6+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge unknown"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>Internet Explorer</span><span>No</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>33+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>16+</span></span><span class="chrome_android no"><span>Chrome Android</span><span>No</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>4.0–5.0</span></span><span class="opera_android no"><span>Opera Android</span><span>11–14</span></span></div></div></div>

  

  <p>Shared workers are identified by the URL of the script used to create it, optionally with an
    explicit name. The name allows multiple instances of a particular shared worker to be started.</p>

  <p>Shared workers are scoped by <a id=shared-workers:concept-origin href=browsers.html#concept-origin>origin</a>. Two different sites using the same names will
    not collide. However, if a page tries to use the same shared worker name as another page on the
    same site, but with a different script URL, it will fail.</p>

  <p>Creating shared workers is done using the <code id=shared-workers:dom-sharedworker><a href=#dom-sharedworker>SharedWorker()</a></code>
    constructor. This constructor takes the URL to the script to use for its first argument, and the
    name of the worker, if any, as the second argument.</p>

  <pre><code class=js>var worker = new SharedWorker('service.js');</code></pre>

  <p>Communicating with shared workers is done with explicit <code id=shared-workers:messageport><a href=web-messaging.html#messageport>MessagePort</a></code> objects. The
    object returned by the <code id=shared-workers:dom-sharedworker-2><a href=#dom-sharedworker>SharedWorker()</a></code> constructor holds a
    reference to the port on its <code id=shared-workers:dom-sharedworker-port><a href=#dom-sharedworker-port>port</a></code> attribute.</p>

  <pre><code class=js>worker.port.onmessage = function (event) { ... };
worker.port.postMessage('some message');
worker.port.postMessage({ foo: 'structured', bar: ['data', 'also', 'possible']});</code></pre>

  <p>Inside the shared worker, new clients of the worker are announced using the <code id=shared-workers:event-workerglobalscope-connect><a href=indices.html#event-workerglobalscope-connect>connect</a></code> event. The port for the new client is
    given by the event object's <code id=shared-workers:dom-messageevent-source><a href=comms.html#dom-messageevent-source>source</a></code> attribute.</p>

  <pre><code class=js>onconnect = function (event) {
  var newPort = event.source;
  // set up a listener
  newPort.onmessage = function (event) { ... };
  // send a message back to the port
  newPort.postMessage('ready!'); // can also send structured data, of course
};</code></pre>




  <h3 id=infrastructure-2><span class=secno>10.2</span> Infrastructure<a href=#infrastructure-2 class=self-link></a></h3>

  <p>This standard defines two kinds of workers: dedicated workers, and shared workers. Dedicated
    workers, once created, are linked to their creator, but message ports can be used to communicate
    from a dedicated worker to multiple other browsing contexts or workers. Shared workers, on the
    other hand, are named, and once created any script running in the same <a id=infrastructure-2:concept-origin href=browsers.html#concept-origin>origin</a> can
    obtain a reference to that worker and communicate with it. <cite>Service Workers</cite> defines a
    third kind. <a href=references.html#refsSW>[SW]</a>
  </p>


  <h4 id=the-global-scope><span class=secno>10.2.1</span> The global scope<a href=#the-global-scope class=self-link></a></h4>

  <p>The global scope is the "inside" of a worker.</p>

  <h5 id=the-workerglobalscope-common-interface><span class=secno>10.2.1.1</span> The <code id=workerglobalscope><a href=#workerglobalscope-2>WorkerGlobalScope</a></code> common interface<a href=#the-workerglobalscope-common-interface class=self-link></a></h5><div class="mdn-anno wrapped"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/WorkerGlobalScope title="The WorkerGlobalScope interface of the Web Workers API is an interface representing the scope of any worker. Workers have no browsing context; this scope contains the information usually conveyed by Window objects — in this case event handlers, the console or the associated WorkerNavigator object. Each WorkerGlobalScope has its own event loop.">WorkerGlobalScope</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>3.5+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>4+</span></span><hr><span class="opera yes"><span>Opera</span><span>10.6+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>10+</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>5+</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android yes"><span>Opera Android</span><span>11+</span></span></div></div></div>

  <pre><code class=idl>[Exposed=Worker]
interface <dfn id=workerglobalscope-2 data-dfn-type=interface>WorkerGlobalScope</dfn> : <a id=the-workerglobalscope-common-interface:eventtarget href=https://dom.spec.whatwg.org/#interface-eventtarget data-x-internal=eventtarget>EventTarget</a> {
  readonly attribute <a href=#workerglobalscope-2 id=the-workerglobalscope-common-interface:workerglobalscope-2>WorkerGlobalScope</a> <a href=#dom-workerglobalscope-self id=the-workerglobalscope-common-interface:dom-workerglobalscope-self>self</a>;
  readonly attribute <a href=#workerlocation-2 id=the-workerglobalscope-common-interface:workerlocation-2>WorkerLocation</a> <a href=#dom-workerglobalscope-location id=the-workerglobalscope-common-interface:dom-workerglobalscope-location>location</a>;
  readonly attribute <a href=#workernavigator-2 id=the-workerglobalscope-common-interface:workernavigator-2>WorkerNavigator</a> <a href=#dom-worker-navigator id=the-workerglobalscope-common-interface:dom-worker-navigator>navigator</a>;
  undefined <a href=#dom-workerglobalscope-importscripts id=the-workerglobalscope-common-interface:dom-workerglobalscope-importscripts>importScripts</a>((<code id=the-workerglobalscope-common-interface:tt-trustedscripturl><a data-x-internal=tt-trustedscripturl href=https://w3c.github.io/trusted-types/dist/spec/#trustedscripturl>TrustedScriptURL</a></code> or USVString)... urls);

  attribute <a id=the-workerglobalscope-common-interface:onerroreventhandler href=webappapis.html#onerroreventhandler>OnErrorEventHandler</a> <a href=#handler-workerglobalscope-onerror id=the-workerglobalscope-common-interface:handler-workerglobalscope-onerror>onerror</a>;
  attribute <a id=the-workerglobalscope-common-interface:eventhandler href=webappapis.html#eventhandler>EventHandler</a> <a href=#handler-workerglobalscope-onlanguagechange id=the-workerglobalscope-common-interface:handler-workerglobalscope-onlanguagechange>onlanguagechange</a>;
  attribute <a id=the-workerglobalscope-common-interface:eventhandler-2 href=webappapis.html#eventhandler>EventHandler</a> <a href=#handler-workerglobalscope-onoffline id=the-workerglobalscope-common-interface:handler-workerglobalscope-onoffline>onoffline</a>;
  attribute <a id=the-workerglobalscope-common-interface:eventhandler-3 href=webappapis.html#eventhandler>EventHandler</a> <a href=#handler-workerglobalscope-ononline id=the-workerglobalscope-common-interface:handler-workerglobalscope-ononline>ononline</a>;
  attribute <a id=the-workerglobalscope-common-interface:eventhandler-4 href=webappapis.html#eventhandler>EventHandler</a> <a href=#handler-workerglobalscope-onrejectionhandled id=the-workerglobalscope-common-interface:handler-workerglobalscope-onrejectionhandled>onrejectionhandled</a>;
  attribute <a id=the-workerglobalscope-common-interface:eventhandler-5 href=webappapis.html#eventhandler>EventHandler</a> <a href=#handler-workerglobalscope-onunhandledrejection id=the-workerglobalscope-common-interface:handler-workerglobalscope-onunhandledrejection>onunhandledrejection</a>;
};</code></pre>

  <p><code id=the-workerglobalscope-common-interface:workerglobalscope-2-2><a href=#workerglobalscope-2>WorkerGlobalScope</a></code> serves as the base class for specific types of worker global
    scope objects, including <code id=the-workerglobalscope-common-interface:dedicatedworkerglobalscope-2><a href=#dedicatedworkerglobalscope-2>DedicatedWorkerGlobalScope</a></code>,
    <code id=the-workerglobalscope-common-interface:sharedworkerglobalscope-2><a href=#sharedworkerglobalscope-2>SharedWorkerGlobalScope</a></code>, and <code id=the-workerglobalscope-common-interface:serviceworkerglobalscope><a data-x-internal=serviceworkerglobalscope href=https://w3c.github.io/ServiceWorker/#serviceworkerglobalscope>ServiceWorkerGlobalScope</a></code>.
  </p>

  

  <dl class=domintro><dt><code><var>workerGlobal</var>.<span id=dom-workerglobalscope-self>self</span></code><dd>Returns <var>workerGlobal</var>.<dt><code><var>workerGlobal</var>.<span id=dom-workerglobalscope-location>location</span></code><dd>Returns <var>workerGlobal</var>'s <code id=the-workerglobalscope-common-interface:workerlocation-2-2><a href=#workerlocation-2>WorkerLocation</a></code> object.<dt><code><var>workerGlobal</var>.<span id=dom-worker-navigator>navigator</span></code><dd>Returns <var>workerGlobal</var>'s <code id=the-workerglobalscope-common-interface:workernavigator-2-2><a href=#workernavigator-2>WorkerNavigator</a></code> object.<dt><code><var>workerGlobal</var>.<span id=dom-workerglobalscope-importscripts>importScripts</span>(...<var>urls</var>)</code><dd>Fetches each <a id=the-workerglobalscope-common-interface:url href=https://url.spec.whatwg.org/#concept-url data-x-internal=url>URL</a> in <var>urls</var>, executes them one-by-one in the order they
      are passed, and then returns (or throws if something went amiss).</dl>

  

  <p>The following are the <a id=the-workerglobalscope-common-interface:event-handlers href=webappapis.html#event-handlers>event handlers</a> (and their corresponding <span>event handler event types</span>)  supported,
    as <a id=the-workerglobalscope-common-interface:event-handler-idl-attributes href=webappapis.html#event-handler-idl-attributes>event handler IDL attributes</a>, by objects implementing the
    <code id=the-workerglobalscope-common-interface:workerglobalscope-2-3><a href=#workerglobalscope-2>WorkerGlobalScope</a></code> interface:
  </p>

  <table><thead><tr><th><a href=webappapis.html#event-handlers id=the-workerglobalscope-common-interface:event-handlers-2>Event handler</a>
        <th><span>Event handler event type</span>
    <tbody><tr><td><dfn data-dfn-for=WorkerGlobalScope id=handler-workerglobalscope-onerror data-dfn-type=attribute><code>onerror</code></dfn>
        <div class="mdn-anno wrapped before"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/WorkerGlobalScope/error_event title="The error event of the WorkerGlobalScope interface fires when an error occurs in the worker.">WorkerGlobalScope/error_event</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>3.5+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>4+</span></span><hr><span class="opera yes"><span>Opera</span><span>11.5+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>10+</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>5+</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android unknown"><span>Opera Android</span><span>?</span></span></div></div></div><td> <code id=the-workerglobalscope-common-interface:event-error><a href=indices.html#event-error>error</a></code>
      <tr><td><dfn data-dfn-for=WorkerGlobalScope id=handler-workerglobalscope-onlanguagechange data-dfn-type=attribute><code>onlanguagechange</code></dfn>
        <div class="mdn-anno wrapped before"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/WorkerGlobalScope/languagechange_event title="The languagechange event is fired at the global scope object when the user's preferred language changes.">WorkerGlobalScope/languagechange_event</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>74+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>4+</span></span><hr><span class="opera yes"><span>Opera</span><span>11.5+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge unknown"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>Internet Explorer</span><span>No</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>5+</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android yes"><span>WebView Android</span><span>37+</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android unknown"><span>Opera Android</span><span>?</span></span></div></div></div><td> <code id=the-workerglobalscope-common-interface:event-languagechange><a href=indices.html#event-languagechange>languagechange</a></code> 
      <tr><td><dfn data-dfn-for=WorkerGlobalScope id=handler-workerglobalscope-onoffline data-dfn-type=attribute><code>onoffline</code></dfn>
        <div class="mdn-anno wrapped before"><button onclick=toggleStatus(this) class=mdn-anno-btn><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/WorkerGlobalScope/offline_event title="The offline event of the WorkerGlobalScope fires when the device loses connection to the internet.">WorkerGlobalScope/offline_event</a><div class=support><span class="firefox yes"><span>Firefox</span><span>29+</span></span><span class="safari yes"><span>Safari</span><span>8+</span></span><span class="chrome no"><span>Chrome</span><span>No</span></span><hr><span class="opera unknown"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>No</span></span><hr><span class="edge unknown"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>Internet Explorer</span><span>No</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios unknown"><span>Safari iOS</span><span>?</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android unknown"><span>Opera Android</span><span>?</span></span></div></div></div><td> <code id=the-workerglobalscope-common-interface:event-offline><a href=indices.html#event-offline>offline</a></code> 
      <tr><td><dfn data-dfn-for=WorkerGlobalScope id=handler-workerglobalscope-ononline data-dfn-type=attribute><code>ononline</code></dfn>
        <div class="mdn-anno wrapped before"><button onclick=toggleStatus(this) class=mdn-anno-btn><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/WorkerGlobalScope/online_event title="The online event of the WorkerGlobalScope fires when the device reconnects to the internet.">WorkerGlobalScope/online_event</a><div class=support><span class="firefox yes"><span>Firefox</span><span>29+</span></span><span class="safari yes"><span>Safari</span><span>8+</span></span><span class="chrome no"><span>Chrome</span><span>No</span></span><hr><span class="opera unknown"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>No</span></span><hr><span class="edge unknown"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>Internet Explorer</span><span>No</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios unknown"><span>Safari iOS</span><span>?</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android unknown"><span>Opera Android</span><span>?</span></span></div></div></div><td> <code id=the-workerglobalscope-common-interface:event-online><a href=indices.html#event-online>online</a></code> 
      <tr><td><dfn data-dfn-for=WorkerGlobalScope id=handler-workerglobalscope-onrejectionhandled data-dfn-type=attribute><code>onrejectionhandled</code></dfn>
        <td> <code id=the-workerglobalscope-common-interface:event-rejectionhandled><a href=indices.html#event-rejectionhandled>rejectionhandled</a></code>
      <tr><td><dfn data-dfn-for=WorkerGlobalScope id=handler-workerglobalscope-onunhandledrejection data-dfn-type=attribute><code>onunhandledrejection</code></dfn>
        <td> <code id=the-workerglobalscope-common-interface:event-unhandledrejection><a href=indices.html#event-unhandledrejection>unhandledrejection</a></code>
  </table>


  <h5 id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface><span class=secno>10.2.1.2</span> Dedicated workers and the <code id=dedicatedworkerglobalscope><a href=#dedicatedworkerglobalscope-2>DedicatedWorkerGlobalScope</a></code> interface<a href=#dedicated-workers-and-the-dedicatedworkerglobalscope-interface class=self-link></a></h5><div class="mdn-anno wrapped"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/DedicatedWorkerGlobalScope title="The DedicatedWorkerGlobalScope object (the Worker global scope) is accessible through the self keyword. Some additional global functions, namespaces objects, and constructors, not typically associated with the worker global scope, but available on it, are listed in the JavaScript Reference. See also: Functions available to workers.">DedicatedWorkerGlobalScope</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>3.5+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>4+</span></span><hr><span class="opera yes"><span>Opera</span><span>10.6+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>10+</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>5+</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android yes"><span>Opera Android</span><span>11+</span></span></div></div></div>

  <pre><code class=idl>[Global=(Worker,DedicatedWorker),Exposed=DedicatedWorker]
interface <dfn id=dedicatedworkerglobalscope-2 data-dfn-type=interface>DedicatedWorkerGlobalScope</dfn> : <a href=#workerglobalscope-2 id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:workerglobalscope-2>WorkerGlobalScope</a> {
  [Replaceable] readonly attribute DOMString <a href=#dom-dedicatedworkerglobalscope-name id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:dom-dedicatedworkerglobalscope-name>name</a>;

  undefined <a href=#dom-dedicatedworkerglobalscope-postmessage id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:dom-dedicatedworkerglobalscope-postmessage>postMessage</a>(any message, sequence&lt;<a href=https://webidl.spec.whatwg.org/#idl-object id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:idl-object data-x-internal=idl-object>object</a>> transfer);
  undefined <a href=#dom-dedicatedworkerglobalscope-postmessage-options id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:dom-dedicatedworkerglobalscope-postmessage-options>postMessage</a>(any message, optional <a id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:structuredserializeoptions href=web-messaging.html#structuredserializeoptions>StructuredSerializeOptions</a> options = {});

  undefined <a href=#dom-dedicatedworkerglobalscope-close id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:dom-dedicatedworkerglobalscope-close>close</a>();

  attribute <a id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:eventhandler href=webappapis.html#eventhandler>EventHandler</a> <a href=#handler-dedicatedworkerglobalscope-onmessage id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:handler-dedicatedworkerglobalscope-onmessage>onmessage</a>;
  attribute <a id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:eventhandler-2 href=webappapis.html#eventhandler>EventHandler</a> <a href=#handler-dedicatedworkerglobalscope-onmessageerror id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:handler-dedicatedworkerglobalscope-onmessageerror>onmessageerror</a>;
};</code></pre>

  <p><code id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:dedicatedworkerglobalscope-2><a href=#dedicatedworkerglobalscope-2>DedicatedWorkerGlobalScope</a></code> objects act as if they had an implicit
    <code id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:messageport><a href=web-messaging.html#messageport>MessagePort</a></code> associated with them. This port is part of a channel that is set up when
    the worker is created, but it is not exposed.
  </p>

  

  <dl class=domintro><dt><code><var>dedicatedWorkerGlobal</var>.<span id=dom-dedicatedworkerglobalscope-name>name</span></code><dd>
      <p>Returns <var>dedicatedWorkerGlobal</var>'s <span>name</span>, i.e. the value given to the
        <code id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:worker-2><a href=#worker-2>Worker</a></code> constructor. Primarily useful for debugging.
      </p>
    <dt><code><var>dedicatedWorkerGlobal</var>.<span id=dom-dedicatedworkerglobalscope-postmessage>postMessage</span>(<var>message</var> [, <var>transfer</var> ])</code><dt><code><var>dedicatedWorkerGlobal</var>.<span id=dom-dedicatedworkerglobalscope-postmessage-options>postMessage</span>(<var>message</var> [, { <a href=web-messaging.html#dom-structuredserializeoptions-transfer id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:dom-structuredserializeoptions-transfer>transfer</a> } ])</code><dd>
      <p>Clones <var>message</var> and transmits it to the <code id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:worker-2-2><a href=#worker-2>Worker</a></code> object associated
        with <var>dedicatedWorkerGlobal</var>. <var>transfer</var> can be passed as a list of objects
        that are to be transferred rather than cloned.</p>
    <dt><code><var>dedicatedWorkerGlobal</var>.<span id=dom-dedicatedworkerglobalscope-close>close</span>()</code><dd>
      <p>Aborts <var>dedicatedWorkerGlobal</var>.</p>
    </dl>

  

  <p>The following are the <a id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:event-handlers href=webappapis.html#event-handlers>event handlers</a> (and their corresponding <span>event handler event types</span>)  supported,
    as <a id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:event-handler-idl-attributes href=webappapis.html#event-handler-idl-attributes>event handler IDL attributes</a>, by objects implementing the
    <code id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:dedicatedworkerglobalscope-2-2><a href=#dedicatedworkerglobalscope-2>DedicatedWorkerGlobalScope</a></code> interface:
  </p>

  <table><thead><tr><th><a href=webappapis.html#event-handlers id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:event-handlers-2>Event handler</a>
        <th><span>Event handler event type</span>
    <tbody><tr><td><dfn data-dfn-for=DedicatedWorkerGlobalScope id=handler-dedicatedworkerglobalscope-onmessage data-dfn-type=attribute><code>onmessage</code></dfn>
        <div class="mdn-anno wrapped before"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/DedicatedWorkerGlobalScope/message_event title="The message event is fired on a DedicatedWorkerGlobalScope object when the worker receives a message from its parent (i.e. when the parent sends a message using Worker.postMessage()).">DedicatedWorkerGlobalScope/message_event</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>3.5+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>4+</span></span><hr><span class="opera yes"><span>Opera</span><span>10.6+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>10+</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>5+</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android yes"><span>WebView Android</span><span>37+</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android yes"><span>Opera Android</span><span>11.5+</span></span></div></div></div><td> <code id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:event-message><a href=indices.html#event-message>message</a></code>
      <tr><td><dfn data-dfn-for=DedicatedWorkerGlobalScope id=handler-dedicatedworkerglobalscope-onmessageerror data-dfn-type=attribute><code>onmessageerror</code></dfn>
        <div class="mdn-anno wrapped before"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/DedicatedWorkerGlobalScope/messageerror_event title="The messageerror event is fired on a DedicatedWorkerGlobalScope object when it receives a message that can't be deserialized.">DedicatedWorkerGlobalScope/messageerror_event</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>57+</span></span><span class="safari yes"><span>Safari</span><span>16.4+</span></span><span class="chrome yes"><span>Chrome</span><span>60+</span></span><hr><span class="opera unknown"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>18</span></span><span class="ie no"><span>Internet Explorer</span><span>No</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios unknown"><span>Safari iOS</span><span>?</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android yes"><span>Opera Android</span><span>47+</span></span></div></div></div><td> <code id=dedicated-workers-and-the-dedicatedworkerglobalscope-interface:event-messageerror><a href=indices.html#event-messageerror>messageerror</a></code>
  </table>



  <h5 id=shared-workers-and-the-sharedworkerglobalscope-interface><span class=secno>10.2.1.3</span> Shared workers and the <code id=sharedworkerglobalscope><a href=#sharedworkerglobalscope-2>SharedWorkerGlobalScope</a></code> interface<a href=#shared-workers-and-the-sharedworkerglobalscope-interface class=self-link></a></h5><div class="mdn-anno wrapped"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/SharedWorkerGlobalScope title="The SharedWorkerGlobalScope object (the SharedWorker global scope) is accessible through the self keyword. Some additional global functions, namespaces objects, and constructors, not typically associated with the worker global scope, but available on it, are listed in the JavaScript Reference. See the complete list of functions available to workers.">SharedWorkerGlobalScope</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>29+</span></span><span class="safari yes"><span>Safari</span><span>16+</span></span><span class="chrome yes"><span>Chrome</span><span>4+</span></span><hr><span class="opera yes"><span>Opera</span><span>10.6+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge unknown"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>Internet Explorer</span><span>No</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>16+</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android yes"><span>WebView Android</span><span>37+</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android yes"><span>Opera Android</span><span>11+</span></span></div></div></div>

  <pre><code class=idl>[Global=(Worker,SharedWorker),Exposed=SharedWorker]
interface <dfn id=sharedworkerglobalscope-2 data-dfn-type=interface>SharedWorkerGlobalScope</dfn> : <a href=#workerglobalscope-2 id=shared-workers-and-the-sharedworkerglobalscope-interface:workerglobalscope-2>WorkerGlobalScope</a> {
  [Replaceable] readonly attribute DOMString <a href=#dom-sharedworkerglobalscope-name id=shared-workers-and-the-sharedworkerglobalscope-interface:dom-sharedworkerglobalscope-name>name</a>;

  undefined <a href=#dom-sharedworkerglobalscope-close id=shared-workers-and-the-sharedworkerglobalscope-interface:dom-sharedworkerglobalscope-close>close</a>();

  attribute <a id=shared-workers-and-the-sharedworkerglobalscope-interface:eventhandler href=webappapis.html#eventhandler>EventHandler</a> <a href=#handler-sharedworkerglobalscope-onconnect id=shared-workers-and-the-sharedworkerglobalscope-interface:handler-sharedworkerglobalscope-onconnect>onconnect</a>;
};</code></pre>

  

  <p>Shared workers receive message ports through <code id=shared-workers-and-the-sharedworkerglobalscope-interface:event-workerglobalscope-connect><a href=indices.html#event-workerglobalscope-connect>connect</a></code> events on their <code id=shared-workers-and-the-sharedworkerglobalscope-interface:sharedworkerglobalscope-2><a href=#sharedworkerglobalscope-2>SharedWorkerGlobalScope</a></code> object for each
    connection.</p>

  <dl class=domintro><dt><code><var>sharedWorkerGlobal</var>.<span id=dom-sharedworkerglobalscope-name>name</span></code><dd>
      <p>Returns <var>sharedWorkerGlobal</var>'s <span>name</span>, i.e. the value given to the
        <code id=shared-workers-and-the-sharedworkerglobalscope-interface:sharedworker-2><a href=#sharedworker-2>SharedWorker</a></code> constructor. Multiple <code id=shared-workers-and-the-sharedworkerglobalscope-interface:sharedworker-2-2><a href=#sharedworker-2>SharedWorker</a></code> objects can correspond
        to the same shared worker (and <code id=shared-workers-and-the-sharedworkerglobalscope-interface:sharedworkerglobalscope-2-2><a href=#sharedworkerglobalscope-2>SharedWorkerGlobalScope</a></code>), by reusing the same
        name.
      </p>
    <dt><code><var>sharedWorkerGlobal</var>.<span id=dom-sharedworkerglobalscope-close>close</span>()</code><dd>
      <p>Aborts <var>sharedWorkerGlobal</var>.</p>
    </dl>

  

  <p>The following are the <a id=shared-workers-and-the-sharedworkerglobalscope-interface:event-handlers href=webappapis.html#event-handlers>event handlers</a> (and their corresponding <span>event handler event types</span>)  supported,
    as <a id=shared-workers-and-the-sharedworkerglobalscope-interface:event-handler-idl-attributes href=webappapis.html#event-handler-idl-attributes>event handler IDL attributes</a>, by objects implementing the
    <code id=shared-workers-and-the-sharedworkerglobalscope-interface:sharedworkerglobalscope-2-3><a href=#sharedworkerglobalscope-2>SharedWorkerGlobalScope</a></code> interface:
  </p>

  <table><thead><tr><th><a href=webappapis.html#event-handlers id=shared-workers-and-the-sharedworkerglobalscope-interface:event-handlers-2>Event handler</a>
        <th><span>Event handler event type</span>
    <tbody><tr><td><dfn data-dfn-for=SharedWorkerGlobalScope id=handler-sharedworkerglobalscope-onconnect data-dfn-type=attribute><code>onconnect</code></dfn>
        <div class="mdn-anno wrapped before"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/SharedWorkerGlobalScope/connect_event title="The connect event is fired in shared workers at their SharedWorkerGlobalScope when a new client connects.">SharedWorkerGlobalScope/connect_event</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>29+</span></span><span class="safari yes"><span>Safari</span><span>16+</span></span><span class="chrome yes"><span>Chrome</span><span>4+</span></span><hr><span class="opera yes"><span>Opera</span><span>10.6+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge unknown"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>Internet Explorer</span><span>No</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>16+</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android yes"><span>WebView Android</span><span>37+</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android yes"><span>Opera Android</span><span>11+</span></span></div></div></div><td> <code id=shared-workers-and-the-sharedworkerglobalscope-interface:event-workerglobalscope-connect-2><a href=indices.html#event-workerglobalscope-connect>connect</a></code>
  </table>



  <h4 id=worker-event-loop><span class=secno>10.2.2</span> The event loop<a href=#worker-event-loop class=self-link></a></h4>

  <p>A <a id=worker-event-loop:worker-event-loop-2 href=webappapis.html#worker-event-loop-2>worker event loop</a>'s <span>task queues</span> only have
    events, callbacks, and networking activity as <span>tasks</span>.</p>

  <p>Each <code id=worker-event-loop:workerglobalscope-2><a href=#workerglobalscope-2>WorkerGlobalScope</a></code> object has a <dfn data-dfn-for=WorkerGlobalScope id=dom-workerglobalscope-closing data-export="">closing</dfn> flag,  initially
    false, but which can get set to true <span>when the worker is requested to close</span>.</p>

  <p>Once the <code id=worker-event-loop:workerglobalscope-2-2><a href=#workerglobalscope-2>WorkerGlobalScope</a></code>'s <a href=#dom-workerglobalscope-closing id=worker-event-loop:dom-workerglobalscope-closing>closing</a> flag is set to true, the <a id=worker-event-loop:event-loop href=webappapis.html#event-loop>event
      loop</a>'s <span>task queues</span>  discard any
    further <span>tasks</span> that would be added to them (tasks already on the
    queue are unaffected except where otherwise specified). Effectively, once the <a href=#dom-workerglobalscope-closing id=worker-event-loop:dom-workerglobalscope-closing-2>closing</a> flag is true, timers stop firing,
    notifications for all pending background operations are dropped, etc.</p>



  


  <h4 id=runtime-script-errors-2><span class=secno>10.2.3</span> Runtime script errors<a href=#runtime-script-errors-2 class=self-link></a></h4>

  <p>Whenever an uncaught runtime script error occurs in one of the worker's scripts, if the error
    did not occur while handling a previous script error, the user agent will <span>report</span> it for the worker's <code id=runtime-script-errors-2:workerglobalscope-2><a href=#workerglobalscope-2>WorkerGlobalScope</a></code> object.</p>


  <h4 id=creating-workers><span class=secno>10.2.4</span> Creating workers<a href=#creating-workers class=self-link></a></h4>

  
  <h5 id=properties-present-on-both-worker-and-sharedworker><span class=secno>10.2.4.1</span> Properties present on both <code id=properties-present-on-both-worker-and-sharedworker:worker-2><a href=#worker-2>Worker</a></code> and <code id=properties-present-on-both-worker-and-sharedworker:sharedworker-2><a href=#sharedworker-2>SharedWorker</a></code><a href=#properties-present-on-both-worker-and-sharedworker class=self-link></a></h5>

  <pre><code class=idl>interface mixin <dfn id=abstractworker data-dfn-type=interface>AbstractWorker</dfn> {
  attribute <a id=properties-present-on-both-worker-and-sharedworker:eventhandler href=webappapis.html#eventhandler>EventHandler</a> <a href=#handler-abstractworker-onerror id=properties-present-on-both-worker-and-sharedworker:handler-abstractworker-onerror>onerror</a>;
};</code></pre>

  <p>The following are the <a id=properties-present-on-both-worker-and-sharedworker:event-handlers href=webappapis.html#event-handlers>event handlers</a> (and their corresponding <span>event handler event types</span>)  supported,
    as <a id=properties-present-on-both-worker-and-sharedworker:event-handler-idl-attributes href=webappapis.html#event-handler-idl-attributes>event handler IDL attributes</a>, by <span><code id=properties-present-on-both-worker-and-sharedworker:worker-2-2><a href=#worker-2>Worker</a></code> and
      <code id=properties-present-on-both-worker-and-sharedworker:sharedworker-2-2><a href=#sharedworker-2>SharedWorker</a></code> objects</span>:</p>

  <table><thead><tr><th><a href=webappapis.html#event-handlers id=properties-present-on-both-worker-and-sharedworker:event-handlers-2>Event handler</a>
        <th><span>Event handler event type</span>
    <tbody><tr><td><dfn data-dfn-for=AbstractWorker id=handler-abstractworker-onerror data-dfn-type=attribute><code>onerror</code></dfn>
        <div class="mdn-anno wrapped before"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorker/error_event title="The error event fires whenever an error occurs in the service worker.">ServiceWorker/error_event</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>44+</span></span><span class="safari yes"><span>Safari</span><span>11.1+</span></span><span class="chrome yes"><span>Chrome</span><span>40+</span></span><hr><span class="opera unknown"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>17+</span></span><span class="ie no"><span>Internet Explorer</span><span>No</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios unknown"><span>Safari iOS</span><span>?</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android unknown"><span>Opera Android</span><span>?</span></span></div></div><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker/error_event title="The error event of the SharedWorker interface fires when an error occurs in the worker.">SharedWorker/error_event</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>29+</span></span><span class="safari yes"><span>Safari</span><span>16+</span></span><span class="chrome yes"><span>Chrome</span><span>5+</span></span><hr><span class="opera yes"><span>Opera</span><span>10.6+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge unknown"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>Internet Explorer</span><span>No</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>33+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>16+</span></span><span class="chrome_android no"><span>Chrome Android</span><span>No</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>4.0–5.0</span></span><span class="opera_android no"><span>Opera Android</span><span>11–14</span></span></div></div><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/Worker/error_event title="The error event of the Worker interface fires when an error occurs in the worker.">Worker/error_event</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>3.5+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>4+</span></span><hr><span class="opera yes"><span>Opera</span><span>10.6+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>10+</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>5+</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android yes"><span>Opera Android</span><span>11+</span></span></div></div></div><td> <code id=properties-present-on-both-worker-and-sharedworker:event-error><a href=indices.html#event-error>error</a></code>
  </table>


  


  <h5 id=dedicated-workers-and-the-worker-interface><span class=secno>10.2.4.2</span> Dedicated workers and the <code id=worker><a href=#worker-2>Worker</a></code> interface<a href=#dedicated-workers-and-the-worker-interface class=self-link></a></h5><div class="mdn-anno wrapped"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/Worker title="The Worker interface of the Web Workers API represents a background task that can be created via script, which can send messages back to its creator.">Worker</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>3.5+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>2+</span></span><hr><span class="opera yes"><span>Opera</span><span>10.6+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>10+</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>5+</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android yes"><span>Opera Android</span><span>11+</span></span></div></div></div>

  <pre><code class=idl>[Exposed=(Window,DedicatedWorker,SharedWorker)]
interface <dfn id=worker-2 data-dfn-type=interface>Worker</dfn> : <a id=dedicated-workers-and-the-worker-interface:eventtarget href=https://dom.spec.whatwg.org/#interface-eventtarget data-x-internal=eventtarget>EventTarget</a> {
  <a href=#dom-worker id=dedicated-workers-and-the-worker-interface:dom-worker>constructor</a>((<code id=dedicated-workers-and-the-worker-interface:tt-trustedscripturl><a data-x-internal=tt-trustedscripturl href=https://w3c.github.io/trusted-types/dist/spec/#trustedscripturl>TrustedScriptURL</a></code> or USVString) scriptURL, optional <a href=#workeroptions id=dedicated-workers-and-the-worker-interface:workeroptions>WorkerOptions</a> options = {});

  undefined <a href=#dom-worker-terminate id=dedicated-workers-and-the-worker-interface:dom-worker-terminate>terminate</a>();

  undefined <a href=#dom-worker-postmessage id=dedicated-workers-and-the-worker-interface:dom-worker-postmessage>postMessage</a>(any message, sequence&lt;<a href=https://webidl.spec.whatwg.org/#idl-object id=dedicated-workers-and-the-worker-interface:idl-object data-x-internal=idl-object>object</a>> transfer);
  undefined <a href=#dom-worker-postmessage-options id=dedicated-workers-and-the-worker-interface:dom-worker-postmessage-options>postMessage</a>(any message, optional <a id=dedicated-workers-and-the-worker-interface:structuredserializeoptions href=web-messaging.html#structuredserializeoptions>StructuredSerializeOptions</a> options = {});
  attribute <a id=dedicated-workers-and-the-worker-interface:eventhandler href=webappapis.html#eventhandler>EventHandler</a> <a href=#handler-worker-onmessage id=dedicated-workers-and-the-worker-interface:handler-worker-onmessage>onmessage</a>;
  attribute <a id=dedicated-workers-and-the-worker-interface:eventhandler-2 href=webappapis.html#eventhandler>EventHandler</a> <a href=#handler-worker-onmessageerror id=dedicated-workers-and-the-worker-interface:handler-worker-onmessageerror>onmessageerror</a>;
};

dictionary <dfn id=workeroptions data-dfn-type=dictionary>WorkerOptions</dfn> {
  <a href=#workertype id=dedicated-workers-and-the-worker-interface:workertype>WorkerType</a> type = "classic";
  <a id=dedicated-workers-and-the-worker-interface:requestcredentials href=https://fetch.spec.whatwg.org/#requestcredentials data-x-internal=requestcredentials>RequestCredentials</a> credentials = "same-origin"; // credentials is only used if type is "module"
  DOMString name = "";
};

enum <dfn id=workertype data-dfn-type=enum>WorkerType</dfn> { "classic", "module" };

<a href=#worker-2 id=dedicated-workers-and-the-worker-interface:worker-2>Worker</a> includes <a href=#abstractworker id=dedicated-workers-and-the-worker-interface:abstractworker>AbstractWorker</a>;</code></pre>

  <dl class=domintro><dt><code><var>worker</var> = new <span id=dom-worker>Worker</span>(<var>scriptURL</var> [, <var>options</var> ])</code><dd>
      <p>Returns a new <code id=dedicated-workers-and-the-worker-interface:worker-2-2><a href=#worker-2>Worker</a></code> object. <var>scriptURL</var> will be fetched and
        executed in the background, creating a new global environment for which <var>worker</var>
        represents the communication channel. <var>options</var> can be used to define the <span>name</span> of that global environment via the <code>name</code> option, primarily for debugging purposes. It can also ensure this new
        global environment supports JavaScript modules (specify <code>type: "module"</code>),
        and if that is specified, can also be used to specify how <var>scriptURL</var> is fetched through
        the <code>credentials</code> option.</p>
    <dt><code><var>worker</var>.<span id=dom-worker-terminate>terminate</span>()</code><dd>Aborts <var>worker</var>'s associated global environment.<dt><code><var>worker</var>.<span id=dom-worker-postmessage>postMessage</span>(<var>message</var> [, <var>transfer</var> ])</code><dt><code><var>worker</var>.<span id=dom-worker-postmessage-options>postMessage</span>(<var>message</var> [, { <a href=web-messaging.html#dom-structuredserializeoptions-transfer id=dedicated-workers-and-the-worker-interface:dom-structuredserializeoptions-transfer>transfer</a> } ])</code><dd>
      <p>Clones <var>message</var> and transmits it to <var>worker</var>'s global environment.
        <var>transfer</var> can be passed as a list of objects that are to be transferred rather than
        cloned.
      </p>
    </dl>

  

  <div class=example>

    <p>The <code id=dedicated-workers-and-the-worker-interface:dom-worker-postmessage-2><a href=#dom-worker-postmessage>postMessage()</a></code>
      method's first argument can be structured data:</p>

    <pre><code class=js>worker.postMessage({opcode: 'activate', device: 1938, parameters: [23, 102]});</code></pre>

  </div>

  <p>The following are the <a id=dedicated-workers-and-the-worker-interface:event-handlers href=webappapis.html#event-handlers>event handlers</a> (and their corresponding <span>event handler event types</span>)  supported,
    as <a id=dedicated-workers-and-the-worker-interface:event-handler-idl-attributes href=webappapis.html#event-handler-idl-attributes>event handler IDL attributes</a>, by objects implementing the <code id=dedicated-workers-and-the-worker-interface:worker-2-3><a href=#worker-2>Worker</a></code>
    interface:</p>

  <table><thead><tr><th><a href=webappapis.html#event-handlers id=dedicated-workers-and-the-worker-interface:event-handlers-2>Event handler</a>
        <th><span>Event handler event type</span>
    <tbody><tr><td><dfn data-dfn-for=Worker id=handler-worker-onmessage data-dfn-type=attribute><code>onmessage</code></dfn>
        <td> <code id=dedicated-workers-and-the-worker-interface:event-message><a href=indices.html#event-message>message</a></code>
      <tr><td><dfn data-dfn-for=Worker id=handler-worker-onmessageerror data-dfn-type=attribute><code>onmessageerror</code></dfn>
        <td> <code id=dedicated-workers-and-the-worker-interface:event-messageerror><a href=indices.html#event-messageerror>messageerror</a></code>
  </table>

  


  <h5 id=shared-workers-and-the-sharedworker-interface><span class=secno>10.2.4.3</span> Shared workers and the <code id=sharedworker><a href=#sharedworker-2>SharedWorker</a></code> interface<a href=#shared-workers-and-the-sharedworker-interface class=self-link></a></h5><div class="mdn-anno wrapped"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker title="The SharedWorker interface represents a specific kind of worker that can be accessed from several browsing contexts, such as several windows, iframes or even workers. They implement an interface different than dedicated workers and have a different global scope, SharedWorkerGlobalScope.">SharedWorker</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>29+</span></span><span class="safari yes"><span>Safari</span><span>16+</span></span><span class="chrome yes"><span>Chrome</span><span>5+</span></span><hr><span class="opera yes"><span>Opera</span><span>10.6+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge unknown"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>Internet Explorer</span><span>No</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>33+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>16+</span></span><span class="chrome_android no"><span>Chrome Android</span><span>No</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>4.0–5.0</span></span><span class="opera_android no"><span>Opera Android</span><span>11–14</span></span></div></div></div>

  <pre><code class=idl>[Exposed=Window]
interface <dfn id=sharedworker-2 data-dfn-type=interface>SharedWorker</dfn> : <a id=shared-workers-and-the-sharedworker-interface:eventtarget href=https://dom.spec.whatwg.org/#interface-eventtarget data-x-internal=eventtarget>EventTarget</a> {
  <a href=#dom-sharedworker id=shared-workers-and-the-sharedworker-interface:dom-sharedworker>constructor</a>((<code id=shared-workers-and-the-sharedworker-interface:tt-trustedscripturl><a data-x-internal=tt-trustedscripturl href=https://w3c.github.io/trusted-types/dist/spec/#trustedscripturl>TrustedScriptURL</a></code> or USVString) scriptURL, optional (DOMString or <a href=#workeroptions id=shared-workers-and-the-sharedworker-interface:workeroptions>WorkerOptions</a>) options = {});

  readonly attribute <a id=shared-workers-and-the-sharedworker-interface:messageport href=web-messaging.html#messageport>MessagePort</a> <a href=#dom-sharedworker-port id=shared-workers-and-the-sharedworker-interface:dom-sharedworker-port>port</a>;
};
<a href=#sharedworker-2 id=shared-workers-and-the-sharedworker-interface:sharedworker-2>SharedWorker</a> includes <a href=#abstractworker id=shared-workers-and-the-sharedworker-interface:abstractworker>AbstractWorker</a>;</code></pre>

  <dl class=domintro><dt><code><var>sharedWorker</var> = new <span id=dom-sharedworker>SharedWorker</span>(<var>scriptURL</var> [, <var>name</var> ])</code><dd>
      <p>Returns a new <code id=shared-workers-and-the-sharedworker-interface:sharedworker-2-2><a href=#sharedworker-2>SharedWorker</a></code> object. <var>scriptURL</var> will be fetched and
        executed in the background, creating a new global environment for which <var>sharedWorker</var>
        represents the communication channel. <var>name</var> can be used to define the <span>name</span> of that global environment.</p>
    <dt><code><var>sharedWorker</var> = new <a href=#dom-sharedworker id=shared-workers-and-the-sharedworker-interface:dom-sharedworker-2>SharedWorker</a>(<var>scriptURL</var> [, <var>options</var> ])</code><dd>
      <p>Returns a new <code id=shared-workers-and-the-sharedworker-interface:sharedworker-2-3><a href=#sharedworker-2>SharedWorker</a></code> object. <var>scriptURL</var> will be fetched and
        executed in the background, creating a new global environment for which <var>sharedWorker</var>
        represents the communication channel. <var>options</var> can be used to define the <span>name</span> of that global environment via the <code>name</code> option. It can also ensure this new global environment supports JavaScript
        modules (specify <code>type: "module"</code>), and if that is specified, can also be
        used to specify how <var>scriptURL</var> is fetched through the <code>credentials</code> option. Note that attempting to construct a shared worker with
        <var>options</var> whose <code>type</code> or <code>credentials</code> values
        mismatch an existing shared worker will cause the returned <var>sharedWorker</var> to fire an
        error event and not connect to the existing shared worker.
      </p>
    <dt><code><var>sharedWorker</var>.<span id=dom-sharedworker-port>port</span></code><dd>
      <p>Returns <var>sharedWorker</var>'s <code id=shared-workers-and-the-sharedworker-interface:messageport-2><a href=web-messaging.html#messageport>MessagePort</a></code> object which can be used to
        communicate with the global environment.</p>
    </dl>

  


  <h4 id=navigator.hardwareconcurrency><span class=secno>10.2.5</span> Concurrent hardware capabilities<a href=#navigator.hardwareconcurrency class=self-link></a></h4>

  <pre><code class=idl>interface mixin <dfn id=navigatorconcurrenthardware data-dfn-type=interface>NavigatorConcurrentHardware</dfn> {
  readonly attribute unsigned long long <a href=#dom-navigator-hardwareconcurrency id=navigator.hardwareconcurrency:dom-navigator-hardwareconcurrency>hardwareConcurrency</a>;
};</code></pre>

  <dl class=domintro><dt><code><var>self</var>.<span>navigator</span>.<span id=dom-navigator-hardwareconcurrency>hardwareConcurrency</span></code><dd>
      <p>Returns the number of logical processors potentially available to the user agent.</p>
    </dl>

  

  <h3 id=apis-available-to-workers><span class=secno>10.3</span> APIs available to workers<a href=#apis-available-to-workers class=self-link></a></h3>

  


  <h4 id=the-workernavigator-object><span class=secno>10.3.1</span> The <code id=workernavigator><a href=#workernavigator-2>WorkerNavigator</a></code> interface<a href=#the-workernavigator-object class=self-link></a></h4><div class="mdn-anno wrapped"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/WorkerNavigator title="The WorkerNavigator interface represents a subset of the Navigator interface allowed to be accessed from a Worker. Such an object is initialized for each worker and is available via the self.navigator property.">WorkerNavigator</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>3.5+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>4+</span></span><hr><span class="opera yes"><span>Opera</span><span>12.1+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>10+</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>5+</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android yes"><span>Opera Android</span><span>12.1+</span></span></div></div></div>

  

  <pre><code class=idl>[Exposed=Worker]
interface <dfn id=workernavigator-2 data-dfn-type=interface>WorkerNavigator</dfn> {};
<a href=#workernavigator-2 id=the-workernavigator-object:workernavigator-2>WorkerNavigator</a> includes <a id=the-workernavigator-object:navigatorid href=system-state.html#navigatorid>NavigatorID</a>;
<a href=#workernavigator-2 id=the-workernavigator-object:workernavigator-2-2>WorkerNavigator</a> includes <a id=the-workernavigator-object:navigatorlanguage href=system-state.html#navigatorlanguage>NavigatorLanguage</a>;
<a href=#workernavigator-2 id=the-workernavigator-object:workernavigator-2-3>WorkerNavigator</a> includes <a id=the-workernavigator-object:navigatoronline href=system-state.html#navigatoronline>NavigatorOnLine</a>;
<a href=#workernavigator-2 id=the-workernavigator-object:workernavigator-2-4>WorkerNavigator</a> includes <a href=#navigatorconcurrenthardware id=the-workernavigator-object:navigatorconcurrenthardware>NavigatorConcurrentHardware</a>;</code></pre>

  <div>

    <p>The <code id=the-workernavigator-object:workernavigator-2-5><a href=#workernavigator-2>WorkerNavigator</a></code> interface implements a subset of the <code id=the-workernavigator-object:navigator><a href=system-state.html#navigator>Navigator</a></code>
      interface, consisting of the following APIs:</p>

    <ul class=brief><li><a href=system-state.html#client-identification>Client identification</a><li><a href=system-state.html#language-preferences>Language preferences</a><li><a href=system-state.html#navigator.online>Browser state</a><li><a href=#navigator.hardwareconcurrency>Concurrent hardware capabilities</a></ul>

  </div>

  <h4 id=worker-locations><span class=secno>10.3.2</span> The <code id=workerlocation><a href=#workerlocation-2>WorkerLocation</a></code> interface<a href=#worker-locations class=self-link></a></h4><div class="mdn-anno wrapped"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/WorkerLocation/toString title="The toString() stringifier method of a WorkerLocation object returns a string containing the serialized URL for the worker's location. It is a synonym for WorkerLocation.href.">WorkerLocation/toString</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>3.5+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>4+</span></span><hr><span class="opera yes"><span>Opera</span><span>15+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>10+</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>5+</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android yes"><span>WebView Android</span><span>37+</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android yes"><span>Opera Android</span><span>14+</span></span></div></div><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/WorkerLocation title="The WorkerLocation interface defines the absolute location of the script executed by the Worker. Such an object is initialized for each worker and is available via the WorkerGlobalScope.location property obtained by calling self.location.">WorkerLocation</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>3.5+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>4+</span></span><hr><span class="opera yes"><span>Opera</span><span>12.1+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>10+</span></span><hr><span class="firefox_android unknown"><span>Firefox Android</span><span>?</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>5+</span></span><span class="chrome_android unknown"><span>Chrome Android</span><span>?</span></span><span class="webview_android unknown"><span>WebView Android</span><span>?</span></span><span class="samsunginternet_android unknown"><span>Samsung Internet</span><span>?</span></span><span class="opera_android yes"><span>Opera Android</span><span>12.1+</span></span></div></div></div>

  <pre><code class=idl>[Exposed=Worker]
interface <dfn id=workerlocation-2 data-dfn-type=interface>WorkerLocation</dfn> {
  stringifier readonly attribute USVString <span>href</span>;
  readonly attribute USVString <span>origin</span>;
  readonly attribute USVString <span>protocol</span>;
  readonly attribute USVString <span>host</span>;
  readonly attribute USVString <span>hostname</span>;
  readonly attribute USVString <span>port</span>;
  readonly attribute USVString <span>pathname</span>;
  readonly attribute USVString <span>search</span>;
  readonly attribute USVString <span>hash</span>;
};</code></pre>

  <p>The <code id=worker-locations:workerlocation-2><a href=#workerlocation-2>WorkerLocation</a></code> interface is like the <code id=worker-locations:location><a href=nav-history-apis.html#location>Location</a></code> interface,
    but lacks the <code id=worker-locations:dom-location-assign><a href=nav-history-apis.html#dom-location-assign>assign()</a></code>, <code id=worker-locations:dom-location-replace><a href=nav-history-apis.html#dom-location-replace>replace()</a></code>, <code id=worker-locations:dom-location-reload><a href=nav-history-apis.html#dom-location-reload>reload()</a></code>,
    and <code id=worker-locations:dom-location-ancestororigins><a href=nav-history-apis.html#dom-location-ancestororigins>ancestorOrigins</a></code> members.</p>

  


  <nav><a href=web-messaging.html>← 9.3 Cross-document messaging</a> — <a href=./>Table of Contents</a> — <a href=worklets.html>11 Worklets →</a></nav>
