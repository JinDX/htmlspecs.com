<!DOCTYPE html><html class=split lang=en-US-x-hixie><script src=/link-fixup.js defer=""></script><meta charset=utf-8><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name=viewport><title>HTML 标准</title><meta content=#3c790a name=theme-color><meta content="light dark" name=color-scheme><link rel=stylesheet href=https://resources.whatwg.org/standard-shared-with-dev.css crossorigin=""><link rel=stylesheet href=https://resources.whatwg.org/standard.css crossorigin=""><link rel=stylesheet href=https://resources.whatwg.org/spec.css crossorigin=""><link rel=icon href=https://resources.whatwg.org/logo.svg crossorigin=""><link rel=stylesheet href=/styles.css crossorigin=""><script>
    function toggleStatus(div) {
      div.parentNode.classList.toggle('wrapped');
    }
    function setLinkFragment(link) {
      link.hash = location.hash;
    }
  </script><body>
  
  <script defer="" crossorigin="" src=/html-dfn.js></script>
  
  <header id=head class="head with-buttons">
    <a href=https://whatwg.org/ class=logo><img width=100 alt=WHATWG crossorigin="" class=darkmode-aware src=https://resources.whatwg.org/logo.svg height=100></a>
    <hgroup><h1 class=allcaps>HTML</h1><p id=living-standard>现行标准 — 上次更新 <span class=pubdate>7 September 2024</span></hgroup>
    
    

    
  </header>

  

  

  

  
  

  
  

  

  <nav><a href=embedded-content.html>← 4.8 Embedded content</a> — <a href=./>Table of Contents</a> — <a href=iframe-embed-object.html>4.8.5 The
  iframe element →</a></nav><ol class=toc><li id=toc-semantics><ol><li><ol><li><a href=images.html#images><span class=secno>4.8.4</span> Images</a><ol><li><a href=images.html#introduction-3><span class=secno>4.8.4.1</span> Introduction</a><ol><li><a href=images.html#adaptive-images><span class=secno>4.8.4.1.1</span> Adaptive images</a></ol><li><a href=images.html#attributes-common-to-source-and-img-elements><span class=secno>4.8.4.2</span> Attributes common to <code>source</code>,
  <code>img</code>, and <code>link</code> elements</a><ol><li><a href=images.html#srcset-attributes><span class=secno>4.8.4.2.1</span> Srcset attributes</a><li><a href=images.html#sizes-attributes><span class=secno>4.8.4.2.2</span> Sizes attributes</a></ol><li><a href=images.html#images-processing-model><span class=secno>4.8.4.3</span> Processing model</a><ol><li><a href=images.html#when-to-obtain-images><span class=secno>4.8.4.3.1</span> When to obtain images</a><li><a href=images.html#reacting-to-dom-mutations><span class=secno>4.8.4.3.2</span> Reacting to DOM mutations</a><li><a href=images.html#the-list-of-available-images><span class=secno>4.8.4.3.3</span> The list of available images</a><li><a href=images.html#decoding-images><span class=secno>4.8.4.3.4</span> Decoding images</a><li><a href=images.html#updating-the-image-data><span class=secno>4.8.4.3.5</span> Updating the image data</a><li><a href=images.html#preparing-an-image-for-presentation><span class=secno>4.8.4.3.6</span> Preparing an image for presentation</a><li><a href=images.html#selecting-an-image-source><span class=secno>4.8.4.3.7</span> Selecting an image source</a><li><a href=images.html#creating-a-source-set-from-attributes><span class=secno>4.8.4.3.8</span> Creating a source set from attributes</a><li><a href=images.html#updating-the-source-set><span class=secno>4.8.4.3.9</span> Updating the source set</a><li><a href=images.html#parsing-a-srcset-attribute><span class=secno>4.8.4.3.10</span> Parsing a srcset attribute</a><li><a href=images.html#parsing-a-sizes-attribute><span class=secno>4.8.4.3.11</span> Parsing a sizes attribute</a><li><a href=images.html#normalizing-the-source-densities><span class=secno>4.8.4.3.12</span> Normalizing the source densities</a><li><a href=images.html#reacting-to-environment-changes><span class=secno>4.8.4.3.13</span> Reacting to environment changes</a></ol><li><a href=images.html#alt><span class=secno>4.8.4.4</span> Requirements for providing text to act as an alternative for images</a><ol><li><a href=images.html#general-guidelines><span class=secno>4.8.4.4.1</span> General guidelines</a><li><a href=images.html#a-link-or-button-containing-nothing-but-the-image><span class=secno>4.8.4.4.2</span> A link or button containing nothing but the image</a><li><a href=images.html#a-phrase-or-paragraph-with-an-alternative-graphical-representation:-charts,-diagrams,-graphs,-maps,-illustrations><span class=secno>4.8.4.4.3</span> A phrase or paragraph with an alternative graphical representation: charts, diagrams, graphs, maps, illustrations</a><li><a href=images.html#a-short-phrase-or-label-with-an-alternative-graphical-representation:-icons,-logos><span class=secno>4.8.4.4.4</span> A short phrase or label with an alternative graphical representation: icons, logos</a><li><a href=images.html#text-that-has-been-rendered-to-a-graphic-for-typographical-effect><span class=secno>4.8.4.4.5</span> Text that has been rendered to a graphic for typographical effect</a><li><a href=images.html#a-graphical-representation-of-some-of-the-surrounding-text><span class=secno>4.8.4.4.6</span> A graphical representation of some of the surrounding text</a><li><a href=images.html#ancillary-images><span class=secno>4.8.4.4.7</span> Ancillary images</a><li><a href="images.html#a-purely-decorative-image-that-doesn't-add-any-information"><span class=secno>4.8.4.4.8</span> A purely decorative image that doesn't add any information</a><li><a href=images.html#a-group-of-images-that-form-a-single-larger-picture-with-no-links><span class=secno>4.8.4.4.9</span> A group of images that form a single larger picture with no links</a><li><a href=images.html#a-group-of-images-that-form-a-single-larger-picture-with-links><span class=secno>4.8.4.4.10</span> A group of images that form a single larger picture with links</a><li><a href=images.html#a-key-part-of-the-content><span class=secno>4.8.4.4.11</span> A key part of the content</a><li><a href=images.html#an-image-not-intended-for-the-user><span class=secno>4.8.4.4.12</span> An image not intended for the user</a><li><a href=images.html#an-image-in-an-e-mail-or-private-document-intended-for-a-specific-person-who-is-known-to-be-able-to-view-images><span class=secno>4.8.4.4.13</span> An image in an email or private document intended for a specific person who is known to be able to view images</a><li><a href=images.html#guidance-for-markup-generators><span class=secno>4.8.4.4.14</span> Guidance for markup generators</a><li><a href=images.html#guidance-for-conformance-checkers><span class=secno>4.8.4.4.15</span> Guidance for conformance checkers</a></ol></ol></ol></ol></ol><h4 id=images><span class=secno>4.8.4</span> Images<a href=#images class=self-link></a></h4>

  <h5 id=introduction-3><span class=secno>4.8.4.1</span> Introduction<a href=#introduction-3 class=self-link></a></h5>

  <p><i>This section is non-normative.</i></p>

  <p>To embed an image in HTML, when there is only a single image resource, use the <code id=introduction-3:the-img-element><a href=embedded-content.html#the-img-element>img</a></code>
    element and its <code id=introduction-3:attr-img-src><a href=embedded-content.html#attr-img-src>src</a></code> attribute.</p>

  <div class=example>

    <pre><code class=html>&lt;h2>From today's featured article&lt;/h2>
<strong>&lt;img src="/uploads/100-marie-lloyd.jpg" alt="" width="100" height="150"></strong>
&lt;p>&lt;b>&lt;a href="/wiki/Marie_Lloyd">Marie Lloyd&lt;/a>&lt;/b> (1870–1922)
was an English &lt;a href="/wiki/Music_hall">music hall&lt;/a> singer, ...</code></pre>

  </div>

  <p>However, there are a number of situations for which the author might wish to use multiple image
    resources that the user agent can choose from:</p>

  <ul><li>
      <p>Different users might have different environmental characteristics:</p>

      <ul><li>
          <p>The users' physical screen size might be different from one another.</p>

          <div class=example>
            <p>A mobile phone's screen might be 4 inches diagonally, while a laptop's screen might be 14
              inches diagonally.</p>

            <svg font-size=2.5 role=img viewBox="0 0 80 32" font-family=sans-serif height=200 aria-label="The phone's screen is much smaller compared to the laptop's screen.">
              
              <rect width=6 fill=white stroke=black x=6 height=12 y=18 rx=1></rect>
              <text transform="translate(9 24)
        rotate(-60)" text-anchor=middle dominant-baseline=middle>4″</text>
              
              <rect width=40 stroke-width=2 fill=white stroke=black x=30 height=26 y=2 rx=2></rect>
              <line y2=30 stroke-linecap=round stroke-width=2 stroke=black x1=26 y1=30 x2=74></line>
              <text transform="translate(50 15)
        rotate(-30)" text-anchor=middle dominant-baseline=middle>14″</text>
            </svg>
          </div>

          <p class=note>This is only relevant when an image's rendered size depends on the
            <a id=introduction-3:viewport href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a> size.
          </p>
        <li>
          <p>The users' screen pixel density might be different from one another.</p>

          <div class=example>
            <p>A mobile phone's screen might have three times as many physical pixels per inch
              compared to another mobile phone's screen, regardless of their physical screen size.</p>

            <svg font-size=2.5 role=img viewBox="0 0 56 27" font-family=sans-serif height=170 aria-label="One phone has big pixels, the other has small pixels.">
              <defs>
                <pattern id=img-intro-pixel width=3 patternUnits=userSpaceOnUse stroke-linecap=round x=0 y=0 height=3>
                  <rect fill=black width=3 x=0 height=3 y=0></rect>
                  <line y2=2.5 stroke=red x1=0.5 x2=0.5 y1=0.5></line>
                  <line y2=2.5 stroke=lime x1=1.5 x2=1.5 y1=0.5></line>
                  <line y2=2.5 stroke=blue x1=2.5 x2=2.5 y1=0.5></line>
                </pattern>
              </defs>
              
              <rect width=6 fill=white stroke=black x=6 height=12 y=8 rx=1></rect>
              <rect width=6 fill=white stroke=black x=36 height=12 y=8 rx=1></rect>
              
              <line y2=24 stroke-width=3 stroke=brown x1=15 y1=16 x2=22></line>
              <circle cx=10 cy=10 fill=url(#img-intro-pixel) stroke=black r=8></circle>
              <line y2=24 stroke-width=3 stroke=brown x1=45 y1=16 x2=52></line>
              <circle cx=120 transform=scale(0.333333) cy=30 r=24 stroke-width=3 fill=url(#img-intro-pixel) stroke=black></circle>
              
              <text x=20 y=10 dominant-baseline=middle>1x</text>
              <text x=50 y=10 dominant-baseline=middle>3x</text>
            </svg>
          </div>
        <li>
          <p>The users' zoom level might be different from one another, or might change for a single
            user over time.</p>

          <p class=example>A user might zoom in to a particular image to be able to get a more
            detailed look.</p>

          <p>The zoom level and the screen pixel density (the previous point) can both affect the number
            of physical screen pixels per <a href=https://drafts.csswg.org/css-values/#px id="introduction-3:'px'" data-x-internal="'px'">CSS pixel</a>. This ratio is usually
            referred to as <dfn id=device-pixel-ratio>device-pixel-ratio</dfn>.</p>
        <li>
          <p>The users' screen orientation might be different from one another, or might change for a
            single user over time.</p>

          <div class=example>
            <p>A tablet can be held upright or rotated 90 degrees, so that the screen is either
              "portrait" or "landscape".</p>

            <svg font-size=2.5 role=img viewBox="0 0 60 32" font-family=sans-serif height=200 aria-label="The tablet has two orientations.">
              
              <rect width=14 fill=white stroke=black x=6 height=20 y=5 rx=1></rect>
              <line y2=24 stroke-width=1.1 stroke=black x1=6 y1=24 x2=20></line>
              <text text-anchor=middle x=13 y=14.5 dominant-baseline=middle>Portrait</text>
              <rect width=20 fill=white stroke=black x=30 height=14 y=11 rx=1></rect>
              <line y2=11 stroke-width=1.1 stroke=black x1=31 y1=25 x2=31></line>
              <text text-anchor=middle x=40.5 y=18 dominant-baseline=middle>Landscape</text>
            </svg>
          </div>
        <li>
          <p>The users' network speed, network latency and bandwidth cost might be different from one
            another, or might change for a single user over time.</p>

          <p class=example>A user might be on a fast, low-latency and constant-cost connection while
            at work, on a slow, low-latency and constant-cost connection while at home, and on a
            variable-speed, high-latency and variable-cost connection anywhere else.</p>
        </ul>
    <li>
      <p>Authors might want to show the same image content but with different rendered size depending
        on, usually, the width of the <a id=introduction-3:viewport-2 href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a>. This is usually referred to as
        <dfn id=viewport-based-selection>viewport-based selection</dfn>.
      </p>

      <div class=example>
        <p>A web page might have a banner at the top that always spans the entire <a id=introduction-3:viewport-3 href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a>
          width. In this case, the rendered size of the image depends on the physical size of the screen
          (assuming a maximised browser window).</p>

        <svg viewBox="0 0 52 25.6" height=160 aria-label="The upright-held phone shows a
     small wolf at the top, and the tablet shows the same image but it is bigger." role=img>
          

          
          <rect width=6 fill=white stroke=black x=6 height=12 y=8 rx=1></rect>
          <rect fill=#716966 x=7 width=4 height=2 y=9></rect>
          <image xlink:href=/images/wolf.jpg width=4 x=7 y=9 height=2></image>

          
          <rect width=20 fill=white stroke=black x=25 height=14 y=6 rx=1></rect>
          <line y2=6 stroke-width=1.1 stroke=black x1=26 y1=20 x2=26></line>
          <rect fill=#716966 x=27 width=17 height=8.5 y=7></rect>
          <image xlink:href=/images/wolf.jpg width=17 x=27 y=7 height=8.5></image>

        </svg>
      </div>

      <div class=example>
        <p>Another web page might have images in columns, with a single column for screens with a small
          physical size, two columns for screens with medium physical size, and three columns for screens
          with big physical size, with the images varying in rendered size in each case to fill up the
          <a id=introduction-3:viewport-4 href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a>. In this case, the rendered size of an image might be <em>bigger</em> in
          the one-column layout compared to the two-column layout, despite the screen being smaller.
        </p>

        <svg font-size=2.5 role=img viewBox="0 0 115 32" font-family=sans-serif height=200 aria-label="The rotated phone shows a top part of an image of a kettlebell swing; the
     upright-held tablet shows a bit smaller images in two columns; the laptop shows images in three
     columns.">
          

          
          <rect width=12 fill=white stroke=black x=6 height=6 y=24 rx=1></rect>
          <rect fill=#987b5a width=10 x=7 height=4.5 y=25></rect>
          <image xlink:href=/images/kettlebell.jpg preserveAspectRatio="xMinYMin slice" width=10 x=7 y=25 height=4.5></image>
          <text text-anchor=middle x=12 y=21>Narrow, 1 column</text>

          
          <rect width=14 fill=white stroke=black x=32 height=20 y=10 rx=1></rect>
          <line y2=29 stroke-width=1.1 stroke=black x1=32 y1=29 x2=46></line>
          <rect fill=#987b5a width=5.5 x=33 height=5.5 y=11></rect>
          <image xlink:href=/images/kettlebell.jpg width=5.5 x=33 y=11 height=5.5></image>
          <rect fill=burlywood width=5.5 x=39.5 height=5.5 y=11></rect>
          <rect fill=silver width=5.5 x=33 height=5.5 y=17.5></rect>
          <text text-anchor=middle x=39 y=7>Medium, 2 columns</text>

          
          <rect width=40 stroke-width=2 fill=white stroke=black x=65 height=26 y=2 rx=2></rect>
          <line y2=30 stroke-linecap=round stroke-width=2 stroke=black x1=61 y1=30 x2=109></line>
          <rect fill=#987b5a width=10 x=67 height=10 y=4></rect>
          <image xlink:href=/images/kettlebell.jpg width=10 x=67 y=4 height=10></image>
          <rect fill=burlywood width=10 x=80 height=10 y=4></rect>
          <rect fill=silver width=10 x=93 height=10 y=4></rect>
          <text text-anchor=middle x=85 y=25>Wide, 3 columns</text>
        </svg>
      </div>
    <li>
      <p>Authors might want to show different image content depending on the rendered size of the
        image. This is usually referred to as <dfn id=art-direction>art direction</dfn>.</p>

      <div class=example>
        <p>When a web page is viewed on a screen with a large physical size (assuming a maximised
          browser window), the author might wish to include some less relevant parts surrounding the
          critical part of the image. When the same web page is viewed on a screen with a small physical
          size, the author might wish to show only the critical part of the image.</p>

        <svg viewBox="0 0 52 25.6" height=160 aria-label="The upright-held phone shows a
     cropped image of a wolf; the rotated tablet shows the uncropped image." role=img>
          

          
          <rect width=6 fill=white stroke=black x=6 height=12 y=8 rx=1></rect>
          <rect fill=#716966 x=7 width=4 height=6 y=9></rect>
          <image xlink:href=/images/wolf.jpg preserveAspectRatio="xMidYMid slice" width=4 x=7 y=9 height=6></image>

          
          <rect width=20 fill=white stroke=black x=25 height=14 y=6 rx=1></rect>
          <line y2=6 stroke-width=1.1 stroke=black x1=26 y1=20 x2=26></line>
          <rect fill=#716966 x=27 width=17 height=8.5 y=7></rect>
          <image xlink:href=/images/wolf.jpg width=17 x=27 y=7 height=8.5></image>

        </svg>
      </div>
    <li>
      <p>Authors might want to show the same image content but using different image formats,
        depending on which image formats the user agent supports. This is usually referred to as
        <dfn id=image-format-based-selection>image format-based selection</dfn>.
      </p>

      <p class=example>A web page might have some images in the JPEG, WebP and JPEG XR image
        formats, with the latter two having better compression abilities compared to JPEG. Since
        different user agents can support different image formats, with some formats offering better
        compression ratios, the author would like to serve the better formats to user agents that
        support them, while providing JPEG fallback for user agents that don't.</p>
    </ul>

  <p>The above situations are not mutually exclusive. For example, it is reasonable to combine
    different resources for different <a href=#device-pixel-ratio id=introduction-3:device-pixel-ratio>device-pixel-ratio</a> with different resources for
    <a href=#art-direction id=introduction-3:art-direction>art direction</a>.
  </p>

  <p>While it is possible to solve these problems using scripting, doing so introduces some other
    problems:</p>

  <ul><li>
      <p>Some user agents aggressively download images specified in the HTML markup, before scripts
        have had a chance to run, so that web pages complete loading sooner. If a script changes which
        image to download, the user agent will potentially start two separate downloads, which can
        instead cause worse page loading performance.</p>
    <li>
      <p>If the author avoids specifying any image in the HTML markup and instead instantiates a
        single download from script, that avoids the double download problem above but then no image will
        be downloaded at all for users with scripting disabled and the aggressive image downloading
        optimization will also be disabled.</p>
    </ul>

  <p>With this in mind, this specification introduces a number of features to address the above
    problems in a declarative manner.</p>

  <dl><dt><a href=#device-pixel-ratio id=introduction-3:device-pixel-ratio-2>Device-pixel-ratio</a>-based selection when the rendered size of the image is
      fixed<dd>
      <p>The <code id=introduction-3:attr-img-src-2><a href=embedded-content.html#attr-img-src>src</a></code> and <code id=introduction-3:attr-img-srcset><a href=embedded-content.html#attr-img-srcset>srcset</a></code>
        attributes on the <code id=introduction-3:the-img-element-2><a href=embedded-content.html#the-img-element>img</a></code> element can be used, using the <code>x</code>
        descriptor, to provide multiple images that only vary in their size (the smaller image is a
        scaled-down version of the bigger image).</p>

      <p class=note>The <code>x</code> descriptor is not appropriate when the rendered
        size of the image depends on the <a id=introduction-3:viewport-5 href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a> width
        (<a href=#viewport-based-selection id=introduction-3:viewport-based-selection>viewport-based selection</a>), but can be used together with
        <a href=#art-direction id=introduction-3:art-direction-2>art direction</a>.
      </p>

      <div class=example>

        <pre><code class=html>&lt;h2>From today's featured article&lt;/h2>
&lt;img <strong>src="/uploads/100-marie-lloyd.jpg"</strong>
     <strong>srcset="/uploads/150-marie-lloyd.jpg 1.5x, /uploads/200-marie-lloyd.jpg 2x"</strong>
     alt="" width="100" height="150">
&lt;p>&lt;b>&lt;a href="/wiki/Marie_Lloyd">Marie Lloyd&lt;/a>&lt;/b> (1870–1922)
was an English &lt;a href="/wiki/Music_hall">music hall&lt;/a> singer, ...</code></pre>

        <p>The user agent can choose any of the given resources depending on the user's screen's pixel
          density, zoom level, and possibly other factors such as the user's network conditions.</p>

        <p>For backwards compatibility with older user agents that don't yet understand the <code id=introduction-3:attr-img-srcset-2><a href=embedded-content.html#attr-img-srcset>srcset</a></code> attribute, one of the URLs is specified in the
          <code id=introduction-3:the-img-element-3><a href=embedded-content.html#the-img-element>img</a></code> element's <code id=introduction-3:attr-img-src-3><a href=embedded-content.html#attr-img-src>src</a></code> attribute. This will result
          in something useful (though perhaps lower-resolution than the user would like) being displayed
          even in older user agents. For new user agents, the <code id=introduction-3:attr-img-src-4><a href=embedded-content.html#attr-img-src>src</a></code>
          attribute participates in the resource selection, as if it was specified in <code id=introduction-3:attr-img-srcset-3><a href=embedded-content.html#attr-img-srcset>srcset</a></code> with a <code>1x</code> descriptor.
        </p>

        <p>The image's rendered size is given in the <code id=introduction-3:attr-dim-width><a href=embedded-content-other.html#attr-dim-width>width</a></code> and
          <code id=introduction-3:attr-dim-height><a href=embedded-content-other.html#attr-dim-height>height</a></code> attributes, which allows the user agent to
          allocate space for the image before it is downloaded.
        </p>

      </div>
    <dt><a href=#viewport-based-selection id=introduction-3:viewport-based-selection-2>Viewport-based selection</a><dd>
      <p>The <code id=introduction-3:attr-img-srcset-4><a href=embedded-content.html#attr-img-srcset>srcset</a></code> and <code id=introduction-3:attr-img-sizes><a href=embedded-content.html#attr-img-sizes>sizes</a></code> attributes can be used, using the <code>w</code>
        descriptor, to provide multiple images that only vary in their size (the smaller image is a
        scaled-down version of the bigger image).</p>

      <div class=example>

        <p>In this example, a banner image takes up the entire <a id=introduction-3:viewport-6 href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a> width (using
          appropriate CSS).</p>

        <pre><code class=html>&lt;h1>&lt;img <strong>sizes="100vw" srcset="wolf-400.jpg 400w, wolf-800.jpg 800w, wolf-1600.jpg 1600w"</strong>
     src="wolf-400.jpg" alt="The rad wolf">&lt;/h1></code></pre>

        <p>The user agent will calculate the effective pixel density of each image from the specified
          <code>w</code> descriptors and the specified rendered size in the <code id=introduction-3:attr-img-sizes-2><a href=embedded-content.html#attr-img-sizes>sizes</a></code> attribute. It can then choose any of the given resources
          depending on the user's screen's pixel density, zoom level, and possibly other factors such as
          the user's network conditions.
        </p>

        <p>If the user's screen is 320 <a href=https://drafts.csswg.org/css-values/#px id="introduction-3:'px'-2" data-x-internal="'px'">CSS pixels</a> wide, this is equivalent
          to specifying <code>wolf-400.jpg 1.25x, wolf-800.jpg 2.5x, wolf-1600.jpg 5x</code>.
          On the other hand, if the user's screen is 1200 <a href=https://drafts.csswg.org/css-values/#px id="introduction-3:'px'-3" data-x-internal="'px'">CSS pixels</a> wide,
          this is equivalent to specifying <code>wolf-400.jpg 0.33x, wolf-800.jpg 0.67x, wolf-1600.jpg 1.33x</code>. By using the
          <code>w</code> descriptors and the <code id=introduction-3:attr-img-sizes-3><a href=embedded-content.html#attr-img-sizes>sizes</a></code>
          attribute, the user agent can choose the correct image source to download regardless of how
          large the user's device is.
        </p>

        <p>For backwards compatibility, one of the URLs is specified in the <code id=introduction-3:the-img-element-4><a href=embedded-content.html#the-img-element>img</a></code> element's
          <code id=introduction-3:attr-img-src-5><a href=embedded-content.html#attr-img-src>src</a></code> attribute. In new user agents, the <code id=introduction-3:attr-img-src-6><a href=embedded-content.html#attr-img-src>src</a></code> attribute is ignored when the <code id=introduction-3:attr-img-srcset-5><a href=embedded-content.html#attr-img-srcset>srcset</a></code> attribute uses <code>w</code> descriptors.
        </p>

      </div>

      <div class=example>

        <p>In this example, the web page has three layouts depending on the width of the
          <a id=introduction-3:viewport-7 href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a>. The narrow layout has one column of images (the width of each image is
          about 100%), the middle layout has two columns of images (the width of each image is about
          50%), and the widest layout has three columns of images, and some page margin (the width of
          each image is about 33%). It breaks between these layouts when the <a id=introduction-3:viewport-8 href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a> is
          <code>30em</code> wide and <code>50em</code> wide, respectively.
        </p>

        <pre><code class=html>&lt;img <strong>sizes="(max-width: 30em) 100vw, (max-width: 50em) 50vw, calc(33vw - 100px)"</strong>
     <strong>srcset="swing-200.jpg 200w, swing-400.jpg 400w, swing-800.jpg 800w, swing-1600.jpg 1600w"</strong>
     src="swing-400.jpg" alt="Kettlebell Swing"></code></pre>

        <p>The <code id=introduction-3:attr-img-sizes-4><a href=embedded-content.html#attr-img-sizes>sizes</a></code> attribute sets up the layout breakpoints at
          <code>30em</code> and <code>50em</code>, and declares the image sizes
          between these breakpoints to be <code>100vw</code>, <code>50vw</code>, or
          <code>calc(33vw - 100px)</code>. These sizes do not necessarily have to match up
          exactly with the actual image width as specified in the CSS.
        </p>

        <p>The user agent will pick a width from the <code id=introduction-3:attr-img-sizes-5><a href=embedded-content.html#attr-img-sizes>sizes</a></code>
          attribute, using the first item with a <a id=introduction-3:media-condition href=https://drafts.csswg.org/mediaqueries/#typedef-media-condition data-x-internal=media-condition>&lt;media-condition></a> (the part in
          parentheses) that evaluates to true, or using the last item (<code>calc(33vw -
     100px)</code>) if they all evaluate to false.</p>

        <p>For example, if the <a id=introduction-3:viewport-9 href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a> width is <code>29em</code>, then <code>(max-width: 30em)</code> evaluates to true and <code>100vw</code> is used,
          so the image size, for the purpose of resource selection, is <code>29em</code>. If
          the <a id=introduction-3:viewport-10 href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a> width is instead <code>32em</code>, then
          <code>(max-width: 30em)</code> evaluates to false, but
          <code>(max-width: 50em)</code> evaluates to true
          and <code>50vw</code> is used, so the image size, for the purpose of resource
          selection, is <code>16em</code> (half the <a id=introduction-3:viewport-11 href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a> width). Notice that
          the slightly wider <a id=introduction-3:viewport-12 href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a> results in a smaller image because of the different
          layout.
        </p>

        <p>The user agent can then calculate the effective pixel density and choose an appropriate
          resource similarly to the previous example.</p>

      </div>

      <div class=example>

        <p>This example is the same as the previous example, but the image is <a href=urls-and-fetching.html#attr-loading-lazy-state id=introduction-3:attr-loading-lazy-state>lazy-loaded</a>. In this case, the <code id=introduction-3:attr-img-sizes-6><a href=embedded-content.html#attr-img-sizes>sizes</a></code> attribute can use the <code id=introduction-3:valdef-sizes-auto><a href=#valdef-sizes-auto>auto</a></code> keyword, and the user agent will use the <code id=introduction-3:attr-dim-width-2><a href=embedded-content-other.html#attr-dim-width>width</a></code> attribute (or the width specified in CSS) for the
          <a href=#source-size-2 id=introduction-3:source-size-2>source size</a>.
        </p>

        <pre><code class=html>&lt;img <strong>loading="lazy" width="200" height="200" sizes="auto"</strong>
     srcset="swing-200.jpg 200w, swing-400.jpg 400w, swing-800.jpg 800w, swing-1600.jpg 1600w"
     src="swing-400.jpg" alt="Kettlebell Swing"></code></pre>

        <p>For better backwards-compatibility with legacy user agents that don't support the <code id=introduction-3:valdef-sizes-auto-2><a href=#valdef-sizes-auto>auto</a></code> keyword, fallback sizes can be specified if desired.</p>

        <pre><code class=html>&lt;img loading="lazy" width="200" height="200"
     <strong>sizes="auto, (max-width: 30em) 100vw, (max-width: 50em) 50vw, calc(33vw - 100px)"</strong>
     srcset="swing-200.jpg 200w, swing-400.jpg 400w, swing-800.jpg 800w, swing-1600.jpg 1600w"
     src="swing-400.jpg" alt="Kettlebell Swing"></code></pre>

      </div>
    <dt><a href=#art-direction id=introduction-3:art-direction-3>Art direction</a>-based selection<dd>
      <p>The <code id=introduction-3:the-picture-element><a href=embedded-content.html#the-picture-element>picture</a></code> element and the <code id=introduction-3:the-source-element><a href=embedded-content.html#the-source-element>source</a></code> element, together with the <code id=introduction-3:attr-source-media><a href=embedded-content.html#attr-source-media>media</a></code> attribute, can be used to provide multiple images that
        vary the image content (for instance the smaller image might be a cropped version of the bigger
        image).</p>

      <div class=example>

        <pre><code class=html>&lt;picture>
  &lt;source <strong>media="(min-width: 45em)"</strong> srcset="large.jpg">
  &lt;source <strong>media="(min-width: 32em)"</strong> srcset="med.jpg">
  &lt;img src="small.jpg" alt="The wolf runs through the snow.">
&lt;/picture></code></pre>

        <p>The user agent will choose the first <code id=introduction-3:the-source-element-2><a href=embedded-content.html#the-source-element>source</a></code> element for which the media query
          in the <code id=introduction-3:attr-source-media-2><a href=embedded-content.html#attr-source-media>media</a></code> attribute matches, and then choose an
          appropriate URL from its <code id=introduction-3:attr-source-srcset><a href=embedded-content.html#attr-source-srcset>srcset</a></code> attribute.</p>

        <p>The rendered size of the image varies depending on which resource is chosen. To specify
          dimensions that the user agent can use before having downloaded the image, CSS can be used.</p>

        <pre><code class=css>img { width: 300px; height: 300px }
@media (min-width: 32em) { img { width: 500px; height:300px } }
@media (min-width: 45em) { img { width: 700px; height:400px } }</code></pre>

      </div>

      <div class=example>

        <p>This example combines <a href=#art-direction id=introduction-3:art-direction-4>art direction</a>- and <a href=#device-pixel-ratio id=introduction-3:device-pixel-ratio-3>device-pixel-ratio</a>-based
          selection. A banner that takes half the <a id=introduction-3:viewport-13 href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a> is provided in two versions,
          one for wide screens and one for narrow screens.</p>

        <pre><code class=html>&lt;h1>
 &lt;picture>
  &lt;source media="(max-width: 500px)" srcset="banner-phone.jpeg, banner-phone-HD.jpeg 2x">
  &lt;img src="banner.jpeg" srcset="banner-HD.jpeg 2x" alt="The Breakfast Combo">
 &lt;/picture>
&lt;/h1></code></pre>

      </div>
    <dt><a href=#image-format-based-selection id=introduction-3:image-format-based-selection>Image format-based selection</a><dd>
      <p>The <code id=introduction-3:attr-source-type><a href=embedded-content.html#attr-source-type>type</a></code> attribute on the <code id=introduction-3:the-source-element-3><a href=embedded-content.html#the-source-element>source</a></code> element
        can be used to provide multiple images in different formats.</p>

      <div class=example>

        <pre><code class=html>&lt;h2>From today's featured article&lt;/h2>
&lt;picture>
 &lt;source srcset="/uploads/100-marie-lloyd.webp" <strong>type="image/webp"</strong>>
 &lt;source srcset="/uploads/100-marie-lloyd.jxr" <strong>type="image/vnd.ms-photo"</strong>>
 &lt;img src="/uploads/100-marie-lloyd.jpg" alt="" width="100" height="150">
&lt;/picture>
&lt;p>&lt;b>&lt;a href="/wiki/Marie_Lloyd">Marie Lloyd&lt;/a>&lt;/b> (1870–1922)
was an English &lt;a href="/wiki/Music_hall">music hall&lt;/a> singer, ...</code></pre>

        <p>In this example, the user agent will choose the first source that has a <code id=introduction-3:attr-source-type-2><a href=embedded-content.html#attr-source-type>type</a></code> attribute with a supported MIME type. If the user agent
          supports WebP images, the first <code id=introduction-3:the-source-element-4><a href=embedded-content.html#the-source-element>source</a></code> element will be chosen. If not, but the
          user agent does support JPEG XR images, the second <code id=introduction-3:the-source-element-5><a href=embedded-content.html#the-source-element>source</a></code> element will be chosen.
          If neither of those formats are supported, the <code id=introduction-3:the-img-element-5><a href=embedded-content.html#the-img-element>img</a></code> element will be chosen.</p>

      </div>
    </dl>


  <h6 id=adaptive-images><span class=secno>4.8.4.1.1</span> Adaptive images<a href=#adaptive-images class=self-link></a></h6>

  <p><i>This section is non-normative.</i></p>

  <p>CSS and media queries can be used to construct graphical page layouts that adapt dynamically to
    the user's environment, in particular to different <a id=adaptive-images:viewport href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a> dimensions and pixel
    densities. For content, however, CSS does not help; instead, we have the <code id=adaptive-images:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> element's
    <code id=adaptive-images:attr-img-srcset><a href=embedded-content.html#attr-img-srcset>srcset</a></code> attribute and the <code id=adaptive-images:the-picture-element><a href=embedded-content.html#the-picture-element>picture</a></code> element.
    This section walks through a sample case showing how to use these features.
  </p>

  <p>Consider a situation where on wide screens (wider than 600 <a href=https://drafts.csswg.org/css-values/#px id="adaptive-images:'px'" data-x-internal="'px'">CSS
      pixels</a>) a 300×150 image named <code>a-rectangle.png</code> is to be used,
    but on smaller screens (600 <a href=https://drafts.csswg.org/css-values/#px id="adaptive-images:'px'-2" data-x-internal="'px'">CSS pixels</a> and less), a smaller
    100×100 image called <code>a-square.png</code> is to be used. The markup for this
    would look like this:</p>

  <pre><code class=html>&lt;figure>
 &lt;picture>
  &lt;source srcset="a-square.png" media="(max-width: 600px)">
  &lt;img src="a-rectangle.png" alt="Barney Frank wears a suit and glasses.">
 &lt;/picture>
 &lt;figcaption>Barney Frank, 2011&lt;/figcaption>
&lt;/figure></code></pre>

  <p class=note>For details on what to put in the <code id=adaptive-images:attr-img-alt><a href=embedded-content.html#attr-img-alt>alt</a></code>
    attribute, see the <a href=#alt>Requirements for providing text to act as an alternative for
      images</a> section.</p>

  <p>The problem with this is that the user agent does not necessarily know what dimensions to use
    for the image when the image is loading. To avoid the layout having to be reflowed multiple times
    as the page is loading, CSS and CSS media queries can be used to provide the dimensions:</p>

  <pre><code class=html>&lt;style>
 #a { width: 300px; height: 150px; }
 @media (max-width: 600px) { #a { width: 100px; height: 100px; } }
&lt;/style>
&lt;figure>
 &lt;picture>
  &lt;source srcset="a-square.png" media="(max-width: 600px)">
  &lt;img src="a-rectangle.png" alt="Barney Frank wears a suit and glasses." id="a">
 &lt;/picture>
 &lt;figcaption>Barney Frank, 2011&lt;/figcaption>
&lt;/figure></code></pre>

  <p>Alternatively, the <code id=adaptive-images:attr-dim-width><a href=embedded-content-other.html#attr-dim-width>width</a></code> and <code id=adaptive-images:attr-dim-height><a href=embedded-content-other.html#attr-dim-height>height</a></code> attributes can be used to provide the width and height for
    legacy user agents, using CSS just for the user agents that support <code id=adaptive-images:the-picture-element-2><a href=embedded-content.html#the-picture-element>picture</a></code>:</p>

  <pre><code class=html>&lt;style media="(max-width: 600px)">
 #a { width: 100px; height: 100px; }
&lt;/style>
&lt;figure>
 &lt;picture>
  &lt;source srcset="a-square.png" media="(max-width: 600px)">
  &lt;img src="a-rectangle.png" width="300" height="150"
  alt="Barney Frank wears a suit and glasses." id="a">
 &lt;/picture>
 &lt;figcaption>Barney Frank, 2011&lt;/figcaption>
&lt;/figure></code></pre>

  <hr>

  <p>The <code id=adaptive-images:the-img-element-2><a href=embedded-content.html#the-img-element>img</a></code> element is used with the <code id=adaptive-images:attr-img-src><a href=embedded-content.html#attr-img-src>src</a></code> attribute,
    which gives the URL of the image to use for legacy user agents that do not support the
    <code id=adaptive-images:the-picture-element-3><a href=embedded-content.html#the-picture-element>picture</a></code> element. This leads to a question of which image to provide in the <code id=adaptive-images:attr-img-src-2><a href=embedded-content.html#attr-img-src>src</a></code> attribute.
  </p>

  <p>If the author wants the biggest image in legacy user agents, the markup could be as
    follows:</p>

  <pre><code class=html>&lt;picture>
 &lt;source srcset="pear-mobile.jpeg" media="(max-width: 720px)">
 &lt;source srcset="pear-tablet.jpeg" media="(max-width: 1280px)">
 &lt;img src="pear-desktop.jpeg" alt="The pear is juicy.">
&lt;/picture></code></pre>

  <p>However, if legacy mobile user agents are more important, one can list all three images in the
    <code id=adaptive-images:the-source-element><a href=embedded-content.html#the-source-element>source</a></code> elements, overriding the <code id=adaptive-images:attr-img-src-3><a href=embedded-content.html#attr-img-src>src</a></code> attribute
    entirely.
  </p>

  <pre><code class=html>&lt;picture>
 &lt;source srcset="pear-mobile.jpeg" media="(max-width: 720px)">
 &lt;source srcset="pear-tablet.jpeg" media="(max-width: 1280px)">
 &lt;source srcset="pear-desktop.jpeg">
 &lt;img src="pear-mobile.jpeg" alt="The pear is juicy.">
&lt;/picture></code></pre>

  <p>Since at this point the <code id=adaptive-images:attr-img-src-4><a href=embedded-content.html#attr-img-src>src</a></code> attribute is actually being
    ignored entirely by <code id=adaptive-images:the-picture-element-4><a href=embedded-content.html#the-picture-element>picture</a></code>-supporting user agents, the <code id=adaptive-images:attr-img-src-5><a href=embedded-content.html#attr-img-src>src</a></code> attribute can default to any image, including one that is neither
    the smallest nor biggest:</p>

  <pre><code class=html>&lt;picture>
 &lt;source srcset="pear-mobile.jpeg" media="(max-width: 720px)">
 &lt;source srcset="pear-tablet.jpeg" media="(max-width: 1280px)">
 &lt;source srcset="pear-desktop.jpeg">
 &lt;img src="pear-tablet.jpeg" alt="The pear is juicy.">
&lt;/picture></code></pre>

  <hr>

  <p>Above the <code>max-width</code> media feature is used, giving the maximum
    (<a id=adaptive-images:viewport-2 href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a>) dimensions that an image is intended for. It is also possible to use <code>min-width</code> instead.</p>

  <pre><code class=html>&lt;picture>
 &lt;source srcset="pear-desktop.jpeg" media="(min-width: 1281px)">
 &lt;source srcset="pear-tablet.jpeg" media="(min-width: 721px)">
 &lt;img src="pear-mobile.jpeg" alt="The pear is juicy.">
&lt;/picture></code></pre>


  <h5 id=attributes-common-to-source-and-img-elements><span class=secno>4.8.4.2</span> Attributes common to <code id=attributes-common-to-source-and-img-elements:the-source-element><a href=embedded-content.html#the-source-element>source</a></code>,
  <code id=attributes-common-to-source-and-img-elements:the-img-element><a href=embedded-content.html#the-img-element>img</a></code>, and <code id=attributes-common-to-source-and-img-elements:the-link-element><a href=semantics.html#the-link-element>link</a></code> elements<a href=#attributes-common-to-source-and-img-elements class=self-link></a></h5>

  <h6 id=srcset-attributes><span class=secno>4.8.4.2.1</span> Srcset attributes<a href=#srcset-attributes class=self-link></a></h6>

  <p>A <dfn id=srcset-attribute>srcset attribute</dfn> is an attribute with requirements defined in this section.</p>

  <p>If present, its value must consist of one or more <a href=#image-candidate-string id=srcset-attributes:image-candidate-string>image
      candidate strings</a>, each separated from the next by a U+002C COMMA character (,). If an
    <a href=#image-candidate-string id=srcset-attributes:image-candidate-string-2>image candidate string</a> contains no descriptors and no <a id=srcset-attributes:space-characters href=https://infra.spec.whatwg.org/#ascii-whitespace data-x-internal=space-characters>ASCII whitespace</a>
    after the URL, the following <a href=#image-candidate-string id=srcset-attributes:image-candidate-string-3>image candidate string</a>, if there is one, must begin with
    one or more <a id=srcset-attributes:space-characters-2 href=https://infra.spec.whatwg.org/#ascii-whitespace data-x-internal=space-characters>ASCII whitespace</a>.
  </p>

  <p>An <dfn id=image-candidate-string>image candidate string</dfn> consists of the following components, in order, with the
    further restrictions described below this list:</p>

  <ol><li>
      <p>Zero or more <a id=srcset-attributes:space-characters-3 href=https://infra.spec.whatwg.org/#ascii-whitespace data-x-internal=space-characters>ASCII whitespace</a>.</p>
    <li>
      <p>A <a id=srcset-attributes:valid-non-empty-url href=urls-and-fetching.html#valid-non-empty-url>valid non-empty URL</a> that does not start or end with a U+002C COMMA
        character (,), referencing a non-interactive, optionally animated, image resource that is neither
        paged nor scripted.</p>
    <li>
      <p>Zero or more <a id=srcset-attributes:space-characters-4 href=https://infra.spec.whatwg.org/#ascii-whitespace data-x-internal=space-characters>ASCII whitespace</a>.</p>
    <li>
      <p>Zero or one of the following:</p>

      <ul><li>
          <p>A <dfn id=width-descriptor>width descriptor</dfn>, consisting of: <a id=srcset-attributes:space-characters-5 href=https://infra.spec.whatwg.org/#ascii-whitespace data-x-internal=space-characters>ASCII whitespace</a>, a
            <a id=srcset-attributes:valid-non-negative-integer href=common-microsyntaxes.html#valid-non-negative-integer>valid non-negative integer</a> giving a number greater than zero representing the
            <dfn id=width-descriptor-value>width descriptor value</dfn>, and a U+0077 LATIN SMALL LETTER W character.
          </p>
        <li>
          <p>A <dfn id=pixel-density-descriptor>pixel density descriptor</dfn>, consisting of: <a id=srcset-attributes:space-characters-6 href=https://infra.spec.whatwg.org/#ascii-whitespace data-x-internal=space-characters>ASCII whitespace</a>, a
            <a id=srcset-attributes:valid-floating-point-number href=common-microsyntaxes.html#valid-floating-point-number>valid floating-point number</a> giving a number greater than zero representing the
            <dfn id=pixel-density-descriptor-value>pixel density descriptor value</dfn>, and a U+0078 LATIN SMALL LETTER X
            character.
          </p>
        </ul>
    <li>
      <p>Zero or more <a id=srcset-attributes:space-characters-7 href=https://infra.spec.whatwg.org/#ascii-whitespace data-x-internal=space-characters>ASCII whitespace</a>.</p>
    </ol>

  <p>There must not be an <a href=#image-candidate-string id=srcset-attributes:image-candidate-string-4>image candidate string</a> for an element that has the same
    <a href=#width-descriptor-value id=srcset-attributes:width-descriptor-value>width descriptor value</a> as another <a href=#image-candidate-string id=srcset-attributes:image-candidate-string-5>image candidate string</a>'s <a href=#width-descriptor-value id=srcset-attributes:width-descriptor-value-2>width
      descriptor value</a> for the same element.
  </p>

  <p>There must not be an <a href=#image-candidate-string id=srcset-attributes:image-candidate-string-6>image candidate string</a> for an element that has the same
    <a href=#pixel-density-descriptor-value id=srcset-attributes:pixel-density-descriptor-value>pixel density descriptor value</a> as another <a href=#image-candidate-string id=srcset-attributes:image-candidate-string-7>image candidate string</a>'s
    <a href=#pixel-density-descriptor-value id=srcset-attributes:pixel-density-descriptor-value-2>pixel density descriptor value</a> for the same element. For the purpose of this
    requirement, an <a href=#image-candidate-string id=srcset-attributes:image-candidate-string-8>image candidate string</a> with no descriptors is equivalent to an
    <a href=#image-candidate-string id=srcset-attributes:image-candidate-string-9>image candidate string</a> with a <code>1x</code> descriptor.
  </p>

  <p>If an <a href=#image-candidate-string id=srcset-attributes:image-candidate-string-10>image candidate string</a> for an element has the <a href=#width-descriptor id=srcset-attributes:width-descriptor>width descriptor</a>
    specified, all other <a href=#image-candidate-string id=srcset-attributes:image-candidate-string-11>image candidate strings</a> for that
    element must also have the <a href=#width-descriptor id=srcset-attributes:width-descriptor-2>width descriptor</a> specified.</p>

  <p>The specified width in an <a href=#image-candidate-string id=srcset-attributes:image-candidate-string-12>image candidate string</a>'s <a href=#width-descriptor id=srcset-attributes:width-descriptor-3>width descriptor</a>
    must match the <a id=srcset-attributes:natural-width href=https://drafts.csswg.org/css-images/#natural-width data-x-internal=natural-width>natural width</a> in the resource given by the
    <a href=#image-candidate-string id=srcset-attributes:image-candidate-string-13>image candidate string</a>'s URL, if it has a <a id=srcset-attributes:natural-width-2 href=https://drafts.csswg.org/css-images/#natural-width data-x-internal=natural-width>natural width</a>.
  </p>

  <p>If an element has a <a href=#sizes-attribute id=srcset-attributes:sizes-attribute>sizes attribute</a> present, all <a href=#image-candidate-string id=srcset-attributes:image-candidate-string-14>image candidate strings</a> for that element must have the <a href=#width-descriptor id=srcset-attributes:width-descriptor-4>width
      descriptor</a> specified.</p>


  <h6 id=sizes-attributes><span class=secno>4.8.4.2.2</span> Sizes attributes<a href=#sizes-attributes class=self-link></a></h6>

  <p>A <dfn id=sizes-attribute>sizes attribute</dfn> is an attribute with requirements defined in this section.</p>

  <p>If present, the value must be a <a href=#valid-source-size-list id=sizes-attributes:valid-source-size-list>valid source size list</a>.</p>

  <p>A <dfn id=valid-source-size-list>valid source size list</dfn> is a string that matches the following grammar:
    <a href=references.html#refsCSSVALUES>[CSSVALUES]</a>
    <a href=references.html#refsMQ>[MQ]</a>
  </p>

  <pre><code class=html><dfn id=source-size-list data-dfn-type=type>&lt;source-size-list></dfn> = <a href=#source-size id=sizes-attributes:source-size>&lt;source-size></a>#? , <a href=#source-size-value id=sizes-attributes:source-size-value>&lt;source-size-value></a>
<dfn id=source-size data-dfn-type=type>&lt;source-size></dfn> = <a id=sizes-attributes:media-condition href=https://drafts.csswg.org/mediaqueries/#typedef-media-condition data-x-internal=media-condition>&lt;media-condition></a> <a href=#source-size-value id=sizes-attributes:source-size-value-2>&lt;source-size-value></a> | <a href=#valdef-sizes-auto id=sizes-attributes:valdef-sizes-auto>auto</a>
<dfn id=source-size-value data-dfn-type=type>&lt;source-size-value></dfn> = <a id=sizes-attributes:length-2 href=https://drafts.csswg.org/css-values/#lengths data-x-internal=length-2>&lt;length></a> | <a href=#valdef-sizes-auto id=sizes-attributes:valdef-sizes-auto-2>auto</a></code></pre>

  <p>A <a href=#source-size-value id=sizes-attributes:source-size-value-3>&lt;source-size-value></a> that is a <a id=sizes-attributes:length-2-2 href=https://drafts.csswg.org/css-values/#lengths data-x-internal=length-2>&lt;length></a> must not be negative,
    and must not use CSS functions other than the <a id=sizes-attributes:math-functions href=https://drafts.csswg.org/css-values/#math-function data-x-internal=math-functions>math functions</a>.</p>

  <p>The keyword <dfn id=valdef-sizes-auto><code>auto</code></dfn> is a width that is
    computed in <a href=#parse-a-sizes-attribute id=sizes-attributes:parse-a-sizes-attribute>parse a sizes attribute</a>. If present, it must be the first entry and the
    entire <a href=#source-size-list id=sizes-attributes:source-size-list>&lt;source-size-list></a> value must either be the string "<code>auto</code>" (<a id=sizes-attributes:ascii-case-insensitive href=https://infra.spec.whatwg.org/#ascii-case-insensitive data-x-internal=ascii-case-insensitive>ASCII case-insensitive</a>) or start with the string "<code>auto,</code>" (<a id=sizes-attributes:ascii-case-insensitive-2 href=https://infra.spec.whatwg.org/#ascii-case-insensitive data-x-internal=ascii-case-insensitive>ASCII case-insensitive</a>).</p>

  <p class=note>If the <code id=sizes-attributes:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> element that initiated the image loading (with the
    <a href=#update-the-image-data id=sizes-attributes:update-the-image-data>update the image data</a> or <a href=#img-environment-changes id=sizes-attributes:img-environment-changes>react to environment
      changes</a> algorithms) <a id=sizes-attributes:allows-auto-sizes href=embedded-content.html#allows-auto-sizes>allows auto-sizes</a> and is <a id=sizes-attributes:being-rendered href=rendering.html#being-rendered>being rendered</a>,
    then <code id=sizes-attributes:valdef-sizes-auto-3><a href=#valdef-sizes-auto>auto</a></code> is the <a id=sizes-attributes:concrete-object-size href=https://drafts.csswg.org/css-images/#concrete-object-size data-x-internal=concrete-object-size>concrete object size</a> width.
    Otherwise, the <code id=sizes-attributes:valdef-sizes-auto-4><a href=#valdef-sizes-auto>auto</a></code> value is ignored and the next
    <a href=#source-size-2 id=sizes-attributes:source-size-2>source size</a> is used instead, if any.
  </p>

  <p>The <code id=sizes-attributes:valdef-sizes-auto-5><a href=#valdef-sizes-auto>auto</a></code> keyword may be specified in the <code id=sizes-attributes:attr-source-sizes><a href=embedded-content.html#attr-source-sizes>sizes</a></code> attribute of <code id=sizes-attributes:the-source-element><a href=embedded-content.html#the-source-element>source</a></code> elements and <code id=sizes-attributes:attr-img-sizes><a href=embedded-content.html#attr-img-sizes>sizes</a></code> attribute of <code id=sizes-attributes:the-img-element-2><a href=embedded-content.html#the-img-element>img</a></code> elements, if the following
    conditions are met. Otherwise, <code id=sizes-attributes:valdef-sizes-auto-6><a href=#valdef-sizes-auto>auto</a></code> must not be
    specified.</p>

  <ul><li>
      <p>The element is a <code id=sizes-attributes:the-source-element-2><a href=embedded-content.html#the-source-element>source</a></code> element with a following sibling
        <code id=sizes-attributes:the-img-element-3><a href=embedded-content.html#the-img-element>img</a></code> element.
      </p>
    <li>
      <p>The element is an <code id=sizes-attributes:the-img-element-4><a href=embedded-content.html#the-img-element>img</a></code> element.</p>
    <li>
      <p>The <code id=sizes-attributes:the-img-element-5><a href=embedded-content.html#the-img-element>img</a></code> element referenced in either condition above <a id=sizes-attributes:allows-auto-sizes-2 href=embedded-content.html#allows-auto-sizes>allows
          auto-sizes</a>.</p>
    </ul>

  <p class=note>In addition, it is strongly encouraged to specify dimensions using the <code id=sizes-attributes:attr-dim-width><a href=embedded-content-other.html#attr-dim-width>width</a></code> and <code id=sizes-attributes:attr-dim-height><a href=embedded-content-other.html#attr-dim-height>height</a></code> attributes
    or with CSS. Without specified dimensions, the image will likely render with 300x150 dimensions
    because <code>sizes="auto"</code> implies <code>contain-intrinsic-size: 300px
  150px</code> in <a href=rendering.html#img-contain-size>the Rendering section</a>.</p>

  <p>The <a href=#source-size-value id=sizes-attributes:source-size-value-4>&lt;source-size-value></a> gives the intended layout width of the image. The
    author can specify different widths for different environments with
    <a id=sizes-attributes:media-condition-2 href=https://drafts.csswg.org/mediaqueries/#typedef-media-condition data-x-internal=media-condition>&lt;media-condition></a>s.
  </p>

  <p class=note>Percentages are not allowed in a <a href=#source-size-value id=sizes-attributes:source-size-value-5>&lt;source-size-value></a>,
    to avoid confusion about what it would be relative to.
    The <a id="sizes-attributes:'vw'" href=https://drafts.csswg.org/css-values/#vw data-x-internal="'vw'">'vw'</a> unit can be used for sizes relative to the <a id=sizes-attributes:viewport href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a>
    width.</p>

  

    <h5 id=images-processing-model><span class=secno>4.8.4.3</span> Processing model<a href=#images-processing-model class=self-link></a></h5>

    <hr>

    <p>An <code id=images-processing-model:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> element has a <dfn id=current-request>current request</dfn> and a <dfn id=pending-request>pending request</dfn>.
      The <a href=#current-request id=images-processing-model:current-request>current request</a> is initially set to a new <a href=#image-request id=images-processing-model:image-request>image request</a>.
      The <a href=#pending-request id=images-processing-model:pending-request>pending request</a> is initially set to null.</p>

    <p>An <dfn id=image-request data-export="">image request</dfn> has a <dfn data-dfn-for="image request" id=img-req-state data-export="">state</dfn>, <dfn data-dfn-for="image request" id=img-req-url data-export="">current URL</dfn>, and <dfn data-dfn-for="image request" id=img-req-data data-export="">image data</dfn>.</p>

    <p>An <a href=#image-request id=images-processing-model:image-request-2>image request</a>'s <a href=#img-req-state id=images-processing-model:img-req-state>state</a> is one of the
      following:</p>

    <dl><dt><dfn id=img-none>Unavailable</dfn><dd>The user agent hasn't obtained any image data,
        or has obtained some or all of the image data but
        hasn't yet decoded enough of the image to get the image dimensions.<dt><dfn id=img-inc>Partially available</dfn><dd>The user agent has obtained some of the image data and at least the image dimensions are
        available.<dt><dfn id=img-all>Completely available</dfn><dd>The user agent has obtained all of the image data and at least the image dimensions are
        available.<dt><dfn id=img-error>Broken</dfn><dd>The user agent has obtained all of the image data that it can, but it cannot even decode the
        image enough to get the image dimensions (e.g. the image is corrupted, or the format is not
        supported, or no data could be obtained).</dl>

    <p>An <a href=#image-request id=images-processing-model:image-request-3>image request</a>'s <a href=#img-req-url id=images-processing-model:img-req-url>current URL</a> is initially the
      empty string.</p>

    <p>An <a href=#image-request id=images-processing-model:image-request-4>image request</a>'s <a href=#img-req-data id=images-processing-model:img-req-data>image data</a> is the decoded
      image data.</p>

    <p>When an <a href=#image-request id=images-processing-model:image-request-5>image request</a>'s <a href=#img-req-state id=images-processing-model:img-req-state-2>state</a> is either <a href=#img-inc id=images-processing-model:img-inc>partially available</a> or <a href=#img-all id=images-processing-model:img-all>completely available</a>,
      the <a href=#image-request id=images-processing-model:image-request-6>image request</a> is said to be <dfn id=img-available>available</dfn>.</p>

    <p>When an <code id=images-processing-model:the-img-element-2><a href=embedded-content.html#the-img-element>img</a></code> element's <a href=#current-request id=images-processing-model:current-request-2>current request</a>'s <a href=#img-req-state id=images-processing-model:img-req-state-3>state</a> is <a href=#img-all id=images-processing-model:img-all-2>completely available</a> and the
      user agent can decode the media data without errors, then the <code id=images-processing-model:the-img-element-3><a href=embedded-content.html#the-img-element>img</a></code> element is said to
      be <dfn id=img-good>fully decodable</dfn>.</p>

    <p>An <a href=#image-request id=images-processing-model:image-request-7>image request</a>'s <a href=#img-req-state id=images-processing-model:img-req-state-4>state</a> is initially <a href=#img-none id=images-processing-model:img-none>unavailable</a>.</p>

    <p>When an <code id=images-processing-model:the-img-element-4><a href=embedded-content.html#the-img-element>img</a></code> element's <a href=#current-request id=images-processing-model:current-request-3>current request</a> is <a href=#img-available id=images-processing-model:img-available>available</a>, the <code id=images-processing-model:the-img-element-5><a href=embedded-content.html#the-img-element>img</a></code> element provides a <a id=images-processing-model:paint-source href=https://drafts.csswg.org/css-images-4/#paint-source data-x-internal=paint-source>paint
        source</a> whose width is the image's <a href=#density-corrected-intrinsic-width-and-height id=images-processing-model:density-corrected-intrinsic-width-and-height>density-corrected natural width</a> (if any), whose height is the image's <a href=#density-corrected-intrinsic-width-and-height id=images-processing-model:density-corrected-intrinsic-width-and-height-2>density-corrected natural height</a>
      (if any), and whose appearance is the natural appearance of the image.</p>

    <hr>

    <p>An <code id=images-processing-model:the-img-element-6><a href=embedded-content.html#the-img-element>img</a></code> element is said to <dfn id=use-srcset-or-picture>use <code>srcset</code> or
        <code>picture</code></dfn> if it has a <code id=images-processing-model:attr-img-srcset><a href=embedded-content.html#attr-img-srcset>srcset</a></code> attribute
      specified or if it has a parent that is a <code id=images-processing-model:the-picture-element><a href=embedded-content.html#the-picture-element>picture</a></code> element.</p>

    <hr>

    <p>Each <code id=images-processing-model:the-img-element-7><a href=embedded-content.html#the-img-element>img</a></code> element has a <dfn id=last-selected-source>last selected source</dfn>, which must initially be
      null.</p>

    <p>Each <a href=#image-request id=images-processing-model:image-request-8>image request</a> has a <dfn id=current-pixel-density>current pixel density</dfn>, which must initially be
      1.</p>

    <p>Each <a href=#image-request id=images-processing-model:image-request-9>image request</a> has <dfn id=preferred-density-corrected-dimensions>preferred density-corrected dimensions</dfn>, which is
      either a struct consisting of a width and a height or is null. It must initially be null.</p>

    <p>To determine the <dfn id=density-corrected-intrinsic-width-and-height>density-corrected
        natural width and height</dfn> of an <code id=images-processing-model:the-img-element-8><a href=embedded-content.html#the-img-element>img</a></code> element <var>img</var>:</p>

    <ol><li>
        <p>Let <var>dim</var> be <var>img</var>'s <a href=#current-request id=images-processing-model:current-request-4>current request</a>'s <a href=#preferred-density-corrected-dimensions id=images-processing-model:preferred-density-corrected-dimensions>preferred
            density-corrected dimensions</a>.</p>

        <p class=note>The <a href=#preferred-density-corrected-dimensions id=images-processing-model:preferred-density-corrected-dimensions-2>preferred density-corrected dimensions</a> are set in the
          <a href=#prepare-an-image-for-presentation id=images-processing-model:prepare-an-image-for-presentation>prepare an image for presentation</a> algorithm based on meta information in the
          image.
        </p>
      <li>
        <p>If <var>dim</var> is null, set <var>dim</var> to <var>img</var>'s <a id=images-processing-model:natural-dimensions href=https://drafts.csswg.org/css-images/#natural-dimensions data-x-internal=natural-dimensions>natural
            dimensions</a>.</p>
      <li>
        <p>Set <var>dim</var>'s width to <var>dim</var>'s width divided by <var>img</var>'s
          <a href=#current-request id=images-processing-model:current-request-5>current request</a>'s <a href=#current-pixel-density id=images-processing-model:current-pixel-density>current pixel density</a>.
        </p>
      <li>
        <p>Set <var>dim</var>'s height to <var>dim</var>'s height divided by <var>img</var>'s
          <a href=#current-request id=images-processing-model:current-request-6>current request</a>'s <a href=#current-pixel-density id=images-processing-model:current-pixel-density-2>current pixel density</a>.
        </p>
      <li>
        <p>Return <var>dim</var>.</p>
      </ol>

    <p class=example>For example, if the <a href=#current-pixel-density id=images-processing-model:current-pixel-density-3>current pixel density</a> is 3.125, that means
      that there are 300 device pixels per <a href=https://drafts.csswg.org/css-values/#in id="images-processing-model:'in'" data-x-internal="'in'">CSS inch</a>, and thus if the image
      data is 300x600, it has <a href=#density-corrected-intrinsic-width-and-height id=images-processing-model:density-corrected-intrinsic-width-and-height-3>density-corrected natural width and height</a> of 96 <a href=https://drafts.csswg.org/css-values/#px id="images-processing-model:'px'" data-x-internal="'px'">CSS pixels</a> by 192 <a href=https://drafts.csswg.org/css-values/#px id="images-processing-model:'px'-2" data-x-internal="'px'">CSS pixels</a>.</p>

    <p>All <code id=images-processing-model:the-img-element-9><a href=embedded-content.html#the-img-element>img</a></code> and <code id=images-processing-model:the-link-element><a href=semantics.html#the-link-element>link</a></code> elements are associated with a <a href=#source-set id=images-processing-model:source-set>source set</a>.</p>

    <p>A <dfn id=source-set>source set</dfn> is an ordered set of zero or more <a href=#image-source id=images-processing-model:image-source>image sources</a>
      and a <a href=#source-size-2 id=images-processing-model:source-size-2>source size</a>.</p>

    <p>An <dfn id=image-source>image source</dfn> is a <a id=images-processing-model:url href=https://url.spec.whatwg.org/#concept-url data-x-internal=url>URL</a>, and optionally either a <a href=#pixel-density-descriptor id=images-processing-model:pixel-density-descriptor>pixel density
        descriptor</a>, or a <a href=#width-descriptor id=images-processing-model:width-descriptor>width descriptor</a>.</p>

    <p>A <dfn id=source-size-2>source size</dfn> is a <a href=#source-size-value id=images-processing-model:source-size-value>&lt;source-size-value></a>.
      When a <a href=#source-size-2 id=images-processing-model:source-size-2-2>source size</a> has a unit relative to the <a id=images-processing-model:viewport href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a>,
      it must be interpreted relative to the <code id=images-processing-model:the-img-element-10><a href=embedded-content.html#the-img-element>img</a></code> element's <a id=images-processing-model:node-document href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node document</a>'s
      <a id=images-processing-model:viewport-2 href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a>. Other units must be interpreted the same as in Media Queries.
      <a href=references.html#refsMQ>[MQ]</a>
    </p>

    <hr>

    <p>A <dfn id=concept-microsyntax-parse-error>parse error</dfn> for algorithms in this
      section indicates a non-fatal mismatch between input and requirements. User agents are encouraged
      to expose <a href=#concept-microsyntax-parse-error id=images-processing-model:concept-microsyntax-parse-error>parse error</a>s somehow.</p>

    <hr>

    <p>Whether the image is fetched successfully or not (e.g. whether the response status was an
      <a id=images-processing-model:ok-status href=https://fetch.spec.whatwg.org/#ok-status data-x-internal=ok-status>ok status</a>) must be ignored when determining the image's type and whether it is a
      valid image.
    </p>

    <p class=note>This allows servers to return images with error responses, and have them
      displayed.</p>

    <p id=img-determine-type>The user agent should apply the <a href=https://mimesniff.spec.whatwg.org/#rules-for-sniffing-images-specifically id=images-processing-model:content-type-sniffing:-image data-x-internal=content-type-sniffing:-image>image sniffing rules</a> to determine the type of the image, with the image's <a href=urls-and-fetching.html#content-type id=images-processing-model:content-type>associated Content-Type headers</a> giving the <var>official
        type</var>. If these rules are not applied, then the type of the image must be the type given by
      the image's <a href=urls-and-fetching.html#content-type id=images-processing-model:content-type-2>associated Content-Type headers</a>.</p>

    <p>User agents must not support non-image resources with the <code id=images-processing-model:the-img-element-11><a href=embedded-content.html#the-img-element>img</a></code> element (e.g. XML
      files whose <a id=images-processing-model:document-element href=https://dom.spec.whatwg.org/#document-element data-x-internal=document-element>document element</a> is an HTML element). User agents must not run executable
      code (e.g. scripts) embedded in the image resource. User agents must only display the first page
      of a multipage resource (e.g. a PDF file). User agents must not allow the resource to act in an
      interactive fashion, but should honour any animation in the resource.</p>

    <p>This specification does not specify which image types are to be supported.</p>


    <h6 id=when-to-obtain-images><span class=secno>4.8.4.3.1</span> When to obtain images<a href=#when-to-obtain-images class=self-link></a></h6>

    <p>By default, images are obtained immediately. User agents may provide users with the option to
      instead obtain them on-demand. (The on-demand option might be used by bandwidth-constrained users,
      for example.)</p>

    <p>When obtaining images immediately, the user agent must synchronously <a href=#update-the-image-data id=when-to-obtain-images:update-the-image-data>update the image
        data</a> of the <code id=when-to-obtain-images:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> element, with the <i>restart animation</i> flag set if so
      stated, whenever that element is created or has experienced <a href=#relevant-mutations id=when-to-obtain-images:relevant-mutations>relevant mutations</a>.</p>

    <p>When obtaining images on demand, the user agent must <a href=#update-the-image-data id=when-to-obtain-images:update-the-image-data-2>update the image data</a> of an
      <code id=when-to-obtain-images:the-img-element-2><a href=embedded-content.html#the-img-element>img</a></code> element whenever it needs the image data (i.e., on demand), but only if the
      <code id=when-to-obtain-images:the-img-element-3><a href=embedded-content.html#the-img-element>img</a></code> element's <a href=#current-request id=when-to-obtain-images:current-request>current request</a>'s <a href=#img-req-state id=when-to-obtain-images:img-req-state>state</a> is <a href=#img-none id=when-to-obtain-images:img-none>unavailable</a>. When an
      <code id=when-to-obtain-images:the-img-element-4><a href=embedded-content.html#the-img-element>img</a></code> element has experienced <a href=#relevant-mutations id=when-to-obtain-images:relevant-mutations-2>relevant mutations</a>, if the user agent only
      obtains images on demand, the <code id=when-to-obtain-images:the-img-element-5><a href=embedded-content.html#the-img-element>img</a></code> element's <a href=#current-request id=when-to-obtain-images:current-request-2>current request</a>'s <a href=#img-req-state id=when-to-obtain-images:img-req-state-2>state</a> must return to <a href=#img-none id=when-to-obtain-images:img-none-2>unavailable</a>.
    </p>


    <h6 id=reacting-to-dom-mutations><span class=secno>4.8.4.3.2</span> Reacting to DOM mutations<a href=#reacting-to-dom-mutations class=self-link></a></h6>

    <p>The <dfn id=relevant-mutations>relevant mutations</dfn> for an <code id=reacting-to-dom-mutations:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> element are as follows:</p>

    <ul><li>
        <p>The element's <code id=reacting-to-dom-mutations:attr-img-src><a href=embedded-content.html#attr-img-src>src</a></code>, <code id=reacting-to-dom-mutations:attr-img-srcset><a href=embedded-content.html#attr-img-srcset>srcset</a></code>, <code id=reacting-to-dom-mutations:attr-dim-width><a href=embedded-content-other.html#attr-dim-width>width</a></code>, or <code id=reacting-to-dom-mutations:attr-img-sizes><a href=embedded-content.html#attr-img-sizes>sizes</a></code> attributes are set, changed, or removed.</p>
      <li>
        <p>The element's <code id=reacting-to-dom-mutations:attr-img-src-2><a href=embedded-content.html#attr-img-src>src</a></code> attribute is set to the same value as the previous value.
          This must set the <i>restart animation</i> flag for the <a href=#update-the-image-data id=reacting-to-dom-mutations:update-the-image-data>update the image data</a> algorithm.</p>
      <li>
        <p>The element's <code id=reacting-to-dom-mutations:attr-img-crossorigin><a href=embedded-content.html#attr-img-crossorigin>crossorigin</a></code> attribute's state is changed.</p>
      <li>
        <p>The element's <code id=reacting-to-dom-mutations:attr-img-referrerpolicy><a href=embedded-content.html#attr-img-referrerpolicy>referrerpolicy</a></code> attribute's
          state is changed.</p>
      <li>
        <p>The <code id=reacting-to-dom-mutations:the-img-element-2><a href=embedded-content.html#the-img-element>img</a></code> or <code id=reacting-to-dom-mutations:the-source-element><a href=embedded-content.html#the-source-element>source</a></code> <a id=reacting-to-dom-mutations:html-element-insertion-steps href=infrastructure.html#html-element-insertion-steps>HTML element insertion steps</a> or
          <a id=reacting-to-dom-mutations:html-element-removing-steps href=infrastructure.html#html-element-removing-steps>HTML element removing steps</a> count the mutation as a <a href=#relevant-mutations id=reacting-to-dom-mutations:relevant-mutations>relevant mutation</a>.
        </p>
      <li>
        <p>The element's parent is a <code id=reacting-to-dom-mutations:the-picture-element><a href=embedded-content.html#the-picture-element>picture</a></code> element and a <code id=reacting-to-dom-mutations:the-source-element-2><a href=embedded-content.html#the-source-element>source</a></code> element
          that is a previous sibling has its <code id=reacting-to-dom-mutations:attr-source-srcset><a href=embedded-content.html#attr-source-srcset>srcset</a></code>, <code id=reacting-to-dom-mutations:attr-source-sizes><a href=embedded-content.html#attr-source-sizes>sizes</a></code>, <code id=reacting-to-dom-mutations:attr-source-media><a href=embedded-content.html#attr-source-media>media</a></code>, <code id=reacting-to-dom-mutations:attr-source-type><a href=embedded-content.html#attr-source-type>type</a></code>, <code id=reacting-to-dom-mutations:attr-dim-width-2><a href=embedded-content-other.html#attr-dim-width>width</a></code> or <code id=reacting-to-dom-mutations:attr-dim-height><a href=embedded-content-other.html#attr-dim-height>height</a></code> attributes set, changed, or removed.</p>
      <li>
        <p>The element's <a href=https://dom.spec.whatwg.org/#concept-node-adopt-ext id=reacting-to-dom-mutations:concept-node-adopt-ext data-x-internal=concept-node-adopt-ext>adopting steps</a> are run.</p>
      <li>
        <p>If the element <a id=reacting-to-dom-mutations:allows-auto-sizes href=embedded-content.html#allows-auto-sizes>allows auto-sizes</a>: the element starts or stops <a id=reacting-to-dom-mutations:being-rendered href=rendering.html#being-rendered>being
            rendered</a>, or its <a id=reacting-to-dom-mutations:concrete-object-size href=https://drafts.csswg.org/css-images/#concrete-object-size data-x-internal=concrete-object-size>concrete object size</a> width changes. This must set the
          <i>maybe omit events</i> flag for the <a href=#update-the-image-data id=reacting-to-dom-mutations:update-the-image-data-2>update the image data</a> algorithm.
        </p>
      </ul>


    <h6 id=the-list-of-available-images><span class=secno>4.8.4.3.3</span> The list of available images<a href=#the-list-of-available-images class=self-link></a></h6>

    <p>Each <code id=the-list-of-available-images:document><a href=dom.html#document>Document</a></code> object must have a <dfn id=list-of-available-images>list of available images</dfn>. Each image
      in this list is identified by a tuple consisting of an <a id=the-list-of-available-images:absolute-url href=https://url.spec.whatwg.org/#syntax-url-absolute data-x-internal=absolute-url>absolute URL</a>, a <a id=the-list-of-available-images:cors-settings-attribute href=urls-and-fetching.html#cors-settings-attribute>CORS
        settings attribute</a> mode, and, if the mode is not <a href=urls-and-fetching.html#attr-crossorigin-none id=the-list-of-available-images:attr-crossorigin-none>No
        CORS</a>, an <a id=the-list-of-available-images:concept-origin href=browsers.html#concept-origin>origin</a>.
      Each image furthermore has an <dfn id=ignore-higher-layer-caching>ignore higher-layer caching</dfn> flag.
      User agents may copy entries from one <code id=the-list-of-available-images:document-2><a href=dom.html#document>Document</a></code>
      object's <a href=#list-of-available-images id=the-list-of-available-images:list-of-available-images>list of available images</a> to another at any time (e.g. when the
      <code id=the-list-of-available-images:document-3><a href=dom.html#document>Document</a></code> is created, user agents can add to it all the images that are loaded in
      other <code id=the-list-of-available-images:document-4><a href=dom.html#document>Document</a></code>s), but must not change the keys of entries copied in this way when
      doing so, and must unset the <a href=#ignore-higher-layer-caching id=the-list-of-available-images:ignore-higher-layer-caching>ignore higher-layer caching</a> flag for the copied entry.
      User agents may also remove images from such lists at any time (e.g. to save
      memory).
      User agents must remove entries in the <a href=#list-of-available-images id=the-list-of-available-images:list-of-available-images-2>list of available images</a> as appropriate
      given higher-layer caching semantics for the resource (e.g. the HTTP `<code id=the-list-of-available-images:http-cache-control><a data-x-internal=http-cache-control href=https://httpwg.org/specs/rfc7234.html#header.cache-control>Cache-Control</a></code>` response header) when the <a href=#ignore-higher-layer-caching id=the-list-of-available-images:ignore-higher-layer-caching-2>ignore
        higher-layer caching</a> flag is unset.
    </p>

    <p class=note>The <a href=#list-of-available-images id=the-list-of-available-images:list-of-available-images-3>list of available images</a> is intended to enable synchronous
      switching when changing the <code id=the-list-of-available-images:attr-img-src><a href=embedded-content.html#attr-img-src>src</a></code> attribute to a URL that has
      previously been loaded, and to avoid re-downloading images in the same document even when they
      don't allow caching per HTTP. It is not used to avoid re-downloading the same image while the
      previous image is still loading.</p>

    <p class=note>The user agent can also store the image data separately from the <a href=#list-of-available-images id=the-list-of-available-images:list-of-available-images-4>list of available images</a>.</p>

    <p class=example>For example, if a resource has the HTTP response header
      `<code>Cache-Control: must-revalidate</code>`, and its <a href=#ignore-higher-layer-caching id=the-list-of-available-images:ignore-higher-layer-caching-3>ignore higher-layer
        caching</a> flag is unset, the user agent would remove it from the <a href=#list-of-available-images id=the-list-of-available-images:list-of-available-images-5>list of available
        images</a> but could keep the image data separately, and use that if the server responds with a
      <code>304 Not Modified</code> status.
    </p>

    <h6 id=decoding-images><span class=secno>4.8.4.3.4</span> Decoding images<a href=#decoding-images class=self-link></a></h6>

    <p>Image data is usually encoded in order to reduce file size. This means that in order for the
      user agent to present the image to the screen, the data needs to be decoded.
      <dfn id=img-decoding-process>Decoding</dfn> is the process which converts an image's media
      data into a bitmap form, suitable for presentation to the screen. Note that this process can be
      slow relative to other processes involved in presenting content. Thus, the user agent can choose
      when to perform decoding, in order to create the best user experience.
    </p>

    <p>Image decoding is said to be synchronous if it prevents presentation of other content until it
      is finished. Typically, this has an effect of atomically presenting the image and any other
      content at the same time. However, this presentation is delayed by the amount of time it takes to
      perform the decode.</p>

    <p>Image decoding is said to be asynchronous if it does not prevent presentation of other content.
      This has an effect of presenting non-image content faster. However, the image content is missing
      on screen until the decode finishes. Once the decode is finished, the screen is updated with the
      image.</p>

    <p>In both synchronous and asynchronous decoding modes, the final content is presented to screen
      after the same amount of time has elapsed. The main difference is whether the user agent presents
      non-image content ahead of presenting the final content.</p>

    <p>In order to aid the user agent in deciding whether to perform synchronous or asynchronous
      decode, the <code id=decoding-images:attr-img-decoding><a href=embedded-content.html#attr-img-decoding>decoding</a></code> attribute can be set on
      <code id=decoding-images:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> elements. The possible values of the <code id=decoding-images:attr-img-decoding-2><a href=embedded-content.html#attr-img-decoding>decoding</a></code> attribute are the following <dfn id=image-decoding-hint>image decoding
        hint</dfn> keywords:
    </p>

    <table><thead><tr><th>Keyword
          <th>State
          <th>Description
      <tbody><tr><td><dfn data-dfn-for=img/decoding id=attr-img-decoding-sync data-dfn-type=attr-value><code>sync</code></dfn>
          <td><dfn id=attr-img-decoding-sync-state>Sync</dfn>
          <td>Indicates a preference to <a href=#img-decoding-process id=decoding-images:img-decoding-process>decode</a> this image
            synchronously for atomic presentation with other content.
        <tr><td><dfn data-dfn-for=img/decoding id=attr-img-decoding-async data-dfn-type=attr-value><code>async</code></dfn>
          <td><dfn id=attr-img-decoding-async-state>Async</dfn>
          <td>Indicates a preference to <a href=#img-decoding-process id=decoding-images:img-decoding-process-2>decode</a> this image
            asynchronously to avoid delaying presentation of other content.
        <tr><td><dfn data-dfn-for=img/decoding id=attr-img-decoding-auto data-dfn-type=attr-value><code>auto</code></dfn>
          <td><dfn id=attr-img-decoding-auto-state>Auto</dfn>
          <td>Indicates no preference in decoding mode (the default).
    </table>

    <p>When <a href=#img-decoding-process id=decoding-images:img-decoding-process-3>decoding</a> an image, the user agent should
      respect the preference indicated by the <code id=decoding-images:attr-img-decoding-3><a href=embedded-content.html#attr-img-decoding>decoding</a></code>
      attribute's state. If the state indicated is <a href=#attr-img-decoding-auto-state id=decoding-images:attr-img-decoding-auto-state>auto</a>, then the user agent is free to choose any
      decoding behavior.</p>

    <p class=note>It is also possible to control the decoding behavior using the <code id=decoding-images:dom-img-decode><a href=embedded-content.html#dom-img-decode>decode()</a></code> method. Since the <code id=decoding-images:dom-img-decode-2><a href=embedded-content.html#dom-img-decode>decode()</a></code> method performs <a href=#img-decoding-process id=decoding-images:img-decoding-process-4>decoding</a> independently from the process responsible for
      presenting content to screen, it is unaffected by the <code id=decoding-images:attr-img-decoding-4><a href=embedded-content.html#attr-img-decoding>decoding</a></code> attribute.</p>

    <h6 id=updating-the-image-data><span class=secno>4.8.4.3.5</span> Updating the image data<a href=#updating-the-image-data class=self-link></a></h6>

    <p class=note>This algorithm cannot be called from steps running <a id=updating-the-image-data:in-parallel href=infrastructure.html#in-parallel>in parallel</a>. If
      a user agent needs to call this algorithm from steps running <a id=updating-the-image-data:in-parallel-2 href=infrastructure.html#in-parallel>in parallel</a>, it needs to
      <a href=webappapis.html#queue-a-task id=updating-the-image-data:queue-a-task>queue</a> a task to do so.
    </p>

    <p>When the user agent is to <dfn id=update-the-image-data>update the image data</dfn> of an <code id=updating-the-image-data:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> element,
      optionally with the <i>restart animations</i> flag set, optionally with the <i>maybe omit
        events</i> flag set, it must run the following steps:</p>

    <ol><li>
        <p>If the element's <a id=updating-the-image-data:node-document href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node document</a> is not <a id=updating-the-image-data:fully-active href=document-sequences.html#fully-active>fully active</a>, then:</p>

        <ol><li>
            <p>Continue running this algorithm <a id=updating-the-image-data:in-parallel-3 href=infrastructure.html#in-parallel>in parallel</a>.</p>
          <li>
            <p>Wait until the element's <a id=updating-the-image-data:node-document-2 href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node document</a> is <a id=updating-the-image-data:fully-active-2 href=document-sequences.html#fully-active>fully
                active</a>.</p>
          <li>
            <p>If another instance of this algorithm for this <code id=updating-the-image-data:the-img-element-2><a href=embedded-content.html#the-img-element>img</a></code> element was started after this instance
              (even if it aborted and is no longer running), then return.</p>
          <li>
            <p><a id=updating-the-image-data:queue-a-microtask href=webappapis.html#queue-a-microtask>Queue a microtask</a> to continue this algorithm.</p>
          </ol>
      <li>
        <p>If the user agent cannot support images, or its support for images has been disabled, then
          <a href=#abort-the-image-request id=updating-the-image-data:abort-the-image-request>abort the image request</a> for the <a href=#current-request id=updating-the-image-data:current-request>current request</a> and the <a href=#pending-request id=updating-the-image-data:pending-request>pending
            request</a>, set <a href=#current-request id=updating-the-image-data:current-request-2>current request</a>'s <a href=#img-req-state id=updating-the-image-data:img-req-state>state</a> to
          <a href=#img-none id=updating-the-image-data:img-none>unavailable</a>, set <a href=#pending-request id=updating-the-image-data:pending-request-2>pending request</a> to null, and
          return.
        </p>
      <li>
        <p>Let <var>previous URL</var> be the <a href=#current-request id=updating-the-image-data:current-request-3>current request</a>'s <a href=#img-req-url id=updating-the-image-data:img-req-url>current URL</a>.</p>
      <li>
        <p>Let <var>selected source</var> be null and <var>selected pixel density</var> be undefined.

      <li>
        <p>If the element does not <a href=#use-srcset-or-picture id=updating-the-image-data:use-srcset-or-picture>use <code>srcset</code> or <code>picture</code></a> and
          it has a <code id=updating-the-image-data:attr-img-src><a href=embedded-content.html#attr-img-src>src</a></code> attribute specified whose value is not the empty
          string, then set <var>selected source</var> to the value of the element's <code id=updating-the-image-data:attr-img-src-2><a href=embedded-content.html#attr-img-src>src</a></code> attribute and set <var>selected pixel density</var> to
          1.0.</p>
      <li>
        <p>Set the element's <a href=#last-selected-source id=updating-the-image-data:last-selected-source>last selected source</a> to <var>selected
            source</var>.</p>
      <li>
        <p>If <var>selected source</var> is not null, then:</p>

        <ol><li>
            <p>Let <var>urlString</var> be the result of <a id=updating-the-image-data:encoding-parsing-and-serializing-a-url href=urls-and-fetching.html#encoding-parsing-and-serializing-a-url>encoding-parsing-and-serializing a
                URL</a> given <var>selected source</var>, relative to the element's <a id=updating-the-image-data:node-document-3 href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node
                document</a>.</p>
          <li>
            <p>If <var>urlString</var> is failure, then abort this inner set of steps.</p>
          <li>
            <p>Let <var>key</var> be a tuple consisting of <var>urlString</var>, the <code id=updating-the-image-data:the-img-element-3><a href=embedded-content.html#the-img-element>img</a></code>
              element's <code id=updating-the-image-data:attr-img-crossorigin><a href=embedded-content.html#attr-img-crossorigin>crossorigin</a></code> attribute's mode, and, if that
              mode is not <a href=urls-and-fetching.html#attr-crossorigin-none id=updating-the-image-data:attr-crossorigin-none>No CORS</a>, the <a id=updating-the-image-data:node-document-4 href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node
                document</a>'s <a href=https://dom.spec.whatwg.org/#concept-document-origin id=updating-the-image-data:concept-document-origin data-x-internal=concept-document-origin>origin</a>.</p>
          <li>
            <p>If the <a href=#list-of-available-images id=updating-the-image-data:list-of-available-images>list of available images</a> contains an entry for <var>key</var>,
              then:</p>

            <ol><li>
                <p>Set the <a href=#ignore-higher-layer-caching id=updating-the-image-data:ignore-higher-layer-caching>ignore higher-layer caching</a> flag for that entry.</p>
              <li>
                <p><a href=#abort-the-image-request id=updating-the-image-data:abort-the-image-request-2>Abort the image request</a> for the <a href=#current-request id=updating-the-image-data:current-request-4>current request</a> and the
                  <a href=#pending-request id=updating-the-image-data:pending-request-3>pending request</a>.
                </p>
              <li>
                <p>Set <a href=#pending-request id=updating-the-image-data:pending-request-4>pending request</a> to null.</p>
              <li>
                <p>Let <a href=#current-request id=updating-the-image-data:current-request-5>current request</a> be a new <a href=#image-request id=updating-the-image-data:image-request>image request</a> whose <a href=#img-req-data id=updating-the-image-data:img-req-data>image data</a> is that of the entry and whose <a href=#img-req-state id=updating-the-image-data:img-req-state-2>state</a> is <a href=#img-all id=updating-the-image-data:img-all>completely
                    available</a>.</p>
              <li>
                <p><a href=#prepare-an-image-for-presentation id=updating-the-image-data:prepare-an-image-for-presentation>Prepare <var>current request</var>
                    for presentation</a> given <var>img</var>.</p>
              <li>
                <p>Set <a href=#current-request id=updating-the-image-data:current-request-6>current request</a>'s <a href=#current-pixel-density id=updating-the-image-data:current-pixel-density>current pixel density</a> to <var>selected
                    pixel density</var>.</p>
              <li>
                <p><a id=updating-the-image-data:queue-an-element-task href=webappapis.html#queue-an-element-task>Queue an element task</a> on the <a id=updating-the-image-data:dom-manipulation-task-source href=webappapis.html#dom-manipulation-task-source>DOM manipulation task source</a>
                  given the <code id=updating-the-image-data:the-img-element-4><a href=embedded-content.html#the-img-element>img</a></code> element and the following steps:</p>

                <ol><li>
                    <p>If <i>restart animation</i> is set, then <a id=updating-the-image-data:restart-the-animation href=rendering.html#restart-the-animation>restart the
                        animation</a>.</p>
                  <li>
                    <p>Set <a href=#current-request id=updating-the-image-data:current-request-7>current request</a>'s <a href=#img-req-url id=updating-the-image-data:img-req-url-2>current URL</a> to
                      <var>urlString</var>.
                    </p>
                  <li>
                    <p>If <i>maybe omit events</i> is not set or <var>previousURL</var> is not equal to
                      <var>urlString</var>, then <a href=https://dom.spec.whatwg.org/#concept-event-fire id=updating-the-image-data:concept-event-fire data-x-internal=concept-event-fire>fire an event</a> named
                      <code id=updating-the-image-data:event-load><a href=indices.html#event-load>load</a></code> at the <code id=updating-the-image-data:the-img-element-5><a href=embedded-content.html#the-img-element>img</a></code> element.
                    </p>
                  </ol>
              <li>
                <p>Abort the <a href=#update-the-image-data id=updating-the-image-data:update-the-image-data>update the image data</a> algorithm.</p>
              </ol>
          </ol>
      <li>
        <p><a id=updating-the-image-data:queue-a-microtask-2 href=webappapis.html#queue-a-microtask>Queue a microtask</a> to perform the rest of this algorithm, allowing the <a href=webappapis.html#concept-task id=updating-the-image-data:concept-task>task</a> that invoked this algorithm to continue.</p>
      <li>
        <p>If another instance of this algorithm for this <code id=updating-the-image-data:the-img-element-6><a href=embedded-content.html#the-img-element>img</a></code> element was started after
          this instance (even if it aborted and is no longer running), then return.</p>

        <p class=note>Only the last instance takes effect, to avoid multiple requests when, for
          example, the <code id=updating-the-image-data:attr-img-src-3><a href=embedded-content.html#attr-img-src>src</a></code>, <code id=updating-the-image-data:attr-img-srcset><a href=embedded-content.html#attr-img-srcset>srcset</a></code>,
          and <code id=updating-the-image-data:attr-img-crossorigin-2><a href=embedded-content.html#attr-img-crossorigin>crossorigin</a></code> attributes are all set in
          succession.</p>
      <li>
        <p>Let <var>selected source</var> and <var>selected pixel density</var> be the URL and pixel
          density that results from <a href=#select-an-image-source id=updating-the-image-data:select-an-image-source>selecting an image source</a>,
          respectively.</p>
      <li>
        <p>If <var>selected source</var> is null, then:</p>

        <ol><li>
            <p>Set the <a href=#current-request id=updating-the-image-data:current-request-8>current request</a>'s <a href=#img-req-state id=updating-the-image-data:img-req-state-3>state</a> to
              <a href=#img-error id=updating-the-image-data:img-error>broken</a>, <a href=#abort-the-image-request id=updating-the-image-data:abort-the-image-request-3>abort the image request</a> for the
              <a href=#current-request id=updating-the-image-data:current-request-9>current request</a> and the <a href=#pending-request id=updating-the-image-data:pending-request-5>pending request</a>, and set <a href=#pending-request id=updating-the-image-data:pending-request-6>pending
                request</a> to null.
            </p>
          <li>
            <p><a id=updating-the-image-data:queue-an-element-task-2 href=webappapis.html#queue-an-element-task>Queue an element task</a> on the <a id=updating-the-image-data:dom-manipulation-task-source-2 href=webappapis.html#dom-manipulation-task-source>DOM manipulation task source</a> given
              the <code id=updating-the-image-data:the-img-element-7><a href=embedded-content.html#the-img-element>img</a></code> element and the following steps:</p>

            <ol><li>
                <p>Change the <a href=#current-request id=updating-the-image-data:current-request-10>current request</a>'s <a href=#img-req-url id=updating-the-image-data:img-req-url-3>current
                    URL</a> to the empty string.</p>
              <li>
                <p>If all of the following are true:</p>

                <ul><li>
                    <p>the element has a <code id=updating-the-image-data:attr-img-src-4><a href=embedded-content.html#attr-img-src>src</a></code> attribute or it <a href=#use-srcset-or-picture id=updating-the-image-data:use-srcset-or-picture-2>uses <code>srcset</code> or
                        <code>picture</code></a>; and</p>
                  <li>
                    <p><i>maybe omit events</i> is not set or <var>previousURL</var> is not the empty
                      string,</p>
                  </ul>

                <p>then <a href=https://dom.spec.whatwg.org/#concept-event-fire id=updating-the-image-data:concept-event-fire-2 data-x-internal=concept-event-fire>fire an event</a> named <code id=updating-the-image-data:event-error><a href=indices.html#event-error>error</a></code> at the <code id=updating-the-image-data:the-img-element-8><a href=embedded-content.html#the-img-element>img</a></code> element.</p>
              </ol>
          <li>
            <p>Return.</p>
          </ol>
      <li>
        <p>Let <var>urlString</var> be the result of <a id=updating-the-image-data:encoding-parsing-and-serializing-a-url-2 href=urls-and-fetching.html#encoding-parsing-and-serializing-a-url>encoding-parsing-and-serializing a
            URL</a> given <var>selected source</var>, relative to the element's <a id=updating-the-image-data:node-document-5 href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node
            document</a>.</p>
      <li>
        <p>If <var>urlString</var> is failure, then:</p>

        <ol><li>
            <p><a href=#abort-the-image-request id=updating-the-image-data:abort-the-image-request-4>Abort the image request</a> for the <a href=#current-request id=updating-the-image-data:current-request-11>current request</a> and the
              <a href=#pending-request id=updating-the-image-data:pending-request-7>pending request</a>.
            </p>
          <li>
            <p>Set the <a href=#current-request id=updating-the-image-data:current-request-12>current request</a>'s <a href=#img-req-state id=updating-the-image-data:img-req-state-4>state</a> to
              <a href=#img-error id=updating-the-image-data:img-error-2>broken</a>.
            </p>
          <li>
            <p>Set <a href=#pending-request id=updating-the-image-data:pending-request-8>pending request</a> to null.</p>
          <li>
            <p><a id=updating-the-image-data:queue-an-element-task-3 href=webappapis.html#queue-an-element-task>Queue an element task</a> on the <a id=updating-the-image-data:dom-manipulation-task-source-3 href=webappapis.html#dom-manipulation-task-source>DOM manipulation task
                source</a> given the <code id=updating-the-image-data:the-img-element-9><a href=embedded-content.html#the-img-element>img</a></code> element and the following steps:</p>

            <ol><li>
                <p>Change the <a href=#current-request id=updating-the-image-data:current-request-13>current request</a>'s <a href=#img-req-url id=updating-the-image-data:img-req-url-4>current
                    URL</a> to <var>selected source</var>.</p>
              <li>
                <p>If <i>maybe omit events</i> is not set or <var>previousURL</var> is not equal to
                  <var>selected source</var>, then <a href=https://dom.spec.whatwg.org/#concept-event-fire id=updating-the-image-data:concept-event-fire-3 data-x-internal=concept-event-fire>fire an event</a>
                  named <code id=updating-the-image-data:event-error-2><a href=indices.html#event-error>error</a></code> at the <code id=updating-the-image-data:the-img-element-10><a href=embedded-content.html#the-img-element>img</a></code> element.
                </p>
              </ol>
          <li>
            <p>Return.</p>
          </ol>
      <li>
        <p>If the <a href=#pending-request id=updating-the-image-data:pending-request-9>pending request</a> is not null and <var>urlString</var> is the same as
          the <a href=#pending-request id=updating-the-image-data:pending-request-10>pending request</a>'s <a href=#img-req-url id=updating-the-image-data:img-req-url-5>current URL</a>, then
          return.</p>
      <li>
        <p>If <var>urlString</var> is the same as the <a href=#current-request id=updating-the-image-data:current-request-14>current request</a>'s <a href=#img-req-url id=updating-the-image-data:img-req-url-6>current URL</a> and <a href=#current-request id=updating-the-image-data:current-request-15>current request</a>'s <a href=#img-req-state id=updating-the-image-data:img-req-state-5>state</a> is <a href=#img-inc id=updating-the-image-data:img-inc>partially available</a>, then
          <a href=#abort-the-image-request id=updating-the-image-data:abort-the-image-request-5>abort the image request</a> for the <a href=#pending-request id=updating-the-image-data:pending-request-11>pending request</a>, <a id=updating-the-image-data:queue-an-element-task-4 href=webappapis.html#queue-an-element-task>queue an element
            task</a> on the <a id=updating-the-image-data:dom-manipulation-task-source-4 href=webappapis.html#dom-manipulation-task-source>DOM manipulation task source</a> given the <code id=updating-the-image-data:the-img-element-11><a href=embedded-content.html#the-img-element>img</a></code> element
          to <a id=updating-the-image-data:restart-the-animation-2 href=rendering.html#restart-the-animation>restart the animation</a> if <i>restart animation</i> is set, and return.
        </p>
      <li>
        <p><a href=#abort-the-image-request id=updating-the-image-data:abort-the-image-request-6>Abort the image request</a> for the <a href=#pending-request id=updating-the-image-data:pending-request-12>pending request</a>.</p>
      <li>
        <p>Set <var>image request</var> to a new <a href=#image-request id=updating-the-image-data:image-request-2>image request</a> whose <a href=#img-req-url id=updating-the-image-data:img-req-url-7>current URL</a> is <var>urlString</var>.</p>
      <li>
        <p>If <a href=#current-request id=updating-the-image-data:current-request-16>current request</a>'s <a href=#img-req-state id=updating-the-image-data:img-req-state-6>state</a> is <a href=#img-none id=updating-the-image-data:img-none-2>unavailable</a> or <a href=#img-error id=updating-the-image-data:img-error-3>broken</a>, then set the
          <a href=#current-request id=updating-the-image-data:current-request-17>current request</a> to <var>image request</var>. Otherwise, set the <a href=#pending-request id=updating-the-image-data:pending-request-13>pending
            request</a> to <var>image request</var>.
        </p>
      <li>
        <p>Let <var>request</var> be the result of <a href=urls-and-fetching.html#create-a-potential-cors-request id=updating-the-image-data:create-a-potential-cors-request>creating a potential-CORS request</a> given <var>urlString</var>, "<code>image</code>", and the current state of the element's <code id=updating-the-image-data:attr-img-crossorigin-3><a href=embedded-content.html#attr-img-crossorigin>crossorigin</a></code> content attribute.</p>
      <li>
        <p>Set <var>request</var>'s <a href=https://fetch.spec.whatwg.org/#concept-request-client id=updating-the-image-data:concept-request-client data-x-internal=concept-request-client>client</a> to the
          element's <a id=updating-the-image-data:node-document-6 href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node document</a>'s <a id=updating-the-image-data:relevant-settings-object href=webappapis.html#relevant-settings-object>relevant settings object</a>.</p>
      <li>
        <p>If the element <a href=#use-srcset-or-picture id=updating-the-image-data:use-srcset-or-picture-3>uses <code>srcset</code> or
            <code>picture</code></a>, set <var>request</var>'s <a href=https://fetch.spec.whatwg.org/#concept-request-initiator id=updating-the-image-data:concept-request-initiator data-x-internal=concept-request-initiator>initiator</a> to "<code>imageset</code>".</p>
      <li>
        <p>Set <var>request</var>'s <a href=https://fetch.spec.whatwg.org/#concept-request-referrer-policy id=updating-the-image-data:concept-request-referrer-policy data-x-internal=concept-request-referrer-policy>referrer
            policy</a> to the current state of the element's <code id=updating-the-image-data:attr-img-referrerpolicy><a href=embedded-content.html#attr-img-referrerpolicy>referrerpolicy</a></code> attribute.</p>
      <li>
        <p>Set <var>request</var>'s <a href=https://fetch.spec.whatwg.org/#request-priority id=updating-the-image-data:concept-request-priority data-x-internal=concept-request-priority>priority</a> to the current state of the
          element's <code id=updating-the-image-data:attr-img-fetchpriority><a href=embedded-content.html#attr-img-fetchpriority>fetchpriority</a></code> attribute.</p>
      <li>
        <p>Let <var>delay load event</var> be true if the <code id=updating-the-image-data:the-img-element-12><a href=embedded-content.html#the-img-element>img</a></code>'s <a id=updating-the-image-data:lazy-loading-attribute href=urls-and-fetching.html#lazy-loading-attribute>lazy loading
            attribute</a> is in the <a href=urls-and-fetching.html#attr-loading-eager-state id=updating-the-image-data:attr-loading-eager-state>Eager</a> state, or if
          <a href=webappapis.html#concept-n-noscript id=updating-the-image-data:concept-n-noscript>scripting is disabled</a> for the <code id=updating-the-image-data:the-img-element-13><a href=embedded-content.html#the-img-element>img</a></code>, and
          false otherwise.
        </p>
      <li>
        <p>If the <a id=updating-the-image-data:will-lazy-load-element-steps href=urls-and-fetching.html#will-lazy-load-element-steps>will lazy load element steps</a> given the <code id=updating-the-image-data:the-img-element-14><a href=embedded-content.html#the-img-element>img</a></code> return true,
          then:</p>

        <ol><li>
            <p>Set the <code id=updating-the-image-data:the-img-element-15><a href=embedded-content.html#the-img-element>img</a></code>'s <a id=updating-the-image-data:lazy-load-resumption-steps href=urls-and-fetching.html#lazy-load-resumption-steps>lazy load resumption steps</a> to the rest of this
              algorithm starting with the step labeled <i>fetch the image</i>.</p>
          <li>
            <p><a id=updating-the-image-data:start-intersection-observing-a-lazy-loading-element href=urls-and-fetching.html#start-intersection-observing-a-lazy-loading-element>Start intersection-observing a lazy loading element</a> for the
              <code id=updating-the-image-data:the-img-element-16><a href=embedded-content.html#the-img-element>img</a></code> element.
            </p>
          <li>
            <p>Return.</p>
          </ol>
      <li>
        
        <p><i>Fetch the image</i>: <a href=https://fetch.spec.whatwg.org/#concept-fetch id=updating-the-image-data:concept-fetch data-x-internal=concept-fetch>Fetch</a> <var>request</var>. Return
          from this algorithm, and run the remaining steps as part of the fetch's <i id=updating-the-image-data:processresponse><a data-x-internal=processresponse href=https://fetch.spec.whatwg.org/#process-response>processResponse</a></i> for the <a href=https://fetch.spec.whatwg.org/#concept-response id=updating-the-image-data:concept-response data-x-internal=concept-response>response</a> <var>response</var>.</p>

        

        <p>The resource obtained in this fashion, if any, is <var>image request</var>'s <a href=#img-req-data id=updating-the-image-data:img-req-data-2>image data</a>. It can be either <a id=updating-the-image-data:cors-same-origin href=urls-and-fetching.html#cors-same-origin>CORS-same-origin</a> or
          <a id=updating-the-image-data:cors-cross-origin href=urls-and-fetching.html#cors-cross-origin>CORS-cross-origin</a>; this affects the image's interaction with other APIs (e.g.,
          when used on a <code id=updating-the-image-data:the-canvas-element><a href=canvas.html#the-canvas-element>canvas</a></code>).
        </p>

        
        <p>When <var>delay load event</var> is true, fetching the image must <a id=updating-the-image-data:delay-the-load-event href=parsing.html#delay-the-load-event>delay the load
            event</a> of the element's <a id=updating-the-image-data:node-document-7 href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node document</a> until the <a href=webappapis.html#concept-task id=updating-the-image-data:concept-task-2>task</a> that is <a href=webappapis.html#queue-a-task id=updating-the-image-data:queue-a-task-2>queued</a> by the
          <a id=updating-the-image-data:networking-task-source href=webappapis.html#networking-task-source>networking task source</a> once the resource has been fetched (<a href=#img-load>defined below</a>) has been run.
          
        </p>

        <p class=warning>This, unfortunately, can be used to perform a rudimentary port scan of the
          user's local network (especially in conjunction with scripting, though scripting isn't actually
          necessary to carry out such an attack). User agents may implement <a href=browsers.html#concept-origin id=updating-the-image-data:concept-origin>cross-origin</a> access control policies that are stricter than those
          described above to mitigate this attack, but unfortunately such policies are typically not
          compatible with existing web content.</p>
      <li>
        <p>As soon as possible, jump to the first applicable entry from the following list:</p>

        <dl class=switch><dt>If the resource type is <code id=updating-the-image-data:multipart/x-mixed-replace><a href=iana.html#multipart/x-mixed-replace>multipart/x-mixed-replace</a></code><dd>
            <p>The next <a href=webappapis.html#concept-task id=updating-the-image-data:concept-task-3>task</a> that is <a href=webappapis.html#queue-a-task id=updating-the-image-data:queue-a-task-3>queued</a> by the <a id=updating-the-image-data:networking-task-source-2 href=webappapis.html#networking-task-source>networking task source</a> while the image is being
              fetched must run the following steps:</p>

            <ol><li>
                <p>If <var>image request</var> is the <a href=#pending-request id=updating-the-image-data:pending-request-14>pending request</a>
                  and at least one body part has been completely decoded,
                  <a href=#abort-the-image-request id=updating-the-image-data:abort-the-image-request-7>abort the image request</a> for the <a href=#current-request id=updating-the-image-data:current-request-18>current request</a>,
                  and <a href=#upgrade-the-pending-request-to-the-current-request id=updating-the-image-data:upgrade-the-pending-request-to-the-current-request>upgrade the pending request to the current request</a>.
                </p>
              <li>
                <p>Otherwise, if <var>image request</var> is the <a href=#pending-request id=updating-the-image-data:pending-request-15>pending request</a> and the
                  user agent is able to determine that <var>image request</var>'s image is corrupted in some
                  fatal way such that the image dimensions cannot be obtained, <a href=#abort-the-image-request id=updating-the-image-data:abort-the-image-request-8>abort the image
                    request</a> for the <a href=#current-request id=updating-the-image-data:current-request-19>current request</a>, <a href=#upgrade-the-pending-request-to-the-current-request id=updating-the-image-data:upgrade-the-pending-request-to-the-current-request-2>upgrade the pending request to the
                    current request</a>, and set the <a href=#current-request id=updating-the-image-data:current-request-20>current request</a>'s <a href=#img-req-state id=updating-the-image-data:img-req-state-7>state</a> to <a href=#img-error id=updating-the-image-data:img-error-4>broken</a>.</p>
              <li>
                <p>Otherwise, if <var>image request</var> is the <a href=#current-request id=updating-the-image-data:current-request-21>current request</a>, its <a href=#img-req-state id=updating-the-image-data:img-req-state-8>state</a> is <a href=#img-none id=updating-the-image-data:img-none-3>unavailable</a>, and the
                  user agent is able to determine <var>image request</var>'s image's width and height, set the
                  <a href=#current-request id=updating-the-image-data:current-request-22>current request</a>'s <a href=#img-req-state id=updating-the-image-data:img-req-state-9>state</a> to <a href=#img-inc id=updating-the-image-data:img-inc-2>partially available</a>.
                </p>
              <li>
                <p>Otherwise, if <var>image request</var> is the <a href=#current-request id=updating-the-image-data:current-request-23>current request</a>, its <a href=#img-req-state id=updating-the-image-data:img-req-state-10>state</a> is <a href=#img-none id=updating-the-image-data:img-none-4>unavailable</a>, and the
                  user agent is able to determine that <var>image request</var>'s image is corrupted in some
                  fatal way such that the image dimensions cannot be obtained, set the <a href=#current-request id=updating-the-image-data:current-request-24>current
                    request</a>'s <a href=#img-req-state id=updating-the-image-data:img-req-state-11>state</a> to <a href=#img-error id=updating-the-image-data:img-error-5>broken</a>.
                  
                </p>
              </ol>

            <p>Each <a href=webappapis.html#concept-task id=updating-the-image-data:concept-task-4>task</a> that is <a href=webappapis.html#queue-a-task id=updating-the-image-data:queue-a-task-4>queued</a> by the <a id=updating-the-image-data:networking-task-source-3 href=webappapis.html#networking-task-source>networking task source</a> while the image is being
              fetched must update the presentation of the image, but as each new body part comes in, if the
              user agent is able to determine the image's width and height, it must <a href=#prepare-an-image-for-presentation id=updating-the-image-data:prepare-an-image-for-presentation-2>prepare the <code>img</code> element's <span>current request</span>
                for presentation</a> given the <code id=updating-the-image-data:the-img-element-17><a href=embedded-content.html#the-img-element>img</a></code> element and replace the previous image.
              Once one body part has been completely decoded, perform the following steps:</p>

            <ol><li>
                <p>Set the <code id=updating-the-image-data:the-img-element-18><a href=embedded-content.html#the-img-element>img</a></code> element's <a href=#current-request id=updating-the-image-data:current-request-25>current request</a>'s <a href=#img-req-state id=updating-the-image-data:img-req-state-12>state</a> to <a href=#img-all id=updating-the-image-data:img-all-2>completely
                    available</a>.</p>
              <li>
                <p>If <i>maybe omit events</i> is not set or <var>previousURL</var> is not equal to
                  <var>urlString</var>, then <a id=updating-the-image-data:queue-an-element-task-5 href=webappapis.html#queue-an-element-task>queue an element task</a> on the <a id=updating-the-image-data:dom-manipulation-task-source-5 href=webappapis.html#dom-manipulation-task-source>DOM manipulation task source</a>
                  given the <code id=updating-the-image-data:the-img-element-19><a href=embedded-content.html#the-img-element>img</a></code> element to <a href=https://dom.spec.whatwg.org/#concept-event-fire id=updating-the-image-data:concept-event-fire-4 data-x-internal=concept-event-fire>fire an event</a>
                  named <code id=updating-the-image-data:event-load-2><a href=indices.html#event-load>load</a></code> at the <code id=updating-the-image-data:the-img-element-20><a href=embedded-content.html#the-img-element>img</a></code> element.
                </p>
              </ol>
            
          <dt>If the resource type and data corresponds to a supported image format, <a href=#img-determine-type>as described below</a><dd>
            <p>The next <a href=webappapis.html#concept-task id=updating-the-image-data:concept-task-5>task</a> that is <a href=webappapis.html#queue-a-task id=updating-the-image-data:queue-a-task-5>queued</a> by the <a id=updating-the-image-data:networking-task-source-4 href=webappapis.html#networking-task-source>networking task source</a> while the image is being
              fetched must run the following steps:</p>

            <ol><li>
                <p>If the user agent is able to determine <var>image request</var>'s image's width and
                  height, and <var>image request</var> is <a href=#pending-request id=updating-the-image-data:pending-request-16>pending request</a>, set <var>image
                    request</var>'s <a href=#img-req-state id=updating-the-image-data:img-req-state-13>state</a> to <a href=#img-inc id=updating-the-image-data:img-inc-3>partially
                    available</a>.</p>
              <li>
                <p>Otherwise, if the user agent is able to determine <var>image request</var>'s image's
                  width and height, and <var>image request</var> is <a href=#current-request id=updating-the-image-data:current-request-26>current request</a>, <a href=#prepare-an-image-for-presentation id=updating-the-image-data:prepare-an-image-for-presentation-3>prepare <var>image request</var> for
                    presentation</a> given the <code id=updating-the-image-data:the-img-element-21><a href=embedded-content.html#the-img-element>img</a></code> element and set <var>image request</var>'s
                  <a href=#img-req-state id=updating-the-image-data:img-req-state-14>state</a> to <a href=#img-inc id=updating-the-image-data:img-inc-4>partially
                    available</a>.
                </p>
              <li>
                <p>Otherwise, if the user agent is able to determine that <var>image request</var>'s image
                  is corrupted in some fatal way such that the image dimensions cannot be obtained, and
                  <var>image request</var> is <a href=#pending-request id=updating-the-image-data:pending-request-17>pending request</a>:
                </p>

                <ol><li>
                    <p><a href=#abort-the-image-request id=updating-the-image-data:abort-the-image-request-9>Abort the image request</a> for the <a href=#current-request id=updating-the-image-data:current-request-27>current request</a> and the
                      <a href=#pending-request id=updating-the-image-data:pending-request-18>pending request</a>.
                    </p>
                  <li>
                    <p><a href=#upgrade-the-pending-request-to-the-current-request id=updating-the-image-data:upgrade-the-pending-request-to-the-current-request-3>Upgrade the pending request to the current request</a>.</p>
                  <li>
                    <p>Set <a href=#current-request id=updating-the-image-data:current-request-28>current request</a>'s <a href=#img-req-state id=updating-the-image-data:img-req-state-15>state</a> to
                      <a href=#img-error id=updating-the-image-data:img-error-6>broken</a>.
                    </p>
                  <li>
                    <p><a href=https://dom.spec.whatwg.org/#concept-event-fire id=updating-the-image-data:concept-event-fire-5 data-x-internal=concept-event-fire>Fire an event</a> named <code id=updating-the-image-data:event-error-3><a href=indices.html#event-error>error</a></code> at the <code id=updating-the-image-data:the-img-element-22><a href=embedded-content.html#the-img-element>img</a></code> element.</p>
                  </ol>
              <li>
                <p>Otherwise, if the user agent is able to determine that <var>image request</var>'s image
                  is corrupted in some fatal way such that the image dimensions cannot be obtained, and
                  <var>image request</var> is <a href=#current-request id=updating-the-image-data:current-request-29>current request</a>:
                </p>

                <ol><li>
                    <p><a href=#abort-the-image-request id=updating-the-image-data:abort-the-image-request-10>Abort the image request</a> for <var>image request</var>.</p>
                  <li>
                    <p>If <i>maybe omit events</i> is not set or <var>previousURL</var> is not equal to
                      <var>urlString</var>, then <a href=https://dom.spec.whatwg.org/#concept-event-fire id=updating-the-image-data:concept-event-fire-6 data-x-internal=concept-event-fire>fire an event</a> named
                      <code id=updating-the-image-data:event-error-4><a href=indices.html#event-error>error</a></code> at the <code id=updating-the-image-data:the-img-element-23><a href=embedded-content.html#the-img-element>img</a></code> element.
                    </p>
                  </ol>
              </ol>

            <p id=img-load>That <a href=webappapis.html#concept-task id=updating-the-image-data:concept-task-6>task</a>, and each subsequent <a href=webappapis.html#concept-task id=updating-the-image-data:concept-task-7>task</a>, that is <a href=webappapis.html#queue-a-task id=updating-the-image-data:queue-a-task-6>queued</a> by the
              <a id=updating-the-image-data:networking-task-source-5 href=webappapis.html#networking-task-source>networking task source</a> while the image is being fetched, if <var>image
                request</var> is the <a href=#current-request id=updating-the-image-data:current-request-30>current request</a>, must update the presentation of the image
              appropriately (e.g., if the image is a progressive JPEG, each packet can improve the
              resolution of the image).
            </p>

            <p>Furthermore, the last <a href=webappapis.html#concept-task id=updating-the-image-data:concept-task-8>task</a> that is <a href=webappapis.html#queue-a-task id=updating-the-image-data:queue-a-task-7>queued</a> by the <a id=updating-the-image-data:networking-task-source-6 href=webappapis.html#networking-task-source>networking task source</a> once the resource has been
              fetched must additionally run these steps:</p>

            <ol><li>
                <p>If <var>image request</var> is the <a href=#pending-request id=updating-the-image-data:pending-request-19>pending request</a>,
                  <a href=#abort-the-image-request id=updating-the-image-data:abort-the-image-request-11>abort the image request</a> for the <a href=#current-request id=updating-the-image-data:current-request-31>current request</a>,
                  <a href=#upgrade-the-pending-request-to-the-current-request id=updating-the-image-data:upgrade-the-pending-request-to-the-current-request-4>upgrade the pending request to the current request</a> and
                  <a href=#prepare-an-image-for-presentation id=updating-the-image-data:prepare-an-image-for-presentation-4>prepare <var>image request</var> for
                    presentation</a> given the <code id=updating-the-image-data:the-img-element-24><a href=embedded-content.html#the-img-element>img</a></code> element.
                </p>
              <li>
                <p>Set <var>image request</var> to the <a href=#img-all id=updating-the-image-data:img-all-3>completely
                    available</a> state.</p>
              <li>
                <p>Add the image to the <a href=#list-of-available-images id=updating-the-image-data:list-of-available-images-2>list of available images</a> using the key
                  <var>key</var>, with the <a href=#ignore-higher-layer-caching id=updating-the-image-data:ignore-higher-layer-caching-2>ignore higher-layer caching</a> flag set.
                </p>
              <li>
                <p>If <i>maybe omit events</i> is not set or <var>previousURL</var> is not equal to
                  <var>urlString</var>, then <a href=https://dom.spec.whatwg.org/#concept-event-fire id=updating-the-image-data:concept-event-fire-7 data-x-internal=concept-event-fire>fire an event</a> named
                  <code id=updating-the-image-data:event-load-3><a href=indices.html#event-load>load</a></code> at the <code id=updating-the-image-data:the-img-element-25><a href=embedded-content.html#the-img-element>img</a></code> element.
                </p>
              </ol>
          <dt>Otherwise<dd>
            <p>The image data is not in a supported file format; the user agent must set <var>image
                request</var>'s <a href=#img-req-state id=updating-the-image-data:img-req-state-16>state</a> to <a href=#img-error id=updating-the-image-data:img-error-7>broken</a>, <a href=#abort-the-image-request id=updating-the-image-data:abort-the-image-request-12>abort the image request</a> for the <a href=#current-request id=updating-the-image-data:current-request-32>current
                request</a> and the <a href=#pending-request id=updating-the-image-data:pending-request-20>pending request</a>, <a href=#upgrade-the-pending-request-to-the-current-request id=updating-the-image-data:upgrade-the-pending-request-to-the-current-request-5>upgrade the pending request to the
                current request</a> if <var>image request</var> is the <a href=#pending-request id=updating-the-image-data:pending-request-21>pending request</a>, and
              then, if <i>maybe omit events</i> is not set or <var>previousURL</var> is not equal to
              <var>urlString</var>, <a id=updating-the-image-data:queue-an-element-task-6 href=webappapis.html#queue-an-element-task>queue an element task</a> on the <a id=updating-the-image-data:dom-manipulation-task-source-6 href=webappapis.html#dom-manipulation-task-source>DOM manipulation task
                source</a> given the <code id=updating-the-image-data:the-img-element-26><a href=embedded-content.html#the-img-element>img</a></code> element to <a href=https://dom.spec.whatwg.org/#concept-event-fire id=updating-the-image-data:concept-event-fire-8 data-x-internal=concept-event-fire>fire an
                event</a> named <code id=updating-the-image-data:event-error-5><a href=indices.html#event-error>error</a></code> at the <code id=updating-the-image-data:the-img-element-27><a href=embedded-content.html#the-img-element>img</a></code>
              element.
            </p>
          </dl>
      </ol>

    <p>While a user agent is running the above algorithm for an element <var>x</var>, there must be a
      strong reference from the element's <a id=updating-the-image-data:node-document-8 href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node document</a> to the element <var>x</var>, even
      if that element is not <a id=updating-the-image-data:connected href=https://dom.spec.whatwg.org/#connected data-x-internal=connected>connected</a>.</p>

    <p>To <dfn id=abort-the-image-request>abort the image request</dfn> for an <a href=#image-request id=updating-the-image-data:image-request-3>image request</a> or null <var>image
        request</var> means to run the following steps:</p>

    <ol><li>
        <p>If <var>image request</var> is null, then return.</p>
      <li>
        <p>Forget <var>image request</var>'s <a href=#img-req-data id=updating-the-image-data:img-req-data-3>image data</a>, if any.</p>
      <li>
        <p>Abort any instance of the <a href=https://fetch.spec.whatwg.org/#concept-fetch id=updating-the-image-data:concept-fetch-2 data-x-internal=concept-fetch>fetching</a> algorithm for
          <var>image request</var>, discarding any pending tasks generated by that algorithm.
        </p>
      </ol>

    <p>To <dfn id=upgrade-the-pending-request-to-the-current-request>upgrade the pending request to the current request</dfn> for an <code id=updating-the-image-data:the-img-element-28><a href=embedded-content.html#the-img-element>img</a></code> element means to run the following steps:</p>

    <ol><li>
        <p>Let the <code id=updating-the-image-data:the-img-element-29><a href=embedded-content.html#the-img-element>img</a></code> element's <a href=#current-request id=updating-the-image-data:current-request-33>current request</a> be the <a href=#pending-request id=updating-the-image-data:pending-request-22>pending request</a>.</p>
      <li>
        <p>Let the <code id=updating-the-image-data:the-img-element-30><a href=embedded-content.html#the-img-element>img</a></code> element's <a href=#pending-request id=updating-the-image-data:pending-request-23>pending request</a> be null.</p>
      </ol>


    <h6 id=preparing-an-image-for-presentation><span class=secno>4.8.4.3.6</span> Preparing an image for presentation<a href=#preparing-an-image-for-presentation class=self-link></a></h6>

    <p>To <dfn id=prepare-an-image-for-presentation>prepare an image for presentation</dfn> for an <a href=#image-request id=preparing-an-image-for-presentation:image-request>image request</a>
      <var>req</var> given image element <var>img</var>:
    </p>

    <ol><li>
        <p>Let <var>exifTagMap</var> be the EXIF tags obtained from <var>req</var>'s <a href=#img-req-data id=preparing-an-image-for-presentation:img-req-data>image data</a>, as defined by the relevant codec.
          <a href=references.html#refsEXIF>[EXIF]</a>
        </p>
      <li>
        <p>Let <var>physicalWidth</var> and <var>physicalHeight</var> be the width and height
          obtained from <var>req</var>'s <a href=#img-req-data id=preparing-an-image-for-presentation:img-req-data-2>image data</a>, as defined by the
          relevant codec.</p>
      <li>
        <p>Let <var>dimX</var> be the value of <var>exifTagMap</var>'s tag <code>0xA002</code> (<code>PixelXDimension</code>).</p>
      <li>
        <p>Let <var>dimY</var> be the value of <var>exifTagMap</var>'s tag <code>0xA003</code> (<code>PixelYDimension</code>).</p>
      <li>
        <p>Let <var>resX</var> be the value of <var>exifTagMap</var>'s tag <code>0x011A</code> (<code>XResolution</code>).</p>
      <li>
        <p>Let <var>resY</var> be the value of <var>exifTagMap</var>'s tag <code>0x011B</code> (<code>YResolution</code>).</p>
      <li>
        <p>Let <var>resUnit</var> be the value of <var>exifTagMap</var>'s tag <code>0x0128</code> (<code>ResolutionUnit</code>).</p>
      <li>
        <p>If either <var>dimX</var> or <var>dimY</var> is not a positive integer, then
          return.</p>
      <li>
        <p>If either <var>resX</var> or <var>resY</var> is not a positive floating-point number, then
          return.</p>
      <li>
        <p>If <var>resUnit</var> is not equal to <code>2</code> (<code>Inch</code>), then return.</p>
      <li>
        <p>Let <var>widthFromDensity</var> be the value of <var>physicalWidth</var>, multiplied by 72
          and divided by <var>resX</var>.</p>
      <li>
        <p>Let <var>heightFromDensity</var> be the value of <var>physicalHeight</var>, multiplied by
          72 and divided by <var>resY</var>.</p>
      <li>
        <p>If <var>widthFromDensity</var> is not equal to <var>dimX</var> or
          <var>heightFromDensity</var> is not equal to <var>dimY</var>, then return.
        </p>
      <li>
        <p>If <var>req</var>'s <a href=#img-req-data id=preparing-an-image-for-presentation:img-req-data-3>image data</a> is
          <a id=preparing-an-image-for-presentation:cors-cross-origin href=urls-and-fetching.html#cors-cross-origin>CORS-cross-origin</a>, then set <var>img</var>'s <a id=preparing-an-image-for-presentation:natural-dimensions href=https://drafts.csswg.org/css-images/#natural-dimensions data-x-internal=natural-dimensions>natural dimensions</a> to
          <var>dimX</var> and <var>dimY</var>, scale <var>img</var>'s pixel data accordingly, and return.
        </p>
      <li>
        <p>Set <var>req</var>'s <a href=#preferred-density-corrected-dimensions id=preparing-an-image-for-presentation:preferred-density-corrected-dimensions>preferred density-corrected dimensions</a> to a struct with
          its width set to <var>dimX</var> and its height set to <var>dimY</var>.</p>
      <li>
        <p>Update <var>req</var>'s <code id=preparing-an-image-for-presentation:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> element's presentation appropriately.</p>
      </ol>

    <p class=note>Resolution in EXIF is equivalent to <a href=https://drafts.csswg.org/css-values/#pt id="preparing-an-image-for-presentation:'pt'" data-x-internal="'pt'">CSS points per
        inch</a>, therefore 72 is the base for computing size from resolution.</p>

    <p class=XXX>It is not yet specified what would be the case if EXIF arrives after the image is
      already presented. See <a href=https://github.com/w3c/csswg-drafts/issues/4929>issue
        #4929</a>.</p>



    <h6 id=selecting-an-image-source><span class=secno>4.8.4.3.7</span> Selecting an image source<a href=#selecting-an-image-source class=self-link></a></h6>

    <p>To <dfn id=select-an-image-source>select an image source</dfn> given an <code id=selecting-an-image-source:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> element <var>el</var>:</p>

    <ol><li>
        <p><a href=#update-the-source-set id=selecting-an-image-source:update-the-source-set>Update the source set</a> for <var>el</var>.</p>
      <li>
        <p>If <var>el</var>'s <a href=#source-set id=selecting-an-image-source:source-set>source set</a> is empty, return null as the URL and undefined
          as the pixel density.</p>
      <li>
        <p>Return the result of <a href=#select-an-image-source-from-a-source-set id=selecting-an-image-source:select-an-image-source-from-a-source-set>selecting an
            image</a> from <var>el</var>'s <a href=#source-set id=selecting-an-image-source:source-set-2>source set</a>.</p>
      </ol>

    <p>To <dfn id=select-an-image-source-from-a-source-set>select an image source from a source set</dfn> given a <a href=#source-set id=selecting-an-image-source:source-set-3>source set</a>
      <var>sourceSet</var>:
    </p>

    <ol><li>
        <p>If an entry <var>b</var> in <var>sourceSet</var> has the same associated <a href=#pixel-density-descriptor id=selecting-an-image-source:pixel-density-descriptor>pixel
            density descriptor</a> as an earlier entry <var>a</var> in <var>sourceSet</var>, then remove
          entry <var>b</var>. Repeat this step until none of the entries in <var>sourceSet</var> have the
          same associated <a href=#pixel-density-descriptor id=selecting-an-image-source:pixel-density-descriptor-2>pixel density descriptor</a> as an earlier entry.</p>
      <li>
        <p>In an <a id=selecting-an-image-source:implementation-defined href=https://infra.spec.whatwg.org/#implementation-defined data-x-internal=implementation-defined>implementation-defined</a> manner, choose one <a href=#image-source id=selecting-an-image-source:image-source>image source</a>
          from <var>sourceSet</var>. Let this be <var>selectedSource</var>.</p>
      <li>
        <p>Return <var>selectedSource</var> and its associated pixel density.</p>
      </ol>

    <h6 id=creating-a-source-set-from-attributes><span class=secno>4.8.4.3.8</span> Creating a source set from attributes<a href=#creating-a-source-set-from-attributes class=self-link></a></h6>

    <p>When asked to <dfn id=create-a-source-set>create a source set</dfn> given a string <var>default source</var>, a string
      <var>srcset</var>, a string <var>sizes</var>, and an element or null <var>img</var>:
    </p>

    <ol><li>
        <p>Let <var>source set</var> be an empty <a href=#source-set id=creating-a-source-set-from-attributes:source-set>source set</a>.</p>
      <li>
        <p>If <var>srcset</var> is not an empty string, then set
          <var>source set</var> to the result of <a href=#parse-a-srcset-attribute id=creating-a-source-set-from-attributes:parse-a-srcset-attribute>parsing</a>
          <var>srcset</var>.
        </p>
      <li>
        <p>Let <a href=#source-size-2 id=creating-a-source-set-from-attributes:source-size-2>source size</a> be the result of <a href=#parse-a-sizes-attribute id=creating-a-source-set-from-attributes:parse-a-sizes-attribute>parsing</a> <var>sizes</var> with <var>img</var>.</p>
      <li>
        <p>If <var>default source</var> is not the empty string and
          <var>source set</var> does not contain an <a href=#image-source id=creating-a-source-set-from-attributes:image-source>image source</a> with a <a href=#pixel-density-descriptor id=creating-a-source-set-from-attributes:pixel-density-descriptor>pixel
            density descriptor</a> value of 1, and no <a href=#image-source id=creating-a-source-set-from-attributes:image-source-2>image source</a> with a <a href=#width-descriptor id=creating-a-source-set-from-attributes:width-descriptor>width
            descriptor</a>, append <var>default source</var> to <var>source set</var>.
        </p>
      <li>
        <p><a href=#normalise-the-source-densities id=creating-a-source-set-from-attributes:normalise-the-source-densities>Normalize the source densities</a> of <var>source set</var>.</p>
      <li>
        <p>Return <var>source set</var>.</p>
      </ol>


    <h6 id=updating-the-source-set><span class=secno>4.8.4.3.9</span> Updating the source set<a href=#updating-the-source-set class=self-link></a></h6>

    <p>When asked to <dfn id=update-the-source-set>update the source set</dfn> for a given <code id=updating-the-source-set:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> or
      <code id=updating-the-source-set:the-link-element><a href=semantics.html#the-link-element>link</a></code> element <var>el</var>, user agents must do the following:
    </p>

    <ol><li>
        <p>Set <var>el</var>'s <a href=#source-set id=updating-the-source-set:source-set>source set</a> to an empty <a href=#source-set id=updating-the-source-set:source-set-2>source set</a>.</p>
      <li>
        <p>Let <var>elements</var> be « <var>el</var> ».</p>
      <li>
        <p>If <var>el</var> is an <code id=updating-the-source-set:the-img-element-2><a href=embedded-content.html#the-img-element>img</a></code> element whose parent node is a
          <code id=updating-the-source-set:the-picture-element><a href=embedded-content.html#the-picture-element>picture</a></code> element, then <a href=https://infra.spec.whatwg.org/#list-replace id=updating-the-source-set:list-replace data-x-internal=list-replace>replace</a> the contents of
          <var>elements</var> with <var>el</var>'s parent node's child elements, retaining relative
          order.
        </p>
      <li>
        <p>Let <var>img</var> be <var>el</var> if <var>el</var> is an <code id=updating-the-source-set:the-img-element-3><a href=embedded-content.html#the-img-element>img</a></code> element,
          otherwise null.</p>
      <li>
        <p><a href=https://infra.spec.whatwg.org/#list-iterate id=updating-the-source-set:list-iterate data-x-internal=list-iterate>For each</a> <var>child</var> in <var>elements</var>:</p>

        <ol><li>
            <p>If <var>child</var> is <var>el</var>:</p>

            <ol><li>
                <p>Let <var>default source</var> be the empty string.</p>
              <li>
                <p>Let <var>srcset</var> be the empty string.</p>
              <li>
                <p>Let <var>sizes</var> be the empty string.</p>
              <li>
                <p>If <var>el</var> is an <code id=updating-the-source-set:the-img-element-4><a href=embedded-content.html#the-img-element>img</a></code> element that has a <code id=updating-the-source-set:attr-img-srcset><a href=embedded-content.html#attr-img-srcset>srcset</a></code> attribute, then set <var>srcset</var> to that
                  attribute's value.</p>
              <li>
                <p>Otherwise, if <var>el</var> is a <code id=updating-the-source-set:the-link-element-2><a href=semantics.html#the-link-element>link</a></code> element that has an <code id=updating-the-source-set:attr-link-imagesrcset><a href=semantics.html#attr-link-imagesrcset>imagesrcset</a></code> attribute, then set <var>srcset</var> to
                  that attribute's value.</p>
              <li>
                <p>If <var>el</var> is an <code id=updating-the-source-set:the-img-element-5><a href=embedded-content.html#the-img-element>img</a></code> element that has a <code id=updating-the-source-set:attr-img-sizes><a href=embedded-content.html#attr-img-sizes>sizes</a></code> attribute, then set <var>sizes</var> to that attribute's
                  value.</p>
              <li>
                <p>Otherwise, if <var>el</var> is a <code id=updating-the-source-set:the-link-element-3><a href=semantics.html#the-link-element>link</a></code> element that has an <code id=updating-the-source-set:attr-link-imagesizes><a href=semantics.html#attr-link-imagesizes>imagesizes</a></code> attribute, then set <var>sizes</var> to that
                  attribute's value.</p>
              <li>
                <p>If <var>el</var> is an <code id=updating-the-source-set:the-img-element-6><a href=embedded-content.html#the-img-element>img</a></code> element that has a <code id=updating-the-source-set:attr-img-src><a href=embedded-content.html#attr-img-src>src</a></code> attribute, then set <var>default source</var> to that
                  attribute's value.</p>
              <li>
                <p>Otherwise, if <var>el</var> is a <code id=updating-the-source-set:the-link-element-4><a href=semantics.html#the-link-element>link</a></code> element that has an <code id=updating-the-source-set:attr-link-href><a href=semantics.html#attr-link-href>href</a></code> attribute, then set <var>default source</var> to that
                  attribute's value.</p>
              <li>
                <p>Let <var>el</var>'s <a href=#source-set id=updating-the-source-set:source-set-3>source set</a> be the result of <a href=#create-a-source-set id=updating-the-source-set:create-a-source-set>creating a source set</a> given <var>default source</var>, <var>srcset</var>,
                  <var>sizes</var>, and <var>img</var>.
                </p>
              <li>
                <p>Return.</p>

                <p class=note>If <var>el</var> is a <code id=updating-the-source-set:the-link-element-5><a href=semantics.html#the-link-element>link</a></code> element, then <var>elements</var>
                  contains only <var>el</var>, so this step will be reached immediately and the rest of the
                  algorithm will not run.</p>
              </ol>
          <li>
            <p>If <var>child</var> is not a <code id=updating-the-source-set:the-source-element><a href=embedded-content.html#the-source-element>source</a></code> element, then
              <a id=updating-the-source-set:continue href=https://infra.spec.whatwg.org/#iteration-continue data-x-internal=continue>continue</a>.
            </p>
          <li>
            <p>If <var>child</var> does not have a <code id=updating-the-source-set:attr-source-srcset><a href=embedded-content.html#attr-source-srcset>srcset</a></code>
              attribute, <a id=updating-the-source-set:continue-2 href=https://infra.spec.whatwg.org/#iteration-continue data-x-internal=continue>continue</a> to the next child.</p>
          <li>
            <p><a href=#parse-a-srcset-attribute id=updating-the-source-set:parse-a-srcset-attribute>Parse <var>child</var>'s srcset attribute</a> and
              let the returned <a href=#source-set id=updating-the-source-set:source-set-4>source set</a> be <var>source set</var>.</p>
          <li>
            <p>If <var>source set</var> has zero <a href=#image-source id=updating-the-source-set:image-source>image sources</a>,
              <a id=updating-the-source-set:continue-3 href=https://infra.spec.whatwg.org/#iteration-continue data-x-internal=continue>continue</a> to the next child.
            </p>
          <li>
            <p>If <var>child</var> has a <code id=updating-the-source-set:attr-source-media><a href=embedded-content.html#attr-source-media>media</a></code> attribute, and
              its value does not <a href=common-microsyntaxes.html#matches-the-environment id=updating-the-source-set:matches-the-environment>match the environment</a>,
              <a id=updating-the-source-set:continue-4 href=https://infra.spec.whatwg.org/#iteration-continue data-x-internal=continue>continue</a> to the next child.
            </p>
          <li>
            <p><a href=#parse-a-sizes-attribute id=updating-the-source-set:parse-a-sizes-attribute>Parse <var>child</var>'s sizes attribute</a>
              with <var>img</var>, and let <var>source set</var>'s <a href=#source-size-2 id=updating-the-source-set:source-size-2>source size</a> be the returned
              value.</p>
          <li>
            <p>If <var>child</var> has a <code id=updating-the-source-set:attr-source-type><a href=embedded-content.html#attr-source-type>type</a></code> attribute, and its
              value is an unknown or unsupported <a id=updating-the-source-set:mime-type href=https://mimesniff.spec.whatwg.org/#mime-type data-x-internal=mime-type>MIME type</a>, <a id=updating-the-source-set:continue-5 href=https://infra.spec.whatwg.org/#iteration-continue data-x-internal=continue>continue</a> to the next child.</p>
          <li>
            <p>If <var>child</var> has <code id=updating-the-source-set:attr-dim-width><a href=embedded-content-other.html#attr-dim-width>width</a></code> or <code id=updating-the-source-set:attr-dim-height><a href=embedded-content-other.html#attr-dim-height>height</a></code> attributes, set <var>el</var>'s <a href=embedded-content.html#concept-img-dimension-attribute-source id=updating-the-source-set:concept-img-dimension-attribute-source>dimension attribute source</a> to
              <var>child</var>. Otherwise, set <var>el</var>'s <a href=embedded-content.html#concept-img-dimension-attribute-source id=updating-the-source-set:concept-img-dimension-attribute-source-2>dimension attribute source</a> to
              <var>el</var>.
            </p>
          <li>
            <p><a href=#normalise-the-source-densities id=updating-the-source-set:normalise-the-source-densities>Normalize the source densities</a> of <var>source set</var>.</p>
          <li>
            <p>Let <var>el</var>'s <a href=#source-set id=updating-the-source-set:source-set-5>source set</a> be <var>source set</var>.</p>
          <li>
            <p>Return.</p>
          </ol>
      </ol>

    <p class=note>Each <code id=updating-the-source-set:the-img-element-7><a href=embedded-content.html#the-img-element>img</a></code> element independently considers its previous sibling
      <code id=updating-the-source-set:the-source-element-2><a href=embedded-content.html#the-source-element>source</a></code> elements plus the <code id=updating-the-source-set:the-img-element-8><a href=embedded-content.html#the-img-element>img</a></code> element itself for selecting an <a href=#image-source id=updating-the-source-set:image-source-2>image
        source</a>, ignoring any other (invalid) elements, including other <code id=updating-the-source-set:the-img-element-9><a href=embedded-content.html#the-img-element>img</a></code> elements in
      the same <code id=updating-the-source-set:the-picture-element-2><a href=embedded-content.html#the-picture-element>picture</a></code> element, or <code id=updating-the-source-set:the-source-element-3><a href=embedded-content.html#the-source-element>source</a></code> elements that are following siblings
      of the relevant <code id=updating-the-source-set:the-img-element-10><a href=embedded-content.html#the-img-element>img</a></code> element.
    </p>


    <h6 id=parsing-a-srcset-attribute><span class=secno>4.8.4.3.10</span> Parsing a srcset attribute<a href=#parsing-a-srcset-attribute class=self-link></a></h6>

    <p>When asked to <dfn id=parse-a-srcset-attribute>parse a srcset attribute</dfn> from an element, parse the value of the
      element's <a href=#srcset-attribute id=parsing-a-srcset-attribute:srcset-attribute>srcset attribute</a> as follows:</p>

    <ol><li>
        <p>Let <var>input</var> be the value passed to this algorithm.</p>
      <li>
        <p>Let <var>position</var> be a pointer into <var>input</var>,
          initially pointing at the start of the string.</p>
      <li>
        <p>Let <var>candidates</var> be an initially empty <a href=#source-set id=parsing-a-srcset-attribute:source-set>source set</a>.</p>
      <li>
        <p><i>Splitting loop</i>: <a id=parsing-a-srcset-attribute:collect-a-sequence-of-code-points href=https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points data-x-internal=collect-a-sequence-of-code-points>Collect a sequence of code points</a> that are <a id=parsing-a-srcset-attribute:space-characters href=https://infra.spec.whatwg.org/#ascii-whitespace data-x-internal=space-characters>ASCII
            whitespace</a> or U+002C COMMA characters from <var>input</var> given <var>position</var>. If
          any U+002C COMMA characters were collected, that is a <a href=#concept-microsyntax-parse-error id=parsing-a-srcset-attribute:concept-microsyntax-parse-error>parse error</a>.</p>
      <li>
        <p>If <var>position</var> is past the end of <var>input</var>,
          return <var>candidates</var>.</p>
      <li>
        <p><a id=parsing-a-srcset-attribute:collect-a-sequence-of-code-points-2 href=https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points data-x-internal=collect-a-sequence-of-code-points>Collect a sequence of code points</a> that are not <a id=parsing-a-srcset-attribute:space-characters-2 href=https://infra.spec.whatwg.org/#ascii-whitespace data-x-internal=space-characters>ASCII whitespace</a>
          from <var>input</var> given <var>position</var>, and let that be <var>url</var>.</p>
      <li>
        <p>Let <var>descriptors</var> be a new empty list.</p>
      <li>
        <p>If <var>url</var> ends with U+002C (,), then:</p>

        <ol><li>
            <p>Remove all trailing U+002C COMMA characters from <var>url</var>.
              If this removed more than one character,
              that is a <a href=#concept-microsyntax-parse-error id=parsing-a-srcset-attribute:concept-microsyntax-parse-error-2>parse error</a>.</p>
          </ol>

        <p>Otherwise:</p>

        <ol><li>
            <p><i>Descriptor tokenizer</i>: <a id=parsing-a-srcset-attribute:skip-ascii-whitespace href=https://infra.spec.whatwg.org/#skip-ascii-whitespace data-x-internal=skip-ascii-whitespace>Skip ASCII whitespace</a> within <var>input</var>
              given <var>position</var>.</p>
          <li>
            <p>Let <var>current descriptor</var> be the empty string.</p>
          <li>
            <p>Let <var>state</var> be <i>in descriptor</i>.</p>
          <li>
            <p>Let <var>c</var> be the character at <var>position</var>.
              Do the following depending on the value of <var>state</var>.
              For the purpose of this step, "EOF" is a special character representing
              that <var>position</var> is past the end of <var>input</var>.</p>

            <dl class=switch><dt><i>In descriptor</i><dd>
                <p>Do the following, depending on the value of <var>c</var>:</p>

                <dl class=switch><dt><a id=parsing-a-srcset-attribute:space-characters-3 href=https://infra.spec.whatwg.org/#ascii-whitespace data-x-internal=space-characters>ASCII whitespace</a><dd>
                    <p>If <var>current descriptor</var> is not empty,
                      append <var>current descriptor</var> to <var>descriptors</var>
                      and let <var>current descriptor</var> be the empty string.
                      Set <var>state</var> to <i>after descriptor</i>.</p>
                  <dt>U+002C COMMA (,)<dd>
                    <p>Advance <var>position</var> to the next character in <var>input</var>.
                      If <var>current descriptor</var> is not empty,
                      append <var>current descriptor</var> to <var>descriptors</var>.
                      Jump to the step labeled <i>descriptor parser</i>.</p>
                  <dt>U+0028 LEFT PARENTHESIS (()<dd>
                    <p>Append <var>c</var> to <var>current descriptor</var>.
                      Set <var>state</var> to <i>in parens</i>.</p>
                  <dt>EOF<dd>
                    <p>If <var>current descriptor</var> is not empty,
                      append <var>current descriptor</var> to <var>descriptors</var>.
                      Jump to the step labeled <i>descriptor parser</i>.</p>
                  <dt>Anything else<dd>
                    <p>Append <var>c</var> to <var>current descriptor</var>.</p>
                  </dl>
              <dt><i>In parens</i><dd>
                <p>Do the following, depending on the value of <var>c</var>:</p>

                <dl class=switch><dt>U+0029 RIGHT PARENTHESIS ())<dd>
                    <p>Append <var>c</var> to <var>current descriptor</var>.
                      Set <var>state</var> to <i>in descriptor</i>.</p>
                  <dt>EOF<dd>
                    <p>Append <var>current descriptor</var> to <var>descriptors</var>.
                      Jump to the step labeled <i>descriptor parser</i>.</p>
                  <dt>Anything else<dd>
                    <p>Append <var>c</var> to <var>current descriptor</var>.</p>
                  </dl>
              <dt><i>After descriptor</i><dd>
                <p>Do the following, depending on the value of <var>c</var>:</p>

                <dl class=switch><dt><a id=parsing-a-srcset-attribute:space-characters-4 href=https://infra.spec.whatwg.org/#ascii-whitespace data-x-internal=space-characters>ASCII whitespace</a><dd>
                    <p>Stay in this state.</p>
                  <dt>EOF<dd>
                    <p>Jump to the step labeled <i>descriptor parser</i>.</p>
                  <dt>Anything else<dd>
                    <p>Set <var>state</var> to <i>in descriptor</i>.
                      Set <var>position</var> to the <em>previous</em> character in <var>input</var>.</p>
                  </dl>
              </dl>

            <p>Advance <var>position</var> to the next character in <var>input</var>. Repeat this
              step.</p>

            <p class=note>In order to be compatible with future additions,
              this algorithm supports multiple descriptors and descriptors with parens.</p>
          </ol>
      <li>
        <p><i>Descriptor parser</i>: Let <var>error</var> be <i>no</i>.</p>
      <li>
        <p>Let <var>width</var> be <i>absent</i>.</p>
      <li>
        <p>Let <var>density</var> be <i>absent</i>.</p>
      <li>
        <p>Let <var>future-compat-h</var> be <i>absent</i>.</p>
      <li>
        <p>For each descriptor in <var>descriptors</var>,
          run the appropriate set of steps from the following list:</p>

        <dl class=switch><dt>If the descriptor consists of a <a id=parsing-a-srcset-attribute:valid-non-negative-integer href=common-microsyntaxes.html#valid-non-negative-integer>valid non-negative integer</a>
            followed by a U+0077 LATIN SMALL LETTER W character<dd>
            <ol><li>
                <p>If the user agent does not support the <code id=parsing-a-srcset-attribute:attr-img-sizes><a href=embedded-content.html#attr-img-sizes>sizes</a></code> attribute,
                  let <var>error</var> be <i>yes</i>.</p>

                <p class=note>A conforming user agent will support the <code id=parsing-a-srcset-attribute:attr-img-sizes-2><a href=embedded-content.html#attr-img-sizes>sizes</a></code> attribute.
                  However, user agents typically implement and ship features in an incremental manner in practice.</p>
              <li>
                <p>If <var>width</var> and <var>density</var>
                  are not both <i>absent</i>,
                  then let <var>error</var> be <i>yes</i>.</p>
              <li>
                <p>Apply the <a id=parsing-a-srcset-attribute:rules-for-parsing-non-negative-integers href=common-microsyntaxes.html#rules-for-parsing-non-negative-integers>rules for parsing non-negative integers</a> to the descriptor. If
                  the result is 0, let <var>error</var> be <i>yes</i>. Otherwise, let <var>width</var> be the
                  result.</p>
              </ol>
          <dt>If the descriptor consists of a <a id=parsing-a-srcset-attribute:valid-floating-point-number href=common-microsyntaxes.html#valid-floating-point-number>valid floating-point number</a>
            followed by a U+0078 LATIN SMALL LETTER X character<dd>
            <ol><li>
                <p>If <var>width</var>, <var>density</var> and <var>future-compat-h</var>
                  are not all <i>absent</i>,
                  then let <var>error</var> be <i>yes</i>.</p>
              <li>
                <p>Apply the <a id=parsing-a-srcset-attribute:rules-for-parsing-floating-point-number-values href=common-microsyntaxes.html#rules-for-parsing-floating-point-number-values>rules for parsing floating-point number values</a> to the descriptor.
                  If the result is less than 0, let <var>error</var> be <i>yes</i>. Otherwise, let
                  <var>density</var> be the result.
                </p>

                <p class=note>If <var>density</var> is 0, the <a id=parsing-a-srcset-attribute:natural-dimensions href=https://drafts.csswg.org/css-images/#natural-dimensions data-x-internal=natural-dimensions>natural dimensions</a> will be
                  infinite. User agents are <a href=https://infra.spec.whatwg.org/#algorithm-limits>expected
                    to have limits</a> in how big images can be rendered.</p>
              </ol>
          <dt>If the descriptor consists of a <a id=parsing-a-srcset-attribute:valid-non-negative-integer-2 href=common-microsyntaxes.html#valid-non-negative-integer>valid non-negative integer</a>
            followed by a U+0068 LATIN SMALL LETTER H character<dd>
            <p>This is a <a href=#concept-microsyntax-parse-error id=parsing-a-srcset-attribute:concept-microsyntax-parse-error-3>parse error</a>.</p>

            <ol><li>
                <p>If <var>future-compat-h</var> and <var>density</var>
                  are not both <i>absent</i>,
                  then let <var>error</var> be <i>yes</i>.</p>
              <li>
                <p>Apply the <a id=parsing-a-srcset-attribute:rules-for-parsing-non-negative-integers-2 href=common-microsyntaxes.html#rules-for-parsing-non-negative-integers>rules for parsing non-negative integers</a> to the descriptor. If
                  the result is 0, let <var>error</var> be <i>yes</i>. Otherwise, let
                  <var>future-compat-h</var> be the result.
                </p>
              </ol>
          <dt>Anything else<dd>
            <p>Let <var>error</var> be <i>yes</i>.</p>
          </dl>
      <li>
        <p>If <var>future-compat-h</var> is not <i>absent</i> and <var>width</var> is <i>absent</i>,
          let <var>error</var> be <i>yes</i>.</p>
      <li>
        <p>If <var>error</var> is still <i>no</i>,
          then append a new <a href=#image-source id=parsing-a-srcset-attribute:image-source>image source</a> to <var>candidates</var>
          whose URL is <var>url</var>,
          associated with a width <var>width</var> if not <i>absent</i>
          and a pixel density <var>density</var> if not <i>absent</i>.
          Otherwise, there is a <a href=#concept-microsyntax-parse-error id=parsing-a-srcset-attribute:concept-microsyntax-parse-error-4>parse error</a>.</p>
      <li>
        <p>Return to the step labeled <i>splitting loop</i>.</p>
      </ol>


    <h6 id=parsing-a-sizes-attribute><span class=secno>4.8.4.3.11</span> Parsing a sizes attribute<a href=#parsing-a-sizes-attribute class=self-link></a></h6>

    <p>When asked to <dfn id=parse-a-sizes-attribute>parse a sizes attribute</dfn> from an element <var>element</var>, with an
      <code id=parsing-a-sizes-attribute:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> element or null <var>img</var>:
    </p>

    <ol><li>
        <p>Let <var>unparsed sizes list</var> be the result of <a href=https://drafts.csswg.org/css-syntax/#parse-a-comma-separated-list-of-component-values id=parsing-a-sizes-attribute:parse-a-comma-separated-list-of-component-values data-x-internal=parse-a-comma-separated-list-of-component-values>parsing a comma-separated list of component values</a> from the
          value of <var>element</var>'s <a href=#sizes-attribute id=parsing-a-sizes-attribute:sizes-attribute>sizes attribute</a> (or the empty string, if the attribute
          is absent). <a href=references.html#refsCSSSYNTAX>[CSSSYNTAX]</a>
        </p>
      <li>
        <p>Let <var>size</var> be null.</p>
      <li>
        <p>For each <var>unparsed size</var> in <var>unparsed sizes list</var>:</p>

        <ol><li>
            <p>Remove all consecutive <a id=parsing-a-sizes-attribute:whitespace-token href=https://drafts.csswg.org/css-syntax/#typedef-whitespace-token data-x-internal=whitespace-token>&lt;whitespace-token></a>s
              from the end of <var>unparsed size</var>.
              If <var>unparsed size</var> is now empty,
              then that is a <a href=#concept-microsyntax-parse-error id=parsing-a-sizes-attribute:concept-microsyntax-parse-error>parse error</a>;
              <a id=parsing-a-sizes-attribute:continue href=https://infra.spec.whatwg.org/#iteration-continue data-x-internal=continue>continue</a>.
            </p>
          <li>
            <p>If the last <a id=parsing-a-sizes-attribute:component-value href=https://drafts.csswg.org/css-syntax/#component-value data-x-internal=component-value>component value</a> in <var>unparsed size</var>
              is a valid non-negative <a href=#source-size-value id=parsing-a-sizes-attribute:source-size-value>&lt;source-size-value></a>,
              then set <var>size</var> to its value
              and remove the <a id=parsing-a-sizes-attribute:component-value-2 href=https://drafts.csswg.org/css-syntax/#component-value data-x-internal=component-value>component value</a> from <var>unparsed size</var>.
              Any CSS function other than the <a id=parsing-a-sizes-attribute:math-functions href=https://drafts.csswg.org/css-values/#math-function data-x-internal=math-functions>math functions</a> is invalid.
              Otherwise, there is a <a href=#concept-microsyntax-parse-error id=parsing-a-sizes-attribute:concept-microsyntax-parse-error-2>parse error</a>;
              <a id=parsing-a-sizes-attribute:continue-2 href=https://infra.spec.whatwg.org/#iteration-continue data-x-internal=continue>continue</a>.
            </p>
          <li>
            <p>If <var>size</var> is <code id=parsing-a-sizes-attribute:valdef-sizes-auto><a href=#valdef-sizes-auto>auto</a></code>, and <var>img</var>
              is not null, and <var>img</var> is <a id=parsing-a-sizes-attribute:being-rendered href=rendering.html#being-rendered>being rendered</a>, and <var>img</var>
              <a id=parsing-a-sizes-attribute:allows-auto-sizes href=embedded-content.html#allows-auto-sizes>allows auto-sizes</a>, then set <var>size</var> to the <a id=parsing-a-sizes-attribute:concrete-object-size href=https://drafts.csswg.org/css-images/#concrete-object-size data-x-internal=concrete-object-size>concrete object
                size</a> width of <var>img</var>, in <a href=https://drafts.csswg.org/css-values/#px id="parsing-a-sizes-attribute:'px'" data-x-internal="'px'">CSS pixels</a>.
            </p>

            <p class=note>If <var>size</var> is still <code id=parsing-a-sizes-attribute:valdef-sizes-auto-2><a href=#valdef-sizes-auto>auto</a></code>,
              then it will be ignored.</p>
          <li>
            <p>Remove all consecutive <a id=parsing-a-sizes-attribute:whitespace-token-2 href=https://drafts.csswg.org/css-syntax/#typedef-whitespace-token data-x-internal=whitespace-token>&lt;whitespace-token></a>s from the end of <var>unparsed
                size</var>. If <var>unparsed size</var> is now empty:</p>

            <ol><li>
                <p>If this was not the last item in <var>unparsed sizes list</var>, that is a <a href=#concept-microsyntax-parse-error id=parsing-a-sizes-attribute:concept-microsyntax-parse-error-3>parse error</a>.</p>
              <li>
                <p>If <var>size</var> is not <code id=parsing-a-sizes-attribute:valdef-sizes-auto-3><a href=#valdef-sizes-auto>auto</a></code>, then return
                  <var>size</var>. Otherwise, continue.
                </p>
              </ol>
          <li>
            <p>Parse the remaining <a href=https://drafts.csswg.org/css-syntax/#component-value id=parsing-a-sizes-attribute:component-value-3 data-x-internal=component-value>component values</a> in <var>unparsed size</var>
              as a <a id=parsing-a-sizes-attribute:media-condition href=https://drafts.csswg.org/mediaqueries/#typedef-media-condition data-x-internal=media-condition>&lt;media-condition></a>.
              If it does not parse correctly,
              or it does parse correctly but the <a id=parsing-a-sizes-attribute:media-condition-2 href=https://drafts.csswg.org/mediaqueries/#typedef-media-condition data-x-internal=media-condition>&lt;media-condition></a> evaluates to false,
              <a id=parsing-a-sizes-attribute:continue-3 href=https://infra.spec.whatwg.org/#iteration-continue data-x-internal=continue>continue</a>. <a href=references.html#refsMQ>[MQ]</a>
            </p>
          <li>
            <p>If <var>size</var> is not <code id=parsing-a-sizes-attribute:valdef-sizes-auto-4><a href=#valdef-sizes-auto>auto</a></code>, then return
              <var>size</var>. Otherwise, continue.
            </p>
          </ol>
      <li>
        <p>Return <code>100vw</code>.</p>
      </ol>

    <p class=note>It is invalid to use a bare <a href=#source-size-value id=parsing-a-sizes-attribute:source-size-value-2>&lt;source-size-value></a> that is a <a id=parsing-a-sizes-attribute:length-2 href=https://drafts.csswg.org/css-values/#lengths data-x-internal=length-2>&lt;length></a>
      (without an accompanying <a id=parsing-a-sizes-attribute:media-condition-3 href=https://drafts.csswg.org/mediaqueries/#typedef-media-condition data-x-internal=media-condition>&lt;media-condition></a>)
      as an entry in the <a href=#source-size-list id=parsing-a-sizes-attribute:source-size-list>&lt;source-size-list></a> that is not the last entry.
      However, the parsing algorithm allows it at any point in the <a href=#source-size-list id=parsing-a-sizes-attribute:source-size-list-2>&lt;source-size-list></a>,
      and will accept it immediately as the size
      if the preceding entries in the list weren't used.
      This is to enable future extensions,
      and protect against simple author errors such as a final trailing comma.
      A bare <code id=parsing-a-sizes-attribute:valdef-sizes-auto-5><a href=#valdef-sizes-auto>auto</a></code> keyword is allowed to have other entries
      following it to provide a fallback for legacy user agents.</p>


    <h6 id=normalizing-the-source-densities><span class=secno>4.8.4.3.12</span> Normalizing the source densities<a href=#normalizing-the-source-densities class=self-link></a></h6>

    <p>An <a href=#image-source id=normalizing-the-source-densities:image-source>image source</a> can have a <a href=#pixel-density-descriptor id=normalizing-the-source-densities:pixel-density-descriptor>pixel density descriptor</a>, a <a href=#width-descriptor id=normalizing-the-source-densities:width-descriptor>width
        descriptor</a>, or no descriptor at all accompanying its URL. Normalizing a <a href=#source-set id=normalizing-the-source-densities:source-set>source
        set</a> gives every <a href=#image-source id=normalizing-the-source-densities:image-source-2>image source</a> a <a href=#pixel-density-descriptor id=normalizing-the-source-densities:pixel-density-descriptor-2>pixel density descriptor</a>.</p>

    <p>When asked to <dfn id=normalise-the-source-densities>normalize the source
        densities</dfn> of a <a href=#source-set id=normalizing-the-source-densities:source-set-2>source set</a> <var>source set</var>, the user agent must do the
      following:</p>

    <ol><li>
        <p>Let <var>source size</var> be <var>source set</var>'s <a href=#source-size-2 id=normalizing-the-source-densities:source-size-2>source size</a>.</p>
      <li>
        <p>For each <a href=#image-source id=normalizing-the-source-densities:image-source-3>image source</a> in <var>source set</var>:</p>

        <ol><li>
            <p>If the <a href=#image-source id=normalizing-the-source-densities:image-source-4>image source</a> has a <a href=#pixel-density-descriptor id=normalizing-the-source-densities:pixel-density-descriptor-3>pixel density descriptor</a>, <a id=normalizing-the-source-densities:continue href=https://infra.spec.whatwg.org/#iteration-continue data-x-internal=continue>continue</a> to the next
              <a href=#image-source id=normalizing-the-source-densities:image-source-5>image source</a>.
            </p>
          <li>
            <p>Otherwise, if the <a href=#image-source id=normalizing-the-source-densities:image-source-6>image source</a> has a <a href=#width-descriptor id=normalizing-the-source-densities:width-descriptor-2>width descriptor</a>, replace the <a href=#width-descriptor id=normalizing-the-source-densities:width-descriptor-3>width
                descriptor</a> with a <a href=#pixel-density-descriptor id=normalizing-the-source-densities:pixel-density-descriptor-4>pixel density descriptor</a> with a <a href=#pixel-density-descriptor-value id=normalizing-the-source-densities:pixel-density-descriptor-value>value</a> of the <a href=#width-descriptor-value id=normalizing-the-source-densities:width-descriptor-value>width descriptor value</a> divided by the <a href=#source-size-2 id=normalizing-the-source-densities:source-size-2-2>source size</a> and a unit
              of <code>x</code>.</p>

            <p class=note>If the <a href=#source-size-2 id=normalizing-the-source-densities:source-size-2-3>source size</a> is 0, then the density would be infinity,
              which results in the <a id=normalizing-the-source-densities:natural-dimensions href=https://drafts.csswg.org/css-images/#natural-dimensions data-x-internal=natural-dimensions>natural dimensions</a> being 0 by 0.</p>
          <li>
            <p>Otherwise, give the <a href=#image-source id=normalizing-the-source-densities:image-source-7>image source</a> a <a href=#pixel-density-descriptor id=normalizing-the-source-densities:pixel-density-descriptor-5>pixel density descriptor</a> of <code>1x</code>.</p>
          </ol>
      </ol>


    <h6 id=reacting-to-environment-changes><span class=secno>4.8.4.3.13</span> Reacting to environment changes<a href=#reacting-to-environment-changes class=self-link></a></h6>

    <p>The user agent may at any time run the following algorithm to update an <code id=reacting-to-environment-changes:the-img-element><a href=embedded-content.html#the-img-element>img</a></code>
      element's image in order to <dfn id=img-environment-changes>react to changes in the
        environment</dfn>. (User agents are <em>not required</em> to ever run this algorithm; for example,
      if the user is not looking at the page any more, the user agent might want to wait until the user
      has returned to the page before determining which image to use, in case the environment changes
      again in the meantime.)</p>

    <p class=note>User agents are encouraged to run this algorithm in particular when the user changes
      the <a id=reacting-to-environment-changes:viewport href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a>'s size (e.g. by resizing the window or changing the page zoom), and when
      an <code id=reacting-to-environment-changes:the-img-element-2><a href=embedded-content.html#the-img-element>img</a></code> element is <a href=infrastructure.html#insert-an-element-into-a-document id=reacting-to-environment-changes:insert-an-element-into-a-document>inserted into a
        document</a>, so that the <a href=#density-corrected-intrinsic-width-and-height id=reacting-to-environment-changes:density-corrected-intrinsic-width-and-height>density-corrected natural width and height</a> match the
      new <a id=reacting-to-environment-changes:viewport-2 href=https://drafts.csswg.org/css2/#viewport data-x-internal=viewport>viewport</a>, and so that the correct image is chosen when <a href=#art-direction id=reacting-to-environment-changes:art-direction>art direction</a>
      is involved.</p>

    <ol><li>
        <p><a id=reacting-to-environment-changes:await-a-stable-state href=webappapis.html#await-a-stable-state>Await a stable state</a>. The <a id=reacting-to-environment-changes:synchronous-section href=webappapis.html#synchronous-section>synchronous section</a>
          consists of all the remaining steps of this algorithm until the algorithm says the
          <a id=reacting-to-environment-changes:synchronous-section-2 href=webappapis.html#synchronous-section>synchronous section</a> has ended. (Steps in <a href=webappapis.html#synchronous-section id=reacting-to-environment-changes:synchronous-section-3>synchronous sections</a> are marked with ⌛.)
        </p>
      <li>
        <p>⌛ If the <code id=reacting-to-environment-changes:the-img-element-3><a href=embedded-content.html#the-img-element>img</a></code> element does not <a href=#use-srcset-or-picture id=reacting-to-environment-changes:use-srcset-or-picture>use <code>srcset</code> or
            <code>picture</code></a>, its <a id=reacting-to-environment-changes:node-document href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node document</a> is not <a id=reacting-to-environment-changes:fully-active href=document-sequences.html#fully-active>fully active</a>, has
          image data whose resource type is <code id=reacting-to-environment-changes:multipart/x-mixed-replace><a href=iana.html#multipart/x-mixed-replace>multipart/x-mixed-replace</a></code>, or the <a href=#pending-request id=reacting-to-environment-changes:pending-request>pending
            request</a> is not null, then return.</p>
      <li>
        <p>⌛ Let <var>selected source</var> and <var>selected pixel
            density</var> be the URL and pixel density that results from <a href=#select-an-image-source id=reacting-to-environment-changes:select-an-image-source>selecting an image source</a>, respectively.</p>
      <li>
        <p>⌛ If <var>selected source</var> is null, then return.</p>
      <li>
        <p>⌛ If <var>selected source</var> and <var>selected pixel
            density</var> are the same as the element's <a href=#last-selected-source id=reacting-to-environment-changes:last-selected-source>last selected source</a> and <a href=#current-pixel-density id=reacting-to-environment-changes:current-pixel-density>current
            pixel density</a>, then return.</p>
      <li>
        <p>⌛ Let <var>urlString</var> be the result of <a id=reacting-to-environment-changes:encoding-parsing-and-serializing-a-url href=urls-and-fetching.html#encoding-parsing-and-serializing-a-url>encoding-parsing-and-serializing
            a URL</a> given <var>selected source</var>, relative to the element's <a id=reacting-to-environment-changes:node-document-2 href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node
            document</a>.</p>
      <li>
        <p>⌛ If <var>urlString</var> is failure, then return.</p>
      <li>
        <p>⌛ Let <var>corsAttributeState</var> be the state of the element's <code id=reacting-to-environment-changes:attr-img-crossorigin><a href=embedded-content.html#attr-img-crossorigin>crossorigin</a></code> content attribute.</p>
      <li>
        <p>⌛ Let <var>origin</var> be the <code id=reacting-to-environment-changes:the-img-element-4><a href=embedded-content.html#the-img-element>img</a></code> element's <a id=reacting-to-environment-changes:node-document-3 href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node
            document</a>'s <a href=https://dom.spec.whatwg.org/#concept-document-origin id=reacting-to-environment-changes:concept-document-origin data-x-internal=concept-document-origin>origin</a>.</p>
      <li>
        <p>⌛ Let <var>client</var> be the <code id=reacting-to-environment-changes:the-img-element-5><a href=embedded-content.html#the-img-element>img</a></code> element's <a id=reacting-to-environment-changes:node-document-4 href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node
            document</a>'s <a id=reacting-to-environment-changes:relevant-settings-object href=webappapis.html#relevant-settings-object>relevant settings object</a>.</p>
      <li>
        <p>⌛ Let <var>key</var> be a tuple consisting of <var>urlString</var>,
          <var>corsAttributeState</var>, and, if <var>corsAttributeState</var> is not <a href=urls-and-fetching.html#attr-crossorigin-none id=reacting-to-environment-changes:attr-crossorigin-none>No CORS</a>, <var>origin</var>.
        </p>
      <li>
        <p>⌛ Let <var>image request</var> be a new <a href=#image-request id=reacting-to-environment-changes:image-request>image request</a>
          whose <a href=#img-req-url id=reacting-to-environment-changes:img-req-url>current URL</a> is <var>urlString</var>.</p>
      <li>
        <p>⌛ Let the element's <a href=#pending-request id=reacting-to-environment-changes:pending-request-2>pending request</a> be <var>image request</var>.</p>
      <li>
        <p>End the <a id=reacting-to-environment-changes:synchronous-section-4 href=webappapis.html#synchronous-section>synchronous section</a>, continuing the remaining steps
          <a id=reacting-to-environment-changes:in-parallel href=infrastructure.html#in-parallel>in parallel</a>.
        </p>
      <li>
        <p>If the <a href=#list-of-available-images id=reacting-to-environment-changes:list-of-available-images>list of available images</a> contains an entry for <var>key</var>,
          then set <var>image request</var>'s <a href=#img-req-data id=reacting-to-environment-changes:img-req-data>image data</a> to that of the entry.
          Continue to the next step.</p>

        <p>Otherwise:</p>

        <ol><li>
            <p>Let <var>request</var> be the result of <a href=urls-and-fetching.html#create-a-potential-cors-request id=reacting-to-environment-changes:create-a-potential-cors-request>creating a potential-CORS request</a> given
              <var>urlString</var>, "<code>image</code>", and
              <var>corsAttributeState</var>.
            </p>
          <li>
            <p>Set <var>request</var>'s <a href=https://fetch.spec.whatwg.org/#concept-request-client id=reacting-to-environment-changes:concept-request-client data-x-internal=concept-request-client>client</a> to
              <var>client</var>, <a href=https://fetch.spec.whatwg.org/#concept-request-initiator id=reacting-to-environment-changes:concept-request-initiator data-x-internal=concept-request-initiator>initiator</a> to "<code>imageset</code>", and set <var>request</var>'s <a id=reacting-to-environment-changes:synchronous-flag href=https://fetch.spec.whatwg.org/#synchronous-flag data-x-internal=synchronous-flag>synchronous
                flag</a>.
            </p>
          <li>
            <p>Set <var>request</var>'s
              <a href=https://fetch.spec.whatwg.org/#concept-request-referrer-policy id=reacting-to-environment-changes:concept-request-referrer-policy data-x-internal=concept-request-referrer-policy>referrer policy</a> to the current state of
              the element's <code id=reacting-to-environment-changes:attr-img-referrerpolicy><a href=embedded-content.html#attr-img-referrerpolicy>referrerpolicy</a></code> attribute.
            </p>
          <li>
            <p>Set <var>request</var>'s <a href=https://fetch.spec.whatwg.org/#request-priority id=reacting-to-environment-changes:concept-request-priority data-x-internal=concept-request-priority>priority</a> to the current state of the element's <code id=reacting-to-environment-changes:attr-img-fetchpriority><a href=embedded-content.html#attr-img-fetchpriority>fetchpriority</a></code> attribute.</p>
          <li>
            <p>Let <var>response</var> be the result of <a href=https://fetch.spec.whatwg.org/#concept-fetch id=reacting-to-environment-changes:concept-fetch data-x-internal=concept-fetch>fetching</a> <var>request</var>.</p>
          <li>
            <p>If <var>response</var>'s <a id=reacting-to-environment-changes:unsafe-response href=urls-and-fetching.html#unsafe-response>unsafe response</a> is a <a id=reacting-to-environment-changes:network-error href=https://fetch.spec.whatwg.org/#concept-network-error data-x-internal=network-error>network error</a> or
              if the image format is unsupported (as determined by applying the <a href=https://mimesniff.spec.whatwg.org/#rules-for-sniffing-images-specifically id=reacting-to-environment-changes:content-type-sniffing:-image data-x-internal=content-type-sniffing:-image>image sniffing rules</a>, again as mentioned earlier),
              or if the user agent is able to determine that <var>image request</var>'s image is corrupted in
              some fatal way such that the image dimensions cannot be obtained, or if the resource type is
              <code id=reacting-to-environment-changes:multipart/x-mixed-replace-2><a href=iana.html#multipart/x-mixed-replace>multipart/x-mixed-replace</a></code>, then let <a href=#pending-request id=reacting-to-environment-changes:pending-request-3>pending request</a> be null and abort
              these steps.
            </p>
          <li>
            <p>Otherwise, <var>response</var>'s <a id=reacting-to-environment-changes:unsafe-response-2 href=urls-and-fetching.html#unsafe-response>unsafe response</a> is <var>image
                request</var>'s <a href=#img-req-data id=reacting-to-environment-changes:img-req-data-2>image data</a>. It can be either
              <a id=reacting-to-environment-changes:cors-same-origin href=urls-and-fetching.html#cors-same-origin>CORS-same-origin</a> or <a id=reacting-to-environment-changes:cors-cross-origin href=urls-and-fetching.html#cors-cross-origin>CORS-cross-origin</a>; this affects the image's
              interaction with other APIs (e.g., when used on a <code id=reacting-to-environment-changes:the-canvas-element><a href=canvas.html#the-canvas-element>canvas</a></code>).
            </p>
          </ol>
      <li>
        <p><a id=reacting-to-environment-changes:queue-an-element-task href=webappapis.html#queue-an-element-task>Queue an element task</a> on the <a id=reacting-to-environment-changes:dom-manipulation-task-source href=webappapis.html#dom-manipulation-task-source>DOM manipulation task source</a> given
          the <code id=reacting-to-environment-changes:the-img-element-6><a href=embedded-content.html#the-img-element>img</a></code> element and the following steps:</p>

        <ol><li>
            <p>If the <code id=reacting-to-environment-changes:the-img-element-7><a href=embedded-content.html#the-img-element>img</a></code> element has experienced <a href=#relevant-mutations id=reacting-to-environment-changes:relevant-mutations>relevant mutations</a>
              since this algorithm started, then let <a href=#pending-request id=reacting-to-environment-changes:pending-request-4>pending request</a> be null and abort these
              steps.</p>

          <li>
            <p>Let the <code id=reacting-to-environment-changes:the-img-element-8><a href=embedded-content.html#the-img-element>img</a></code> element's <a href=#last-selected-source id=reacting-to-environment-changes:last-selected-source-2>last selected source</a> be <var>selected
                source</var> and the <code id=reacting-to-environment-changes:the-img-element-9><a href=embedded-content.html#the-img-element>img</a></code> element's <a href=#current-pixel-density id=reacting-to-environment-changes:current-pixel-density-2>current pixel density</a> be
              <var>selected pixel density</var>.
            </p>
          <li>
            <p>Set the <var>image request</var>'s <a href=#img-req-state id=reacting-to-environment-changes:img-req-state>state</a> to <a href=#img-all id=reacting-to-environment-changes:img-all>completely available</a>.</p>
          <li>
            <p>Add the image to the <a href=#list-of-available-images id=reacting-to-environment-changes:list-of-available-images-2>list of available images</a> using the key <var>key</var>,
              with the <a href=#ignore-higher-layer-caching id=reacting-to-environment-changes:ignore-higher-layer-caching>ignore higher-layer caching</a> flag set.</p>
          <li>
            <p><a href=#upgrade-the-pending-request-to-the-current-request id=reacting-to-environment-changes:upgrade-the-pending-request-to-the-current-request>Upgrade the pending request to the current request</a>.</p>
          <li>
            <p><a href=#prepare-an-image-for-presentation id=reacting-to-environment-changes:prepare-an-image-for-presentation>Prepare <var>image request</var> for
                presentation</a> given the <code id=reacting-to-environment-changes:the-img-element-10><a href=embedded-content.html#the-img-element>img</a></code> element.</p>
          <li>
            <p><a href=https://dom.spec.whatwg.org/#concept-event-fire id=reacting-to-environment-changes:concept-event-fire data-x-internal=concept-event-fire>Fire an event</a> named <code id=reacting-to-environment-changes:event-load><a href=indices.html#event-load>load</a></code> at the <code id=reacting-to-environment-changes:the-img-element-11><a href=embedded-content.html#the-img-element>img</a></code> element.</p>
          </ol>
      </ol>

  


  <h5 id=alt><span class=secno>4.8.4.4</span> Requirements for providing text to act as an alternative for images<a href=#alt class=self-link></a></h5>


  <h6 id=general-guidelines><span class=secno>4.8.4.4.1</span> General guidelines<a href=#general-guidelines class=self-link></a></h6>

  <p>Except where otherwise specified, the <code id=general-guidelines:attr-img-alt><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute must be
    specified and its value must not be empty; the value must be an appropriate replacement for the
    image. The specific requirements for the <code id=general-guidelines:attr-img-alt-2><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute depend on
    what the image is intended to represent, as described in the following sections.</p>

  <p>The most general rule to consider when writing alternative text is the following: <strong>the
      intent is that replacing every image with the text of its <code id=general-guidelines:attr-img-alt-3><a href=embedded-content.html#attr-img-alt>alt</a></code>
      attribute does not change the meaning of the page</strong>.</p>

  <p>So, in general, alternative text can be written by considering what one would have written had
    one not been able to include the image.</p>

  <p>A corollary to this is that the <code id=general-guidelines:attr-img-alt-4><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute's value should
    never contain text that could be considered the image's <em>caption</em>, <em>title</em>, or
    <em>legend</em>. It is supposed to contain replacement text that could be used by users
    <em>instead</em> of the image; it is not meant to supplement the image. The <code id=general-guidelines:attr-title><a href=dom.html#attr-title>title</a></code> attribute can be used for supplemental information.
  </p>

  <p>Another corollary is that the <code id=general-guidelines:attr-img-alt-5><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute's value should
    not repeat information that is already provided in the prose next to the image.</p>

  <p class=note>One way to think of alternative text is to think about how you would read the page
    containing the image to someone over the phone, without mentioning that there is an image present.
    Whatever you say instead of the image is typically a good start for writing the alternative
    text.</p>


  <h6 id=a-link-or-button-containing-nothing-but-the-image><span class=secno>4.8.4.4.2</span> A link or button containing nothing but the image<a href=#a-link-or-button-containing-nothing-but-the-image class=self-link></a></h6>

  <p>When an <code id=a-link-or-button-containing-nothing-but-the-image:the-a-element><a href=text-level-semantics.html#the-a-element>a</a></code> element that creates a <a id=a-link-or-button-containing-nothing-but-the-image:hyperlink href=links.html#hyperlink>hyperlink</a>, or a <code id=a-link-or-button-containing-nothing-but-the-image:the-button-element><a href=form-elements.html#the-button-element>button</a></code>
    element, has no textual content but contains one or more images, the <code id=a-link-or-button-containing-nothing-but-the-image:attr-img-alt><a href=embedded-content.html#attr-img-alt>alt</a></code> attributes must contain text that together convey the purpose of
    the link or button.</p>

  <div class=example>

    <p>In this example, a user is asked to pick their preferred color from a list of three. Each color
      is given by an image, but for users who have configured their user agent not to display images,
      the color names are used instead:</p>

    <pre><code class=html>&lt;h1>Pick your color&lt;/h1>
&lt;ul>
 &lt;li>&lt;a href="green.html"><strong>&lt;img src="green.jpeg" alt="Green"></strong>&lt;/a>&lt;/li>
 &lt;li>&lt;a href="blue.html"><strong>&lt;img src="blue.jpeg" alt="Blue"></strong>&lt;/a>&lt;/li>
 &lt;li>&lt;a href="red.html"><strong>&lt;img src="red.jpeg" alt="Red"></strong>&lt;/a>&lt;/li>
&lt;/ul></code></pre>

  </div>

  <div class=example>

    <p>In this example, each button has a set of images to indicate the kind of color output desired
      by the user. The first image is used in each case to give the alternative text.</p>

    <pre><code class=html>&lt;button name="rgb"><strong>&lt;img src="red" alt="RGB">&lt;img src="green" alt="">&lt;img src="blue" alt=""></strong>&lt;/button>
&lt;button name="cmyk"><strong>&lt;img src="cyan" alt="CMYK">&lt;img src="magenta" alt="">&lt;img src="yellow" alt="">&lt;img src="black" alt=""></strong>&lt;/button></code></pre>

    <p>Since each image represents one part of the text, it could also be written like this:</p>

    <pre><code class=html>&lt;button name="rgb"><strong>&lt;img src="red" alt="R">&lt;img src="green" alt="G">&lt;img src="blue" alt="B"></strong>&lt;/button>
&lt;button name="cmyk"><strong>&lt;img src="cyan" alt="C">&lt;img src="magenta" alt="M">&lt;img src="yellow" alt="Y">&lt;img src="black" alt="K"></strong>&lt;/button></code></pre>

    <p>However, with other alternative text, this might not work, and putting all the alternative
      text into one image in each case might make more sense:</p>

    <pre><code class=html>&lt;button name="rgb"><strong>&lt;img src="red" alt="sRGB profile">&lt;img src="green" alt="">&lt;img src="blue" alt=""></strong>&lt;/button>
&lt;button name="cmyk"><strong>&lt;img src="cyan" alt="CMYK profile">&lt;img src="magenta" alt="">&lt;img src="yellow" alt="">&lt;img src="black" alt=""></strong>&lt;/button></code></pre>

  </div>



  <h6 id=a-phrase-or-paragraph-with-an-alternative-graphical-representation:-charts,-diagrams,-graphs,-maps,-illustrations><span class=secno>4.8.4.4.3</span> A phrase or paragraph with an alternative graphical representation: charts, diagrams, graphs, maps, illustrations<a href=#a-phrase-or-paragraph-with-an-alternative-graphical-representation:-charts,-diagrams,-graphs,-maps,-illustrations class=self-link></a></h6>

  <p>Sometimes something can be more clearly stated in graphical form, for example as a flowchart, a
    diagram, a graph, or a simple map showing directions. In such cases, an image can be given using
    the <code id=a-phrase-or-paragraph-with-an-alternative-graphical-representation:-charts,-diagrams,-graphs,-maps,-illustrations:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> element, but the lesser textual version must still be given, so that users
    who are unable to view the image (e.g. because they have a very slow connection, or because they
    are using a text-only browser, or because they are listening to the page being read out by a
    hands-free automobile voice web browser, or simply because they are blind) are still able to
    understand the message being conveyed.</p>

  <p>The text must be given in the <code id=a-phrase-or-paragraph-with-an-alternative-graphical-representation:-charts,-diagrams,-graphs,-maps,-illustrations:attr-img-alt><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute, and must convey
    the same message as the image specified in the <code id=a-phrase-or-paragraph-with-an-alternative-graphical-representation:-charts,-diagrams,-graphs,-maps,-illustrations:attr-img-src><a href=embedded-content.html#attr-img-src>src</a></code>
    attribute.</p>

  <p>It is important to realize that the alternative text is a <em>replacement</em> for the image,
    not a description of the image.</p>

  <div class=example>

    <p>In the following example we have <a href=/images/parsing-model-overview.svg>a flowchart</a>
      in image form, with text in the <code id=a-phrase-or-paragraph-with-an-alternative-graphical-representation:-charts,-diagrams,-graphs,-maps,-illustrations:attr-img-alt-2><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute rephrasing the
      flowchart in prose form:</p>

    <pre><code class=html>&lt;p>In the common case, the data handled by the tokenization stage
comes from the network, but it can also come from script.&lt;/p>
&lt;p><strong>&lt;img src="images/parsing-model-overview.svg" alt="The Network
passes data to the Input Stream Preprocessor, which passes it to the
Tokenizer, which passes it to the Tree Construction stage. From there,
data goes to both the DOM and to Script Execution. Script Execution is
linked to the DOM, and, using document.write(), passes data to the
Tokenizer."></strong>&lt;/p></code></pre>

  </div>

  <div class=example>

    <p>Here's another example, showing a good solution and a bad solution to the problem of including
      an image in a description.</p>

    <p>First, here's the good solution. This sample shows how the alternative text should just be
      what you would have put in the prose if the image had never existed.</p>

    <pre><code class=html>&lt;!-- This is the correct way to do things. -->
&lt;p>
 You are standing in an open field west of a house.
 <strong>&lt;img src="house.jpeg" alt="The house is white, with a boarded front door."></strong>
 There is a small mailbox here.
&lt;/p></code></pre>

    <p>Second, here's the bad solution. In this incorrect way of doing things, the alternative text
      is simply a description of the image, instead of a textual replacement for the image. It's bad
      because when the image isn't shown, the text doesn't flow as well as in the first example.</p>

    <pre class=bad><code class=html>&lt;!-- <em>This is the wrong way to do things.</em> -->
&lt;p>
 You are standing in an open field west of a house.
 &lt;img src="house.jpeg" alt="A white house, with a boarded front door.">
 There is a small mailbox here.
&lt;/p></code></pre>

    <p>Text such as "Photo of white house with boarded door" would be equally bad alternative text
      (though it could be suitable for the <code id=a-phrase-or-paragraph-with-an-alternative-graphical-representation:-charts,-diagrams,-graphs,-maps,-illustrations:attr-title><a href=dom.html#attr-title>title</a></code> attribute or in the
      <code id=a-phrase-or-paragraph-with-an-alternative-graphical-representation:-charts,-diagrams,-graphs,-maps,-illustrations:the-figcaption-element><a href=grouping-content.html#the-figcaption-element>figcaption</a></code> element of a <code id=a-phrase-or-paragraph-with-an-alternative-graphical-representation:-charts,-diagrams,-graphs,-maps,-illustrations:the-figure-element><a href=grouping-content.html#the-figure-element>figure</a></code> with this image).
    </p>

  </div>


  <h6 id=a-short-phrase-or-label-with-an-alternative-graphical-representation:-icons,-logos><span class=secno>4.8.4.4.4</span> A short phrase or label with an alternative graphical representation: icons, logos<a href=#a-short-phrase-or-label-with-an-alternative-graphical-representation:-icons,-logos class=self-link></a></h6>

  <p>A document can contain information in iconic form. The icon is intended to help users of visual
    browsers to recognize features at a glance.</p>

  <p>In some cases, the icon is supplemental to a text label conveying the same meaning. In those
    cases, the <code id=a-short-phrase-or-label-with-an-alternative-graphical-representation:-icons,-logos:attr-img-alt><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute must be present but must be empty.</p>

  <div class=example>

    <p>Here the icons are next to text that conveys the same meaning, so they have an empty <code id=a-short-phrase-or-label-with-an-alternative-graphical-representation:-icons,-logos:attr-img-alt-2><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute:</p>

    <pre><code class=html>&lt;nav>
 &lt;p>&lt;a href="/help/"><strong>&lt;img src="/icons/help.png" alt=""></strong> Help&lt;/a>&lt;/p>
 &lt;p>&lt;a href="/configure/"><strong>&lt;img src="/icons/configuration.png" alt=""></strong>
 Configuration Tools&lt;/a>&lt;/p>
&lt;/nav></code></pre>

  </div>

  <p>In other cases, the icon has no text next to it describing what it means; the icon is supposed
    to be self-explanatory. In those cases, an equivalent textual label must be given in the <code id=a-short-phrase-or-label-with-an-alternative-graphical-representation:-icons,-logos:attr-img-alt-3><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute.</p>

  <div class=example>

    <p>Here, posts on a news site are labeled with an icon indicating their topic.</p>

    <pre><code class=html>&lt;body>
 &lt;article>
  &lt;header>
   &lt;h1>Ratatouille wins &lt;i>Best Movie of the Year&lt;/i> award&lt;/h1>
   &lt;p><strong>&lt;img src="movies.png" alt="Movies"></strong>&lt;/p>
  &lt;/header>
  &lt;p>Pixar has won yet another &lt;i>Best Movie of the Year&lt;/i> award,
  making this its 8th win in the last 12 years.&lt;/p>
 &lt;/article>
 &lt;article>
  &lt;header>
   &lt;h1>Latest TWiT episode is online&lt;/h1>
   &lt;p><strong>&lt;img src="podcasts.png" alt="Podcasts"></strong>&lt;/p>
  &lt;/header>
  &lt;p>The latest TWiT episode has been posted, in which we hear
  several tech news stories as well as learning much more about the
  iPhone. This week, the panelists compare how reflective their
  iPhones' Apple logos are.&lt;/p>
 &lt;/article>
&lt;/body></code></pre>

  </div>

  <p>Many pages include logos, insignia, flags, or emblems, which stand for a particular entity such
    as a company, organization, project, band, software package, country, or some such.</p>

  <p>If the logo is being used to represent the entity, e.g. as a page heading, the <code id=a-short-phrase-or-label-with-an-alternative-graphical-representation:-icons,-logos:attr-img-alt-4><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute must contain the name of the entity being represented by
    the logo. The <code id=a-short-phrase-or-label-with-an-alternative-graphical-representation:-icons,-logos:attr-img-alt-5><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute must <em>not</em> contain text like
    the word "logo", as it is not the fact that it is a logo that is being conveyed, it's the entity
    itself.</p>

  <p>If the logo is being used next to the name of the entity that it represents, then the logo is
    supplemental, and its <code id=a-short-phrase-or-label-with-an-alternative-graphical-representation:-icons,-logos:attr-img-alt-6><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute must instead be empty.</p>

  <p>If the logo is merely used as decorative material (as branding, or, for example, as a side
    image in an article that mentions the entity to which the logo belongs), then the entry below on
    purely decorative images applies. If the logo is actually being discussed, then it is being used
    as a phrase or paragraph (the description of the logo) with an alternative graphical
    representation (the logo itself), and the first entry above applies.</p>

  <div class=example>

    <p>In the following snippets, all four of the above cases are present. First, we see a logo used
      to represent a company:</p>

    <pre><code class=html>&lt;h1><strong>&lt;img src="XYZ.gif" alt="The XYZ company"></strong>&lt;/h1></code></pre>

    <p>Next, we see a paragraph which uses a logo right next to the company name, and so doesn't have
      any alternative text:

    <pre><code class=html>&lt;article>
 &lt;h2>News&lt;/h2>
 &lt;p>We have recently been looking at buying the <strong>&lt;img src="alpha.gif"
 alt=""> ΑΒΓ company</strong>, a small Greek company
 specializing in our type of product.&lt;/p></code></pre>

    <p>In this third snippet, we have a logo being used in an aside, as part of the larger article
      discussing the acquisition:</p>

    <pre><code class=html><strong>&lt;aside>&lt;p>&lt;img src="alpha-large.gif" alt="">&lt;/p>&lt;/aside></strong>
 &lt;p>The ΑΒΓ company has had a good quarter, and our
 pie chart studies of their accounts suggest a much bigger blue slice
 than its green and orange slices, which is always a good sign.&lt;/p>
&lt;/article></code></pre>

    <p>Finally, we have an opinion piece talking about a logo, and the logo is therefore described in
      detail in the alternative text.</p>

    <pre><code class=html>&lt;p>Consider for a moment their logo:&lt;/p>

<strong>&lt;p>&lt;img src="/images/logo" alt="It consists of a green circle with a
green question mark centered inside it.">&lt;/p></strong>

&lt;p>How unoriginal can you get? I mean, oooooh, a question mark, how
&lt;em>revolutionary&lt;/em>, how utterly &lt;em>ground-breaking&lt;/em>, I'm
sure everyone will rush to adopt those specifications now! They could
at least have tried for some sort of, I don't know, sequence of
rounded squares with varying shades of green and bold white outlines,
at least that would look good on the cover of a blue book.&lt;/p></code></pre>

    <p>This example shows how the alternative text should be written such that if the image isn't <i id=a-short-phrase-or-label-with-an-alternative-graphical-representation:-icons,-logos:img-available><a href=#img-available>available</a></i>, and the text is used instead, the text flows seamlessly into
      the surrounding text, as if the image had never been there in the first place.</p>

  </div>


  <h6 id=text-that-has-been-rendered-to-a-graphic-for-typographical-effect><span class=secno>4.8.4.4.5</span> Text that has been rendered to a graphic for typographical effect<a href=#text-that-has-been-rendered-to-a-graphic-for-typographical-effect class=self-link></a></h6>

  <p>Sometimes, an image just consists of text, and the purpose of the image is not to highlight the
    actual typographic effects used to render the text, but just to convey the text itself.</p>

  <p>In such cases, the <code id=text-that-has-been-rendered-to-a-graphic-for-typographical-effect:attr-img-alt><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute must be present but must
    consist of the same text as written in the image itself.</p>

  <div class=example>

    <p>Consider a graphic containing the text "Earth Day", but with the letters all decorated with
      flowers and plants. If the text is merely being used as a heading, to spice up the page for
      graphical users, then the correct alternative text is just the same text "Earth Day", and no
      mention need be made of the decorations:</p>

    <pre><code class=html>&lt;h1><strong>&lt;img src="earthdayheading.png" alt="Earth Day"></strong>&lt;/h1></code></pre>

  </div>

  <div class=example>

    <p>An illuminated manuscript might use graphics for some of its images. The alternative text in
      such a situation is just the character that the image represents.</p>

    <pre><code class=html>&lt;p>&lt;img src="initials/o.svg" alt="O">nce upon a time and a long long time ago, late at
night, when it was dark, over the hills, through the woods, across a great ocean, in a land far
away, in a small house, on a hill, under a full moon...</code></pre> 

  </div>

  <p>When an image is used to represent a character that cannot otherwise be represented in Unicode,
    for example gaiji, itaiji, or new characters such as novel currency symbols, the alternative text
    should be a more conventional way of writing the same thing, e.g. using the phonetic hiragana or
    katakana to give the character's pronunciation.</p>

  <div class=example>

    <p>In this example from 1997, a new-fangled currency symbol that looks like a curly E with two
      bars in the middle instead of one is represented using an image. The alternative text gives the
      character's pronunciation.</p>

    <pre><code class=html>&lt;p>Only &lt;img src="euro.png" alt="euro ">5.99!</code></pre>

  </div>

  <p>An image should not be used if characters would serve an identical purpose. Only when the text
    cannot be directly represented using text, e.g., because of decorations or because there is no
    appropriate character (as in the case of gaiji), would an image be appropriate.</p>

  <p class=note>If an author is tempted to use an image because their default system font does not
    support a given character, then web fonts are a better solution than images.</p>



  <h6 id=a-graphical-representation-of-some-of-the-surrounding-text><span class=secno>4.8.4.4.6</span> A graphical representation of some of the surrounding text<a href=#a-graphical-representation-of-some-of-the-surrounding-text class=self-link></a></h6>

  <p>In many cases, the image is actually just supplementary, and its presence merely reinforces the
    surrounding text. In these cases, the <code id=a-graphical-representation-of-some-of-the-surrounding-text:attr-img-alt><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute must be
    present but its value must be the empty string.</p>

  <p>In general, an image falls into this category if removing the image doesn't make the page any
    less useful, but including the image makes it a lot easier for users of visual browsers to
    understand the concept.</p>

  <div class=example>

    <p>A flowchart that repeats the previous paragraph in graphical form:</p>

    <pre><code class=html>&lt;p>The Network passes data to the Input Stream Preprocessor, which
passes it to the Tokenizer, which passes it to the Tree Construction
stage. From there, data goes to both the DOM and to Script Execution.
Script Execution is linked to the DOM, and, using document.write(),
passes data to the Tokenizer.&lt;/p>
<strong>&lt;p>&lt;img src="images/parsing-model-overview.svg" alt="">&lt;/p></strong></code></pre>

    <p>In these cases, it would be wrong to include alternative text that consists of just a caption.
      If a caption is to be included, then either the <code id=a-graphical-representation-of-some-of-the-surrounding-text:attr-title><a href=dom.html#attr-title>title</a></code> attribute
      can be used, or the <code id=a-graphical-representation-of-some-of-the-surrounding-text:the-figure-element><a href=grouping-content.html#the-figure-element>figure</a></code> and <code id=a-graphical-representation-of-some-of-the-surrounding-text:the-figcaption-element><a href=grouping-content.html#the-figcaption-element>figcaption</a></code> elements can be used. In the
      latter case, the image would in fact be a phrase or paragraph with an alternative graphical
      representation, and would thus require alternative text.</p>

    <pre><code class=html>&lt;!-- Using the title="" attribute -->
&lt;p>The Network passes data to the Input Stream Preprocessor, which
passes it to the Tokenizer, which passes it to the Tree Construction
stage. From there, data goes to both the DOM and to Script Execution.
Script Execution is linked to the DOM, and, using document.write(),
passes data to the Tokenizer.&lt;/p>
&lt;p><strong>&lt;img src="images/parsing-model-overview.svg" alt=""
        title="Flowchart representation of the parsing model."></strong>&lt;/p></code></pre>

    <pre><code class=html>&lt;!-- Using &lt;figure> and &lt;figcaption> -->
&lt;p>The Network passes data to the Input Stream Preprocessor, which
passes it to the Tokenizer, which passes it to the Tree Construction
stage. From there, data goes to both the DOM and to Script Execution.
Script Execution is linked to the DOM, and, using document.write(),
passes data to the Tokenizer.&lt;/p>
&lt;figure>
 <strong>&lt;img src="images/parsing-model-overview.svg" alt="The Network leads to
 the Input Stream Preprocessor, which leads to the Tokenizer, which
 leads to the Tree Construction stage. The Tree Construction stage
 leads to two items. The first is Script Execution, which leads via
 document.write() back to the Tokenizer. The second item from which
 Tree Construction leads is the DOM. The DOM is related to the Script
 Execution."></strong>
 &lt;figcaption>Flowchart representation of the parsing model.&lt;/figcaption>
&lt;/figure></code></pre>

    <pre class=bad><code class=html>&lt;!-- This is WRONG. Do not do this. Instead, do what the above examples do. -->
&lt;p>The Network passes data to the Input Stream Preprocessor, which
passes it to the Tokenizer, which passes it to the Tree Construction
stage. From there, data goes to both the DOM and to Script Execution.
Script Execution is linked to the DOM, and, using document.write(),
passes data to the Tokenizer.&lt;/p>
&lt;p>&lt;img src="images/parsing-model-overview.svg"
        alt="Flowchart representation of the parsing model.">&lt;/p>
&lt;!-- Never put the image's caption in the alt="" attribute! --></code></pre>

  </div>

  <div class=example>

    <p>A graph that repeats the previous paragraph in graphical form:</p>

    <pre><code class=html>&lt;p>According to a study covering several billion pages,
about 62% of documents on the web in 2007 triggered the Quirks
rendering mode of web browsers, about 30% triggered the Almost
Standards mode, and about 9% triggered the Standards mode.&lt;/p>
<strong>&lt;p>&lt;img src="rendering-mode-pie-chart.png" alt="">&lt;/p></strong></code></pre>

  </div>



  <h6 id=ancillary-images><span class=secno>4.8.4.4.7</span> Ancillary images<a href=#ancillary-images class=self-link></a></h6>

  <p>Sometimes, an image is not critical to the content, but is nonetheless neither purely
    decorative nor entirely redundant with the text. In these cases, the <code id=ancillary-images:attr-img-alt><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute must be present, and its value should either be the
    empty string, or a textual representation of the information that the image conveys. If the image
    has a caption giving the image's title, then the <code id=ancillary-images:attr-img-alt-2><a href=embedded-content.html#attr-img-alt>alt</a></code>
    attribute's value must not be empty (as that would be quite confusing for non-visual readers).</p>

  <div class=example>

    <p>Consider a news article about a political figure, in which the individual's face was shown in
      an image. The image is not purely decorative, as it is relevant to the story. The image is not
      entirely redundant with the story either, as it shows what the politician looks like. Whether
      any alternative text need be provided is an authoring decision, decided by whether the image
      influences the interpretation of the prose.</p>

    <p>In this first variant, the image is shown without context, and no alternative text is
      provided:</p>

    <pre><code class=html>&lt;p><strong>&lt;img src="president.jpeg" alt=""></strong> Ahead of today's referendum,
the President wrote an open letter to all registered voters. In it, she admitted that the country was
divided.&lt;/p></code></pre>

    <p>If the picture is just a face, there might be no value in describing it. It's of no interest
      to the reader whether the individual has red hair or blond hair, whether the individual has white
      skin or black skin, whether the individual has one eye or two eyes.</p>

    <p>However, if the picture is more dynamic, for instance showing the politician as angry, or
      particularly happy, or devastated, some alternative text would be useful in setting the tone of
      the article, a tone that might otherwise be missed:</p>

    <pre><code class=html>&lt;p><strong>&lt;img src="president.jpeg" alt="The President is sad."></strong>
Ahead of today's referendum, the President wrote an open letter to all
registered voters. In it, she admitted that the country was divided.
&lt;/p></code></pre>

    <pre><code class=html>&lt;p><strong>&lt;img src="president.jpeg" alt="The President is happy!"></strong>
Ahead of today's referendum, the President wrote an open letter to all
registered voters. In it, she admitted that the country was divided.
&lt;/p></code></pre>

    <p>Whether the individual was "sad" or "happy" makes a difference to how the rest of the
      paragraph is to be interpreted: is she likely saying that she is unhappy with the country
      being divided, or is she saying that the prospect of a divided country is good for her
      political career? The interpretation varies based on the image.</p>

  </div>

  <div class=example>

    <p>If the image has a caption, then including alternative text avoids leaving the non-visual user
      confused as to what the caption refers to.</p>

    <pre><code class=html>&lt;p>Ahead of today's referendum, the President wrote an open letter to
all registered voters. In it, she admitted that the country was divided.&lt;/p>
<strong>&lt;figure>
 &lt;img src="president.jpeg"
      alt="A high forehead, cheerful disposition, and dark hair round out the President's face.">
 &lt;figcaption> The President of Ruritania. Photo © 2014 PolitiPhoto. &lt;/figcaption>
&lt;/figure></strong></code></pre>

  </div>



  <h6 id="a-purely-decorative-image-that-doesn't-add-any-information"><span class=secno>4.8.4.4.8</span> A purely decorative image that doesn't add any information<a href="#a-purely-decorative-image-that-doesn't-add-any-information" class=self-link></a></h6>

  <p>If an image is decorative but isn't especially page-specific — for example an image that
    forms part of a site-wide design scheme — the image should be specified in the site's CSS,
    not in the markup of the document.</p>

  <p>However, a decorative image that isn't discussed by the surrounding text but still has some
    relevance can be included in a page using the <code id="a-purely-decorative-image-that-doesn't-add-any-information:the-img-element"><a href=embedded-content.html#the-img-element>img</a></code> element. Such images are
    decorative, but still form part of the content. In these cases, the <code id="a-purely-decorative-image-that-doesn't-add-any-information:attr-img-alt"><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute must be present but its value must be the empty
    string.</p>

  <div class=example>

    <p>Examples where the image is purely decorative despite being relevant would include things like
      a photo of the Black Rock City landscape in a blog post about an event at Burning Man, or an
      image of a painting inspired by a poem, on a page reciting that poem. The following snippet shows
      an example of the latter case (only the first verse is included in this snippet):</p>

    <pre><code class=html>&lt;h1>The Lady of Shalott&lt;/h1>
<strong>&lt;p>&lt;img src="shalott.jpeg" alt="">&lt;/p></strong>
&lt;p>On either side the river lie&lt;br>
Long fields of barley and of rye,&lt;br>
That clothe the wold and meet the sky;&lt;br>
And through the field the road run by&lt;br>
To many-tower'd Camelot;&lt;br>
And up and down the people go,&lt;br>
Gazing where the lilies blow&lt;br>
Round an island there below,&lt;br>
The island of Shalott.&lt;/p></code></pre>

  </div>


  <h6 id=a-group-of-images-that-form-a-single-larger-picture-with-no-links><span class=secno>4.8.4.4.9</span> A group of images that form a single larger picture with no links<a href=#a-group-of-images-that-form-a-single-larger-picture-with-no-links class=self-link></a></h6>

  <p>When a picture has been sliced into smaller image files that are then displayed together to
    form the complete picture again, one of the images must have its <code id=a-group-of-images-that-form-a-single-larger-picture-with-no-links:attr-img-alt><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute set as per the relevant rules that would be appropriate
    for the picture as a whole, and then all the remaining images must have their <code id=a-group-of-images-that-form-a-single-larger-picture-with-no-links:attr-img-alt-2><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute set to the empty string.</p>

  <div class=example>

    <p>In the following example, a picture representing a company logo for <span>XYZ
        Corp</span> has been split into two pieces, the first containing the letters "XYZ" and the second
      with the word "Corp". The alternative text ("XYZ Corp") is all in the first image.</p>

    <pre><code class=html>&lt;h1><strong>&lt;img src="logo1.png" alt="XYZ Corp">&lt;img src="logo2.png" alt=""></strong>&lt;/h1></code></pre>

  </div>

  <div class=example>

    <p>In the following example, a rating is shown as three filled stars and two empty stars. While
      the alternative text could have been "★★★☆☆", the author has
      instead decided to more helpfully give the rating in the form "3 out of 5". That is the
      alternative text of the first image, and the rest have blank alternative text.</p>

    <pre><code class=html>&lt;p>Rating: &lt;meter max=5 value=3><strong>&lt;img src="1" alt="3 out of 5"
  >&lt;img src="1" alt="">&lt;img src="1" alt="">&lt;img src="0" alt=""
  >&lt;img src="0" alt=""></strong>&lt;/meter>&lt;/p></code></pre>

  </div>



  <h6 id=a-group-of-images-that-form-a-single-larger-picture-with-links><span class=secno>4.8.4.4.10</span> A group of images that form a single larger picture with links<a href=#a-group-of-images-that-form-a-single-larger-picture-with-links class=self-link></a></h6>

  <p>Generally, <a href=image-maps.html#image-map id=a-group-of-images-that-form-a-single-larger-picture-with-links:image-map>image maps</a> should be used instead of slicing an image
    for links.</p>

  <p>However, if an image is indeed sliced and any of the components of the sliced picture are the
    sole contents of links, then one image per link must have alternative text in its <code id=a-group-of-images-that-form-a-single-larger-picture-with-links:attr-img-alt><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute representing the purpose of the link.</p>

  <div class=example>

    <p>In the following example, a picture representing the flying spaghetti monster emblem, with
      each of the left noodly appendages and the right noodly appendages in different images, so that
      the user can pick the left side or the right side in an adventure.</p>

    <pre><code class=html>&lt;h1>The Church&lt;/h1>
&lt;p>You come across a flying spaghetti monster. Which side of His
Noodliness do you wish to reach out for?&lt;/p>
<strong>&lt;p>&lt;a href="?go=left" >&lt;img src="fsm-left.png"  alt="Left side. ">&lt;/a
  >&lt;img src="fsm-middle.png" alt=""
  >&lt;a href="?go=right">&lt;img src="fsm-right.png" alt="Right side.">&lt;/a>&lt;/p></strong></code></pre>

  </div>



  <h6 id=a-key-part-of-the-content><span class=secno>4.8.4.4.11</span> A key part of the content<a href=#a-key-part-of-the-content class=self-link></a></h6>

  <p>In some cases, the image is a critical part of the content. This could be the case, for
    instance, on a page that is part of a photo gallery. The image is the whole <em>point</em> of the
    page containing it.</p>

  <p>How to provide alternative text for an image that is a key part of the content depends on the
    image's provenance.</p>

  <dl><dt>The general case<dd>
      <p>When it is possible for detailed alternative text to be provided, for example if the image is
        part of a series of screenshots in a magazine review, or part of a comic strip, or is a
        photograph in a blog entry about that photograph, text that can serve as a substitute for the
        image must be given as the contents of the <code id=a-key-part-of-the-content:attr-img-alt><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute.</p>

      <div class=example>

        <p>A screenshot in a gallery of screenshots for a new OS, with some alternative text:</p>

        <pre><code class=html>&lt;figure>
 <strong>&lt;img src="KDE%20Light%20desktop.png"
      alt="The desktop is blue, with icons along the left hand side in
           two columns, reading System, Home, K-Mail, etc. A window is
           open showing that menus wrap to a second line if they
           cannot fit in the window. The window has a list of icons
           along the top, with an address bar below it, a list of
           icons for tabs along the left edge, a status bar on the
           bottom, and two panes in the middle. The desktop has a bar
           at the bottom of the screen with a few buttons, a pager, a
           list of open applications, and a clock."></strong>
 &lt;figcaption>Screenshot of a KDE desktop.&lt;/figcaption>
&lt;/figure></code></pre>

      </div>

      <div class=example>

        <p>A graph in a financial report:</p>

        <pre><code class=html><strong>&lt;img src="sales.gif"
     title="Sales graph"
     alt="From 1998 to 2005, sales increased by the following percentages
     with each year: 624%, 75%, 138%, 40%, 35%, 9%, 21%"></strong></code></pre>

        <p>Note that "sales graph" would be inadequate alternative text for a sales graph. Text that
          would be a good <em>caption</em> is not generally suitable as replacement text.</p>

      </div>
    <dt>Images that defy a complete description<dd>
      <p>In certain cases, the nature of the image might be such that providing thorough alternative
        text is impractical. For example, the image could be indistinct, or could be a complex fractal,
        or could be a detailed topographical map.</p>

      <p>In these cases, the <code id=a-key-part-of-the-content:attr-img-alt-2><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute must contain some
        suitable alternative text, but it may be somewhat brief.</p>

      <div class=example>

        <p>Sometimes there simply is no text that can do justice to an image. For example, there is
          little that can be said to usefully describe a Rorschach inkblot test. However, a description,
          even if brief, is still better than nothing:</p>

        <pre><code class=html>&lt;figure>
 <strong>&lt;img src="/commons/a/a7/Rorschach1.jpg" alt="A shape with left-right
 symmetry with indistinct edges, with a small gap in the center, two
 larger gaps offset slightly from the center, with two similar gaps
 under them. The outline is wider in the top half than the bottom
 half, with the sides extending upwards higher than the center, and
 the center extending below the sides."></strong>
 &lt;figcaption>A black outline of the first of the ten cards
 in the Rorschach inkblot test.&lt;/figcaption>
&lt;/figure></code></pre>

        <p>Note that the following would be a very bad use of alternative text:</p>

        <pre class=bad><code class=html>&lt;!-- This example is wrong. Do not copy it. -->
&lt;figure>
 &lt;img src="/commons/a/a7/Rorschach1.jpg" alt="A black outline
 of the first of the ten cards in the Rorschach inkblot test.">
 &lt;figcaption>A black outline of the first of the ten cards
 in the Rorschach inkblot test.&lt;/figcaption>
&lt;/figure></code></pre>

        <p>Including the caption in the alternative text like this isn't useful because it effectively
          duplicates the caption for users who don't have images, taunting them twice yet not helping
          them any more than if they had only read or heard the caption once.</p>

      </div>

      <div class=example>

        <p>Another example of an image that defies full description is a fractal, which, by definition,
          is infinite in detail.</p>

        <p>The following example shows one possible way of providing alternative text for the full view
          of an image of the Mandelbrot set.</p>

        <pre><code class=html><strong>&lt;img src="ms1.jpeg" alt="The Mandelbrot set appears as a cardioid with
its cusp on the real axis in the positive direction, with a smaller
bulb aligned along the same center line, touching it in the negative
direction, and with these two shapes being surrounded by smaller bulbs
of various sizes."></strong></code></pre>

      </div>

      <div class=example>

        <p>Similarly, a photograph of a person's face, for example in a biography, can be considered
          quite relevant and key to the content, but it can be hard to fully substitute text for:</p>

        <pre><code class=html>&lt;section class="bio">
 &lt;h1>A Biography of Isaac Asimov&lt;/h1>
 &lt;p>Born &lt;b>Isaak Yudovich Ozimov&lt;/b> in 1920, Isaac was a prolific author.&lt;/p>
 &lt;p>&lt;img src="headpics/asimov.jpeg" alt="Isaac Asimov had dark hair, a tall forehead, and wore glasses.
 Later in life, he wore long white sideburns.">&lt;/p>
 &lt;p>Asimov was born in Russia, and moved to the US when he was three years old.&lt;/p>
 &lt;p>...&lt;/p>
&lt;/section></code></pre>

        <p>In such cases it is unnecessary (and indeed discouraged) to include a reference to the
          presence of the image itself in the alternative text, since such text would be redundant with
          the browser itself reporting the presence of the image. For example, if the alternative text
          was "A photo of Isaac Asimov", then a conforming user agent might read that out as "(Image) A
          photo of Isaac Asimov" rather than the more useful "(Image) Isaac Asimov had dark hair, a tall
          forehead, and wore glasses...".</p>

      </div>
    <dt id=unknown-images>Images whose contents are not known<dd>
      <p>In some unfortunate cases, there might be no alternative text available at all, either
        because the image is obtained in some automated fashion without any associated alternative text
        (e.g., a webcam), or because the page is being generated by a script using user-provided images
        where the user did not provide suitable or usable alternative text (e.g. photograph sharing
        sites), or because the author does not themself know what the images represent (e.g. a blind
        photographer sharing an image on their blog).</p>

      <p>In such cases, the <code id=a-key-part-of-the-content:attr-img-alt-3><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute may be omitted, but one of
        the following conditions must be met as well:</p>

      <ul><li id=figcaption-as-alt-condition>
          <p>The <code id=a-key-part-of-the-content:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> element is in a
            <code id=a-key-part-of-the-content:the-figure-element><a href=grouping-content.html#the-figure-element>figure</a></code> element that contains a <code id=a-key-part-of-the-content:the-figcaption-element><a href=grouping-content.html#the-figcaption-element>figcaption</a></code> element that contains
            content other than <a id=a-key-part-of-the-content:inter-element-whitespace href=dom.html#inter-element-whitespace>inter-element whitespace</a>, and, ignoring the
            <code id=a-key-part-of-the-content:the-figcaption-element-2><a href=grouping-content.html#the-figcaption-element>figcaption</a></code> element and its descendants, the <code id=a-key-part-of-the-content:the-figure-element-2><a href=grouping-content.html#the-figure-element>figure</a></code> element has no
            <a id=a-key-part-of-the-content:flow-content-2 href=dom.html#flow-content-2>flow content</a> descendants other than <a id=a-key-part-of-the-content:inter-element-whitespace-2 href=dom.html#inter-element-whitespace>inter-element whitespace</a> and the
            <code id=a-key-part-of-the-content:the-img-element-2><a href=embedded-content.html#the-img-element>img</a></code> element.
          </p>
        <li>
          <p>The <code id=a-key-part-of-the-content:attr-title><a href=dom.html#attr-title>title</a></code> attribute is present and has a non-empty
            value.</p>

          
          <p class=note>Relying on the <code id=a-key-part-of-the-content:attr-title-2><a href=dom.html#attr-title>title</a></code> attribute is currently
            discouraged as many user agents do not expose the attribute in an accessible manner as
            required by this specification (e.g. requiring a pointing device such as a mouse to cause a
            tooltip to appear, which excludes keyboard-only users and touch-only users, such as anyone
            with a modern phone or tablet).</p>
        </ul>

      <p class=note>Such cases are to be kept to an absolute minimum. If there is even the slightest
        possibility of the author having the ability to provide real alternative text, then it would not
        be acceptable to omit the <code id=a-key-part-of-the-content:attr-img-alt-4><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute.</p>

      <div class=example>

        <p>A photo on a photo-sharing site, if the site received the image with no metadata other than
          the caption, could be marked up as follows:</p>

        <pre><code class=html>&lt;figure>
 <strong>&lt;img src="1100670787_6a7c664aef.jpg"></strong>
 &lt;figcaption>Bubbles traveled everywhere with us.&lt;/figcaption>
&lt;/figure></code></pre>

        <p>It would be better, however, if a detailed description of the important parts of the image
          obtained from the user and included on the page.</p>

      </div>

      <div class=example>

        <p>A blind user's blog in which a photo taken by the user is shown. Initially, the user might
          not have any idea what the photo they took shows:</p>

        <pre><code class=html>&lt;article>
 &lt;h1>I took a photo&lt;/h1>
 &lt;p>I went out today and took a photo!&lt;/p>
 &lt;figure>
  <strong>&lt;img src="photo2.jpeg"></strong>
  &lt;figcaption>A photograph taken blindly from my front porch.&lt;/figcaption>
 &lt;/figure>
&lt;/article></code></pre>

        <p>Eventually though, the user might obtain a description of the image from their friends and
          could then include alternative text:</p>

        <pre><code class=html>&lt;article>
 &lt;h1>I took a photo&lt;/h1>
 &lt;p>I went out today and took a photo!&lt;/p>
 &lt;figure>
  <strong>&lt;img src="photo2.jpeg" alt="The photograph shows my squirrel
  feeder hanging from the edge of my roof. It is half full, but there
  are no squirrels around. In the background, out-of-focus trees fill the
  shot. The feeder is made of wood with a metal grate, and it contains
  peanuts. The edge of the roof is wooden too, and is painted white
  with light blue streaks."></strong>
  &lt;figcaption>A photograph taken blindly from my front porch.&lt;/figcaption>
 &lt;/figure>
&lt;/article></code></pre>

      </div>

      <div class=example>

        <p>Sometimes the entire point of the image is that a textual description is not available, and
          the user is to provide the description. For instance, the point of a CAPTCHA image is to see if
          the user can literally read the graphic. Here is one way to mark up a CAPTCHA (note the <code id=a-key-part-of-the-content:attr-title-3><a href=dom.html#attr-title>title</a></code> attribute):</p>

        <pre><code class=html>&lt;p>&lt;label>What does this image say?
<strong>&lt;img src="captcha.cgi?id=8934" title="CAPTCHA"></strong>
&lt;input type=text name=captcha>&lt;/label>
(If you cannot see the image, you can use an &lt;a
href="?audio">audio&lt;/a> test instead.)&lt;/p></code></pre>

        <p>Another example would be software that displays images and asks for alternative text
          precisely for the purpose of then writing a page with correct alternative text. Such a page
          could have a table of images, like this:</p>

        <pre><code class=html>&lt;table>
 &lt;thead>
  &lt;tr> &lt;th> Image &lt;th> Description
 &lt;tbody>
  &lt;tr>
   &lt;td> <strong>&lt;img src="2421.png" title="Image 640 by 100, filename 'banner.gif'"></strong>
   &lt;td> &lt;input name="alt2421">
  &lt;tr>
   &lt;td> <strong>&lt;img src="2422.png" title="Image 200 by 480, filename 'ad3.gif'"></strong>
   &lt;td> &lt;input name="alt2422">
&lt;/table></code></pre>

        <p>Notice that even in this example, as much useful information as possible is still included
          in the <code id=a-key-part-of-the-content:attr-title-4><a href=dom.html#attr-title>title</a></code> attribute.</p>

      </div>

      <p class=note>Since some users cannot use images at all (e.g. because they have a very slow
        connection, or because they are using a text-only browser, or because they are listening to the
        page being read out by a hands-free automobile voice web browser, or simply because they are
        blind), the <code id=a-key-part-of-the-content:attr-img-alt-5><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute is only allowed to be omitted rather
        than being provided with replacement text when no alternative text is available and none can be
        made available, as in the above examples. Lack of effort from the part of the author is not an
        acceptable reason for omitting the <code id=a-key-part-of-the-content:attr-img-alt-6><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute.</p>
    </dl>



  <h6 id=an-image-not-intended-for-the-user><span class=secno>4.8.4.4.12</span> An image not intended for the user<a href=#an-image-not-intended-for-the-user class=self-link></a></h6>

  <p>Generally authors should avoid using <code id=an-image-not-intended-for-the-user:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> elements for purposes other than showing
    images.</p>

  <p>If an <code id=an-image-not-intended-for-the-user:the-img-element-2><a href=embedded-content.html#the-img-element>img</a></code> element is being used for purposes other than showing an image, e.g. as
    part of a service to count page views, then the <code id=an-image-not-intended-for-the-user:attr-img-alt><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute
    must be the empty string.</p>

  <p>In such cases, the <code id=an-image-not-intended-for-the-user:attr-dim-width><a href=embedded-content-other.html#attr-dim-width>width</a></code> and <code id=an-image-not-intended-for-the-user:attr-dim-height><a href=embedded-content-other.html#attr-dim-height>height</a></code> attributes should both be set to zero.</p>


  <h6 id=an-image-in-an-e-mail-or-private-document-intended-for-a-specific-person-who-is-known-to-be-able-to-view-images><span class=secno>4.8.4.4.13</span> An image in an email or private document intended for a specific person who is known to be able to view images<a href=#an-image-in-an-e-mail-or-private-document-intended-for-a-specific-person-who-is-known-to-be-able-to-view-images class=self-link></a></h6>

  <p><i>This section does not apply to documents that are publicly accessible, or whose target
      audience is not necessarily personally known to the author, such as documents on a web site,
      emails sent to public mailing lists, or software documentation.</i></p>

  <p>When an image is included in a private communication (such as an HTML email) aimed at a
    specific person who is known to be able to view images, the <code id=an-image-in-an-e-mail-or-private-document-intended-for-a-specific-person-who-is-known-to-be-able-to-view-images:attr-img-alt><a href=embedded-content.html#attr-img-alt>alt</a></code>
    attribute may be omitted. However, even in such cases authors are strongly urged to include
    alternative text (as appropriate according to the kind of image involved, as described in the
    above entries), so that the email is still usable should the user use a mail client that does not
    support images, or should the document be forwarded on to other users whose abilities might not
    include easily seeing images.</p>




  

    <h6 id=guidance-for-markup-generators><span class=secno>4.8.4.4.14</span> Guidance for markup generators<a href=#guidance-for-markup-generators class=self-link></a></h6>

    <p>Markup generators (such as WYSIWYG authoring tools) should, wherever possible, obtain
      alternative text from their users. However, it is recognized that in many cases, this will not be
      possible.</p>

    <p>For images that are the sole contents of links, markup generators should examine the link
      target to determine the title of the target, or the URL of the target, and use information
      obtained in this manner as the alternative text.</p>

    <p>For images that have captions, markup generators should use the <code id=guidance-for-markup-generators:the-figure-element><a href=grouping-content.html#the-figure-element>figure</a></code> and
      <code id=guidance-for-markup-generators:the-figcaption-element><a href=grouping-content.html#the-figcaption-element>figcaption</a></code> elements, or the <code id=guidance-for-markup-generators:attr-title><a href=dom.html#attr-title>title</a></code> attribute, to
      provide the image's caption.
    </p>

    <p>As a last resort, implementers should either set the <code id=guidance-for-markup-generators:attr-img-alt><a href=embedded-content.html#attr-img-alt>alt</a></code>
      attribute to the empty string, under the assumption that the image is a purely decorative image
      that doesn't add any information but is still specific to the surrounding content, or omit the
      <code id=guidance-for-markup-generators:attr-img-alt-2><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute altogether, under the assumption that the image is
      a key part of the content.
    </p>

    <p>Markup generators may specify a <dfn id=attr-img-generator-unable-to-provide-required-alt><code>generator-unable-to-provide-required-alt</code></dfn>
      attribute on <code id=guidance-for-markup-generators:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> elements for which they have been unable to obtain alternative text
      and for which they have therefore omitted the <code id=guidance-for-markup-generators:attr-img-alt-3><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute. The
      value of this attribute must be the empty string. Documents containing such attributes are not
      conforming, but conformance checkers will <a href=#guidance-for-conformance-checkers>silently
        ignore</a> this error.</p>

    <p class=note>This is intended to avoid markup generators from being pressured into replacing
      the error of omitting the <code id=guidance-for-markup-generators:attr-img-alt-4><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute with the even more
      egregious error of providing phony alternative text, because state-of-the-art automated
      conformance checkers cannot distinguish phony alternative text from correct alternative text.</p>

    <p>Markup generators should generally avoid using the image's own filename as the alternative
      text. Similarly, markup generators should avoid generating alternative text from any content that
      will be equally available to presentation user agents (e.g., web browsers).</p>

    <p class=note>This is because once a page is generated, it will typically not be updated,
      whereas the browsers that later read the page can be updated by the user, therefore the browser is
      likely to have more up-to-date and finely-tuned heuristics than the markup generator did when
      generating the page.</p>

  

  

    <h6 id=guidance-for-conformance-checkers><span class=secno>4.8.4.4.15</span> Guidance for conformance checkers<a href=#guidance-for-conformance-checkers class=self-link></a></h6>

    <p>A conformance checker must report the lack of an <code id=guidance-for-conformance-checkers:attr-img-alt><a href=embedded-content.html#attr-img-alt>alt</a></code>
      attribute as an error unless one of the conditions listed below applies:</p>

    <ul><li>
        <p>The <code id=guidance-for-conformance-checkers:the-img-element><a href=embedded-content.html#the-img-element>img</a></code> element is in a <code id=guidance-for-conformance-checkers:the-figure-element><a href=grouping-content.html#the-figure-element>figure</a></code> element that satisfies <a href=#figcaption-as-alt-condition>the conditions described above</a>.</p>
      <li>
        <p>The <code id=guidance-for-conformance-checkers:the-img-element-2><a href=embedded-content.html#the-img-element>img</a></code> element has a <code id=guidance-for-conformance-checkers:attr-title><a href=dom.html#attr-title>title</a></code> attribute with a
          value that is not the empty string (also as <a href=#unknown-images>described
            above</a>).</p>
      <li>
        <p>The conformance checker has been configured to assume that the document is an email or
          document intended for a specific person who is known to be able to view images.</p>
      <li>
        <p>The <code id=guidance-for-conformance-checkers:the-img-element-3><a href=embedded-content.html#the-img-element>img</a></code> element has a (non-conforming) <code id=guidance-for-conformance-checkers:attr-img-generator-unable-to-provide-required-alt><a href=#attr-img-generator-unable-to-provide-required-alt>generator-unable-to-provide-required-alt</a></code>
          attribute whose value is the empty string. A conformance checker that is not reporting the lack
          of an <code id=guidance-for-conformance-checkers:attr-img-alt-2><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute as an error must also not report the
          presence of the empty <code id=guidance-for-conformance-checkers:attr-img-generator-unable-to-provide-required-alt-2><a href=#attr-img-generator-unable-to-provide-required-alt>generator-unable-to-provide-required-alt</a></code>
          attribute as an error. (This case does not represent a case where the document is conforming,
          only that the generator could not determine appropriate alternative text — validators are
          not required to show an error in this case, because such an error might encourage markup
          generators to include bogus alternative text purely in an attempt to silence validators.
          Naturally, conformance checkers <em>may</em> report the lack of an <code id=guidance-for-conformance-checkers:attr-img-alt-3><a href=embedded-content.html#attr-img-alt>alt</a></code> attribute as an error even in the presence of the <code id=guidance-for-conformance-checkers:attr-img-generator-unable-to-provide-required-alt-3><a href=#attr-img-generator-unable-to-provide-required-alt>generator-unable-to-provide-required-alt</a></code>
          attribute; for example, there could be a user option to report <em>all</em> conformance errors
          even those that might be the more or less inevitable result of using a markup
          generator.)</p>
      </ul>

  


  <nav><a href=embedded-content.html>← 4.8 Embedded content</a> — <a href=./>Table of Contents</a> — <a href=iframe-embed-object.html>4.8.5 The
  iframe element →</a></nav>
