<!doctype html>
<html lang="zh-hans">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <meta content="#3c790a" name="theme-color">
    <meta content="light dark" name="color-scheme">
    <title>MIME 嗅探标准</title>
    <link crossorigin href="https://resources.whatwg.org/standard-shared-with-dev.css" rel="stylesheet">
    <link crossorigin href="https://resources.whatwg.org/standard.css" rel="stylesheet">
    <link crossorigin href="https://resources.whatwg.org/spec.css" rel="stylesheet">
    <link crossorigin href="https://resources.whatwg.org/logo-mimesniff.svg" rel="icon">
    <script crossorigin defer src="https://resources.whatwg.org/commit-snapshot-shortcut-key.js"></script>
    <!-- <meta content="Bikeshed version b25686b9f, updated Fri Mar 14 14:15:20 2025 -0700" name="generator">
    <meta content="7460cb44c5751884c1cdd9211717ee6202cfefd6" name="revision"> -->
    <style>
        /* Boilerplate: style-dfn-panel */
        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
            --dfnpanel-target-bg: #ffc;
            --dfnpanel-target-outline: orange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --dfnpanel-bg: #222;
                --dfnpanel-text: var(--text);
                --dfnpanel-target-bg: #333;
                --dfnpanel-target-outline: silver;
            }
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel a:focus {
            outline: 5px auto Highlight;
            outline: 5px auto -webkit-focus-ring-color;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0 0 0 1em;
            list-style: none;
        }

        .dfn-panel li a {
            max-width: calc(300px - 1.5em - 1em);
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: 8px;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
            transition: left 1s ease-out, bottom 1s ease-out;
        }

        .dfn-panel .link-item:hover {
            text-decoration: underline;
        }

        .dfn-panel .link-item .copy-icon {
            opacity: 0;
        }

        .dfn-panel .link-item:hover .copy-icon,
        .dfn-panel .link-item .copy-icon:focus {
            opacity: 1;
        }

        .dfn-panel .copy-icon {
            display: inline-block;
            margin-right: 0.5em;
            width: 0.85em;
            height: 1em;
            border-radius: 3px;
            background-color: #ccc;
            cursor: pointer;
        }

        .dfn-panel .copy-icon .icon {
            width: 100%;
            height: 100%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .dfn-panel .copy-icon .icon::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1px solid black;
            background-color: #ccc;
            opacity: 0.25;
            transform: translate(3px, -3px);
        }

        .dfn-panel .copy-icon:active .icon::before {
            opacity: 1;
        }

        .dfn-paneled[role="button"] {
            cursor: help;
        }

        .highlighted {
            animation: target-fade 3s;
        }

        @keyframes target-fade {
            from {
                background-color: var(--dfnpanel-target-bg);
                outline: 5px solid var(--dfnpanel-target-outline);
            }

            to {
                color: var(--a-normal-text);
                background-color: transparent;
                outline: transparent;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-ref-hints */
        :root {
            --ref-hint-bg: #ddd;
            --ref-hint-text: var(--text);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --ref-hint-bg: #222;
                --ref-hint-text: var(--text);
            }
        }

        .ref-hint {
            display: inline-block;
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.5em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--ref-hint-bg);
            color: var(--ref-hint-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .ref-hint * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .ref-hint ul {
            padding: 0 0 0 1em;
            list-style: none;
        }
    </style>
    <style>
        /* Boilerplate: style-var-click-highlighting */
        /*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)

For darkmode:
0 = oklab(50%   0%  108%)
1 = oklab(50% -51%   51%)
2 = oklab(50% -64%  -20%)
3 = oklab(50%   6%   19%)
4 = oklab(50% -12%  -64%)
5 = oklab(50%  44%  -19%)  
6 = oklab(50% 102%   38%)
*/

        [data-algorithm] var {
            cursor: pointer;
        }

        var[data-var-color] {
            background-color: var(--var-bg);
            box-shadow: 0 0 0 2px var(--var-bg);
        }

        var[data-var-color] {
            --var-bg: #F4D200;
        }

        var[data-var-color="1"] {
            --var-bg: #FF87A2;
        }

        var[data-var-color="2"] {
            --var-bg: #96E885;
        }

        var[data-var-color="3"] {
            --var-bg: #3EEED2;
        }

        var[data-var-color="4"] {
            --var-bg: #EACFB6;
        }

        var[data-var-color="5"] {
            --var-bg: #82DDFF;
        }

        var[data-var-color="6"] {
            --var-vg: #FFBCF2;
        }

        @media (prefers-color-scheme: dark) {
            var[data-var-color] {
                --var-bg: #bc1a00;
            }

            var[data-var-color="1"] {
                --var-bg: #007f00;
            }

            var[data-var-color="2"] {
                --var-bg: #008698;
            }

            var[data-var-color="3"] {
                --var-bg: #7f5b2b;
            }

            var[data-var-color="4"] {
                --var-bg: #004df3;
            }

            var[data-var-color="5"] {
                --var-bg: #a1248a;
            }

            var[data-var-color="6"] {
                --var-vg: #ff0000;
            }
        }
    </style>

<body class="h-entry status-LS">
    <div class="head">
        <a class="logo" href="https://whatwg.org/"> <img alt="WHATWG" class="darkmode-aware" crossorigin height="100"
                src="https://resources.whatwg.org/logo-mimesniff.svg"> </a>
        <hgroup>
            <h1 class="p-name no-ref" id="title">MIME 嗅探</h1>
            <p id="subtitle">Living Standard — 最后更新 <time class="dt-updated" datetime="2025-08-12">2025年8月12日</time>
            </p>
        </hgroup>
        <div data-fill-with="spec-metadata">
            <dl>
                <dt>参与：
                <dd><a href="https://github.com/whatwg/mimesniff">GitHub whatwg/mimesniff</a> (<a
                        href="https://github.com/whatwg/mimesniff/issues/new/choose">新建 issue</a>, <a
                        href="https://github.com/whatwg/mimesniff/issues">打开的 issue</a>)
                <dd><a href="https://whatwg.org/chat">Matrix 聊天</a>
                <dt>提交历史：
                <dd><a href="https://github.com/whatwg/mimesniff/commits">GitHub whatwg/mimesniff/commits</a>
                <dd><a href="https://mimesniff.spec.whatwg.org/commit-snapshots/e7594d531819053508447f688a3bde465531aca5/"
                        id="commit-snapshot-link">此提交的快照</a>
                <dd><a href="https://twitter.com/mimesniff">@mimesniff</a>
                <dt>测试：
                <dd><a href="https://github.com/web-platform-tests/wpt/tree/master/mimesniff">web-platform-tests
                        mimesniff/</a> (<a href="https://github.com/web-platform-tests/wpt/labels/mimesniff">进行中
                        工作</a>)
                <dt>翻译 <small>（非规范性）</small>：
                <dd><span title="Japanese"><a href="https://triple-underscore.github.io/mimesniff-ja.html" hreflang="ja"
                            lang="ja" rel="alternate">日本語</a></span>
                <dd><span title="Simplified Chinese"><a href="https://htmlspecs.com/mimesniff/" hreflang="zh-hans"
                            lang="zh-hans" rel="alternate">简体中文</a></span>
                <dd><span title="Korean"><a href="https://ko.htmlspecs.com/mimesniff/" hreflang="ko" lang="ko"
                            rel="alternate">한국어</a></span>
            </dl>
        </div>
        <div data-fill-with="warning"></div>
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">摘要</span></h2>
        <p>MIME 嗅探标准定义了资源嗅探的规则。</p>
    </div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目录</h2>
        <ol class="toc" role="directory">
            <li><a href="#introduction"><span class="secno">1</span> <span class="content">简介</span></a>
            <li><a href="#conformance-requirements"><span class="secno">2</span> <span class="content">一致性要求</span></a>
            <li><a href="#terminology"><span class="secno">3</span> <span class="content">术语</span></a>
            <li>
                <a href="#understanding-mime-types"><span class="secno">4</span> <span class="content">MIME
                        类型</span></a>
                <ol class="toc">
                    <li><a href="#mime-type-representation"><span class="secno">4.1</span> <span class="content">MIME
                                类型表示</span></a>
                    <li><a href="#mime-type-miscellaneous"><span class="secno">4.2</span> <span class="content">MIME
                                类型杂项</span></a>
                    <li><a href="#mime-type-writing"><span class="secno">4.3</span> <span class="content">MIME
                                类型写入</span></a>
                    <li><a href="#parsing-a-mime-type"><span class="secno">4.4</span> <span class="content">解析 MIME
                                类型</span></a>
                    <li><a href="#serializing-a-mime-type"><span class="secno">4.5</span> <span class="content">序列化 MIME
                                类型</span></a>
                    <li><a href="#mime-type-groups"><span class="secno">4.6</span> <span class="content">MIME
                                类型分组</span></a>
                </ol>
            <li>
                <a href="#handling-a-resource"><span class="secno">5</span> <span class="content">资源处理</span></a>
                <ol class="toc">
                    <li><a href="#interpreting-the-resource-metadata"><span class="secno">5.1</span> <span
                                class="content">资源元数据解释</span></a>
                    <li><a href="#reading-the-resource-header"><span class="secno">5.2</span> <span
                                class="content">读取资源头部</span></a>
                </ol>
            <li>
                <a href="#matching-a-mime-type-pattern"><span class="secno">6</span> <span class="content">匹配 MIME
                        类型模式</span></a>
                <ol class="toc">
                    <li><a href="#matching-an-image-type-pattern"><span class="secno">6.1</span> <span
                                class="content">匹配图像类型模式</span></a>
                    <li>
                        <a href="#matching-an-audio-or-video-type-pattern"><span class="secno">6.2</span> <span
                                class="content">匹配音频或视频类型模式</span></a>
                        <ol class="toc">
                            <li><a href="#signature-for-mp4"><span class="secno">6.2.1</span> <span class="content">MP4
                                        签名</span></a>
                            <li><a href="#signature-for-webm"><span class="secno">6.2.2</span> <span
                                        class="content">WebM 签名</span></a>
                            <li><a href="#signature-for-mp3-without-id3"><span class="secno">6.2.3</span> <span
                                        class="content">无 ID3 的 MP3 签名</span></a>
                        </ol>
                    <li><a href="#matching-a-font-type-pattern"><span class="secno">6.3</span> <span
                                class="content">匹配字体类型模式</span></a>
                    <li><a href="#matching-an-archive-type-pattern"><span class="secno">6.4</span> <span
                                class="content">匹配归档类型模式</span></a>
                </ol>
            <li>
                <a href="#determining-the-computed-mime-type-of-a-resource"><span class="secno">7</span> <span
                        class="content">确定资源的计算 MIME 类型</span></a>
                <ol class="toc">
                    <li><a href="#identifying-a-resource-with-an-unknown-mime-type"><span class="secno">7.1</span> <span
                                class="content">识别未知 MIME 类型的资源</span></a>
                    <li><a href="#sniffing-a-mislabeled-binary-resource"><span class="secno">7.2</span> <span
                                class="content">嗅探标签错误的二进制资源</span></a>
                </ol>
            <li>
                <a href="#context-specific-sniffing"><span class="secno">8</span> <span
                        class="content">上下文相关嗅探</span></a>
                <ol class="toc">
                    <li><a href="#sniffing-in-a-browsing-context"><span class="secno">8.1</span> <span
                                class="content">浏览上下文中的嗅探</span></a>
                    <li><a href="#sniffing-in-an-image-context"><span class="secno">8.2</span> <span
                                class="content">图像上下文中的嗅探</span></a>
                    <li><a href="#sniffing-in-an-audio-or-video-context"><span class="secno">8.3</span> <span
                                class="content">音频或视频上下文中的嗅探</span></a>
                    <li><a href="#sniffing-in-a-plugin-context"><span class="secno">8.4</span> <span
                                class="content">插件上下文中的嗅探</span></a>
                    <li><a href="#sniffing-in-a-style-context"><span class="secno">8.5</span> <span
                                class="content">样式上下文中的嗅探</span></a>
                    <li><a href="#sniffing-in-a-script-context"><span class="secno">8.6</span> <span
                                class="content">脚本上下文中的嗅探</span></a>
                    <li><a href="#sniffing-in-a-font-context"><span class="secno">8.7</span> <span
                                class="content">字体上下文中的嗅探</span></a>
                    <li><a href="#sniffing-in-a-text-track-context"><span class="secno">8.8</span> <span
                                class="content">文本轨道上下文中的嗅探</span></a>
                    <li><a href="#sniffing-in-a-cache-manifest-context"><span class="secno">8.9</span> <span
                                class="content">缓存清单上下文中的嗅探</span></a>
                </ol>
            <li><a href="#acknowledgements"><span class="secno"></span> <span class="content">致谢</span></a>
            <li><a href="#ipr"><span class="secno"></span> <span class="content">知识产权声明</span></a>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本规范定义的术语</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">引用文献中定义的术语</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考文献</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">规范性引用</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">资料性引用</span></a>
                </ol>
        </ol>
    </nav>
    <main>
        <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span
                class="content">简介</span><a class="self-link" href="#introduction"></a></h2>
        <p> HTTP <code>Content-Type</code> 头字段用于指示 HTTP 响应的 MIME 类型。
            但许多 HTTP 服务器提供的 <code>Content-Type</code> 头字段值与实际响应内容并不匹配。
            过去，Web 浏览器为兼容这些服务器，除了检查 <code>Content-Type</code> 头字段之外，还会检查 HTTP 响应内容，以确定实际的 MIME 类型。
        </p>
        <p> 没有明确规范如何 “嗅探（sniff）” MIME 类型，每个用户代理都被迫逆向工程其他用户代理的算法，以保持互操作性。
            这种努力最终并不完全成功，导致了用户代理间行为的差异。
            在某些情况下，这些差异带来了安全隐患，因为用户代理可能会将 HTTP 响应解释为与服务器预期不同的 MIME 类型。
        </p>
        <p> 当 “诚实” 服务器允许潜在恶意用户上传文件，并以低权限 MIME 类型提供这些文件内容时，安全问题最为严重。
            例如，如果服务器认为客户端会将用户上传的文件视为图片（因此是良性的），但用户代理却将其视为 HTML（进而可能执行其中的脚本），攻击者就有可能窃取用户凭据并实施其他跨站脚本攻击。
            （恶意服务器当然可以在 <code>Content-Type</code> 头字段中指定任意 MIME 类型。）
        </p>
        <p> 本文档描述了一种内容嗅探算法，在满足用户代理兼容性需求和现有 Web 内容的安全约束之间做出了平衡。
            该算法起源于 Adam Barth、Juan Caballero 和 Dawn Song 的研究，基于主流用户代理的内容嗅探算法、现有 Web 内容的大型数据库以及在大量用户中部署所收集的度量数据。<a
                data-link-type="biblio" href="#biblio-seccontsniff"
                title="Secure Content Sniffing for Web Browsers, or How to Stop Papers from Reviewing Themselves">[SECCONTSNIFF]</a>
        </p>
        <h2 class="heading settled" data-level="2" id="conformance-requirements"><span class="secno">2. </span><span
                class="content">一致性要求</span><a class="self-link" href="#conformance-requirements"></a></h2>
        <p> 本文档中的关键词 "MUST"、"MUST NOT"、"REQUIRED"、"SHALL"、"SHALL NOT"、"SHOULD"、
            "SHOULD NOT"、"RECOMMENDED"、"NOT RECOMMENDED"、"MAY" 和 "OPTIONAL"，其含义应按 RFC 2119 所述理解。
            为便于阅读，这些关键词通常不会全部大写。 <a data-link-type="biblio" href="#biblio-keywords"
                title="Key words for use in RFCs to Indicate Requirement Levels">[KEYWORDS]</a> </p>
        <p> 作为算法一部分的命令式要求（如 "去除所有前导空格字符" 或 "返回 false 并终止这些步骤"），应结合引入算法时使用的关键词来理解其含义。</p>
        <p> 以算法或具体步骤表述的一致性要求可以通过任何方式实现，只要最终结果等价即可。
            特别需要注意的是，本规范定义的算法旨在易于理解，并不以高性能为目标。
        </p>
        <h2 class="heading settled" data-level="3" id="terminology"><span class="secno">3. </span><span
                class="content">术语</span><a class="self-link" href="#terminology"></a></h2>
        <p> 本规范依赖 Infra 标准。<a data-link-type="biblio" href="#biblio-infra" title="Infra Standard">[INFRA]</a> </p>
        <p>一个 <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="http-token-code-point">HTTP 令牌码点（HTTP token
                code
                point）</dfn> 是 U+0021 (!)、U+0023 (#)、U+0024 ($)、U+0025 (%)、
            U+0026 (&amp;)、U+0027 (')、U+002A (*)、U+002B (+)、U+002D (-)、U+002E (.)、U+005E (^)、U+005F (_)、
            U+0060 (`)、U+007C (|)、U+007E (~)，或一个 <a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#ascii-alphanumeric" id="ref-for-ascii-alphanumeric">ASCII
                字母或数字</a>。
        </p>
        <p class="note" role="note">这与 <a data-link-type="dfn" href="https://www.rfc-editor.org/rfc/rfc9110#name-tokens"
                id="ref-for-name-tokens">token</a> 产生式的值空间一致。
            <a data-link-type="biblio" href="#biblio-http-semantics" title="HTTP Semantics">[HTTP-SEMANTICS]</a>
        </p>
        <p>一个 <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="http-quoted-string-token-code-point">HTTP
                引号字符串令牌码点（quoted-string token code point）</dfn> 是 U+0009 TAB、范围 U+0020 SPACE 到 U+007E (~)（含）、或范围 U+0080
            到 U+00FF (ÿ)（含）的<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#code-point"
                id="ref-for-code-point">码点</a>。 </p>
        <p class="note" role="note">这与 <a data-link-type="dfn"
                href="https://www.rfc-editor.org/rfc/rfc9110#name-quoted-strings"
                id="ref-for-name-quoted-strings">quoted-string</a> 产生式的有效值空间一致。定义上它是 <a data-link-type="dfn"
                href="#http-token-code-point" id="ref-for-http-token-code-point">HTTP 令牌码点</a> 的超集。<a
                data-link-type="biblio" href="#biblio-http-semantics" title="HTTP Semantics">[HTTP-SEMANTICS]</a>
        </p>
        <p>一个 <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="binary-data-byte">二进制数据字节（binary data
                byte）</dfn> 是
            <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte">字节</a>值在 0x00 到
            0x08 (NUL 到 BS) 范围内，或 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                id="ref-for-byte①">字节</a>值为 0x0B (VT)，或字节值在
            0x0E 到 0x1A (SO 到 SUB) 范围内，或字节值在 0x1C 到 0x1F (FS 到 US) 范围内。
        </p>
        <p>一个 <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="whitespace-byte">空白字节（whitespace
                byte）</dfn>
            （缩写为 <abbr data-lt="whitespace byte">0xWS</abbr>）为下列任一 <a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte④">字节</a>：0x09 (HT)、
            0x0A (LF)、0x0C (FF)、0x0D (CR)、0x20 (SP)。
        </p>
        <p>一个 <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="tag-terminating-byte">标签终止字节（tag-terminating
                byte）</dfn>
            （缩写为 <abbr data-lt="tag terminating byte">0xTT</abbr>）为下列任一 <a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte⑤">字节</a>：0x20 (SP)、0x3E
            ("<code>&gt;</code>")。
        </p>
        <p> 本文中的数学运算符采用 <a data-link-type="biblio" href="#biblio-encoding" title="Encoding Standard">[ENCODING]</a>
            中定义的符号。此外，按位非用 ~ 表示。
        </p>
        <h2 class="heading settled" data-level="4" id="understanding-mime-types"><span class="secno">4. </span><span
                class="content">MIME 类型</span><a class="self-link" href="#understanding-mime-types"></a></h2>
        <h3 class="heading settled" data-level="4.1" id="mime-type-representation"><span class="secno">4.1. </span><span
                class="content">MIME 类型表示</span><a class="self-link" href="#mime-type-representation"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="MIME type|MIME type record"
                id="mime-type">MIME 类型</dfn> 表示 <i>互联网媒体类型</i>，定义见 <cite>Multipurpose
                Internet Mail Extensions (MIME) Part Two: Media Types</cite>。也可称为 <a data-link-type="dfn"
                href="#mime-type" id="ref-for-mime-type">MIME 类型记录</a>。<a data-link-type="biblio"
                href="#biblio-mimetype"
                title="Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">[MIMETYPE]</a> </p>
        <p class="note" role="note">标准建议始终使用 <a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①">MIME
                类型</a> 这个术语，以避免与 <cite>Media Queries</cite> 中的 <i>媒体类型</i> 混淆。<a data-link-type="biblio"
                href="#biblio-mediaqueries" title="Media Queries Level 4">[MEDIAQUERIES]</a>
        </p>
        <p><a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②">MIME 类型</a>的 <dfn class="dfn-paneled"
                data-dfn-for="MIME type" data-dfn-type="dfn" data-export id="type">主类型（type）</dfn> 是非空 <a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string">ASCII
                字符串</a>。</p>
        <p><a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type③">MIME 类型</a>的 <dfn class="dfn-paneled"
                data-dfn-for="MIME type" data-dfn-type="dfn" data-export id="subtype">子类型（subtype）</dfn> 是非空 <a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string①">ASCII
                字符串</a>。</p>
        <p><a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type④">MIME 类型</a>的 <dfn class="dfn-paneled"
                data-dfn-for="MIME type" data-dfn-type="dfn" data-export id="parameters">参数（parameters）</dfn> 是一个 <a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map"
                id="ref-for-ordered-map">有序映射（ordered map）</a>，其 <a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#map-getting-the-keys" id="ref-for-map-getting-the-keys">键</a>为 <a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string②">ASCII
                字符串</a>，<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-getting-the-values"
                id="ref-for-map-getting-the-values">值</a>为仅包含 <a data-link-type="dfn"
                href="#http-quoted-string-token-code-point" id="ref-for-http-quoted-string-token-code-point">HTTP
                引号字符串令牌码点</a>的<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string"
                id="ref-for-string">字符串</a>。初始为空。 </p>
        <h3 class="heading settled" data-level="4.2" id="mime-type-miscellaneous"><span class="secno">4.2. </span><span
                class="content">MIME 类型杂项</span><a class="self-link" href="#mime-type-miscellaneous"></a>
        </h3>
        <p><a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type⑤">MIME 类型</a> <var>mimeType</var> 的 <dfn
                class="dfn-paneled" data-dfn-for="MIME type" data-dfn-type="dfn" data-export
                id="mime-type-essence">本质（essence）</dfn> 是 <var>mimeType</var> 的 <a data-link-type="dfn" href="#type"
                id="ref-for-type">type</a>，加上 U+002F (/) 和 <a data-link-type="dfn" href="#subtype"
                id="ref-for-subtype">subtype</a>。
        </p>
        <p><a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type⑥">MIME 类型</a> <dfn class="dfn-paneled"
                data-dfn-type="dfn" data-export id="supported-by-the-user-agent">被用户代理支持</dfn>，指用户代理能够解析该 <a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type⑦">MIME 类型</a> 的<a data-link-type="dfn"
                href="#resource" id="ref-for-resource">资源</a>并将其展示给用户。
        </p>
        <p class="XXX">理想情况应更精确。参见 <a href="https://github.com/w3c/preload/issues/113">w3c/preload #113</a>。</p>
        <div class="algorithm" data-algorithm="minimize a supported MIME type">
            <p>要<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="minimize-a-supported-mime-type">最简化受支持的
                    MIME 类型</dfn>，给定 <a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type⑧">MIME 类型</a>
                <var>mimeType</var>，执行如下步骤，返回 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string"
                    id="ref-for-ascii-string③">ASCII 字符串</a>：
            </p>
            <ol>
                <li>
                    <p>如果 <var>mimeType</var> 是 <a data-link-type="dfn" href="#javascript-mime-type"
                            id="ref-for-javascript-mime-type">JavaScript MIME 类型</a>，则返回 "<code>text/javascript</code>"。
                    </p>
                <li>
                    <p>如果 <var>mimeType</var> 是 <a data-link-type="dfn" href="#json-mime-type"
                            id="ref-for-json-mime-type">JSON MIME 类型</a>，则返回 "<code>application/json</code>"。</p>
                <li>
                    <p>如果 <var>mimeType</var> 的 <a data-link-type="dfn" href="#mime-type-essence"
                            id="ref-for-mime-type-essence">本质</a>为 "<code>image/svg+xml</code>"，则返回
                        "<code>image/svg+xml</code>"。</p>
                    <p class="note" role="note">SVG 区别于其他 <a data-link-type="dfn" href="#xml-mime-type"
                            id="ref-for-xml-mime-type">XML MIME 类型</a>。</p>
                <li>
                    <p>如果 <var>mimeType</var> 是 <a data-link-type="dfn" href="#xml-mime-type"
                            id="ref-for-xml-mime-type①">XML MIME 类型</a>，则返回 "<code>application/xml</code>"。</p>
                <li>
                    <p>如果 <var>mimeType</var> <a data-link-type="dfn" href="#supported-by-the-user-agent"
                            id="ref-for-supported-by-the-user-agent">被用户代理支持</a>，则返回 <var>mimeType</var> 的 <a
                            data-link-type="dfn" href="#mime-type-essence" id="ref-for-mime-type-essence①">本质</a>。
                    </p>
                <li>
                    <p>返回空字符串。</p>
            </ol>
            <p class="note" role="note">本算法目的是让调用者区分具有不同处理模型的 MIME 类型（如 GIF 和 PNG），但除此之外尽量少暴露信息。</p>
        </div>
        <h3 class="heading settled" data-level="4.3" id="mime-type-writing"><span class="secno">4.3. </span><span
                class="content">MIME 类型写入</span><a class="self-link" href="#mime-type-writing"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="valid-mime-type">有效 MIME 类型字符串</dfn>
            指符合 <a data-link-type="dfn" href="https://www.rfc-editor.org/rfc/rfc9110#name-media-type"
                id="ref-for-name-media-type">media-type</a> 产生式的字符串。特别地，<a data-link-type="dfn" href="#valid-mime-type"
                id="ref-for-valid-mime-type">有效 MIME 类型字符串</a>可包含 <a data-link-type="dfn" href="#parameters"
                id="ref-for-parameters">参数</a>。<a data-link-type="biblio" href="#biblio-http-semantics"
                title="HTTP Semantics">[HTTP-SEMANTICS]</a> </p>
        <p class="note" role="note"><a data-link-type="dfn" href="#valid-mime-type" id="ref-for-valid-mime-type①">有效
                MIME 类型字符串</a>主要供一致性检查器使用。</p>
        <div class="example" id="example-valid-mime-type-string">
            <a class="self-link" href="#example-valid-mime-type-string"></a>
            <p>"<code>text/html</code>" 是 <a data-link-type="dfn" href="#valid-mime-type"
                    id="ref-for-valid-mime-type②">有效 MIME 类型字符串</a>。</p>
            <p>"<code>text/html;</code>" 不是 <a data-link-type="dfn" href="#valid-mime-type"
                    id="ref-for-valid-mime-type③">有效 MIME 类型字符串</a>，但 <a data-link-type="dfn" href="#parse-a-mime-type"
                    id="ref-for-parse-a-mime-type">解析 MIME 类型</a>仍会返回一个与输入为 "<code>text/html</code>" 时相同的<a
                    data-link-type="dfn" href="#mime-type" id="ref-for-mime-type⑨">MIME 类型记录</a>。</p>
        </div>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="valid-mime-type-with-no-parameters">无参数有效 MIME
                类型字符串</dfn>是
            不包含 U+003B (;) 的 <a data-link-type="dfn" href="#valid-mime-type" id="ref-for-valid-mime-type④">有效 MIME
                类型字符串</a>。</p>
        <h3 class="heading settled" data-level="4.4" id="parsing-a-mime-type"><span class="secno">4.4. </span><span
                class="content">解析 MIME 类型</span><a class="self-link" href="#parsing-a-mime-type"></a></h3>
        <p>要<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="parse-a-mime-type">解析 MIME 类型</dfn>，给定字符串
            <var>input</var>，执行如下步骤：
        </p>
        <ol>
            <li>
                <p>去除 <var>input</var> 的前后 <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-whitespace"
                        id="ref-for-http-whitespace">HTTP 空白字符</a>。</p>
            <li>
                <p>令 <var>position</var> 为 <var>input</var> 的 <a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#string-position-variable"
                        id="ref-for-string-position-variable">位置变量</a>，初始指向 <var>input</var> 开头。</p>
            <li>
                <p>令 <var>type</var> 为 <a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points"
                        id="ref-for-collect-a-sequence-of-code-points">收集一串不是 U+002F (/) 的码点</a>所得结果，输入为
                    <var>input</var> 和 <var>position</var>。
                </p>
            <li>
                <p>如果 <var>type</var> 为空字符串或不只包含 <a data-link-type="dfn" href="#http-token-code-point"
                        id="ref-for-http-token-code-point①">HTTP 令牌码点</a>，则返回失败。</p>
            <li>
                <p>如果 <var>position</var> 已超出 <var>input</var> 末尾，则返回失败。</p>
            <li>
                <p>将 <var>position</var> 前进 1。（跳过 U+002F (/)。）</p>
            <li>
                <p>令 <var>subtype</var> 为 <a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points"
                        id="ref-for-collect-a-sequence-of-code-points①">收集一串不是 U+003B (;) 的码点</a>所得结果，输入为
                    <var>input</var> 和 <var>position</var>。
                </p>
            <li>
                <p>去除 <var>subtype</var> 尾部的 <a data-link-type="dfn"
                        href="https://fetch.spec.whatwg.org/#http-whitespace" id="ref-for-http-whitespace①">HTTP
                        空白字符</a>。</p>
            <li>
                <p>如果 <var>subtype</var> 为空字符串或不只包含 <a data-link-type="dfn" href="#http-token-code-point"
                        id="ref-for-http-token-code-point②">HTTP 令牌码点</a>，则返回失败。</p>
            <li>
                <p>令 <var>mimeType</var> 为新建的 <a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①⓪">MIME
                        类型记录</a>，其 <a data-link-type="dfn" href="#type" id="ref-for-type①">type</a> 为 <var>type</var>（转为
                    <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-lowercase"
                        id="ref-for-ascii-lowercase">ASCII 小写</a>），
                    <a data-link-type="dfn" href="#subtype" id="ref-for-subtype①">subtype</a> 为 <var>subtype</var>（转为 <a
                        data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-lowercase"
                        id="ref-for-ascii-lowercase①">ASCII 小写</a>）。
                </p>
            <li>
                <p>当 <var>position</var> 未超出 <var>input</var> 末尾时：</p>
                <ol>
                    <li>
                        <p>将 <var>position</var> 前进 1。（跳过 U+003B (;)。）</p>
                    <li>
                        <p>
                            <a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points"
                                id="ref-for-collect-a-sequence-of-code-points②">收集一段码点序列</a>
                            ，这些码点是<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-whitespace"
                                id="ref-for-http-whitespace②">HTTP 空白符</a>，从 <var>input</var> 的 <var>position</var> 开始。
                        </p>
                        <p class="note" role="note">效果类似 <a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#skip-ascii-whitespace"
                                id="ref-for-skip-ascii-whitespace">跳过 ASCII 空白</a>，但用 <a data-link-type="dfn"
                                href="https://fetch.spec.whatwg.org/#http-whitespace" id="ref-for-http-whitespace③">HTTP
                                空白字符</a> 而不是 <a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#ascii-whitespace"
                                id="ref-for-ascii-whitespace">ASCII 空白</a>。</p>
                    <li>
                        <p>令 <var>parameterName</var> 为 <a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points"
                                id="ref-for-collect-a-sequence-of-code-points③">收集一串不是 U+003B (;) 或 U+003D (=)
                                的码点</a>所得结果，输入为 <var>input</var> 和 <var>position</var>。</p>
                    <li>
                        <p>将 <var>parameterName</var> 转为 <a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#ascii-lowercase"
                                id="ref-for-ascii-lowercase②">ASCII 小写</a>。</p>
                    <li>
                        <p>如果 <var>position</var> 未超出 <var>input</var> 末尾，则：</p>
                        <ol>
                            <li>
                                <p>如果 <var>input</var> 的 <var>position</var> 处 <a data-link-type="dfn"
                                        href="https://infra.spec.whatwg.org/#code-point"
                                        id="ref-for-code-point②">码点</a>是 U+003B (;)，则 <a data-link-type="dfn"
                                        href="https://infra.spec.whatwg.org/#iteration-continue"
                                        id="ref-for-iteration-continue">继续</a>。
                                </p>
                            <li>
                                <p>将 <var>position</var> 前进 1。（跳过 U+003D (=)。）</p>
                        </ol>
                    <li>
                        <p>如果 <var>position</var> 已超出 <var>input</var> 末尾，则 <a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#iteration-break"
                                id="ref-for-iteration-break">中断</a>。</p>
                    <li>
                        <p>令 <var>parameterValue</var> 为 null。</p>
                    <li>
                        <p>如果 <var>input</var> 的 <var>position</var> 处 <a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#code-point" id="ref-for-code-point③">码点</a>为 U+0022
                            (")，则：</p>
                        <ol>
                            <li>
                                <p>将 <var>parameterValue</var> 设为 <a data-link-type="dfn"
                                        href="https://fetch.spec.whatwg.org/#collect-an-http-quoted-string"
                                        id="ref-for-collect-an-http-quoted-string">收集 HTTP
                                        引号字符串</a>（输入：<var>input</var>、<var>position</var>、true）结果。</p>
                            <li>
                                <p><a data-link-type="dfn"
                                        href="https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points"
                                        id="ref-for-collect-a-sequence-of-code-points④">收集一串不是 U+003B (;)
                                        的码点</a>（输入：<var>input</var>、<var>position</var>）。</p>
                                <p class="example" id="example-mime-type-parser-trailing-garbage"><a class="self-link"
                                        href="#example-mime-type-parser-trailing-garbage"></a>输入
                                    <code>text/html;charset="shift_jis"iso-2022-jp</code>，结果为
                                    <code>text/html;charset=shift_jis</code>。
                                </p>
                        </ol>
                    <li>
                        <p>否则：</p>
                        <ol>
                            <li>
                                <p>将 <var>parameterValue</var> 设为 <a data-link-type="dfn"
                                        href="https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points"
                                        id="ref-for-collect-a-sequence-of-code-points⑤">收集一串不是 U+003B (;)
                                        的码点</a>所得结果（输入：<var>input</var>、<var>position</var>）。</p>
                            <li>
                                <p>去除 <var>parameterValue</var> 尾部 <a data-link-type="dfn"
                                        href="https://fetch.spec.whatwg.org/#http-whitespace"
                                        id="ref-for-http-whitespace④">HTTP 空白字符</a>。</p>
                            <li>
                                <p>如果 <var>parameterValue</var> 为空字符串，则 <a data-link-type="dfn"
                                        href="https://infra.spec.whatwg.org/#iteration-continue"
                                        id="ref-for-iteration-continue①">继续</a>。</p>
                        </ol>
                    <li>
                        <p>若全部满足：</p>
                        <ul class="brief">
                            <li><var>parameterName</var> 非空
                            <li><var>parameterName</var> 只包含 <a data-link-type="dfn" href="#http-token-code-point"
                                    id="ref-for-http-token-code-point③">HTTP 令牌码点</a>
                            <li><var>parameterValue</var> 只包含 <a data-link-type="dfn"
                                    href="#http-quoted-string-token-code-point"
                                    id="ref-for-http-quoted-string-token-code-point①">HTTP 引号字符串令牌码点</a>
                            <li><a data-link-type="dfn" href="#parameters"
                                    id="ref-for-parameters①">参数</a>[<var>parameterName</var>] 不存在
                        </ul>
                        <p>则<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set"
                                id="ref-for-map-set">设置</a> <var>mimeType</var> 的 <a data-link-type="dfn"
                                href="#parameters" id="ref-for-parameters②">参数</a>[<var>parameterName</var>] 为
                            <var>parameterValue</var>。
                        </p>
                </ol>
            <li>
                <p>返回 <var>mimeType</var>。</p>
        </ol>
        <hr>
        <p>要<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="parse-a-mime-type-from-bytes">从字节解析 MIME
                类型</dfn>，给定 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence">字节序列</a>
            <var>input</var>，执行如下步骤：
        </p>
        <ol>
            <li>
                <p>令 <var>string</var> 为 <var>input</var> <a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#isomorphic-decode"
                        id="ref-for-isomorphic-decode">同构解码</a>后的结果。</p>
            <li>
                <p>返回 <a data-link-type="dfn" href="#parse-a-mime-type" id="ref-for-parse-a-mime-type①">解析 MIME
                        类型</a>（<var>string</var>）的结果。</p>
        </ol>
        <h3 class="heading settled" data-level="4.5" id="serializing-a-mime-type"><span class="secno">4.5. </span><span
                class="content">序列化 MIME 类型</span><a class="self-link" href="#serializing-a-mime-type"></a>
        </h3>
        <p>要<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="serialize-a-mime-type">序列化 MIME 类型</dfn>，给定 <a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①①">MIME 类型</a> <var>mimeType</var>，执行如下步骤：
        </p>
        <ol>
            <li>
                <p>令 <var>serialization</var> 为 <var>mimeType</var> 的 <a data-link-type="dfn" href="#type"
                        id="ref-for-type②">主类型</a>、U+002F (/) 以及 <var>mimeType</var> 的 <a data-link-type="dfn"
                        href="#subtype" id="ref-for-subtype②">子类型</a> 的拼接结果。</p>
            <li>
                <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate"
                        id="ref-for-map-iterate">对于</a> <var>mimeType</var> 的每个 <a data-link-type="dfn"
                        href="#parameters" id="ref-for-parameters③">参数</a> <var>name</var> → <var>value</var>：</p>
                <ol>
                    <li>
                        <p>在 <var>serialization</var> 后添加 U+003B (;)。</p>
                    <li>
                        <p>在 <var>serialization</var> 后添加 <var>name</var>。</p>
                    <li>
                        <p>在 <var>serialization</var> 后添加 U+003D (=)。</p>
                    <li>
                        <p>如果 <var>value</var> 不仅包含 <a data-link-type="dfn" href="#http-token-code-point"
                                id="ref-for-http-token-code-point④">HTTP 令牌码点</a>，或 <var>value</var> 为空字符串，则：</p>
                        <ol>
                            <li>
                                <p>在 <var>value</var> 中每个 U+0022 (") 或 U+005C (\) 前加 U+005C (\)。</p>
                            <li>
                                <p>在 <var>value</var> 前添加 U+0022 (")。</p>
                            <li>
                                <p>在 <var>value</var> 后添加 U+0022 (")。</p>
                        </ol>
                    <li>
                        <p>将 <var>value</var> 添加到 <var>serialization</var>。</p>
                </ol>
            <li>
                <p>返回 <var>serialization</var>。</p>
        </ol>
        <hr>
        <p>要<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="serialize-a-mime-type-to-bytes">将 MIME
                类型序列化为字节</dfn>，给定 <a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①②">MIME 类型</a>
            <var>mimeType</var>，执行如下步骤：
        </p>
        <ol>
            <li>
                <p>令 <var>stringSerialization</var> 为 <a data-link-type="dfn" href="#serialize-a-mime-type"
                        id="ref-for-serialize-a-mime-type">序列化 MIME 类型</a>（<var>mimeType</var>）的结果。</p>
            <li>
                <p>返回 <var>stringSerialization</var> <a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#isomorphic-encode"
                        id="ref-for-isomorphic-encode">同构编码</a>后的结果。</p>
        </ol>
        <h3 class="heading settled" data-level="4.6" id="mime-type-groups"><span class="secno">4.6. </span><span
                class="content">MIME 类型分组</span><a class="self-link" href="#mime-type-groups"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="image-mime-type">图像 MIME 类型（image MIME
                type）</dfn>指 <a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①③">MIME 类型</a> 其 <a
                data-link-type="dfn" href="#type" id="ref-for-type③">主类型</a>为 "<code>image</code>"。
        </p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="audio-or-video-mime-type">音频或视频 MIME 类型（audio or
                video MIME type）</dfn>指 <a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①④">MIME
                类型</a>其<a data-link-type="dfn" href="#type" id="ref-for-type④">主类型</a>为 "<code>audio</code>" 或
            "<code>video</code>"，或 <a data-link-type="dfn" href="#mime-type-essence"
                id="ref-for-mime-type-essence②">本质</a>为 "<code>application/ogg</code>"。
        </p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="font-mime-type">字体 MIME 类型（font MIME
                type）</dfn>指 <a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①⑤">MIME 类型</a>其<a
                data-link-type="dfn" href="#type" id="ref-for-type⑤">主类型</a>为 "<code>font</code>"，或 <a
                data-link-type="dfn" href="#mime-type-essence" id="ref-for-mime-type-essence③">本质</a>为下列之一：<a
                data-link-type="biblio" href="#biblio-rfc8081"
                title="The &quot;font&quot; Top-Level Media Type">[RFC8081]</a> </p>
        <ul class="brief">
            <li><code>application/font-cff</code>
            <li><code>application/font-otf</code>
            <li><code>application/font-sfnt</code>
            <li><code>application/font-ttf</code>
            <li><code>application/font-woff</code>
            <li><code>application/vnd.ms-fontobject</code>
            <li><code>application/vnd.ms-opentype</code>
        </ul>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="zip-based-mime-type">基于 ZIP 的 MIME 类型（ZIP-based
                MIME type）</dfn>指 <a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①⑥">MIME 类型</a>其<a
                data-link-type="dfn" href="#subtype" id="ref-for-subtype③">子类型</a>以 "<code>+zip</code>" 结尾，或 <a
                data-link-type="dfn" href="#mime-type-essence" id="ref-for-mime-type-essence④">本质</a>为下列之一：</p>
        <ul class="XXX brief">
            <li><code>application/zip</code>
        </ul>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="archive-mime-type">归档 MIME 类型（archive MIME
                type）</dfn>指 <a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①⑦">MIME 类型</a>其<a
                data-link-type="dfn" href="#mime-type-essence" id="ref-for-mime-type-essence⑤">本质</a>为下列之一：</p>
        <ul class="brief">
            <li><code>application/x-rar-compressed</code>
            <li><code>application/zip</code>
            <li><code>application/x-gzip</code>
        </ul>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="xml-mime-type">XML MIME 类型</dfn>指 <a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①⑧">MIME 类型</a>其<a data-link-type="dfn"
                href="#subtype" id="ref-for-subtype④">子类型</a>以 "<code>+xml</code>" 结尾，或 <a data-link-type="dfn"
                href="#mime-type-essence" id="ref-for-mime-type-essence⑥">本质</a>为 "<code>text/xml</code>" 或
            "<code>application/xml</code>"。<a data-link-type="biblio" href="#biblio-rfc7303"
                title="XML Media Types">[RFC7303]</a> </p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="html-mime-type">HTML MIME 类型</dfn>指 <a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type①⑨">MIME 类型</a>其<a data-link-type="dfn"
                href="#mime-type-essence" id="ref-for-mime-type-essence⑦">本质</a>为 "<code>text/html</code>"。
        </p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="scriptable-mime-type">可脚本 MIME 类型（scriptable
                MIME type）</dfn>指 <a data-link-type="dfn" href="#xml-mime-type" id="ref-for-xml-mime-type②">XML MIME
                类型</a>、<a data-link-type="dfn" href="#html-mime-type" id="ref-for-html-mime-type">HTML MIME 类型</a>，或 <a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②⓪">MIME 类型</a>其<a data-link-type="dfn"
                href="#mime-type-essence" id="ref-for-mime-type-essence⑧">本质</a>为 "<code>application/pdf</code>"。
        </p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="javascript-mime-type">JavaScript MIME 类型</dfn>指
            <a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②①">MIME 类型</a>其<a data-link-type="dfn"
                href="#mime-type-essence" id="ref-for-mime-type-essence⑨">本质</a>为下列之一：
        </p>
        <ul class="brief">
            <li><code>application/ecmascript</code>
            <li><code>application/javascript</code>
            <li><code>application/x-ecmascript</code>
            <li><code>application/x-javascript</code>
            <li><code>text/ecmascript</code>
            <li><code>text/javascript</code>
            <li><code>text/javascript1.0</code>
            <li><code>text/javascript1.1</code>
            <li><code>text/javascript1.2</code>
            <li><code>text/javascript1.3</code>
            <li><code>text/javascript1.4</code>
            <li><code>text/javascript1.5</code>
            <li><code>text/jscript</code>
            <li><code>text/livescript</code>
            <li><code>text/x-ecmascript</code>
            <li><code>text/x-javascript</code>
        </ul>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①">字符串</a>为<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-export id="javascript-mime-type-essence-match">JavaScript
                MIME 类型本质匹配（essence match）</dfn>，如果它与某个 <a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive">ASCII
                不区分大小写</a>的 <a data-link-type="dfn" href="#javascript-mime-type"
                id="ref-for-javascript-mime-type①">JavaScript MIME 类型</a>本质字符串一致。
        </p>
        <p class="note" role="note">此钩子用于
            <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/scripting.html#attr-script-type" id="ref-for-attr-script-type">type</a></code>
            属性和
            <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script">script</a></code>
            元素。<a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a>
        </p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="json-mime-type">JSON MIME 类型</dfn>指 <a
                data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②②">MIME 类型</a>其<a data-link-type="dfn"
                href="#subtype" id="ref-for-subtype⑤">子类型</a>以 "<code>+json</code>" 结尾，或 <a data-link-type="dfn"
                href="#mime-type-essence" id="ref-for-mime-type-essence①⓪">本质</a>为 "<code>application/json</code>" 或
            "<code>text/json</code>"。
        </p>
        <h2 class="heading settled" data-level="5" id="handling-a-resource"><span class="secno">5. </span><span
                class="content">资源处理</span><a class="self-link" href="#handling-a-resource"></a></h2>
        <p class="XXX"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="resource">资源</dfn>是……</p>
        <p>对于每个要处理的<a data-link-type="dfn" href="#resource" id="ref-for-resource①">资源</a>，用户代理必须跟踪以下相关元数据：</p>
        <ul>
            <li><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="supplied-mime-type">提供的 MIME 类型</dfn>，由<a
                    data-link-type="dfn" href="#supplied-mime-type-detection-algorithm"
                    id="ref-for-supplied-mime-type-detection-algorithm">提供的 MIME 类型检测算法</a>判定的<a data-link-type="dfn"
                    href="#mime-type" id="ref-for-mime-type②③">MIME 类型</a>。
            <li><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="check-for-apache-bug-flag">检查 Apache bug
                    标志</dfn>，默认未设置。
            <li>
                <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="no-sniff-flag">no-sniff
                    标志</dfn>，如果用户代理不希望对该<a data-link-type="dfn" href="#resource"
                    id="ref-for-resource②">资源</a>进行嗅探，则默认设置，否则为未设置。
                <p class="note" role="note">用户代理可以使用外部信息（如之前对某站点的经验）来判断是否对特定<a data-link-type="dfn" href="#resource"
                        id="ref-for-resource③">资源</a>关闭嗅探。用户代理还可以选择对所有<a data-link-type="dfn" href="#resource"
                        id="ref-for-resource④">资源</a>关闭嗅探。但关闭嗅探并不意味着可以不使用<a data-link-type="dfn"
                        href="#mime-type-sniffing-algorithm" id="ref-for-mime-type-sniffing-algorithm">MIME 类型嗅探算法</a>。
                </p>
            <li><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="computed-mime-type">计算出的 MIME 类型</dfn>，由<a
                    data-link-type="dfn" href="#mime-type-sniffing-algorithm"
                    id="ref-for-mime-type-sniffing-algorithm①">MIME 类型嗅探算法</a>判定的<a data-link-type="dfn"
                    href="#mime-type" id="ref-for-mime-type②④">MIME 类型</a>。
        </ul>
        <h3 class="heading settled" data-level="5.1" id="interpreting-the-resource-metadata"><span class="secno">5.1.
            </span><span class="content">资源元数据解释</span><a class="self-link"
                href="#interpreting-the-resource-metadata"></a></h3>
        <p><a data-link-type="dfn" href="#resource" id="ref-for-resource⑤">资源</a>的<a data-link-type="dfn"
                href="#supplied-mime-type" id="ref-for-supplied-mime-type">提供的 MIME 类型</a>由与该<a data-link-type="dfn"
                href="#resource" id="ref-for-resource⑥">资源</a>相关的外部来源提供。获取该信息的方法取决于<a data-link-type="dfn"
                href="#resource" id="ref-for-resource⑦">资源</a>的获取方式。</p>
        <p>为了确定<a data-link-type="dfn" href="#resource" id="ref-for-resource⑧">资源</a>的<a data-link-type="dfn"
                href="#supplied-mime-type" id="ref-for-supplied-mime-type①">提供的 MIME 类型</a>，用户代理必须使用以下<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-lt="supplied MIME type detection algorithm" data-noexport
                id="supplied-mime-type-detection-algorithm">提供的 MIME 类型检测算法</dfn>：</p>
        <ol>
            <li>令 <var>supplied-type</var> 为 null。
            <li>如果<a data-link-type="dfn" href="#resource" id="ref-for-resource⑨">资源</a>是通过 HTTP 获取的，执行以下步骤：
                <ol>
                    <li>如果该<a data-link-type="dfn" href="#resource" id="ref-for-resource①⓪">资源</a>有一个或多个
                        <code>Content-Type</code> 头，执行以下步骤：
                        <ol>
                            <li>将 <var>supplied-type</var> 设为与该<a data-link-type="dfn" href="#resource"
                                    id="ref-for-resource①①">资源</a>关联的最后一个 <code>Content-Type</code> 头的值。
                                <p class="note" role="note">通过 HTTP 获取的<a data-link-type="dfn" href="#resource"
                                        id="ref-for-resource①②">资源</a>，其<a data-link-type="dfn"
                                        href="#supplied-mime-type" id="ref-for-supplied-mime-type②">提供的 MIME
                                        类型</a>不依赖于文件扩展名，因为扩展名不可靠且容易伪造。</p>
                            <li>如果 <var>supplied-type</var> <strong>完全等于</strong>下表中的某个值，则设置<a data-link-type="dfn"
                                    href="#check-for-apache-bug-flag" id="ref-for-check-for-apache-bug-flag">检查 Apache
                                    bug 标志</a>：
                                <table>
                                    <thead>
                                        <tr>
                                            <th>十六进制字节
                                            <th>ASCII 字节
                                    <tbody>
                                        <tr>
                                            <td>74 65 78 74 2F 70 6C 61 69 6E
                                            <td><code>text/plain</code>
                                        <tr>
                                            <td>74 65 78 74 2F 70 6C 61 69 6E<br>3B 20 63 68 61 72 73 65 74 3D<br>49 53
                                                4F 2D 38 38 35 39 2D 31
                                            <td><code>text/plain; charset=ISO-8859-1</code>
                                        <tr>
                                            <td>74 65 78 74 2F 70 6C 61 69 6E<br>3B 20 63 68 61 72 73 65 74 3D<br>69 73
                                                6F 2D 38 38 35 39 2D 31
                                            <td><code>text/plain; charset=iso-8859-1</code>
                                        <tr>
                                            <td>74 65 78 74 2F 70 6C 61 69 6E<br>3B 20 63 68 61 72 73 65 74 3D<br>55 54
                                                46 2D 38
                                            <td><code>text/plain; charset=UTF-8</code>
                                </table>
                                <p class="note" role="note"><a data-link-type="dfn"
                                        href="#supplied-mime-type-detection-algorithm"
                                        id="ref-for-supplied-mime-type-detection-algorithm①">提供的 MIME
                                        类型检测算法</a>检测这些精确的<a data-link-type="dfn"
                                        href="https://infra.spec.whatwg.org/#byte"
                                        id="ref-for-byte⑥">字节</a>序列，是因为一些较老版本的 Apache 存在<a
                                        href="https://issues.apache.org/bugzilla/show_bug.cgi?id=13986">一个
                                        bug</a>，导致其在提供未知<a data-link-type="dfn" href="#mime-type"
                                        id="ref-for-mime-type②⑤">MIME 类型</a>文件时返回这些 Content-Type 头。</p>
                        </ol>
                </ol>
                <p><a data-link-type="biblio" href="#biblio-http-semantics" title="HTTP Semantics">[HTTP-SEMANTICS]</a>
                </p>
            <li>如果<a data-link-type="dfn" href="#resource" id="ref-for-resource①③">资源</a>是直接从文件系统获取的，令
                <var>supplied-type</var> 为文件系统提供的<a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②⑥">MIME
                    类型</a>。
            <li>如果<a data-link-type="dfn" href="#resource" id="ref-for-resource①④">资源</a>是通过其他协议（如 FTP）获取的，令
                <var>supplied-type</var> 为该协议判定的<a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②⑦">MIME
                    类型</a>（若有）。
                <p><a data-link-type="biblio" href="#biblio-ftp" title="File Transfer Protocol">[FTP]</a></p>
            <li>如果 <var>supplied-type</var> 不是<a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②⑧">MIME
                    类型</a>，则<a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type③">提供的 MIME
                    类型</a>未定义。
                <p>终止这些步骤。</p>
            <li><a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type④">提供的 MIME 类型</a>为
                <var>supplied-type</var>。
        </ol>
        <h3 class="heading settled" data-level="5.2" id="reading-the-resource-header"><span class="secno">5.2.
            </span><span class="content">读取资源头部</span><a class="self-link" href="#reading-the-resource-header"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="resource-header">资源头部</dfn>是<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence①">字节序列</a>，即<a data-link-type="dfn" href="#resource"
                id="ref-for-resource①⑤">资源</a>开头的部分，由<a data-link-type="dfn" href="#read-the-resource-header"
                id="ref-for-read-the-resource-header">读取资源头部</a>确定。</p>
        <p>要<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="read-the-resource-header">读取资源头部</dfn>，执行如下步骤：</p>
        <ol>
            <li>令 <var>buffer</var> 为一个<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                    id="ref-for-byte-sequence②">字节序列</a>。
            <li>从<a data-link-type="dfn" href="#resource" id="ref-for-resource①⑥">资源</a>中读取<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte⑦">字节</a>到 <var>buffer</var>，直到满足下列任一条件：
                <ul>
                    <li>到达<a data-link-type="dfn" href="#resource" id="ref-for-resource①⑦">资源</a>末尾。
                    <li><var>buffer</var>中的<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                            id="ref-for-byte⑧">字节</a>数大于等于 1445。
                    <li>用户代理认定已过了合理的时间。
                </ul>
                <p class="note" role="note">如果 <var>buffer</var> 的<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte⑨">字节</a>数大于等于 1445，则<a
                        data-link-type="dfn" href="#mime-type-sniffing-algorithm"
                        id="ref-for-mime-type-sniffing-algorithm②">MIME 类型嗅探算法</a>在绝大多数情况下是确定性的。</p>
                <p>但某些因素（如网络慢）可能导致用户代理无法在合理时间内读取到 1445 <a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte①⓪">字节</a>。</p>
            <li><a data-link-type="dfn" href="#resource-header" id="ref-for-resource-header">资源头部</a>为
                <var>buffer</var>。
        </ol>
        <p class="note" role="note"><a data-link-type="dfn" href="#resource-header"
                id="ref-for-resource-header①">资源头部</a>每个<a data-link-type="dfn" href="#resource"
                id="ref-for-resource①⑧">资源</a>只需确定一次。</p>
        <h2 class="heading settled" data-level="6" id="matching-a-mime-type-pattern"><span class="secno">6. </span><span
                class="content">匹配 MIME 类型模式</span><a class="self-link" href="#matching-a-mime-type-pattern"></a></h2>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="byte-pattern">字节模式（byte pattern）</dfn>是用于<a
                data-link-type="dfn" href="#pattern-matching-algorithm"
                id="ref-for-pattern-matching-algorithm">模式匹配算法</a>比对的<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence③">字节序列</a>。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="pattern-mask">模式掩码（pattern mask）</dfn>是用于确定与<a
                data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern">字节模式</a>比对时哪些<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte①①">字节</a>有意义的<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence④">字节序列</a>，用于<a
                data-link-type="dfn" href="#pattern-matching-algorithm"
                id="ref-for-pattern-matching-algorithm①">模式匹配算法</a>。</p>
        <p class="note" role="note">在<a data-link-type="dfn" href="#pattern-mask"
                id="ref-for-pattern-mask">模式掩码</a>中，0xFF 表示该<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte①②">字节</a>严格有意义，0xDF 表示该<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte①③">字节</a>以 ASCII
            不区分大小写方式有意义，0x00 表示该<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                id="ref-for-byte①④">字节</a>无意义。</p>
        <p>要判断一个<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence⑤">字节序列</a>是否匹配特定的<a data-link-type="dfn" href="#byte-pattern"
                id="ref-for-byte-pattern①">字节模式</a>，请使用如下<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="pattern-matching-algorithm">模式匹配算法</dfn>。该算法接收一个<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence⑥">字节序列</a>
            <var>input</var>、一个<a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern②">字节模式</a>
            <var>pattern</var>、一个<a data-link-type="dfn" href="#pattern-mask" id="ref-for-pattern-mask①">模式掩码</a>
            <var>mask</var>，以及一个要忽略的<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set"
                id="ref-for-ordered-set">字节集合</a> <var>ignored</var>，返回 true 或 false。
        </p>
        <ol>
            <li>
                <p>断言：<var>pattern</var> 的<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#byte-sequence-length"
                        id="ref-for-byte-sequence-length">长度</a>等于 <var>mask</var> 的<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#byte-sequence-length"
                        id="ref-for-byte-sequence-length①">长度</a>。</p>
            <li>
                <p>如果 <var>input</var> 的<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#byte-sequence-length"
                        id="ref-for-byte-sequence-length②">长度</a>小于 <var>pattern</var> 的<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#byte-sequence-length"
                        id="ref-for-byte-sequence-length③">长度</a>，返回 false。</p>
            <li>
                <p>令 <var>s</var> = 0。</p>
            <li>
                <p>当 <var>s</var> &lt; <var>input</var> 的<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#byte-sequence-length"
                        id="ref-for-byte-sequence-length④">长度</a>：</p>
                <ol>
                    <li>
                        <p>如果 <var>ignored</var> 不<a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">包含</a>
                            <var>input</var>[<var>s</var>]，<a data-link-type="dfn"
                                href="https://infra.spec.whatwg.org/#iteration-break"
                                id="ref-for-iteration-break①">中断</a>。
                        </p>
                    <li>
                        <p>令 <var>s</var> = <var>s</var> + 1。</p>
                </ol>
            <li>
                <p>令 <var>p</var> = 0。</p>
            <li>
                <p>当 <var>p</var> &lt; <var>pattern</var> 的<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#byte-sequence-length"
                        id="ref-for-byte-sequence-length⑤">长度</a>：</p>
                <ol>
                    <li>
                        <p>令 <var>maskedData</var> 为 <var>input</var>[<var>s</var>] 和 <var>mask</var>[<var>p</var>]
                            进行按位与的结果。</p>
                    <li>
                        <p>如果 <var>maskedData</var> 不等于 <var>pattern</var>[<var>p</var>]，返回 false。</p>
                    <li>
                        <p>令 <var>s</var> = <var>s</var> + 1。</p>
                    <li>
                        <p>令 <var>p</var> = <var>p</var> + 1。</p>
                </ol>
            <li>
                <p>返回 true。</p>
        </ol>
        <h3 class="heading settled" data-level="6.1" id="matching-an-image-type-pattern"><span class="secno">6.1.
            </span><span class="content">匹配图像类型模式</span><a class="self-link" href="#matching-an-image-type-pattern"></a>
        </h3>
        <p>要确定<a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern③">字节模式</a> <a data-link-type="dfn"
                href="#image-mime-type" id="ref-for-image-mime-type">图像 MIME 类型</a>的哪一项与 <a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence⑦">字节序列</a>
            <var>input</var> 匹配（如有），请使用如下<a data-link-type="dfn" data-dfn-type="dfn" data-export
                id="image-type-pattern-matching-algorithm">图像类型模式匹配算法</a>：
        </p>
        <ol>
            <li>
                <p>对下表每一行 <var>row</var> 执行如下步骤：</p>
                <ol>
                    <li>
                        <p>令 <var>patternMatched</var> 为 <a data-link-type="dfn" href="#pattern-matching-algorithm"
                                id="ref-for-pattern-matching-algorithm②">模式匹配算法</a>（参数：<var>input</var>、行首列、行次列、行第三列）的结果。
                        </p>
                    <li>
                        <p>如果 <var>patternMatched</var> 为 true，则返回 <var>row</var> 的第四列值。</p>
                </ol>
                <table>
                    <thead>
                        <tr>
                            <th><a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern④">字节模式</a>
                            <th><a data-link-type="dfn" href="#pattern-mask" id="ref-for-pattern-mask②">模式掩码</a>
                            <th>要忽略的前导<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte①⑥">字节</a>
                            <th><a data-link-type="dfn" href="#image-mime-type" id="ref-for-image-mime-type①">图像 MIME
                                    类型</a>
                            <th>说明
                    <tbody>
                        <tr>
                            <td>00 00 01 00
                            <td>FF FF FF FF
                            <td>无
                            <td><code>image/x-icon</code>
                            <td>Windows Icon 签名。
                        <tr>
                            <td>00 00 02 00
                            <td>FF FF FF FF
                            <td>无
                            <td><code>image/x-icon</code>
                            <td>Windows Cursor 签名。
                        <tr>
                            <td>42 4D
                            <td>FF FF
                            <td>无
                            <td><code>image/bmp</code>
                            <td>字符串 "<code>BM</code>"，BMP 签名。
                        <tr>
                            <td>47 49 46 38 37 61
                            <td>FF FF FF FF FF FF
                            <td>无
                            <td><code>image/gif</code>
                            <td>字符串 "<code>GIF87a</code>"，GIF 签名。
                        <tr>
                            <td>47 49 46 38 39 61
                            <td>FF FF FF FF FF FF
                            <td>无
                            <td><code>image/gif</code>
                            <td>字符串 "<code>GIF89a</code>"，GIF 签名。
                        <tr>
                            <td>52 49 46 46 00 00 00 00 57 45 42 50 56 50
                            <td>FF FF FF FF 00 00 00 00 FF FF FF FF FF FF
                            <td>无
                            <td><code>image/webp</code>
                            <td>字符串 "<code>RIFF</code>" 后四个<a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte①⑦">字节</a>，再加
                                "<code>WEBPVP</code>"。
                        <tr>
                            <td>89 50 4E 47 0D 0A 1A 0A
                            <td>FF FF FF FF FF FF FF FF
                            <td>无
                            <td><code>image/png</code>
                            <td>一个校验<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte①⑧">字节</a>后跟 "<code>PNG</code>"，再跟 CR LF SUB LF，为 PNG 签名。
                        <tr>
                            <td>FF D8 FF
                            <td>FF FF FF
                            <td>无
                            <td><code>image/jpeg</code>
                            <td>JPEG 起始标记及另一个标记的指示<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte①⑨">字节</a>。
                </table>
            <li>
                <p>返回 undefined。</p>
        </ol>
        <h3 class="heading settled" data-level="6.2" id="matching-an-audio-or-video-type-pattern"><span
                class="secno">6.2. </span><span class="content">匹配音频或视频类型模式</span><a class="self-link"
                href="#matching-an-audio-or-video-type-pattern"></a></h3>
        <p>要确定<a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern⑤">字节模式</a> <a data-link-type="dfn"
                href="#audio-or-video-mime-type" id="ref-for-audio-or-video-mime-type">音频或视频 MIME 类型</a>的哪一项与 <a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence⑧">字节序列</a> <var>input</var> 匹配（如有），请使用如下<a data-link-type="dfn"
                data-dfn-type="dfn" data-export data-lt="audio or video type pattern matching algorithm"
                id="audio-or-video-type-pattern-matching-algorithm">音频或视频类型模式匹配算法</a>：</p>
        <ol>
            <li>
                <p>对下表每一行 <var>row</var> 执行如下步骤：</p>
                <ol>
                    <li>
                        <p>令 <var>patternMatched</var> 为 <a data-link-type="dfn" href="#pattern-matching-algorithm"
                                id="ref-for-pattern-matching-algorithm③">模式匹配算法</a>（参数：<var>input</var>、行首列、行次列、行第三列）的结果。
                        </p>
                    <li>
                        <p>如果 <var>patternMatched</var> 为 true，则返回 <var>row</var> 的第四列值。</p>
                </ol>
                <table>
                    <thead>
                        <tr>
                            <th><a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern⑥">字节模式</a>
                            <th><a data-link-type="dfn" href="#pattern-mask" id="ref-for-pattern-mask③">模式掩码</a>
                            <th>要忽略的前导<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte②⓪">字节</a>
                            <th><a data-link-type="dfn" href="#audio-or-video-mime-type"
                                    id="ref-for-audio-or-video-mime-type①">音频或视频 MIME 类型</a>
                            <th>说明
                    <tbody>
                        <tr>
                            <td>46 4F 52 4D 00 00 00 00 41 49 46 46
                            <td>FF FF FF FF 00 00 00 00 FF FF FF FF
                            <td>无
                            <td><code>audio/aiff</code>
                            <td>字符串 "<code>FORM</code>" 后四个<a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte②①">字节</a>，再加
                                "<code>AIFF</code>"，即 AIFF 签名。
                        <tr>
                            <td>49 44 33
                            <td>FF FF FF
                            <td>无
                            <td><code>audio/mpeg</code>
                            <td>字符串 "<code>ID3</code>"，ID3v2 标记的 MP3 签名。
                        <tr>
                            <td>4F 67 67 53 00
                            <td>FF FF FF FF FF
                            <td>无
                            <td><code>application/ogg</code>
                            <td>字符串 "<code>OggS</code>" 后跟 NUL，即 Ogg 容器签名。
                        <tr>
                            <td>4D 54 68 64 00 00 00 06
                            <td>FF FF FF FF FF FF FF FF
                            <td>无
                            <td><code>audio/midi</code>
                            <td>字符串 "<code>MThd</code>" 后跟四个表示数字 6（32 位大端）的<a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte②②">字节</a>，即 MIDI 签名。
                        <tr>
                            <td>52 49 46 46 00 00 00 00 41 56 49 20
                            <td>FF FF FF FF 00 00 00 00 FF FF FF FF
                            <td>无
                            <td><code>video/avi</code>
                            <td>字符串 "<code>RIFF</code>" 后四个<a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte②③">字节</a>，再加
                                "<code>AVI </code>"，即 AVI 签名。
                        <tr>
                            <td>52 49 46 46 00 00 00 00 57 41 56 45
                            <td>FF FF FF FF 00 00 00 00 FF FF FF FF
                            <td>无
                            <td><code>audio/wave</code>
                            <td>字符串 "<code>RIFF</code>" 后四个<a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte②④">字节</a>，再加
                                "<code>WAVE</code>"，即 WAVE 签名。
                </table>
            <li>
                <p>如果 <var>input</var> <a data-link-type="dfn" href="#matches-the-signature-for-mp4"
                        id="ref-for-matches-the-signature-for-mp4">匹配 MP4 签名</a>，返回 "<code>video/mp4</code>"。</p>
            <li>
                <p>如果 <var>input</var> <a data-link-type="dfn" href="#matches-the-signature-for-webm"
                        id="ref-for-matches-the-signature-for-webm">匹配 WebM 签名</a>，返回 "<code>video/webm</code>"。</p>
            <li>
                <p>如果 <var>input</var> <a data-link-type="dfn" href="#matches-the-signature-for-mp3-without-id3"
                        id="ref-for-matches-the-signature-for-mp3-without-id3">匹配无 ID3 的 MP3 签名</a>，返回
                    "<code>audio/mpeg</code>"。</p>
            <li>
                <p>返回 undefined。</p>
        </ol>
        <h4 class="heading settled" data-level="6.2.1" id="signature-for-mp4"><span class="secno">6.2.1. </span><span
                class="content">MP4 签名</span><a class="self-link" href="#signature-for-mp4"></a></h4>
        <p>要判断一个<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence⑨">字节序列</a>是否<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-lt="matches the signature for MP4" data-noexport id="matches-the-signature-for-mp4">匹配 MP4
                签名</dfn>，使用以下步骤：</p>
        <ol>
            <li>令 <var>sequence</var> 为要匹配的<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                    id="ref-for-byte-sequence①⓪">字节序列</a>，<var>sequence</var>[<var>s</var>] 表示第 <var>s</var> 个<a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                    id="ref-for-byte②⑤">字节</a>，<var>sequence</var>[0] 为第一个字节。
            <li>令 <var>length</var> 为 <var>sequence</var> 的<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte②⑦">字节</a>数。
            <li>如果 <var>length</var> 小于 12，返回 false。
            <li>令 <var>box-size</var> 为 <var>sequence</var>[0] 到 <var>sequence</var>[3] 四个字节，按大端解释为 32 位无符号整数。
            <li>如果 <var>length</var> 小于 <var>box-size</var> 或 <var>box-size</var> 模 4 不为 0，返回 false。
            <li>如果 <var>sequence</var>[4] 到 <var>sequence</var>[7] 四个字节不等于 0x66 0x74 0x79 0x70（<code>ftyp</code>），返回
                false。
            <li>如果 <var>sequence</var>[8] 到 <var>sequence</var>[10] 三个字节等于 0x6D 0x70 0x34（<code>mp4</code>），返回 true。
            <li>
                令 <var>bytes-read</var> 为 16。
                <p class="note" role="note">这忽略了 “major brand” 版本号对应的四个字节。</p>
            <li>
                当 <var>bytes-read</var> 小于 <var>box-size</var> 时，循环执行：
                <ol>
                    <li>如果 <var>sequence</var>[<var>bytes-read</var>] 到 <var>sequence</var>[<var>bytes-read</var> + 2]
                        三个字节为 0x6D 0x70 0x34（<code>mp4</code>），返回 true。
                    <li><var>bytes-read</var> 增加 4。
                </ol>
            <li>返回 false。
        </ol>
        <h4 class="heading settled" data-level="6.2.2" id="signature-for-webm"><span class="secno">6.2.2. </span><span
                class="content">WebM 签名</span><a class="self-link" href="#signature-for-webm"></a></h4>
        <p>要判断一个<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence①①">字节序列</a>是否<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-lt="matches the signature for WebM" data-noexport id="matches-the-signature-for-webm">匹配 WebM
                签名</dfn>，使用以下步骤：</p>
        <ol>
            <li>令 <var>sequence</var> 为要匹配的<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                    id="ref-for-byte-sequence①②">字节序列</a>，<var>sequence</var>[<var>s</var>] 表示第 <var>s</var> 个<a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                    id="ref-for-byte③③">字节</a>，<var>sequence</var>[0] 为第一个字节。
            <li>令 <var>length</var> 为 <var>sequence</var> 的<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte③⑤">字节</a>数。
            <li>如果 <var>length</var> 小于 4，返回 false。
            <li>如果 <var>sequence</var>[0] 到 <var>sequence</var>[3] 四个字节不等于 0x1A 0x45 0xDF 0xA3，返回 false。
            <li>令 <var>iter</var> 为 4。
            <li>
                当 <var>iter</var> 小于 <var>length</var> 且 <var>iter</var> 小于 38 时，循环执行：
                <ol>
                    <li>
                        如果 <var>sequence</var>[<var>iter</var>] 和 <var>sequence</var>[<var>iter</var>+1] 两个字节等于 0x42
                        0x82，
                        <ol>
                            <li><var>iter</var> 增加 2。
                            <li>如果 <var>iter</var> 大于等于 <var>length</var>，终止这些步骤。
                            <li>令 <var>number size</var> 为 <a href="#parse-a-vint" id="ref-for-parse-a-vint">解析 vint</a>
                                从 <var>sequence</var>[<var>iter</var>] 得到的结果。
                            <li><var>iter</var> 增加 <var>number size</var>。
                            <li>如果 <var>iter</var> 大于等于 <var>length</var> - 4，终止这些步骤。
                            <li>令 <var>matched</var> 为 <a href="#matching-a-padded-sequence"
                                    id="ref-for-matching-a-padded-sequence">匹配填充序列</a> 0x77 0x65 0x62
                                0x6D（<code>webm</code>）在 <var>sequence</var> 的 <var>iter</var> 处的结果。
                            <li>如果 <var>matched</var> 为 true，终止并返回 true。
                        </ol>
                    <li><var>iter</var> 增加 1。
                </ol>
            <li>返回 false。
        </ol>
        <p>要<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-a-vint">解析 <code>vint</code></dfn>，在 <a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence①③">字节序列</a> <var>sequence</var>、长度 <var>length</var>、起始索引 <var>iter</var>
            上，执行：</p>
        <ol>
            <li>令 <var>mask</var> = 128。
            <li>令 <var>max vint length</var> = 8。
            <li>令 <var>number size</var> = 1。
            <li>令 <var>index</var> = 0。
            <li>
                当 <var>number size</var> 小于 <var>max vint length</var> 且小于 <var>length</var> 时，循环：
                <ol>
                    <li>如果 <var>sequence</var>[<var>index</var>] &amp; <var>mask</var> 不为零，终止循环。
                    <li><var>mask</var> 右移一位。
                    <li><var>number size</var> 增加 1。
                </ol>
            <li>令 <var>parsed number</var> = <var>sequence</var>[<var>index</var>] &amp; ~<var>mask</var>。
            <li><var>index</var> 增加 1。
            <li>令 <var>bytes remaining</var> = <var>number size</var> - 1。
            <li>
                当 <var>bytes remaining</var> 不为零时，循环：
                <ol>
                    <li><var>parsed number</var> 左移 8。
                    <li><var>parsed number</var> |= <var>sequence</var>[<var>index</var>]。
                    <li><var>index</var> 增加 1。
                    <li>如果 <var>index</var> 大于等于 <var>length</var>，终止循环。
                    <li><var>bytes remaining</var> 减 1。
                </ol>
            <li>返回 <var>parsed number</var> 和 <var>number size</var>
        </ol>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="matching-a-padded-sequence">匹配填充序列</dfn>
            <var>pattern</var> 在序列 <var>sequence</var> 偏移 <var>offset</var> 到 <var>end</var>，当且仅当 <var>sequence</var>
            长度大于 <var>end</var>，且区间 [<var>offset</var>, <var>end</var>] 的字节与 <var>pattern</var> 完全一致（前面可有若干 0x00），否则返回
            false。
        </p>
        <h4 class="heading settled" data-level="6.2.3" id="signature-for-mp3-without-id3"><span class="secno">6.2.3.
            </span><span class="content">无 ID3 的 MP3 签名</span><a class="self-link"
                href="#signature-for-mp3-without-id3"></a></h4>
        <p>要判断一个<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence①④">字节序列</a>是否<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-lt="matches the signature for MP3 without ID3" data-noexport
                id="matches-the-signature-for-mp3-without-id3">匹配无 ID3 的 MP3 签名</dfn>，使用以下步骤：</p>
        <ol>
            <li>令 <var>sequence</var> 为要匹配的<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                    id="ref-for-byte-sequence①⑤">字节序列</a>，<var>sequence</var>[<var>s</var>] 表示第 <var>s</var> 个<a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                    id="ref-for-byte③⑦">字节</a>，<var>sequence</var>[0] 为第一个字节。
            <li>令 <var>length</var> 为 <var>sequence</var> 的<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte" id="ref-for-byte③⑨">字节</a>数。
            <li>初始化 s 为 0。
            <li>如果 <a href="#match-an-mp3-header" id="ref-for-match-an-mp3-header">匹配 mp3 头</a> 返回 false，返回 false。
            <li>在 <var>sequence</var> 的 <var>s</var> 偏移上<a href="#parse-an-mp3-frame" id="ref-for-parse-an-mp3-frame">解析
                    mp3 帧</a>。
            <li>令 <var>skipped-bytes</var> 为 <a href="#compute-an-mp3-frame-size"
                    id="ref-for-compute-an-mp3-frame-size">计算 mp3 帧大小</a>的返回值。
            <li>如果 <var>skipped-bytes</var> 小于 4，或 <var>skipped-bytes</var> 大于 <var>s</var> - <var>length</var>，返回
                false。
            <li>s 增加 <var>skipped-bytes</var>。
            <li>如果 <a href="#match-an-mp3-header" id="ref-for-match-an-mp3-header①">匹配 mp3 头</a> 返回 false，则返回 false，否则返回
                true。
        </ol>
        <p>要<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="match-an-mp3-header">匹配 mp3 头</dfn>，使用长度为
            <var>length</var> 的<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                id="ref-for-byte-sequence①⑥">字节序列</a> <var>sequence</var> 在偏移 <var>s</var> 上：
        </p>
        <ol>
            <li>若 <var>length</var> 小于 4，返回 false。
            <li>若 <var>sequence</var>[<var>s</var>] 不等于 0xff 且 <var>sequence</var>[<var>s</var> + 1] &amp; 0xe0 不等于
                0xe0，返回 false。
            <li>令 <var>layer</var> = (<var>sequence</var>[<var>s</var>+1] &amp; 0x06) >> 1。
            <li>若 <var>layer</var> 为 0，返回 false。
            <li>令 <var>bit-rate</var> = (<var>sequence</var>[<var>s</var>+2] &amp; 0xf0) >> 4。
            <li>若 <var>bit-rate</var> 为 15，返回 false。
            <li>令 <var>sample-rate</var> = (<var>sequence</var>[<var>s</var>+2] &amp; 0x0c) >> 2。
            <li>若 <var>sample-rate</var> 为 3，返回 false。
            <li>令 <var>freq</var> 为 <var>sample-rate</var> 在 sample-rate 表中的值。
            <li>令 <var>final-layer</var> = 4 - (<var>sequence</var>[<var>s</var>+1])。
            <li>若 (<var>final-layer</var> &amp; 0x06) >> 1 不为 3，返回 false。
            <li>返回 true。
        </ol>
        <p>要<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="compute-an-mp3-frame-size">计算 mp3
                帧大小</dfn>，执行如下：</p>
        <ol>
            <li>若 <var>version</var> 为 1，则 <var>scale</var> = 72，否则 <var>scale</var> = 144。
            <li>令 <var>size</var> = <var>bitrate</var> * <var>scale</var> / <var>freq</var>。
            <li>若 <var>pad</var> 不为零，则 <var>size</var> 增加 1。
            <li>返回 <var>size</var>。
        </ol>
        <p>要<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-an-mp3-frame">解析 mp3 帧</dfn>，执行如下：</p>
        <ol>
            <li><var>version</var> = (<var>sequence</var>[<var>s</var> + 1] &amp; 0x18) >> 3。
            <li><var>bitrate-index</var> = (<var>sequence</var>[<var>s</var> + 2] &amp; 0xf0) >> 4。
            <li>若 <var>version</var> &amp; 0x01 非零，则 <var>bitrate</var> 取 mp2.5-rates 表中 <var>bitrate-index</var> 的值。
            <li>若 <var>version</var> &amp; 0x01 为零，则 <var>bitrate</var> 取 mp3-rates 表中 <var>bitrate-index</var> 的值。
            <li><var>samplerate-index</var> = (<var>sequence</var>[<var>s</var> + 2] &amp; 0x0c) >> 2。
            <li><var>samplerate</var> 为 sample-rate 表中 <var>samplerate-index</var> 的值。
            <li><var>pad</var> = (<var>sequence</var>[<var>s</var> + 2] &amp; 0x02) >> 1。
        </ol>
        <figure>
            <figcaption>mp3-rates 表</figcaption>
            <table>
                <thead>
                    <tr>
                        <th>索引
                        <th>mp3-rates
                <tbody>
                    <tr>
                        <td>0
                        <td>0
                    <tr>
                        <td>1
                        <td>32000
                    <tr>
                        <td>2
                        <td>40000
                    <tr>
                        <td>3
                        <td>48000
                    <tr>
                        <td>4
                        <td>56000
                    <tr>
                        <td>5
                        <td>64000
                    <tr>
                        <td>6
                        <td>80000
                    <tr>
                        <td>7
                        <td>96000
                    <tr>
                        <td>8
                        <td>112000
                    <tr>
                        <td>9
                        <td>128000
                    <tr>
                        <td>10
                        <td>160000
                    <tr>
                        <td>11
                        <td>192000
                    <tr>
                        <td>12
                        <td>224000
                    <tr>
                        <td>13
                        <td>256000
                    <tr>
                        <td>14
                        <td>320000
            </table>
        </figure>
        <figure>
            <figcaption>mp2.5-rates 表</figcaption>
            <table>
                <thead>
                    <tr>
                        <th>索引
                        <th>mp2.5-rates
                <tbody>
                    <tr>
                        <td>0
                        <td>0
                    <tr>
                        <td>1
                        <td>8000
                    <tr>
                        <td>2
                        <td>16000
                    <tr>
                        <td>3
                        <td>24000
                    <tr>
                        <td>4
                        <td>32000
                    <tr>
                        <td>5
                        <td>40000
                    <tr>
                        <td>6
                        <td>48000
                    <tr>
                        <td>7
                        <td>56000
                    <tr>
                        <td>8
                        <td>64000
                    <tr>
                        <td>9
                        <td>80000
                    <tr>
                        <td>10
                        <td>96000
                    <tr>
                        <td>11
                        <td>112000
                    <tr>
                        <td>12
                        <td>128000
                    <tr>
                        <td>13
                        <td>144000
                    <tr>
                        <td>14
                        <td>160000
            </table>
        </figure>
        <figure>
            <figcaption>sample-rate 表</figcaption>
            <table>
                <thead>
                    <tr>
                        <th>索引
                        <th>采样率
                <tbody>
                    <tr>
                        <td>0
                        <td>44100
                    <tr>
                        <td>1
                        <td>48000
                    <tr>
                        <td>2
                        <td>32000
            </table>
        </figure>
        <h3 class="heading settled" data-level="6.3" id="matching-a-font-type-pattern"><span class="secno">6.3.
            </span><span class="content">匹配字体类型模式</span><a class="self-link" href="#matching-a-font-type-pattern"></a>
        </h3>
        <p>要确定<a data-link-type="dfn" href="#font-mime-type" id="ref-for-font-mime-type">字体 MIME 类型</a>的哪一个<a
                data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern⑦">字节模式</a>与 <a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①⑦">字节序列</a>
            <var>input</var> 匹配（如有），请使用如下<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="font-type-pattern-matching-algorithm">字体类型模式匹配算法</dfn>：
        </p>
        <ol>
            <li>
                <p>对下表每一行 <var>row</var> 执行如下步骤：</p>
                <ol>
                    <li>
                        <p>令 <var>patternMatched</var> 为 <a data-link-type="dfn" href="#pattern-matching-algorithm"
                                id="ref-for-pattern-matching-algorithm④">模式匹配算法</a>（参数：<var>input</var>、行首列、行次列、行第三列）的结果。
                        </p>
                    <li>
                        <p>如果 <var>patternMatched</var> 为 true，则返回 <var>row</var> 的第四列值。</p>
                </ol>
                <table>
                    <thead>
                        <tr>
                            <th><a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern⑧">字节模式</a>
                            <th><a data-link-type="dfn" href="#pattern-mask" id="ref-for-pattern-mask④">模式掩码</a>
                            <th>要忽略的前导<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte④⓪">字节</a>
                            <th><a data-link-type="dfn" href="#font-mime-type" id="ref-for-font-mime-type①">字体 MIME
                                    类型</a>
                            <th>说明
                    <tbody>
                        <tr>
                            <td>00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
                                00 00 00 00 00 00 00 00 00 00 4C 50
                            <td>00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
                                00 00 00 00 00 00 00 00 00 00 FF FF
                            <td>无
                            <td><code>application/vnd.ms-fontobject</code>
                            <td>34 个<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte④①">字节</a>后跟字符串 "<code>LP</code>"，即 Embedded OpenType 签名。
                        <tr>
                            <td>00 01 00 00
                            <td>FF FF FF FF
                            <td>无
                            <td><code>font/ttf</code>
                            <td>4 个<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte④②">字节</a>表示版本号 1.0，TrueType 签名。
                        <tr>
                            <td>4F 54 54 4F
                            <td>FF FF FF FF
                            <td>无
                            <td><code>font/otf</code>
                            <td>字符串 "<code>OTTO</code>"，OpenType 签名。
                        <tr>
                            <td>74 74 63 66
                            <td>FF FF FF FF
                            <td>无
                            <td><code>font/collection</code>
                            <td>字符串 "<code>ttcf</code>"，TrueType Collection 签名。
                        <tr>
                            <td>77 4F 46 46
                            <td>FF FF FF FF
                            <td>无
                            <td><code>font/woff</code>
                            <td>字符串 "<code>wOFF</code>"，Web Open Font Format 1.0 签名。
                        <tr>
                            <td>77 4F 46 32
                            <td>FF FF FF FF
                            <td>无
                            <td><code>font/woff2</code>
                            <td>字符串 "<code>wOF2</code>"，Web Open Font Format 2.0 签名。
                </table>
            <li>
                <p>返回 undefined。</p>
        </ol>
        <h3 class="heading settled" data-level="6.4" id="matching-an-archive-type-pattern"><span class="secno">6.4.
            </span><span class="content">匹配归档类型模式</span><a class="self-link"
                href="#matching-an-archive-type-pattern"></a></h3>
        <p>要确定<a data-link-type="dfn" href="#archive-mime-type" id="ref-for-archive-mime-type">归档 MIME 类型</a>的哪一个<a
                data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern⑨">字节模式</a>与 <a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①⑧">字节序列</a>
            <var>input</var> 匹配（如有），请使用如下<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-lt="archive type pattern matching algorithm" data-noexport
                id="archive-type-pattern-matching-algorithm">归档类型模式匹配算法</dfn>：
        </p>
        <ol>
            <li>
                <p>对下表每一行 <var>row</var> 执行如下步骤：</p>
                <ol>
                    <li>
                        <p>令 <var>patternMatched</var> 为 <a data-link-type="dfn" href="#pattern-matching-algorithm"
                                id="ref-for-pattern-matching-algorithm⑤">模式匹配算法</a>（参数：<var>input</var>、行首列、行次列、行第三列）的结果。
                        </p>
                    <li>
                        <p>如果 <var>patternMatched</var> 为 true，则返回 <var>row</var> 的第四列值。</p>
                </ol>
                <table>
                    <thead>
                        <tr>
                            <th><a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern①⓪">字节模式</a>
                            <th><a data-link-type="dfn" href="#pattern-mask" id="ref-for-pattern-mask⑤">模式掩码</a>
                            <th>要忽略的前导<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte④③">字节</a>
                            <th><a data-link-type="dfn" href="#archive-mime-type" id="ref-for-archive-mime-type①">归档
                                    MIME 类型</a>
                            <th>说明
                    <tbody>
                        <tr>
                            <td>1F 8B 08
                            <td>FF FF FF
                            <td>无
                            <td><code>application/x-gzip</code>
                            <td>GZIP 归档签名。
                        <tr>
                            <td>50 4B 03 04
                            <td>FF FF FF FF
                            <td>无
                            <td><code>application/zip</code>
                            <td>字符串 "<code>PK</code>" 后跟 ETX EOT，为 ZIP 归档签名。
                        <tr>
                            <td>52 61 72 21 1A 07 00
                            <td>FF FF FF FF FF FF FF
                            <td>无
                            <td><code>application/x-rar-compressed</code>
                            <td>
                                字符串 "<code>Rar!</code>"，后跟 SUB BEL NUL，即 RAR 4.x 存档签名。
                </table>
            <li>
                <p>返回 undefined。</p>
        </ol>
        <h2 class="heading settled" data-level="7" id="determining-the-computed-mime-type-of-a-resource"><span
                class="secno">7. </span><span class="content">确定资源的计算 MIME 类型</span><a class="self-link"
                href="#determining-the-computed-mime-type-of-a-resource"></a></h2>
        <p>要确定<a data-link-type="dfn" href="#resource" id="ref-for-resource①⑨">资源</a>的<a data-link-type="dfn"
                href="#computed-mime-type" id="ref-for-computed-mime-type">计算出的 MIME 类型</a>，用户代理必须使用如下<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-noexport id="mime-type-sniffing-algorithm">MIME
                类型嗅探算法</dfn>：</p>
        <ol>
            <li>
                如果<a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type⑤">提供的 MIME 类型</a>是<a
                    data-link-type="dfn" href="#xml-mime-type" id="ref-for-xml-mime-type③">XML MIME 类型</a>或<a
                    data-link-type="dfn" href="#html-mime-type" id="ref-for-html-mime-type①">HTML MIME 类型</a>，则<a
                    data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type①">计算出的 MIME 类型</a>为<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type⑥">提供的 MIME 类型</a>。
                <p>终止这些步骤。</p>
            <li>如果<a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type⑦">提供的 MIME
                    类型</a>未定义，或其<a data-link-type="dfn" href="#mime-type-essence"
                    id="ref-for-mime-type-essence①①">本质</a>为
                "<code>unknown/unknown</code>"、"<code>application/unknown</code>" 或 "<code>*/*</code>"，则以 <a
                    data-link-type="dfn" href="#sniff-scriptable-flag"
                    id="ref-for-sniff-scriptable-flag">sniff-scriptable 标志</a>为 <a data-link-type="dfn"
                    href="#no-sniff-flag" id="ref-for-no-sniff-flag">no-sniff 标志</a>的相反值，执行<a data-link-type="dfn"
                    href="#rules-for-identifying-an-unknown-mime-type"
                    id="ref-for-rules-for-identifying-an-unknown-mime-type">未知 MIME 类型识别规则</a>，并终止这些步骤。
            <li>
                如果<a data-link-type="dfn" href="#no-sniff-flag" id="ref-for-no-sniff-flag①">no-sniff 标志</a>已设置，则<a
                    data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type②">计算出的 MIME 类型</a>为<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type⑨">提供的 MIME 类型</a>。
                <p>终止这些步骤。</p>
            <li>如果<a data-link-type="dfn" href="#check-for-apache-bug-flag" id="ref-for-check-for-apache-bug-flag①">检查
                    Apache bug 标志</a>已设置，执行<a data-link-type="dfn" href="#rules-for-text-or-binary"
                    id="ref-for-rules-for-text-or-binary">文本或二进制资源判断规则</a>，并终止这些步骤。
            <li>如果<a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type①⓪">提供的 MIME
                    类型</a>是<a data-link-type="dfn" href="#image-mime-type" id="ref-for-image-mime-type②">被用户代理支持的图像 MIME
                    类型</a>，则令 <var>matched-type</var> 为使用<a data-link-type="dfn"
                    href="#image-type-pattern-matching-algorithm"
                    id="ref-for-image-type-pattern-matching-algorithm">图像类型模式匹配算法</a>，以<a data-link-type="dfn"
                    href="#resource-header" id="ref-for-resource-header②">资源头部</a>为待匹配<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①⑨">字节序列</a>的结果。
            <li>
                如果 <var>matched-type</var> 不为 undefined，<a data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type③">计算出的 MIME 类型</a>为 <var>matched-type</var>。
                <p>终止这些步骤。</p>
            <li>如果<a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type①①">提供的 MIME
                    类型</a>是<a data-link-type="dfn" href="#audio-or-video-mime-type"
                    id="ref-for-audio-or-video-mime-type②">被用户代理支持的音频或视频 MIME 类型</a>，则令 <var>matched-type</var> 为使用<a
                    data-link-type="dfn" href="#audio-or-video-type-pattern-matching-algorithm"
                    id="ref-for-audio-or-video-type-pattern-matching-algorithm">音频或视频类型模式匹配算法</a>，以<a
                    data-link-type="dfn" href="#resource-header" id="ref-for-resource-header③">资源头部</a>为待匹配<a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                    id="ref-for-byte-sequence②⓪">字节序列</a>的结果。
            <li>
                如果 <var>matched-type</var> 不为 undefined，<a data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type④">计算出的 MIME 类型</a>为 <var>matched-type</var>。
                <p>终止这些步骤。</p>
            <li><a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type⑤">计算出的 MIME 类型</a>为<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type①②">提供的 MIME 类型</a>。
        </ol>
        <h3 class="heading settled" data-level="7.1" id="identifying-a-resource-with-an-unknown-mime-type"><span
                class="secno">7.1. </span><span class="content">识别未知 MIME 类型的资源</span><a class="self-link"
                href="#identifying-a-resource-with-an-unknown-mime-type"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="sniff-scriptable-flag">sniff-scriptable
                标志</dfn>用于<a data-link-type="dfn" href="#rules-for-identifying-an-unknown-mime-type"
                id="ref-for-rules-for-identifying-an-unknown-mime-type①">未知 MIME 类型识别规则</a>，判断是否需要嗅探<a
                data-link-type="dfn" href="#scriptable-mime-type" id="ref-for-scriptable-mime-type">可脚本 MIME 类型</a>。</p>
        <p>如果调用<a data-link-type="dfn" href="#rules-for-identifying-an-unknown-mime-type"
                id="ref-for-rules-for-identifying-an-unknown-mime-type②">未知 MIME 类型识别规则</a>时未指定 <a data-link-type="dfn"
                href="#sniff-scriptable-flag" id="ref-for-sniff-scriptable-flag②">sniff-scriptable 标志</a>，则其默认未设置。</p>
        <p>要确定未知<a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type②⑨">MIME 类型</a>的<a data-link-type="dfn"
                href="#resource" id="ref-for-resource②⓪">资源</a> <var>resource</var> 的<a data-link-type="dfn"
                href="#computed-mime-type" id="ref-for-computed-mime-type⑥">计算出的 MIME 类型</a>，执行如下<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-lt="rules for identifying an unknown MIME type"
                data-noexport id="rules-for-identifying-an-unknown-mime-type">未知 MIME 类型识别规则</dfn>：</p>
        <ol>
            <li>
                <p>如果 <a data-link-type="dfn" href="#sniff-scriptable-flag"
                        id="ref-for-sniff-scriptable-flag③">sniff-scriptable 标志</a>已设置，对下表每一行 <var>row</var> 执行：</p>
                <ol>
                    <li>
                        <p>令 <var>patternMatched</var> 为 <a data-link-type="dfn" href="#pattern-matching-algorithm"
                                id="ref-for-pattern-matching-algorithm⑥">模式匹配算法</a>（参数：<var>resource</var> 的<a
                                data-link-type="dfn" href="#resource-header"
                                id="ref-for-resource-header④">资源头部</a>、行首列、行次列、行第三列）的结果。</p>
                    <li>
                        <p>如果 <var>patternMatched</var> 为 true，返回 <var>row</var> 的第四列值。</p>
                </ol>
                <table>
                    <thead>
                        <tr>
                            <th><a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern①①">字节模式</a>
                            <th><a data-link-type="dfn" href="#pattern-mask" id="ref-for-pattern-mask⑥">模式掩码</a>
                            <th>要忽略的前导<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte④④">字节</a>
                            <th><a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type⑦">计算出的
                                    MIME 类型</a>
                            <th>说明
                    <tbody>
                        <tr>
                            <td>3C 21 44 4F 43 54 59 50 45 20 48 54 4D 4C <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF FF DF DF DF DF DF DF DF FF DF DF DF DF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;!DOCTYPE HTML</code>" 后跟<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte">标签终止字节</a>。
                        <tr>
                            <td>3C 48 54 4D 4C <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF DF DF DF DF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte①">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;HTML</code>" 后跟<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte①">标签终止字节</a>。
                        <tr>
                            <td>3C 48 45 41 44 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF DF DF DF DF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte②">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;HEAD</code>" 后跟<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte②">标签终止字节</a>。
                        <tr>
                            <td>3C 53 43 52 49 50 54 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF DF DF DF DF DF DF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte③">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;SCRIPT</code>" 后跟<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte③">标签终止字节</a>。
                        <tr>
                            <td>3C 49 46 52 41 4D 45 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF DF DF DF DF DF DF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte④">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;IFRAME</code>" 后跟<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte④">标签终止字节</a>。
                        <tr>
                            <td>3C 48 31 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF DF FF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte⑤">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;H1</code>" 后跟<a data-link-type="dfn" href="#tag-terminating-byte"
                                    id="ref-for-tag-terminating-byte⑤">标签终止字节</a>。
                        <tr>
                            <td>3C 44 49 56 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF DF DF DF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte⑥">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;DIV</code>" 后跟<a data-link-type="dfn" href="#tag-terminating-byte"
                                    id="ref-for-tag-terminating-byte⑥">标签终止字节</a>。
                        <tr>
                            <td>3C 46 4F 4E 54 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF DF DF DF DF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte⑦">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;FONT</code>" 后跟<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte⑦">标签终止字节</a>。
                        <tr>
                            <td>3C 54 41 42 4C 45 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF DF DF DF DF DF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte⑧">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;TABLE</code>" 后跟<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte⑧">标签终止字节</a>。
                        <tr>
                            <td>3C 41 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF DF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte⑨">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;A</code>" 后跟<a data-link-type="dfn" href="#tag-terminating-byte"
                                    id="ref-for-tag-terminating-byte⑨">标签终止字节</a>。
                        <tr>
                            <td>3C 53 54 59 4C 45 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF DF DF DF DF DF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte①⓪">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;STYLE</code>" 后跟<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte①⓪">标签终止字节</a>。
                        <tr>
                            <td>3C 54 49 54 4C 45 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF DF DF DF DF DF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte①①">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;TITLE</code>" 后跟<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte①①">标签终止字节</a>。
                        <tr>
                            <td>3C 42 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF DF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte①②">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;B</code>" 后跟<a data-link-type="dfn" href="#tag-terminating-byte"
                                    id="ref-for-tag-terminating-byte①②">标签终止字节</a>。
                        <tr>
                            <td>3C 42 4F 44 59 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF DF DF DF DF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte①③">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;BODY</code>" 后跟<a data-link-type="dfn"
                                    href="#tag-terminating-byte" id="ref-for-tag-terminating-byte①③">标签终止字节</a>。
                        <tr>
                            <td>3C 42 52 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF DF DF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte①④">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;BR</code>" 后跟<a data-link-type="dfn" href="#tag-terminating-byte"
                                    id="ref-for-tag-terminating-byte①④">标签终止字节</a>。
                        <tr>
                            <td>3C 50 <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF DF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte①⑤">空白字节</a>
                            <td><code>text/html</code>
                            <td>不区分大小写的字符串 "<code>&lt;P</code>" 后跟<a data-link-type="dfn" href="#tag-terminating-byte"
                                    id="ref-for-tag-terminating-byte①⑤">标签终止字节</a>。
                        <tr>
                            <td>3C 21 2D 2D <abbr data-lt="tag terminating byte">TT</abbr>
                            <td>FF FF FF FF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte①⑥">空白字节</a>
                            <td><code>text/html</code>
                            <td>字符串 "<code>&lt;!--</code>" 后跟<a data-link-type="dfn" href="#tag-terminating-byte"
                                    id="ref-for-tag-terminating-byte①⑥">标签终止字节</a>。
                        <tr>
                            <td>3C 3F 78 6D 6C
                            <td>FF FF FF FF FF
                            <td><a data-link-type="dfn" href="#whitespace-byte" id="ref-for-whitespace-byte①⑦">空白字节</a>
                            <td><code>text/xml</code>
                            <td>字符串 "<code>&lt;?xml</code>"。
                        <tr>
                            <td>25 50 44 46 2D
                            <td>FF FF FF FF FF
                            <td>无
                            <td><code>application/pdf</code>
                            <td>字符串 "<code>%PDF-</code>"，PDF 签名。
                </table>
            <li>
                <p>对下表每一行 <var>row</var> 执行：</p>
                <ol>
                    <li>
                        <p>令 <var>patternMatched</var> 为 <a data-link-type="dfn" href="#pattern-matching-algorithm"
                                id="ref-for-pattern-matching-algorithm⑦">模式匹配算法</a>（参数：<var>resource</var> 的<a
                                data-link-type="dfn" href="#resource-header"
                                id="ref-for-resource-header⑤">资源头部</a>、行首列、行次列、行第三列）的结果。</p>
                    <li>
                        <p>如果 <var>patternMatched</var> 为 true，返回 <var>row</var> 的第四列值。</p>
                </ol>
                <table>
                    <thead>
                        <tr>
                            <th><a data-link-type="dfn" href="#byte-pattern" id="ref-for-byte-pattern①②">字节模式</a>
                            <th><a data-link-type="dfn" href="#pattern-mask" id="ref-for-pattern-mask⑦">模式掩码</a>
                            <th>要忽略的前导<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                                    id="ref-for-byte④⑤">字节</a>
                            <th><a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type⑧">计算出的
                                    MIME 类型</a>
                            <th>说明
                    <tbody>
                        <tr>
                            <td>25 21 50 53 2D 41 64 6F 62 65 2D
                            <td>FF FF FF FF FF FF FF FF FF FF FF
                            <td>无
                            <td><code>application/postscript</code>
                            <td>字符串 "<code>%!PS-Adobe-</code>"，PostScript 签名。
                        <tr>
                            <td>FE FF 00 00
                            <td>FF FF 00 00
                            <td>无
                            <td><code>text/plain</code>
                            <td>UTF-16BE BOM
                        <tr>
                            <td>FF FE 00 00
                            <td>FF FF 00 00
                            <td>无
                            <td><code>text/plain</code>
                            <td>UTF-16LE BOM
                        <tr>
                            <td>EF BB BF 00
                            <td>FF FF FF 00
                            <td>无
                            <td><code>text/plain</code>
                            <td>UTF-8 BOM
                </table>
                <p>用户代理可以隐式扩展此表以支持额外的<a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type③⓪">MIME 类型</a>。</p>
                <p>但用户代理不应隐式扩展此表为任何已在表中的<a data-link-type="dfn" href="#computed-mime-type"
                        id="ref-for-computed-mime-type⑨">计算出的 MIME 类型</a>增加新的<a data-link-type="dfn"
                        href="#byte-pattern" id="ref-for-byte-pattern①③">字节模式</a>，以避免权限提升漏洞。</p>
                <p>用户代理在扩展该表时不得引入权限提升漏洞。</p>
            <li>
                <p>令 <var>matchedType</var> 为使用<a data-link-type="dfn" href="#image-type-pattern-matching-algorithm"
                        id="ref-for-image-type-pattern-matching-algorithm①">图像类型模式匹配算法</a>，以 <var>resource</var> 的<a
                        data-link-type="dfn" href="#resource-header" id="ref-for-resource-header⑥">资源头部</a>为参数的结果。</p>
            <li>
                <p>如果 <var>matchedType</var> 不为 undefined，返回 <var>matchedType</var>。</p>
            <li>
                <p>令 <var>matchedType</var> 为使用<a data-link-type="dfn"
                        href="#audio-or-video-type-pattern-matching-algorithm"
                        id="ref-for-audio-or-video-type-pattern-matching-algorithm①">音频或视频类型模式匹配算法</a>，以
                    <var>resource</var> 的<a data-link-type="dfn" href="#resource-header"
                        id="ref-for-resource-header⑦">资源头部</a>为参数的结果。
                </p>
            <li>
                <p>如果 <var>matchedType</var> 不为 undefined，返回 <var>matchedType</var>。</p>
            <li>
                <p>令 <var>matchedType</var> 为使用<a data-link-type="dfn" href="#archive-type-pattern-matching-algorithm"
                        id="ref-for-archive-type-pattern-matching-algorithm">归档类型模式匹配算法</a>，以 <var>resource</var> 的<a
                        data-link-type="dfn" href="#resource-header" id="ref-for-resource-header⑧">资源头部</a>为参数的结果。</p>
            <li>
                <p>如果 <var>matchedType</var> 不为 undefined，返回 <var>matchedType</var>。</p>
            <li>
                <p>如果 <var>resource</var> 的<a data-link-type="dfn" href="#resource-header"
                        id="ref-for-resource-header⑨">资源头部</a>不包含任何<a data-link-type="dfn" href="#binary-data-byte"
                        id="ref-for-binary-data-byte">二进制数据字节</a>，返回 "<code>text/plain</code>"。</p>
            <li>
                <p>返回 "<code>application/octet-stream</code>"。</p>
        </ol>
        <h3 class="heading settled" data-level="7.2" id="sniffing-a-mislabeled-binary-resource"><span class="secno">7.2.
            </span><span class="content">嗅探标签错误的二进制资源</span><a class="self-link"
                href="#sniffing-a-mislabeled-binary-resource"></a></h3>
        <p>要判断一个二进制<a data-link-type="dfn" href="#resource" id="ref-for-resource②①">资源</a>是否被错误标记为纯文本，执行如下<dfn
                class="dfn-paneled" data-dfn-type="dfn"
                data-lt="rules for distinguishing if a resource is text or binary" data-noexport
                id="rules-for-text-or-binary">文本或二进制资源判断规则</dfn>：</p>
        <ol>
            <li>令 <var>length</var> 为<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte"
                    id="ref-for-byte④⑥">资源头部</a>中的字节数。
            <li>如果 <var>length</var> 大于等于 2 且前 2 个字节为 0xFE 0xFF（UTF-16BE BOM）或 0xFF 0xFE（UTF-16LE BOM），则<a
                    data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type①⓪">计算出的 MIME 类型</a>为
                "<code>text/plain</code>"。<p>终止这些步骤。</p>
            <li>如果 <var>length</var> 大于等于 3 且前 3 个字节为 0xEF 0xBB 0xBF（UTF-8 BOM），则<a data-link-type="dfn"
                    href="#computed-mime-type" id="ref-for-computed-mime-type①①">计算出的 MIME 类型</a>为
                "<code>text/plain</code>"。<p>终止这些步骤。</p>
            <li>如果<a data-link-type="dfn" href="#resource-header" id="ref-for-resource-header①③">资源头部</a>不包含任何<a
                    data-link-type="dfn" href="#binary-data-byte" id="ref-for-binary-data-byte①">二进制数据字节</a>，则<a
                    data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type①②">计算出的 MIME 类型</a>为
                "<code>text/plain</code>"。<p>终止这些步骤。</p>
            <li><a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type①③">计算出的 MIME 类型</a>为
                "<code>application/octet-stream</code>"。
                <p class="warning">必须确保<a data-link-type="dfn" href="#rules-for-text-or-binary"
                        id="ref-for-rules-for-text-or-binary①">文本或二进制资源判断规则</a>永远不会将<a data-link-type="dfn"
                        href="#computed-mime-type" id="ref-for-computed-mime-type①④">计算出的 MIME 类型</a>判定为<a
                        data-link-type="dfn" href="#scriptable-mime-type" id="ref-for-scriptable-mime-type①">可脚本 MIME
                        类型</a>，否则可能带来权限提升攻击。</p>
        </ol>
        <h2 class="heading settled" data-level="8" id="context-specific-sniffing"><span class="secno">8. </span><span
                class="content">上下文相关嗅探</span><a class="self-link" href="#context-specific-sniffing"></a></h2>
        <p class="XXX"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="context">上下文</dfn>是……</p>
        <p>在某些<a data-link-type="dfn" href="#context" id="ref-for-context">上下文</a>中，仅识别属于特定<a data-link-type="dfn"
                href="#mime-type" id="ref-for-mime-type③①">MIME 类型</a>子集的<a data-link-type="dfn" href="#resource"
                id="ref-for-resource②②">资源</a>才有意义。</p>
        <p>在这种<a data-link-type="dfn" href="#context" id="ref-for-context①">上下文</a>中，适合使用<a data-link-type="dfn"
                href="#context-specific-sniffing-algorithm"
                id="ref-for-context-specific-sniffing-algorithm">上下文相关嗅探算法</a>，代替<a data-link-type="dfn"
                href="#mime-type-sniffing-algorithm" id="ref-for-mime-type-sniffing-algorithm③">MIME 类型嗅探算法</a>，以确定<a
                data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type①⑤">计算出的 MIME 类型</a>。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="context-specific-sniffing-algorithm">上下文相关嗅探算法</dfn>仅在<a data-link-type="dfn" href="#resource"
                id="ref-for-resource②④">资源</a>为某一特定<a data-link-type="dfn" href="#context"
                id="ref-for-context②">上下文</a>相关的<a data-link-type="dfn" href="#mime-type" id="ref-for-mime-type③②">MIME
                类型</a>时，确定该<a data-link-type="dfn" href="#resource" id="ref-for-resource②⑤">资源</a>的<a
                data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type①⑥">计算出的 MIME 类型</a>。</p>
        <h3 class="heading settled" data-level="8.1" id="sniffing-in-a-browsing-context"><span class="secno">8.1.
            </span><span class="content">浏览上下文中的嗅探</span><a class="self-link"
                href="#sniffing-in-a-browsing-context"></a></h3>
        <p class="XXX">使用<a data-link-type="dfn" href="#mime-type-sniffing-algorithm"
                id="ref-for-mime-type-sniffing-algorithm④">MIME 类型嗅探算法</a>。</p>
        <h3 class="heading settled" data-level="8.2" id="sniffing-in-an-image-context"><span class="secno">8.2.
            </span><span class="content">图像上下文中的嗅探</span><a class="self-link" href="#sniffing-in-an-image-context"></a>
        </h3>
        <p>要确定带有<a data-link-type="dfn" href="#image-mime-type" id="ref-for-image-mime-type③">图像 MIME 类型</a>的<a
                data-link-type="dfn" href="#resource" id="ref-for-resource②⑥">资源</a>的<a data-link-type="dfn"
                href="#computed-mime-type" id="ref-for-computed-mime-type①⑦">计算出的 MIME 类型</a>，执行如下<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="rules for sniffing images specifically"
                id="rules-for-sniffing-images-specifically">专门针对图像嗅探的规则</dfn>：</p>
        <ol>
            <li>
                如果<a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type①③">提供的 MIME
                    类型</a>是<a data-link-type="dfn" href="#xml-mime-type" id="ref-for-xml-mime-type④">XML MIME 类型</a>，则<a
                    data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type①⑧">计算出的 MIME
                    类型</a>为<a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type①④">提供的 MIME
                    类型</a>。
                <p>终止这些步骤。</p>
            <li>令 <var>image-type-matched</var> 为使用<a data-link-type="dfn" href="#image-type-pattern-matching-algorithm"
                    id="ref-for-image-type-pattern-matching-algorithm②">图像类型模式匹配算法</a>，以<a data-link-type="dfn"
                    href="#resource-header" id="ref-for-resource-header①④">资源头部</a>为待匹配<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence②①">字节序列</a>的结果。
            <li>
                如果 <var>image-type-matched</var> 不为 undefined，<a data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type①⑨">计算出的 MIME 类型</a>为 <var>image-type-matched</var>。
                <p>终止这些步骤。</p>
            <li><a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type②⓪">计算出的 MIME 类型</a>为<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type①⑤">提供的 MIME 类型</a>。
        </ol>
        <h3 class="heading settled" data-level="8.3" id="sniffing-in-an-audio-or-video-context"><span class="secno">8.3.
            </span><span class="content">音频或视频上下文中的嗅探</span><a class="self-link"
                href="#sniffing-in-an-audio-or-video-context"></a></h3>
        <p>要确定具有<a data-link-type="dfn" href="#audio-or-video-mime-type" id="ref-for-audio-or-video-mime-type③">音频或视频
                MIME 类型</a>的<a data-link-type="dfn" href="#resource" id="ref-for-resource②⑦">资源</a>的<a
                data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type②①">计算出的 MIME
                类型</a>，执行如下<dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                data-lt="rules for sniffing audio and video specifically"
                id="rules-for-sniffing-audio-and-video-specifically">专门针对音频和视频嗅探的规则</dfn>：</p>
        <ol>
            <li>
                如果<a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type①⑥">提供的 MIME
                    类型</a>是<a data-link-type="dfn" href="#xml-mime-type" id="ref-for-xml-mime-type⑤">XML MIME 类型</a>，则<a
                    data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type②②">计算出的 MIME
                    类型</a>为<a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type①⑦">提供的 MIME
                    类型</a>。
                <p>终止这些步骤。</p>
            <li>令 <var>audio-or-video-type-matched</var> 为使用<a data-link-type="dfn"
                    href="#audio-or-video-type-pattern-matching-algorithm"
                    id="ref-for-audio-or-video-type-pattern-matching-algorithm②">音频或视频类型模式匹配算法</a>，以<a
                    data-link-type="dfn" href="#resource-header" id="ref-for-resource-header①⑤">资源头部</a>为待匹配<a
                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence"
                    id="ref-for-byte-sequence②②">字节序列</a>的结果。
            <li>
                如果 <var>audio-or-video-type-matched</var> 不为 undefined，<a data-link-type="dfn"
                    href="#computed-mime-type" id="ref-for-computed-mime-type②③">计算出的 MIME 类型</a>为
                <var>audio-or-video-type-matched</var>。
                <p>终止这些步骤。</p>
            <li><a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type②④">计算出的 MIME 类型</a>为<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type①⑧">提供的 MIME 类型</a>。
        </ol>
        <h3 class="heading settled" data-level="8.4" id="sniffing-in-a-plugin-context"><span class="secno">8.4.
            </span><span class="content">插件上下文中的嗅探</span><a class="self-link" href="#sniffing-in-a-plugin-context"></a>
        </h3>
        <p>要确定在插件上下文中<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
                id="ref-for-concept-fetch">获取</a>的<a data-link-type="dfn" href="#resource"
                id="ref-for-resource②⑧">资源</a>的<a data-link-type="dfn" href="#computed-mime-type"
                id="ref-for-computed-mime-type②⑤">计算出的 MIME 类型</a>，执行如下<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-export id="rules-for-sniffing-in-a-plugin-context">插件上下文嗅探规则</dfn>：</p>
        <ol>
            <li class="XXX">如果<a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type①⑨">提供的
                    MIME 类型</a>未定义，<a data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type②⑥">计算出的 MIME 类型</a>为 "<code>application/octet-stream</code>"。
            <li><a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type②⑦">计算出的 MIME 类型</a>为<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type②⓪">提供的 MIME 类型</a>。
        </ol>
        <h3 class="heading settled" data-level="8.5" id="sniffing-in-a-style-context"><span class="secno">8.5.
            </span><span class="content">样式上下文中的嗅探</span><a class="self-link" href="#sniffing-in-a-style-context"></a>
        </h3>
        <p>要确定在样式上下文中<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
                id="ref-for-concept-fetch①">获取</a>的<a data-link-type="dfn" href="#resource"
                id="ref-for-resource②⑨">资源</a>的<a data-link-type="dfn" href="#computed-mime-type"
                id="ref-for-computed-mime-type②⑧">计算出的 MIME 类型</a>，执行如下<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-export id="rules-for-sniffing-in-a-style-context">样式上下文嗅探规则</dfn>：</p>
        <ol>
            <li class="XXX">如果<a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type②①">提供的
                    MIME 类型</a>未定义，……</li>
            <li><a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type②⑨">计算出的 MIME 类型</a>为<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type②②">提供的 MIME 类型</a>。
            </li>
        </ol>
        <h3 class="heading settled" data-level="8.6" id="sniffing-in-a-script-context"><span class="secno">8.6.
            </span><span class="content">脚本上下文中的嗅探</span><a class="self-link" href="#sniffing-in-a-script-context"></a>
        </h3>
        <p>要确定在脚本上下文中<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch"
                id="ref-for-concept-fetch②">获取</a>的<a data-link-type="dfn" href="#resource"
                id="ref-for-resource③⓪">资源</a>的<a data-link-type="dfn" href="#computed-mime-type"
                id="ref-for-computed-mime-type③⓪">计算出的 MIME 类型</a>，执行如下<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-export id="rules-for-sniffing-in-a-script-context">脚本上下文嗅探规则</dfn>：</p>
        <ol>
            <li class="XXX">如果<a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type②③">提供的
                    MIME 类型</a>未定义，……</li>
            <li><a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type③①">计算出的 MIME 类型</a>为<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type②④">提供的 MIME 类型</a>。
            </li>
        </ol>
        <h3 class="heading settled" data-level="8.7" id="sniffing-in-a-font-context"><span class="secno">8.7.
            </span><span class="content">字体上下文中的嗅探</span><a class="self-link" href="#sniffing-in-a-font-context"></a>
        </h3>
        <p>要确定具有<a data-link-type="dfn" href="#font-mime-type" id="ref-for-font-mime-type②">字体 MIME 类型</a>的<a
                data-link-type="dfn" href="#resource" id="ref-for-resource③①">资源</a>的<a data-link-type="dfn"
                href="#computed-mime-type" id="ref-for-computed-mime-type③②">计算出的 MIME 类型</a>，执行如下<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="rules for sniffing fonts specifically"
                id="rules-for-sniffing-fonts-specifically">专门针对字体嗅探的规则</dfn>：</p>
        <ol>
            <li>
                如果<a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type②⑤">提供的 MIME
                    类型</a>是<a data-link-type="dfn" href="#xml-mime-type" id="ref-for-xml-mime-type⑥">XML MIME 类型</a>，则<a
                    data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type③③">计算出的 MIME
                    类型</a>为<a data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type②⑥">提供的 MIME
                    类型</a>。
                <p>终止这些步骤。</p>
            <li>令 <var>font-type-matched</var> 为使用<a data-link-type="dfn" href="#font-type-pattern-matching-algorithm"
                    id="ref-for-font-type-pattern-matching-algorithm">字体类型模式匹配算法</a>，以<a data-link-type="dfn"
                    href="#resource-header" id="ref-for-resource-header①⑥">资源头部</a>为待匹配<a data-link-type="dfn"
                    href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence②③">字节序列</a>的结果。
            <li>
                如果 <var>font-type-matched</var> 不为 undefined，<a data-link-type="dfn" href="#computed-mime-type"
                    id="ref-for-computed-mime-type③④">计算出的 MIME 类型</a>为 <var>font-type-matched</var>。
                <p>终止这些步骤。</p>
            <li><a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type③⑤">计算出的 MIME 类型</a>为<a
                    data-link-type="dfn" href="#supplied-mime-type" id="ref-for-supplied-mime-type②⑦">提供的 MIME 类型</a>。
        </ol>
        <h3 class="heading settled" data-level="8.8" id="sniffing-in-a-text-track-context"><span class="secno">8.8.
            </span><span class="content">文本轨道上下文中的嗅探</span><a class="self-link"
                href="#sniffing-in-a-text-track-context"></a></h3>
        <p class="XXX"><a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type③⑥">计算出的 MIME
                类型</a>为 "<code>text/vtt</code>"。</p>
        <h3 class="heading settled" data-level="8.9" id="sniffing-in-a-cache-manifest-context"><span class="secno">8.9.
            </span><span class="content">缓存清单上下文中的嗅探</span><a class="self-link"
                href="#sniffing-in-a-cache-manifest-context"></a></h3>
        <p class="XXX"><a data-link-type="dfn" href="#computed-mime-type" id="ref-for-computed-mime-type③⑦">计算出的 MIME
                类型</a>为 "<code>text/cache-manifest</code>"。</p>
        <h2 class="no-num heading settled" id="acknowledgements"><span class="content">致谢</span><a class="self-link"
                href="#acknowledgements"></a></h2>
        <p>特别感谢 Adam Barth 和 Ian Hickson 维护了本规范的早期版本。</p>
        <p>还要感谢
            Alfred Hönes、
            Andreu Botella、
            Anne van Kesteren、
            Ben Eidson、
            Boris Zbarsky、
            Darien Maillet Valentine、
            David Singer、
            Domenic Denicola、
            Henri Sivonen、
            Jean-Yves Avenard、
            Jonathan Neal、
            Joshua Cranmer、
            Larry Masinter、
            罗泽轩、
            Mariko Kosaka、
            Mark Pilgrim、
            Paul Adenot、
            Peter Occil、
            Rob Buis、
            Russ Cox、
            Simon Pieters 以及
            triple-underscore
            ，感谢他们的重要贡献。
        </p>
        <p>本标准由 <a href="https://gphemsley.org/">Gordon P. Hemsley</a>（<a
                href="mailto:me@gphemsley.org">me@gphemsley.org</a>）撰写。</p>
        <h2 class="no-num heading settled" id="ipr"><span class="content">知识产权声明</span><a class="self-link"
                href="#ipr"></a></h2>
        <p>Copyright © WHATWG（Apple、Google、Mozilla、Microsoft）。本作品采用 <a
                href="https://creativecommons.org/licenses/by/4.0/" rel="license">知识共享署名 4.0 国际许可证</a>
            许可。若本规范部分内容被整合进源代码，则该部分源代码按 <a href="https://opensource.org/licenses/BSD-3-Clause" rel="license">BSD
                3-Clause License</a> 许可。</p>
        <p>本规范是 Living Standard。如需专利审核版本，请参见 <a href="/review-drafts/2025-07/">Living Standard Review Draft</a>。</p>
    </main>
    <script>
        // "use strict";
        // if ("serviceWorker" in navigator) {
        //     navigator.serviceWorker.register("/service-worker.js");
        // }
    </script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本规范定义的术语</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#archive-mime-type">归档 MIME 类型</a><span>，见 § 4.6</span>
        <li><a href="#archive-type-pattern-matching-algorithm">归档类型模式匹配算法</a><span>，见 § 6.4</span>
        <li><a href="#audio-or-video-mime-type">音频或视频 MIME 类型</a><span>，见 § 4.6</span>
        <li><a href="#audio-or-video-type-pattern-matching-algorithm">音频或视频类型模式匹配算法</a><span>，见 § 6.2</span>
        <li><a href="#binary-data-byte">二进制数据字节</a><span>，见 § 3</span>
        <li><a href="#byte-pattern">字节模式</a><span>，见 § 6</span>
        <li><a href="#check-for-apache-bug-flag">检查 Apache bug 标志</a><span>，见 § 5</span>
        <li><a href="#compute-an-mp3-frame-size">计算 mp3 帧大小</a><span>，见 § 6.2.3</span>
        <li><a href="#computed-mime-type">计算出的 MIME 类型</a><span>，见 § 5</span>
        <li><a href="#context">上下文</a><span>，见 § 8</span>
        <li><a href="#context-specific-sniffing-algorithm">上下文相关嗅探算法</a><span>，见 § 8</span>
        <li><a href="#mime-type-essence">本质（essence）</a><span>，见 § 4.2</span>
        <li><a href="#font-mime-type">字体 MIME 类型</a><span>，见 § 4.6</span>
        <li><a href="#font-type-pattern-matching-algorithm">字体类型模式匹配算法</a><span>，见 § 6.3</span>
        <li><a href="#html-mime-type">HTML MIME 类型</a><span>，见 § 4.6</span>
        <li><a href="#http-quoted-string-token-code-point">HTTP 引号字符串令牌码点</a><span>，见 § 3</span>
        <li><a href="#http-token-code-point">HTTP 令牌码点</a><span>，见 § 3</span>
        <li><a href="#image-mime-type">图像 MIME 类型</a><span>，见 § 4.6</span>
        <li><a href="#image-type-pattern-matching-algorithm">图像类型模式匹配算法</a><span>，见 § 6.1</span>
        <li><a href="#javascript-mime-type">JavaScript MIME 类型</a><span>，见 § 4.6</span>
        <li><a href="#javascript-mime-type-essence-match">JavaScript MIME 类型本质匹配</a><span>，见 § 4.6</span>
        <li><a href="#json-mime-type">JSON MIME 类型</a><span>，见 § 4.6</span>
        <li><a href="#match-an-mp3-header">匹配 mp3 头</a><span>，见 § 6.2.3</span>
        <li><a href="#matches-the-signature-for-mp3-without-id3">匹配无 ID3 的 MP3 签名</a><span>，见 § 6.2.3</span>
        <li><a href="#matches-the-signature-for-mp4">匹配 MP4 签名</a><span>，见 § 6.2.1</span>
        <li><a href="#matches-the-signature-for-webm">匹配 WebM 签名</a><span>，见 § 6.2.2</span>
        <li><a href="#matching-a-padded-sequence">匹配填充序列</a><span>，见 § 6.2.2</span>
        <li><a href="#mime-type">MIME 类型</a><span>，见 § 4.1</span>
        <li><a href="#mime-type">MIME 类型记录</a><span>，见 § 4.1</span>
        <li><a href="#mime-type-sniffing-algorithm">MIME 类型嗅探算法</a><span>，见 § 7</span>
        <li><a href="#minimize-a-supported-mime-type">最简化受支持的 MIME 类型</a><span>，见 § 4.2</span>
        <li><a href="#no-sniff-flag">no-sniff 标志</a><span>，见 § 5</span>
        <li><a href="#parameters">参数（parameters）</a><span>，见 § 4.1</span>
        <li><a href="#parse-a-mime-type">解析 MIME 类型</a><span>，见 § 4.4</span>
        <li><a href="#parse-a-mime-type-from-bytes">从字节解析 MIME 类型</a><span>，见 § 4.4</span>
        <li><a href="#parse-an-mp3-frame">解析 mp3 帧</a><span>，见 § 6.2.3</span>
        <li><a href="#parse-a-vint">解析 vint</a><span>，见 § 6.2.2</span>
        <li><a href="#pattern-mask">模式掩码</a><span>，见 § 6</span>
        <li><a href="#pattern-matching-algorithm">模式匹配算法</a><span>，见 § 6</span>
        <li><a href="#read-the-resource-header">读取资源头部</a><span>，见 § 5.2</span>
        <li><a href="#resource">资源</a><span>，见 § 5</span>
        <li><a href="#resource-header">资源头部</a><span>，见 § 5.2</span>
        <li><a href="#rules-for-text-or-binary">文本或二进制资源判断规则</a><span>，见 § 7.2</span>
        <li><a href="#rules-for-identifying-an-unknown-mime-type">未知 MIME 类型识别规则</a><span>，见 § 7.1</span>
        <li><a href="#rules-for-sniffing-audio-and-video-specifically">专门针对音频和视频嗅探的规则</a><span>，见 § 8.3</span>
        <li><a href="#rules-for-sniffing-fonts-specifically">专门针对字体嗅探的规则</a><span>，见 § 8.7</span>
        <li><a href="#rules-for-sniffing-images-specifically">专门针对图像嗅探的规则</a><span>，见 § 8.2</span>
        <li><a href="#rules-for-sniffing-in-a-plugin-context">插件上下文嗅探规则</a><span>，见 § 8.4</span>
        <li><a href="#rules-for-sniffing-in-a-script-context">脚本上下文嗅探规则</a><span>，见 § 8.6</span>
        <li><a href="#rules-for-sniffing-in-a-style-context">样式上下文嗅探规则</a><span>，见 § 8.5</span>
        <li><a href="#scriptable-mime-type">可脚本 MIME 类型</a><span>，见 § 4.6</span>
        <li><a href="#serialize-a-mime-type">序列化 MIME 类型</a><span>，见 § 4.5</span>
        <li><a href="#serialize-a-mime-type-to-bytes">将 MIME 类型序列化为字节</a><span>，见 § 4.5</span>
        <li><a href="#sniff-scriptable-flag">sniff-scriptable 标志</a><span>，见 § 7.1</span>
        <li><a href="#subtype">子类型（subtype）</a><span>，见 § 4.1</span>
        <li><a href="#supplied-mime-type">提供的 MIME 类型</a><span>，见 § 5</span>
        <li><a href="#supplied-mime-type-detection-algorithm">提供的 MIME 类型检测算法</a><span>，见 § 5.1</span>
        <li><a href="#supported-by-the-user-agent">被用户代理支持</a><span>，见 § 4.2</span>
        <li><a href="#tag-terminating-byte">标签终止字节</a><span>，见 § 3</span>
        <li><a href="#type">主类型（type）</a><span>，见 § 4.1</span>
        <li><a href="#valid-mime-type">有效 MIME 类型字符串</a><span>，见 § 4.3</span>
        <li><a href="#valid-mime-type-with-no-parameters">无参数有效 MIME 类型字符串</a><span>，见 § 4.3</span>
        <li><a href="#whitespace-byte">空白字节</a><span>，见 § 3</span>
        <li><a href="#xml-mime-type">XML MIME 类型</a><span>，见 § 4.6</span>
        <li><a href="#zip-based-mime-type">基于 ZIP 的 MIME 类型</a><span>，见 § 4.6</span>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">引用文献中定义的术语</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[FETCH]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="4456bfd9">收集 HTTP 引号字符串</span>
                <li><span class="dfn-paneled" id="a33db89a">获取（fetch）</span>
                <li><span class="dfn-paneled" id="5fe4ff5e">HTTP 空白符</span>
            </ul>
        <li>
            <a data-link-type="biblio">[HTML]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="0cf3964f">script</span>
                <li><span class="dfn-paneled" id="ee18ab25">type</span>
            </ul>
        <li>
            <a data-link-type="biblio">[HTTP-SEMANTICS]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="9715e3ca">media-type</span>
                <li><span class="dfn-paneled" id="5bc6d4d9">quoted-string</span>
                <li><span class="dfn-paneled" id="750904b2">token</span>
            </ul>
        <li>
            <a data-link-type="biblio">[INFRA]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="f43d6978">ASCII 字母数字</span>
                <li><span class="dfn-paneled" id="7f9469b5">ASCII 不区分大小写</span>
                <li><span class="dfn-paneled" id="6f2dfa22">ASCII 小写</span>
                <li><span class="dfn-paneled" id="2d5a2765">ASCII 字符串</span>
                <li><span class="dfn-paneled" id="5fb1ed8a">ASCII 空白</span>
                <li><span class="dfn-paneled" id="7b0d918d">中断（break）</span>
                <li><span class="dfn-paneled" id="f5354b9d">字节（byte）</span>
                <li><span class="dfn-paneled" id="3de9e659">字节序列</span>
                <li><span class="dfn-paneled" id="915aff5e">码点</span>
                <li><span class="dfn-paneled" id="d24334b4">收集码点序列</span>
                <li><span class="dfn-paneled" id="60184fa5">收集码点序列（进行时）</span>
                <li><span class="dfn-paneled" id="ae8def21">包含（contain）</span>
                <li><span class="dfn-paneled" id="f937b7b6">继续（continue）</span>
                <li><span class="dfn-paneled" id="1243a891">存在（exist）</span>
                <li><span class="dfn-paneled" id="45209803">对于每个（for each）</span>
                <li><span class="dfn-paneled" id="d8b963e8">同构解码（isomorphic decode）</span>
                <li><span class="dfn-paneled" id="16b1470a">同构编码（isomorphic encode）</span>
                <li><span class="dfn-paneled" id="31db57e6">键（keys）</span>
                <li><span class="dfn-paneled" id="36333997">长度（length）</span>
                <li><span class="dfn-paneled" id="84b454ff">有序映射（ordered map）</span>
                <li><span class="dfn-paneled" id="75bee4d5">位置变量</span>
                <li><span class="dfn-paneled" id="15e48c39">集合（set）</span>
                <li><span class="dfn-paneled" id="0e6b2056">设置 <small>(用于映射)</small></span>
                <li><span class="dfn-paneled" id="50c91fa5">跳过 ASCII 空白</span>
                <li><span class="dfn-paneled" id="0698d556">字符串</span>
                <li><span class="dfn-paneled" id="12d6b9a8">值（values）</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">规范性引用</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-encoding">[ENCODING]
        <dd>Anne van Kesteren. <a href="https://encoding.spec.whatwg.org/"><cite>编码标准（Encoding Standard）</cite></a>.
            Living
            Standard. URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
        <dt id="biblio-fetch">[FETCH]
        <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch 标准</cite></a>. Living
            Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
        <dt id="biblio-http-semantics">[HTTP-SEMANTICS]
        <dd>R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed.. <a
                href="https://httpwg.org/specs/rfc9110.html"><cite>HTTP 语义（HTTP Semantics）</cite></a>. 2022年6月. Internet
            Standard. URL: <a href="https://httpwg.org/specs/rfc9110.html">https://httpwg.org/specs/rfc9110.html</a>
        <dt id="biblio-infra">[INFRA]
        <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra
                    标准</cite></a>. Living Standard. URL: <a
                href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
        <dt id="biblio-keywords">[KEYWORDS]
        <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>在RFC中用于指示需求级别的关键词</cite></a>.
            1997年3月. Best Current Practice. URL: <a
                href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
        <dt id="biblio-mimetype">[MIMETYPE]
        <dd>N. Freed; N. Borenstein. <a
                href="https://www.rfc-editor.org/rfc/rfc2046"><cite>多用途互联网邮件扩展（MIME）第二部分：媒体类型</cite></a>. 1996年11月.
            Draft Standard. URL: <a
                href="https://www.rfc-editor.org/rfc/rfc2046">https://www.rfc-editor.org/rfc/rfc2046</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">资料性引用</span><a class="self-link"
            href="#informative"></a></h3>
    <dl>
        <dt id="biblio-ftp">[FTP]
        <dd>J. Postel; J. Reynolds. <a href="https://www.rfc-editor.org/rfc/rfc959"><cite>文件传输协议（File Transfer
                    Protocol）</cite></a>. 1985年10月. Internet Standard. URL: <a
                href="https://www.rfc-editor.org/rfc/rfc959">https://www.rfc-editor.org/rfc/rfc959</a>
        <dt id="biblio-html">[HTML]
        <dd>Anne van Kesteren; 等. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML 标准</cite></a>.
            Living Standard. URL: <a
                href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        <dt id="biblio-mediaqueries">[MEDIAQUERIES]
        <dd>Florian Rivoal; Tab Atkins Jr.. <a href="https://drafts.csswg.org/mediaqueries-4/"><cite>媒体查询 4（Media
                    Queries Level
                    4）</cite></a>. URL: <a
                href="https://drafts.csswg.org/mediaqueries-4/">https://drafts.csswg.org/mediaqueries-4/</a>
        <dt id="biblio-rfc7303">[RFC7303]
        <dd>H. Thompson; C. Lilley. <a href="https://www.rfc-editor.org/rfc/rfc7303"><cite>XML 媒体类型</cite></a>.
            2014年7月. Proposed Standard. URL: <a
                href="https://www.rfc-editor.org/rfc/rfc7303">https://www.rfc-editor.org/rfc/rfc7303</a>
        <dt id="biblio-rfc8081">[RFC8081]
        <dd>C. Lilley. <a href="https://www.rfc-editor.org/rfc/rfc8081"><cite>“font” 顶级媒体类型</cite></a>. 2017年2月.
            Proposed Standard. URL: <a
                href="https://www.rfc-editor.org/rfc/rfc8081">https://www.rfc-editor.org/rfc/rfc8081</a>
        <dt id="biblio-seccontsniff">[SECCONTSNIFF]
        <dd>Adam Barth; Juan Caballero; Dawn Song. <a
                href="https://www.adambarth.com/papers/2009/barth-caballero-song.pdf"><cite>Web
                    浏览器的安全内容嗅探，或如何阻止论文自评（Secure Content Sniffing for
                    Web Browsers, or How to Stop Papers from Reviewing Themselves）</cite></a>. 2009年5月. URL: <a
                href="https://www.adambarth.com/papers/2009/barth-caballero-song.pdf">https://www.adambarth.com/papers/2009/barth-caballero-song.pdf</a>
    </dl>
    <script>/* Boilerplate: script-dom-helper */
        "use strict";
        function query(sel) { return document.querySelector(sel); }

        function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

        function iter(obj) {
            if (!obj) return [];
            var it = obj[Symbol.iterator];
            if (it) return it;
            return Object.entries(obj);
        }

        function mk(tagname, attrs, ...children) {
            const el = document.createElement(tagname);
            for (const [k, v] of iter(attrs)) {
                if (k.slice(0, 3) == "_on") {
                    const eventName = k.slice(3);
                    el.addEventListener(eventName, v);
                } else if (k[0] == "_") {
                    // property, not attribute
                    el[k.slice(1)] = v;
                } else {
                    if (v === false || v == null) {
                        continue;
                    } else if (v === true) {
                        el.setAttribute(k, "");
                        continue;
                    } else {
                        el.setAttribute(k, v);
                    }
                }
            }
            append(el, children);
            return el;
        }

        /* Create shortcuts for every known HTML element */
        [
            "a",
            "abbr",
            "acronym",
            "address",
            "applet",
            "area",
            "article",
            "aside",
            "audio",
            "b",
            "base",
            "basefont",
            "bdo",
            "big",
            "blockquote",
            "body",
            "br",
            "button",
            "canvas",
            "caption",
            "center",
            "cite",
            "code",
            "col",
            "colgroup",
            "datalist",
            "dd",
            "del",
            "details",
            "dfn",
            "dialog",
            "div",
            "dl",
            "dt",
            "em",
            "embed",
            "fieldset",
            "figcaption",
            "figure",
            "font",
            "footer",
            "form",
            "frame",
            "frameset",
            "head",
            "header",
            "h1",
            "h2",
            "h3",
            "h4",
            "h5",
            "h6",
            "hr",
            "html",
            "i",
            "iframe",
            "img",
            "input",
            "ins",
            "kbd",
            "label",
            "legend",
            "li",
            "link",
            "main",
            "map",
            "mark",
            "meta",
            "meter",
            "nav",
            "nobr",
            "noscript",
            "object",
            "ol",
            "optgroup",
            "option",
            "output",
            "p",
            "param",
            "pre",
            "progress",
            "q",
            "s",
            "samp",
            "script",
            "section",
            "select",
            "small",
            "source",
            "span",
            "strike",
            "strong",
            "style",
            "sub",
            "summary",
            "sup",
            "table",
            "tbody",
            "td",
            "template",
            "textarea",
            "tfoot",
            "th",
            "thead",
            "time",
            "title",
            "tr",
            "u",
            "ul",
            "var",
            "video",
            "wbr",
            "xmp",
        ].forEach(tagname => {
            mk[tagname] = (...args) => mk(tagname, ...args);
        });

        function* nodesFromChildList(children) {
            for (const child of children.flat(Infinity)) {
                if (child instanceof Node) {
                    yield child;
                } else {
                    yield new Text(child);
                }
            }
        }
        function append(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                if (el instanceof Node) el.appendChild(child);
                else el.push(child);
            }
            return el;
        }

        function insertAfter(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                el.parentNode.insertBefore(child, el.nextSibling);
            }
            return el;
        }

        function clearContents(el) {
            el.innerHTML = "";
            return el;
        }

        function parseHTML(markup) {
            if (markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
                const doc = document.implementation.createHTMLDocument("");
                doc.documentElement.innerHTML = markup;
                return doc;
            } else {
                const el = mk.template({});
                el.innerHTML = markup;
                return el.content;
            }
        }</script>
    <script>/* Boilerplate: script-dfn-panel */
        "use strict";
        {
            let dfnPanelData = {
                "0698d556": { "dfnID": "0698d556", "dfnText": "string", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-string" }], "title": "4.1. MIME type representation" }, { "refs": [{ "id": "ref-for-string\u2460" }], "title": "4.6. MIME type groups" }], "url": "https://infra.spec.whatwg.org/#string" },
                "0cf3964f": { "dfnID": "0cf3964f", "dfnText": "script", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-script" }], "title": "4.6. MIME type groups" }], "url": "https://html.spec.whatwg.org/multipage/scripting.html#script" },
                "0e6b2056": { "dfnID": "0e6b2056", "dfnText": "set (for map)", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-set" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#map-set" },
                "1243a891": { "dfnID": "1243a891", "dfnText": "exist", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-exists" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#map-exists" },
                "12d6b9a8": { "dfnID": "12d6b9a8", "dfnText": "values", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-getting-the-values" }], "title": "4.1. MIME type representation" }], "url": "https://infra.spec.whatwg.org/#map-getting-the-values" },
                "15e48c39": { "dfnID": "15e48c39", "dfnText": "set", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ordered-set" }], "title": "6. Matching a MIME type pattern" }], "url": "https://infra.spec.whatwg.org/#ordered-set" },
                "16b1470a": { "dfnID": "16b1470a", "dfnText": "isomorphic encode", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-isomorphic-encode" }], "title": "4.5. Serializing a MIME type" }], "url": "https://infra.spec.whatwg.org/#isomorphic-encode" },
                "2d5a2765": { "dfnID": "2d5a2765", "dfnText": "ASCII string", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ascii-string" }, { "id": "ref-for-ascii-string\u2460" }, { "id": "ref-for-ascii-string\u2461" }], "title": "4.1. MIME type representation" }, { "refs": [{ "id": "ref-for-ascii-string\u2462" }], "title": "4.2. MIME type miscellaneous" }], "url": "https://infra.spec.whatwg.org/#ascii-string" },
                "31db57e6": { "dfnID": "31db57e6", "dfnText": "keys", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-getting-the-keys" }], "title": "4.1. MIME type representation" }], "url": "https://infra.spec.whatwg.org/#map-getting-the-keys" },
                "36333997": { "dfnID": "36333997", "dfnText": "length", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-byte-sequence-length" }, { "id": "ref-for-byte-sequence-length\u2460" }, { "id": "ref-for-byte-sequence-length\u2461" }, { "id": "ref-for-byte-sequence-length\u2462" }, { "id": "ref-for-byte-sequence-length\u2463" }, { "id": "ref-for-byte-sequence-length\u2464" }], "title": "6. Matching a MIME type pattern" }], "url": "https://infra.spec.whatwg.org/#byte-sequence-length" },
                "3de9e659": { "dfnID": "3de9e659", "dfnText": "byte sequence", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-byte-sequence" }], "title": "4.4. Parsing a MIME type" }, { "refs": [{ "id": "ref-for-byte-sequence\u2460" }, { "id": "ref-for-byte-sequence\u2461" }], "title": "5.2. Reading the resource header" }, { "refs": [{ "id": "ref-for-byte-sequence\u2462" }, { "id": "ref-for-byte-sequence\u2463" }, { "id": "ref-for-byte-sequence\u2464" }, { "id": "ref-for-byte-sequence\u2465" }], "title": "6. Matching a MIME type pattern" }, { "refs": [{ "id": "ref-for-byte-sequence\u2466" }], "title": "6.1. Matching an image type pattern" }, { "refs": [{ "id": "ref-for-byte-sequence\u2467" }], "title": "6.2. Matching an audio or video type pattern" }, { "refs": [{ "id": "ref-for-byte-sequence\u2468" }, { "id": "ref-for-byte-sequence\u2460\u24ea" }], "title": "6.2.1. Signature for MP4" }, { "refs": [{ "id": "ref-for-byte-sequence\u2460\u2460" }, { "id": "ref-for-byte-sequence\u2460\u2461" }, { "id": "ref-for-byte-sequence\u2460\u2462" }], "title": "6.2.2. Signature for WebM" }, { "refs": [{ "id": "ref-for-byte-sequence\u2460\u2463" }, { "id": "ref-for-byte-sequence\u2460\u2464" }, { "id": "ref-for-byte-sequence\u2460\u2465" }], "title": "6.2.3. Signature for MP3 without ID3" }, { "refs": [{ "id": "ref-for-byte-sequence\u2460\u2466" }], "title": "6.3. Matching a font type pattern" }, { "refs": [{ "id": "ref-for-byte-sequence\u2460\u2467" }], "title": "6.4. Matching an archive type pattern" }, { "refs": [{ "id": "ref-for-byte-sequence\u2460\u2468" }, { "id": "ref-for-byte-sequence\u2461\u24ea" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-byte-sequence\u2461\u2460" }], "title": "8.2. Sniffing in an image context" }, { "refs": [{ "id": "ref-for-byte-sequence\u2461\u2461" }], "title": "8.3. Sniffing in an audio or video context" }, { "refs": [{ "id": "ref-for-byte-sequence\u2461\u2462" }], "title": "8.7. Sniffing in a font context" }], "url": "https://infra.spec.whatwg.org/#byte-sequence" },
                "4456bfd9": { "dfnID": "4456bfd9", "dfnText": "collecting an HTTP quoted string", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-collect-an-http-quoted-string" }], "title": "4.4. Parsing a MIME type" }], "url": "https://fetch.spec.whatwg.org/#collect-an-http-quoted-string" },
                "45209803": { "dfnID": "45209803", "dfnText": "for each", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-iterate" }], "title": "4.5. Serializing a MIME type" }], "url": "https://infra.spec.whatwg.org/#map-iterate" },
                "50c91fa5": { "dfnID": "50c91fa5", "dfnText": "skip ASCII whitespace", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-skip-ascii-whitespace" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#skip-ascii-whitespace" },
                "5bc6d4d9": { "dfnID": "5bc6d4d9", "dfnText": "quoted-string", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-name-quoted-strings" }], "title": "3. Terminology" }], "url": "https://www.rfc-editor.org/rfc/rfc9110#name-quoted-strings" },
                "5fb1ed8a": { "dfnID": "5fb1ed8a", "dfnText": "ASCII whitespace", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ascii-whitespace" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#ascii-whitespace" },
                "5fe4ff5e": { "dfnID": "5fe4ff5e", "dfnText": "HTTP whitespace", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-http-whitespace" }, { "id": "ref-for-http-whitespace\u2460" }, { "id": "ref-for-http-whitespace\u2461" }, { "id": "ref-for-http-whitespace\u2462" }, { "id": "ref-for-http-whitespace\u2463" }], "title": "4.4. Parsing a MIME type" }], "url": "https://fetch.spec.whatwg.org/#http-whitespace" },
                "60184fa5": { "dfnID": "60184fa5", "dfnText": "collecting a sequence of code points", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-collect-a-sequence-of-code-points" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2460" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2461" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2462" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2463" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2464" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points" },
                "6f2dfa22": { "dfnID": "6f2dfa22", "dfnText": "ASCII lowercase", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ascii-lowercase" }, { "id": "ref-for-ascii-lowercase\u2460" }, { "id": "ref-for-ascii-lowercase\u2461" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#ascii-lowercase" },
                "750904b2": { "dfnID": "750904b2", "dfnText": "token", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-name-tokens" }], "title": "3. Terminology" }], "url": "https://www.rfc-editor.org/rfc/rfc9110#name-tokens" },
                "75bee4d5": { "dfnID": "75bee4d5", "dfnText": "position variable", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-string-position-variable" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#string-position-variable" },
                "7b0d918d": { "dfnID": "7b0d918d", "dfnText": "break", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-iteration-break" }], "title": "4.4. Parsing a MIME type" }, { "refs": [{ "id": "ref-for-iteration-break\u2460" }], "title": "6. Matching a MIME type pattern" }], "url": "https://infra.spec.whatwg.org/#iteration-break" },
                "7f9469b5": { "dfnID": "7f9469b5", "dfnText": "ASCII case-insensitive", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ascii-case-insensitive" }], "title": "4.6. MIME type groups" }], "url": "https://infra.spec.whatwg.org/#ascii-case-insensitive" },
                "84b454ff": { "dfnID": "84b454ff", "dfnText": "ordered map", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ordered-map" }], "title": "4.1. MIME type representation" }], "url": "https://infra.spec.whatwg.org/#ordered-map" },
                "915aff5e": { "dfnID": "915aff5e", "dfnText": "code point", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-code-point" }, { "id": "ref-for-code-point\u2460" }], "title": "3. Terminology" }, { "refs": [{ "id": "ref-for-code-point\u2461" }, { "id": "ref-for-code-point\u2462" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#code-point" },
                "9715e3ca": { "dfnID": "9715e3ca", "dfnText": "media-type", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-name-media-type" }], "title": "4.3. MIME type writing" }], "url": "https://www.rfc-editor.org/rfc/rfc9110#name-media-type" },
                "a33db89a": { "dfnID": "a33db89a", "dfnText": "fetch", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-fetch" }], "title": "8.4. Sniffing in a plugin context" }, { "refs": [{ "id": "ref-for-concept-fetch\u2460" }], "title": "8.5. Sniffing in a style context" }, { "refs": [{ "id": "ref-for-concept-fetch\u2461" }], "title": "8.6. Sniffing in a script context" }], "url": "https://fetch.spec.whatwg.org/#concept-fetch" },
                "ae8def21": { "dfnID": "ae8def21", "dfnText": "contain", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-list-contain" }], "title": "6. Matching a MIME type pattern" }], "url": "https://infra.spec.whatwg.org/#list-contain" },
                "archive-mime-type": { "dfnID": "archive-mime-type", "dfnText": "archive MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-archive-mime-type" }, { "id": "ref-for-archive-mime-type\u2460" }], "title": "6.4. Matching an archive type pattern" }], "url": "#archive-mime-type" },
                "archive-type-pattern-matching-algorithm": { "dfnID": "archive-type-pattern-matching-algorithm", "dfnText": "archive type pattern matching\nalgorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-archive-type-pattern-matching-algorithm" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#archive-type-pattern-matching-algorithm" },
                "audio-or-video-mime-type": { "dfnID": "audio-or-video-mime-type", "dfnText": "audio or video MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-audio-or-video-mime-type" }, { "id": "ref-for-audio-or-video-mime-type\u2460" }], "title": "6.2. Matching an audio or video type pattern" }, { "refs": [{ "id": "ref-for-audio-or-video-mime-type\u2461" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-audio-or-video-mime-type\u2462" }], "title": "8.3. Sniffing in an audio or video context" }], "url": "#audio-or-video-mime-type" },
                "audio-or-video-type-pattern-matching-algorithm": { "dfnID": "audio-or-video-type-pattern-matching-algorithm", "dfnText": "audio or video type pattern matching\nalgorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-audio-or-video-type-pattern-matching-algorithm" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-audio-or-video-type-pattern-matching-algorithm\u2460" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-audio-or-video-type-pattern-matching-algorithm\u2461" }], "title": "8.3. Sniffing in an audio or video context" }], "url": "#audio-or-video-type-pattern-matching-algorithm" },
                "binary-data-byte": { "dfnID": "binary-data-byte", "dfnText": "binary data byte", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-binary-data-byte" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-binary-data-byte\u2460" }], "title": "7.2. Sniffing a mislabeled binary resource" }], "url": "#binary-data-byte" },
                "byte-pattern": { "dfnID": "byte-pattern", "dfnText": "byte pattern", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-byte-pattern" }, { "id": "ref-for-byte-pattern\u2460" }, { "id": "ref-for-byte-pattern\u2461" }], "title": "6. Matching a MIME type pattern" }, { "refs": [{ "id": "ref-for-byte-pattern\u2462" }, { "id": "ref-for-byte-pattern\u2463" }], "title": "6.1. Matching an image type pattern" }, { "refs": [{ "id": "ref-for-byte-pattern\u2464" }, { "id": "ref-for-byte-pattern\u2465" }], "title": "6.2. Matching an audio or video type pattern" }, { "refs": [{ "id": "ref-for-byte-pattern\u2466" }, { "id": "ref-for-byte-pattern\u2467" }], "title": "6.3. Matching a font type pattern" }, { "refs": [{ "id": "ref-for-byte-pattern\u2468" }, { "id": "ref-for-byte-pattern\u2460\u24ea" }], "title": "6.4. Matching an archive type pattern" }, { "refs": [{ "id": "ref-for-byte-pattern\u2460\u2460" }, { "id": "ref-for-byte-pattern\u2460\u2461" }, { "id": "ref-for-byte-pattern\u2460\u2462" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#byte-pattern" },
                "check-for-apache-bug-flag": { "dfnID": "check-for-apache-bug-flag", "dfnText": "check-for-apache-bug flag", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-check-for-apache-bug-flag" }], "title": "5.1. Interpreting the resource metadata" }, { "refs": [{ "id": "ref-for-check-for-apache-bug-flag\u2460" }], "title": "7. Determining the computed MIME type of a resource" }], "url": "#check-for-apache-bug-flag" },
                "compute-an-mp3-frame-size": { "dfnID": "compute-an-mp3-frame-size", "dfnText": "compute an mp3 frame size", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-compute-an-mp3-frame-size" }], "title": "6.2.3. Signature for MP3 without ID3" }], "url": "#compute-an-mp3-frame-size" },
                "computed-mime-type": { "dfnID": "computed-mime-type", "dfnText": "computed MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-computed-mime-type" }, { "id": "ref-for-computed-mime-type\u2460" }, { "id": "ref-for-computed-mime-type\u2461" }, { "id": "ref-for-computed-mime-type\u2462" }, { "id": "ref-for-computed-mime-type\u2463" }, { "id": "ref-for-computed-mime-type\u2464" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2465" }, { "id": "ref-for-computed-mime-type\u2466" }, { "id": "ref-for-computed-mime-type\u2467" }, { "id": "ref-for-computed-mime-type\u2468" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2460\u24ea" }, { "id": "ref-for-computed-mime-type\u2460\u2460" }, { "id": "ref-for-computed-mime-type\u2460\u2461" }, { "id": "ref-for-computed-mime-type\u2460\u2462" }, { "id": "ref-for-computed-mime-type\u2460\u2463" }], "title": "7.2. Sniffing a mislabeled binary resource" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2460\u2464" }, { "id": "ref-for-computed-mime-type\u2460\u2465" }], "title": "8. Context-specific sniffing" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2460\u2466" }, { "id": "ref-for-computed-mime-type\u2460\u2467" }, { "id": "ref-for-computed-mime-type\u2460\u2468" }, { "id": "ref-for-computed-mime-type\u2461\u24ea" }], "title": "8.2. Sniffing in an image context" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2461\u2460" }, { "id": "ref-for-computed-mime-type\u2461\u2461" }, { "id": "ref-for-computed-mime-type\u2461\u2462" }, { "id": "ref-for-computed-mime-type\u2461\u2463" }], "title": "8.3. Sniffing in an audio or video context" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2461\u2464" }, { "id": "ref-for-computed-mime-type\u2461\u2465" }, { "id": "ref-for-computed-mime-type\u2461\u2466" }], "title": "8.4. Sniffing in a plugin context" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2461\u2467" }, { "id": "ref-for-computed-mime-type\u2461\u2468" }], "title": "8.5. Sniffing in a style context" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2462\u24ea" }, { "id": "ref-for-computed-mime-type\u2462\u2460" }], "title": "8.6. Sniffing in a script context" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2462\u2461" }, { "id": "ref-for-computed-mime-type\u2462\u2462" }, { "id": "ref-for-computed-mime-type\u2462\u2463" }, { "id": "ref-for-computed-mime-type\u2462\u2464" }], "title": "8.7. Sniffing in a font context" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2462\u2465" }], "title": "8.8. Sniffing in a text track context" }, { "refs": [{ "id": "ref-for-computed-mime-type\u2462\u2466" }], "title": "8.9. Sniffing in a cache manifest context" }], "url": "#computed-mime-type" },
                "context": { "dfnID": "context", "dfnText": "context", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-context" }, { "id": "ref-for-context\u2460" }, { "id": "ref-for-context\u2461" }], "title": "8. Context-specific sniffing" }], "url": "#context" },
                "context-specific-sniffing-algorithm": { "dfnID": "context-specific-sniffing-algorithm", "dfnText": "context-specific sniffing algorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-context-specific-sniffing-algorithm" }], "title": "8. Context-specific sniffing" }], "url": "#context-specific-sniffing-algorithm" },
                "d24334b4": { "dfnID": "d24334b4", "dfnText": "collect a sequence of code points", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-collect-a-sequence-of-code-points" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2460" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2461" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2462" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2463" }, { "id": "ref-for-collect-a-sequence-of-code-points\u2464" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points" },
                "d8b963e8": { "dfnID": "d8b963e8", "dfnText": "isomorphic decode", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-isomorphic-decode" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#isomorphic-decode" },
                "ee18ab25": { "dfnID": "ee18ab25", "dfnText": "type", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-attr-script-type" }], "title": "4.6. MIME type groups" }], "url": "https://html.spec.whatwg.org/multipage/scripting.html#attr-script-type" },
                "f43d6978": { "dfnID": "f43d6978", "dfnText": "ASCII alphanumeric", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ascii-alphanumeric" }], "title": "3. Terminology" }], "url": "https://infra.spec.whatwg.org/#ascii-alphanumeric" },
                "f5354b9d": { "dfnID": "f5354b9d", "dfnText": "byte", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-byte" }, { "id": "ref-for-byte\u2460" }, { "id": "ref-for-byte\u2461" }, { "id": "ref-for-byte\u2462" }, { "id": "ref-for-byte\u2463" }, { "id": "ref-for-byte\u2464" }], "title": "3. Terminology" }, { "refs": [{ "id": "ref-for-byte\u2465" }], "title": "5.1. Interpreting the resource metadata" }, { "refs": [{ "id": "ref-for-byte\u2466" }, { "id": "ref-for-byte\u2467" }, { "id": "ref-for-byte\u2468" }, { "id": "ref-for-byte\u2460\u24ea" }], "title": "5.2. Reading the resource header" }, { "refs": [{ "id": "ref-for-byte\u2460\u2460" }, { "id": "ref-for-byte\u2460\u2461" }, { "id": "ref-for-byte\u2460\u2462" }, { "id": "ref-for-byte\u2460\u2463" }, { "id": "ref-for-byte\u2460\u2464" }], "title": "6. Matching a MIME type pattern" }, { "refs": [{ "id": "ref-for-byte\u2460\u2465" }, { "id": "ref-for-byte\u2460\u2466" }, { "id": "ref-for-byte\u2460\u2467" }, { "id": "ref-for-byte\u2460\u2468" }], "title": "6.1. Matching an image type pattern" }, { "refs": [{ "id": "ref-for-byte\u2461\u24ea" }, { "id": "ref-for-byte\u2461\u2460" }, { "id": "ref-for-byte\u2461\u2461" }, { "id": "ref-for-byte\u2461\u2462" }, { "id": "ref-for-byte\u2461\u2463" }], "title": "6.2. Matching an audio or video type pattern" }, { "refs": [{ "id": "ref-for-byte\u2461\u2464" }, { "id": "ref-for-byte\u2461\u2465" }, { "id": "ref-for-byte\u2461\u2466" }, { "id": "ref-for-byte\u2461\u2467" }, { "id": "ref-for-byte\u2461\u2468" }, { "id": "ref-for-byte\u2462\u24ea" }, { "id": "ref-for-byte\u2462\u2460" }, { "id": "ref-for-byte\u2462\u2461" }], "title": "6.2.1. Signature for MP4" }, { "refs": [{ "id": "ref-for-byte\u2462\u2462" }, { "id": "ref-for-byte\u2462\u2463" }, { "id": "ref-for-byte\u2462\u2464" }, { "id": "ref-for-byte\u2462\u2465" }], "title": "6.2.2. Signature for WebM" }, { "refs": [{ "id": "ref-for-byte\u2462\u2466" }, { "id": "ref-for-byte\u2462\u2467" }, { "id": "ref-for-byte\u2462\u2468" }], "title": "6.2.3. Signature for MP3 without ID3" }, { "refs": [{ "id": "ref-for-byte\u2463\u24ea" }, { "id": "ref-for-byte\u2463\u2460" }, { "id": "ref-for-byte\u2463\u2461" }], "title": "6.3. Matching a font type pattern" }, { "refs": [{ "id": "ref-for-byte\u2463\u2462" }], "title": "6.4. Matching an archive type pattern" }, { "refs": [{ "id": "ref-for-byte\u2463\u2463" }, { "id": "ref-for-byte\u2463\u2464" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-byte\u2463\u2465" }], "title": "7.2. Sniffing a mislabeled binary resource" }], "url": "https://infra.spec.whatwg.org/#byte" },
                "f937b7b6": { "dfnID": "f937b7b6", "dfnText": "continue", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-iteration-continue" }, { "id": "ref-for-iteration-continue\u2460" }], "title": "4.4. Parsing a MIME type" }], "url": "https://infra.spec.whatwg.org/#iteration-continue" },
                "font-mime-type": { "dfnID": "font-mime-type", "dfnText": "font MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-font-mime-type" }, { "id": "ref-for-font-mime-type\u2460" }], "title": "6.3. Matching a font type pattern" }, { "refs": [{ "id": "ref-for-font-mime-type\u2461" }], "title": "8.7. Sniffing in a font context" }], "url": "#font-mime-type" },
                "font-type-pattern-matching-algorithm": { "dfnID": "font-type-pattern-matching-algorithm", "dfnText": "font type pattern matching algorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-font-type-pattern-matching-algorithm" }], "title": "8.7. Sniffing in a font context" }], "url": "#font-type-pattern-matching-algorithm" },
                "html-mime-type": { "dfnID": "html-mime-type", "dfnText": "HTML MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-html-mime-type" }], "title": "4.6. MIME type groups" }, { "refs": [{ "id": "ref-for-html-mime-type\u2460" }], "title": "7. Determining the computed MIME type of a resource" }], "url": "#html-mime-type" },
                "http-quoted-string-token-code-point": { "dfnID": "http-quoted-string-token-code-point", "dfnText": "HTTP quoted-string token code point", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-http-quoted-string-token-code-point" }], "title": "4.1. MIME type representation" }, { "refs": [{ "id": "ref-for-http-quoted-string-token-code-point\u2460" }], "title": "4.4. Parsing a MIME type" }], "url": "#http-quoted-string-token-code-point" },
                "http-token-code-point": { "dfnID": "http-token-code-point", "dfnText": "HTTP token code point", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-http-token-code-point" }], "title": "3. Terminology" }, { "refs": [{ "id": "ref-for-http-token-code-point\u2460" }, { "id": "ref-for-http-token-code-point\u2461" }, { "id": "ref-for-http-token-code-point\u2462" }], "title": "4.4. Parsing a MIME type" }, { "refs": [{ "id": "ref-for-http-token-code-point\u2463" }], "title": "4.5. Serializing a MIME type" }], "url": "#http-token-code-point" },
                "image-mime-type": { "dfnID": "image-mime-type", "dfnText": "image MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-image-mime-type" }, { "id": "ref-for-image-mime-type\u2460" }], "title": "6.1. Matching an image type pattern" }, { "refs": [{ "id": "ref-for-image-mime-type\u2461" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-image-mime-type\u2462" }], "title": "8.2. Sniffing in an image context" }], "url": "#image-mime-type" },
                "image-type-pattern-matching-algorithm": { "dfnID": "image-type-pattern-matching-algorithm", "dfnText": "image type pattern matching algorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-image-type-pattern-matching-algorithm" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-image-type-pattern-matching-algorithm\u2460" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-image-type-pattern-matching-algorithm\u2461" }], "title": "8.2. Sniffing in an image context" }], "url": "#image-type-pattern-matching-algorithm" },
                "javascript-mime-type": { "dfnID": "javascript-mime-type", "dfnText": "JavaScript MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-javascript-mime-type" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-for-javascript-mime-type\u2460" }], "title": "4.6. MIME type groups" }], "url": "#javascript-mime-type" },
                "javascript-mime-type-essence-match": { "dfnID": "javascript-mime-type-essence-match", "dfnText": "JavaScript MIME type essence match", "external": false, "refSections": [], "url": "#javascript-mime-type-essence-match" },
                "json-mime-type": { "dfnID": "json-mime-type", "dfnText": "JSON MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-json-mime-type" }], "title": "4.2. MIME type miscellaneous" }], "url": "#json-mime-type" },
                "match-an-mp3-header": { "dfnID": "match-an-mp3-header", "dfnText": "match an mp3 header", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-match-an-mp3-header" }, { "id": "ref-for-match-an-mp3-header" }], "title": "6.2.3. Signature for MP3 without ID3" }], "url": "#match-an-mp3-header" },
                "matches-the-signature-for-mp3-without-id3": { "dfnID": "matches-the-signature-for-mp3-without-id3", "dfnText": "matches the signature\nfor MP3 without ID3", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-matches-the-signature-for-mp3-without-id3" }], "title": "6.2. Matching an audio or video type pattern" }], "url": "#matches-the-signature-for-mp3-without-id3" },
                "matches-the-signature-for-mp4": { "dfnID": "matches-the-signature-for-mp4", "dfnText": "matches the signature\n for MP4", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-matches-the-signature-for-mp4" }], "title": "6.2. Matching an audio or video type pattern" }], "url": "#matches-the-signature-for-mp4" },
                "matches-the-signature-for-webm": { "dfnID": "matches-the-signature-for-webm", "dfnText": "matches the signature\n for WebM", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-matches-the-signature-for-webm" }], "title": "6.2. Matching an audio or video type pattern" }], "url": "#matches-the-signature-for-webm" },
                "matching-a-padded-sequence": { "dfnID": "matching-a-padded-sequence", "dfnText": "Matching a padded sequence", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-matching-a-padded-sequence" }], "title": "6.2.2. Signature for WebM" }], "url": "#matching-a-padded-sequence" },
                "mime-type": { "dfnID": "mime-type", "dfnText": "MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-mime-type" }, { "id": "ref-for-mime-type\u2460" }, { "id": "ref-for-mime-type\u2461" }, { "id": "ref-for-mime-type\u2462" }, { "id": "ref-for-mime-type\u2463" }], "title": "4.1. MIME type representation" }, { "refs": [{ "id": "ref-for-mime-type\u2464" }, { "id": "ref-for-mime-type\u2465" }, { "id": "ref-for-mime-type\u2466" }, { "id": "ref-for-mime-type\u2467" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-for-mime-type\u2468" }], "title": "4.3. MIME type writing" }, { "refs": [{ "id": "ref-for-mime-type\u2460\u24ea" }], "title": "4.4. Parsing a MIME type" }, { "refs": [{ "id": "ref-for-mime-type\u2460\u2460" }, { "id": "ref-for-mime-type\u2460\u2461" }], "title": "4.5. Serializing a MIME type" }, { "refs": [{ "id": "ref-for-mime-type\u2460\u2462" }, { "id": "ref-for-mime-type\u2460\u2463" }, { "id": "ref-for-mime-type\u2460\u2464" }, { "id": "ref-for-mime-type\u2460\u2465" }, { "id": "ref-for-mime-type\u2460\u2466" }, { "id": "ref-for-mime-type\u2460\u2467" }, { "id": "ref-for-mime-type\u2460\u2468" }, { "id": "ref-for-mime-type\u2461\u24ea" }, { "id": "ref-for-mime-type\u2461\u2460" }, { "id": "ref-for-mime-type\u2461\u2461" }], "title": "4.6. MIME type groups" }, { "refs": [{ "id": "ref-for-mime-type\u2461\u2462" }, { "id": "ref-for-mime-type\u2461\u2463" }], "title": "5. Handling a resource" }, { "refs": [{ "id": "ref-for-mime-type\u2461\u2464" }, { "id": "ref-for-mime-type\u2461\u2465" }, { "id": "ref-for-mime-type\u2461\u2466" }, { "id": "ref-for-mime-type\u2461\u2467" }], "title": "5.1. Interpreting the resource metadata" }, { "refs": [{ "id": "ref-for-mime-type\u2461\u2468" }, { "id": "ref-for-mime-type\u2462\u24ea" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-mime-type\u2462\u2460" }, { "id": "ref-for-mime-type\u2462\u2461" }], "title": "8. Context-specific sniffing" }], "url": "#mime-type" },
                "mime-type-essence": { "dfnID": "mime-type-essence", "dfnText": "essence", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-mime-type-essence" }, { "id": "ref-for-mime-type-essence\u2460" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-for-mime-type-essence\u2461" }, { "id": "ref-for-mime-type-essence\u2462" }, { "id": "ref-for-mime-type-essence\u2463" }, { "id": "ref-for-mime-type-essence\u2464" }, { "id": "ref-for-mime-type-essence\u2465" }, { "id": "ref-for-mime-type-essence\u2466" }, { "id": "ref-for-mime-type-essence\u2467" }, { "id": "ref-for-mime-type-essence\u2468" }, { "id": "ref-for-mime-type-essence\u2460\u24ea" }], "title": "4.6. MIME type groups" }, { "refs": [{ "id": "ref-for-mime-type-essence\u2460\u2460" }], "title": "7. Determining the computed MIME type of a resource" }], "url": "#mime-type-essence" },
                "mime-type-sniffing-algorithm": { "dfnID": "mime-type-sniffing-algorithm", "dfnText": "MIME type sniffing algorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-mime-type-sniffing-algorithm" }, { "id": "ref-for-mime-type-sniffing-algorithm\u2460" }], "title": "5. Handling a resource" }, { "refs": [{ "id": "ref-for-mime-type-sniffing-algorithm\u2461" }], "title": "5.2. Reading the resource header" }, { "refs": [{ "id": "ref-for-mime-type-sniffing-algorithm\u2462" }], "title": "8. Context-specific sniffing" }, { "refs": [{ "id": "ref-for-mime-type-sniffing-algorithm\u2463" }], "title": "8.1. Sniffing in a browsing context" }], "url": "#mime-type-sniffing-algorithm" },
                "minimize-a-supported-mime-type": { "dfnID": "minimize-a-supported-mime-type", "dfnText": "minimize a supported MIME type", "external": false, "refSections": [], "url": "#minimize-a-supported-mime-type" },
                "no-sniff-flag": { "dfnID": "no-sniff-flag", "dfnText": "no-sniff flag", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-no-sniff-flag" }, { "id": "ref-for-no-sniff-flag\u2460" }], "title": "7. Determining the computed MIME type of a resource" }], "url": "#no-sniff-flag" },
                "parameters": { "dfnID": "parameters", "dfnText": "parameters", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-parameters" }], "title": "4.3. MIME type writing" }, { "refs": [{ "id": "ref-for-parameters\u2460" }, { "id": "ref-for-parameters\u2461" }], "title": "4.4. Parsing a MIME type" }, { "refs": [{ "id": "ref-for-parameters\u2462" }], "title": "4.5. Serializing a MIME type" }], "url": "#parameters" },
                "parse-a-mime-type": { "dfnID": "parse-a-mime-type", "dfnText": "parse a MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-parse-a-mime-type" }], "title": "4.3. MIME type writing" }, { "refs": [{ "id": "ref-for-parse-a-mime-type\u2460" }], "title": "4.4. Parsing a MIME type" }], "url": "#parse-a-mime-type" },
                "parse-a-mime-type-from-bytes": { "dfnID": "parse-a-mime-type-from-bytes", "dfnText": "parse a MIME type from bytes", "external": false, "refSections": [], "url": "#parse-a-mime-type-from-bytes" },
                "parse-a-vint": { "dfnID": "parse-a-vint", "dfnText": "parse a vint", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-parse-a-vint" }], "title": "6.2.2. Signature for WebM" }], "url": "#parse-a-vint" },
                "parse-an-mp3-frame": { "dfnID": "parse-an-mp3-frame", "dfnText": "parse an mp3 frame", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-parse-an-mp3-frame" }], "title": "6.2.3. Signature for MP3 without ID3" }], "url": "#parse-an-mp3-frame" },
                "pattern-mask": { "dfnID": "pattern-mask", "dfnText": "pattern mask", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-pattern-mask" }, { "id": "ref-for-pattern-mask\u2460" }], "title": "6. Matching a MIME type pattern" }, { "refs": [{ "id": "ref-for-pattern-mask\u2461" }], "title": "6.1. Matching an image type pattern" }, { "refs": [{ "id": "ref-for-pattern-mask\u2462" }], "title": "6.2. Matching an audio or video type pattern" }, { "refs": [{ "id": "ref-for-pattern-mask\u2463" }], "title": "6.3. Matching a font type pattern" }, { "refs": [{ "id": "ref-for-pattern-mask\u2464" }], "title": "6.4. Matching an archive type pattern" }, { "refs": [{ "id": "ref-for-pattern-mask\u2465" }, { "id": "ref-for-pattern-mask\u2466" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#pattern-mask" },
                "pattern-matching-algorithm": { "dfnID": "pattern-matching-algorithm", "dfnText": "pattern matching algorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-pattern-matching-algorithm" }, { "id": "ref-for-pattern-matching-algorithm\u2460" }], "title": "6. Matching a MIME type pattern" }, { "refs": [{ "id": "ref-for-pattern-matching-algorithm\u2461" }], "title": "6.1. Matching an image type pattern" }, { "refs": [{ "id": "ref-for-pattern-matching-algorithm\u2462" }], "title": "6.2. Matching an audio or video type pattern" }, { "refs": [{ "id": "ref-for-pattern-matching-algorithm\u2463" }], "title": "6.3. Matching a font type pattern" }, { "refs": [{ "id": "ref-for-pattern-matching-algorithm\u2464" }], "title": "6.4. Matching an archive type pattern" }, { "refs": [{ "id": "ref-for-pattern-matching-algorithm\u2465" }, { "id": "ref-for-pattern-matching-algorithm\u2466" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#pattern-matching-algorithm" },
                "read-the-resource-header": { "dfnID": "read-the-resource-header", "dfnText": "read the resource header", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-read-the-resource-header" }], "title": "5.2. Reading the resource header" }], "url": "#read-the-resource-header" },
                "resource": { "dfnID": "resource", "dfnText": "resource", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-resource" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-for-resource\u2460" }, { "id": "ref-for-resource\u2461" }, { "id": "ref-for-resource\u2462" }, { "id": "ref-for-resource\u2463" }], "title": "5. Handling a resource" }, { "refs": [{ "id": "ref-for-resource\u2464" }, { "id": "ref-for-resource\u2465" }, { "id": "ref-for-resource\u2466" }, { "id": "ref-for-resource\u2467" }, { "id": "ref-for-resource\u2468" }, { "id": "ref-for-resource\u2460\u24ea" }, { "id": "ref-for-resource\u2460\u2460" }, { "id": "ref-for-resource\u2460\u2461" }, { "id": "ref-for-resource\u2460\u2462" }, { "id": "ref-for-resource\u2460\u2463" }], "title": "5.1. Interpreting the resource metadata" }, { "refs": [{ "id": "ref-for-resource\u2460\u2464" }, { "id": "ref-for-resource\u2460\u2465" }, { "id": "ref-for-resource\u2460\u2466" }, { "id": "ref-for-resource\u2460\u2467" }], "title": "5.2. Reading the resource header" }, { "refs": [{ "id": "ref-for-resource\u2460\u2468" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-resource\u2461\u24ea" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-resource\u2461\u2460" }], "title": "7.2. Sniffing a mislabeled binary resource" }, { "refs": [{ "id": "ref-for-resource\u2461\u2461" }, { "id": "ref-for-resource\u2461\u2462" }, { "id": "ref-for-resource\u2461\u2463" }, { "id": "ref-for-resource\u2461\u2464" }], "title": "8. Context-specific sniffing" }, { "refs": [{ "id": "ref-for-resource\u2461\u2465" }], "title": "8.2. Sniffing in an image context" }, { "refs": [{ "id": "ref-for-resource\u2461\u2466" }], "title": "8.3. Sniffing in an audio or video context" }, { "refs": [{ "id": "ref-for-resource\u2461\u2467" }], "title": "8.4. Sniffing in a plugin context" }, { "refs": [{ "id": "ref-for-resource\u2461\u2468" }], "title": "8.5. Sniffing in a style context" }, { "refs": [{ "id": "ref-for-resource\u2462\u24ea" }], "title": "8.6. Sniffing in a script context" }, { "refs": [{ "id": "ref-for-resource\u2462\u2460" }], "title": "8.7. Sniffing in a font context" }], "url": "#resource" },
                "resource-header": { "dfnID": "resource-header", "dfnText": "resource header", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-resource-header" }, { "id": "ref-for-resource-header\u2460" }], "title": "5.2. Reading the resource header" }, { "refs": [{ "id": "ref-for-resource-header\u2461" }, { "id": "ref-for-resource-header\u2462" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-resource-header\u2463" }, { "id": "ref-for-resource-header\u2464" }, { "id": "ref-for-resource-header\u2465" }, { "id": "ref-for-resource-header\u2466" }, { "id": "ref-for-resource-header\u2467" }, { "id": "ref-for-resource-header\u2468" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-resource-header\u2460\u24ea" }, { "id": "ref-for-resource-header\u2460\u2460" }, { "id": "ref-for-resource-header\u2460\u2461" }, { "id": "ref-for-resource-header\u2460\u2462" }], "title": "7.2. Sniffing a mislabeled binary resource" }, { "refs": [{ "id": "ref-for-resource-header\u2460\u2463" }], "title": "8.2. Sniffing in an image context" }, { "refs": [{ "id": "ref-for-resource-header\u2460\u2464" }], "title": "8.3. Sniffing in an audio or video context" }, { "refs": [{ "id": "ref-for-resource-header\u2460\u2465" }], "title": "8.7. Sniffing in a font context" }], "url": "#resource-header" },
                "rules-for-identifying-an-unknown-mime-type": { "dfnID": "rules-for-identifying-an-unknown-mime-type", "dfnText": "rules for identifying an unknown MIME\ntype", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-rules-for-identifying-an-unknown-mime-type" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-rules-for-identifying-an-unknown-mime-type\u2460" }, { "id": "ref-for-rules-for-identifying-an-unknown-mime-type\u2461" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#rules-for-identifying-an-unknown-mime-type" },
                "rules-for-sniffing-audio-and-video-specifically": { "dfnID": "rules-for-sniffing-audio-and-video-specifically", "dfnText": "rules\n for sniffing audio and video specifically", "external": false, "refSections": [], "url": "#rules-for-sniffing-audio-and-video-specifically" },
                "rules-for-sniffing-fonts-specifically": { "dfnID": "rules-for-sniffing-fonts-specifically", "dfnText": "rules for sniffing\n fonts specifically", "external": false, "refSections": [], "url": "#rules-for-sniffing-fonts-specifically" },
                "rules-for-sniffing-images-specifically": { "dfnID": "rules-for-sniffing-images-specifically", "dfnText": "rules for\n sniffing images specifically", "external": false, "refSections": [], "url": "#rules-for-sniffing-images-specifically" },
                "rules-for-sniffing-in-a-plugin-context": { "dfnID": "rules-for-sniffing-in-a-plugin-context", "dfnText": "rules for sniffing in a plugin context", "external": false, "refSections": [], "url": "#rules-for-sniffing-in-a-plugin-context" },
                "rules-for-sniffing-in-a-script-context": { "dfnID": "rules-for-sniffing-in-a-script-context", "dfnText": "rules for sniffing in a script context", "external": false, "refSections": [], "url": "#rules-for-sniffing-in-a-script-context" },
                "rules-for-sniffing-in-a-style-context": { "dfnID": "rules-for-sniffing-in-a-style-context", "dfnText": "rules for sniffing in a style context", "external": false, "refSections": [], "url": "#rules-for-sniffing-in-a-style-context" },
                "rules-for-text-or-binary": { "dfnID": "rules-for-text-or-binary", "dfnText": "rules for\n distinguishing if a resource is text or binary", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-rules-for-text-or-binary" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-rules-for-text-or-binary\u2460" }], "title": "7.2. Sniffing a mislabeled binary resource" }], "url": "#rules-for-text-or-binary" },
                "scriptable-mime-type": { "dfnID": "scriptable-mime-type", "dfnText": "scriptable MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-scriptable-mime-type" }], "title": "7.1. Identifying a resource with an unknown MIME type" }, { "refs": [{ "id": "ref-for-scriptable-mime-type\u2460" }], "title": "7.2. Sniffing a mislabeled binary resource" }], "url": "#scriptable-mime-type" },
                "serialize-a-mime-type": { "dfnID": "serialize-a-mime-type", "dfnText": "serialize a MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-serialize-a-mime-type" }], "title": "4.5. Serializing a MIME type" }], "url": "#serialize-a-mime-type" },
                "serialize-a-mime-type-to-bytes": { "dfnID": "serialize-a-mime-type-to-bytes", "dfnText": "serialize a MIME type to bytes", "external": false, "refSections": [], "url": "#serialize-a-mime-type-to-bytes" },
                "sniff-scriptable-flag": { "dfnID": "sniff-scriptable-flag", "dfnText": "sniff-scriptable flag", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-sniff-scriptable-flag" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-sniff-scriptable-flag\u2460" }, { "id": "ref-for-sniff-scriptable-flag\u2461" }, { "id": "ref-for-sniff-scriptable-flag\u2462" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#sniff-scriptable-flag" },
                "subtype": { "dfnID": "subtype", "dfnText": "subtype", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-subtype" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-for-subtype\u2460" }], "title": "4.4. Parsing a MIME type" }, { "refs": [{ "id": "ref-for-subtype\u2461" }], "title": "4.5. Serializing a MIME type" }, { "refs": [{ "id": "ref-for-subtype\u2462" }, { "id": "ref-for-subtype\u2463" }, { "id": "ref-for-subtype\u2464" }], "title": "4.6. MIME type groups" }], "url": "#subtype" },
                "supplied-mime-type": { "dfnID": "supplied-mime-type", "dfnText": "supplied MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-supplied-mime-type" }, { "id": "ref-for-supplied-mime-type\u2460" }, { "id": "ref-for-supplied-mime-type\u2461" }, { "id": "ref-for-supplied-mime-type\u2462" }, { "id": "ref-for-supplied-mime-type\u2463" }], "title": "5.1. Interpreting the resource metadata" }, { "refs": [{ "id": "ref-for-supplied-mime-type\u2464" }, { "id": "ref-for-supplied-mime-type\u2465" }, { "id": "ref-for-supplied-mime-type\u2466" }, { "id": "ref-for-supplied-mime-type\u2467" }, { "id": "ref-for-supplied-mime-type\u2468" }, { "id": "ref-for-supplied-mime-type\u2460\u24ea" }, { "id": "ref-for-supplied-mime-type\u2460\u2460" }, { "id": "ref-for-supplied-mime-type\u2460\u2461" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-supplied-mime-type\u2460\u2462" }, { "id": "ref-for-supplied-mime-type\u2460\u2463" }, { "id": "ref-for-supplied-mime-type\u2460\u2464" }], "title": "8.2. Sniffing in an image context" }, { "refs": [{ "id": "ref-for-supplied-mime-type\u2460\u2465" }, { "id": "ref-for-supplied-mime-type\u2460\u2466" }, { "id": "ref-for-supplied-mime-type\u2460\u2467" }], "title": "8.3. Sniffing in an audio or video context" }, { "refs": [{ "id": "ref-for-supplied-mime-type\u2460\u2468" }, { "id": "ref-for-supplied-mime-type\u2461\u24ea" }], "title": "8.4. Sniffing in a plugin context" }, { "refs": [{ "id": "ref-for-supplied-mime-type\u2461\u2460" }, { "id": "ref-for-supplied-mime-type\u2461\u2461" }], "title": "8.5. Sniffing in a style context" }, { "refs": [{ "id": "ref-for-supplied-mime-type\u2461\u2462" }, { "id": "ref-for-supplied-mime-type\u2461\u2463" }], "title": "8.6. Sniffing in a script context" }, { "refs": [{ "id": "ref-for-supplied-mime-type\u2461\u2464" }, { "id": "ref-for-supplied-mime-type\u2461\u2465" }, { "id": "ref-for-supplied-mime-type\u2461\u2466" }], "title": "8.7. Sniffing in a font context" }], "url": "#supplied-mime-type" },
                "supplied-mime-type-detection-algorithm": { "dfnID": "supplied-mime-type-detection-algorithm", "dfnText": "supplied MIME type detection\n algorithm", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-supplied-mime-type-detection-algorithm" }], "title": "5. Handling a resource" }, { "refs": [{ "id": "ref-for-supplied-mime-type-detection-algorithm\u2460" }], "title": "5.1. Interpreting the resource metadata" }], "url": "#supplied-mime-type-detection-algorithm" },
                "supported-by-the-user-agent": { "dfnID": "supported-by-the-user-agent", "dfnText": "supported by the user agent", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-supported-by-the-user-agent" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-for-supported-by-the-user-agent\u2460" }, { "id": "ref-for-supported-by-the-user-agent\u2461" }], "title": "7. Determining the computed MIME type of a resource" }], "url": "#supported-by-the-user-agent" },
                "tag-terminating-byte": { "dfnID": "tag-terminating-byte", "dfnText": "tag-terminating byte", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-tag-terminating-byte" }, { "id": "ref-for-tag-terminating-byte\u2460" }, { "id": "ref-for-tag-terminating-byte\u2461" }, { "id": "ref-for-tag-terminating-byte\u2462" }, { "id": "ref-for-tag-terminating-byte\u2463" }, { "id": "ref-for-tag-terminating-byte\u2464" }, { "id": "ref-for-tag-terminating-byte\u2465" }, { "id": "ref-for-tag-terminating-byte\u2466" }, { "id": "ref-for-tag-terminating-byte\u2467" }, { "id": "ref-for-tag-terminating-byte\u2468" }, { "id": "ref-for-tag-terminating-byte\u2460\u24ea" }, { "id": "ref-for-tag-terminating-byte\u2460\u2460" }, { "id": "ref-for-tag-terminating-byte\u2460\u2461" }, { "id": "ref-for-tag-terminating-byte\u2460\u2462" }, { "id": "ref-for-tag-terminating-byte\u2460\u2463" }, { "id": "ref-for-tag-terminating-byte\u2460\u2464" }, { "id": "ref-for-tag-terminating-byte\u2460\u2465" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#tag-terminating-byte" },
                "type": { "dfnID": "type", "dfnText": "type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-type" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-for-type\u2460" }], "title": "4.4. Parsing a MIME type" }, { "refs": [{ "id": "ref-for-type\u2461" }], "title": "4.5. Serializing a MIME type" }, { "refs": [{ "id": "ref-for-type\u2462" }, { "id": "ref-for-type\u2463" }, { "id": "ref-for-type\u2464" }], "title": "4.6. MIME type groups" }], "url": "#type" },
                "valid-mime-type": { "dfnID": "valid-mime-type", "dfnText": "valid MIME type string", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valid-mime-type" }, { "id": "ref-for-valid-mime-type\u2460" }, { "id": "ref-for-valid-mime-type\u2461" }, { "id": "ref-for-valid-mime-type\u2462" }, { "id": "ref-for-valid-mime-type\u2463" }], "title": "4.3. MIME type writing" }], "url": "#valid-mime-type" },
                "valid-mime-type-with-no-parameters": { "dfnID": "valid-mime-type-with-no-parameters", "dfnText": "valid MIME type string with no parameters", "external": false, "refSections": [], "url": "#valid-mime-type-with-no-parameters" },
                "whitespace-byte": { "dfnID": "whitespace-byte", "dfnText": "whitespace byte", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-whitespace-byte" }, { "id": "ref-for-whitespace-byte\u2460" }, { "id": "ref-for-whitespace-byte\u2461" }, { "id": "ref-for-whitespace-byte\u2462" }, { "id": "ref-for-whitespace-byte\u2463" }, { "id": "ref-for-whitespace-byte\u2464" }, { "id": "ref-for-whitespace-byte\u2465" }, { "id": "ref-for-whitespace-byte\u2466" }, { "id": "ref-for-whitespace-byte\u2467" }, { "id": "ref-for-whitespace-byte\u2468" }, { "id": "ref-for-whitespace-byte\u2460\u24ea" }, { "id": "ref-for-whitespace-byte\u2460\u2460" }, { "id": "ref-for-whitespace-byte\u2460\u2461" }, { "id": "ref-for-whitespace-byte\u2460\u2462" }, { "id": "ref-for-whitespace-byte\u2460\u2463" }, { "id": "ref-for-whitespace-byte\u2460\u2464" }, { "id": "ref-for-whitespace-byte\u2460\u2465" }, { "id": "ref-for-whitespace-byte\u2460\u2466" }], "title": "7.1. Identifying a resource with an unknown MIME type" }], "url": "#whitespace-byte" },
                "xml-mime-type": { "dfnID": "xml-mime-type", "dfnText": "XML MIME type", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-xml-mime-type" }, { "id": "ref-for-xml-mime-type\u2460" }], "title": "4.2. MIME type miscellaneous" }, { "refs": [{ "id": "ref-for-xml-mime-type\u2461" }], "title": "4.6. MIME type groups" }, { "refs": [{ "id": "ref-for-xml-mime-type\u2462" }], "title": "7. Determining the computed MIME type of a resource" }, { "refs": [{ "id": "ref-for-xml-mime-type\u2463" }], "title": "8.2. Sniffing in an image context" }, { "refs": [{ "id": "ref-for-xml-mime-type\u2464" }], "title": "8.3. Sniffing in an audio or video context" }, { "refs": [{ "id": "ref-for-xml-mime-type\u2465" }], "title": "8.7. Sniffing in a font context" }], "url": "#xml-mime-type" },
                "zip-based-mime-type": { "dfnID": "zip-based-mime-type", "dfnText": "ZIP-based MIME type", "external": false, "refSections": [], "url": "#zip-based-mime-type" },
            };

            document.addEventListener("DOMContentLoaded", () => {
                genAllDfnPanels();

                document.body.addEventListener("click", (e) => {
                    // If not handled already, just hide all dfn panels.
                    hideAllDfnPanels();
                });
            });

            window.addEventListener("resize", () => {
                // Pin any visible dfn panel
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => positionDfnPanel(el));
            });

            function genAllDfnPanels() {
                for (const panelData of Object.values(dfnPanelData)) {
                    const dfnID = panelData.dfnID;
                    const dfn = document.getElementById(dfnID);
                    if (!dfn) {
                        console.log(`Can't find dfn#${dfnID}.`, panelData);
                        continue;
                    }
                    dfn.panelData = panelData;
                    insertDfnPopupAction(dfn);
                }
            }

            function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
                const dfnPanel = mk.aside({
                    class: "dfn-panel on",
                    id: `infopanel-for-${dfnID}`,
                    "data-for": dfnID,
                    "aria-labelled-by": `infopaneltitle-for-${dfnID}`,
                },
                    mk.span({ id: `infopaneltitle-for-${dfnID}`, style: "display:none" },
                        `Info about the '${dfnText}' ${external ? "external" : ""} reference.`),
                    mk.a({ href: url, class: "dfn-link" }, url),
                    refSections.length == 0 ? [] :
                        mk.b({}, "Referenced in:"),
                    mk.ul({},
                        ...refSections.map(section =>
                            mk.li({},
                                ...section.refs.map((ref, refI) =>
                                    [
                                        mk.a({ href: `#${ref.id}` },
                                            (refI == 0) ? section.title : `(${refI + 1})`
                                        ),
                                        " ",
                                    ]
                                ),
                            ),
                        ),
                    ),
                    genLinkingSyntaxes(dfn),
                );

                dfnPanel.addEventListener('click', (event) => {
                    if (event.target.nodeName == 'A') {
                        scrollToTargetAndHighlight(event);
                        pinDfnPanel(dfnPanel);
                    }
                    event.stopPropagation();
                    refocusOnTarget(event);
                });
                dfnPanel.addEventListener('keydown', (event) => {
                    if (event.keyCode == 27) { // Escape key
                        hideDfnPanel({ dfnPanel });
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });

                dfnPanel.dfn = dfn;
                dfn.dfnPanel = dfnPanel;
                return dfnPanel;
            }



            function hideAllDfnPanels() {
                // Delete the currently-active dfn panel.
                queryAll(".dfn-panel").forEach(dfnPanel => hideDfnPanel({ dfnPanel }));
            }

            function showDfnPanel(dfn) {
                hideAllDfnPanels(); // Only display one at a time.

                dfn.setAttribute("aria-expanded", "true");

                const dfnPanel = genDfnPanel(dfn, dfn.panelData);

                // Give the dfn a unique tabindex, and then
                // give all the tabbable panel bits successive indexes.
                let tabIndex = 100;
                dfn.tabIndex = tabIndex++;
                const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
                for (const el of tabbable) {
                    el.tabIndex = tabIndex++;
                }

                append(document.body, dfnPanel);
                positionDfnPanel(dfnPanel);
            }

            function positionDfnPanel(dfnPanel) {
                const dfn = dfnPanel.dfn;
                const dfnPos = getBounds(dfn);
                dfnPanel.style.top = dfnPos.bottom + "px";
                dfnPanel.style.left = dfnPos.left + "px";

                const panelPos = dfnPanel.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
                    dfnPanel.style.left = newLeft + "px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.position = "fixed";
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel({ dfn, dfnPanel }) {
                if (!dfnPanel) dfnPanel = dfn.dfnPanel;
                if (!dfn) dfn = dfnPanel.dfn;
                dfn.dfnPanel = undefined;
                dfnPanel.dfn = undefined;
                dfn.setAttribute("aria-expanded", "false");
                dfn.tabIndex = undefined;
                dfnPanel.remove()
            }

            function toggleDfnPanel(dfn) {
                if (dfn.dfnPanel) {
                    hideDfnPanel(dfn);
                } else {
                    showDfnPanel(dfn);
                }
            }

            function insertDfnPopupAction(dfn) {
                dfn.setAttribute('role', 'button');
                dfn.setAttribute('aria-expanded', 'false')
                dfn.tabIndex = 0;
                dfn.classList.add('has-dfn-panel');
                dfn.addEventListener('click', (event) => {
                    toggleDfnPanel(dfn);
                    event.stopPropagation();
                });
                dfn.addEventListener('keypress', (event) => {
                    const kc = event.keyCode;
                    // 32->Space, 13->Enter
                    if (kc == 32 || kc == 13) {
                        toggleDfnPanel(dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });
            }

            function refocusOnTarget(event) {
                const target = event.target;
                setTimeout(() => {
                    // Refocus on the event.target element.
                    // This is needed after browser scrolls to the destination.
                    target.focus();
                });
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function scrollToTargetAndHighlight(event) {
                let hash = event.target.hash;
                if (hash) {
                    hash = decodeURIComponent(hash.substring(1));
                    const dest = document.getElementById(hash);
                    if (dest) {
                        dest.classList.add('highlighted');
                        setTimeout(() => dest.classList.remove('highlighted'), 1000);
                    }
                }
            }

            // Functions, divided by link type, that wrap an autolink's
            // contents with the appropriate outer syntax.
            // Alternately, a string naming another type they format
            // the same as.
            function needsFor(type) {
                switch (type) {
                    case "descriptor":
                    case "value":
                    case "element-attr":
                    case "attr-value":
                    case "element-state":
                    case "method":
                    case "constructor":
                    case "argument":
                    case "attribute":
                    case "const":
                    case "dict-member":
                    case "event":
                    case "enum-value":
                    case "stringifier":
                    case "serializer":
                    case "iterator":
                    case "maplike":
                    case "setlike":
                    case "state":
                    case "mode":
                    case "context":
                    case "facet": return true;

                    default: return false;
                }
            }
            function refusesFor(type) {
                switch (type) {
                    case "property":
                    case "element":
                    case "interface":
                    case "namespace":
                    case "callback":
                    case "dictionary":
                    case "enum":
                    case "exception":
                    case "typedef":
                    case "http-header":
                    case "permission": return true;

                    default: return false;
                }
            }
            function linkFormatterFromType(type) {
                switch (type) {
                    case 'scheme':
                    case 'permission':
                    case 'dfn': return (text) => `[=${text}=]`;

                    case 'abstract-op': return (text) => `[\$${text}\$]`;

                    case 'function':
                    case 'at-rule':
                    case 'selector':
                    case 'value': return (text) => `''${text}''`;

                    case 'http-header': return (text) => `[:${text}:]`;

                    case 'interface':
                    case 'constructor':
                    case 'method':
                    case 'argument':
                    case 'attribute':
                    case 'callback':
                    case 'dictionary':
                    case 'dict-member':
                    case 'enum':
                    case 'enum-value':
                    case 'exception':
                    case 'const':
                    case 'typedef':
                    case 'stringifier':
                    case 'serializer':
                    case 'iterator':
                    case 'maplike':
                    case 'setlike':
                    case 'extended-attribute':
                    case 'event':
                    case 'idl': return (text) => `{{${text}}}`;

                    case 'element-state':
                    case 'element-attr':
                    case 'attr-value':
                    case 'element': return (element) => `<{${element}}>`;

                    case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

                    case 'type': return (text) => `<<${text}>>`;

                    case 'descriptor':
                    case 'property': return (text) => `'${text}'`;

                    default: return;
                };
            };

            function genLinkingSyntaxes(dfn) {
                if (dfn.tagName != "DFN") return;

                const type = dfn.getAttribute('data-dfn-type');
                if (!type) {
                    console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
                    return [];
                }

                // Return a function that wraps link text based on the type
                const linkFormatter = linkFormatterFromType(type);
                if (!linkFormatter) {
                    console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
                    return [];
                }

                let ltAlts;
                if (dfn.hasAttribute('data-lt')) {
                    ltAlts = dfn.getAttribute('data-lt')
                        .split("|")
                        .map(x => x.trim());
                } else {
                    ltAlts = [dfn.textContent.trim()];
                }
                if (type == "type") {
                    // lt of "<foo>", but "foo" is the interior;
                    // <<foo/bar>> is how you write it with a for,
                    // not <foo/<bar>> or whatever.
                    for (var i = 0; i < ltAlts.length; i++) {
                        const lt = ltAlts[i];
                        const match = /<(.*)>/.exec(lt);
                        if (match) { ltAlts[i] = match[1]; }
                    }
                }

                let forAlts;
                if (dfn.hasAttribute('data-dfn-for')) {
                    forAlts = dfn.getAttribute('data-dfn-for')
                        .split(",")
                        .map(x => x.trim());
                } else {
                    forAlts = [''];
                }

                let linkingSyntaxes = [];
                if (!needsFor(type)) {
                    for (const lt of ltAlts) {
                        linkingSyntaxes.push(linkFormatter(lt));
                    }
                }
                if (!refusesFor(type)) {
                    for (const f of forAlts) {
                        linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
                    }
                }
                return [
                    mk.b({}, 'Possible linking syntaxes:'),
                    mk.ul({},
                        ...linkingSyntaxes.map(link => {
                            const copyLink = async () =>
                                await navigator.clipboard.writeText(link);
                            return mk.li({},
                                mk.div({ class: 'link-item' },
                                    mk.button({
                                        class: 'copy-icon', title: 'Copy',
                                        type: 'button',
                                        _onclick: copyLink,
                                        tabindex: 0,
                                    }, mk.span({ class: 'icon' })),
                                    mk.span({}, link)
                                )
                            );
                        })
                    )
                ];
            }
        }
    </script>
    <script>/* Boilerplate: script-ref-hints */
        "use strict";
        {
            let refsData = {
                "#archive-mime-type": { "displayText": "archive mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "archive mime type", "type": "dfn", "url": "#archive-mime-type" },
                "#archive-type-pattern-matching-algorithm": { "displayText": "archive type pattern matching algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "archive type pattern matching algorithm", "type": "dfn", "url": "#archive-type-pattern-matching-algorithm" },
                "#audio-or-video-mime-type": { "displayText": "audio or video mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "audio or video mime type", "type": "dfn", "url": "#audio-or-video-mime-type" },
                "#audio-or-video-type-pattern-matching-algorithm": { "displayText": "audio or video type pattern matching algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "audio or video type pattern matching algorithm", "type": "dfn", "url": "#audio-or-video-type-pattern-matching-algorithm" },
                "#binary-data-byte": { "displayText": "binary data byte", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "binary data byte", "type": "dfn", "url": "#binary-data-byte" },
                "#byte-pattern": { "displayText": "byte pattern", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "byte pattern", "type": "dfn", "url": "#byte-pattern" },
                "#check-for-apache-bug-flag": { "displayText": "check-for-apache-bug flag", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "check-for-apache-bug flag", "type": "dfn", "url": "#check-for-apache-bug-flag" },
                "#computed-mime-type": { "displayText": "computed mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "computed mime type", "type": "dfn", "url": "#computed-mime-type" },
                "#context": { "displayText": "context", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "context", "type": "dfn", "url": "#context" },
                "#context-specific-sniffing-algorithm": { "displayText": "context-specific sniffing algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "context-specific sniffing algorithm", "type": "dfn", "url": "#context-specific-sniffing-algorithm" },
                "#font-mime-type": { "displayText": "font mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "font mime type", "type": "dfn", "url": "#font-mime-type" },
                "#font-type-pattern-matching-algorithm": { "displayText": "font type pattern matching algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "font type pattern matching algorithm", "type": "dfn", "url": "#font-type-pattern-matching-algorithm" },
                "#html-mime-type": { "displayText": "html mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "html mime type", "type": "dfn", "url": "#html-mime-type" },
                "#http-quoted-string-token-code-point": { "displayText": "http quoted-string token code point", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "http quoted-string token code point", "type": "dfn", "url": "#http-quoted-string-token-code-point" },
                "#http-token-code-point": { "displayText": "http token code point", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "http token code point", "type": "dfn", "url": "#http-token-code-point" },
                "#image-mime-type": { "displayText": "image mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "image mime type", "type": "dfn", "url": "#image-mime-type" },
                "#image-type-pattern-matching-algorithm": { "displayText": "image type pattern matching algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "image type pattern matching algorithm", "type": "dfn", "url": "#image-type-pattern-matching-algorithm" },
                "#javascript-mime-type": { "displayText": "javascript mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "javascript mime type", "type": "dfn", "url": "#javascript-mime-type" },
                "#json-mime-type": { "displayText": "json mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "json mime type", "type": "dfn", "url": "#json-mime-type" },
                "#matches-the-signature-for-mp3-without-id3": { "displayText": "matches the signature for mp3 without id3", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "matches the signature for mp3 without id3", "type": "dfn", "url": "#matches-the-signature-for-mp3-without-id3" },
                "#matches-the-signature-for-mp4": { "displayText": "matches the signature for mp4", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "matches the signature for mp4", "type": "dfn", "url": "#matches-the-signature-for-mp4" },
                "#matches-the-signature-for-webm": { "displayText": "matches the signature for webm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "matches the signature for webm", "type": "dfn", "url": "#matches-the-signature-for-webm" },
                "#mime-type": { "displayText": "mime type record", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "mime type record", "type": "dfn", "url": "#mime-type" },
                "#mime-type-essence": { "displayText": "essence", "export": true, "for_": ["MIME type"], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "essence", "type": "dfn", "url": "#mime-type-essence" },
                "#mime-type-sniffing-algorithm": { "displayText": "mime type sniffing algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "mime type sniffing algorithm", "type": "dfn", "url": "#mime-type-sniffing-algorithm" },
                "#no-sniff-flag": { "displayText": "no-sniff flag", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "no-sniff flag", "type": "dfn", "url": "#no-sniff-flag" },
                "#parameters": { "displayText": "parameters", "export": true, "for_": ["MIME type"], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "parameters", "type": "dfn", "url": "#parameters" },
                "#parse-a-mime-type": { "displayText": "parse a mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "parse a mime type", "type": "dfn", "url": "#parse-a-mime-type" },
                "#pattern-mask": { "displayText": "pattern mask", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "pattern mask", "type": "dfn", "url": "#pattern-mask" },
                "#pattern-matching-algorithm": { "displayText": "pattern matching algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "pattern matching algorithm", "type": "dfn", "url": "#pattern-matching-algorithm" },
                "#read-the-resource-header": { "displayText": "read the resource header", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "read the resource header", "type": "dfn", "url": "#read-the-resource-header" },
                "#resource": { "displayText": "resource", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "resource", "type": "dfn", "url": "#resource" },
                "#resource-header": { "displayText": "resource header", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "resource header", "type": "dfn", "url": "#resource-header" },
                "#rules-for-identifying-an-unknown-mime-type": { "displayText": "rules for identifying an unknown mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "rules for identifying an unknown mime type", "type": "dfn", "url": "#rules-for-identifying-an-unknown-mime-type" },
                "#rules-for-text-or-binary": { "displayText": "rules for distinguishing if a resource is text or binary", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "rules for distinguishing if a resource is text or binary", "type": "dfn", "url": "#rules-for-text-or-binary" },
                "#scriptable-mime-type": { "displayText": "scriptable mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "scriptable mime type", "type": "dfn", "url": "#scriptable-mime-type" },
                "#serialize-a-mime-type": { "displayText": "serialize a mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "serialize a mime type", "type": "dfn", "url": "#serialize-a-mime-type" },
                "#sniff-scriptable-flag": { "displayText": "sniff-scriptable flag", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "sniff-scriptable flag", "type": "dfn", "url": "#sniff-scriptable-flag" },
                "#subtype": { "displayText": "subtype", "export": true, "for_": ["MIME type"], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "subtype", "type": "dfn", "url": "#subtype" },
                "#supplied-mime-type": { "displayText": "supplied mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "supplied mime type", "type": "dfn", "url": "#supplied-mime-type" },
                "#supplied-mime-type-detection-algorithm": { "displayText": "supplied mime type detection algorithm", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "supplied mime type detection algorithm", "type": "dfn", "url": "#supplied-mime-type-detection-algorithm" },
                "#supported-by-the-user-agent": { "displayText": "supported by the user agent", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "supported by the user agent", "type": "dfn", "url": "#supported-by-the-user-agent" },
                "#tag-terminating-byte": { "displayText": "tag-terminating byte", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "tag-terminating byte", "type": "dfn", "url": "#tag-terminating-byte" },
                "#type": { "displayText": "type", "export": true, "for_": ["MIME type"], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "type", "type": "dfn", "url": "#type" },
                "#valid-mime-type": { "displayText": "valid mime type string", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "valid mime type string", "type": "dfn", "url": "#valid-mime-type" },
                "#whitespace-byte": { "displayText": "whitespace byte", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "whitespace byte", "type": "dfn", "url": "#whitespace-byte" },
                "#xml-mime-type": { "displayText": "xml mime type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "mimesniff", "spec": "mimesniff", "status": "local", "text": "xml mime type", "type": "dfn", "url": "#xml-mime-type" },
                "https://fetch.spec.whatwg.org/#collect-an-http-quoted-string": { "displayText": "collecting an HTTP quoted string", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "fetch", "spec": "fetch", "status": "current", "text": "collecting an http quoted string", "type": "dfn", "url": "https://fetch.spec.whatwg.org/#collect-an-http-quoted-string" },
                "https://fetch.spec.whatwg.org/#concept-fetch": { "displayText": "fetch", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "fetch", "spec": "fetch", "status": "current", "text": "fetch", "type": "dfn", "url": "https://fetch.spec.whatwg.org/#concept-fetch" },
                "https://fetch.spec.whatwg.org/#http-whitespace": { "displayText": "HTTP whitespace", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "fetch", "spec": "fetch", "status": "current", "text": "http whitespace", "type": "dfn", "url": "https://fetch.spec.whatwg.org/#http-whitespace" },
                "https://html.spec.whatwg.org/multipage/scripting.html#attr-script-type": { "displayText": "type", "export": true, "for_": ["script"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "type", "type": "element-attr", "url": "https://html.spec.whatwg.org/multipage/scripting.html#attr-script-type" },
                "https://html.spec.whatwg.org/multipage/scripting.html#script": { "displayText": "script", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "script", "type": "element", "url": "https://html.spec.whatwg.org/multipage/scripting.html#script" },
                "https://infra.spec.whatwg.org/#ascii-alphanumeric": { "displayText": "ASCII alphanumeric", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "ascii alphanumeric", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ascii-alphanumeric" },
                "https://infra.spec.whatwg.org/#ascii-case-insensitive": { "displayText": "ASCII case-insensitive", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "ascii case-insensitive", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ascii-case-insensitive" },
                "https://infra.spec.whatwg.org/#ascii-lowercase": { "displayText": "ASCII lowercase", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "ascii lowercase", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ascii-lowercase" },
                "https://infra.spec.whatwg.org/#ascii-string": { "displayText": "ASCII string", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "ascii string", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ascii-string" },
                "https://infra.spec.whatwg.org/#ascii-whitespace": { "displayText": "ASCII whitespace", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "ascii whitespace", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ascii-whitespace" },
                "https://infra.spec.whatwg.org/#byte": { "displayText": "byte", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "byte", "type": "dfn", "url": "https://infra.spec.whatwg.org/#byte" },
                "https://infra.spec.whatwg.org/#byte-sequence": { "displayText": "byte sequence", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "byte sequence", "type": "dfn", "url": "https://infra.spec.whatwg.org/#byte-sequence" },
                "https://infra.spec.whatwg.org/#byte-sequence-length": { "displayText": "length", "export": true, "for_": ["byte sequence"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "length", "type": "dfn", "url": "https://infra.spec.whatwg.org/#byte-sequence-length" },
                "https://infra.spec.whatwg.org/#code-point": { "displayText": "code point", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "code point", "type": "dfn", "url": "https://infra.spec.whatwg.org/#code-point" },
                "https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points": { "displayText": "collecting a sequence of code points", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "collecting a sequence of code points", "type": "dfn", "url": "https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points" },
                "https://infra.spec.whatwg.org/#isomorphic-decode": { "displayText": "isomorphic decode", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "isomorphic decode", "type": "dfn", "url": "https://infra.spec.whatwg.org/#isomorphic-decode" },
                "https://infra.spec.whatwg.org/#isomorphic-encode": { "displayText": "isomorphic encode", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "isomorphic encode", "type": "dfn", "url": "https://infra.spec.whatwg.org/#isomorphic-encode" },
                "https://infra.spec.whatwg.org/#iteration-break": { "displayText": "break", "export": true, "for_": ["iteration"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "break", "type": "dfn", "url": "https://infra.spec.whatwg.org/#iteration-break" },
                "https://infra.spec.whatwg.org/#iteration-continue": { "displayText": "continue", "export": true, "for_": ["iteration"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "continue", "type": "dfn", "url": "https://infra.spec.whatwg.org/#iteration-continue" },
                "https://infra.spec.whatwg.org/#list-contain": { "displayText": "contain", "export": true, "for_": ["list", "stack", "queue", "set"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "contain", "type": "dfn", "url": "https://infra.spec.whatwg.org/#list-contain" },
                "https://infra.spec.whatwg.org/#map-exists": { "displayText": "exist", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "exist", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-exists" },
                "https://infra.spec.whatwg.org/#map-getting-the-keys": { "displayText": "keys", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "keys", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-getting-the-keys" },
                "https://infra.spec.whatwg.org/#map-getting-the-values": { "displayText": "values", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "values", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-getting-the-values" },
                "https://infra.spec.whatwg.org/#map-iterate": { "displayText": "for each", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "for each", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-iterate" },
                "https://infra.spec.whatwg.org/#map-set": { "displayText": "set", "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "set", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-set" },
                "https://infra.spec.whatwg.org/#ordered-map": { "displayText": "ordered map", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "ordered map", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ordered-map" },
                "https://infra.spec.whatwg.org/#ordered-set": { "displayText": "set", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "set", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ordered-set" },
                "https://infra.spec.whatwg.org/#skip-ascii-whitespace": { "displayText": "skip ASCII whitespace", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "skip ascii whitespace", "type": "dfn", "url": "https://infra.spec.whatwg.org/#skip-ascii-whitespace" },
                "https://infra.spec.whatwg.org/#string": { "displayText": "string", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "string", "type": "dfn", "url": "https://infra.spec.whatwg.org/#string" },
                "https://infra.spec.whatwg.org/#string-position-variable": { "displayText": "position variable", "export": true, "for_": ["string"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "position variable", "type": "dfn", "url": "https://infra.spec.whatwg.org/#string-position-variable" },
                "https://www.rfc-editor.org/rfc/rfc9110#name-media-type": { "displayText": "media-type", "export": true, "for_": [], "level": "", "normative": true, "shortname": "http-semantics", "spec": "http-semantics", "status": "anchor-block", "text": "media-type", "type": "dfn", "url": "https://www.rfc-editor.org/rfc/rfc9110#name-media-type" },
                "https://www.rfc-editor.org/rfc/rfc9110#name-quoted-strings": { "displayText": "quoted-string", "export": true, "for_": [], "level": "", "normative": true, "shortname": "http-semantics", "spec": "http-semantics", "status": "anchor-block", "text": "quoted-string", "type": "dfn", "url": "https://www.rfc-editor.org/rfc/rfc9110#name-quoted-strings" },
                "https://www.rfc-editor.org/rfc/rfc9110#name-tokens": { "displayText": "token", "export": true, "for_": [], "level": "", "normative": true, "shortname": "http-semantics", "spec": "http-semantics", "status": "anchor-block", "text": "token", "type": "dfn", "url": "https://www.rfc-editor.org/rfc/rfc9110#name-tokens" },
            };

            function mkRefHint(link, ref) {
                const linkText = link.textContent;
                let dfnTextElements = '';
                if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
                    // Give the original term if it's being displayed in a different way.
                    // But allow casing differences, they're insignificant.
                    dfnTextElements =
                        mk.li({},
                            mk.b({}, "Term: "),
                            mk.span({}, ref.displayText)
                        );
                }
                const forList = ref.for_;
                let forListElements;
                if (forList.length == 0) {
                    forListElements = [];
                } else if (forList.length == 1) {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.span({}, forList[0]),
                    );
                } else {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.ul({},
                            ...forList.map(forItem =>
                                mk.li({},
                                    mk.span({}, forItem)
                                ),
                            ),
                        ),
                    );
                }
                const url = ref.url;
                const safeUrl = encodeURIComponent(url);
                const hintPanel = mk.aside({
                    class: "ref-hint",
                    id: `ref-hint-for-${safeUrl}`,
                    "data-for": url,
                    "aria-labelled-by": `ref-hint-for-${safeUrl}`,
                },
                    mk.ul({},
                        dfnTextElements,
                        mk.li({},
                            mk.b({}, "URL: "),
                            mk.a({ href: url, class: "ref" }, url),
                        ),
                        mk.li({},
                            mk.b({}, "Type: "),
                            mk.span({}, `${ref.type}`),
                        ),
                        mk.li({},
                            mk.b({}, "Spec: "),
                            mk.span({}, `${ref.spec ? ref.spec : ''}`),
                        ),
                        forListElements
                    ),
                );
                hintPanel.forLink = link;
                setupRefHintEventListeners(link, hintPanel);
                return hintPanel;
            }

            function hideAllRefHints() {
                queryAll(".ref-hint").forEach(el => hideRefHint(el));
            }

            function hideRefHint(refHint) {
                const link = refHint.forLink;
                link.setAttribute("aria-expanded", "false");
                if (refHint.teardownEventListeners) {
                    refHint.teardownEventListeners();
                }
                refHint.remove();
            }

            function showRefHint(link) {
                if (link.classList.contains("dfn-link")) return;
                const url = link.getAttribute("href");
                const refHintKey = link.getAttribute("data-refhint-key");
                let key = url;
                if (refHintKey) {
                    key = refHintKey + "_" + url;
                }
                const ref = refsData[key];
                if (!ref) return;

                hideAllRefHints(); // Only display one at this time.

                const refHint = mkRefHint(link, ref);
                append(document.body, refHint);
                link.setAttribute("aria-expanded", "true");
                positionRefHint(refHint);
            }

            function setupRefHintEventListeners(link, refHint) {
                if (refHint.teardownEventListeners) return;
                // Add event handlers to hide the refHint after the user moves away
                // from both the link and refHint, if not hovering either within one second.
                let timeout = null;
                const startHidingRefHint = (event) => {
                    if (timeout) {
                        clearTimeout(timeout);
                    }
                    timeout = setTimeout(() => {
                        hideRefHint(refHint);
                    }, 1000);
                }
                const resetHidingRefHint = (event) => {
                    if (timeout) clearTimeout(timeout);
                    timeout = null;
                };
                link.addEventListener("mouseleave", startHidingRefHint);
                link.addEventListener("mouseenter", resetHidingRefHint);
                link.addEventListener("blur", startHidingRefHint);
                link.addEventListener("focus", resetHidingRefHint);
                refHint.addEventListener("mouseleave", startHidingRefHint);
                refHint.addEventListener("mouseenter", resetHidingRefHint);
                refHint.addEventListener("blur", startHidingRefHint);
                refHint.addEventListener("focus", resetHidingRefHint);

                refHint.teardownEventListeners = () => {
                    // remove event listeners
                    resetHidingRefHint();
                    link.removeEventListener("mouseleave", startHidingRefHint);
                    link.removeEventListener("mouseenter", resetHidingRefHint);
                    link.removeEventListener("blur", startHidingRefHint);
                    link.removeEventListener("focus", resetHidingRefHint);
                    refHint.removeEventListener("mouseleave", startHidingRefHint);
                    refHint.removeEventListener("mouseenter", resetHidingRefHint);
                    refHint.removeEventListener("blur", startHidingRefHint);
                    refHint.removeEventListener("focus", resetHidingRefHint);
                };
            }

            function positionRefHint(refHint) {
                const link = refHint.forLink;
                const linkPos = getBounds(link);
                refHint.style.top = linkPos.bottom + "px";
                refHint.style.left = linkPos.left + "px";

                const panelPos = refHint.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
                    refHint.style.left = newLeft + "px";
                }
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function showRefHintListener(e) {
                // If the target isn't in a link (or is a link),
                // just ignore it.
                let link = e.target.closest("a");
                if (!link) return;

                // If the target is in a ref-hint panel
                // (aka a link in the already-open one),
                // also just ignore it.
                if (link.closest(".ref-hint")) return;

                // Otherwise, show the panel for the link.
                showRefHint(link);
            }

            function hideAllHintsListener(e) {
                // If the click is inside a ref-hint panel, ignore it.
                if (e.target.closest(".ref-hint")) return;
                // Otherwise, close all the current panels.
                hideAllRefHints();
            }

            document.addEventListener("DOMContentLoaded", () => {
                document.body.addEventListener("mousedown", showRefHintListener);
                document.body.addEventListener("focus", showRefHintListener);

                document.body.addEventListener("click", hideAllHintsListener);
            });

            window.addEventListener("resize", () => {
                // Hide any open ref hint.
                hideAllRefHints();
            });
        }
    </script>
    <script>/* Boilerplate: script-var-click-highlighting */
        "use strict";
        {
            /*
            Color-choosing design:
            
            * Colors are ordered by goodness.
            * On clicking a var, give it the earliest color
                with the lowest usage in the algorithm.
            * On re-clicking, re-use the var's most recent color
                if that's not currently being used elsewhere.
            */

            const COLOR_COUNT = 7;

            document.addEventListener("click", e => {
                if (e.target.nodeName == "VAR") {
                    highlightSameAlgoVars(e.target);
                }
            });

            function highlightSameAlgoVars(v) {
                // Find the algorithm container.
                let algoContainer = findAlgoContainer(v);

                // Not highlighting document-global vars,
                // too likely to be unrelated.
                if (algoContainer == null) return;

                const varName = nameFromVar(v);
                if (!v.hasAttribute("data-var-color")) {
                    const newColor = chooseHighlightColor(algoContainer, v);
                    for (const el of algoContainer.querySelectorAll("var")) {
                        if (nameFromVar(el) == varName) {
                            el.setAttribute("data-var-color", newColor);
                            el.setAttribute("data-var-last-color", newColor);
                        }
                    }
                } else {
                    for (const el of algoContainer.querySelectorAll("var")) {
                        if (nameFromVar(el) == varName) {
                            el.removeAttribute("data-var-color");
                        }
                    }
                }
            }
            function findAlgoContainer(el) {
                while (el != document.body) {
                    if (el.hasAttribute("data-algorithm")) return el;
                    el = el.parentNode;
                }
                return null;
            }
            function nameFromVar(el) {
                return el.textContent.replace(/(\s|\xa0)+/g, " ").trim();
            }
            function colorCountsFromContainer(container) {
                const namesFromColor = Array.from({ length: COLOR_COUNT }, x => new Set());
                for (let v of container.querySelectorAll("var[data-var-color]")) {
                    let color = +v.getAttribute("data-var-color");
                    namesFromColor[color].add(nameFromVar(v));
                }

                return namesFromColor.map(x => x.size);
            }
            function leastUsedColor(colors) {
                // Find the earliest color with the lowest count.
                let minCount = Infinity;
                let minColor = null;
                for (var i = 0; i < colors.length; i++) {
                    if (colors[i] < minCount) {
                        minColor = i;
                        minCount = colors[i];
                    }
                }
                return minColor;
            }
            function chooseHighlightColor(container, v) {
                const colorCounts = colorCountsFromContainer(container);
                if (v.hasAttribute("data-var-last-color")) {
                    let color = +v.getAttribute("data-var-last-color");
                    if (colorCounts[color] == 0) return color;
                }
                return leastUsedColor(colorCounts);
            }
        }
    </script>
    <script src="/dropdown.js"></script>