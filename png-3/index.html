<!DOCTYPE html>
<html lang="zh-hans">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <!-- <meta name="generator" content="ReSpec 35.3.1"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <style>
        span.example-title {
            text-transform: none
        }

        :is(aside, div).example,
        div.illegal-example {
            padding: .5em;
            margin: 1em 0;
            position: relative;
            clear: both
        }

        div.illegal-example {
            color: red
        }

        div.illegal-example p {
            color: #000
        }

        aside.example div.example {
            border-left-width: .1em;
            border-color: #999;
            background: #fff
        }
    </style>
    <style>
        .issue-label {
            text-transform: initial
        }

        .warning>p:first-child {
            margin-top: 0
        }

        .warning {
            padding: .5em;
            border-left-width: .5em;
            border-left-style: solid
        }

        span.warning {
            padding: .1em .5em .15em
        }

        .issue.closed span.issue-number {
            text-decoration: line-through
        }

        .issue.closed span.issue-number::after {
            content: " (Closed)";
            font-size: smaller
        }

        .warning {
            border-color: #f11;
            border-color: var(--warning-border, #f11);
            border-width: .2em;
            border-style: solid;
            background: #fbe9e9;
            background: var(--warning-bg, #fbe9e9);
            color: #000;
            color: var(--text, #000)
        }

        .warning-title:before {
            content: "⚠";
            font-size: 1.3em;
            float: left;
            padding-right: .3em;
            margin-top: -.3em
        }

        li.task-list-item {
            list-style: none
        }

        input.task-list-item-checkbox {
            margin: 0 .35em .25em -1.6em;
            vertical-align: middle
        }

        .issue a.respec-gh-label {
            padding: 5px;
            margin: 0 2px 0 2px;
            font-size: 10px;
            text-transform: none;
            text-decoration: none;
            font-weight: 700;
            border-radius: 4px;
            position: relative;
            bottom: 2px;
            border: none;
            display: inline-block
        }
    </style>
    <style>
        dfn {
            cursor: pointer
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            min-width: 300px;
            max-width: 500px;
            padding: .5em .75em;
            margin-top: .6em;
            font-family: "Helvetica Neue", sans-serif;
            font-size: small;
            background: #fff;
            background: var(--indextable-hover-bg, #fff);
            color: #000;
            color: var(--text, #000);
            box-shadow: 0 1em 3em -.4em rgba(0, 0, 0, .3), 0 0 1px 1px rgba(0, 0, 0, .05);
            box-shadow: 0 1em 3em -.4em var(--tocsidebar-shadow, rgba(0, 0, 0, .3)), 0 0 1px 1px var(--tocsidebar-shadow, rgba(0, 0, 0, .05));
            border-radius: 2px
        }

        .dfn-panel:not(.docked)>.caret {
            position: absolute;
            top: -9px
        }

        .dfn-panel:not(.docked)>.caret::after,
        .dfn-panel:not(.docked)>.caret::before {
            content: "";
            position: absolute;
            border: 10px solid transparent;
            border-top: 0;
            border-bottom: 10px solid #fff;
            border-bottom-color: var(--indextable-hover-bg, #fff);
            top: 0
        }

        .dfn-panel:not(.docked)>.caret::before {
            border-bottom: 9px solid #a2a9b1;
            border-bottom-color: var(--indextable-hover-bg, #a2a9b1)
        }

        .dfn-panel * {
            margin: 0
        }

        .dfn-panel b {
            display: block;
            color: #000;
            color: var(--text, #000);
            margin-top: .25em
        }

        .dfn-panel ul a[href] {
            color: #333;
            color: var(--text, #333)
        }

        .dfn-panel>div {
            display: flex
        }

        .dfn-panel a.self-link {
            font-weight: 700;
            margin-right: auto
        }

        .dfn-panel .marker {
            padding: .1em;
            margin-left: .5em;
            border-radius: .2em;
            text-align: center;
            white-space: nowrap;
            font-size: 90%;
            color: #040b1c
        }

        .dfn-panel .marker.dfn-exported {
            background: #d1edfd;
            box-shadow: 0 0 0 .125em #1ca5f940
        }

        .dfn-panel .marker.idl-block {
            background: #8ccbf2;
            box-shadow: 0 0 0 .125em #0670b161
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important
        }

        .dfn-panel a[href]:hover {
            border-bottom-width: 1px
        }

        .dfn-panel ul {
            padding: 0
        }

        .dfn-panel li {
            margin-left: 1em
        }

        .dfn-panel.docked {
            position: fixed;
            left: .5em;
            top: unset;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - .75em * 2 - .5em - .2em * 2);
            max-height: 30vh;
            overflow: auto
        }
    </style>

    <title>可移植网络图形（PNG）规范（第三版）</title>



    <style>
        span.chunk {
            color: #622;
        }
    </style>



    <style id="respec-mainstyle">
        @keyframes pop {
            0% {
                transform: scale(1, 1)
            }

            25% {
                transform: scale(1.25, 1.25);
                opacity: .75
            }

            100% {
                transform: scale(1, 1)
            }
        }

        a.internalDFN {
            color: inherit;
            border-bottom: 1px solid #99c;
            text-decoration: none
        }

        a.externalDFN {
            color: inherit;
            border-bottom: 1px dotted #ccc;
            text-decoration: none
        }

        a.bibref {
            text-decoration: none
        }

        .respec-offending-element:target {
            animation: pop .25s ease-in-out 0s 1
        }

        .respec-offending-element,
        a[href].respec-offending-element {
            text-decoration: red wavy underline
        }

        @supports not (text-decoration:red wavy underline) {
            .respec-offending-element:not(pre) {
                display: inline-block
            }

            .respec-offending-element {
                background: url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x
            }
        }

        #references :target {
            background: #eaf3ff;
            animation: pop .4s ease-in-out 0s 1
        }

        cite .bibref {
            font-style: italic
        }

        a[href].orcid {
            padding-left: 4px;
            padding-right: 4px
        }

        a[href].orcid>svg {
            margin-bottom: -2px
        }

        ol.tof,
        ul.tof {
            list-style: none outside none
        }

        .caption {
            margin-top: .5em;
            font-style: italic
        }

        #issue-summary>ul {
            column-count: 2
        }

        #issue-summary li {
            list-style: none;
            display: inline-block
        }

        details.respec-tests-details {
            margin-left: 1em;
            display: inline-block;
            vertical-align: top
        }

        details.respec-tests-details>* {
            padding-right: 2em
        }

        details.respec-tests-details[open] {
            z-index: 999999;
            position: absolute;
            border: thin solid #cad3e2;
            border-radius: .3em;
            background-color: #fff;
            padding-bottom: .5em
        }

        details.respec-tests-details[open]>summary {
            border-bottom: thin solid #cad3e2;
            padding-left: 1em;
            margin-bottom: 1em;
            line-height: 2em
        }

        details.respec-tests-details>ul {
            width: 100%;
            margin-top: -.3em
        }

        details.respec-tests-details>li {
            padding-left: 1em
        }

        .self-link:hover {
            opacity: 1;
            text-decoration: none;
            background-color: transparent
        }

        aside.example .marker>a.self-link {
            color: inherit
        }

        .header-wrapper {
            display: flex;
            align-items: baseline
        }

        :is(h2, h3, h4, h5, h6):not(#toc>h2, #abstract>h2, #sotd>h2, .head>h2) {
            position: relative;
            left: -.5em
        }

        :is(h2, h3, h4, h5, h6):not(#toch2)+a.self-link {
            color: inherit;
            order: -1;
            position: relative;
            left: -1.1em;
            font-size: 1rem;
            opacity: .5
        }

        :is(h2, h3, h4, h5, h6)+a.self-link::before {
            content: "§";
            text-decoration: none;
            color: var(--heading-text)
        }

        :is(h2, h3)+a.self-link {
            top: -.2em
        }

        :is(h4, h5, h6)+a.self-link::before {
            color: #000
        }

        @media (max-width:767px) {
            dd {
                margin-left: 0
            }
        }

        @media print {
            .removeOnSave {
                display: none
            }
        }
    </style>
    <meta name="color-scheme" content="light">
    <meta name="description" content="This document describes PNG (Portable Network Graphics), an extensible file format for the lossless, portable,
    well-compressed storage of static and animated raster images. PNG provides a patent-free replacement for GIF and can also
    replace many common uses of TIFF. Indexed-color, greyscale, and truecolor images are supported, plus an optional alpha
    channel. Sample depths range from 1 to 16 bits.">
    <link rel="canonical" href="https://www.w3.org/TR/png-3/">
    <style>
        .hljs {
            --base: #fafafa;
            --mono-1: #383a42;
            --mono-2: #686b77;
            --mono-3: #717277;
            --hue-1: #0b76c5;
            --hue-2: #336ae3;
            --hue-3: #a626a4;
            --hue-4: #42803c;
            --hue-5: #ca4706;
            --hue-5-2: #c91243;
            --hue-6: #986801;
            --hue-6-2: #9a6a01
        }

        @media (prefers-color-scheme:dark) {
            .hljs {
                --base: #282c34;
                --mono-1: #abb2bf;
                --mono-2: #818896;
                --mono-3: #5c6370;
                --hue-1: #56b6c2;
                --hue-2: #61aeee;
                --hue-3: #c678dd;
                --hue-4: #98c379;
                --hue-5: #e06c75;
                --hue-5-2: #be5046;
                --hue-6: #d19a66;
                --hue-6-2: #e6c07b
            }
        }

        .hljs {
            display: block;
            overflow-x: auto;
            padding: .5em;
            color: #383a42;
            color: var(--mono-1, #383a42);
            background: #fafafa;
            background: var(--base, #fafafa)
        }

        .hljs-comment,
        .hljs-quote {
            color: #717277;
            color: var(--mono-3, #717277);
            font-style: italic
        }

        .hljs-doctag,
        .hljs-formula,
        .hljs-keyword {
            color: #a626a4;
            color: var(--hue-3, #a626a4)
        }

        .hljs-deletion,
        .hljs-name,
        .hljs-section,
        .hljs-selector-tag,
        .hljs-subst {
            color: #ca4706;
            color: var(--hue-5, #ca4706);
            font-weight: 700
        }

        .hljs-literal {
            color: #0b76c5;
            color: var(--hue-1, #0b76c5)
        }

        .hljs-addition,
        .hljs-attribute,
        .hljs-meta-string,
        .hljs-regexp,
        .hljs-string {
            color: #42803c;
            color: var(--hue-4, #42803c)
        }

        .hljs-built_in,
        .hljs-class .hljs-title {
            color: #9a6a01;
            color: var(--hue-6-2, #9a6a01)
        }

        .hljs-attr,
        .hljs-number,
        .hljs-selector-attr,
        .hljs-selector-class,
        .hljs-selector-pseudo,
        .hljs-template-variable,
        .hljs-type,
        .hljs-variable {
            color: #986801;
            color: var(--hue-6, #986801)
        }

        .hljs-bullet,
        .hljs-link,
        .hljs-meta,
        .hljs-selector-id,
        .hljs-symbol,
        .hljs-title {
            color: #336ae3;
            color: var(--hue-2, #336ae3)
        }

        .hljs-emphasis {
            font-style: italic
        }

        .hljs-strong {
            font-weight: 700
        }

        .hljs-link {
            text-decoration: underline
        }
    </style>
    <style>
        var:hover {
            text-decoration: underline;
            cursor: pointer
        }

        var.respec-hl {
            color: var(--color, #000);
            background-color: var(--bg-color);
            box-shadow: 0 0 0 2px var(--bg-color)
        }

        @media (prefers-color-scheme:dark) {
            var.respec-hl {
                filter: saturate(.9) brightness(.9)
            }
        }

        var.respec-hl-c1 {
            --bg-color: #f4d200
        }

        var.respec-hl-c2 {
            --bg-color: #ff87a2
        }

        var.respec-hl-c3 {
            --bg-color: #96e885
        }

        var.respec-hl-c4 {
            --bg-color: #3eeed2
        }

        var.respec-hl-c5 {
            --bg-color: #eacfb6
        }

        var.respec-hl-c6 {
            --bg-color: #82ddff
        }

        var.respec-hl-c7 {
            --bg-color: #ffbcf2
        }

        @media print {
            var.respec-hl {
                background: 0 0;
                color: #000;
                box-shadow: unset
            }
        }
    </style>
    <style>
        var {
            position: relative;
            cursor: pointer
        }

        var[data-type]::after,
        var[data-type]::before {
            position: absolute;
            left: 50%;
            top: -6px;
            opacity: 0;
            transition: opacity .4s;
            pointer-events: none
        }

        var[data-type]::before {
            content: "";
            transform: translateX(-50%);
            border-width: 4px 6px 0 6px;
            border-style: solid;
            border-color: transparent;
            border-top-color: #222
        }

        var[data-type]::after {
            content: attr(data-type);
            transform: translateX(-50%) translateY(-100%);
            background: #222;
            text-align: center;
            font-family: "Dank Mono", "Fira Code", monospace;
            font-style: normal;
            padding: 6px;
            border-radius: 3px;
            color: #daca88;
            text-indent: 0;
            font-weight: 400
        }

        var[data-type]:hover::after,
        var[data-type]:hover::before {
            opacity: 1
        }
    </style>
    <script id="initialUserConfig" type="application/json">{
  "group": "png",
  "specStatus": "REC",
  "publishDate": "2025-06-24",
  "crEnd": "2025-05-13",
  prEnd: "2025-05-29",
  "implementationReportURI": "https://w3c.github.io/png/Implementation_Report_3e/",
  "shortName": "png-3",
  "copyrightStart": "1996",
  "previousPublishDate": "2025-05-15",
  "previousMaturity": "PR",
  "edDraftURI": "https://w3c.github.io/png/",
  "github": {
    "repoURL": "https://github.com/w3c/png",
    "branch": "main"
  },
  "extraCSS": [
    "https://dev.w3.org/2009/dap/ReSpec.js/css/respec.css"
  ],
  "editors": [
    {
      "name": "Chris Blume",
      "url": "https://www.programmax.net",
      "company": "W3C Invited Experts",
      "w3cid": 127631
    },
    {
      "name": "Pierre-Anthony Lemieux",
      "company": "MovieLabs",
      "companyURL": "https://movielabs.com/",
      "url": "mailto:pal@palemieux.com",
      "w3cid": 57073
    },
    {
      "name": "Chris Lilley",
      "url": "https://svgees.us",
      "company": "W3C",
      "companyURL": "https://www.w3.org",
      "w3cid": 1438
    },
    {
      "name": "Chris Needham",
      "url": "https://chrisneedham.com/about",
      "w3cid": 67414
    },
    {
      "name": "Leonard Rosenthol",
      "company": "Adobe Inc.",
      "companyURL": "https://www.adobe.com",
      "w3cid": 42485
    },
    {
      "name": "Chris Arley Seeger",
      "company": "NBCUniversal, LLC a subsidiary of Comcast Corporation",
      "companyURL": "https://www.xfinity.com",
      "w3cid": 125844
    },
    {
      "name": "Simon Thompson",
      "company": "British Broadcasting Corporation",
      "companyURL": "https://www.bbc.co.uk",
      "w3cid": 100939
    },
    {
      "name": "Cosmin Truta",
      "company": "W3C Invited Experts",
      "w3cid": 160971
    }
  ],
  "formerEditors": [
    {
      "name": "Thomas Boutell"
    },
    {
      "name": "Adam M. Costello"
    },
    {
      "name": "David Duce"
    },
    {
      "name": "Tom Lane"
    },
    {
      "name": "Glenn Randers-Pehrson"
    }
  ],
  "authors": [
    {
      "name": "Mark Adler",
      "url": "https://en.wikipedia.org/wiki/Mark_Adler"
    },
    {
      "name": "Thomas Boutell",
      "url": "https://boutell.dev/"
    },
    {
      "name": "Christian Brunschen"
    },
    {
      "name": "Adam M. Costello",
      "url": "http://www.nicemice.net/amc/"
    },
    {
      "name": "Lee Daniel Crocker"
    },
    {
      "name": "Andreas Dilger",
      "url": "http://www-mddsp.enel.ucalgary.ca/People/adilger/"
    },
    {
      "name": "Oliver Fromme",
      "url": "https://www.fromme.com/"
    },
    {
      "name": "Jean-loup Gailly",
      "url": "http://gailly.net/"
    },
    {
      "name": "Phil Harvey"
    },
    {
      "name": "Chris Herborth"
    },
    {
      "name": "Alex Jakulin"
    },
    {
      "name": "Neal Kettler"
    },
    {
      "name": "Tom Lane"
    },
    {
      "name": "Alexander Lehmann"
    },
    {
      "name": "Chris Lilley",
      "url": "https://svgees.us",
      "company": "W3C",
      "companyURL": "https://www.w3.org"
    },
    {
      "name": "Dave Martindale"
    },
    {
      "name": "Owen Mortensen"
    },
    {
      "name": "Stuart Parmenter"
    },
    {
      "name": "Keith S. Pickens"
    },
    {
      "name": "Robert P. Poole"
    },
    {
      "name": "Glenn Randers-Pehrson"
    },
    {
      "name": "Greg Roelofs",
      "url": "http://www.gregroelofs.com/"
    },
    {
      "name": "Willem van Schaik"
    },
    {
      "name": "Guy Schalnat"
    },
    {
      "name": "Paul Schmidt"
    },
    {
      "name": "Andrew Smith"
    },
    {
      "name": "Michael Stokes"
    },
    {
      "name": "Vladimir Vukicevic"
    },
    {
      "name": "Tim Wegner"
    },
    {
      "name": "Jeremy Wohl"
    }
  ],
  "wg": "Portable Network Graphics (PNG) Working Group",
  "wgURI": "https://www.w3.org/groups/wg/png",
  "wgPublicList": "public-png",
  "wgPatentURI": "https://www.w3.org/groups/wg/png/ipr",
  "lint": {
    "informative-dfn": false
  },
  "xref": [
    "i18n-glossary"
  ],
  "localBiblio": {
    "CIPA-DC-008": {
      "title": "Exchangeable image file format for digital still cameras: Exif Version 2.32",
      "href": "https://www.cipa.jp/std/documents/download_e.html?DC-008-Translation-2019-E",
      "date": "2019-05-17",
      "publisher": "Camera & Imaging Products Association",
      "id": "cipa-dc-008"
    },
    "COLOR-FAQ": {
      "title": "Color FAQ",
      "authors": [
        "Poynton, C."
      ],
      "href": "https://poynton.ca/ColorFAQ.html",
      "date": "2009-10-19",
      "id": "color-faq"
    },
    "CTA-861.3-A": {
      "title": "HDR Static Metadata Extensions (CTA-861.3-A)",
      "publisher": "Consumer Technology Association",
      "date": "2015-01",
      "href": "https://shop.cta.tech/products/cta-861-3",
      "id": "cta-861.3-a"
    },
    "Display-P3": {
      "title": "Display P3",
      "authors": [
        "Apple, Inc"
      ],
      "date": "2022-02",
      "publisher": "ICC",
      "href": "https://www.color.org/chardata/rgb/DisplayP3.xalter",
      "id": "display-p3"
    },
    "ICC-2": {
      "title": "Specification ICC.2:2019 (Profile version 5.0.0 - iccMAX)",
      "date": "2019",
      "href": "https://www.color.org/specification/ICC.2-2019.pdf",
      "publisher": "International Color Consortium",
      "id": "icc-2"
    },
    "GAMMA-FAQ": {
      "title": "Gamma FAQ",
      "authors": [
        "Poynton, C."
      ],
      "href": "https://poynton.ca/GammaFAQ.html",
      "date": "1998-08-04",
      "id": "gamma-faq"
    },
    "HDR10": {
      "title": "HDR10 Media Profile",
      "href": "https://en.wikipedia.org/wiki/HDR10",
      "id": "hdr10"
    },
    "HDR-Static-Meta": {
      "title": "On the Calculation and Usage of HDR Static Content Metadata",
      "authors": [
        "Smith, Michael D.",
        "Zink, Michael"
      ],
      "publisher": "Society of Motion Picture and Television Engineers",
      "date": "2021-08-05",
      "href": "https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=9508136",
      "id": "hdr-static-meta"
    },
    "Hill": {
      "title": "Comparative analysis of the quantization of color spaces on the basis of the CIELAB color-difference formula",
      "authors": [
        "Hill, B.",
        "Roger, Th.",
        "Vorhagen, F.W."
      ],
      "journal": "ACM Transactions on Graphics, Volume 16, Issue 2, pp. 109–154",
      "date": "1997-04",
      "href": "https://dl.acm.org/doi/10.1145/248210.248212",
      "id": "hill"
    },
    "ISO-3309": {
      "title": "ISO/IEC 3309:1993, Information Technology — Telecommunications and information exchange between systems — High-level data link control (HDLC) procedures — Frame structure.",
      "date": "1993",
      "publisher": "ISO",
      "id": "iso-3309"
    },
    "ISO_8859-1": {
      "title": "ISO/IEC 8859-1:1998, Information technology — 8-bit single-byte coded graphic character sets — Part 1: Latin alphabet No. 1.",
      "date": "1998",
      "publisher": "ISO",
      "id": "iso_8859-1"
    },
    "ISO_9899": {
      "title": "ISO/IEC 9899:2018 Information technology — Programming languages — C",
      "href": "https://www.iso.org/standard/74528.html",
      "date": "2018-6",
      "publisher": "ISO",
      "id": "iso_9899"
    },
    "ISO_15076-1": {
      "title": "ISO 15076-1:2010 Image technology colour management — Architecture, profile format and data structure — Part 1: Based on ICC.1:2010",
      "href": "https://www.iso.org/standard/54754.html",
      "date": "2010-12",
      "publisher": "ISO",
      "id": "iso_15076-1"
    },
    "ISO_20677-1": {
      "title": "ISO 20677:2019 Image technology colour management — Extensions to architecture, profile format and data structure",
      "href": "https://www.iso.org/standard/68806.html",
      "date": "2019-02",
      "publisher": "ISO"
    },
    "ITU-R-BT.709": {
      "title": "ITU-R BT.709, SERIES BT: BROADCASTING SERVICE (TELEVISION). Parameter values for the HDTV standards for production and international programme exchange",
      "publisher": "ITU",
      "date": "2015-06",
      "href": "https://www.itu.int/rec/R-REC-BT.709",
      "id": "itu-r-bt.709"
    },
    "ITU-R-BT.2020": {
      "title": "Parameter values for ultra-high definition television systems for production and international programme exchange",
      "publisher": "ITU",
      "href": "https://www.itu.int/rec/R-REC-BT.2020",
      "id": "itu-r-bt.2020"
    },
    "ITU-R-BT.2100": {
      "title": "ITU-R BT.2100, SERIES BT: BROADCASTING SERVICE (TELEVISION). Image parameter values for high dynamic range television for use in production and international programme exchange",
      "publisher": "ITU",
      "date": "2018-07",
      "href": "https://www.itu.int/rec/R-REC-BT.2100",
      "id": "itu-r-bt.2100"
    },
    "ITU-R-BT.2390": {
      "title": "High dynamic range television for production and international programme exchange",
      "publisher": "ITU",
      "href": "https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-11-2023-PDF-E.pdf",
      "id": "itu-r-bt.2390"
    },
    "ITU-T-H.273": {
      "title": "ITU-T H.273, SERIES H: AUDIOVISUAL AND MULTIMEDIA SYSTEMS Infrastructure of audiovisual services – Coding of moving video. Coding-independent code points for video signal type identification",
      "publisher": "ITU",
      "date": "2024-07-14",
      "href": "https://www.itu.int/rec/T-REC-H.273",
      "id": "itu-t-h.273"
    },
    "ITU-T-V.42": {
      "title": "ITU-T V.42, SERIES V: DATA COMMUNICATION OVER THE TELEPHONE NETWORK. Error-correcting procedures for DCEs using asynchronous-to-synchronous conversion",
      "href": "https://www.itu.int/rec/T-REC-V.42-200203-I/en",
      "date": "2002-03-29",
      "publisher": "ITU",
      "id": "itu-t-v.42"
    },
    "Kasson": {
      "title": "An Analysis of Selected Computer Interchange Color Spaces",
      "authors": [
        "Kasson, J.",
        "W. Plouffe"
      ],
      "journal": "ACM Transactions on Graphics, vol. 11, no. 4, pp. 373-405",
      "date": "1992",
      "href": "https://dl.acm.org/doi/abs/10.1145/146443.146479",
      "id": "kasson"
    },
    "Paeth": {
      "authors": [
        "Paeth, A.W"
      ],
      "title": "Image File Compression Made Easy, in Graphics Gems II, pp. 93-100",
      "publisher": "Academic Press",
      "date": "1991",
      "isbn": "0-12-064481-9",
      "href": "https://www.sciencedirect.com/science/article/pii/B9780080507545500293",
      "id": "paeth"
    },
    "PNG-EXTENSIONS": {
      "title": "Extensions to the PNG Third Edition Specification, Version 1.6.0",
      "publisher": "W3C",
      "date": "2021",
      "href": "https://w3c.github.io/png/extensions/Overview.html",
      "id": "png-extensions"
    },
    "PostScript": {
      "title": "PostScript Language Reference Manual",
      "authors": [
        "Adobe Systems Incorporated"
      ],
      "publisher": "Addison-Wesley",
      "date": "1990",
      "edition": "2",
      "isbn": "0-201-18127-4",
      "id": "postscript"
    },
    "ROELOFS": {
      "title": "PNG: The Definitive Guide",
      "authors": [
        "Roelofs, G."
      ],
      "publisher": "O'Reilly &amp; Associates Inc",
      "isbn": "1-56592-542-4",
      "href": "http://www.libpng.org/pub/png/pngbook.html",
      "date": "1999-06-11",
      "id": "roelofs"
    },
    "SMPTE-170M": {
      "title": "Television — Composite Analog Video Signal — NTSC for Studio Applications",
      "publisher": "Society of Motion Picture and Television Engineers",
      "date": "2004-11-30",
      "href": "https://standards.globalspec.com/std/892300/SMPTE%20ST%20170M",
      "id": "smpte-170m"
    },
    "SMPTE-RP-177": {
      "title": "Derivation of Basic Television Color Equations",
      "publisher": "Society of Motion Picture and Television Engineers",
      "date": "1 November 1993",
      "href": "https://standards.globalspec.com/std/1284890/smpte-rp-177",
      "id": "smpte-rp-177"
    },
    "SMPTE-ST-2067-21": {
      "title": "Interoperable Master Format — Application #2E",
      "publisher": "Society of Motion Picture and Television Engineers",
      "date": "2023-02-20",
      "href": "https://doi.org/10.5594/SMPTE.ST2067-21.2023",
      "id": "smpte-st-2067-21"
    },
    "SMPTE-RP-2077": {
      "title": "Full-Range Image Mapping",
      "publisher": "Society of Motion Picture and Television Engineers",
      "date": "2013-01-01",
      "href": "https://doi.org/10.5594/SMPTE.RP2077.2013",
      "id": "smpte-rp-2077"
    },
    "SMPTE-ST-2086": {
      "title": "Mastering Display Color Volume Metadata Supporting High Luminance and Wide Color Gamut Images",
      "publisher": "Society of Motion Picture and Television Engineers",
      "date": "27 April 2018",
      "href": "https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8353899",
      "id": "smpte-st-2086"
    },
    "TIFF-6.0": {
      "href": "https://www.loc.gov/preservation/digital/formats/fdd/fdd000022.shtml",
      "title": "TIFF Revision 6.0",
      "date": "3 June 1992",
      "id": "tiff-6.0"
    },
    "Ziv-Lempel": {
      "authors": [
        "J. Ziv",
        "A. Lempel"
      ],
      "title": "A Universal Algorithm for Sequential Data Compression, IEEE Transactions on Information Theory, vol. IT-23, no. 3, pp. 337 - 343",
      "date": "1977-05",
      "publisher": "IEEE",
      "href": "https://ieeexplore.ieee.org/document/1055714",
      "id": "ziv-lempel"
    },
    "EBU-R-103": {
      "title": "Video Signal Tolerance in Digital Television Systems",
      "publisher": "EBU",
      "date": "2020-05",
      "href": "https://tech.ebu.ch/docs/r/r103.pdf",
      "id": "ebu-r-103"
    },
    "ITU-T-Series-H-Supplement-19": {
      "title": "Series H: Audio Visual and Multimedia Systems - Usage of video signal type code points",
      "publisher": "ITU",
      "date": "2021-04",
      "href": "https://www.itu.int/ITU-T/recommendations/rec.aspx?rec=14652",
      "id": "itu-t-series-h-supplement-19"
    }
  },
  "publishISODate": "2025-06-24T00:00:00.000Z",
  "generatedSubtitle": "W3C Recommendation 24 June 2025"
}</script>
    <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-REC">
</head>

<body class="h-entry" data-cite="i18n-glossary">
    <div class="head">
        <p class="logos"><a class="logo" href="https://www.w3.org/"><img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
            </a></p>
        <h1 id="title" class="title">可移植网络图形（PNG）规范（第三版）</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types#REC">W3C 推荐标准</a> <time class="dt-published"
                datetime="2025-06-24">2025年6月24日</time></p>
        <details open="">
            <summary>关于本文档的更多信息</summary>
            <dl>
                <dt>本版本：</dt>
                <dd>
                    <a class="u-url"
                        href="https://www.w3.org/TR/2025/REC-png-3-20250624/">https://www.w3.org/TR/2025/REC-png-3-20250624/</a>
                </dd>
                <dt>最新发布版本：</dt>
                <dd>
                    <a href="https://www.w3.org/TR/png-3/">https://www.w3.org/TR/png-3/</a>
                </dd>
                <dt>最新编辑草案：</dt>
                <dd><a href="https://w3c.github.io/png/">https://w3c.github.io/png/</a></dd>
                <dt>历史记录：</dt>
                <dd>
                    <a
                        href="https://www.w3.org/standards/history/png-3/">https://www.w3.org/standards/history/png-3/</a>
                </dd>
                <dd>
                    <a href="https://github.com/w3c/png/commits/main">提交历史</a>
                </dd>

                <dt>实现报告：</dt>
                <dd>
                    <a
                        href="https://w3c.github.io/png/Implementation_Report_3e/">https://w3c.github.io/png/Implementation_Report_3e/</a>
                </dd>

                <dt>编辑：</dt>
                <dd class="editor p-author h-card vcard" data-editor-id="127631">
                    <a class="u-url url p-name fn" href="https://www.programmax.net">Chris Blume</a> (<span
                        class="p-org org h-org">W3C 受邀专家</span>)
                </dd>
                <dd class="editor p-author h-card vcard" data-editor-id="57073">
                    <a class="ed_mailto u-email email p-name" href="mailto:pal@palemieux.com">Pierre-Anthony Lemieux</a>
                    (<a class="p-org org h-org" href="https://movielabs.com/">MovieLabs</a>)
                </dd>
                <dd class="editor p-author h-card vcard" data-editor-id="1438">
                    <a class="u-url url p-name fn" href="https://svgees.us">Chris Lilley</a> (<a class="p-org org h-org"
                        href="https://www.w3.org">W3C</a>)
                </dd>
                <dd class="editor p-author h-card vcard" data-editor-id="67414">
                    <a class="u-url url p-name fn" href="https://chrisneedham.com/about">Chris Needham</a>
                </dd>
                <dd class="editor p-author h-card vcard" data-editor-id="42485">
                    <span class="p-name fn">Leonard Rosenthol</span> (<a class="p-org org h-org"
                        href="https://www.adobe.com">Adobe公司</a>)
                </dd>
                <dd class="editor p-author h-card vcard" data-editor-id="125844">
                    <span class="p-name fn">Chris Arley Seeger</span> (<a class="p-org org h-org"
                        href="https://www.xfinity.com">NBCUniversal有限责任公司（康卡斯特公司子公司）</a>)
                </dd>
                <dd class="editor p-author h-card vcard" data-editor-id="100939">
                    <span class="p-name fn">Simon Thompson</span> (<a class="p-org org h-org"
                        href="https://www.bbc.co.uk">英国广播公司</a>)
                </dd>
                <dd class="editor p-author h-card vcard" data-editor-id="160971">
                    <span class="p-name fn">Cosmin Truta</span> (<span class="p-org org h-org">W3C 受邀专家</span>)
                </dd>
                <dt>
                    前任编辑：
                </dt>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Thomas Boutell</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Adam M. Costello</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">David Duce</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Tom Lane</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Glenn Randers-Pehrson</span>
                </dd>
                <dt>作者：</dt>
                <dd class="editor p-author h-card vcard">
                    <a class="u-url url p-name fn" href="https://en.wikipedia.org/wiki/Mark_Adler">Mark Adler</a>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <a class="u-url url p-name fn" href="https://boutell.dev/">Thomas Boutell</a>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Christian Brunschen</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <a class="u-url url p-name fn" href="http://www.nicemice.net/amc/">Adam M. Costello</a>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Lee Daniel Crocker</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <a class="u-url url p-name fn" href="http://www-mddsp.enel.ucalgary.ca/People/adilger/">Andreas
                        Dilger</a>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <a class="u-url url p-name fn" href="https://www.fromme.com/">Oliver Fromme</a>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <a class="u-url url p-name fn" href="http://gailly.net/">Jean-loup Gailly</a>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Phil Harvey</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Chris Herborth</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Alex Jakulin</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Neal Kettler</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Tom Lane</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Alexander Lehmann</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <a class="u-url url p-name fn" href="https://svgees.us">Chris Lilley</a> (<a class="p-org org h-org"
                        href="https://www.w3.org">W3C</a>)
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Dave Martindale</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Owen Mortensen</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Stuart Parmenter</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Keith S. Pickens</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Robert P. Poole</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Glenn Randers-Pehrson</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <a class="u-url url p-name fn" href="http://www.gregroelofs.com/">Greg Roelofs</a>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Willem van Schaik</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Guy Schalnat</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Paul Schmidt</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Andrew Smith</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Michael Stokes</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Vladimir Vukicevic</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Tim Wegner</span>
                </dd>
                <dd class="editor p-author h-card vcard">
                    <span class="p-name fn">Jeremy Wohl</span>
                </dd>
                <dt>反馈：</dt>
                <dd>
                    <a href="https://github.com/w3c/png/">GitHub w3c/png</a>
                    (<a href="https://github.com/w3c/png/pulls/">拉取请求</a>,
                    <a href="https://github.com/w3c/png/issues/new/choose">新建议</a>,
                    <a href="https://github.com/w3c/png/issues/">开放议题</a>)
                </dd>
                <dd><a href="mailto:public-png@w3.org?subject=%5Bpng-3%5D%20YOUR%20TOPIC%20HERE">public-png@w3.org</a>
                    邮件主题请使用 <kbd>[png-3] <em>… 消息主题 …</em></kbd> (<a rel="discussion"
                        href="https://lists.w3.org/Archives/Public/public-png">邮件存档</a>)</dd>

                <dt>勘误：</dt>
                <dd><a
                        href="https://www.w3.org/2025/06/REC-PNG-20250624-errata">https://www.w3.org/2025/06/REC-PNG-20250624-errata</a>
                </dd>
            </dl>
        </details>

        <p>另见 <a href="https://www.w3.org/Translations/?technology=png-3"><strong>翻译版本</strong></a>。</p>


        <p class="copyright">
            <a href="https://www.w3.org/policies/#copyright">Copyright</a>
            ©
            1996-2025

            <a href="https://www.w3.org/">World Wide Web Consortium</a>.
            <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup>
            <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>,
            <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and
            <a rel="license" href="https://www.w3.org/copyright/software-license-2023/"
                title="W3C Software and Document Notice and License">permissive document license</a> rules apply.
        </p>
        <hr title="Separator for header">
    </div>
    <section id="abstract" class="introductory">
        <h2>摘要</h2>
        <p>本文档描述了 PNG（可移植网络图形），一种可扩展的文件格式，用于<a href="#dfn-lossless" class="internalDFN" data-link-type="dfn"
                id="ref-for-dfn-lossless-1">无损</a>、可移植、高压缩效率地存储静态和动画光栅图像。PNG 提供了无专利的 GIF 替代方案，也可以替代许多常见的 TIFF 用途。支持<a
                href="#3indexedColour" class="internalDFN" data-link-type="dfn" id="ref-for-3indexedColour-1">索引色</a>、<a
                href="#dfn-greyscale" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-greyscale-1">灰度</a>和<a
                href="#3truecolour" class="internalDFN" data-link-type="dfn" id="ref-for-3truecolour-1">真彩色</a>图像，以及可选的
            alpha 通道。采样深度范围为 1 至 16 位。</p>

        <p>PNG 专为在线浏览应用（如万维网）设计，因此完全支持流式传输，并带有渐进式显示选项。PNG 具有很强的鲁棒性，提供完整的文件完整性校验以及常见传输错误的简单检测。同时，PNG
            可以存储色彩空间数据，以提升异构平台上的色彩匹配效果。</p>

        <p>本规范定义了两种互联网媒体类型：image/png 和 image/apng。</p>

    </section>

    <section id="sotd" class="introductory">
        <h2>本文档状态</h2>
        <p><em>本节描述了本文档发布时的状态。当前 <abbr title="World Wide Web Consortium">W3C</abbr> 发布的文档及本技术报告的最新修订版可在
                <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr>
                    标准与草案索引</a>（https://www.w3.org/TR/）中找到。</em></p>
        <p>本规范旨在成为国际标准，但目前尚未成为国际标准。引用本规范为国际标准并不合适。</p>

        <p>本文档由<a href="https://www.w3.org/groups/wg/png">可移植网络图形（PNG）工作组</a>作为推荐标准，并通过<a
                href="https://www.w3.org/policies/process/20231103/#recs-and-notes">推荐流程</a>发布。</p>

        <p>W3C 推荐标准是在广泛共识基础上，由 <abbr title="World Wide Web Consortium">W3C</abbr> 及其成员认可的规范，并且工作组成员承诺为实现提供<a
                href="https://www.w3.org/policies/patent-policy/#sec-Requirements">免版税许可</a>。</p>

        <p>W3C 推荐将本规范广泛部署为 Web 的标准。</p>

        <p>
            本文档由遵循
            <a href="https://www.w3.org/policies/patent-policy/"><abbr title="World Wide Web Consortium">W3C</abbr>
                专利政策</a>的工作组制定。

            <abbr title="World Wide Web Consortium">W3C</abbr>
            维护一份
            <a rel="disclosure" href="https://www.w3.org/groups/wg/png/ipr">与工作组成果相关的专利公开公开列表</a>；
            该页面还包含专利披露说明。任何个人如实际知晓某项专利且认为其包含
            <a href="https://www.w3.org/policies/patent-policy/#def-essential">必要权利要求</a>，
            必须按照
            <a href="https://www.w3.org/policies/patent-policy/#sec-Disclosure">W3C 专利政策第6节</a>进行披露。
        </p>
        <p>
            本文档受
            <a id="w3c_process_revision" href="https://www.w3.org/policies/process/20231103/">2023年11月3日 <abbr
                    title="World Wide Web Consortium">W3C</abbr>流程文档</a>管理。
        </p>
    </section>
    <nav id="toc">
        <h2 class="introductory" id="table-of-contents">目录</h2>
        <ol class="toc">
            <li class="tocline"><a class="tocxref" href="#abstract">摘要</a></li>
            <li class="tocline"><a class="tocxref" href="#sotd">本文档状态</a></li>
            <li class="tocline"><a class="tocxref" href="#Introduction"><bdi class="secno">1. </bdi>简介</a>
            </li>
            <li class="tocline"><a class="tocxref" href="#1Scope"><bdi class="secno">2. </bdi>范围</a></li>
            <li class="tocline"><a class="tocxref" href="#3Defsandabbrevs"><bdi class="secno">3. </bdi>术语、定义与缩略语</a>
            </li>
            <li class="tocline"><a class="tocxref" href="#4Concepts"><bdi class="secno">4. </bdi>基本概念</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#static-and-animated-images"><bdi class="secno">4.1
                            </bdi>静态与动画图像</a></li>
                    <li class="tocline"><a class="tocxref" href="#4Concepts.Sourceimage"><bdi class="secno">4.2
                            </bdi>图像</a></li>
                    <li class="tocline"><a class="tocxref" href="#4Concepts.ColourSpaces"><bdi class="secno">4.3
                            </bdi>色彩空间</a></li>
                    <li class="tocline"><a class="tocxref" href="#4Concepts.PNGImageTransformation"><bdi
                                class="secno">4.4 </bdi>参考图像到 PNG 图像的转换</a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#4Concepts.Introduction">简介</a></li>
                            <li class="tocline"><a class="tocxref" href="#4Concepts.Implied-alpha"><bdi
                                        class="secno">4.4.1 </bdi><span>Alpha 分离</span></a></li>
                            <li class="tocline"><a class="tocxref" href="#4Concepts.Indexing"><bdi class="secno">4.4.2
                                    </bdi>索引</a></li>
                            <li class="tocline"><a class="tocxref" href="#4Concepts.RGBMerging"><bdi class="secno">4.4.3
                                    </bdi><span>RGB 合并</span>
                                </a></li>
                            <li class="tocline"><a class="tocxref" href="#4Concepts.Alpha-indexing"><bdi
                                        class="secno">4.4.4 </bdi><span>Alpha 压缩</span></a></li>
                            <li class="tocline"><a class="tocxref" href="#4Concepts.Scaling"><bdi class="secno">4.4.5
                                    </bdi><span>采样深度缩放</span>
                                </a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#4Concepts.PNGImage"><bdi class="secno">4.5 </bdi>PNG
                            图像</a></li>
                    <li class="tocline"><a class="tocxref" href="#4Concepts.Encoding"><bdi class="secno">4.6
                            </bdi>PNG 图像编码</a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#4Concepts.EncodingIntro">简介</a></li>
                            <li class="tocline"><a class="tocxref" href="#4Concepts.EncodingPassAbs"><bdi
                                        class="secno">4.6.1 </bdi>通道提取</a></li>
                            <li class="tocline"><a class="tocxref" href="#4Concepts.EncodingScanlineAbs"><bdi
                                        class="secno">4.6.2 </bdi>扫描线序列化</a></li>
                            <li class="tocline"><a class="tocxref" href="#4Concepts.EncodingFiltering"><bdi
                                        class="secno">4.6.3 </bdi>滤波</a></li>
                            <li class="tocline"><a class="tocxref" href="#4Concepts.EncodingCompression"><bdi
                                        class="secno">4.6.4 </bdi>压缩</a></li>
                            <li class="tocline"><a class="tocxref" href="#4Concepts.EncodingChunking"><bdi
                                        class="secno">4.6.5 </bdi>分块</a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#4Concepts.AncillInfo"><bdi class="secno">4.7
                            </bdi>附加信息</a></li>
                    <li class="tocline"><a class="tocxref" href="#4Concepts.Format"><bdi class="secno">4.8 </bdi>PNG
                            数据流</a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#4Concepts.FormatChunks"><bdi
                                        class="secno">4.8.1 </bdi>块</a></li>
                            <li class="tocline"><a class="tocxref" href="#4Concepts.FormatTypes"><bdi
                                        class="secno">4.8.2 </bdi>块类型</a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#apng-frame-based-animation"><bdi class="secno">4.9
                            </bdi><abbr title="Animated PNG">APNG</abbr>：基于帧的动画</a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#introduction-0">简介</a></li>
                            <li class="tocline"><a class="tocxref" href="#structure"><bdi class="secno">4.9.1
                                    </bdi>结构</a></li>
                            <li class="tocline"><a class="tocxref" href="#4Concepts.APNGSequence"><bdi
                                        class="secno">4.9.2 </bdi>序列号</a></li>
                            <li class="tocline"><a class="tocxref" href="#apng-output-buffer"><bdi class="secno">4.9.3
                                    </bdi>输出缓冲区</a></li>
                            <li class="tocline"><a class="tocxref" href="#apng-canvas"><bdi class="secno">4.9.4
                                    </bdi>画布</a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#4Concepts.Errors"><bdi class="secno">4.10
                            </bdi>错误处理</a></li>
                    <li class="tocline"><a class="tocxref" href="#4Concepts.Registration"><bdi class="secno">4.11
                            </bdi>扩展</a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#5DataRep"><bdi class="secno">5. </bdi>数据流结构</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#5Introduction"><bdi class="secno">5.1 </bdi>PNG
                            数据流</a></li>
                    <li class="tocline"><a class="tocxref" href="#3PNGsignature"><bdi class="secno">5.2 </bdi>PNG 签名</a>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#5Chunk-layout"><bdi class="secno">5.3 </bdi>块布局</a>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#5Chunk-naming-conventions"><bdi class="secno">5.4
                            </bdi>块命名约定</a></li>
                    <li class="tocline"><a class="tocxref" href="#5CRC-algorithm"><bdi class="secno">5.5 </bdi><abbr
                                title="Cyclic Redundancy Code">CRC</abbr> 算法</a></li>
                    <li class="tocline"><a class="tocxref" href="#5ChunkOrdering"><bdi class="secno">5.6 </bdi>块排序</a>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#sec-defining-new-chunks"><bdi class="secno">5.7
                            </bdi>块定义</a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#sec-defining-public-chunks-general"><bdi
                                        class="secno">5.7.1 </bdi>通用</a></li>
                            <li class="tocline"><a class="tocxref" href="#sec-defining-public-chunks"><bdi
                                        class="secno">5.7.2 </bdi>公有块的定义</a></li>
                            <li class="tocline"><a class="tocxref" href="#sec-defining-private-chunks"><bdi
                                        class="secno">5.7.3 </bdi>私有块的定义</a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#sec-field-value-extensibility"><bdi class="secno">5.8
                            </bdi>私有字段值</a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#6Transformation"><bdi class="secno">6. </bdi>参考图像到 PNG
                    图像的转换</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#6Colour-values"><bdi class="secno">6.1
                            </bdi>颜色类型与取值</a></li>
                    <li class="tocline"><a class="tocxref" href="#6AlphaRepresentation"><bdi class="secno">6.2
                            </bdi>Alpha 表示</a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#7Transformation"><bdi class="secno">7. </bdi>PNG 图像编码为 PNG
                    数据流</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#7Integers-and-byte-order"><bdi class="secno">7.1
                            </bdi>整数和字节序</a></li>
                    <li class="tocline"><a class="tocxref" href="#7Scanline"><bdi class="secno">7.2 </bdi>扫描线</a>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#7Filtering"><bdi class="secno">7.3 </bdi>滤波</a>
                    </li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#8Interlace"><bdi class="secno">8. </bdi>隔行与通道提取</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#8InterlaceIntro">简介</a></li>
                    <li class="tocline"><a class="tocxref" href="#8InterlaceMethods"><bdi class="secno">8.1
                            </bdi>隔行方法</a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#9Filters"><bdi class="secno">9. </bdi>滤波</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#9FtIntro"><bdi class="secno">9.1 </bdi>滤波方法与滤波类型</a>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#9Filter-types"><bdi class="secno">9.2
                            </bdi>滤波方法0的滤波类型</a></li>
                    <li class="tocline"><a class="tocxref" href="#9Filter-type-3-Average"><bdi class="secno">9.3
                            </bdi>滤波类型3：Average</a></li>
                    <li class="tocline"><a class="tocxref" href="#9Filter-type-4-Paeth"><bdi class="secno">9.4
                            </bdi>滤波类型4：Paeth</a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#10Compression"><bdi class="secno">10. </bdi>压缩</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#10CompressionCM0"><bdi class="secno">10.1
                            </bdi>压缩方法0</a></li>
                    <li class="tocline"><a class="tocxref" href="#10CompressionFSL"><bdi class="secno">10.2
                            </bdi>滤波后扫描线序列的压缩</a></li>
                    <li class="tocline"><a class="tocxref" href="#10CompressionOtherUses"><bdi class="secno">10.3
                            </bdi>压缩的其他用法</a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#11Chunks"><bdi class="secno">11. </bdi>块规范</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#11Introduction"><bdi class="secno">11.1
                            </bdi>通用</a></li>
                    <li class="tocline"><a class="tocxref" href="#11Critical-chunks"><bdi class="secno">11.2
                            </bdi>关键块</a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#11CcGen">简介</a></li>
                            <li class="tocline"><a class="tocxref" href="#11IHDR"><bdi class="secno">11.2.1 </bdi><span
                                        class="chunk">IHDR</span> 图像头</a></li>
                            <li class="tocline"><a class="tocxref" href="#11PLTE"><bdi class="secno">11.2.2 </bdi><span
                                        class="chunk">PLTE</span> 调色板</a></li>
                            <li class="tocline"><a class="tocxref" href="#11IDAT"><bdi class="secno">11.2.3 </bdi><span
                                        class="chunk">IDAT</span> 图像数据</a></li>
                            <li class="tocline"><a class="tocxref" href="#11IEND"><bdi class="secno">11.2.4 </bdi><span
                                        class="chunk">IEND</span> 图像结尾</a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#11Ancillary-chunks"><bdi class="secno">11.3
                            </bdi>辅助块</a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#11AcGen">简介</a></li>
                            <li class="tocline"><a class="tocxref" href="#11transinfo"><bdi class="secno">11.3.1
                                    </bdi>透明信息</a>
                                <ol class="toc">
                                    <li class="tocline"><a class="tocxref" href="#11tRNS"><bdi class="secno">11.3.1.1
                                            </bdi><span class="chunk">tRNS</span> 透明度</a></li>
                                </ol>
                            </li>
                            <li class="tocline"><a class="tocxref" href="#11addnlcolinfo"><bdi class="secno">11.3.2
                                    </bdi>色彩空间信息</a>
                                <ol class="toc">
                                    <li class="tocline"><a class="tocxref" href="#11cHRM"><bdi class="secno">11.3.2.1
                                            </bdi><span class="chunk">cHRM</span> 主色度与白点</a></li>
                                    <li class="tocline"><a class="tocxref" href="#11gAMA"><bdi class="secno">11.3.2.2
                                            </bdi><span class="chunk">gAMA</span> 图像伽玛</a></li>
                                    <li class="tocline"><a class="tocxref" href="#11iCCP"><bdi class="secno">11.3.2.3
                                            </bdi><span class="chunk">iCCP</span> 内嵌 ICC 配置文件</a></li>
                                    <li class="tocline"><a class="tocxref" href="#11sBIT"><bdi class="secno">11.3.2.4
                                            </bdi><span class="chunk">sBIT</span> 有效位</a></li>
                                    <li class="tocline"><a class="tocxref" href="#srgb-standard-colour-space"><bdi
                                                class="secno">11.3.2.5 </bdi><span class="chunk">sRGB</span> 标准 RGB
                                            色彩空间</a></li>
                                    <li class="tocline"><a class="tocxref" href="#cICP-chunk"><bdi
                                                class="secno">11.3.2.6 </bdi><span class="chunk">cICP</span>
                                            视频信号类型标识的编码无关代码点</a></li>
                                    <li class="tocline"><a class="tocxref" href="#mDCV-chunk"><bdi
                                                class="secno">11.3.2.7 </bdi><span class="chunk">mDCV</span>
                                            母版显示色彩体积</a>
                                    </li>
                                    <li class="tocline"><a class="tocxref" href="#cLLI-chunk"><bdi
                                                class="secno">11.3.2.8 </bdi><span class="chunk">cLLI</span> 内容光等级信息</a>
                                    </li>
                                </ol>
                            </li>
                            <li class="tocline"><a class="tocxref" href="#11textinfo"><bdi class="secno">11.3.3
                                    </bdi>文本信息</a>
                                <ol class="toc">
                                    <li class="tocline"><a class="tocxref" href="#11textIntro">简介</a></li>
                                    <li class="tocline"><a class="tocxref" href="#11keywords"><bdi
                                                class="secno">11.3.3.1 </bdi>关键字与文本字符串</a></li>
                                    <li class="tocline"><a class="tocxref" href="#11tEXt"><bdi class="secno">11.3.3.2
                                            </bdi><span class="chunk">tEXt</span> 文本数据</a></li>
                                    <li class="tocline"><a class="tocxref" href="#11zTXt"><bdi class="secno">11.3.3.3
                                            </bdi><span class="chunk">zTXt</span> 压缩文本数据</a></li>
                                    <li class="tocline"><a class="tocxref" href="#11iTXt"><bdi class="secno">11.3.3.4
                                            </bdi><span class="chunk">iTXt</span> 国际文本数据</a></li>
                                </ol>
                            </li>
                            <li class="tocline"><a class="tocxref" href="#11addnlsiinfo"><bdi class="secno">11.3.4
                                    </bdi>杂项信息</a>
                                <ol class="toc">
                                    <li class="tocline"><a class="tocxref" href="#11bKGD"><bdi class="secno">11.3.4.1
                                            </bdi><span class="chunk">bKGD</span> 背景色</a></li>
                                    <li class="tocline"><a class="tocxref" href="#11hIST"><bdi class="secno">11.3.4.2
                                            </bdi><span class="chunk">hIST</span> 图像直方图</a></li>
                                    <li class="tocline"><a class="tocxref" href="#11pHYs"><bdi class="secno">11.3.4.3
                                            </bdi><span class="chunk">pHYs</span> 物理像素尺寸</a></li>
                                    <li class="tocline"><a class="tocxref" href="#11sPLT"><bdi class="secno">11.3.4.4
                                            </bdi><span class="chunk">sPLT</span> 建议调色板</a></li>
                                    <li class="tocline"><a class="tocxref" href="#eXIf"><bdi class="secno">11.3.4.5
                                            </bdi><span class="chunk">eXIf</span> 可交换图像文件（Exif）配置文件</a>
                                        <ol class="toc">
                                            <li class="tocline"><a class="tocxref"
                                                    href="#exif-general-recommendations"><bdi class="secno">11.3.4.5.1
                                                    </bdi><span class="chunk">eXIf</span> 一般建议</a>
                                            </li>
                                            <li class="tocline"><a class="tocxref"
                                                    href="#exif-recommendations-for-decoders"><bdi
                                                        class="secno">11.3.4.5.2 </bdi><span class="chunk">eXIf</span>
                                                    解码器建议</a></li>
                                            <li class="tocline"><a class="tocxref"
                                                    href="#exif-recommendations-for-encoders"><bdi
                                                        class="secno">11.3.4.5.3 </bdi><span class="chunk">eXIf</span>
                                                    编码器建议</a></li>
                                        </ol>
                                    </li>
                                </ol>
                            </li>
                            <li class="tocline"><a class="tocxref" href="#11timestampinfo"><bdi class="secno">11.3.5
                                    </bdi>时间戳信息</a>
                                <ol class="toc">
                                    <li class="tocline"><a class="tocxref" href="#11tIME"><bdi class="secno">11.3.5.1
                                            </bdi><span class="chunk">tIME</span> 图像最后修改时间</a></li>
                                </ol>
                            </li>
                            <li class="tocline"><a class="tocxref" href="#animation-information"><bdi
                                        class="secno">11.3.6 </bdi>动画信息</a>
                                <ol class="toc">
                                    <li class="tocline"><a class="tocxref" href="#acTL-chunk"><bdi
                                                class="secno">11.3.6.1 </bdi><span class="chunk">acTL</span> 动画控制块</a>
                                    </li>
                                    <li class="tocline"><a class="tocxref" href="#fcTL-chunk"><bdi
                                                class="secno">11.3.6.2 </bdi><span class="chunk">fcTL</span> 帧控制块</a>
                                    </li>
                                    <li class="tocline"><a class="tocxref" href="#fdAT-chunk"><bdi
                                                class="secno">11.3.6.3 </bdi><span class="chunk">fdAT</span> 帧数据块</a>
                                    </li>
                                </ol>
                            </li>
                        </ol>
                    </li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#12Encoders"><bdi class="secno">12. </bdi>PNG 编码器</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#12Introduction">简介</a></li>
                    <li class="tocline"><a class="tocxref" href="#12Encoder-gamma-handling"><bdi class="secno">12.1
                            </bdi>编码器伽玛处理</a></li>
                    <li class="tocline"><a class="tocxref" href="#12Encoder-colour-handling"><bdi class="secno">12.2
                            </bdi>编码器色彩处理</a></li>
                    <li class="tocline"><a class="tocxref" href="#12Alpha-channel-creation"><bdi class="secno">12.3
                            </bdi>Alpha 通道创建</a></li>
                    <li class="tocline"><a class="tocxref" href="#12Sample-depth-scaling"><bdi class="secno">12.4
                            </bdi>样本深度缩放</a></li>
                    <li class="tocline"><a class="tocxref" href="#12Suggested-palettes"><bdi class="secno">12.5
                            </bdi>建议调色板</a></li>
                    <li class="tocline"><a class="tocxref" href="#12Interlacing"><bdi class="secno">12.6
                            </bdi>隔行</a></li>
                    <li class="tocline"><a class="tocxref" href="#12Filter-selection"><bdi class="secno">12.7
                            </bdi>滤波选择</a></li>
                    <li class="tocline"><a class="tocxref" href="#12Compression"><bdi class="secno">12.8
                            </bdi>压缩</a></li>
                    <li class="tocline"><a class="tocxref" href="#12Text-chunk-processing"><bdi class="secno">12.9
                            </bdi>文本块处理</a></li>
                    <li class="tocline"><a class="tocxref" href="#12Chunk-processing"><bdi class="secno">12.10
                            </bdi>分块</a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#12Use-of-private-chunks"><bdi
                                        class="secno">12.10.1 </bdi>使用私有块</a></li>
                            <li class="tocline"><a class="tocxref" href="#12Private-type-and-method-codes"><bdi
                                        class="secno">12.10.2 </bdi>使用非保留字段值</a></li>
                            <li class="tocline"><a class="tocxref" href="#12Ancillary"><bdi class="secno">12.10.3
                                    </bdi>辅助块</a></li>
                        </ol>
                    </li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#13Decoders"><bdi class="secno">13. </bdi>PNG 解码器与查看器</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#13Introduction">简介</a></li>
                    <li class="tocline"><a class="tocxref" href="#13Decoders.Errors"><bdi class="secno">13.1
                            </bdi>错误处理</a></li>
                    <li class="tocline"><a class="tocxref" href="#13Error-checking"><bdi class="secno">13.2
                            </bdi>错误检查</a></li>
                    <li class="tocline"><a class="tocxref" href="#13Security-considerations"><bdi class="secno">13.3
                            </bdi>安全注意事项</a></li>
                    <li class="tocline"><a class="tocxref" href="#Privacy-considerations"><bdi class="secno">13.4
                            </bdi>隐私注意事项</a></li>
                    <li class="tocline"><a class="tocxref" href="#13Chunking"><bdi class="secno">13.5 </bdi>分块</a>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#13Pixel-dimensions"><bdi class="secno">13.6
                            </bdi>像素尺寸</a></li>
                    <li class="tocline"><a class="tocxref" href="#13Text-chunk-processing"><bdi class="secno">13.7
                            </bdi>文本块处理</a></li>
                    <li class="tocline"><a class="tocxref" href="#13Decompression"><bdi class="secno">13.8
                            </bdi>解压缩</a></li>
                    <li class="tocline"><a class="tocxref" href="#13Filtering"><bdi class="secno">13.9
                            </bdi>滤波</a></li>
                    <li class="tocline"><a class="tocxref" href="#13Progressive-display"><bdi class="secno">13.10
                            </bdi>隔行与渐进显示</a></li>
                    <li class="tocline"><a class="tocxref" href="#13Truecolour-image-handling"><bdi class="secno">13.11
                            </bdi>真彩色图像处理</a></li>
                    <li class="tocline"><a class="tocxref" href="#13Sample-depth-rescaling"><bdi class="secno">13.12
                            </bdi>采样深度重缩放</a></li>
                    <li class="tocline"><a class="tocxref" href="#13Decoder-gamma-handling"><bdi class="secno">13.13
                            </bdi>解码器伽玛处理</a></li>
                    <li class="tocline"><a class="tocxref" href="#13Decoder-colour-handling"><bdi class="secno">13.14
                            </bdi>解码器色彩处理</a></li>
                    <li class="tocline"><a class="tocxref" href="#13Background-colour"><bdi class="secno">13.15
                            </bdi>背景色</a></li>
                    <li class="tocline"><a class="tocxref" href="#13Alpha-channel-processing"><bdi class="secno">13.16
                            </bdi>Alpha 通道处理</a></li>
                    <li class="tocline"><a class="tocxref" href="#13Histogram-and-suggested-palette-usage"><bdi
                                class="secno">13.17 </bdi>直方图与建议调色板的使用</a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#14EditorsExt"><bdi class="secno">14. </bdi>编辑器</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#14Additional-chunk-types"><bdi class="secno">14.1
                            </bdi>额外的块类型</a></li>
                    <li class="tocline"><a class="tocxref" href="#14Ordering"><bdi class="secno">14.2 </bdi>PNG
                            编辑器的行为</a></li>
                    <li class="tocline"><a class="tocxref" href="#14Ordering-of-chunks"><bdi class="secno">14.3
                            </bdi>块的排序</a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#14Ordering-of-critical-chunks"><bdi
                                        class="secno">14.3.1 </bdi>关键块的排序</a></li>
                            <li class="tocline"><a class="tocxref" href="#14Ordering-of-ancillary-chunks"><bdi
                                        class="secno">14.3.2 </bdi>辅助块的排序</a></li>
                        </ol>
                    </li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">15. </bdi>一致性</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#conformance-0"><bdi class="secno">15.1
                            </bdi>一致性</a></li>
                    <li class="tocline"><a class="tocxref" href="#15ConfIntro"><bdi class="secno">15.2
                            </bdi>简介</a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#15ConfObjectives"><bdi class="secno">15.2.1
                                    </bdi>目标</a></li>
                            <li class="tocline"><a class="tocxref" href="#15ConfScope"><bdi class="secno">15.2.2
                                    </bdi>范围</a></li>
                        </ol>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#15ConformanceConf"><bdi class="secno">15.3
                            </bdi>一致性条件</a>
                        <ol class="toc">
                            <li class="tocline"><a class="tocxref" href="#15FileConformance"><bdi class="secno">15.3.1
                                    </bdi>PNG 数据流一致性</a></li>
                            <li class="tocline"><a class="tocxref" href="#15ConformanceEncoder"><bdi
                                        class="secno">15.3.2 </bdi>PNG 编码器一致性</a></li>
                            <li class="tocline"><a class="tocxref" href="#15ConformanceDecoder"><bdi
                                        class="secno">15.3.3 </bdi>PNG 解码器一致性</a></li>
                            <li class="tocline"><a class="tocxref" href="#15ConformanceEditor"><bdi class="secno">15.3.4
                                    </bdi>PNG 编辑器一致性</a></li>
                        </ol>
                    </li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#IANA-registrations"><bdi class="secno">A. </bdi>Internet
                    媒体类型</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#A-Media-type"><bdi class="secno">A.1
                            </bdi>image/png</a></li>
                    <li class="tocline"><a class="tocxref" href="#image-apng"><bdi class="secno">A.2
                            </bdi>image/apng</a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#newchunks"><bdi class="secno">B. </bdi>私有块类型指导原则</a></li>
            <li class="tocline"><a class="tocxref" href="#gammachromaticity"><bdi class="secno">C. </bdi>伽玛与色度</a></li>
            <li class="tocline"><a class="tocxref" href="#samplecrc"><bdi class="secno">D. </bdi>示例 CRC 实现</a></li>
            <li class="tocline"><a class="tocxref" href="#onlineresources"><bdi class="secno">E. </bdi>在线资源</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#E-Intro">简介</a></li>
                    <li class="tocline"><a class="tocxref" href="#E-icc-profile-specs"><bdi class="secno">E.1 </bdi>ICC
                            配置文件规范</a></li>
                    <li class="tocline"><a class="tocxref" href="#E-PNG-home-page"><bdi class="secno">E.2 </bdi>PNG
                            网站</a></li>
                    <li class="tocline"><a class="tocxref" href="#E-Sample-implementation"><bdi class="secno">E.3
                            </bdi>示例实现与测试图像</a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#F-ChangeList"><bdi class="secno">F. </bdi>变更记录</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#changes-20250515"><bdi class="secno">F.1 </bdi>自<span
                                class="formerLink">2025年5月15日拟议推荐稿</span>以来的更改</a></li>
                    <li class="tocline"><a class="tocxref" href="#changes-20250313"><bdi class="secno">F.2 </bdi>自<span
                                class="formerLink">2025年3月13日候选推荐快照</span>以来的更改</a></li>
                    <li class="tocline"><a class="tocxref" href="#changes-20250121/"><bdi class="secno">F.3
                            </bdi>自<span class="formerLink">2025年1月21日候选推荐草案（第三版）</span>以来的更改</a></li>
                    <li class="tocline"><a class="tocxref" href="#changes-20240718"><bdi class="secno">F.4 </bdi>自<span
                                class="formerLink">2024年7月18日候选推荐草案（第三版）</span>以来的更改</a></li>
                    <li class="tocline"><a class="tocxref" href="#changes-20230921"><bdi class="secno">F.5 </bdi>自<span
                                class="formerLink">2023年9月21日候选推荐快照（第三版）</span>以来的更改</a></li>
                    <li class="tocline"><a class="tocxref" href="#changes-20230720"><bdi class="secno">F.6 </bdi>自<span
                                class="formerLink">2023年7月20日工作草案（第三版）</span>以来的更改</a>
                    </li>
                    <li class="tocline"><a class="tocxref" href="#changes-20221025"><bdi class="secno">F.7 </bdi>自<span
                                class="formerLink">2022年10月25日首个公开工作草案（第三版）</span>以来的更改</a></li>
                    <li class="tocline"><a class="tocxref" href="#changes-20031110"><bdi class="secno">F.8 </bdi>自<span
                                class="formerLink"><abbr title="World Wide Web Consortium">W3C</abbr>
                                2003年11月10日推荐标准</span>（PNG第二版）以来的更改</a></li>
                    <li class="tocline"><a class="tocxref" href="#changes-between-first-and-second-editions"><bdi
                                class="secno">F.9 </bdi>第一版与第二版之间的更改</a></li>
                </ol>
            </li>
            <li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">G. </bdi>参考文献</a>
                <ol class="toc">
                    <li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">G.1
                            </bdi>规范性参考文献</a></li>
                    <li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">G.2
                            </bdi>信息性参考文献</a></li>
                </ol>
            </li>
        </ol>
    </nav>


    <section id="introduction">
        <div class="header-wrapper">
            <h2 id="Introduction"><bdi class="secno">1. </bdi>简介</h2><a class="self-link" href="#Introduction"
                aria-label="Permalink for Section 1."></a>
        </div>

        <p>本规范的设计目标如下：</p>

        <ol>
            <li>可移植性：编码、解码和传输应与软件和硬件平台无关。</li>

            <li>完整性：应能够表示<a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3truecolour-2">真彩色</a>、<a href="#3indexedColour" class="internalDFN"
                    data-link-type="dfn" id="ref-for-3indexedColour-2">索引色</a>和<a href="#dfn-greyscale"
                    class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-greyscale-2">灰度</a>图像，并且每种情况都可以选择透明度、色彩空间信息以及如文本注释等辅助信息。</li>

            <li>串行编码与解码：应能串行地产生和读取数据流，使数据流格式可用于通过串行通信通道动态生成和显示图像。</li>

            <li>渐进式展现：应当能够传输数据流，使得最初可以显示整幅图的大致效果，并随着数据流的接收逐步增强。</li>

            <li>对传输错误的鲁棒性：应能够可靠地检测数据流传输错误。</li>

            <li>无损性：滤波和压缩应保留所有信息。</li>

            <li>性能：任何滤波、压缩和渐进式图像展现应以高效解码和显示为目标。快速编码不是首要目标，解码速度更为重要。可牺牲编码速度以提高解码速度。</li>

            <li>压缩：图像应在满足其他设计目标的前提下有效压缩。</li>

            <li>简洁性：开发者应能够轻松实现该标准。</li>

            <li>互操作性：任何符合标准的 PNG 解码器都应能读取所有符合标准的 PNG 数据流。</li>

            <li>灵活性：应允许未来扩展和私有扩展，同时不影响标准 PNG 数据流的互操作性。</li>

            <li>无法律限制：不应使用非自由可用的算法。</li>
        </ol>

    </section>
    <section id="scope">
        <div class="header-wrapper">
            <h2 id="1Scope"><bdi class="secno">2. </bdi>范围</h2><a class="self-link" href="#1Scope"
                aria-label="Permalink for Section 2."></a>
        </div>




        <p>本规范规定了一种数据流及其相关文件格式——可移植网络图形（PNG，发音“ping”），用于无损、可移植、压缩的单幅计算机图像或基于帧的动画，在互联网上进行传输。
        </p>
    </section>

    <section id="terms-definitions-and-abbreviated-terms">
        <div class="header-wrapper">
            <h2 id="3Defsandabbrevs"><bdi class="secno">3. </bdi>术语、定义与缩略语</h2><a class="self-link"
                href="#3Defsandabbrevs" aria-label="Permalink for Section 3."></a>
        </div>




        <p>为本规范起见，采用如下定义。</p>

        <dl>

            <dt id="3byte"><dfn data-plurals="bytes" id="dfn-byte" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">字节（byte）</dfn>
            </dt>
            <dt>八位字节（octet）</dt>

            <dd>8 位二进制整数，取值范围 [0, 255]，最高有效位为第 7 位，最低有效位为第 0 位。</dd>

            <dt id="3byteOrder"><dfn id="dfn-byte-order" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">字节序</dfn>
            </dt>

            <dd>
                多字节数据值的<a href="#dfn-byte" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-byte-1">字节</a>排列顺序。
            </dd>

            <dt id="3chromaticity"><dfn id="dfn-chromaticity" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">色度（chromaticity）</dfn>
            </dt>

            <dd>在 [<cite><a class="bibref" data-link-type="biblio" href="#bib-colorimetry"
                        title="Colorimetry, Fourth Edition. CIE 015:2018">COLORIMETRY</a></cite>] 指定的 <i>xyY</i> 空间中的
                <i>x</i> 和 <i>y</i> 一对值。

                <div class="note" role="note" id="issue-container-generatedID">
                    <div role="heading" class="note-title marker" id="h-note" aria-level="3"><span>注</span></div>
                    <p class="">色度是颜色质量的一种度量，与其亮度无关。</p>
                </div>
            </dd>

            <dt id="3composite"><dfn data-lt="composited|composite|composite (verb)" id="dfn-composited" tabindex="0"
                    aria-haspopup="dialog" data-dfn-type="dfn">合成（动词 composite）</dfn>
            </dt>

            <dd>通过合并前景图像和背景图像并利用透明度信息确定背景应显示的位置及程度，形成一幅图像。
                <div class="note" role="note" id="issue-container-generatedID-0">
                    <div role="heading" class="note-title marker" id="h-note-0" aria-level="3"><span>注</span></div>
                    <p class="">前景图像被称为已<a href="#dfn-composited" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-composited-1">合成</a>到背景之上。</p>
                </div>
            </dd>

            <dt id="3datastream"><dfn id="dfn-datastream" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">数据流（datastream）</dfn>
            </dt>

            <dd>
                由<a href="#dfn-byte" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-byte-2">字节</a>组成的序列。
            </dd>

            <dt id="3deflate"><dfn id="dfn-deflate" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">deflate</dfn>
            </dt>

            <dd>
                <a href="#3LZ77" class="internalDFN" data-link-type="dfn" id="ref-for-3LZ77-1">LZ77</a> 压缩方法家族成员。

                <p>来源：[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc1951"
                            title="DEFLATE Compressed Data Format Specification version 1.3">RFC1951</a></cite>]</p>
            </dd>

            <dt><dfn id="dfn-frame" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">帧（frame）</dfn></dt>

            <dd>对于静态 PNG，<a href="#dfn-static-image" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-static-image-1">静态图像</a>
                被视为第一帧（也是唯一一帧）。
                对于动画 PNG，每个组成<a href="#apng-frame-based-animation">基于帧的动画</a>序列的图像都是一帧。
                因此，对于动画 PNG，当静态图像不是第一帧时，静态图像不被视为一帧。
            </dd>

            <dt id="3frameBuffer"><dfn data-plurals="frame buffers" id="dfn-frame-buffer" tabindex="0"
                    aria-haspopup="dialog" data-dfn-type="dfn">帧缓冲区（frame buffer）</dfn>
            </dt>

            <dd>
                大多数类型计算机显示器用于显示图像的最终数字存储区域。

                <div class="note" role="note" id="issue-container-generatedID-1">
                    <div role="heading" class="note-title marker" id="h-note-1" aria-level="3"><span>注</span></div>
                    <p class="">软件通过将图像加载到<a href="#dfn-frame-buffer" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-frame-buffer-1">帧缓冲区</a>来实现屏幕显示。</p>
                </div>
            </dd>

            <dt><dfn id="dfn-fully-transparent-black" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">全透明黑（fully
                    transparent black）</dfn>
            </dt>

            <dd>红、绿、蓝和 alpha 分量均为零的像素。</dd>

            <dt><dfn data-plurals="gamma values" id="dfn-gamma-value" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">伽玛值（gamma value）</dfn>
            </dt>

            <dd>
                <a href="#dfn-gamma" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-1">伽玛</a><a
                    href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-transfer-function-1">传递函数</a>的指数值。
            </dd>

            <dt id="3gamma"><dfn id="dfn-gamma" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">伽玛（gamma）</dfn>
            </dt>

            <dd>
                幂律<a href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-transfer-function-2">传递函数</a>。
            </dd>

            <dt>高动态范围（<dfn id="dfn-hdr" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">HDR</dfn>）</dt>

            <dd>
                一种能够存储动态范围较高（接近或超过人眼瞬时动态范围，约 12-14 <a href="#dfn-stop" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-stop-1">级（stop）</a>）的图像格式。PNG 支持两种<a href="#dfn-hdr" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-hdr-1">HDR</a>格式，<a href="#dfn-hlg" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-hlg-1">HLG</a> 和 <a href="#dfn-pq" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-pq-1">PQ</a> [<cite><a class="bibref" data-link-type="biblio"
                        href="#bib-itu-r-bt.2100"
                        title="ITU-R BT.2100, SERIES BT: BROADCASTING SERVICE (TELEVISION). Image parameter values for high dynamic range television for use in production and international programme exchange">ITU-R-BT.2100</a></cite>]。
            </dd>

            <dt>混合对数伽玛（<dfn id="dfn-hlg" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">HLG</dfn>）</dt>

            <dd>
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-r-bt.2100"
                        title="ITU-R BT.2100, SERIES BT: BROADCASTING SERVICE (TELEVISION). Image parameter values for high dynamic range television for use in production and international programme exchange">ITU-R-BT.2100</a></cite>]
                表 5 所定义的<a href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-transfer-function-3">传递函数</a>。（一种相对场景参考系统。）
            </dd>

            <dt><dfn data-plurals="full-range images" id="dfn-full-range-image" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">全范围图像（full-range image）</dfn>
            </dt>

            <dd>参考黑和白分别对应采样值 <code>0</code> 和 <code>2<sup>bit depth</sup> - 1</code> 的图像。</dd>

            <dt id="3imageData"><dfn id="dfn-image-data" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">图像数据（image data）</dfn>
            </dt>

            <dd>
                图像中的一维<a href="#dfn-scanline" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-scanline-1">扫描线</a>数组。
            </dd>

            <dt id="3interlacedPNGimage"><dfn id="dfn-interlaced-png-image" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">隔行 PNG 图像（interlaced PNG image）</dfn>
            </dt>

            <dd>
                通过<a href="#3passExtraction" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3passExtraction-1">通道提取</a>，由<a href="#3PNGimage" class="internalDFN"
                    data-link-type="dfn" id="ref-for-3PNGimage-1">PNG 图像</a>生成的一系列<a href="#3reducedImage"
                    class="internalDFN" data-link-type="dfn" id="ref-for-3reducedImage-1">缩减图像</a>。
            </dd>

            <dt id="3losslessCompression"><dfn id="dfn-lossless" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">无损（lossless）</dfn>
            </dt>

            <dd>允许完全按位重建原始数据的数据压缩方法。</dd>

            <dt id="3luminance"><dfn id="dfn-luminance" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">亮度（luminance）</dfn>
            </dt>

            <dd>
                可见光强度的客观测量，考虑了人眼对不同波长的敏感度。

                <div class="note" role="note" id="issue-container-generatedID-2">
                    <div role="heading" class="note-title marker" id="h-note-2" aria-level="3"><span>注</span></div>
                    <p class="">亮度和<a href="#dfn-chromaticity" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-chromaticity-1">色度</a>共同完全定义了一种测量颜色。正式定义见 [<cite><a class="bibref"
                                data-link-type="biblio" href="#bib-colorimetry"
                                title="Colorimetry, Fourth Edition. CIE 015:2018">COLORIMETRY</a></cite>]。</p>
                </div>
            </dd>

            <dt><dfn id="3LZ77" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">LZ77</dfn>
            </dt>

            <dd>见 [<cite><a class="bibref" data-link-type="biblio" href="#bib-ziv-lempel"
                        title="A Universal Algorithm for Sequential Data Compression, IEEE Transactions on Information Theory, vol. IT-23, no. 3, pp. 337 - 343">Ziv-Lempel</a></cite>]
                所述的数据压缩算法。
            </dd>

            <dt><dfn data-plurals="narrow-range images" id="dfn-narrow-range-image" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">窄范围图像（narrow-range image）</dfn>
            </dt>

            <dd>参考黑和白不分别对应采样值 <code>0</code> 和 <code>2<sup>bit depth</sup> - 1</code> 的图像。</dd>

            <dt id="3networkByteOrder"><dfn id="dfn-network-byte-order" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">网络字节序（network byte order）</dfn>
            </dt>

            <dd>
                <a href="#dfn-byte-order" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-byte-order-1">字节序</a>，最高有效字节（MSB）在前，然后是次高有效字节，依次递减（例如，二字节整数为 MSB LSB，四字节整数为 MSB B2
                B1 LSB）。
            </dd>

            <dt>感知量化器（<dfn id="dfn-pq" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">PQ</dfn>）</dt>

            <dd>
                <a href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-transfer-function-4">传递函数</a>，定义见 [<cite><a class="bibref" data-link-type="biblio"
                        href="#bib-itu-r-bt.2100"
                        title="ITU-R BT.2100, SERIES BT: BROADCASTING SERVICE (TELEVISION). Image parameter values for high dynamic range television for use in production and international programme exchange">ITU-R-BT.2100</a></cite>]
                表 4。（一种绝对显示参考系统。）
                <div class="note" role="note" id="issue-container-generatedID-3">
                    <div role="heading" class="note-title marker" id="h-note-3" aria-level="3"><span>注</span></div>
                    <p class="">
                        PNG 只支持 RGB，不支持 ICtCp。
                    </p>
                </div>
            </dd>

            <dt id="3PNGdecoder">PNG 解码器</dt>

            <dd>
                从<a href="#3PNGdatastream" class="internalDFN" data-link-type="dfn" id="ref-for-3PNGdatastream-1">PNG
                    数据流</a>重建<a href="#3referenceImage" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3referenceImage-1">参考图像</a>并生成对应<a href="#3deliveredImage" class="internalDFN"
                    data-link-type="dfn" id="ref-for-3deliveredImage-1">输出图像</a>的过程或设备。
            </dd>

            <dt id="3PNGeditor"><dfn data-plurals="png editors" id="dfn-png-editor" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">PNG 编辑器</dfn>
            </dt>

            <dd>
                修改现有<a href="#3PNGdatastream" class="internalDFN" data-link-type="dfn" id="ref-for-3PNGdatastream-2">PNG
                    数据流</a>的过程或设备，尽可能保留未修改的辅助信息，并遵循<a href="#3chunk" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3chunk-1">块</a>排序规则，即使对于未知块类型也同样适用。
            </dd>

            <dt id="3PNGencoder">PNG 编码器
            </dt>

            <dd>
                从<a href="#3sourceImage" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3sourceImage-1">源图像</a>构建<a href="#3referenceImage" class="internalDFN"
                    data-link-type="dfn" id="ref-for-3referenceImage-2">参考图像</a>，并生成表示该参考图像的<a href="#3PNGdatastream"
                    class="internalDFN" data-link-type="dfn" id="ref-for-3PNGdatastream-3">PNG 数据流</a>的过程或设备。
            </dd>

            <dt id="3PNGfile">PNG 文件
            </dt>

            <dd>
                以文件形式存储的<a href="#3PNGdatastream" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3PNGdatastream-4">PNG 数据流</a>。
            </dd>

            <dt id="3PNGfourByteUnSignedInteger"><dfn data-plurals="png four-byte unsigned integers"
                    id="dfn-png-four-byte-unsigned-integer" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">PNG
                    四字节无符号整数</dfn>
            </dt>

            <dd>
                <p>范围为 0 到 2<sup>31</sup>-1 的四字节无符号整数。</p>

                <div class="note" role="note" id="issue-container-generatedID-4">
                    <div role="heading" class="note-title marker" id="h-note-4" aria-level="3"><span>注</span></div>
                    <p class="">此限制是为了适应难以处理无符号四字节值的编程语言。</p>
                </div>
            </dd>

            <dt id="3PNGtwoByteUnSignedInteger"><dfn id="dfn-png-two-byte-unsigned-integer" tabindex="0"
                    aria-haspopup="dialog" data-dfn-type="dfn">PNG 两字节无符号整数</dfn>
            </dt>

            <dd>
                <p>以网络字节序存储的两字节无符号整数。</p>
            </dd>

            <dt id="3sample"><dfn data-plurals="samples" id="dfn-sample" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">采样值（sample）</dfn>
            </dt>

            <dd>
                图像中<a href="#3channel" class="internalDFN" data-link-type="dfn" id="ref-for-3channel-1">通道</a>与<a
                    href="#3pixel" class="internalDFN" data-link-type="dfn" id="ref-for-3pixel-1">像素</a>的交点。
            </dd>

            <dt id="3sampleDepth">采样深度（sample depth）</dt>

            <dd>
                表示<a href="#dfn-sample" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-sample-1">采样值</a>所用的比特数。
            </dd>

            <dt id="3scanline"><dfn data-plurals="scanlines" id="dfn-scanline" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">扫描线（scanline）</dfn>
            </dt>

            <dd>
                图像或<a href="#dfn-interlaced-png-image" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-interlaced-png-image-1">隔行 PNG 图像</a>中的一行<a href="#3pixel" class="internalDFN"
                    data-link-type="dfn" id="ref-for-3pixel-2">像素</a>。
            </dd>

            <dt>标准动态范围（<dfn id="dfn-sdr" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">SDR</dfn>）</dt>

            <dd>
                能够存储动态范围较低（5-8 <a href="#dfn-stop" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-stop-2">级</a>）的图像格式。例如 [<cite><a class="bibref" data-link-type="biblio"
                        href="#bib-srgb"
                        title="Multimedia systems and equipment - Colour measurement and management - Part 2-1: Colour management - Default RGB colour space - sRGB">SRGB</a></cite>]、
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-display-p3"
                        title="Display P3">Display-P3</a></cite>]、[<cite><a class="bibref" data-link-type="biblio"
                        href="#bib-itu-r-bt.709"
                        title="ITU-R BT.709, SERIES BT: BROADCASTING SERVICE (TELEVISION). Parameter values for the HDTV standards for production and international programme exchange">ITU-R-BT.709</a></cite>]。
                <div class="note" role="note" id="issue-container-generatedID-5">
                    <div role="heading" class="note-title marker" id="h-note-5" aria-level="3"><span>注</span></div>
                    <p class="">标准动态范围与主色度无关，也即与色域无关。PNG 支持广色域<a href="#dfn-sdr" class="internalDFN"
                            data-link-type="dfn" id="ref-for-dfn-sdr-1">SDR</a>格式。</p>
                </div>
            </dd>

            <dt><dfn data-plurals="stops" id="dfn-stop" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">级（stop）</dfn>
            </dt>

            <dd>
                场景亮度变化一倍（二倍）的单位。
            </dd>

            <dt><dfn data-plurals="transfer functions" id="dfn-transfer-function" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">传递函数（transfer function）</dfn>
            </dt>

            <dd>描述图像亮度与采样值之间关系的函数。</dd>

            <dt id="3whitePoint"><dfn data-plurals="white points" id="dfn-white-point" tabindex="0"
                    aria-haspopup="dialog" data-dfn-type="dfn">白点（white point）</dfn>
            </dt>

            <dd>
                计算机显示设备名义白色值的<a href="#dfn-chromaticity" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-chromaticity-2">色度</a>。
            </dd>

            <dt id="3zlib"><dfn id="dfn-zlib" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">zlib</dfn>
            </dt>

            <dd>
                <p><a href="#dfn-deflate" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-deflate-1">deflate</a> 风格的压缩方法。</p>

                <p>来源：[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc1950"
                            title="ZLIB Compressed Data Format Specification version 3.3">rfc1950</a></cite>]</p>

                <div class="note" role="note" id="issue-container-generatedID-6">
                    <div role="heading" class="note-title marker" id="h-note-6" aria-level="3"><span>注</span></div>
                    <p class="">也指包含该方法示例实现的库的名称。</p>
                </div>
            </dd>

            <dt id="3CRC">循环冗余校验码（Cyclic Redundancy Code）</dt>
            <dt><abbr title="Cyclic Redundancy Code">CRC</abbr></dt>
            <dd>
                <p>检测大多数传输错误的一种校验值类型。</p>

                <div class="note" role="note" id="issue-container-generatedID-7">
                    <div role="heading" class="note-title marker" id="h-note-7" aria-level="3"><span>注</span></div>
                    <p class="">解码器为接收数据计算 <abbr title="Cyclic Redundancy Code">CRC</abbr> 并与编码器计算并追加到数据后的 <abbr
                            title="Cyclic Redundancy Code">CRC</abbr> 比较。不匹配表示数据或 <abbr
                            title="Cyclic Redundancy Code">CRC</abbr> 在传输中已损坏。</p>
                </div>
            </dd>

            <dt id="3CRT">阴极射线管（Cathode Ray Tube）</dt>
            <dt><abbr title="Cathode Ray Tube">CRT</abbr></dt>

            <dd>一种真空管，内含一个或多个电子枪，通过操控电子束在荧光屏上显示图像。</dd>

            <dt>电光传递函数（Electro-Optical Transfer Function）</dt>
            <dt>
                <abbr title="Electro-Optical Transfer Function"><dfn id="dfn-eotf" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn"><abbr title="Electro-Optical Transfer Function">EOTF</abbr></dfn></abbr>
            </dt>
            <dd>电或数字域与光能量之间的<a href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-transfer-function-5">传递函数</a>。它定义了显示器对于给定输入信号发射的光量。</dd>

            <dt id="3LSB">最低有效字节（Least Significant Byte）</dt>
            <dt><abbr title="Least Significant Byte">LSB</abbr></dt>
            <dd>
                多<a href="#dfn-byte" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-byte-3">字节</a>值中的最低有效字节。
            </dd>

            <dt id="3MSB">最高有效字节（Most Significant Byte）</dt>
            <dt><abbr title="Most Significant Byte">MSB</abbr></dt>

            <dd>
                多<a href="#dfn-byte" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-byte-4">字节</a>值中的最高有效字节。
            </dd>

            <dt>光电传递函数（Opto-Electrical Transfer Function）</dt>
            <dt>
                <abbr title="Opto-Electrical Transfer Function"><dfn id="dfn-oetf" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn"><abbr title="Opto-Electrical Transfer Function">OETF</abbr></dfn></abbr>
            </dt>
            <dd>光能量与电或数字域之间的<a href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-transfer-function-6">传递函数</a>。它定义了场景中产生某一输出信号所需的光量。</dd>
        </dl>
    </section>



    <section id="concepts">
        <div class="header-wrapper">
            <h2 id="4Concepts"><bdi class="secno">4. </bdi>基本概念</h2><a class="self-link" href="#4Concepts"
                aria-label="Permalink for Section 4."></a>
        </div>




        <section id="static-and-animated-images">
            <div class="header-wrapper">
                <h3 id="x4-1-static-and-animated-images"><bdi class="secno">4.1 </bdi>静态与动画图像</h3><a class="self-link"
                    href="#static-and-animated-images" aria-label="Permalink for Section 4.1"></a>
            </div>


            <p>所有 PNG 图像都包含一个<dfn id="dfn-static-image" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">静态图像</dfn>。</p>

            <p>某些 PNG 图像——称为<dfn class="lint-ignore" id="dfn-animated-png" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">动画 PNG</dfn>（<abbr title="Animated PNG">APNG</abbr>）——还包含一个基于帧的动画序列，即<dfn
                    id="dfn-animated-image" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">动画图像</dfn>。其第一帧可以是（但不一定是）<a href="#dfn-static-image" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-static-image-2">静态图像</a>。不支持动画的显示设备（如打印机）将显示<a
                    href="#dfn-static-image" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-static-image-3">静态图像</a>，而非动画序列。</p>

            <p><a href="#dfn-static-image" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-static-image-4">静态图像</a>以及<a href="#dfn-animated-image" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-animated-image-1">动画图像</a>的每个独立帧，都对应一个<em>参考图像</em>，并以<em>PNG
                    图像</em>的形式存储。</p>

        </section>

        <section id="images">
            <div class="header-wrapper">
                <h3 id="4Concepts.Sourceimage"><bdi class="secno">4.2 </bdi>图像</h3><a class="self-link"
                    href="#4Concepts.Sourceimage" aria-label="Permalink for Section 4.2"></a>
            </div>




            <p>本规范规定了 PNG 数据流，并对生成 PNG 数据流的 PNG 编码器、解释 PNG 数据流的 PNG 解码器以及将一个 PNG 数据流转换为另一个的<a href="#dfn-png-editor"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-png-editor-1">PNG 编辑器</a>提出了一些要求。它不规定应用与
                PNG 编码器、解码器或编辑器之间的接口。并未规定图像呈现给编码器或由解码器输出的精确形式。图像区分为四类。</p>

            <dl>

                <dt><dfn id="3sourceImage" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">源图像（Source
                        image）</dfn>
                </dt>
                <dd><i>源图像</i>是呈现给 PNG 编码器的图像。</dd>



                <dt><dfn id="3referenceImage" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">参考图像（Reference
                        image）</dfn></dt>
                <dd><a href="#3referenceImage" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3referenceImage-3">参考图像</a>仅在概念上存在，是一个由矩形<dfn id="3pixel" data-plurals="pixel"
                        tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">像素</dfn>构成的矩形数组，所有像素具有相同的宽和高，并且都包含相同数量的无符号整数采样值，或为三个（红、绿、蓝），或为四个（红、绿、蓝、alpha）。某一类（红、绿、蓝或
                    alpha）的所有采样值构成的数组称为

                    <dfn id="3channel" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">通道</dfn>。每个通道的采样深度范围为 1 至
                    16，即该通道中每个采样所使用的位数。不同通道可具有不同的采样深度。红、绿和蓝采样决定像素颜色的红、绿、蓝分量强度；若它们全为零，则像素为黑色；若它们都取最大值（2<sup>sampledepth</sup>-1），则像素为白色。<dfn
                        id="3alpha" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">alpha</dfn>采样决定像素的不透明度，零表示完全透明，最大值表示完全不透明。在三通道参考图像中，所有像素完全不透明。（四通道参考图像也可能所有像素完全不透明；不同在于后者具有特定的
                    alpha 采样深度，而前者没有。）每一水平像素行称为一条扫描线。每条扫描线内像素从左到右排序，扫描线从上到下排序。每个参考图像都可以被<a href="#3PNGdatastream"
                        class="internalDFN" data-link-type="dfn" id="ref-for-3PNGdatastream-5">PNG 数据流</a>精确表示，且每个<a
                        href="#3PNGdatastream" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3PNGdatastream-6">PNG 数据流</a>都可以转换为一个参考图像。PNG 编码器可以将源图像直接转换为 PNG
                    图像，但从概念上讲，它首先将源图像转换为参考图像，然后将参考图像转换为 PNG 图像。根据源图像类型，从源图像到参考图像的转换可能需要信息损失。该转换超出本国际标准的范围。然而，参考图像总能从 PNG
                    数据流精确恢复。
                </dd>


                <dt><dfn id="3PNGimage" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">PNG 图像（PNG image）</dfn>
                </dt>
                <dd><i>PNG 图像</i>由参考图像经过一系列转换获得：<a href="#3alphaSeparation" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3alphaSeparation-1">Alpha 分离</a>、<a href="#3indexing" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3indexing-1">索引</a>、<a href="#3RGBmerging" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3RGBmerging-1">RGB 合并</a>、<a href="#3alphaCompaction"
                        class="internalDFN" data-link-type="dfn" id="ref-for-3alphaCompaction-1">Alpha 压缩</a>以及<a
                        href="#3sampleDepthScaling" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3sampleDepthScaling-1">采样深度缩放</a>。定义了五种 PNG 图像类型（见<a href="#6Colour-values"
                        class="sec-ref"><bdi class="secno">6.1 </bdi>颜色类型与取值</a>）。（如果 PNG 编码器确实将源图像直接转换为 PNG 图像，且源图像格式已与
                    PNG 图像格式相似，编码器可能无需执行其中某些转换。）尽管 PNG 图像并未明确支持 1 至 16 位范围内的所有采样深度，但可记录参考图像中每个通道的有效位数。PNG
                    图像中的所有通道具有相同的采样深度。PNG 编码器从 PNG 图像生成 PNG 数据流。PNG 解码器读取 PNG 数据流并重建 PNG 图像。
                </dd>


                <dt><dfn id="3deliveredImage" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">输出图像（Delivered
                        image）</dfn></dt>
                <dd><a href="#3deliveredImage" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3deliveredImage-2">输出图像</a>由解码 PNG 数据流得到的 PNG 图像构建而成。未对<a href="#3deliveredImage"
                        class="internalDFN" data-link-type="dfn"
                        id="ref-for-3deliveredImage-3">输出图像</a>规定具体格式。查看器应尽可能以接近原始源图像外观的方式向用户呈现图像。
                </dd>
            </dl>

            <p>四类图像之间的关系如<a href="#image-relationship" class="fig-ref"
                    title="Relationships between source, reference, PNG, and display images">图 <bdi
                        class="">1</bdi></a>所示。</p>

            <figure id="image-relationship">

                <img id="figure41" src="https://www.w3.org/TR/png-3/figures/image-relationships.svg">

                <figcaption><a class="self-link" href="#image-relationship">图 <bdi class="figno">1</bdi></a> <span
                        class="fig-title">
                        源图像、参考图像、PNG 图像与显示图像之间的关系
                    </span></figcaption>
            </figure>



            <p>采样值、通道、像素与采样深度之间的关系如<a href="#sample-pixel-channel-relationship" class="fig-ref"
                    title="Relationships between sample, sample depth, pixel, and channel">图 <bdi
                        class="">2</bdi></a>所示。</p>

            <figure id="sample-pixel-channel-relationship">

                <img id="figure42" src="https://www.w3.org/TR/png-3/figures/sample-pixel-channel-relationship.svg"
                    width="640" height="290">

                <figcaption><a class="self-link" href="#sample-pixel-channel-relationship">图 <bdi
                            class="figno">2</bdi></a> <span class="fig-title">
                        采样值、采样深度、像素与通道之间的关系
                    </span></figcaption>
            </figure>
        </section>


        <section id="4Concepts.ColourSpaces">
            <div class="header-wrapper">
                <h3 id="x4-3-color-spaces"><bdi class="secno">4.3 </bdi>色彩空间</h3><a class="self-link"
                    href="#4Concepts.ColourSpaces" aria-label="Permalink for Section 4.3"></a>
            </div>


            <p>颜色采样所处的 RGB 色彩空间可通过以下四种方式之一指定：</p>


            <ol>
                <li>通过 CICP 图像格式信令元数据；</li>

                <li>通过 ICC 配置文件；</li>

                <li>当采样符合该色彩空间时，明确指定色彩空间为 sRGB；</li>

                <li>通过指定<a href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-gamma-value-1">伽玛值</a>以及图像中所用红、绿、蓝三基色的 1931 CIE <i>x,y</i> 色度，并指定参考<a
                        href="#dfn-white-point" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-white-point-1">白点</a>。
                </li>
            </ol>

            <p>对于高端应用，前两种方法提供了最大的灵活性与可控性。第三种方法可指示一种特定但极为常见的色彩空间。第四种方法在 ICC 配置文件被广泛采用之前已标准化，能精确指定 RGB 数据的色度以及应应用的<a
                    href="#dfn-gamma" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-2">伽玛</a>校正（见<a
                    href="#C-GammaAppendix" class="sec-ref"><bdi class="secno">C.
                    </bdi>伽玛与色度</a>）。然而，具有色彩管理的应用更倾向于前三种方法之一，而无色彩管理的应用通常会忽略全部四种方法。</p>

            <p><a href="#color-chunk-precendence" class="table-ref" title="Color Chunk Priority">表 <bdi
                        class="">1</bdi></a>列出了提供色彩空间信息的块类型及其对应的优先级编号。若单个图像同时包含多种此类块类型，则应以优先级编号最低的块为准，忽略编号更高的块类型。</p>

            <table id="color-chunk-precendence" class="numbered simple">
                <caption><a class="self-link" href="#color-chunk-precendence">表 <bdi class="tableno">1</bdi></a>
                    <span class="table-title">
                        颜色块优先级
                    </span>
                </caption>

                <tbody>
                    <tr>
                        <th>块类型</th>
                        <th>优先级</th>
                    </tr>

                    <tr>
                        <td><a href="#cICP-chunk" class="chunk">cICP</a></td>
                        <td>1</td>
                    </tr>

                    <tr>
                        <td><a class="chunk" href="#11iCCP">iCCP</a></td>
                        <td>2</td>
                    </tr>

                    <tr>
                        <td><a class="chunk" href="#11sRGB">sRGB</a></td>
                        <td>3</td>
                    </tr>

                    <tr>
                        <td><a class="chunk" href="#11cHRM">cHRM</a> 和 <a class="chunk" href="#11gAMA">gAMA</a></td>
                        <td>4</td>
                    </tr>
                </tbody>
            </table>

            <p><a href="#dfn-gamma" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-3">伽玛</a>校正不适用于（若存在的）alpha 通道。Alpha 采样始终为全范围，表示相对于完全不透明的线性比例。</p>

            <p>还可以提供母版制作相关的元数据。</p>
        </section>


        <section id="4Concepts.PNGImageTransformation">
            <div class="header-wrapper">
                <h3 id="x4-4-reference-image-to-png-image-transformation"><bdi class="secno">4.4 </bdi>参考图像到 PNG 图像的转换
                </h3><a class="self-link" href="#4Concepts.PNGImageTransformation"
                    aria-label="Permalink for Section 4.4"></a>
            </div>



            <section class="introductory" id="4Concepts.Introduction">
                <div class="header-wrapper">
                    <h3 id="introduction-1">简介</h3><a class="self-link" href="#4Concepts.Introduction"
                        aria-label="Permalink for this Section"></a>
                </div>


                <p>为生成将被编码的 PNG 图像，需要对参考图像应用若干转换（见<a href="#reference-to-png-transformation" class="fig-ref"
                        title="Reference image to PNG image transformation">图 <bdi
                            class="">3</bdi></a>）。转换按以下顺序进行，方括号表示该转换为可选：</p>

                <pre aria-busy="false"><code class="hljs css"><span class="hljs-selector-attr">[Alpha 分离]</span>
索引 或 ( <span class="hljs-selector-attr">[RGB 合并]</span> <span class="hljs-selector-attr">[Alpha 压缩]</span> )
采样深度缩放</code></pre>
                <p>当每个像素非完全透明即完全不透明时，<a href="#3alphaSeparation" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3alphaSeparation-2">Alpha 分离</a>、<a href="#3alphaCompaction" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3alphaCompaction-2">Alpha 压缩</a>与<a href="#3indexing"
                        class="internalDFN" data-link-type="dfn" id="ref-for-3indexing-2">索引</a>转换可能导致恢复的参考图像的 alpha
                    采样深度不同于原参考图像，或不再具有 alpha 通道。这不会影响任何像素的不透明程度。两者被视为等效参考图像，这些转换被视为无损。若编码器希望保留 alpha 采样深度，可选择不执行会改变
                    alpha 采样深度的转换。
                </p>



                <figure id="reference-to-png-transformation">

                    <img id="figure43" src="https://www.w3.org/TR/png-3/figures/reference-to-png-transformation.svg"
                        height="525" width="370">

                    <figcaption><a class="self-link" href="#reference-to-png-transformation">图 <bdi
                                class="figno">3</bdi></a> <span class="fig-title">
                            参考图像到 PNG 图像的转换
                        </span></figcaption>
                </figure>
            </section>

            <section id="4Concepts.Implied-alpha">
                <div class="header-wrapper">
                    <h4 id="x4-4-1-alpha-separation"><bdi class="secno">4.4.1 </bdi><dfn id="3alphaSeparation"
                            tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Alpha 分离</dfn></h4><a
                        class="self-link" href="#4Concepts.Implied-alpha" aria-label="Permalink for Section 4.4.1"></a>
                </div>



                <p>若参考图像中的所有 alpha 采样均为最大值，则可省略 alpha 通道，从而得到一个等效图像，并可更紧凑地编码。</p>
            </section>


            <section id="4Concepts.Indexing">
                <div class="header-wrapper">
                    <h4 id="x4-4-2-indexing"><bdi class="secno">4.4.2 </bdi>索引</h4><a class="self-link"
                        href="#4Concepts.Indexing" aria-label="Permalink for Section 4.4.2"></a>
                </div>


                <p>如果不同像素值的数量不超过 256，且 RGB 采样深度不大于 8，并且 alpha 通道不存在或恰为 8 位，或每个像素非完全透明即完全不透明，那么通过<dfn id="3indexing"
                        tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">索引</dfn>转换得到的替代<a href="#3indexedColour"
                        class="internalDFN" data-link-type="dfn" id="ref-for-3indexedColour-3">索引色</a>表示，可能更高效地进行编码。




                    在<dfn id="3indexedColour" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">索引色</dfn>表示中，每个像素被一个调色板索引取代。<dfn id="3palette" tabindex="0"
                        aria-haspopup="dialog" data-dfn-type="dfn">调色板</dfn>
                    是一个条目列表，每个条目包含三个 8 位采样值（红、绿、蓝）。如果存在 alpha 通道，还存在一个并行的 8 位 alpha 采样表，称为<dfn id="3alphaTable"
                        tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">alpha 表</dfn>。
                </p>



                <figure id="indexed-colour-image">

                    <img id="figure44" height="450" width="660"
                        src="https://www.w3.org/TR/png-3/figures/indexed-colour-image.svg">

                    <figcaption><a class="self-link" href="#indexed-colour-image">图 <bdi class="figno">4</bdi></a>
                        <span class="fig-title">
                            索引色图像
                        </span>
                    </figcaption>
                </figure>

                <p>即使 PNG 图像不是<a href="#3indexedColour" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3indexedColour-4">索引色</a>，也可以构建建议的调色板，以帮助那些只能显示有限颜色数量的查看器。</p>

                <p>对于<a href="#3indexedColour" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3indexedColour-5">索引色</a>图像，编码器可以重新排列调色板，使具有最大 alpha
                    值的表项分组到末尾。在这种情况下，表可以以缩短的形式编码，不包含这些表项。</p>

                <p>创建索引色 PNG 的编码器不得插入大于调色板表实际长度的索引值；这样做是错误的，不同解码器对该错误的处理会有所不同。</p>
            </section>


            <section id="4Concepts.RGBMerging">
                <div class="header-wrapper">
                    <h4 id="x4-4-3-rgb-merging"><bdi class="secno">4.4.3 </bdi><dfn id="3RGBmerging" tabindex="0"
                            aria-haspopup="dialog" data-dfn-type="dfn">RGB 合并</dfn>
                    </h4><a class="self-link" href="#4Concepts.RGBMerging" aria-label="Permalink for Section 4.4.3"></a>
                </div>




                <p>若红、绿、蓝通道具有相同的采样深度，且对于每个像素，红、绿、蓝采样值都相等，则可将这三条通道合并为单条灰度通道。</p>
            </section>


            <section id="4Concepts.Alpha-indexing">
                <div class="header-wrapper">
                    <h4 id="x4-4-4-alpha-compaction"><bdi class="secno">4.4.4 </bdi><dfn id="3alphaCompaction"
                            tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Alpha 压缩</dfn></h4><a
                        class="self-link" href="#4Concepts.Alpha-indexing" aria-label="Permalink for Section 4.4.4"></a>
                </div>



                <p>对于非索引图像，如果存在某个 RGB（或灰度）值，使得所有具有该值的像素完全透明，而所有其他像素完全不透明，则可仅通过标识该透明的 RGB（或灰度）值来更紧凑地表示 alpha 通道。</p>
            </section>


            <section id="4Concepts.Scaling">
                <div class="header-wrapper">
                    <h4 id="x4-4-5-sample-depth-scaling"><bdi class="secno">4.4.5 </bdi><dfn id="3sampleDepthScaling"
                            tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">采样深度缩放</dfn>
                    </h4><a class="self-link" href="#4Concepts.Scaling" aria-label="Permalink for Section 4.4.5"></a>
                </div>




                <p>在 PNG 图像中，并非所有采样深度都受支持（见<a href="#6Colour-values" class="sec-ref"><bdi class="secno">6.1
                        </bdi>颜色类型与取值</a>），并且所有通道应具有相同的采样深度。PNG 图像的所有通道使用不小于参考图像中任何采样深度的、最小的允许采样深度，并将参考图像中的可能采样值线性映射到
                    PNG 图像的下一允许范围。<a href="#scaling-sample-values" class="fig-ref" title="Scaling sample values">图 <bdi
                            class="">5</bdi></a>展示了如何将深度为 3 的采样映射到深度为 4 的采样。</p>



                <figure id="scaling-sample-values">

                    <img id="figure45" height="320" width="280"
                        src="https://www.w3.org/TR/png-3/figures/scaling-sample-values.svg">

                    <figcaption><a class="self-link" href="#scaling-sample-values">图 <bdi class="figno">5</bdi></a>
                        <span class="fig-title">
                            采样值缩放
                        </span>
                    </figcaption>
                </figure>

                <p>仅允许少数采样深度可减少解码器需要处理的情况。<a href="#3sampleDepthScaling" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3sampleDepthScaling-2">采样深度缩放</a>是可逆且无损的，因为可在 PNG
                    数据流中记录参考图像的采样深度。如果未记录采样深度，则参考图像的采样深度等于 PNG 图像的采样深度。参见<a href="#12Sample-depth-scaling"
                        class="sec-ref"><bdi class="secno">12.4 </bdi>采样深度缩放</a>与<a href="#13Sample-depth-rescaling"
                        class="sec-ref"><bdi class="secno">13.12
                        </bdi>采样深度重缩放</a>。</p>

                <figure id="possible-pixel-types">

                    <img id="figure46" src="https://www.w3.org/TR/png-3/figures/possible-pixel-types.svg">

                    <figcaption><a class="self-link" href="#possible-pixel-types">图 <bdi class="figno">6</bdi></a>
                        <span class="fig-title">
                            可能的 PNG 图像像素类型
                        </span>
                    </figcaption>
                </figure>
            </section>
        </section>




        <section id="4Concepts.PNGImage">
            <div class="header-wrapper">
                <h3 id="x4-5-png-image"><bdi class="secno">4.5 </bdi>PNG 图像</h3><a class="self-link"
                    href="#4Concepts.PNGImage" aria-label="Permalink for Section 4.5"></a>
            </div>


            <p>参考图像的转换会得到五种 PNG 图像类型之一（见<a href="#possible-pixel-types" class="fig-ref"
                    title="Possible PNG image pixel types">图 <bdi class="">6</bdi></a>）：</p>


            <dl>
                <dt><dfn id="dfn-truecolor-with-alpha" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">真彩色（含
                        alpha）</dfn></dt>
                <dd>每个<a href="#3pixel" class="internalDFN" data-link-type="dfn" id="ref-for-3pixel-3">像素</a>由四个<a
                        href="#dfn-sample" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-sample-2">采样</a>组成：红、绿、蓝和<a href="#3alpha" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3alpha-1">alpha</a>。</dd>

                <dt><dfn id="dfn-greyscale-with-alpha" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">灰度（含
                        alpha）</dfn></dt>
                <dd>每个<a href="#3pixel" class="internalDFN" data-link-type="dfn" id="ref-for-3pixel-4">像素</a>由两个<a
                        href="#dfn-sample" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-sample-3">采样</a>组成：一个<a href="#3greyscale" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3greyscale-1">灰度采样</a>和一个<a href="#3alpha" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3alpha-2">alpha</a>采样。</dd>


                <dt id="truecolor"><dfn id="3truecolour" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">真彩色</dfn></dt>
                <dd>每个<a href="#3pixel" class="internalDFN" data-link-type="dfn" id="ref-for-3pixel-5">像素</a>由三个<a
                        href="#dfn-sample" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-sample-4">采样</a>组成：红、绿、蓝。可选的 alpha 通道可以作为单个红、绿、蓝<a href="#dfn-sample"
                        class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sample-5">采样</a>三元组来指定：图像中其红、绿、蓝<a
                        href="#dfn-sample" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sample-6">采样</a>与
                    alpha 通道的红、绿、蓝<a href="#dfn-sample" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-sample-7">采样</a>完全相同的<a href="#3pixel" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3pixel-6">像素</a>为完全透明；其他像素为完全不透明。若不存在 alpha 通道，所有<a href="#3pixel"
                        class="internalDFN" data-link-type="dfn" id="ref-for-3pixel-7">像素</a>完全不透明。</dd>

                <dt><dfn id="dfn-greyscale" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">灰度</dfn></dt>

                <dd>每个像素由单个<dfn id="3greyscale" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">灰度采样</dfn>构成，表示整体<a href="#dfn-luminance" class="internalDFN"
                        data-link-type="dfn" id="ref-for-dfn-luminance-1">亮度</a>（从黑到白）。可选的 alpha 通道可以作为单个<a
                        href="#3greyscale" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3greyscale-2">灰度采样</a>来指定：图像中其<a href="#3greyscale" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3greyscale-3">灰度采样</a>与 alpha 通道的<a href="#3greyscale"
                        class="internalDFN" data-link-type="dfn" id="ref-for-3greyscale-4">灰度采样</a>完全相同的<a
                        href="#3pixel" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3pixel-8">像素</a>为完全透明；其他像素为完全不透明。若不存在 alpha 通道，所有<a href="#3pixel"
                        class="internalDFN" data-link-type="dfn" id="ref-for-3pixel-9">像素</a>完全不透明。
                </dd>

                <dt><a href="#3indexedColour" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3indexedColour-6">索引色</a></dt>
                <dd>每个像素由调色板索引组成（若存在，还包括关联的 alpha 值表中的索引）。</dd>
            </dl>

            <p>每个像素的格式取决于 PNG 图像类型和位深。对于索引色之外的 PNG 图像类型，位深指定的是每个采样所占的位数，而不是每个像素的总位数。对于<a href="#3indexedColour"
                    class="internalDFN" data-link-type="dfn"
                    id="ref-for-3indexedColour-7">索引色</a>图像，位深指定的是每个调色板索引的位数，而不是调色板或 alpha 表中颜色的采样深度。像素内采样的出现顺序取决于 PNG
                图像类型，如下所示。</p>


            <ol>
                <li><a href="#dfn-truecolor-with-alpha" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-truecolor-with-alpha-1">真彩色（含 alpha）</a>：红、绿、蓝、alpha。</li>

                <li><a href="#dfn-greyscale-with-alpha" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-greyscale-with-alpha-1">灰度（含 alpha）</a>：灰度、alpha。</li>

                <li><a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3truecolour-3">真彩色</a>：红、绿、蓝。</li>

                <li><a href="#dfn-greyscale" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-greyscale-3">灰度</a>：灰度。</li>

                <li><a href="#3indexedColour" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3indexedColour-8">索引色</a>：调色板索引。</li>
            </ol>
        </section>


        <section id="4Concepts.Encoding">
            <div class="header-wrapper">
                <h3 id="x4-6-encoding-the-png-image"><bdi class="secno">4.6 </bdi>PNG 图像编码</h3><a class="self-link"
                    href="#4Concepts.Encoding" aria-label="Permalink for Section 4.6"></a>
            </div>



            <section class="introductory" id="4Concepts.EncodingIntro">
                <div class="header-wrapper">
                    <h3 id="introduction-2">简介</h3><a class="self-link" href="#4Concepts.EncodingIntro"
                        aria-label="Permalink for this Section"></a>
                </div>


                <p>PNG 图像编码过程的概念模型见<a href="#encoding-png-image" class="fig-ref" title="Encoding the PNG image">图 <bdi
                            class="">7</bdi></a>。这些步骤指的是对 PNG 图像中像素或索引数组的操作。<a href="#3palette" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3palette-1">调色板</a>与<a href="#3alphaTable" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3alphaTable-1">alpha 表</a>不以这种方式编码。</p>


                <ol>
                    <li>通道提取：为支持渐进显示，可将 PNG 图像像素重排为多个较小图像，称为缩减图像或轮次（pass）。</li>

                    <li>扫描线序列化：按扫描线对图像进行序列化。像素在扫描线中从左到右排序，扫描线从上到下排序。</li>

                    <li>滤波：将每条扫描线使用定义的某种滤波类型转换为滤波后的扫描线，以为图像压缩做准备。</li>

                    <li>压缩：对图像中的所有滤波后的扫描线进行压缩。</li>

                    <li>分块：将压缩后的图像划分为易于处理的块。每个块都添加错误检测码。</li>

                    <li>数据流构建：将这些块插入数据流。</li>
                </ol>
            </section>


            <section id="4Concepts.EncodingPassAbs">
                <div class="header-wrapper">
                    <h4 id="x4-6-1-pass-extraction"><bdi class="secno">4.6.1 </bdi>通道提取</h4><a class="self-link"
                        href="#4Concepts.EncodingPassAbs" aria-label="Permalink for Section 4.6.1"></a>
                </div>



                <p><dfn id="3passExtraction" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">通道提取</dfn>（见<a
                        href="#encoding-png-image" class="fig-ref" title="Encoding the PNG image">图 <bdi
                            class="">7</bdi></a>）将一幅 PNG 图像拆分为一系列<dfn id="3reducedImage" tabindex="0"
                        aria-haspopup="dialog" data-dfn-type="dfn">缩减图像</dfn>，第一幅提供粗略视图，随后的图像逐步增强该视图，直至最后一幅完成 PNG
                    图像。缩减图像集合也称为隔行 PNG
                    图像。本规范定义了两种隔行方法。第一种为空方法；像素按从左到右、扫描线按从上到下顺序存储。第二种通过对图像进行多次扫描，生成包含七幅缩减图像的序列。样例图像的七个轮次见<a
                        href="#encoding-png-image" class="fig-ref" title="Encoding the PNG image">图 <bdi
                            class="">7</bdi></a>。参见<a href="#8Interlace" class="sec-ref"><bdi class="secno">8.
                        </bdi>隔行与通道提取</a>。</p>



                <figure id="encoding-png-image">

                    <img id="figure47" src="https://www.w3.org/TR/png-3/figures/encoding-png-image.svg">

                    <figcaption><a class="self-link" href="#encoding-png-image">图 <bdi class="figno">7</bdi></a>
                        <span class="fig-title">
                            PNG 图像编码
                        </span>
                    </figcaption>
                </figure>

                <figure id="pass-extraction">

                    <img id="figure48" src="https://www.w3.org/TR/png-3/figures/pass-extraction.svg">

                    <figcaption><a class="self-link" href="#pass-extraction">图 <bdi class="figno">8</bdi></a> <span
                            class="fig-title">
                            通道提取
                        </span></figcaption>
                </figure>
            </section>




            <section id="4Concepts.EncodingScanlineAbs">
                <div class="header-wrapper">
                    <h4 id="x4-6-2-scanline-serialization"><bdi class="secno">4.6.2 </bdi>扫描线序列化</h4><a
                        class="self-link" href="#4Concepts.EncodingScanlineAbs"
                        aria-label="Permalink for Section 4.6.2"></a>
                </div>


                <p>每一行像素（称为扫描线）以字节序列的形式表示。</p>
            </section>


            <section id="4Concepts.EncodingFiltering">
                <div class="header-wrapper">
                    <h4 id="x4-6-3-filtering"><bdi class="secno">4.6.3 </bdi>滤波</h4><a class="self-link"
                        href="#4Concepts.EncodingFiltering" aria-label="Permalink for Section 4.6.3"></a>
                </div>


                <p>PNG 允许在压缩前对<a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-image-data-1">图像数据</a>进行滤波。滤波可改善数据的可压缩性。滤波操作是确定性的、可逆的、无损的。这允许在解压缩后进行反向滤波以获得原始数据。参见<a
                        href="#7Filtering" class="sec-ref"><bdi class="secno">7.3 </bdi>滤波</a>。</p>
            </section>


            <section id="4Concepts.EncodingCompression">
                <div class="header-wrapper">
                    <h4 id="x4-6-4-compression"><bdi class="secno">4.6.4 </bdi>压缩</h4><a class="self-link"
                        href="#4Concepts.EncodingCompression" aria-label="Permalink for Section 4.6.4"></a>
                </div>


                <p>PNG 图像一个或多个轮次中的滤波扫描线序列，会通过定义的压缩方法之一进行压缩（见<a href="#compression" class="fig-ref"
                        title="Compression and chunking">图 <bdi
                            class="">9</bdi></a>）。连接起来的滤波扫描线形成压缩阶段的输入。压缩阶段的输出是单个压缩数据流。参见<a href="#10Compression"
                        class="sec-ref"><bdi class="secno">10. </bdi>压缩</a>。</p>
            </section>


            <section id="4Concepts.EncodingChunking">
                <div class="header-wrapper">
                    <h4 id="x4-6-5-chunking"><bdi class="secno">4.6.5 </bdi>分块</h4><a class="self-link"
                        href="#4Concepts.EncodingChunking" aria-label="Permalink for Section 4.6.5"></a>
                </div>


                <p>分块将压缩后的数据流便捷地拆分为可管理的块（见<a href="#compression" class="fig-ref" title="Compression and chunking">图 <bdi
                            class="">9</bdi></a>）。每个块都有其自身的冗余校验。参见<a href="#11Chunks" class="sec-ref"><bdi
                            class="secno">11. </bdi>块规范</a>。</p>



                <figure id="compression">

                    <img id="figure410" src="https://www.w3.org/TR/png-3/figures/compression.svg">

                    <figcaption><a class="self-link" href="#compression">图 <bdi class="figno">9</bdi></a> <span
                            class="fig-title">
                            压缩与分块
                        </span></figcaption>
                </figure>
            </section>
        </section>


        <section id="4Concepts.AncillInfo">
            <div class="header-wrapper">
                <h3 id="x4-7-additional-information"><bdi class="secno">4.7 </bdi>附加信息</h3><a class="self-link"
                    href="#4Concepts.AncillInfo" aria-label="Permalink for Section 4.7"></a>
            </div>


            <p>图像可以关联辅助信息。解码器可忽略全部或部分辅助信息。提供的辅助信息类型如<a href="#table41" class="table-ref"
                    title="Types of ancillary information">表 <bdi class="">2</bdi></a>所述。</p>


            <table id="table41" class="simple numbered">
                <caption><a class="self-link" href="#table41">表 <bdi class="tableno">2</bdi></a> <span
                        class="table-title">
                        辅助信息类型
                    </span></caption>

                <tbody>
                    <tr>
                        <th>信息类型</th>
                        <th>说明</th>
                    </tr>

                    <tr>
                        <td>动画信息</td>
                        <td>
                            动画图像，定义为由帧序列构成并带有关联的计时、位置与处理信息，若查看器具备能力则应显示。在其他情况（如打印机）下，将显示<a href="#dfn-static-image"
                                class="internalDFN" data-link-type="dfn" id="ref-for-dfn-static-image-5">静态图像</a>。
                        </td>
                    </tr>

                    <tr>
                        <td>背景色</td>
                        <td>当没有更合适的选项时，用于呈现图像的纯色背景。</td>
                    </tr>

                    <tr>
                        <td>编码无关代码点</td>
                        <td>
                            通过枚举诸如<a href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-transfer-function-7">传递函数</a>与三基色等元数据来标识色彩空间。

                            最初用于<a href="#dfn-sdr" class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-sdr-2">SDR</a>与<a href="#dfn-hdr" class="internalDFN"
                                data-link-type="dfn" id="ref-for-dfn-hdr-2">HDR</a>视频，也用于静态与动画图像。
                        </td>
                    </tr>

                    <tr>
                        <td>内容光等级信息</td>
                        <td>图像（或图像序列）中最亮像素的<a href="#dfn-luminance" class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-luminance-2">亮度</a>，以及序列中最亮帧的平均亮度水平。</td>
                    </tr>

                    <tr>
                        <td>EXIF 信息</td>
                        <td>可交换图像文件格式元数据，如快门速度、光圈与方向等。</td>
                    </tr>

                    <tr>
                        <td>伽玛与色度</td>
                        <td>
                            图像相对于期望输出强度的<a href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-gamma-value-2">伽玛值</a>，以及图像所用 RGB 值的<a href="#dfn-chromaticity"
                                class="internalDFN" data-link-type="dfn" id="ref-for-dfn-chromaticity-3">色度</a>特性。
                        </td>
                    </tr>

                    <tr>
                        <td>ICC 配置文件</td>
                        <td>描述图像中采样所遵循的色彩空间（以国际色彩联盟（ICC）配置文件的形式）。</td>
                    </tr>

                    <tr>
                        <td>图像直方图</td>
                        <td>估计图像对每个调色板项的使用频率。</td>
                    </tr>

                    <tr>
                        <td>母版显示色彩体积</td>
                        <td>描述用于制作内容的显示器的绝对三维色域体积，包括母版显示器可复现的最亮与最暗颜色。这有助于在显示设备上呈现图像。</td>
                    </tr>

                    <tr>
                        <td>物理像素尺寸</td>
                        <td>呈现 PNG 图像时使用的像素尺寸与纵横比。</td>
                    </tr>

                    <tr>
                        <td>有效位数</td>
                        <td>采样值中有效位的数量。</td>
                    </tr>

                    <tr>
                        <td>sRGB 色彩空间</td>
                        <td>一种渲染意图（由国际色彩联盟定义）以及图像采样符合该色彩空间的指示。</td>
                    </tr>

                    <tr>
                        <td>建议调色板</td>
                        <td>在显示设备无法显示图像完整色域时可使用的缩减调色板。</td>
                    </tr>

                    <tr>
                        <td>文本数据</td>
                        <td>与图像关联的文本信息（可被压缩）。</td>
                    </tr>

                    <tr>
                        <td>时间</td>
                        <td>PNG 图像上次修改的时间。</td>
                    </tr>

                    <tr>
                        <td>透明度</td>
                        <td>当 PNG 图像不保留 alpha 通道时，允许重建参考图像的 alpha 信息。</td>
                    </tr>
                </tbody>
            </table>
        </section>


        <section id="4Concepts.Format">
            <div class="header-wrapper">
                <h3 id="x4-8-png-datastream"><bdi class="secno">4.8 </bdi>PNG 数据流</h3><a class="self-link"
                    href="#4Concepts.Format" aria-label="Permalink for Section 4.8"></a>
            </div>



            <section id="4Concepts.FormatChunks">
                <div class="header-wrapper">
                    <h4 id="x4-8-1-chunks"><bdi class="secno">4.8.1 </bdi>块</h4><a class="self-link"
                        href="#4Concepts.FormatChunks" aria-label="Permalink for Section 4.8.1"></a>
                </div>


                <p>PNG 数据流由 PNG 签名（见<a href="#5PNG-file-signature" class="sec-ref"><bdi class="secno">5.2 </bdi>PNG
                        签名</a>）后接一串块（见<a href="#11Chunks" class="sec-ref"><bdi class="secno">11.
                        </bdi>块规范</a>）组成。每个块有其块类型以指明其功能。</p>
            </section>


            <section id="4Concepts.FormatTypes">
                <div class="header-wrapper">
                    <h4 id="x4-8-2-chunk-types"><bdi class="secno">4.8.2 </bdi>块类型</h4><a class="self-link"
                        href="#4Concepts.FormatTypes" aria-label="Permalink for Section 4.8.2"></a>
                </div>


                <p>块类型是四字节序列，选择时使其在 ISO 646.IRV:1991 [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso646"
                            title="Information technology — ISO 7-bit coded character set for information interchange">ISO646</a></cite>]
                    字符集下可对应为可读标签。前四种称为关键块，必须根据本规范的规定被理解并正确解释。这些是：</p>


                <ol>
                    <li>
                        <a class="chunk" href="#11IHDR">IHDR</a>：图像头，是 PNG 数据流中的第一个块。
                    </li>

                    <li>
                        <a class="chunk" href="#11PLTE">PLTE</a>：与索引 PNG 图像相关的调色板表。
                    </li>

                    <li>
                        <a class="chunk" href="#11IDAT">IDAT</a>：图像数据块。
                    </li>

                    <li>
                        <a class="chunk" href="#11IEND">IEND</a>：图像终结块，是 PNG 数据流中的最后一个块。
                    </li>
                </ol>


                <p>其余块类型称为<dfn class="lint-ignore" id="3ancillaryChunk" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">辅助块</dfn>类型，编码器可以生成，解码器可以解释。</p>


                <ol>
                    <li>透明度信息：<a class="chunk" href="#11tRNS">tRNS</a>（见<a href="#11transinfo" class="sec-ref"><bdi
                                class="secno">11.3.1 </bdi>透明信息</a>）。
                    </li>

                    <li>色彩空间信息：<a class="chunk" href="#11cHRM">cHRM</a>、<a class="chunk" href="#11gAMA">gAMA</a>、
                        <a class="chunk" href="#11iCCP">iCCP</a>、<a class="chunk" href="#11sBIT">sBIT</a>、<a
                            class="chunk" href="#11sRGB">sRGB</a>、<a class="chunk" href="#cICP-chunk">cICP</a>、<a
                            class="chunk" href="#mDCV-chunk">mDCV</a>（见
                        <a href="#11addnlcolinfo" class="sec-ref"><bdi class="secno">11.3.2 </bdi>色彩空间信息</a>）。
                    </li>

                    <li>文本信息：<a class="chunk" href="#11iTXt">iTXt</a>、<a class="chunk" href="#11tEXt">tEXt</a>、<a
                            class="chunk" href="#11zTXt">zTXt</a>（见<a href="#11textinfo" class="sec-ref"><bdi
                                class="secno">11.3.3 </bdi>文本信息</a>）。
                    </li>

                    <li>杂项信息：<a class="chunk" href="#11bKGD">bKGD</a>、<a class="chunk" href="#11hIST">hIST</a>、
                        <a class="chunk" href="#11pHYs">pHYs</a>、<a class="chunk" href="#11sPLT">sPLT</a>、<a
                            class="chunk" href="#eXIf">eXIf</a>（见<a href="#11addnlsiinfo" class="sec-ref"><bdi
                                class="secno">11.3.4 </bdi>杂项信息</a>）。
                    </li>

                    <li>时间信息：<a class="chunk" href="#11tIME">tIME</a>（见<a href="#11timestampinfo" class="sec-ref"><bdi
                                class="secno">11.3.5 </bdi>时间戳信息</a>）。
                    </li>

                    <li>动画信息：<a class="chunk" href="#acTL-chunk">acTL</a>、<a class="chunk" href="#fcTL-chunk">fcTL</a>、
                        <a class="chunk" href="#fdAT-chunk">fdAT</a>（见<a href="#animation-information"
                            class="sec-ref"><bdi class="secno">11.3.6 </bdi>动画信息</a>）。
                    </li>
                </ol>
            </section>
        </section>

        <section id="apng-frame-based-animation">
            <div class="header-wrapper">
                <h3 id="x4-9-apng-frame-based-animation"><bdi class="secno">4.9 </bdi><abbr
                        title="Animated PNG">APNG</abbr>：基于帧的动画</h3><a class="self-link"
                    href="#apng-frame-based-animation" aria-label="Permalink for Section 4.9"></a>
            </div>


            <section class="introductory" id="introduction-0">
                <div class="header-wrapper">
                    <h3 id="introduction-3">简介</h3><a class="self-link" href="#introduction-0"
                        aria-label="Permalink for this Section"></a>
                </div>


                <p>动画 PNG（<abbr title="Animated PNG">APNG</abbr>）在原始仅静态的 PNG 格式基础上扩展，增加了对基于<a href="#dfn-frame"
                        class="internalDFN" data-link-type="dfn" id="ref-for-dfn-frame-1">帧</a>的动画图像的支持。它旨在替代传统上使用 GIF
                    格式 [<cite><a class="bibref" data-link-type="biblio" href="#bib-gif"
                            title="Graphics Interchange Format">GIF</a></cite>] 的简单动画图像，同时增加对 24 位图像和 8 位透明度的支持，而 GIF
                    不具备这些。</p>

                <p><abbr title="Animated PNG">APNG</abbr>与早期版本的 PNG 向后兼容；非动画的 PNG 解码器将忽略与<abbr
                        title="Animated PNG">APNG</abbr>相关的辅助块，并显示<a href="#dfn-static-image" class="internalDFN"
                        data-link-type="dfn" id="ref-for-dfn-static-image-6">静态图像</a>。
                </p>
            </section>

            <section id="structure">
                <div class="header-wrapper">
                    <h4 id="x4-9-1-structure"><bdi class="secno">4.9.1 </bdi>结构</h4><a class="self-link"
                        href="#structure" aria-label="Permalink for Section 4.9.1"></a>
                </div>


                <p><abbr title="Animated PNG">APNG</abbr>流是按照先前 PNG 规范版本定义的普通 PNG 流，并增加了三个描述动画并提供额外帧数据的块类型。</p>

                <p>要被识别为<abbr title="Animated PNG">APNG</abbr>，流中必须在任一<a class="chunk" href="#11IDAT">IDAT</a>块之前出现一个<a
                        class="chunk" href="#acTL-chunk">acTL</a>块。<a class="chunk" href="#acTL-chunk">acTL</a>结构<a
                        href="#animation-information">如下所述</a>。
                </p>

                <p>从概念上讲，每次播放开始时，<a href="#dfn-output-buffer" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-output-buffer-1">输出缓冲区</a>应完全初始化为一个<a href="#dfn-fully-transparent-black"
                        class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-fully-transparent-black-1">全透明黑</a>矩形，其宽、高来自<a class="chunk"
                        href="#11IHDR">IHDR</a>块。</p>

                <p>若在<a class="chunk" href="#11IDAT">IDAT</a>之前存在单个<a class="chunk"
                        href="#fcTL-chunk">fcTL</a>块，则可将静态图像作为动画的第一帧包含在内。否则，静态图像不属于动画的一部分。</p>

                <p>后续帧编码在<a class="chunk" href="#fdAT-chunk">fdAT</a>块中，其结构与<a class="chunk"
                        href="#11IDAT">IDAT</a>块相同，但在前面增加了一个<a href="#4Concepts.APNGSequence">序列号</a>。每个帧的放置与渲染信息存储在<a
                        class="chunk" href="#fcTL-chunk">fcTL</a>块中。<a class="chunk" href="#fdAT-chunk">fdAT</a>与<a
                        class="chunk" href="#fcTL-chunk">fcTL</a>块的完整布局<a href="#animation-information">如下所述</a>。
                </p>

                <p>整个动画的边界由<a class="chunk" href="#11IHDR">IHDR</a>块的宽与高参数指定，无论默认图像是否属于动画。若后续帧需要额外空间，默认图像应使用<a
                        href="#dfn-fully-transparent-black" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-fully-transparent-black-2">全透明黑</a>像素进行适当填充。</p>

                <p>每一帧在每次播放时都是相同的，因此应用缓存这些帧是安全的。</p>
            </section>

            <section id="4Concepts.APNGSequence">
                <div class="header-wrapper">
                    <h4 id="x4-9-2-sequence-numbers"><bdi class="secno">4.9.2 </bdi>序列号</h4><a class="self-link"
                        href="#4Concepts.APNGSequence" aria-label="Permalink for Section 4.9.2"></a>
                </div>


                <p><a class="chunk" href="#fcTL-chunk">fcTL</a>与<a class="chunk" href="#fdAT-chunk">fdAT</a>块具有从零开始的 4
                    字节序列号。两种块类型共享该序列号。该编号用于在动画 PNG 中检测（并可选地纠正）序列错误，因为本规范未对辅助块施加排序约束。</p>

                <p>第一个<a class="chunk" href="#fcTL-chunk">fcTL</a>块应包含序列号 0，剩余<a class="chunk"
                        href="#fcTL-chunk">fcTL</a>与<a class="chunk" href="#fdAT-chunk">fdAT</a>块的序列号应按升序排列，不得有缺失或重复。
                </p>

                <p>下表展示了对于多帧图像以及第二帧包含多个<a class="chunk" href="#fdAT-chunk">fdAT</a>块时序列号的使用。（为清晰起见，表中省略了<a class="chunk"
                        href="#11IHDR">IHDR</a>与<a class="chunk" href="#11IEND">IEND</a>块）。</p>

                <table class="numbered simple" id="table-if-the-static-image-is-also-the-first-frame">
                    <caption><a class="self-link" href="#table-if-the-static-image-is-also-the-first-frame">表 <bdi
                                class="tableno">3</bdi></a> <span class="table-title">
                            当静态图像同时为第一帧时
                        </span></caption>

                    <tbody>
                        <tr>
                            <th>序列号</th>
                            <th>块</th>
                        </tr>

                        <tr>
                            <td>（无）</td>
                            <td>
                                <a class="chunk" href="#acTL-chunk">acTL</a>
                            </td>
                        </tr>

                        <tr>
                            <td>0</td>
                            <td>
                                <a class="chunk" href="#fcTL-chunk">fcTL</a> 第一帧
                            </td>
                        </tr>

                        <tr>
                            <td>（无）</td>
                            <td>
                                <a class="chunk" href="#11IDAT">IDAT</a> 第一帧 / 静态图像
                            </td>
                        </tr>

                        <tr>
                            <td>1</td>
                            <td>
                                <a class="chunk" href="#fcTL-chunk">fcTL</a> 第二帧
                            </td>
                        </tr>

                        <tr>
                            <td>2</td>
                            <td>
                                第二帧的第一个 <a class="chunk" href="#fdAT-chunk">fdAT</a>
                            </td>
                        </tr>

                        <tr>
                            <td>3</td>
                            <td>
                                第二帧的第二个 <a class="chunk" href="#fdAT-chunk">fdAT</a>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <table class="numbered simple" id="table-if-the-static-image-is-not-part-of-the-animation">
                    <caption><a class="self-link" href="#table-if-the-static-image-is-not-part-of-the-animation">表
                            <bdi class="tableno">4</bdi></a> <span class="table-title">
                            当静态图像不是动画的一部分时
                        </span></caption>

                    <tbody>
                        <tr>
                            <th>序列号</th>
                            <th>块</th>
                        </tr>

                        <tr>
                            <td>（无）</td>
                            <td>
                                <a class="chunk" href="#acTL-chunk">acTL</a>
                            </td>
                        </tr>

                        <tr>
                            <td>（无）</td>
                            <td>
                                <a class="chunk" href="#11IDAT">IDAT</a> 静态图像
                            </td>
                        </tr>

                        <tr>
                            <td>0</td>
                            <td>
                                <a class="chunk" href="#fcTL-chunk">fcTL</a> 第一帧
                            </td>
                        </tr>

                        <tr>
                            <td>1</td>
                            <td>
                                第一帧的第一个 <a class="chunk" href="#fdAT-chunk">fdAT</a>
                            </td>
                        </tr>

                        <tr>
                            <td>2</td>
                            <td>
                                第一帧的第二个 <a class="chunk" href="#fdAT-chunk">fdAT</a>
                            </td>
                        </tr>

                        <tr>
                            <td>3</td>
                            <td>
                                <a class="chunk" href="#fcTL-chunk">fcTL</a> 第二帧
                            </td>
                        </tr>

                        <tr>
                            <td>4</td>
                            <td>
                                第二帧的第一个 <a class="chunk" href="#fdAT-chunk">fdAT</a>
                            </td>
                        </tr>

                        <tr>
                            <td>5</td>
                            <td>
                                第二帧的第二个 <a class="chunk" href="#fdAT-chunk">fdAT</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section id="apng-output-buffer">
                <div class="header-wrapper">
                    <h4 id="x4-9-3-output-buffer"><bdi class="secno">4.9.3 </bdi>输出缓冲区</h4><a class="self-link"
                        href="#apng-output-buffer" aria-label="Permalink for Section 4.9.3"></a>
                </div>


                <p><dfn id="dfn-output-buffer" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">输出缓冲区</dfn>是一个像素数组，其尺寸由 PNG <a class="chunk"
                        href="#11IHDR">IHDR</a>块的宽与高参数指定。从概念上讲，每一帧都会先在输出缓冲区中构建，然后再<a href="#dfn-composited"
                        class="internalDFN" data-link-type="dfn" id="ref-for-dfn-composited-2">合成</a>到<a
                        href="#dfn-canvas" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-canvas-1">画布</a>上。输出缓冲区的内容对解码器可用。输出缓冲区的四个角映射到<a href="#dfn-canvas"
                        class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canvas-2">画布</a>的四个角。
                </p>
            </section>

            <section id="apng-canvas">
                <div class="header-wrapper">
                    <h4 id="x4-9-4-canvas"><bdi class="secno">4.9.4 </bdi>画布</h4><a class="self-link"
                        href="#apng-canvas" aria-label="Permalink for Section 4.9.4"></a>
                </div>


                <p><dfn id="dfn-canvas" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">画布</dfn>是输出设备上用于显示帧的区域。画布的内容不一定对解码器可用。若存在<a class="chunk"
                        href="#11bKGD">bKGD</a>块，且没有更合适的背景，可用其填充画布。</p>
            </section>

        </section>


        <section id="4Concepts.Errors">
            <div class="header-wrapper">
                <h3 id="x4-10-error-handling"><bdi class="secno">4.10 </bdi>错误处理</h3><a class="self-link"
                    href="#4Concepts.Errors" aria-label="Permalink for Section 4.10"></a>
            </div>


            <p>PNG 数据流中的错误大致分为两类：</p>


            <ol>
                <li>传输错误或计算机文件系统损坏，往往会破坏数据流的大部分或全部内容；</li>

                <li>语法错误，表现为块中的无效值，或缺失、放错位置的块。语法错误不仅可能由编码错误引起，也可能由使用注册或私有值而解码器不识别这些值所致。</li>
            </ol>

            <p>PNG 解码器应尽早检测错误，尽可能从错误中恢复，否则应优雅失败。错误处理理念详见<a href="#13Decoders.Errors" class="sec-ref"><bdi
                        class="secno">13.1 </bdi>错误处理</a>。</p>
        </section>


        <section class="informative" id="4Concepts.Registration">
            <div class="header-wrapper">
                <h3 id="x4-11-extensions"><bdi class="secno">4.11 </bdi>扩展</h3><a class="self-link"
                    href="#4Concepts.Registration" aria-label="Permalink for Section 4.11"></a>
            </div>
            <p><em>本节为非规范性内容。</em></p>


            <p>PNG 格式提供了多个扩展点：</p>

            <ul>
                <li>
                    <a href="#sec-defining-new-chunks">块类型</a>；
                </li>

                <li>
                    <a href="#11tEXt">文本关键字</a>；以及
                </li>

                <li>
                    <a href="#dfn-private-field-values" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-private-field-values-1">私有字段值</a>。
                </li>
            </ul>

            <p>其中一些扩展点由<abbr title="World Wide Web Consortium">W3C</abbr>保留，其他则可供私有使用。</p>
        </section>
    </section>


    <section id="5DataRep">
        <div class="header-wrapper">
            <h2 id="x5-datastream-structure"><bdi class="secno">5. </bdi>数据流结构</h2><a class="self-link" href="#5DataRep"
                aria-label="Permalink for Section 5."></a>
        </div>



        <section id="5Introduction">
            <div class="header-wrapper">
                <h3 id="x5-1-png-datastream"><bdi class="secno">5.1 </bdi>PNG 数据流</h3><a class="self-link"
                    href="#5Introduction" aria-label="Permalink for Section 5.1"></a>
            </div>



            <p><dfn id="3PNGdatastream" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">PNG 数据流</dfn>
                由一个 PNG 签名后接一系列块组成。它是对<a href="#3PNGimage" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3PNGimage-2">PNG 图像</a>编码的结果。</p>

            <div class="note" role="note" id="issue-container-generatedID-8">
                <div role="heading" class="note-title marker" id="h-note-8" aria-level="4"><span>注</span></div>
                <p class="">
                    使用“数据流（datastream）”这一术语而非“文件（file）”，是为了描述可能只是文件一部分的字节序列。该术语也用来强调这些字节序列可能是“即时”生成与消费的，完全不会以存储文件的形式出现。
                </p>
            </div>
        </section>


        <section id="5PNG-file-signature">
            <div class="header-wrapper">
                <h3 id="3PNGsignature"><bdi class="secno">5.2 </bdi>PNG 签名</h3><a class="self-link"
                    href="#3PNGsignature" aria-label="Permalink for Section 5.2"></a>
            </div>



            <p>PNG 数据流的前 8 个字节始终包含以下十六进制值：</p>

            <pre aria-busy="false"><code class="hljs">
89 50 4E 47 0D 0A 1A 0A</code></pre>
            <p>该签名表明数据流的其余部分包含一个单一的 PNG 图像，由一系列块组成，以<a class="chunk" href="#11IHDR">IHDR</a>块开始，以<a class="chunk"
                    href="#11IEND">IEND</a>块结束。</p>

            <p>该签名可将 PNG 数据流与其他类型的<a href="#dfn-datastream" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-datastream-1">数据流</a>区分开来，并允许及早检测某些传输错误。</p>
        </section>


        <section id="5Chunk-layout">
            <div class="header-wrapper">
                <h3 id="x5-3-chunk-layout"><bdi class="secno">5.3 </bdi>块布局</h3><a class="self-link"
                    href="#5Chunk-layout" aria-label="Permalink for Section 5.3"></a>
            </div>



            <p>每个<dfn id="3chunk" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">块（chunk）</dfn>由三个或四个字段组成（见<a
                    href="#figure411" class="fig-ref" title="Chunk parts">图 <bdi class="">10</bdi></a>）。各字段含义见
                <a href="#table51" class="table-ref" title="Chunk fields">表 <bdi class="">5</bdi></a>。块数据字段可以为空。
            </p>

            <figure id="figure411">

                <img style="width: 70vw" src="https://www.w3.org/TR/png-3/figures/chunk-parts.svg">

                <figcaption><a class="self-link" href="#figure411">图 <bdi class="figno">10</bdi></a> <span
                        class="fig-title">
                        块组成部分
                    </span></figcaption>
            </figure>


            <table id="table51" class="numbered simple">
                <caption><a class="self-link" href="#table51">表 <bdi class="tableno">5</bdi></a> <span
                        class="table-title">
                        块字段
                    </span></caption>

                <tbody>
                    <tr>
                        <th>名称</th>
                        <th>说明</th>
                    </tr>

                    <tr>
                        <td>Length（长度）</td>
                        <td>
                            一个<a href="#dfn-png-four-byte-unsigned-integer" class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-png-four-byte-unsigned-integer-1">PNG
                                四字节无符号整数</a>，给出块数据字段中的字节数。长度<strong>只</strong>计算数据字段，<strong>不</strong>包括自身、块类型或
                            <abbr title="Cyclic Redundancy Code">CRC</abbr>。长度为零也是有效的。尽管编码器和解码器应将长度视为无符号整数，其值不得超过
                            2<sup>31</sup>-1
                            字节。
                        </td>
                    </tr>

                    <tr>
                        <td>Chunk Type（块类型）</td>
                        <td>
                            用四个字节表示的块类型。块类型的每个字节仅限于十六进制值 41 到 5A 和 61 到 7A。这些分别对应 ISO 646 [<cite><a class="bibref"
                                    data-link-type="biblio" href="#bib-iso646"
                                    title="Information technology — ISO 7-bit coded character set for information interchange">ISO646</a></cite>]
                            的大写和小写字母
                            （<code>A</code>-<code>Z</code> 与 <code>a</code>-<code>z</code>），以便于描述和检查 PNG
                            数据流。编码器与解码器应将块类型视为固定的二进制值，而不是字符字符串。例如，用 UCS 2 字符集中的这些字母的等价物来表示块类型<a class="chunk"
                                href="#11IDAT">IDAT</a>是不正确的。关于块类型的更多命名约定见<a href="#5Chunk-naming-conventions"
                                class="sec-ref"><bdi class="secno">5.4
                                </bdi>块命名约定</a>。
                        </td>
                    </tr>

                    <tr>
                        <td>Chunk Data（块数据）</td>
                        <td>与块类型相对应的数据字节（如果有）。
                            <span id="zero-length-data">该字段可以为零长度。</span>
                        </td>
                    </tr>

                    <tr>
                        <td><abbr title="Cyclic Redundancy Code">CRC</abbr></td>
                        <td>
                            一个四字节的<abbr
                                title="Cyclic Redundancy Code">CRC</abbr>，在块中先前的字节上计算，包括块类型字段和块数据字段，但<strong>不</strong>包括长度字段。<abbr
                                title="Cyclic Redundancy Code">CRC</abbr>可用于检查数据是否损坏。即使块不包含数据，<abbr
                                title="Cyclic Redundancy Code">CRC</abbr>也始终存在。参见<a href="#5CRC-algorithm"
                                class="sec-ref"><bdi class="secno">5.5
                                </bdi><abbr title="Cyclic Redundancy Code">CRC</abbr> 算法</a>。
                        </td>
                    </tr>
                </tbody>
            </table>

            <p>块数据长度可以是任意不超过最大值的字节数；因此，实现者不能假定块在大于字节的任何边界上对齐。</p>
        </section>




        <section id="5Chunk-naming-conventions">
            <div class="header-wrapper">
                <h3 id="x5-4-chunk-naming-conventions"><bdi class="secno">5.4 </bdi>块命名约定</h3><a class="self-link"
                    href="#5Chunk-naming-conventions" aria-label="Permalink for Section 5.4"></a>
            </div>


            <p>当按 ISO 646 字母 [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso646"
                        title="Information technology — ISO 7-bit coded character set for information interchange">ISO646</a></cite>]
                解释块类型的字节时，块类型应是有意义的名称。块类型的分配使得解码器即使在不识别该类型时也能判断出块的一些属性。这些规则允许对 PNG 格式进行安全、灵活的扩展，因为它允许 PNG
                解码器在遇到未知块时决定如何处理。</p>

            <p>当解码器不识别块类型时（见
                <a href="#13Decoders" class="sec-ref"><bdi class="secno">13. </bdi>PNG 解码器与查看器</a>），命名规则通常才会引起兴趣。
            </p>

            <p>块类型的四个位——属性位，即每个字节的第 5 位（值 32）——用于传达块属性。这一选择意味着人们可以根据块类型每个字节对应的字母是大写（第 5 位为 0）还是小写（第 5 位为 1）来读取已分配的属性。
            </p>

            <p>属性位是块类型的内在组成部分，因此对于任何块类型都是固定的。因此，
                <span class="chunk">CHNK</span> 与 <span class="chunk">cHNk</span> 将是无关的块类型，而不是同一块具有不同属性。
            </p>

            <p>属性位的语义见<a href="#table52" class="table-ref" title="Semantics of property bits">表 <bdi
                        class="">6</bdi></a>。</p>


            <table id="table52" class="numbered simple">
                <caption><a class="self-link" href="#table52">表 <bdi class="tableno">6</bdi></a> <span
                        class="table-title">
                        属性位的语义
                    </span></caption>

                <tbody>
                    <tr>
                        <th>名称与位置</th>
                        <th>定义</th>
                        <th>说明</th>
                    </tr>

                    <tr>
                        <td>辅助位：第一个字节</td>
                        <td>0（大写）= 关键（critical），<br>
                            1（小写）= 辅助（ancillary）。</td>
                        <td>
                            关键块对于成功显示数据流内容是必要的，例如图像头块（<a class="chunk"
                                href="#11IHDR">IHDR</a>）。解码器在尝试提取图像时，如遇到未知块类型且其辅助位为 0，应向用户指示图像包含其无法安全解释的信息。<br>
                            辅助块并非为了有意义地显示数据流内容而严格必需，例如时间块（<a class="chunk" href="#11tIME">tIME</a>）。解码器在遇到未知块类型且其辅助位为 1
                            时，可以安全地忽略该块并继续显示图像。
                        </td>
                    </tr>

                    <tr>
                        <td>私有位：第二个字节</td>
                        <td>0（大写）= 公有（public），<br>
                            1（小写）= 私有（private）。</td>
                        <td>
                            公有块保留由<abbr title="World Wide Web Consortium">W3C</abbr>定义。私有块的定义见<a
                                href="#12Use-of-private-chunks" class="sec-ref"><bdi class="secno">12.10.1
                                </bdi>私有块的使用</a>。私有块名称的第二个字母为小写，而公有块名称的第二个字母为大写。
                        </td>
                    </tr>

                    <tr>
                        <td>保留位：第三个字节</td>
                        <td>在本版本 PNG 中为 0（大写）。<br>
                            如果保留位为 1，则数据流不符合本版本 PNG。</td>
                        <td>块名第三个字母大小写的意义被保留以便未来扩展。在本国际标准中，所有块名的第三个字母均应为大写。</td>
                    </tr>

                    <tr>
                        <td>可安全复制位：第四个字节</td>
                        <td>0（大写）= 不可安全复制，<br>
                            1（小写）= 可安全复制。</td>
                        <td>
                            该属性位对纯解码器而言并不重要，但对<a href="#dfn-png-editor" class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-png-editor-2">PNG 编辑器</a>是必需的。该位定义了在修改中的数据流内未识别块的正确处理方式。关于<a
                                href="#dfn-png-editor" class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-png-editor-3">PNG 编辑器</a>的规则详见<a href="#14Ordering" class="sec-ref"><bdi
                                    class="secno">14.2
                                </bdi>PNG 编辑器的行为</a>。
                        </td>
                    </tr>
                </tbody>
            </table>

            <p class="example">假设的块类型“<span class="chunk">cHNk</span>”具有如下属性位：</p>

            <pre
                aria-busy="false"><code class="hljs javascript">cHNk  &lt;-- 以文本形式表示的 <span class="hljs-number">32</span> 位块类型
||||
|||+- 可安全复制位为 <span class="hljs-number">1</span>（小写字母；位 <span class="hljs-number">5</span> 为 <span class="hljs-number">1</span>）
||+-- 保留位为 <span class="hljs-number">0</span>     （大写字母；位 <span class="hljs-number">5</span> 为 <span class="hljs-number">0</span>）
|+--- 私有位为 <span class="hljs-number">0</span>      （大写字母；位 <span class="hljs-number">5</span> 为 <span class="hljs-number">0</span>）
+---- 辅助位为 <span class="hljs-number">1</span>    （小写字母；位 <span class="hljs-number">5</span> 为 <span class="hljs-number">1</span>）</code></pre>
            <p>因此，该名称表示一个辅助、公有、可安全复制的块。</p>
        </section>


        <section id="5CRC-algorithm">
            <div class="header-wrapper">
                <h3 id="x5-5-crc-algorithm"><bdi class="secno">5.5 </bdi><abbr title="Cyclic Redundancy Code">CRC</abbr>
                    算法</h3><a class="self-link" href="#5CRC-algorithm" aria-label="Permalink for Section 5.5"></a>
            </div>


            <p><abbr title="Cyclic Redundancy Code">CRC</abbr> 字段使用标准化的、带有预处理与后处理的 <abbr
                    title="Cyclic Redundancy Code">CRC</abbr> 方法计算，如 [<cite><a class="bibref" data-link-type="biblio"
                        href="#bib-iso-3309"
                        title="ISO/IEC 3309:1993, Information Technology — Telecommunications and information exchange between systems — High-level data link control (HDLC) procedures — Frame structure.">ISO-3309</a></cite>]
                与 [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-t-v.42"
                        title="ITU-T V.42, SERIES V: DATA COMMUNICATION OVER THE TELEPHONE NETWORK. Error-correcting procedures for DCEs using asynchronous-to-synchronous conversion">ITU-T-V.42</a></cite>]
                所定义。所采用的 <abbr title="Cyclic Redundancy Code">CRC</abbr> 多项式——与 GZIP 文件格式规范 [<cite><a class="bibref"
                        data-link-type="biblio" href="#bib-rfc1952"
                        title="GZIP file format specification version 4.3">RFC1952</a></cite>] 中使用的相同——为</p>

            <p>x<sup>32</sup> + x<sup>26</sup> + x<sup>23</sup> + x<sup>22</sup> + x<sup>16</sup> + x<sup>12</sup> +
                x<sup>11</sup> +
                x<sup>10</sup> + x<sup>8</sup> + x<sup>7</sup> + x<sup>5</sup> + x<sup>4</sup> + x<sup>2</sup> + x + 1
            </p>

            <p>在 PNG 中，32 位 <abbr title="Cyclic Redundancy Code">CRC</abbr> 以全 1
                初始化，然后按从最低有效位（1）到最高有效位（128）的顺序处理每个字节中的数据。在处理完所有数据字节后，<abbr title="Cyclic Redundancy Code">CRC</abbr>
                取反（取其反码）。该值以<abbr title="Most Significant Byte">MSB</abbr>（最高有效字节）优先的顺序传输（存储在数据流中）。为便于分解为字节与排序，32 位
                <abbr title="Cyclic Redundancy Code">CRC</abbr> 的最低有效位被定义为
                <code>x<sup>31</sup></code> 项的系数。
            </p>

            <p>实际计算 <abbr title="Cyclic Redundancy Code">CRC</abbr> 时常使用预计算表来加速计算。参见<a href="#D-CRCAppendix"
                    class="sec-ref"><bdi class="secno">D. </bdi><abbr title="Cyclic Redundancy Code">CRC</abbr>
                    示例实现</a>。</p>
        </section>


        <section id="5ChunkOrdering">
            <div class="header-wrapper">
                <h3 id="x5-6-chunk-ordering"><bdi class="secno">5.6 </bdi>块排序</h3><a class="self-link"
                    href="#5ChunkOrdering" aria-label="Permalink for Section 5.6"></a>
            </div>


            <p>各个块的位置约束列于<a href="#table53" class="table-ref" title="Chunk ordering rules">表 <bdi
                        class="">7</bdi></a>，并通过图示展示：静态图像见<a href="#lattice-diagram-with-plte" class="fig-ref"
                    title="Lattice diagram: Static PNG images with PLTE">图 <bdi class="">11</bdi></a>与<a
                    href="#lattice-diagram-without-plte" class="fig-ref"
                    title="Lattice diagram: Static PNG images without PLTE">图 <bdi
                        class="">12</bdi></a>；静态图像作为第一帧的动画图像见<a href="#lattice-apng-static-with-plte" class="fig-ref"
                    title="Lattice diagram: Animated PNG images with PLTE, static image forms the first frame">图
                    <bdi class="">13</bdi></a>与<a href="#lattice-apng-static-without-plte" class="fig-ref"
                    title="Lattice diagram: Animated PNG images without PLTE, static image forms the first frame">图
                    <bdi class="">14</bdi></a>；静态图像不属于动画的动画图像见<a href="#lattice-apng-nostatic-with-plte" class="fig-ref"
                    title="Lattice diagram: Animated PNG images with PLTE, static image not part of animation">图
                    <bdi class="">15</bdi></a>与<a href="#lattice-apng-nostatic-without-plte" class="fig-ref"
                    title="Lattice diagram: Animated PNG images without PLTE, static image not part of animation">图
                    <bdi
                        class="">16</bdi></a>。这些格状图表示本规范对位置施加的约束。图中的线定义了偏序关系。更上方的块必须出现在更下方的块之前。水平方向对齐且位于两个其他块类型（高于与低于这组水平对齐块）之间的块，可以以任意顺序出现在这两类更高与更低的块类型之间。与块类型相关联的上标在<a
                    href="#table54" class="table-ref" title="Meaning of symbols used in lattice diagrams">表 <bdi
                        class="">8</bdi></a>中定义，表示该块是必选、可选或可出现多次。两种块类型之间的竖线表示二者为可选关系（择一）。</p>




            <table id="table53" class="numbered simple">
                <caption><a class="self-link" href="#table53">表 <bdi class="tableno">7</bdi></a> <span
                        class="table-title">
                        块排序规则
                    </span></caption>

                <tbody>
                    <tr>
                        <th colspan="3">关键块<br>
                            （必须按此顺序出现，PLTE 为可选）</th>
                    </tr>

                    <tr>
                        <th>块名</th>
                        <th>可多次出现</th>
                        <th>排序约束</th>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11IHDR">IHDR</a>
                        </td>
                        <td>否</td>
                        <td>必须为首个</td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11PLTE">PLTE</a>
                        </td>
                        <td>否</td>
                        <td>
                            在第一个 <a class="chunk" href="#11IDAT">IDAT</a> 之前
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11IDAT">IDAT</a>
                        </td>
                        <td>是</td>
                        <td>
                            多个 <a class="chunk" href="#11IDAT">IDAT</a> 块必须连续
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11IEND">IEND</a>
                        </td>
                        <td>否</td>
                        <td>必须为最后一个</td>
                    </tr>

                    <tr>
                        <th colspan="3">辅助块<br>
                            （不必按此顺序出现）</th>
                    </tr>

                    <tr>
                        <th>块名</th>
                        <th>可多次出现</th>
                        <th>排序约束</th>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#acTL-chunk">acTL</a>
                        </td>
                        <td>否</td>
                        <td>
                            在 <a class="chunk" href="#11IDAT">IDAT</a> 之前
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11cHRM">cHRM</a>
                        </td>
                        <td>否</td>
                        <td>
                            在 <a class="chunk" href="#11PLTE">PLTE</a> 与 <a class="chunk" href="#11IDAT">IDAT</a> 之前
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#cICP-chunk">cICP</a>
                        </td>
                        <td>否</td>
                        <td>
                            在 <a class="chunk" href="#11PLTE">PLTE</a> 与 <a class="chunk" href="#11IDAT">IDAT</a> 之前
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11gAMA">gAMA</a>
                        </td>
                        <td>否</td>
                        <td>
                            在 <a class="chunk" href="#11PLTE">PLTE</a> 与 <a class="chunk" href="#11IDAT">IDAT</a> 之前
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11iCCP">iCCP</a>
                        </td>
                        <td>否</td>
                        <td>
                            在 <a class="chunk" href="#11PLTE">PLTE</a> 与 <a class="chunk" href="#11IDAT">IDAT</a> 之前。若存在
                            <a class="chunk" href="#11iCCP">iCCP</a> 块，则不应出现 <a class="chunk" href="#11sRGB">sRGB</a> 块。
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#mDCV-chunk">mDCV</a>
                        </td>
                        <td>否</td>
                        <td>
                            在 <a class="chunk" href="#11PLTE">PLTE</a> 与 <a class="chunk" href="#11IDAT">IDAT</a> 之前。
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#cLLI-chunk">cLLI</a>
                        </td>
                        <td>否</td>
                        <td>
                            在 <a class="chunk" href="#11PLTE">PLTE</a> 与 <a class="chunk" href="#11IDAT">IDAT</a> 之前。
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11sBIT">sBIT</a>
                        </td>
                        <td>否</td>
                        <td>
                            在 <a class="chunk" href="#11PLTE">PLTE</a> 与 <a class="chunk" href="#11IDAT">IDAT</a> 之前
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11sRGB">sRGB</a>
                        </td>
                        <td>否</td>
                        <td>
                            在 <a class="chunk" href="#11PLTE">PLTE</a> 与 <a class="chunk" href="#11IDAT">IDAT</a> 之前。若存在
                            <a class="chunk" href="#11sRGB">sRGB</a> 块，则不应出现 <a class="chunk" href="#11iCCP">iCCP</a> 块。
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11bKGD">bKGD</a>
                        </td>
                        <td>否</td>
                        <td>
                            在 <a class="chunk" href="#11PLTE">PLTE</a> 之后；在 <a class="chunk" href="#11IDAT">IDAT</a> 之前
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11hIST">hIST</a>
                        </td>
                        <td>否</td>
                        <td>
                            在 <a class="chunk" href="#11PLTE">PLTE</a> 之后；在 <a class="chunk" href="#11IDAT">IDAT</a> 之前
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11tRNS">tRNS</a>
                        </td>
                        <td>否</td>
                        <td>
                            在 <a class="chunk" href="#11PLTE">PLTE</a> 之后；在 <a class="chunk" href="#11IDAT">IDAT</a> 之前
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#eXIf">eXIf</a>
                        </td>
                        <td>否</td>
                        <td>
                            在 <a class="chunk" href="#11IDAT">IDAT</a> 之前
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#fcTL-chunk">fcTL</a>
                        </td>
                        <td>是</td>
                        <td>
                            可有一个出现在 <a class="chunk" href="#11IDAT">IDAT</a> 之前；其余均应在 <a class="chunk"
                                href="#11IDAT">IDAT</a> 之后
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11pHYs">pHYs</a>
                        </td>
                        <td>否</td>
                        <td>
                            在 <a class="chunk" href="#11IDAT">IDAT</a> 之前
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11sPLT">sPLT</a>
                        </td>
                        <td>是</td>
                        <td>
                            在 <a class="chunk" href="#11IDAT">IDAT</a> 之前
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#fdAT-chunk">fdAT</a>
                        </td>
                        <td>是</td>
                        <td>
                            在 <a class="chunk" href="#11IDAT">IDAT</a> 之后
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11tIME">tIME</a>
                        </td>
                        <td>否</td>
                        <td>无</td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11iTXt">iTXt</a>
                        </td>
                        <td>是</td>
                        <td>无</td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11tEXt">tEXt</a>
                        </td>
                        <td>是</td>
                        <td>无</td>
                    </tr>

                    <tr>
                        <td>
                            <a class="chunk" href="#11zTXt">zTXt</a>
                        </td>
                        <td>是</td>
                        <td>无</td>
                    </tr>
                </tbody>
            </table>


            <table id="table54" class="numbered simple">
                <caption><a class="self-link" href="#table54">表 <bdi class="tableno">8</bdi></a> <span
                        class="table-title">
                        格状图中使用符号的含义
                    </span></caption>

                <tbody>
                    <tr>
                        <th>符号</th>
                        <th>含义</th>
                    </tr>

                    <tr>
                        <td>+</td>
                        <td>一个或多个</td>
                    </tr>

                    <tr>
                        <td>1</td>
                        <td>仅一个</td>
                    </tr>

                    <tr>
                        <td>?</td>
                        <td>零个或一个</td>
                    </tr>

                    <tr>
                        <td>*</td>
                        <td>零个或多个</td>
                    </tr>

                    <tr>
                        <td>|</td>
                        <td>或（备选）</td>
                    </tr>
                </tbody>
            </table>




            <figure id="lattice-diagram-with-plte">

                <img id="figure52" src="https://www.w3.org/TR/png-3/figures/lattice-diagram-with-plte.svg">

                <figcaption><a class="self-link" href="#lattice-diagram-with-plte">图 <bdi class="figno">11</bdi></a>
                    <span class="fig-title">
                        格状图：包含 <a class="chunk" href="#11PLTE">PLTE</a> 的静态 PNG 图像
                    </span>
                </figcaption>
            </figure>

            <figure id="lattice-diagram-without-plte">

                <img id="figure53" src="https://www.w3.org/TR/png-3/figures/lattice-diagram-without-plte.svg">

                <figcaption><a class="self-link" href="#lattice-diagram-without-plte">图 <bdi class="figno">12</bdi></a>
                    <span class="fig-title">
                        格状图：不包含 <a class="chunk" href="#11PLTE">PLTE</a> 的静态 PNG 图像
                    </span>
                </figcaption>
            </figure>

            <figure id="lattice-apng-static-with-plte">
                <img id="figure52a"
                    src="https://www.w3.org/TR/png-3/figures/lattice-diagram-apng-static-first-with-plte.svg">

                <figcaption><a class="self-link" href="#lattice-apng-static-with-plte">图 <bdi class="figno">13</bdi></a>
                    <span class="fig-title">
                        格状图：包含 <a class="chunk" href="#11PLTE">PLTE</a> 的动画 PNG 图像，静态图像作为第一帧
                    </span>
                </figcaption>
            </figure>

            <figure id="lattice-apng-static-without-plte">
                <img id="figure53a"
                    src="https://www.w3.org/TR/png-3/figures/lattice-diagram-apng-static-first-without-plte.svg">

                <figcaption><a class="self-link" href="#lattice-apng-static-without-plte">图 <bdi
                            class="figno">14</bdi></a> <span class="fig-title">
                        格状图：不包含 <a class="chunk" href="#11PLTE">PLTE</a> 的动画 PNG 图像，静态图像作为第一帧
                    </span></figcaption>
            </figure>

            <figure id="lattice-apng-nostatic-with-plte">
                <img id="figure52b"
                    src="https://www.w3.org/TR/png-3/figures/lattice-diagram-apng-static-notfirst-with-plte.svg">

                <figcaption><a class="self-link" href="#lattice-apng-nostatic-with-plte">图 <bdi
                            class="figno">15</bdi></a> <span class="fig-title">
                        格状图：包含 <a class="chunk" href="#11PLTE">PLTE</a> 的动画 PNG 图像，静态图像不属于动画
                    </span></figcaption>
            </figure>

            <figure id="lattice-apng-nostatic-without-plte">
                <img id="figure53b"
                    src="https://www.w3.org/TR/png-3/figures/lattice-diagram-apng-static-notfirst-without-plte.svg">

                <figcaption><a class="self-link" href="#lattice-apng-nostatic-without-plte">图 <bdi
                            class="figno">16</bdi></a> <span class="fig-title">
                        格状图：不包含 <a class="chunk" href="#11PLTE">PLTE</a> 的动画 PNG 图像，静态图像不属于动画
                    </span></figcaption>
            </figure>
        </section>

        <section id="sec-defining-new-chunks">
            <div class="header-wrapper">
                <h3 id="x5-7-defining-chunks"><bdi class="secno">5.7 </bdi>块定义</h3><a class="self-link"
                    href="#sec-defining-new-chunks" aria-label="Permalink for Section 5.7"></a>
            </div>


            <section id="sec-defining-public-chunks-general">
                <div class="header-wrapper">
                    <h4 id="x5-7-1-general"><bdi class="secno">5.7.1 </bdi>通用</h4><a class="self-link"
                        href="#sec-defining-public-chunks-general" aria-label="Permalink for Section 5.7.1"></a>
                </div>


                <p>所有块（私有与公有）<em class="rfc2119">SHOULD</em> 列出于 [<cite><a class="bibref" data-link-type="biblio"
                            href="#bib-png-extensions"
                            title="Extensions to the PNG Third Edition Specification, Version 1.6.0">PNG-EXTENSIONS</a></cite>]。
                </p>
            </section>

            <section id="sec-defining-public-chunks">
                <div class="header-wrapper">
                    <h4 id="x5-7-2-defining-public-chunks"><bdi class="secno">5.7.2 </bdi>公有块的定义</h4><a
                        class="self-link" href="#sec-defining-public-chunks"
                        aria-label="Permalink for Section 5.7.2"></a>
                </div>


                <p>公有块保留由<abbr title="World Wide Web Consortium">W3C</abbr>定义。</p>

                <p>公有块旨在与 PNG 的理念保持一致并被广泛使用。</p>

                <p>鼓励组织与应用提交符合上述标准的任何块，由<a href="https://www.w3.org/groups/wg/png">PNG 工作组</a>定义为公有块。</p>

                <p>定义为公有块既非自动也非即时。拟议的公有块类型在被如此定义之前，<em class="rfc2119">SHALL</em> 不得用于公开可用的软件或数据流中。</p>

                <p>除非必要，不鼓励定义新的关键块类型。</p>
            </section>

            <section id="sec-defining-private-chunks">
                <div class="header-wrapper">
                    <h4 id="x5-7-3-defining-private-chunks"><bdi class="secno">5.7.3 </bdi>私有块的定义</h4>
                    <a class="self-link" href="#sec-defining-private-chunks"
                        aria-label="Permalink for Section 5.7.3"></a>
                </div>


                <p>组织与应用<em class="rfc2119">MAY</em> 定义用于私有和实验用途的私有块。</p>

                <p>不应仅为了承载与人类用户相关的文本信息而定义私有块，<em class="rfc2119">SHOULD NOT</em>。相反，应使用 <a class="chunk"
                        href="#11iTXt">iTXt</a> 块 <em class="rfc2119">SHOULD</em> BE 使用，并且对应的关键字 <em
                        class="rfc2119">SHOULD</em> BE 使用并定义合适的关键字。</p>

                <p>将私有块列于 [<cite><a class="bibref" data-link-type="biblio" href="#bib-png-extensions"
                            title="Extensions to the PNG Third Edition Specification, Version 1.6.0">PNG-EXTENSIONS</a></cite>]
                    可以降低（但不能消除）不同应用将同一私有块用于不兼容目的的可能性。如果使用了某一私有块类型，为进一步降低冲突风险，额外的标识信息<em class="rfc2119">SHOULD</em> BE
                    存储在块数据的开头。</p>

                <p>对于所有不绝对必要用于查看图像的信息，<em class="rfc2119">SHOULD</em> 使用辅助块类型，而非关键块类型。</p>

                <p>不应定义私有关键块，<em class="rfc2119">SHOULD NOT</em>，因为包含此类块的 PNG 数据流不可移植，且<em class="rfc2119">SHOULD
                        NOT</em> 用于公开可用的软件或数据流。如果应用确实必须使用某个私有关键块，它<em class="rfc2119">SHOULD</em>
                    出现在数据流靠前的位置，以便标准解码器无需读取很远就能发现它无法处理该数据流。
                </p>

                <p>关于定义私有块的更多指南，参见<a href="#newchunks" class="sec-ref"><bdi class="secno">B. </bdi>私有块类型指南</a>。</p>
            </section>
        </section>

        <section id="sec-field-value-extensibility">
            <div class="header-wrapper">
                <h3 id="x5-8-private-field-values"><bdi class="secno">5.8 </bdi>私有字段值</h3><a class="self-link"
                    href="#sec-field-value-extensibility" aria-label="Permalink for Section 5.8"></a>
            </div>


            <p>以下字段中大于或等于 128 的取值是<dfn id="dfn-private-field-values" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">私有字段值</dfn>：</p>

            <ul>
                <li>
                    位深（bit depth）
                </li>
                <li>
                    <a href="#3colourType" id="ref-for-3colourType-1">颜色类型（color type）</a>
                </li>
                <li>
                    <a href="#10CompressionCM0">压缩方法（compression method）</a>
                </li>

                <li>
                    <a href="#8InterlaceMethods">隔行方法（interlace method）</a>
                </li>

                <li>
                    <a href="#9FtIntro">滤波方法（filter method）</a>
                </li>
            </ul>

            <p>这些<a href="#dfn-private-field-values" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-private-field-values-2">私有字段值</a>既未被本规范定义，也未被保留。</p>

            <p><a href="#dfn-private-field-values" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-private-field-values-3">私有字段值</a><em class="rfc2119">MAY</em> 用于实验性或私有语义。</p>

            <p><a href="#dfn-private-field-values" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-private-field-values-4">私有字段值</a><em class="rfc2119">SHOULD NOT</em>
                出现在公开可用的软件或数据流中，因为它们可能导致数据流对 PNG 解码器不可读，详见<a href="#13Decoders" class="sec-ref"><bdi class="secno">13.
                    </bdi>PNG 解码器与查看器</a>。</p>
        </section>
    </section>




    <section id="6Transformation">
        <div class="header-wrapper">
            <h2 id="x6-reference-image-to-png-image-transformation"><bdi class="secno">6. </bdi>参考图像到 PNG 图像的转换</h2><a
                class="self-link" href="#6Transformation" aria-label="Permalink for Section 6."></a>
        </div>



        <section id="6Colour-values">
            <div class="header-wrapper">
                <h3 id="x6-1-color-types-and-values"><bdi class="secno">6.1 </bdi>颜色类型与取值</h3><a class="self-link"
                    href="#6Colour-values" aria-label="Permalink for Section 6.1"></a>
            </div>


            <p>如<a href="#4Concepts.PNGImage" class="sec-ref"><bdi class="secno">4.5 </bdi>PNG 图像</a>所述，PNG
                图像共有五种类型。与每种类型相对应的是<a id="colorType" href="#3colourType" class="internalDFN" data-link-type="dfn"><dfn
                        id="3colourType" data-plurals="color types" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">颜色类型</dfn></a>，其值为下列数值之和：1（使用调色板）、2（使用<a href="#3truecolour"
                    class="internalDFN" data-link-type="dfn" id="ref-for-3truecolour-4">真彩色</a>）与 4（使用 alpha）。<a
                    href="#dfn-greyscale" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-greyscale-4">灰度</a>与<a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3truecolour-5">真彩色</a>图像可以具有显式的 alpha 通道。PNG 图像类型与对应的<a href="#3colourType"
                    class="internalDFN" data-link-type="dfn" id="ref-for-3colourType-3">颜色类型</a>见<a href="#table6.1"
                    class="table-ref" title="PNG image types and color types">表 <bdi class="">9</bdi></a>。</p>


            <table id="table6.1" class="numbered simple">
                <caption><a class="self-link" href="#table6.1">表 <bdi class="tableno">9</bdi></a> <span
                        class="table-title">
                        PNG 图像类型与颜色类型
                    </span></caption>

                <tbody>
                    <tr>
                        <th>PNG 图像类型</th>
                        <th>颜色类型</th>
                    </tr>

                    <tr>
                        <td>灰度</td>
                        <td>0</td>
                    </tr>

                    <tr>
                        <td>真彩色</td>
                        <td>2</td>
                    </tr>

                    <tr>
                        <td>索引色</td>
                        <td>3</td>
                    </tr>

                    <tr>
                        <td>灰度（含 alpha）</td>
                        <td>4</td>
                    </tr>

                    <tr>
                        <td>真彩色（含 alpha）</td>
                        <td>6</td>
                    </tr>
                </tbody>
            </table>

            <p>各 PNG 图像类型允许的位深与采样深度见<a href="#11IHDR">图像头</a>。</p>

            <p>若指明了传递曲线（通过 <a class="chunk" href="#11gAMA">gAMA</a>、<a class="chunk" href="#11sRGB">sRGB</a>、<a
                    class="chunk" href="#11iCCP">iCCP</a> 或 <a href="#cICP-chunk"
                    class="chunk">cICP</a>），灰度采样表示亮度；否则表示设备相关的灰度。若指明了色彩空间（通过 <a class="chunk" href="#11gAMA">gAMA</a> 与
                <a class="chunk" href="#11cHRM">cHRM</a>、<a class="chunk" href="#11sRGB">sRGB</a>、<a class="chunk"
                    href="#11iCCP">iCCP</a> 或 <a href="#cICP-chunk" class="chunk">cICP</a>），RGB
                采样表示经校准的颜色信息；否则表示未校准的设备相关颜色。
            </p>

            <p>采样值不一定与光强度成正比；<a class="chunk" href="#11gAMA">gAMA</a> 块指明采样值与显示输出强度之间的关系。强烈建议查看器进行适当补偿。参见<a
                    href="#4Concepts.ColourSpaces" class="sec-ref"><bdi class="secno">4.3 </bdi>色彩空间</a>、<a
                    href="#13Decoder-gamma-handling" class="sec-ref"><bdi class="secno">13.13
                    </bdi>解码器伽玛处理</a>与<a href="#C-GammaAppendix" class="sec-ref"><bdi class="secno">C. </bdi>伽玛与色度</a>。
            </p>
        </section>


        <section id="6AlphaRepresentation">
            <div class="header-wrapper">
                <h3 id="x6-2-alpha-representation"><bdi class="secno">6.2 </bdi>Alpha 表示</h3><a class="self-link"
                    href="#6AlphaRepresentation" aria-label="Permalink for Section 6.2"></a>
            </div>


            <p>在 PNG 数据流中，透明度可依据 PNG 图像类型以四种方式之一表示（见<a href="#4Concepts.Implied-alpha" class="sec-ref"><bdi
                        class="secno">4.4.1 </bdi><span>Alpha 分离</span></a>与<a href="#4Concepts.Alpha-indexing"
                    class="sec-ref"><bdi class="secno">4.4.4 </bdi><span>Alpha 压缩</span></a>）。</p>


            <ol>
                <li>
                    <a href="#dfn-truecolor-with-alpha" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-truecolor-with-alpha-2">真彩色（含 alpha）</a>、<a href="#dfn-greyscale-with-alpha"
                        class="internalDFN" data-link-type="dfn" id="ref-for-dfn-greyscale-with-alpha-2">灰度（含
                        alpha）</a>：alpha 通道是图像数组的一部分。
                </li>

                <li>
                    <a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3truecolour-6">真彩色</a>、<a href="#dfn-greyscale" class="internalDFN"
                        data-link-type="dfn" id="ref-for-dfn-greyscale-5">灰度</a>：一个 <a class="chunk"
                        href="#11tRNS">tRNS</a> 块包含一个像素值，用于区分完全透明像素与完全不透明像素。
                </li>

                <li><a href="#3indexedColour" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3indexedColour-9">索引色</a>：一个 <a class="chunk" href="#11tRNS">tRNS</a>
                    块包含 alpha 表，为每个调色板条目关联一个 alpha 采样。
                </li>

                <li>
                    <a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3truecolour-7">真彩色</a>、<a href="#dfn-greyscale" class="internalDFN"
                        data-link-type="dfn" id="ref-for-dfn-greyscale-6">灰度</a>、<a href="#3indexedColour"
                        class="internalDFN" data-link-type="dfn" id="ref-for-3indexedColour-10">索引色</a>：不存在 <a
                        class="chunk" href="#11tRNS">tRNS</a> 块，所有像素完全不透明。
                </li>
            </ol>

            <p>包含于图像数组中的 alpha 通道采用 8 位或 16 位采样，其大小与其他采样相同。每个像素的 alpha 采样紧随该像素的灰度或 RGB 采样之后存储。alpha 值为 0 表示完全透明，值为
                2<sup>sampledepth</sup> - 1 表示完全不透明。中间值表示部分透明像素，可与背景图像进行<a href="#dfn-composited" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-composited-3">合成</a>以生成输出图像。</p>

            <p>像素中的颜色值不会与分配给该像素的 alpha 值预乘。此规则有时称为“非关联（unassociated）”或“非预乘（non-premultiplied）” alpha。（另一种常见方法是存储被 alpha
                值预乘的采样值；实际上，此类图像已相对于黑色背景完成<a href="#dfn-composited" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-composited-4">合成</a>。PNG <strong>不</strong>使用预乘 alpha。因此，图像编辑器可以方便地对 PNG
                图像的透明度进行修改。）参见<a href="#12Alpha-channel-creation" class="sec-ref"><bdi class="secno">12.3
                    </bdi>Alpha 通道创建</a>与<a href="#13Alpha-channel-processing" class="sec-ref"><bdi class="secno">13.16
                    </bdi>Alpha 通道处理</a>。</p>
        </section>
    </section>




    <section id="7Transformation">
        <div class="header-wrapper">
            <h2 id="x7-encoding-the-png-image-as-a-png-datastream"><bdi class="secno">7. </bdi>将 PNG 图像编码为 PNG 数据流</h2>
            <a class="self-link" href="#7Transformation" aria-label="Permalink for Section 7."></a>
        </div>



        <section id="7Integers-and-byte-order">
            <div class="header-wrapper">
                <h3 id="x7-1-integers-and-byte-order"><bdi class="secno">7.1 </bdi>整数与字节序</h3><a class="self-link"
                    href="#7Integers-and-byte-order" aria-label="Permalink for Section 7.1"></a>
            </div>


            <p>所有需要多个字节表示的整数均应采用<a href="#dfn-network-byte-order" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-network-byte-order-1">网络字节序</a>（如<a href="#integer-representation-in-png"
                    class="fig-ref" title="Integer representation in PNG">图 <bdi
                        class="">17</bdi></a>所示）：最高有效字节在前，随后各字节按重要性递减顺序排列（两字节整数为 <abbr
                    title="Most Significant Byte">MSB</abbr> <abbr title="Least Significant Byte">LSB</abbr>，四字节整数为
                <abbr title="Most Significant Byte">MSB</abbr> B2 B1 <abbr
                    title="Least Significant Byte">LSB</abbr>）。一个字节的最高位（值 128）标号为位 7；最低位（值 1）标号为位
                0。除非另有说明，取值均为无符号。明示为有符号的取值采用二进制补码表示。
            </p>

            <p><a href="#dfn-png-four-byte-unsigned-integer" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-png-four-byte-unsigned-integer-2">PNG 四字节无符号整数</a>限定在 0 至 2<sup>31</sup>-1
                的范围内，以适应某些难以处理无符号四字节值的语言。</p>

            <figure id="integer-representation-in-png">

                <img id="figure71" src="https://www.w3.org/TR/png-3/figures/integer-representation-in-png.svg">

                <figcaption><a class="self-link" href="#integer-representation-in-png">图 <bdi class="figno">17</bdi></a>
                    <span class="fig-title">
                        PNG 中的整数表示
                    </span>
                </figcaption>
            </figure>
        </section>


        <section id="7Scanline">
            <div class="header-wrapper">
                <h3 id="x7-2-scanlines"><bdi class="secno">7.2 </bdi>扫描线</h3><a class="self-link" href="#7Scanline"
                    aria-label="Permalink for Section 7.2"></a>
            </div>


            <p>PNG 图像（或轮次，见<a href="#8Interlace" class="sec-ref"><bdi class="secno">8.
                    </bdi>隔行与通道提取</a>）是一个矩形像素数组，每条扫描线内像素从左到右排列，扫描线从上到下排列。每个像素的大小由每像素位数决定。</p>

            <p>扫描线内的像素始终紧密打包为字节序列，像素之间没有浪费的比特。扫描线总是在字节边界上开始。允许的位深与<a href="#3colourType" class="internalDFN"
                    data-link-type="dfn" id="ref-for-3colourType-4">颜色类型</a>受到限制，以确保在所有情况下打包均简单高效。</p>

            <p>在<a href="#3colourType" class="internalDFN" data-link-type="dfn" id="ref-for-3colourType-5">颜色类型</a>为
                0（灰度）的 PNG 图像中，每个像素是一个采样，精度可以小于一个字节（1、2 或 4 位）。这些采样按字节打包，每字节的高位为该扫描线最左侧的采样，随后是该扫描线的其他采样。</p>

            <p>在<a href="#3colourType" class="internalDFN" data-link-type="dfn" id="ref-for-3colourType-6">颜色类型</a>为
                3（索引色）的 PNG 图像中，每个像素是一个调色板索引。这些索引的打包方式与<a href="#3colourType" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3colourType-7">颜色类型</a> 0 的采样相同。</p>

            <p>当每字节包含多个像素时，扫描线最后一个字节的一些低位可能未使用。这些未使用比特的内容未作规定。</p>

            <p>非<a href="#3indexedColour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3indexedColour-11">索引色</a>的 PNG 图像，其采样值的位深可以为 16。此类采样值采用<a
                    href="#dfn-network-byte-order" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-network-byte-order-2">网络字节序</a>（<abbr title="Most Significant Byte">MSB</abbr>
                在前，<abbr title="Least Significant Byte">LSB</abbr> 在后）。PNG 仅允许在 8 位与 16
                位采样时使用多采样像素，因此同一像素的多个采样不会被打包到同一个字节中。
            </p>
        </section>




        <section id="7Filtering">
            <div class="header-wrapper">
                <h3 id="x7-3-filtering"><bdi class="secno">7.3 </bdi>滤波</h3><a class="self-link" href="#7Filtering"
                    aria-label="Permalink for Section 7.3"></a>
            </div>



            <p><dfn id="3filter" data-plurals="filter methods" tabindex="0" aria-haspopup="dialog"
                    data-dfn-type="dfn">滤波方法</dfn>是一种作用于<a href="#dfn-scanline" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-scanline-2">扫描线</a>数组的变换，旨在提高其可压缩性。</p>

            <p>PNG 标准化了一种<a href="#3filter" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3filter-1">滤波方法</a>以及若干可用于为<a href="#dfn-image-data" class="internalDFN"
                    data-link-type="dfn"
                    id="ref-for-dfn-image-data-2">图像数据</a>做压缩准备的滤波类型。它将字节序列变换为等长的字节序列，并在前面加上一个滤波类型字节（示例见<a
                    href="#serializing-and-filtering-scanline" class="fig-ref"
                    title="Serializing and filtering a scanline">图 <bdi class="">18</bdi></a>）。</p>

            <p>对于隔行 PNG 图像，编码器应仅使用单一<a href="#3filter" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3filter-2">滤波方法</a>，但可以对缩减图像中的每条扫描线使用不同的滤波类型。智能的编码器可以在相邻扫描线之间切换滤波器。选择使用何种滤波器的方法由编码器自行决定。
            </p>

            <p>滤波类型字节不视为<a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-image-data-3">图像数据</a>的一部分，但会被包含在发送至压缩步骤的数据流中。参见<a href="#9Filters"
                    class="sec-ref"><bdi class="secno">9. </bdi>滤波</a>。</p>

            <figure id="serializing-and-filtering-scanline">

                <img id="figure49" src="https://www.w3.org/TR/png-3/figures/serializing-and-filtering-scanline.svg">

                <figcaption><a class="self-link" href="#serializing-and-filtering-scanline">图 <bdi
                            class="figno">18</bdi></a> <span class="fig-title">
                        序列化与滤波一条扫描线
                    </span></figcaption>
            </figure>
        </section>
    </section>




    <section id="8Interlace">
        <div class="header-wrapper">
            <h2 id="x8-interlacing-and-pass-extraction"><bdi class="secno">8. </bdi>隔行与通道提取</h2>
            <a class="self-link" href="#8Interlace" aria-label="Permalink for Section 8."></a>
        </div>



        <section class="introductory" id="8InterlaceIntro">
            <div class="header-wrapper">
                <h3 id="introduction-4">简介</h3><a class="self-link" href="#8InterlaceIntro"
                    aria-label="Permalink for this Section"></a>
            </div>


            <p>通道提取（见<a href="#figure48">图 4.8</a>）将一幅 PNG 图像拆分为一系列缩减图像（即隔行 PNG 图像），第一幅给出粗略视图，后续图像逐步增强该视图，直到最后一幅完成整幅 PNG
                图像。这使解码器能够对隔行 PNG 图像进行渐进式显示，并允许图像在即时显示时“淡入”。平均而言，隔行会略微增大数据流大小，但可以更快地为用户提供有意义的显示。</p>
        </section>


        <section id="8InterlaceMethods">
            <div class="header-wrapper">
                <h3 id="x8-1-interlace-methods"><bdi class="secno">8.1 </bdi>隔行方法</h3><a class="self-link"
                    href="#8InterlaceMethods" aria-label="Permalink for Section 8.1"></a>
            </div>


            <p>本国际标准定义了两种隔行方法，方法 0 与方法 1。隔行方法的其他取值保留用于未来标准化。</p>

            <p>在隔行方法 0（空方法）中，像素按从左到右依次提取，扫描线按从上到下依次提取。隔行 PNG 图像是一幅单一的缩减图像。</p>

            <p>隔行方法 1（Adam7）定义了对图像的七个不同轮次。每个轮次传输参考图像中像素的一个子集。每个像素被传输的轮次（编号 1 至 7）通过将以下 8×8 模式在整幅图像上自左上角开始复制来定义：</p>

            <pre aria-busy="false"><code class="hljs">1 6 4 6 2 6 4 6
7 7 7 7 7 7 7 7
5 6 5 6 5 6 5 6
7 7 7 7 7 7 7 7
3 6 4 6 3 6 4 6
7 7 7 7 7 7 7 7
5 6 5 6 5 6 5 6
7 7 7 7 7 7 7 7</code></pre>
            <p><a href="#figure48">图 4.8</a>展示了隔行方法 1 的七个轮次。在每个轮次内，选定像素在扫描线内自左向右传输，选定扫描线按从上到下顺序传输。例如，轮次 2 包含扫描线 0、8、16
                等的像素 4、12、20 等（其中扫描线 0、像素 0 为左上角）。最后一个轮次包含扫描线 1、3、5
                等的所有像素。传输顺序的定义确保同一轮次中传输的所有扫描线具有相同的像素数；这对某些滤波器的正确应用是必要的。隔行 PNG 图像由七幅缩减图像构成。例如，若 PNG 图像为 16×16
                像素，则第三个轮次将是两条扫描线组成的缩减图像，每条包含四个像素（见<a href="#figure48">图 4.8</a>）。</p>

            <p>未能填满整数个字节的扫描线按照<a href="#7Scanline" class="sec-ref"><bdi class="secno">7.2 </bdi>扫描线</a>中的定义进行填充。</p>

            <div class="note" role="note" id="issue-container-generatedID-9">
                <div role="heading" class="note-title marker" id="h-note-9" aria-level="4"><span>注</span></div>
                <p class="">如果参考图像的列数少于五列或行数少于五行，某些轮次将为空。</p>
            </div>
        </section>
    </section>




    <section id="9Filters">
        <div class="header-wrapper">
            <h2 id="x9-filtering"><bdi class="secno">9. </bdi>滤波</h2><a class="self-link" href="#9Filters"
                aria-label="Permalink for Section 9."></a>
        </div>



        <section id="9FtIntro">
            <div class="header-wrapper">
                <h3 id="x9-1-filter-methods-and-filter-types"><bdi class="secno">9.1 </bdi>滤波方法与滤波类型</h3><a
                    class="self-link" href="#9FtIntro" aria-label="Permalink for Section 9.1"></a>
            </div>


            <p>滤波会对 PNG 图像进行变换，目标是提升压缩效果。整体流程见<a href="#encoding-png-image" class="fig-ref"
                    title="Encoding the PNG image">图 <bdi class="">7</bdi></a>，而对单条扫描线的序列化与滤波细节见<a
                    href="#serializing-and-filtering-scanline" class="fig-ref"
                    title="Serializing and filtering a scanline">图 <bdi class="">18</bdi></a>。</p>

            <p>PNG 允许若干种<a href="#3filter" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3filter-3">滤波方法</a>。隔行图像中的所有缩减图像应使用单一<a href="#3filter" class="internalDFN"
                    data-link-type="dfn" id="ref-for-3filter-4">滤波方法</a>。本规范仅定义<a href="#3filter" class="internalDFN"
                    data-link-type="dfn" id="ref-for-3filter-5">滤波方法</a> 0。其他<a href="#3filter" class="internalDFN"
                    data-link-type="dfn" id="ref-for-3filter-6">滤波方法</a>保留供未来标准化使用。<a href="#3filter"
                    class="internalDFN" data-link-type="dfn" id="ref-for-3filter-7">滤波方法</a> 0
                提供五种滤波类型，每个缩减图像中的各条扫描线可以使用不同的滤波类型。
            </p>

            <p>PNG 对可应用于隔行 PNG 图像的滤波类型不作额外限制。然而，各滤波类型对不同数据的效果并不相同。参见<a href="#12Filter-selection" class="sec-ref"><bdi
                        class="secno">12.7 </bdi>滤波选择</a>。</p>

            <p>滤波将扫描线中的字节序列变换为等长的字节序列，并在前面加上滤波类型字节。仅非空扫描线才具有滤波类型字节。空轮次中不包含滤波类型字节。参见<a href="#13Progressive-display"
                    class="sec-ref"><bdi class="secno">13.10 </bdi>隔行与渐进显示</a>。</p>
        </section>


        <section id="9Filter-types">
            <div class="header-wrapper">
                <h3 id="x9-2-filter-types-for-filter-method-0"><bdi class="secno">9.2 </bdi>滤波方法 0 的滤波类型</h3><a
                    class="self-link" href="#9Filter-types" aria-label="Permalink for Section 9.2"></a>
            </div>


            <p>无论图像的位深或<a href="#3colourType" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3colourType-8">颜色类型</a>为何，滤波均作用于<strong>字节</strong>而非像素。滤波在已按<a href="#7Scanline"
                    class="sec-ref"><bdi class="secno">7.2 </bdi>扫描线</a>描述形式表示的扫描线字节序列上进行。若图像包含 alpha 通道，alpha 数据与<a
                    href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-image-data-4">图像数据</a>以相同方式进行滤波。</p>

            <p>滤波器可使用以下字节的原始取值来生成新字节值：</p>

            <table class="numbered simple" id="table-named-filter-bytes">
                <caption><a class="self-link" href="#table-named-filter-bytes">表 <bdi class="tableno">10</bdi></a>
                    <span class="table-title">
                        命名的滤波字节
                    </span>
                </caption>

                <tbody>
                    <tr>
                        <th>名称</th>
                        <th>定义</th>
                    </tr>

                    <tr>
                        <td><var>x</var>
                        </td>
                        <td>当前被滤波的字节；</td>
                    </tr>

                    <tr>
                        <td><var>a</var>
                        </td>
                        <td>位于包含 x 的像素之前那个像素中与 x 对应的字节（当位深小于 8 时，为紧邻 x 之前的字节）；</td>
                    </tr>

                    <tr>
                        <td><var>b</var>
                        </td>
                        <td>上一条扫描线中与 x 对应的字节；</td>
                    </tr>

                    <tr>
                        <td><var>c</var>
                        </td>
                        <td>位于包含 b 的像素之前那个像素中与 b 对应的字节（当位深小于 8 时，为紧邻 b 之前的字节）。</td>
                    </tr>
                </tbody>
            </table>

            <figure id="filter-byte-positions">
                <img id="figure72" src="https://www.w3.org/TR/png-3/figures/filter-bytes.svg" style="width: 12vw">

                <figcaption><a class="self-link" href="#filter-byte-positions">图 <bdi class="figno">19</bdi></a>
                    <span class="fig-title">
                        相对于 x 的滤波字节 a、b 与 c 的位置
                    </span>
                </figcaption>
            </figure>

            <p><a href="#filter-byte-positions" class="fig-ref"
                    title="Positions of filter bytes a, b and c relative to x">图 <bdi class="">19</bdi></a>展示了字节
                <var>x</var>、<var>a</var>、<var>b</var> 与 <var>c</var> 的相对位置。
            </p>

            <p><a href="#3filter" class="internalDFN" data-link-type="dfn" id="ref-for-3filter-8">滤波方法</a> 0
                定义的五种基本滤波类型列于<a href="#9-table91" class="table-ref" title="Filter types">表 <bdi
                        class="">11</bdi></a>。<code>Orig(y)</code> 表示字节 <var>y</var> 的原始（未滤波）值。<code>Filt(y)</code>
                表示应用某种滤波类型后的值。<code>Recon(y)</code> 表示应用对应重建函数后的值。Paeth 滤波类型中的 <var>PaethPredictor</var> [<cite><a
                        class="bibref" data-link-type="biblio" href="#bib-paeth"
                        title="Image File Compression Made Easy, in Graphics Gems II, pp. 93-100">Paeth</a></cite>]
                定义如下。</p>

            <p><a href="#3filter" class="internalDFN" data-link-type="dfn" id="ref-for-3filter-9">滤波方法</a> 0
                严格规定为这五种滤波类型，且不得扩展。这样可确保解码器无需解压数据便能判断是否包含不受支持的滤波类型：只需检查<a href="#3filter" class="internalDFN"
                    data-link-type="dfn" id="ref-for-3filter-10">滤波方法</a>是否为<a href="#11IHDR" class="sec-ref"><bdi
                        class="secno">11.2.1 </bdi><span class="chunk">IHDR</span> 图像头</a>中的方法 0。</p>




            <table id="9-table91" class="numbered simple">
                <caption><a class="self-link" href="#9-table91">表 <bdi class="tableno">11</bdi></a> <span
                        class="table-title">
                        滤波类型
                    </span></caption>

                <tbody>
                    <tr>
                        <th>类型</th>
                        <th>名称</th>
                        <th>滤波函数</th>
                        <th>重建函数</th>
                    </tr>

                    <tr>
                        <td>0</td>
                        <td>None</td>
                        <td><code>Filt(x) = Orig(x)</code>
                        </td>
                        <td><code>Recon(x) = Filt(x)</code>
                        </td>
                    </tr>

                    <tr>
                        <td>1</td>
                        <td>Sub</td>
                        <td><code>Filt(x) = Orig(x) - Orig(a)</code>
                        </td>
                        <td><code>Recon(x) = Filt(x) + Recon(a)</code>
                        </td>
                    </tr>

                    <tr>
                        <td>2</td>
                        <td>Up</td>
                        <td><code>Filt(x) = Orig(x) - Orig(b)</code>
                        </td>
                        <td><code>Recon(x) = Filt(x) + Recon(b)</code>
                        </td>
                    </tr>

                    <tr>
                        <td>3</td>
                        <td>Average</td>
                        <td><code>Filt(x) = Orig(x) - floor((Orig(a) + Orig(b)) / 2)</code>
                        </td>
                        <td><code>Recon(x) = Filt(x) + floor((Recon(a) + Recon(b)) / 2)</code>
                        </td>
                    </tr>

                    <tr>
                        <td>4</td>
                        <td>Paeth</td>
                        <td><code>Filt(x) = Orig(x) - PaethPredictor(Orig(a), Orig(b), Orig(c))</code>
                        </td>
                        <td><code>Recon(x) = Filt(x) + PaethPredictor(Recon(a), Recon(b), Recon(c))</code>
                        </td>
                    </tr>
                </tbody>
            </table>

            <p>对于所有滤波器，扫描线中第一个像素“左侧”的字节应视为 0。对于引用上一条扫描线的滤波器，在缩减图像的第一条扫描线上，上一条扫描线的全部字节以及该扫描线第一个像素“左侧”的字节均应视为 0。</p>

            <p>要逆转滤波效果，需要使用同一扫描线中前一像素的解码值、上一条扫描线上当前像素正上方像素的解码值，以及位于上方像素左侧的像素的解码值。</p>

            <p>使用 256 模的无符号算术，以确保输入与输出均适合于字节。滤波对每个字节应用，无论位深为何。<code>Filt</code> 值序列作为滤波后的扫描线进行传输。</p>
        </section>


        <section id="9Filter-type-3-Average">
            <div class="header-wrapper">
                <h3 id="x9-3-filter-type-3-average"><bdi class="secno">9.3 </bdi>滤波类型 3：Average</h3><a class="self-link"
                    href="#9Filter-type-3-Average" aria-label="Permalink for Section 9.3"></a>
            </div>


            <p>求和 <code>Orig(a) + Orig(b)</code> 应在无溢出的情况下进行（至少使用九位算术）。<code>floor()</code>
                表示若结果为小数，则向下取整为下一个较小的整数；换言之，是整数除法或右移操作。
            </p>
        </section>


        <section id="9Filter-type-4-Paeth">
            <div class="header-wrapper">
                <h3 id="x9-4-filter-type-4-paeth"><bdi class="secno">9.4 </bdi>滤波类型 4：Paeth</h3><a class="self-link"
                    href="#9Filter-type-4-Paeth" aria-label="Permalink for Section 9.4"></a>
            </div>


            <p>Paeth 滤波类型对三个相邻像素（左、上、左上）的值进行简单线性组合，然后选择与该计算值最接近的相邻像素作为预测值。本规范所用算法源自 Alan W. Paeth 的技术改编自 [<cite><a
                        class="bibref" data-link-type="biblio" href="#bib-paeth"
                        title="Image File Compression Made Easy, in Graphics Gems II, pp. 93-100">Paeth</a></cite>]。</p>

            <p>PaethPredictor 函数定义如下代码。该函数的逻辑以及字节 <var>a</var>、<var>b</var>、<var>c</var> 与 <var>x</var> 的位置见<a
                    href="#paethpredictor-function" class="fig-ref" title="The PaethPredictor function">图 <bdi
                        class="">20</bdi></a>。<var>Pr</var> 是字节 <var>x</var> 的预测值。
            </p>

            <pre aria-busy="false"><code class="hljs javascript">p = a + b - c
pa = <span class="hljs-title function_">abs</span>(p - a)
pb = <span class="hljs-title function_">abs</span>(p - b)
pc = <span class="hljs-title function_">abs</span>(p - c)
<span class="hljs-keyword">if</span> pa &lt;= pb and pa &lt;= pc then <span class="hljs-title class_">Pr</span> = a
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> pb &lt;= pc then <span class="hljs-title class_">Pr</span> = b
<span class="hljs-keyword">else</span> <span class="hljs-title class_">Pr</span> = c
<span class="hljs-keyword">return</span> <span class="hljs-title class_">Pr</span></code></pre>


            <figure id="paethpredictor-function">

                <img id="9-figure91" src="https://www.w3.org/TR/png-3/figures/paethpredictor-function.svg">

                <figcaption><a class="self-link" href="#paethpredictor-function">图 <bdi class="figno">20</bdi></a>
                    <span class="fig-title">
                        PaethPredictor 函数
                    </span>
                </figcaption>
            </figure>

            <p>PaethPredictor 函数中的计算应精确执行，不得产生溢出。</p>

            <p><strong>比较的执行顺序至关重要，不得更改。</strong>该函数试图确定在三个方向（垂直、水平或对角）中，图像的梯度在哪个方向最小。</p>

            <p>编码器与解码器均使用完全相同的 PaethPredictor 函数。</p>
        </section>
    </section>




    <section id="10Compression">
        <div class="header-wrapper">
            <h2 id="x10-compression"><bdi class="secno">10. </bdi>压缩</h2><a class="self-link" href="#10Compression"
                aria-label="Permalink for Section 10."></a>
        </div>



        <section id="10CompressionCM0">
            <div class="header-wrapper">
                <h3 id="x10-1-compression-method-0"><bdi class="secno">10.1 </bdi>压缩方法 0</h3><a class="self-link"
                    href="#10CompressionCM0" aria-label="Permalink for Section 10.1"></a>
            </div>


            <p>本国际标准仅定义了 PNG 压缩方法 0。压缩方法的其他取值保留供未来标准化使用。PNG 压缩方法 0 为<a href="#dfn-deflate" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-deflate-2">deflate</a> 压缩，使用的滑动窗口（这是 <a href="#dfn-deflate"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-deflate-3">deflate</a> 流中出现的距离的上界）最大为 32768
                字节。<a href="#dfn-deflate" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-deflate-4">Deflate</a> 压缩源自
                <a href="#3LZ77" class="internalDFN" data-link-type="dfn" id="ref-for-3LZ77-2">LZ77</a>。
            </p>

            <p>PNG 中的经 <a href="#dfn-deflate" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-deflate-5">deflate</a> 压缩的数据流以 <a href="#dfn-zlib" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-zlib-1">zlib</a> 格式存储，其结构为：</p>

            <table id="zlib-structure" class="simple numbered">
                <tbody>
                    <tr>
                        <td>zlib 压缩方法/标志码</td>
                        <td>1 字节</td>
                    </tr>

                    <tr>
                        <td>附加标志/校验位</td>
                        <td>1 字节</td>
                    </tr>

                    <tr>
                        <td>压缩数据块</td>
                        <td>n 字节</td>
                    </tr>

                    <tr>
                        <td>校验值</td>
                        <td>4 字节</td>
                    </tr>
                </tbody>
            </table>

            <p><a href="#dfn-zlib" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-zlib-2">zlib</a> 的规范见
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc1950"
                        title="ZLIB Compressed Data Format Specification version 3.3">rfc1950</a></cite>]。</p>

            <p>对于 PNG 压缩方法 0，<a href="#dfn-zlib" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-zlib-3">zlib</a> 的压缩方法/标志码应指定方法码 8（<a href="#dfn-deflate" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-deflate-6">deflate</a>
                压缩）且 <a href="#3LZ77" class="internalDFN" data-link-type="dfn" id="ref-for-3LZ77-3">LZ77</a> 窗口大小不超过
                32768 字节。<a href="#dfn-zlib" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-zlib-4">zlib</a>
                的压缩方法编号与 <a class="chunk" href="#11IHDR">IHDR</a> 块中的 PNG 压缩方法编号并不相同。附加标志不得指定预置字典。</p>

            <p>若待压缩的数据不超过 16384 字节，PNG 编码器可以将窗口大小上取整为 2 的幂（最小为 256）。这将在不不利影响压缩比的情况下减少编码与解码所需内存。</p>

            <p><a href="#dfn-zlib" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-zlib-5">zlib</a>
                数据流中的压缩数据以一系列数据块的形式存储，每个数据块可以表示原始（未压缩）数据、使用固定哈夫曼码编码的 <a href="#3LZ77" class="internalDFN"
                    data-link-type="dfn" id="ref-for-3LZ77-4">LZ77</a> 压缩数据，或使用自定义哈夫曼码编码的 <a href="#3LZ77"
                    class="internalDFN" data-link-type="dfn" id="ref-for-3LZ77-5">LZ77</a>
                压缩数据。最终数据块中的标记位将其标识为最后一个数据块，从而使解码器能够识别压缩数据流的结束。有关压缩算法与编码的更多细节见
                <a href="#dfn-deflate" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-deflate-7">deflate</a>
                规范 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc1951"
                        title="DEFLATE Compressed Data Format Specification version 1.3">rfc1951</a></cite>]。
            </p>

            <p><a href="#dfn-zlib" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-zlib-6">zlib</a>
                数据流末尾存储的校验值是基于该数据流所表示的未压缩数据计算的。用于计算该值的算法不同于 PNG 块 <abbr title="Cyclic Redundancy Code">CRC</abbr>
                字段值所使用的 <abbr title="Cyclic Redundancy Code">CRC</abbr> 计算。<a href="#dfn-zlib" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-zlib-7">zlib</a> 校验值主要用于交叉检验 <a href="#dfn-deflate"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-deflate-8">deflate</a>
                算法是否被正确实现。校验单独的 PNG 块 CRC 能够增强对 PNG 数据流未在传输中损坏的信心。</p>
        </section>


        <section id="10CompressionFSL">
            <div class="header-wrapper">
                <h3 id="x10-2-compression-of-the-sequence-of-filtered-scanlines"><bdi class="secno">10.2
                    </bdi>滤波后扫描线序列的压缩</h3><a class="self-link" href="#10CompressionFSL"
                    aria-label="Permalink for Section 10.2"></a>
            </div>


            <p>对滤波后的扫描线序列进行压缩，所得数据流被拆分为 <a class="chunk" href="#11IDAT">IDAT</a> 块。所有 <a class="chunk"
                    href="#11IDAT">IDAT</a> 块内容的串联构成一个 <a href="#dfn-zlib" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-zlib-8">zlib</a>
                数据流。该数据流解压缩得到滤波后的<a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-image-data-5">图像数据</a>。</p>

            <p>需要强调的是，<a class="chunk" href="#11IDAT">IDAT</a> 块之间的边界是任意的，可以落在 <a href="#dfn-zlib" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-zlib-9">zlib</a> 数据流中的任意位置。<a class="chunk"
                    href="#11IDAT">IDAT</a> 块边界与 <a href="#dfn-deflate" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-deflate-9">deflate</a> 数据块边界或 <a href="#dfn-zlib" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-zlib-10">zlib</a> 数据的任何其他特征之间并无必然关联。例如，终止性的 <a href="#dfn-zlib"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-zlib-11">zlib</a> 校验值完全可能被拆分到不同的 <a
                    class="chunk" href="#11IDAT">IDAT</a> 块中。</p>

            <p>同样，<a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-image-data-6">图像数据</a>的结构（即扫描线边界）与 <a href="#dfn-deflate" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-deflate-10">deflate</a>
                数据块边界或 <a class="chunk" href="#11IDAT">IDAT</a> 块边界之间也没有要求上的关联。完整的、经过滤波的 PNG 图像由一个单一的 <a
                    href="#dfn-zlib" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-zlib-12">zlib</a>
                数据流表示，而该数据流被存放在若干个 <a class="chunk" href="#11IDAT">IDAT</a> 块中。
            </p>
        </section>




        <section id="10CompressionOtherUses">
            <div class="header-wrapper">
                <h3 id="x10-3-other-uses-of-compression"><bdi class="secno">10.3 </bdi>压缩的其他用法</h3><a class="self-link"
                    href="#10CompressionOtherUses" aria-label="Permalink for Section 10.3"></a>
            </div>


            <p>PNG 还在 <a class="chunk" href="#11iTXt">iTXt</a>、<a class="chunk" href="#11iCCP">iCCP</a> 与 <a
                    class="chunk" href="#11zTXt">zTXt</a> 块中使用压缩方法 0。与<a href="#dfn-image-data" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-image-data-7">图像数据</a>不同，此类数据流不会跨多个块拆分；每个此类块都包含一个独立的 <a
                    href="#dfn-zlib" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-zlib-13">zlib</a> 数据流（见 <a
                    href="#10CompressionCM0" class="sec-ref"><bdi class="secno">10.1 </bdi>压缩方法 0</a>）。</p>
        </section>
    </section>




    <section id="11Chunks">
        <div class="header-wrapper">
            <h2 id="x11-chunk-specifications"><bdi class="secno">11. </bdi>块规范</h2><a class="self-link" href="#11Chunks"
                aria-label="Permalink for Section 11."></a>
        </div>



        <section id="11Introduction">
            <div class="header-wrapper">
                <h3 id="x11-1-general"><bdi class="secno">11.1 </bdi>通用</h3><a class="self-link" href="#11Introduction"
                    aria-label="Permalink for Section 11.1"></a>
            </div>


            <p>本条款定义了本规范中使用的各块。</p>
        </section>


        <section id="11Critical-chunks">
            <div class="header-wrapper">
                <h3 id="x11-2-critical-chunks"><bdi class="secno">11.2 </bdi>关键块</h3><a class="self-link"
                    href="#11Critical-chunks" aria-label="Permalink for Section 11.2"></a>
            </div>



            <section class="introductory" id="11CcGen">
                <div class="header-wrapper">
                    <h3 id="introduction-5">简介</h3><a class="self-link" href="#11CcGen"
                        aria-label="Permalink for this Section"></a>
                </div>



                <p><dfn id="3criticalChunk" class="lint-ignore" tabindex="0" aria-haspopup="dialog"
                        data-dfn-type="dfn">关键块（critical chunk）</dfn>是指从 PNG 数据流中成功解码 PNG 图像所绝对必需的块。扩展块可以被定义为关键块（见 <a
                        href="#14EditorsExt" class="sec-ref"><bdi class="secno">14. </bdi>编辑器</a>），但强烈不建议这样做。</p>

                <p>有效的 PNG 数据流应以 PNG 签名开始，其后紧跟一个 <a class="chunk" href="#11IHDR">IHDR</a> 块，然后是一个或多个 <a class="chunk"
                        href="#11IDAT">IDAT</a> 块，并以一个 <a class="chunk" href="#11IEND">IEND</a> 块结束。一个 PNG 数据流中只允许有一个 <a
                        class="chunk" href="#11IHDR">IHDR</a> 块和一个 <a class="chunk" href="#11IEND">IEND</a> 块。</p>
            </section>


            <section id="11IHDR">
                <div class="header-wrapper">
                    <h4 id="x11-2-1-ihdr-image-header"><bdi class="secno">11.2.1 </bdi><span class="chunk">IHDR</span>
                        图像头</h4><a class="self-link" href="#11IHDR" aria-label="Permalink for Section 11.2.1"></a>
                </div>


                <p>四字节的块类型字段包含以下十六进制值：</p>

                <pre aria-busy="false"><code class="hljs">49 48 44 52</code></pre>
                <p><a class="chunk" href="#11IHDR">IHDR</a> 块应为 PNG 数据流中的第一个块。其包含：</p>

                <table id="IHDR-structure" class="simple numbered">
                    <tbody>
                        <tr>
                            <td>宽度</td>
                            <td>4 字节</td>
                        </tr>

                        <tr>
                            <td>高度</td>
                            <td>4 字节</td>
                        </tr>

                        <tr>
                            <td>位深</td>
                            <td>1 字节</td>
                        </tr>

                        <tr>
                            <td>颜色类型</td>
                            <td>1 字节</td>
                        </tr>

                        <tr>
                            <td>压缩方法</td>
                            <td>1 字节</td>
                        </tr>

                        <tr>
                            <td>滤波方法</td>
                            <td>1 字节</td>
                        </tr>

                        <tr>
                            <td>隔行方法</td>
                            <td>1 字节</td>
                        </tr>
                    </tbody>
                </table>

                <p>宽度与高度给出图像的像素尺寸。它们是<a href="#dfn-png-four-byte-unsigned-integer" class="internalDFN"
                        data-link-type="dfn" id="ref-for-dfn-png-four-byte-unsigned-integer-3">PNG 四字节无符号整数</a>。取值 0 无效。
                </p>


                <p id="3bitDepth">位深是一个单字节整数，给出每个采样或每个调色板索引（而非每像素）的位数。有效取值为 1、2、4、8 与 16，尽管并非所有<a href="#3colourType"
                        class="internalDFN" data-link-type="dfn" id="ref-for-3colourType-9">颜色类型</a>都允许所有取值。见 <a
                        href="#6Colour-values" class="sec-ref"><bdi class="secno">6.1 </bdi>颜色类型与取值</a>。</p>

                <p><a href="#3colourType" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3colourType-10">颜色类型</a>是一个单字节整数。</p>

                <p>对每种<a href="#3colourType" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3colourType-11">颜色类型</a>施加位深限制，以简化实现并禁止压缩效果不佳的组合。允许的组合定义见 <a href="#table111"
                        class="table-ref" title="Allowed combinations of color type and bit depth">表 <bdi
                            class="">12</bdi></a>。</p>


                <table id="table111" class="numbered simple">
                    <caption><a class="self-link" href="#table111">Table <bdi class="tableno">12</bdi></a> <span
                            class="table-title">
                            允许的<a href="#3colourType" class="internalDFN" data-link-type="dfn"
                                id="ref-for-3colourType-12">颜色类型</a>与位深组合
                        </span></caption>

                    <tbody>
                        <tr>
                            <th>PNG 图像类型</th>
                            <th>颜色类型</th>
                            <th>允许的位深</th>
                            <th>解释</th>
                        </tr>

                        <tr>
                            <td>灰度</td>
                            <td>0</td>
                            <td>1, 2, 4, 8, 16</td>
                            <td>每个像素是一个灰度采样</td>
                        </tr>

                        <tr>
                            <td>真彩色</td>
                            <td>2</td>
                            <td>8, 16</td>
                            <td>每个像素是一个 R,G,B 三元组</td>
                        </tr>

                        <tr>
                            <td>索引色</td>
                            <td>3</td>
                            <td>1, 2, 4, 8</td>
                            <td>
                                每个像素是一个调色板索引；必须出现 <a class="chunk" href="#11PLTE">PLTE</a> 块。
                            </td>
                        </tr>

                        <tr>
                            <td>灰度（含 alpha）</td>
                            <td>4</td>
                            <td>8, 16</td>
                            <td>每个像素是一个灰度采样，后跟一个 alpha 采样。</td>
                        </tr>

                        <tr>
                            <td>真彩色（含 alpha）</td>
                            <td>6</td>
                            <td>8, 16</td>
                            <td>每个像素是一个 R,G,B 三元组，后跟一个 alpha 采样。</td>
                        </tr>
                    </tbody>
                </table>

                <p>除 <a href="#3indexedColour" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3indexedColour-12">索引色</a> PNG 图像（<a href="#3colourType" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3colourType-13">颜色类型</a> 3）外，采样深度与位深相同；在索引色图像中，采样深度始终为 8 位（见 <a
                        href="#4Concepts.PNGImage" class="sec-ref"><bdi class="secno">4.5 </bdi>PNG 图像</a>）。</p>

                <p>压缩方法是一个单字节整数，指示用于压缩<a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-image-data-8">图像数据</a>的方法。本规范仅定义压缩方法 0（<a href="#dfn-deflate"
                        class="internalDFN" data-link-type="dfn" id="ref-for-dfn-deflate-11">deflate</a> 压缩，滑动窗口最大 32768
                    字节）。所有符合规范的 PNG 图像均应使用该方案进行压缩。</p>

                <p>滤波方法是一个单字节整数，指示在压缩前应用于<a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-image-data-9">图像数据</a>的预处理方法。本规范仅定义 <a href="#3filter" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3filter-11">滤波方法</a> 0（包含五种基本滤波类型的自适应滤波）。详见 <a href="#9Filters"
                        class="sec-ref"><bdi class="secno">9. </bdi>滤波</a>。</p>

                <p>隔行方法是一个单字节整数，指示<a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-image-data-10">图像数据</a>的传输顺序。本规范定义了两个取值：0（不隔行）与 1（Adam7 隔行）。详见 <a
                        href="#8Interlace" class="sec-ref"><bdi class="secno">8. </bdi>隔行与通道提取</a>。</p>
            </section>


            <section id="11PLTE">
                <div class="header-wrapper">
                    <h4 id="x11-2-2-plte-palette"><bdi class="secno">11.2.2 </bdi><span class="chunk">PLTE</span>
                        调色板</h4><a class="self-link" href="#11PLTE" aria-label="Permalink for Section 11.2.2"></a>
                </div>


                <p>四字节的块类型字段包含以下十六进制值：</p>

                <pre aria-busy="false"><code class="hljs">50 4C 54 45</code></pre>
                <p><span class="chunk">PLTE</span> 块包含 1 到 256 个调色板条目，每个条目为以下三字节序列：</p>

                <table id="PLTE-structure" class="simple numbered">
                    <tbody>
                        <tr>
                            <td>红</td>
                            <td>1 字节</td>
                        </tr>

                        <tr>
                            <td>绿</td>
                            <td>1 字节</td>
                        </tr>

                        <tr>
                            <td>蓝</td>
                            <td>1 字节</td>
                        </tr>
                    </tbody>
                </table>

                <p>条目数量由块长度决定。块长度若不能被 3 整除则为错误。</p>

                <p>对于<a href="#3colourType" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3colourType-14">颜色类型</a> 3，本块必须出现；对于<a href="#3colourType" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3colourType-15">颜色类型</a> 2 和 6，本块可以出现；对于<a href="#3colourType"
                        class="internalDFN" data-link-type="dfn" id="ref-for-3colourType-16">颜色类型</a> 0 和
                    4，本块不得出现。不得存在多于一个的 <span class="chunk">PLTE</span> 块。</p>

                <p>对于<a href="#3colourType" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3colourType-17">颜色类型</a> 3（索引色），<span class="chunk">PLTE</span> 块为必需。<span
                        class="chunk">PLTE</span> 中的第一个条目由像素值 0 引用，第二个由像素值 1 引用，依此类推。调色板条目的数量不得超过图像位深所能表示的范围（例如，位深为 4 时为
                    2<sup>4</sup> = 16）。允许条目数量少于位深所允许的最大数量。在这种情况下，若在<a href="#dfn-image-data" class="internalDFN"
                        data-link-type="dfn" id="ref-for-dfn-image-data-11">图像数据</a>中发现超出范围的像素值，则为错误。
                </p>

                <p>对于<a href="#3colourType" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3colourType-18">颜色类型</a> 2 与 6（<a href="#3truecolour" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3truecolour-8">真彩色</a>与<a href="#dfn-truecolor-with-alpha"
                        class="internalDFN" data-link-type="dfn" id="ref-for-dfn-truecolor-with-alpha-3">真彩色（含
                        alpha）</a>），<span class="chunk">PLTE</span> 块是可选的。若存在，它提供一个建议的颜色集合（1 到 256 种），当图像无法直接显示时，可将 <a
                        href="#3truecolour" class="internalDFN" data-link-type="dfn"
                        id="ref-for-3truecolour-9">真彩色</a>图像量化到这些颜色。然而，建议使用 <a class="chunk" href="#11sPLT">sPLT</a>
                    块来实现该目的，而非 <span class="chunk">PLTE</span> 块。若既无 <span class="chunk">PLTE</span> 块也无 <a
                        class="chunk" href="#11sPLT">sPLT</a> 块且图像无法直接显示，则量化需由查看系统完成。然而，通常更可取的是由 PNG 编码器一次性完成颜色选择。（见 <a
                        href="#12Suggested-palettes" class="sec-ref"><bdi class="secno">12.5 </bdi>建议调色板</a>。）</p>

                <p>请注意，调色板每个采样使用 8 位（1 字节），与图像位深无关。尤其是，即使它是对 16 位<a href="#3truecolour" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3truecolour-10">真彩色</a>图像的建议量化，调色板本身仍为 8 位深。</p>

                <p>图像并不要求必须使用所有调色板条目，也不要求所有条目互不相同。</p>
            </section>


            <section id="11IDAT">
                <div class="header-wrapper">
                    <h4 id="x11-2-3-idat-image-data"><bdi class="secno">11.2.3 </bdi><span class="chunk">IDAT</span>
                        图像数据</h4><a class="self-link" href="#11IDAT" aria-label="Permalink for Section 11.2.3"></a>
                </div>


                <p>四字节的块类型字段包含以下十六进制值：</p>

                <pre aria-busy="false"><code class="hljs">49 44 41 54</code></pre>
                <p><span class="chunk">IDAT</span> 块包含实际的<a href="#dfn-image-data" class="internalDFN"
                        data-link-type="dfn" id="ref-for-dfn-image-data-12">图像数据</a>，即压缩算法的输出流。详见 <a href="#9Filters"
                        class="sec-ref"><bdi class="secno">9.
                        </bdi>滤波</a>与 <a href="#10Compression" class="sec-ref"><bdi class="secno">10.
                        </bdi>压缩</a>。</p>

                <p>可以存在多个 <span class="chunk">IDAT</span> 块；若存在，必须连续出现，中间不得夹杂其他块。压缩数据流即为所有 <span
                        class="chunk">IDAT</span> 块数据字段内容的串联
                    （注意数据字段<a href="#zero-length-data">可能为零长度</a>）。
                </p>

                <p>某些图像在最后一个 IDAT
                    块的末尾存在未使用的尾随字节。这可能发生在存储了整个缓冲区而非仅使用部分缓冲区的情况下。这是不理想的。更可取的是，编码器不包含这些未使用的字节；若必须包含，将这些字节置零可避免意外的数据泄露。解码器应忽略这些尾随字节。
                </p>
            </section>


            <section id="11IEND">
                <div class="header-wrapper">
                    <h4 id="x11-2-4-iend-image-trailer"><bdi class="secno">11.2.4 </bdi><span class="chunk">IEND</span>
                        图像结尾</h4><a class="self-link" href="#11IEND" aria-label="Permalink for Section 11.2.4"></a>
                </div>


                <p>四字节的块类型字段包含以下十六进制值：</p>

                <pre aria-busy="false"><code class="hljs">49 45 4E 44</code></pre>
                <p><span class="chunk">IEND</span> 块标记 PNG 数据流的结束。该块的数据字段为空。</p>
            </section>
        </section>


        <section id="11Ancillary-chunks">
            <div class="header-wrapper">
                <h3 id="x11-3-ancillary-chunks"><bdi class="secno">11.3 </bdi>辅助块</h3><a class="self-link"
                    href="#11Ancillary-chunks" aria-label="Permalink for Section 11.3"></a>
            </div>



            <section class="introductory" id="11AcGen">
                <div class="header-wrapper">
                    <h3 id="introduction-6">简介</h3><a class="self-link" href="#11AcGen"
                        aria-label="Permalink for this Section"></a>
                </div>


                <p>本规范中定义的辅助块按<a href="#4Concepts.FormatTypes" class="sec-ref"><bdi class="secno">4.8.2
                        </bdi>块类型</a>的顺序列出。该顺序并非它们在 PNG 数据流中出现的顺序。解码器可以忽略辅助块。对每个辅助块而言，下述行为均假定解码器未忽略该块。</p>
            </section>


            <section id="11transinfo">
                <div class="header-wrapper">
                    <h4 id="x11-3-1-transparency-information"><bdi class="secno">11.3.1 </bdi>透明信息
                    </h4><a class="self-link" href="#11transinfo" aria-label="Permalink for Section 11.3.1"></a>
                </div>



                <section id="11tRNS">
                    <div class="header-wrapper">
                        <h5 id="x11-3-1-1-trns-transparency"><bdi class="secno">11.3.1.1 </bdi><span
                                class="chunk">tRNS</span> 透明度</h5><a class="self-link" href="#11tRNS"
                            aria-label="Permalink for Section 11.3.1.1"></a>
                    </div>


                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">74 52 4E 53</code></pre>
                    <p><span class="chunk">tRNS</span> 块为<a href="#3indexedColour" class="internalDFN"
                            data-link-type="dfn" id="ref-for-3indexedColour-13">索引色</a>图像指定与调色板条目关联的 alpha 值，或为<a
                            href="#dfn-greyscale" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-greyscale-7">灰度</a>与<a href="#3truecolour" class="internalDFN"
                            data-link-type="dfn" id="ref-for-3truecolour-11">真彩色</a>图像指定单一透明颜色。<span
                            class="chunk">tRNS</span> 块包含：</p>


                    <table id="tRNS-structure" class="simple numbered">
                        <tbody>
                            <tr>
                                <th colspan="2">
                                    <a href="#3colourType" class="internalDFN" data-link-type="dfn"
                                        id="ref-for-3colourType-19">颜色类型</a> 0
                                </th>
                            </tr>

                            <tr>
                                <td>灰度采样值</td>
                                <td>2 字节</td>
                            </tr>

                            <tr>
                                <th colspan="2">
                                    <a href="#3colourType" class="internalDFN" data-link-type="dfn"
                                        id="ref-for-3colourType-20">颜色类型</a> 2
                                </th>
                            </tr>

                            <tr>
                                <td>红色采样值</td>
                                <td>2 字节</td>
                            </tr>

                            <tr>
                                <td>绿色采样值</td>
                                <td>2 字节</td>
                            </tr>

                            <tr>
                                <td>蓝色采样值</td>
                                <td>2 字节</td>
                            </tr>

                            <tr>
                                <th colspan="2">
                                    <a href="#3colourType" class="internalDFN" data-link-type="dfn"
                                        id="ref-for-3colourType-21">颜色类型</a> 3
                                </th>
                            </tr>

                            <tr>
                                <td>调色板索引 0 的 Alpha</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>调色板索引 1 的 Alpha</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>……等等……</td>
                                <td>1 字节</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>对于<a href="#3colourType" class="internalDFN" data-link-type="dfn"
                            id="ref-for-3colourType-22">颜色类型</a> 3（索引色），<span class="chunk">tRNS</span> 块包含一系列与 <a
                            class="chunk" href="#11PLTE">PLTE</a> 块条目一一对应的单字节 alpha 值。每个条目表明对应调色板索引的像素应被视为具有指定的 alpha
                        值。Alpha 值与 8 位完整 alpha 通道的解释相同：0 为完全透明，255 为完全不透明，与图像位深无关。<span class="chunk">tRNS</span> 块所含
                        alpha 值数量不得多于调色板条目数，但可以少于调色板条目数。此时，所有其余调色板条目的 alpha 值视为 255。常见情况下仅需将调色板索引 0 设为透明，则仅需一个单字节的 <span
                            class="chunk">tRNS</span> 块；若所有调色板索引均不透明，可省略 <span class="chunk">tRNS</span> 块。</p>

                    <p>对于<a href="#3colourType" class="internalDFN" data-link-type="dfn"
                            id="ref-for-3colourType-23">颜色类型</a> 0 或 2，每个采样均使用两个字节，不受图像位深影响（见<a
                            href="#7Integers-and-byte-order" class="sec-ref"><bdi class="secno">7.1
                            </bdi>整数与字节序</a>）。与指定灰度采样值或 RGB 采样值相同的像素视为透明（等同于 alpha 值 0）；所有其他像素视为完全不透明（alpha 值为
                        2<sup>bitdepth</sup>-1）。若图像位深小于 16，则使用最低有效位。编码器应将其他位设为 0，解码器在使用前必须将其他位掩蔽为 0。</p>

                    <p>对于<a href="#3colourType" class="internalDFN" data-link-type="dfn"
                            id="ref-for-3colourType-24">颜色类型</a> 4 与 6，不得出现 <span class="chunk">tRNS</span> 块，因为已存在完整的
                        alpha 通道。</p>

                    <div class="note" role="note" id="issue-container-generatedID-10">
                        <div role="heading" class="note-title marker" id="h-note-10" aria-level="6"><span>注</span>
                        </div>
                        <p class="">注：对于 16 位 <a href="#dfn-greyscale" class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-greyscale-8">灰度</a> 或 <a href="#3truecolour" class="internalDFN"
                                data-link-type="dfn" id="ref-for-3truecolour-12">真彩色</a> 数据，
                            如 <a href="#13Sample-depth-rescaling" class="sec-ref"><bdi class="secno">13.12
                                </bdi>样本深度重缩放</a> 所述，
                            只有 <a href="#tRNS-compare-exactly">与完整 16 位值相匹配的像素</a> 在 <span class="chunk">tRNS</span>
                            块中被视为透明。解码器必须在对像素进行透明性检测之后再进行任何样本深度重缩放。
                        </p>
                    </div>
                </section>
            </section>


            <section id="11addnlcolinfo">
                <div class="header-wrapper">
                    <h4 id="x11-3-2-color-space-information"><bdi class="secno">11.3.2 </bdi>色彩空间信息
                    </h4><a class="self-link" href="#11addnlcolinfo" aria-label="Permalink for Section 11.3.2"></a>
                </div>



                <section id="11cHRM">
                    <div class="header-wrapper">
                        <h5 id="x11-3-2-1-chrm-primary-chromaticities-and-white-point"><bdi class="secno">11.3.2.1
                            </bdi><span class="chunk">cHRM</span> 主色度与白点</h5><a class="self-link" href="#11cHRM"
                            aria-label="Permalink for Section 11.3.2.1"></a>
                    </div>



                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">63 48 52 4D</code></pre>
                    <p><span class="chunk">cHRM</span> 块可用于指定<a href="#3PNGimage" class="internalDFN"
                            data-link-type="dfn" id="ref-for-3PNGimage-3">PNG 图像</a>所用显示设备的红、绿、蓝三基色的 1931 CIE <i>x,y</i>
                        色度，以及参考<a href="#dfn-white-point" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-white-point-2">白点</a>。更多信息见<a href="#C-GammaAppendix" class="sec-ref"><bdi
                                class="secno">C. </bdi>伽玛与色度</a>。<a class="chunk" href="#11iCCP">iCCP</a> 与 <a
                            class="chunk" href="#11sRGB">sRGB</a> 块为色彩管理与控制提供了更完善的支持。</p>

                    <p><span class="chunk">cHRM</span> 块包含：</p>



                    <table id="cHRM-structure" class="numbered simple">
                        <caption><a class="self-link" href="#cHRM-structure">Table <bdi class="tableno">13</bdi></a>
                            <span class="table-title">
                                cHRM 块组成
                            </span>
                        </caption>

                        <tbody>
                            <tr>
                                <th>名称</th>
                                <th>大小</th>
                            </tr>

                            <tr>
                                <td>白点 x</td>
                                <td>4 字节</td>
                            </tr>

                            <tr>
                                <td>白点 y</td>
                                <td>4 字节</td>
                            </tr>

                            <tr>
                                <td>红色 x</td>
                                <td>4 字节</td>
                            </tr>

                            <tr>
                                <td>红色 y</td>
                                <td>4 字节</td>
                            </tr>

                            <tr>
                                <td>绿色 x</td>
                                <td>4 字节</td>
                            </tr>

                            <tr>
                                <td>绿色 y</td>
                                <td>4 字节</td>
                            </tr>

                            <tr>
                                <td>蓝色 x</td>
                                <td>4 字节</td>
                            </tr>

                            <tr>
                                <td>蓝色 y</td>
                                <td>4 字节</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>每个值以<a href="#dfn-png-four-byte-unsigned-integer" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-png-four-byte-unsigned-integer-4">PNG 四字节无符号整数</a>编码，表示 <i>x</i> 或 <i>y</i>
                        值乘以 100000。</p>

                    <p class="example">值 0.3127 将存储为整数 31270。</p>

                    <p><span class="chunk">cHRM</span> 块允许出现在所有 PNG 数据流中，尽管对<a href="#dfn-greyscale" class="internalDFN"
                            data-link-type="dfn" id="ref-for-dfn-greyscale-9">灰度</a>图像意义较小。</p>

                    <p>除非该块是解码器所理解的<a href="#color-chunk-precendence">优先级最高的颜色块</a>，否则应忽略本块。</p>
                </section>


                <section id="11gAMA">
                    <div class="header-wrapper">
                        <h5 id="x11-3-2-2-gama-image-gamma"><bdi class="secno">11.3.2.2 </bdi><span
                                class="chunk">gAMA</span> 图像伽玛</h5><a class="self-link" href="#11gAMA"
                            aria-label="Permalink for Section 11.3.2.2"></a>
                    </div>



                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">67 41 4D 41</code></pre>
                    <p><a class="chunk" href="#11gAMA">gAMA</a> 块指定<a href="#dfn-gamma-value" class="internalDFN"
                            data-link-type="dfn" id="ref-for-dfn-gamma-value-3">伽玛值</a>。</p>

                    <p>实际上，仅指定期望的显示输出强度是不够的，还需要指定期望输出所对应的观看条件。对于 <span class="chunk">gAMA</span>，参考观看条件为 sRGB 规范
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-srgb"
                                title="Multimedia systems and equipment - Colour measurement and management - Part 2-1: Colour management - Default RGB colour space - sRGB">SRGB</a></cite>]
                        的参考观看条件。对不同观看条件的调整通常由色彩管理系统处理。若未进行调整，误差通常很小。需要高保真色彩的应用可考虑使用 <a class="chunk"
                            href="#11sRGB">sRGB</a>、<a class="chunk" href="#11iCCP">iCCP</a> 块。</p>

                    <p><span class="chunk">gAMA</span> 块包含：</p>

                    <table id="gAMA-structure" class="simple numbered">
                        <tbody>
                            <tr>
                                <td>图像伽玛</td>
                                <td>4 字节</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>该值以<a href="#dfn-png-four-byte-unsigned-integer" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-png-four-byte-unsigned-integer-5">PNG 四字节无符号整数</a>编码，表示<a
                            href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-gamma-value-4">伽玛值</a>乘以 100000。</p>

                    <p class="example">伽玛值 1/2.2 将存储为整数 45455。</p>

                    <p>更多信息见<a href="#12Encoder-gamma-handling" class="sec-ref"><bdi class="secno">12.1
                            </bdi>编码器伽玛处理</a>与<a href="#13Decoder-gamma-handling" class="sec-ref"><bdi
                                class="secno">13.13 </bdi>解码器伽玛处理</a>。</p>

                    <p>除非该块是解码器所理解的<a href="#color-chunk-precendence">优先级最高的颜色块</a>，否则应忽略本块。</p>
                </section>


                <section id="11iCCP">
                    <div class="header-wrapper">
                        <h5 id="x11-3-2-3-iccp-embedded-icc-profile"><bdi class="secno">11.3.2.3 </bdi><span
                                class="chunk">iCCP</span> 内嵌 ICC 配置文件</h5><a class="self-link" href="#11iCCP"
                            aria-label="Permalink for Section 11.3.2.3"></a>
                    </div>



                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">69 43 43 50</code></pre>
                    <p><span class="chunk">iCCP</span> 块包含：</p>

                    <table id="iCCP-structure" class="simple numbered">
                        <tbody>
                            <tr>
                                <td>配置文件名称</td>
                                <td>1-79 字节（字符串）</td>
                            </tr>

                            <tr>
                                <td>空字符分隔符</td>
                                <td>1 字节（空字符）</td>
                            </tr>

                            <tr>
                                <td>压缩方法</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>压缩的配置文件数据</td>
                                <td>n 字节</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>配置文件名称可以是用于引用该配置文件的任意便捷名称，区分大小写。名称只能包含可打印的 Latin-1 字符与空格（仅允许码位 0x20-7E 与
                        0xA1-FF）。不允许前导、尾随及连续空格。本规范仅定义压缩方法 0（<a href="#dfn-zlib" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-zlib-14">zlib</a> 数据流，使用 <a href="#dfn-deflate" class="internalDFN"
                            data-link-type="dfn" id="ref-for-dfn-deflate-12">deflate</a> 压缩，见<a
                            href="#10CompressionOtherUses" class="sec-ref"><bdi class="secno">10.3
                            </bdi>压缩的其他用法</a>）。压缩方法条目之后是占据块剩余部分的压缩配置文件数据。解压该数据流可得到内嵌的 ICC 配置文件。</p>

                    <p>若存在 <span class="chunk">iCCP</span> 块，则图像采样符合国际色彩联盟 [<cite><a class="bibref"
                                data-link-type="biblio" href="#bib-icc"
                                title="ICC.1:2022 (Profile version 4.4.0.0)">ICC</a></cite>][<cite><a class="bibref"
                                data-link-type="biblio" href="#bib-iso_15076-1"
                                title="ISO 15076-1:2010 Image technology colour management — Architecture, profile format and data structure — Part 1: Based on ICC.1:2010">ISO_15076-1</a></cite>]
                        定义的内嵌 ICC 配置文件所表示的色彩空间。ICC 配置文件的色彩空间对于彩色图像（<a href="#3colourType" class="internalDFN"
                            data-link-type="dfn" id="ref-for-3colourType-25">颜色类型</a> 2、3、6）应为 RGB 色彩空间；对于<a
                            href="#dfn-greyscale" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-greyscale-10">灰度</a>图像（<a href="#3colourType" class="internalDFN"
                            data-link-type="dfn" id="ref-for-3colourType-26">颜色类型</a> 0、4）应为灰度色彩空间。建议写入 <span
                            class="chunk">iCCP</span> 块的 PNG 编码器同时写入可近似 ICC 配置文件的 <a class="chunk"
                            href="#11gAMA">gAMA</a> 与 <a class="chunk" href="#11cHRM">cHRM</a> 块，以便兼容不使用 <span
                            class="chunk">iCCP</span> 块的应用。</p>

                    <p>
                        除非该块是解码器所理解的<a href="#color-chunk-precendence">优先级最高的颜色块</a>，否则应忽略本块。
                    </p>

                    <p>除非存在 <a class="chunk" href="#cICP-chunk">cICP</a> 块，PNG 数据流中至多应包含一个内嵌配置文件，可通过 <span
                            class="chunk">iCCP</span> 显式指定，或通过 <a class="chunk"
                            href="#srgb-standard-colour-space">sRGB</a> 块隐式指定。</p>
                </section>


                <section id="11sBIT">
                    <div class="header-wrapper">
                        <h5 id="x11-3-2-4-sbit-significant-bits"><bdi class="secno">11.3.2.4 </bdi><span
                                class="chunk">sBIT</span> 有效位</h5><a class="self-link" href="#11sBIT"
                            aria-label="Permalink for Section 11.3.2.4"></a>
                    </div>



                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">73 42 49 54</code></pre>
                    <p>为简化解码器，PNG 规定仅可使用某些采样深度，并进一步规定采样值应缩放至该采样深度下可能值的全范围。<span class="chunk">sBIT</span>
                        块定义原始的有效位数（可小于或等于采样深度）。这使得即使数据的采样深度并非 PNG 直接支持，PNG 解码器也能无损恢复原始数据。</p>

                    <p><span class="chunk">sBIT</span> 块包含：</p>



                    <table id="sBIT-structure" class="numbered simple">
                        <caption><a class="self-link" href="#sBIT-structure">Table <bdi class="tableno">14</bdi></a>
                            <span class="table-title">
                                sBIT 块内容
                            </span>
                        </caption>

                        <tbody>
                            <tr>
                                <th colspan="2">颜色类型 0</th>
                            </tr>

                            <tr>
                                <td>灰度有效位数</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <th colspan="2">颜色类型 2 与 3</th>
                            </tr>

                            <tr>
                                <td>红色有效位数</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>绿色有效位数</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>蓝色有效位数</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <th colspan="2">颜色类型 4</th>
                            </tr>

                            <tr>
                                <td>灰度有效位数</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>Alpha 有效位数</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <th colspan="2">颜色类型 6</th>
                            </tr>

                            <tr>
                                <td>红色有效位数</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>绿色有效位数</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>蓝色有效位数</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>Alpha 有效位数</td>
                                <td>1 字节</td>
                            </tr>
                        </tbody>
                    </table>

                    <p><span class="chunk">sBIT</span> 中指定的每个位数应大于 0 且不大于采样深度（索引色图像的采样深度为 8，其他<a href="#3colourType"
                            class="internalDFN" data-link-type="dfn" id="ref-for-3colourType-27">颜色类型</a>的采样深度为 <a
                            class="chunk" href="#11IHDR">IHDR</a> 中给定的位深）。注意，<span class="chunk">sBIT</span> 不会为由 <a
                            class="chunk" href="#11tRNS">tRNS</a> 块隐含的 alpha 通道提供采样深度；此种情况下，alpha 通道的所有采样位均应视为有效。若不存在
                        <span class="chunk">sBIT</span> 块，则所有通道的全部采样位均应视为有效。
                    </p>
                </section>


                <section id="11sRGB">
                    <div class="header-wrapper">
                        <h5 id="srgb-standard-colour-space"><bdi class="secno">11.3.2.5 </bdi><span
                                class="chunk">sRGB</span> 标准 RGB 色彩空间</h5><a class="self-link"
                            href="#srgb-standard-colour-space" aria-label="Permalink for Section 11.3.2.5"></a>
                    </div>



                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">73 52 47 42</code></pre>
                    <p>若存在 <span class="chunk">sRGB</span> 块，则图像采样符合 sRGB 色彩空间 [<cite><a class="bibref"
                                data-link-type="biblio" href="#bib-srgb"
                                title="Multimedia systems and equipment - Colour measurement and management - Part 2-1: Colour management - Default RGB colour space - sRGB">SRGB</a></cite>]，并应使用国际色彩联盟
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-icc"
                                title="ICC.1:2022 (Profile version 4.4.0.0)">ICC</a></cite>] 或 [<cite><a class="bibref"
                                data-link-type="biblio" href="#bib-icc-2"
                                title="Specification ICC.2:2019 (Profile version 5.0.0 - iccMAX)">ICC-2</a></cite>]
                        定义的指定渲染意图进行显示。</p>

                    <p><span class="chunk">sRGB</span> 块包含：</p>

                    <table id="sRGB-structure" class="numbered simple">
                        <caption><a class="self-link" href="#sRGB-structure">Table <bdi class="tableno">15</bdi></a>
                            <span class="table-title">
                                sRGB 块内容
                            </span>
                        </caption>

                        <tbody>
                            <tr>
                                <th>名称</th>
                                <th>大小</th>
                            </tr>

                            <tr>
                                <td>渲染意图</td>
                                <td>1 字节</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>渲染意图的取值定义如下：</p>

                    <table id="rendering-intent-structure" class="numbered simple">
                        <caption><a class="self-link" href="#rendering-intent-structure">Table <bdi
                                    class="tableno">16</bdi></a> <span class="table-title">
                                渲染意图取值
                            </span></caption>

                        <tbody>
                            <tr>
                                <th>值</th>
                                <th>名称</th>
                                <th>说明</th>
                            </tr>

                            <tr>
                                <td>0</td>
                                <td>感知（Perceptual）</td>
                                <td>适用于偏好良好适配输出设备色域、而牺牲比色精度的图像，如照片。</td>
                            </tr>

                            <tr>
                                <td>1</td>
                                <td>相对比色（Relative colorimetric）</td>
                                <td>
                                    适用于要求匹配色外观（相对于输出设备<a href="#dfn-white-point" class="internalDFN"
                                        data-link-type="dfn" id="ref-for-dfn-white-point-3">白点</a>）的图像，如标志。
                                </td>
                            </tr>

                            <tr>
                                <td>2</td>
                                <td>饱和（Saturation）</td>
                                <td>适用于偏好保持饱和度、而牺牲色相与明度的图像，如图表与曲线图。</td>
                            </tr>

                            <tr>
                                <td>3</td>
                                <td>绝对比色（Absolute colorimetric）</td>
                                <td>适用于要求保持绝对比色的图像，如为其他输出设备（打样）生成的预览。</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>建议写入 <span class="chunk">sRGB</span> 块的 PNG 编码器同时写入 <a class="chunk" href="#11gAMA">gAMA</a>
                        块（可选再写入 <a class="chunk" href="#11cHRM">cHRM</a> 块），以兼容不使用 <span class="chunk">sRGB</span>
                        块的解码器。仅应使用下列取值。</p>

                    <table id="sRGB-gAMA-cHRM" class="numbered simple">
                        <caption><a class="self-link" href="#sRGB-gAMA-cHRM">Table <bdi class="tableno">17</bdi></a>
                            <span class="table-title">
                                sRGB 的 gAMA 与 cHRM 取值
                            </span>
                        </caption>

                        <tbody>
                            <tr>
                                <th colspan="2">gAMA</th>
                            </tr>

                            <tr>
                                <td>Gamma</td>
                                <td>45455</td>
                            </tr>

                            <tr>
                                <th colspan="2">cHRM</th>
                            </tr>

                            <tr>
                                <td>白点 x</td>
                                <td>31270</td>
                            </tr>

                            <tr>
                                <td>白点 y</td>
                                <td>32900</td>
                            </tr>

                            <tr>
                                <td>红色 x</td>
                                <td>64000</td>
                            </tr>

                            <tr>
                                <td>红色 y</td>
                                <td>33000</td>
                            </tr>

                            <tr>
                                <td>绿色 x</td>
                                <td>30000</td>
                            </tr>

                            <tr>
                                <td>绿色 y</td>
                                <td>60000</td>
                            </tr>

                            <tr>
                                <td>蓝色 x</td>
                                <td>15000</td>
                            </tr>

                            <tr>
                                <td>蓝色 y</td>
                                <td>6000</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>
                        除非该块是解码器所理解的<a href="#color-chunk-precendence">优先级最高的颜色块</a>，否则应忽略本块。
                    </p>

                    <p>建议 PNG 数据流中不要同时出现 <a class="chunk" href="#11sRGB">sRGB</a> 与 <a class="chunk"
                            href="#11iCCP">iCCP</a> 块。</p>
                </section>


                <section id="cICP-chunk">
                    <div class="header-wrapper">
                        <h5 id="x11-3-2-6-cicp-coding-independent-code-points-for-video-signal-type-identification"><bdi
                                class="secno">11.3.2.6 </bdi><span class="chunk">cICP</span> 视频信号类型标识的编码无关代码点</h5><a
                            class="self-link" href="#cICP-chunk" aria-label="Permalink for Section 11.3.2.6"></a>
                    </div>



                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">63 49 43 50</code></pre>
                    <p>若存在，<span class="chunk">cICP</span> 块使用 [<cite><a class="bibref" data-link-type="biblio"
                                href="#bib-itu-t-h.273"
                                title="ITU-T H.273, SERIES H: AUDIOVISUAL AND MULTIMEDIA SYSTEMS Infrastructure of audiovisual services – Coding of moving video. Coding-independent code points for video signal type identification">ITU-T-H.273</a></cite>]
                        中的代码点指定图像的色彩空间（主色），传递函数、矩阵系数与缩放因子。处理图像时（包括解码或渲染）<em class="rfc2119">应（SHOULD）</em>使用该视频格式信令。</p>

                    <p>cICP 块由四个 1 字节无符号整数组成，用以标识上述特性。</p>

                    <p>下表给出了 <span class="chunk">cICP</span> 块的语法：</p>

                    <table id="cICP-chunk-syntax" class="numbered simple">
                        <caption><a class="self-link" href="#cICP-chunk-syntax">Table <bdi class="tableno">18</bdi></a>
                            <span class="table-title">
                                cICP 块组成
                            </span>
                        </caption>

                        <tbody>
                            <tr>
                                <th>名称</th>
                                <th>大小</th>
                            </tr>

                            <tr>
                                <td>色度学原色（Color Primaries）</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>传递函数（Transfer Function）</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>矩阵系数（Matrix Coefficients）</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>视频全范围标志（Video Full Range Flag）</td>
                                <td>1 字节</td>
                            </tr>
                        </tbody>
                    </table>

                    <p><span class="chunk">cICP</span> 块的每个字段均对应于 [<cite><a class="bibref" data-link-type="biblio"
                                href="#bib-itu-t-h.273"
                                title="ITU-T H.273, SERIES H: AUDIOVISUAL AND MULTIMEDIA SYSTEMS Infrastructure of audiovisual services – Coding of moving video. Coding-independent code points for video signal type identification">ITU-T-H.273</a></cite>]
                        中同名参数。</p>

                    <p>PNG 当前仅支持 RGB 颜色模型，因此<code>Matrix Coefficients</code> 应设置为 <code>0</code>。</p>

                    <div class="note" role="note" id="issue-container-generatedID-11">
                        <div role="heading" class="note-title marker" id="h-note-11" aria-level="6"><span>注</span>
                        </div>
                        <aside class="">
                            若 <code>Video Full Range Flag</code> 值为 <code>1</code>，则图像为<a href="#dfn-full-range-image"
                                class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-full-range-image-1">全范围图像</a>。通常，RGB 颜色表示的图像使用全范围信号量化，因此包括传统 PNG
                            工作流在内的绝大多数计算机图形与网页图像都是<a href="#dfn-full-range-image" class="internalDFN"
                                data-link-type="dfn" id="ref-for-dfn-full-range-image-2">全范围图像</a>。若
                            <code>Video Full Range Flag</code> 值为 <code>0</code>，则图像为<a href="#dfn-narrow-range-image"
                                class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-narrow-range-image-1">窄范围图像</a>。窄范围图像常见于视频工作流，在该场景下参考黑（0%
                            信号电平）以下或标称峰值（100% 信号电平）以上存在采样值。例如，[<cite><a class="bibref" data-link-type="biblio"
                                    href="#bib-itu-r-bt.709"
                                    title="ITU-R BT.709, SERIES BT: BROADCASTING SERVICE (TELEVISION). Parameter values for the HDTV standards for production and international programme exchange">ITU-R-BT.709</a></cite>]
                            规定 10 位编码时参考黑（黑电平）对应码值为 64，标称峰值对应码值为
                            940。在窄范围中，为保留由滤波/压缩或不可控光照引起的处理伪影而不裁剪，定义了低于参考黑与高于标称峰值的瞬时越界（过冲与欠冲）。这可在后续处理与压缩阶段提升图像质量。欠冲/过冲也被用于保留额外的色彩体积（亮度与色度），详见
                            [<cite><a class="bibref" data-link-type="biblio" href="#bib-ebu-r-103"
                                    title="Video Signal Tolerance in Digital Television Systems">EBU-R-103</a></cite>]。
                            [<cite><a class="bibref" data-link-type="biblio" href="#bib-smpte-rp-2077"
                                    title="Full-Range Image Mapping">SMPTE-RP-2077</a></cite>] 更详细描述了全范围，并给出了从<a
                                href="#dfn-full-range-image" class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-full-range-image-3">全范围图像</a>到<a href="#dfn-narrow-range-image"
                                class="internalDFN" data-link-type="dfn"
                                id="ref-for-dfn-narrow-range-image-2">窄范围图像</a>的映射，以及用于 SDI（基带）传输的保护码值。
                        </aside>
                    </div>

                    <p>若 <code>Video Full Range Flag</code> 为 <code>0</code>（<a href="#dfn-narrow-range-image"
                            class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-narrow-range-image-3">窄范围图像</a>），建议将诸如<a href="#dfn-eotf"
                            class="internalDFN" data-link-type="dfn" id="ref-for-dfn-eotf-1"><abbr
                                title="Electro-Optical Transfer Function">EOTF</abbr></a> 或逆<a href="#dfn-oetf"
                            class="internalDFN" data-link-type="dfn" id="ref-for-dfn-oetf-1"><abbr
                                title="Opto-Electrical Transfer Function">OETF</abbr></a> 等传递函数定义在扩展范围上，以包含负值。方法如下：</p>

                    <pre
                        aria-busy="false"><code class="hljs abnf"><span class="hljs-attribute">out</span> <span class="hljs-operator">=</span> sign(in) * TransferFunction(abs(in))</code></pre>

                    <p><span class="chunk">cICP</span> 块<em class="rfc2119">必须（MUST）</em>出现在 <a class="chunk"
                            href="#11PLTE">PLTE</a> 与 <a class="chunk" href="#11IDAT">IDAT</a> 块之前。</p>

                    <p>
                        若解码器能够理解该块，则该块为<a href="#color-chunk-precendence">优先级最高的颜色块</a>。
                    </p>


                    <aside class="example" id="ex-cICP-BT.2100-PQ-full">
                        <div class="marker">
                            <a class="self-link" href="#ex-cICP-BT.2100-PQ-full">示例<bdi> 1</bdi></a>
                        </div>
                        使用 [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-r-bt.2100"
                                title="ITU-R BT.2100, SERIES BT: BROADCASTING SERVICE (TELEVISION). Image parameter values for high dynamic range television for use in production and international programme exchange">ITU-R-BT.2100</a></cite>]
                        指定的色度与
                        <a href="#dfn-pq" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-pq-2">PQ</a> <a
                            href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-transfer-function-8">传递函数</a>的<a href="#dfn-full-range-image"
                            class="internalDFN" data-link-type="dfn" id="ref-for-dfn-full-range-image-4">全范围图像</a>的
                        <span class="chunk">cICP</span> 字段值：

                        <pre aria-busy="false"><code class="hljs">09 10 00 01</code></pre>
                        <p>（四个 1 字节无符号整数，十六进制）</p>
                    </aside>

                    <aside class="example" id="ex-cICP-BT.2100-HLG-full">
                        <div class="marker">
                            <a class="self-link" href="#ex-cICP-BT.2100-HLG-full">示例<bdi> 2</bdi></a>
                        </div>
                        使用 [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-r-bt.2100"
                                title="ITU-R BT.2100, SERIES BT: BROADCASTING SERVICE (TELEVISION). Image parameter values for high dynamic range television for use in production and international programme exchange">ITU-R-BT.2100</a></cite>]
                        指定的色度与
                        <a href="#dfn-hlg" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hlg-2">HLG</a> <a
                            href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-transfer-function-9">传递函数</a>的<a href="#dfn-full-range-image"
                            class="internalDFN" data-link-type="dfn" id="ref-for-dfn-full-range-image-5">全范围图像</a>的
                        <span class="chunk">cICP</span> 字段值：

                        <pre aria-busy="false"><code class="hljs">09 12 00 01</code></pre>
                        <p>（四个 1 字节无符号整数，十六进制）</p>
                    </aside>

                    <aside class="example" id="ex-cICP-BT.709-narrow">
                        <div class="marker">
                            <a class="self-link" href="#ex-cICP-BT.709-narrow">示例<bdi> 3</bdi></a>
                        </div>
                        使用 [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-r-bt.709"
                                title="ITU-R BT.709, SERIES BT: BROADCASTING SERVICE (TELEVISION). Parameter values for the HDTV standards for production and international programme exchange">ITU-R-BT.709</a></cite>]
                        定义的色度与<a href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-transfer-function-10">传递函数</a>的<a href="#dfn-narrow-range-image"
                            class="internalDFN" data-link-type="dfn" id="ref-for-dfn-narrow-range-image-4">窄范围图像</a>的
                        <span class="chunk">cICP</span> 字段值：

                        <pre aria-busy="false"><code class="hljs">01 01 00 00</code></pre>
                        <p>（四个 1 字节无符号整数，十六进制）</p>
                    </aside>

                    <p id="display-p3">类似于使用
                        <a href="#srgb-standard-colour-space"><span class="chunk">sRGB</span></a> 块紧凑地标识 sRGB 图像，<span
                            class="chunk">cICP</span> 也可用于紧凑地标识 Display P3 图像 [<cite><a class="bibref"
                                data-link-type="biblio" href="#bib-display-p3"
                                title="Display P3">Display-P3</a></cite>]。
                    </p>

                    <aside class="example" id="ex-cICP-Display-P3-full">
                        <div class="marker">
                            <a class="self-link" href="#ex-cICP-Display-P3-full">示例<bdi> 4</bdi></a>
                        </div>
                        使用 [<cite><a class="bibref" data-link-type="biblio" href="#bib-display-p3"
                                title="Display P3">Display-P3</a></cite>] 定义的色度与<a href="#dfn-transfer-function"
                            class="internalDFN" data-link-type="dfn" id="ref-for-dfn-transfer-function-11">传递函数</a>的<a
                            href="#dfn-full-range-image" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-full-range-image-6">全范围图像</a>的 <span class="chunk">cICP</span> 字段值：

                        <pre aria-busy="false"><code class="hljs">0C 0D 00 01</code></pre>
                        <p>（四个 1 字节无符号整数，十六进制）</p>
                    </aside>

                </section>


                <section id="mDCV-chunk">
                    <div class="header-wrapper">
                        <h5 id="x11-3-2-7-mdcv-mastering-display-color-volume"><bdi class="secno">11.3.2.7 </bdi><span
                                class="chunk">mDCV</span> 母版显示色彩体积</h5><a class="self-link" href="#mDCV-chunk"
                            aria-label="Permalink for Section 11.3.2.7"></a>
                    </div>



                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">6D 44 43 56</code></pre>

                    <p>若存在，<span class="chunk">mDCV</span> 块表征内容创作阶段所使用的母版显示色彩体积（mDCV），其定义见 [<cite><a class="bibref"
                                data-link-type="biblio" href="#bib-smpte-st-2086"
                                title="Mastering Display Color Volume Metadata Supporting High Luminance and Wide Color Gamut Images">SMPTE-ST-2086</a></cite>]。mDCV
                        块提供具有参考意义的静态元数据，使目标（消费者）显示设备可基于其固有能力与原始母版显示能力的比较，潜在地优化其色调映射决策。</p>

                    <p>mDCV 通常与 <a href="#dfn-pq" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-pq-3">PQ</a>
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-r-bt.2100"
                                title="ITU-R BT.2100, SERIES BT: BROADCASTING SERVICE (TELEVISION). Image parameter values for high dynamic range television for use in production and international programme exchange">ITU-R-BT.2100</a></cite>]
                        传递函数及附加的 <a href="#cLLI-chunk">cLLI</a> 元数据配合使用，此配置通常称为
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-hdr10"
                                title="HDR10 Media Profile">HDR10</a></cite>]（PQ + ST 2086 静态元数据、MaxFALL 与 MaxCLL）。
                        <span class="chunk">mDCV</span> 块也可与 <a href="#dfn-hlg" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-hlg-3">HLG</a> [<cite><a class="bibref" data-link-type="biblio"
                                href="#bib-itu-r-bt.2100"
                                title="ITU-R BT.2100, SERIES BT: BROADCASTING SERVICE (TELEVISION). Image parameter values for high dynamic range television for use in production and international programme exchange">ITU-R-BT.2100</a></cite>]
                        以及 <a href="#dfn-sdr" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sdr-3">SDR</a>
                        图像格式（例如 [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-r-bt.709"
                                title="ITU-R BT.709, SERIES BT: BROADCASTING SERVICE (TELEVISION). Parameter values for the HDTV standards for production and international programme exchange">ITU-R-BT.709</a></cite>]）配合使用。
                    </p>

                    <p>由于 mDCV 最初作为补充的静态元数据，用于在视频显示目标上优化图像的色调映射，因此使用 mDCV 时必须配套 cICP 块，以明确图像内容的基本特性。色度学原色与白点特性可由 cICP
                        块格式推导。关于其在使用
                        HDR [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-r-bt.2100"
                                title="ITU-R BT.2100, SERIES BT: BROADCASTING SERVICE (TELEVISION). Image parameter values for high dynamic range television for use in production and international programme exchange">ITU-R-BT.2100</a></cite>]
                        与 SDR [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-r-bt.709"
                                title="ITU-R BT.709, SERIES BT: BROADCASTING SERVICE (TELEVISION). Parameter values for the HDTV standards for production and international programme exchange">ITU-R-BT.709</a></cite>]
                        图像时最常见的用例，见
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-t-series-h-supplement-19"
                                title="Series H: Audio Visual and Multimedia Systems - Usage of video signal type code points">ITU-T-Series-H-Supplement-19</a></cite>]。
                        基本（cICP）特性加上补充（mDCV）静态元数据，可为优化色调映射提供有价值的信息。</p>


                    <div class="note" role="note" id="issue-container-generatedID-12">
                        <div role="heading" class="note-title marker" id="h-note-12" aria-level="6"><span>注</span>
                        </div>
                        <p class=""><a href="https://github.com/w3c/png/issues/319">Issue #319</a> 讨论了存在 <span
                                class="chunk">mDCV</span> 块时的色调映射行为。</p>
                    </div>

                    <p>对于<a href="#dfn-sdr" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sdr-4">SDR</a> 图像，若
                        mDCV 显示的最小/最大亮度未知，默认特性可由 [<cite><a class="bibref" data-link-type="biblio"
                                href="#bib-itu-t-series-h-supplement-19"
                                title="Series H: Audio Visual and Multimedia Systems - Usage of video signal type code points">ITU-T-Series-H-Supplement-19</a></cite>]
                        表 11 的数值或相关<a href="#dfn-sdr" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-sdr-5">SDR</a> 规范推导。目前并无发布的、标准化的方法可将 SDR 图像信号从其默认观看条件（显示亮度与环境照明）转换为 mDCV
                        块所指示的条件。</p>

                    <div class="note" role="note" id="issue-container-generatedID-13">
                        <div role="heading" class="note-title marker" id="h-note-13" aria-level="6"><span>注</span>
                        </div>
                        <aside class="">
                            <a href="#dfn-hlg" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hlg-4">HLG</a>
                            [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-r-bt.2100"
                                    title="ITU-R BT.2100, SERIES BT: BROADCASTING SERVICE (TELEVISION). Image parameter values for high dynamic range television for use in production and international programme exchange">ITU-R-BT.2100</a></cite>]
                            图像格式确实发布了将图像在显示亮度（见 [<cite><a class="bibref" data-link-type="biblio"
                                    href="#bib-itu-r-bt.2100"
                                    title="ITU-R BT.2100, SERIES BT: BROADCASTING SERVICE (TELEVISION). Image parameter values for high dynamic range television for use in production and international programme exchange">ITU-R-BT.2100</a></cite>]
                            范围内）与环境照明（见配套报告 [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-r-bt.2390"
                                    title="High dynamic range television for production and international programme exchange">ITU-R-BT.2390</a></cite>]）变化时进行转换的方法。这些方法也可用于
                            SDR 图像。
                        </aside>
                    </div>

                    <p>下表给出了 <span class="chunk">mDCV</span> 块的语法：</p>

                    <table id="mDCV-chunk-syntax" class="numbered simple">
                        <caption><a class="self-link" href="#mDCV-chunk-syntax">Table <bdi class="tableno">19</bdi></a>
                            <span class="table-title">
                                mDCV 块组成
                            </span>
                        </caption>

                        <tbody>
                            <tr>
                                <th>名称</th>
                                <th>大小</th>
                                <th>除数</th>
                            </tr>

                            <tr>
                                <td>母版显示色度学原色（CIE 1931 <i>x,y</i> 的 R、G、B）</td>
                                <td>12 字节</td>
                                <td>0.00002</td>
                            </tr>

                            <tr>
                                <td>母版显示白点色度（CIE 1931 <i>x,y</i>）</td>
                                <td>4 字节</td>
                                <td>0.00002</td>
                            </tr>

                            <tr>
                                <td>母版显示最大亮度（cd/m<sup>2</sup>）</td>
                                <td>4 字节</td>
                                <td>0.0001</td>
                            </tr>

                            <tr>
                                <td>母版显示最小亮度（cd/m<sup>2</sup>）</td>
                                <td>4 字节</td>
                                <td>0.0001</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>色度学原色编码为三个成对的<a href="#dfn-png-two-byte-unsigned-integer" class="internalDFN"
                            data-link-type="dfn" id="ref-for-dfn-png-two-byte-unsigned-integer-1">PNG 两字节无符号整数</a>，顺序为
                        <em>x</em> 后 <em>y</em>，每个值表示对应原色的 x 或 y 色度值除以除数后的结果。排序从 x 色度最大的原色开始，其次为 y 色度最大的原色，最后为剩余的原色。对
                        RGB 色彩空间而言，这对应 R、G、B 的顺序。
                    </p>
                    <p>
                        白点编码为一对<a href="#dfn-png-two-byte-unsigned-integer" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-png-two-byte-unsigned-integer-2">PNG 两字节无符号整数</a>，顺序为 <em>x</em> 后
                        <em>y</em>，每个值表示白点 x 或 y 色度值除以除数后的结果。
                    </p>

                    <p>
                        最大与最小亮度编码为<a href="#dfn-png-four-byte-unsigned-integer" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-png-four-byte-unsigned-integer-6">PNG 四字节无符号整数</a>，表示以 cd/m<sup>2</sup>
                        为单位的绝对亮度值除以除数后的结果。
                    </p>

                    <p>除数用于将实际值映射为存储值。例如，原色与白点的无单位除数 0.00002 会将色度 (0.6800, 0.3200) 存储为 {34000, 16000}。</p>

                    <p><span class="chunk">mDCV</span> 块<em class="rfc2119">必须（MUST）</em>出现在 <a class="chunk"
                            href="#11PLTE">PLTE</a> 与 <a class="chunk" href="#11IDAT">IDAT</a> 块之前。</p>

                    <p>下面给出 [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-r-bt.2100"
                                title="ITU-R BT.2100, SERIES BT: BROADCASTING SERVICE (TELEVISION). Image parameter values for high dynamic range television for use in production and international programme exchange">ITU-R-BT.2100</a></cite>]
                        <a href="#dfn-hdr" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hdr-3">HDR</a> 的
                        mDCV 示例。
                    </p>

                    <aside class="example" id="example-5">
                        <div class="marker">
                            <a class="self-link" href="#example-5">示例<bdi> 5</bdi></a>
                        </div>
                        <span class="chunk">mDCV</span> 块在 <a href="#dfn-hdr" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-hdr-4">HDR</a>
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-r-bt.2100"
                                title="ITU-R BT.2100, SERIES BT: BROADCASTING SERVICE (TELEVISION). Image parameter values for high dynamic range television for use in production and international programme exchange">ITU-R-BT.2100</a></cite>]
                        中的母版显示色度学原色示例：
                        <table id="mDCV-chunk-hdr-primaries-example" class="numbered simple">
                            <tbody>
                                <tr>
                                    <th>名称</th>
                                    <th>实际值</th>
                                    <th>存储十进制值</th>
                                    <th>存储十六进制值</th>
                                </tr>

                                <tr>
                                    <td rowspan="3">[<cite><a class="bibref" data-link-type="biblio"
                                                href="#bib-itu-r-bt.2020"
                                                title="Parameter values for ultra-high definition television systems for production and international programme exchange">ITU-R-BT.2020</a></cite>]
                                        指定的色度学原色
                                    </td>
                                    <td>(0.708, 0.292)</td>
                                    <td>{ 35400, 14600 }</td>
                                    <td>{ 8A 48, 39 08 }</td>
                                </tr>

                                <tr>
                                    <td>(0.170, 0.797)</td>
                                    <td>{ 8500, 39850 }</td>
                                    <td>{ 21 34, 9B AA }</td>
                                </tr>

                                <tr>
                                    <td>(0.131, 0.046)</td>
                                    <td>{ 6550, 2300 }</td>
                                    <td>{ 19 96, 08 FC }</td>
                                </tr>
                            </tbody>
                        </table>
                    </aside>

                    <aside class="example" id="example-6">
                        <div class="marker">
                            <a class="self-link" href="#example-6">示例<bdi> 6</bdi></a>
                        </div>
                        <span class="chunk">mDCV</span> 块在 <a href="#dfn-hdr" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-hdr-5">HDR</a>
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-r-bt.2100"
                                title="ITU-R BT.2100, SERIES BT: BROADCASTING SERVICE (TELEVISION). Image parameter values for high dynamic range television for use in production and international programme exchange">ITU-R-BT.2100</a></cite>]
                        中的母版显示白点示例：

                        <table id="mDCV-chunk-hdr-white-point-example" class="numbered simple">
                            <tbody>
                                <tr>
                                    <th>名称</th>
                                    <th>实际值</th>
                                    <th>存储十进制值</th>
                                    <th>存储十六进制值</th>
                                </tr>

                                <tr>
                                    <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-smpte-rp-177"
                                                title="Derivation of Basic Television Color Equations">SMPTE-RP-177</a></cite>]
                                        指定的 D65 光源
                                    </td>
                                    <td>(0.3127, 0.3290)</td>
                                    <td>{ 15635, 16450 }</td>
                                    <td>{ 3C 05, 40 42 }</td>
                                </tr>
                            </tbody>
                        </table>
                    </aside>

                    <aside class="example" id="example-7">
                        <div class="marker">
                            <a class="self-link" href="#example-7">示例<bdi> 7</bdi></a>
                        </div>

                        <span class="chunk">mDCV</span> 块在 <a href="#dfn-hdr" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-hdr-6">HDR</a>
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-r-bt.2100"
                                title="ITU-R BT.2100, SERIES BT: BROADCASTING SERVICE (TELEVISION). Image parameter values for high dynamic range television for use in production and international programme exchange">ITU-R-BT.2100</a></cite>]
                        中的母版显示最大亮度示例：

                        <table id="mDCV-chunk-hdr-max-luminance-example" class="numbered simple">
                            <tbody>
                                <tr>
                                    <th>实际值</th>
                                    <th>存储十进制值</th>
                                    <th>存储十六进制值</th>
                                </tr>

                                <tr>
                                    <td>4000 cd/m<sup>2</sup></td>
                                    <td>40000000</td>
                                    <td>02 62 5A 00</td>
                                </tr>
                            </tbody>
                        </table>
                    </aside>

                    <aside class="example" id="example-8">
                        <div class="marker">
                            <a class="self-link" href="#example-8">示例<bdi> 8</bdi></a>
                        </div>
                        <span class="chunk">mDCV</span> 块母版显示最小亮度示例：
                        <table id="mDCV-chunk-hdr-min-luminance-example" class="numbered simple">
                            <tbody>
                                <tr>
                                    <th>实际值</th>
                                    <th>存储十进制值</th>
                                    <th>存储十六进制值</th>
                                </tr>

                                <tr>
                                    <td>0.0005 cd/m<sup>2</sup></td>
                                    <td>5</td>
                                    <td>00 00 00 05</td>
                                </tr>
                            </tbody>
                        </table>
                    </aside>

                    <p>下面给出 [<cite><a class="bibref" data-link-type="biblio" href="#bib-display-p3"
                                title="Display P3">Display-P3</a></cite>] <a href="#dfn-sdr" class="internalDFN"
                            data-link-type="dfn" id="ref-for-dfn-sdr-6">SDR</a> 的 mDCV 示例。</p>

                    <aside class="example" id="example-9">
                        <div class="marker">
                            <a class="self-link" href="#example-9">示例<bdi> 9</bdi></a>
                        </div>
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-display-p3"
                                title="Display P3">Display-P3</a></cite>] 的 <span class="chunk">mDCV</span>
                        块母版显示色度学原色示例：

                        <table id="mDCV-chunk-sdr-primaries-example" class="numbered simple">
                            <tbody>
                                <tr>
                                    <th>名称</th>
                                    <th>实际值</th>
                                    <th>存储十进制值</th>
                                    <th>存储十六进制值</th>
                                </tr>

                                <tr>
                                    <td rowspan="3">[<cite><a class="bibref" data-link-type="biblio"
                                                href="#bib-display-p3" title="Display P3">Display-P3</a></cite>]
                                        指定的色度学原色</td>
                                    <td>(0.68, 0.32)</td>
                                    <td>{ 34000, 16000 }</td>
                                    <td>{ 84 D0, 3E 80 }</td>
                                </tr>

                                <tr>
                                    <td>(0.265, 0.69)</td>
                                    <td>{ 13520, 34500 }</td>
                                    <td>{ 34 D0, 86 C4 }</td>
                                </tr>

                                <tr>
                                    <td>(0.15, 0.06)</td>
                                    <td>{ 7500, 3000 }</td>
                                    <td>{ 1D 4C, 0B B8 }</td>
                                </tr>
                            </tbody>
                        </table>
                    </aside>

                    <aside class="example" id="example-10">
                        <div class="marker">
                            <a class="self-link" href="#example-10">示例<bdi> 10</bdi></a>
                        </div>
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-display-p3"
                                title="Display P3">Display-P3</a></cite>] 的 <span class="chunk">mDCV</span> 块母版显示白点示例：

                        <table id="mDCV-chunk-sdr-white-point-example" class="numbered simple">
                            <tbody>
                                <tr>
                                    <th>名称</th>
                                    <th>实际值</th>
                                    <th>存储十进制值</th>
                                    <th>存储十六进制值</th>
                                </tr>

                                <tr>
                                    <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-smpte-rp-177"
                                                title="Derivation of Basic Television Color Equations">SMPTE-RP-177</a></cite>]
                                        指定的 D65 光源
                                    </td>
                                    <td>(0.3127, 0.3290)</td>
                                    <td>{ 15635, 16450 }</td>
                                    <td>{ 3D 13, 40 42 }</td>
                                </tr>
                            </tbody>
                        </table>
                    </aside>

                    <aside class="example" id="example-11">
                        <div class="marker">
                            <a class="self-link" href="#example-11">示例<bdi> 11</bdi></a>
                        </div>
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-display-p3"
                                title="Display P3">Display-P3</a></cite>] 的 <span class="chunk">mDCV</span> 块母版显示最大亮度示例：
                        <table id="mDCV-chunk-sdr-max-luminance-example" class="numbered simple">
                            <tbody>
                                <tr>
                                    <th>实际值</th>
                                    <th>存储十进制值</th>
                                    <th>存储十六进制值</th>
                                </tr>

                                <tr>
                                    <td>80 cd/m<sup>2</sup></td>
                                    <td>800000</td>
                                    <td>00 0C 35 00</td>
                                </tr>
                            </tbody>
                        </table>
                    </aside>

                    <aside class="example" id="example-12">
                        <div class="marker">
                            <a class="self-link" href="#example-12">示例<bdi> 12</bdi></a>
                        </div>
                        [<cite><a class="bibref" data-link-type="biblio" href="#bib-display-p3"
                                title="Display P3">Display-P3</a></cite>] 的 mDCV 块母版显示最小亮度示例：
                        <table id="mDCV-chunk-sdr-min-luminance-example" class="numbered simple">
                            <tbody>
                                <tr>
                                    <th>实际值</th>
                                    <th>存储十进制值</th>
                                    <th>存储十六进制值</th>
                                </tr>

                                <tr>
                                    <td>0.05 cd/m<sup>2</sup></td>
                                    <td>500</td>
                                    <td>00 00 01 F4</td>
                                </tr>
                            </tbody>
                        </table>
                    </aside>
                </section>

                <section id="cLLI-chunk">
                    <div class="header-wrapper">
                        <h5 id="x11-3-2-8-clli-content-light-level-information"><bdi class="secno">11.3.2.8 </bdi><span
                                class="chunk">cLLI</span> 内容光等级信息</h5><a class="self-link" href="#cLLI-chunk"
                            aria-label="Permalink for Section 11.3.2.8"></a>
                    </div>

                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">63 4C 4C 49</code></pre>
                    <p>若存在，<span class="chunk">cLLI</span> 块标识<a href="#dfn-hdr" class="internalDFN"
                            data-link-type="dfn" id="ref-for-dfn-hdr-7">HDR</a> 内容的两个特性：</p>

                    <p><span class="chunk">cLLI</span>
                        块添加静态元数据，为将相关内容映射到特定目标显示器进行色调映射优化提供可能。这通过根据目标显示器的峰值亮度能力对内容自身的色调映射进行定制来实现，以防止裁剪。目前色调映射优化的方法是主观的。
                    </p>

                    <p>MaxCLL（最大内容光等级）使用静态元数据值表示整个回放序列中任一单个像素的最大光等级（单位
                        cd/m<sup>2</sup>，也称尼特）。通常会使用算法滤波以消除由处理或噪声导致的不真实值，避免对下游目标色调映射产生不利影响。</p>

                    <p>MaxFALL（最大帧平均光等级）使用静态元数据值表示整个回放序列中<a href="#dfn-frame" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-frame-2">帧</a>平均光等级（单位
                        cd/m<sup>2</sup>，也称尼特）的最大值。其计算方法是先对每帧的所有像素解码后的亮度值进行平均，再取平均值最高的那一帧的数值。</p>

                    <p>MaxCLL 与 MaxFALL 值以<a href="#dfn-png-four-byte-unsigned-integer" class="internalDFN"
                            data-link-type="dfn" id="ref-for-dfn-png-four-byte-unsigned-integer-7">PNG 四字节无符号整数</a>编码。
                    </p>

                    <div class="note" role="note" id="issue-container-generatedID-14">
                        <div role="heading" class="note-title marker" id="h-note-14" aria-level="6"><span>注</span>
                        </div>
                        <p class="">[<cite><a class="bibref" data-link-type="biblio" href="#bib-cta-861.3-a"
                                    title="HDR Static Metadata Extensions (CTA-861.3-A)">CTA-861.3-A</a></cite>] 描述了生成
                            <span class="chunk">cLLI</span> 值的计算方法，但未规定任何滤波。[<cite><a class="bibref"
                                    data-link-type="biblio" href="#bib-hdr-static-meta"
                                    title="On the Calculation and Usage of HDR Static Content Metadata">HDR-Static-Meta</a></cite>]
                            描述了一种改进方法，可剔除统计离群、噪声或重采样滤波器振铃导致的极端值，推荐在实际实现中采用。
                        </p>
                    </div>

                    <div class="note" role="note" id="issue-container-generatedID-15">
                        <div role="heading" class="note-title marker" id="h-note-15" aria-level="6"><span>注</span>
                        </div>
                        <p class="">[<cite><a class="bibref" data-link-type="biblio" href="#bib-smpte-st-2067-21"
                                    title="Interoperable Master Format — Application #2E">SMPTE-ST-2067-21</a></cite>]
                            第 7.5 节在 <span class="chunk">cLLI</span> 值未知且未计算的情况下，提供了额外信息。</p>
                    </div>

                    <div class="note" role="note" id="issue-container-generatedID-16">
                        <div role="heading" class="note-title marker" id="h-note-16" aria-level="6"><span>注</span>
                        </div>
                        <p class=""><a href="https://github.com/w3c/png/issues/319">Issue #319</a> 讨论了存在 <span
                                class="chunk">cLLI</span> 块时的色调映射行为。</p>
                    </div>

                    <p>需要对每个<a href="#dfn-frame" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-frame-3">帧</a>进行分析。</p>

                    <p>MaxCLL 或 MaxFALL 任一值为零表示该值未知或当前无法计算。</p>

                    <div class="note" role="note" id="issue-container-generatedID-17">
                        <div role="heading" class="note-title marker" id="h-note-17" aria-level="6"><span>注</span>
                        </div>
                        <p class="">例如在创建直播的 APNG 流时，在流结束前无法获得全部帧来计算这些数值，因此无法计算。编码器可选择初始设置为 0，并在流结束时以计算得到的数值替换。</p>
                    </div>

                    <p>下表给出了 <span class="chunk">cLLI</span> 块的语法：</p>

                    <table id="cLLI-chunk-syntax" class="numbered simple">
                        <caption><a class="self-link" href="#cLLI-chunk-syntax">Table <bdi class="tableno">20</bdi></a>
                            <span class="table-title">cLLI 块组成</span>
                        </caption>

                        <tbody>
                            <tr>
                                <th>名称</th>
                                <th>大小</th>
                                <th>除数</th>
                            </tr>

                            <tr>
                                <td>最大内容光等级（MaxCLL）</td>
                                <td>4 字节</td>
                                <td>0.0001 cd/m<sup>2</sup></td>
                            </tr>

                            <tr>
                                <td>最大帧平均光等级（MaxFALL）</td>
                                <td>4 字节</td>
                                <td>0.0001 cd/m<sup>2</sup></td>
                            </tr>
                        </tbody>
                    </table>

                    <aside class="example" id="example-13">
                        <div class="marker">
                            <a class="self-link" href="#example-13">示例<bdi> 13</bdi></a>
                        </div>
                        <span class="chunk">cLLI</span> 块最大内容光等级示例：

                        <table id="cLLI-chunk-max-content-light-level-example" class="numbered simple">
                            <tbody>
                                <tr>
                                    <th>实际值</th>
                                    <th>存储十进制值</th>
                                    <th>存储十六进制值</th>
                                </tr>

                                <tr>
                                    <td>1000 cd/m<sup>2</sup></td>
                                    <td>10000000</td>
                                    <td>00 98 96 80</td>
                                </tr>
                            </tbody>
                        </table>
                    </aside>

                    <aside class="example" id="example-14">
                        <div class="marker">
                            <a class="self-link" href="#example-14">示例<bdi> 14</bdi></a>
                        </div>
                        <span class="chunk">cLLI</span> 块最大帧平均光等级示例：

                        <table id="cLLI-chunk-max-frame-avg-luminance-example" class="numbered simple">
                            <tbody>
                                <tr>
                                    <th>实际值</th>
                                    <th>存储十进制值</th>
                                    <th>存储十六进制值</th>
                                </tr>

                                <tr>
                                    <td>250 cd/m<sup>2</sup></td>
                                    <td>2500000</td>
                                    <td>00 26 25 A0</td>
                                </tr>
                            </tbody>
                        </table>
                    </aside>
                </section>
            </section>



            <section id="11textinfo">
                <div class="header-wrapper">
                    <h4 id="x11-3-3-textual-information"><bdi class="secno">11.3.3 </bdi>文本信息</h4><a class="self-link"
                        href="#11textinfo" aria-label="第 11.3.3 节的永久链接"></a>
                </div>



                <section class="introductory" id="11textIntro">
                    <div class="header-wrapper">
                        <h3 id="introduction-7">简介</h3><a class="self-link" href="#11textIntro"
                            aria-label="本节的永久链接"></a>
                    </div>


                    <p>PNG 提供了 <a class="chunk" href="#11tEXt">tEXt</a>、<a class="chunk" href="#11iTXt">iTXt</a> 和 <a
                            class="chunk" href="#11zTXt">zTXt</a>
                        块，用于存储与图像关联的文本字符串，例如图像描述或版权声明。关键字用于指示每个文本字符串的含义。可以出现任意数量的此类文本块，并允许出现多个具有相同关键字的块。</p>
                </section>


                <section id="11keywords">
                    <div class="header-wrapper">
                        <h5 id="x11-3-3-1-keywords-and-text-strings"><bdi class="secno">11.3.3.1 </bdi>关键字与文本字符串</h5><a
                            class="self-link" href="#11keywords" aria-label="第 11.3.3.1 节的永久链接"></a>
                    </div>


                    <p>下列关键字是预定义的，应在适当情况下使用。</p>

                    <table id="keywords-predefined" class="numbered simple">
                        <caption><a class="self-link" href="#keywords-predefined">表 <bdi class="tableno">21</bdi></a>
                            <span class="table-title">
                                预定义关键字
                            </span>
                        </caption>

                        <tbody>
                            <tr>
                                <th>关键字值</th>
                                <th>说明</th>
                            </tr>

                            <tr>
                                <td>Title</td>
                                <td>图像的简短（单行）标题或说明</td>
                            </tr>

                            <tr>
                                <td>Author</td>
                                <td>图像创建者姓名</td>
                            </tr>

                            <tr>
                                <td>Description</td>
                                <td>图像描述（可能较长）</td>
                            </tr>

                            <tr>
                                <td>Copyright</td>
                                <td>版权声明</td>
                            </tr>

                            <tr>
                                <td>Creation Time</td>
                                <td>原始图像创建时间</td>
                            </tr>

                            <tr>
                                <td>Software</td>
                                <td>用于创建图像的软件</td>
                            </tr>

                            <tr>
                                <td>Disclaimer</td>
                                <td>法律免责声明</td>
                            </tr>

                            <tr>
                                <td>Warning</td>
                                <td>内容性质的警告</td>
                            </tr>

                            <tr>
                                <td>Source</td>
                                <td>用于创建图像的设备</td>
                            </tr>

                            <tr>
                                <td>Comment</td>
                                <td>其他备注</td>
                            </tr>

                            <tr>
                                <td>XML:com.adobe.xmp</td>
                                <td>
                                    可扩展元数据平台（XMP）信息，按 XMP 规范要求的格式 [<cite><a class="bibref" data-link-type="biblio"
                                            href="#bib-xmp"
                                            title="Extensible metadata platform (XMP) specification -- Part 1">XMP</a></cite>]。建议为符合
                                    XMP 要求使用 <a class="chunk" href="#11iTXt">iTXt</a>，将 Compression Flag 设为 0，并将
                                    Language Tag 与 Translated Keyword 均设为空字符串。
                                </td>
                            </tr>

                            <tr>
                                <td>Collection</td>
                                <td>图像所属集合的名称。图像可以属于一个或多个集合，每个集合由单独的文本块命名。</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>其他关键字 <em class="rfc2119">MAY</em> 由任何应用为私有或通用用途定义。</p>

                    <p>关键字 <em class="rfc2119">SHOULD</em> 满足以下条件。</p>

                    <ul>
                        <li>应当相当自解释，以便其他人工用户能够理解该块包含的内容；并且</li>

                        <li>选择时应尽量减少不同应用因不兼容用途使用相同关键字的可能性。</li>
                    </ul>

                    <p>应将具有一般性意义的关键字 <em class="rfc2119">SHOULD</em> 列入 [<cite><a class="bibref" data-link-type="biblio"
                                href="#bib-png-extensions"
                                title="Extensions to the PNG Third Edition Specification, Version 1.6.0">PNG-EXTENSIONS</a></cite>]。
                    </p>

                    <p>关键字只能包含可打印的 Latin-1 [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso_8859-1"
                                title="ISO/IEC 8859-1:1998, Information technology — 8-bit single-byte coded graphic character sets — Part 1: Latin alphabet No. 1.">ISO_8859-1</a></cite>]
                        字符和空格；即仅允许码位 0x20-7E 与 0xA1-FF。为减少人工误读关键字的概率，关键字中不允许前导空格、尾随空格和连续空格，也不允许 U+00A0 NO-BREAK
                        SPACE（因其在视觉上与普通空格无法区分）。</p>

                    <p>关键字应按注册时的拼写精确表示，以便解码器在查找特定关键字时能够使用简单的字面比较。特别地，关键字视为区分大小写。关键字长度限制为 1 到 79 字节。</p>

                    <p>对于 Creation Time 关键字，日期格式 <em class="rfc2119">SHOULD</em> 使用 RFC 3339 [<cite><a class="bibref"
                                data-link-type="biblio" href="#bib-rfc3339"
                                title="Date and Time on the Internet: Timestamps">rfc3339</a></cite>] 的日期-时间格式，或 RFC
                        1123 第 5.2.14 节中定义的日期格式 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc1123"
                                title="Requirements for Internet Hosts - Application and Support">rfc1123</a></cite>]。优先采用
                        RFC3339 日期-时间格式。该字段的实际格式未作严格定义。</p>

                    <p><a class="chunk" href="#11iTXt">iTXt</a> 块使用 UTF-8 编码 [<cite><a class="bibref"
                                data-link-type="biblio" href="#bib-rfc3629"
                                title="UTF-8, a transformation format of ISO 10646">rfc3629</a></cite>]，可用于传递任何语言的字符。<a
                            class="chunk" href="#11iTXt">iTXt</a> 块可选择对文本字符串进行压缩。由于支持 Unicode，建议对所有文本字符串使用 <a
                            class="chunk" href="#11iTXt">iTXt</a>。此外还有 <a class="chunk" href="#11tEXt">tEXt</a> 与 <a
                            class="chunk" href="#11zTXt">zTXt</a> 块，其内容仅限于可打印的 Latin-1 字符集和 U+000A LINE FEED (LF)。<a
                            class="chunk" href="#11zTXt">zTXt</a> 中的文本字符串通过 <a href="#dfn-zlib" class="internalDFN"
                            data-link-type="dfn" id="ref-for-dfn-zlib-15">zlib</a> 数据流使用 <a href="#dfn-deflate"
                            class="internalDFN" data-link-type="dfn" id="ref-for-dfn-deflate-13">deflate</a> 压缩（见 <a
                            href="#10CompressionOtherUses" class="sec-ref"><bdi class="secno">10.3
                            </bdi>压缩的其他用法</a>）。解压后得到的文本与等价的 <a class="chunk" href="#11tEXt">tEXt</a> 块中的文本在内容上相同。</p>
                </section>


                <section id="11tEXt">
                    <div class="header-wrapper">
                        <h5 id="x11-3-3-2-text-textual-data"><bdi class="secno">11.3.3.2 </bdi><span
                                class="chunk">tEXt</span> 文本数据</h5><a class="self-link" href="#11tEXt"
                            aria-label="第 11.3.3.2 节的永久链接"></a>
                    </div>


                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">74 45 58 74</code></pre>
                    <p>每个 <span class="chunk">tEXt</span> 块包含一个关键字和一个文本字符串，其格式为：</p>

                    <table id="tEXt-structure" class="simple numbered">
                        <tbody>
                            <tr>
                                <td>关键字</td>
                                <td>1-79 字节（字符串）</td>
                            </tr>

                            <tr>
                                <td>空字符分隔符</td>
                                <td>1 字节（空字符）</td>
                            </tr>

                            <tr>
                                <td>文本字符串</td>
                                <td>0 或更多字节（字符串）</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>关键字与文本字符串之间用零字节（空字符）分隔。关键字与文本字符串均不得包含空字符。文本字符串<strong>不</strong>以空字符结尾（块的长度定义了结束位置）。文本字符串的长度可以从零字节到最大允许块大小减去关键字与空字符分隔符的长度。
                    </p>

                    <p>关键字指示文本字符串表示的信息类型，详见 <a href="#11keywords" class="sec-ref"><bdi class="secno">11.3.3.1
                            </bdi>关键字与文本字符串</a>。</p>

                    <p>文本按 Latin-1 字符集解释 [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso_8859-1"
                                title="ISO/IEC 8859-1:1998, Information technology — 8-bit single-byte coded graphic character sets — Part 1: Latin alphabet No. 1.">ISO_8859-1</a></cite>]。文本字符串可以包含任意
                        Latin-1 字符。文本字符串中的换行应使用单个换行符（十进制 10）表示。除 Latin-1 定义的字符以及换行符之外的字符在 <span
                            class="chunk">tEXt</span> 块中无定义含义。包含 ISO/IEC 8859-1 范围之外字符的文本应使用 <a class="chunk"
                            href="#11iTXt">iTXt</a> 块进行编码。</p>
                </section>


                <section id="11zTXt">
                    <div class="header-wrapper">
                        <h5 id="x11-3-3-3-ztxt-compressed-textual-data"><bdi class="secno">11.3.3.3 </bdi><span
                                class="chunk">zTXt</span> 压缩文本数据</h5><a class="self-link" href="#11zTXt"
                            aria-label="第 11.3.3.3 节的永久链接"></a>
                    </div>


                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">7A 54 58 74</code></pre>
                    <p><span class="chunk">zTXt</span> 与 <a class="chunk" href="#11tEXt">tEXt</a> 块在语义上等价，但建议使用 <span
                            class="chunk">zTXt</span> 来存储大量文本。</p>

                    <p>一个 <span class="chunk">zTXt</span> 块包含：</p>

                    <table id="zTXt-structure" class="simple numbered">
                        <tbody>
                            <tr>
                                <td>关键字</td>
                                <td>1-79 字节（字符串）</td>
                            </tr>

                            <tr>
                                <td>空字符分隔符</td>
                                <td>1 字节（空字符）</td>
                            </tr>

                            <tr>
                                <td>压缩方法</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>压缩的文本数据流</td>
                                <td>n 字节</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>关键字和空字符与 <a class="chunk" href="#11tEXt">tEXt</a> 块中的相同。关键字不被压缩。压缩方法字段定义所用的压缩方法。本国际标准中定义的唯一值为
                        0（<a href="#dfn-deflate" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-deflate-14">deflate</a> 压缩）。其他值保留以供未来标准化。压缩方法字段之后是构成块其余部分的压缩文本数据流。对于压缩方法
                        0，该数据流为带 deflate 压缩的 <a href="#dfn-zlib" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-zlib-16">zlib</a> 数据流（参见 <a href="#10CompressionOtherUses"
                            class="sec-ref"><bdi class="secno">10.3 </bdi>压缩的其他用法</a>）。解压该数据流将得到与等价 <a class="chunk"
                            href="#11tEXt">tEXt</a> 块中相同的 Latin-1 文本。</p>
                </section>


                <section id="11iTXt">
                    <div class="header-wrapper">
                        <h5 id="x11-3-3-4-itxt-international-textual-data"><bdi class="secno">11.3.3.4 </bdi><span
                                class="chunk">iTXt</span> 国际文本数据</h5><a class="self-link" href="#11iTXt"
                            aria-label="第 11.3.3.4 节的永久链接"></a>
                    </div>


                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">69 54 58 74</code></pre>
                    <p>一个 <span class="chunk">iTXt</span> 块包含：</p>

                    <table id="iTXt-structure" class="simple numbered">
                        <tbody>
                            <tr>
                                <td>关键字</td>
                                <td>1-79 字节（字符串）</td>
                            </tr>

                            <tr>
                                <td>空字符分隔符</td>
                                <td>1 字节（空字符）</td>
                            </tr>

                            <tr>
                                <td>压缩标志</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>压缩方法</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>语言标签</td>
                                <td>0 或更多字节（字符串）</td>
                            </tr>

                            <tr>
                                <td>空字符分隔符</td>
                                <td>1 字节（空字符）</td>
                            </tr>

                            <tr>
                                <td>翻译后的关键字</td>
                                <td>0 或更多字节</td>
                            </tr>

                            <tr>
                                <td>空字符分隔符</td>
                                <td>1 字节（空字符）</td>
                            </tr>

                            <tr>
                                <td>文本</td>
                                <td>0 或更多字节</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>关键字详见 <a href="#11keywords" class="sec-ref"><bdi class="secno">11.3.3.1 </bdi>关键字与文本字符串</a>。</p>

                    <p>压缩标志为 0 表示未压缩文本，1 表示压缩文本。只有文本字段可以被压缩。压缩方法字段定义所用的压缩方法。本规范中定义的唯一压缩方法为 0（带 deflate 压缩的 <a
                            href="#dfn-zlib" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-zlib-17">zlib</a>
                        数据流，见 <a href="#dfn-deflate" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-deflate-15">deflate</a>）。对于未压缩文本，编码器应将压缩方法设为 0，解码器应忽略该字段。</p>

                    <p>语言标签应为 [<cite><a class="bibref" data-link-type="biblio" href="#bib-bcp47"
                                title="Tags for Identifying Languages">BCP47</a></cite>]
                        定义的良构语言标签。与关键字不同，语言标签不区分大小写。子标签必须出现在 IANA
                        语言子标签注册表中（https://www.iana.org/assignments/language-subtag-registry/language-subtag-registry）。若语言标签为空，则语言未指定。语言标签示例：<code>en</code>、<code>en-GB</code>、<code>es-419</code>、<code>zh-Hans</code>、<code>zh-Hans-CN</code>、<code>tlh-Cyrl-AQ</code>、<code>ar-AE-u-nu-latn</code>、<code>x-private</code>。
                    </p>

                    <p>翻译后的关键字与文本均使用 UTF-8 编码 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3629"
                                title="UTF-8, a transformation format of ISO 10646">rfc3629</a></cite>]，且均不得包含零字节（空字符）。与该块中的其他文本数据不同，此处的文本不以空字符结尾；其长度由块长度推导得出。
                    </p>

                    <p>翻译后的关键字中不应出现换行。在文本中，换行应由单个换行符（十六进制 0A）表示。其余控制字符（01-09、0B-1F、7F-9F）在翻译后的关键字和文本中均不推荐使用。在 UTF-8 中，字符
                        80-9F（不推荐）与字节序列 80-9F（在某些情况下是必要的）是不同的概念。</p>

                    <p>若翻译后的关键字非空，则应包含将关键字翻译为语言标签所指示语言的翻译，显示关键字的应用应同时显示翻译后的关键字。</p>
                </section>
            </section>




            <section id="11addnlsiinfo">
                <div class="header-wrapper">
                    <h4 id="x11-3-4-miscellaneous-information"><bdi class="secno">11.3.4 </bdi>杂项信息</h4><a
                        class="self-link" href="#11addnlsiinfo" aria-label="第 11.3.4 节的永久链接"></a>
                </div>



                <section id="11bKGD">
                    <div class="header-wrapper">
                        <h5 id="x11-3-4-1-bkgd-background-color"><bdi class="secno">11.3.4.1 </bdi><span
                                class="chunk">bKGD</span> 背景色</h5><a class="self-link" href="#11bKGD"
                            aria-label="第 11.3.4.1 节的永久链接"></a>
                    </div>


                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">62 4B 47 44</code></pre>
                    <p><span class="chunk">bKGD</span> 块指定用于呈现图像的默认背景颜色。如果存在任何其它更优先的背景（例如用户指定的或页面（如浏览器）的一部分），应忽略 <span
                            class="chunk">bKGD</span> 块。<span class="chunk">bKGD</span> 块包含：</p>

                    <table id="bKGD-structure" class="numbered simple">
                        <caption><a class="self-link" href="#bKGD-structure">表 <bdi class="tableno">22</bdi></a>
                            <span class="table-title">
                                bKGD 块内容
                            </span>
                        </caption>

                        <tbody>
                            <tr>
                                <th colspan="2">颜色类型 0 与 4</th>
                            </tr>

                            <tr>
                                <td>灰度</td>
                                <td>2 字节</td>
                            </tr>

                            <tr>
                                <th colspan="2">颜色类型 2 与 6</th>
                            </tr>

                            <tr>
                                <td>红</td>
                                <td>2 字节</td>
                            </tr>

                            <tr>
                                <td>绿</td>
                                <td>2 字节</td>
                            </tr>

                            <tr>
                                <td>蓝</td>
                                <td>2 字节</td>
                            </tr>

                            <tr>
                                <th colspan="2">颜色类型 3</th>
                            </tr>

                            <tr>
                                <td>调色板索引</td>
                                <td>1 字节</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>对于 <a href="#3colourType" class="internalDFN" data-link-type="dfn"
                            id="ref-for-3colourType-28">color type</a> 3（<a href="#3indexedColour" class="internalDFN"
                            data-link-type="dfn" id="ref-for-3indexedColour-15">indexed-color</a>），该值为应作为背景使用的调色板索引。</p>

                    <p>对于 <a href="#3colourType" class="internalDFN" data-link-type="dfn"
                            id="ref-for-3colourType-29">color types</a> 0 与 4（<a href="#dfn-greyscale"
                            class="internalDFN" data-link-type="dfn" id="ref-for-dfn-greyscale-11">greyscale</a>、<a
                            href="#dfn-greyscale-with-alpha" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-greyscale-with-alpha-3">greyscale with alpha</a>），该值为用作背景的灰度级，范围为 0 到
                        (2<sup>bitdepth</sup>) - 1。对于 <a href="#3colourType" class="internalDFN" data-link-type="dfn"
                            id="ref-for-3colourType-30">color types</a> 2 与 6（<a href="#3truecolour" class="internalDFN"
                            data-link-type="dfn" id="ref-for-3truecolour-13">truecolor</a>、<a
                            href="#dfn-truecolor-with-alpha" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-truecolor-with-alpha-4">truecolor with alpha</a>），这些值为用作背景的颜色，作为 RGB 采样，范围为
                        0 到 (2<sup>bitdepth</sup>) - 1。在每种情况下，为一致起见，每个采样使用两字节，且不受图像位深影响。如果图像位深小于 16，则使用最低有效位。编码器应将其他位设为
                        0，解码器在使用前必须将其他位掩蔽为 0。</p>
                </section>


                <section id="11hIST">
                    <div class="header-wrapper">
                        <h5 id="x11-3-4-2-hist-image-histogram"><bdi class="secno">11.3.4.2 </bdi><span
                                class="chunk">hIST</span> 图像直方图</h5><a class="self-link" href="#11hIST"
                            aria-label="第 11.3.4.2 节的永久链接"></a>
                    </div>


                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">68 49 53 54</code></pre>
                    <p><span class="chunk">hIST</span> 块包含一系列两字节无符号整数：</p>

                    <table id="hIST-structure" class="simple numbered">
                        <tbody>
                            <tr>
                                <td>频率</td>
                                <td>2 字节（无符号整数）</td>
                            </tr>

                            <tr>
                                <td>……等等……</td>
                                <td>&nbsp;</td>
                            </tr>
                        </tbody>
                    </table>

                    <p><span class="chunk">hIST</span> 块给出调色板中每种颜色的近似使用频率。只有当出现 <a class="chunk" href="#11PLTE">PLTE</a>
                        块时，才可出现直方图块。如果查看器无法提供调色板中列出的所有颜色，直方图可以帮助其决定如何为显示选择颜色子集。</p>

                    <p>对于 <a class="chunk" href="#11PLTE">PLTE</a>
                        块中的每个条目，应恰好存在一个直方图条目。每个条目与图像中具有该调色板索引的像素所占比例成正比；缩放因子由编码器自行选择。</p>

                    <p>直方图条目为近似值，唯一例外是零条目表示相应调色板条目在图像中根本未被使用。若存在该颜色的像素，则该直方图条目应为非零。</p>

                    <div class="note" role="note" id="issue-container-generatedID-18">
                        <div role="heading" class="note-title marker" id="h-note-18" aria-level="6"><span>注</span>
                        </div>
                        <p class="">注：当调色板是对 <a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                                id="ref-for-3truecolour-14">truecolor</a>
                            图像的建议量化时，直方图必然是近似的，因为解码器映射像素到调色板条目的方式可能与编码器不同。在这种情况下，通常不应出现零条目，因为任何条目都有可能被使用。</p>
                    </div>
                </section>


                <section id="11pHYs">
                    <div class="header-wrapper">
                        <h5 id="x11-3-4-3-phys-physical-pixel-dimensions"><bdi class="secno">11.3.4.3 </bdi><span
                                class="chunk">pHYs</span> 物理像素尺寸</h5><a class="self-link" href="#11pHYs"
                            aria-label="第 11.3.4.3 节的永久链接"></a>
                    </div>


                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">70 48 59 73</code></pre>
                    <p><span class="chunk">pHYs</span> 块指定用于显示图像的目标像素大小或纵横比。它包含：</p>

                    <table id="pHYs-structure" class="numbered simple">
                        <caption><a class="self-link" href="#pHYs-structure">表 <bdi class="tableno">23</bdi></a>
                            <span class="table-title">
                                pHYs 块内容
                            </span>
                        </caption>

                        <tbody>
                            <tr>
                                <th>名称</th>
                                <th>大小</th>
                            </tr>

                            <tr>
                                <td>X 轴每单位像素数</td>
                                <td>
                                    4 字节（<a href="#dfn-png-four-byte-unsigned-integer" class="internalDFN"
                                        data-link-type="dfn" id="ref-for-dfn-png-four-byte-unsigned-integer-8">PNG
                                        四字节无符号整数</a>）
                                </td>
                            </tr>

                            <tr>
                                <td>Y 轴每单位像素数</td>
                                <td>
                                    4 字节（<a href="#dfn-png-four-byte-unsigned-integer" class="internalDFN"
                                        data-link-type="dfn" id="ref-for-dfn-png-four-byte-unsigned-integer-9">PNG
                                        四字节无符号整数</a>）
                                </td>
                            </tr>

                            <tr>
                                <td>单位说明符</td>
                                <td>1 字节</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>单位说明符的定义值如下：</p>

                    <table id="unit-specifiers" class="numbered simple">
                        <caption><a class="self-link" href="#unit-specifiers">表 <bdi class="tableno">24</bdi></a>
                            <span class="table-title">
                                单位说明符取值
                            </span>
                        </caption>

                        <tbody>
                            <tr>
                                <th>值</th>
                                <th>说明</th>
                            </tr>

                            <tr>
                                <td>0</td>
                                <td>单位未知</td>
                            </tr>

                            <tr>
                                <td>1</td>
                                <td>单位为米</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>当单位说明符为 0 时，<span class="chunk">pHYs</span> 块仅定义像素纵横比；像素的实际尺寸未被指定。</p>

                    <p>如果未存在 <span class="chunk">pHYs</span> 块，则假定像素为方形，且每个像素的物理尺寸未被指定。</p>
                </section>


                <section id="11sPLT">
                    <div class="header-wrapper">
                        <h5 id="x11-3-4-4-splt-suggested-palette"><bdi class="secno">11.3.4.4 </bdi><span
                                class="chunk">sPLT</span> 建议调色板</h5><a class="self-link" href="#11sPLT"
                            aria-label="第 11.3.4.4 节的永久链接"></a>
                    </div>


                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">73 50 4C 54</code></pre>
                    <p><span class="chunk">sPLT</span> 块包含：</p>

                    <table id="sPLT-structure" class="numbered simple">
                        <caption><a class="self-link" href="#sPLT-structure">表 <bdi class="tableno">25</bdi></a>
                            <span class="table-title">
                                sPLT 块内容
                            </span>
                        </caption>

                        <tbody>
                            <tr>
                                <th>名称</th>
                                <th>大小</th>
                            </tr>

                            <tr>
                                <td>调色板名称</td>
                                <td>1-79 字节（字符串）</td>
                            </tr>

                            <tr>
                                <td>空字符分隔符</td>
                                <td>1 字节（空字符）</td>
                            </tr>

                            <tr>
                                <td>样本深度</td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td>红</td>
                                <td>1 或 2 字节</td>
                            </tr>

                            <tr>
                                <td>绿</td>
                                <td>1 或 2 字节</td>
                            </tr>

                            <tr>
                                <td>蓝</td>
                                <td>1 或 2 字节</td>
                            </tr>

                            <tr>
                                <td>Alpha</td>
                                <td>1 或 2 字节</td>
                            </tr>

                            <tr>
                                <td>频率</td>
                                <td>2 字节</td>
                            </tr>

                            <tr>
                                <td>……等等……</td>
                                <td>&nbsp;</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>每个调色板条目为六字节或十字节，包含五个无符号整数（red、blue、green、alpha 与 frequency）。</p>

                    <p>条目数可以是任意数量。PNG 解码器根据样本深度字节之后剩余的块长度确定条目数。如果 <span class="chunk">sPLT</span> 的样本深度为 8，则剩余长度应能被 6
                        整除；若样本深度为 16，则应能被 10 整除。条目应按频率降序排列。并不要求所有条目都被图像使用，也不要求条目互不相同。</p>

                    <p>调色板名称可以是引用该调色板的任意便捷名称（例如 "256 color including Macintosh default"、"256 color including Windows-3.1
                        default"、"Optimal 512"）。当 PNG 数据流中出现多个建议调色板时，调色板名称可帮助选择适当的建议调色板。</p>

                    <p>调色板名称区分大小写，并遵循与 <a class="chunk" href="#11tEXt">tEXt</a> 块关键字参数相同的限制。调色板名称仅应包含可打印的 Latin-1
                        字符和空格（仅允许码位 0x20-7E 与 0xA1-FF）。不允许前导、尾随或连续空格。</p>

                    <p><span class="chunk">sPLT</span> 的样本深度应为 8 或 16。</p>

                    <p>红、绿、蓝与 alpha 采样的长度为 1 或 2 字节，取决于 <span class="chunk">sPLT</span> 的样本深度，与图像位深无关。颜色样本未被 alpha
                        预乘，也未与任何背景预合成。alpha 值为 0 表示完全透明。alpha 值为 255（当样本深度为 8）或 65535（当样本深度为 16）表示完全不透明。<span
                            class="chunk">sPLT</span> 块可出现在任何 <a href="#3colourType" class="internalDFN"
                            data-link-type="dfn" id="ref-for-3colourType-31">color type</a> 中。<span
                            class="chunk">sPLT</span> 条目使用与 PNG 图像相同的 <a href="#dfn-gamma-value" class="internalDFN"
                            data-link-type="dfn" id="ref-for-dfn-gamma-value-6">gamma value</a> 与 <a
                            href="#dfn-chromaticity" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-chromaticity-4">chromaticity</a> 值，但条目值可能超出图像色彩空间的使用范围；例如，在灰度 PNG 图像中，每个
                        <span class="chunk">sPLT</span> 条目通常会具有相等的 R、G、B 值，但这并非必须。同样，即便 PNG 图像不使用透明度，<span
                            class="chunk">sPLT</span> 条目也可以具有非不透明的 alpha 值。
                    </p>

                    <p>每个频率值与图像中在 RGBA 空间内最接近该调色板条目的像素所占比例成正比，且该计算在将图像与任何背景进行 <a href="#dfn-composited"
                            class="internalDFN" data-link-type="dfn" id="ref-for-dfn-composited-5">合成</a> 之前完成。确切缩放因子由
                        PNG 编码器选择；建议使单个值的范围合理地填充 0 到 65535 的区间。PNG
                        编码器可人为地增加被认为“重要”的颜色的频率，例如用于标志或肖像面部特征的颜色。频率为零是有效的，表示该颜色“最不重要”或很少（或从未）被使用。当所有频率均为零时，这些值无意义，不能从中推断颜色在图像中出现的实际频率。
                    </p>

                    <p>允许多个 <span class="chunk">sPLT</span> 块，但每个块的调色板名称必须不同。</p>
                </section>


                <section id="eXIf">
                    <div class="header-wrapper">
                        <h5 id="x11-3-4-5-exif-exchangeable-image-file-exif-profile"><bdi class="secno">11.3.4.5
                            </bdi><span class="chunk">eXIf</span> 可交换图像文件（Exif）配置文件</h5><a class="self-link"
                            href="#eXIf" aria-label="第 11.3.4.5 节的永久链接"></a>
                    </div>


                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">65 58 49 66</code></pre>
                    <p><span class="chunk">eXIf</span> 块的数据段包含按 [<cite><a class="bibref" data-link-type="biblio"
                                href="#bib-cipa-dc-008"
                                title="Exchangeable image file format for digital still cameras: Exif Version 2.32">CIPA-DC-008</a></cite>]
                        中“4.7.2 Interoperability Structure of APP1 in Compressed Data” 指定的格式的 Exif 配置文件，但不包括 JPEG APP1
                        标记、长度以及 4.7.2(C) 中描述的 “Exif ID code”（即 "Exif", NULL 与填充字节）。</p>

                    <p><span class="chunk">eXIf</span> 块的大小仅受 PNG 规范强加的 2<sup>31</sup>-1 字节最大值约束。一个 PNG 数据流中仅允许存在一个
                        <span class="chunk">eXIf</span> 块。
                    </p>

                    <p><span class="chunk">eXIf</span> 块包含关于原始 <a href="#dfn-image-data" class="internalDFN"
                            data-link-type="dfn" id="ref-for-dfn-image-data-13">图像数据</a> 的元数据。如果图像在 Exif
                        配置文件创建后被编辑，则这些数据可能不再适用于 PNG 的 <a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-image-data-14">图像数据</a>。建议除非解码器具有独立证据确认 Exif
                        数据仍然有效，否则应将这些数据视为仅具历史价值。本规范不负责解决 eXIf 块与其他 PNG 块中的数据之间可能存在的冲突。</p>

                    <section id="exif-general-recommendations">
                        <div class="header-wrapper">
                            <h6 id="x11-3-4-5-1-exif-general-recommendations"><bdi class="secno">11.3.4.5.1 </bdi><span
                                    class="chunk">eXIf</span> 一般建议</h6><a class="self-link"
                                href="#exif-general-recommendations" aria-label="第 11.3.4.5.1 节的永久链接"></a>
                        </div>


                        <p>尽管 PNG 规范允许块大小达到 2<sup>31</sup>-1 字节，但应用程序作者应注意：如果 Exif 配置文件还将被写入 JPEG [<cite><a
                                    class="bibref" data-link-type="biblio" href="#bib-jpeg"
                                    title="JPEG File Interchange Format">JPEG</a></cite>] 数据流，则需调整 <span
                                class="chunk">eXIf</span> 块数据的总长度，使其不超过 2<sup>16</sup>-9 字节，以便能够放入 JPEG 的 APP1
                            标记（Exif）段中。</p>
                    </section>

                    <section id="exif-recommendations-for-decoders">
                        <div class="header-wrapper">
                            <h6 id="x11-3-4-5-2-exif-recommendations-for-decoders"><bdi class="secno">11.3.4.5.2
                                </bdi><span class="chunk">eXIf</span> 解码器建议</h6><a class="self-link"
                                href="#exif-recommendations-for-decoders" aria-label="第 11.3.4.5.2 节的永久链接"></a>
                        </div>


                        <p>数据的前两个字节为 "II" 表示小端（Intel）字节序，或 "MM" 表示大端（Motorola）字节序。解码器应检查前四个字节以确保它们为以下十六进制值之一：</p>

                        <pre
                            aria-busy="false"><code class="hljs javascript"><span class="hljs-number">49</span> <span class="hljs-number">49</span> 2A <span class="hljs-number">00</span> (ASCII "II", 16 位小端整数 42)</code></pre>
                        <p>或</p>

                        <pre
                            aria-busy="false"><code class="hljs javascript">4D 4D <span class="hljs-number">00</span> 2A (ASCII "MM", 16 位大端整数 42)</code></pre>
                        <p>所有其他值保留以供未来定义。</p>
                    </section>

                    <section id="exif-recommendations-for-encoders">
                        <div class="header-wrapper">
                            <h6 id="x11-3-4-5-3-exif-recommendations-for-encoders"><bdi class="secno">11.3.4.5.3
                                </bdi><span class="chunk">eXIf</span> 编码器建议</h6><a class="self-link"
                                href="#exif-recommendations-for-encoders" aria-label="第 11.3.4.5.3 节的永久链接"></a>
                        </div>


                        <p>图像编辑应用应考虑 Exif 规范中第 E.3 节的建议 [<cite><a class="bibref" data-link-type="biblio"
                                    href="#bib-cipa-dc-008"
                                    title="Exchangeable image file format for digital still cameras: Exif Version 2.32">CIPA-DC-008</a></cite>]，其中讨论了图像更改时更新
                            Exif 数据的要求。编码器应遵循这些要求，但解码器不应假定这些更新已被执行。</p>

                        <p>尽管编码器可以选择更新 Exif 中的缩略图，但不应期望当主图像更改时，Exif 配置文件中存在的任何缩略图已被更新或未被更新。</p>
                    </section>
                </section>
            </section>


            <section id="11timestampinfo">
                <div class="header-wrapper">
                    <h4 id="x11-3-5-time-stamp-information"><bdi class="secno">11.3.5 </bdi>时间戳信息</h4>
                    <a class="self-link" href="#11timestampinfo" aria-label="Permalink for Section 11.3.5"></a>
                </div>



                <section id="11tIME">
                    <div class="header-wrapper">
                        <h5 id="x11-3-5-1-time-image-last-modification-time"><bdi class="secno">11.3.5.1 </bdi><span
                                class="chunk">tIME</span> 图像最后修改时间</h5><a class="self-link" href="#11tIME"
                            aria-label="Permalink for Section 11.3.5.1"></a>
                    </div>


                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">74 49 4D 45</code></pre>
                    <p><span class="chunk">tIME</span> 块给出图像的最后修改时间（<strong>不是</strong>图像最初创建时间）。它包含：</p>

                    <table id="tIME-structure" class="numbered simple">
                        <caption><a class="self-link" href="#tIME-structure">Table <bdi class="tableno">26</bdi></a>
                            <span class="table-title">
                                tIME 块内容
                            </span>
                        </caption>

                        <tbody>
                            <tr>
                                <th>名称</th>
                                <th>大小</th>
                            </tr>

                            <tr>
                                <td>Year</td>
                                <td>2 字节（完整，例如 1995，<strong>不是</strong> 95）</td>
                            </tr>

                            <tr>
                                <td>Month</td>
                                <td>1 字节（1-12）</td>
                            </tr>

                            <tr>
                                <td>Day</td>
                                <td>1 字节（1-31）</td>
                            </tr>

                            <tr>
                                <td>Hour</td>
                                <td>1 字节（0-23）</td>
                            </tr>

                            <tr>
                                <td>Minute</td>
                                <td>1 字节（0-59）</td>
                            </tr>

                            <tr>
                                <td>Second</td>
                                <td>1 字节（0-60）（以允许闰秒）</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>应指定世界协调时（UTC），而不是本地时间。</p>

                    <p><span class="chunk">tIME</span> 块用于作为自动应用的时间戳，每当 <a href="#dfn-image-data" class="internalDFN"
                            data-link-type="dfn" id="ref-for-dfn-image-data-15">image data</a> 被更改时会更新。</p>
                </section>
            </section>

            <section id="animation-information">
                <div class="header-wrapper">
                    <h4 id="x11-3-6-animation-information"><bdi class="secno">11.3.6 </bdi>动画信息</h4><a class="self-link"
                        href="#animation-information" aria-label="Permalink for Section 11.3.6"></a>
                </div>


                <section id="acTL-chunk">
                    <div class="header-wrapper">
                        <h5 id="x11-3-6-1-actl-animation-control-chunk"><bdi class="secno">11.3.6.1 </bdi><span
                                class="chunk">acTL</span> 动画控制块</h5><a class="self-link" href="#acTL-chunk"
                            aria-label="Permalink for Section 11.3.6.1"></a>
                    </div>


                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">61 63 54 4C</code></pre>
                    <p><span class="chunk">acTL</span> 块声明这是一个动画 PNG 图片，给出帧数以及循环播放的次数。它包含：</p>

                    <table id="acTL-structure" class="simple numbered">
                        <tbody>
                            <tr>
                                <td><code>num_frames</code></td>
                                <td>4 字节</td>
                            </tr>

                            <tr>
                                <td><code>num_plays</code></td>
                                <td>4 字节</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>每个值均按 <a href="#dfn-png-four-byte-unsigned-integer" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-png-four-byte-unsigned-integer-10">PNG four-byte unsigned integer</a> 编码。
                    </p>

                    <p><code>num_frames</code> 指示动画中的总帧数。此值必须等于 <a class="chunk" href="#fcTL-chunk">fcTL</a> 块的数量。0
                        不是有效值。1 为有效值，表示单帧 PNG。如果该值与实际帧数不一致，应将其视为错误。</p>

                    <p><code>num_plays</code> 指示该动画应播放的次数；若为 0，则应无限循环播放。若非零，则动画在最后一次播放结束时应停留在最后一帧。</p>

                    <p><span class="chunk">acTL</span> 块必须出现在有效 PNG 流中的第一个 <a class="chunk" href="#11IDAT">IDAT</a> 块之前。
                    </p>

                    <div class="note" role="note" id="issue-container-generatedID-19">
                        <div role="heading" class="note-title marker" id="h-note-19" aria-level="6"><span>Note</span>
                        </div>
                        <p class="">出于 Web 兼容性考虑，由于该块的开发与部署与其并入 PNG 规范之间间隔较长，该块名特例地按私有块定义。</p>
                    </div>
                </section>

                <section id="fcTL-chunk">
                    <div class="header-wrapper">
                        <h5 id="x11-3-6-2-fctl-frame-control-chunk"><bdi class="secno">11.3.6.2 </bdi><span
                                class="chunk">fcTL</span> 帧控制块</h5><a class="self-link" href="#fcTL-chunk"
                            aria-label="Permalink for Section 11.3.6.2"></a>
                    </div>


                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">66 63 54 4C</code></pre>
                    <p><span class="chunk">fcTL</span> 块定义单个帧的尺寸、位置、延迟和处置。每个帧精确需要一个 <span class="chunk">fcTL</span>
                        块。它包含：</p>

                    <table id="fcTL-structure" class="numbered simple">
                        <caption><a class="self-link" href="#fcTL-structure">Table <bdi class="tableno">27</bdi></a>
                            <span class="table-title">
                                fcTL 块内容
                            </span>
                        </caption>

                        <tbody>
                            <tr>
                                <th>名称</th>
                                <th>大小</th>
                            </tr>

                            <tr>
                                <td><code>sequence_number</code></td>
                                <td>4 字节</td>
                            </tr>

                            <tr>
                                <td><code>width</code></td>
                                <td>4 字节</td>
                            </tr>

                            <tr>
                                <td><code>height</code></td>
                                <td>4 字节</td>
                            </tr>

                            <tr>
                                <td><code>x_offset</code></td>
                                <td>4 字节</td>
                            </tr>

                            <tr>
                                <td><code>y_offset</code></td>
                                <td>4 字节</td>
                            </tr>

                            <tr>
                                <td><code>delay_num</code></td>
                                <td>2 字节</td>
                            </tr>

                            <tr>
                                <td><code>delay_den</code></td>
                                <td>2 字节</td>
                            </tr>

                            <tr>
                                <td><code>dispose_op</code></td>
                                <td>1 字节</td>
                            </tr>

                            <tr>
                                <td><code>blend_op</code></td>
                                <td>1 字节</td>
                            </tr>
                        </tbody>
                    </table>

                    <p><code>sequence_number</code> 定义动画块的 <a href="#4Concepts.APNGSequence">序列号</a>，从 0 开始。它按 <a
                            href="#dfn-png-four-byte-unsigned-integer" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-png-four-byte-unsigned-integer-11">PNG four-byte unsigned integer</a> 编码。
                    </p>

                    <p><code>width</code> 与 <code>height</code> 定义后续帧的宽度与高度。它们按 <a
                            href="#dfn-png-four-byte-unsigned-integer" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-png-four-byte-unsigned-integer-12">PNG four-byte unsigned integers</a>
                        编码，且必须大于零。</p>

                    <p><code>x_offset</code> 与 <code>y_offset</code> 定义后续帧的位置。它们按 <a
                            href="#dfn-png-four-byte-unsigned-integer" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-png-four-byte-unsigned-integer-13">PNG four-byte unsigned integers</a> 编码，0
                        为有效值。</p>

                    <p>帧必须在由 <code>x_offset</code>、<code>y_offset</code>、<code>width</code> 与 <code>height</code>
                        定义的区域内渲染。该区域不得超出默认图像；因此 <code>x_offset</code> 加上 <code>width</code> 不得大于 <a class="chunk"
                            href="#11IHDR">IHDR</a> 中的宽度；同样 <code>y_offset</code> 加上 <code>height</code> 不得大于 <a
                            class="chunk" href="#11IHDR">IHDR</a> 中的高度。</p>

                    <p><code>delay_num</code> 与 <code>delay_den</code> 定义延迟分数的分子與分母；表示显示当前帧的时间（以秒为单位）。若分母为 0，则视为 100（即
                        <code>delay_num</code> 指定 1/100 秒）。若分子为 0，解码器应尽快渲染下一帧，但查看器可以施加合理的下限。它们按两字节无符号整数编码。
                    </p>

                    <p>帧定时应独立于解码与显示每帧所需的时间，以确保动画在不同解码器实现上的播放速率一致。</p>

                    <p><code>dispose_op</code> 定义在渲染该帧之后应对该帧区域进行的处置类型；换言之，它指定在延迟结束（渲染下一帧之前）应如何更改输出缓冲区。它按一字节无符号整数编码。</p>

                    <p><code>dispose_op</code> 的有效取值如下：</p>

                    <table id="dispose-op-values" class="simple numbered">
                        <tbody>
                            <tr>
                                <td>0</td>
                                <td><code>APNG_DISPOSE_OP_NONE</code></td>
                            </tr>

                            <tr>
                                <td>1</td>
                                <td><code>APNG_DISPOSE_OP_BACKGROUND</code></td>
                            </tr>

                            <tr>
                                <td>2</td>
                                <td><code>APNG_DISPOSE_OP_PREVIOUS</code></td>
                            </tr>
                        </tbody>
                    </table>

                    <dl>
                        <dt><code>APNG_DISPOSE_OP_NONE</code></dt>

                        <dd>在渲染下一帧之前对此帧不做处置；输出缓冲区内容保持不变。</dd>

                        <dt><code>APNG_DISPOSE_OP_BACKGROUND</code></dt>

                        <dd>在渲染下一帧之前，先将该帧在输出缓冲区中的区域清除为完全透明的黑色。</dd>

                        <dt><code>APNG_DISPOSE_OP_PREVIOUS</code></dt>

                        <dd>在渲染下一帧之前，将该帧在输出缓冲区中的区域恢复为先前的内容。</dd>
                    </dl>

                    <p>如果第一个 <span class="chunk">fcTL</span> 块使用的 <code>dispose_op</code> 为
                        <code>APNG_DISPOSE_OP_PREVIOUS</code>，则应将其视为 <code>APNG_DISPOSE_OP_BACKGROUND</code>。
                    </p>

                    <p><code>blend_op</code> 指定该帧是应基于 alpha 与当前输出缓冲区内容进行 alpha 混合，还是应完全替换输出缓冲区中该区域。它按一字节无符号整数编码。</p>

                    <p><code>blend_op</code> 的有效取值如下：</p>

                    <table id="blend-op-values" class="simple numbered">
                        <tbody>
                            <tr>
                                <td>0</td>
                                <td><code>APNG_BLEND_OP_SOURCE</code></td>
                            </tr>

                            <tr>
                                <td>1</td>
                                <td><code>APNG_BLEND_OP_OVER</code></td>
                            </tr>
                        </tbody>
                    </table>

                    <p>若 <code>blend_op</code> 为 <code>APNG_BLEND_OP_SOURCE</code>，则该帧的所有颜色分量（包括
                        alpha）覆盖帧输出缓冲区当前内容的相应区域。若 <code>blend_op</code> 为 <code>APNG_BLEND_OP_OVER</code>，则该帧应基于其 alpha
                        使用简单的 OVER 操作将其合成（<a href="#dfn-composited" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-composited-6">composited</a>）到输出缓冲区，如在 <a
                            href="#13Alpha-channel-processing">Alpha Channel Processing</a> 中所述。注意示例代码的第二种变体适用。</p>

                    <p>注意对于第一帧，由于在每次播放开始时输出缓冲区会被清除，两种混合模式在功能上等价。</p>

                    <p>对应于默认图像的 <span class="chunk">fcTL</span> 块（如果存在）具有如下限制：</p>

                    <ul>
                        <li><code>x_offset</code> 与 <code>y_offset</code> 字段必须为 0。</li>

                        <li><code>width</code> 与 <code>height</code> 字段必须等于 <a class="chunk" href="#11IHDR">IHDR</a>
                            块中的对应字段。</li>
                    </ul>

                    <p>如前所述，输出缓冲区必须在每次播放开始时完全初始化为完全透明的黑色，以确保每次播放的结果相同。解码器只要能保证结果相同，便可以避免显式的清除步骤。例如，如果默认图像包含在动画中且使用
                        <code>blend_op</code> 为 <code>APNG_BLEND_OP_SOURCE</code>，则无需清除，因为整个输出缓冲区将被覆盖。
                    </p>



                    <div class="note" role="note" id="issue-container-generatedID-20">
                        <div role="heading" class="note-title marker" id="h-note-20" aria-level="6"><span>Note</span>
                        </div>
                        <p class="">出于 Web 兼容性考虑，由于该块的开发与部署与其并入 PNG 规范之间间隔较长，该块名特例地按私有块定义。</p>
                    </div>
                </section>

                <section id="fdAT-chunk">
                    <div class="header-wrapper">
                        <h5 id="x11-3-6-3-fdat-frame-data-chunk"><bdi class="secno">11.3.6.3 </bdi><span
                                class="chunk">fdAT</span> 帧数据块</h5><a class="self-link" href="#fdAT-chunk"
                            aria-label="Permalink for Section 11.3.6.3"></a>
                    </div>


                    <p>四字节的块类型字段包含以下十六进制值</p>

                    <pre aria-busy="false"><code class="hljs">66 64 41 54</code></pre>
                    <p><span class="chunk">fdAT</span> 块对动画而言的作用与静态图像的 <a class="chunk" href="#11IDAT">IDAT</a> 块相同；一组
                        <span class="chunk">fdAT</span> 块包含所有帧（或者当动画将静态图像作为第一帧时，包含第一帧之后的所有帧）的 <a href="#dfn-image-data"
                            class="internalDFN" data-link-type="dfn" id="ref-for-dfn-image-data-16">图像数据</a>。它包含：
                    </p>

                    <table id="fdAT-structure" class="numbered simple">
                        <caption><a class="self-link" href="#fdAT-structure">Table <bdi class="tableno">28</bdi></a>
                            <span class="table-title">
                                fdAT 块内容
                            </span>
                        </caption>

                        <tbody>
                            <tr>
                                <th>名称</th>
                                <th>大小</th>
                            </tr>

                            <tr>
                                <td><code>sequence_number</code></td>
                                <td>4 字节</td>
                            </tr>

                            <tr>
                                <td><code>frame_data</code></td>
                                <td><i>n</i> 字节</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>除非第一帧由 <a class="chunk" href="#11IDAT">IDAT</a> 块表示，否则每个帧至少需要一个 <span class="chunk">fdAT</span>
                        块。</p>

                    <p>每帧的压缩数据流为该帧内所有 <span class="chunk">fdAT</span> 块的 <code>frame_data</code> 字段内容按 <a
                            href="#4Concepts.APNGSequence">sequence number</a> 升序连接而成。</p>

                    <p>由于有序号，<span class="chunk">fdAT</span> 块<a href="#zero-length-data">不得为零长度</a>；但其
                        <code>frame_data</code> 字段可以为零长度。
                    </p>

                    <p>解压后，该数据流为完整的像素数据，包含每条扫描线开头的滤波字节，类似于所有 <a class="chunk" href="#11IDAT">IDAT</a>
                        块的未压缩数据。它使用与静态图像相同的位深、<a href="#3colourType" class="internalDFN" data-link-type="dfn"
                            id="ref-for-3colourType-32">color type</a>、压缩方法、<a href="#3filter" class="internalDFN"
                            data-link-type="dfn" id="ref-for-3filter-12">filter method</a>、隔行方法以及调色板（如有）。</p>

                    <p>每个帧继承位于文件中第一个 <a class="chunk" href="#11IDAT">IDAT</a> 块之前的所有关键或辅助块所指定的属性，但宽度和高度来自对应的 <span
                            class="chunk">fcTL</span> 块。</p>

                    <p>如果 PNG 中存在 <a class="chunk" href="#11pHYs">pHYs</a> 块，则 APNG 图像及其 <code>x_offset</code> 和
                        <code>y_offset</code> 值必须以与主图像相同的方式进行缩放。概念上，此类缩放在将输出缓冲区映射到 <a href="#dfn-canvas"
                            class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canvas-3">canvas</a> 时发生。
                    </p>

                    <div class="note" role="note" id="issue-container-generatedID-21">
                        <div role="heading" class="note-title marker" id="h-note-21" aria-level="6"><span>Note</span>
                        </div>
                        <p class="">出于 Web 兼容性考虑，由于该块的开发与部署与其并入 PNG 规范之间间隔较长，该块名特例地按私有块定义。</p>
                    </div>
                </section>
            </section>
        </section>
    </section>




    <section id="12Encoders">
        <div class="header-wrapper">
            <h2 id="x12-png-encoders"><bdi class="secno">12. </bdi>PNG 编码器</h2><a class="self-link" href="#12Encoders"
                aria-label="Permalink for Section 12."></a>
        </div>



        <section class="introductory" id="12Introduction">
            <div class="header-wrapper">
                <h3 id="introduction-8">简介</h3><a class="self-link" href="#12Introduction"
                    aria-label="Permalink for this Section"></a>
            </div>


            <p>本条款给出了对编码器行为的要求和建议。PNG 编码器应当从一个 PNG 图像生成一个符合前述条款中所规定格式的 PNG 数据流。遵循此处给出的额外建议通常能得到更好的结果。</p>
        </section>


        <section id="12Encoder-gamma-handling">
            <div class="header-wrapper">
                <h3 id="x12-1-encoder-gamma-handling"><bdi class="secno">12.1 </bdi>编码器伽玛处理</h3><a class="self-link"
                    href="#12Encoder-gamma-handling" aria-label="Permalink for Section 12.1"></a>
            </div>


            <p>有关 <a href="#C-GammaAppendix" class="sec-ref"><bdi class="secno">C. </bdi>伽玛与色度</a> 中的简要介绍，请参阅 <a
                    href="#dfn-gamma" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-4">gamma</a> 相关问题。
            </p>

            <p>具备完整色彩管理能力的 PNG 编码器将比此处描述的执行更复杂的计算，并可能选择使用 <a class="chunk" href="#11iCCP">iCCP</a> 块。如果已知图像采样符合 sRGB 规范
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-srgb"
                        title="Multimedia systems and equipment - Colour measurement and management - Part 2-1: Colour management - Default RGB colour space - sRGB">SRGB</a></cite>]，
                强烈建议编码器写入 <a class="chunk" href="#srgb-standard-colour-space">sRGB</a> 块，而无需进行额外的 <a href="#dfn-gamma"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-5">gamma</a> 处理。在这两种情况下，建议生成一个适当的 <a
                    class="chunk" href="#11gAMA">gAMA</a> 块，以供不识别 <a class="chunk" href="#11iCCP">iCCP</a> 或 <a
                    class="chunk" href="#srgb-standard-colour-space">sRGB</a> 块的 PNG 解码器使用。</p>

            <p>PNG 编码器必须确定：</p>


            <ol>
                <li>在 <a class="chunk" href="#11gAMA">gAMA</a> 块中写入什么值；
                </li>

                <li>如何将提供的图像采样转换为要写入 PNG 数据流的值。
                </li>
            </ol>

            <p>写入 <a class="chunk" href="#11gAMA">gAMA</a> 块的值应当是能使 PNG 解码器按期望方式工作的那个值。参见 <a class="Href sec-ref"
                    href="#13Decoder-gamma-handling"><bdi class="secno">13.13 </bdi>解码器伽玛处理</a>。</p>

            <p>要应用的变换取决于图像样本的性质及其精度。如果样本以浮点或高精度整数形式表示光强（例如来自计算机图形渲染器），编码器可以在量化为整数并写入 PNG 数据流之前执行 <dfn
                    id="dfn-gamma-encoding" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">伽玛编码</dfn>（应用指数小于 1
                的幂函数）。这样在给定采样深度下可减少条带伪影，或在保持相同视觉质量的同时使用更小的采样。取值范围 0 到 1 的浮点强度可以按下式转换为数据流中的图像采样：</p>

            <p><code>integer_sample = floor((2<sup>sampledepth</sup>-1) * intensity<sup>encoding_exponent</sup> + 0.5)</code>
            </p>

            <p>如果上述方程中的 intensity 是期望的输出强度，则 encoding_exponent 即为应在 <a class="chunk" href="#11gAMA">gAMA</a> 块中使用的 <a
                    href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-value-7">gamma value</a>。</p>

            <p>如果编码器可获得的是场景的原始强度，可能需要另一个变换。有时要求显示图像相对于原始源具有更高的对比度，这对应于从原始场景到显示输出的端到端 <a href="#dfn-transfer-function"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-transfer-function-12">传递函数</a> 的指数大于
                1。在这种情况下：</p>

            <pre
                aria-busy="false"><code class="hljs abnf"><span class="hljs-attribute">gamma</span> <span class="hljs-operator">=</span> encoding_exponent/end_to_end_exponent</code></pre>
            <p>如果无法确定原始图像捕获或计算的条件是否需要这种对比度变化，则可假定显示强度与原始场景强度成比例，即端到端指数为 1，因此：</p>

            <pre
                aria-busy="false"><code class="hljs abnf"><span class="hljs-attribute">gamma</span> <span class="hljs-operator">=</span> encoding_exponent</code></pre>


            <p>如果图像仅写入数据流，编码器可以自由选择 encoding_exponent。通常将 <a href="#dfn-gamma-value" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-gamma-value-8">gAMA</a> 块中的 gamma 值设为 1/2.2
                是一个合理选择，因为这会将解码器在典型视频监视器上显示时的工作量最小化。</p>

            <p>一些图像渲染器可能同时将图像写入 PNG 数据流并在屏幕上显示。屏幕上显示的像素应根据正在使用的显示系统与观看条件进行 <a href="#dfn-gamma" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-gamma-6">gamma</a> 校正，以便用户看到与原始场景相符的正确表现。</p>

            <p>如果渲染器想将已显示的采样值写入 PNG 数据流，从而避免对数据流进行单独的 <a href="#dfn-gamma-encoding" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-gamma-encoding-1">伽玛编码</a>，渲染器应通过幂函数近似显示系统的 <a
                    href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-transfer-function-13">传递函数</a>，并将该幂函数的倒数写入 <a class="chunk" href="#11gAMA">gAMA</a>
                块。这将允许 PNG 解码器重现渲染器在渲染期间在屏幕上显示的内容。</p>

            <p>然而，渲染器也可以为显示设备计算合适的显示像素，并为数据存储与传输执行单独的 <a href="#dfn-gamma-encoding" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-gamma-encoding-2">伽玛编码</a>，并在 <a class="chunk"
                    href="#11gAMA">gAMA</a> 块中写入更适合图像未来使用的值。</p>

            <p>计算机图形渲染器通常不执行 <a href="#dfn-gamma-encoding" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-encoding-3">伽玛编码</a>，而是直接使样本值与场景光强成正比。如果 PNG 编码器接收到的样本值已经被量化为整数，则对它们再做 <a
                    href="#dfn-gamma-encoding" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-encoding-4">伽玛编码</a> 没有意义；那只会造成额外的信息损失。编码器应将这些样本值直接写入 PNG 数据流。这并不意味着 <a
                    class="chunk" href="#11gAMA">gAMA</a> 块应当包含 <a href="#dfn-gamma-value" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-gamma-value-9">gamma value</a> 为 1.0，因为从场景强度到显示输出强度的期望端到端 <a
                    href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-transfer-function-14">传递函数</a> 不一定是线性的。不过，期望的 <a href="#dfn-gamma-value"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-value-10">gamma value</a> 可能接近
                1.0。其值可能取决于场景是日光场景还是室内场景等因素。</p>

            <p>当样本值直接来自硬件时，正确的 <a class="chunk" href="#11gAMA">gAMA</a> 值原则上可以从硬件的 <a href="#dfn-transfer-function"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-transfer-function-15">传递函数</a>
                以及场景的照明条件推断出来。对于视频采集卡（“帧抓取器”），样本很可能处于 sRGB 色彩空间，因为 sRGB
                规范设计时考虑了与现代视频标准的兼容性。图像扫描仪则更难预测：它们的输出可能与输入光强成正比（CCD 传感器本身是线性的），也可能在硬件层面上应用了用于补偿印刷点增益的幂函数（大约 0.57
                的指数），或者已对样本进行显示校正。确定特定扫描仪的特性可能需要参考其手册或扫描一个校准目标。应记住 <a href="#dfn-gamma" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-gamma-7">gamma</a> 关系的是样本与期望显示输出之间的关系，而不是与扫描仪输入之间的关系。</p>

            <p>数据流格式转换器通常不应试图将提供的图像转换为不同的 <a href="#dfn-gamma" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-8">gamma</a>。数据应在无转换情况下存储在 PNG 数据流中，并应尽可能从源数据流中推断出应写入的 <a
                    href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-value-11">gamma value</a>。在数据流转换时改变 <a href="#dfn-gamma" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-gamma-9">gamma</a>
                会导致所表示的强度级集合被重新量化，从而引入更多舍入误差而收益甚微。通常最好直接将输入样本值从输入复制到输出文件，而不进行转换。</p>

            <p>如果源数据流描述了图像的 <a href="#dfn-gamma" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-10">gamma</a> 特性，强烈鼓励数据流转换器写入一个 <a class="chunk" href="#11gAMA">gAMA</a>
                块。有些数据流格式指定的是显示指数（从图像样本映射到显示输出的函数的指数，而不是反方向）。如果源文件的 <a href="#dfn-gamma-value" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-gamma-value-12">gamma value</a> 大于 1.0，则它很可能是显示指数，应对该值取倒数以用于
                PNG 的 <a href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-value-13">gamma value</a>。如果源文件格式记录的是图像样本与显示输出以外量之间的关系，则推断 PNG 的 <a
                    href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-value-14">gamma value</a> 将更为复杂。</p>

            <p>如果 PNG 编码器或数据流转换器知道图像在一个其 <a href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-transfer-function-16">传递函数</a> 可用幂函数近似且其指数为 <var>display_exponent</var>
                的显示系统上已满意地显示过，则可以将图像标记为具有下列 <a href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-value-15">gamma value</a>：</p>

            <pre
                aria-busy="false"><code class="hljs abnf"><span class="hljs-attribute">gamma</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>/display_exponent</code></pre>


            <p>写入一个近似正确的 <a class="chunk" href="#11gAMA">gAMA</a> 块要比省略该块并迫使 PNG 解码器猜测一个近似的 <a href="#dfn-gamma-value"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-value-16">gamma value</a> 更好。如果 PNG
                编码器无法推断出 <a href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-value-17">gamma value</a>，则最好省略 <a class="chunk" href="#11gAMA">gAMA</a>
                块。如果必须进行猜测，应将该任务留给 PNG 解码器。</p>

            <p><a href="#dfn-gamma" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-11">gamma</a> 不适用于
                alpha 采样；alpha 始终以线性方式表示。</p>

            <p>另见 <a href="#13Decoder-gamma-handling" class="sec-ref"><bdi class="secno">13.13 </bdi>解码器伽玛处理</a>。</p>
        </section>


        <section id="12Encoder-colour-handling">
            <div class="header-wrapper">
                <h3 id="x12-2-encoder-color-handling"><bdi class="secno">12.2 </bdi>编码器色彩处理</h3><a class="self-link"
                    href="#12Encoder-colour-handling" aria-label="Permalink for Section 12.2"></a>
            </div>


            <p>关于色彩问题的参考，请参阅 <a href="#C-GammaAppendix" class="sec-ref"><bdi class="secno">C. </bdi>伽玛与色度</a>。</p>

            <p>具备完整色彩管理能力的 PNG 编码器将执行比此处描述的更复杂的计算，并可能选择使用 <a class="chunk" href="#11iCCP">iCCP</a> 块。如果已知图像采样符合 sRGB 规范
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-srgb"
                        title="Multimedia systems and equipment - Colour measurement and management - Part 2-1: Colour management - Default RGB colour space - sRGB">SRGB</a></cite>]，强烈建议
                PNG 编码器使用 <a class="chunk" href="#srgb-standard-colour-space">sRGB</a> 块。</p>

            <p>如果编码器能确定源显示器三基色的色度，或能根据图像的来源或运行它的硬件做出有力的猜测，强烈建议编码器输出 <a class="chunk" href="#11cHRM">cHRM</a> 块。如果写入了 <a
                    class="chunk" href="#11cHRM">cHRM</a> 块，也应写入 <a class="chunk" href="#11gAMA">gAMA</a> 块；若没有 <a
                    class="chunk" href="#11gAMA">gAMA</a> 块，解码器几乎无法利用 <a class="chunk" href="#11cHRM">cHRM</a> 块。</p>

            <p>有关基色和 <a href="#dfn-white-point" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-white-point-4">白点</a> 的若干建议与标准，其中一些与特定技术相关，例如 CCIR 709 标准 [<cite><a class="bibref"
                        data-link-type="biblio" href="#bib-itu-r-bt.709"
                        title="ITU-R BT.709, SERIES BT: BROADCASTING SERVICE (TELEVISION). Parameter values for the HDTV standards for production and international programme exchange">ITU-R-BT.709</a></cite>]
                和 SMPTE-C 标准 [<cite><a class="bibref" data-link-type="biblio" href="#bib-smpte-170m"
                        title="Television — Composite Analog Video Signal — NTSC for Studio Applications">SMPTE-170M</a></cite>]。
            </p>

            <p>需要考虑三种情况：</p>

            <ol>
                <li>编码器是生成系统的一部分；</li>

                <li>源图像由相机或扫描仪捕获；</li>

                <li>PNG 数据流是从其他格式转换生成的。</li>
            </ol>


            <p>对于手绘或数字编辑的图像，有必要确定在创作过程中它们是在哪种显示器上被查看的。许多图像编辑程序允许指定所使用的显示器类型，这通常是因为它们在内部使用某种设备无关空间。此类程序拥有足够信息来写入有效的 <a
                    class="chunk" href="#11cHRM">cHRM</a> 和 <a class="chunk" href="#11gAMA">gAMA</a> 块，并强烈建议自动执行此操作。</p>

            <p>如果编码器作为执行全光谱渲染的计算机图像渲染器的一部分进行编译，则用于将内部设备无关颜色空间转换为 RGB 的监视器值应写入 <a class="chunk" href="#11cHRM">cHRM</a>
                块。任何超出所选 RGB 设备色域的颜色应映射到色域内；PNG 不存储超出色域的颜色。</p>

            <p>如果计算机图像渲染器直接在设备相关的 RGB 空间中进行计算，则除非场景描述和渲染参数已针对特定显示器调整，否则不应写入 <a class="chunk" href="#11cHRM">cHRM</a>
                块。在那种情况下，应使用该监视器的数据构造 <a class="chunk" href="#11cHRM">cHRM</a> 块。</p>

            <p>一些图像格式存储校准信息，可用于填充 <a class="chunk" href="#11cHRM">cHRM</a> 块。例如，TIFF 6.0 文件 [<cite><a class="bibref"
                        data-link-type="biblio" href="#bib-tiff-6.0" title="TIFF Revision 6.0">TIFF-6.0</a></cite>]
                可选择地存储校准信息，若存在此类信息，应使用其构造 <a class="chunk" href="#11cHRM">cHRM</a> 块。</p>

            <p>使用近期视频设备创建的视频很可能采用 CCIR 709 基色和 D65 <a href="#dfn-white-point" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-white-point-5">白点</a> [<cite><a class="bibref" data-link-type="biblio"
                        href="#bib-itu-r-bt.709"
                        title="ITU-R BT.709, SERIES BT: BROADCASTING SERVICE (TELEVISION). Parameter values for the HDTV standards for production and international programme exchange">ITU-R-BT.709</a></cite>]，其值列于
                <a href="#12-table121" class="table-ref" title="CCIR 709 primaries and D65 whitepoint">表 <bdi
                        class="">29</bdi></a>。
            </p>




            <table id="12-table121" class="numbered simple">
                <caption><a class="self-link" href="#12-table121">Table <bdi class="tableno">29</bdi></a> <span
                        class="table-title">
                        CCIR 709 基色与 D65 白点
                    </span></caption>

                <tbody>
                    <tr>
                        <th>&nbsp;</th>
                        <th>R</th>
                        <th>G</th>
                        <th>B</th>
                        <th>White</th>
                    </tr>

                    <tr>
                        <td>x</td>
                        <td>0.640</td>
                        <td>0.300</td>
                        <td>0.150</td>
                        <td>0.3127</td>
                    </tr>

                    <tr>
                        <td>y</td>
                        <td>0.330</td>
                        <td>0.600</td>
                        <td>0.060</td>
                        <td>0.3290</td>
                    </tr>
                </tbody>
            </table>

            <p>一个较旧但仍然流行的视频标准是 SMPTE-C [<cite><a class="bibref" data-link-type="biblio" href="#bib-smpte-170m"
                        title="Television — Composite Analog Video Signal — NTSC for Studio Applications">SMPTE-170M</a></cite>]，其值见
                <a href="#12-table122" class="table-ref" title="SMPTE-C video standard">表 <bdi class="">30</bdi></a>。
            </p>


            <table id="12-table122" class="numbered simple">
                <caption><a class="self-link" href="#12-table122">Table <bdi class="tableno">30</bdi></a> <span
                        class="table-title">
                        SMPTE-C 视频标准
                    </span></caption>

                <tbody>
                    <tr>
                        <th>&nbsp;</th>
                        <th>R</th>
                        <th>G</th>
                        <th>B</th>
                        <th>White</th>
                    </tr>

                    <tr>
                        <td>x</td>
                        <td>0.630</td>
                        <td>0.310</td>
                        <td>0.155</td>
                        <td>0.3127</td>
                    </tr>

                    <tr>
                        <td>y</td>
                        <td>0.340</td>
                        <td>0.595</td>
                        <td>0.070</td>
                        <td>0.3290</td>
                    </tr>
                </tbody>
            </table>

            <p><strong>不</strong>建议数据流格式转换器尝试将提供的图像转换为不同的 RGB 色彩空间。数据应在 PNG
                数据流中不经转换地存储，并应记录源基色的色度（如果已知）。在数据流转换时进行色彩空间变换通常不可取，原因是色域不匹配和舍入误差。与 <a href="#dfn-gamma"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-12">gamma</a>
                转换类似，最好无损地存储数据，并在图像最终显示时最多执行一次转换。</p>

            <p>另见 <a href="#13Decoder-colour-handling" class="sec-ref"><bdi class="secno">13.14 </bdi>解码器色彩处理</a>。</p>
        </section>


        <section id="12Alpha-channel-creation">
            <div class="header-wrapper">
                <h3 id="x12-3-alpha-channel-creation"><bdi class="secno">12.3 </bdi>Alpha 通道创建</h3><a class="self-link"
                    href="#12Alpha-channel-creation" aria-label="Permalink for Section 12.3"></a>
            </div>


            <p>Alpha 通道可以被看作是暂时隐藏图像透明部分的掩码，或者用来构造非矩形图像。在第一种情况下，完全透明像素的颜色值应当保留以备将来使用。在第二种情况下，透明像素不携带有用数据，仅用于填充 PNG
                所需的矩形图像区域。在这种情况下，为获得最佳压缩，应将所有完全透明像素赋予相同的颜色值。</p>

            <p>图像作者应记住，解码器可能不会完全支持透明控制（见 <a href="#13Alpha-channel-processing" class="sec-ref"><bdi class="secno">13.16
                    </bdi>Alpha 通道处理</a>）。因此，在可行的情况下，分配给透明像素的颜色应当尽量是合理的背景颜色。</p>

            <p>对于不需要完整 alpha 通道或无法承受压缩效率代价的应用，也可以使用 <a class="chunk" href="#11tRNS">tRNS</a> 透明块。</p>

            <p>如果图像有已知的背景色，应将该颜色写入 <a class="chunk" href="#11bKGD">bKGD</a> 块。即便忽略透明性的解码器也可以使用 <a class="chunk"
                    href="#11bKGD">bKGD</a> 颜色来填充未用的屏幕区域。</p>

            <p>如果原始图像具有预乘（也称为“关联”）alpha 数据，可以通过将每个样本值除以相应的 alpha 值，然后乘以图像位深的最大值，并四舍五入到最近的整数，将其转换为 PNG
                的非预乘格式。在有效的预乘数据中，样本值从不超过相应的 alpha 值，因此除法结果应始终在 0 到 1 的范围内。如果 alpha 值为零，则输出黑色（零值）。</p>
        </section>




        <section id="12Sample-depth-scaling">
            <div class="header-wrapper">
                <h3 id="x12-4-sample-depth-scaling"><bdi class="secno">12.4 </bdi>样本深度缩放</h3><a class="self-link"
                    href="#12Sample-depth-scaling" aria-label="Permalink for Section 12.4"></a>
            </div>


            <p>当编码输入样本的样本深度不能被 PNG 直接表示时，编码器应将样本缩放到 PNG 允许的样本深度。最精确的缩放方法是线性方程：</p>

            <pre
                aria-busy="false"><code class="hljs">output = floor((input * MAXOUTSAMPLE / MAXINSAMPLE) + 0.5)</code></pre>
            <p>其中输入样本的范围为 0 到 <var>MAXINSAMPLE</var>，输出范围为 0 到 <var>MAXOUTSAMPLE</var>
                （即 2<sup>sampledepth</sup>-1）。
            </p>

            <p>“左位复制”（left bit replication）可以近似线性缩放：将有效位移到最高有效位开始，并将最高有效位复制到开放的位中。该方法通常比线性缩放计算更快。</p>

            <p class="example">假设将 5 位样本扩展到 8 位。如果源样本值为 27（范围 0-31），则原始位为：</p>

            <pre aria-busy="false"><code class="hljs">4 3 2 1 0
---------
1 1 0 1 1</code></pre>
            <p>左位复制得到的值为 222：</p>

            <pre aria-busy="false"><code class="hljs">7 6 5 4 3  2 1 0
----------------
1 1 0 1 1  1 1 0
|=======|  |===|
    |      Leftmost Bits Repeated to Fill Open Bits
    |
Original Bits</code></pre>
            <p>该值与线性方程计算的值一致。左位复制通常与线性缩放给出相同的值，并且误差不会超过 1。</p>

            <p>另一种不太精确的近似是简单地左移输入值并用零填充低位。该方案无法精确生成纯白（全 1）的最大值；其总体效果是使图像略微变暗。通常不推荐此方法，但在处理大于 8
                位的样本深度时它有助于改善压缩。由于在高样本深度时零填充引入的相对误差较小，一些编码器可能选择使用它。但对于 alpha 通道数据不得使用零填充，因为许多解码器会将全零与全一的 alpha
                值视为特殊情况。因此必须在缩放数据中精确表示这两个值。</p>

            <p>当编码器写入 <a class="chunk" href="#11sBIT">sBIT</a> 块时，要求按这样的方式进行缩放：已存储样本的高位应与原始数据匹配。也就是说，如果 <a class="chunk"
                    href="#11sBIT">sBIT</a> 块指定了 S 位的样本深度，则存储数据的高 S 位应与原始 S
                位数据值一致。这样解码器可以通过右移恢复原始数据。低位没有约束。以上所有缩放方法都满足此限制。</p>

            <p>在扩展源 <a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-image-data-17">图像数据</a>
                时，建议一致地填充低位；即相同的源值应在任何像素位置生成相同的样本值。这可以通过减少不同样本值的数量来改善压缩。这并非强制要求，某些编码器可能不遵循此建议，例如它们可能对低位执行抖动以提高显示图像质量，但代价是增大文件体积。
            </p>

            <p>在某些应用中，原始源数据的范围可能不是 2 的幂次。线性缩放方程对这种情况仍然适用，而移位方法则不适用。建议在此类图像上不要写入 <a class="chunk" href="#11sBIT">sBIT</a>
                块，因为 <a class="chunk" href="#11sBIT">sBIT</a> 暗示原始数据范围正好是 0..2<sup>S</sup>-1。</p>
        </section>




        <section id="12Suggested-palettes">
            <div class="header-wrapper">
                <h3 id="x12-5-suggested-palettes"><bdi class="secno">12.5 </bdi>建议调色板</h3><a class="self-link"
                    href="#12Suggested-palettes" aria-label="Permalink for Section 12.5"></a>
            </div>


            <p>建议调色板可以作为 <a class="chunk" href="#11sPLT">sPLT</a> 块出现在任意 PNG 数据流中，或者作为 <a class="chunk"
                    href="#11PLTE">PLTE</a> 块出现在 <a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3truecolour-15">truecolor</a> PNG 数据流中。在任一情况下，建议调色板并非 <a href="#dfn-image-data"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-image-data-18">图像数据</a>
                的必需部分，但可用于在索引色显示硬件上呈现图像。对于运行在 <a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3truecolour-16">truecolor</a> 硬件上的查看器，建议调色板没有意义。</p>

            <p>当使用 <a class="chunk" href="#11sPLT">sPLT</a>
                块提供建议调色板时，建议编码器使用频率字段来指示调色板条目的相对重要性，而不是将它们全部置为零（表示未定义）。频率值最容易通过“最近邻”计数计算得到，即在不使用抖动的情况下每个 RGBA
                调色板条目的近似使用量。（在构建建议调色板的过程中，通常可以“免费”获得这些计数。）由于建议调色板包含透明信息，应针对未合成的图像来计算它。</p>

            <p>即使对于索引色图像，<a class="chunk" href="#11sPLT">sPLT</a> 也可用于为无法显示所有 <a class="chunk" href="#11PLTE">PLTE</a>
                块中颜色的查看器定义替代的简化调色板。如果 <a class="chunk" href="#11PLTE">PLTE</a> 出现在没有 <a class="chunk"
                    href="#11bKGD">bKGD</a> 块的 <a href="#3colourType" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3colourType-33">color type</a> 6 的图像中，则未指定计算调色板时所处的环境。</p>

            <p>在 <a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3truecolour-17">truecolor</a> PNG 数据流中包含建议调色板的旧方法是使用 <a class="chunk"
                    href="#11PLTE">PLTE</a> 块。如果使用此方法，应在单独的 <a class="chunk" href="#11hIST">hIST</a> 块中给出直方图（频率）。<a
                    class="chunk" href="#11PLTE">PLTE</a> 块不包含透明信息。因此，对于 <a href="#3colourType" class="internalDFN"
                    data-link-type="dfn" id="ref-for-3colourType-34">color type</a> 6（<a
                    href="#dfn-truecolor-with-alpha" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-truecolor-with-alpha-5">truecolor with alpha</a>）的图像，建议出现 <a class="chunk"
                    href="#11bKGD">bKGD</a> 块，并以在与指定背景色合成后的图像为参考来计算调色板和直方图。这一定义是为了确保为具有分数 alpha
                值的像素生成有用的调色板条目。所得的调色板可能仅对在相同背景色下呈现图像的查看器有用。建议 <a href="#dfn-png-editor" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-png-editor-4">PNG 编辑器</a> 在更改或删除 <a class="chunk"
                    href="#11bKGD">bKGD</a> 块时删除或重新计算该调色板（对于 color type 6 的图像）。</p>

            <p>对于 <a href="#3colourType" class="internalDFN" data-link-type="dfn" id="ref-for-3colourType-36">color
                    type</a> 2（<a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3truecolour-18">truecolor</a>）的图像，建议以仅参考 RGB 数据（忽略任何透明颜色规范）来计算 <a class="chunk"
                    href="#11PLTE">PLTE</a> 与 <a class="chunk" href="#11hIST">hIST</a> 块。如果数据流使用透明性（有 <a class="chunk"
                    href="#11tRNS">tRNS</a> 块），查看器可以轻松地根据其目标背景色调整所得调色板（参见 <a
                    href="#13Histogram-and-suggested-palette-usage" class="sec-ref"><bdi class="secno">13.17
                    </bdi>直方图与建议调色板的使用</a>）。</p>

            <p>在提供建议调色板方面，<a class="chunk" href="#11sPLT">sPLT</a> 块相对于 <a class="chunk" href="#11PLTE">PLTE</a> 块有下列优点：
            </p>


            <ol>
                <li>使用 <a class="chunk" href="#11sPLT">sPLT</a> 可以提供多个建议调色板。PNG 解码器可以基于名称或条目数量选择合适的调色板。
                </li>

                <li>在 <a href="#3colourType" class="internalDFN" data-link-type="dfn" id="ref-for-3colourType-37">color
                        type</a> 6（<a href="#dfn-truecolor-with-alpha" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-truecolor-with-alpha-6">truecolor with alpha</a>）的数据流中，<a class="chunk"
                        href="#11PLTE">PLTE</a> 块表示已相对于 <a class="chunk" href="#11bKGD">bKGD</a>
                    颜色进行合成的调色板，因此仅对针对该背景色显示有用。<a class="chunk" href="#11sPLT">sPLT</a> 块提供未合成的调色板，更适合解码器选择其自身背景进行显示时使用。
                </li>

                <li>因为 <a class="chunk" href="#11sPLT">sPLT</a> 为辅助块，<a href="#dfn-png-editor" class="internalDFN"
                        data-link-type="dfn" id="ref-for-dfn-png-editor-5">PNG 编辑器</a> 可以添加或修改建议调色板而不必丢弃未知的不可安全复制块。
                </li>

                <li>尽管 <a class="chunk" href="#11sPLT">sPLT</a> 块被允许在 <a href="#3colourType" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3colourType-38">color types</a> 0、3 与 4（<a
                        href="#dfn-greyscale" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-greyscale-13">greyscale</a> 与 <a href="#3indexedColour" class="internalDFN"
                        data-link-type="dfn" id="ref-for-3indexedColour-16">indexed-color</a>）的数据流中使用，但在这些情况下 <a
                        class="chunk" href="#11PLTE">PLTE</a> 块无法用于提供简化调色板。
                </li>

                <li><a class="chunk" href="#11sPLT">sPLT</a> 块中可以包含多于 256 个条目。
                </li>
            </ol>

            <p>使用 <a class="chunk" href="#11sPLT">sPLT</a> 块的 PNG 编码器也可以选择同时写入由 <a class="chunk" href="#11PLTE">PLTE</a>
                和 <a class="chunk" href="#11hIST">hIST</a> 表示的建议调色板，以便与不识别 <a class="chunk" href="#11sPLT">sPLT</a>
                块的解码器兼容。</p>
        </section>




        <section id="12Interlacing">
            <div class="header-wrapper">
                <h3 id="x12-6-interlacing"><bdi class="secno">12.6 </bdi>隔行</h3><a class="self-link"
                    href="#12Interlacing" aria-label="Permalink for Section 12.6"></a>
            </div>


            <p>本规范定义了两种隔行方法，其中一种是不隔行。隔行为解码器提供了一个便于渐进式显示图像的基础，如 <a href="#13Progressive-display" class="sec-ref"><bdi
                        class="secno">13.10 </bdi>隔行与渐进显示</a> 所述。</p>
        </section>


        <section id="12Filter-selection">
            <div class="header-wrapper">
                <h3 id="x12-7-filter-selection"><bdi class="secno">12.7 </bdi>滤波选择</h3><a class="self-link"
                    href="#12Filter-selection" aria-label="Permalink for Section 12.7"></a>
            </div>


            <p>对于 <a href="#3colourType" class="internalDFN" data-link-type="dfn" id="ref-for-3colourType-39">color
                    type</a> 3（索引色）图像，滤波类型 0（None）通常是最有效的。具有 256 色或更少颜色的彩色图像几乎总是应以 <a href="#3indexedColour"
                    class="internalDFN" data-link-type="dfn" id="ref-for-3indexedColour-17">indexed-color</a> 格式存储；以 <a
                    href="#3truecolour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3truecolour-19">truecolor</a> 格式存储可能会大得多。</p>

            <p>对于位深小于 8 的图像，也推荐使用滤波类型 0。对于低位深灰度图像，在极少数情况下，先将图像扩展到 8 位再应用滤波可能得到更好的压缩。</p>

            <p>对于 <a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3truecolour-20">truecolor</a> 和 <a href="#dfn-greyscale" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-greyscale-14">greyscale</a>
                图像，五种滤波器中的任何一种都可能是最有效的。如果编码器使用固定滤波，Paeth 滤波类型最有可能表现最好。</p>

            <p>为了在 <a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3truecolour-21">truecolor</a> 和 <a href="#dfn-greyscale" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-greyscale-15">greyscale</a>
                图像上获得最佳压缩，并且当压缩效率比压缩速度更重要时，建议使用自适应滤波：为每条扫描线选择滤波类型。每幅图像最佳的滤波集合各不相同。编码器可以尝试所有滤波组合以找到对给定图像压缩效果最佳的方案。然而，当无法进行穷尽式搜索时，以下启发式方法通常效果足够好：对每条扫描线分别用五种滤波器生成输出，并选择能使输出字节绝对值之和最小的滤波器（在此测试中将输出字节视为有符号差值）。这种方法通常优于任何单一固定滤波类型的选择。
            </p>

            <p>根据这些建议进行的滤波在与本规范定义的任一隔行方法配合时均有效。</p>
        </section>


        <section id="12Compression">
            <div class="header-wrapper">
                <h3 id="x12-8-compression"><bdi class="secno">12.8 </bdi>压缩</h3><a class="self-link"
                    href="#12Compression" aria-label="Permalink for Section 12.8"></a>
            </div>


            <p>编码器可以按任意方式将压缩后的数据流划分为 <a class="chunk" href="#11IDAT">IDAT</a> 块。（允许多个 <a class="chunk"
                    href="#11IDAT">IDAT</a> 块，以便编码器在固定内存量下工作；通常块大小对应编码器的缓冲区大小。）一个 PNG 数据流中每个 <a class="chunk"
                    href="#11IDAT">IDAT</a> 块仅包含一个数据字节的情况是有效的，尽管极其浪费空间。（<a href="#zero-length-data">零长度</a> 的 <a
                    class="chunk" href="#11IDAT">IDAT</a> 块也是有效的，但更加浪费。）</p>
        </section>


        <section id="12Text-chunk-processing">
            <div class="header-wrapper">
                <h3 id="x12-9-text-chunk-processing"><bdi class="secno">12.9 </bdi>文本块处理</h3><a class="self-link"
                    href="#12Text-chunk-processing" aria-label="Permalink for Section 12.9"></a>
            </div>


            <p>每个文本块必须提供非空关键字。如果没有更合适的描述，可以使用通用关键字 "Comment"。如果使用用户提供的关键字，编码器应检查其是否符合关键字的限制。</p>

            <p><a class="chunk" href="#11iTXt">iTXt</a> 块使用 Unicode 的 UTF-8 编码，因此可以存储任何语言的文本。<a class="chunk"
                    href="#11tEXt">tEXt</a> 与 <a class="chunk" href="#11zTXt">zTXt</a> 块使用 Latin-1（ISO
                8859-1）字符编码，这限制了这些块中可用字符的范围。编码器应优先使用 <a class="chunk" href="#11iTXt">iTXt</a>，而不是 <a class="chunk"
                    href="#11tEXt">tEXt</a> 与 <a class="chunk"
                    href="#11zTXt">zTXt</a>，以允许广泛字符而不丢失数据。编码器必须在存储文本时将使用本地传统字符编码的字符转换为相应的目标编码（参见 <a data-link-type="dfn"
                    href="https://www.w3.org/TR/i18n-glossary/#dfn-legacy-character-encodings">legacy character
                    encodings</a>）。</p>

            <p>创建 <a href="#11iTXt" class="chunk">iTXt</a> 块时，编码器应遵循 <a
                    href="https://encoding.spec.whatwg.org/#utf-8-encode">Encoding Standard</a> 中的 <a
                    href="https://encoding.spec.whatwg.org/#utf-8-encode">UTF-8 encode</a> 规范。</p>

            <p>编码器应劝阻创建长度超过 79 个 Unicode <a data-link-type="dfn"
                    href="https://www.w3.org/TR/i18n-glossary/#dfn-code-point">code points</a> 的单行文本，以便易于阅读。建议将小于 1024
                字节的文本项以未压缩文本块输出。建议将基本的标题和作者关键字使用未压缩的文本块输出。将大文本块放在 <a href="#dfn-image-data" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-image-data-19">图像数据</a> 之后（即 <a class="chunk"
                    href="#11IDAT">IDAT</a> 块之后）在某些情况下可以加快图像显示，因为解码器会先解码 <a href="#dfn-image-data" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-image-data-20">图像数据</a>。建议将小文本块（例如图像标题）放在 <a class="chunk"
                    href="#11IDAT">IDAT</a> 块之前。</p>
        </section>




        <section id="12Chunk-processing">
            <div class="header-wrapper">
                <h3 id="x12-10-chunking"><bdi class="secno">12.10 </bdi>分块（Chunking）</h3><a class="self-link"
                    href="#12Chunk-processing" aria-label="Permalink for Section 12.10"></a>
            </div>



            <section id="12Use-of-private-chunks">
                <div class="header-wrapper">
                    <h4 id="x12-10-1-use-of-private-chunks"><bdi class="secno">12.10.1 </bdi>使用私有块</h4>
                    <a class="self-link" href="#12Use-of-private-chunks" aria-label="Permalink for Section 12.10.1"></a>
                </div>


                <p>编码器 <em class="rfc2119">MAY</em> 使用私有块来携带不必被其他应用理解的信息。</p>
            </section>


            <section id="12Private-type-and-method-codes">
                <div class="header-wrapper">
                    <h4 id="x12-10-2-use-of-non-reserved-field-values"><bdi class="secno">12.10.2 </bdi>使用非保留字段值</h4><a
                        class="self-link" href="#12Private-type-and-method-codes"
                        aria-label="Permalink for Section 12.10.2"></a>
                </div>


                <p>编码器 <em class="rfc2119">MAY</em> 使用非保留的字段值进行实验或私用。</p>
            </section>


            <section id="12Ancillary">
                <div class="header-wrapper">
                    <h4 id="x12-10-3-ancillary-chunks"><bdi class="secno">12.10.3 </bdi>辅助块</h4><a class="self-link"
                        href="#12Ancillary" aria-label="Permalink for Section 12.10.3"></a>
                </div>


                <p>所有辅助块均为可选，编码器无需写入它们。不过，当相关信息可用时，鼓励编码器写入标准的辅助块。</p>
            </section>
        </section>
    </section>




    <section id="13Decoders">
        <div class="header-wrapper">
            <h2 id="x13-png-decoders-and-viewers"><bdi class="secno">13. </bdi>PNG 解码器与查看器</h2><a class="self-link"
                href="#13Decoders" aria-label="Permalink for Section 13."></a>
        </div>



        <section class="introductory" id="13Introduction">
            <div class="header-wrapper">
                <h2 id="introduction-9">简介</h2><a class="self-link" href="#13Introduction"
                    aria-label="Permalink for this Section"></a>
            </div>


            <p>本条款给出了一些关于 PNG 解码器行为与查看器行为的要求与建议。查看器将解码后的 PNG 图像呈现给用户。由于查看器与解码器行为密切相关，这里将二者一并讨论。对 PNG
                解码器的唯一绝对要求是它必须能成功读取任何符合前述章节中指定格式的数据流。然而，遵循下列附加建议通常会得到更好的效果。</p>

            <p>PNG 解码器应支持本国际标准中明确定义的所有有效的位深、<a href="#3colourType" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3colourType-40">颜色类型</a>、压缩方法、<a href="#3filter" class="internalDFN"
                    data-link-type="dfn" id="ref-for-3filter-13">滤波方法</a>和隔行方法的组合。</p>
        </section>

        <section id="error-handling">
            <div class="header-wrapper">
                <h3 id="13Decoders.Errors"><bdi class="secno">13.1 </bdi>错误处理</h3><a class="self-link"
                    href="#13Decoders.Errors" aria-label="Permalink for Section 13.1"></a>
            </div>




            <p>PNG 数据流中的错误大致可分为两类：传输错误与语法错误（见 <a href="#4Concepts.Errors" class="sec-ref"><bdi class="secno">4.10
                    </bdi>错误处理</a>）。</p>

            <p>传输错误的例子包括以“文本”或“ascii”模式传输，在此模式下字节码 13 和/或 10 可能在整个数据流中被添加、删除或转换；意外终止，即数据流被截断；或存储设备的物理错误，其中一个或多个块（通常为每块
                512 字节）会出现损坏或随机值。语法错误的例子包括行滤波器的无效值、无效的压缩方法、无效的块长度、在索引图像中第一个 <a class="chunk" href="#11IDAT">IDAT</a>
                块之前缺少 <a class="chunk" href="#11PLTE">PLTE</a> 块，或存在多个 <a class="chunk" href="#11gAMA">gAMA</a> 块。PNG
                解码器应如下处理错误：</p>


            <ol>
                <li>尽早检测到错误，利用 PNG 签名字节和每个块的 CRC。解码器应验证 PNG 签名的全部八个字节是否正确。如果接下来的八个字节以正确的块长度开始一个 <a class="chunk"
                        href="#11IHDR">IHDR</a> 块，则可进一步增强对数据流完整性的信心。在处理块数据之前应检查校验和（<abbr
                        title="Cyclic Redundancy Code">CRC</abbr>）。有时这并不现实，例如当流式 PNG 解码器正在处理一个大型 <a class="chunk"
                        href="#11IDAT">IDAT</a> 块时。在这种情况下，应在到达该块结尾时检查 <abbr title="Cyclic Redundancy Code">CRC</abbr>。
                </li>

                <li>在可能的情况下从错误中恢复；否则优雅地失败。对图像处理影响很小或没有影响的错误可以被忽略，而那些影响关键数据的错误应以适合应用的方式处理。</li>

                <li>提供有助于理解的错误描述信息，包括可恢复错误的说明。</li>
            </ol>

            <p>与此理念相关的三类 PNG
                块如下。这里定义的“未知块”要么是解码器作者确实不知道其类型的块，要么是作者选择将其视为未知的块（因为对该块类型的默认处理对程序目的已足够）。其他块称为“已知块”。在此定义下，三类为：</p>


            <ol>
                <li>已知块，这必然包括本规范中定义的所有关键块（<a class="chunk" href="#11IHDR">IHDR</a>、<a class="chunk"
                        href="#11PLTE">PLTE</a>、<a class="chunk" href="#11IDAT">IDAT</a>、<a class="chunk"
                        href="#11IEND">IEND</a>）</li>

                <li>未知的关键块（块类型第一个字节的位 5 为 0）</li>

                <li>未知的辅助块（块类型第一个字节的位 5 为 1）</li>
            </ol>

            <p>有关块命名约定的描述，请参阅 <a href="#5Chunk-naming-conventions" class="sec-ref"><bdi class="secno">5.4
                    </bdi>块命名约定</a>。</p>



            <p>PNG 块类型根据它们对提取可查看图像（例如 <a class="chunk" href="#11IHDR">IHDR</a>、<a class="chunk" href="#11PLTE">PLTE</a>
                和 <a class="chunk" href="#11IDAT">IDAT</a>）或对理解数据流结构（例如 <a class="chunk"
                    href="#11IEND">IEND</a>）的重要性，被标记为“关键”或“辅助”。这是一类特定的关键性，并不一定适用于每一种解码器。例如，仅用于提取文本注释（如版权信息）的程序并不需要可查看图像，但应能正确
                <a href="https://encoding.spec.whatwg.org/#utf-8-decode">解码 UTF-8</a>。另一个解码器可能认为 <a class="chunk"
                    href="#11tRNS">tRNS</a> 和 <a class="chunk" href="#11gAMA">gAMA</a> 块对其正确执行是必需的。
            </p>

            <p>语法错误总是牵涉到已知块，因为在未知块中不能检测出语法错误。PNG 解码器必须根据其需求和情形判断语法错误是否为致命（不可恢复）的。例如，大多数解码器可以忽略一个无效的 <a class="chunk"
                    href="#11IEND">IEND</a> 块；文本提取程序可以忽略缺少 <a class="chunk" href="#11IDAT">IDAT</a>；图像查看器无法从索引图像中空的 <a
                    class="chunk" href="#11PLTE">PLTE</a> 块中恢复，但可以忽略真彩色图像中无效的 <a class="chunk" href="#11PLTE">PLTE</a>
                块；提取 alpha 通道的程序可以忽略无效的 <a class="chunk" href="#11gAMA">gAMA</a> 块，但可能认为存在两个 <a class="chunk"
                    href="#11tRNS">tRNS</a> 块是致命错误。除语法错误外的异常情况应如下处理：</p>


            <ol>
                <li>遇到未知的辅助块从来都不是错误。该块可以简单地被忽略。</li>

                <li>遇到未知的关键块对于任何试图从数据流提取图像的解码器而言都是致命情况。若解码器忽略了关键块，则无法知道它提取的图像是否为编码器意图的图像。</li>

                <li>PNG 签名不匹配、<abbr title="Cyclic Redundancy Code">CRC</abbr>
                    不匹配或意外的流结尾表示数据流已损坏，可视为致命错误。解码器可以尝试从数据流中挽救一些内容，但损坏的程度无法预知。</li>
            </ol>

            <p>当发生致命情形时，解码器应立即失败、在适当时向用户报告错误，并可选择继续显示用户已见到的任何 <a href="#dfn-image-data" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-image-data-21">图像数据</a>（即“优雅失败”）。整个应用程序无需终止。</p>

            <p>当发生非致命错误时，解码器应在适当时向用户发出警告、从错误中恢复并继续正常处理。</p>

            <p>在解码索引色 PNG 时，如果遇到越界的索引，解码器历来在处理此错误上有不同做法。<span id="oor-index-black">将像素显示为不透明的黑色</span>
                是一种常见的错误恢复策略，并且本规范现已要求如此。旧的实现可能有所不同，因此编码器不应依赖解码器会有相同的行为。</p>

            <p>不计算 CRC 的解码器应将明显的语法错误解释为数据损坏的迹象（另见 <a href="#13Error-checking" class="sec-ref"><bdi class="secno">13.2
                    </bdi>错误检查</a>）。</p>

            <p>压缩块（<a class="chunk" href="#11IDAT">IDAT</a>、<a class="chunk" href="#11zTXt">zTXt</a>、<a class="chunk"
                    href="#11iTXt">iTXt</a>、<a class="chunk" href="#11iCCP">iCCP</a>）中的错误可能导致缓冲区溢出。<a
                    href="#dfn-deflate" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-deflate-16">deflate</a>
                解压器的实现者应防范此类可能性。</p>

            <p><abbr title="Animated PNG">APNG</abbr> 的设计允许在未读取完整个 <a href="#5DataRep">数据流</a>
                之前逐帧增量显示。这意味着有些错误可能直到动画部分播放期间才被检测到。强烈建议在遇到任何错误时，解码器应丢弃所有后续帧、停止动画并恢复显示静态图像。若在动画开始前检测到错误，应显示静态图像。如适当，可向用户显示错误信息。
            </p>

            <p>解码器应将乱序的 <abbr title="Animated PNG">APNG</abbr> 块视为错误。了解 APNG 的 <a href="#dfn-png-editor"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-png-editor-6">PNG 编辑器</a> 应使用序列号将其恢复到正确顺序。
            </p>
        </section>


        <section id="13Error-checking">
            <div class="header-wrapper">
                <h3 id="x13-2-error-checking"><bdi class="secno">13.2 </bdi>错误检查</h3><a class="self-link"
                    href="#13Error-checking" aria-label="Permalink for Section 13.2"></a>
            </div>


            <p>PNG 的错误处理理念见 <a href="#13Decoders.Errors" class="sec-ref"><bdi class="secno">13.1 </bdi>错误处理</a>。</p>

            <p>除非未知块是关键块，否则未知块类型<strong>不应</strong>被视为错误。</p>

            <p>可通过检查四个字节是否都在 41-5A 和 61-7A（十六进制）范围内来检验块类型的合理性；注意仅需对未识别的块类型执行此检查。如果已知整个数据流大小（来自文件系统信息、HTTP
                协议等），也可以检查块长度是否合理。如果不检查 CRC，丢失/添加字节或错误的块长度可能导致解码器步调错乱并将后续数据误解释为块头。</p>

            <p>对于已知长度的块，例如 <a class="chunk"
                    href="#11IHDR">IHDR</a>，解码器应将意外的块长度视为错误。本规范的将来扩展不会向现有块添加新字段；相反，会添加新的块类型来承载新信息。</p>

            <p>应检查并将已知块字段中出现的意外值（例如 <a class="chunk" href="#11IHDR">IHDR</a>
                块中的意外压缩方法）视为错误。然而，建议仅在<strong>关键</strong>块中将意外字段值视为致命错误。辅助块中的意外字段值可以通过忽略整个块并将其视为未知块来处理。（该建议假定块的 <abbr
                    title="Cyclic Redundancy Code">CRC</abbr> 已通过验证。在不检查 CRC 的解码器中，将任何意外值视为数据流损坏的迹象更为安全。）</p>

            <p>标准 PNG 图像应使用压缩方法 0 进行压缩。<a class="chunk" href="#11IHDR">IHDR</a>
                块中的压缩方法字段保留以供将来标准化或专有变体使用。解码器应检查该字节并在其含有未识别的代码时报告错误。详情见 <a href="#10Compression" class="sec-ref"><bdi
                        class="secno">10. </bdi>压缩</a>。</p>
        </section>


        <section id="13Security-considerations">
            <div class="header-wrapper">
                <h3 id="x13-3-security-considerations"><bdi class="secno">13.3 </bdi>安全注意事项</h3><a class="self-link"
                    href="#13Security-considerations" aria-label="Permalink for Section 13.3"></a>
            </div>


            <p>PNG 数据流由一系列明确定义类型的块组成。规范定义内容的块实际上可以包含任何东西，包括恶意代码。同样，<a class="chunk" href="#11IEND">IEND</a>
                块之后可能还存在数据，这些数据也可以包含任何内容，包括恶意代码。已知不存在因仅仅解码 PNG 图像而在接收者计算机上执行此类恶意代码的风险。然而，恶意应用可能将此类代码隐藏在看似无害的图像文件中，然后执行它。
            </p>

            <p>与未来块类型相关的潜在安全风险目前无法详尽规定。定义将来公共块时会考虑安全问题。未知或未实现的块类型没有额外的安全风险，因为此类块将被忽略，或者至多被复制到另一个 PNG 数据流中。</p>

            <p><a class="chunk" href="#11iTXt">iTXt</a>、<a class="chunk" href="#11tEXt">tEXt</a> 和 <a class="chunk"
                    href="#11zTXt">zTXt</a> 块包含要作为纯文本显示的关键字与数据。<a class="chunk" href="#11iCCP">iCCP</a> 与 <a
                    class="chunk" href="#11sPLT">sPLT</a> 块也包含意在显示为纯文本的关键字。如果解码器在显示这些文本时不过滤控制字符，尤其是
                ESC（转义）字符，某些系统或终端可能会出现不期望或不安全的行为。建议解码器过滤控制字符以避免此类风险；参见 <a href="#13Text-chunk-processing"
                    class="sec-ref"><bdi class="secno">13.7 </bdi>文本块处理</a>。</p>

            <p>对于 <a class="chunk" href="#eXIf">eXIf</a> 块，Exif 规范 [<cite><a class="bibref" data-link-type="biblio"
                        href="#bib-cipa-dc-008"
                        title="Exchangeable image file format for digital still cameras: Exif Version 2.32">CIPA-DC-008</a></cite>]
                并未明确要求标签的“值偏移”指针必须实际指向文件内的有效地址。该要求只是隐含的（参见描述 Exif IFD 结构的第 4.6.2 段）。无论如何，解码器应准备好遇到无效指针并适当处理它们。</p>

            <p>每个块都以长度字段开始，这使得编写对试图通过伪造块溢出缓冲区的攻击免疫的解码器更容易。每个块末尾的 <abbr title="Cyclic Redundancy Code">CRC</abbr>
                为防止意外损坏提供了稳健的防御。PNG 签名字节可早期检测常见的文件传输错误。</p>

            <p>未检查 CRC 的解码器可能遭受数据损坏。此类损坏最可能的后果是图像内像素显示错误。更糟的是，如果不检查 <abbr title="Cyclic Redundancy Code">CRC</abbr> 的 <a
                    class="chunk" href="#11IHDR">IHDR</a> 块被破坏，其宽度或高度字段被篡改，可能导致更严重的问题。参见 <a href="#13Error-checking"
                    class="sec-ref"><bdi class="secno">13.2 </bdi>错误检查</a>。</p>

            <p>不良实现的解码器可能容易发生缓冲区溢出，因为块可以非常大，最大可达 2<sup>31</sup>-1 字节。但正确编写的解码器能够处理大型块而不会遇到问题。</p>
        </section>

        <section id="Privacy-considerations">
            <div class="header-wrapper">
                <h3 id="x13-4-privacy-considerations"><bdi class="secno">13.4 </bdi>隐私注意事项</h3><a class="self-link"
                    href="#Privacy-considerations" aria-label="Permalink for Section 13.4"></a>
            </div>


            <p>一些图像编辑工具历史上通过仅将被编辑区域的 alpha 通道设为零来执行“涂黑”处理，而没有同时删除实际图像数据。仅依赖图像视觉外观的用户因此面临隐私风险，因为实际图像数据可能被轻易恢复。</p>

            <p>同样，一些图像编辑工具历史上通过重写 <span class="chunk">IHDR</span> 中的宽度和高度来执行裁剪，而不重新编码图像数据，导致图像数据超出新宽度和高度并可能被恢复。</p>

            <p>包含 <span class="chunk">eXIf</span> 块的图像可能包含自动添加的数据，例如照片的 GPS 坐标，如果用户不知道 PNG 图像包含这些数据，则可能构成隐私风险。（其他包含 Exif
                的图像格式，如 JPEG/JFIF，也存在相同的隐私风险。）</p>
        </section>


        <section id="13Chunking">
            <div class="header-wrapper">
                <h3 id="x13-5-chunking"><bdi class="secno">13.5 </bdi>分块（Chunking）</h3><a class="self-link"
                    href="#13Chunking" aria-label="Permalink for Section 13.5"></a>
            </div>


            <p>解码器应通过四字节的逐字面比较识别块类型；对块类型执行大小写转换是不正确的。解码器在遇到未知且辅助位为 1 的块时可以安全地忽略该块并继续显示图像。若在遇到未知且辅助位为
                0（表示关键块）的块时，试图提取图像的解码器应向用户指示该图像包含不能安全解释的信息。</p>

            <p>解码器应通过数值测试指定位来测试未知块类型的属性。测试字符是大写还是小写既效率低下且错误（若使用依赖于区域设置的大小写定义时）。</p>

            <p>解码器不应在保留位被设为 1 时标记为错误，因为 PNG 规范的将来某个版本可能会为该位定义含义。将该位设为 1 的块与其他未知块类型以相同方式对待即可。</p>

            <p>解码器无需测试块类型的私有位，因为该位没有功能意义，用于避免 W3C 定义的块与私人定义的块之间发生冲突。</p>

            <p>所有辅助块都是可选的；解码器可以忽略它们。然而，解码器在适当且可行时应被鼓励解释这些块。</p>
        </section>


        <section id="13Pixel-dimensions">
            <div class="header-wrapper">
                <h3 id="x13-6-pixel-dimensions"><bdi class="secno">13.6 </bdi>像素尺寸</h3><a class="self-link"
                    href="#13Pixel-dimensions" aria-label="Permalink for Section 13.6"></a>
            </div>


            <p>可以表示非方形像素（见 <a href="#11pHYs" class="sec-ref"><bdi class="secno">11.3.4.3 </bdi><span
                        class="chunk">pHYs</span> 物理像素尺寸</a>），但查看器并不被要求对其进行校正；查看器可以将任何 PNG 数据流当作其像素为方形进行呈现。</p>

            <p>当显示器的像素纵横比与 PNG 数据流中定义的物理像素尺寸的纵横比不同时，强烈建议查看器对图像进行重缩放以便正确显示。</p>

            <p>当 <a class="chunk" href="#11pHYs">pHYs</a> 块的单位说明符为 0（单位未知）时，解码器的行为可依赖于两个像素每单位值的比率，但不应依赖它们的大小。例如，包含
                <code>(ppuX, ppuY, unit) = (2, 1, 0)</code> 的 <a class="chunk" href="#11pHYs">pHYs</a> 块等价于包含
                <code>(1000, 500, 0)</code> 的块；两者同样有效地表明图像像素的高度是宽度的两倍。
            </p>

            <p>查看器处理图像与显示像素纵横比不一致的一种合理方法是仅沿水平方向或垂直方向扩展图像，而不是同时扩展两个方向。缩放因子可以使用以下浮点计算得到：</p>

            <pre><code aria-busy="false" class="hljs">image_ratio = pHYs_ppuY / pHYs_ppuX
display_ratio = display_ppuY / display_ppuX
scale_factor_X = max(1.0, image_ratio/display_ratio)
scale_factor_Y = max(1.0, display_ratio/image_ratio)</code></pre>
            <p>由于保持图像面积等其他方法也合理，并且忽略 <a class="chunk" href="#11pHYs">pHYs</a> 块也是允许的，因此作者不应假定所有查看应用都会使用此缩放方法。</p>

            <p>除为像素纵横比作校正之外，查看器可能还会出于其他原因对图像在横向和纵向上进行额外缩放。例如，查看器可能希望将过大的图像缩小以适配显示器，或将发送到高分辨率打印机的图像放大以便它们在打印后看起来与在显示器上相同大小。
            </p>
        </section>


        <section id="13Text-chunk-processing">
            <div class="header-wrapper">
                <h3 id="x13-7-text-chunk-processing"><bdi class="secno">13.7 </bdi>文本块处理</h3><a class="self-link"
                    href="#13Text-chunk-processing" aria-label="Permalink for Section 13.7"></a>
            </div>


            <p>如果可行，PNG 解码器应提供一种方式向用户显示数据流中发现的所有 <a class="chunk" href="#11iTXt">iTXt</a>、<a class="chunk"
                    href="#11tEXt">tEXt</a> 和 <a class="chunk" href="#11zTXt">zTXt</a> 块。即使解码器不识别某个文本关键字，用户也可能理解其含义。</p>

            <p>在处理 <a class="chunk" href="#11tEXt">tEXt</a> 与 <a class="chunk" href="#11zTXt">zTXt</a>
                块时，解码器可能会遇到不允许的字符。有些字符可以安全显示（例如 TAB、FF 与 CR，分别为十六进制 09、0C 与 0D），但其他字符，尤其是 ESC（十六进制
                1B），可能构成安全隐患（因为显示硬件或软件可能会执行意外动作）。解码器不应尝试直接显示在 <a class="chunk" href="#11tEXt">tEXt</a> 或 <a
                    class="chunk" href="#11zTXt">zTXt</a> 块中遇到的非 Latin-1 字符（换行与可能的 TAB 除外）。相反，应忽略这些字符或以可见记号显示，例如
                "<code>\nn</code>"。参见 <a href="#13Security-considerations" class="sec-ref"><bdi class="secno">13.3
                    </bdi>安全注意事项</a>。</p>

            <p>在处理 <a href="#11iTXt" class="chunk">iTXt</a> 块时，解码器应遵循 <a
                    href="https://encoding.spec.whatwg.org/#utf-8-decode">Encoding Standard</a> 中的 <a
                    href="https://encoding.spec.whatwg.org/#utf-8-decode">UTF-8 decode</a>。</p>

            <p>尽管建议编码器将换行表示为行结束符（十六进制 0A），但建议解码器不要依赖此约定；最好识别所有常见的换行组合（CR、LF 与 CR-LF）并将其显示为单个换行符。TAB 可扩展为足够的空格以到达列的 8
                的倍数。</p>

            <p>在使用非 Latin-1 的本地 <a data-link-type="dfn"
                    href="https://www.w3.org/TR/i18n-glossary/#dfn-legacy-character-encodings">传统字符编码</a>
                的系统上运行的解码器应重新映射字符码以便正确显示 Latin-1 字符。不受支持的字符应被替换为系统适当的替代字符（例如 U+FFFD REPLACEMENT CHARACTER、U+003F
                QUESTION MARK 或 U+001A SUB），或映射为可见记号如
                "<code>\nn</code>"。仅当字符在解码系统上为可打印字符时才应显示。某些字节值可能被解码系统解释为控制字符；出于安全考虑，在此类系统上运行的解码器不应显示这些控制字符。</p>

            <p>解码器应准备显示包含任意数量打印字符（在换行字符之间）的文本块，尽管建议编码器避免创建超过 79 个字符的行。</p>
        </section>


        <section id="13Decompression">
            <div class="header-wrapper">
                <h3 id="x13-8-decompression"><bdi class="secno">13.8 </bdi>解压缩</h3><a class="self-link"
                    href="#13Decompression" aria-label="Permalink for Section 13.8"></a>
            </div>


            <p>本规范使用的压缩技术并不要求在开始解压之前获取完整的压缩数据流。因此可以在整个解压数据流可用之前开始显示。极不可能在本规范将来的版本中采用不具备此特性的通用压缩方法。</p>

            <p>需要强调的是，<a class="chunk" href="#11IDAT">IDAT</a> 块边界没有语义意义，可以出现在压缩数据流中的任意位置。图像数据的结构（例如扫描线边界）与 <a
                    href="#dfn-deflate" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-deflate-17">deflate</a>
                块边界或 <a class="chunk" href="#11IDAT">IDAT</a> 块边界之间没有必然关联。完整的图像数据由单一的 <a href="#dfn-zlib"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-zlib-18">zlib</a> 数据流表示，并存储在若干个 <a
                    class="chunk" href="#11IDAT">IDAT</a> 块中；假定超过此点的关系是错误的。某些编码器实现可能会产生这些结构相关的数据流，但解码器不得依赖于此。</p>
        </section>


        <section id="13Filtering">
            <div class="header-wrapper">
                <h3 id="x13-9-filtering"><bdi class="secno">13.9 </bdi>滤波</h3><a class="self-link" href="#13Filtering"
                    aria-label="Permalink for Section 13.9"></a>
            </div>


            <p>为了还原滤波的效果，解码器可能需要使用同一行上前一个像素的解码值、上一行中当前像素上方的像素，以及上方像素的左侧像素。这意味着解码器至少需要始终保存一行扫描线长度的 <a
                    href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-image-data-24">图像数据</a>。尽管某些滤波类型不引用上一扫描线，解码器仍需在解码时始终存储每条扫描线，因为下一条扫描线可能使用引用它的滤波类型。详见
                <a href="#7Filtering" class="sec-ref"><bdi class="secno">7.3 </bdi>滤波</a>。
            </p>
        </section>


        <section id="13Progressive-display">
            <div class="header-wrapper">
                <h3 id="x13-10-interlacing-and-progressive-display"><bdi class="secno">13.10 </bdi>隔行与渐进显示</h3><a
                    class="self-link" href="#13Progressive-display" aria-label="Permalink for Section 13.10"></a>
            </div>


            <p>解码器必须能够读取隔行图像。如果参考图像少于五列或少于五行，则某些通道将为空。编码器和解码器应正确处理此情况。特别地，滤波类型字节仅与非空扫描线相关；在空的缩小图像中不存在滤波类型字节。</p>

            <p>在慢速传输链接上接收图像时，查看器可以通过渐进显示隔行图像来改善感知性能。这意味着当接收到每个缩小图像时，基于至今接收到的数据显示对完整图像的近似。一种简单而令人满意的效果是将每个接收到的像素扩展为一个矩形，覆盖尚未传输的位于该像素下方和右侧的位置。该过程可以由下述
                ISO C 代码描述 [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso_9899"
                        title="ISO/IEC 9899:2018 Information technology — Programming languages — C">ISO_9899</a></cite>]：
            </p>

            <pre aria-busy="false"><code class="hljs javascript"><span class="hljs-comment">/*
    variables declared and initialized elsewhere in the code:
        height, width
    functions or macros defined elsewhere in the code:
        visit(), min()
 */</span>

int starting_row[<span class="hljs-number">7</span>]  = { <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span> };
int starting_col[<span class="hljs-number">7</span>]  = { <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span> };
int row_increment[<span class="hljs-number">7</span>] = { <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span> };
int col_increment[<span class="hljs-number">7</span>] = { <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span> };
int block_height[<span class="hljs-number">7</span>]  = { <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span> };
int block_width[<span class="hljs-number">7</span>]   = { <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span> };

int pass;
long row, col;

pass = <span class="hljs-number">0</span>;
<span class="hljs-keyword">while</span> (pass &lt; <span class="hljs-number">7</span>)
{
    row = starting_row[pass];
    <span class="hljs-keyword">while</span> (row &lt; height)
    {
        col = starting_col[pass];
        <span class="hljs-keyword">while</span> (col &lt; width)
        {
            <span class="hljs-title function_">visit</span>(row, col,
                  <span class="hljs-title function_">min</span>(block_height[pass], height - row),
                  <span class="hljs-title function_">min</span>(block_width[pass], width - col));
            col = col + col_increment[pass];
        }
        row = row + row_increment[pass];
    }
    pass = pass + <span class="hljs-number">1</span>;
}</code></pre>
            <p>函数 <code>visit(row,column,height,width)</code>
                获取下一个传输的像素并绘制一个指定高度与宽度的矩形，该矩形的左上角位于指定的行与列，用像素指示的颜色填充。注意行与列以左上角的 (0,0) 为起点计数。</p>

            <p>如果查看器将接收到的图像与背景图像合并，可能更方便只绘制接收到的像素位置（即 <code>visit()</code>
                函数仅设置指定行列的像素，而不是整个矩形）。这会产生一种“渐显”效果，随着新图像逐步替换旧图像而显现。该方法的一个优点是可以在每个像素被替换时执行正确的 alpha
                或透明度处理。如前所述，按上述方式绘制矩形会覆盖背景图像的像素；如果以后接收到的那些位置的像素是完全或部分透明的，则这些背景像素可能需要被保留。这仅在背景图像未在屏外存储时成为问题。</p>
        </section>


        <section id="13Truecolour-image-handling">
            <div class="header-wrapper">
                <h3 id="x13-11-truecolor-image-handling"><bdi class="secno">13.11 </bdi>真彩色图像处理</h3><a class="self-link"
                    href="#13Truecolour-image-handling" aria-label="Permalink for Section 13.11"></a>
            </div>


            <p>为了实现 PNG 的通用可互换性目标，解码器应接受所有类型的 PNG 图像：<a href="#3indexedColour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3indexedColour-18">索引色</a>、
                <a href="#3truecolour" class="internalDFN" data-link-type="dfn" id="ref-for-3truecolour-23">真彩色</a>，以及
                <a href="#dfn-greyscale" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-greyscale-16">灰度</a>。运行在索引色显示硬件上的查看器需要能够将
                <a href="#3truecolour" class="internalDFN" data-link-type="dfn" id="ref-for-3truecolour-24">真彩色</a>
                图像降级为索引色以便显示。该过程称为“色彩量化”。
            </p>

            <p>一种简单且快速的色彩量化方法是将图像减少到一个固定的调色板。通常使用均匀色彩间隔的调色板（“色彩立方体”）以最小化每像素的计算。对于照片类图像，建议使用抖动以避免本应为平滑渐变区域出现难看的阶梯状轮廓；不过抖动会引入颗粒感，可能令人不悦。
            </p>

            <p>通过使用为特定图像专门挑选的调色板，可以显著提高渲染质量，因为色彩立方体通常包含许多在特定图像中未被使用的条目。这种方法需要更多工作：首先是选择调色板，其次是将单个像素映射到最近的可用颜色。PNG
                允许编码器提供建议调色板，但并非所有编码器都会这样做，而且建议调色板在任何情况下可能都不适用（颜色数量可能过多或过少）。因此，高质量的查看器需要具备调色板选择例程。使用大型查找表通常是以足够速度将单个像素映射到调色板条目的最可行方法。
            </p>

            <p>有许多色彩量化的实现可用。PNG 示例实现 libpng (<a
                    href="http://www.libpng.org/pub/png/libpng.html"><code>http://www.libpng.org/pub/png/libpng.html</code></a>)
                包含用于该目的的代码。</p>
        </section>


        <section id="13Sample-depth-rescaling">
            <div class="header-wrapper">
                <h3 id="x13-12-sample-depth-rescaling"><bdi class="secno">13.12 </bdi>样本深度重缩放</h3><a class="self-link"
                    href="#13Sample-depth-rescaling" aria-label="Permalink for Section 13.12"></a>
            </div>


            <p>解码器可能希望将 PNG 数据缩减到更低的样本深度（数据精度）以供显示。例如，16 位数据需要被降至 8 位以用于大多数现有显示硬件。将 8 位数据降至 5 位也很常见。</p>

            <p>最精确的缩放由线性方程实现</p>

            <p><code>output = floor((input * MAXOUTSAMPLE / MAXINSAMPLE) + 0.5)</code>
            </p>

            <p>其中</p>

            <p><code>MAXINSAMPLE = (2<sup>sampledepth</sup>)-1</code><br>
                <code>MAXOUTSAMPLE = (2<sup>desired_sampledepth</sup>)-1</code>
            </p>

            <p>稍微不那么精确的一种转换方法是简单地右移 <code>(sampledepth - desired_sampledepth)</code> 位。例如，要将 16 位样本降至 8
                位，可以丢弃低位字节。在许多情况下，移位方法对于显示来说足够精确，而且速度要快得多。（但如果正在进行 <a href="#dfn-gamma" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-gamma-13">gamma</a> 校正，则样本重缩放可以并入 <a href="#dfn-gamma"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-14">gamma</a> 校正的查找表，如 <a
                    href="#13Decoder-gamma-handling" class="sec-ref"><bdi class="secno">13.13 </bdi>解码器伽玛处理</a> 中所示。）
            </p>

            <p>如果解码器需要将样本放大（例如，若 <a href="#dfn-frame_buffer" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-frame_buffer-2">帧缓冲区</a> 的样本深度大于 PNG 图像），则应使用线性缩放或在 <a
                    href="#12Sample-depth-scaling" class="sec-ref"><bdi class="secno">12.4 </bdi>样本深度缩放</a> 中所述的左位复制方法。
            </p>

            <p>当存在 <a class="chunk" href="#11sBIT">sBIT</a> 块时，可以通过右移到 <a class="chunk" href="#11sBIT">sBIT</a>
                指定的样本深度来恢复参考的 <a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-image-data-25">图像数据</a>。注意线性缩放不必然重现原始数据，因为编码器并非必须使用线性缩放将数据放大。然而，编码器必须使用一种保留高位的方法，所以右移总是有效。这是移位在某些情况下被认为比线性缩放更精确的唯一情形。解码器不必关注
                <a class="chunk" href="#11sBIT">sBIT</a> 块；已存储的图像是一个有效的由 <a class="chunk" href="#11IHDR">IHDR</a>
                指示的样本深度的 PNG 数据流；不过，在缩放到适合显示之前利用 <a class="chunk" href="#11sBIT">sBIT</a> 恢复原始样本通常能比忽略 <a class="chunk"
                    href="#11sBIT">sBIT</a> 得到更准确的显示。
            </p>

            <p id="tRNS-compare-exactly">当将像素值与 <a class="chunk" href="#11tRNS">tRNS</a>
                块值比较以检测透明像素时，应精确进行比较。因此，透明像素检测应在降低样本精度之前完成。</p>
        </section>


        <section id="13Decoder-gamma-handling">
            <div class="header-wrapper">
                <h3 id="x13-13-decoder-gamma-handling"><bdi class="secno">13.13 </bdi>解码器伽玛处理</h3><a class="self-link"
                    href="#13Decoder-gamma-handling" aria-label="Permalink for Section 13.13"></a>
            </div>


            <p>有关 <a href="#dfn-gamma" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-15">gamma</a>
                问题的简要介绍，请参见 <a href="#C-GammaAppendix" class="sec-ref"><bdi class="secno">C. </bdi>伽玛与色度</a>。</p>

            <p>具备完整色彩管理能力的查看器会执行比此处描述的更复杂的计算。</p>

            <p>为了使图像显示程序产生正确的色调再现，必须考虑样本与显示输出之间的关系，以及显示系统的 <a href="#dfn-transfer-function" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-transfer-function-17">传递函数</a>。这可以通过计算来实现：</p>

            <p><code>sample = integer_sample / (2<sup>sampledepth</sup> - 1.0)<br>
      display_output = sample<sup>1.0/gamma</sup><br>
      display_input = inverse_display_transfer(display_output)<br>
      framebuf_sample = floor((display_input * MAX_FRAMEBUF_SAMPLE)+0.5)</code>
            </p>

            <p>其中 <var>integer_sample</var> 是来自数据流的样本值，<var>framebuf_sample</var> 是写入 <a href="#dfn-frame_buffer"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-frame-buffer-3">帧缓冲区</a>
                的值，<var>MAX_FRAMEBUF_SAMPLE</var> 是帧缓冲区样本的最大值（8 位为 255，5 位为 31，等等）。第一行将整数样本转换为归一化的浮点值（范围 0.0 到
                1.0），第二行转换为与期望显示输出强度成比例的值，第三行考虑显示系统的 <a href="#dfn-transfer-function" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-transfer-function-18">传递函数</a>，第四行将其转换为整数帧缓冲样本。零的任何正次幂仍为零。</p>

            <p>可以在第二行和第三行之间插入一步，用以调整
                <var>display_output</var>，以考虑实际观看条件与参考观看条件之间的差异。然而，这种调整需要考虑眩光、黑电平映射和色彩外观模型，这些均不能很好地用幂函数近似描述。此类计算在此不作说明。如果忽略观看条件，误差通常很小。
            </p>

            <p>显示的 <a href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-transfer-function-19">传递函数</a> 通常可用指数 <var>display_exponent</var>
                的幂函数近似，在这种情况下第二行和第三行可以合并为：</p>

            <p><code>display_input = sample<sup>1.0/(gamma * display_exponent)</sup> = sample<sup>decoding_exponent</sup></code>
            </p>

            <p>从而只需执行一次幂运算。对于彩色图像，上述计算需要分别对 R、G 和 B 值执行。</p>

            <p><a href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-value-18">gamma
                    value</a> 可以直接从 <a class="chunk" href="#11gAMA">gAMA</a> 块取得。或者，应用程序可允许用户通过影响 <a
                    href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-value-19">gamma value</a> 来调整显示图像的外观。例如，用户可以手动设置参数
                <var>user_exponent</var>（默认为 1.0），应用可以设置：
            </p>

            <pre><code aria-busy="false" class="hljs abnf"><span class="hljs-attribute">gamma</span> <span class="hljs-operator">=</span> gamma_from_file / user_exponent
decoding_exponent <span class="hljs-operator">=</span> <span class="hljs-number">1.0</span> / (gamma * display_exponent)
   <span class="hljs-operator">=</span> user_exponent / (gamma_from_file * display_exponent)</code></pre>
            <p>用户将 <var>user_exponent</var> 设大于 1 可使中间调变暗，设小于 1 可使其变亮。</p>

            <p>包含零的 <a class="chunk" href="#11gAMA">gAMA</a> 块是没有意义的，但可能误写。解码器应忽略它，编辑器可丢弃并向用户发出警告。</p>

            <p>并非必须对每个像素执行超越函数运算。可以预先计算一个查找表，为每个可能的样本值给出正确的输出值。对于 8 位精度，这只需对图像进行 256
                次计算，而不是每像素或每色度进行计算。对于索引色图像，对调色板进行一次性校正就足够，除非图像使用透明度且在非均一背景上显示。</p>

            <p>如果无法使用浮点运算，<a href="#dfn-gamma" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-16">gamma</a> 校正表可用整数算术和预计算的对数表来构建。示例代码见 [<cite><a class="bibref"
                        data-link-type="biblio" href="#bib-png-extensions"
                        title="Extensions to the PNG Third Edition Specification, Version 1.6.0">PNG-EXTENSIONS</a></cite>]。
            </p>

            <p>当输入图像的 <a href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-value-20">gamma value</a> 未知时（缺少 <a class="chunk" href="#11gAMA">gAMA</a>、<a
                    class="chunk" href="#srgb-standard-colour-space">sRGB</a> 与 <a class="chunk"
                    href="#11iCCP">iCCP</a>），独立的图像查看器应选择一个可能的默认 <a href="#dfn-gamma-value" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-gamma-value-21">gamma value</a>，但应允许用户在结果过暗或过亮时选择新的值。默认的 <a
                    href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-value-22">gamma value</a> 可能取决于关于图像的其他信息，例如它是来自互联网还是本地系统。为一致起见，文档格式（如
                HTML）或矢量图形（如 SVG）的查看器在处理嵌入或链接的未知 <a href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-value-23">gamma value</a> 的 PNG 图像时，应与处理其他未标记图像的方式保持一致。</p>

            <p>在实践中，确定应使用何种 display_exponent 常常很困难。在没有内建 <a href="#dfn-gamma" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-17">gamma</a> 校正的系统中，显示指数完全由 CRT 决定。除非有针对特定 CRT 的详细校准测量，否则应使用 2.2 的显示指数。</p>

            <p>许多现代 <a href="#dfn-frame_buffer" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-frame-buffer-6">帧缓冲</a> 具有用于执行 <a href="#dfn-gamma" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-gamma-18">gamma</a> 校正的查找表，在这些系统上显示指数值应为查找表与 CRT
                的组合指数。查看器应用内部可能无法得知查找表的内容，因而可能需要向用户询问显示系统的指数值。不幸的是，不同厂商使用不同方式来指定查找表内容，因此系统 <a href="#dfn-gamma-value"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-value-24">gamma value</a> 的解释与系统相关。
            </p>

            <p>真实显示器的响应实际上比单个数值（显示指数）所能描述的要复杂得多。如果有监视器的实际测量数据（输出亮度随电压的变化），上述计算中的第三行和第四行可以被这些测量值的查表替换，以找到最接近所需亮度的实际 <a
                    href="#dfn-frame_buffer" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-frame-buffer-7">帧缓冲</a> 值。</p>
        </section>


        <section id="13Decoder-colour-handling">
            <div class="header-wrapper">
                <h3 id="x13-14-decoder-color-handling"><bdi class="secno">13.14 </bdi>解码器色彩处理</h3><a class="self-link"
                    href="#13Decoder-colour-handling" aria-label="Permalink for Section 13.14"></a>
            </div>


            <p>有关色彩问题的参考，请参见 <a href="#C-GammaAppendix" class="sec-ref"><bdi class="secno">C. </bdi>伽玛与色度</a>。</p>

            <p>在许多情况下，PNG 数据流中的 <a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-image-data-26">图像数据</a> 会被视为设备相关的 RGB 值并直接显示（仅做适当的 <a href="#dfn-gamma"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-19">gamma</a> 校正）。这提供了最快的 PNG
                显示方式。但除非查看器使用与原始图像作者完全相同的显示硬件，否则颜色不会与作者看到的完全一致，尤其是较暗或接近中性颜色时。<a class="chunk" href="#11cHRM">cHRM</a>
                块提供了比单纯 <a href="#dfn-gamma" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-20">gamma</a> 校正更接近的颜色匹配信息。</p>

            <p><a class="chunk" href="#11cHRM">cHRM</a> 数据可用于将 <a href="#dfn-image-data" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-image-data-27">图像数据</a> 从 RGB 转换为 XYZ，继而进入感知线性的色彩空间（例如 CIE
                LAB）。颜色可以在该空间中被划分以生成最优调色板，因为在 CIE LAB 中两种颜色的几何距离与它们在视觉上的差异高度相关（不同于例如 RGB 或 XYZ 空间）。将得到的颜色调色板再转换回 RGB
                空间后，可用于显示或写入 <a class="chunk" href="#11PLTE">PLTE</a> 块。</p>

            <p>作为图像处理应用一部分的解码器也可能将 <a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-image-data-28">图像数据</a> 转换到 CIE LAB 空间以便分析。</p>

            <p>在对色彩一致性要求极高的应用（如产品设计、科学可视化、医学、建筑或广告）中，PNG 解码器可以将 <a href="#dfn-image-data" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-image-data-29">图像数据</a> 从源 RGB 转换为用于查看图像的显示器的显示 RGB 空间。这涉及计算从源
                RGB 到 XYZ 的矩阵，以及从 XYZ 到显示 RGB 的矩阵，然后合并以产生总体变换。PNG 解码器负责实现色域映射。</p>

            <p>在具有色彩管理系统（CMS）的平台上运行的解码器可以将 <a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-image-data-30">图像数据</a>、<a class="chunk" href="#11gAMA">gAMA</a> 和 <a class="chunk"
                    href="#11cHRM">cHRM</a> 值传递给 CMS 以供显示或进一步处理。</p>

            <p>提供颜色打印功能的 PNG 解码器可以使用 PostScript Level 2 中的功能，在校准的 RGB 空间或设备无关的色彩空间（如 XYZ）中指定 <a href="#dfn-image-data"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-image-data-31">图像数据</a>。这将比简单的 RGB 到 CMYK
                转换提供更好的色彩保真度。PostScript 语言参考手册 [<cite><a class="bibref" data-link-type="biblio" href="#bib-postscript"
                        title="PostScript Language Reference Manual">PostScript</a></cite>] 给出示例。此类解码器负责在源 RGB（在 <a
                    class="chunk" href="#11cHRM">cHRM</a> 块中指定）与目标打印机之间实现色域映射。随后由 PostScript 解释器负责产生所需颜色。</p>

            <p>PNG 解码器可以使用 <a class="chunk" href="#11cHRM">cHRM</a> 数据来计算颜色图像的准确灰度表示。将 RGB 转换为灰度只是计算 XYZ 的 Y（亮度）分量，这是
                R、G、B 值的加权和。权重取决于显示器类型，即 <a class="chunk" href="#11cHRM">cHRM</a> 块中的值。对于没有 <a class="chunk"
                    href="#11cHRM">cHRM</a> 块的 PNG 数据流，解码器可能希望进行此转换。在这种情况下，使用 CCIR 709 基色 [<cite><a class="bibref"
                        data-link-type="biblio" href="#bib-itu-r-bt.709"
                        title="ITU-R BT.709, SERIES BT: BROADCASTING SERVICE (TELEVISION). Parameter values for the HDTV standards for production and international programme exchange">ITU-R-BT.709</a></cite>]
                作为合理的默认值是可行的。原始的 NTSC 基色 <strong>不</strong> 应被使用，除非 PNG 图像确实是为那类显示器进行过色彩平衡的。</p>
        </section>


        <section id="13Background-colour">
            <div class="header-wrapper">
                <h3 id="x13-15-background-color"><bdi class="secno">13.15 </bdi>背景色</h3><a class="self-link"
                    href="#13Background-colour" aria-label="Permalink for Section 13.15"></a>
            </div>


            <p><a class="chunk" href="#11bKGD">bKGD</a> 块给出的背景色通常用于填充图像周围未被占用的屏幕空间，以及图像内的任何透明像素。（因此，即便图像不使用透明度，<a
                    class="chunk" href="#11bKGD">bKGD</a> 也是有效且有用的。）如果不存在 <a class="chunk" href="#11bKGD">bKGD</a>
                块，查看器需要选择一个合适的背景色。若无其他信息可用，使用例如 8 位 sRGB 色彩空间中的中灰（如 153）是一个合理的选择。透明的黑色或白色文字以及常见的深色投影在该背景上都应具有良好可读性。</p>

            <p>具有特定背景以呈现图像的查看器（例如网页浏览器）应忽略 <a class="chunk" href="#11bKGD">bKGD</a> 块，从而以其首选的背景颜色或背景图像覆盖 <a
                    class="chunk" href="#11bKGD">bKGD</a>。</p>

            <p><a class="chunk" href="#11bKGD">bKGD</a> 块给出的背景色不应被视为透明，即使它恰好与 <a class="chunk" href="#11tRNS">tRNS</a>
                块给出的颜色相匹配（或者在索引色图像的情况下，引用了被 <a class="chunk" href="#11tRNS">tRNS</a>
                标记为透明的调色板索引）。否则就必须设想“在背景之后”还有某个东西用于与之进行 <a href="#dfn-composited" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-composited-10">合成</a>。背景颜色要么被用作背景，要么被忽略；它不是 PNG 图像与其他背景之间的中间层。
            </p>

            <p>事实上，<a class="chunk" href="#11bKGD">bKGD</a> 与 <a class="chunk" href="#11tRNS">tRNS</a>
                块常常指定相同的颜色，因为这样在没有实现透明处理的解码器上，当不存在部分透明像素时，显示效果会符合预期。</p>
        </section>


        <section id="13Alpha-channel-processing">
            <div class="header-wrapper">
                <h3 id="x13-16-alpha-channel-processing"><bdi class="secno">13.16 </bdi>Alpha 通道处理</h3><a
                    class="self-link" href="#13Alpha-channel-processing" aria-label="Permalink for Section 13.16"></a>
            </div>


            <p>Alpha 通道可用于将前景图像与背景图像进行 <a href="#dfn-composited" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-composited-11">合成</a>。PNG 数据流定义前景图像和透明度掩码，但不定义背景图像。PNG
                解码器<strong>不</strong>要求支持这种最一般的情况。期望大多数解码器至少能支持相对于单一背景色的合成。</p>

            <p>用于计算合成样本值的方程为：</p>

            <pre aria-busy="false"><code class="hljs">output = alpha * foreground + (1-alpha) * background</code></pre>
            <p>其中 alpha 以及输入与输出样本值均以 0 到 1 的分数表示。该计算应在强度样本上执行（而非 <a href="#dfn-gamma" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-gamma-21">gamma</a> 编码的样本）。对于彩色图像，该计算应分别对 R、G、B 样本执行。</p>

            <p>下面的代码演示了将前景图像相对于背景图像进行合成的一般情况。它假设背景图像的原始像素数据可用，且输出目标为用于显示的 <a href="#dfn-frame_buffer"
                    class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-frame-buffer-8">帧缓冲区</a>。还存在其他变体；见代码下方的注释。该代码允许前景图像与背景图像的样本深度和 <a
                    href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-gamma-value-25">gamma 值</a> 各不相同，且未必适合显示系统。实践中在未先检查之前不应做出相等性的假设。</p>

            <p>该代码为 ISO C [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso_9899"
                        title="ISO/IEC 9899:2018 Information technology — Programming languages — C">ISO_9899</a></cite>]，在注释中加入了行号以便参考。
            </p>

            <pre aria-busy="false"><code class="hljs javascript"><span class="hljs-number">01</span>  int foreground[<span class="hljs-number">4</span>];  <span class="hljs-comment">/* image pixel: R, G, B, A */</span>
<span class="hljs-number">02</span>  int background[<span class="hljs-number">3</span>];  <span class="hljs-comment">/* background pixel: R, G, B */</span>
<span class="hljs-number">03</span>  int fbpix[<span class="hljs-number">3</span>];       <span class="hljs-comment">/* frame buffer pixel */</span>
<span class="hljs-number">04</span>  int fg_maxsample;   <span class="hljs-comment">/* foreground max sample */</span>
<span class="hljs-number">05</span>  int bg_maxsample;   <span class="hljs-comment">/* background max sample */</span>
<span class="hljs-number">06</span>  int fb_maxsample;   <span class="hljs-comment">/* frame buffer max sample */</span>
<span class="hljs-number">07</span>  int ialpha;
<span class="hljs-number">08</span>  float alpha, compalpha;
<span class="hljs-number">09</span>  float gamfg, linfg, gambg, linbg, comppix, gcvideo;

    <span class="hljs-comment">/* Get max sample values in data and frame buffer */</span>
<span class="hljs-number">10</span>  fg_maxsample = (<span class="hljs-number">1</span> &lt;&lt; fg_sample_depth) - <span class="hljs-number">1</span>;
<span class="hljs-number">11</span>  bg_maxsample = (<span class="hljs-number">1</span> &lt;&lt; bg_sample_depth) - <span class="hljs-number">1</span>;
<span class="hljs-number">12</span>  fb_maxsample = (<span class="hljs-number">1</span> &lt;&lt; frame_buffer_sample_depth) - <span class="hljs-number">1</span>;
    <span class="hljs-comment">/*
     * Get integer version of alpha.
     * Check for opaque and transparent special cases;
     * no compositing needed if so.
     *
     * We show the whole gamma decode/correct process in
     * floating point, but it would more likely be done
     * with lookup tables.
     */</span>
<span class="hljs-number">13</span>  ialpha = foreground[<span class="hljs-number">3</span>];

<span class="hljs-number">14</span>  <span class="hljs-keyword">if</span> (ialpha == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">/*
         * Foreground image is transparent here.
         * If the background image is already in the frame
         * buffer, there is nothing to do.
         */</span>
<span class="hljs-number">15</span>      ;
<span class="hljs-number">16</span>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ialpha == fg_maxsample) {
        <span class="hljs-comment">/*
         * Copy foreground pixel to frame buffer.
         */</span>
<span class="hljs-number">17</span>      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
<span class="hljs-number">18</span>          gamfg = (float) foreground[i] / fg_maxsample;
<span class="hljs-number">19</span>          linfg = <span class="hljs-title function_">pow</span>(gamfg, <span class="hljs-number">1.0</span> / fg_gamma);
<span class="hljs-number">20</span>          comppix = linfg;
<span class="hljs-number">21</span>          gcvideo = <span class="hljs-title function_">pow</span>(comppix, <span class="hljs-number">1.0</span> / display_exponent);
<span class="hljs-number">22</span>          fbpix[i] = (int) (gcvideo * fb_maxsample + <span class="hljs-number">0.5</span>);
<span class="hljs-number">23</span>      }
<span class="hljs-number">24</span>  } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">/*
         * Compositing is necessary.
         * Get floating-point alpha and its complement.
         * Note: alpha is always linear; gamma does not
         * affect it.
         */</span>
<span class="hljs-number">25</span>      alpha = (float) ialpha / fg_maxsample;
<span class="hljs-number">26</span>      compalpha = <span class="hljs-number">1.0</span> - alpha;

<span class="hljs-number">27</span>      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
            <span class="hljs-comment">/*
             * Convert foreground and background to floating
             * point, then undo gamma encoding.
             */</span>
<span class="hljs-number">28</span>          gamfg = (float) foreground[i] / fg_maxsample;
<span class="hljs-number">29</span>          linfg = <span class="hljs-title function_">pow</span>(gamfg, <span class="hljs-number">1.0</span> / fg_gamma);
<span class="hljs-number">30</span>          gambg = (float) background[i] / bg_maxsample;</code></pre>


            <pre aria-busy="false"><code class="hljs javascript"><span class="hljs-number">31</span>          linbg = <span class="hljs-title function_">pow</span>(gambg, <span class="hljs-number">1.0</span> / bg_gamma);
            <span class="hljs-comment">/*
             * Composite.
             */</span>
<span class="hljs-number">32</span>          comppix = linfg * alpha + linbg * compalpha;
            <span class="hljs-comment">/*
             * Gamma correct for display.
             * Convert to integer frame buffer pixel.
             */</span>
<span class="hljs-number">33</span>          gcvideo = <span class="hljs-title function_">pow</span>(comppix, <span class="hljs-number">1.0</span> / display_exponent);
<span class="hljs-number">34</span>          fbpix[i] = (int) (gcvideo * fb_maxsample + <span class="hljs-number">0.5</span>);
<span class="hljs-number">35</span>      }
<span class="hljs-number">36</span>  }</code></pre>
            <p>变体：</p>


            <ol>
                <li>如果输出目标是另一个 PNG 数据流而不是 <a href="#dfn-frame_buffer" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-frame-buffer-9">帧缓冲区</a>，则第 21、22、33 和 34 行应按下列方式修改

                    <pre aria-busy="false"><code class="hljs javascript"><span class="hljs-comment">/*
 * Gamma encode for storage in output datastream.
 * Convert to integer sample value.
 */</span>
gamout = <span class="hljs-title function_">pow</span>(comppix, outfile_gamma);
outpix[i] = (int) (gamout * out_maxsample + <span class="hljs-number">0.5</span>);</code></pre>此外，当 alpha
                    为零时，需要处理背景像素而非仅跳过像素。因此，第 15 行需要被用处理背景像素（而非前景像素值）的第 17-23 行的拷贝替换。
                </li>

                <li>如果输出文件、前景文件与背景文件的样本深度都相同，且三者的 <a href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-gamma-value-26">gamma 值</a> 也匹配，则无合成代码（第 14-23 行）在 alpha 为 1
                    时可简化为从输入文件复制像素值到输出文件，在 alpha 为 0 时复制背景到输出。由于在图像中绝大多数像素的 alpha 通常为零或一，这将节省大量计算。对大多数像素不需要进行 <a
                        href="#dfn-gamma" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-22">gamma</a>
                    运算。</li>

                <li>当样本深度与 <a href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-gamma-value-27">gamma 值</a> 都匹配时，看似可以跳过 <a href="#dfn-gamma" class="internalDFN"
                        data-link-type="dfn" id="ref-for-dfn-gamma-23">gamma</a> 解码/编码（第 28-31 行、33-34 行），而仅用第 32 行对 <a
                        href="#dfn-gamma" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-24">gamma</a>
                    编码的样本值执行合成。尽管这对图像质量影响不大，但如果将零和一的 alpha 视为特殊情况（如此处建议），节省的时间并不显著。</li>

                <li>如果背景图像的原始像素值不可得，只有通过显示背景图像留下的处理后 <a href="#dfn-frame_buffer" class="internalDFN"
                        data-link-type="dfn" id="ref-for-dfn-frame-buffer-10">帧缓冲</a> 像素可用，则第 30 和 31
                    行需要通过例如如下代码从帧缓冲像素值中提取强度：

                    <pre aria-busy="false"><code class="hljs javascript"><span class="hljs-comment">/*
 * Convert frame buffer value into intensity sample.
 */</span>
gcvideo = (float) fbpix[i] / fb_maxsample;
linbg = <span class="hljs-title function_">pow</span>(gcvideo, display_exponent);</code></pre>
                    不过这可能产生一些四舍五入误差，因此如果可能，最好使用原始背景像素。
                </li>

                <li>注意第 18-22 行执行的计算与在没有 alpha 通道时做的 <a href="#dfn-gamma" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-gamma-25">gamma</a> 运算是完全相同的。如果无 alpha 情况使用查找表处理，这里也可复用同一查找表。第 28-31 行与 33-34
                    行也可以用（不同的）查找表来完成。</li>

                <li>可以使用整数算术替代浮点，只要在整个过程中注意保持足够的精度以避免溢出或下溢。</li>
            </ol>

            <div class="note" role="note" id="issue-container-generatedID-22">
                <div role="heading" class="note-title marker" id="h-note-22" aria-level="4"><span>注</span></div>
                <p class="">注：在浮点运算中不需要进行溢出或下溢检查，因为输入样本值保证在 0 和 1
                    之间，合成结果也总是在输入值之间（含端点）。使用整数算术时，可能需要进行一些舍入误差分析以保证没有溢出或下溢。</p>
            </div>



            <p>在显示具有完整 alpha 通道的 PNG 图像时，将图像与某个背景（即使只是黑色）<a href="#dfn-composited" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-composited-13">合成</a> 是很重要的。忽略 alpha 通道会使那些从关联 alpha 表现转换而来的
                PNG 图像看起来错误。（当然，如果 alpha 通道是单独的透明掩码，则忽略 alpha 是一个有用的选项：它允许恢复被隐藏的图像部分。）</p>

            <p>即便解码器未实现真实合成逻辑，也可以简单地处理只包含零和一 alpha 值的图像。（对于使用 <a class="chunk" href="#11tRNS">tRNS</a> 块的 <a
                    href="#dfn-greyscale" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-greyscale-17">灰度</a>
                和 <a href="#3truecolour" class="internalDFN" data-link-type="dfn" id="ref-for-3truecolour-25">真彩色</a>
                PNG 数据流，这在隐含上为真；对于 <a href="#3indexedColour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3indexedColour-20">索引色</a> PNG 数据流，检查 <a class="chunk" href="#11tRNS">tRNS</a> 块是否仅包含 0
                与 255 之外的值是容易的。）在这种简单情形下，透明像素被替换为背景色，其他像素保持不变。</p>

            <p>如果解码器仅具备此程度的透明处理能力，它应通过将所有非零 alpha 值视为完全不透明，或通过抖动处理来应对完整 alpha 通道。对于从关联 alpha
                格式转换而来的图像，这两种方法都不会产生很好结果，但总比什么都不做要好。将完整 alpha 抖动为二值 alpha 很类似于将灰度抖动为黑白，除了所有完全透明与完全不透明的像素都应在抖动过程中保持不变。
            </p>
        </section>


        <section id="13Histogram-and-suggested-palette-usage">
            <div class="header-wrapper">
                <h3 id="x13-17-histogram-and-suggested-palette-usage"><bdi class="secno">13.17 </bdi>直方图与建议调色板的使用</h3><a
                    class="self-link" href="#13Histogram-and-suggested-palette-usage" aria-label="第 13.17 节的永久链接"></a>
            </div>


            <p>对于运行在索引色硬件上的查看器，若试图显示一幅 <a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3truecolour-26">truecolor</a> 图像，或一幅其调色板对 <a href="#dfn-frame-buffer"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-frame-buffer-12">frame buffer</a>
                来说过大的索引色图像，编码器可能在 <a class="chunk" href="#11sPLT">sPLT</a> 块中提供了一个或多个建议调色板。如果根据大小或名称等判断某个建议调色板适用，PNG
                解码器可以采用该调色板。样本深度与解码器需求不符的建议调色板可以通过样本深度重缩放进行转换（见 <a href="#13Sample-depth-rescaling" class="sec-ref"><bdi
                        class="secno">13.12 </bdi>样本深度重缩放</a>）。</p>

            <p>当背景为纯色时，查看器应将图像与建议调色板相对于该颜色进行 <a href="#dfn-composited" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-composited-14">合成</a>，然后对合成后的图像进行 RGB 调色板量化。当图像使用透明度且背景并非纯色时，通常没有哪个建议调色板是有用的。</p>

            <p>对于 <a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3truecolour-27">truecolor</a> 图像，建议调色板也可能以 <a class="chunk" href="#11PLTE">PLTE</a>
                块的形式提供。如果图像具有 <a class="chunk" href="#11tRNS">tRNS</a> 块且背景为纯色，查看器需要使建议调色板适应其所需的背景色。为此，应将最接近 <a
                    class="chunk" href="#11tRNS">tRNS</a> 颜色的调色板条目替换为所需的背景色；或者如果查看器能处理比 <a class="chunk"
                    href="#11PLTE">PLTE</a> 条目更多的颜色，则可以添加一个用于背景色的调色板条目。</p>

            <p>对于 <a href="#3colourType" class="internalDFN" data-link-type="dfn" id="ref-for-3colourType-41">color
                    type</a> 6（<a href="#dfn-truecolour-with-alpha" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-truecolour-with-alpha-7">truecolor with
                    alpha</a>）的图像，任何 <a class="chunk" href="#11PLTE">PLTE</a> 块都应该是针对以 <a class="chunk"
                    href="#11bKGD">bKGD</a> 块指定的颜色作为统一背景时的显示而设计的。若查看器打算使用不同的背景，或 <a class="chunk"
                    href="#11bKGD">bKGD</a> 块缺失，则查看器可能应忽略该调色板。查看器可以在不同于其原意的背景下使用建议调色板，但结果可能不佳。</p>

            <p>如果查看器将透明的 <a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3truecolour-28">truecolor</a> 图像呈现在比统一颜色更复杂的背景上，则建议调色板很可能不会对合成（<a href="#dfn-composited"
                    class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-composited-15">composite</a>）图像达到最优。在这种情况下，最好对 <a href="#3truecolour"
                    class="internalDFN" data-link-type="dfn" id="ref-for-3truecolour-29">truecolor</a> PNG 图像和背景图像先执行一次
                <a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3truecolour-30">truecolor</a> 合成步骤，然后对合成结果进行颜色量化。
            </p>

            <p>在 <a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3truecolour-31">truecolor</a> PNG 数据流中，如果同时出现 <a class="chunk" href="#11PLTE">PLTE</a> 和
                <a class="chunk" href="#11sPLT">sPLT</a> 块，PNG 解码器可以在两者建议的调色板之间进行选择，但应注意上文所述的不同透明语义。
            </p>

            <p><a class="chunk" href="#11sPLT">sPLT</a> 与 <a class="chunk" href="#11hIST">hIST</a> 块中的频率信息在查看器不能提供与 PNG
                数据流中调色板相同数量颜色时很有用。如果查看器仅缺少少数颜色，通常将使用频率最低的颜色从调色板中删除即可。要大幅减少颜色数量，最好选择全新的代表颜色，而不是试图使用现有调色板的子集。这等同于执行一次新的颜色量化步骤；不过现有的调色板和直方图可以作为输入数据，从而避免对
                <a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-image-data-32">IDAT</a> 块中的 <a class="chunk" href="#11IDAT">image data</a> 进行扫描。
            </p>

            <p>如果未提供建议调色板，解码器可以自行生成，不过需要对 <a class="chunk" href="#11IDAT">IDAT</a> 块中的 <a href="#dfn-image-data"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-image-data-33">image data</a>
                做一次额外遍历。或者，也可以使用一个默认调色板（可能是一个色彩立方体）。</p>

            <p>另见 <a href="#12Suggested-palettes" class="sec-ref"><bdi class="secno">12.5 </bdi>建议调色板</a>。</p>
        </section>
    </section>




    <section id="14EditorsExt">
        <div class="header-wrapper">
            <h2 id="x14-editors"><bdi class="secno">14. </bdi>编辑器</h2><a class="self-link" href="#14EditorsExt"
                aria-label="第 14 节的永久链接"></a>
        </div>



        <section id="14Additional-chunk-types">
            <div class="header-wrapper">
                <h3 id="x14-1-additional-chunk-types"><bdi class="secno">14.1 </bdi>额外的块类型</h3><a class="self-link"
                    href="#14Additional-chunk-types" aria-label="第 14.1 节的永久链接"></a>
            </div>


            <p>在考虑引入新的块类型之前，建议作者先查阅本规范以及 [<cite><a class="bibref" data-link-type="biblio" href="#bib-png-extensions"
                        title="Extensions to the PNG Third Edition Specification, Version 1.6.0">PNG-EXTENSIONS</a></cite>]
                中已有的块类型。位于 [<cite><a class="bibref" data-link-type="biblio" href="#bib-png-extensions"
                        title="Extensions to the PNG Third Edition Specification, Version 1.6.0">PNG-EXTENSIONS</a></cite>]
                的块类型预期比本规范定义的块得到的支持更少。</p>
        </section>


        <section id="14Ordering">
            <div class="header-wrapper">
                <h3 id="x14-2-behavior-of-png-editors"><bdi class="secno">14.2 </bdi>PNG 编辑器的行为</h3><a class="self-link"
                    href="#14Ordering" aria-label="第 14.2 节的永久链接"></a>
            </div>


            <p>两个 <a href="#dfn-png-editor" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-png-editor-7">PNG
                    编辑器</a> 的示例是：一个添加或修改文本块的程序，以及一个向 <a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                    id="ref-for-3truecolour-32">truecolor</a> PNG 数据流添加建议调色板的程序。普通的图像编辑器通常不是 <a href="#dfn-png-editor"
                    class="internalDFN" data-link-type="dfn" id="ref-for-dfn-png-editor-8">PNG
                    编辑器</a>，因为它们在读取图像时通常会丢弃所有无法识别的信息。</p>

            <p>为了允许向 PNG 添加新的块类型，有必要为所有块类型建立关于顺序要求的规则。否则，当 <a href="#dfn-png-editor" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-png-editor-9">PNG 编辑器</a> 遇到未知块时就不知道该如何处理。</p>

            <p>示例：考虑一个假设的新辅助块类型，它是可安全复制的，并且如果存在 <a class="chunk" href="#11PLTE">PLTE</a>，则该新块需要出现在 PLTE 之后。如果某程序尝试插入一个
                <a class="chunk" href="#11PLTE">PLTE</a> 块但不识别新块，它可能会将 PLTE 插入到错误的位置（即新块之后）。通过要求 <a
                    href="#dfn-png-editor" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-png-editor-10">PNG
                    编辑器</a> 丢弃所有未知块可以防止这种问题，但这并不是一个令人满意的方案。因此，PNG 要求此类辅助块不要有此类严格的顺序依赖。
            </p>

            <p>为在允许未来扩展的同时防止此类问题，PNG 对 <a href="#dfn-png-editor" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-png-editor-11">PNG 编辑器</a> 的行为以及块的允许顺序施加了约束。safe-to-copy 位定义了在修改数据流时对无法识别块的正确处理。</p>


            <ol>
                <li>如果某块的 safe-to-copy 位为 1，则无论 <a href="#dfn-png-editor" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-png-editor-12">PNG 编辑器</a> 是否识别该块类型，也无论对数据流的修改范围如何，该块均可以被复制到修改后的 PNG 数据流中。</li>

                <li>如果某块的 safe-to-copy 位为 0，则表示该块依赖于 <a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-image-data-34">image data</a>。如果程序对任何
                    <strong>关键</strong>块进行了任何修改（包括添加、修改、删除或重排关键块），则不应将无法识别的非安全块复制到输出的 PNG
                    数据流中。（当然，如果程序确实识别该块，它可以选择输出适当修改后的版本。）
                </li>

                <li>如果 <a href="#dfn-png-editor" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-png-editor-13">PNG 编辑器</a> 仅添加、删除、修改或重排了 <strong>辅助</strong>
                    块，则它始终被允许复制所有无法识别的辅助块。这意味着辅助块不应依赖于其他辅助块。</li>

                <li><a href="#dfn-png-editor" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-png-editor-14">PNG 编辑器</a>
                    在遇到无法识别的关键块类型时应终止，因为无法确定在修改包含该块的数据流后能否得到一个有效的数据流。（简单地丢弃该块不足以保证安全，因为该块可能对其他块的解释有未知影响。）safe/unsafe
                    机制旨在用于辅助块。关键块的 safe-to-copy 位始终为 0。</li>
            </ol>

            <p>针对块顺序的规则如下。</p>


            <ol>
                <li>在复制未知的、<strong>unsafe-to-copy</strong> 的辅助块时，<a href="#dfn-png-editor" class="internalDFN"
                        data-link-type="dfn" id="ref-for-dfn-png-editor-15">PNG 编辑器</a>
                    不得将该块相对于任何关键块移动。它可以在相同一对关键块之间的其他辅助块之间自由地重新定位该块。（这是明确的，因为如果编辑器在保留未知的 unsafe-to-copy
                    块时不会添加、删除、修改或重排关键块。）</li>

                <li>在复制未知的、<strong>safe-to-copy</strong> 的辅助块时，<a href="#dfn-png-editor" class="internalDFN"
                        data-link-type="dfn" id="ref-for-dfn-png-editor-16">PNG 编辑器</a> 不得将该块从 <a class="chunk"
                        href="#11IDAT">IDAT</a> 之前移到 <a class="chunk" href="#11IDAT">IDAT</a>
                    之后，或反之。任何其他重排都是允许的。（这是明确的，因为 <a class="chunk" href="#11IDAT">IDAT</a> 总是存在。）</li>

                <li>在复制已知的辅助块类型时，编辑器只需遵守该特定块类型存在的具体块顺序规则。然而，它总是可以选择应用上面的一般规则。</li>
            </ol>

            <p>这些规则以从输入数据流向输出数据流复制块来表达，但如果在原地修改 PNG 数据流，规则以显而易见的方式同样适用。</p>

            <p>另见 <a href="#5Chunk-naming-conventions" class="sec-ref"><bdi class="secno">5.4 </bdi>块命名约定</a>。</p>

            <p>那些不改变 <a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-image-data-35">image data</a> 的 <a href="#dfn-png-editor" class="internalDFN"
                    data-link-type="dfn" id="ref-for-dfn-png-editor-17">PNG 编辑器</a> 不应更改 <a class="chunk"
                    href="#11tIME">tIME</a> 块。<a class="chunk" href="#11tEXt">tEXt</a>、<a class="chunk"
                    href="#11zTXt">zTXt</a> 与 <a class="chunk" href="#11iTXt">iTXt</a> 块中的 Creation Time 关键字可用于用户提供的时间。
            </p>
        </section>


        <section id="14Ordering-of-chunks">
            <div class="header-wrapper">
                <h3 id="x14-3-ordering-of-chunks"><bdi class="secno">14.3 </bdi>块的排序</h3><a class="self-link"
                    href="#14Ordering-of-chunks" aria-label="第 14.3 节的永久链接"></a>
            </div>



            <section id="14Ordering-of-critical-chunks">
                <div class="header-wrapper">
                    <h4 id="x14-3-1-ordering-of-critical-chunks"><bdi class="secno">14.3.1 </bdi>关键块的排序</h4><a
                        class="self-link" href="#14Ordering-of-critical-chunks" aria-label="第 14.3.1 节的永久链接"></a>
                </div>


                <p>关键块可能具有任意的排序要求，因为 <a href="#dfn-png-editor" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-png-editor-18">PNG 编辑器</a> 被要求在遇到未知关键块时终止。例如 <a class="chunk"
                        href="#11IHDR">IHDR</a> 有明确的排序规则：它必须始终出现在首位。能生成某个关键块类型的 PNG 编辑器或任何写 PNG 的程序都应了解并遵循该关键块的排序规则。</p>
            </section>


            <section id="14Ordering-of-ancillary-chunks">
                <div class="header-wrapper">
                    <h4 id="x14-3-2-ordering-of-ancillary-chunks"><bdi class="secno">14.3.2 </bdi>辅助块的排序</h4><a
                        class="self-link" href="#14Ordering-of-ancillary-chunks" aria-label="第 14.3.2 节的永久链接"></a>
                </div>


                <p>对某个辅助块类型最严格的排序规则是：</p>


                <ol>
                    <li>unsafe-to-copy 的块相对于关键块可能有排序要求。</li>

                    <li>safe-to-copy 的块相对于 <a class="chunk" href="#11IDAT">IDAT</a> 可能有排序要求。</li>
                </ol>

                <p>任何特定辅助块类型的实际排序规则可能更宽松。参见例如标准辅助块类型在 <a href="#5ChunkOrdering" class="sec-ref"><bdi class="secno">5.6
                        </bdi>块排序</a> 中的排序规则。</p>

                <p>解码器不得对任何辅助块的位置做出超过块排序规则规定的假设。特别地，绝不可假定某一特定辅助块类型相对于其他辅助块有某种特定位置。</p>

                <p>示例：假定某私有辅助块总是写在 <a class="chunk" href="#11IEND">IEND</a> 之前，将其视为不变的位置是不安全的。即便某应用总是在该位置写入该块，某个 <a
                        href="#dfn-png-editor" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-png-editor-19">PNG 编辑器</a> 也可能在其后插入其他辅助块。但可以安全地假定该块仍将位于 <a class="chunk"
                        href="#11IDAT">IDAT</a> 与 <a class="chunk" href="#11IEND">IEND</a> 之间的某处。</p>
            </section>
        </section>
    </section>




    <div id="15Conformance">
    </div>

    <section id="conformance">
        <div class="header-wrapper">
            <h2 id="x15-conformance"><bdi class="secno">15. </bdi>一致性</h2><a class="self-link" href="#conformance"
                aria-label="Permalink for Section 15."></a>
        </div>
        <p>除了被标记为非规范性的章节外，本规范中的所有创作指南、图表、示例和注释均为非规范性。规范性内容为本规范中未被标记为非规范性的其他所有部分。</p>
        <p>
            文档中出现的关键字 <em class="rfc2119">MAY</em>、<em class="rfc2119">MUST</em>、<em class="rfc2119">SHALL</em>、
            <em class="rfc2119">SHOULD</em> 和 <em class="rfc2119">SHOULD NOT</em> 应按
            <a href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119"
                    title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a
                    class="bibref" data-link-type="biblio" href="#bib-rfc8174"
                    title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
            中所述的方式解释，但仅当这些关键字以全大写形式出现时才按此解释，如本文所示。
        </p>
        <section id="conformance-0">
            <div class="header-wrapper">
                <h3 id="x15-1-conformance"><bdi class="secno">15.1 </bdi>一致性</h3><a class="self-link"
                    href="#conformance-0" aria-label="Permalink for Section 15.1"></a>
            </div>


        </section>
        <section id="15ConfIntro">
            <div class="header-wrapper">
                <h3 id="x15-2-introduction"><bdi class="secno">15.2 </bdi>简介</h3><a class="self-link"
                    href="#15ConfIntro" aria-label="Permalink for Section 15.2"></a>
            </div>



            <section id="15ConfObjectives">
                <div class="header-wrapper">
                    <h4 id="x15-2-1-objectives"><bdi class="secno">15.2.1 </bdi>目标</h4><a class="self-link"
                        href="#15ConfObjectives" aria-label="Permalink for Section 15.2.1"></a>
                </div>


                <p>本条款讨论 PNG 数据流、PNG 编码器、PNG 解码器以及 <a href="#dfn-png-editor" class="internalDFN" data-link-type="dfn"
                        id="ref-for-dfn-png-editor-20">PNG 编辑器</a> 的一致性。</p>

                <p>本条款规范的主要目标是：</p>


                <ol>
                    <li>通过消除对本规范的任意子集或扩展来促进互操作性；</li>

                    <li>促进一致的一致性测试开发；</li>

                    <li>促进 PNG 编码器、解码器和编辑器之间的一致结果；</li>

                    <li>便于自动化测试生成。</li>
                </ol>
            </section>


            <section id="15ConfScope">
                <div class="header-wrapper">
                    <h4 id="x15-2-2-scope"><bdi class="secno">15.2.2 </bdi>范围</h4><a class="self-link"
                        href="#15ConfScope" aria-label="Permalink for Section 15.2.2"></a>
                </div>


                <p>一致性定义针对 PNG 数据流以及 PNG 编码器、解码器和编辑器。</p>

                <p>本条款涉及 PNG 数据流和实现要求，包括 PNG 编码器、PNG 解码器以及 <a href="#dfn-png-editor" class="internalDFN"
                        data-link-type="dfn" id="ref-for-dfn-png-editor-21">PNG 编辑器</a>
                    可允许的差异范围。本条款不直接涉及编码器、解码器或编辑器的环境、性能或资源需求。</p>

                <p>本条款的范围限于开放交换 PNG 数据流的规则。</p>
            </section>
        </section>


        <section id="15ConformanceConf">
            <div class="header-wrapper">
                <h3 id="x15-3-conformance-conditions"><bdi class="secno">15.3 </bdi>一致性条件</h3><a class="self-link"
                    href="#15ConformanceConf" aria-label="Permalink for Section 15.3"></a>
            </div>



            <section id="15FileConformance">
                <div class="header-wrapper">
                    <h4 id="x15-3-1-conformance-of-png-datastreams"><bdi class="secno">15.3.1 </bdi>PNG 数据流一致性</h4><a
                        class="self-link" href="#15FileConformance" aria-label="Permalink for Section 15.3.1"></a>
                </div>


                <p>PNG 数据流在满足以下条件时视为符合本规范。</p>

                <ol>
                    <li>PNG 数据流以 PNG 签名作为首个内容（参见 <a href="#5PNG-file-signature" class="sec-ref"><bdi class="secno">5.2
                            </bdi>PNG 签名</a>）。
                    </li>

                    <li>关于本国际标准中定义的块类型：
                        <ul>
                            <li>PNG 数据流在 PNG 签名之后立即包含第一个块为 <a class="chunk" href="#11IHDR">IHDR</a> 块；
                            </li>

                            <li>PNG 数据流的最后一个块为 <a class="chunk" href="#11IEND">IEND</a> 块。
                            </li>
                        </ul>
                    </li>

                    <li>在 <a class="chunk" href="#11IEND">IEND</a> 块之后不得有任何块或其他内容。</li>

                    <li>其中包含的所有块均符合本规范中相应块类型的规范。PNG 数据流应遵守本规范中定义的块类型之间的关系。</li>

                    <li>PNG 数据流中块的顺序应遵守本国际标准中规定的排序关系。</li>

                    <li>PNG 数据流中的所有字段值应遵守本规范所规定的关系，从而产生本规范所定义的结构。</li>

                    <li>PNG 数据流中不得出现本规范未指定的块，除非按照本规范定义的新块类型创建规则定义的块。</li>

                    <li>PNG 数据流应按照本国际标准的规则进行编码。</li>
                </ol>
            </section>




            <section id="15ConformanceEncoder">
                <div class="header-wrapper">
                    <h4 id="x15-3-2-conformance-of-png-encoders"><bdi class="secno">15.3.2 </bdi>PNG 编码器一致性</h4><a
                        class="self-link" href="#15ConformanceEncoder" aria-label="Permalink for Section 15.3.2"></a>
                </div>


                <p>PNG 编码器在满足以下条件时视为符合本规范。</p>


                <ol>
                    <li>该 PNG 编码器生成的所有 PNG 数据流均为符合性的 PNG 数据流。</li>

                    <li>在对具有无法由 PNG 直接表示的样本深度的输入样本进行编码时，编码器将样本缩放到 PNG 允许的下一较高样本深度。数据按使高位位与原始数据匹配的方式进行缩放。</li>

                    <li>
                        <a href="#dfn-private-field-values" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-private-field-values-5">私有字段值</a> 在对任何方法或类型字段进行实验性或私有定义时可被使用。
                    </li>
                </ol>
            </section>


            <section id="15ConformanceDecoder">
                <div class="header-wrapper">
                    <h4 id="x15-3-3-conformance-of-png-decoders"><bdi class="secno">15.3.3 </bdi>PNG 解码器一致性</h4><a
                        class="self-link" href="#15ConformanceDecoder" aria-label="Permalink for Section 15.3.3"></a>
                </div>


                <p>PNG 解码器在满足以下条件时视为符合本规范。</p>


                <ol>
                    <li>它能够读取任何符合本国际标准的 PNG 数据流，包括那些类型可能无法识别的公共和私有块。</li>

                    <li>它支持所有标准化的关键块，以及符合本国际标准的任何 PNG 数据流中的所有标准化压缩、滤波和隔行方法与类型。</li>

                    <li>对未知块类型的处理应按 <a href="#5Chunk-naming-conventions" class="sec-ref"><bdi class="secno">5.4
                            </bdi>块命名约定</a> 中的描述进行。未知块类型<strong>不</strong>应被视为错误，除非它是关键块。</li>

                    <li>已知块字段中出现的意外值（例如 <a class="chunk" href="#11IHDR">IHDR</a> 块中出现意外的压缩方法）应被视为错误并处理。</li>

                    <li>应处理所有类型的 PNG 图像（索引色、<a href="#3truecolour" class="internalDFN" data-link-type="dfn"
                            id="ref-for-3truecolour-33">真彩色</a>、<a href="#dfn-greyscale" class="internalDFN"
                            data-link-type="dfn" id="ref-for-dfn-greyscale-18">灰度</a>、<a
                            href="#dfn-truecolor-with-alpha" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-truecolor-with-alpha-8">带 alpha 的真彩色</a> 和 <a
                            href="#dfn-greyscale-with-alpha" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-greyscale-with-alpha-4">带 alpha 的灰度</a>）。例如，运行在索引色显示硬件上的查看器的一部分的解码器，应将 <a
                            href="#3truecolour" class="internalDFN" data-link-type="dfn"
                            id="ref-for-3truecolour-34">真彩色</a> 图像降为索引格式以便显示。</li>

                    <li>当遇到辅助位为 0 的未知块时，如果解码器正在尝试提取图像，则应产生错误。</li>

                    <li>当块类型的保留位被设置时，应将其视为未知块类型进行处理。</li>

                    <li>支持 <a class="chunk sec-ref" href="#11IHDR"><bdi class="secno">11.2.1 </bdi><span
                                class="chunk">IHDR</span> Image header</a> 中定义的所有有效的位深与 <a href="#3colourType"
                            class="internalDFN" data-link-type="dfn" id="ref-for-3colourType-42">颜色类型</a> 组合。</li>

                    <li>如果在 <a class="chunk" href="#11IHDR">IHDR</a> 块的位深、<a href="#3colourType" class="internalDFN"
                            data-link-type="dfn" id="ref-for-3colourType-43">颜色类型</a>、压缩方法、<a href="#3filter"
                            class="internalDFN" data-link-type="dfn"
                            id="ref-for-3filter-14">滤波方法</a>或隔行方法字节中遇到无法识别的值，应报告错误。</li>

                    <li>在处理 <a class="chunk" href="#11tRNS">tRNS</a> 块中对 16 位 <a href="#dfn-greyscale"
                            class="internalDFN" data-link-type="dfn" id="ref-for-dfn-greyscale-19">灰度</a> 或 <a
                            href="#3truecolour" class="internalDFN" data-link-type="dfn"
                            id="ref-for-3truecolour-35">真彩色</a> 数据时，应对样本值的两个字节都进行评估以确定像素是否透明。</li>

                    <li>在处理由压缩方法 0 压缩的图像时，解码器仅假定完整的 <a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-image-data-36">图像数据</a> 由一个压缩数据流表示，并存储在若干 <a class="chunk"
                            href="#11IDAT">IDAT</a> 块中。</li>

                    <li>除非块排序规则另有规定，否则不得对任何辅助块的位置做出假设。</li>
                </ol>
            </section>


            <section id="15ConformanceEditor">
                <div class="header-wrapper">
                    <h4 id="x15-3-4-conformance-of-png-editors"><bdi class="secno">15.3.4 </bdi>PNG 编辑器一致性</h4><a
                        class="self-link" href="#15ConformanceEditor" aria-label="Permalink for Section 15.3.4"></a>
                </div>


                <p><a href="#dfn-png-editor" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-png-editor-22">PNG
                        编辑器</a> 在满足以下条件时视为符合本规范。</p>

                <ol>
                    <li>它符合 PNG 编码器的要求。</li>

                    <li>它符合 PNG 解码器的要求。</li>

                    <li>它能够编码它所解码的所有块。</li>

                    <li>它在 <a href="#5ChunkOrdering" class="sec-ref"><bdi class="secno">5.6 </bdi>块排序</a>
                        规则范围内保留所呈现的块的顺序。</li>

                    <li>它正确处理 safe-to-copy 位信息，并在 safe-to-copy 规则允许时保留未知块。</li>

                    <li>除非用户明确允许有损操作或编辑器发出警告，否则它应保留重构参考图像所需的所有信息（使参考图像能够被精确重建），但如果 alpha 通道仅包含零和最大值，则 alpha
                        通道的样本深度无需保留。允许执行诸如更改 <a href="#3colourType" class="internalDFN" data-link-type="dfn"
                            id="ref-for-3colourType-44">颜色类型</a> 或重新排列 <a href="#3indexedColour" class="internalDFN"
                            data-link-type="dfn" id="ref-for-3indexedColour-21">索引色</a>
                        数据流中的调色板等操作，前提是新的数据流以无损方式表示相同的参考图像。</li>
                </ol>
            </section>
        </section>
    </section>




    <section class="appendix" id="A-Conventions">
        <div class="header-wrapper">
            <h2 id="IANA-registrations"><bdi class="secno">A. </bdi>Internet 媒体类型</h2><a class="self-link"
                href="#IANA-registrations" aria-label="Permalink for Appendix A."></a>
        </div>





        <section id="image-png">
            <div class="header-wrapper">
                <h3 id="A-Media-type"><bdi class="secno">A.1 </bdi>image/png</h3><a class="self-link"
                    href="#A-Media-type" aria-label="Permalink for Appendix A.1"></a>
            </div>


            <p>本附录更新了现有的 <span class="tt">image/png</span> Internet 媒体类型，归入顶级类型 <span class="tt">image</span>。本附录符合 <a
                    href="https://www.rfc-editor.org/info/bcp13">BCP 13</a> 与 <a
                    href="https://www.w3.org/2020/01/registering-mediatypes.html">W3CRegMedia</a> 的要求。</p>

            <dl>
                <dt>媒体类型名称：</dt>

                <dd>image</dd>

                <dt>媒体子类型名称：</dt>

                <dd>png</dd>

                <dt>必需参数：</dt>

                <dd>无</dd>

                <dt>可选参数：</dt>

                <dd>无</dd>

                <dt>编码注意事项：</dt>

                <dd>二进制</dd>

                <dt>安全注意事项：</dt>

                <dd>
                    <p>PNG 文档由一组明确定义类型的“块”组成。对于 PNG 规范中定义的每一种块类型（除 <span class="chunk">gIFx</span>
                        外），这些块产生的唯一影响是导致图像在接收方的显示器或打印机上呈现。</p>

                    <p><span class="chunk">gIFx</span>
                        块类型用于封装应用扩展数据，对该数据的某些使用可能存在安全风险，尽管目前未知具体风险。同样，未来未注册的块类型的安全风险也无法评估。然而，PNG
                        工作组的意图是禁止包含“可执行”数据的块成为已注册的块。</p>

                    <p>文本块 <a class="chunk" href="#11tEXt">tEXt</a>、<a class="chunk" href="#11iTXt">iTXT</a> 与 <a
                            class="chunk" href="#11zTXt">zTXt</a>
                        包含可作为注释等显示的数据。某些操作系统或终端可能允许显示内嵌控制字符的文本数据来执行诸如重新映射键、创建文件等操作。因此，规范建议在直接显示前对文本块进行控制字符过滤。</p>

                    <p>PNG 格式专为便于及早检测文件传输错误而设计，并使用循环冗余校验来确保其块中数据的完整性。</p>
                </dd>

                <dt>互操作性注意事项：</dt>

                <dd>整个规范中使用网络字节顺序。</dd>

                <dt>已发布规范：</dt>

                <dd>
                    <a href="https://www.w3.org/TR/PNG/">Portable Network Graphics (PNG) Specification</a>, <a
                        href="https://www.w3.org/TR/PNG/">https://www.w3.org/TR/PNG/</a>
                </dd>

                <dt>使用此媒体的应用：</dt>

                <dd>PNG 在所有 Web 浏览器、图像查看器和图像创建工具中被广泛实现</dd>

                <dt>片段标识符注意事项：</dt>

                <dd>不适用</dd>

                <dt>使用限制：</dt>

                <dd>不适用</dd>

                <dt>是否为临时注册？（仅标准树）：</dt>

                <dd>否</dd>

                <dt>附加信息：</dt>

                <dd>
                    <dl>
                        <dt>该类型的已弃用别名：</dt>

                        <dd>不适用</dd>

                        <dt>魔术数字：</dt>

                        <dd>89 50 4E 47 0D 0A 1A 0A</dd>

                        <dt>文件扩展名：</dt>

                        <dd>.png</dd>

                        <dt>Macintosh 文件类型代码：</dt>

                        <dd>PNGf</dd>

                        <dt>对象标识符：</dt>

                        <dd>不适用</dd>
                    </dl>
                </dd>

                <dt>一般性说明：</dt>

                <dd>
                    <p>此注册更新了早先的注册：</p>

                    <ol>
                        <li>早先的注册指向一个已过期的 Internet 草案。本次更新指向一个 <abbr title="World Wide Web Consortium">W3C</abbr> 推荐。
                        </li>

                        <li>早先的联系人已故。新的联系人电子邮件为 PNG 工作组的公开归档 <abbr title="World Wide Web Consortium">W3C</abbr> 邮件列表。
                        </li>

                        <li>变更控制者为 <abbr title="World Wide Web Consortium">W3C</abbr></li>
                    </ol>
                </dd>

                <dt>如需更多信息的联系人：</dt>

                <dd>
                    <dl>
                        <dt>名称：</dt>

                        <dd>PNG Working Group</dd>

                        <dt>电子邮件：</dt>

                        <dd>
                            <a href="mailto:public-png@w3.org">public-png@w3.org</a>
                        </dd>
                    </dl>
                </dd>

                <dt>预期用途：</dt>

                <dd>通用</dd>

                <dt>作者/变更控制者：</dt>

                <dd><abbr title="World Wide Web Consortium">W3C</abbr></dd>
            </dl>
        </section>

        <section id="image-apng">
            <div class="header-wrapper">
                <h3 id="a-2-image-apng"><bdi class="secno">A.2 </bdi>image/apng</h3><a class="self-link"
                    href="#image-apng" aria-label="Permalink for Appendix A.2"></a>
            </div>


            <p>本附录符合 <a href="https://www.rfc-editor.org/info/bcp13">BCP 13</a> 与 <a
                    href="https://www.w3.org/2020/01/registering-mediatypes.html">W3CRegMedia</a> 的要求。</p>

            <dl>
                <dt>媒体类型名称：</dt>

                <dd>image</dd>

                <dt>媒体子类型名称：</dt>

                <dd>apng</dd>

                <dt>必需参数：</dt>

                <dd>不适用</dd>

                <dt>可选参数：</dt>

                <dd>不适用</dd>

                <dt>编码注意事项：</dt>

                <dd>二进制</dd>

                <dt>安全注意事项：</dt>

                <dd>
                    <p><abbr title="Animated PNG">APNG</abbr> 文档由一组明确定义类型的“块”组成。对于 PNG 规范中定义的每一种块类型（除 <span
                            class="chunk">gIFx</span> 外），这些块产生的影响仅是导致动画图像在接收方的显示器上呈现。</p>

                    <p><span class="chunk">gIFx</span>
                        块用于封装应用扩展数据，对该数据的某些使用可能存在安全风险，尽管目前未知具体风险。同样，未来未注册的块类型的安全风险也无法评估。不过，PNG 工作组意图禁止包含“可执行”数据的块成为已注册块。
                    </p>

                    <p>文本块 <a class="chunk" href="#11tEXt">tEXt</a>、<a class="chunk" href="#11iTXt">iTXt</a> 与 <a
                            class="chunk" href="#11zTXt">zTXt</a>
                        包含可作为注释等显示的数据。某些操作系统或终端可能允许显示内嵌控制字符的文本数据来执行诸如重新映射键、创建文件等操作。因此，规范建议在直接显示前对文本块进行控制字符过滤。</p>

                    <p>PNG 格式专为便于及早检测文件传输错误而设计，并使用循环冗余校验来确保其块中数据的完整性。</p>

                    <p>如果创建了包含不相关静态图像块和动画图像块的 <abbr title="Animated PNG">APNG</abbr> 文件，那么使用不支持 APNG
                        的工具的人只会看到静态图像而不会意识到有附加内容。这可能被用于例如规避审核。</p>
                </dd>

                <dt>互操作性注意事项：</dt>

                <dd>无</dd>

                <dt>已发布规范：</dt>

                <dd>
                    <a href="https://www.w3.org/TR/png/">Portable Network Graphics (PNG) Specification</a>, <a
                        href="https://www.w3.org/TR/png/">https://www.w3.org/TR/png/</a>
                </dd>

                <dt>使用此媒体的应用：</dt>

                <dd>Animated PNG (<abbr title="Animated PNG">APNG</abbr>) 在所有 Web 浏览器中被广泛实现，并且在图像查看器、动画与图像创建工具中日益可用</dd>

                <dt>片段标识符注意事项：</dt>

                <dd>不适用</dd>

                <dt>使用限制：</dt>

                <dd>不适用</dd>

                <dt>是否为临时注册？（仅标准树）：</dt>

                <dd>否</dd>

                <dt>附加信息：</dt>

                <dd>
                    <dl>
                        <dt>该类型的已弃用别名：</dt>

                        <dd>image/vnd.mozilla.apng</dd>

                        <dt>魔术数字：</dt>

                        <dd>89 50 4E 47 0D 0A 1A 0A</dd>

                        <dt>文件扩展名：</dt>

                        <dd>.apng</dd>

                        <dt>对象标识符：</dt>

                        <dd>不适用</dd>
                    </dl>
                </dd>

                <dt>一般性说明：</dt>

                <dd>
                    <p>image/apng 自 2015 年起已被广泛非注册使用。动画 PNG 在 2022 年之前并非官方 PNG 规范的一部分。本次注册以及 PNG 规范（第 3
                        版）将官方文档与已广泛部署的现实对齐。</p>
                </dd>

                <dt>如需更多信息的联系人：</dt>

                <dd>
                    <dl>
                        <dt>名称：</dt>

                        <dd>PNG Working Group</dd>

                        <dt>电子邮件：</dt>

                        <dd>
                            <a href="mailto:public-png@w3.org">public-png@w3.org</a>
                        </dd>
                    </dl>
                </dd>

                <dt>预期用途：</dt>

                <dd>通用</dd>

                <dt>作者/变更控制者：</dt>

                <dd><abbr title="World Wide Web Consortium">W3C</abbr></dd>
            </dl>
        </section>
    </section>




    <section class="appendix informative" id="B-NewChunksAppendix">
        <div class="header-wrapper">
            <h2 class="Annex" id="newchunks"><bdi class="secno">B. </bdi>私有块类型指导原则</h2><a class="self-link"
                href="#newchunks" aria-label="Permalink for Appendix B."></a>
        </div>
        <p><em>本节为非规范性内容。</em></p>




        <p>下面规定了定义私有块的指导原则：</p>


        <ol>
            <li>不要定义会重定义已有块含义或改变对现有标准化块解释的新块，例如，不要新增一个块来声明 RGB 与 alpha 值实际表示 CMYK。
            </li>

            <li>尽量减少私有块的使用以提高可移植性。</li>

            <li>避免定义依赖于整个数据流内容的块。如果必须定义此类块，请将它们设为关键块。</li>

            <li>对于可以用 Latin-1 表示的文本信息，避免定义新块类型。使用带有合适关键字以标识信息类型的 <a class="chunk" href="#11tEXt">tEXt</a> 或 <a
                    class="chunk" href="#11zTXt">zTXt</a> 块。对于不能用 Latin-1 表示但可用 UTF-8 表示的文本信息，使用带有合适关键字的 <a
                    class="chunk" href="#11iTXt">iTXt</a> 块。
            </li>

            <li>将相互依赖的辅助信息组合到单个块中。这样可避免引入块排序关系的需要。</li>

            <li>避免定义私有的关键块。</li>
        </ol>
    </section>




    <section class="appendix informative" id="C-GammaAppendix">
        <div class="header-wrapper">
            <h2 class="Annex" id="gammachromaticity"><bdi class="secno">C. </bdi>伽玛与色度</h2><a class="self-link"
                href="#gammachromaticity" aria-label="Permalink for Appendix C."></a>
        </div>
        <p><em>本节为非规范性内容。</em></p>




        <p>一个 <a href="#dfn-gamma-value" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-value-28">gamma
                value</a>（伽玛值）是用来描述在图像采集与重现中遇到的某些非线性 <a href="#dfn-transfer-function" class="internalDFN"
                data-link-type="dfn" id="ref-for-dfn-transfer-function-20">传递函数</a> 近似的数值参数。<a href="#dfn-gamma-value"
                class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gamma-value-29">伽玛值</a> 是幂律函数中的指数。
            例如下列函数：</p>

        <p><code>intensity = (voltage + constant)<sup>exponent</sup></code>
        </p>

        <p>用于建模 <abbr title="Cathode Ray Tube">CRT</abbr> 显示器的非线性。正如本国际标准中通常假定的那样，常数常被认为为零。</p>

        <p>为本规范之目的，便于考虑一般图像管线中可能出现并可用幂律建模的五个位置处的非线性 <a href="#dfn-transfer-function" class="internalDFN"
                data-link-type="dfn" id="ref-for-dfn-transfer-function-21">传递函数</a>。与每个位置相关的特征性指数被赋予特定名称。</p>

        <table id="gamma-pipeline" class="simple numbered">
            <tbody>
                <tr>
                    <td><var>input_exponent</var>
                    </td>
                    <td>图像传感器的指数。</td>
                </tr>

                <tr>
                    <td><var>encoding_exponent</var>
                    </td>
                    <td>
                        由写入数据流的过程或设备执行的任何 <a href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-transfer-function-22">传递函数</a> 的指数。
                    </td>
                </tr>

                <tr>
                    <td><var>decoding_exponent</var>
                    </td>
                    <td>
                        由读取 <a href="#dfn-image-data" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-image-data-37">图像数据</a> 的软件执行的任何 <a href="#dfn-transfer-function"
                            class="internalDFN" data-link-type="dfn" id="ref-for-dfn-transfer-function-23">传递函数</a> 的指数。
                    </td>
                </tr>

                <tr>
                    <td><var>LUT_exponent</var>
                    </td>
                    <td>
                        应用于 <a href="#dfn-frame-buffer" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-frame-buffer-13">帧缓冲</a> 与显示设备之间的 <a href="#dfn-transfer-function"
                            class="internalDFN" data-link-type="dfn" id="ref-for-dfn-transfer-function-24">传递函数</a>
                        的指数（通常通过查找表应用）。
                    </td>
                </tr>

                <tr>
                    <td><var>output_exponent</var>
                    </td>
                    <td>
                        显示设备的指数。对于 <abbr title="Cathode Ray Tube">CRT</abbr>，通常接近 2.2。
                    </td>
                </tr>
            </tbody>
        </table>

        <p>定义一些额外实体以描述若干复合 <a href="#dfn-transfer-function" class="internalDFN" data-link-type="dfn"
                id="ref-for-dfn-transfer-function-25">传递函数</a>（或阶段组合）是很方便的。</p>

        <table id="gamma-composite" class="simple numbered">
            <tbody>
                <tr>
                    <td><var>display_exponent</var>
                    </td>
                    <td>
                        应用于 <a href="#dfn-frame-buffer" class="internalDFN" data-link-type="dfn"
                            id="ref-for-dfn-frame-buffer-14">帧缓冲</a> 与显示设备显示表面之间的 <a href="#dfn-transfer-function"
                            class="internalDFN" data-link-type="dfn" id="ref-for-dfn-transfer-function-26">传递函数</a>
                        的指数。<br>
                        <code>display_exponent = LUT_exponent * output_exponent</code>
                    </td>
                </tr>

                <tr>
                    <td><var>gamma</var>
                    </td>
                    <td>将显示输出强度映射到 PNG 数据流中的样本的函数的指数。<br>
                        <code>gamma = 1.0 / (decoding_exponent * display_exponent)</code>
                    </td>
                </tr>

                <tr>
                    <td><var>end_to_end_exponent</var>
                    </td>
                    <td>将图像传感器输入强度映射到显示输出强度的函数的指数。通常在 1.0 到 1.5 的范围内。</td>
                </tr>
            </tbody>
        </table>

        <p>PNG 的 <a class="chunk" href="#11gAMA">gAMA</a> 块用于记录 <a href="#dfn-gamma-value" class="internalDFN"
                data-link-type="dfn" id="ref-for-dfn-gamma-value-30">伽玛值</a>。解码器可以结合关于显示环境的额外信息使用这些信息以实现或近似期望的显示输出。</p>

        <p>关于该主题的更多资料可见 [<cite><a class="bibref" data-link-type="biblio" href="#bib-gamma-faq"
                    title="Gamma FAQ">GAMMA-FAQ</a></cite>]。</p>

        <p>关于色彩空间对图像编码影响的更多资料可见 [<cite><a class="bibref" data-link-type="biblio" href="#bib-kasson"
                    title="An Analysis of Selected Computer Interchange Color Spaces">Kasson</a></cite>] 与 [<cite><a
                    class="bibref" data-link-type="biblio" href="#bib-hill"
                    title="Comparative analysis of the quantization of color spaces on the basis of the CIELAB color-difference formula">Hill</a></cite>]。
        </p>

        <p>关于 <a href="#dfn-chromaticity" class="internalDFN" data-link-type="dfn"
                id="ref-for-dfn-chromaticity-5">色度</a> 与色彩空间的背景信息可见 [<cite><a class="bibref" data-link-type="biblio"
                    href="#bib-color-faq" title="Color FAQ">COLOR-FAQ</a></cite>]。</p>
    </section>




    <section class="appendix" id="D-CRCAppendix">
        <div class="header-wrapper">
            <h2 class="Annex" id="samplecrc"><bdi class="secno">D. </bdi>示例 <abbr
                    title="Cyclic Redundancy Code">CRC</abbr> 实现</h2><a class="self-link" href="#samplecrc"
                aria-label="Permalink for Appendix D."></a>
        </div>




        <p>下面的示例代码（仅供参考）表示在 PNG 块中使用的 <abbr title="Cyclic Redundancy Code">CRC</abbr>（循环冗余校验） 的一种实用实现。（正式规范另见 ISO 3309
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso-3309"
                    title="ISO/IEC 3309:1993, Information Technology — Telecommunications and information exchange between systems — High-level data link control (HDLC) procedures — Frame structure.">ISO-3309</a></cite>]
            或 ITU-T V.42 [<cite><a class="bibref" data-link-type="biblio" href="#bib-itu-t-v.42"
                    title="ITU-T V.42, SERIES V: DATA COMMUNICATION OVER THE TELEPHONE NETWORK. Error-correcting procedures for DCEs using asynchronous-to-synchronous conversion">ITU-T-V.42</a></cite>]）。
        </p>

        <p>示例代码使用 ISO C [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso_9899"
                    title="ISO/IEC 9899:2018 Information technology — Programming languages — C">ISO_9899</a></cite>]
            编程语言。表 <a href="#D-tabled1" class="table-ref" title="Hints for reading ISO C code">表 <bdi
                    class="tableno">31</bdi></a> 中的提示可帮助非 C 用户更容易阅读代码。</p>


        <table id="D-tabled1" class="numbered simple">
            <caption><a class="self-link" href="#D-tabled1">Table <bdi class="tableno">31</bdi></a> <span
                    class="table-title">
                    读取 ISO C 代码的提示
                </span></caption>

            <tbody>
                <tr>
                    <th>运算符</th>
                    <th>说明</th>
                </tr>

                <tr>
                    <td><code>&amp;</code>
                    </td>
                    <td>按位与运算符。</td>
                </tr>

                <tr>
                    <td><code>^</code>
                    </td>
                    <td>按位异或运算符。</td>
                </tr>

                <tr>
                    <td><code>&gt;&gt;</code>
                    </td>
                    <td>按位右移运算符。当应用于无符号量时（如此处），右移在左侧插入零。</td>
                </tr>

                <tr>
                    <td><code>!</code>
                    </td>
                    <td>逻辑非运算符。</td>
                </tr>

                <tr>
                    <td><code>++</code>
                    </td>
                    <td>"<code>n++</code>" 将变量 <var>n</var> 增加 1。在 "for" 循环中，该操作在变量测试之后执行。</td>
                </tr>

                <tr>
                    <td><code>0xNNN</code>
                    </td>
                    <td><code>0x</code> 引入一个十六进制（基数 16）常量。后缀 <code>L</code> 表示 long 类型（至少 32 位）。</td>
                </tr>
            </tbody>
        </table>

        <hr>

        <pre aria-busy="false"><code class="hljs javascript"><span class="hljs-comment">/* Table of CRCs of all 8-bit messages. */</span>
unsigned long crc_table[<span class="hljs-number">256</span>];

<span class="hljs-comment">/* Flag: has the table been computed? Initially false. */</span>
int crc_table_computed = <span class="hljs-number">0</span>;

<span class="hljs-comment">/* Make the table for a fast CRC. */</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">make_crc_table</span>(<span class="hljs-params"><span class="hljs-keyword">void</span></span>)
{
  unsigned long c;
  int n, k;

  <span class="hljs-keyword">for</span> (n = <span class="hljs-number">0</span>; n &lt; <span class="hljs-number">256</span>; n++) {
    c = (unsigned long) n;
    <span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">8</span>; k++) {
      <span class="hljs-keyword">if</span> (c &amp; <span class="hljs-number">1</span>)
        c = 0xedb88320L ^ (c &gt;&gt; <span class="hljs-number">1</span>);
      <span class="hljs-keyword">else</span>
        c = c &gt;&gt; <span class="hljs-number">1</span>;
    }
    crc_table[n] = c;
  }
  crc_table_computed = <span class="hljs-number">1</span>;
}</code></pre>


        <pre aria-busy="false"><code class="hljs javascript"><span class="hljs-comment">/* Update a running CRC with the bytes buf[0..len-1]--the CRC
   should be initialized to all 1's, and the transmitted value
   is the 1's complement of the final running CRC (see the
   crc() routine below). */</span>

unsigned long <span class="hljs-title function_">update_crc</span>(<span class="hljs-params">unsigned long crc, unsigned char *buf,
                         int len</span>)
{
  unsigned long c = crc;
  int n;

  <span class="hljs-keyword">if</span> (!crc_table_computed)
    <span class="hljs-title function_">make_crc_table</span>();
  <span class="hljs-keyword">for</span> (n = <span class="hljs-number">0</span>; n &lt; len; n++) {
    c = crc_table[(c ^ buf[n]) &amp; <span class="hljs-number">0xff</span>] ^ (c &gt;&gt; <span class="hljs-number">8</span>);
  }
  <span class="hljs-keyword">return</span> c;
}

<span class="hljs-comment">/* Return the CRC of the bytes buf[0..len-1]. */</span>
unsigned long <span class="hljs-title function_">crc</span>(<span class="hljs-params">unsigned char *buf, int len</span>)
{
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">update_crc</span>(0xffffffffL, buf, len) ^ 0xffffffffL;
}</code></pre>
    </section>




    <section class="appendix informative" id="E-Resources">
        <div class="header-wrapper">
            <h2 class="Annex" id="onlineresources"><bdi class="secno">E. </bdi>在线资源</h2><a class="self-link"
                href="#onlineresources" aria-label="Permalink for Appendix E."></a>
        </div>
        <p><em>本节为非规范性内容。</em></p>





        <section class="introductory" id="E-Intro">
            <div class="header-wrapper">
                <h3 id="introduction-10">简介</h3><a class="self-link" href="#E-Intro"
                    aria-label="Permalink for this Appendix"></a>
            </div>


            <p>本附录给出了一些面向 PNG 软件开发者的互联网资源位置。由于互联网的特性，列举并不完整且可能发生变化。</p>
        </section>



        <section id="E-icc-profile-specs">
            <div class="header-wrapper">
                <h3 id="e-1-icc-profile-specifications"><bdi class="secno">E.1 </bdi>ICC 配置文件规范</h3><a class="self-link"
                    href="#E-icc-profile-specs" aria-label="Permalink for Appendix E.1"></a>
            </div>


            <p>ICC 配置文件规范可在： <a href="https://www.color.org/"><code>https://www.color.org/</code></a> 获取</p>
        </section>


        <section id="E-PNG-home-page">
            <div class="header-wrapper">
                <h3 id="e-2-png-web-site"><bdi class="secno">E.2 </bdi>PNG 网站</h3><a class="self-link"
                    href="#E-PNG-home-page" aria-label="Permalink for Appendix E.2"></a>
            </div>


            <p>PNG 的万维网主页位于 <a
                    href="http://www.libpng.org/pub/png/"><code>http://www.libpng.org/pub/png/</code></a>。该页面是获取有关 PNG
                及相关工具的当前信息的中心位置。</p>

            <p>关于 <a href="#dfn-deflate" class="internalDFN" data-link-type="dfn"
                    id="ref-for-dfn-deflate-18">deflate</a> 的额外文档和可移植 C 代码，以及一个优化的 <abbr
                    title="Cyclic Redundancy Code">CRC</abbr> 算法实现，可从 zlib 网站获取： <a
                    href="https://www.zlib.net/"><code>https://www.zlib.net/</code></a>。
            </p>
        </section>


        <section id="E-Sample-implementation">
            <div class="header-wrapper">
                <h3 id="e-3-sample-implementation-and-test-images"><bdi class="secno">E.3 </bdi>示例实现与测试图像</h3><a
                    class="self-link" href="#E-Sample-implementation" aria-label="Permalink for Appendix E.3"></a>
            </div>


            <p>可移植 C 的示例实现 <strong>libpng</strong> 可在 <a
                    href="http://www.libpng.org/pub/png/libpng.html"><code>http://www.libpng.org/pub/png/libpng.html</code></a>
                获取。libpng 的示例查看器与编码器应用可在 <a
                    href="http://www.libpng.org/pub/png/book/sources.html"><code>http://www.libpng.org/pub/png/book/sources.html</code></a>
                获取，并在 <i>PNG: The Definitive Guide</i> [<cite><a class="bibref" data-link-type="biblio"
                        href="#bib-roelofs" title="PNG: The Definitive Guide">ROELOFS</a></cite>] 中有详细描述。测试图像也可从 PNG
                网站访问。</p>
        </section>
    </section>


    <section id="F-ChangeList" class="appendix informative">
        <div class="header-wrapper">
            <h2 class="Annex" id="f-changes"><bdi class="secno">F. </bdi>更改记录</h2><a class="self-link"
                href="#F-ChangeList" aria-label="Permalink for Appendix F."></a>
        </div>
        <p><em>本节为非规范性内容。</em></p>

        <section id="changes-since-the-proposed-recommendation-of-15-may-2025">
            <div class="header-wrapper">
                <h3 id="changes-20250515"><bdi class="secno">F.1 </bdi>自 2025 年 5 月 15 日拟议推荐稿以来的更改（Proposed
                    Recommendation of 15 May 2025）</h3><a class="self-link" href="#changes-20250515"
                    aria-label="Permalink for Appendix F.1"></a>
            </div>

            <ul>
                <li><em>无</em></li>
            </ul>
        </section>


        <section id="changes-since-the-candidate-recommendation-snapshot-of-13-march-2025">
            <div class="header-wrapper">
                <h3 id="changes-20250313"><bdi class="secno">F.2 </bdi>自 2025 年 3 月 13 日候选推荐快照以来的更改（Candidate
                    Recommendation Snapshot of 13 March 2025）</h3><a class="self-link" href="#changes-20250313"
                    aria-label="Permalink for Appendix F.2"></a>
            </div>

            <ul>
                <li><em>无</em></li>
            </ul>

        </section>
        <section id="changes-since-the-candidate-recommendation-draft-of-21-january-2025-third-edition">
            <div class="header-wrapper">
                <h3 id="changes-20250121/"><bdi class="secno">F.3 </bdi>自 2025 年 1 月 21 日候选推荐草案以来的更改（第三版，Candidate
                    Recommendation Draft of 21 January 2025 (Third Edition)）</h3><a class="self-link"
                    href="#changes-20250121/" aria-label="Permalink for Appendix F.3"></a>
            </div>

            <ul>
                <li>向 <span class="chunk">eXIf</span> 块致谢原始作者</li>
                <li>移除无意义的约束：无符号整数不能为负（！）</li>
                <li>将 "Collection" 关键字从扩展文档移回主规范</li>
                <li>从扩展文档中复制关于 EXIF 的原始安全说明</li>
                <li>更新对 ITU H.273 最新版本的引用</li>
            </ul>

        </section>
        <section id="changes-since-the-candidate-recommendation-draft-of-18-july-2024-third-edition">
            <div class="header-wrapper">
                <h3 id="changes-20240718"><bdi class="secno">F.4 </bdi>自 2024 年 7 月 18 日候选推荐草案以来的更改（第三版，Candidate
                    Recommendation Draft of 18 July 2024 (Third Edition)）</h3><a class="self-link"
                    href="#changes-20240718" aria-label="Permalink for Appendix F.4"></a>
            </div>

            <ul>

                <li>将 <span class="chunk">mDCv</span> 重命名为 <span class="chunk">mDCV</span></li>
                <li>将 <span class="chunk">cLLi</span> 重命名为 <span class="chunk">cLLI</span></li>
                <li>一致性要求：仅要求 <span class="chunk">acTL</span> 出现在 <span class="chunk">IDAT</span> 之前，而不是 <span
                        class="chunk">PLTE</span> 之前</li>
            </ul>

        </section>
        <section id="changes-since-the-candidate-recommendation-snapshot-of-21-september-2023-third-edition">
            <div class="header-wrapper">
                <h3 id="changes-20230921"><bdi class="secno">F.5 </bdi>自 2023 年 9 月 21 日候选推荐快照以来的更改（第三版，Candidate
                    Recommendation Snapshot of 21 September 2023 (Third Edition)）</h3><a class="self-link"
                    href="#changes-20230921" aria-label="Permalink for Appendix F.5"></a>
            </div>

            <ul>
                <li>明确说明位深与颜色类型字段可以采用私有值</li>
                <li>在 MaxCLL 与 MaxFALL 示例中列出十进制与十六进制值</li>
                <li>修正 mDCV 部分的术语</li>
                <li>修正 cHRM 部分中的 "PNG image" 术语</li>
                <li>整合颜色块优先级信息</li>
                <li>添加颜色空间块的优先级顺序</li>
                <li>澄清颜色块优先级的描述</li>
                <li>将 SMPTE RP 2077 标记为参考性（informative），因为其不可自由获取</li>
                <li>添加颜色块优先级表</li>
                <li>澄清 alpha 通道总为全范围</li>
                <li>添加 EOTF（电光传递函数）和 OETF（光电传递函数）定义</li>
                <li>增加关于使用扩展范围传递函数处理窄范围图像产生的负值的建议</li>
                <li>澄清“video”与“video full range flag”用以匹配 H.273 的措辞，但仍适用于静态图像</li>
                <li>添加至 IANA 子标签注册表的链接</li>
                <li>修复 alpha compaction 与 alpha separation 节的链接</li>
                <li>修复断裂的 tRNS 链接</li>
                <li>添加 Display P3 的 cICP 示例</li>
                <li>将 "perceived" 一词改为 "measured"，因为亮度与色度并不定义感知色</li>
                <li>澄清哪些元数据属于 HDR10</li>
                <li>更新对 ITU-R BT.2390 的最新版本的引用</li>
                <li>指出当前没有已发布标准将 SDR 图像从默认观察条件适配到 <span class="chunk">mDCV</span> 中给定的观察条件</li>
                <li>指出可采用 BT.2390 中给出的 BT.2100 HLG 图像到不同观察条件的适配方法，也可用于 SDR 图像</li>
                <li>指出为了防止裁剪，将 <span class="chunk">cLLI</span> 中给定的亮度级别映射到目标显示的色调映射（tone mapping）对使用绝对亮度的格式（如 BT.2100
                    PQ）尤为重要</li>
                <li>指出使用全范围 BT.709 值虽常见，但并非 BT.709 标准的一部分</li>
                <li>在窄范围与全范围视频描述中添加了串行数字接口（Serial Digital Interface, 基带视频）受保护代码值的说明</li>
                <li>添加对 ITU-R-BT.2390 的引用</li>
                <li>修改对 <span class="chunk">mDCV</span> 的描述以侧重 BT.2100 PQ，因为目前与其他格式的使用较少</li>
                <li>澄清 16 位 <span class="chunk">tRNS</span> 匹配的要求</li>
                <li>使用更精确的 “primary chromaticities” 而非单纯的 “primaries”</li>
                <li>新增要求：<span class="chunk">mDCV</span> 需要配套的 <span class="chunk">cICP</span>，以符合现有 HDR10 工作流的预期</li>
                <li>更好地解释 <code>Video Full Range Flag</code></li>
                <li>澄清序列号的排序与编码，澄清 <span class="chunk">fdAT</span> 拼接按序列号顺序进行</li>
                <li>在相关块的描述中添加缺失的 <span class="chunk">cICP</span> 提及</li>
                <li>完全规范了 <span class="chunk">mDCV</span> 中字段的顺序与字节序</li>
                <li>补充了 PNG 两字节无符号整数的缺失定义</li>
                <li>在 SDR 的 <span class="chunk">mDCV</span> 示例中使用 Display P3 而非 sRGB</li>
                <li>添加 Chris Needham 为合著者</li>
                <li>更新了 <span class="chunk">mDCV</span> 的示例，并添加对 SMPTE-ST-2086 的引用</li>
                <li>添加对 Display P3 的引用</li>
                <li>明确指出来自 <span class="chunk">IDAT</span> 与 <span class="chunk">fdAT</span> 的拼接数据可能包含零长度数据的块</li>
                <li>对标记、样式、内部交叉链接、错别字、标点、语法、美国英语用法一致性等进行了若干非实质性改进</li>
            </ul>

        </section>
        <section id="changes-since-the-working-draft-of-20-july-2023-third-edition">
            <div class="header-wrapper">
                <h3 id="changes-20230720"><bdi class="secno">F.6 </bdi>自 2023 年 7 月 20 日工作草案以来的更改（第三版，Working Draft of
                    20 July 2023 (Third Edition)）</h3><a class="self-link" href="#changes-20230720"
                    aria-label="Permalink for Appendix F.6"></a>
            </div>

            <ul>

                <li>澄清 <span class="chunk">mDCV</span> 与 <span class="chunk">cLLi</span> 的描述</li>
                <li>在安全注意事项中添加关于 <span class="chunk">IEND</span> 之后可能存在恶意数据的说明</li>
                <li>澄清 <a href="#cLLI-chunk" class="chunk">cLLI</a> 适用于 HDR 内容</li>
                <li>添加 Smith &amp; Zink 的信息性参考：“On the Calculation and Usage of HDR Static Content Metadata”</li>
                <li>添加 CTA-861.3-A 关于静态 HDR 元数据的信息性参考</li>
                <li>修复对 ITU-R BT.2100 的断裂引用</li>
                <li>更新对 SMPTE-ST-2067-21 的引用</li>

                <li>添加有关计算 MaxCLL 与 MaxFALL 值的指南</li>
                <li>添加示例（实时流）说明何时无法预先计算 <a href="#cLLI-chunk" class="chunk">cLLI</a></li>
                <li>添加 stop、SDR、HDR、HLG 和 PQ 的定义</li>
                <li>澄清窄范围的定义</li>
                <li>将 ITU-T H 补充 19 的引用更新为最新版本</li>
                <li>添加 Simon Thompson 为作者</li>
                <li>规定当前浏览器对越界调色板索引的处理方式</li>
                <li>在“附加信息”表中添加 <a href="#mDCV-chunk" class="chunk">mDCV</a> 与 <a href="#cLLI-chunk"
                        class="chunk">cLLI</a></li>
            </ul>

        </section>
        <section id="changes-since-the-first-public-working-draft-of-25-october-2022-third-edition">
            <div class="header-wrapper">
                <h3 id="changes-20221025"><bdi class="secno">F.7 </bdi>自 2022 年 10 月 25 日首次公开工作草案以来的更改（第三版，First Public
                    Working Draft of 25 October 2022 (Third Edition)）</h3><a class="self-link" href="#changes-20221025"
                    aria-label="Permalink for Appendix F.7"></a>
            </div>

            <ul>

                <li>说明了对最终 <a href="#11IDAT" class="chunk">IDAT</a> 块尾随字节的优选处理方式，针对编码器与解码器</li>
                <li>链接到关于在存在 <a href="#mDCV-chunk" class="chunk">mDCV</a> 时对 HDR 图像进行色调映射（tone-mapping）的开放议题</li>

                <li>遵循 Encoding Standard 的 UTF-8 编码与解码</li>
                <li>添加了帧的定义</li>
                <li>要求 <a href="#cICP-chunk" class="chunk">cICP</a> 中的 Matrix Coefficients 为零（RGB 数据）</li>
                <li>添加了可恢复数据（看似已被编辑为不可见）的已知隐私问题</li>
                <li>改进了关于选择滤波器的建议</li>
                <li>添加了指向颜色图像类型定义的链接</li>
                <li>澄清 MaxFALL 使用具有最高平均亮度的帧的值</li>
                <li>澄清亮度单位</li>
                <li>建议 Creation Time 使用 RFC 3339 格式</li>
                <li>改进了对 <a href="#mDCV-chunk" class="chunk">mDCV</a> 的定义，提供更好的描述、默认值并引用 SMPTE 标准</li>
                <li>重构了术语与定义以提高清晰度</li>
                <li>改进了源图像、参考图像与 PNG 图像的定义</li>
                <li>将一些概念从术语与定义节移至主体文本</li>

                <li>修正了与 <a href="#eXIf" class="chunk">eXIf</a> 块冲突的错误，该冲突原位于 <a href="#5ChunkOrdering">块排序</a> 小节</li>
                <li>简化了 <a href="#1Scope">范围</a> 小节，移除其他地方已有的冗余细节</li>
                <li>重绘块排序格图以提高清晰度与一致性</li>
                <li>添加了新块 <a href="#cLLI-chunk" class="chunk">cLLI</a>，用于描述静态与动画 HDR PNG 图像的单像素及帧平均最大亮度（MaxCLL 与
                    MaxFALL）</li>
                <li>更新外部链接为最新版本，优先使用 https 而非 http</li>
                <li>指定了在 <a href="#11tRNS" class="chunk">tRNS</a> 与 <a href="#11bKGD" class="chunk">bKGD</a>
                    块中对超出指定位深的额外样本位的可互操作处理</li>
                <li>添加了新块 <a href="#mDCV-chunk" class="chunk">mDCV</a>，用于描述用于分级 HDR 内容的母带显示器的色彩体积</li>

                <li>使用正确的 Unicode 字符名称</li>
                <li>将块类型代码改为使用十六进制而非十进制</li>
                <li>更清晰地描述文本块处理</li>
                <li>建议使用 <a href="#11iTXt" class="chunk">iTXt</a> 来承载新内容</li>
                <li>澄清 <a href="#11iTXt" class="chunk">iTXt</a> 块语言标记字段，修正示例以符合 BCP47</li>
                <li>更新 image/apng 注册附录。APNG MIME 类型已在 IANA 注册。</li>
                <li>将 ASCII 艺术图改为更易访问的图示</li>
            </ul>

        </section>
        <section id="changes-since-the-w3c-recommendation-of-10-november-2003-png-second-edition">
            <div class="header-wrapper">
                <h3 id="changes-20031110"><bdi class="secno">F.8 </bdi>自 2003 年 11 月 10 日 W3C 推荐以来的更改（PNG 第二版，W3C
                    Recommendation of 10 November 2003）</h3><a class="self-link" href="#changes-20031110"
                    aria-label="Permalink for Appendix F.8"></a>
            </div>

            <ul>


                <li>
                    <p>三个先前定义但非官方的 Animated PNG（<abbr title="Animated PNG">APNG</abbr>）块已被加入：</p>

                    <ul>
                        <li><a href="#acTL-chunk" class="chunk">acTL</a> Animation Control Chunk</li>
                        <li><a href="#fcTL-chunk" class="chunk">fcTL</a> Frame Control Chunk</li>
                        <li><a href="#fdAT-chunk" class="chunk">fdAT</a> Frame Data Chunk</li>
                    </ul>

                    <p>这使 PNG 规范与广泛部署的行业实践保持一致。</p>
                </li>

                <li>
                    <p>新增 <a class="chunk" href="#cICP-chunk">cICP</a> 块（与视频信号类型识别无关的编码点），用于承载 ITU-T H.273
                        中定义的图像格式元数据，从而使 PNG 能包含 ITU-R BT.2100 定义的高动态范围（HDR）与宽色域（WCG）图像相关信息。</p>
                </li>

                <li>
                    <p>对于定义图像色彩空间的块，若同时存在多个块，明确了优先级顺序。</p>
                </li>

                <li>
                    <p>先前定义的 <a class="chunk" href="#eXIf">eXIf</a> 块已从 PNG-Extensions 文档移入本规范主体，以反映其日益广泛的使用。</p>
                </li>

                <li>
                    <p>为帮助对 HDR 内容进行色调映射，添加了 <a class="chunk" href="#mDCV-chunk">mDCV</a> 块（包含母带分级时使用的显示器元数据）与 <a
                            href="#cLLI-chunk" class="chunk">cLLI</a>（包含峰值与帧平均亮度元数据）。这可在异构平台上实现更精确的色彩匹配。</p>
                </li>

                <li>
                    <p>澄清 <a href="#11iCCP" class="chunk">iCCP</a> 块（包含 ICC 配置文件）可以包含符合任意版本 ICC.1 规范的配置文件。PNG 第二版仅参考当时的
                        v2，但行业实践已发展为也使用更高版本。</p>
                </li>

                <li>
                    <p>澄清索引色 PNG 中对越界索引的处理</p>
                </li>

                <li>
                    <p>澄清对未知与无效辅助块的错误恢复策略</p>
                </li>

                <li>
                    <p>并入所有 PNG 第二版勘误（Errata）。值得注意的是，澄清了当嵌入到 HTML 或 SVG 等格式中且伽玛值未知时，PNG 图像必须被视为未标记（untagged images）。</p>
                </li>

                <li>
                    <p>响应社区反馈进行了若干编辑澄清</p>
                </li>

                <li>
                    <p>更新引用为最新版本</p>
                </li>

                <li>
                    <p>修正标记与链接</p>
                </li>

                <li>
                    <p>将文档源格式化为使用 ReSpec</p>
                </li>
            </ul>

        </section>
        <section id="changes-between-first-and-second-editions">
            <div class="header-wrapper">
                <h3 id="f-8-changes-between-first-and-second-editions"><bdi class="secno">F.9 </bdi>第一版与第二版之间的更改</h3><a
                    class="self-link" href="#changes-between-first-and-second-editions"
                    aria-label="Permalink for Appendix F.9"></a>
            </div>

            <p>有关 <abbr title="World Wide Web Consortium">W3C</abbr> 推荐文档 <a
                    href="https://www.w3.org/TR/REC-png-961001">PNG 规范 1.0</a> 与 <a
                    href="https://www.w3.org/TR/2003/REC-PNG-20031110/">PNG 第二版</a> 之间更改的列表，请参见 <a
                    href="https://www.w3.org/TR/2003/REC-PNG-20031110/#F-ChangeList">PNG 第二版 更改列表</a></p>
        </section>
    </section>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-byte"
        aria-label="Links in this document to definition: byte">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-byte"
                aria-label="Permalink for definition: byte. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-byte-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a> <a href="#ref-for-dfn-byte-2" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-byte-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-byte-4"
                    title="Reference 4">(4)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-byte-order"
        aria-label="Links in this document to definition: byte order">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-byte-order"
                aria-label="Permalink for definition: byte order. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-byte-order-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-chromaticity"
        aria-label="Links in this document to definition: chromaticity">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-chromaticity"
                aria-label="Permalink for definition: chromaticity. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-chromaticity-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a> <a href="#ref-for-dfn-chromaticity-2"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-chromaticity-3" title="§ 4.7 Additional information">§ 4.7 Additional
                    information</a>
            </li>
            <li>
                <a href="#ref-for-dfn-chromaticity-4" title="§ 11.3.4.4 sPLT Suggested palette">§ 11.3.4.4 sPLT
                    Suggested palette</a>
            </li>
            <li>
                <a href="#ref-for-dfn-chromaticity-5" title="§ C. Gamma and chromaticity">§ C. Gamma and
                    chromaticity</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-composited"
        aria-label="Links in this document to definition: composite (verb)">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-composited"
                aria-label="Permalink for definition: composite (verb). Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-composited-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
            <li>
                <a href="#ref-for-dfn-composited-2" title="§ 4.9.3 Output buffer">§ 4.9.3 Output buffer</a>
            </li>
            <li>
                <a href="#ref-for-dfn-composited-3" title="§ 6.2 Alpha representation">§ 6.2 Alpha representation</a> <a
                    href="#ref-for-dfn-composited-4" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-composited-5" title="§ 11.3.4.4 sPLT Suggested palette">§ 11.3.4.4 sPLT Suggested
                    palette</a>
            </li>
            <li>
                <a href="#ref-for-dfn-composited-6" title="§ 11.3.6.2 fcTL Frame Control Chunk">§ 11.3.6.2 fcTL Frame
                    Control Chunk</a>
            </li>
            <li>
                <a href="#ref-for-dfn-composited-7" title="§ 12.5 Suggested palettes">§ 12.5 Suggested palettes</a> <a
                    href="#ref-for-dfn-composited-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-composited-9"
                    title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-composited-10" title="§ 13.15 Background color">§ 13.15 Background color</a>
            </li>
            <li>
                <a href="#ref-for-dfn-composited-11" title="§ 13.16 Alpha channel processing">§ 13.16 Alpha channel
                    processing</a> <a href="#ref-for-dfn-composited-12" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-composited-13" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-composited-14" title="§ 13.17 Histogram and suggested palette usage">§ 13.17
                    Histogram and suggested palette usage</a> <a href="#ref-for-dfn-composited-15"
                    title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-datastream"
        aria-label="Links in this document to definition: datastream">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-datastream"
                aria-label="Permalink for definition: datastream. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-datastream-1" title="§ 5.2 PNG signature">§ 5.2 PNG signature</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-deflate"
        aria-label="Links in this document to definition: deflate">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-deflate"
                aria-label="Permalink for definition: deflate. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-deflate-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
            <li>
                <a href="#ref-for-dfn-deflate-2" title="§ 10.1 Compression method 0">§ 10.1 Compression method 0</a> <a
                    href="#ref-for-dfn-deflate-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-deflate-4"
                    title="Reference 3">(3)</a> <a href="#ref-for-dfn-deflate-5" title="Reference 4">(4)</a> <a
                    href="#ref-for-dfn-deflate-6" title="Reference 5">(5)</a> <a href="#ref-for-dfn-deflate-7"
                    title="Reference 6">(6)</a> <a href="#ref-for-dfn-deflate-8" title="Reference 7">(7)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-deflate-9" title="§ 10.2 Compression of the sequence of filtered scanlines">§ 10.2
                    Compression of the sequence of filtered scanlines</a> <a href="#ref-for-dfn-deflate-10"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-deflate-11" title="§ 11.2.1 IHDR Image header">§ 11.2.1 IHDR Image header</a>
            </li>
            <li>
                <a href="#ref-for-dfn-deflate-12" title="§ 11.3.2.3 iCCP Embedded ICC profile">§ 11.3.2.3 iCCP Embedded
                    ICC profile</a>
            </li>
            <li>
                <a href="#ref-for-dfn-deflate-13" title="§ 11.3.3.1 Keywords and text strings">§ 11.3.3.1 Keywords and
                    text strings</a>
            </li>
            <li>
                <a href="#ref-for-dfn-deflate-14" title="§ 11.3.3.3 zTXt Compressed textual data">§ 11.3.3.3 zTXt
                    Compressed textual data</a>
            </li>
            <li>
                <a href="#ref-for-dfn-deflate-15" title="§ 11.3.3.4 iTXt International textual data">§ 11.3.3.4 iTXt
                    International textual data</a>
            </li>
            <li>
                <a href="#ref-for-dfn-deflate-16" title="§ 13.1 Error handling">§ 13.1 Error handling</a>
            </li>
            <li>
                <a href="#ref-for-dfn-deflate-17" title="§ 13.8 Decompression">§ 13.8 Decompression</a>
            </li>
            <li>
                <a href="#ref-for-dfn-deflate-18" title="§ E.2 PNG web site">§ E.2 PNG web site</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-frame"
        aria-label="Links in this document to definition: frame">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-frame"
                aria-label="Permalink for definition: frame. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-frame-1" title="§ Introduction">§ Introduction</a>
            </li>
            <li>
                <a href="#ref-for-dfn-frame-2" title="§ 11.3.2.8 cLLI Content Light Level Information">§ 11.3.2.8 cLLI
                    Content Light Level Information</a> <a href="#ref-for-dfn-frame-3" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-frame-buffer"
        aria-label="Links in this document to definition: frame buffer">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-frame-buffer"
                aria-label="Permalink for definition: frame buffer. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-frame-buffer-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
            <li>
                <a href="#ref-for-dfn-frame-buffer-2" title="§ 13.12 Sample depth rescaling">§ 13.12 Sample depth
                    rescaling</a>
            </li>
            <li>
                <a href="#ref-for-dfn-frame-buffer-3" title="§ 13.13 Decoder gamma handling">§ 13.13 Decoder gamma
                    handling</a> <a href="#ref-for-dfn-frame-buffer-4" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-frame-buffer-5" title="Reference 3">(3)</a> <a href="#ref-for-dfn-frame-buffer-6"
                    title="Reference 4">(4)</a> <a href="#ref-for-dfn-frame-buffer-7" title="Reference 5">(5)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-frame-buffer-8" title="§ 13.16 Alpha channel processing">§ 13.16 Alpha channel
                    processing</a> <a href="#ref-for-dfn-frame-buffer-9" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-frame-buffer-10" title="Reference 3">(3)</a> <a
                    href="#ref-for-dfn-frame-buffer-11" title="Reference 4">(4)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-frame-buffer-12" title="§ 13.17 Histogram and suggested palette usage">§ 13.17
                    Histogram and suggested palette usage</a>
            </li>
            <li>
                <a href="#ref-for-dfn-frame-buffer-13" title="§ C. Gamma and chromaticity">§ C. Gamma and
                    chromaticity</a> <a href="#ref-for-dfn-frame-buffer-14" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-fully-transparent-black"
        aria-label="Links in this document to definition: fully transparent black">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-fully-transparent-black"
                aria-label="Permalink for definition: fully transparent black. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-fully-transparent-black-1" title="§ 4.9.1 Structure">§ 4.9.1 Structure</a> <a
                    href="#ref-for-dfn-fully-transparent-black-2" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-gamma-value"
        aria-label="Links in this document to definition: gamma value">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-gamma-value"
                aria-label="Permalink for definition: gamma value. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-gamma-value-1" title="§ 4.3 Color spaces">§ 4.3 Color spaces</a>
            </li>
            <li>
                <a href="#ref-for-dfn-gamma-value-2" title="§ 4.7 Additional information">§ 4.7 Additional
                    information</a>
            </li>
            <li>
                <a href="#ref-for-dfn-gamma-value-3" title="§ 11.3.2.2 gAMA Image gamma">§ 11.3.2.2 gAMA Image gamma</a>
                <a href="#ref-for-dfn-gamma-value-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-gamma-value-5"
                    title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-gamma-value-6" title="§ 11.3.4.4 sPLT Suggested palette">§ 11.3.4.4 sPLT Suggested
                    palette</a>
            </li>
            <li>
                <a href="#ref-for-dfn-gamma-value-7" title="§ 12.1 Encoder gamma handling">§ 12.1 Encoder gamma
                    handling</a> <a href="#ref-for-dfn-gamma-value-8" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-gamma-value-9" title="Reference 3">(3)</a> <a href="#ref-for-dfn-gamma-value-10"
                    title="Reference 4">(4)</a> <a href="#ref-for-dfn-gamma-value-11" title="Reference 5">(5)</a> <a
                    href="#ref-for-dfn-gamma-value-12" title="Reference 6">(6)</a> <a href="#ref-for-dfn-gamma-value-13"
                    title="Reference 7">(7)</a> <a href="#ref-for-dfn-gamma-value-14" title="Reference 8">(8)</a> <a
                    href="#ref-for-dfn-gamma-value-15" title="Reference 9">(9)</a> <a href="#ref-for-dfn-gamma-value-16"
                    title="Reference 10">(10)</a> <a href="#ref-for-dfn-gamma-value-17" title="Reference 11">(11)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-gamma-value-18" title="§ 13.13 Decoder gamma handling">§ 13.13 Decoder gamma
                    handling</a> <a href="#ref-for-dfn-gamma-value-19" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-gamma-value-20" title="Reference 3">(3)</a> <a href="#ref-for-dfn-gamma-value-21"
                    title="Reference 4">(4)</a> <a href="#ref-for-dfn-gamma-value-22" title="Reference 5">(5)</a> <a
                    href="#ref-for-dfn-gamma-value-23" title="Reference 6">(6)</a> <a href="#ref-for-dfn-gamma-value-24"
                    title="Reference 7">(7)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-gamma-value-25" title="§ 13.16 Alpha channel processing">§ 13.16 Alpha channel
                    processing</a> <a href="#ref-for-dfn-gamma-value-26" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-gamma-value-27" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-gamma-value-28" title="§ C. Gamma and chromaticity">§ C. Gamma and
                    chromaticity</a> <a href="#ref-for-dfn-gamma-value-29" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-gamma-value-30" title="Reference 3">(3)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-gamma"
        aria-label="Links in this document to definition: gamma">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-gamma"
                aria-label="Permalink for definition: gamma. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-gamma-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
            <li>
                <a href="#ref-for-dfn-gamma-2" title="§ 4.3 Color spaces">§ 4.3 Color spaces</a> <a
                    href="#ref-for-dfn-gamma-3" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-gamma-4" title="§ 12.1 Encoder gamma handling">§ 12.1 Encoder gamma handling</a>
                <a href="#ref-for-dfn-gamma-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-gamma-6"
                    title="Reference 3">(3)</a> <a href="#ref-for-dfn-gamma-7" title="Reference 4">(4)</a> <a
                    href="#ref-for-dfn-gamma-8" title="Reference 5">(5)</a> <a href="#ref-for-dfn-gamma-9"
                    title="Reference 6">(6)</a> <a href="#ref-for-dfn-gamma-10" title="Reference 7">(7)</a> <a
                    href="#ref-for-dfn-gamma-11" title="Reference 8">(8)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-gamma-12" title="§ 12.2 Encoder color handling">§ 12.2 Encoder color handling</a>
            </li>
            <li>
                <a href="#ref-for-dfn-gamma-13" title="§ 13.12 Sample depth rescaling">§ 13.12 Sample depth
                    rescaling</a> <a href="#ref-for-dfn-gamma-14" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-gamma-15" title="§ 13.13 Decoder gamma handling">§ 13.13 Decoder gamma
                    handling</a> <a href="#ref-for-dfn-gamma-16" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-gamma-17" title="Reference 3">(3)</a> <a href="#ref-for-dfn-gamma-18"
                    title="Reference 4">(4)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-gamma-19" title="§ 13.14 Decoder color handling">§ 13.14 Decoder color
                    handling</a> <a href="#ref-for-dfn-gamma-20" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-gamma-21" title="§ 13.16 Alpha channel processing">§ 13.16 Alpha channel
                    processing</a> <a href="#ref-for-dfn-gamma-22" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-gamma-23" title="Reference 3">(3)</a> <a href="#ref-for-dfn-gamma-24"
                    title="Reference 4">(4)</a> <a href="#ref-for-dfn-gamma-25" title="Reference 5">(5)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-hdr"
        aria-label="Links in this document to definition: HDR">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-hdr"
                aria-label="Permalink for definition: HDR. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-hdr-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
            <li>
                <a href="#ref-for-dfn-hdr-2" title="§ 4.7 Additional information">§ 4.7 Additional information</a>
            </li>
            <li>
                <a href="#ref-for-dfn-hdr-3" title="§ 11.3.2.7 mDCV Mastering Display Color Volume">§ 11.3.2.7 mDCV
                    Mastering Display Color Volume</a> <a href="#ref-for-dfn-hdr-4" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-hdr-5" title="Reference 3">(3)</a> <a href="#ref-for-dfn-hdr-6"
                    title="Reference 4">(4)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-hdr-7" title="§ 11.3.2.8 cLLI Content Light Level Information">§ 11.3.2.8 cLLI
                    Content Light Level Information</a>
            </li>
            <li>
                <a href="#ref-for-dfn-hdr-8"
                    title="§ F.6 Changes since the First Public Working Draft of 25 October 2022 (Third Edition)">§ F.6
                    Changes since the First Public Working Draft of 25 October 2022 (Third Edition)</a> <a
                    href="#ref-for-dfn-hdr-9" title="Reference 2">(2)</a> <a href="#ref-for-dfn-hdr-10"
                    title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-hdr-11"
                    title="§ F.7 Changes since the W3C Recommendation of 10 November 2003 (PNG Second Edition)">§ F.7
                    Changes since the W3C Recommendation of 10 November 2003 (PNG Second Edition)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-hlg"
        aria-label="Links in this document to definition: HLG">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-hlg"
                aria-label="Permalink for definition: HLG. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-hlg-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
            <li>
                <a href="#ref-for-dfn-hlg-2"
                    title="§ 11.3.2.6 cICP Coding-independent code points for video signal type identification">§
                    11.3.2.6 cICP Coding-independent code points for video signal type identification</a>
            </li>
            <li>
                <a href="#ref-for-dfn-hlg-3" title="§ 11.3.2.7 mDCV Mastering Display Color Volume">§ 11.3.2.7 mDCV
                    Mastering Display Color Volume</a> <a href="#ref-for-dfn-hlg-4" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-full-range-image"
        aria-label="Links in this document to definition: full-range image">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-full-range-image"
                aria-label="Permalink for definition: full-range image. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-full-range-image-1"
                    title="§ 11.3.2.6 cICP Coding-independent code points for video signal type identification">§
                    11.3.2.6 cICP Coding-independent code points for video signal type identification</a> <a
                    href="#ref-for-dfn-full-range-image-2" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-full-range-image-3" title="Reference 3">(3)</a> <a
                    href="#ref-for-dfn-full-range-image-4" title="Reference 4">(4)</a> <a
                    href="#ref-for-dfn-full-range-image-5" title="Reference 5">(5)</a> <a
                    href="#ref-for-dfn-full-range-image-6" title="Reference 6">(6)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-image-data"
        aria-label="Links in this document to definition: image data">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-image-data"
                aria-label="Permalink for definition: image data. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-image-data-1" title="§ 4.6.3 Filtering">§ 4.6.3 Filtering</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-2" title="§ 7.3 Filtering">§ 7.3 Filtering</a> <a
                    href="#ref-for-dfn-image-data-3" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-4" title="§ 9.2 Filter types for filter method 0">§ 9.2 Filter types
                    for filter method 0</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-5" title="§ 10.2 Compression of the sequence of filtered scanlines">§
                    10.2 Compression of the sequence of filtered scanlines</a> <a href="#ref-for-dfn-image-data-6"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-7" title="§ 10.3 Other uses of compression">§ 10.3 Other uses of
                    compression</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-8" title="§ 11.2.1 IHDR Image header">§ 11.2.1 IHDR Image header</a> <a
                    href="#ref-for-dfn-image-data-9" title="Reference 2">(2)</a> <a href="#ref-for-dfn-image-data-10"
                    title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-11" title="§ 11.2.2 PLTE Palette">§ 11.2.2 PLTE Palette</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-12" title="§ 11.2.3 IDAT Image data">§ 11.2.3 IDAT Image data</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-13" title="§ 11.3.4.5 eXIf Exchangeable Image File (Exif) Profile">§
                    11.3.4.5 eXIf Exchangeable Image File (Exif) Profile</a> <a href="#ref-for-dfn-image-data-14"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-15" title="§ 11.3.5.1 tIME Image last-modification time">§ 11.3.5.1
                    tIME Image last-modification time</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-16" title="§ 11.3.6.3 fdAT Frame Data Chunk">§ 11.3.6.3 fdAT Frame Data
                    Chunk</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-17" title="§ 12.4 Sample depth scaling">§ 12.4 Sample depth scaling</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-18" title="§ 12.5 Suggested palettes">§ 12.5 Suggested palettes</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-19" title="§ 12.9 Text chunk processing">§ 12.9 Text chunk
                    processing</a> <a href="#ref-for-dfn-image-data-20" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-21" title="§ 13.1 Error handling">§ 13.1 Error handling</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-22" title="§ 13.8 Decompression">§ 13.8 Decompression</a> <a
                    href="#ref-for-dfn-image-data-23" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-24" title="§ 13.9 Filtering">§ 13.9 Filtering</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-25" title="§ 13.12 Sample depth rescaling">§ 13.12 Sample depth
                    rescaling</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-26" title="§ 13.14 Decoder color handling">§ 13.14 Decoder color
                    handling</a> <a href="#ref-for-dfn-image-data-27" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-image-data-28" title="Reference 3">(3)</a> <a href="#ref-for-dfn-image-data-29"
                    title="Reference 4">(4)</a> <a href="#ref-for-dfn-image-data-30" title="Reference 5">(5)</a> <a
                    href="#ref-for-dfn-image-data-31" title="Reference 6">(6)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-32" title="§ 13.17 Histogram and suggested palette usage">§ 13.17
                    Histogram and suggested palette usage</a> <a href="#ref-for-dfn-image-data-33"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-34" title="§ 14.2 Behavior of PNG editors">§ 14.2 Behavior of PNG
                    editors</a> <a href="#ref-for-dfn-image-data-35" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-36" title="§ 15.3.3 Conformance of PNG decoders">§ 15.3.3 Conformance
                    of PNG decoders</a>
            </li>
            <li>
                <a href="#ref-for-dfn-image-data-37" title="§ C. Gamma and chromaticity">§ C. Gamma and chromaticity</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-interlaced-png-image"
        aria-label="Links in this document to definition: interlaced PNG image">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-interlaced-png-image"
                aria-label="Permalink for definition: interlaced PNG image. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-interlaced-png-image-1" title="§ 3. Terms, definitions, and abbreviated terms">§
                    3. Terms, definitions, and abbreviated terms</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-lossless"
        aria-label="Links in this document to definition: lossless">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-lossless"
                aria-label="Permalink for definition: lossless. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-lossless-1" title="§ Abstract">§ Abstract</a>
            </li>
            <li>
                <a href="#ref-for-dfn-lossless-2" title="§ 2. Scope">§ 2. Scope</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-luminance"
        aria-label="Links in this document to definition: luminance">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-luminance"
                aria-label="Permalink for definition: luminance. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-luminance-1" title="§ 4.5 PNG image">§ 4.5 PNG image</a>
            </li>
            <li>
                <a href="#ref-for-dfn-luminance-2" title="§ 4.7 Additional information">§ 4.7 Additional information</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3LZ77"
        aria-label="Links in this document to definition: LZ77">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3LZ77"
                aria-label="Permalink for definition: LZ77. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3LZ77-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
            <li>
                <a href="#ref-for-3LZ77-2" title="§ 10.1 Compression method 0">§ 10.1 Compression method 0</a> <a
                    href="#ref-for-3LZ77-3" title="Reference 2">(2)</a> <a href="#ref-for-3LZ77-4"
                    title="Reference 3">(3)</a> <a href="#ref-for-3LZ77-5" title="Reference 4">(4)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-narrow-range-image"
        aria-label="Links in this document to definition: narrow-range image">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-narrow-range-image"
                aria-label="Permalink for definition: narrow-range image. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-narrow-range-image-1"
                    title="§ 11.3.2.6 cICP Coding-independent code points for video signal type identification">§
                    11.3.2.6 cICP Coding-independent code points for video signal type identification</a> <a
                    href="#ref-for-dfn-narrow-range-image-2" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-narrow-range-image-3" title="Reference 3">(3)</a> <a
                    href="#ref-for-dfn-narrow-range-image-4" title="Reference 4">(4)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-network-byte-order"
        aria-label="Links in this document to definition: network byte order">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-network-byte-order"
                aria-label="Permalink for definition: network byte order. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-network-byte-order-1" title="§ 7.1 Integers and byte order">§ 7.1 Integers and
                    byte order</a>
            </li>
            <li>
                <a href="#ref-for-dfn-network-byte-order-2" title="§ 7.2 Scanlines">§ 7.2 Scanlines</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-pq"
        aria-label="Links in this document to definition: PQ">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-pq"
                aria-label="Permalink for definition: PQ. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-pq-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pq-2"
                    title="§ 11.3.2.6 cICP Coding-independent code points for video signal type identification">§
                    11.3.2.6 cICP Coding-independent code points for video signal type identification</a>
            </li>
            <li>
                <a href="#ref-for-dfn-pq-3" title="§ 11.3.2.7 mDCV Mastering Display Color Volume">§ 11.3.2.7 mDCV
                    Mastering Display Color Volume</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-png-editor"
        aria-label="Links in this document to definition: PNG editor">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-png-editor"
                aria-label="Permalink for definition: PNG editor. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-png-editor-1" title="§ 4.2 Images">§ 4.2 Images</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-editor-2" title="§ 5.4 Chunk naming conventions">§ 5.4 Chunk naming
                    conventions</a> <a href="#ref-for-dfn-png-editor-3" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-editor-4" title="§ 12.5 Suggested palettes">§ 12.5 Suggested palettes</a> <a
                    href="#ref-for-dfn-png-editor-5" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-editor-6" title="§ 13.1 Error handling">§ 13.1 Error handling</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-editor-7" title="§ 14.2 Behavior of PNG editors">§ 14.2 Behavior of PNG
                    editors</a> <a href="#ref-for-dfn-png-editor-8" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-png-editor-9" title="Reference 3">(3)</a> <a href="#ref-for-dfn-png-editor-10"
                    title="Reference 4">(4)</a> <a href="#ref-for-dfn-png-editor-11" title="Reference 5">(5)</a> <a
                    href="#ref-for-dfn-png-editor-12" title="Reference 6">(6)</a> <a href="#ref-for-dfn-png-editor-13"
                    title="Reference 7">(7)</a> <a href="#ref-for-dfn-png-editor-14" title="Reference 8">(8)</a> <a
                    href="#ref-for-dfn-png-editor-15" title="Reference 9">(9)</a> <a href="#ref-for-dfn-png-editor-16"
                    title="Reference 10">(10)</a> <a href="#ref-for-dfn-png-editor-17" title="Reference 11">(11)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-editor-18" title="§ 14.3.1 Ordering of critical chunks">§ 14.3.1 Ordering of
                    critical chunks</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-editor-19" title="§ 14.3.2 Ordering of ancillary chunks">§ 14.3.2 Ordering of
                    ancillary chunks</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-editor-20" title="§ 15.2.1 Objectives">§ 15.2.1 Objectives</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-editor-21" title="§ 15.2.2 Scope">§ 15.2.2 Scope</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-editor-22" title="§ 15.3.4 Conformance of PNG editors">§ 15.3.4 Conformance of
                    PNG editors</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-png-four-byte-unsigned-integer"
        aria-label="Links in this document to definition: PNG four-byte unsigned integer">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-png-four-byte-unsigned-integer"
                aria-label="Permalink for definition: PNG four-byte unsigned integer. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-png-four-byte-unsigned-integer-1" title="§ 5.3 Chunk layout">§ 5.3 Chunk
                    layout</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-four-byte-unsigned-integer-2" title="§ 7.1 Integers and byte order">§ 7.1
                    Integers and byte order</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-four-byte-unsigned-integer-3" title="§ 11.2.1 IHDR Image header">§ 11.2.1 IHDR
                    Image header</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-four-byte-unsigned-integer-4"
                    title="§ 11.3.2.1 cHRM Primary chromaticities and white point">§ 11.3.2.1 cHRM Primary
                    chromaticities and white point</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-four-byte-unsigned-integer-5" title="§ 11.3.2.2 gAMA Image gamma">§ 11.3.2.2
                    gAMA Image gamma</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-four-byte-unsigned-integer-6"
                    title="§ 11.3.2.7 mDCV Mastering Display Color Volume">§ 11.3.2.7 mDCV Mastering Display Color
                    Volume</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-four-byte-unsigned-integer-7"
                    title="§ 11.3.2.8 cLLI Content Light Level Information">§ 11.3.2.8 cLLI Content Light Level
                    Information</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-four-byte-unsigned-integer-8"
                    title="§ 11.3.4.3 pHYs Physical pixel dimensions">§ 11.3.4.3 pHYs Physical pixel dimensions</a> <a
                    href="#ref-for-dfn-png-four-byte-unsigned-integer-9" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-four-byte-unsigned-integer-10"
                    title="§ 11.3.6.1 acTL Animation Control Chunk">§ 11.3.6.1 acTL Animation Control Chunk</a>
            </li>
            <li>
                <a href="#ref-for-dfn-png-four-byte-unsigned-integer-11" title="§ 11.3.6.2 fcTL Frame Control Chunk">§
                    11.3.6.2 fcTL Frame Control Chunk</a> <a href="#ref-for-dfn-png-four-byte-unsigned-integer-12"
                    title="Reference 2">(2)</a> <a href="#ref-for-dfn-png-four-byte-unsigned-integer-13"
                    title="Reference 3">(3)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
        id="dfn-panel-for-dfn-png-two-byte-unsigned-integer"
        aria-label="Links in this document to definition: PNG two-byte unsigned integer">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-png-two-byte-unsigned-integer"
                aria-label="Permalink for definition: PNG two-byte unsigned integer. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-png-two-byte-unsigned-integer-1"
                    title="§ 11.3.2.7 mDCV Mastering Display Color Volume">§ 11.3.2.7 mDCV Mastering Display Color
                    Volume</a> <a href="#ref-for-dfn-png-two-byte-unsigned-integer-2" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-sample"
        aria-label="Links in this document to definition: sample">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-sample"
                aria-label="Permalink for definition: sample. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-sample-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
            <li>
                <a href="#ref-for-dfn-sample-2" title="§ 4.5 PNG image">§ 4.5 PNG image</a> <a
                    href="#ref-for-dfn-sample-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-sample-4"
                    title="Reference 3">(3)</a> <a href="#ref-for-dfn-sample-5" title="Reference 4">(4)</a> <a
                    href="#ref-for-dfn-sample-6" title="Reference 5">(5)</a> <a href="#ref-for-dfn-sample-7"
                    title="Reference 6">(6)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-scanline"
        aria-label="Links in this document to definition: scanline">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-scanline"
                aria-label="Permalink for definition: scanline. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-scanline-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
            <li>
                <a href="#ref-for-dfn-scanline-2" title="§ 7.3 Filtering">§ 7.3 Filtering</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-sdr"
        aria-label="Links in this document to definition: SDR">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-sdr"
                aria-label="Permalink for definition: SDR. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-sdr-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
            <li>
                <a href="#ref-for-dfn-sdr-2" title="§ 4.7 Additional information">§ 4.7 Additional information</a>
            </li>
            <li>
                <a href="#ref-for-dfn-sdr-3" title="§ 11.3.2.7 mDCV Mastering Display Color Volume">§ 11.3.2.7 mDCV
                    Mastering Display Color Volume</a> <a href="#ref-for-dfn-sdr-4" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-sdr-5" title="Reference 3">(3)</a> <a href="#ref-for-dfn-sdr-6"
                    title="Reference 4">(4)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-stop"
        aria-label="Links in this document to definition: stop">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-stop"
                aria-label="Permalink for definition: stop. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-stop-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a> <a href="#ref-for-dfn-stop-2" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-transfer-function"
        aria-label="Links in this document to definition: transfer function">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-transfer-function"
                aria-label="Permalink for definition: transfer function. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-transfer-function-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3.
                    Terms, definitions, and abbreviated terms</a> <a href="#ref-for-dfn-transfer-function-2"
                    title="Reference 2">(2)</a> <a href="#ref-for-dfn-transfer-function-3" title="Reference 3">(3)</a>
                <a href="#ref-for-dfn-transfer-function-4" title="Reference 4">(4)</a> <a
                    href="#ref-for-dfn-transfer-function-5" title="Reference 5">(5)</a> <a
                    href="#ref-for-dfn-transfer-function-6" title="Reference 6">(6)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-transfer-function-7" title="§ 4.7 Additional information">§ 4.7 Additional
                    information</a>
            </li>
            <li>
                <a href="#ref-for-dfn-transfer-function-8"
                    title="§ 11.3.2.6 cICP Coding-independent code points for video signal type identification">§
                    11.3.2.6 cICP Coding-independent code points for video signal type identification</a> <a
                    href="#ref-for-dfn-transfer-function-9" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-transfer-function-10" title="Reference 3">(3)</a> <a
                    href="#ref-for-dfn-transfer-function-11" title="Reference 4">(4)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-transfer-function-12" title="§ 12.1 Encoder gamma handling">§ 12.1 Encoder gamma
                    handling</a> <a href="#ref-for-dfn-transfer-function-13" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-transfer-function-14" title="Reference 3">(3)</a> <a
                    href="#ref-for-dfn-transfer-function-15" title="Reference 4">(4)</a> <a
                    href="#ref-for-dfn-transfer-function-16" title="Reference 5">(5)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-transfer-function-17" title="§ 13.13 Decoder gamma handling">§ 13.13 Decoder gamma
                    handling</a> <a href="#ref-for-dfn-transfer-function-18" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-transfer-function-19" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-transfer-function-20" title="§ C. Gamma and chromaticity">§ C. Gamma and
                    chromaticity</a> <a href="#ref-for-dfn-transfer-function-21" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-transfer-function-22" title="Reference 3">(3)</a> <a
                    href="#ref-for-dfn-transfer-function-23" title="Reference 4">(4)</a> <a
                    href="#ref-for-dfn-transfer-function-24" title="Reference 5">(5)</a> <a
                    href="#ref-for-dfn-transfer-function-25" title="Reference 6">(6)</a> <a
                    href="#ref-for-dfn-transfer-function-26" title="Reference 7">(7)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-white-point"
        aria-label="Links in this document to definition: white point">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-white-point"
                aria-label="Permalink for definition: white point. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-white-point-1" title="§ 4.3 Color spaces">§ 4.3 Color spaces</a>
            </li>
            <li>
                <a href="#ref-for-dfn-white-point-2" title="§ 11.3.2.1 cHRM Primary chromaticities and white point">§
                    11.3.2.1 cHRM Primary chromaticities and white point</a>
            </li>
            <li>
                <a href="#ref-for-dfn-white-point-3" title="§ 11.3.2.5 sRGB Standard RGB color space">§ 11.3.2.5 sRGB
                    Standard RGB color space</a>
            </li>
            <li>
                <a href="#ref-for-dfn-white-point-4" title="§ 12.2 Encoder color handling">§ 12.2 Encoder color
                    handling</a> <a href="#ref-for-dfn-white-point-5" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-zlib"
        aria-label="Links in this document to definition: zlib">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-zlib"
                aria-label="Permalink for definition: zlib. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-zlib-1" title="§ 10.1 Compression method 0">§ 10.1 Compression method 0</a> <a
                    href="#ref-for-dfn-zlib-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-zlib-3"
                    title="Reference 3">(3)</a> <a href="#ref-for-dfn-zlib-4" title="Reference 4">(4)</a> <a
                    href="#ref-for-dfn-zlib-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-zlib-6"
                    title="Reference 6">(6)</a> <a href="#ref-for-dfn-zlib-7" title="Reference 7">(7)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-zlib-8" title="§ 10.2 Compression of the sequence of filtered scanlines">§ 10.2
                    Compression of the sequence of filtered scanlines</a> <a href="#ref-for-dfn-zlib-9"
                    title="Reference 2">(2)</a> <a href="#ref-for-dfn-zlib-10" title="Reference 3">(3)</a> <a
                    href="#ref-for-dfn-zlib-11" title="Reference 4">(4)</a> <a href="#ref-for-dfn-zlib-12"
                    title="Reference 5">(5)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-zlib-13" title="§ 10.3 Other uses of compression">§ 10.3 Other uses of
                    compression</a>
            </li>
            <li>
                <a href="#ref-for-dfn-zlib-14" title="§ 11.3.2.3 iCCP Embedded ICC profile">§ 11.3.2.3 iCCP Embedded ICC
                    profile</a>
            </li>
            <li>
                <a href="#ref-for-dfn-zlib-15" title="§ 11.3.3.1 Keywords and text strings">§ 11.3.3.1 Keywords and text
                    strings</a>
            </li>
            <li>
                <a href="#ref-for-dfn-zlib-16" title="§ 11.3.3.3 zTXt Compressed textual data">§ 11.3.3.3 zTXt
                    Compressed textual data</a>
            </li>
            <li>
                <a href="#ref-for-dfn-zlib-17" title="§ 11.3.3.4 iTXt International textual data">§ 11.3.3.4 iTXt
                    International textual data</a>
            </li>
            <li>
                <a href="#ref-for-dfn-zlib-18" title="§ 13.8 Decompression">§ 13.8 Decompression</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-eotf"
        aria-label="Links in this document to definition: EOTF">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-eotf"
                aria-label="Permalink for definition: EOTF. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-eotf-1"
                    title="§ 11.3.2.6 cICP Coding-independent code points for video signal type identification">§
                    11.3.2.6 cICP Coding-independent code points for video signal type identification</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-oetf"
        aria-label="Links in this document to definition: OETF">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-oetf"
                aria-label="Permalink for definition: OETF. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-oetf-1"
                    title="§ 11.3.2.6 cICP Coding-independent code points for video signal type identification">§
                    11.3.2.6 cICP Coding-independent code points for video signal type identification</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-static-image"
        aria-label="Links in this document to definition: static image">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-static-image"
                aria-label="Permalink for definition: static image. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-static-image-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
            <li>
                <a href="#ref-for-dfn-static-image-2" title="§ 4.1 Static and Animated images">§ 4.1 Static and Animated
                    images</a> <a href="#ref-for-dfn-static-image-3" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-static-image-4" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-static-image-5" title="§ 4.7 Additional information">§ 4.7 Additional
                    information</a>
            </li>
            <li>
                <a href="#ref-for-dfn-static-image-6" title="§ Introduction">§ Introduction</a>
            </li>
            <li>
                <a href="#ref-for-dfn-static-image-7" title="§ 11.3.6.3 fdAT Frame Data Chunk">§ 11.3.6.3 fdAT Frame
                    Data Chunk</a> <a href="#ref-for-dfn-static-image-8" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-animated-png"
        aria-label="Links in this document to definition: Animated PNG">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-animated-png"
                aria-label="Permalink for definition: Animated PNG. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-animated-image"
        aria-label="Links in this document to definition: animated image">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-animated-image"
                aria-label="Permalink for definition: animated image. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-animated-image-1" title="§ 4.1 Static and Animated images">§ 4.1 Static and
                    Animated images</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3sourceImage"
        aria-label="Links in this document to definition: Source image">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3sourceImage"
                aria-label="Permalink for definition: Source image. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3sourceImage-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3referenceImage"
        aria-label="Links in this document to definition: Reference image">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3referenceImage"
                aria-label="Permalink for definition: Reference image. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3referenceImage-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a> <a href="#ref-for-3referenceImage-2"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-3referenceImage-3" title="§ 4.2 Images">§ 4.2 Images</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3pixel"
        aria-label="Links in this document to definition: pixels">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3pixel"
                aria-label="Permalink for definition: pixels. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3pixel-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a> <a href="#ref-for-3pixel-2" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-3pixel-3" title="§ 4.5 PNG image">§ 4.5 PNG image</a> <a href="#ref-for-3pixel-4"
                    title="Reference 2">(2)</a> <a href="#ref-for-3pixel-5" title="Reference 3">(3)</a> <a
                    href="#ref-for-3pixel-6" title="Reference 4">(4)</a> <a href="#ref-for-3pixel-7"
                    title="Reference 5">(5)</a> <a href="#ref-for-3pixel-8" title="Reference 6">(6)</a> <a
                    href="#ref-for-3pixel-9" title="Reference 7">(7)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3channel"
        aria-label="Links in this document to definition: channel">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3channel"
                aria-label="Permalink for definition: channel. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3channel-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3alpha"
        aria-label="Links in this document to definition: alpha">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3alpha"
                aria-label="Permalink for definition: alpha. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3alpha-1" title="§ 4.5 PNG image">§ 4.5 PNG image</a> <a href="#ref-for-3alpha-2"
                    title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3PNGimage"
        aria-label="Links in this document to definition: PNG image">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3PNGimage"
                aria-label="Permalink for definition: PNG image. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3PNGimage-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
            <li>
                <a href="#ref-for-3PNGimage-2" title="§ 5.1 PNG datastream">§ 5.1 PNG datastream</a>
            </li>
            <li>
                <a href="#ref-for-3PNGimage-3" title="§ 11.3.2.1 cHRM Primary chromaticities and white point">§ 11.3.2.1
                    cHRM Primary chromaticities and white point</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3deliveredImage"
        aria-label="Links in this document to definition: Delivered image">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3deliveredImage"
                aria-label="Permalink for definition: Delivered image. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3deliveredImage-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
            <li>
                <a href="#ref-for-3deliveredImage-2" title="§ 4.2 Images">§ 4.2 Images</a> <a
                    href="#ref-for-3deliveredImage-3" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3alphaSeparation"
        aria-label="Links in this document to definition: Alpha separation">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3alphaSeparation"
                aria-label="Permalink for definition: Alpha separation. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3alphaSeparation-1" title="§ 4.2 Images">§ 4.2 Images</a>
            </li>
            <li>
                <a href="#ref-for-3alphaSeparation-2" title="§ Introduction">§ Introduction</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3indexing"
        aria-label="Links in this document to definition: indexing">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3indexing"
                aria-label="Permalink for definition: indexing. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3indexing-1" title="§ 4.2 Images">§ 4.2 Images</a>
            </li>
            <li>
                <a href="#ref-for-3indexing-2" title="§ Introduction">§ Introduction</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3indexedColour"
        aria-label="Links in this document to definition: indexed-color">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3indexedColour"
                aria-label="Permalink for definition: indexed-color. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3indexedColour-1" title="§ Abstract">§ Abstract</a>
            </li>
            <li>
                <a href="#ref-for-3indexedColour-2" title="§ 1. Introduction">§ 1. Introduction</a>
            </li>
            <li>
                <a href="#ref-for-3indexedColour-3" title="§ 4.4.2 Indexing">§ 4.4.2 Indexing</a> <a
                    href="#ref-for-3indexedColour-4" title="Reference 2">(2)</a> <a href="#ref-for-3indexedColour-5"
                    title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-3indexedColour-6" title="§ 4.5 PNG image">§ 4.5 PNG image</a> <a
                    href="#ref-for-3indexedColour-7" title="Reference 2">(2)</a> <a href="#ref-for-3indexedColour-8"
                    title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-3indexedColour-9" title="§ 6.2 Alpha representation">§ 6.2 Alpha representation</a> <a
                    href="#ref-for-3indexedColour-10" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-3indexedColour-11" title="§ 7.2 Scanlines">§ 7.2 Scanlines</a>
            </li>
            <li>
                <a href="#ref-for-3indexedColour-12" title="§ 11.2.1 IHDR Image header">§ 11.2.1 IHDR Image header</a>
            </li>
            <li>
                <a href="#ref-for-3indexedColour-13" title="§ 11.3.1.1 tRNS Transparency">§ 11.3.1.1 tRNS
                    Transparency</a>
            </li>
            <li>
                <a href="#ref-for-3indexedColour-14" title="§ 11.3.2.4 sBIT Significant bits">§ 11.3.2.4 sBIT
                    Significant bits</a>
            </li>
            <li>
                <a href="#ref-for-3indexedColour-15" title="§ 11.3.4.1 bKGD Background color">§ 11.3.4.1 bKGD Background
                    color</a>
            </li>
            <li>
                <a href="#ref-for-3indexedColour-16" title="§ 12.5 Suggested palettes">§ 12.5 Suggested palettes</a>
            </li>
            <li>
                <a href="#ref-for-3indexedColour-17" title="§ 12.7 Filter selection">§ 12.7 Filter selection</a>
            </li>
            <li>
                <a href="#ref-for-3indexedColour-18" title="§ 13.11 Truecolor image handling">§ 13.11 Truecolor image
                    handling</a>
            </li>
            <li>
                <a href="#ref-for-3indexedColour-19" title="§ 13.15 Background color">§ 13.15 Background color</a>
            </li>
            <li>
                <a href="#ref-for-3indexedColour-20" title="§ 13.16 Alpha channel processing">§ 13.16 Alpha channel
                    processing</a>
            </li>
            <li>
                <a href="#ref-for-3indexedColour-21" title="§ 15.3.4 Conformance of PNG editors">§ 15.3.4 Conformance of
                    PNG editors</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3palette"
        aria-label="Links in this document to definition: palette">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3palette"
                aria-label="Permalink for definition: palette. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3palette-1" title="§ Introduction">§ Introduction</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3alphaTable"
        aria-label="Links in this document to definition: alpha table">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3alphaTable"
                aria-label="Permalink for definition: alpha table. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3alphaTable-1" title="§ Introduction">§ Introduction</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3RGBmerging"
        aria-label="Links in this document to definition: RGB merging">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3RGBmerging"
                aria-label="Permalink for definition: RGB merging. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3RGBmerging-1" title="§ 4.2 Images">§ 4.2 Images</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3alphaCompaction"
        aria-label="Links in this document to definition: Alpha compaction">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3alphaCompaction"
                aria-label="Permalink for definition: Alpha compaction. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3alphaCompaction-1" title="§ 4.2 Images">§ 4.2 Images</a>
            </li>
            <li>
                <a href="#ref-for-3alphaCompaction-2" title="§ Introduction">§ Introduction</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3sampleDepthScaling"
        aria-label="Links in this document to definition: Sample depth scaling">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3sampleDepthScaling"
                aria-label="Permalink for definition: Sample depth scaling. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3sampleDepthScaling-1" title="§ 4.2 Images">§ 4.2 Images</a>
            </li>
            <li>
                <a href="#ref-for-3sampleDepthScaling-2" title="§ 4.4.5 Sample depth scaling">§ 4.4.5 Sample depth
                    scaling</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-truecolor-with-alpha"
        aria-label="Links in this document to definition: Truecolor with alpha">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-truecolor-with-alpha"
                aria-label="Permalink for definition: Truecolor with alpha. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-truecolor-with-alpha-1" title="§ 4.5 PNG image">§ 4.5 PNG image</a>
            </li>
            <li>
                <a href="#ref-for-dfn-truecolor-with-alpha-2" title="§ 6.2 Alpha representation">§ 6.2 Alpha
                    representation</a>
            </li>
            <li>
                <a href="#ref-for-dfn-truecolor-with-alpha-3" title="§ 11.2.2 PLTE Palette">§ 11.2.2 PLTE Palette</a>
            </li>
            <li>
                <a href="#ref-for-dfn-truecolor-with-alpha-4" title="§ 11.3.4.1 bKGD Background color">§ 11.3.4.1 bKGD
                    Background color</a>
            </li>
            <li>
                <a href="#ref-for-dfn-truecolor-with-alpha-5" title="§ 12.5 Suggested palettes">§ 12.5 Suggested
                    palettes</a> <a href="#ref-for-dfn-truecolor-with-alpha-6" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-truecolor-with-alpha-7" title="§ 13.17 Histogram and suggested palette usage">§
                    13.17 Histogram and suggested palette usage</a>
            </li>
            <li>
                <a href="#ref-for-dfn-truecolor-with-alpha-8" title="§ 15.3.3 Conformance of PNG decoders">§ 15.3.3
                    Conformance of PNG decoders</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-greyscale-with-alpha"
        aria-label="Links in this document to definition: Greyscale with alpha">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-greyscale-with-alpha"
                aria-label="Permalink for definition: Greyscale with alpha. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-greyscale-with-alpha-1" title="§ 4.5 PNG image">§ 4.5 PNG image</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-with-alpha-2" title="§ 6.2 Alpha representation">§ 6.2 Alpha
                    representation</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-with-alpha-3" title="§ 11.3.4.1 bKGD Background color">§ 11.3.4.1 bKGD
                    Background color</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-with-alpha-4" title="§ 15.3.3 Conformance of PNG decoders">§ 15.3.3
                    Conformance of PNG decoders</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3truecolour"
        aria-label="Links in this document to definition: Truecolor">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3truecolour"
                aria-label="Permalink for definition: Truecolor. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3truecolour-1" title="§ Abstract">§ Abstract</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-2" title="§ 1. Introduction">§ 1. Introduction</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-3" title="§ 4.5 PNG image">§ 4.5 PNG image</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-4" title="§ 6.1 Color types and values">§ 6.1 Color types and values</a>
                <a href="#ref-for-3truecolour-5" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-6" title="§ 6.2 Alpha representation">§ 6.2 Alpha representation</a> <a
                    href="#ref-for-3truecolour-7" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-8" title="§ 11.2.2 PLTE Palette">§ 11.2.2 PLTE Palette</a> <a
                    href="#ref-for-3truecolour-9" title="Reference 2">(2)</a> <a href="#ref-for-3truecolour-10"
                    title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-11" title="§ 11.3.1.1 tRNS Transparency">§ 11.3.1.1 tRNS Transparency</a>
                <a href="#ref-for-3truecolour-12" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-13" title="§ 11.3.4.1 bKGD Background color">§ 11.3.4.1 bKGD Background
                    color</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-14" title="§ 11.3.4.2 hIST Image histogram">§ 11.3.4.2 hIST Image
                    histogram</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-15" title="§ 12.5 Suggested palettes">§ 12.5 Suggested palettes</a> <a
                    href="#ref-for-3truecolour-16" title="Reference 2">(2)</a> <a href="#ref-for-3truecolour-17"
                    title="Reference 3">(3)</a> <a href="#ref-for-3truecolour-18" title="Reference 4">(4)</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-19" title="§ 12.7 Filter selection">§ 12.7 Filter selection</a> <a
                    href="#ref-for-3truecolour-20" title="Reference 2">(2)</a> <a href="#ref-for-3truecolour-21"
                    title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-22" title="§ 13.1 Error handling">§ 13.1 Error handling</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-23" title="§ 13.11 Truecolor image handling">§ 13.11 Truecolor image
                    handling</a> <a href="#ref-for-3truecolour-24" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-25" title="§ 13.16 Alpha channel processing">§ 13.16 Alpha channel
                    processing</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-26" title="§ 13.17 Histogram and suggested palette usage">§ 13.17
                    Histogram and suggested palette usage</a> <a href="#ref-for-3truecolour-27"
                    title="Reference 2">(2)</a> <a href="#ref-for-3truecolour-28" title="Reference 3">(3)</a> <a
                    href="#ref-for-3truecolour-29" title="Reference 4">(4)</a> <a href="#ref-for-3truecolour-30"
                    title="Reference 5">(5)</a> <a href="#ref-for-3truecolour-31" title="Reference 6">(6)</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-32" title="§ 14.2 Behavior of PNG editors">§ 14.2 Behavior of PNG
                    editors</a>
            </li>
            <li>
                <a href="#ref-for-3truecolour-33" title="§ 15.3.3 Conformance of PNG decoders">§ 15.3.3 Conformance of
                    PNG decoders</a> <a href="#ref-for-3truecolour-34" title="Reference 2">(2)</a> <a
                    href="#ref-for-3truecolour-35" title="Reference 3">(3)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-greyscale"
        aria-label="Links in this document to definition: Greyscale">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-greyscale"
                aria-label="Permalink for definition: Greyscale. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-greyscale-1" title="§ Abstract">§ Abstract</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-2" title="§ 1. Introduction">§ 1. Introduction</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-3" title="§ 4.5 PNG image">§ 4.5 PNG image</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-4" title="§ 6.1 Color types and values">§ 6.1 Color types and values</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-5" title="§ 6.2 Alpha representation">§ 6.2 Alpha representation</a> <a
                    href="#ref-for-dfn-greyscale-6" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-7" title="§ 11.3.1.1 tRNS Transparency">§ 11.3.1.1 tRNS Transparency</a>
                <a href="#ref-for-dfn-greyscale-8" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-9" title="§ 11.3.2.1 cHRM Primary chromaticities and white point">§
                    11.3.2.1 cHRM Primary chromaticities and white point</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-10" title="§ 11.3.2.3 iCCP Embedded ICC profile">§ 11.3.2.3 iCCP
                    Embedded ICC profile</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-11" title="§ 11.3.4.1 bKGD Background color">§ 11.3.4.1 bKGD Background
                    color</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-12" title="§ 11.3.4.4 sPLT Suggested palette">§ 11.3.4.4 sPLT Suggested
                    palette</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-13" title="§ 12.5 Suggested palettes">§ 12.5 Suggested palettes</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-14" title="§ 12.7 Filter selection">§ 12.7 Filter selection</a> <a
                    href="#ref-for-dfn-greyscale-15" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-16" title="§ 13.11 Truecolor image handling">§ 13.11 Truecolor image
                    handling</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-17" title="§ 13.16 Alpha channel processing">§ 13.16 Alpha channel
                    processing</a>
            </li>
            <li>
                <a href="#ref-for-dfn-greyscale-18" title="§ 15.3.3 Conformance of PNG decoders">§ 15.3.3 Conformance of
                    PNG decoders</a> <a href="#ref-for-dfn-greyscale-19" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3greyscale"
        aria-label="Links in this document to definition: grey sample">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3greyscale"
                aria-label="Permalink for definition: grey sample. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3greyscale-1" title="§ 4.5 PNG image">§ 4.5 PNG image</a> <a
                    href="#ref-for-3greyscale-2" title="Reference 2">(2)</a> <a href="#ref-for-3greyscale-3"
                    title="Reference 3">(3)</a> <a href="#ref-for-3greyscale-4" title="Reference 4">(4)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3passExtraction"
        aria-label="Links in this document to definition: Pass extraction">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3passExtraction"
                aria-label="Permalink for definition: Pass extraction. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3passExtraction-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3reducedImage"
        aria-label="Links in this document to definition: reduced images">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3reducedImage"
                aria-label="Permalink for definition: reduced images. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3reducedImage-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3ancillaryChunk"
        aria-label="Links in this document to definition: ancillary chunk">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3ancillaryChunk"
                aria-label="Permalink for definition: ancillary chunk. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-output-buffer"
        aria-label="Links in this document to definition: output buffer">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-output-buffer"
                aria-label="Permalink for definition: output buffer. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-output-buffer-1" title="§ 4.9.1 Structure">§ 4.9.1 Structure</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-canvas"
        aria-label="Links in this document to definition: canvas">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-canvas"
                aria-label="Permalink for definition: canvas. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-canvas-1" title="§ 4.9.3 Output buffer">§ 4.9.3 Output buffer</a> <a
                    href="#ref-for-dfn-canvas-2" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-canvas-3" title="§ 11.3.6.3 fdAT Frame Data Chunk">§ 11.3.6.3 fdAT Frame Data
                    Chunk</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3PNGdatastream"
        aria-label="Links in this document to definition: PNG datastream">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3PNGdatastream"
                aria-label="Permalink for definition: PNG datastream. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3PNGdatastream-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a> <a href="#ref-for-3PNGdatastream-2"
                    title="Reference 2">(2)</a> <a href="#ref-for-3PNGdatastream-3" title="Reference 3">(3)</a> <a
                    href="#ref-for-3PNGdatastream-4" title="Reference 4">(4)</a>
            </li>
            <li>
                <a href="#ref-for-3PNGdatastream-5" title="§ 4.2 Images">§ 4.2 Images</a> <a
                    href="#ref-for-3PNGdatastream-6" title="Reference 2">(2)</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3chunk"
        aria-label="Links in this document to definition: chunk">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3chunk"
                aria-label="Permalink for definition: chunk. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3chunk-1" title="§ 3. Terms, definitions, and abbreviated terms">§ 3. Terms,
                    definitions, and abbreviated terms</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-private-field-values"
        aria-label="Links in this document to definition: private field values">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-private-field-values"
                aria-label="Permalink for definition: private field values. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-private-field-values-1" title="§ 4.11 Extensions">§ 4.11 Extensions</a>
            </li>
            <li>
                <a href="#ref-for-dfn-private-field-values-2" title="§ 5.8 Private field values">§ 5.8 Private field
                    values</a> <a href="#ref-for-dfn-private-field-values-3" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-private-field-values-4" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-dfn-private-field-values-5" title="§ 15.3.2 Conformance of PNG encoders">§ 15.3.2
                    Conformance of PNG encoders</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3colourType"
        aria-label="Links in this document to definition: color type">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3colourType"
                aria-label="Permalink for definition: color type. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3colourType-1" title="§ 5.8 Private field values">§ 5.8 Private field values</a>
            </li>
            <li>
                <a href="#colorType" title="§ 6.1 Color types and values">§ 6.1 Color types and values</a> <a
                    href="#ref-for-3colourType-3" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-4" title="§ 7.2 Scanlines">§ 7.2 Scanlines</a> <a
                    href="#ref-for-3colourType-5" title="Reference 2">(2)</a> <a href="#ref-for-3colourType-6"
                    title="Reference 3">(3)</a> <a href="#ref-for-3colourType-7" title="Reference 4">(4)</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-8" title="§ 9.2 Filter types for filter method 0">§ 9.2 Filter types for
                    filter method 0</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-9" title="§ 11.2.1 IHDR Image header">§ 11.2.1 IHDR Image header</a> <a
                    href="#ref-for-3colourType-10" title="Reference 2">(2)</a> <a href="#ref-for-3colourType-11"
                    title="Reference 3">(3)</a> <a href="#ref-for-3colourType-12" title="Reference 4">(4)</a> <a
                    href="#ref-for-3colourType-13" title="Reference 5">(5)</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-14" title="§ 11.2.2 PLTE Palette">§ 11.2.2 PLTE Palette</a> <a
                    href="#ref-for-3colourType-15" title="Reference 2">(2)</a> <a href="#ref-for-3colourType-16"
                    title="Reference 3">(3)</a> <a href="#ref-for-3colourType-17" title="Reference 4">(4)</a> <a
                    href="#ref-for-3colourType-18" title="Reference 5">(5)</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-19" title="§ 11.3.1.1 tRNS Transparency">§ 11.3.1.1 tRNS Transparency</a>
                <a href="#ref-for-3colourType-20" title="Reference 2">(2)</a> <a href="#ref-for-3colourType-21"
                    title="Reference 3">(3)</a> <a href="#ref-for-3colourType-22" title="Reference 4">(4)</a> <a
                    href="#ref-for-3colourType-23" title="Reference 5">(5)</a> <a href="#ref-for-3colourType-24"
                    title="Reference 6">(6)</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-25" title="§ 11.3.2.3 iCCP Embedded ICC profile">§ 11.3.2.3 iCCP Embedded
                    ICC profile</a> <a href="#ref-for-3colourType-26" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-27" title="§ 11.3.2.4 sBIT Significant bits">§ 11.3.2.4 sBIT Significant
                    bits</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-28" title="§ 11.3.4.1 bKGD Background color">§ 11.3.4.1 bKGD Background
                    color</a> <a href="#ref-for-3colourType-29" title="Reference 2">(2)</a> <a
                    href="#ref-for-3colourType-30" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-31" title="§ 11.3.4.4 sPLT Suggested palette">§ 11.3.4.4 sPLT Suggested
                    palette</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-32" title="§ 11.3.6.3 fdAT Frame Data Chunk">§ 11.3.6.3 fdAT Frame Data
                    Chunk</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-33" title="§ 12.5 Suggested palettes">§ 12.5 Suggested palettes</a> <a
                    href="#ref-for-3colourType-34" title="Reference 2">(2)</a> <a href="#ref-for-3colourType-35"
                    title="Reference 3">(3)</a> <a href="#ref-for-3colourType-36" title="Reference 4">(4)</a> <a
                    href="#ref-for-3colourType-37" title="Reference 5">(5)</a> <a href="#ref-for-3colourType-38"
                    title="Reference 6">(6)</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-39" title="§ 12.7 Filter selection">§ 12.7 Filter selection</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-40" title="§ Introduction">§ Introduction</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-41" title="§ 13.17 Histogram and suggested palette usage">§ 13.17
                    Histogram and suggested palette usage</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-42" title="§ 15.3.3 Conformance of PNG decoders">§ 15.3.3 Conformance of
                    PNG decoders</a> <a href="#ref-for-3colourType-43" title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-3colourType-44" title="§ 15.3.4 Conformance of PNG editors">§ 15.3.4 Conformance of
                    PNG editors</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3filter"
        aria-label="Links in this document to definition: filter method">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3filter"
                aria-label="Permalink for definition: filter method. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-3filter-1" title="§ 7.3 Filtering">§ 7.3 Filtering</a> <a href="#ref-for-3filter-2"
                    title="Reference 2">(2)</a>
            </li>
            <li>
                <a href="#ref-for-3filter-3" title="§ 9.1 Filter methods and filter types">§ 9.1 Filter methods and
                    filter types</a> <a href="#ref-for-3filter-4" title="Reference 2">(2)</a> <a
                    href="#ref-for-3filter-5" title="Reference 3">(3)</a> <a href="#ref-for-3filter-6"
                    title="Reference 4">(4)</a> <a href="#ref-for-3filter-7" title="Reference 5">(5)</a>
            </li>
            <li>
                <a href="#ref-for-3filter-8" title="§ 9.2 Filter types for filter method 0">§ 9.2 Filter types for
                    filter method 0</a> <a href="#ref-for-3filter-9" title="Reference 2">(2)</a> <a
                    href="#ref-for-3filter-10" title="Reference 3">(3)</a>
            </li>
            <li>
                <a href="#ref-for-3filter-11" title="§ 11.2.1 IHDR Image header">§ 11.2.1 IHDR Image header</a>
            </li>
            <li>
                <a href="#ref-for-3filter-12" title="§ 11.3.6.3 fdAT Frame Data Chunk">§ 11.3.6.3 fdAT Frame Data
                    Chunk</a>
            </li>
            <li>
                <a href="#ref-for-3filter-13" title="§ Introduction">§ Introduction</a>
            </li>
            <li>
                <a href="#ref-for-3filter-14" title="§ 15.3.3 Conformance of PNG decoders">§ 15.3.3 Conformance of PNG
                    decoders</a>
            </li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-3criticalChunk"
        aria-label="Links in this document to definition: critical chunk">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#3criticalChunk"
                aria-label="Permalink for definition: critical chunk. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>Not referenced in this document.</li>
        </ul>
    </div>
    <div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-gamma-encoding"
        aria-label="Links in this document to definition: gamma encoding">
        <span class="caret"></span>
        <div>
            <a class="self-link" href="#dfn-gamma-encoding"
                aria-label="Permalink for definition: gamma encoding. Activate to close this dialog.">Permalink</a>

        </div>
        <p><b>Referenced in:</b></p>
        <ul>
            <li>
                <a href="#ref-for-dfn-gamma-encoding-1" title="§ 12.1 Encoder gamma handling">§ 12.1 Encoder gamma
                    handling</a> <a href="#ref-for-dfn-gamma-encoding-2" title="Reference 2">(2)</a> <a
                    href="#ref-for-dfn-gamma-encoding-3" title="Reference 3">(3)</a> <a
                    href="#ref-for-dfn-gamma-encoding-4" title="Reference 4">(4)</a>
            </li>
        </ul>
    </div>
    <script src="https://www.w3.org/scripts/TR/fixup.js"></script>


    <section id="references" class="appendix">
        <div class="header-wrapper">
            <h2 id="g-references"><bdi class="secno">G. </bdi>参考文献</h2><a class="self-link" href="#references"
                aria-label="Permalink for Appendix G."></a>
        </div>
        <section id="normative-references">
            <div class="header-wrapper">
                <h3 id="g-1-normative-references"><bdi class="secno">G.1 </bdi>规范性参考文献</h3><a class="self-link"
                    href="#normative-references" aria-label="Permalink for Appendix G.1"></a>
            </div>

            <dl class="bibliography">
                <dt id="bib-bcp47">[BCP47]</dt>
                <dd>
                    <a href="https://www.rfc-editor.org/rfc/rfc5646"><cite>用于标识语言的标签</cite></a>。A.
                    Phillips（编）；M. Davis（编）。IETF。2009 年 9 月。最佳现行实践。网址：<a
                        href="https://www.rfc-editor.org/rfc/rfc5646">https://www.rfc-editor.org/rfc/rfc5646</a>
                </dd>
                <dt id="bib-cipa-dc-008">[CIPA-DC-008]</dt>
                <dd>
                    <a href="https://www.cipa.jp/std/documents/download_e.html?DC-008-Translation-2019-E"><cite>可交换
                            图像文件格式：Exif 版本 2.32</cite></a>。相机与影像产品协会。2019-05-17。网址：<a
                        href="https://www.cipa.jp/std/documents/download_e.html?DC-008-Translation-2019-E">https://www.cipa.jp/std/documents/download_e.html?DC-008-Translation-2019-E</a>
                </dd>
                <dt id="bib-colorimetry">[COLORIMETRY]</dt>
                <dd>
                    <a href="http://www.cie.co.at/publications/colorimetry-4th-edition"><cite>色度学，第四版（CIE
                            015:2018）</cite></a>。CIE。2018。网址：<a
                        href="http://www.cie.co.at/publications/colorimetry-4th-edition">http://www.cie.co.at/publications/colorimetry-4th-edition</a>
                </dd>
                <dt id="bib-display-p3">[Display-P3]</dt>
                <dd>
                    <a href="https://www.color.org/chardata/rgb/DisplayP3.xalter"><cite>Display P3</cite></a>。Apple,
                    Inc. ICC。2022-02。网址：<a
                        href="https://www.color.org/chardata/rgb/DisplayP3.xalter">https://www.color.org/chardata/rgb/DisplayP3.xalter</a>
                </dd>
                <dt id="bib-encoding">[ENCODING]</dt>
                <dd>
                    <a href="https://encoding.spec.whatwg.org/"><cite>编码规范（Encoding Standard）</cite></a>。Anne van
                    Kesteren。
                    WHATWG。持续更新的标准。网址：<a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
                </dd>
                <dt id="bib-icc">[ICC]</dt>
                <dd>
                    <a href="http://www.color.org/specification/ICC.1-2022-05.pdf"><cite>ICC.1:2022（配置文件版本
                            4.4.0.0）</cite></a>。国际色彩联盟。2022 年 5 月。网址：<a
                        href="http://www.color.org/specification/ICC.1-2022-05.pdf">http://www.color.org/specification/ICC.1-2022-05.pdf</a>
                </dd>
                <dt id="bib-icc-2">[ICC-2]</dt>
                <dd>
                    <a href="https://www.color.org/specification/ICC.2-2019.pdf"><cite>规范 ICC.2:2019（配置文件版本 5.0.0 -
                            iccMAX）</cite></a>。国际色彩联盟。2019。网址：<a
                        href="https://www.color.org/specification/ICC.2-2019.pdf">https://www.color.org/specification/ICC.2-2019.pdf</a>
                </dd>
                <dt id="bib-iso_15076-1">[ISO_15076-1]</dt>
                <dd>
                    <a href="https://www.iso.org/standard/54754.html"><cite>ISO 15076-1:2010 图像技术 色彩管理 — 架构、配置文件格式与数据结构
                            — 第 1 部分：基于 ICC.1:2010</cite></a>。ISO。2010-12。网址：<a
                        href="https://www.iso.org/standard/54754.html">https://www.iso.org/standard/54754.html</a>
                </dd>
                <dt id="bib-iso_8859-1">[ISO_8859-1]</dt>
                <dd>
                    <cite>ISO/IEC 8859-1:1998，信息技术 — 8 位单字节图形字符集 — 第 1 部分：拉丁字母第 1 集。</cite>。ISO。1998。
                </dd>
                <dt id="bib-iso_9899">[ISO_9899]</dt>
                <dd>
                    <a href="https://www.iso.org/standard/74528.html"><cite>ISO/IEC 9899:2018 信息技术 — 编程语言 —
                            C</cite></a>。ISO。2018-6。网址：<a
                        href="https://www.iso.org/standard/74528.html">https://www.iso.org/standard/74528.html</a>
                </dd>
                <dt id="bib-iso-3309">[ISO-3309]</dt>
                <dd>
                    <cite>ISO/IEC 3309:1993，信息技术 — 系统间电信与信息交换 — 高层数据链路控制（HDLC）过程 — 帧结构。</cite>。ISO。1993 年。
                </dd>
                <dt id="bib-iso646">[ISO646]</dt>
                <dd>
                    <a href="https://www.iso.org/standard/4777.html"><cite>信息技术 — 用于信息交换的 ISO 7
                            位编码字符集</cite></a>。国际标准化组织（ISO）。1991 年 12 月。已发布。网址：<a
                        href="https://www.iso.org/standard/4777.html">https://www.iso.org/standard/4777.html</a>
                </dd>
                <dt id="bib-itu-r-bt.2100">[ITU-R-BT.2100]</dt>
                <dd>
                    <a href="https://www.itu.int/rec/R-REC-BT.2100"><cite>ITU-R BT.2100，系列
                            BT：广播服务（电视）。用于制作与国际节目交换的高动态范围电视图像参数值</cite></a>。ITU。2018-07。网址：<a
                        href="https://www.itu.int/rec/R-REC-BT.2100">https://www.itu.int/rec/R-REC-BT.2100</a>
                </dd>
                <dt id="bib-itu-r-bt.709">[ITU-R-BT.709]</dt>
                <dd>
                    <a href="https://www.itu.int/rec/R-REC-BT.709"><cite>ITU-R BT.709，系列 BT：广播服务（电视）。用于 HDTV
                            制作与国际节目交换的参数值</cite></a>。ITU。2015-06。网址：<a
                        href="https://www.itu.int/rec/R-REC-BT.709">https://www.itu.int/rec/R-REC-BT.709</a>
                </dd>
                <dt id="bib-itu-t-h.273">[ITU-T-H.273]</dt>
                <dd>
                    <a href="https://www.itu.int/rec/T-REC-H.273"><cite>ITU-T H.273，系列 H：视听与多媒体系统 — 视听服务基础设施 —
                            运动视频编码。用于视频信号类型识别的编码无关代码点</cite></a>。ITU。2024-07-14。网址：<a
                        href="https://www.itu.int/rec/T-REC-H.273">https://www.itu.int/rec/T-REC-H.273</a>
                </dd>
                <dt id="bib-itu-t-series-h-supplement-19">[ITU-T-Series-H-Supplement-19]</dt>
                <dd>
                    <a href="https://www.itu.int/ITU-T/recommendations/rec.aspx?rec=14652"><cite>系列 H：视听与多媒体系统 —
                            视频信号类型代码点的使用</cite></a>。ITU。2021-04。网址：<a
                        href="https://www.itu.int/ITU-T/recommendations/rec.aspx?rec=14652">https://www.itu.int/ITU-T/recommendations/rec.aspx?rec=14652</a>
                </dd>
                <dt id="bib-itu-t-v.42">[ITU-T-V.42]</dt>
                <dd>
                    <a href="https://www.itu.int/rec/T-REC-V.42-200203-I/en"><cite>ITU-T V.42，系列 V：电话网络上的数据通信 —
                            使用异步到同步转换的 DCE 的差错纠正程序</cite></a>。ITU。2002-03-29。网址：<a
                        href="https://www.itu.int/rec/T-REC-V.42-200203-I/en">https://www.itu.int/rec/T-REC-V.42-200203-I/en</a>
                </dd>
                <dt id="bib-jpeg">[JPEG]</dt>
                <dd>
                    <a href="https://www.w3.org/Graphics/JPEG/jfif3.pdf"><cite>JPEG 文件交换格式（JFIF）</cite></a>。
                    Eric Hamilton。C-Cube Microsystems。Milpitas, CA, USA。1992 年 9 月。网址：<a
                        href="https://www.w3.org/Graphics/JPEG/jfif3.pdf">https://www.w3.org/Graphics/JPEG/jfif3.pdf</a>
                </dd>
                <dt id="bib-paeth">[Paeth]</dt>
                <dd>
                    <a href="https://www.sciencedirect.com/science/article/pii/B9780080507545500293"><cite>图像文件压缩简易法，收录于
                            Graphics Gems II，第 93–100 页</cite></a>。Paeth, A.W.。Academic
                    Press。1991。网址：<a
                        href="https://www.sciencedirect.com/science/article/pii/B9780080507545500293">https://www.sciencedirect.com/science/article/pii/B9780080507545500293</a>
                </dd>
                <dt id="bib-png-extensions">[PNG-EXTENSIONS]</dt>
                <dd>
                    <a href="https://w3c.github.io/png/extensions/Overview.html"><cite>PNG 第三版规范扩展（版本
                            1.6.0）</cite></a>。W3C。2021。网址：<a
                        href="https://w3c.github.io/png/extensions/Overview.html">https://w3c.github.io/png/extensions/Overview.html</a>
                </dd>
                <dt id="bib-rfc1123">[rfc1123]</dt>
                <dd>
                    <a href="https://www.rfc-editor.org/rfc/rfc1123"><cite>互联网主机要求 — 应用与支持</cite></a>。R.
                    Braden（编）。IETF。1989 年 10 月。互联网标准。网址：<a
                        href="https://www.rfc-editor.org/rfc/rfc1123">https://www.rfc-editor.org/rfc/rfc1123</a>
                </dd>
                <dt id="bib-rfc1950">[rfc1950]</dt>
                <dd>
                    <a href="https://www.rfc-editor.org/rfc/rfc1950"><cite>ZLIB 压缩数据格式规范 版本 3.3</cite></a>。P.
                    Deutsch；J-L. Gailly。IETF。1996 年 5 月。信息性文档。网址：<a
                        href="https://www.rfc-editor.org/rfc/rfc1950">https://www.rfc-editor.org/rfc/rfc1950</a>
                </dd>
                <dt id="bib-rfc1951">[RFC1951]</dt>
                <dd>
                    <a href="https://www.rfc-editor.org/rfc/rfc1951"><cite>DEFLATE 压缩数据格式规范 版本 1.3</cite></a>。P.
                    Deutsch。IETF。1996 年 5 月。信息性文档。网址：<a
                        href="https://www.rfc-editor.org/rfc/rfc1951">https://www.rfc-editor.org/rfc/rfc1951</a>
                </dd>
                <dt id="bib-rfc1952">[RFC1952]</dt>
                <dd>
                    <a href="https://www.rfc-editor.org/rfc/rfc1952"><cite>GZIP 文件格式规范 版本 4.3</cite></a>。P.
                    Deutsch。IETF。1996 年 5 月。信息性文档。网址：<a
                        href="https://www.rfc-editor.org/rfc/rfc1952">https://www.rfc-editor.org/rfc/rfc1952</a>
                </dd>
                <dt id="bib-rfc2119">[RFC2119]</dt>
                <dd>
                    <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>用于 RFC 中指示要求级别的关键字</cite></a>。S.
                    Bradner。IETF。1997 年 3 月。最佳现行实践。网址：<a
                        href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
                </dd>
                <dt id="bib-rfc3339">[rfc3339]</dt>
                <dd>
                    <a href="https://www.rfc-editor.org/rfc/rfc3339"><cite>互联网的日期与时间：时间戳</cite></a>。G. Klyne；C.
                    Newman。IETF。2002 年 7 月。拟定标准。网址：<a
                        href="https://www.rfc-editor.org/rfc/rfc3339">https://www.rfc-editor.org/rfc/rfc3339</a>
                </dd>
                <dt id="bib-rfc3629">[rfc3629]</dt>
                <dd>
                    <a href="https://www.rfc-editor.org/rfc/rfc3629"><cite>UTF-8：ISO 10646 的一种转换格式</cite></a>。F.
                    Yergeau。IETF。2003 年 11 月。互联网标准。网址：<a
                        href="https://www.rfc-editor.org/rfc/rfc3629">https://www.rfc-editor.org/rfc/rfc3629</a>
                </dd>
                <dt id="bib-rfc8174">[RFC8174]</dt>
                <dd>
                    <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>RFC 2119 关键字大小写二义性的说明</cite></a>。B.
                    Leiba。IETF。2017 年 5 月。最佳现行实践。网址：<a
                        href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
                </dd>
                <dt id="bib-smpte-170m">[SMPTE-170M]</dt>
                <dd>
                    <a href="https://standards.globalspec.com/std/892300/SMPTE%20ST%20170M"><cite>电视 — 复合模拟视频信号 — 用于制作的
                            NTSC（SMPTE-170M）</cite></a>。电影与电视工程学会（SMPTE）。2004-11-30。网址：<a
                        href="https://standards.globalspec.com/std/892300/SMPTE%20ST%20170M">https://standards.globalspec.com/std/892300/SMPTE%20ST%20170M</a>
                </dd>
                <dt id="bib-smpte-st-2086">[SMPTE-ST-2086]</dt>
                <dd>
                    <a
                        href="https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8353899"><cite>支持高亮度与宽色域图像的母带显示色彩体积元数据</cite></a>。SMPTE。2018-04-27。网址：<a
                        href="https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8353899">https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8353899</a>
                </dd>
                <dt id="bib-srgb">[SRGB]</dt>
                <dd>
                    <a href="https://webstore.iec.ch/publication/6169"><cite>多媒体系统与设备 — 色度测量与管理 — 第 2-1 部分：色彩管理 — 默认 RGB
                            色彩空间 — sRGB</cite></a>。IEC。网址：<a
                        href="https://webstore.iec.ch/publication/6169">https://webstore.iec.ch/publication/6169</a>
                </dd>
                <dt id="bib-xmp">[XMP]</dt>
                <dd>
                    <a href="https://www.iso.org/standard/75163.html"><cite>可扩展元数据平台（XMP）规范 — 第 1 部分</cite></a>。Adobe
                    Systems Inc. ISO/IEC。2019 年 4 月。网址：<a
                        href="https://www.iso.org/standard/75163.html">https://www.iso.org/standard/75163.html</a>
                </dd>
                <dt id="bib-ziv-lempel">[Ziv-Lempel]</dt>
                <dd>
                    <a href="https://ieeexplore.ieee.org/document/1055714"><cite>顺序数据压缩的通用算法，《IEEE 信息论学报》，第 IT-23 卷，第 3
                            期，第 337–343 页</cite></a>。J. Ziv；A. Lempel。IEEE。1977-05。网址：<a
                        href="https://ieeexplore.ieee.org/document/1055714">https://ieeexplore.ieee.org/document/1055714</a>
                </dd>
            </dl>
        </section>
        <section id="informative-references">
            <div class="header-wrapper">
                <h3 id="g-2-informative-references"><bdi class="secno">G.2 </bdi>信息性参考文献</h3><a class="self-link"
                    href="#informative-references" aria-label="Permalink for Appendix G.2"></a>
            </div>

            <dl class="bibliography">
                <dt id="bib-color-faq">[COLOR-FAQ]</dt>
                <dd>
                    <a href="https://poynton.ca/ColorFAQ.html"><cite>色彩常见问题（Color FAQ）</cite></a>。Poynton, C.
                    2009-10-19。网址：
                    <a href="https://poynton.ca/ColorFAQ.html">https://poynton.ca/ColorFAQ.html</a>
                </dd>
                <dt id="bib-cta-861.3-a">[CTA-861.3-A]</dt>
                <dd>
                    <a href="https://shop.cta.tech/products/cta-861-3"><cite>HDR
                            静态元数据扩展（CTA-861.3-A）</cite></a>。消费者技术协会（CTA）。2015-01。网址：<a
                        href="https://shop.cta.tech/products/cta-861-3">https://shop.cta.tech/products/cta-861-3</a>
                </dd>
                <dt id="bib-ebu-r-103">[EBU-R-103]</dt>
                <dd>
                    <a
                        href="https://tech.ebu.ch/docs/r/r103.pdf"><cite>数字电视系统中的视频信号容差</cite></a>。欧洲广播联盟（EBU）。2020-05。网址：<a
                        href="https://tech.ebu.ch/docs/r/r103.pdf">https://tech.ebu.ch/docs/r/r103.pdf</a>
                </dd>
                <dt id="bib-gamma-faq">[GAMMA-FAQ]</dt>
                <dd>
                    <a href="https://poynton.ca/GammaFAQ.html"><cite>伽玛常见问题（Gamma FAQ）</cite></a>。Poynton, C.
                    1998-08-04。网址：
                    <a href="https://poynton.ca/GammaFAQ.html">https://poynton.ca/GammaFAQ.html</a>
                </dd>
                <dt id="bib-gif">[GIF]</dt>
                <dd>
                    <a
                        href="https://www.w3.org/Graphics/GIF/spec-gif89a.txt"><cite>图形交换格式（GIF89a）规范</cite></a>。CompuServe
                    Inc. 1990-07-31。网址：<a
                        href="https://www.w3.org/Graphics/GIF/spec-gif89a.txt">https://www.w3.org/Graphics/GIF/spec-gif89a.txt</a>
                </dd>
                <dt id="bib-hdr-static-meta">[HDR-Static-Meta]</dt>
                <dd>
                    <a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=9508136"><cite>关于 HDR
                            静态内容元数据的计算与使用</cite></a>。Smith, Michael D.; Zink, Michael。SMPTE。2021-08-05。网址：<a
                        href="https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=9508136">https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=9508136</a>
                </dd>
                <dt id="bib-hdr10">[HDR10]</dt>
                <dd>
                    <a href="https://en.wikipedia.org/wiki/HDR10"><cite>HDR10 媒体配置文件</cite></a>。网址：<a
                        href="https://en.wikipedia.org/wiki/HDR10">https://en.wikipedia.org/wiki/HDR10</a>
                </dd>
                <dt id="bib-hill">[Hill]</dt>
                <dd>
                    <a href="https://dl.acm.org/doi/10.1145/248210.248212"><cite>基于 CIELAB
                            色差公式的色彩空间量化比较分析</cite></a>。Hill, B.; Roger, Th.; Vorhagen, F.W. 1997-04。网址：<a
                        href="https://dl.acm.org/doi/10.1145/248210.248212">https://dl.acm.org/doi/10.1145/248210.248212</a>
                </dd>
                <dt id="bib-itu-r-bt.2020">[ITU-R-BT.2020]</dt>
                <dd>
                    <a href="https://www.itu.int/rec/R-REC-BT.2020"><cite>超高清电视系统的参数值，用于制作与国际节目交换</cite></a>。ITU。网址：
                    <a href="https://www.itu.int/rec/R-REC-BT.2020">https://www.itu.int/rec/R-REC-BT.2020</a>
                </dd>
                <dt id="bib-itu-r-bt.2390">[ITU-R-BT.2390]</dt>
                <dd>
                    <a
                        href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-11-2023-PDF-E.pdf"><cite>用于制作与国际节目交换的高动态范围电视</cite></a>。ITU。网址：<a
                        href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-11-2023-PDF-E.pdf">https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-11-2023-PDF-E.pdf</a>
                </dd>
                <dt id="bib-kasson">[Kasson]</dt>
                <dd>
                    <a href="https://dl.acm.org/doi/abs/10.1145/146443.146479"><cite>选定计算机交换色彩空间的分析</cite></a>。Kasson,
                    J.; W. Plouffe。1992。网址：<a
                        href="https://dl.acm.org/doi/abs/10.1145/146443.146479">https://dl.acm.org/doi/abs/10.1145/146443.146479</a>
                </dd>
                <dt id="bib-postscript">[PostScript]</dt>
                <dd>
                    <cite>PostScript 语言参考手册</cite>。Adobe Systems Inc.。Addison-Wesley。1990 年。
                </dd>
                <dt id="bib-roelofs">[ROELOFS]</dt>
                <dd>
                    <a href="http://www.libpng.org/pub/png/pngbook.html"><cite>PNG：权威指南</cite></a>。Roelofs, G. O'Reilly
                    &amp; Associates Inc. 1999-06-11。网址：<a
                        href="http://www.libpng.org/pub/png/pngbook.html">http://www.libpng.org/pub/png/pngbook.html</a>
                </dd>
                <dt id="bib-smpte-rp-177">[SMPTE-RP-177]</dt>
                <dd>
                    <a
                        href="https://standards.globalspec.com/std/1284890/smpte-rp-177"><cite>基本电视色彩方程的推导</cite></a>。SMPTE。1993-11-01。网址：<a
                        href="https://standards.globalspec.com/std/1284890/smpte-rp-177">https://standards.globalspec.com/std/1284890/smpte-rp-177</a>
                </dd>
                <dt id="bib-smpte-rp-2077">[SMPTE-RP-2077]</dt>
                <dd>
                    <a href="https://doi.org/10.5594/SMPTE.RP2077.2013"><cite>全范围图像映射</cite></a>。SMPTE。2013-01-01。网址：<a
                        href="https://doi.org/10.5594/SMPTE.RP2077.2013">https://doi.org/10.5594/SMPTE.RP2077.2013</a>
                </dd>
                <dt id="bib-smpte-st-2067-21">[SMPTE-ST-2067-21]</dt>
                <dd>
                    <a href="https://doi.org/10.5594/SMPTE.ST2067-21.2023"><cite>可互操作母带格式 — 应用
                            #2E</cite></a>。SMPTE。2023-02-20。网址：<a
                        href="https://doi.org/10.5594/SMPTE.ST2067-21.2023">https://doi.org/10.5594/SMPTE.ST2067-21.2023</a>
                </dd>
                <dt id="bib-tiff-6.0">[TIFF-6.0]</dt>
                <dd>
                    <a href="https://www.loc.gov/preservation/digital/formats/fdd/fdd000022.shtml"><cite>TIFF 修订版
                            6.0</cite></a>。1992-06-03。网址：<a
                        href="https://www.loc.gov/preservation/digital/formats/fdd/fdd000022.shtml">https://www.loc.gov/preservation/digital/formats/fdd/fdd000022.shtml</a>
                </dd>
            </dl>
        </section>
    </section>
    <p role="navigation" id="back-to-top">
        <a href="#title"><abbr title="返回顶部">↑</abbr></a>
    </p>
    <script id="respec-highlight-vars">(() => {
            // @ts-check

            if (document.respec) {
                document.respec.ready.then(setupVarHighlighter);
            } else {
                setupVarHighlighter();
            }

            function setupVarHighlighter() {
                document
                    .querySelectorAll("var")
                    .forEach(varElem => varElem.addEventListener("click", highlightListener));
            }

            function highlightListener(ev) {
                ev.stopPropagation();
                const { target: varElem } = ev;
                const hightligtedElems = highlightVars(varElem);
                const resetListener = () => {
                    const hlColor = getHighlightColor(varElem);
                    hightligtedElems.forEach(el => removeHighlight(el, hlColor));
                    [...HL_COLORS.keys()].forEach(key => HL_COLORS.set(key, true));
                };
                if (hightligtedElems.length) {
                    document.body.addEventListener("click", resetListener, { once: true });
                }
            }

            // availability of highlight colors. colors from var.css
            const HL_COLORS = new Map([
                ["respec-hl-c1", true],
                ["respec-hl-c2", true],
                ["respec-hl-c3", true],
                ["respec-hl-c4", true],
                ["respec-hl-c5", true],
                ["respec-hl-c6", true],
                ["respec-hl-c7", true],
            ]);

            function getHighlightColor(target) {
                // return current colors if applicable
                const { value } = target.classList;
                const re = /respec-hl-\w+/;
                const activeClass = re.test(value) && value.match(re);
                if (activeClass) return activeClass[0];

                // first color preference
                if (HL_COLORS.get("respec-hl-c1") === true) return "respec-hl-c1";

                // otherwise get some other available color
                return [...HL_COLORS.keys()].find(c => HL_COLORS.get(c)) || "respec-hl-c1";
            }

            function highlightVars(varElem) {
                const textContent = norm(varElem.textContent);
                const parent = varElem.closest(".algorithm, section");
                const highlightColor = getHighlightColor(varElem);

                const varsToHighlight = [...parent.querySelectorAll("var")].filter(
                    el =>
                        norm(el.textContent) === textContent &&
                        el.closest(".algorithm, section") === parent
                );

                // update availability of highlight color
                const colorStatus = varsToHighlight[0].classList.contains("respec-hl");
                HL_COLORS.set(highlightColor, colorStatus);

                // highlight vars
                if (colorStatus) {
                    varsToHighlight.forEach(el => removeHighlight(el, highlightColor));
                    return [];
                } else {
                    varsToHighlight.forEach(el => addHighlight(el, highlightColor));
                }
                return varsToHighlight;
            }

            function removeHighlight(el, highlightColor) {
                el.classList.remove("respec-hl", highlightColor);
                // clean up empty class attributes so they don't come in export
                if (!el.classList.length) el.removeAttribute("class");
            }

            function addHighlight(elem, highlightColor) {
                elem.classList.add("respec-hl", highlightColor);
            }

            /**
             * Same as `norm` from src/core/utils, but our build process doesn't allow
             * imports in runtime scripts, so duplicated here.
             * @param {string} str
             */
            function norm(str) {
                return str.trim().replace(/\s+/g, " ");
            }
        })()</script>
    <script id="respec-dfn-panel">(() => {
                                               // @ts-check
                                               if (document.respec) {
                                                   document.respec.ready.then(setupPanel);
                                               } else {
                                                   setupPanel();
                                               }

                                               function setupPanel() {
                                                   const listener = panelListener();
                                                   document.body.addEventListener("keydown", listener);
                                                   document.body.addEventListener("click", listener);
                                               }

                                               function panelListener() {
                                                   /** @type {HTMLElement} */
                                                   let panel = null;
                                                   return event => {
                                                       const { target, type } = event;

                                                       if (!(target instanceof HTMLElement)) return;

                                                       // For keys, we only care about Enter key to activate the panel
                                                       // otherwise it's activated via a click.
                                                       if (type === "keydown" && event.key !== "Enter") return;

                                                       const action = deriveAction(event);

                                                       switch (action) {
                                                           case "show": {
                                                               hidePanel(panel);
                                                               /** @type {HTMLElement} */
                                                               const dfn = target.closest("dfn, .index-term");
                                                               panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
                                                               const coords = deriveCoordinates(event);
                                                               displayPanel(dfn, panel, coords);
                                                               break;
                                                           }
                                                           case "dock": {
                                                               panel.style.left = null;
                                                               panel.style.top = null;
                                                               panel.classList.add("docked");
                                                               break;
                                                           }
                                                           case "hide": {
                                                               hidePanel(panel);
                                                               panel = null;
                                                               break;
                                                           }
                                                       }
                                                   };
                                               }

                                               /**
                                                * @param {MouseEvent|KeyboardEvent} event
                                                */
                                               function deriveCoordinates(event) {
                                                   const target = /** @type HTMLElement */ (event.target);

                                                   // We prevent synthetic AT clicks from putting
                                                   // the dialog in a weird place. The AT events sometimes
                                                   // lack coordinates, so they have clientX/Y = 0
                                                   const rect = target.getBoundingClientRect();
                                                   if (
                                                       event instanceof MouseEvent &&
                                                       event.clientX >= rect.left &&
                                                       event.clientY >= rect.top
                                                   ) {
                                                       // The event probably happened inside the bounding rect...
                                                       return { x: event.clientX, y: event.clientY };
                                                   }

                                                   // Offset to the middle of the element
                                                   const x = rect.x + rect.width / 2;
                                                   // Placed at the bottom of the element
                                                   const y = rect.y + rect.height;
                                                   return { x, y };
                                               }

                                               /**
                                                * @param {Event} event
                                                */
                                               function deriveAction(event) {
                                                   const target = /** @type {HTMLElement} */ (event.target);
                                                   const hitALink = !!target.closest("a");
                                                   if (target.closest("dfn:not([data-cite]), .index-term")) {
                                                       return hitALink ? "none" : "show";
                                                   }
                                                   if (target.closest(".dfn-panel")) {
                                                       if (hitALink) {
                                                           return target.classList.contains("self-link") ? "hide" : "dock";
                                                       }
                                                       const panel = target.closest(".dfn-panel");
                                                       return panel.classList.contains("docked") ? "hide" : "none";
                                                   }
                                                   if (document.querySelector(".dfn-panel:not([hidden])")) {
                                                       return "hide";
                                                   }
                                                   return "none";
                                               }

                                               /**
                                                * @param {HTMLElement} dfn
                                                * @param {HTMLElement} panel
                                                * @param {{ x: number, y: number }} clickPosition
                                                */
                                               function displayPanel(dfn, panel, { x, y }) {
                                                   panel.hidden = false;
                                                   // distance (px) between edge of panel and the pointing triangle (caret)
                                                   const MARGIN = 20;

                                                   const dfnRects = dfn.getClientRects();
                                                   // Find the `top` offset when the `dfn` can be spread across multiple lines
                                                   let closestTop = 0;
                                                   let minDiff = Infinity;
                                                   for (const rect of dfnRects) {
                                                       const { top, bottom } = rect;
                                                       const diffFromClickY = Math.abs((top + bottom) / 2 - y);
                                                       if (diffFromClickY < minDiff) {
                                                           minDiff = diffFromClickY;
                                                           closestTop = top;
                                                       }
                                                   }

                                                   const top = window.scrollY + closestTop + dfnRects[0].height;
                                                   const left = x - MARGIN;
                                                   panel.style.left = `${left}px`;
                                                   panel.style.top = `${top}px`;

                                                   // Find if the panel is flowing out of the window
                                                   const panelRect = panel.getBoundingClientRect();
                                                   const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
                                                   if (panelRect.right > SCREEN_WIDTH) {
                                                       const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
                                                       const newCaretOffset = left - newLeft;
                                                       panel.style.left = `${newLeft}px`;
                                                       /** @type {HTMLElement} */
                                                       const caret = panel.querySelector(".caret");
                                                       caret.style.left = `${newCaretOffset}px`;
                                                   }

                                                   // As it's a dialog, we trap focus.
                                                   // TODO: when <dialog> becomes a implemented, we should really
                                                   // use that.
                                                   trapFocus(panel, dfn);
                                               }

                                               /**
                                                * @param {HTMLElement} panel
                                                * @param {HTMLElement} dfn
                                                * @returns
                                                */
                                               function trapFocus(panel, dfn) {
                                                   /** @type NodeListOf<HTMLAnchorElement> elements */
                                                   const anchors = panel.querySelectorAll("a[href]");
                                                   // No need to trap focus
                                                   if (!anchors.length) return;

                                                   // Move focus to first anchor element
                                                   const first = anchors.item(0);
                                                   first.focus();

                                                   const trapListener = createTrapListener(anchors, panel, dfn);
                                                   panel.addEventListener("keydown", trapListener);

                                                   // Hiding the panel releases the trap
                                                   const mo = new MutationObserver(records => {
                                                       const [record] = records;
                                                       const target = /** @type HTMLElement */ (record.target);
                                                       if (target.hidden) {
                                                           panel.removeEventListener("keydown", trapListener);
                                                           mo.disconnect();
                                                       }
                                                   });
                                                   mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
                                               }

                                               /**
                                                *
                                                * @param {NodeListOf<HTMLAnchorElement>} anchors
                                                * @param {HTMLElement} panel
                                                * @param {HTMLElement} dfn
                                                * @returns
                                                */
                                               function createTrapListener(anchors, panel, dfn) {
                                                   const lastIndex = anchors.length - 1;
                                                   let currentIndex = 0;
                                                   return event => {
                                                       switch (event.key) {
                                                           // Hitting "Tab" traps us in a nice loop around elements.
                                                           case "Tab": {
                                                               event.preventDefault();
                                                               currentIndex += event.shiftKey ? -1 : +1;
                                                               if (currentIndex < 0) {
                                                                   currentIndex = lastIndex;
                                                               } else if (currentIndex > lastIndex) {
                                                                   currentIndex = 0;
                                                               }
                                                               anchors.item(currentIndex).focus();
                                                               break;
                                                           }

                                                           // Hitting "Enter" on an anchor releases the trap.
                                                           case "Enter":
                                                               hidePanel(panel);
                                                               break;

                                                           // Hitting "Escape" returns focus to dfn.
                                                           case "Escape":
                                                               hidePanel(panel);
                                                               dfn.focus();
                                                               return;
                                                       }
                                                   };
                                               }

                                               /** @param {HTMLElement} panel */
                                               function hidePanel(panel) {
                                                   if (!panel) return;
                                                   panel.hidden = true;
                                                   panel.classList.remove("docked");
                                               }
                                           })()</script>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <script src="/dropdown.js"></script>
</body>

</html>