<!doctype html>
<html lang="zh-hans">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <title>测量内存 API</title>
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <link href="https://www.w3.org/StyleSheets/TR/2016/cg-draft" rel="stylesheet">
    <!-- <meta content="Bikeshed version 5c7bc9381, updated Wed May 12 18:18:08 2021 -0700" name="generator"> -->
    <link href="https://wicg.github.io/performance-measure-memory/" rel="canonical">
    <!-- <meta content="1bc2904d4dba8c8c41019566ed4c9f2ec4855023" name="document-revision"> -->
    <style>
        /* domintro from https://resources.whatwg.org/standard.css */
        .domintro {
            position: relative;
            color: green;
            background: #DDFFDD;
            margin: 2.5em 0 2em 0;
            padding: 1.5em 1em 0.5em 2em;
        }

        .domintro dt,
        .domintro dt * {
            color: black;
            font-size: inherit;
        }

        .domintro dd {
            margin: 0.5em 0 1em 2em;
            padding: 0;
        }

        .domintro dd p {
            margin: 0.5em 0;
        }

        .domintro::before {
            content: 'For web developers (non-normative)';
            background: green;
            color: white;
            padding: 0.15em 0.25em;
            font-style: normal;
            position: absolute;
            top: -0.8em;
            left: -0.8em;
        }
    </style>
    <style>
        /* style-autolinks */

        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: var(--a-normal-text);
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }
    </style>
    <style>
        /* style-colors */

        /* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
        :root {
            color-scheme: light dark;

            --text: black;
            --bg: white;

            --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

            --logo-bg: #1a5e9a;
            --logo-active-bg: #c00;
            --logo-text: white;

            --tocnav-normal-text: #707070;
            --tocnav-normal-bg: var(--bg);
            --tocnav-hover-text: var(--tocnav-normal-text);
            --tocnav-hover-bg: #f8f8f8;
            --tocnav-active-text: #c00;
            --tocnav-active-bg: var(--tocnav-normal-bg);

            --tocsidebar-text: var(--text);
            --tocsidebar-bg: #f7f8f9;
            --tocsidebar-shadow: rgba(0, 0, 0, .1);
            --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

            --toclink-text: var(--text);
            --toclink-underline: #3980b5;
            --toclink-visited-text: var(--toclink-text);
            --toclink-visited-underline: #054572;

            --heading-text: #005a9c;

            --hr-text: var(--text);

            --algo-border: #def;

            --del-text: red;
            --del-bg: transparent;
            --ins-text: #080;
            --ins-bg: transparent;

            --a-normal-text: #034575;
            --a-normal-underline: #bbb;
            --a-visited-text: var(--a-normal-text);
            --a-visited-underline: #707070;
            --a-hover-bg: rgba(75%, 75%, 75%, .25);
            --a-active-text: #c00;
            --a-active-underline: #c00;

            --blockquote-border: silver;
            --blockquote-bg: transparent;
            --blockquote-text: currentcolor;

            --issue-border: #e05252;
            --issue-bg: #fbe9e9;
            --issue-text: var(--text);
            --issueheading-text: #831616;

            --example-border: #e0cb52;
            --example-bg: #fcfaee;
            --example-text: var(--text);
            --exampleheading-text: #574b0f;

            --note-border: #52e052;
            --note-bg: #e9fbe9;
            --note-text: var(--text);
            --noteheading-text: hsl(120, 70%, 30%);
            --notesummary-underline: silver;

            --assertion-border: #aaa;
            --assertion-bg: #eee;
            --assertion-text: black;

            --advisement-border: orange;
            --advisement-bg: #fec;
            --advisement-text: var(--text);
            --advisementheading-text: #b35f00;

            --warning-border: red;
            --warning-bg: hsla(40, 100%, 50%, 0.95);
            --warning-text: var(--text);

            --amendment-border: #330099;
            --amendment-bg: #F5F0FF;
            --amendment-text: var(--text);
            --amendmentheading-text: #220066;

            --def-border: #8ccbf2;
            --def-bg: #def;
            --def-text: var(--text);
            --defrow-border: #bbd7e9;

            --datacell-border: silver;

            --indexinfo-text: #707070;

            --indextable-hover-text: black;
            --indextable-hover-bg: #f7f8f9;

            --outdatedspec-bg: rgba(0, 0, 0, .5);
            --outdatedspec-text: black;
            --outdated-bg: maroon;
            --outdated-text: white;
            --outdated-shadow: red;

            --editedrec-bg: darkorange;
        }
    </style>
    <style>
        /* style-counters */

        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* style-dfn-panel */

        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            width: fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0;
        }

        .dfn-panel li {
            list-style: inside;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled {
            cursor: pointer;
        }
    </style>
    <style>
        /* style-md-lists */

        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* style-selflinks */

        :root {
            --selflink-text: white;
            --selflink-bg: gray;
            --selflink-hover-text: black;
        }

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: var(--selflink-bg);
            color: var(--selflink-text);
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: var(--selflink-hover-text);
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <style>
        /* style-syntax-highlighting */

        pre.idl.highlight {
            background: var(--borderedblock-bg, var(--def-bg));
        }

        code.highlight {
            padding: .1em;
            border-radius: .3em;
        }

        pre.highlight,
        pre>code.highlight {
            display: block;
            padding: 1em;
            margin: .5em 0;
            overflow: auto;
            border-radius: 0;
        }

        .highlight:not(.idl) {
            background: rgba(0, 0, 0, .03);
        }

        c-[a] {
            color: #990055
        }

        /* Keyword.Declaration */
        c-[b] {
            color: #990055
        }

        /* Keyword.Type */
        c-[c] {
            color: #708090
        }

        /* Comment */
        c-[d] {
            color: #708090
        }

        /* Comment.Multiline */
        c-[e] {
            color: #0077aa
        }

        /* Name.Attribute */
        c-[f] {
            color: #669900
        }

        /* Name.Tag */
        c-[g] {
            color: #222222
        }

        /* Name.Variable */
        c-[k] {
            color: #990055
        }

        /* Keyword */
        c-[l] {
            color: #000000
        }

        /* Literal */
        c-[m] {
            color: #000000
        }

        /* Literal.Number */
        c-[n] {
            color: #0077aa
        }

        /* Name */
        c-[o] {
            color: #999999
        }

        /* Operator */
        c-[p] {
            color: #999999
        }

        /* Punctuation */
        c-[s] {
            color: #a67f59
        }

        /* Literal.String */
        c-[t] {
            color: #a67f59
        }

        /* Literal.String.Single */
        c-[u] {
            color: #a67f59
        }

        /* Literal.String.Double */
        c-[cp] {
            color: #708090
        }

        /* Comment.Preproc */
        c-[c1] {
            color: #708090
        }

        /* Comment.Single */
        c-[cs] {
            color: #708090
        }

        /* Comment.Special */
        c-[kc] {
            color: #990055
        }

        /* Keyword.Constant */
        c-[kn] {
            color: #990055
        }

        /* Keyword.Namespace */
        c-[kp] {
            color: #990055
        }

        /* Keyword.Pseudo */
        c-[kr] {
            color: #990055
        }

        /* Keyword.Reserved */
        c-[ld] {
            color: #000000
        }

        /* Literal.Date */
        c-[nc] {
            color: #0077aa
        }

        /* Name.Class */
        c-[no] {
            color: #0077aa
        }

        /* Name.Constant */
        c-[nd] {
            color: #0077aa
        }

        /* Name.Decorator */
        c-[ni] {
            color: #0077aa
        }

        /* Name.Entity */
        c-[ne] {
            color: #0077aa
        }

        /* Name.Exception */
        c-[nf] {
            color: #0077aa
        }

        /* Name.Function */
        c-[nl] {
            color: #0077aa
        }

        /* Name.Label */
        c-[nn] {
            color: #0077aa
        }

        /* Name.Namespace */
        c-[py] {
            color: #0077aa
        }

        /* Name.Property */
        c-[ow] {
            color: #999999
        }

        /* Operator.Word */
        c-[mb] {
            color: #000000
        }

        /* Literal.Number.Bin */
        c-[mf] {
            color: #000000
        }

        /* Literal.Number.Float */
        c-[mh] {
            color: #000000
        }

        /* Literal.Number.Hex */
        c-[mi] {
            color: #000000
        }

        /* Literal.Number.Integer */
        c-[mo] {
            color: #000000
        }

        /* Literal.Number.Oct */
        c-[sb] {
            color: #a67f59
        }

        /* Literal.String.Backtick */
        c-[sc] {
            color: #a67f59
        }

        /* Literal.String.Char */
        c-[sd] {
            color: #a67f59
        }

        /* Literal.String.Doc */
        c-[se] {
            color: #a67f59
        }

        /* Literal.String.Escape */
        c-[sh] {
            color: #a67f59
        }

        /* Literal.String.Heredoc */
        c-[si] {
            color: #a67f59
        }

        /* Literal.String.Interpol */
        c-[sx] {
            color: #a67f59
        }

        /* Literal.String.Other */
        c-[sr] {
            color: #a67f59
        }

        /* Literal.String.Regex */
        c-[ss] {
            color: #a67f59
        }

        /* Literal.String.Symbol */
        c-[vc] {
            color: #0077aa
        }

        /* Name.Variable.Class */
        c-[vg] {
            color: #0077aa
        }

        /* Name.Variable.Global */
        c-[vi] {
            color: #0077aa
        }

        /* Name.Variable.Instance */
        c-[il] {
            color: #000000
        }

        /* Literal.Number.Integer.Long */
    </style>
    <style>
        /* style-var-click-highlighting */

        var {
            cursor: pointer;
        }

        var.selected0 {
            background-color: #F4D200;
            box-shadow: 0 0 0 2px #F4D200;
        }

        var.selected1 {
            background-color: #FF87A2;
            box-shadow: 0 0 0 2px #FF87A2;
        }

        var.selected2 {
            background-color: #96E885;
            box-shadow: 0 0 0 2px #96E885;
        }

        var.selected3 {
            background-color: #3EEED2;
            box-shadow: 0 0 0 2px #3EEED2;
        }

        var.selected4 {
            background-color: #EACFB6;
            box-shadow: 0 0 0 2px #EACFB6;
        }

        var.selected5 {
            background-color: #82DDFF;
            box-shadow: 0 0 0 2px #82DDFF;
        }

        var.selected6 {
            background-color: #FFBCF2;
            box-shadow: 0 0 0 2px #FFBCF2;
        }
    </style>
    <style>
        /* style-darkmode */

        @media (prefers-color-scheme: dark) {
            :root {
                --text: #ddd;
                --bg: black;

                --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

                --logo-bg: #1a5e9a;
                --logo-active-bg: #c00;
                --logo-text: white;

                --tocnav-normal-text: #999;
                --tocnav-normal-bg: var(--bg);
                --tocnav-hover-text: var(--tocnav-normal-text);
                --tocnav-hover-bg: #080808;
                --tocnav-active-text: #f44;
                --tocnav-active-bg: var(--tocnav-normal-bg);

                --tocsidebar-text: var(--text);
                --tocsidebar-bg: #080808;
                --tocsidebar-shadow: rgba(255, 255, 255, .1);
                --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

                --toclink-text: var(--text);
                --toclink-underline: #6af;
                --toclink-visited-text: var(--toclink-text);
                --toclink-visited-underline: #054572;

                --heading-text: #8af;

                --hr-text: var(--text);

                --algo-border: #456;

                --del-text: #f44;
                --del-bg: transparent;
                --ins-text: #4a4;
                --ins-bg: transparent;

                --a-normal-text: #6af;
                --a-normal-underline: #555;
                --a-visited-text: var(--a-normal-text);
                --a-visited-underline: var(--a-normal-underline);
                --a-hover-bg: rgba(25%, 25%, 25%, .2);
                --a-active-text: #f44;
                --a-active-underline: var(--a-active-text);

                --borderedblock-bg: rgba(255, 255, 255, .05);

                --blockquote-border: silver;
                --blockquote-bg: var(--borderedblock-bg);
                --blockquote-text: currentcolor;

                --issue-border: #e05252;
                --issue-bg: var(--borderedblock-bg);
                --issue-text: var(--text);
                --issueheading-text: hsl(0deg, 70%, 70%);

                --example-border: hsl(50deg, 90%, 60%);
                --example-bg: var(--borderedblock-bg);
                --example-text: var(--text);
                --exampleheading-text: hsl(50deg, 70%, 70%);

                --note-border: hsl(120deg, 100%, 35%);
                --note-bg: var(--borderedblock-bg);
                --note-text: var(--text);
                --noteheading-text: hsl(120, 70%, 70%);
                --notesummary-underline: silver;

                --assertion-border: #444;
                --assertion-bg: var(--borderedblock-bg);
                --assertion-text: var(--text);

                --advisement-border: orange;
                --advisement-bg: #222218;
                --advisement-text: var(--text);
                --advisementheading-text: #f84;

                --warning-border: red;
                --warning-bg: hsla(40, 100%, 20%, 0.95);
                --warning-text: var(--text);

                --amendment-border: #330099;
                --amendment-bg: #080010;
                --amendment-text: var(--text);
                --amendmentheading-text: #cc00ff;

                --def-border: #8ccbf2;
                --def-bg: #080818;
                --def-text: var(--text);
                --defrow-border: #136;

                --datacell-border: silver;

                --indexinfo-text: #aaa;

                --indextable-hover-text: var(--text);
                --indextable-hover-bg: #181818;

                --outdatedspec-bg: rgba(255, 255, 255, .5);
                --outdatedspec-text: black;
                --outdated-bg: maroon;
                --outdated-text: white;
                --outdated-shadow: red;

                --editedrec-bg: darkorange;
            }

            /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
            img {
                background: white;
            }
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --selflink-text: black;
                --selflink-bg: silver;
                --selflink-hover-text: white;
            }
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --dfnpanel-bg: #222;
                --dfnpanel-text: var(--text);
            }
        }

        @media (prefers-color-scheme: dark) {
            .highlight:not(.idl) {
                background: rgba(255, 255, 255, .05);
            }

            c-[a] {
                color: #d33682
            }

            /* Keyword.Declaration */
            c-[b] {
                color: #d33682
            }

            /* Keyword.Type */
            c-[c] {
                color: #2aa198
            }

            /* Comment */
            c-[d] {
                color: #2aa198
            }

            /* Comment.Multiline */
            c-[e] {
                color: #268bd2
            }

            /* Name.Attribute */
            c-[f] {
                color: #b58900
            }

            /* Name.Tag */
            c-[g] {
                color: #cb4b16
            }

            /* Name.Variable */
            c-[k] {
                color: #d33682
            }

            /* Keyword */
            c-[l] {
                color: #657b83
            }

            /* Literal */
            c-[m] {
                color: #657b83
            }

            /* Literal.Number */
            c-[n] {
                color: #268bd2
            }

            /* Name */
            c-[o] {
                color: #657b83
            }

            /* Operator */
            c-[p] {
                color: #657b83
            }

            /* Punctuation */
            c-[s] {
                color: #6c71c4
            }

            /* Literal.String */
            c-[t] {
                color: #6c71c4
            }

            /* Literal.String.Single */
            c-[u] {
                color: #6c71c4
            }

            /* Literal.String.Double */
            c-[ch] {
                color: #2aa198
            }

            /* Comment.Hashbang */
            c-[cp] {
                color: #2aa198
            }

            /* Comment.Preproc */
            c-[cpf] {
                color: #2aa198
            }

            /* Comment.PreprocFile */
            c-[c1] {
                color: #2aa198
            }

            /* Comment.Single */
            c-[cs] {
                color: #2aa198
            }

            /* Comment.Special */
            c-[kc] {
                color: #d33682
            }

            /* Keyword.Constant */
            c-[kn] {
                color: #d33682
            }

            /* Keyword.Namespace */
            c-[kp] {
                color: #d33682
            }

            /* Keyword.Pseudo */
            c-[kr] {
                color: #d33682
            }

            /* Keyword.Reserved */
            c-[ld] {
                color: #657b83
            }

            /* Literal.Date */
            c-[nc] {
                color: #268bd2
            }

            /* Name.Class */
            c-[no] {
                color: #268bd2
            }

            /* Name.Constant */
            c-[nd] {
                color: #268bd2
            }

            /* Name.Decorator */
            c-[ni] {
                color: #268bd2
            }

            /* Name.Entity */
            c-[ne] {
                color: #268bd2
            }

            /* Name.Exception */
            c-[nf] {
                color: #268bd2
            }

            /* Name.Function */
            c-[nl] {
                color: #268bd2
            }

            /* Name.Label */
            c-[nn] {
                color: #268bd2
            }

            /* Name.Namespace */
            c-[py] {
                color: #268bd2
            }

            /* Name.Property */
            c-[ow] {
                color: #657b83
            }

            /* Operator.Word */
            c-[mb] {
                color: #657b83
            }

            /* Literal.Number.Bin */
            c-[mf] {
                color: #657b83
            }

            /* Literal.Number.Float */
            c-[mh] {
                color: #657b83
            }

            /* Literal.Number.Hex */
            c-[mi] {
                color: #657b83
            }

            /* Literal.Number.Integer */
            c-[mo] {
                color: #657b83
            }

            /* Literal.Number.Oct */
            c-[sa] {
                color: #6c71c4
            }

            /* Literal.String.Affix */
            c-[sb] {
                color: #6c71c4
            }

            /* Literal.String.Backtick */
            c-[sc] {
                color: #6c71c4
            }

            /* Literal.String.Char */
            c-[dl] {
                color: #6c71c4
            }

            /* Literal.String.Delimiter */
            c-[sd] {
                color: #6c71c4
            }

            /* Literal.String.Doc */
            c-[se] {
                color: #6c71c4
            }

            /* Literal.String.Escape */
            c-[sh] {
                color: #6c71c4
            }

            /* Literal.String.Heredoc */
            c-[si] {
                color: #6c71c4
            }

            /* Literal.String.Interpol */
            c-[sx] {
                color: #6c71c4
            }

            /* Literal.String.Other */
            c-[sr] {
                color: #6c71c4
            }

            /* Literal.String.Regex */
            c-[ss] {
                color: #6c71c4
            }

            /* Literal.String.Symbol */
            c-[fm] {
                color: #268bd2
            }

            /* Name.Function.Magic */
            c-[vc] {
                color: #cb4b16
            }

            /* Name.Variable.Class */
            c-[vg] {
                color: #cb4b16
            }

            /* Name.Variable.Global */
            c-[vi] {
                color: #cb4b16
            }

            /* Name.Variable.Instance */
            c-[vm] {
                color: #cb4b16
            }

            /* Name.Variable.Magic */
            c-[il] {
                color: #657b83
            }

            /* Literal.Number.Integer.Long */
        }
    </style>

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"> </a> </p>
        <h1 class="p-name no-ref" id="title">测量内存 API</h1>
        <h2 class="no-num no-toc no-ref heading settled" id="profile-and-date"><span class="content">社区组报告草案，<time
                    class="dt-updated" datetime="2021-05-28">2021年5月28日</time></span></h2>
        <div data-fill-with="spec-metadata">
            <dl>
                <dt>该版本：
                <dd><a class="u-url"
                        href="https://wicg.github.io/performance-measure-memory/">https://wicg.github.io/performance-measure-memory/</a>
                <dt class="editor">编辑者：
                <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email"
                        href="mailto:ulan@google.com">Ulan Degenbaev</a> (<a class="p-org org"
                        href="https://www.google.com/">Google</a>)
                <dt>参与方式：
                <dd><a href="https://github.com/WICG/performance-measure-memory">GitHub
                        WICG/performance-measure-memory</a> (<a
                        href="https://github.com/WICG/performance-measure-memory/issues/new">新议题</a>, <a
                        href="https://github.com/WICG/performance-measure-memory/issues?state=open">开放议题</a>)
            </dl>
        </div>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a
                href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2021 the Contributors to
            the Measure Memory API Specification, published by the <a href="https://www.w3.org/community/wicg/">Web
                Platform Incubator Community Group</a> under the <a
                href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement
                (CLA)</a>.
            A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available.
        </p>
        <hr title="Separator for header">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">摘要</span></h2>
        <p>本规范定义了一个使 Web 应用能够测量其内存使用情况的 API。</p>
    </div>
    <div data-fill-with="at-risk"></div>
    <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">本文档状态</span>
    </h2>
    <div data-fill-with="status">
        <p> 本规范由 <a href="https://www.w3.org/community/wicg/">Web 平台孵化社区组</a> 发布。
            它不是 W3C 标准，也不属于 W3C 标准轨道。
            请注意，根据 <a href="https://www.w3.org/community/about/agreements/cla/">W3C
                社区贡献者许可协议（CLA）</a>，存在有限的选择退出权，且有其它适用条件。
            了解更多 <a href="http://www.w3.org/community/">W3C 社区和业务组</a> 信息。 </p>
        <p></p>
    </div>
    <div data-fill-with="at-risk"></div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目录</h2>
        <ol class="toc" role="directory">
            <li>
                <a href="#intro"><span class="secno">1</span> <span class="content">简介</span></a>
                <ol class="toc">
                    <li><a href="#examples"><span class="secno">1.1</span> <span class="content">示例</span></a>
                </ol>
            <li>
                <a href="#data-model"><span class="secno">2</span> <span class="content">数据模型</span></a>
                <ol class="toc">
                    <li><a href="#memory-measurement-result"><span class="secno">2.1</span> <span
                                class="content">内存测量结果</span></a>
                    <li><a href="#intermediate-memory-measurement-section"><span class="secno">2.2</span> <span
                                class="content">中间内存测量</span></a>
                    <li><a href="#memory-attribution-token-section"><span class="secno">2.3</span> <span
                                class="content">内存归因令牌</span></a>
                </ol>
            <li>
                <a href="#processing-model"><span class="secno">3</span> <span class="content">处理模型</span></a>
                <ol class="toc">
                    <li><a href="#extensions-to-performance"><span class="secno">3.1</span> <span class="content"><code
                                    class="idl"><span>Performance</span></code> 接口扩展</span></a>
                    <li><a href="#top-level-algorithms"><span class="secno">3.2</span> <span
                                class="content">顶层算法</span></a>
                    <li><a href="#converting-an-intermediate-memory-measurement-to-the-result"><span
                                class="secno">3.3</span> <span class="content">将中间内存测量值转换为结果</span></a>
                    <li><a href="#creating-or-obtaining-a-memory-attribution-token"><span class="secno">3.4</span> <span
                                class="content">创建或获取内存归因令牌</span></a>
                </ol>
            <li>
                <a href="#integration-with-the-existing-specification"><span class="secno">4</span> <span
                        class="content">与现有规范的整合</span></a>
                <ol class="toc">
                    <li><a href="#extension-to-window-or-worker-global-scope"><span class="secno">4.1</span> <span
                                class="content">对 <code class="idl"><span>WindowOrWorkerGlobalScope</span></code>
                                的扩展</span></a>
                    <li><a href="#extensions-to-the-existing-algorithms"><span class="secno">4.2</span> <span
                                class="content">对现有算法的扩展</span></a>
                </ol>
            <li>
                <a href="#privacy-and-security"><span class="secno">5</span> <span class="content">隐私与安全</span></a>
                <ol class="toc">
                    <li><a href="#information-leak"><span class="secno">5.1</span> <span
                                class="content">跨域信息泄露</span></a>
                    <li><a href="#fingerprinting"><span class="secno">5.2</span> <span class="content">指纹识别</span></a>
                </ol>
            <li><a href="#acknowledgements"><span class="secno">6</span> <span class="content">致谢</span></a>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本规范定义的术语</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">引用定义的术语</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考文献</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">规范性引用</span></a>
                </ol>
            <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL 索引</span></a>
        </ol>
    </nav>
    <main>
        <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span
                class="content">简介</span><a class="self-link" href="#intro"></a></h2>
        <div nonnormative>
            许多算法和数据结构中都固有存在内存与性能的权衡。当前，Web 开发者有多种方式度量时间信息，但没有标准方式来测量内存使用。本规范定义了 <code
                class="idl"><a data-link-type="idl" href="#dom-performance-measureuseragentspecificmemory" id="ref-for-dom-performance-measureuseragentspecificmemory">performance.measureUserAgentSpecificMemory()</a></code>
            API，用于估算 web 应用（包括所有 iframe 和 worker）的内存使用情况。这个新 API 旨在用于收集线上内存使用数据，主要用例包括：
            <ul>
                <li data-md>
                    <p>在 Web 应用新版本发布过程中监测回归，捕捉新的内存泄漏。</p>
                <li data-md>
                    <p>A/B 测试新特性，评估其内存影响。</p>
                <li data-md>
                    <p>将内存使用与用户指标相关联，以了解内存使用的整体影响。</p>
            </ul>
        </div>
        <p></p>
        <h3 class="heading settled" data-level="1.1" id="examples"><span class="secno">1.1. </span><span
                class="content">示例</span><a class="self-link" href="#examples"></a></h3>
        <div class="example" id="example-simple-page">
            <a class="self-link" href="#example-simple-page"></a>
            <p>一次 <code
                    class="idl"><a data-link-type="idl" href="#dom-performance-measureuseragentspecificmemory" id="ref-for-dom-performance-measureuseragentspecificmemory①">performance.measureUserAgentSpecificMemory()</a></code>
                调用将返回一个 <code
                    class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise">Promise</a></code>
                ，并启动异步测量当前页面分配的内存。</p>
            <pre class="language-javascript highlight"><c- k>async</c-> <c- a>function</c-> run<c- p>()</c-> <c- p>{</c->
  <c- a>const</c-> result <c- o>=</c-> <c- k>await</c-> performance<c- p>.</c->measureUserAgentSpecificMemory<c- p>();</c->
  console<c- p>.</c->log<c- p>(</c->result<c- p>);</c->
<c- p>}</c->
run<c- p>();</c->
</pre>
            <p>对于没有 iframe 和 worker 的简单页面，结果可能如下所示：</p>
            <pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
            此处所有内存都归属于主页面。breakdown 列表中的 <code>bytes: 0</code> 条目旨在鼓励通用方式处理结果，而不是写死特定条目。只要列表不为空，该条目会被插入到一个随机位置。
            <p>其它可能的有效结果：</p>
            <pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[],</c->
<c- p>}</c->
</pre>
            此时实现只提供总内存使用量。
            <pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
            这种情况下实现没有按类型分拆内存。
        </div>
        <div class="example" id="example-same-origin-iframe">
            <a class="self-link" href="#example-same-origin-iframe"></a>
            <p>对于嵌入了同源 iframe 的页面，结果可能会将部分内存归因到该 iframe，并提供识别该 iframe 的诊断信息：</p>
            <pre class="language-html highlight">  <c- p>&lt;</c-><c- f>html</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>body</c-><c- p>></c->
      <c- p>&lt;</c-><c- f>iframe</c-> <c- e>id</c-><c- o>=</c-><c- s>"example-id"</c-> <c- e>src</c-><c- o>=</c-><c- s>"redirect.html?target=iframe.html"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
    <c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>html</c-><c- p>></c->
</pre>
            <pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1500000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"DOM"</c-><c- p>,</c-> <c- u>"JS"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>500000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/iframe.html"</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"redirect.html?target=iframe.html"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>}</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
            注意 iframe 的 <code>url</code> 和 <code>container.src</code> 字段不同。前者反映当前 iframe 的
            <code>location.href</code>，后者是 iframe 元素的 <code>src</code> 属性值。
            <p>有时无法有意义地将 iframe 内存和页面内存区分开，允许实现将部分或所有 iframe 内存与主页面内存合并：</p>
            <pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1500000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1500000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/iframe.html"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"redirect.html?target=iframe.html"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>};</c->
</pre>
        </div>
        <div class="example" id="example-web-worker">
            <a class="self-link" href="#example-web-worker"></a> 对于创建了 web worker 的页面，结果会包含该 worker 的 URL。
            <pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1800000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>800000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/worker.js"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"DedicatedWorkerGlobalScope"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>};</c->
</pre>
            有些实现可能会将 worker 和页面内存合并统计。如果 worker 是被某个 iframe 创建的，那么该 worker 的归因条目会包含一个与 iframe 元素对应的
            <code>container</code> 字段。
            <p>共享 worker 和 service worker 的内存不包含在结果中。</p>
        </div>
        <div class="example" id="example-shared-worker">
            <a class="self-link" href="#example-shared-worker"></a> 如需获取 shared/service worker 的内存使用，需要在该 worker 的上下文中调用
            <code
                class="idl"><a data-link-type="idl" href="#dom-performance-measureuseragentspecificmemory" id="ref-for-dom-performance-measureuseragentspecificmemory②">performance.measureUserAgentSpecificMemory()</a></code>
            。
            结果可能如下：
            <pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/service-worker.js"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"ServiceWorkerGlobalScope"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
        </div>
        <div class="example" id="example-cross-origin-iframe">
            <a class="self-link" href="#example-cross-origin-iframe"></a> 如果页面嵌入了跨域 iframe，
            那么不会暴露该 iframe 的 URL，以避免信息泄露。结果中仅包含已知的容器元素。
            并且，如果跨域 iframe 内还嵌套了其它跨域 iframe 或创建了 worker，
            这些内容的内存都会归属于最顶层的跨域 iframe。
            <p>假设有如下结构的页面：</p>
            <pre class="language-javascript highlight">example<c- p>.</c->com <c- p>(</c-><c- mf>1000000</c-> bytes<c- p>)</c->
  <c- o>|</c->
  <c- o>*--</c->foo<c- p>.</c->com<c- o>/</c->iframe1 <c- p>(</c-><c- mf>500000</c-> bytes<c- p>)</c->
       <c- o>|</c->
       <c- o>*--</c->foo<c- p>.</c->com<c- o>/</c->iframe2 <c- p>(</c-><c- mf>200000</c-> bytes<c- p>)</c->
       <c- o>|</c->
       <c- o>*--</c->bar<c- p>.</c->com<c- o>/</c->iframe2 <c- p>(</c-><c- mf>300000</c-> bytes<c- p>)</c->
       <c- o>|</c->
       <c- o>*--</c->foo<c- p>.</c->com<c- o>/</c->worker<c- p>.</c->js <c- p>(</c-><c- mf>400000</c-> bytes<c- p>)</c->
</pre>
            一个跨域 iframe 嵌套了其他 iframe 并创建了 worker。
            所有这些资源的内存都归属于第一个 iframe。
            <pre class="language-html highlight">  <c- p>&lt;</c-><c- f>html</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>body</c-><c- p>></c->
      <c- p>&lt;</c-><c- f>iframe</c-> <c- e>id</c-><c- o>=</c-><c- s>"example-id"</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://foo.com/iframe1"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
    <c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>html</c-><c- p>></c->
</pre>
            <pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>2400000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1400000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"cross-origin-url"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"https://foo.com/iframe1"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"cross-origin-aggregated"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"DOM"</c-><c- p>,</c-> <c- u>"JS"</c-><c- p>],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
            注意跨域 iframe 项的 <code>url</code> 和 <code>scope</code> 字段有特殊取值，表示信息不可用。
            <p>如果实现将跨域 iframe 加载在其它地址空间，则无法测量其内存。这类 iframe 的 breakdown 条目会有 <code>bytes: 0</code>，表示未统计：</p>
            <pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>100000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"cross-origin-url"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"https://foo.com/iframe1"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"cross-origin-aggregated"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
        </div>
        <div class="example" id="example-same-and-cross-origin-iframes">
            <a class="self-link" href="#example-same-and-cross-origin-iframes"></a> 如果一个跨域 iframe 嵌套了与主页面同源的 iframe，则该同源
            iframe 会在结果中呈现。
            注意不存在信息泄露风险，因为主页面可以找到并读取同源 iframe 的 <code>location.href</code>。
            <pre class="language-javascript highlight">example<c- p>.</c->com <c- p>(</c-><c- mf>1000000</c-> bytes<c- p>)</c->
  <c- o>|</c->
  <c- o>*--</c->foo<c- p>.</c->com<c- o>/</c->iframe1 <c- p>(</c-><c- mf>500000</c-> bytes<c- p>)</c->
       <c- o>|</c->
       <c- o>*--</c->example<c- p>.</c->com<c- o>/</c->iframe2 <c- p>(</c-><c- mf>200000</c-> bytes<c- p>)</c->
</pre>
            <pre class="language-html highlight">  <c- p>&lt;</c-><c- f>html</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>body</c-><c- p>></c->
      <c- p>&lt;</c-><c- f>iframe</c-> <c- e>id</c-><c- o>=</c-><c- s>"example-id"</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://foo.com/iframe1"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
    <c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>html</c-><c- p>></c->
</pre>
            <pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1700000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"DOM"</c-><c- p>,</c-> <c- u>"JS"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>500000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"cross-origin-url"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"https://foo.com/iframe1"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"cross-origin-aggregated"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"DOM"</c-><c- p>,</c-> <c- u>"JS"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>200000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/iframe2"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"https://foo.com/iframe1"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
            <p>如果实现不统计跨域 iframe 的内存，则结果可能如下：</p>
            <pre class="language-javascript highlight"><c- p>{</c->
  bytes<c- o>:</c-> <c- mf>1200000</c-><c- p>,</c->
  breakdown<c- o>:</c-> <c- p>[</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com"</c-><c- p>,</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"cross-origin-url"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"https://foo.com/iframe1"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"cross-origin-aggregated"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>200000</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[</c->
        <c- p>{</c->
          url<c- o>:</c-> <c- u>"https://example.com/iframe2"</c-><c- p>,</c->
          container<c- o>:</c-> <c- p>{</c->
            id<c- o>:</c-> <c- u>"example-id"</c-><c- p>,</c->
            src<c- o>:</c-> <c- u>"https://foo.com/iframe1"</c-><c- p>,</c->
          <c- p>},</c->
          scope<c- o>:</c-> <c- u>"Window"</c-><c- p>,</c->
        <c- p>},</c->
      <c- p>],</c->
      types<c- o>:</c-> <c- p>[</c-><c- u>"JS"</c-><c- p>,</c-> <c- u>"DOM"</c-><c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      bytes<c- o>:</c-> <c- mf>0</c-><c- p>,</c->
      attribution<c- o>:</c-> <c- p>[],</c->
      types<c- o>:</c-> <c- p>[],</c->
    <c- p>},</c->
  <c- p>],</c->
<c- p>}</c->
</pre>
        </div>
        <h2 class="heading settled" data-level="2" id="data-model"><span class="secno">2. </span><span
                class="content">数据模型</span><a class="self-link" href="#data-model"></a></h2>
        <h3 class="heading settled" data-level="2.1" id="memory-measurement-result"><span class="secno">2.1.
            </span><span class="content">内存测量结果</span><a class="self-link" href="#memory-measurement-result"></a></h3>
        <p><code
                class="idl"><a data-link-type="idl" href="#dom-performance-measureuseragentspecificmemory" id="ref-for-dom-performance-measureuseragentspecificmemory③">performance.measureUserAgentSpecificMemory()</a></code>
            函数返回一个 <code
                class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise①">Promise</a></code>
            ，该 Promise 解析后为 <code
                class="idl"><a data-link-type="idl" href="#dictdef-memorymeasurement" id="ref-for-dictdef-memorymeasurement">MemoryMeasurement</a></code>
            字典的实例：</p>
        <pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-memorymeasurement"><code><c- g>MemoryMeasurement</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryMeasurement" data-dfn-type="dict-member" data-export data-type="unsigned long long " id="dom-memorymeasurement-bytes"><code><c- g>bytes</c-></code></dfn>;
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence" id="ref-for-idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-memorybreakdownentry" id="ref-for-dictdef-memorybreakdownentry"><c- n>MemoryBreakdownEntry</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryMeasurement" data-dfn-type="dict-member" data-export data-type="sequence<MemoryBreakdownEntry> " id="dom-memorymeasurement-breakdown"><code><c- g>breakdown</c-></code></dfn>;
};
</pre>
        <dl class="domintro">
            <dl>
                <dt data-md>
                    <code>measurement . <code class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-bytes" id="ref-for-dom-memorymeasurement-bytes">bytes</a></code></code>
                <dd data-md>
                    <p>表示总内存使用量的数字。</p>
                <dt data-md>
                    <code>measurement . <code class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-breakdown" id="ref-for-dom-memorymeasurement-breakdown">breakdown</a></code></code>
                <dd data-md>
                    <p>一个数组，用于分割总的 <code
                            class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-bytes" id="ref-for-dom-memorymeasurement-bytes①">bytes</a></code>
                        ，并提供归因和类型信息。</p>
            </dl>
            <p></p>
        </dl>
        <pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-memorybreakdownentry"><code><c- g>MemoryBreakdownEntry</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long①"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryBreakdownEntry" data-dfn-type="dict-member" data-export data-type="unsigned long long " id="dom-memorybreakdownentry-bytes"><code><c- g>bytes</c-></code></dfn>;
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence" id="ref-for-idl-sequence①"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-memoryattribution" id="ref-for-dictdef-memoryattribution"><c- n>MemoryAttribution</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryBreakdownEntry" data-dfn-type="dict-member" data-export data-type="sequence<MemoryAttribution> " id="dom-memorybreakdownentry-attribution"><code><c- g>attribution</c-></code></dfn>;
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence" id="ref-for-idl-sequence②"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryBreakdownEntry" data-dfn-type="dict-member" data-export data-type="sequence<DOMString> " id="dom-memorybreakdownentry-types"><code><c- g>types</c-></code></dfn>;
};
</pre>
        <dl class="domintro">
            <dl>
                <dt data-md>
                    <code>breakdown . <code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-bytes" id="ref-for-dom-memorybreakdownentry-bytes">bytes</a></code></code>
                <dd data-md>
                    <p>该条目所描述内存的大小。</p>
                <dt data-md>
                    <code>breakdown . <code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-attribution" id="ref-for-dom-memorybreakdownentry-attribution">attribution</a></code></code>
                <dd data-md>
                    <p>一个由使用这些内存的<a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms"
                            id="ref-for-sec-code-realms">JavaScript
                            域</a>的 URL 和/或容器元素组成的数组。</p>
                <dt data-md>
                    <code>breakdown . <code class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-types" id="ref-for-dom-memorybreakdownentry-types">types</a></code></code>
                <dd data-md>
                    <p>一个与该内存相关的<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined"
                            id="ref-for-implementation-defined">实现自定义</a>内存类型的数组。</p>
            </dl>
            <p></p>
        </dl>
        <pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-memoryattribution"><code><c- g>MemoryAttribution</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryAttribution" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-memoryattribution-url"><code><c- g>url</c-></code></dfn>;
  <a data-link-type="idl-name" href="#dictdef-memoryattributioncontainer" id="ref-for-dictdef-memoryattributioncontainer"><c- n>MemoryAttributionContainer</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryAttribution" data-dfn-type="dict-member" data-export data-type="MemoryAttributionContainer " id="dom-memoryattribution-container"><code><c- g>container</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryAttribution" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-memoryattribution-scope"><code><c- g>scope</c-></code></dfn>;
};
</pre>
        <dl class="domintro">
            <dl>
                <dt data-md>
                    <code>attribution . <code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-url" id="ref-for-dom-memoryattribution-url">url</a></code></code>
                <dd data-md>
                    <p>如果此归因对应同源的<a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms"
                            id="ref-for-sec-code-realms①">JavaScript
                            域</a>，则此字段为该域的 URL。
                        否则，归因为一个或多个跨域的<a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms"
                            id="ref-for-sec-code-realms②">JavaScript
                            域</a>，此字段为特殊值：<code>"cross-origin-url"</code>。</p>
                <dt data-md>
                    <code>attribution . <code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-container" id="ref-for-dom-memoryattribution-container">container</a></code></code>
                <dd data-md>
                    <p>描述（可能是间接）包含该<a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms"
                            id="ref-for-sec-code-realms③">JavaScript
                            域</a>的 DOM 元素。
                        如果归因的是同源顶层域，该属性可能不存在。注意，跨域域由于<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability"
                            id="ref-for-concept-settings-object-cross-origin-isolated-capability">跨源隔离</a>，不能是顶层。</p>
                <dt data-md>
                    <code>attribution . <code class="idl"><a data-link-type="idl" href="#dom-memoryattribution-scope" id="ref-for-dom-memoryattribution-scope">scope</a></code></code>
                <dd data-md>
                    <p>描述同源<a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms"
                            id="ref-for-sec-code-realms④">JavaScript
                            域</a>的类型：
                        <code>"Window", "DedicatedWorkerGlobalScope", "SharedWorkerGlobalScope", "ServiceWorkerGlobalScope"</code>
                        ，或在跨域场景下为 <code>"cross-origin-aggregated"</code>。
                    </p>
            </dl>
            <p></p>
        </dl>
        <pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-memoryattributioncontainer"><code><c- g>MemoryAttributionContainer</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryAttributionContainer" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-memoryattributioncontainer-id"><code><c- g>id</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString①"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MemoryAttributionContainer" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-memoryattributioncontainer-src"><code><c- g>src</c-></code></dfn>;
};
</pre>
        <dl class="domintro">
            <dl>
                <dt data-md>
                    <code>container . <code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-id" id="ref-for-dom-memoryattributioncontainer-id">id</a></code></code>
                <dd data-md>
                    <p>容器元素的 <code>id</code> 属性。</p>
                <dt data-md>
                    <code>container . <code class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-src" id="ref-for-dom-memoryattributioncontainer-src">src</a></code></code>
                <dd data-md>
                    <p>容器元素的 <code>src</code> 属性。如果容器元素是
                        <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element" id="ref-for-the-object-element">object</a></code>
                        元素，
                        则此字段保存
                        <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data" id="ref-for-attr-object-data">data</a></code>
                        属性的值。
                    </p>
            </dl>
            <p></p>
        </dl>
        <h3 class="heading settled" data-level="2.2" id="intermediate-memory-measurement-section"><span
                class="secno">2.2. </span><span class="content">中间内存测量</span><a class="self-link"
                href="#intermediate-memory-measurement-section"></a></h3>
        <p>本规范假设存在一个<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined"
                id="ref-for-implementation-defined①">实现自定义</a>算法，用于测量给定<a data-link-type="dfn"
                href="https://tc39.es/ecma262/#sec-agent-clusters" id="ref-for-sec-agent-clusters">代理集群</a>集合在当前<a
                data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent-clusters"
                id="ref-for-sec-agent-clusters①">代理集群</a>地址空间内的内存使用情况。
            该算法的输出结果叫做<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="intermediate-memory-measurement">中间内存测量值</dfn>，它是<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">集合</a>，集合内是<a
                data-link-type="dfn" href="#intermediate-memory-breakdown-entry"
                id="ref-for-intermediate-memory-breakdown-entry">中间内存分拆条目</a>。</p>
        <p>为保证地址空间隔离的安全性，任何代表当前地址空间之外内存的中间内存分拆条目，都必须将其 bytes 设置为 0。</p>
        <p>为减小指纹识别风险，结果仅应包括与给定代理集群集合分配或使用的 web 平台对象相关的内存。
            例如，这不包括 user-agent 特有扩展的内存及空页面的基线内存。
            内存必须按地址空间统计，以排除诸如内存压缩、延迟分配等平台相关内存优化的影响。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="intermediate-memory-breakdown-entry">中间内存分拆条目</dfn>是一种<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct">结构体</a>
            ，包含如下<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item"
                id="ref-for-struct-item">项</a>：</p>
        <dl>
            <dt data-md><dfn class="dfn-paneled" data-dfn-for="intermediate memory breakdown entry" data-dfn-type="dfn"
                    data-noexport id="intermediate-memory-breakdown-entry-bytes">bytes</dfn>
            <dd data-md>
                <p>该<a data-link-type="dfn" href="#intermediate-memory-breakdown-entry"
                        id="ref-for-intermediate-memory-breakdown-entry①">中间内存分拆条目</a>描述的内存大小，若为当前地址空间外，则为 0。</p>
            <dt data-md><dfn class="dfn-paneled" data-dfn-for="intermediate memory breakdown entry" data-dfn-type="dfn"
                    data-noexport id="intermediate-memory-breakdown-entry-realms">realms</dfn>
            <dd data-md>
                <p>一个<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set"
                        id="ref-for-ordered-set①">集合</a>，内含归因该内存的<a data-link-type="dfn"
                        href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms⑤">JavaScript
                        域</a>。</p>
            <dt data-md><dfn class="dfn-paneled" data-dfn-for="intermediate memory breakdown entry" data-dfn-type="dfn"
                    data-noexport id="intermediate-memory-breakdown-entry-types">types</dfn>
            <dd data-md>
                <p>一个<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set"
                        id="ref-for-ordered-set②">集合</a>，包含指定与该内存关联的<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#implementation-defined"
                        id="ref-for-implementation-defined②">实现自定义</a>内存类型的<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#string" id="ref-for-string">字符串</a>。</p>
        </dl>
        <p>本规范定义的算法说明如何将<a data-link-type="dfn" href="#intermediate-memory-measurement"
                id="ref-for-intermediate-memory-measurement">中间内存测量值</a>转换为 <code
                class="idl"><a data-link-type="idl" href="#dictdef-memorymeasurement" id="ref-for-dictdef-memorymeasurement①">MemoryMeasurement</a></code>
            实例。
        </p>
        <h3 class="heading settled" data-level="2.3" id="memory-attribution-token-section"><span class="secno">2.3.
            </span><span class="content">内存归因令牌</span><a class="self-link" href="#memory-attribution-token-section"></a>
        </h3>
        <p>嵌入的<a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms"
                id="ref-for-sec-code-realms⑥">JavaScript 域</a>与其容器元素之间的链接是临时的，不能保证永久存在。
            例如，容器元素导航到其它文档或从 DOM 树中移除，都会断开该链接。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="memory-attribution-token">内存归因令牌</dfn>
            提供了一种从<a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms"
                id="ref-for-sec-code-realms⑦">JavaScript 域</a>找到其容器元素的方法。
            它是一个<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct①">结构体</a>，
            包含如下<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item"
                id="ref-for-struct-item①">项</a>：</p>
        <dl>
            <dt data-md><dfn class="dfn-paneled" data-dfn-for="memory attribution token" data-dfn-type="dfn"
                    data-noexport id="memory-attribution-token-container">container</dfn>
            <dd data-md>
                <p>一个 <code
                        class="idl"><a data-link-type="idl" href="#dictdef-memoryattributioncontainer" id="ref-for-dictdef-memoryattributioncontainer①">MemoryAttributionContainer</a></code>
                    实例。
                </p>
            <dt data-md><dfn class="dfn-paneled" data-dfn-for="memory attribution token" data-dfn-type="dfn"
                    data-noexport id="memory-attribution-token-cross-origin-aggregated-flag">cross-origin aggregated
                    flag</dfn>
            <dd data-md>
                <p>一个<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean"
                        id="ref-for-boolean">布尔</a>标志，表示此令牌是否用于跨域<a data-link-type="dfn"
                        href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms⑧">JavaScript
                        域</a>内存归集。</p>
        </dl>
        <p>该令牌会在 <code
                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope">WindowOrWorkerGlobalScope</a></code>
            构造时的新内部字段中保存，始终可用于内存上报。</p>
        <h2 class="heading settled" data-level="3" id="processing-model"><span class="secno">3. </span><span
                class="content">处理模型</span><a class="self-link" href="#processing-model"></a></h2>
        <h3 class="heading settled" data-level="3.1" id="extensions-to-performance"><span class="secno">3.1.
            </span><span class="content"><code
                    class="idl"><a data-link-type="idl" href="https://w3c.github.io/hr-time/#sec-performance" id="ref-for-sec-performance">Performance</a></code>
                接口扩展</span><a class="self-link" href="#extensions-to-performance"></a></h3>
        <pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/hr-time/#sec-performance" id="ref-for-sec-performance①"><c- g>Performance</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>ServiceWorker</c->,<c- n>SharedWorker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://github.com/heycam/webidl#pull/883" id="ref-for-pull/883"><c- g>CrossOriginIsolated</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise②"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-memorymeasurement" id="ref-for-dictdef-memorymeasurement②"><c- n>MemoryMeasurement</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-performance-measureuseragentspecificmemory" id="ref-for-dom-performance-measureuseragentspecificmemory④"><c- g>measureUserAgentSpecificMemory</c-></a>();
};
</pre>
        <dl class="domintro">
            <dl>
                <dt data-md>
                    <code>performance . <code class="idl"><a data-link-type="idl" href="#dom-performance-measureuseragentspecificmemory" id="ref-for-dom-performance-measureuseragentspecificmemory⑤">measureUserAgentSpecificMemory()</a></code></code>
                <dd data-md>
                    <p>一个执行异步内存测量的方法。该方法结果的详细说明见 <a href="#memory-measurement-result">§ 2.1 内存测量结果</a>。</p>
            </dl>
            <p></p>
        </dl>
        <h3 class="heading settled" data-level="3.2" id="top-level-algorithms"><span class="secno">3.2. </span><span
                class="content">顶层算法</span><a class="self-link" href="#top-level-algorithms"></a></h3>
        <div class="algorithm" data-algorithm="measureUserAgentSpecificMemory()" data-algorithm-for="Performance">
            <dfn class="dfn-paneled idl-code" data-dfn-for="Performance" data-dfn-type="method" data-export
                id="dom-performance-measureuseragentspecificmemory"><code>measureUserAgentSpecificMemory()</code></dfn>
            方法的执行步骤如下：
            <ol>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert"
                            id="ref-for-assert">断言</a>：<a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent"
                            id="ref-for-sec-agent">当前 Realm</a> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object"
                            id="ref-for-concept-realm-settings-object">settings 对象</a>的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability"
                            id="ref-for-concept-settings-object-cross-origin-isolated-capability①">跨域隔离能力</a>为 true。</p>
                <li data-md>
                    <p>如果 <a data-link-type="dfn" href="#memory-measurement-allowed-predicate"
                            id="ref-for-memory-measurement-allowed-predicate">memory measurement allowed predicate</a>
                        以 <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent" id="ref-for-sec-agent①">当前
                            Realm</a> 为参数结果为 false，则：</p>
                    <ol>
                        <li data-md>
                            <p>返回<a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with"
                                    id="ref-for-a-promise-rejected-with">被拒绝的 Promise</a>，错误类型为 "<code
                                    class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror" id="ref-for-securityerror">SecurityError</a></code>"
                                <code
                                    class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMException" id="ref-for-idl-DOMException">DOMException</a></code>。
                            </p>
                    </ol>
                <li data-md>
                    <p>令 <var>当前代理集群</var> 为 <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent"
                            id="ref-for-sec-agent②">当前 Realm</a> 的 <a data-link-type="dfn"
                            href="https://tc39.es/ecma262/#sec-agents" id="ref-for-sec-agents">agent</a> 的 <a
                            data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent-clusters"
                            id="ref-for-sec-agent-clusters②">代理集群</a>。</p>
                <li data-md>
                    <p>令 <var>agent clusters</var> 为 <a data-link-type="dfn" href="#getting-all-agent-clusters"
                            id="ref-for-getting-all-agent-clusters">getting all agent
                            clusters</a> 以 <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent"
                            id="ref-for-sec-agent③">当前 Realm</a> 调用的结果。</p>
                <li data-md>
                    <p>令 <var>promise</var> 为新的 <code
                            class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise③">Promise</a></code>。
                    </p>
                <li data-md>
                    <p>以 <var>当前代理集群</var>、<var>agent clusters</var> 和 <var>promise</var>，启动异步<a data-link-type="dfn"
                            href="#implementation-defined-memory-measurement"
                            id="ref-for-implementation-defined-memory-measurement">实现自定义内存测量</a>。</p>
                <li data-md>
                    <p>返回 <var>promise</var>。</p>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="memory measurement allowed predicate">
            计算<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="memory-measurement-allowed-predicate">memory measurement allowed predicate</dfn>（给定 <a
                data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms"
                id="ref-for-sec-code-realms⑨">JavaScript 域</a> <var>realm</var>）的步骤如下：
            <ol>
                <li data-md>
                    <p>令 <var>global object</var> 为 <var>realm</var> 的<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global"
                            id="ref-for-concept-realm-global">全局对象</a>。</p>
                <li data-md>
                    <p>如果 <var>global object</var> 是 <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope">SharedWorkerGlobalScope</a></code>,
                        返回 true。</p>
                <li data-md>
                    <p>如果 <var>global object</var> 是 <code
                            class="idl"><a data-link-type="idl" href="https://w3c.github.io/ServiceWorker/#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope">ServiceWorkerGlobalScope</a></code>,
                        返回 true。</p>
                <li data-md>
                    <p>如果 <var>global object</var> 是 <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window">Window</a></code>
                        ，那么：</p>
                    <ol>
                        <li data-md>
                            <p>令 <var>settings object</var> 为 <var>realm</var> 的 <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object"
                                    id="ref-for-concept-realm-settings-object①">settings object</a>。</p>
                        <li data-md>
                            <p>如果 <var>settings object</var> 的 <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"
                                    id="ref-for-concept-settings-object-origin">origin</a> 和 <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin"
                                    id="ref-for-concept-environment-top-level-origin">顶级 origin</a> 相同，则返回 true。</p>
                    </ol>
                <li data-md>
                    <p>返回 false。</p>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="getting all agent clusters">
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="getting all agent clusters|get all agent clusters"
                data-noexport id="getting-all-agent-clusters">get all agent clusters</dfn>（给定 <a data-link-type="dfn"
                href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms①⓪">JavaScript 域</a>
            <var>realm</var>）的步骤如下：
            <ol>
                <li data-md>
                    <p>如果 <var>realm</var> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global"
                            id="ref-for-concept-realm-global①">全局对象</a> 是 <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window①">Window</a></code>，
                        则：</p>
                    <ol>
                        <li data-md>
                            <p>令 <var>group</var> 为包含 <var>realm</var> 的 <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global"
                                    id="ref-for-concept-realm-global②">全局对象</a>的 <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/window-object.html#window-bc"
                                    id="ref-for-window-bc">浏览上下文</a>的<a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-group"
                                    id="ref-for-browsing-context-group">浏览上下文组</a>。
                            </p>
                        <li data-md>
                            <p>返回 <var>group</var> 的 <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/browsers.html#agent-cluster-map"
                                    id="ref-for-agent-cluster-map">agent cluster map</a>所有值的结果。</p>
                    </ol>
                <li data-md>
                    <p>返回 « <var>realm</var> 的<a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agents"
                            id="ref-for-sec-agents①">agent</a>的<a data-link-type="dfn"
                            href="https://tc39.es/ecma262/#sec-agent-clusters" id="ref-for-sec-agent-clusters③">代理集群</a>
                        »。</p>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="implementation-defined memory measurement">
            <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="implementation-defined-memory-measurement">实现自定义内存测量</dfn>（参数为 <a data-link-type="dfn"
                href="https://tc39.es/ecma262/#sec-agent-clusters" id="ref-for-sec-agent-clusters④">代理集群</a>
            <var>当前代理集群</var>，一组<a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-agent-clusters"
                id="ref-for-sec-agent-clusters⑤">代理集群</a> <var>agent clusters</var>，以及 <code
                class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise④">Promise</a></code>
            <var>promise</var>），并<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                id="ref-for-in-parallel">并行</a>执行如下步骤：
            <ol>
                <li data-md>
                    <p>令 <var>intermediate memory measurement</var> 为使用 <var>当前代理集群</var> 与 <var>agent clusters</var>
                        执行<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined"
                            id="ref-for-implementation-defined③">实现自定义</a>的<a data-link-type="dfn"
                            href="#intermediate-memory-measurement"
                            id="ref-for-intermediate-memory-measurement①">中间内存测量</a>的结果。</p>
                <li data-md>
                    <p>在 TODO 任务源上，<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task"
                            id="ref-for-queue-a-global-task">排入全局任务队列</a>，以 <var>promise</var> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"
                            id="ref-for-concept-relevant-global">相关全局对象</a>为上下文，<a data-link-type="dfn"
                            href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve">resolve</a>
                        <var>promise</var> 的值为以 <var>intermediate memory measurement</var> 作为参数调用<a data-link-type="dfn"
                            href="#creating-a-new-memory-measurement"
                            id="ref-for-creating-a-new-memory-measurement">创建新内存测量</a>的结果。
                    </p>
            </ol>
        </div>
        <h3 class="heading settled" data-level="3.3" id="converting-an-intermediate-memory-measurement-to-the-result">
            <span class="secno">3.3. </span><span class="content">将中间内存测量值转换为结果</span><a class="self-link"
                href="#converting-an-intermediate-memory-measurement-to-the-result"></a>
        </h3>
        <div class="algorithm" data-algorithm="creating a new memory measurement">
            若要<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-lt="creating a new memory measurement|create a new memory measurement" data-noexport
                id="creating-a-new-memory-measurement">创建新的内存测量</dfn>，给定一个<a data-link-type="dfn"
                href="#intermediate-memory-measurement"
                id="ref-for-intermediate-memory-measurement②">中间内存测量值</a><var>intermediate
                measurement</var>：
            <ol>
                <li data-md>
                    <p>令 <var>bytes</var> 为 0。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate">遍历每个</a><a data-link-type="dfn"
                            href="#intermediate-memory-breakdown-entry"
                            id="ref-for-intermediate-memory-breakdown-entry②">中间内存分拆条目</a>
                        <var>intermediate entry</var> 于 <var>intermediate measurement</var> 中：
                    </p>
                    <ol>
                        <li data-md>
                            <p>将 <var>bytes</var> 设为 <var>bytes</var> 加上 <var>intermediate entry</var> 的 <a
                                    data-link-type="dfn" href="#intermediate-memory-breakdown-entry-bytes"
                                    id="ref-for-intermediate-memory-breakdown-entry-bytes">bytes</a>。</p>
                    </ol>
                <li data-md>
                    <p>令 <var>breakdown</var> 为一个新的<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                            id="ref-for-list">列表</a>。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append"
                            id="ref-for-list-append">添加</a>到 <var>breakdown</var> 一个新的 <code
                            class="idl"><a data-link-type="idl" href="#dictdef-memorybreakdownentry" id="ref-for-dictdef-memorybreakdownentry①">MemoryBreakdownEntry</a></code>
                        ，其：</p>
                    <ul>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-bytes" id="ref-for-dom-memorybreakdownentry-bytes①">bytes</a></code>
                                为 0，</p>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-attribution" id="ref-for-dom-memorybreakdownentry-attribution①">attribution</a></code>
                                为 « »，</p>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-types" id="ref-for-dom-memorybreakdownentry-types①">types</a></code>
                                为 « »。</p>
                    </ul>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate①">遍历每个</a><a data-link-type="dfn"
                            href="#intermediate-memory-breakdown-entry"
                            id="ref-for-intermediate-memory-breakdown-entry③">中间内存分拆条目</a>
                        <var>intermediate entry</var> 于 <var>intermediate measurement</var> 中：
                    </p>
                    <ol>
                        <li data-md>
                            <p>令 <var>breakdown entry</var> 为以 <var>intermediate entry</var> 为参数调用<a
                                    data-link-type="dfn" href="#creating-a-new-memory-breakdown-entry"
                                    id="ref-for-creating-a-new-memory-breakdown-entry">创建新的 memory breakdown entry</a>
                                的结果。</p>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append"
                                    id="ref-for-list-append①">添加</a> <var>breakdown entry</var> 至
                                <var>breakdown</var>。
                            </p>
                    </ol>
                <li data-md>
                    <p>将 <var>breakdown</var> 中各项随机排序。</p>
                <li data-md>
                    <p>返回一个新的 <code
                            class="idl"><a data-link-type="idl" href="#dictdef-memorymeasurement" id="ref-for-dictdef-memorymeasurement③">MemoryMeasurement</a></code>
                        ，其：</p>
                    <ul>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-bytes" id="ref-for-dom-memorymeasurement-bytes②">bytes</a></code>
                                为 <var>bytes</var>，</p>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-breakdown" id="ref-for-dom-memorymeasurement-breakdown①">breakdown</a></code>
                                为 <var>breakdown</var>。</p>
                    </ul>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="creating a new memory breakdown entry">
            若要<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-lt="creating a new memory breakdown entry|create a new memory breakdown entry" data-noexport
                id="creating-a-new-memory-breakdown-entry">创建新的 memory breakdown entry</dfn>，给定一个<a data-link-type="dfn"
                href="#intermediate-memory-breakdown-entry"
                id="ref-for-intermediate-memory-breakdown-entry④">中间内存分拆条目</a>
            <var>intermediate entry</var>：
            <ol>
                <li data-md>
                    <p>令 <var>attribution</var> 为新的<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                            id="ref-for-list①">列表</a>。</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate②">遍历每个</a> <a data-link-type="dfn"
                            href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms①①">JavaScript
                            域</a> <var>realm</var> 于 <var>intermediate entry</var> 的 <a data-link-type="dfn"
                            href="#intermediate-memory-breakdown-entry-realms"
                            id="ref-for-intermediate-memory-breakdown-entry-realms">realms</a> 中：</p>
                    <ol>
                        <li data-md>
                            <p>令 <var>attribution entry</var> 为以 <var>realm</var> 为参数调用 <a data-link-type="dfn"
                                    href="#creating-a-new-memory-attribution"
                                    id="ref-for-creating-a-new-memory-attribution">创建新的 memory attribution</a> 的结果。</p>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append"
                                    id="ref-for-list-append②">添加</a> <var>attribution entry</var> 到
                                <var>attribution</var>。
                            </p>
                    </ol>
                <li data-md>
                    <p>令 <var>types</var> 为 <var>intermediate entry</var> 的 <a data-link-type="dfn"
                            href="#intermediate-memory-breakdown-entry-types"
                            id="ref-for-intermediate-memory-breakdown-entry-types">types</a>。</p>
                <li data-md>
                    <p>将 <var>types</var> 中各项随机排序。</p>
                <li data-md>
                    <p>返回一个新的 <code
                            class="idl"><a data-link-type="idl" href="#dictdef-memorybreakdownentry" id="ref-for-dictdef-memorybreakdownentry②">MemoryBreakdownEntry</a></code>
                        ，其：</p>
                    <ul>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-bytes" id="ref-for-dom-memorybreakdownentry-bytes②">bytes</a></code>
                                为 <var>intermediate entry</var> 的 <a data-link-type="dfn"
                                    href="#intermediate-memory-breakdown-entry-bytes"
                                    id="ref-for-intermediate-memory-breakdown-entry-bytes①">bytes</a>，</p>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-attribution" id="ref-for-dom-memorybreakdownentry-attribution②">attribution</a></code>
                                为 <var>attribution</var>，</p>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-types" id="ref-for-dom-memorybreakdownentry-types②">types</a></code>
                                为 <var>types</var>。</p>
                    </ul>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="creating a new memory attribution">
            若要<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-lt="creating a new memory attribution|create a new memory attribution" data-noexport
                id="creating-a-new-memory-attribution">创建新的 memory attribution</dfn>，给定一个<a data-link-type="dfn"
                href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms①②">JavaScript 域</a>
            <var>realm</var>：
            <ol>
                <li data-md>
                    <p>令 <var>token</var> 为 <var>realm</var> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global"
                            id="ref-for-concept-realm-global③">全局对象</a>的 <a data-link-type="dfn"
                            href="#windoworworkerglobalscope-memory-attribution-token"
                            id="ref-for-windoworworkerglobalscope-memory-attribution-token">memory attribution
                            token</a>。</p>
                <li data-md>
                    <p>如果 <var>token</var> 的 <a data-link-type="dfn"
                            href="#memory-attribution-token-cross-origin-aggregated-flag"
                            id="ref-for-memory-attribution-token-cross-origin-aggregated-flag">跨域聚合标志</a>为 true，则：</p>
                    <ol>
                        <li data-md>
                            <p>返回一个新的 <code
                                    class="idl"><a data-link-type="idl" href="#dictdef-memoryattribution" id="ref-for-dictdef-memoryattribution①">MemoryAttribution</a></code>
                                ，其：</p>
                            <ul>
                                <li data-md>
                                    <p><code
                                            class="idl"><a data-link-type="idl" href="#dom-memoryattribution-url" id="ref-for-dom-memoryattribution-url①">url</a></code>
                                        为 "<code>cross-origin-url</code>"，</p>
                                <li data-md>
                                    <p><code
                                            class="idl"><a data-link-type="idl" href="#dom-memoryattribution-container" id="ref-for-dom-memoryattribution-container①">container</a></code>
                                        为 <var>token</var> 的 <a data-link-type="dfn"
                                            href="#memory-attribution-token-container"
                                            id="ref-for-memory-attribution-token-container">container</a> 若非 null，否则不包含该
                                        <code
                                            class="idl"><a data-link-type="idl" href="#dom-memoryattribution-container" id="ref-for-dom-memoryattribution-container②">container</a></code>
                                        属性，
                                    </p>
                                <li data-md>
                                    <p><code
                                            class="idl"><a data-link-type="idl" href="#dom-memoryattribution-scope" id="ref-for-dom-memoryattribution-scope①">scope</a></code>
                                        为 "<code>cross-origin-aggregated</code>"。</p>
                            </ul>
                    </ol>
                <li data-md>
                    <p>令 <var>scope name</var> 为 <var>realm</var> 的 <a data-link-type="dfn"
                            href="https://heycam.github.io/webidl/#dfn-identifier"
                            id="ref-for-dfn-identifier">identifier</a>（接口类型名）。</p>
                <li data-md>
                    <p>返回一个新的 <code
                            class="idl"><a data-link-type="idl" href="#dictdef-memoryattribution" id="ref-for-dictdef-memoryattribution②">MemoryAttribution</a></code>
                        ，其：</p>
                    <ul>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-memoryattribution-url" id="ref-for-dom-memoryattribution-url②">url</a></code>
                                为 <var>realm</var> 的 <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object"
                                    id="ref-for-concept-realm-settings-object②">settings object</a> 的 <a
                                    data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url"
                                    id="ref-for-concept-environment-creation-url">创建 URL</a>，</p>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-memoryattribution-container" id="ref-for-dom-memoryattribution-container③">container</a></code>
                                为 <var>token</var> 的 <a data-link-type="dfn" href="#memory-attribution-token-container"
                                    id="ref-for-memory-attribution-token-container①">container</a>（如非 null，否则不写该 <code
                                    class="idl"><a data-link-type="idl" href="#dom-memoryattribution-container" id="ref-for-dom-memoryattribution-container④">container</a></code>
                                字段），</p>
                        <li data-md>
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-memoryattribution-scope" id="ref-for-dom-memoryattribution-scope②">scope</a></code>
                                为 <var>scope name</var>。</p>
                    </ul>
            </ol>
        </div>
        <h3 class="heading settled" data-level="3.4" id="creating-or-obtaining-a-memory-attribution-token"><span
                class="secno">3.4. </span><span class="content">创建或获取内存归因令牌</span><a class="self-link"
                href="#creating-or-obtaining-a-memory-attribution-token"></a></h3>
        <div class="algorithm" data-algorithm="obtain a window memory attribution token">
            若要<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-lt="obtain a window memory attribution token|obtaining a window memory attribution token"
                data-noexport id="obtain-a-window-memory-attribution-token">获取 window 内存归因令牌</dfn>，给定一个 <a
                data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin"
                id="ref-for-concept-origin">origin</a> <var>origin</var>，<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin"
                id="ref-for-concept-origin①">origin</a> <var>parent origin</var>，<a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin"
                id="ref-for-concept-origin②">origin</a> <var>top-level origin</var>，
            <code
                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/dom.html#htmlelement" id="ref-for-htmlelement">HTMLElement</a></code>
            <var>container element</var>，以及 <a data-link-type="dfn" href="#memory-attribution-token"
                id="ref-for-memory-attribution-token">memory attribution token</a> <var>parent token</var>：
            <ol>
                <li data-md>
                    <p>若 <var>container element</var> 为 null，则：</p>
                    <ol>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert"
                                    id="ref-for-assert①">断言</a>：<var>parent origin</var> 为 null。</p>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert"
                                    id="ref-for-assert②">断言</a>：<var>parent token</var> 为 null。</p>
                        <li data-md>
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert"
                                    id="ref-for-assert③">断言</a>：<var>origin</var> 等于 <var>parent
                                    origin</var></p>
                        <li data-md>
                            <p>返回一个新的<a data-link-type="dfn" href="#memory-attribution-token"
                                    id="ref-for-memory-attribution-token①">memory attribution token</a>，其：</p>
                            <ul>
                                <li data-md>
                                    <p><a data-link-type="dfn" href="#memory-attribution-token-container"
                                            id="ref-for-memory-attribution-token-container②">container</a> 为 null，</p>
                                <li data-md>
                                    <p><a data-link-type="dfn"
                                            href="#memory-attribution-token-cross-origin-aggregated-flag"
                                            id="ref-for-memory-attribution-token-cross-origin-aggregated-flag①">cross-origin
                                            aggregated flag</a> 为 false。</p>
                            </ul>
                    </ol>
                <li data-md>
                    <p>若 <var>parent origin</var> 不等于 <var>top-level origin</var>，则：</p>
                    <ol>
                        <li data-md>
                            <p>返回 <var>parent token</var>。</p>
                    </ol>
                <li data-md>
                    <p>令 <var>container</var> 为以 <var>container element</var> 为参数调用<a data-link-type="dfn"
                            href="#extract-container-element-attributes"
                            id="ref-for-extract-container-element-attributes">提取容器元素属性</a>的结果。</p>
                <li data-md>
                    <p>若 <var>origin</var> 等于 <var>top-level origin</var>，则：</p>
                    <ol>
                        <li data-md>
                            <p>返回新的<a data-link-type="dfn" href="#memory-attribution-token"
                                    id="ref-for-memory-attribution-token②">memory attribution token</a>，其：</p>
                            <ul>
                                <li data-md>
                                    <p><a data-link-type="dfn" href="#memory-attribution-token-container"
                                            id="ref-for-memory-attribution-token-container③">container</a> 为
                                        <var>container</var>，
                                    </p>
                                <li data-md>
                                    <p><a data-link-type="dfn"
                                            href="#memory-attribution-token-cross-origin-aggregated-flag"
                                            id="ref-for-memory-attribution-token-cross-origin-aggregated-flag②">cross-origin
                                            aggregated flag</a> 为 false。</p>
                            </ul>
                    </ol>
                <li data-md>
                    <p>返回一个新的 <a data-link-type="dfn" href="#memory-attribution-token"
                            id="ref-for-memory-attribution-token③">memory attribution token</a>，其：</p>
                    <ul>
                        <li data-md>
                            <p><a data-link-type="dfn" href="#memory-attribution-token-container"
                                    id="ref-for-memory-attribution-token-container④">container</a> 为
                                <var>container</var>，
                            </p>
                        <li data-md>
                            <p><a data-link-type="dfn" href="#memory-attribution-token-cross-origin-aggregated-flag"
                                    id="ref-for-memory-attribution-token-cross-origin-aggregated-flag③">cross-origin
                                    aggregated flag</a> 为 true。</p>
                    </ul>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="obtain a worker memory attribution token">
            若要<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-lt="obtain a worker memory attribution token|obtaining a worker memory attribution token"
                data-noexport id="obtain-a-worker-memory-attribution-token">获取 worker 内存归因令牌</dfn>，给定 <code
                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope">WorkerGlobalScope</a></code>
            <var>worker global scope</var>，以及 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"
                id="ref-for-environment-settings-object">environment settings object</a> <var>outside settings</var>：
            <ol>
                <li data-md>
                    <p>如果 <var>worker global scope</var> 是 <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope">DedicatedWorkerGlobalScope</a></code>，
                        则返回 <var>outside settings</var> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                            id="ref-for-concept-settings-object-global">global object</a> 的 <a data-link-type="dfn"
                            href="#windoworworkerglobalscope-memory-attribution-token"
                            id="ref-for-windoworworkerglobalscope-memory-attribution-token①">memory attribution
                            token</a>。</p>
                <li data-md>
                    <p class="assertion">断言: <var>worker global scope</var> 为 <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope①">SharedWorkerGlobalScope</a></code>
                        或 <code
                            class="idl"><a data-link-type="idl" href="https://w3c.github.io/ServiceWorker/#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope①">ServiceWorkerGlobalScope</a></code>。
                    </p>
                <li data-md>
                    <p>返回一个新的 <a data-link-type="dfn" href="#memory-attribution-token"
                            id="ref-for-memory-attribution-token④">memory attribution token</a>，其：</p>
                    <ul>
                        <li data-md>
                            <p><a data-link-type="dfn" href="#memory-attribution-token-container"
                                    id="ref-for-memory-attribution-token-container⑤">container</a> 为 null，</p>
                        <li data-md>
                            <p><a data-link-type="dfn" href="#memory-attribution-token-cross-origin-aggregated-flag"
                                    id="ref-for-memory-attribution-token-cross-origin-aggregated-flag④">cross-origin
                                    aggregated flag</a> 为 false。</p>
                    </ul>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="extract container element attributes">
            若要<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-lt="extract container element attributes|extracting container element attributes" data-noexport
                id="extract-container-element-attributes">提取容器元素属性</dfn>，给定 <code
                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/dom.html#htmlelement" id="ref-for-htmlelement①">HTMLElement</a></code>
            <var>container element</var>：
            <ol>
                <li data-md>
                    <p>以 <var>container element</var> 的<a data-link-type="dfn"
                            href="https://dom.spec.whatwg.org/#concept-element-local-name"
                            id="ref-for-concept-element-local-name">本地名</a>为分支：</p>
                    <dl class="switch">
                        <dt data-md>"iframe"
                        <dd data-md>
                            <p>返回新的 <code
                                    class="idl"><a data-link-type="idl" href="#dictdef-memoryattributioncontainer" id="ref-for-dictdef-memoryattributioncontainer②">MemoryAttributionContainer</a></code>
                                ，其：</p>
                            <ul>
                                <li data-md>
                                    <p><code
                                            class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-id" id="ref-for-dom-memoryattributioncontainer-id①">id</a></code>
                                        为 <var>container element</var> 的
                                        <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute" id="ref-for-the-id-attribute">id</a></code>
                                        属性，
                                    </p>
                                <li data-md>
                                    <p><code
                                            class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-src" id="ref-for-dom-memoryattributioncontainer-src①">src</a></code>
                                        为 <var>container element</var> 的
                                        <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-src" id="ref-for-attr-iframe-src">src</a></code>
                                        属性，
                                    </p>
                            </ul>
                        <dt data-md>"frame"
                        <dd data-md>
                            <p>返回新的 <code
                                    class="idl"><a data-link-type="idl" href="#dictdef-memoryattributioncontainer" id="ref-for-dictdef-memoryattributioncontainer③">MemoryAttributionContainer</a></code>
                                ，其：</p>
                            <ul>
                                <li data-md>
                                    <p><code
                                            class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-id" id="ref-for-dom-memoryattributioncontainer-id②">id</a></code>
                                        为 <var>container element</var> 的
                                        <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute" id="ref-for-the-id-attribute①">id</a></code>
                                        属性，
                                    </p>
                                <li data-md>
                                    <p><code
                                            class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-src" id="ref-for-dom-memoryattributioncontainer-src②">src</a></code>
                                        为 <var>container element</var> 的
                                        <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/obsolete.html#dom-frame-src" id="ref-for-dom-frame-src">src</a></code>
                                        属性，
                                    </p>
                            </ul>
                        <dt data-md>"object"
                        <dd data-md>
                            <p>返回新的 <code
                                    class="idl"><a data-link-type="idl" href="#dictdef-memoryattributioncontainer" id="ref-for-dictdef-memoryattributioncontainer④">MemoryAttributionContainer</a></code>
                                ，其：</p>
                            <ul>
                                <li data-md>
                                    <p><code
                                            class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-id" id="ref-for-dom-memoryattributioncontainer-id③">id</a></code>
                                        为 <var>container element</var> 的
                                        <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute" id="ref-for-the-id-attribute②">id</a></code>
                                        属性，
                                    </p>
                                <li data-md>
                                    <p><code
                                            class="idl"><a data-link-type="idl" href="#dom-memoryattributioncontainer-src" id="ref-for-dom-memoryattributioncontainer-src③">src</a></code>
                                        为 <var>container element</var> 的
                                        <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data" id="ref-for-attr-object-data①">data</a></code>
                                        属性，
                                    </p>
                            </ul>
                    </dl>
            </ol>
        </div>
        <h2 class="heading settled" data-level="4" id="integration-with-the-existing-specification"><span
                class="secno">4. </span><span class="content">与现有规范的整合</span><a class="self-link"
                href="#integration-with-the-existing-specification"></a></h2>
        <h3 class="heading settled" data-level="4.1" id="extension-to-window-or-worker-global-scope"><span
                class="secno">4.1. </span><span class="content">对 <code
                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope①">WindowOrWorkerGlobalScope</a></code>
                的扩展</span><a class="self-link" href="#extension-to-window-or-worker-global-scope"></a></h3>
        在 <code
            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope②">WindowOrWorkerGlobalScope</a></code>
        中新增一个内部字段：
        <dl>
            <dt data-md>一个 <dfn class="dfn-paneled" data-dfn-for="WindowOrWorkerGlobalScope" data-dfn-type="dfn"
                    data-noexport id="windoworworkerglobalscope-memory-attribution-token">内存归因令牌</dfn>
            <dd data-md>
                <p>用于上报此环境内存使用的 <a data-link-type="dfn" href="#memory-attribution-token"
                        id="ref-for-memory-attribution-token⑤">内存归因令牌</a>。</p>
        </dl>
        <h3 class="heading settled" data-level="4.2" id="extensions-to-the-existing-algorithms"><span class="secno">4.2.
            </span><span class="content">对现有算法的扩展</span><a class="self-link"
                href="#extensions-to-the-existing-algorithms"></a></h3>
        <p>
            <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/workers.html#run-a-worker"
                id="ref-for-run-a-worker">运行 worker</a> 的算法，在第 6 步里会为新建全局对象设置 <a data-link-type="dfn"
                href="#windoworworkerglobalscope-memory-attribution-token"
                id="ref-for-windoworworkerglobalscope-memory-attribution-token②">内存归因令牌</a> 字段：
        </p>
        <blockquote>
            <ol start="6">
                <li data-md>
                    <p>令 realm execution context 为基于 agent 和下列自定义项创建的新 JavaScript realm：</p>
                    <ul>
                        <li data-md>
                            <p>...</p>
                        <li data-md>
                            <p>将全局对象的 <a data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token"
                                    id="ref-for-windoworworkerglobalscope-memory-attribution-token③">内存归因令牌</a>
                                设置为以全局对象和 <var>outside settings</var> 调用 <a data-link-type="dfn"
                                    href="#obtain-a-worker-memory-attribution-token"
                                    id="ref-for-obtain-a-worker-memory-attribution-token">获取 worker 内存归因令牌</a> 的结果。</p>
                    </ul>
            </ol>
        </blockquote>
        <p>
            <a data-link-type="abstract-op"
                href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#initialise-the-document-object"
                id="ref-for-initialise-the-document-object">创建与初始化 Document 对象</a> 的算法会为新创建的全局对象设置 <a
                data-link-type="dfn" href="#windoworworkerglobalscope-memory-attribution-token"
                id="ref-for-windoworworkerglobalscope-memory-attribution-token④">内存归因令牌</a> 字段：
        </p>
        <blockquote>
            <ol start="7">
                <li data-md>
                    <p>否则：</p>
                    <ol start="5">
                        <li data-md>
                            <p>令 <var>token</var> 为一个空的 <a data-link-type="dfn" href="#memory-attribution-token"
                                    id="ref-for-memory-attribution-token⑥">内存归因令牌</a>。</p>
                        <li data-md>
                            <p>如果 <var>browsingContext</var> 不是顶级 browsing context，则：</p>
                            <ol start="4">
                                <li data-md>
                                    <p>令 <var>parentToken</var> 为 <var>parentEnvironment</var> 的 <a data-link-type="dfn"
                                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"
                                            id="ref-for-concept-settings-object-global①">全局对象</a> 的 <a
                                            data-link-type="dfn"
                                            href="#windoworworkerglobalscope-memory-attribution-token"
                                            id="ref-for-windoworworkerglobalscope-memory-attribution-token⑤">内存归因令牌</a>。
                                    </p>
                                <li data-md>
                                    <p>将 <var>token</var> 设为以 <var>origin</var>、<var>parentEnvironment</var> 的
                                        origin、<var>topLevelOrigin</var>、<var>browsingContext</var> 的
                                        container、<var>parentToken</var> 调用 <a data-link-type="dfn"
                                            href="#obtain-a-window-memory-attribution-token"
                                            id="ref-for-obtain-a-window-memory-attribution-token">获取 window 内存归因令牌</a>
                                        的结果。
                                    </p>
                            </ol>
                        <li data-md>
                            <p>否则，将 <var>token</var> 设为以 <var>origin</var>、null <var>topLevelOrigin</var>、null、null 调用
                                <a data-link-type="dfn" href="#obtain-a-window-memory-attribution-token"
                                    id="ref-for-obtain-a-window-memory-attribution-token①">获取 window 内存归因令牌</a> 的结果。
                            </p>
                        <li data-md>
                            <p>令 <var>window global scope</var> 为 <var>realm execution context</var> 的 Realm 组件的 <a
                                    data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global"
                                    id="ref-for-concept-realm-global⑤">全局对象</a>。</p>
                        <li data-md>
                            <p>将 <var>window global scope</var> 的 <a data-link-type="dfn"
                                    href="#windoworworkerglobalscope-memory-attribution-token"
                                    id="ref-for-windoworworkerglobalscope-memory-attribution-token⑥">内存归因令牌</a> 设为
                                <var>token</var>。
                            </p>
                    </ol>
            </ol>
        </blockquote>
        <p>
            <a data-link-type="abstract-op"
                href="https://html.spec.whatwg.org/multipage/browsers.html#creating-a-new-browsing-context"
                id="ref-for-creating-a-new-browsing-context">创建新的浏览上下文</a> 的算法会为新建全局对象设置 <a data-link-type="dfn"
                href="#windoworworkerglobalscope-memory-attribution-token"
                id="ref-for-windoworworkerglobalscope-memory-attribution-token⑦">内存归因令牌</a> 字段：
        </p>
        <blockquote>
            <ol start="11">
                <li data-md>
                    <p>令 <var>token</var> 为一个空令牌。</p>
                <li data-md>
                    <p>如果 <var>embedder</var> 为 null，则把 <var>token</var> 设为以
                        <var>origin</var>、null、<var>topLevelOrigin</var>、null、null 调用 <a data-link-type="dfn"
                            href="#obtain-a-window-memory-attribution-token"
                            id="ref-for-obtain-a-window-memory-attribution-token②">获取 window 内存归因令牌</a> 的结果。
                    </p>
                <li data-md>
                    <p>否则，将 <var>token</var> 设为以 <var>origin</var>、<var>embedder</var> 的 <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"
                            id="ref-for-relevant-settings-object">相关 settings object</a> 的
                        origin、<var>topLevelOrigin</var>、<var>embedder</var>、<var>embedder</var> 的 <a
                            data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"
                            id="ref-for-concept-relevant-global①">相关全局对象</a> 的 <a data-link-type="dfn"
                            href="#windoworworkerglobalscope-memory-attribution-token"
                            id="ref-for-windoworworkerglobalscope-memory-attribution-token⑧">内存归因令牌</a> 调用 <a
                            data-link-type="dfn" href="#obtain-a-window-memory-attribution-token"
                            id="ref-for-obtain-a-window-memory-attribution-token③">获取 window 内存归因令牌</a> 的结果。
                    </p>
                <li data-md>
                    <p>令 <var>window global scope</var> 为 <var>realm execution context</var> 的 Realm 组件的 <a
                            data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global"
                            id="ref-for-concept-realm-global⑥">全局对象</a>。</p>
                <li data-md>
                    <p>将 <var>window global scope</var> 的 <a data-link-type="dfn"
                            href="#windoworworkerglobalscope-memory-attribution-token"
                            id="ref-for-windoworworkerglobalscope-memory-attribution-token⑨">内存归因令牌</a> 设为
                        <var>token</var>。
                    </p>
            </ol>
        </blockquote>
        <h2 class="heading settled" data-level="5" id="privacy-and-security"><span class="secno">5. </span><span
                class="content">隐私与安全</span><a class="self-link" href="#privacy-and-security"></a></h2>
        <div nonnormative>
            <h3 class="heading settled" data-level="5.1" id="information-leak"><span class="secno">5.1. </span><span
                    class="content">跨域信息泄露</span><a class="self-link" href="#information-leak"></a></h3>
            <p>结果中出现的 URL 及其他字符串值保证为调用 API 的源已知。</p>
            <p>仅有跨域暴露的信息是 <code
                    class="idl"><a data-link-type="idl" href="#dom-memorymeasurement-bytes" id="ref-for-dom-memorymeasurement-bytes③">memoryMeasurement.bytes</a></code>
                和 <code
                    class="idl"><a data-link-type="idl" href="#dom-memorybreakdownentry-bytes" id="ref-for-dom-memorybreakdownentry-bytes③">memoryBreakdownEntry.bytes</a></code>
                中的大小信息。
                该 API 依赖 <a data-link-type="dfn"
                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability"
                    id="ref-for-concept-settings-object-cross-origin-isolated-capability②">跨源隔离</a>
                机制以缓解跨域大小信息泄漏。
                具体来说，API 依赖一个不变式：当前地址空间的所有资源都已选择允许被嵌入且能被嵌入源读取。
                API 不暴露在不同地址空间加载的跨域资源的大小。</p>
            <h3 class="heading settled" data-level="5.2" id="fingerprinting"><span class="secno">5.2. </span><span
                    class="content">指纹识别</span><a class="self-link" href="#fingerprinting"></a></h3>
            <p>API 的结果只依赖于页面本身分配的对象，不计入与空页面基线内存等无关内存。
                这意味着同一 user agent 二进制在两台不同设备上访问同一个页面应产生相同的结果。</p>
            <p>网页可以推断如下 user agent 的信息：</p>
            <ul>
                <li data-md>
                    <p>user agent 的位数（32位 vs 64位）。</p>
                <li data-md>
                    <p>部分 user agent 版本信息。</p>
            </ul>
            <p>类似信息也可以从现有 API 获取（<code
                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-useragent" id="ref-for-dom-navigator-useragent">navigator.userAgent</a></code>，
                <code
                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-platform" id="ref-for-dom-navigator-platform">navigator.platform</a></code>）。
                user agent 的位数还可以通过测量 32 位和 64 位运算的执行时间推断。
            </p>
            <p>目前该 API 仅可被顶级域名访问。
                未来顶级域可通过权限策略（Permissions Policy）将 API 委托给其它域。
                无论哪种情况，跨域 iframe 默认均无法访问该 API。</p>
        </div>
        <h2 class="heading settled" data-level="6" id="acknowledgements"><span class="secno">6. </span><span
                class="content">致谢</span><a class="self-link" href="#acknowledgements"></a></h2>
        感谢 Domenic Denicola 和 Shu-yu Guo 对 API 设计的贡献与本规范的审阅。
        <p>同时感谢 Adam Giacobbe、Anne van Kesteren、Artur Janc、Boris Zbarsky、Chris Hamilton、Chris Palmer、
            Daniel Vogelheim、Dominik Inführ、Hannes Payer、Joe Mason、Kentaro Hara、L. David Baron、Mathias Bynens、
            Matthew Bolohan、Michael Lippautz、Mike West、Neil Mckay、Olga Belomestnykh、Per Parker、Philipp Weis 和
            Yoav Weiss 的反馈与贡献。</p>
    </main>
    <script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本规范定义的术语</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#dom-memorybreakdownentry-attribution">归因（attribution）</a><span>，见 §2.1</span>
        <li><a href="#dom-memorymeasurement-breakdown">分拆（breakdown）</a><span>，见 §2.1</span>
        <li>
            字节数（bytes）
            <ul>
                <li><a href="#intermediate-memory-breakdown-entry-bytes">intermediate memory breakdown entry
                        的定义</a><span>，见 §2.2</span>
                <li><a href="#dom-memorybreakdownentry-bytes">MemoryBreakdownEntry 的字典成员</a><span>，见 §2.1</span>
                <li><a href="#dom-memorymeasurement-bytes">MemoryMeasurement 的字典成员</a><span>，见 §2.1</span>
            </ul>
        <li>
            容器（container）
            <ul>
                <li><a href="#memory-attribution-token-container">memory attribution token 的定义</a><span>，见 §2.3</span>
                <li><a href="#dom-memoryattribution-container">MemoryAttribution 的字典成员</a><span>，见 §2.1</span>
            </ul>
        <li><a href="#creating-a-new-memory-attribution">创建新的 memory attribution（create a new memory
                attribution）</a><span>，见 §3.3</span>
        <li><a href="#creating-a-new-memory-breakdown-entry">创建新的 memory breakdown entry（create a new memory breakdown
                entry）</a><span>，见 §3.3</span>
        <li><a href="#creating-a-new-memory-measurement">创建新的 memory measurement（create a new memory
                measurement）</a><span>，见 §3.3</span>
        <li><a href="#creating-a-new-memory-attribution">创建新的 memory attribution（creating a new memory
                attribution）</a><span>，见 §3.3</span>
        <li><a href="#creating-a-new-memory-breakdown-entry">创建新的 memory breakdown entry（creating a new memory breakdown
                entry）</a><span>，见 §3.3</span>
        <li><a href="#creating-a-new-memory-measurement">创建新的 memory measurement（creating a new memory
                measurement）</a><span>，见 §3.3</span>
        <li><a href="#memory-attribution-token-cross-origin-aggregated-flag">跨域聚合标志（cross-origin aggregated
                flag）</a><span>，见 §2.3</span>
        <li><a href="#extract-container-element-attributes">提取容器元素属性（extract container element attributes）</a><span>，见
                §3.4</span>
        <li><a href="#extract-container-element-attributes">提取容器元素属性（extracting container element
                attributes）</a><span>，见 §3.4</span>
        <li><a href="#getting-all-agent-clusters">获取所有 agent cluster（get all agent clusters）</a><span>，见 §3.2</span>
        <li><a href="#getting-all-agent-clusters">获取所有 agent cluster（getting all agent clusters）</a><span>，见 §3.2</span>
        <li><a href="#dom-memoryattributioncontainer-id">id</a><span>，见 §2.1</span>
        <li><a href="#implementation-defined-memory-measurement">实现自定义内存测量（implementation-defined memory
                measurement）</a><span>，见 §3.2</span>
        <li><a href="#intermediate-memory-breakdown-entry">中间内存分拆条目（intermediate memory breakdown entry）</a><span>，见
                §2.2</span>
        <li><a href="#intermediate-memory-measurement">中间内存测量（intermediate memory measurement）</a><span>，见 §2.2</span>
        <li><a href="#dom-performance-measureuseragentspecificmemory">measureUserAgentSpecificMemory()</a><span>，见
                §3.2</span>
        <li><a href="#dictdef-memoryattribution">MemoryAttribution</a><span>，见 §2.1</span>
        <li><a href="#dictdef-memoryattributioncontainer">MemoryAttributionContainer</a><span>，见 §2.1</span>
        <li>
            内存归因令牌（memory attribution token）
            <ul>
                <li><a href="#memory-attribution-token">定义</a><span>，见 §2.3</span>
                <li><a href="#windoworworkerglobalscope-memory-attribution-token">WindowOrWorkerGlobalScope
                        的定义</a><span>，见 §4.1</span>
            </ul>
        <li><a href="#dictdef-memorybreakdownentry">MemoryBreakdownEntry</a><span>，见 §2.1</span>
        <li><a href="#dictdef-memorymeasurement">MemoryMeasurement</a><span>，见 §2.1</span>
        <li><a href="#memory-measurement-allowed-predicate">memory measurement 允许谓词（memory measurement allowed
                predicate）</a><span>，见 §3.2</span>
        <li><a href="#obtain-a-window-memory-attribution-token">获取 window 内存归因令牌（obtain a window memory attribution
                token）</a><span>，见 §3.4</span>
        <li><a href="#obtain-a-worker-memory-attribution-token">获取 worker 内存归因令牌（obtain a worker memory attribution
                token）</a><span>，见 §3.4</span>
        <li><a href="#obtain-a-window-memory-attribution-token">获取 window 内存归因令牌（obtaining a window memory attribution
                token）</a><span>，见 §3.4</span>
        <li><a href="#obtain-a-worker-memory-attribution-token">获取 worker 内存归因令牌（obtaining a worker memory attribution
                token）</a><span>，见 §3.4</span>
        <li><a href="#intermediate-memory-breakdown-entry-realms">realms</a><span>，见 §2.2</span>
        <li><a href="#dom-memoryattribution-scope">scope</a><span>，见 §2.1</span>
        <li><a href="#dom-memoryattributioncontainer-src">src</a><span>，见 §2.1</span>
        <li>
            类型（types）
            <ul>
                <li><a href="#intermediate-memory-breakdown-entry-types">intermediate memory breakdown entry
                        的定义</a><span>，见 §2.2</span>
                <li><a href="#dom-memorybreakdownentry-types">MemoryBreakdownEntry 的字典成员</a><span>，见 §2.1</span>
            </ul>
        <li><a href="#dom-memoryattribution-url">url</a><span>，见 §2.1</span>
    </ul>
    <aside class="dfn-panel" data-for="term-for-concept-element-local-name">
        <a
            href="https://dom.spec.whatwg.org/#concept-element-local-name">https://dom.spec.whatwg.org/#concept-element-local-name</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-element-local-name">3.4. Creating or obtaining a memory attribution token</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-sec-agents">
        <a href="https://tc39.es/ecma262/#sec-agents">https://tc39.es/ecma262/#sec-agents</a><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-sec-agents">3.2. Top-level algorithms</a> <a href="#ref-for-sec-agents①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-sec-agent-clusters">
        <a href="https://tc39.es/ecma262/#sec-agent-clusters">https://tc39.es/ecma262/#sec-agent-clusters</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-sec-agent-clusters">2.2. Intermediate memory measurement</a> <a
                    href="#ref-for-sec-agent-clusters①">(2)</a>
            <li><a href="#ref-for-sec-agent-clusters②">3.2. Top-level algorithms</a> <a
                    href="#ref-for-sec-agent-clusters③">(2)</a> <a href="#ref-for-sec-agent-clusters④">(3)</a> <a
                    href="#ref-for-sec-agent-clusters⑤">(4)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-sec-code-realms">
        <a href="https://tc39.es/ecma262/#sec-code-realms">https://tc39.es/ecma262/#sec-code-realms</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-sec-code-realms">2.1. Memory measurement result</a> <a
                    href="#ref-for-sec-code-realms①">(2)</a> <a href="#ref-for-sec-code-realms②">(3)</a> <a
                    href="#ref-for-sec-code-realms③">(4)</a> <a href="#ref-for-sec-code-realms④">(5)</a>
            <li><a href="#ref-for-sec-code-realms⑤">2.2. Intermediate memory measurement</a>
            <li><a href="#ref-for-sec-code-realms⑥">2.3. Memory attribution token</a> <a
                    href="#ref-for-sec-code-realms⑦">(2)</a> <a href="#ref-for-sec-code-realms⑧">(3)</a>
            <li><a href="#ref-for-sec-code-realms⑨">3.2. Top-level algorithms</a> <a
                    href="#ref-for-sec-code-realms①⓪">(2)</a>
            <li><a href="#ref-for-sec-code-realms①①">3.3. Converting an intermediate memory measurement to the
                    result</a> <a href="#ref-for-sec-code-realms①②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-sec-code-realms">
        <a href="https://tc39.es/ecma262/#sec-code-realms">https://tc39.es/ecma262/#sec-code-realms</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-sec-code-realms">2.1. Memory measurement result</a> <a
                    href="#ref-for-sec-code-realms①">(2)</a> <a href="#ref-for-sec-code-realms②">(3)</a> <a
                    href="#ref-for-sec-code-realms③">(4)</a> <a href="#ref-for-sec-code-realms④">(5)</a>
            <li><a href="#ref-for-sec-code-realms⑤">2.2. Intermediate memory measurement</a>
            <li><a href="#ref-for-sec-code-realms⑥">2.3. Memory attribution token</a> <a
                    href="#ref-for-sec-code-realms⑦">(2)</a> <a href="#ref-for-sec-code-realms⑧">(3)</a>
            <li><a href="#ref-for-sec-code-realms⑨">3.2. Top-level algorithms</a> <a
                    href="#ref-for-sec-code-realms①⓪">(2)</a>
            <li><a href="#ref-for-sec-code-realms①①">3.3. Converting an intermediate memory measurement to the
                    result</a> <a href="#ref-for-sec-code-realms①②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-sec-agent">
        <a href="https://tc39.es/ecma262/#sec-agent">https://tc39.es/ecma262/#sec-agent</a><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-sec-agent">3.2. Top-level algorithms</a> <a href="#ref-for-sec-agent①">(2)</a> <a
                    href="#ref-for-sec-agent②">(3)</a> <a href="#ref-for-sec-agent③">(4)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-sec-performance">
        <a href="https://w3c.github.io/hr-time/#sec-performance">https://w3c.github.io/hr-time/#sec-performance</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-sec-performance">3.1. Extensions to the Performance interface</a> <a
                    href="#ref-for-sec-performance①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-dedicatedworkerglobalscope">
        <a
            href="https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope">https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dedicatedworkerglobalscope">3.4. Creating or obtaining a memory attribution token</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-htmlelement">
        <a
            href="https://html.spec.whatwg.org/multipage/dom.html#htmlelement">https://html.spec.whatwg.org/multipage/dom.html#htmlelement</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-htmlelement">3.4. Creating or obtaining a memory attribution token</a> <a
                    href="#ref-for-htmlelement①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-sharedworkerglobalscope">
        <a
            href="https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope">https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-sharedworkerglobalscope">3.2. Top-level algorithms</a>
            <li><a href="#ref-for-sharedworkerglobalscope①">3.4. Creating or obtaining a memory attribution token</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-window">
        <a
            href="https://html.spec.whatwg.org/multipage/window-object.html#window">https://html.spec.whatwg.org/multipage/window-object.html#window</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-window">3.2. Top-level algorithms</a> <a href="#ref-for-window①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-windoworworkerglobalscope">
        <a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope">https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-windoworworkerglobalscope">2.3. Memory attribution token</a>
            <li><a href="#ref-for-windoworworkerglobalscope①">4.1. Extension to WindowOrWorkerGlobalScope</a> <a
                    href="#ref-for-windoworworkerglobalscope②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-workerglobalscope">
        <a
            href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-workerglobalscope">3.4. Creating or obtaining a memory attribution token</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-window-bc">
        <a
            href="https://html.spec.whatwg.org/multipage/window-object.html#window-bc">https://html.spec.whatwg.org/multipage/window-object.html#window-bc</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-window-bc">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-browsing-context-group">
        <a
            href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-group">https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-group</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-browsing-context-group">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-concept-environment-creation-url">
        <a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-environment-creation-url">3.3. Converting an intermediate memory measurement
                    to the result</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-concept-settings-object-cross-origin-isolated-capability">
        <a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-settings-object-cross-origin-isolated-capability">2.1. Memory measurement
                    result</a>
            <li><a href="#ref-for-concept-settings-object-cross-origin-isolated-capability①">3.2. Top-level
                    algorithms</a>
            <li><a href="#ref-for-concept-settings-object-cross-origin-isolated-capability②">5.1. Cross-origin
                    information leak</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-attr-object-data">
        <a
            href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-attr-object-data">2.1. Memory measurement result</a>
            <li><a href="#ref-for-attr-object-data①">3.4. Creating or obtaining a memory attribution token</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-environment-settings-object">
        <a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-environment-settings-object">3.4. Creating or obtaining a memory attribution token</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-concept-settings-object-global">
        <a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-settings-object-global">3.4. Creating or obtaining a memory attribution
                    token</a>
            <li><a href="#ref-for-concept-settings-object-global①">4.2. Extensions to the existing algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-in-parallel">
        <a
            href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-in-parallel">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-the-object-element">
        <a
            href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-the-object-element">2.1. Memory measurement result</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-concept-settings-object-origin">
        <a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-settings-object-origin">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-dom-navigator-platform">
        <a
            href="https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-platform">https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-platform</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-navigator-platform">5.2. Fingerprinting</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-queue-a-global-task">
        <a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-queue-a-global-task">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-concept-relevant-global">
        <a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-relevant-global">3.2. Top-level algorithms</a>
            <li><a href="#ref-for-concept-relevant-global①">4.2. Extensions to the existing algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-relevant-settings-object">
        <a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-relevant-settings-object">4.2. Extensions to the existing algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-concept-realm-settings-object">
        <a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-realm-settings-object">3.2. Top-level algorithms</a> <a
                    href="#ref-for-concept-realm-settings-object①">(2)</a>
            <li><a href="#ref-for-concept-realm-settings-object②">3.3. Converting an intermediate memory measurement to
                    the result</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-attr-iframe-src">
        <a
            href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-src">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-src</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-attr-iframe-src">3.4. Creating or obtaining a memory attribution token</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-concept-environment-top-level-origin">
        <a
            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-concept-environment-top-level-origin">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-dom-navigator-useragent">
        <a
            href="https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-useragent">https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-useragent</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-navigator-useragent">5.2. Fingerprinting</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-list-append">
        <a href="https://infra.spec.whatwg.org/#list-append">https://infra.spec.whatwg.org/#list-append</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-list-append">3.3. Converting an intermediate memory measurement to the result</a> <a
                    href="#ref-for-list-append①">(2)</a> <a href="#ref-for-list-append②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-assert">
        <a href="https://infra.spec.whatwg.org/#assert">https://infra.spec.whatwg.org/#assert</a><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-assert">3.2. Top-level algorithms</a>
            <li><a href="#ref-for-assert①">3.4. Creating or obtaining a memory attribution token</a> <a
                    href="#ref-for-assert②">(2)</a> <a href="#ref-for-assert③">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-boolean">
        <a href="https://infra.spec.whatwg.org/#boolean">https://infra.spec.whatwg.org/#boolean</a><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-boolean">2.3. Memory attribution token</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-list-iterate">
        <a href="https://infra.spec.whatwg.org/#list-iterate">https://infra.spec.whatwg.org/#list-iterate</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-list-iterate">3.3. Converting an intermediate memory measurement to the result</a> <a
                    href="#ref-for-list-iterate①">(2)</a> <a href="#ref-for-list-iterate②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-map-getting-the-values">
        <a
            href="https://infra.spec.whatwg.org/#map-getting-the-values">https://infra.spec.whatwg.org/#map-getting-the-values</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-map-getting-the-values">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-implementation-defined">
        <a
            href="https://infra.spec.whatwg.org/#implementation-defined">https://infra.spec.whatwg.org/#implementation-defined</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-implementation-defined">2.1. Memory measurement result</a>
            <li><a href="#ref-for-implementation-defined①">2.2. Intermediate memory measurement</a> <a
                    href="#ref-for-implementation-defined②">(2)</a>
            <li><a href="#ref-for-implementation-defined③">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-struct-item">
        <a href="https://infra.spec.whatwg.org/#struct-item">https://infra.spec.whatwg.org/#struct-item</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-struct-item">2.2. Intermediate memory measurement</a>
            <li><a href="#ref-for-struct-item①">2.3. Memory attribution token</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-list">
        <a href="https://infra.spec.whatwg.org/#list">https://infra.spec.whatwg.org/#list</a><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-list">3.3. Converting an intermediate memory measurement to the result</a> <a
                    href="#ref-for-list①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-ordered-set">
        <a href="https://infra.spec.whatwg.org/#ordered-set">https://infra.spec.whatwg.org/#ordered-set</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-ordered-set">2.2. Intermediate memory measurement</a> <a
                    href="#ref-for-ordered-set①">(2)</a> <a href="#ref-for-ordered-set②">(3)</a>
            <li><a href="#ref-for-ordered-set③">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-string">
        <a href="https://infra.spec.whatwg.org/#string">https://infra.spec.whatwg.org/#string</a><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-string">2.2. Intermediate memory measurement</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-struct">
        <a href="https://infra.spec.whatwg.org/#struct">https://infra.spec.whatwg.org/#struct</a><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-struct">2.2. Intermediate memory measurement</a>
            <li><a href="#ref-for-struct①">2.3. Memory attribution token</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-serviceworkerglobalscope">
        <a
            href="https://w3c.github.io/ServiceWorker/#serviceworkerglobalscope">https://w3c.github.io/ServiceWorker/#serviceworkerglobalscope</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-serviceworkerglobalscope">3.2. Top-level algorithms</a>
            <li><a href="#ref-for-serviceworkerglobalscope①">3.4. Creating or obtaining a memory attribution token</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-idl-DOMException">
        <a
            href="https://heycam.github.io/webidl/#idl-DOMException">https://heycam.github.io/webidl/#idl-DOMException</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-idl-DOMException">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-idl-DOMString">
        <a href="https://heycam.github.io/webidl/#idl-DOMString">https://heycam.github.io/webidl/#idl-DOMString</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-idl-DOMString">2.1. Memory measurement result</a> <a
                    href="#ref-for-idl-DOMString①">(2)</a> <a href="#ref-for-idl-DOMString②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-Exposed">
        <a href="https://heycam.github.io/webidl/#Exposed">https://heycam.github.io/webidl/#Exposed</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-Exposed">3.1. Extensions to the Performance interface</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-idl-promise">
        <a href="https://heycam.github.io/webidl/#idl-promise">https://heycam.github.io/webidl/#idl-promise</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-idl-promise">1.1. Examples</a>
            <li><a href="#ref-for-idl-promise①">2.1. Memory measurement result</a>
            <li><a href="#ref-for-idl-promise②">3.1. Extensions to the Performance interface</a>
            <li><a href="#ref-for-idl-promise③">3.2. Top-level algorithms</a> <a href="#ref-for-idl-promise④">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-securityerror">
        <a href="https://heycam.github.io/webidl/#securityerror">https://heycam.github.io/webidl/#securityerror</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-securityerror">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-idl-USVString">
        <a href="https://heycam.github.io/webidl/#idl-USVString">https://heycam.github.io/webidl/#idl-USVString</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-idl-USVString">2.1. Memory measurement result</a> <a
                    href="#ref-for-idl-USVString①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-a-promise-rejected-with">
        <a
            href="https://heycam.github.io/webidl/#a-promise-rejected-with">https://heycam.github.io/webidl/#a-promise-rejected-with</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-a-promise-rejected-with">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-dfn-identifier">
        <a href="https://heycam.github.io/webidl/#dfn-identifier">https://heycam.github.io/webidl/#dfn-identifier</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dfn-identifier">3.3. Converting an intermediate memory measurement to the result</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-dfn-interface">
        <a href="https://heycam.github.io/webidl/#dfn-interface">https://heycam.github.io/webidl/#dfn-interface</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dfn-interface">3.3. Converting an intermediate memory measurement to the result</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-resolve">
        <a href="https://heycam.github.io/webidl/#resolve">https://heycam.github.io/webidl/#resolve</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-resolve">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-idl-sequence">
        <a href="https://heycam.github.io/webidl/#idl-sequence">https://heycam.github.io/webidl/#idl-sequence</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-idl-sequence">2.1. Memory measurement result</a> <a
                    href="#ref-for-idl-sequence①">(2)</a> <a href="#ref-for-idl-sequence②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="term-for-idl-unsigned-long-long">
        <a
            href="https://heycam.github.io/webidl/#idl-unsigned-long-long">https://heycam.github.io/webidl/#idl-unsigned-long-long</a><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-idl-unsigned-long-long">2.1. Memory measurement result</a> <a
                    href="#ref-for-idl-unsigned-long-long①">(2)</a>
        </ul>
    </aside>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">引用定义的术语</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[DOM]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="term-for-concept-element-local-name">本地名（local name）</span>
            </ul>
        <li>
            <a data-link-type="biblio">[ECMASCRIPT]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="term-for-sec-agents">agent</span>
                <li><span class="dfn-paneled" id="term-for-sec-agent-clusters">agent cluster <small>（属于
                            agent）</small></span>
                <li><span class="dfn-paneled" id="term-for-sec-code-realms">JavaScript 域（realm）</span>
                <li><span class="dfn-paneled" id="term-for-sec-code-realms①">JavaScript 域们（realms）</span>
                <li><span class="dfn-paneled" id="term-for-sec-agent">当前 Realm（the current realm）</span>
            </ul>
        <li>
            <a data-link-type="biblio">[hr-time-2]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="term-for-sec-performance">Performance</span>
            </ul>
        <li>
            <a data-link-type="biblio">[HTML]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="term-for-dedicatedworkerglobalscope">DedicatedWorkerGlobalScope</span>
                <li><span class="dfn-paneled" id="term-for-htmlelement">HTMLElement</span>
                <li><span class="dfn-paneled" id="term-for-sharedworkerglobalscope">SharedWorkerGlobalScope</span>
                <li><span class="dfn-paneled" id="term-for-window">Window</span>
                <li><span class="dfn-paneled" id="term-for-windoworworkerglobalscope">WindowOrWorkerGlobalScope</span>
                <li><span class="dfn-paneled" id="term-for-workerglobalscope">WorkerGlobalScope</span>
                <li><span class="dfn-paneled" id="term-for-window-bc">浏览上下文（browsing context）</span>
                <li><span class="dfn-paneled" id="term-for-browsing-context-group">浏览上下文组（browsing context group）</span>
                <li><span class="dfn-paneled" id="term-for-concept-environment-creation-url">创建 URL（creation url）</span>
                <li><span class="dfn-paneled"
                        id="term-for-concept-settings-object-cross-origin-isolated-capability">跨域隔离能力（cross-origin
                        isolated capability）</span>
                <li><span class="dfn-paneled" id="term-for-attr-object-data">data</span>
                <li><span class="dfn-paneled" id="term-for-environment-settings-object">环境设置对象（environment settings
                        object）</span>
                <li><span class="dfn-paneled" id="term-for-concept-settings-object-global">全局对象（global object，属于
                        environment settings object）</span>
                <li><span class="dfn-paneled" id="term-for-in-parallel">并行（in parallel）</span>
                <li><span class="dfn-paneled" id="term-for-the-object-element">object</span>
                <li><span class="dfn-paneled" id="term-for-concept-settings-object-origin">origin（属于 environment
                        settings object）</span>
                <li><span class="dfn-paneled" id="term-for-dom-navigator-platform">platform</span>
                <li><span class="dfn-paneled" id="term-for-queue-a-global-task">queue a global task</span>
                <li><span class="dfn-paneled" id="term-for-concept-relevant-global">relevant global object</span>
                <li><span class="dfn-paneled" id="term-for-relevant-settings-object">relevant settings object</span>
                <li><span class="dfn-paneled" id="term-for-concept-realm-settings-object">settings object</span>
                <li><span class="dfn-paneled" id="term-for-attr-iframe-src">src</span>
                <li><span class="dfn-paneled" id="term-for-concept-environment-top-level-origin">顶级 origin（top-level
                        origin）</span>
                <li><span class="dfn-paneled" id="term-for-dom-navigator-useragent">userAgent</span>
            </ul>
        <li>
            <a data-link-type="biblio">[INFRA]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="term-for-list-append">append</span>
                <li><span class="dfn-paneled" id="term-for-assert">assert</span>
                <li><span class="dfn-paneled" id="term-for-boolean">boolean</span>
                <li><span class="dfn-paneled" id="term-for-list-iterate">for each</span>
                <li><span class="dfn-paneled" id="term-for-map-getting-the-values">getting the values</span>
                <li><span class="dfn-paneled" id="term-for-implementation-defined">implementation-defined</span>
                <li><span class="dfn-paneled" id="term-for-struct-item">item</span>
                <li><span class="dfn-paneled" id="term-for-list">list</span>
                <li><span class="dfn-paneled" id="term-for-ordered-set">set</span>
                <li><span class="dfn-paneled" id="term-for-string">string</span>
                <li><span class="dfn-paneled" id="term-for-struct">struct</span>
            </ul>
        <li>
            <a data-link-type="biblio">[service-workers-1]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="term-for-serviceworkerglobalscope">ServiceWorkerGlobalScope</span>
            </ul>
        <li>
            <a data-link-type="biblio">[WebIDL]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="term-for-idl-DOMException">DOMException</span>
                <li><span class="dfn-paneled" id="term-for-idl-DOMString">DOMString</span>
                <li><span class="dfn-paneled" id="term-for-Exposed">Exposed</span>
                <li><span class="dfn-paneled" id="term-for-idl-promise">Promise</span>
                <li><span class="dfn-paneled" id="term-for-securityerror">SecurityError</span>
                <li><span class="dfn-paneled" id="term-for-idl-USVString">USVString</span>
                <li><span class="dfn-paneled" id="term-for-a-promise-rejected-with">a promise rejected with</span>
                <li><span class="dfn-paneled" id="term-for-dfn-identifier">identifier</span>
                <li><span class="dfn-paneled" id="term-for-dfn-interface">interface</span>
                <li><span class="dfn-paneled" id="term-for-resolve">resolve</span>
                <li><span class="dfn-paneled" id="term-for-idl-sequence">sequence</span>
                <li><span class="dfn-paneled" id="term-for-idl-unsigned-long-long">unsigned long long</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">规范性引用</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-dom">[DOM]
        <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM 标准</a>. 实时标准. URL: <a
                href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
        <dt id="biblio-ecmascript">[ECMASCRIPT]
        <dd><a href="https://tc39.es/ecma262/">ECMAScript 语言规范</a>. URL: <a
                href="https://tc39.es/ecma262/">https://tc39.es/ecma262/</a>
        <dt id="biblio-hr-time-2">[HR-TIME-2]
        <dd>Ilya Grigorik. <a href="https://w3c.github.io/hr-time/">高精度计时 Level 2</a>. URL: <a
                href="https://w3c.github.io/hr-time/">https://w3c.github.io/hr-time/</a>
        <dt id="biblio-html">[HTML]
        <dd>Anne van Kesteren; 等. <a href="https://html.spec.whatwg.org/multipage/">HTML 标准</a>. 实时标准. URL: <a
                href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        <dt id="biblio-infra">[INFRA]
        <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/">Infra 标准</a>. 实时标准. URL: <a
                href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
        <dt id="biblio-service-workers-1">[SERVICE-WORKERS-1]
        <dd>Alex Russell; 等. <a href="https://w3c.github.io/ServiceWorker/">Service Workers 1</a>. URL: <a
                href="https://w3c.github.io/ServiceWorker/">https://w3c.github.io/ServiceWorker/</a>
        <dt id="biblio-webidl">[WebIDL]
        <dd>Boris Zbarsky. <a href="https://heycam.github.io/webidl/">Web IDL</a>. URL: <a
                href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
    </dl>
    <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL 索引</span><a class="self-link"
            href="#idl-index"></a></h2>
    <pre class="idl highlight def"><c- b>dictionary</c-> <a href="#dictdef-memorymeasurement"><code><c- g>MemoryMeasurement</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a data-type="unsigned long long " href="#dom-memorymeasurement-bytes"><code><c- g>bytes</c-></code></a>;
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-memorybreakdownentry"><c- n>MemoryBreakdownEntry</c-></a>> <a data-type="sequence<MemoryBreakdownEntry> " href="#dom-memorymeasurement-breakdown"><code><c- g>breakdown</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-memorybreakdownentry"><code><c- g>MemoryBreakdownEntry</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a data-type="unsigned long long " href="#dom-memorybreakdownentry-bytes"><code><c- g>bytes</c-></code></a>;
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-memoryattribution"><c- n>MemoryAttribution</c-></a>> <a data-type="sequence<MemoryAttribution> " href="#dom-memorybreakdownentry-attribution"><code><c- g>attribution</c-></code></a>;
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString"><c- b>DOMString</c-></a>> <a data-type="sequence<DOMString> " href="#dom-memorybreakdownentry-types"><code><c- g>types</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-memoryattribution"><code><c- g>MemoryAttribution</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-memoryattribution-url"><code><c- g>url</c-></code></a>;
  <a data-link-type="idl-name" href="#dictdef-memoryattributioncontainer"><c- n>MemoryAttributionContainer</c-></a> <a data-type="MemoryAttributionContainer " href="#dom-memoryattribution-container"><code><c- g>container</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-memoryattribution-scope"><code><c- g>scope</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-memoryattributioncontainer"><code><c- g>MemoryAttributionContainer</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-memoryattributioncontainer-id"><code><c- g>id</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-memoryattributioncontainer-src"><code><c- g>src</c-></code></a>;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/hr-time/#sec-performance"><c- g>Performance</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>ServiceWorker</c->,<c- n>SharedWorker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://github.com/heycam/webidl#pull/883"><c- g>CrossOriginIsolated</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-memorymeasurement"><c- n>MemoryMeasurement</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-performance-measureuseragentspecificmemory"><c- g>measureUserAgentSpecificMemory</c-></a>();
};

</pre>
    <aside class="dfn-panel" data-for="dictdef-memorymeasurement">
        <b><a href="#dictdef-memorymeasurement">#dictdef-memorymeasurement</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dictdef-memorymeasurement">2.1. Memory measurement result</a>
            <li><a href="#ref-for-dictdef-memorymeasurement①">2.2. Intermediate memory measurement</a>
            <li><a href="#ref-for-dictdef-memorymeasurement②">3.1. Extensions to the Performance interface</a>
            <li><a href="#ref-for-dictdef-memorymeasurement③">3.3. Converting an intermediate memory measurement to the
                    result</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-memorymeasurement-bytes">
        <b><a href="#dom-memorymeasurement-bytes">#dom-memorymeasurement-bytes</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-memorymeasurement-bytes">2.1. Memory measurement result</a> <a
                    href="#ref-for-dom-memorymeasurement-bytes①">(2)</a>
            <li><a href="#ref-for-dom-memorymeasurement-bytes②">3.3. Converting an intermediate memory measurement to
                    the result</a>
            <li><a href="#ref-for-dom-memorymeasurement-bytes③">5.1. Cross-origin information leak</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-memorymeasurement-breakdown">
        <b><a href="#dom-memorymeasurement-breakdown">#dom-memorymeasurement-breakdown</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-memorymeasurement-breakdown">2.1. Memory measurement result</a>
            <li><a href="#ref-for-dom-memorymeasurement-breakdown①">3.3. Converting an intermediate memory measurement
                    to the result</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dictdef-memorybreakdownentry">
        <b><a href="#dictdef-memorybreakdownentry">#dictdef-memorybreakdownentry</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dictdef-memorybreakdownentry">2.1. Memory measurement result</a>
            <li><a href="#ref-for-dictdef-memorybreakdownentry①">3.3. Converting an intermediate memory measurement to
                    the result</a> <a href="#ref-for-dictdef-memorybreakdownentry②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-memorybreakdownentry-bytes">
        <b><a href="#dom-memorybreakdownentry-bytes">#dom-memorybreakdownentry-bytes</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-memorybreakdownentry-bytes">2.1. Memory measurement result</a>
            <li><a href="#ref-for-dom-memorybreakdownentry-bytes①">3.3. Converting an intermediate memory measurement to
                    the result</a> <a href="#ref-for-dom-memorybreakdownentry-bytes②">(2)</a>
            <li><a href="#ref-for-dom-memorybreakdownentry-bytes③">5.1. Cross-origin information leak</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-memorybreakdownentry-attribution">
        <b><a href="#dom-memorybreakdownentry-attribution">#dom-memorybreakdownentry-attribution</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-memorybreakdownentry-attribution">2.1. Memory measurement result</a>
            <li><a href="#ref-for-dom-memorybreakdownentry-attribution①">3.3. Converting an intermediate memory
                    measurement to the result</a> <a href="#ref-for-dom-memorybreakdownentry-attribution②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-memorybreakdownentry-types">
        <b><a href="#dom-memorybreakdownentry-types">#dom-memorybreakdownentry-types</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-memorybreakdownentry-types">2.1. Memory measurement result</a>
            <li><a href="#ref-for-dom-memorybreakdownentry-types①">3.3. Converting an intermediate memory measurement to
                    the result</a> <a href="#ref-for-dom-memorybreakdownentry-types②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dictdef-memoryattribution">
        <b><a href="#dictdef-memoryattribution">#dictdef-memoryattribution</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dictdef-memoryattribution">2.1. Memory measurement result</a>
            <li><a href="#ref-for-dictdef-memoryattribution①">3.3. Converting an intermediate memory measurement to the
                    result</a> <a href="#ref-for-dictdef-memoryattribution②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-memoryattribution-url">
        <b><a href="#dom-memoryattribution-url">#dom-memoryattribution-url</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-memoryattribution-url">2.1. Memory measurement result</a>
            <li><a href="#ref-for-dom-memoryattribution-url①">3.3. Converting an intermediate memory measurement to the
                    result</a> <a href="#ref-for-dom-memoryattribution-url②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-memoryattribution-container">
        <b><a href="#dom-memoryattribution-container">#dom-memoryattribution-container</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-memoryattribution-container">2.1. Memory measurement result</a>
            <li><a href="#ref-for-dom-memoryattribution-container①">3.3. Converting an intermediate memory measurement
                    to the result</a> <a href="#ref-for-dom-memoryattribution-container②">(2)</a> <a
                    href="#ref-for-dom-memoryattribution-container③">(3)</a> <a
                    href="#ref-for-dom-memoryattribution-container④">(4)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-memoryattribution-scope">
        <b><a href="#dom-memoryattribution-scope">#dom-memoryattribution-scope</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-memoryattribution-scope">2.1. Memory measurement result</a>
            <li><a href="#ref-for-dom-memoryattribution-scope①">3.3. Converting an intermediate memory measurement to
                    the result</a> <a href="#ref-for-dom-memoryattribution-scope②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dictdef-memoryattributioncontainer">
        <b><a href="#dictdef-memoryattributioncontainer">#dictdef-memoryattributioncontainer</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dictdef-memoryattributioncontainer">2.1. Memory measurement result</a>
            <li><a href="#ref-for-dictdef-memoryattributioncontainer①">2.3. Memory attribution token</a>
            <li><a href="#ref-for-dictdef-memoryattributioncontainer②">3.4. Creating or obtaining a memory attribution
                    token</a> <a href="#ref-for-dictdef-memoryattributioncontainer③">(2)</a> <a
                    href="#ref-for-dictdef-memoryattributioncontainer④">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-memoryattributioncontainer-id">
        <b><a href="#dom-memoryattributioncontainer-id">#dom-memoryattributioncontainer-id</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-memoryattributioncontainer-id">2.1. Memory measurement result</a>
            <li><a href="#ref-for-dom-memoryattributioncontainer-id①">3.4. Creating or obtaining a memory attribution
                    token</a> <a href="#ref-for-dom-memoryattributioncontainer-id②">(2)</a> <a
                    href="#ref-for-dom-memoryattributioncontainer-id③">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-memoryattributioncontainer-src">
        <b><a href="#dom-memoryattributioncontainer-src">#dom-memoryattributioncontainer-src</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-memoryattributioncontainer-src">2.1. Memory measurement result</a>
            <li><a href="#ref-for-dom-memoryattributioncontainer-src①">3.4. Creating or obtaining a memory attribution
                    token</a> <a href="#ref-for-dom-memoryattributioncontainer-src②">(2)</a> <a
                    href="#ref-for-dom-memoryattributioncontainer-src③">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="intermediate-memory-measurement">
        <b><a href="#intermediate-memory-measurement">#intermediate-memory-measurement</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-intermediate-memory-measurement">2.2. Intermediate memory measurement</a>
            <li><a href="#ref-for-intermediate-memory-measurement①">3.2. Top-level algorithms</a>
            <li><a href="#ref-for-intermediate-memory-measurement②">3.3. Converting an intermediate memory measurement
                    to the result</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="intermediate-memory-breakdown-entry">
        <b><a href="#intermediate-memory-breakdown-entry">#intermediate-memory-breakdown-entry</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-intermediate-memory-breakdown-entry">2.2. Intermediate memory measurement</a> <a
                    href="#ref-for-intermediate-memory-breakdown-entry①">(2)</a>
            <li><a href="#ref-for-intermediate-memory-breakdown-entry②">3.3. Converting an intermediate memory
                    measurement to the result</a> <a href="#ref-for-intermediate-memory-breakdown-entry③">(2)</a> <a
                    href="#ref-for-intermediate-memory-breakdown-entry④">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="intermediate-memory-breakdown-entry-bytes">
        <b><a
                href="#intermediate-memory-breakdown-entry-bytes">#intermediate-memory-breakdown-entry-bytes</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-intermediate-memory-breakdown-entry-bytes">3.3. Converting an intermediate memory
                    measurement to the result</a> <a href="#ref-for-intermediate-memory-breakdown-entry-bytes①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="intermediate-memory-breakdown-entry-realms">
        <b><a
                href="#intermediate-memory-breakdown-entry-realms">#intermediate-memory-breakdown-entry-realms</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-intermediate-memory-breakdown-entry-realms">3.3. Converting an intermediate memory
                    measurement to the result</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="intermediate-memory-breakdown-entry-types">
        <b><a
                href="#intermediate-memory-breakdown-entry-types">#intermediate-memory-breakdown-entry-types</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-intermediate-memory-breakdown-entry-types">3.3. Converting an intermediate memory
                    measurement to the result</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="memory-attribution-token">
        <b><a href="#memory-attribution-token">#memory-attribution-token</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-memory-attribution-token">3.4. Creating or obtaining a memory attribution token</a> <a
                    href="#ref-for-memory-attribution-token①">(2)</a> <a
                    href="#ref-for-memory-attribution-token②">(3)</a> <a
                    href="#ref-for-memory-attribution-token③">(4)</a> <a
                    href="#ref-for-memory-attribution-token④">(5)</a>
            <li><a href="#ref-for-memory-attribution-token⑤">4.1. Extension to WindowOrWorkerGlobalScope</a>
            <li><a href="#ref-for-memory-attribution-token⑥">4.2. Extensions to the existing algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="memory-attribution-token-container">
        <b><a href="#memory-attribution-token-container">#memory-attribution-token-container</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-memory-attribution-token-container">3.3. Converting an intermediate memory measurement
                    to the result</a> <a href="#ref-for-memory-attribution-token-container①">(2)</a>
            <li><a href="#ref-for-memory-attribution-token-container②">3.4. Creating or obtaining a memory attribution
                    token</a> <a href="#ref-for-memory-attribution-token-container③">(2)</a> <a
                    href="#ref-for-memory-attribution-token-container④">(3)</a> <a
                    href="#ref-for-memory-attribution-token-container⑤">(4)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="memory-attribution-token-cross-origin-aggregated-flag">
        <b><a
                href="#memory-attribution-token-cross-origin-aggregated-flag">#memory-attribution-token-cross-origin-aggregated-flag</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-memory-attribution-token-cross-origin-aggregated-flag">3.3. Converting an intermediate
                    memory measurement to the result</a>
            <li><a href="#ref-for-memory-attribution-token-cross-origin-aggregated-flag①">3.4. Creating or obtaining a
                    memory attribution token</a> <a
                    href="#ref-for-memory-attribution-token-cross-origin-aggregated-flag②">(2)</a> <a
                    href="#ref-for-memory-attribution-token-cross-origin-aggregated-flag③">(3)</a> <a
                    href="#ref-for-memory-attribution-token-cross-origin-aggregated-flag④">(4)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-performance-measureuseragentspecificmemory">
        <b><a
                href="#dom-performance-measureuseragentspecificmemory">#dom-performance-measureuseragentspecificmemory</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-performance-measureuseragentspecificmemory">1. Introduction</a>
            <li><a href="#ref-for-dom-performance-measureuseragentspecificmemory①">1.1. Examples</a> <a
                    href="#ref-for-dom-performance-measureuseragentspecificmemory②">(2)</a>
            <li><a href="#ref-for-dom-performance-measureuseragentspecificmemory③">2.1. Memory measurement result</a>
            <li><a href="#ref-for-dom-performance-measureuseragentspecificmemory④">3.1. Extensions to the Performance
                    interface</a> <a href="#ref-for-dom-performance-measureuseragentspecificmemory⑤">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="memory-measurement-allowed-predicate">
        <b><a href="#memory-measurement-allowed-predicate">#memory-measurement-allowed-predicate</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-memory-measurement-allowed-predicate">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="getting-all-agent-clusters">
        <b><a href="#getting-all-agent-clusters">#getting-all-agent-clusters</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-getting-all-agent-clusters">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="implementation-defined-memory-measurement">
        <b><a
                href="#implementation-defined-memory-measurement">#implementation-defined-memory-measurement</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-implementation-defined-memory-measurement">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="creating-a-new-memory-measurement">
        <b><a href="#creating-a-new-memory-measurement">#creating-a-new-memory-measurement</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-creating-a-new-memory-measurement">3.2. Top-level algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="creating-a-new-memory-breakdown-entry">
        <b><a href="#creating-a-new-memory-breakdown-entry">#creating-a-new-memory-breakdown-entry</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-creating-a-new-memory-breakdown-entry">3.3. Converting an intermediate memory
                    measurement to the result</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="creating-a-new-memory-attribution">
        <b><a href="#creating-a-new-memory-attribution">#creating-a-new-memory-attribution</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-creating-a-new-memory-attribution">3.3. Converting an intermediate memory measurement
                    to the result</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="obtain-a-window-memory-attribution-token">
        <b><a
                href="#obtain-a-window-memory-attribution-token">#obtain-a-window-memory-attribution-token</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-obtain-a-window-memory-attribution-token">4.2. Extensions to the existing
                    algorithms</a> <a href="#ref-for-obtain-a-window-memory-attribution-token①">(2)</a> <a
                    href="#ref-for-obtain-a-window-memory-attribution-token②">(3)</a> <a
                    href="#ref-for-obtain-a-window-memory-attribution-token③">(4)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="obtain-a-worker-memory-attribution-token">
        <b><a
                href="#obtain-a-worker-memory-attribution-token">#obtain-a-worker-memory-attribution-token</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-obtain-a-worker-memory-attribution-token">4.2. Extensions to the existing
                    algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="extract-container-element-attributes">
        <b><a href="#extract-container-element-attributes">#extract-container-element-attributes</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-extract-container-element-attributes">3.4. Creating or obtaining a memory attribution
                    token</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="windoworworkerglobalscope-memory-attribution-token">
        <b><a
                href="#windoworworkerglobalscope-memory-attribution-token">#windoworworkerglobalscope-memory-attribution-token</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-windoworworkerglobalscope-memory-attribution-token">3.3. Converting an intermediate
                    memory measurement to the result</a>
            <li><a href="#ref-for-windoworworkerglobalscope-memory-attribution-token①">3.4. Creating or obtaining a
                    memory attribution token</a>
            <li><a href="#ref-for-windoworworkerglobalscope-memory-attribution-token②">4.2. Extensions to the existing
                    algorithms</a> <a href="#ref-for-windoworworkerglobalscope-memory-attribution-token③">(2)</a> <a
                    href="#ref-for-windoworworkerglobalscope-memory-attribution-token④">(3)</a> <a
                    href="#ref-for-windoworworkerglobalscope-memory-attribution-token⑤">(4)</a> <a
                    href="#ref-for-windoworworkerglobalscope-memory-attribution-token⑥">(5)</a> <a
                    href="#ref-for-windoworworkerglobalscope-memory-attribution-token⑦">(6)</a> <a
                    href="#ref-for-windoworworkerglobalscope-memory-attribution-token⑧">(7)</a> <a
                    href="#ref-for-windoworworkerglobalscope-memory-attribution-token⑨">(8)</a>
        </ul>
    </aside>
    <script>/* script-dfn-panel */

        document.body.addEventListener("click", function (e) {
            var queryAll = function (sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            var hitALink = false;
            while (el.parentElement) {
                if (el.tagName == "A") {
                    // Clicking on a link in a <dfn> shouldn't summon the panel
                    hitALink = true;
                }
                if (el.classList.contains("dfn-paneled")) {
                    target = "dfn";
                    break;
                }
                if (el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if (target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function (el) {
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if (target == "dfn" && !hitALink) {
                // open the panel
                var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
                if (dfnPanel) {
                    dfnPanel.classList.add("on");
                    var rect = el.getBoundingClientRect();
                    dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
                    dfnPanel.style.top = window.scrollY + rect.top + "px";
                    var panelRect = dfnPanel.getBoundingClientRect();
                    var panelWidth = panelRect.right - panelRect.left;
                    if (panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                        // Reposition, because the panel is overflowing
                        dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
                    }
                } else {
                    console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
                }
            } else if (target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
                el.style.left = null;
                el.style.top = null;
            }

        });
    </script>
    <script>/* script-var-click-highlighting */

        document.addEventListener("click", e => {
            if (e.target.nodeName == "VAR") {
                highlightSameAlgoVars(e.target);
            }
        });
        {
            const indexCounts = new Map();
            const indexNames = new Map();
            function highlightSameAlgoVars(v) {
                // Find the algorithm container.
                let algoContainer = null;
                let searchEl = v;
                while (algoContainer == null && searchEl != document.body) {
                    searchEl = searchEl.parentNode;
                    if (searchEl.hasAttribute("data-algorithm")) {
                        algoContainer = searchEl;
                    }
                }

                // Not highlighting document-global vars,
                // too likely to be unrelated.
                if (algoContainer == null) return;

                const algoName = algoContainer.getAttribute("data-algorithm");
                const varName = getVarName(v);
                const addClass = !v.classList.contains("selected");
                let highlightClass = null;
                if (addClass) {
                    const index = chooseHighlightIndex(algoName, varName);
                    indexCounts.get(algoName)[index] += 1;
                    indexNames.set(algoName + "///" + varName, index);
                    highlightClass = nameFromIndex(index);
                } else {
                    const index = previousHighlightIndex(algoName, varName);
                    indexCounts.get(algoName)[index] -= 1;
                    highlightClass = nameFromIndex(index);
                }

                // Find all same-name vars, and toggle their class appropriately.
                for (const el of algoContainer.querySelectorAll("var")) {
                    if (getVarName(el) == varName) {
                        el.classList.toggle("selected", addClass);
                        el.classList.toggle(highlightClass, addClass);
                    }
                }
            }
            function getVarName(el) {
                return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
            }
            function chooseHighlightIndex(algoName, varName) {
                let indexes = null;
                if (indexCounts.has(algoName)) {
                    indexes = indexCounts.get(algoName);
                } else {
                    // 7 classes right now
                    indexes = [0, 0, 0, 0, 0, 0, 0];
                    indexCounts.set(algoName, indexes);
                }

                // If the element was recently unclicked,
                // *and* that color is still unclaimed,
                // give it back the same color.
                const lastIndex = previousHighlightIndex(algoName, varName);
                if (indexes[lastIndex] === 0) return lastIndex;

                // Find the earliest index with the lowest count.
                const minCount = Math.min.apply(null, indexes);
                let index = null;
                for (var i = 0; i < indexes.length; i++) {
                    if (indexes[i] == minCount) {
                        return i;
                    }
                }
            }
            function previousHighlightIndex(algoName, varName) {
                return indexNames.get(algoName + "///" + varName);
            }
            function nameFromIndex(index) {
                return "selected" + index;
            }
        }
    </script>
    <script src="/dropdown.js"></script>