<!doctype html>
<html lang="en">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>CSS View Transitions Module Level 2</title>
    <meta content="WD" name="w3c-status">
    <meta content="Bikeshed version d5d58a306, updated Fri Jan 26 16:12:28 2024 -0800" name="generator">
    <link href="https://www.w3.org/TR/css-view-transitions-2/" rel="canonical">
    <meta content="f0de23017382a3a5100164410e2b4b48a871076f" name="revision">
    <style>
        spec-scaler {
            display: block;
        }

        spec-scaler:not(:defined)>* {
            display: none;
        }

        .spec-slides {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }

        .spec-slide-controls {
            text-align: center;
        }

        .main-example-video {
            display: block;
            width: 100%;
            max-width: 702px;
            height: auto;
            margin: 0 auto;
        }

        /* Put nice boxes around each algorithm. */
        [data-algorithm]:not(.heading) {
            padding: .5em;
            border: thin solid #ddd;
            border-radius: .5em;
            margin: .5em calc(-0.5em - 1px);
        }

        [data-algorithm]:not(.heading)> :first-child {
            margin-top: 0;
        }

        [data-algorithm]:not(.heading)> :last-child {
            margin-bottom: 0;
        }

        [data-algorithm] [data-algorithm] {
            margin: 1em 0;
        }

        pre {
            tab-size: 2;
        }
    </style>
    <style>
        /* Boilerplate: style-autolinks */
        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: var(--a-normal-text);
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --selflink-text: black;
                --selflink-bg: silver;
                --selflink-hover-text: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-colors */
        /* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
        :root {
            color-scheme: light dark;

            --text: black;
            --bg: white;

            --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

            --logo-bg: #1a5e9a;
            --logo-active-bg: #c00;
            --logo-text: white;

            --tocnav-normal-text: #707070;
            --tocnav-normal-bg: var(--bg);
            --tocnav-hover-text: var(--tocnav-normal-text);
            --tocnav-hover-bg: #f8f8f8;
            --tocnav-active-text: #c00;
            --tocnav-active-bg: var(--tocnav-normal-bg);

            --tocsidebar-text: var(--text);
            --tocsidebar-bg: #f7f8f9;
            --tocsidebar-shadow: rgba(0, 0, 0, .1);
            --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

            --toclink-text: var(--text);
            --toclink-underline: #3980b5;
            --toclink-visited-text: var(--toclink-text);
            --toclink-visited-underline: #054572;

            --heading-text: #005a9c;

            --hr-text: var(--text);

            --algo-border: #def;

            --del-text: red;
            --del-bg: transparent;
            --ins-text: #080;
            --ins-bg: transparent;

            --a-normal-text: #034575;
            --a-normal-underline: #bbb;
            --a-visited-text: var(--a-normal-text);
            --a-visited-underline: #707070;
            --a-hover-bg: rgba(75%, 75%, 75%, .25);
            --a-active-text: #c00;
            --a-active-underline: #c00;

            --blockquote-border: silver;
            --blockquote-bg: transparent;
            --blockquote-text: currentcolor;

            --issue-border: #e05252;
            --issue-bg: #fbe9e9;
            --issue-text: var(--text);
            --issueheading-text: #831616;

            --example-border: #e0cb52;
            --example-bg: #fcfaee;
            --example-text: var(--text);
            --exampleheading-text: #574b0f;

            --note-border: #52e052;
            --note-bg: #e9fbe9;
            --note-text: var(--text);
            --noteheading-text: hsl(120, 70%, 30%);
            --notesummary-underline: silver;

            --assertion-border: #aaa;
            --assertion-bg: #eee;
            --assertion-text: black;

            --advisement-border: orange;
            --advisement-bg: #fec;
            --advisement-text: var(--text);
            --advisementheading-text: #b35f00;

            --warning-border: red;
            --warning-bg: hsla(40, 100%, 50%, 0.95);
            --warning-text: var(--text);

            --amendment-border: #330099;
            --amendment-bg: #F5F0FF;
            --amendment-text: var(--text);
            --amendmentheading-text: #220066;

            --def-border: #8ccbf2;
            --def-bg: #def;
            --def-text: var(--text);
            --defrow-border: #bbd7e9;

            --datacell-border: silver;

            --indexinfo-text: #707070;

            --indextable-hover-text: black;
            --indextable-hover-bg: #f7f8f9;

            --outdatedspec-bg: rgba(0, 0, 0, .5);
            --outdatedspec-text: black;
            --outdated-bg: maroon;
            --outdated-text: white;
            --outdated-shadow: red;

            --editedrec-bg: darkorange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --text: #ddd;
                --bg: black;

                --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

                --logo-bg: #1a5e9a;
                --logo-active-bg: #c00;
                --logo-text: white;

                --tocnav-normal-text: #999;
                --tocnav-normal-bg: var(--bg);
                --tocnav-hover-text: var(--tocnav-normal-text);
                --tocnav-hover-bg: #080808;
                --tocnav-active-text: #f44;
                --tocnav-active-bg: var(--tocnav-normal-bg);

                --tocsidebar-text: var(--text);
                --tocsidebar-bg: #080808;
                --tocsidebar-shadow: rgba(255, 255, 255, .1);
                --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

                --toclink-text: var(--text);
                --toclink-underline: #6af;
                --toclink-visited-text: var(--toclink-text);
                --toclink-visited-underline: #054572;

                --heading-text: #8af;

                --hr-text: var(--text);

                --algo-border: #456;

                --del-text: #f44;
                --del-bg: transparent;
                --ins-text: #4a4;
                --ins-bg: transparent;

                --a-normal-text: #6af;
                --a-normal-underline: #555;
                --a-visited-text: var(--a-normal-text);
                --a-visited-underline: var(--a-normal-underline);
                --a-hover-bg: rgba(25%, 25%, 25%, .2);
                --a-active-text: #f44;
                --a-active-underline: var(--a-active-text);

                --borderedblock-bg: rgba(255, 255, 255, .05);

                --blockquote-border: silver;
                --blockquote-bg: var(--borderedblock-bg);
                --blockquote-text: currentcolor;

                --issue-border: #e05252;
                --issue-bg: var(--borderedblock-bg);
                --issue-text: var(--text);
                --issueheading-text: hsl(0deg, 70%, 70%);

                --example-border: hsl(50deg, 90%, 60%);
                --example-bg: var(--borderedblock-bg);
                --example-text: var(--text);
                --exampleheading-text: hsl(50deg, 70%, 70%);

                --note-border: hsl(120deg, 100%, 35%);
                --note-bg: var(--borderedblock-bg);
                --note-text: var(--text);
                --noteheading-text: hsl(120, 70%, 70%);
                --notesummary-underline: silver;

                --assertion-border: #444;
                --assertion-bg: var(--borderedblock-bg);
                --assertion-text: var(--text);

                --advisement-border: orange;
                --advisement-bg: #222218;
                --advisement-text: var(--text);
                --advisementheading-text: #f84;

                --warning-border: red;
                --warning-bg: hsla(40, 100%, 20%, 0.95);
                --warning-text: var(--text);

                --amendment-border: #330099;
                --amendment-bg: #080010;
                --amendment-text: var(--text);
                --amendmentheading-text: #cc00ff;

                --def-border: #8ccbf2;
                --def-bg: #080818;
                --def-text: var(--text);
                --defrow-border: #136;

                --datacell-border: silver;

                --indexinfo-text: #aaa;

                --indextable-hover-text: var(--text);
                --indextable-hover-bg: #181818;

                --outdatedspec-bg: rgba(255, 255, 255, .5);
                --outdatedspec-text: black;
                --outdated-bg: maroon;
                --outdated-text: white;
                --outdated-shadow: red;

                --editedrec-bg: darkorange;
            }

            /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
            img {
                background: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-counters */
        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* Boilerplate: style-dfn-panel */
        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
            --dfnpanel-target-bg: #ffc;
            --dfnpanel-target-outline: orange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --dfnpanel-bg: #222;
                --dfnpanel-text: var(--text);
                --dfnpanel-target-bg: #333;
                --dfnpanel-target-outline: silver;
            }
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel a:focus {
            outline: 5px auto Highlight;
            outline: 5px auto -webkit-focus-ring-color;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0 0 0 1em;
            list-style: none;
        }

        .dfn-panel li a {
            max-width: calc(300px - 1.5em - 1em);
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: 8px;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
            transition: left 1s ease-out, bottom 1s ease-out;
        }

        .dfn-panel .link-item:hover {
            text-decoration: underline;
        }

        .dfn-panel .link-item .copy-icon {
            opacity: 0;
        }

        .dfn-panel .link-item:hover .copy-icon,
        .dfn-panel .link-item .copy-icon:focus {
            opacity: 1;
        }

        .dfn-panel .copy-icon {
            display: inline-block;
            margin-right: 0.5em;
            width: 0.85em;
            height: 1em;
            border-radius: 3px;
            background-color: #ccc;
            cursor: pointer;
        }

        .dfn-panel .copy-icon .icon {
            width: 100%;
            height: 100%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .dfn-panel .copy-icon .icon::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1px solid black;
            background-color: #ccc;
            opacity: 0.25;
            transform: translate(3px, -3px);
        }

        .dfn-panel .copy-icon:active .icon::before {
            opacity: 1;
        }

        .dfn-paneled[role="button"] {
            cursor: help;
        }

        .highlighted {
            animation: target-fade 3s;
        }

        @keyframes target-fade {
            from {
                background-color: var(--dfnpanel-target-bg);
                outline: 5px solid var(--dfnpanel-target-outline);
            }

            to {
                color: var(--a-normal-text);
                background-color: transparent;
                outline: transparent;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-idl-highlighting */
        pre.idl.highlight {
            background: var(--borderedblock-bg, var(--def-bg));
        }
    </style>
    <style>
        /* Boilerplate: style-issues */
        a[href].issue-return {
            float: right;
            float: inline-end;
            color: var(--issueheading-text);
            font-weight: bold;
            text-decoration: none;
        }
    </style>
    <style>
        /* Boilerplate: style-md-lists */
        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* Boilerplate: style-ref-hints */
        :root {
            --ref-hint-bg: #ddd;
            --ref-hint-text: var(--text);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --ref-hint-bg: #222;
                --ref-hint-text: var(--text);
            }
        }

        .ref-hint {
            display: inline-block;
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.5em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--ref-hint-bg);
            color: var(--ref-hint-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .ref-hint * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .ref-hint ul {
            padding: 0 0 0 1em;
            list-style: none;
        }
    </style>
    <style>
        /* Boilerplate: style-selflinks */
        :root {
            --selflink-text: white;
            --selflink-bg: gray;
            --selflink-hover-text: black;
        }

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        .example>a.self-link,
        .note>a.self-link,
        .issue>a.self-link {
            /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
            left: auto;
            right: 0;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: var(--selflink-bg);
            color: var(--selflink-text);
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: var(--selflink-hover-text);
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <style>
        /* Boilerplate: style-syntax-highlighting */
        code.highlight {
            padding: .1em;
            border-radius: .3em;
        }

        pre.highlight,
        pre>code.highlight {
            display: block;
            padding: 1em;
            margin: .5em 0;
            overflow: auto;
            border-radius: 0;
        }

        .highlight:not(.idl) {
            background: rgba(0, 0, 0, .03);
        }

        c-[a] {
            color: #990055
        }

        /* Keyword.Declaration */
        c-[b] {
            color: #990055
        }

        /* Keyword.Type */
        c-[c] {
            color: #708090
        }

        /* Comment */
        c-[d] {
            color: #708090
        }

        /* Comment.Multiline */
        c-[e] {
            color: #0077aa
        }

        /* Name.Attribute */
        c-[f] {
            color: #669900
        }

        /* Name.Tag */
        c-[g] {
            color: #222222
        }

        /* Name.Variable */
        c-[k] {
            color: #990055
        }

        /* Keyword */
        c-[l] {
            color: #000000
        }

        /* Literal */
        c-[m] {
            color: #000000
        }

        /* Literal.Number */
        c-[n] {
            color: #0077aa
        }

        /* Name */
        c-[o] {
            color: #999999
        }

        /* Operator */
        c-[p] {
            color: #999999
        }

        /* Punctuation */
        c-[s] {
            color: #a67f59
        }

        /* Literal.String */
        c-[t] {
            color: #a67f59
        }

        /* Literal.String.Single */
        c-[u] {
            color: #a67f59
        }

        /* Literal.String.Double */
        c-[cp] {
            color: #708090
        }

        /* Comment.Preproc */
        c-[c1] {
            color: #708090
        }

        /* Comment.Single */
        c-[cs] {
            color: #708090
        }

        /* Comment.Special */
        c-[kc] {
            color: #990055
        }

        /* Keyword.Constant */
        c-[kn] {
            color: #990055
        }

        /* Keyword.Namespace */
        c-[kp] {
            color: #990055
        }

        /* Keyword.Pseudo */
        c-[kr] {
            color: #990055
        }

        /* Keyword.Reserved */
        c-[ld] {
            color: #000000
        }

        /* Literal.Date */
        c-[nc] {
            color: #0077aa
        }

        /* Name.Class */
        c-[no] {
            color: #0077aa
        }

        /* Name.Constant */
        c-[nd] {
            color: #0077aa
        }

        /* Name.Decorator */
        c-[ni] {
            color: #0077aa
        }

        /* Name.Entity */
        c-[ne] {
            color: #0077aa
        }

        /* Name.Exception */
        c-[nf] {
            color: #0077aa
        }

        /* Name.Function */
        c-[nl] {
            color: #0077aa
        }

        /* Name.Label */
        c-[nn] {
            color: #0077aa
        }

        /* Name.Namespace */
        c-[py] {
            color: #0077aa
        }

        /* Name.Property */
        c-[ow] {
            color: #999999
        }

        /* Operator.Word */
        c-[mb] {
            color: #000000
        }

        /* Literal.Number.Bin */
        c-[mf] {
            color: #000000
        }

        /* Literal.Number.Float */
        c-[mh] {
            color: #000000
        }

        /* Literal.Number.Hex */
        c-[mi] {
            color: #000000
        }

        /* Literal.Number.Integer */
        c-[mo] {
            color: #000000
        }

        /* Literal.Number.Oct */
        c-[sb] {
            color: #a67f59
        }

        /* Literal.String.Backtick */
        c-[sc] {
            color: #a67f59
        }

        /* Literal.String.Char */
        c-[sd] {
            color: #a67f59
        }

        /* Literal.String.Doc */
        c-[se] {
            color: #a67f59
        }

        /* Literal.String.Escape */
        c-[sh] {
            color: #a67f59
        }

        /* Literal.String.Heredoc */
        c-[si] {
            color: #a67f59
        }

        /* Literal.String.Interpol */
        c-[sx] {
            color: #a67f59
        }

        /* Literal.String.Other */
        c-[sr] {
            color: #a67f59
        }

        /* Literal.String.Regex */
        c-[ss] {
            color: #a67f59
        }

        /* Literal.String.Symbol */
        c-[vc] {
            color: #0077aa
        }

        /* Name.Variable.Class */
        c-[vg] {
            color: #0077aa
        }

        /* Name.Variable.Global */
        c-[vi] {
            color: #0077aa
        }

        /* Name.Variable.Instance */
        c-[il] {
            color: #000000
        }

        /* Literal.Number.Integer.Long */

        @media (prefers-color-scheme: dark) {
            .highlight:not(.idl) {
                background: rgba(255, 255, 255, .05);
            }

            c-[a] {
                color: #d33682
            }

            /* Keyword.Declaration */
            c-[b] {
                color: #d33682
            }

            /* Keyword.Type */
            c-[c] {
                color: #2aa198
            }

            /* Comment */
            c-[d] {
                color: #2aa198
            }

            /* Comment.Multiline */
            c-[e] {
                color: #268bd2
            }

            /* Name.Attribute */
            c-[f] {
                color: #b58900
            }

            /* Name.Tag */
            c-[g] {
                color: #cb4b16
            }

            /* Name.Variable */
            c-[k] {
                color: #d33682
            }

            /* Keyword */
            c-[l] {
                color: #657b83
            }

            /* Literal */
            c-[m] {
                color: #657b83
            }

            /* Literal.Number */
            c-[n] {
                color: #268bd2
            }

            /* Name */
            c-[o] {
                color: #657b83
            }

            /* Operator */
            c-[p] {
                color: #657b83
            }

            /* Punctuation */
            c-[s] {
                color: #6c71c4
            }

            /* Literal.String */
            c-[t] {
                color: #6c71c4
            }

            /* Literal.String.Single */
            c-[u] {
                color: #6c71c4
            }

            /* Literal.String.Double */
            c-[ch] {
                color: #2aa198
            }

            /* Comment.Hashbang */
            c-[cp] {
                color: #2aa198
            }

            /* Comment.Preproc */
            c-[cpf] {
                color: #2aa198
            }

            /* Comment.PreprocFile */
            c-[c1] {
                color: #2aa198
            }

            /* Comment.Single */
            c-[cs] {
                color: #2aa198
            }

            /* Comment.Special */
            c-[kc] {
                color: #d33682
            }

            /* Keyword.Constant */
            c-[kn] {
                color: #d33682
            }

            /* Keyword.Namespace */
            c-[kp] {
                color: #d33682
            }

            /* Keyword.Pseudo */
            c-[kr] {
                color: #d33682
            }

            /* Keyword.Reserved */
            c-[ld] {
                color: #657b83
            }

            /* Literal.Date */
            c-[nc] {
                color: #268bd2
            }

            /* Name.Class */
            c-[no] {
                color: #268bd2
            }

            /* Name.Constant */
            c-[nd] {
                color: #268bd2
            }

            /* Name.Decorator */
            c-[ni] {
                color: #268bd2
            }

            /* Name.Entity */
            c-[ne] {
                color: #268bd2
            }

            /* Name.Exception */
            c-[nf] {
                color: #268bd2
            }

            /* Name.Function */
            c-[nl] {
                color: #268bd2
            }

            /* Name.Label */
            c-[nn] {
                color: #268bd2
            }

            /* Name.Namespace */
            c-[py] {
                color: #268bd2
            }

            /* Name.Property */
            c-[ow] {
                color: #657b83
            }

            /* Operator.Word */
            c-[mb] {
                color: #657b83
            }

            /* Literal.Number.Bin */
            c-[mf] {
                color: #657b83
            }

            /* Literal.Number.Float */
            c-[mh] {
                color: #657b83
            }

            /* Literal.Number.Hex */
            c-[mi] {
                color: #657b83
            }

            /* Literal.Number.Integer */
            c-[mo] {
                color: #657b83
            }

            /* Literal.Number.Oct */
            c-[sa] {
                color: #6c71c4
            }

            /* Literal.String.Affix */
            c-[sb] {
                color: #6c71c4
            }

            /* Literal.String.Backtick */
            c-[sc] {
                color: #6c71c4
            }

            /* Literal.String.Char */
            c-[dl] {
                color: #6c71c4
            }

            /* Literal.String.Delimiter */
            c-[sd] {
                color: #6c71c4
            }

            /* Literal.String.Doc */
            c-[se] {
                color: #6c71c4
            }

            /* Literal.String.Escape */
            c-[sh] {
                color: #6c71c4
            }

            /* Literal.String.Heredoc */
            c-[si] {
                color: #6c71c4
            }

            /* Literal.String.Interpol */
            c-[sx] {
                color: #6c71c4
            }

            /* Literal.String.Other */
            c-[sr] {
                color: #6c71c4
            }

            /* Literal.String.Regex */
            c-[ss] {
                color: #6c71c4
            }

            /* Literal.String.Symbol */
            c-[fm] {
                color: #268bd2
            }

            /* Name.Function.Magic */
            c-[vc] {
                color: #cb4b16
            }

            /* Name.Variable.Class */
            c-[vg] {
                color: #cb4b16
            }

            /* Name.Variable.Global */
            c-[vi] {
                color: #cb4b16
            }

            /* Name.Variable.Instance */
            c-[vm] {
                color: #cb4b16
            }

            /* Name.Variable.Magic */
            c-[il] {
                color: #657b83
            }

            /* Literal.Number.Integer.Long */
        }
    </style>
    <style>
        /* Boilerplate: style-var-click-highlighting */
        /*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)
*/
        [data-algorithm] var {
            cursor: pointer;
        }

        var[data-var-color="0"] {
            background-color: #F4D200;
            box-shadow: 0 0 0 2px #F4D200;
        }

        var[data-var-color="1"] {
            background-color: #FF87A2;
            box-shadow: 0 0 0 2px #FF87A2;
        }

        var[data-var-color="2"] {
            background-color: #96E885;
            box-shadow: 0 0 0 2px #96E885;
        }

        var[data-var-color="3"] {
            background-color: #3EEED2;
            box-shadow: 0 0 0 2px #3EEED2;
        }

        var[data-var-color="4"] {
            background-color: #EACFB6;
            box-shadow: 0 0 0 2px #EACFB6;
        }

        var[data-var-color="5"] {
            background-color: #82DDFF;
            box-shadow: 0 0 0 2px #82DDFF;
        }

        var[data-var-color="6"] {
            background-color: #FFBCF2;
            box-shadow: 0 0 0 2px #FFBCF2;
        }
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD" rel="stylesheet">

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
        <h1 class="p-name no-ref" id="title">CSS View Transitions Module Level 2</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types#FPWD">W3C First Public Working Draft</a>, <time
                class="dt-updated" datetime="2024-05-16">16 May 2024</time></p>
        <details open>
            <summary>More details about this document</summary>
            <div data-fill-with="spec-metadata">
                <dl>
                    <dt>This version:
                    <dd><a class="u-url"
                            href="https://www.w3.org/TR/2024/WD-css-view-transitions-2-20240516/">https://www.w3.org/TR/2024/WD-css-view-transitions-2-20240516/</a>
                    <dt>Latest published version:
                    <dd><a
                            href="https://www.w3.org/TR/css-view-transitions-2/">https://www.w3.org/TR/css-view-transitions-2/</a>
                    <dt>Editor's Draft:
                    <dd><a
                            href="https://drafts.csswg.org/css-view-transitions-2/">https://drafts.csswg.org/css-view-transitions-2/</a>
                    <dt>History:
                    <dd><a class="u-url"
                            href="https://www.w3.org/standards/history/css-view-transitions-2/">https://www.w3.org/standards/history/css-view-transitions-2/</a>
                    <dt>Feedback:
                    <dd><a href="https://github.com/w3c/csswg-drafts/labels/css-view-transitions-2">CSSWG Issues
                            Repository</a>
                    <dd><a href="#issues-index">Inline In Spec</a>
                    <dt class="editor">Editors:
                    <dd class="editor p-author h-card vcard" data-editor-id="121539"><span class="p-name fn">Noam
                            Rosenthal</span> (<span class="p-org org">Google</span>)
                    <dd class="editor p-author h-card vcard" data-editor-id="122787"><span class="p-name fn">Khushal
                            Sagar</span> (<span class="p-org org">Google</span>)
                    <dd class="editor p-author h-card vcard" data-editor-id="75295"><span class="p-name fn">Vladimir
                            Levin</span> (<span class="p-org org">Google</span>)
                    <dd class="editor p-author h-card vcard" data-editor-id="42199"><a class="p-name fn u-url url"
                            href="http://xanthir.com/contact/">Tab Atkins-Bittner</a> (<span
                            class="p-org org">Google</span>)
                    <dt>Suggest an Edit for this Spec:
                    <dd><a href="https://github.com/w3c/csswg-drafts/blob/main/css-view-transitions-2/Overview.bs">GitHub
                            Editor</a>
                </dl>
            </div>
        </details>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> ©
            2024 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr
                title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a
                href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a
                href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a
                href="https://www.w3.org/copyright/software-license/" rel="license"
                title="W3C Software and Document License">permissive document license</a> rules apply. </p>
        <hr title="Separator for header">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
        <p>This module defines how the View Transition API works with cross-document navigations.</p>
        <a href="https://www.w3.org/TR/CSS/">CSS</a> is a language for describing the rendering of structured documents
        (such as HTML and XML)
        on screen, on paper, etc.
    </div>
    <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
    <div data-fill-with="status">
        <p><em>This section describes the status of this document at the time of its publication.
                A list of current W3C publications
                and the latest revision of this technical report
                can be found in the <a href="https://www.w3.org/TR/">W3C technical reports index at
                    https://www.w3.org/TR/.</a></em> </p>
        <p> This document was published
            by the <a href="https://www.w3.org/groups/wg/css">CSS Working Group</a> as a <strong>First Public Working
                Draft</strong> using the <a
                href="https://www.w3.org/2023/Process-20231103/#recs-and-notes">Recommendation
                track</a>.
            Publication as a First Public Working Draft
            does not imply endorsement by <abbr title="World Wide Web Consortium">W3C</abbr> and its Members. </p>
        <p> This is a draft document
            and may be updated, replaced
            or obsoleted by other documents at any time.
            It is inappropriate to cite this document as other than work in progress. </p>
        <p>Please send feedback
            by <a href="https://github.com/w3c/csswg-drafts/issues">filing issues in GitHub</a> (preferred),
            including the spec code “css-view-transitions” in the title, like this:
            “[css-view-transitions] <i>…summary of comment…</i>”.
            All issues and comments are <a href="https://lists.w3.org/Archives/Public/public-css-archive/">archived</a>.
            Alternately, feedback can be sent to the (<a
                href="https://lists.w3.org/Archives/Public/www-style/">archived</a>) public mailing list <a
                href="mailto:www-style@w3.org?Subject=%5Bcss-view-transitions%5D%20PUT%20SUBJECT%20HERE">www-style@w3.org</a>.
        </p>
        <p>This document is governed by the <a href="https://www.w3.org/2023/Process-20231103/"
                id="w3c_process_revision">03 November 2023 W3C Process Document</a>. </p>
        <p>This document was produced by a group operating under the <a
                href="https://www.w3.org/Consortium/Patent-Policy-20200915/">W3C Patent Policy</a>.
            W3C maintains a <a href="https://www.w3.org/groups/wg/css/ipr" rel="disclosure">public list of any patent
                disclosures</a> made in connection with the deliverables of the group;
            that page also includes instructions for disclosing a patent.
            An individual who has actual knowledge of a patent which the individual believes
            contains <a href="https://www.w3.org/Consortium/Patent-Policy-20200915/#def-essential">Essential
                Claim(s)</a> must disclose the information in accordance with <a
                href="https://www.w3.org/Consortium/Patent-Policy-20200915/#sec-Disclosure">section 6 of the W3C Patent
                Policy</a>. </p>
        <p></p>
    </div>
    <div data-fill-with="at-risk"></div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
        <ol class="toc" role="directory">
            <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
            <li>
                <a href="#cross-document-view-transitions"><span class="secno">2</span> <span
                        class="content">Cross-document view transitions</span></a>
                <ol class="toc">
                    <li>
                        <a href="#cross-doc-overview"><span class="secno">2.1</span> <span
                                class="content">Overview</span></a>
                        <ol class="toc">
                            <li><a href="#activating-cross-document-view-transition"><span class="secno">2.1.1</span>
                                    <span class="content">Activation</span></a>
                            <li><a href="#waiting-for-stable-state"><span class="secno">2.1.2</span> <span
                                        class="content">Waiting for the new state to stabilize</span></a>
                            <li>
                                <a href="#customizing-cross-document-view-transitions"><span class="secno">2.1.3</span>
                                    <span class="content">Customization</span></a>
                                <ol class="toc">
                                    <li><a href="#old-doc-event"><span class="secno">2.1.3.1</span> <span
                                                class="content">Handling the view transition in the old
                                                document</span></a>
                                    <li><a href="#new-doc-event"><span class="secno">2.1.3.2</span> <span
                                                class="content">Handling the view transition in the new
                                                document</span></a>
                                </ol>
                            <li><a href="#lifecycle"><span class="secno">2.1.4</span> <span
                                        class="content">Lifecycle</span></a>
                        </ol>
                    <li><a href="#cross-doc-examples"><span class="secno">2.2</span> <span
                                class="content">Examples</span></a>
                    <li>
                        <a href="#cross-doc-opt-in"><span class="secno">2.3</span> <span class="content">Opting in to
                                cross-document view transitions</span></a>
                        <ol class="toc">
                            <li><a href="#view-transition-rule"><span class="secno">2.3.1</span> <span
                                        class="content">The <span><span class="css">@view-transition</span></span>
                                        rule</span></a>
                            <li><a href="#view-transition-navigation-descriptor"><span class="secno">2.3.2</span> <span
                                        class="content">The <span>navigation</span> descriptor</span></a>
                            <li><a href="#cssom"><span class="secno">2.3.3</span> <span class="content">Accessing the
                                        <span class="css">@view-transition</span> rule using CSSOM</span></a>
                        </ol>
                </ol>
            <li>
                <a href="#selective-vt"><span class="secno">3</span> <span class="content">Selective view
                        transitions</span></a>
                <ol class="toc">
                    <li><a href="#selective-vt-overview"><span class="secno">3.1</span> <span
                                class="content">Overview</span></a>
                    <li><a href="#active-view-transition-pseudo-examples"><span class="secno">3.2</span> <span
                                class="content">Examples</span></a>
                    <li>
                        <a href="#pseudo-classes-for-selective-vt"><span class="secno">3.3</span> <span
                                class="content">Selecting based on the active view transition</span></a>
                        <ol class="toc">
                            <li><a href="#the-active-view-transition-pseudo"><span class="secno">3.3.1</span> <span
                                        class="content">The <span class="css">:active-view-transition</span>
                                        pseudo-class</span></a>
                            <li><a href="#the-active-view-transition-type-pseudo"><span class="secno">3.3.2</span> <span
                                        class="content">The <span class="css">:active-view-transition-type()</span>
                                        pseudo-class</span></a>
                        </ol>
                    <li><a href="#view-transitions-extension-types"><span class="secno">3.4</span> <span
                                class="content">Changing the types of an ongoing view transition</span></a>
                    <li><a href="#types-cross-doc"><span class="secno">3.5</span> <span class="content">Activating the
                                transition type for cross-document view transitions</span></a>
                </ol>
            <li>
                <a href="#shared-style-with-vt-classes"><span class="secno">4</span> <span class="content">Sharing
                        styles between view transition pseudo-elements</span></a>
                <ol class="toc">
                    <li><a href="#shared-style-overview"><span class="secno">4.1</span> <span
                                class="content">Overview</span></a>
                    <li><a href="#vt-class-example"><span class="secno">4.2</span> <span
                                class="content">Examples</span></a>
                    <li><a href="#view-transition-class-prop"><span class="secno">4.3</span> <span class="content">The
                                <span class="property">view-transition-class</span> property</span></a>
                    <li><a href="#pseudo-element-class-additions"><span class="secno">4.4</span> <span
                                class="content">Additions to named view transition pseudo-elements</span></a>
                </ol>
            <li><a href="#extend-document-types"><span class="secno">5</span> <span class="content">Extending <code
                            class="idl"><span>document.startViewTransition()</span></code></span></a>
            <li>
                <a href="#algorithms"><span class="secno">6</span> <span class="content">Algorithms</span></a>
                <ol class="toc">
                    <li>
                        <a href="#cross-doc-data-structures"><span class="secno">6.1</span> <span class="content">Data
                                structures</span></a>
                        <ol class="toc">
                            <li><a href="#cross-doc-data-structure-document"><span class="secno">6.1.1</span> <span
                                        class="content">Additions to <code
                                            class="idl"><span>Document</span></code></span></a>
                            <li><a href="#cross-doc-data-structure-vt"><span class="secno">6.1.2</span> <span
                                        class="content">Additions to <code
                                            class="idl"><span>ViewTransition</span></code></span></a>
                            <li><a href="#cross-doc-data-structure-serialization"><span class="secno">6.1.3</span> <span
                                        class="content">Serializable <span>view transition params</span></span></a>
                            <li><a href="#capture-classes-data-structure"><span class="secno">6.1.4</span> <span
                                        class="content">Captured elements extension</span></a>
                        </ol>
                    <li><a href="#vt-rule-algo"><span class="secno">6.2</span> <span class="content">Resolving the <span
                                    class="css">@view-transition</span> rule</span></a>
                    <li>
                        <a href="#setup-old-document-vt"><span class="secno">6.3</span> <span class="content">Setting up
                                the view transition in the old <code class="idl"><span>Document</span></code></span></a>
                        <ol class="toc">
                            <li><a href="#check-eligibility"><span class="secno">6.3.1</span> <span
                                        class="content">Check eligibility for outbound cross-document view
                                        transition</span></a>
                            <li><a href="#setup-outbound-transition"><span class="secno">6.3.2</span> <span
                                        class="content">Setup the outbound transition when ready to swap
                                        pages</span></a>
                            <li><a href="#update-opt-in"><span class="secno">6.3.3</span> <span class="content">Update
                                        the opt-in flag to reflect the current state</span></a>
                            <li><a href="#proceed-if-skipped"><span class="secno">6.3.4</span> <span
                                        class="content">Proceed with navigation if view transition is skipped</span></a>
                            <li><a href="#cross-doc-after-capture"><span class="secno">6.3.5</span> <span
                                        class="content">Proceed with cross-document view transition after capturing the
                                        old state</span></a>
                        </ol>
                    <li><a href="#access-view-transition-in-new-doc"><span class="secno">6.4</span> <span
                                class="content">Activating the view transition in the new <code
                                    class="idl"><span>Document</span></code></span></a>
                    <li><a href="#vt-class-algorithms"><span class="secno">6.5</span> <span class="content">Capturing
                                the <span class="property">view-transition-class</span></span></a>
                </ol>
            <li><a href="#priv"><span class="secno"></span> <span class="content">Privacy Considerations</span></a>
            <li><a href="#sec"><span class="secno"></span> <span class="content">Security Considerations</span></a>
            <li>
                <a href="#w3c-conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
                <ol class="toc">
                    <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content"> Document
                                conventions</span></a>
                    <li><a href="#w3c-conformance-classes"><span class="secno"></span> <span class="content">
                                Conformance classes</span></a>
                    <li>
                        <a href="#w3c-partial"><span class="secno"></span> <span class="content"> Partial
                                implementations</span></a>
                        <ol class="toc">
                            <li><a href="#w3c-conform-future-proofing"><span class="secno"></span> <span
                                        class="content"> Implementations of Unstable and Proprietary Features</span></a>
                        </ol>
                    <li><a href="#w3c-testing"><span class="secno"></span> <span class="content"> Non-experimental
                                implementations</span></a>
                </ol>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by
                                this specification</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms
                                defined by reference</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">Normative
                                References</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">Informative
                                References</span></a>
                </ol>
            <li>
                <a href="#property-index"><span class="secno"></span> <span class="content">Property Index</span></a>
                <ol class="toc">
                    <li><a href="#view-transition-descriptor-table"><span class="secno"></span> <span
                                class="content"><span>@view-transition</span> Descriptors</span></a>
                </ol>
            <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
            <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
        </ol>
    </nav>
    <main>
        <script async src="diagrams/resources/scaler.js" type="module"></script>
        <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span
                class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
        <p><em>This section is non-normative.</em></p>
        <p>View Transitions, as specified in <a data-link-type="biblio" href="#biblio-css-view-transitions-1"
                title="CSS View Transitions Module Level 1">[css-view-transitions-1]</a>, is a feature that allows
            developers
            to create animated transitions between visual states of the <a data-link-type="dfn"
                href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document">document</a>.</p>
        <p>Level 2 extends that specification, by adding the necessary API and lifecycle to enable
            transitions across a same-origin cross-document navigation, as well as a few additions that
            make it easier to author pages with richer view transitions.</p>
        <p>Level 2 defines the following:</p>
        <ul>
            <li data-md>
                <p><a href="#cross-document-view-transitions">Cross-document view transitions</a>, including the <a
                        class="css" data-link-type="maybe" href="#at-view-transition-rule"
                        id="ref-for-at-view-transition-rule">@view-transition</a> rule and the algorithms
                    that enable the cross-document view transition lifecycle.</p>
            <li data-md>
                <p><a href="#selective-vt">Selective view transitions</a>, a way to match styles based on the existence
                    of an <a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition"
                        id="ref-for-document-active-view-transition">active view transition</a>,
                    and more specifically based on the active view transition being of a certain type.</p>
            <li data-md>
                <p><a href="#shared-style-with-vt-classes">Sharing styles between view transition pseudo-elements</a>, a
                    way to declare a style once,
                    and use it for multiple view transition pseudo-elements. This includes the <a class="property css"
                        data-link-type="property" href="#propdef-view-transition-class"
                        id="ref-for-propdef-view-transition-class">view-transition-class</a> property, and <a
                        href="#pseudo-element-class-additions">additions to named pseudo-elements</a></p>
        </ul>
        <h2 class="heading settled" data-level="2" id="cross-document-view-transitions"><span class="secno">2.
            </span><span class="content">Cross-document view transitions</span><a class="self-link"
                href="#cross-document-view-transitions"></a></h2>
        <h3 class="heading settled" data-level="2.1" id="cross-doc-overview"><span class="secno">2.1. </span><span
                class="content">Overview</span><a class="self-link" href="#cross-doc-overview"></a></h3>
        <p><em>This section is non-normative.</em></p>
        <h4 class="heading settled" data-level="2.1.1" id="activating-cross-document-view-transition"><span
                class="secno">2.1.1. </span><span class="content">Activation</span><a class="self-link"
                href="#activating-cross-document-view-transition"></a></h4>
        With same-document view transitions, the author starts a view transition using JavaScript, by calling <code
            class="idl"><a data-link-type="idl" href="#dom-document-startviewtransition" id="ref-for-dom-document-startviewtransition">startViewTransition</a></code>.
        In cross-document view transition, what triggers a view transition is a navigation between two documents, as
        long as the following conditions are met:
        <ul>
            <li data-md>
                <p>Both documents are of the <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin"
                        id="ref-for-same-origin">same origin</a>;</p>
            <li data-md>
                <p>The page is visible throughout the entire course of the navigatiion;</p>
            <li data-md>
                <p>the navigation is initiated by the page, e.g. by clicking a link or submitting a form, or is a <code
                        class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-traverse" id="ref-for-dom-navigationtype-traverse">traverse</a></code>
                    navigation (back/forward). This excludes, for example, navigations initiated by the URL bar;</p>
            <li data-md>
                <p>the navigation didn’t include cross-origin redirects; and</p>
            <li data-md>
                <p>both documents opted in to cross-document view transitions, using the <a class="css"
                        data-link-type="maybe" href="#at-view-transition-rule"
                        id="ref-for-at-view-transition-rule①">@view-transition</a> rule.</p>
        </ul>
        <p>See the <a href="#lifecycle">lifecycle</a> section for more details.</p>
        <h4 class="heading settled" data-level="2.1.2" id="waiting-for-stable-state"><span class="secno">2.1.2.
            </span><span class="content">Waiting for the new state to stabilize</span><a class="self-link"
                href="#waiting-for-stable-state"></a></h4>
        In same-document view transitions, the author can indicate when the new state of the transition is in a stable
        state by using the callback passed to <code
            class="idl"><a data-link-type="idl" href="#dom-document-startviewtransition" id="ref-for-dom-document-startviewtransition①">startViewTransition</a></code>.
        Since cross-document view transitions are declarative, there is no such explicit promise. Instead, the user
        agent relies on the <a data-link-type="dfn"
            href="https://html.spec.whatwg.org/multipage/dom.html#render-blocking-mechanism"
            id="ref-for-render-blocking-mechanism">render-blocking mechanism</a> to decide when the document has reached
        a stable state.
        In this way, the author can use the the <code data-x>blocking</code> attribute, to delay the transition until:
        <ul>
            <li data-md>
                <p>All expected scripts are executed, by using the script’s <code
                        class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/scripting.html#dom-script-blocking" id="ref-for-dom-script-blocking">blocking</a></code>
                    attribute on required scripts.</p>
            <li data-md>
                <p>All expected styles are executed, by using the style or link’s <code
                        class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/semantics.html#dom-style-blocking" id="ref-for-dom-style-blocking">blocking</a></code>
                    attribute on required styles.</p>
            <li data-md>
                <p>All expected HTML elements are seen by the parser, using an
                    <code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/multipage/links.html#link-type-expect" id="ref-for-link-type-expect">expect</a></code>
                    <code
                        class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/semantics.html#htmllinkelement" id="ref-for-htmllinkelement">HTMLLinkElement</a></code>
                    element.
                </p>
        </ul>
        <p class="note" role="note"><span class="marker">Note:</span> overusing the render-blocking mechanism could make
            it so that the old state remains frozen for a long time, resulting in a jarring user experience.
            To avoid this, it’s advised to ensure that the render-blocking elements are available in a timely manner.
        </p>
        <div class="example" id="example-2c826e50">
            <a class="self-link" href="#example-2c826e50"></a>
            <p>In this example, the last frame of the old document will be shown, and the animation will be delayed,
                until all the following conditions are met:</p>
            <ul>
                <li data-md>
                    <p><code>style.css</code> is applied, to ensure the new state has the correct styles</p>
                <li data-md>
                    <p><code>fixup.js</code> is run, to ensure the presentation is up to date with script-based fixups.
                    </p>
                <li data-md>
                    <p>The <code>main-article</code> section is seen and parsed, to ensure enough of the content is
                        loaded before allowing the transition to proceed.</p>
            </ul>
            <pre class="language-html highlight"><c- cp>&lt;!DOCTYPE html></c->
<c- p>&lt;</c-><c- f>html</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>head</c-><c- p>></c->
    &lt; !-- This will be render-blocking by default -->
    <c- p>&lt;</c-><c- f>link</c-> <c- e>rel</c-><c- o>=</c-><c- s>"stylesheet"</c-> <c- e>href</c-><c- o>=</c-><c- s>"style.css"</c-><c- p>></c->

    &lt; !-- Since this script fixes up the layout, marking it as render blocking will
        ensure it's run before the view transition is activated -->
    <c- p>&lt;</c-><c- f>script</c-> <c- e>async</c-> <c- e>href</c-><c- o>=</c-><c- s>"fixup.js"</c-> <c- e>blocking</c-><c- o>=</c-><c- s>"render"</c-><c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->

    &lt; !-- Wait until the main-article element is seen and fully parsed before
        activating the transition -->
    <c- p>&lt;</c-><c- f>link</c-> <c- e>rel</c-><c- o>=</c-><c- s>"expect"</c-> <c- e>href</c-><c- o>=</c-><c- s>"#main-article"</c-> <c- e>blocking</c-><c- o>=</c-><c- s>"render"</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>head</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>body</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>header</c-><c- p>></c->...<c- p>&lt;/</c-><c- f>header</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>main</c-><c- p>></c->
      <c- p>&lt;</c-><c- f>article</c-> <c- e>id</c-><c- o>=</c-><c- s>"main-article"</c-><c- p>></c->...<c- p>&lt;/</c-><c- f>article</c-><c- p>></c->
    <c- p>&lt;/</c-><c- f>main</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>article</c-> <c- e>id</c-><c- o>=</c-><c- s>"secondary-article"</c-><c- p>></c->...<c- p>&lt;/</c-><c- f>article</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>html</c-><c- p>></c->
</pre>
        </div>
        <h4 class="heading settled" data-level="2.1.3" id="customizing-cross-document-view-transitions"><span
                class="secno">2.1.3. </span><span class="content">Customization</span><a class="self-link"
                href="#customizing-cross-document-view-transitions"></a></h4>
        The <code
            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition">ViewTransition</a></code>
        object enables customizing the transition in script.
        Same-document view transitions use a single <code
            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition①">ViewTransition</a></code>
        object returned from the <code
            class="idl"><a data-link-type="idl" href="#dom-document-startviewtransition" id="ref-for-dom-document-startviewtransition②">startViewTransition</a></code>
        call for the entire lifecycle.
        Cross-document view transitions have two <code
            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition②">ViewTransition</a></code>
        objects, one in the old document and one in the new document.
        <h5 class="heading settled" data-level="2.1.3.1" id="old-doc-event"><span class="secno">2.1.3.1. </span><span
                class="content">Handling the view transition in the old document</span><a class="self-link"
                href="#old-doc-event"></a></h5>
        <p>The <code
                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-pageswap" id="ref-for-event-pageswap">pageswap</a></code>
            event is fired at the last moment before a document is about to be unloaded and swapped by another document.
            It can be used to find out whether a view transition is about to take place, customize it using <code
                class="idl"><a data-link-type="idl" href="#dom-viewtransition-types" id="ref-for-dom-viewtransition-types">types</a></code>,
            make last minute changes to the captured elements, or skip it if necessary.
            The <code
                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#pageswapevent" id="ref-for-pageswapevent">PageSwapEvent</a></code>
            interface has a <code
                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pageswapevent-viewtransition" id="ref-for-dom-pageswapevent-viewtransition">viewTransition</a></code>
            object, which would be non-null when the navigation is eligible to a view transition,
            and a <code
                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pageswapevent-activation" id="ref-for-dom-pageswapevent-activation">activation</a></code>
            object, providing handy information about the navigation, like the URL after redirects.
            The transition’s <code
                class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-finished" id="ref-for-dom-viewtransition-finished">finished</a></code>
            promise can be used for cleaning up after the transition, in case the document is later restored from
            BFCache.</p>
        <h5 class="heading settled" data-level="2.1.3.2" id="new-doc-event"><span class="secno">2.1.3.2. </span><span
                class="content">Handling the view transition in the new document</span><a class="self-link"
                href="#new-doc-event"></a></h5>
        <p>The <code
                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-pagereveal" id="ref-for-event-pagereveal">pagereveal</a></code>
            event is fired right before presenting the first frame of the new document.
            It can be used to find out if the view transition is still valid, by querying the <code
                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pagerevealevent-viewtransition" id="ref-for-dom-pagerevealevent-viewtransition">viewTransition</a></code>
            attribute.
            Similar to a same-document view transition, the author can now select different <code
                class="idl"><a data-link-type="idl" href="#dom-viewtransition-types" id="ref-for-dom-viewtransition-types①">types</a></code>,
            make last minute changes to the captured elements, wait for the transition to be <code
                class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-ready" id="ref-for-dom-viewtransition-ready">ready</a></code>
            in order to animate it, or skip it altogether.</p>
        <h4 class="heading settled" data-level="2.1.4" id="lifecycle"><span class="secno">2.1.4. </span><span
                class="content">Lifecycle</span><a class="self-link" href="#lifecycle"></a></h4>
        <p><em>This section is non-normative.</em></p>
        <p>A successful cross-document view transition goes through the following phases:</p>
        <ol>
            <li data-md>
                <p>In the old <code
                        class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code>:
                </p>
                <ol>
                    <li data-md>
                        <p>The user initiates a navigation, by clicking a link, submitting a form, pressing the
                            browser’s back button, etc.</p>
                        <p class="note" role="note"><span class="marker">Note:</span> some navigations do not trigger a
                            view-transition, e.g. typing a new address in the URL bar.</p>
                    <li data-md>
                        <p>When the new <code
                                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①">Document</a></code>
                            is ready to be activated, the <code
                                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-pageswap" id="ref-for-event-pageswap①">pageswap</a></code>
                            event is fired.</p>
                    <li data-md>
                        <p>If the navigation is <a data-link-type="dfn"
                                href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin"
                                id="ref-for-same-origin①">same origin</a>, has no cross-origin redirects,
                            and the old <code
                                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②">Document</a></code>
                            has <a href="#cross-doc-opt-in">opted in to cross-document view transitions</a>, the event’s
                            <code
                                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pageswapevent-viewtransition" id="ref-for-dom-pageswapevent-viewtransition①">viewTransition</a></code>
                            attribute would be
                            a <code
                                class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition③">ViewTransition</a></code>
                            object.
                        </p>
                    <li data-md>
                        <p>The author can now customize the transition, e.g. by mutating its <code
                                class="idl"><a data-link-type="idl" href="#dom-viewtransition-types" id="ref-for-dom-viewtransition-types②">types</a></code>,
                            or <code
                                class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-skiptransition" id="ref-for-dom-viewtransition-skiptransition">skip</a></code>
                            it altogether.</p>
                    <li data-md>
                        <p>If the <code
                                class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition④">ViewTransition</a></code>
                            is not skipped, the state of the old document is <a data-link-type="dfn"
                                href="https://www.w3.org/TR/css-view-transitions-1/#capture-the-old-state"
                                id="ref-for-capture-the-old-state">captured</a>.</p>
                    <li data-md>
                        <p>The navigation proceeds: the old <code
                                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document③">Document</a></code>
                            is unloaded, and the new <code
                                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document④">Document</a></code>
                            is now active.</p>
                </ol>
            <li data-md>
                <p>Then, in the new <code
                        class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑤">Document</a></code>:
                </p>
                <ol>
                    <li data-md>
                        <p>When the new <code
                                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑥">Document</a></code>
                            is ready for its first <a data-link-type="dfn"
                                href="https://html.spec.whatwg.org/multipage/webappapis.html#rendering-opportunity"
                                id="ref-for-rendering-opportunity">rendering opportunity</a>, an event named <code
                                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-pagereveal" id="ref-for-event-pagereveal①">pagereveal</a></code>
                            is fired on the new <code
                                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑦">Document</a></code>,
                            with a <code
                                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pagerevealevent-viewtransition" id="ref-for-dom-pagerevealevent-viewtransition①">viewTransition</a></code>
                            attribute.</p>
                    <li data-md>
                        <p>This <code
                                class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition⑤">ViewTransition</a></code>'s
                            <code><code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-updatecallbackdone" id="ref-for-dom-viewtransition-updatecallbackdone">updateCallbackDone</a></code></code>
                            promise is already resolved,
                            and its <a data-link-type="dfn"
                                href="https://www.w3.org/TR/css-view-transitions-1/#captured-element"
                                id="ref-for-captured-element">captured elements</a> are populated from the old <code
                                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑧">Document</a></code>.
                        </p>
                    <li data-md>
                        <p>This is another opportunity for the author customize the transition, e.g. by mutating its
                            <code
                                class="idl"><a data-link-type="idl" href="#dom-viewtransition-types" id="ref-for-dom-viewtransition-types③">types</a></code>,
                            or <code
                                class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-skiptransition" id="ref-for-dom-viewtransition-skiptransition①">skip</a></code>
                            it altogether.
                        </p>
                    <li data-md>
                        <p>The state of the new document is <a data-link-type="dfn"
                                href="https://www.w3.org/TR/css-view-transitions-1/#capture-the-new-state"
                                id="ref-for-capture-the-new-state">captured</a> as the "new" state of the transition.
                        </p>
                    <li data-md>
                        <p>From this point forward, the transition continues in a similar fashion to a same-document
                            transition, as per <a data-link-type="dfn"
                                href="https://www.w3.org/TR/css-view-transitions-1/#activate-view-transition"
                                id="ref-for-activate-view-transition">activate view transition</a>.</p>
                </ol>
        </ol>
        <h3 class="heading settled" data-level="2.2" id="cross-doc-examples"><span class="secno">2.2. </span><span
                class="content">Examples</span><a class="self-link" href="#cross-doc-examples"></a></h3>
        <div class="example" id="example-5cf7b384">
            <a class="self-link" href="#example-5cf7b384"></a> To generate the same cross-fade as in the first example
            <a href="https://www.w3.org/TR/css-view-transitions-1/#examples"><cite>CSS View Transitions 1</cite> § 1.6
                Examples</a>,
            but across documents, we don’t need JavaScript.
            <p>Instead, we opt in to triggering view-transitions on navigation in both page 1 and page 2:</p>
            <pre class="language-css highlight">// in both documents:
<c- n>@view-transition</c-> <c- p>{</c->
  <c- k>navigation</c-><c- p>:</c-> auto<c- p>;</c->
<c- p>}</c->
</pre>
            <p>A link from page 1 to or from page 2 would generate a crossfade transition for example 1.
                To achieve the effect examples 2, 3 &amp; 4, simply put the CSS for the pseudo-elements in both
                documents.</p>
        </div>
        <div class="example" id="example-e5e29ee3">
            <a class="self-link" href="#example-e5e29ee3"></a> Note that the <a class="css" data-link-type="maybe"
                href="#at-view-transition-rule" id="ref-for-at-view-transition-rule②">@view-transition</a> rule can be
            used together with media queries.
            For example, this would only perform the transition when the screen width is greater than:
            <pre class="language-css highlight"><c- n>@view-transition</c-> <c- p>{</c->
  <c- k>navigation</c-><c- p>:</c-> auto<c- p>;</c->
<c- p>}</c->

<c- n>@media</c-> <c- p>(</c->max-width: <c- m>600</c-><c- k>px</c-><c- p>)</c-> <c- p>{</c->
  <c- k>navigation</c-><c- p>:</c-> none<c- p>;</c->
<c- p>}</c->
</pre>
        </div>
        <div class="example" id="example-06131030">
            <a class="self-link" href="#example-06131030"></a> To achieve the effect in <a
                href="https://www.w3.org/TR/css-view-transitions-1/#examples">example 5</a>, we have to do several
            things:
            <ul>
                <li data-md>
                    <p>Opt-in to navigation-triggered view-transitions in both pages.</p>
                <li data-md>
                    <p>Pass the click location to the new document, e.g. via <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webstorage.html#dom-sessionstorage" id="ref-for-dom-sessionstorage">sessionStorage</a></code>.
                    </p>
                <li data-md>
                    <p>Intercept the <code
                            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition⑥">ViewTransition</a></code>
                        object in the new document, using the <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-pagereveal" id="ref-for-event-pagereveal②">pagereveal</a></code>
                        event.</p>
            </ul>
            <p>In both pages:</p>
            <pre class="language-css highlight"><c- n>@view-transition</c-> <c- p>{</c->
  <c- k>navigation</c-><c- p>:</c-> auto<c- p>;</c->
<c- p>}</c->
</pre>
            <p>In the old page:</p>
            <pre class="language-js highlight">addEventListener<c- p>(</c-><c- t>'click'</c-><c- p>,</c-> event <c- p>=></c-> <c- p>{</c->
  sessionStorage<c- p>.</c->setItem<c- p>(</c-><c- u>"lastClickX"</c-><c- p>,</c-> event<c- p>.</c->clientX<c- p>);</c->
  sessionStorage<c- p>.</c->setItem<c- p>(</c-><c- u>"lastClickY"</c-><c- p>,</c-> event<c- p>.</c->clientY<c- p>);</c->
<c- p>});</c->
</pre>
            <p>In the new page:</p>
            <pre class="language-js highlight"><c- c1>// This would run both on initial load and on reactivation from BFCache.</c->
addEventListener<c- p>(</c-><c- u>"pagereveal"</c-><c- p>,</c-> <c- k>async</c-> event <c- p>=></c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c-><c- o>!</c->event<c- p>.</c->viewTransition<c- p>)</c->
    <c- k>return</c-><c- p>;</c->

  <c- a>const</c-> x <c- o>=</c-> sessionStorage<c- p>.</c->getItem<c- p>(</c-><c- u>"lastClickX"</c-><c- p>)</c-> <c- o>??</c-> innerWidth <c- o>/</c-> <c- mf>2</c-><c- p>;</c->
  <c- a>const</c-> y <c- o>=</c-> sessionStorage<c- p>.</c->getItem<c- p>(</c-><c- u>"lastClickY"</c-><c- p>)</c-> <c- o>??</c-> innerHeight <c- o>/</c-> <c- mf>2</c-><c- p>;</c->

  <c- a>const</c-> endRadius <c- o>=</c-> Math<c- p>.</c->hypot<c- p>(</c->
    Math<c- p>.</c->max<c- p>(</c->x<c- p>,</c-> innerWidth <c- o>-</c-> x<c- p>),</c->
    Math<c- p>.</c->max<c- p>(</c->y<c- p>,</c-> innerHeight <c- o>-</c-> y<c- p>)</c->
  <c- p>);</c->

  <c- k>await</c-> event<c- p>.</c->viewTransition<c- p>.</c->ready<c- p>;</c->

  <c- c1>// Animate the new document's view</c->
  document<c- p>.</c->documentElement<c- p>.</c->animate<c- p>(</c->
    <c- p>{</c->
      clipPath<c- o>:</c-> <c- p>[</c->
        <c- sb>`circle(0 at </c-><c- si>${</c->x<c- si>}</c-><c- sb>px </c-><c- si>${</c->y<c- si>}</c-><c- sb>px)`</c-><c- p>,</c->
        <c- sb>`circle(</c-><c- si>${</c->endRadius<c- si>}</c-><c- sb>px at </c-><c- si>${</c->x<c- si>}</c-><c- sb>px </c-><c- si>${</c->y<c- si>}</c-><c- sb>px)`</c-><c- p>,</c->
      <c- p>],</c->
    <c- p>},</c->
    <c- p>{</c->
      duration<c- o>:</c-> <c- mf>500</c-><c- p>,</c->
      easing<c- o>:</c-> <c- t>'ease-in'</c-><c- p>,</c->
      pseudoElement<c- o>:</c-> <c- t>'::view-transition-new(root)'</c->
    <c- p>}</c->
  <c- p>);</c->
<c- p>})</c->
</pre>
        </div>
        <div class="example" id="example-926506d6">
            <a class="self-link" href="#example-926506d6"></a> To choose which elements are captured based on properties
            of the navigation, and whether certain images are loaded:
            <p>In the old page:</p>
            <pre class="language-js highlight">window<c- p>.</c->addEventListener<c- p>(</c-><c- u>"pageswap"</c-><c- p>,</c-> event <c- p>=></c-> <c- p>{</c->
  <c- c1>// For example, the page was hidden, or the navigation is cross-document.</c->
  <c- k>if</c-> <c- p>(</c-><c- o>!</c->event<c- p>.</c->viewTransition<c- p>)</c->
    <c- k>return</c-><c- p>;</c->

  <c- c1>// If you don't want view transition for back/forward navigations...</c->
  <c- k>if</c-> <c- p>(</c->event<c- p>.</c->activation<c- p>.</c->navigationType <c- o>===</c-> <c- u>"traverse"</c-><c- p>)</c-> <c- p>{</c->
    event<c- p>.</c->viewTransition<c- p>.</c->skipTransition<c- p>();</c->
  <c- p>}</c->

  <c- a>const</c-> newURL <c- o>=</c-> <c- ow>new</c-> URL<c- p>(</c->event<c- p>.</c->activation<c- p>.</c->entry<c- p>.</c->url<c- p>);</c->
  <c- k>if</c-> <c- p>(</c->newURL<c- p>.</c->pathname <c- o>===</c-> <c- u>"/details"</c-> <c- o>&amp;&amp;</c-> thumbnail<c- p>.</c->complete<c- p>)</c-> <c- p>{</c->
    thumbnail<c- p>.</c->classList<c- p>.</c->add<c- p>(</c-><c- u>"transition-to-hero"</c-><c- p>);</c->

    <c- c1>// This will cleanup the state if the page is restored from BFCache.</c->
    event<c- p>.</c->viewTransition<c- p>.</c->finished<c- p>.</c->then<c- p>(()</c-> <c- p>=></c-> <c- p>{</c->
      thumbnail<c- p>.</c->classList<c- p>.</c->remove<c- p>(</c-><c- u>"transition-to-hero"</c-><c- p>);</c->
    <c- p>});</c->
  <c- p>}</c->

<c- p>});</c->
</pre>
            <p>In the new page:</p>
            <pre class="language-js highlight">window<c- p>.</c->addEventListener<c- p>(</c-><c- u>"pagereveal"</c-><c- p>,</c-> event <c- p>=></c-> <c- p>{</c->
  <c- c1>// For example, the page was hidden, the navigation is cross-document, or the transition was skipped in the old document.</c->
  <c- k>if</c-> <c- p>(</c-><c- o>!</c->event<c- p>.</c->viewTransition<c- p>)</c->
    <c- k>return</c-><c- p>;</c->

  <c- a>const</c-> oldURL <c- o>=</c-> <c- ow>new</c-> URL<c- p>(</c->navigation<c- p>.</c->activation<c- p>.</c-><c- kr>from</c-><c- p>.</c->url<c- p>);</c->
  <c- k>if</c-> <c- p>(</c->newURL<c- p>.</c->pathname <c- o>===</c-> <c- u>"/list"</c-><c- p>)</c-> <c- p>{</c->
    event<c- p>.</c->viewTransition<c- p>.</c->types<c- p>.</c->add<c- p>(</c-><c- u>"coming-from-list"</c-><c- p>);</c->

    <c- c1>// This will show the thumbnail until the view transition is finished.</c->
    <c- k>if</c-> <c- p>(</c-><c- o>!</c->hero<c- p>.</c->complete<c- p>)</c-> <c- p>{</c->
      setToThumbnail<c- p>(</c->hero<c- p>);</c->
      event<c- p>.</c->viewTransition<c- p>.</c->finished<c- p>.</c->then<c- p>(()</c-> <c- p>=></c-> <c- p>{</c->
        setToFullResolution<c- p>(</c->hero<c- p>);</c->
      <c- p>})</c->
    <c- p>}</c->
  <c- p>}</c->
<c- p>});</c->
</pre>
        </div>
        <h3 class="heading settled" data-level="2.3" id="cross-doc-opt-in"><span class="secno">2.3. </span><span
                class="content">Opting in to cross-document view transitions</span><a class="self-link"
                href="#cross-doc-opt-in"></a></h3>
        <h4 class="heading settled" data-level="2.3.1" id="view-transition-rule"><span class="secno">2.3.1. </span><span
                class="content">The <dfn class="dfn-paneled css" data-dfn-type="at-rule" data-export
                    id="at-view-transition-rule"><a class="css" data-link-type="maybe" href="#at-view-transition-rule"
                        id="ref-for-at-view-transition-rule③">@view-transition</a></dfn> rule</span><a class="self-link"
                href="#view-transition-rule"></a></h4>
        <p>The <a class="css" data-link-type="maybe" href="#at-view-transition-rule"
                id="ref-for-at-view-transition-rule④">@view-transition</a> rule is used by a document to indicate that
            cross-document navigations
            should setup and activate a <code
                class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition⑦">ViewTransition</a></code>.
        </p>
        <p>The <a class="css" data-link-type="maybe" href="#at-view-transition-rule"
                id="ref-for-at-view-transition-rule⑤">@view-transition</a> rule has the following syntax:</p>
        <pre class="prod">@view-transition {
  <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-syntax-3/#typedef-declaration-list" id="ref-for-typedef-declaration-list">&lt;declaration-list></a>
}
</pre>
        <p>The <a class="css" data-link-type="maybe" href="#at-view-transition-rule"
                id="ref-for-at-view-transition-rule⑥">@view-transition</a> rule accepts the <a data-link-type="dfn"
                href="#view-transition-navigation" id="ref-for-view-transition-navigation">navigation</a> and <a
                data-link-type="dfn" href="#view-transition-types" id="ref-for-view-transition-types">types</a>
            descriptors.</p>
        <p class="note" role="note"><span class="marker">Note:</span> as per default behavior, the <a class="css"
                data-link-type="maybe" href="#at-view-transition-rule"
                id="ref-for-at-view-transition-rule⑦">@view-transition</a> rule can be nested inside a <a
                data-link-type="dfn" href="https://www.w3.org/TR/css-conditional-3/#conditional-group-rule"
                id="ref-for-conditional-group-rule">conditional group rule</a> such as <a class="css"
                data-link-type="maybe" href="https://www.w3.org/TR/css-conditional-3/#at-ruledef-media"
                id="ref-for-at-ruledef-media">@media</a> or <a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-conditional-3/#at-ruledef-supports"
                id="ref-for-at-ruledef-supports">@supports</a>.</p>
        <p>When the <a class="css" data-link-type="maybe" href="#at-view-transition-rule"
                id="ref-for-at-view-transition-rule⑧">@view-transition</a> rule changes for <code
                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑨">Document</a></code>
            <var>document</var>, the user agent must <a data-link-type="dfn"
                href="#update-the-opt-in-state-for-outbound-transitions"
                id="ref-for-update-the-opt-in-state-for-outbound-transitions">update the opt-in state for outbound
                transitions</a> given <var>document</var>.
        </p>
        <p class="note" role="note"><span class="marker">Note:</span> this needs to be cached in the boolean because the
            result needs to be read <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                id="ref-for-in-parallel">in parallel</a>, when navigating.</p>
        <h4 class="heading settled" data-level="2.3.2" id="view-transition-navigation-descriptor"><span
                class="secno">2.3.2. </span><span class="content">The <a data-link-type="dfn"
                    href="#view-transition-navigation" id="ref-for-view-transition-navigation①">navigation</a>
                descriptor</span><a class="self-link" href="#view-transition-navigation-descriptor"></a></h4>
        <table class="def descdef">
            <tbody>
                <tr>
                    <th>Name:
                    <td><dfn class="dfn-paneled css" data-dfn-for="@view-transition" data-dfn-type="descriptor"
                            data-export id="descdef-view-transition-navigation">navigation</dfn>
                <tr>
                    <th>For:
                    <td><a class="css" data-link-type="at-rule" href="#at-view-transition-rule"
                            id="ref-for-at-view-transition-rule⑨">@view-transition</a>
                <tr>
                    <th>Value:
                    <td class="prod">auto <a data-link-type="grammar"
                            href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one">|</a> none
                <tr>
                    <th>Initial:
                    <td>none
        </table>
        <p>The '<dfn class="dfn-paneled" data-dfn-for="@view-transition" data-dfn-type="dfn" data-noexport
                id="view-transition-navigation">navigation</dfn>' descriptor opts in to automatically starting a view
            transition when performing a navigation of a certain type.
            Must be present on both the old and new document.</p>
        <dl>
            <dt data-md><dfn class="dfn-paneled css" data-dfn-for="@view-transition/navigation" data-dfn-type="value"
                    data-export id="valdef-view-transition-navigation-none">none</dfn>
            <dd data-md>
                <p>There will be no transition.</p>
            <dt data-md><dfn class="dfn-paneled css" data-dfn-for="@view-transition/navigation" data-dfn-type="value"
                    data-export id="valdef-view-transition-navigation-auto">auto</dfn>
            <dd data-md>
                <p>The transition will be enabled if the navigation is same-origin, without cross-origin
                    redirects, and whose <code
                        class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#navigationtype" id="ref-for-navigationtype">NavigationType</a></code>
                    is</p>
                <ul>
                    <li data-md>
                        <p><code
                                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-traverse" id="ref-for-dom-navigationtype-traverse①">traverse</a></code>,
                            or</p>
                    <li data-md>
                        <p><code
                                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-push" id="ref-for-dom-navigationtype-push">push</a></code>
                            or <code
                                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-replace" id="ref-for-dom-navigationtype-replace">replace</a></code>,
                            with <a
                                href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#user-navigation-involvement">user
                                navigation involvement</a> not equal to <code>"browser UI"</code>.</p>
                </ul>
                <p class="note" role="note"><span class="marker">Note:</span> Navigations excluded from <a class="css"
                        data-link-type="maybe" href="#valdef-view-transition-navigation-auto"
                        id="ref-for-valdef-view-transition-navigation-auto">auto</a> are for example, navigating
                    via the URL address bar or clicking a bookmark, as well as any form of user or script initiated
                    <code
                        class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-reload" id="ref-for-dom-navigationtype-reload">reload</a></code>.
                </p>
        </dl>
        <h4 class="heading settled" data-level="2.3.3" id="cssom"><span class="secno">2.3.3. </span><span
                class="content">Accessing the <a class="css" data-link-type="maybe" href="#at-view-transition-rule"
                    id="ref-for-at-view-transition-rule①⓪">@view-transition</a> rule using CSSOM</span><a
                class="self-link" href="#cssom"></a></h4>
        <p>The <code>CSSRule</code> interface is extended as follows:</p>
        <pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/cssom-1/#cssrule" id="ref-for-cssrule"><c- g>CSSRule</c-></a> {
  <c- b>const</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short" id="ref-for-idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="CSSRule" data-dfn-type="const" data-export id="dom-cssrule-view_transition_rule"><code><c- g>VIEW_TRANSITION_RULE</c-></code></dfn> = 15;
};
</pre>
        <p>The <code
                class="idl"><a data-link-type="idl" href="#cssviewtransitionrule" id="ref-for-cssviewtransitionrule">CSSViewTransitionRule</a></code>
            represents a <a class="css" data-link-type="maybe" href="#at-view-transition-rule"
                id="ref-for-at-view-transition-rule①①">@view-transition</a> rule.</p>
        <pre class="idl highlight def"><c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-viewtransitionnavigation"><code><c- g>ViewTransitionNavigation</c-></code></dfn> { <dfn class="dfn-paneled idl-code" data-dfn-for="ViewTransitionNavigation" data-dfn-type="enum-value" data-export id="dom-viewtransitionnavigation-auto"><code><c- s>"auto"</c-></code></dfn>, <dfn class="dfn-paneled idl-code" data-dfn-for="ViewTransitionNavigation" data-dfn-type="enum-value" data-export id="dom-viewtransitionnavigation-none"><code><c- s>"none"</c-></code></dfn> };

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="cssviewtransitionrule"><code><c- g>CSSViewTransitionRule</c-></code></dfn> : <a data-link-type="idl-name" href="https://www.w3.org/TR/cssom-1/#cssrule" id="ref-for-cssrule①"><c- n>CSSRule</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-viewtransitionnavigation" id="ref-for-enumdef-viewtransitionnavigation"><c- n>ViewTransitionNavigation</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="CSSViewTransitionRule" data-dfn-type="attribute" data-export data-readonly data-type="ViewTransitionNavigation" id="dom-cssviewtransitionrule-navigation"><code><c- g>navigation</c-></code></dfn>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array" id="ref-for-idl-frozen-array"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="https://www.w3.org/TR/cssom-1/#cssomstring" id="ref-for-cssomstring"><c- n>CSSOMString</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="CSSViewTransitionRule" data-dfn-type="attribute" data-export data-readonly data-type="FrozenArray<CSSOMString>" id="dom-cssviewtransitionrule-types"><code><c- g>types</c-></code></dfn>;
};
</pre>
        <h2 class="heading settled" data-level="3" id="selective-vt"><span class="secno">3. </span><span
                class="content">Selective view transitions</span><a class="self-link" href="#selective-vt"></a></h2>
        <h3 class="heading settled" data-level="3.1" id="selective-vt-overview"><span class="secno">3.1. </span><span
                class="content">Overview</span><a class="self-link" href="#selective-vt-overview"></a></h3>
        <p><em>This section is non-normative.</em></p>
        <p>For simple pages, with a single view transition, setting the <span class="css">view-transition-name</span>
            property on participating elements should be sufficient.
            However, in more complex scenarios, the author might want to declare various view transitions, and only run
            one of them simultaneously.
            For example, sliding the whole page when clicking on the navigation bar, and sorting a list when one if its
            items is dragged.</p>
        <p>To make sure each view transition only captures what it needs to, and different transitions don’t interfere
            with each other,
            this spec introduces the concept of <a data-link-type="dfn" href="#viewtransition-active-types"
                id="ref-for-viewtransition-active-types">active types</a>, alongside the <a class="css"
                data-link-type="maybe" href="#active-view-transition-pseudo"
                id="ref-for-active-view-transition-pseudo">:active-view-transition</a> and <a class="css"
                data-link-type="maybe" href="#active-view-transition-type-pseudo"
                id="ref-for-active-view-transition-type-pseudo">:active-view-transition-type()</a> pseudo-classes.</p>
        <p><a class="css" data-link-type="maybe" href="#active-view-transition-pseudo"
                id="ref-for-active-view-transition-pseudo①">:active-view-transition</a> matches the <a
                data-link-type="dfn" href="https://dom.spec.whatwg.org/#document-element"
                id="ref-for-document-element">document element</a> when it has an <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition"
                id="ref-for-document-active-view-transition①">active view transition</a>, and <a class="css"
                data-link-type="maybe" href="#active-view-transition-type-pseudo"
                id="ref-for-active-view-transition-type-pseudo①">:active-view-transition-type()</a> matches the <span
                id="ref-for-document-element①">document element</span> if the types in the selectors match the <span
                id="ref-for-document-active-view-transition②">active view transition</span>'s <a data-link-type="dfn"
                href="#viewtransition-active-types" id="ref-for-viewtransition-active-types①">active types</a>.</p>
        <p>The <code
                class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition⑧">ViewTransition</a></code>'s
            <a data-link-type="dfn" href="#viewtransition-active-types" id="ref-for-viewtransition-active-types②">active
                types</a> are populated in one of the following ways:
        </p>
        <ol>
            <li data-md>
                <p>Passed as part of the arguments to <code
                        class="idl"><a data-link-type="idl" href="#dom-document-startviewtransition" id="ref-for-dom-document-startviewtransition③">startViewTransition(callbackOptions)</a></code>
                </p>
            <li data-md>
                <p>Mutated at any time, using the transition’s <code
                        class="idl"><a data-link-type="idl" href="#dom-viewtransition-types" id="ref-for-dom-viewtransition-types④">types</a></code>
                </p>
            <li data-md>
                <p>Declared for a cross-document view transition, using the <a data-link-type="dfn"
                        href="#view-transition-types" id="ref-for-view-transition-types①">types</a> descriptor.</p>
        </ol>
        <h3 class="heading settled" data-level="3.2" id="active-view-transition-pseudo-examples"><span
                class="secno">3.2. </span><span class="content">Examples</span><a class="self-link"
                href="#active-view-transition-pseudo-examples"></a></h3>
        <div class="example" id="example-fcb7f482">
            <a class="self-link" href="#example-fcb7f482"></a> For example, the developer might start a transition in
            the following manner:
            <pre class="language-js highlight">document<c- p>.</c->startViewTransition<c- p>({</c->update<c- o>:</c-> updateTheDOMSomehow<c- p>,</c-> types<c- o>:</c-> <c- p>[</c-><c- u>"slide-in"</c-><c- p>,</c-> <c- u>"reverse"</c-><c- p>]});</c->
</pre>
            <p>This will activate any of the following selectors:</p>
            <pre class="language-css highlight">:root<c- nf>:active-view-transition-type</c-><c- p>(</c->slide-in<c- p>)</c-> <c- p>{}</c->
:root<c- nf>:active-view-transition-type</c-><c- p>(</c->reverse<c- p>)</c-> <c- p>{}</c->
:root<c- nf>:active-view-transition-type</c-><c- p>(</c->slide-in<c- p>,</c-> reverse<c- p>)</c-> <c- p>{}</c->
:root<c- nf>:active-view-transition-type</c-><c- p>(</c->slide-in<c- p>,</c-> something-else<c- p>)</c-> <c- p>{}</c->
:root:active-view-transition <c- p>{}</c->
</pre>
            <p>While starting a transition without providing transition types, would only activate
                ':active-view-transition'':</p>
            <pre class="language-js highlight">document<c- p>.</c->startViewTransition<c- p>(</c->updateTheDOMSomehow<c- p>);</c->
<c- c1>// or</c->
document<c- p>.</c->startViewTransition<c- p>({</c->update<c- o>:</c-> updateTheDOMSomehow<c- p>});</c->
</pre>
            <pre class="language-css highlight"><c- c>/* This would be active */</c->
:root <c- p>{</c-> <c- p>}</c->
:root:active-view-transition <c- p>{}</c->

<c- c>/* This would not be active */</c->
:root<c- nf>:active-view-transition-type</c-><c- p>(</c->slide-in<c- p>)</c-> <c- p>{}</c->
:root<c- nf>:active-view-transition-type</c-><c- p>(</c->any-type-at-all-except-star<c- p>)</c-> <c- p>{}</c->
</pre>
        </div>
        <h3 class="heading settled" data-level="3.3" id="pseudo-classes-for-selective-vt"><span class="secno">3.3.
            </span><span class="content">Selecting based on the active view transition</span><a class="self-link"
                href="#pseudo-classes-for-selective-vt"></a></h3>
        <h4 class="heading settled" data-level="3.3.1" id="the-active-view-transition-pseudo"><span class="secno">3.3.1.
            </span><span class="content">The <a class="css" data-link-type="maybe" href="#active-view-transition-pseudo"
                    id="ref-for-active-view-transition-pseudo②">:active-view-transition</a> pseudo-class</span><a
                class="self-link" href="#the-active-view-transition-pseudo"></a></h4>
        <p>The <dfn class="dfn-paneled css" data-dfn-type="selector" data-export
                id="active-view-transition-pseudo">:active-view-transition</dfn> pseudo-class applies to the root
            element of the document, if it has an <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition"
                id="ref-for-document-active-view-transition③">active view transition</a>.</p>
        <p>The <a data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#specificity"
                id="ref-for-specificity">specificity</a> of an <a class="css" data-link-type="maybe"
                href="#active-view-transition-pseudo"
                id="ref-for-active-view-transition-pseudo③">:active-view-transition</a> is one pseudo-class selector.
        </p>
        <p>An <a class="css" data-link-type="maybe" href="#active-view-transition-pseudo"
                id="ref-for-active-view-transition-pseudo④">:active-view-transition</a> pseudo-class matches the <a
                data-link-type="dfn" href="https://dom.spec.whatwg.org/#document-element"
                id="ref-for-document-element②">document element</a> when its <a data-link-type="dfn"
                href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document">node
                document</a> has an non-null <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition"
                id="ref-for-document-active-view-transition④">active view transition</a>.</p>
        <h4 class="heading settled" data-level="3.3.2" id="the-active-view-transition-type-pseudo"><span
                class="secno">3.3.2. </span><span class="content">The <a class="css" data-link-type="maybe"
                    href="#active-view-transition-type-pseudo"
                    id="ref-for-active-view-transition-type-pseudo②">:active-view-transition-type()</a>
                pseudo-class</span><a class="self-link" href="#the-active-view-transition-type-pseudo"></a></h4>
        <p>The <dfn class="dfn-paneled css" data-dfn-type="selector" data-export
                id="active-view-transition-type-pseudo">:active-view-transition-type()</dfn> pseudo-class applies to the
            root element of the document, if it has a matching <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition"
                id="ref-for-document-active-view-transition⑤">active view transition</a>.
            It has the following syntax definition:</p>
        <pre class="prod">:active-view-transition-type(<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#identifier-value" id="ref-for-identifier-value">&lt;custom-ident></a><a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-comma" id="ref-for-mult-comma">#</a>)
</pre>
        <p>The <a data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#specificity"
                id="ref-for-specificity①">specificity</a> of an <a class="css" data-link-type="maybe"
                href="#active-view-transition-type-pseudo"
                id="ref-for-active-view-transition-type-pseudo③">:active-view-transition-type()</a> is one pseudo-class
            selector.</p>
        <p>An <a class="css" data-link-type="maybe" href="#active-view-transition-type-pseudo"
                id="ref-for-active-view-transition-type-pseudo④">:active-view-transition-type()</a> pseudo-class matches
            the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#document-element"
                id="ref-for-document-element③">document element</a> when its <a data-link-type="dfn"
                href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document①">node
                document</a> has an non-null <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition"
                id="ref-for-document-active-view-transition⑥">active view transition</a>,
            whose <a data-link-type="dfn" href="#viewtransition-active-types"
                id="ref-for-viewtransition-active-types③">active types</a> <a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">contains</a> at least one
            of the <a class="production css" data-link-type="type"
                href="https://www.w3.org/TR/css-values-4/#identifier-value"
                id="ref-for-identifier-value①">&lt;custom-ident></a> arguments.</p>
        <h3 class="heading settled" data-level="3.4" id="view-transitions-extension-types"><span class="secno">3.4.
            </span><span class="content">Changing the types of an ongoing view transition</span><a class="self-link"
                href="#view-transitions-extension-types"></a></h3>
        <p>The <code
                class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition⑨">ViewTransition</a></code>
            interface is extended as follows:</p>
        <pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="viewtransitiontypeset"><code><c- g>ViewTransitionTypeSet</c-></code></dfn> {
  <c- b>setlike</c->&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a>>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed②"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition①⓪"><c- g>ViewTransition</c-></a> {
  <c- b>attribute</c-> <a data-link-type="idl-name" href="#viewtransitiontypeset" id="ref-for-viewtransitiontypeset"><c- n>ViewTransitionTypeSet</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="ViewTransition" data-dfn-type="attribute" data-export data-type="ViewTransitionTypeSet" id="dom-viewtransition-types"><code><c- g>types</c-></code></dfn>;
};
</pre>
        <p>The <code
                class="idl"><a data-link-type="idl" href="#viewtransitiontypeset" id="ref-for-viewtransitiontypeset①">ViewTransitionTypeSet</a></code>
            object represents a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set"
                id="ref-for-ordered-set">set</a> of strings, without special semantics.</p>
        <p class="note" role="note"><span class="marker">Note:</span> a <code
                class="idl"><a data-link-type="idl" href="#viewtransitiontypeset" id="ref-for-viewtransitiontypeset②">ViewTransitionTypeSet</a></code>
            can contain strings that are invalid for <span class="css">:active-view-transition-type</span>, e.g.
            strings that are not a <a class="production css" data-link-type="type"
                href="https://www.w3.org/TR/css-values-4/#identifier-value"
                id="ref-for-identifier-value②">&lt;custom-ident></a>.</p>
        <p>The <code
                class="idl"><a data-link-type="idl" href="#dom-viewtransition-types" id="ref-for-dom-viewtransition-types⑤">types</a></code>
            <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#getter-steps" id="ref-for-getter-steps">getter
                steps</a> are to return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this"
                id="ref-for-this">this</a>'s <a data-link-type="dfn" href="#viewtransition-active-types"
                id="ref-for-viewtransition-active-types④">active types</a>.
        </p>
        <h3 class="heading settled" data-level="3.5" id="types-cross-doc"><span class="secno">3.5. </span><span
                class="content">Activating the transition type for cross-document view transitions</span><a
                class="self-link" href="#types-cross-doc"></a></h3>
        <p>The <a data-link-type="dfn" href="#view-transition-types" id="ref-for-view-transition-types②">types</a>
            descriptor</p>
        <table class="def descdef">
            <tbody>
                <tr>
                    <th>Name:
                    <td><dfn class="dfn-paneled css" data-dfn-for="@view-transition" data-dfn-type="descriptor"
                            data-export id="descdef-view-transition-types">types</dfn>
                <tr>
                    <th>For:
                    <td><a class="css" data-link-type="at-rule" href="#at-view-transition-rule"
                            id="ref-for-at-view-transition-rule①②">@view-transition</a>
                <tr>
                    <th>Value:
                    <td class="prod">none <a data-link-type="grammar"
                            href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①">|</a> <a
                            class="production css" data-link-type="type"
                            href="https://www.w3.org/TR/css-values-4/#identifier-value"
                            id="ref-for-identifier-value③">&lt;custom-ident></a><a data-link-type="grammar"
                            href="https://www.w3.org/TR/css-values-4/#mult-one-plus" id="ref-for-mult-one-plus">+</a>
                <tr>
                    <th>Initial:
                    <td>none
        </table>
        <p>The '<dfn class="dfn-paneled" data-dfn-for="@view-transition" data-dfn-type="dfn" data-noexport
                id="view-transition-types">types</dfn>' descriptor sets the <a data-link-type="dfn"
                href="#viewtransition-active-types" id="ref-for-viewtransition-active-types⑤">active types</a> for the
            transition
            when capturing or performing the transition, equivalent to calling <code
                class="idl"><a data-link-type="idl" href="#dom-document-startviewtransition" id="ref-for-dom-document-startviewtransition④">startViewTransition(callbackOptions)</a></code>
            with that <code
                class="idl"><a data-link-type="idl" href="#dom-startviewtransitionoptions-types" id="ref-for-dom-startviewtransitionoptions-types">types</a></code>.
        </p>
        <p class="note" role="note"><span class="marker">Note:</span> the <a data-link-type="dfn"
                href="#view-transition-types" id="ref-for-view-transition-types③">types</a> descriptor only applies to
            the <code
                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⓪">Document</a></code>
            in which it is defined.
            The author is responsible for using their chosen set of types in both documents.</p>
        <h2 class="heading settled" data-level="4" id="shared-style-with-vt-classes"><span class="secno">4. </span><span
                class="content">Sharing styles between view transition pseudo-elements</span><a class="self-link"
                href="#shared-style-with-vt-classes"></a></h2>
        <h3 class="heading settled" data-level="4.1" id="shared-style-overview"><span class="secno">4.1. </span><span
                class="content">Overview</span><a class="self-link" href="#shared-style-overview"></a></h3>
        <p><em>This section is non-normative.</em></p>
        <p>When styling multiple elements in the DOM in a similar way, it is common to use the <a data-link-type="dfn"
                href="https://dom.spec.whatwg.org/#concept-class" id="ref-for-concept-class">class</a> attribute:
            setting a name that’s shared across multiple elements, and then using the <a data-link-type="dfn"
                href="https://www.w3.org/TR/selectors-4/#class-selector" id="ref-for-class-selector">class selector</a>
            to declare the shared style.</p>
        <p><a data-link-type="dfn"
                href="https://www.w3.org/TR/css-view-transitions-1/#named-view-transition-pseudo-elements"
                id="ref-for-named-view-transition-pseudo-elements">The view transition pseudo-elements</a> (e.g. <span
                class="css">view-transition-group()</span>) are not defined in the DOM, but rather by using the <span
                class="css">view-transition-name</span> property.
            For that purpose, the <span class="css">view-transition-class</span>' CSS property provides view transitions
            with the equivalent of HTML <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-class"
                id="ref-for-concept-class①">classes</a>.
            When an element with a <span class="css">view-transition-name</span> also has a <span
                class="css">view-transition-class</span> value, that class would be selectable by the pseudo-elements,
            as per the <a href="#vt-class-example">examples</a>.</p>
        <h3 class="heading settled" data-level="4.2" id="vt-class-example"><span class="secno">4.2. </span><span
                class="content">Examples</span><a class="self-link" href="#vt-class-example"></a></h3>
        <div class="example" id="example-f2466484">
            <a class="self-link" href="#example-f2466484"></a> This example creates a transition with each box
            participating under its own name, while applying
            a 1-second duration to the animation of all the boxes:
            <pre class="language-html highlight"><c- p>&lt;</c-><c- f>div</c-> <c- e>class</c-><c- o>=</c-><c- s>"box"</c-> <c- e>id</c-><c- o>=</c-><c- s>"red-box"</c-><c- p>>&lt;/</c-><c- f>div</c-><c- p>></c->
<c- p>&lt;</c-><c- f>div</c-> <c- e>class</c-><c- o>=</c-><c- s>"box"</c-> <c- e>id</c-><c- o>=</c-><c- s>"green-box"</c-><c- p>>&lt;/</c-><c- f>div</c-><c- p>></c->
<c- p>&lt;</c-><c- f>div</c-> <c- e>class</c-><c- o>=</c-><c- s>"box"</c-> <c- e>id</c-><c- o>=</c-><c- s>"yellow-box"</c-><c- p>>&lt;/</c-><c- f>div</c-><c- p>></c->
</pre>
            <pre class="language-css highlight">div.box <c- p>{</c->
  <c- k>view-transition-class</c-><c- p>:</c-> any-box<c- p>;</c->
  <c- k>width</c-><c- p>:</c-> <c- m>100</c-><c- k>px</c-><c- p>;</c->
  <c- k>height</c-><c- p>:</c-> <c- m>100</c-><c- k>px</c-><c- p>;</c->
<c- p>}</c->
#red-box <c- p>{</c->
  <c- k>view-transition-name</c-><c- p>:</c-> red-box<c- p>;</c->
  <c- k>background</c-><c- p>:</c-> red<c- p>;</c->
<c- p>}</c->
#green-box <c- p>{</c->
  <c- k>view-transition-name</c-><c- p>:</c-> green-box<c- p>;</c->
  <c- k>background</c-><c- p>:</c-> green<c- p>;</c->
<c- p>}</c->
#yellow-box <c- p>{</c->
  <c- k>view-transition-name</c-><c- p>:</c-> yellow-box<c- p>;</c->
  <c- k>background</c-><c- p>:</c-> yellow<c- p>;</c->
<c- p>}</c->

<c- c>/* The following style would apply to all the boxes, thanks to 'view-transition-class' */</c->
:<c- nf>:view-transition-group</c-><c- p>(</c->*.any-box<c- p>)</c-> <c- p>{</c->
  <c- k>animation-duration</c-><c- p>:</c-> <c- m>1</c-><c- k>s</c-><c- p>;</c->
<c- p>}</c->
</pre>
        </div>
        <h3 class="heading settled" data-level="4.3" id="view-transition-class-prop"><span class="secno">4.3.
            </span><span class="content">The <a class="property css" data-link-type="property"
                    href="#propdef-view-transition-class"
                    id="ref-for-propdef-view-transition-class①">view-transition-class</a> property</span><a
                class="self-link" href="#view-transition-class-prop"></a></h3>
        <table class="def propdef" data-link-for-hint="view-transition-class">
            <tbody>
                <tr>
                    <th>Name:
                    <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export
                            id="propdef-view-transition-class">view-transition-class</dfn>
                <tr class="value">
                    <th><a href="https://www.w3.org/TR/css-values/#value-defs">Value:</a>
                    <td class="prod">none <a data-link-type="grammar"
                            href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②">|</a> <a
                            class="production css" data-link-type="type"
                            href="https://www.w3.org/TR/css-values-4/#identifier-value"
                            id="ref-for-identifier-value④">&lt;custom-ident></a><a data-link-type="grammar"
                            href="https://www.w3.org/TR/css-values-4/#mult-one-plus" id="ref-for-mult-one-plus①">+</a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">Initial:</a>
                    <td>none
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">Applies to:</a>
                    <td><a href="https://www.w3.org/TR/css-pseudo/#generated-content"
                            title="Includes ::before and ::after pseudo-elements.">all elements</a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">Inherited:</a>
                    <td>no
                <tr>
                    <th><a href="https://www.w3.org/TR/css-values/#percentages">Percentages:</a>
                    <td>n/a
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#computed">Computed value:</a>
                    <td>as specified
                <tr>
                    <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">Canonical order:</a>
                    <td>per grammar
                <tr>
                    <th><a href="https://www.w3.org/TR/web-animations/#animation-type">Animation type:</a>
                    <td>discrete
        </table>
        <p>The <a class="property css" data-link-type="property" href="#propdef-view-transition-class"
                id="ref-for-propdef-view-transition-class②">view-transition-class</a> can be used to apply the same
            style rule to multiple <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-view-transitions-1/#named-view-transition-pseudo-elements"
                id="ref-for-named-view-transition-pseudo-elements①">named view transition pseudo-elements</a> which may
            have a different <a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-view-transitions-1/#propdef-view-transition-name"
                id="ref-for-propdef-view-transition-name">view-transition-name</a>.
            While <span class="property" id="ref-for-propdef-view-transition-name①">view-transition-name</span> is used
            to match between the element in the old state with its corresponding element in the new state, <span
                class="property" id="ref-for-propdef-view-transition-class③">view-transition-class</span> is used
            only to apply styles using the view transitionpseudo-elements
            (<a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-group"
                id="ref-for-selectordef-view-transition-group">::view-transition-group()</a>, <a class="css"
                data-link-type="maybe"
                href="https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-image-pair"
                id="ref-for-selectordef-view-transition-image-pair">::view-transition-image-pair()</a>, <a class="css"
                data-link-type="maybe"
                href="https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-old"
                id="ref-for-selectordef-view-transition-old">::view-transition-old()</a>, <a class="css"
                data-link-type="maybe"
                href="https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-new"
                id="ref-for-selectordef-view-transition-new">::view-transition-new()</a>).</p>
        <p>Note that <a class="property css" data-link-type="property" href="#propdef-view-transition-class"
                id="ref-for-propdef-view-transition-class④">view-transition-class</a> by itself doesn’t mark an element
            for capturing, it is only used as an additional
            way to style an element that already has a <a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-view-transitions-1/#propdef-view-transition-name"
                id="ref-for-propdef-view-transition-name②">view-transition-name</a>.</p>
        <dl>
            <dt data-md><dfn class="dfn-paneled css" data-dfn-for="view-transition-class" data-dfn-type="value"
                    data-export id="valdef-view-transition-class-none">none</dfn>
            <dd data-md>
                <p>No class would apply to the <a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-view-transitions-1/#named-view-transition-pseudo-elements"
                        id="ref-for-named-view-transition-pseudo-elements②">named view transition pseudo-elements</a>
                    generated for this element.</p>
            <dt data-md><dfn class="dfn-paneled css" data-dfn-for="view-transition-class" data-dfn-type="value"
                    data-export id="valdef-view-transition-class-custom-ident"><a class="production css"
                        data-link-type="type" href="https://www.w3.org/TR/css-values-4/#identifier-value"
                        id="ref-for-identifier-value⑤">&lt;custom-ident></a>+</dfn>
            <dd data-md>
                <p>All of the specified <a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#identifier-value"
                        id="ref-for-identifier-value⑥">&lt;custom-ident></a> values (apart from <span
                        class="css">none</span>) are applied when used in <a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-view-transitions-1/#named-view-transition-pseudo-elements"
                        id="ref-for-named-view-transition-pseudo-elements③">named view transition pseudo-element</a>
                    selectors. <span class="css">none</span> is an invalid <span class="production"
                        id="ref-for-identifier-value⑦">&lt;custom-ident></span> for <a class="property css"
                        data-link-type="property" href="#propdef-view-transition-class"
                        id="ref-for-propdef-view-transition-class⑤">view-transition-class</a>, even when combined with
                    another <span class="production" id="ref-for-identifier-value⑧">&lt;custom-ident></span>.</p>
                <p class="note" role="note"><span class="marker">Note:</span> If the same <a class="property css"
                        data-link-type="property"
                        href="https://www.w3.org/TR/css-view-transitions-1/#propdef-view-transition-name"
                        id="ref-for-propdef-view-transition-name③">view-transition-name</a> is specified for an element
                    both in the old and new states of the transition,
                    only the <a class="property css" data-link-type="property" href="#propdef-view-transition-class"
                        id="ref-for-propdef-view-transition-class⑥">view-transition-class</a> values from the new state
                    apply. This also applies for cross-document view transitions:
                    classes from the old document would only apply if their corresponding <span class="property"
                        id="ref-for-propdef-view-transition-name④">view-transition-name</span> was not specified in the
                    new document.</p>
        </dl>
        <h3 class="heading settled" data-level="4.4" id="pseudo-element-class-additions"><span class="secno">4.4.
            </span><span class="content">Additions to named view transition pseudo-elements</span><a class="self-link"
                href="#pseudo-element-class-additions"></a></h3>
        <p>The <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-view-transitions-1/#named-view-transition-pseudo-elements"
                id="ref-for-named-view-transition-pseudo-elements④">named view transition pseudo-elements</a> (<span
                class="css">view-transition-group()</span>, <span class="css">view-transition-image-pair()</span>, <span
                class="css">view-transition-old()</span>, <span class="css">view-transition-new()</span>)
            are extended to support the following syntax:</p>
        <pre class="prod">::view-transition-group(<a class="production" data-link-type="type" href="#typedef-pt-name-and-class-selector" id="ref-for-typedef-pt-name-and-class-selector">&lt;pt-name-and-class-selector></a>)
::view-transition-image-pair(<a class="production" data-link-type="type" href="#typedef-pt-name-and-class-selector" id="ref-for-typedef-pt-name-and-class-selector①">&lt;pt-name-and-class-selector></a>)
::view-transition-old(<a class="production" data-link-type="type" href="#typedef-pt-name-and-class-selector" id="ref-for-typedef-pt-name-and-class-selector②">&lt;pt-name-and-class-selector></a>)
::view-transition-new(<a class="production" data-link-type="type" href="#typedef-pt-name-and-class-selector" id="ref-for-typedef-pt-name-and-class-selector③">&lt;pt-name-and-class-selector></a>)
</pre>
        <p>where <a class="production css" data-link-type="type"
                href="https://www.w3.org/TR/css-view-transitions-1/#typedef-pt-name-selector"
                id="ref-for-typedef-pt-name-selector">&lt;pt-name-selector></a> works as previously defined, and <a
                class="production css" data-link-type="type" href="#typedef-pt-name-and-class-selector"
                id="ref-for-typedef-pt-name-and-class-selector④">&lt;pt-name-and-class-selector></a> has the following
            syntax definition:</p>
        <pre class="prod"><dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-pt-name-and-class-selector">&lt;pt-name-and-class-selector></dfn> = <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-view-transitions-1/#typedef-pt-name-selector" id="ref-for-typedef-pt-name-selector①">&lt;pt-name-selector></a> <a class="production" data-link-type="type" href="#typedef-pt-class-selector" id="ref-for-typedef-pt-class-selector">&lt;pt-class-selector></a><a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt">?</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③">|</a> <a class="production" data-link-type="type" href="#typedef-pt-class-selector" id="ref-for-typedef-pt-class-selector①">&lt;pt-class-selector></a>
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-pt-class-selector">&lt;pt-class-selector></dfn> = ['.' <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#identifier-value" id="ref-for-identifier-value⑨">&lt;custom-ident></a>]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-one-plus" id="ref-for-mult-one-plus②">+</a>
</pre>
        <p>When interpreting the above grammar, white space is forbidden:</p>
        <ul>
            <li data-md>
                <p>Between <a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-view-transitions-1/#typedef-pt-name-selector"
                        id="ref-for-typedef-pt-name-selector②">&lt;pt-name-selector></a> and <a class="production css"
                        data-link-type="type" href="#typedef-pt-class-selector"
                        id="ref-for-typedef-pt-class-selector②">&lt;pt-class-selector></a></p>
            <li data-md>
                <p>Between any of the components of <a class="production css" data-link-type="type"
                        href="#typedef-pt-class-selector"
                        id="ref-for-typedef-pt-class-selector③">&lt;pt-class-selector></a>.</p>
        </ul>
        <p>A <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-view-transitions-1/#named-view-transition-pseudo-elements"
                id="ref-for-named-view-transition-pseudo-elements⑤">named view transition pseudo-element</a> <a
                data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#selector"
                id="ref-for-selector">selector</a> which has one or more <a class="production css" data-link-type="type"
                href="https://www.w3.org/TR/css-values-4/#identifier-value"
                id="ref-for-identifier-value①⓪">&lt;custom-ident></a> values
            in its <a class="production css" data-link-type="type" href="#typedef-pt-class-selector"
                id="ref-for-typedef-pt-class-selector④">&lt;pt-class-selector></a> would only match an element if the <a
                data-link-type="dfn" href="#captured-element-class-list" id="ref-for-captured-element-class-list">class
                list</a> value in <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition-named-elements"
                id="ref-for-viewtransition-named-elements">named elements</a> for the pseudo-element’s <a
                class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-view-transitions-1/#propdef-view-transition-name"
                id="ref-for-propdef-view-transition-name⑤">view-transition-name</a> <a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain①">contains</a> all of those
            values.</p>
        <p>The <a data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#specificity"
                id="ref-for-specificity②">specificity</a> of a <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-view-transitions-1/#named-view-transition-pseudo-elements"
                id="ref-for-named-view-transition-pseudo-elements⑥">named view transition pseudo-element</a> <a
                data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#selector"
                id="ref-for-selector①">selector</a> with either:</p>
        <ul>
            <li data-md>
                <p>a <a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-view-transitions-1/#typedef-pt-name-selector"
                        id="ref-for-typedef-pt-name-selector③">&lt;pt-name-selector></a> with a <a
                        class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#identifier-value"
                        id="ref-for-identifier-value①①">&lt;custom-ident></a>; or</p>
            <li data-md>
                <p>a <a class="production css" data-link-type="type" href="#typedef-pt-class-selector"
                        id="ref-for-typedef-pt-class-selector⑤">&lt;pt-class-selector></a> with at least one <a
                        class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#identifier-value"
                        id="ref-for-identifier-value①②">&lt;custom-ident></a>,</p>
        </ul>
        <p>is equivalent to a <a data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#type-selector"
                id="ref-for-type-selector">type selector</a>.</p>
        <p>The <a data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#specificity"
                id="ref-for-specificity③">specificity</a> of a <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-view-transitions-1/#named-view-transition-pseudo-elements"
                id="ref-for-named-view-transition-pseudo-elements⑦">named view transition pseudo-element</a> <a
                data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#selector"
                id="ref-for-selector②">selector</a> with a <a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/selectors-3/#x" id="ref-for-x">*</a> argument and with an empty <a
                class="production css" data-link-type="type" href="#typedef-pt-class-selector"
                id="ref-for-typedef-pt-class-selector⑥">&lt;pt-class-selector></a> is zero.</p>
        <h2 class="heading settled" data-level="5" id="extend-document-types"><span class="secno">5. </span><span
                class="content">Extending <code
                    class="idl"><a data-link-type="idl" href="#dom-document-startviewtransition" id="ref-for-dom-document-startviewtransition⑤">document.startViewTransition()</a></code></span><a
                class="self-link" href="#extend-document-types"></a></h2>
        <pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-startviewtransitionoptions"><code><c- g>StartViewTransitionOptions</c-></code></dfn> {
  <a data-link-type="idl-name" href="https://www.w3.org/TR/css-view-transitions-1/#callbackdef-updatecallback" id="ref-for-callbackdef-updatecallback"><c- n>UpdateCallback</c-></a>? <dfn class="dfn-paneled idl-code" data-default="null" data-dfn-for="StartViewTransitionOptions" data-dfn-type="dict-member" data-export data-type="UpdateCallback? " id="dom-startviewtransitionoptions-update"><code><c- g>update</c-></code></dfn> = <c- b>null</c->;
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence" id="ref-for-idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a>>? <dfn class="dfn-paneled idl-code" data-default="null" data-dfn-for="StartViewTransitionOptions" data-dfn-type="dict-member" data-export data-type="sequence<DOMString>? " id="dom-startviewtransitionoptions-types"><code><c- g>types</c-></code></dfn> = <c- b>null</c->;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①①"><c- g>Document</c-></a> {

  <a data-link-type="idl-name" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition①①"><c- n>ViewTransition</c-></a> <a class="idl-code" data-link-type="method" href="#dom-document-startviewtransition" id="ref-for-dom-document-startviewtransition⑥"><c- g>startViewTransition</c-></a>(<c- b>optional</c-> (<a data-link-type="idl-name" href="https://www.w3.org/TR/css-view-transitions-1/#callbackdef-updatecallback" id="ref-for-callbackdef-updatecallback①"><c- n>UpdateCallback</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#dictdef-startviewtransitionoptions" id="ref-for-dictdef-startviewtransitionoptions"><c- n>StartViewTransitionOptions</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-for="Document/startViewTransition(callbackOptions), Document/startViewTransition()" data-dfn-type="argument" data-export id="dom-document-startviewtransition-callbackoptions-callbackoptions"><code><c- g>callbackOptions</c-></code></dfn> = {});
};
</pre>
        <div class="algorithm" data-algorithm="start-vt-with-options">
            The <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#method-steps"
                id="ref-for-method-steps">method steps</a> for <dfn class="dfn-paneled idl-code" data-dfn-for="Document"
                data-dfn-type="method" data-export data-lt="startViewTransition(callbackOptions)|startViewTransition()"
                id="dom-document-startviewtransition"><code>startViewTransition(<var>callbackOptions</var>)</code></dfn>
            are as follows:
            <ol>
                <li data-md>
                    <p>Let <var>updateCallback</var> be null.</p>
                <li data-md>
                    <p>If <var>callbackOptions</var> is an an <code
                            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#callbackdef-updatecallback" id="ref-for-callbackdef-updatecallback②">UpdateCallback</a></code>,
                        set <var>updateCallback</var> to <var>callbackOptions</var>.</p>
                <li data-md>
                    <p>Otherwise, if <var>callbackOptions</var> is a <code
                            class="idl"><a data-link-type="idl" href="#dictdef-startviewtransitionoptions" id="ref-for-dictdef-startviewtransitionoptions①">StartViewTransitionOptions</a></code>,
                        then set <var>updateCallback</var> to <var>callbackOptions</var>’s <code
                            class="idl"><a data-link-type="idl" href="#dom-startviewtransitionoptions-update" id="ref-for-dom-startviewtransitionoptions-update">update</a></code>.
                    </p>
                <li data-md>
                    <p>If <var>this</var>’s <a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition"
                            id="ref-for-document-active-view-transition⑦">active view transition</a> is not null and its
                        <a data-link-type="dfn" href="#viewtransition-outbound-post-capture-steps"
                            id="ref-for-viewtransition-outbound-post-capture-steps">outbound post-capture steps</a> is
                        not null,
                        then:
                    </p>
                    <ol>
                        <li data-md>
                            <p>Let <var>preSkippedTransition</var> be a new <code
                                    class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition①②">ViewTransition</a></code>
                                in <var>this</var>’s <a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm"
                                    id="ref-for-concept-relevant-realm">relevant realm</a> whose <a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition-update-callback"
                                    id="ref-for-viewtransition-update-callback">update callback</a> is
                                <var>updateCallback</var>.
                            </p>
                            <p class="note" role="note"><span class="marker">Note:</span> The
                                <var>preSkippedTransition</var>’s <code
                                    class="idl"><a data-link-type="idl" href="#dom-viewtransition-types" id="ref-for-dom-viewtransition-types⑥">types</a></code>
                                are ignored here because the transition is never activated.
                            </p>
                        <li data-md>
                            <p><a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-view-transitions-1/#skip-the-view-transition"
                                    id="ref-for-skip-the-view-transition">Skip</a> <var>preSkippedTransition</var> with
                                an "<code
                                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror">InvalidStateError</a></code>"
                                <code
                                    class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException">DOMException</a></code>.
                            </p>
                        <li data-md>
                            <p>Return <var>preSkippedTransition</var>.</p>
                    </ol>
                    <p class="note" role="note"><span class="marker">Note:</span> This ensures that a same-document
                        transition that started after firing <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-pageswap" id="ref-for-event-pageswap②">pageswap</a></code>
                        is skipped.</p>
                <li data-md>
                    <p>Let <var>viewTransition</var> be the result of running the <a data-link-type="dfn"
                            href="https://webidl.spec.whatwg.org/#method-steps" id="ref-for-method-steps①">method
                            steps</a> for <code
                            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#dom-document-startviewtransition" id="ref-for-dom-document-startviewtransition⑦">startViewTransition(updateCallback)</a></code>
                        given <var>updateCallback</var>.</p>
                <li data-md>
                    <p>If <var>callbackOptions</var> is a <code
                            class="idl"><a data-link-type="idl" href="#dictdef-startviewtransitionoptions" id="ref-for-dictdef-startviewtransitionoptions②">StartViewTransitionOptions</a></code>,
                        set <var>viewTransition</var>’s <a data-link-type="dfn" href="#viewtransition-active-types"
                            id="ref-for-viewtransition-active-types⑥">active types</a> to a <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#list-clone" id="ref-for-list-clone">clone</a> of <code
                            class="idl"><a data-link-type="idl" href="#dom-startviewtransitionoptions-types" id="ref-for-dom-startviewtransitionoptions-types①">types</a></code>
                        as a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set"
                            id="ref-for-ordered-set①">set</a>.</p>
                <li data-md>
                    <p>Return <var>viewTransition</var>.</p>
            </ol>
        </div>
        <h2 class="heading settled" data-level="6" id="algorithms"><span class="secno">6. </span><span
                class="content">Algorithms</span><a class="self-link" href="#algorithms"></a></h2>
        <h3 class="heading settled" data-level="6.1" id="cross-doc-data-structures"><span class="secno">6.1.
            </span><span class="content">Data structures</span><a class="self-link"
                href="#cross-doc-data-structures"></a></h3>
        <h4 class="heading settled" data-level="6.1.1" id="cross-doc-data-structure-document"><span class="secno">6.1.1.
            </span><span class="content">Additions to <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①②">Document</a></code></span><a
                class="self-link" href="#cross-doc-data-structure-document"></a></h4>
        A <code
            class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①③">Document</a></code>
        additionaly has:
        <dl>
            <dt data-md><dfn class="dfn-paneled" data-dfn-for="document" data-dfn-type="dfn" data-noexport
                    id="document-inbound-view-transition-params">inbound view transition params</dfn>
            <dd data-md>
                <p>a <a data-link-type="dfn" href="#view-transition-params" id="ref-for-view-transition-params">view
                        transition params</a>, or null.
                    Initially null.</p>
            <dt data-md><dfn class="dfn-paneled" data-dfn-for="document" data-dfn-type="dfn" data-noexport
                    id="document-can-initiate-outbound-view-transition">can initiate outbound view transition</dfn>
            <dd data-md>
                <p>a boolean.
                    Initially false.</p>
                <p class="note" role="note"><span class="marker">Note:</span> this value can be read <a
                        data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                        id="ref-for-in-parallel①">in parallel</a> while navigating.</p>
        </dl>
        <h4 class="heading settled" data-level="6.1.2" id="cross-doc-data-structure-vt"><span class="secno">6.1.2.
            </span><span class="content">Additions to <code
                    class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition①③">ViewTransition</a></code></span><a
                class="self-link" href="#cross-doc-data-structure-vt"></a></h4>
        A <code
            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition①④">ViewTransition</a></code>
        additionally has:
        <dl>
            <dt data-md><dfn class="dfn-paneled" data-dfn-for="ViewTransition" data-dfn-type="dfn" data-noexport
                    id="viewtransition-active-types">active types</dfn>
            <dd data-md>
                <p>A <code
                        class="idl"><a data-link-type="idl" href="#viewtransitiontypeset" id="ref-for-viewtransitiontypeset③">ViewTransitionTypeSet</a></code>,
                    initially empty.</p>
            <dt data-md><dfn class="dfn-paneled" data-dfn-for="ViewTransition" data-dfn-type="dfn" data-noexport
                    id="viewtransition-outbound-post-capture-steps">outbound post-capture steps</dfn>
            <dd data-md>
                <p>Null or a set of steps, initially null.</p>
        </dl>
        <h4 class="heading settled" data-level="6.1.3" id="cross-doc-data-structure-serialization"><span
                class="secno">6.1.3. </span><span class="content">Serializable <a data-link-type="dfn"
                    href="#view-transition-params" id="ref-for-view-transition-params①">view transition
                    params</a></span><a class="self-link" href="#cross-doc-data-structure-serialization"></a></h4>
        A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="view-transition-params">view transition
            params</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct"
            id="ref-for-struct">struct</a> whose purpose is to serialize view transition information across documents.
        It has the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item"
            id="ref-for-struct-item">items</a>:
        <dl>
            <dt data-md><dfn class="dfn-paneled" data-dfn-for="view transition params" data-dfn-type="dfn" data-noexport
                    id="view-transition-params-named-elements">named elements</dfn>
            <dd data-md>
                <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map"
                        id="ref-for-ordered-map">map</a>, whose keys are strings and whose values are <a
                        data-link-type="dfn" href="https://www.w3.org/TR/css-view-transitions-1/#captured-element"
                        id="ref-for-captured-element①">captured elements</a>.</p>
            <dt data-md><dfn class="dfn-paneled" data-dfn-for="view transition params" data-dfn-type="dfn" data-noexport
                    id="view-transition-params-initial-snapshot-containing-block-size">initial snapshot containing block
                    size</dfn>
            <dd data-md>
                <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#tuple" id="ref-for-tuple">tuple</a> of
                    two numbers (width and height).</p>
        </dl>
        <h4 class="heading settled" data-level="6.1.4" id="capture-classes-data-structure"><span class="secno">6.1.4.
            </span><span class="content">Captured elements extension</span><a class="self-link"
                href="#capture-classes-data-structure"></a></h4>
        The <a data-link-type="dfn" href="https://www.w3.org/TR/css-view-transitions-1/#captured-element"
            id="ref-for-captured-element②">captured element</a> struct should contain these fields, in addition to the
        existing ones:
        <dl>
            <dt data-md><dfn class="dfn-paneled" data-dfn-for="captured element" data-dfn-type="dfn" data-noexport
                    id="captured-element-class-list">class list</dfn>
            <dd data-md>
                <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list">list</a> of
                    strings, initially empty.</p>
        </dl>
        <h3 class="heading settled" data-level="6.2" id="vt-rule-algo"><span class="secno">6.2. </span><span
                class="content">Resolving the <a class="css" data-link-type="maybe" href="#at-view-transition-rule"
                    id="ref-for-at-view-transition-rule①③">@view-transition</a> rule</span><a class="self-link"
                href="#vt-rule-algo"></a></h3>
        <div class="algorithm" data-algorithm="resolve @view-transition rule">
            To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="resolve-view-transition-rule">resolve
                @view-transition rule</dfn> for a <code
                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①④">Document</a></code>
            <var>document</var>:
            <p class="note" role="note"><span class="marker">Note:</span> this is called in both the old and new
                document.</p>
            <ol>
                <li data-md>
                    <p>If <var>document</var>’s <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/interaction.html#visibility-state"
                            id="ref-for-visibility-state">visibility state</a> is "<code>hidden</code>",
                        then return "<code>skip transition</code>".</p>
                <li data-md>
                    <p>Let <var>matchingRule</var> be the last <a class="css" data-link-type="maybe"
                            href="#at-view-transition-rule" id="ref-for-at-view-transition-rule①④">@view-transition</a>
                        rule in <var>document</var>.</p>
                <li data-md>
                    <p>If <var>matchingRule</var> is not found, then return "<code>skip transition</code>".</p>
                <li data-md>
                    <p>If <var>matchingRule</var>’s <a data-link-type="dfn" href="#view-transition-navigation"
                            id="ref-for-view-transition-navigation②">navigation</a> descriptor’s <a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-cascade-5/#computed-value"
                            id="ref-for-computed-value">computed value</a> is <a class="css" data-link-type="maybe"
                            href="#valdef-view-transition-navigation-none"
                            id="ref-for-valdef-view-transition-navigation-none">none</a>, then return
                        "<code>skip transition</code>".</p>
                <li data-md>
                    <p class="assertion">Assert: <var>matchingRule</var>’s <a data-link-type="dfn"
                            href="#view-transition-navigation" id="ref-for-view-transition-navigation③">navigation</a>
                        descriptor’s <a data-link-type="dfn" href="https://www.w3.org/TR/css-cascade-5/#computed-value"
                            id="ref-for-computed-value①">computed value</a> is <a class="css" data-link-type="maybe"
                            href="#valdef-view-transition-navigation-auto"
                            id="ref-for-valdef-view-transition-navigation-auto①">auto</a>.</p>
                <li data-md>
                    <p>Let <var>typesDescriptor</var> be <var>matchingRule</var>’s <a data-link-type="dfn"
                            href="#view-transition-types" id="ref-for-view-transition-types④">types</a> descriptor.</p>
                <li data-md>
                    <p>If <var>typesDescriptor</var>’s <a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-cascade-5/#computed-value"
                            id="ref-for-computed-value②">computed value</a> is <span class="css">none</span>, then
                        return a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set"
                            id="ref-for-ordered-set②">set</a> « ».</p>
                <li data-md>
                    <p>Return a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set"
                            id="ref-for-ordered-set③">set</a> of strings corresponding to <var>typesDescriptor</var>’s
                        <a data-link-type="dfn" href="https://www.w3.org/TR/css-cascade-5/#computed-value"
                            id="ref-for-computed-value③">computed value</a>.
                    </p>
            </ol>
        </div>
        <h3 class="heading settled" data-level="6.3" id="setup-old-document-vt"><span class="secno">6.3. </span><span
                class="content">Setting up the view transition in the old <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑤">Document</a></code></span><a
                class="self-link" href="#setup-old-document-vt"></a></h3>
        <h4 class="heading settled" data-level="6.3.1" id="check-eligibility"><span class="secno">6.3.1. </span><span
                class="content">Check eligibility for outbound cross-document view transition</span><a class="self-link"
                href="#check-eligibility"></a></h4>
        <div class="algorithm" data-algorithm="navigation can trigger a cross-document view-transition?">
            To check if a <dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="navigation-can-trigger-a-cross-document-view-transition">navigation can trigger a cross-document
                view-transition?</dfn> given
            a <code
                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑥">Document</a></code>
            <var>oldDocument</var>, a <code
                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑦">Document</a></code>
            <var>newDocument</var>, a <code
                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#navigationtype" id="ref-for-navigationtype①">NavigationType</a></code>
            <var>navigationType</var>, and a boolean <var>isBrowserUINavigation</var>:
            <p class="note" role="note"><span class="marker">Note:</span> this is called during navigation, potentially
                <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                    id="ref-for-in-parallel②">in parallel</a>.
            </p>
            <ol>
                <li data-md>
                    <p>If the user agent decides to display an <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#implementation-defined"
                            id="ref-for-implementation-defined">implementation-defined</a> navigation experience, e.g. a
                        gesture-based transition for a back navigation,
                        the user agent may ignore the author-defined view transition. If that is the case, return false.
                    </p>
                <li data-md>
                    <p>If <var>oldDocument</var>’s <a data-link-type="dfn"
                            href="#document-can-initiate-outbound-view-transition"
                            id="ref-for-document-can-initiate-outbound-view-transition">can initiate outbound view
                            transition</a> is false, then return false.</p>
                <li data-md>
                    <p>If <var>navigationType</var> is <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-reload" id="ref-for-dom-navigationtype-reload①">reload</a></code>,
                        then return false.</p>
                <li data-md>
                    <p>If <var>oldDocument</var>’s <a data-link-type="dfn"
                            href="https://dom.spec.whatwg.org/#concept-document-origin"
                            id="ref-for-concept-document-origin">origin</a> is not <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin"
                            id="ref-for-same-origin②">same origin</a> as <var>newDocument</var>’s <span
                            id="ref-for-concept-document-origin①">origin</span>, then return false.</p>
                <li data-md>
                    <p>If <var>newDocument</var> <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/dom.html#was-created-via-cross-origin-redirects"
                            id="ref-for-was-created-via-cross-origin-redirects">was created via cross-origin
                            redirects</a>, then return false.</p>
                <li data-md>
                    <p>If <var>navigationType</var> is <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-traverse" id="ref-for-dom-navigationtype-traverse②">traverse</a></code>,
                        then return true.</p>
                <li data-md>
                    <p>If <var>isBrowserUINavigation</var> is true, then return false.</p>
                <li data-md>
                    <p>Return true.</p>
            </ol>
        </div>
        <h4 class="heading settled" data-level="6.3.2" id="setup-outbound-transition"><span class="secno">6.3.2.
            </span><span class="content">Setup the outbound transition when ready to swap pages</span><a
                class="self-link" href="#setup-outbound-transition"></a></h4>
        <div class="algorithm" data-algorithm="setup cross-document view-transition">
            To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="setup-cross-document-view-transition">setup
                cross-document view-transition</dfn> given a <code
                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑧">Document</a></code>
            <var>oldDocument</var>,
            a <code
                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑨">Document</a></code>
            <var>newDocument</var>, and <var>proceedWithNavigation</var>, which is an algorithm accepting nothing:
            <p class="note" role="note"><span class="marker">Note:</span> This is called from the HTML spec.</p>
            <ol>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert"
                            id="ref-for-assert">Assert</a>: These steps are running as part of a <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task"
                            id="ref-for-concept-task">task</a> queued on <var>oldDocument</var>.</p>
                <li data-md>
                    <p>If <var>oldDocument</var>’s <a data-link-type="dfn"
                            href="#document-can-initiate-outbound-view-transition"
                            id="ref-for-document-can-initiate-outbound-view-transition①">can initiate outbound view
                            transition</a> is false, then return null.</p>
                <li data-md>
                    <p>Let <var>transitionTypesFromRule</var> be the result of <a data-link-type="dfn"
                            href="#resolve-view-transition-rule" id="ref-for-resolve-view-transition-rule">resolving the
                            @view-transition rule</a> for <var>oldDocument</var>.</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert"
                            id="ref-for-assert①">Assert</a>: <var>transitionTypesFromRule</var> is not
                        "<code>skip transition</code>".</p>
                    <p class="note" role="note"><span class="marker">Note:</span> We don’t know yet if
                        <var>newDocument</var> has opted in, as it might not be parsed yet.
                        We check the opt-in for <var>newDocument</var> when we fire the <code
                            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-pagereveal" id="ref-for-event-pagereveal③">pagereveal</a></code>
                        event.
                    </p>
                <li data-md>
                    <p>If <var>oldDocument</var>’s <a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition"
                            id="ref-for-document-active-view-transition⑧">active view transition</a> is not null,
                        then <a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-view-transitions-1/#skip-the-view-transition"
                            id="ref-for-skip-the-view-transition①">skip</a> <var>oldDocument</var>’s <span
                            id="ref-for-document-active-view-transition⑨">active view transition</span> with an "<code
                            class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#aborterror" id="ref-for-aborterror">AbortError</a></code>"
                        <code
                            class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException①">DOMException</a></code>
                        in <var>oldDocument</var>’s <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm"
                            id="ref-for-concept-relevant-realm①">relevant Realm</a>.
                    </p>
                    <p class="note" role="note"><span class="marker">Note:</span> this means that any running transition
                        would be skipped when the document is ready
                        to unload.</p>
                <li data-md>
                    <p>Let <var>outboundTransition</var> be a new <code
                            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition①⑤">ViewTransition</a></code>
                        object in <var>oldDocument</var>’s <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm"
                            id="ref-for-concept-relevant-realm②">relevant Realm</a>.</p>
                <li data-md>
                    <p>Set <var>outboundTransition</var>’s <a data-link-type="dfn" href="#viewtransition-active-types"
                            id="ref-for-viewtransition-active-types⑦">active types</a> to
                        <var>transitionTypesFromRule</var>.
                    </p>
                    <p class="note" role="note"><span class="marker">Note:</span> the <a data-link-type="dfn"
                            href="#viewtransition-active-types" id="ref-for-viewtransition-active-types⑧">active
                            types</a> are not shared between documents.
                        Manipulating the <code
                            class="idl"><a data-link-type="idl" href="#dom-viewtransition-types" id="ref-for-dom-viewtransition-types⑦">types</a></code>
                        in the new document does not affect the types in <var>newDocument</var>,
                        which would be read from the <a data-link-type="dfn" href="#view-transition-types"
                            id="ref-for-view-transition-types⑤">types</a> descriptor once <var>newDocument</var> is
                        revealed.</p>
                    <p class="note" role="note"><span class="marker">Note:</span> the <code
                            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition①⑥">ViewTransition</a></code>
                        is skipped once the old document is hidden.</p>
                <li data-md>
                    <p>Set <var>outboundTransition</var>’s <a data-link-type="dfn"
                            href="#viewtransition-outbound-post-capture-steps"
                            id="ref-for-viewtransition-outbound-post-capture-steps①">outbound post-capture steps</a> to
                        the following steps given a <a data-link-type="dfn" href="#view-transition-params"
                            id="ref-for-view-transition-params②">view transition params</a>-or-null <var>params</var>:
                    </p>
                    <ol>
                        <li data-md>
                            <p>Set <var>newDocument</var>’s <a data-link-type="dfn"
                                    href="#document-inbound-view-transition-params"
                                    id="ref-for-document-inbound-view-transition-params">inbound view transition
                                    params</a> to <var>params</var>.</p>
                            <p class="note" role="note"><span class="marker">Note:</span> The inbound transition is
                                activated after the dispatch of <code
                                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-pagereveal" id="ref-for-event-pagereveal④">pagereveal</a></code>
                                to ensure mutations made in this event apply to the captured new state.</p>
                        <li data-md>
                            <p>Call <var>proceedWithNavigation</var>.</p>
                    </ol>
                <li data-md>
                    <p>Set <var>oldDocument</var>’s <a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition"
                            id="ref-for-document-active-view-transition①⓪">active view transition</a> to
                        <var>outboundTransition</var>.
                    </p>
                    <p class="note" role="note"><span class="marker">Note:</span> The process continues in <a
                            data-link-type="dfn"
                            href="https://www.w3.org/TR/css-view-transitions-1/#perform-pending-transition-operations"
                            id="ref-for-perform-pending-transition-operations">perform pending transition
                            operations</a>.</p>
                <li data-md>
                    <p>The user agent should display the currently displayed frame until either:</p>
                    <ul>
                        <li data-md>
                            <p>The <code
                                    class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-pagereveal" id="ref-for-event-pagereveal⑤">pagereveal</a></code>
                                event is fired.</p>
                        <li data-md>
                            <p>its <a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition"
                                    id="ref-for-document-active-view-transition①①">active view transition</a>'s <a
                                    data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition-phase"
                                    id="ref-for-viewtransition-phase">phase</a> is "<code>done</code>".</p>
                    </ul>
                    <p class="note" role="note"><span class="marker">Note:</span> this is to ensure that there are no
                        unintended flashes between displaying the old and new state, to keep the transition smooth.</p>
                <li data-md>
                    <p>Return <var>outboundTransition</var>.</p>
            </ol>
        </div>
        <h4 class="heading settled" data-level="6.3.3" id="update-opt-in"><span class="secno">6.3.3. </span><span
                class="content">Update the opt-in flag to reflect the current state</span><a class="self-link"
                href="#update-opt-in"></a></h4>
        <div class="algorithm" data-algorithm="update-opt-in-for-outbound">
            To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport
                id="update-the-opt-in-state-for-outbound-transitions">update the opt-in state for outbound
                transitions</dfn> for a <code
                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②⓪">Document</a></code>
            <var>document</var>:
            <ol>
                <li data-md>
                    <p>If <var>document</var> <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#has-been-revealed"
                            id="ref-for-has-been-revealed">has been revealed</a>, and the result of <a
                            data-link-type="dfn" href="#resolve-view-transition-rule"
                            id="ref-for-resolve-view-transition-rule①">resolving the @view-transition rule</a> is not
                        "<code>skip transition</code>",
                        then set <var>document</var>’s <a data-link-type="dfn"
                            href="#document-can-initiate-outbound-view-transition"
                            id="ref-for-document-can-initiate-outbound-view-transition②">can initiate outbound view
                            transition</a> to true.</p>
                <li data-md>
                    <p>Otherwise, set <var>document</var>’s <a data-link-type="dfn"
                            href="#document-can-initiate-outbound-view-transition"
                            id="ref-for-document-can-initiate-outbound-view-transition③">can initiate outbound view
                            transition</a> to false.</p>
            </ol>
        </div>
        <h4 class="heading settled" data-level="6.3.4" id="proceed-if-skipped"><span class="secno">6.3.4. </span><span
                class="content">Proceed with navigation if view transition is skipped</span><a class="self-link"
                href="#proceed-if-skipped"></a></h4>
        <div class="algorithm" data-algorithm="additional skip steps">
            Append the following steps to <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-view-transitions-1/#skip-the-view-transition"
                id="ref-for-skip-the-view-transition②">skip the view transition</a> given a <code
                class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition①⑦">ViewTransition</a></code>
            <var>transition</var>:
            <ol>
                <li data-md>
                    <p>If <var>transition</var>’s <a data-link-type="dfn"
                            href="#viewtransition-outbound-post-capture-steps"
                            id="ref-for-viewtransition-outbound-post-capture-steps②">outbound post-capture steps</a> is
                        not null, then run <var>transition</var>’s <span
                            id="ref-for-viewtransition-outbound-post-capture-steps③">outbound post-capture steps</span>
                        with null.</p>
            </ol>
            <p class="note" role="note"><span class="marker">Note:</span> This is written in a monkey-patch manner, and
                will be merged into the algorithm once the L1 spec graduates.</p>
        </div>
        <h4 class="heading settled" data-level="6.3.5" id="cross-doc-after-capture"><span class="secno">6.3.5.
            </span><span class="content">Proceed with cross-document view transition after capturing the old
                state</span><a class="self-link" href="#cross-doc-after-capture"></a></h4>
        <div class="algorithm" data-algorithm="additional transition operation">
            Prepend the following step to the <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-view-transitions-1/#perform-pending-transition-operations"
                id="ref-for-perform-pending-transition-operations①">Perform pending transition operations</a> algorithm
            given a <code
                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②①">Document</a></code>
            <var>document</var>:
            <ol>
                <li data-md>
                    <p>If <var>document</var>’s <a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition"
                            id="ref-for-document-active-view-transition①②">active view transition</a> is not null and
                        its <a data-link-type="dfn" href="#viewtransition-outbound-post-capture-steps"
                            id="ref-for-viewtransition-outbound-post-capture-steps④">outbound post-capture steps</a> is
                        not null, then:</p>
                    <ol>
                        <li data-md>
                            <p class="assertion">Assert: <var>document</var>’s <a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition"
                                    id="ref-for-document-active-view-transition①③">active view transition</a>'s <a
                                    data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition-phase"
                                    id="ref-for-viewtransition-phase①">phase</a> is "<code>pending-capture</code>".</p>
                        <li data-md>
                            <p>Let <var>viewTransitionParams</var> be null;</p>
                        <li data-md>
                            <p>Set <var>document</var>’s <a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-view-transitions-1/#document-rendering-suppression-for-view-transitions"
                                    id="ref-for-document-rendering-suppression-for-view-transitions">rendering
                                    suppression for view transitions</a> to true.</p>
                            <p class="issue" id="issue-ca114a78"><a class="self-link" href="#issue-ca114a78"></a> Though
                                <a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-view-transitions-1/#capture-the-old-state"
                                    id="ref-for-capture-the-old-state①">capture the old state</a> appears here as a
                                synchronous step, it is in fact an asynchronous step
                                as rendering an element into an image cannot be done synchronously. This should be more
                                explicit in the L1 spec.
                            </p>
                        <li data-md>
                            <p><a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-view-transitions-1/#capture-the-old-state"
                                    id="ref-for-capture-the-old-state②">Capture the old state</a> for
                                <var>transition</var>.
                            </p>
                        <li data-md>
                            <p>If this succeeded, then set <var>viewTransitionParams</var> to a new <a
                                    data-link-type="dfn" href="#view-transition-params"
                                    id="ref-for-view-transition-params③">view transition params</a> whose <a
                                    data-link-type="dfn" href="#view-transition-params-named-elements"
                                    id="ref-for-view-transition-params-named-elements">named elements</a> is a <a
                                    data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-clone"
                                    id="ref-for-map-clone">clone</a> of <var>transition</var>’s <a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition-named-elements"
                                    id="ref-for-viewtransition-named-elements①">named elements</a>,
                                and whose <a data-link-type="dfn"
                                    href="#view-transition-params-initial-snapshot-containing-block-size"
                                    id="ref-for-view-transition-params-initial-snapshot-containing-block-size">initial
                                    snapshot containing block size</a> is <var>transition</var>’s <a
                                    data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition-initial-snapshot-containing-block-size"
                                    id="ref-for-viewtransition-initial-snapshot-containing-block-size">initial snapshot
                                    containing block size</a>.</p>
                        <li data-md>
                            <p>Set <var>document</var>’s <a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-view-transitions-1/#document-rendering-suppression-for-view-transitions"
                                    id="ref-for-document-rendering-suppression-for-view-transitions①">rendering
                                    suppression for view transitions</a> to false.</p>
                        <li data-md>
                            <p>Call <var>transition</var>’s <a data-link-type="dfn"
                                    href="#viewtransition-outbound-post-capture-steps"
                                    id="ref-for-viewtransition-outbound-post-capture-steps⑤">outbound post-capture
                                    steps</a> given <var>viewTransitionParams</var>.</p>
                    </ol>
            </ol>
            <p class="note" role="note"><span class="marker">Note:</span> This is written in a monkey-patch manner, and
                will be merged into the algorithm once the L1 spec graduates.</p>
        </div>
        <h3 class="heading settled" data-level="6.4" id="access-view-transition-in-new-doc"><span class="secno">6.4.
            </span><span class="content">Activating the view transition in the new <code
                    class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②②">Document</a></code></span><a
                class="self-link" href="#access-view-transition-in-new-doc"></a></h3>
        <div class="algorithm" data-algorithm="resolve inbound cross-document view-transition">
            To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                id="resolve-inbound-cross-document-view-transition">resolve inbound cross-document view-transition</dfn>
            for <code
                class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②③">Document</a></code>
            <var>document</var>:
            <ol>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert"
                            id="ref-for-assert②">Assert</a>: <var>document</var> is <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active"
                            id="ref-for-fully-active">fully active</a>.</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert"
                            id="ref-for-assert③">Assert</a>: <var>document</var> <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#has-been-revealed"
                            id="ref-for-has-been-revealed①">has been revealed</a> is true.</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="#update-the-opt-in-state-for-outbound-transitions"
                            id="ref-for-update-the-opt-in-state-for-outbound-transitions①">Update the opt-in state for
                            outbound transitions</a> for <var>document</var>.</p>
                <li data-md>
                    <p>Let <var>inboundViewTransitionParams</var> be <var>document</var>’s <a data-link-type="dfn"
                            href="#document-inbound-view-transition-params"
                            id="ref-for-document-inbound-view-transition-params①">inbound view transition params</a>.
                    </p>
                <li data-md>
                    <p>If <var>inboundViewTransitionParams</var> is null, then return null.</p>
                <li data-md>
                    <p>Set <var>document</var>’s <a data-link-type="dfn" href="#document-inbound-view-transition-params"
                            id="ref-for-document-inbound-view-transition-params②">inbound view transition params</a> to
                        null.</p>
                <li data-md>
                    <p>If <var>document</var>’s <a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition"
                            id="ref-for-document-active-view-transition①④">active view transition</a> is not null, then
                        return null.</p>
                    <p class="note" role="note"><span class="marker">Note:</span> this means that starting a
                        same-document transition before revealing the document would cancel a pending cross-document
                        transition.</p>
                <li data-md>
                    <p><a data-link-type="dfn" href="#resolve-view-transition-rule"
                            id="ref-for-resolve-view-transition-rule②">Resolve @view-transition rule</a> for
                        <var>document</var> and let <var>resolvedRule</var> be the result.
                    </p>
                <li data-md>
                    <p>If <var>resolvedRule</var> is "<code>skip transition</code>", then return null.</p>
                <li data-md>
                    <p>Let <var>transition</var> be a new <code
                            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition" id="ref-for-viewtransition①⑧">ViewTransition</a></code>
                        in <var>document</var>’s <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm"
                            id="ref-for-concept-relevant-realm③">relevant Realm</a>,
                        whose <a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition-named-elements"
                            id="ref-for-viewtransition-named-elements②">named elements</a> is
                        <var>inboundViewTransitionParams</var>’s <a data-link-type="dfn"
                            href="#view-transition-params-named-elements"
                            id="ref-for-view-transition-params-named-elements①">named elements</a>,
                        and <a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition-initial-snapshot-containing-block-size"
                            id="ref-for-viewtransition-initial-snapshot-containing-block-size①">initial snapshot
                            containing block size</a> is <var>inboundViewTransitionParams</var>’s <a
                            data-link-type="dfn" href="#view-transition-params-initial-snapshot-containing-block-size"
                            id="ref-for-view-transition-params-initial-snapshot-containing-block-size①">initial snapshot
                            containing block size</a>.
                    </p>
                <li data-md>
                    <p>Set <var>document</var>’s <a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition"
                            id="ref-for-document-active-view-transition①⑤">active view transition</a> to
                        <var>transition</var>.
                    </p>
                <li data-md>
                    <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve"
                            id="ref-for-resolve">Resolve</a> <var>transition</var>’s <a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition-update-callback-done-promise"
                            id="ref-for-viewtransition-update-callback-done-promise">update callback done promise</a>
                        with undefined.</p>
                <li data-md>
                    <p>Set <var>transition</var>’s <a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition-phase"
                            id="ref-for-viewtransition-phase②">phase</a> to "<code>update-callback-called</code>".</p>
                <li data-md>
                    <p>Set <var>transition</var>’s <a data-link-type="dfn" href="#viewtransition-active-types"
                            id="ref-for-viewtransition-active-types⑨">active types</a> to <var>resolvedRule</var>.</p>
                <li data-md>
                    <p>At any given time, the UA may decide to skip the inbound transition, e.g. after an <a
                            data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined"
                            id="ref-for-implementation-defined①">implementation-defined</a> timeout.
                        To do so, the UA should <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task"
                            id="ref-for-queue-a-global-task">queue a global task</a> on the <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source"
                            id="ref-for-dom-manipulation-task-source">DOM manipulation task source</a> given
                        <var>document</var>’s <a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"
                            id="ref-for-concept-relevant-global">relevant global object</a> to perform the following
                        step:
                        If <var>transition</var>’s <a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition-phase"
                            id="ref-for-viewtransition-phase③">phase</a> is not "<code>done</code>", then <a
                            data-link-type="dfn"
                            href="https://www.w3.org/TR/css-view-transitions-1/#skip-the-view-transition"
                            id="ref-for-skip-the-view-transition③">skip the view transition</a> <var>transition</var>
                        with a "<code
                            class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#timeouterror" id="ref-for-timeouterror">TimeoutError</a></code>"
                        <code
                            class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException②">DOMException</a></code>.
                    </p>
                <li data-md>
                    <p>Return <var>transition</var>.</p>
            </ol>
        </div>
        <h3 class="heading settled" data-level="6.5" id="vt-class-algorithms"><span class="secno">6.5. </span><span
                class="content">Capturing the <a class="property css" data-link-type="property"
                    href="#propdef-view-transition-class"
                    id="ref-for-propdef-view-transition-class⑦">view-transition-class</a></span><a class="self-link"
                href="#vt-class-algorithms"></a></h3>
        <div class="algorithm" data-algorithm="additional capture steps">
            When capturing the old or new state for an element, perform the following steps given a <a
                data-link-type="dfn" href="https://www.w3.org/TR/css-view-transitions-1/#captured-element"
                id="ref-for-captured-element③">captured element</a> <var>capture</var> and an <a data-link-type="dfn"
                href="https://drafts.csswg.org/css2/#element" id="ref-for-element">element</a> <var>element</var>:
            <ol>
                <li data-md>
                    <p>Set <var>capture</var>’s <a data-link-type="dfn" href="#captured-element-class-list"
                            id="ref-for-captured-element-class-list①">class list</a> to the <a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-cascade-5/#computed-value"
                            id="ref-for-computed-value④">computed value</a> of <var>element</var>’s <a
                            class="property css" data-link-type="property" href="#propdef-view-transition-class"
                            id="ref-for-propdef-view-transition-class⑧">view-transition-class</a>.</p>
            </ol>
            <p class="note" role="note"><span class="marker">Note:</span> This is written in a monkey-patch manner, and
                will be merged into the algorithm once the L1 spec graduates.</p>
        </div>
        <h2 class="no-num heading settled" id="priv"><span class="content">Privacy Considerations</span><a
                class="self-link" href="#priv"></a></h2>
        <p>This specification introduces no new privacy considerations.</p>
        <h2 class="no-num heading settled" id="sec"><span class="content">Security Considerations</span><a
                class="self-link" href="#sec"></a></h2>
        <p>To prevent cross-origin issues, at this point cross-document view transitions can only be enabled for
            same-origin navigations. As discussed in <a
                href="https://github.com/WICG/view-transitions/issues/200">WICG/view-transitions#200</a>,
            this still presents two potential threats:</p>
        <ol>
            <li data-md>
                <p>The <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability"
                        id="ref-for-concept-settings-object-cross-origin-isolated-capability">cross-origin isolated
                        capability</a> in both documents might be different.
                    This can cause a situation where a <code
                        class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②④">Document</a></code>
                    that is <span id="ref-for-concept-settings-object-cross-origin-isolated-capability①">cross-origin
                        isolated</span> can read image data from a document that is not cross-origin isolated. This is
                    already mitigated in [[css-view-transitions-1#sec],
                    as the same restriction applies for captured cross-origin iframes.</p>
            <li data-md>
                <p>A same-origin navigation might still occur via a cross-origin redirect, e.g.
                    <code>https://example.com</code> links to <code>https://auth-provider.com/</code> which redirects
                    back to <code>https://example.com/loggedin</code>.
                </p>
                <p>This can cause a (minor) situation where the cross-origin party would redirect the user to an
                    unexpected first-party URL, causing an unexpected transition and obfuscating that fact that there
                    was a redirect.
                    To mitigate this, currently view transitions are disabled for navigations if the <code
                        class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②⑤">Document</a></code>
                    <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/dom.html#was-created-via-cross-origin-redirects"
                        id="ref-for-was-created-via-cross-origin-redirects①">was created via cross-origin redirects</a>.
                    Note that this check doesn’t apply when the <code
                        class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②⑥">Document</a></code>
                    is being <a data-link-type="dfn"
                        href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#reactivate-a-document"
                        id="ref-for-reactivate-a-document">reactivated</a>, as in that case
                    the cross-origin redirect has already taken place.
                </p>
                <p class="note" role="note"><span class="marker">Note:</span> this only applies to server-side
                    redirects. A client-side redirect, e.g. using
                    [^meta/http-equiv/refresh^], is equivalent to a new navigation.</p>
            <li data-md>
                <p>This feature exposes more information to CSS, as so far CSS was not aware of anything
                    navigation-related.
                    This can raise concerns around safety 3rd-party CSS. However, as a general rule, 3rd-party
                    stylesheets should come
                    from trusted sources to begin with, as CSS can learn about the document or change it in many ways.
                </p>
        </ol>
        <p>See <a href="https://github.com/w3c/csswg-drafts/issues/8684">Issue #8684</a> and <a
                href="https://github.com/WICG/view-transitions/issues/200">WICG/view-transitions#200</a> for
            detailed discussion.</p>
    </main>
    <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content"> Conformance</span><a
            class="self-link" href="#w3c-conformance"></a></h2>
    <h3 class="no-ref heading settled" id="w3c-conventions"><span class="content"> Document conventions</span><a
            class="self-link" href="#w3c-conventions"></a></h3>
    <p>Conformance requirements are expressed with a combination of
        descriptive assertions and RFC 2119 terminology. The key words “MUST”,
        “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
        “RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
        document are to be interpreted as described in RFC 2119.
        However, for readability, these words do not appear in all uppercase
        letters in this specification. </p>
    <p>All of the text of this specification is normative except sections
        explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119"
            title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a></p>
    <p>Examples in this specification are introduced with the words “for example”
        or are set apart from the normative text with <code>class="example"</code>,
        like this: </p>
    <div class="example" id="w3c-example">
        <a class="self-link" href="#w3c-example"></a>
        <p>This is an example of an informative example.</p>
    </div>
    <p>Informative notes begin with the word “Note” and are set apart from the
        normative text with <code>class="note"</code>, like this: </p>
    <p class="note" role="note">Note, this is an informative note.</p>
    <p>Advisements are normative sections styled to evoke special attention and are
        set apart from other normative text with <code>&lt;strong class="advisement"></code>, like
        this: <strong class="advisement"> UAs MUST provide an accessible alternative. </strong></p>
    <h3 class="no-ref heading settled" id="w3c-conformance-classes"><span class="content"> Conformance classes</span><a
            class="self-link" href="#w3c-conformance-classes"></a></h3>
    <p>Conformance to this specification
        is defined for three conformance classes: </p>
    <dl>
        <dt>style sheet
        <dd>A <a href="https://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS
                style sheet</a>.
        <dt>renderer
        <dd>A <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a> that interprets the semantics of a
            style sheet and renders
            documents that use them.
        <dt>authoring tool
        <dd>A <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a> that writes a style sheet.
    </dl>
    <p>A style sheet is conformant to this specification
        if all of its statements that use syntax defined in this module are valid
        according to the generic CSS grammar and the individual grammars of each
        feature defined in this module. </p>
    <p>A renderer is conformant to this specification
        if, in addition to interpreting the style sheet as defined by the
        appropriate specifications, it supports all the features defined
        by this specification by parsing them correctly
        and rendering the document accordingly. However, the inability of a
        UA to correctly render a document due to limitations of the device
        does not make the UA non-conformant. (For example, a UA is not
        required to render color on a monochrome monitor.) </p>
    <p>An authoring tool is conformant to this specification
        if it writes style sheets that are syntactically correct according to the
        generic CSS grammar and the individual grammars of each feature in
        this module, and meet all other conformance requirements of style sheets
        as described in this module. </p>
    <h3 class="no-ref heading settled" id="w3c-partial"><span class="content"> Partial implementations</span><a
            class="self-link" href="#w3c-partial"></a></h3>
    <p>So that authors can exploit the forward-compatible parsing rules to
        assign fallback values, CSS renderers <strong>must</strong> treat as invalid (and <a
            href="https://www.w3.org/TR/CSS21/conform.html#ignore">ignore
            as appropriate</a>) any at-rules, properties, property values, keywords,
        and other syntactic constructs for which they have no usable level of
        support. In particular, user agents <strong>must not</strong> selectively
        ignore unsupported component values and honor supported values in a single
        multi-value property declaration: if any value is considered invalid
        (as unsupported values must be), CSS requires that the entire declaration
        be ignored.</p>
    <h4 class="heading settled" id="w3c-conform-future-proofing"><span class="content"> Implementations of Unstable and
            Proprietary Features</span><a class="self-link" href="#w3c-conform-future-proofing"></a></h4>
    <p>To avoid clashes with future stable CSS features,
        the CSSWG recommends <a href="https://www.w3.org/TR/CSS/#future-proofing">following best practices</a> for the
        implementation of <a href="https://www.w3.org/TR/CSS/#unstable">unstable</a> features and <a
            href="https://www.w3.org/TR/CSS/#proprietary-extension">proprietary extensions</a> to CSS. </p>
    <h3 class="no-ref heading settled" id="w3c-testing"><span class="content"> Non-experimental implementations</span><a
            class="self-link" href="#w3c-testing"></a></h3>
    <p>Once a specification reaches the Candidate Recommendation stage,
        non-experimental implementations are possible, and implementors should
        release an unprefixed implementation of any CR-level feature they
        can demonstrate to be correctly implemented according to spec. </p>
    <p>To establish and maintain the interoperability of CSS across
        implementations, the CSS Working Group requests that non-experimental
        CSS renderers submit an implementation report (and, if necessary, the
        testcases used for that implementation report) to the W3C before
        releasing an unprefixed implementation of any CSS features. Testcases
        submitted to W3C are subject to review and correction by the CSS
        Working Group. </p>
    <p>Further information on submitting testcases and implementation reports
        can be found from on the CSS Working Group’s website at <a
            href="https://www.w3.org/Style/CSS/Test/">https://www.w3.org/Style/CSS/Test/</a>.
        Questions should be directed to the <a
            href="https://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a> mailing
        list.</p>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this
            specification</span><a class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#viewtransition-active-types">active types</a><span>, in § 6.1.2</span>
        <li><a href="#active-view-transition-pseudo">:active-view-transition</a><span>, in § 3.3.1</span>
        <li><a href="#active-view-transition-type-pseudo">:active-view-transition-type()</a><span>, in § 3.3.2</span>
        <li><a href="#dom-viewtransitionnavigation-auto">"auto"</a><span>, in § 2.3.3</span>
        <li><a href="#valdef-view-transition-navigation-auto">auto</a><span>, in § 2.3.2</span>
        <li><a href="#document-can-initiate-outbound-view-transition">can initiate outbound view transition</a><span>,
                in § 6.1.1</span>
        <li><a href="#captured-element-class-list">class list</a><span>, in § 6.1.4</span>
        <li><a href="#cssviewtransitionrule">CSSViewTransitionRule</a><span>, in § 2.3.3</span>
        <li><a href="#valdef-view-transition-class-custom-ident">&lt;custom-ident>+</a><span>, in § 4.3</span>
        <li><a href="#document-inbound-view-transition-params">inbound view transition params</a><span>, in
                § 6.1.1</span>
        <li><a href="#view-transition-params-initial-snapshot-containing-block-size">initial snapshot containing block
                size</a><span>, in § 6.1.3</span>
        <li><a href="#view-transition-params-named-elements">named elements</a><span>, in § 6.1.3</span>
        <li>
            navigation
            <ul>
                <li><a href="#dom-cssviewtransitionrule-navigation">attribute for CSSViewTransitionRule</a><span>, in
                        § 2.3.3</span>
                <li><a href="#descdef-view-transition-navigation">descriptor for @view-transition</a><span>, in
                        § 2.3.2</span>
                <li><a href="#view-transition-navigation">dfn for @view-transition</a><span>, in § 2.3.2</span>
            </ul>
        <li><a href="#navigation-can-trigger-a-cross-document-view-transition">navigation can trigger a cross-document
                view-transition?</a><span>, in § 6.3.1</span>
        <li><a href="#dom-viewtransitionnavigation-none">"none"</a><span>, in § 2.3.3</span>
        <li>
            none
            <ul>
                <li><a href="#valdef-view-transition-navigation-none">value for @view-transition/navigation</a><span>,
                        in § 2.3.2</span>
                <li><a href="#valdef-view-transition-class-none">value for view-transition-class</a><span>, in
                        § 4.3</span>
            </ul>
        <li><a href="#viewtransition-outbound-post-capture-steps">outbound post-capture steps</a><span>, in
                § 6.1.2</span>
        <li><a href="#typedef-pt-class-selector">&lt;pt-class-selector></a><span>, in § 4.4</span>
        <li><a href="#typedef-pt-name-and-class-selector">&lt;pt-name-and-class-selector></a><span>, in § 4.4</span>
        <li><a href="#resolve-inbound-cross-document-view-transition">resolve inbound cross-document
                view-transition</a><span>, in § 6.4</span>
        <li><a href="#resolve-view-transition-rule">resolve @view-transition rule</a><span>, in § 6.2</span>
        <li><a href="#setup-cross-document-view-transition">setup cross-document view-transition</a><span>, in
                § 6.3.2</span>
        <li><a href="#dom-document-startviewtransition">startViewTransition()</a><span>, in § 5</span>
        <li><a href="#dom-document-startviewtransition">startViewTransition(callbackOptions)</a><span>, in § 5</span>
        <li><a href="#dictdef-startviewtransitionoptions">StartViewTransitionOptions</a><span>, in § 5</span>
        <li>
            types
            <ul>
                <li><a href="#dom-cssviewtransitionrule-types">attribute for CSSViewTransitionRule</a><span>, in
                        § 2.3.3</span>
                <li><a href="#dom-viewtransition-types">attribute for ViewTransition</a><span>, in § 3.4</span>
                <li><a href="#descdef-view-transition-types">descriptor for @view-transition</a><span>, in § 3.5</span>
                <li><a href="#view-transition-types">dfn for @view-transition</a><span>, in § 3.5</span>
                <li><a href="#dom-startviewtransitionoptions-types">dict-member for
                        StartViewTransitionOptions</a><span>, in § 5</span>
            </ul>
        <li><a href="#dom-startviewtransitionoptions-update">update</a><span>, in § 5</span>
        <li><a href="#update-the-opt-in-state-for-outbound-transitions">update the opt-in state for outbound
                transitions</a><span>, in § 6.3.3</span>
        <li><a href="#at-view-transition-rule">@view-transition</a><span>, in § 2.3.1</span>
        <li><a href="#propdef-view-transition-class">view-transition-class</a><span>, in § 4.3</span>
        <li><a href="#enumdef-viewtransitionnavigation">ViewTransitionNavigation</a><span>, in § 2.3.3</span>
        <li><a href="#view-transition-params">view transition params</a><span>, in § 6.1.3</span>
        <li><a href="#dom-cssrule-view_transition_rule">VIEW_TRANSITION_RULE</a><span>, in § 2.3.3</span>
        <li><a href="#viewtransitiontypeset">ViewTransitionTypeSet</a><span>, in § 3.4</span>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by
            reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[CSS-CASCADE-5]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="8c8e51b4">computed value</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-CONDITIONAL-3]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="4397147f">@media</span>
                <li><span class="dfn-paneled" id="a5d6c9d2">@supports</span>
                <li><span class="dfn-paneled" id="f1a41224">conditional group rule</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-SYNTAX-3]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="a81b1fb8">&lt;declaration-list></span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-VALUES-4]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="c297b070">#</span>
                <li><span class="dfn-paneled" id="af4a190d">+</span>
                <li><span class="dfn-paneled" id="a0144f62">&lt;custom-ident></span>
                <li><span class="dfn-paneled" id="d4441b24">?</span>
                <li><span class="dfn-paneled" id="4eb9d37e">|</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-VIEW-TRANSITIONS-1]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="257d7734">::view-transition-group()</span>
                <li><span class="dfn-paneled" id="a9aefc80">::view-transition-image-pair()</span>
                <li><span class="dfn-paneled" id="e63d01fd">::view-transition-new()</span>
                <li><span class="dfn-paneled" id="3f4cb357">::view-transition-old()</span>
                <li><span class="dfn-paneled" id="8ae6697b">&lt;pt-name-selector></span>
                <li><span class="dfn-paneled" id="abb51c3c">UpdateCallback</span>
                <li><span class="dfn-paneled" id="fb8b141f">ViewTransition</span>
                <li><span class="dfn-paneled" id="3f152388">activate view transition</span>
                <li><span class="dfn-paneled" id="8b0471c9">active view transition</span>
                <li><span class="dfn-paneled" id="a94f7564">capture the new state</span>
                <li><span class="dfn-paneled" id="53fbe689">capture the old state</span>
                <li><span class="dfn-paneled" id="2e5e13e1">captured element</span>
                <li><span class="dfn-paneled" id="c00d8c81">finished</span>
                <li><span class="dfn-paneled" id="6c645596">initial snapshot containing block size</span>
                <li><span class="dfn-paneled" id="3d5a9d15">named elements</span>
                <li><span class="dfn-paneled" id="3d29f343">named view transition pseudo-elements</span>
                <li><span class="dfn-paneled" id="77bcdcee">perform pending transition operations</span>
                <li><span class="dfn-paneled" id="54f188b7">phase</span>
                <li><span class="dfn-paneled" id="d1fbbaaa">ready</span>
                <li><span class="dfn-paneled" id="28e82ba6">rendering suppression for view transitions</span>
                <li><span class="dfn-paneled" id="da45ed1a">skip the view transition</span>
                <li><span class="dfn-paneled" id="f9e53f84">skipTransition()</span>
                <li><span class="dfn-paneled" id="5ce34159">startViewTransition(updateCallback)</span>
                <li><span class="dfn-paneled" id="9bb2014b">update callback</span>
                <li><span class="dfn-paneled" id="a8ff7689">update callback done promise</span>
                <li><span class="dfn-paneled" id="773c38f9">updateCallbackDone</span>
                <li><span class="dfn-paneled" id="aa734171">view-transition-name</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS22]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="e8b75507">element</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSSOM-1]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="9d357000">CSSOMString</span>
                <li><span class="dfn-paneled" id="0f78dbdd">CSSRule</span>
            </ul>
        <li>
            <a data-link-type="biblio">[DOM]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="85394472">Document</span>
                <li><span class="dfn-paneled" id="705b4fd3">class</span>
                <li><span class="dfn-paneled" id="a973e0fe">document</span>
                <li><span class="dfn-paneled" id="2f0ba72c">document element</span>
                <li><span class="dfn-paneled" id="5216e1a0">node document</span>
                <li><span class="dfn-paneled" id="c62cd7cf">origin</span>
            </ul>
        <li>
            <a data-link-type="biblio">[HTML]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="3560d057">HTMLLinkElement</span>
                <li><span class="dfn-paneled" id="a4c36929">NavigationType</span>
                <li><span class="dfn-paneled" id="1815821e">PageSwapEvent</span>
                <li><span class="dfn-paneled" id="0d02a1c8">activation</span>
                <li><span class="dfn-paneled" id="90c99c05">blocking <small>(for HTMLScriptElement)</small></span>
                <li><span class="dfn-paneled" id="787ad014">blocking <small>(for HTMLStyleElement)</small></span>
                <li><span class="dfn-paneled" id="473036cd">cross-origin isolated capability</span>
                <li><span class="dfn-paneled" id="e10e7eb7">dom manipulation task source</span>
                <li><span class="dfn-paneled" id="265a80eb">expect</span>
                <li><span class="dfn-paneled" id="0e3ba9f8">fully active</span>
                <li><span class="dfn-paneled" id="6a40c011">has been revealed</span>
                <li><span class="dfn-paneled" id="a72449dd">in parallel</span>
                <li><span class="dfn-paneled" id="5a31d22c">pagereveal</span>
                <li><span class="dfn-paneled" id="1d314002">pageswap</span>
                <li><span class="dfn-paneled" id="c9ff317b">push</span>
                <li><span class="dfn-paneled" id="48438eb3">queue a global task</span>
                <li><span class="dfn-paneled" id="e93b877c">reactivate</span>
                <li><span class="dfn-paneled" id="e99bd18e">relevant global object</span>
                <li><span class="dfn-paneled" id="5991ccfb">relevant realm</span>
                <li><span class="dfn-paneled" id="6f5567e9">reload</span>
                <li><span class="dfn-paneled" id="43f1a6f1">render-blocking mechanism</span>
                <li><span class="dfn-paneled" id="6998ead7">rendering opportunity</span>
                <li><span class="dfn-paneled" id="6d273060">replace</span>
                <li><span class="dfn-paneled" id="7393da89">same origin</span>
                <li><span class="dfn-paneled" id="7a899a17">sessionStorage</span>
                <li><span class="dfn-paneled" id="e270bd2a">task</span>
                <li><span class="dfn-paneled" id="fa3348cc">traverse</span>
                <li><span class="dfn-paneled" id="55372230">viewTransition <small>(for PageRevealEvent)</small></span>
                <li><span class="dfn-paneled" id="34e73e3f">viewTransition <small>(for PageSwapEvent)</small></span>
                <li><span class="dfn-paneled" id="b4c365f8">visibility state</span>
                <li><span class="dfn-paneled" id="69516351">was created via cross-origin redirects</span>
            </ul>
        <li>
            <a data-link-type="biblio">[INFRA]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="77b4c09a">assert</span>
                <li><span class="dfn-paneled" id="027e3e49">clone <small>(for list)</small></span>
                <li><span class="dfn-paneled" id="ab3919d2">clone <small>(for map)</small></span>
                <li><span class="dfn-paneled" id="ae8def21">contain</span>
                <li><span class="dfn-paneled" id="860300d4">implementation-defined</span>
                <li><span class="dfn-paneled" id="c88f3887">item</span>
                <li><span class="dfn-paneled" id="649608b9">list</span>
                <li><span class="dfn-paneled" id="3fca5a9e">map</span>
                <li><span class="dfn-paneled" id="15e48c39">set</span>
                <li><span class="dfn-paneled" id="984221ca">struct</span>
                <li><span class="dfn-paneled" id="0e8de730">tuple</span>
            </ul>
        <li>
            <a data-link-type="biblio">[SELECTORS-3]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="dfd67b05">*</span>
            </ul>
        <li>
            <a data-link-type="biblio">[SELECTORS-4]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="b5be7607">class selector</span>
                <li><span class="dfn-paneled" id="388bc3fc">selector</span>
                <li><span class="dfn-paneled" id="ba72ce8f">specificity</span>
                <li><span class="dfn-paneled" id="15e81c46">type selector</span>
            </ul>
        <li>
            <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
            <ul>
                <li><span class="dfn-paneled" id="d25dfb2c">AbortError</span>
                <li><span class="dfn-paneled" id="dca2de17">DOMException</span>
                <li><span class="dfn-paneled" id="8855a9aa">DOMString</span>
                <li><span class="dfn-paneled" id="889e932f">Exposed</span>
                <li><span class="dfn-paneled" id="dcf5fafa">FrozenArray</span>
                <li><span class="dfn-paneled" id="797018a7">InvalidStateError</span>
                <li><span class="dfn-paneled" id="a5c91173">SameObject</span>
                <li><span class="dfn-paneled" id="f0ba495b">TimeoutError</span>
                <li><span class="dfn-paneled" id="833154f2">getter steps</span>
                <li><span class="dfn-paneled" id="3024958b">method steps</span>
                <li><span class="dfn-paneled" id="3b90bdcd">resolve</span>
                <li><span class="dfn-paneled" id="9cce47fd">sequence</span>
                <li><span class="dfn-paneled" id="4013a022">this</span>
                <li><span class="dfn-paneled" id="450958f7">unsigned short</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a
            class="self-link" href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a
            class="self-link" href="#normative"></a></h3>
    <dl>
        <dt id="biblio-css-cascade-5">[CSS-CASCADE-5]
        <dd>Elika Etemad; Miriam Suzanne; Tab Atkins Jr.. <a href="https://www.w3.org/TR/css-cascade-5/"><cite>CSS
                    Cascading and Inheritance Level 5</cite></a>. 13 January 2022. CR. URL: <a
                href="https://www.w3.org/TR/css-cascade-5/">https://www.w3.org/TR/css-cascade-5/</a>
        <dt id="biblio-css-syntax-3">[CSS-SYNTAX-3]
        <dd>Tab Atkins Jr.; Simon Sapin. <a href="https://www.w3.org/TR/css-syntax-3/"><cite>CSS Syntax Module Level
                    3</cite></a>. 24 December 2021. CR. URL: <a
                href="https://www.w3.org/TR/css-syntax-3/">https://www.w3.org/TR/css-syntax-3/</a>
        <dt id="biblio-css-values-4">[CSS-VALUES-4]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-4/"><cite>CSS Values and Units
                    Module Level 4</cite></a>. 12 March 2024. WD. URL: <a
                href="https://www.w3.org/TR/css-values-4/">https://www.w3.org/TR/css-values-4/</a>
        <dt id="biblio-css-view-transitions-1">[CSS-VIEW-TRANSITIONS-1]
        <dd>Tab Atkins Jr.; Jake Archibald; Khushal Sagar. <a
                href="https://www.w3.org/TR/css-view-transitions-1/"><cite>CSS View Transitions Module Level
                    1</cite></a>. 28 March 2024. CR. URL: <a
                href="https://www.w3.org/TR/css-view-transitions-1/">https://www.w3.org/TR/css-view-transitions-1/</a>
        <dt id="biblio-css22">[CSS22]
        <dd>Bert Bos. <a href="https://www.w3.org/TR/CSS22/"><cite>Cascading Style Sheets Level 2 Revision 2 (CSS 2.2)
                    Specification</cite></a>. 12 April 2016. WD. URL: <a
                href="https://www.w3.org/TR/CSS22/">https://www.w3.org/TR/CSS22/</a>
        <dt id="biblio-cssom-1">[CSSOM-1]
        <dd>Daniel Glazman; Emilio Cobos Álvarez. <a href="https://www.w3.org/TR/cssom-1/"><cite>CSS Object Model
                    (CSSOM)</cite></a>. 26 August 2021. WD. URL: <a
                href="https://www.w3.org/TR/cssom-1/">https://www.w3.org/TR/cssom-1/</a>
        <dt id="biblio-dom">[DOM]
        <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard.
            URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
        <dt id="biblio-html">[HTML]
        <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>.
            Living Standard. URL: <a
                href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        <dt id="biblio-infra">[INFRA]
        <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra
                    Standard</cite></a>. Living Standard. URL: <a
                href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
        <dt id="biblio-rfc2119">[RFC2119]
        <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to
                    Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a
                href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
        <dt id="biblio-selectors-3">[SELECTORS-3]
        <dd>Tantek Çelik; et al. <a href="https://www.w3.org/TR/selectors-3/"><cite>Selectors Level 3</cite></a>. 6
            November 2018. REC. URL: <a href="https://www.w3.org/TR/selectors-3/">https://www.w3.org/TR/selectors-3/</a>
        <dt id="biblio-selectors-4">[SELECTORS-4]
        <dd>Elika Etemad; Tab Atkins Jr.. <a href="https://www.w3.org/TR/selectors-4/"><cite>Selectors Level
                    4</cite></a>. 11 November 2022. WD. URL: <a
                href="https://www.w3.org/TR/selectors-4/">https://www.w3.org/TR/selectors-4/</a>
        <dt id="biblio-webidl">[WEBIDL]
        <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living
            Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a
            class="self-link" href="#informative"></a></h3>
    <dl>
        <dt id="biblio-css-conditional-3">[CSS-CONDITIONAL-3]
        <dd>David Baron; Elika Etemad; Chris Lilley. <a href="https://www.w3.org/TR/css-conditional-3/"><cite>CSS
                    Conditional Rules Module Level 3</cite></a>. 13 January 2022. CR. URL: <a
                href="https://www.w3.org/TR/css-conditional-3/">https://www.w3.org/TR/css-conditional-3/</a>
    </dl>
    <h2 class="no-num no-ref heading settled" id="property-index"><span class="content">Property Index</span><a
            class="self-link" href="#property-index"></a></h2>
    <div class="big-element-wrapper">
        <table class="index">
            <thead>
                <tr>
                    <th scope="col">Name
                    <th scope="col">Value
                    <th scope="col">Initial
                    <th scope="col">Applies to
                    <th scope="col">Inh.
                    <th scope="col">%ages
                    <th scope="col">Anim­ation type
                    <th scope="col">Canonical order
                    <th scope="col">Com­puted value
            <tbody>
                <tr>
                    <th scope="row"><a class="css" data-link-type="property" href="#propdef-view-transition-class"
                            id="ref-for-propdef-view-transition-class⑨">view-transition-class</a>
                    <td>none | &lt;custom-ident>+
                    <td>none
                    <td>all elements
                    <td>no
                    <td>n/a
                    <td>discrete
                    <td>per grammar
                    <td>as specified
        </table>
    </div>
    <h3 class="no-num no-ref heading settled" id="view-transition-descriptor-table"><span class="content"><a class="css"
                data-link-type="at-rule" href="#at-view-transition-rule"
                id="ref-for-at-view-transition-rule①⑤">@view-transition</a> Descriptors</span><a class="self-link"
            href="#view-transition-descriptor-table"></a></h3>
    <div class="big-element-wrapper">
        <table class="index">
            <thead>
                <tr>
                    <th scope="col">Name
                    <th scope="col">Value
                    <th scope="col">Initial
            <tbody>
                <tr>
                    <th scope="row"><a class="css" data-link-type="descriptor"
                            href="#descdef-view-transition-navigation"
                            id="ref-for-descdef-view-transition-navigation">navigation</a>
                    <td>auto | none
                    <td>none
                <tr>
                    <th scope="row"><a class="css" data-link-type="descriptor" href="#descdef-view-transition-types"
                            id="ref-for-descdef-view-transition-types">types</a>
                    <td>none | &lt;custom-ident>+
                    <td>none
        </table>
    </div>
    <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link"
            href="#idl-index"></a></h2>
    <pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/cssom-1/#cssrule"><c- g>CSSRule</c-></a> {
  <c- b>const</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <a href="#dom-cssrule-view_transition_rule"><code><c- g>VIEW_TRANSITION_RULE</c-></code></a> = 15;
};

<c- b>enum</c-> <a href="#enumdef-viewtransitionnavigation"><code><c- g>ViewTransitionNavigation</c-></code></a> { <a href="#dom-viewtransitionnavigation-auto"><code><c- s>"auto"</c-></code></a>, <a href="#dom-viewtransitionnavigation-none"><code><c- s>"none"</c-></code></a> };

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#cssviewtransitionrule"><code><c- g>CSSViewTransitionRule</c-></code></a> : <a data-link-type="idl-name" href="https://www.w3.org/TR/cssom-1/#cssrule"><c- n>CSSRule</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-viewtransitionnavigation"><c- n>ViewTransitionNavigation</c-></a> <a data-readonly data-type="ViewTransitionNavigation" href="#dom-cssviewtransitionrule-navigation"><code><c- g>navigation</c-></code></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-frozen-array"><c- b>FrozenArray</c-></a>&lt;<a data-link-type="idl-name" href="https://www.w3.org/TR/cssom-1/#cssomstring"><c- n>CSSOMString</c-></a>> <a data-readonly data-type="FrozenArray<CSSOMString>" href="#dom-cssviewtransitionrule-types"><code><c- g>types</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#viewtransitiontypeset"><code><c- g>ViewTransitionTypeSet</c-></code></a> {
  <c- b>setlike</c->&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition"><c- g>ViewTransition</c-></a> {
  <c- b>attribute</c-> <a data-link-type="idl-name" href="#viewtransitiontypeset"><c- n>ViewTransitionTypeSet</c-></a> <a data-type="ViewTransitionTypeSet" href="#dom-viewtransition-types"><code><c- g>types</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-startviewtransitionoptions"><code><c- g>StartViewTransitionOptions</c-></code></a> {
  <a data-link-type="idl-name" href="https://www.w3.org/TR/css-view-transitions-1/#callbackdef-updatecallback"><c- n>UpdateCallback</c-></a>? <a data-default="null" data-type="UpdateCallback? " href="#dom-startviewtransitionoptions-update"><code><c- g>update</c-></code></a> = <c- b>null</c->;
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>>? <a data-default="null" data-type="sequence<DOMString>? " href="#dom-startviewtransitionoptions-types"><code><c- g>types</c-></code></a> = <c- b>null</c->;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#document"><c- g>Document</c-></a> {

  <a data-link-type="idl-name" href="https://www.w3.org/TR/css-view-transitions-1/#viewtransition"><c- n>ViewTransition</c-></a> <a class="idl-code" data-link-type="method" href="#dom-document-startviewtransition"><c- g>startViewTransition</c-></a>(<c- b>optional</c-> (<a data-link-type="idl-name" href="https://www.w3.org/TR/css-view-transitions-1/#callbackdef-updatecallback"><c- n>UpdateCallback</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#dictdef-startviewtransitionoptions"><c- n>StartViewTransitionOptions</c-></a>) <a href="#dom-document-startviewtransition-callbackoptions-callbackoptions"><code><c- g>callbackOptions</c-></code></a> = {});
};

</pre>
    <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a
            class="self-link" href="#issues-index"></a></h2>
    <div style="counter-reset:issue">
        <div class="issue"> Though <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-view-transitions-1/#capture-the-old-state">capture the old state</a>
            appears here as a synchronous step, it is in fact an asynchronous step
            as rendering an element into an image cannot be done synchronously. This should be more explicit in the L1
            spec. <a class="issue-return" href="#issue-ca114a78" title="Jump to section">↵</a></div>
    </div>
    <script>/* Boilerplate: script-dom-helper */
        "use strict";
        function query(sel) { return document.querySelector(sel); }

        function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

        function iter(obj) {
            if (!obj) return [];
            var it = obj[Symbol.iterator];
            if (it) return it;
            return Object.entries(obj);
        }

        function mk(tagname, attrs, ...children) {
            const el = document.createElement(tagname);
            for (const [k, v] of iter(attrs)) {
                if (k.slice(0, 3) == "_on") {
                    const eventName = k.slice(3);
                    el.addEventListener(eventName, v);
                } else if (k[0] == "_") {
                    // property, not attribute
                    el[k.slice(1)] = v;
                } else {
                    if (v === false || v == null) {
                        continue;
                    } else if (v === true) {
                        el.setAttribute(k, "");
                        continue;
                    } else {
                        el.setAttribute(k, v);
                    }
                }
            }
            append(el, children);
            return el;
        }

        /* Create shortcuts for every known HTML element */
        [
            "a",
            "abbr",
            "acronym",
            "address",
            "applet",
            "area",
            "article",
            "aside",
            "audio",
            "b",
            "base",
            "basefont",
            "bdo",
            "big",
            "blockquote",
            "body",
            "br",
            "button",
            "canvas",
            "caption",
            "center",
            "cite",
            "code",
            "col",
            "colgroup",
            "datalist",
            "dd",
            "del",
            "details",
            "dfn",
            "dialog",
            "div",
            "dl",
            "dt",
            "em",
            "embed",
            "fieldset",
            "figcaption",
            "figure",
            "font",
            "footer",
            "form",
            "frame",
            "frameset",
            "head",
            "header",
            "h1",
            "h2",
            "h3",
            "h4",
            "h5",
            "h6",
            "hr",
            "html",
            "i",
            "iframe",
            "img",
            "input",
            "ins",
            "kbd",
            "label",
            "legend",
            "li",
            "link",
            "main",
            "map",
            "mark",
            "meta",
            "meter",
            "nav",
            "nobr",
            "noscript",
            "object",
            "ol",
            "optgroup",
            "option",
            "output",
            "p",
            "param",
            "pre",
            "progress",
            "q",
            "s",
            "samp",
            "script",
            "section",
            "select",
            "small",
            "source",
            "span",
            "strike",
            "strong",
            "style",
            "sub",
            "summary",
            "sup",
            "table",
            "tbody",
            "td",
            "template",
            "textarea",
            "tfoot",
            "th",
            "thead",
            "time",
            "title",
            "tr",
            "u",
            "ul",
            "var",
            "video",
            "wbr",
            "xmp",
        ].forEach(tagname => {
            mk[tagname] = (...args) => mk(tagname, ...args);
        });

        function* nodesFromChildList(children) {
            for (const child of children.flat(Infinity)) {
                if (child instanceof Node) {
                    yield child;
                } else {
                    yield new Text(child);
                }
            }
        }
        function append(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                if (el instanceof Node) el.appendChild(child);
                else el.push(child);
            }
            return el;
        }

        function insertAfter(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                el.parentNode.insertBefore(child, el.nextSibling);
            }
            return el;
        }

        function clearContents(el) {
            el.innerHTML = "";
            return el;
        }

        function parseHTML(markup) {
            if (markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
                const doc = document.implementation.createHTMLDocument("");
                doc.documentElement.innerHTML = markup;
                return doc;
            } else {
                const el = mk.template({});
                el.innerHTML = markup;
                return el.content;
            }
        }</script>
    <script>/* Boilerplate: script-dfn-panel */
        "use strict";
        {
            let dfnPanelData = {
                "027e3e49": { "dfnID": "027e3e49", "dfnText": "clone (for list)", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-list-clone" }], "title": "5. Extending document.startViewTransition()" }], "url": "https://infra.spec.whatwg.org/#list-clone" },
                "0d02a1c8": { "dfnID": "0d02a1c8", "dfnText": "activation", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-pageswapevent-activation" }], "title": "2.1.3.1. Handling the view transition in the old document" }], "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pageswapevent-activation" },
                "0e3ba9f8": { "dfnID": "0e3ba9f8", "dfnText": "fully active", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-fully-active" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active" },
                "0e8de730": { "dfnID": "0e8de730", "dfnText": "tuple", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-tuple" }], "title": "6.1.3. Serializable view transition params" }], "url": "https://infra.spec.whatwg.org/#tuple" },
                "0f78dbdd": { "dfnID": "0f78dbdd", "dfnText": "CSSRule", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-cssrule" }, { "id": "ref-for-cssrule\u2460" }], "title": "2.3.3. Accessing the @view-transition rule using CSSOM" }], "url": "https://www.w3.org/TR/cssom-1/#cssrule" },
                "15e48c39": { "dfnID": "15e48c39", "dfnText": "set", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ordered-set" }], "title": "3.4. Changing the types of an ongoing view transition" }, { "refs": [{ "id": "ref-for-ordered-set\u2460" }], "title": "5. Extending document.startViewTransition()" }, { "refs": [{ "id": "ref-for-ordered-set\u2461" }, { "id": "ref-for-ordered-set\u2462" }], "title": "6.2. Resolving the @view-transition rule" }], "url": "https://infra.spec.whatwg.org/#ordered-set" },
                "15e81c46": { "dfnID": "15e81c46", "dfnText": "type selector", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-type-selector" }], "title": "4.4. Additions to named view transition pseudo-elements" }], "url": "https://www.w3.org/TR/selectors-4/#type-selector" },
                "1815821e": { "dfnID": "1815821e", "dfnText": "PageSwapEvent", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-pageswapevent" }], "title": "2.1.3.1. Handling the view transition in the old document" }], "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#pageswapevent" },
                "1d314002": { "dfnID": "1d314002", "dfnText": "pageswap", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-event-pageswap" }], "title": "2.1.3.1. Handling the view transition in the old document" }, { "refs": [{ "id": "ref-for-event-pageswap\u2460" }], "title": "2.1.4. Lifecycle" }, { "refs": [{ "id": "ref-for-event-pageswap\u2461" }], "title": "5. Extending document.startViewTransition()" }], "url": "https://html.spec.whatwg.org/multipage/indices.html#event-pageswap" },
                "257d7734": { "dfnID": "257d7734", "dfnText": "::view-transition-group()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-selectordef-view-transition-group" }], "title": "4.3. The view-transition-class property" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-group" },
                "265a80eb": { "dfnID": "265a80eb", "dfnText": "expect", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-link-type-expect" }], "title": "2.1.2. Waiting for the new state to stabilize" }], "url": "https://html.spec.whatwg.org/multipage/links.html#link-type-expect" },
                "28e82ba6": { "dfnID": "28e82ba6", "dfnText": "rendering suppression for view transitions", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-document-rendering-suppression-for-view-transitions" }, { "id": "ref-for-document-rendering-suppression-for-view-transitions\u2460" }], "title": "6.3.5. Proceed with cross-document view transition after capturing the old state" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#document-rendering-suppression-for-view-transitions" },
                "2e5e13e1": { "dfnID": "2e5e13e1", "dfnText": "captured element", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-captured-element" }], "title": "2.1.4. Lifecycle" }, { "refs": [{ "id": "ref-for-captured-element\u2460" }], "title": "6.1.3. Serializable view transition params" }, { "refs": [{ "id": "ref-for-captured-element\u2461" }], "title": "6.1.4. Captured elements extension" }, { "refs": [{ "id": "ref-for-captured-element\u2462" }], "title": "6.5. Capturing the view-transition-class" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#captured-element" },
                "2f0ba72c": { "dfnID": "2f0ba72c", "dfnText": "document element", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-document-element" }, { "id": "ref-for-document-element\u2460" }], "title": "3.1. Overview" }, { "refs": [{ "id": "ref-for-document-element\u2461" }], "title": "3.3.1. The :active-view-transition pseudo-class" }, { "refs": [{ "id": "ref-for-document-element\u2462" }], "title": "3.3.2. The :active-view-transition-type() pseudo-class" }], "url": "https://dom.spec.whatwg.org/#document-element" },
                "3024958b": { "dfnID": "3024958b", "dfnText": "method steps", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-method-steps" }, { "id": "ref-for-method-steps\u2460" }], "title": "5. Extending document.startViewTransition()" }], "url": "https://webidl.spec.whatwg.org/#method-steps" },
                "34e73e3f": { "dfnID": "34e73e3f", "dfnText": "viewTransition (for PageSwapEvent)", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-pageswapevent-viewtransition" }], "title": "2.1.3.1. Handling the view transition in the old document" }, { "refs": [{ "id": "ref-for-dom-pageswapevent-viewtransition\u2460" }], "title": "2.1.4. Lifecycle" }], "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pageswapevent-viewtransition" },
                "3560d057": { "dfnID": "3560d057", "dfnText": "HTMLLinkElement", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-htmllinkelement" }], "title": "2.1.2. Waiting for the new state to stabilize" }], "url": "https://html.spec.whatwg.org/multipage/semantics.html#htmllinkelement" },
                "388bc3fc": { "dfnID": "388bc3fc", "dfnText": "selector", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-selector" }, { "id": "ref-for-selector\u2460" }, { "id": "ref-for-selector\u2461" }], "title": "4.4. Additions to named view transition pseudo-elements" }], "url": "https://www.w3.org/TR/selectors-4/#selector" },
                "3b90bdcd": { "dfnID": "3b90bdcd", "dfnText": "resolve", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-resolve" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://webidl.spec.whatwg.org/#resolve" },
                "3d29f343": { "dfnID": "3d29f343", "dfnText": "named view transition pseudo-elements", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-named-view-transition-pseudo-elements" }], "title": "4.1. Overview" }, { "refs": [{ "id": "ref-for-named-view-transition-pseudo-elements\u2460" }, { "id": "ref-for-named-view-transition-pseudo-elements\u2461" }, { "id": "ref-for-named-view-transition-pseudo-elements\u2462" }], "title": "4.3. The view-transition-class property" }, { "refs": [{ "id": "ref-for-named-view-transition-pseudo-elements\u2463" }, { "id": "ref-for-named-view-transition-pseudo-elements\u2464" }, { "id": "ref-for-named-view-transition-pseudo-elements\u2465" }, { "id": "ref-for-named-view-transition-pseudo-elements\u2466" }], "title": "4.4. Additions to named view transition pseudo-elements" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#named-view-transition-pseudo-elements" },
                "3d5a9d15": { "dfnID": "3d5a9d15", "dfnText": "named elements", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-viewtransition-named-elements" }], "title": "4.4. Additions to named view transition pseudo-elements" }, { "refs": [{ "id": "ref-for-viewtransition-named-elements\u2460" }], "title": "6.3.5. Proceed with cross-document view transition after capturing the old state" }, { "refs": [{ "id": "ref-for-viewtransition-named-elements\u2461" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#viewtransition-named-elements" },
                "3f152388": { "dfnID": "3f152388", "dfnText": "activate view transition", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-activate-view-transition" }], "title": "2.1.4. Lifecycle" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#activate-view-transition" },
                "3f4cb357": { "dfnID": "3f4cb357", "dfnText": "::view-transition-old()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-selectordef-view-transition-old" }], "title": "4.3. The view-transition-class property" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-old" },
                "3fca5a9e": { "dfnID": "3fca5a9e", "dfnText": "map", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-ordered-map" }], "title": "6.1.3. Serializable view transition params" }], "url": "https://infra.spec.whatwg.org/#ordered-map" },
                "4013a022": { "dfnID": "4013a022", "dfnText": "this", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-this" }], "title": "3.4. Changing the types of an ongoing view transition" }], "url": "https://webidl.spec.whatwg.org/#this" },
                "4397147f": { "dfnID": "4397147f", "dfnText": "@media", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-at-ruledef-media" }], "title": "2.3.1. The @view-transition rule" }], "url": "https://www.w3.org/TR/css-conditional-3/#at-ruledef-media" },
                "43f1a6f1": { "dfnID": "43f1a6f1", "dfnText": "render-blocking mechanism", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-render-blocking-mechanism" }], "title": "2.1.2. Waiting for the new state to stabilize" }], "url": "https://html.spec.whatwg.org/multipage/dom.html#render-blocking-mechanism" },
                "450958f7": { "dfnID": "450958f7", "dfnText": "unsigned short", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-idl-unsigned-short" }], "title": "2.3.3. Accessing the @view-transition rule using CSSOM" }], "url": "https://webidl.spec.whatwg.org/#idl-unsigned-short" },
                "473036cd": { "dfnID": "473036cd", "dfnText": "cross-origin isolated capability", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-settings-object-cross-origin-isolated-capability" }, { "id": "ref-for-concept-settings-object-cross-origin-isolated-capability\u2460" }], "title": "Security Considerations" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability" },
                "48438eb3": { "dfnID": "48438eb3", "dfnText": "queue a global task", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-queue-a-global-task" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" },
                "4eb9d37e": { "dfnID": "4eb9d37e", "dfnText": "|", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-comb-one" }], "title": "2.3.2. The navigation descriptor" }, { "refs": [{ "id": "ref-for-comb-one\u2460" }], "title": "3.5. Activating the transition type for cross-document view transitions" }, { "refs": [{ "id": "ref-for-comb-one\u2461" }], "title": "4.3. The view-transition-class property" }, { "refs": [{ "id": "ref-for-comb-one\u2462" }], "title": "4.4. Additions to named view transition pseudo-elements" }], "url": "https://www.w3.org/TR/css-values-4/#comb-one" },
                "5216e1a0": { "dfnID": "5216e1a0", "dfnText": "node document", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-node-document" }], "title": "3.3.1. The :active-view-transition pseudo-class" }, { "refs": [{ "id": "ref-for-concept-node-document\u2460" }], "title": "3.3.2. The :active-view-transition-type() pseudo-class" }], "url": "https://dom.spec.whatwg.org/#concept-node-document" },
                "53fbe689": { "dfnID": "53fbe689", "dfnText": "capture the old state", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-capture-the-old-state" }], "title": "2.1.4. Lifecycle" }, { "refs": [{ "id": "ref-for-capture-the-old-state\u2460" }, { "id": "ref-for-capture-the-old-state\u2461" }], "title": "6.3.5. Proceed with cross-document view transition after capturing the old state" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#capture-the-old-state" },
                "54f188b7": { "dfnID": "54f188b7", "dfnText": "phase", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-viewtransition-phase" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }, { "refs": [{ "id": "ref-for-viewtransition-phase\u2460" }], "title": "6.3.5. Proceed with cross-document view transition after capturing the old state" }, { "refs": [{ "id": "ref-for-viewtransition-phase\u2461" }, { "id": "ref-for-viewtransition-phase\u2462" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#viewtransition-phase" },
                "55372230": { "dfnID": "55372230", "dfnText": "viewTransition (for PageRevealEvent)", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-pagerevealevent-viewtransition" }], "title": "2.1.3.2. Handling the view transition in the new document" }, { "refs": [{ "id": "ref-for-dom-pagerevealevent-viewtransition\u2460" }], "title": "2.1.4. Lifecycle" }], "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pagerevealevent-viewtransition" },
                "5991ccfb": { "dfnID": "5991ccfb", "dfnText": "relevant realm", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-relevant-realm" }], "title": "5. Extending document.startViewTransition()" }, { "refs": [{ "id": "ref-for-concept-relevant-realm\u2460" }, { "id": "ref-for-concept-relevant-realm\u2461" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }, { "refs": [{ "id": "ref-for-concept-relevant-realm\u2462" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm" },
                "5a31d22c": { "dfnID": "5a31d22c", "dfnText": "pagereveal", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-event-pagereveal" }], "title": "2.1.3.2. Handling the view transition in the new document" }, { "refs": [{ "id": "ref-for-event-pagereveal\u2460" }], "title": "2.1.4. Lifecycle" }, { "refs": [{ "id": "ref-for-event-pagereveal\u2461" }], "title": "2.2. Examples" }, { "refs": [{ "id": "ref-for-event-pagereveal\u2462" }, { "id": "ref-for-event-pagereveal\u2463" }, { "id": "ref-for-event-pagereveal\u2464" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }], "url": "https://html.spec.whatwg.org/multipage/indices.html#event-pagereveal" },
                "5ce34159": { "dfnID": "5ce34159", "dfnText": "startViewTransition(updateCallback)", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-document-startviewtransition\u2466" }], "title": "5. Extending document.startViewTransition()" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#dom-document-startviewtransition" },
                "649608b9": { "dfnID": "649608b9", "dfnText": "list", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-list" }], "title": "6.1.4. Captured elements extension" }], "url": "https://infra.spec.whatwg.org/#list" },
                "69516351": { "dfnID": "69516351", "dfnText": "was created via cross-origin redirects", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-was-created-via-cross-origin-redirects" }], "title": "6.3.1. Check eligibility for outbound cross-document view transition" }, { "refs": [{ "id": "ref-for-was-created-via-cross-origin-redirects\u2460" }], "title": "Security Considerations" }], "url": "https://html.spec.whatwg.org/multipage/dom.html#was-created-via-cross-origin-redirects" },
                "6998ead7": { "dfnID": "6998ead7", "dfnText": "rendering opportunity", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-rendering-opportunity" }], "title": "2.1.4. Lifecycle" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#rendering-opportunity" },
                "6a40c011": { "dfnID": "6a40c011", "dfnText": "has been revealed", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-has-been-revealed" }], "title": "6.3.3. Update the opt-in flag to reflect the current state" }, { "refs": [{ "id": "ref-for-has-been-revealed\u2460" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://html.spec.whatwg.org/multipage/browsing-the-web.html#has-been-revealed" },
                "6c645596": { "dfnID": "6c645596", "dfnText": "initial snapshot containing block size", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-viewtransition-initial-snapshot-containing-block-size" }], "title": "6.3.5. Proceed with cross-document view transition after capturing the old state" }, { "refs": [{ "id": "ref-for-viewtransition-initial-snapshot-containing-block-size\u2460" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#viewtransition-initial-snapshot-containing-block-size" },
                "6d273060": { "dfnID": "6d273060", "dfnText": "replace", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-navigationtype-replace" }], "title": "2.3.2. The navigation descriptor" }], "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-replace" },
                "6f5567e9": { "dfnID": "6f5567e9", "dfnText": "reload", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-navigationtype-reload" }], "title": "2.3.2. The navigation descriptor" }, { "refs": [{ "id": "ref-for-dom-navigationtype-reload\u2460" }], "title": "6.3.1. Check eligibility for outbound cross-document view transition" }], "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-reload" },
                "705b4fd3": { "dfnID": "705b4fd3", "dfnText": "class", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-class" }, { "id": "ref-for-concept-class\u2460" }], "title": "4.1. Overview" }], "url": "https://dom.spec.whatwg.org/#concept-class" },
                "7393da89": { "dfnID": "7393da89", "dfnText": "same origin", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-same-origin" }], "title": "2.1.1. Activation" }, { "refs": [{ "id": "ref-for-same-origin\u2460" }], "title": "2.1.4. Lifecycle" }, { "refs": [{ "id": "ref-for-same-origin\u2461" }], "title": "6.3.1. Check eligibility for outbound cross-document view transition" }], "url": "https://html.spec.whatwg.org/multipage/browsers.html#same-origin" },
                "773c38f9": { "dfnID": "773c38f9", "dfnText": "updateCallbackDone", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-viewtransition-updatecallbackdone" }], "title": "2.1.4. Lifecycle" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-updatecallbackdone" },
                "77b4c09a": { "dfnID": "77b4c09a", "dfnText": "assert", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-assert" }, { "id": "ref-for-assert\u2460" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }, { "refs": [{ "id": "ref-for-assert\u2461" }, { "id": "ref-for-assert\u2462" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://infra.spec.whatwg.org/#assert" },
                "77bcdcee": { "dfnID": "77bcdcee", "dfnText": "perform pending transition operations", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-perform-pending-transition-operations" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }, { "refs": [{ "id": "ref-for-perform-pending-transition-operations\u2460" }], "title": "6.3.5. Proceed with cross-document view transition after capturing the old state" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#perform-pending-transition-operations" },
                "787ad014": { "dfnID": "787ad014", "dfnText": "blocking (for HTMLStyleElement)", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-style-blocking" }], "title": "2.1.2. Waiting for the new state to stabilize" }], "url": "https://html.spec.whatwg.org/multipage/semantics.html#dom-style-blocking" },
                "797018a7": { "dfnID": "797018a7", "dfnText": "InvalidStateError", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-invalidstateerror" }], "title": "5. Extending document.startViewTransition()" }], "url": "https://webidl.spec.whatwg.org/#invalidstateerror" },
                "7a899a17": { "dfnID": "7a899a17", "dfnText": "sessionStorage", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-sessionstorage" }], "title": "2.2. Examples" }], "url": "https://html.spec.whatwg.org/multipage/webstorage.html#dom-sessionstorage" },
                "833154f2": { "dfnID": "833154f2", "dfnText": "getter steps", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-getter-steps" }], "title": "3.4. Changing the types of an ongoing view transition" }], "url": "https://webidl.spec.whatwg.org/#getter-steps" },
                "85394472": { "dfnID": "85394472", "dfnText": "Document", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-document" }, { "id": "ref-for-document\u2460" }, { "id": "ref-for-document\u2461" }, { "id": "ref-for-document\u2462" }, { "id": "ref-for-document\u2463" }, { "id": "ref-for-document\u2464" }, { "id": "ref-for-document\u2465" }, { "id": "ref-for-document\u2466" }, { "id": "ref-for-document\u2467" }], "title": "2.1.4. Lifecycle" }, { "refs": [{ "id": "ref-for-document\u2468" }], "title": "2.3.1. The @view-transition rule" }, { "refs": [{ "id": "ref-for-document\u2460\u24ea" }], "title": "3.5. Activating the transition type for cross-document view transitions" }, { "refs": [{ "id": "ref-for-document\u2460\u2460" }], "title": "5. Extending document.startViewTransition()" }, { "refs": [{ "id": "ref-for-document\u2460\u2461" }, { "id": "ref-for-document\u2460\u2462" }], "title": "6.1.1. Additions to Document" }, { "refs": [{ "id": "ref-for-document\u2460\u2463" }], "title": "6.2. Resolving the @view-transition rule" }, { "refs": [{ "id": "ref-for-document\u2460\u2464" }], "title": "6.3. Setting up the view transition in the old Document" }, { "refs": [{ "id": "ref-for-document\u2460\u2465" }, { "id": "ref-for-document\u2460\u2466" }], "title": "6.3.1. Check eligibility for outbound cross-document view transition" }, { "refs": [{ "id": "ref-for-document\u2460\u2467" }, { "id": "ref-for-document\u2460\u2468" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }, { "refs": [{ "id": "ref-for-document\u2461\u24ea" }], "title": "6.3.3. Update the opt-in flag to reflect the current state" }, { "refs": [{ "id": "ref-for-document\u2461\u2460" }], "title": "6.3.5. Proceed with cross-document view transition after capturing the old state" }, { "refs": [{ "id": "ref-for-document\u2461\u2461" }, { "id": "ref-for-document\u2461\u2462" }], "title": "6.4. Activating the view transition in the new Document" }, { "refs": [{ "id": "ref-for-document\u2461\u2463" }, { "id": "ref-for-document\u2461\u2464" }, { "id": "ref-for-document\u2461\u2465" }], "title": "Security Considerations" }], "url": "https://dom.spec.whatwg.org/#document" },
                "860300d4": { "dfnID": "860300d4", "dfnText": "implementation-defined", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-implementation-defined" }], "title": "6.3.1. Check eligibility for outbound cross-document view transition" }, { "refs": [{ "id": "ref-for-implementation-defined\u2460" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://infra.spec.whatwg.org/#implementation-defined" },
                "8855a9aa": { "dfnID": "8855a9aa", "dfnText": "DOMString", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-idl-DOMString" }], "title": "3.4. Changing the types of an ongoing view transition" }, { "refs": [{ "id": "ref-for-idl-DOMString\u2460" }], "title": "5. Extending document.startViewTransition()" }], "url": "https://webidl.spec.whatwg.org/#idl-DOMString" },
                "889e932f": { "dfnID": "889e932f", "dfnText": "Exposed", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-Exposed" }], "title": "2.3.3. Accessing the @view-transition rule using CSSOM" }, { "refs": [{ "id": "ref-for-Exposed\u2460" }, { "id": "ref-for-Exposed\u2461" }], "title": "3.4. Changing the types of an ongoing view transition" }], "url": "https://webidl.spec.whatwg.org/#Exposed" },
                "8ae6697b": { "dfnID": "8ae6697b", "dfnText": "<pt-name-selector>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-pt-name-selector" }, { "id": "ref-for-typedef-pt-name-selector\u2460" }, { "id": "ref-for-typedef-pt-name-selector\u2461" }, { "id": "ref-for-typedef-pt-name-selector\u2462" }], "title": "4.4. Additions to named view transition pseudo-elements" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#typedef-pt-name-selector" },
                "8b0471c9": { "dfnID": "8b0471c9", "dfnText": "active view transition", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-document-active-view-transition" }], "title": "1. Introduction" }, { "refs": [{ "id": "ref-for-document-active-view-transition\u2460" }, { "id": "ref-for-document-active-view-transition\u2461" }], "title": "3.1. Overview" }, { "refs": [{ "id": "ref-for-document-active-view-transition\u2462" }, { "id": "ref-for-document-active-view-transition\u2463" }], "title": "3.3.1. The :active-view-transition pseudo-class" }, { "refs": [{ "id": "ref-for-document-active-view-transition\u2464" }, { "id": "ref-for-document-active-view-transition\u2465" }], "title": "3.3.2. The :active-view-transition-type() pseudo-class" }, { "refs": [{ "id": "ref-for-document-active-view-transition\u2466" }], "title": "5. Extending document.startViewTransition()" }, { "refs": [{ "id": "ref-for-document-active-view-transition\u2467" }, { "id": "ref-for-document-active-view-transition\u2468" }, { "id": "ref-for-document-active-view-transition\u2460\u24ea" }, { "id": "ref-for-document-active-view-transition\u2460\u2460" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }, { "refs": [{ "id": "ref-for-document-active-view-transition\u2460\u2461" }, { "id": "ref-for-document-active-view-transition\u2460\u2462" }], "title": "6.3.5. Proceed with cross-document view transition after capturing the old state" }, { "refs": [{ "id": "ref-for-document-active-view-transition\u2460\u2463" }, { "id": "ref-for-document-active-view-transition\u2460\u2464" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition" },
                "8c8e51b4": { "dfnID": "8c8e51b4", "dfnText": "computed value", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-computed-value" }, { "id": "ref-for-computed-value\u2460" }, { "id": "ref-for-computed-value\u2461" }, { "id": "ref-for-computed-value\u2462" }], "title": "6.2. Resolving the @view-transition rule" }, { "refs": [{ "id": "ref-for-computed-value\u2463" }], "title": "6.5. Capturing the view-transition-class" }], "url": "https://www.w3.org/TR/css-cascade-5/#computed-value" },
                "90c99c05": { "dfnID": "90c99c05", "dfnText": "blocking (for HTMLScriptElement)", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-script-blocking" }], "title": "2.1.2. Waiting for the new state to stabilize" }], "url": "https://html.spec.whatwg.org/multipage/scripting.html#dom-script-blocking" },
                "984221ca": { "dfnID": "984221ca", "dfnText": "struct", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-struct" }], "title": "6.1.3. Serializable view transition params" }], "url": "https://infra.spec.whatwg.org/#struct" },
                "9bb2014b": { "dfnID": "9bb2014b", "dfnText": "update callback", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-viewtransition-update-callback" }], "title": "5. Extending document.startViewTransition()" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#viewtransition-update-callback" },
                "9cce47fd": { "dfnID": "9cce47fd", "dfnText": "sequence", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-idl-sequence" }], "title": "5. Extending document.startViewTransition()" }], "url": "https://webidl.spec.whatwg.org/#idl-sequence" },
                "9d357000": { "dfnID": "9d357000", "dfnText": "CSSOMString", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-cssomstring" }], "title": "2.3.3. Accessing the @view-transition rule using CSSOM" }], "url": "https://www.w3.org/TR/cssom-1/#cssomstring" },
                "a0144f62": { "dfnID": "a0144f62", "dfnText": "<custom-ident>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-identifier-value" }, { "id": "ref-for-identifier-value\u2460" }], "title": "3.3.2. The :active-view-transition-type() pseudo-class" }, { "refs": [{ "id": "ref-for-identifier-value\u2461" }], "title": "3.4. Changing the types of an ongoing view transition" }, { "refs": [{ "id": "ref-for-identifier-value\u2462" }], "title": "3.5. Activating the transition type for cross-document view transitions" }, { "refs": [{ "id": "ref-for-identifier-value\u2463" }, { "id": "ref-for-identifier-value\u2464" }, { "id": "ref-for-identifier-value\u2465" }, { "id": "ref-for-identifier-value\u2466" }, { "id": "ref-for-identifier-value\u2467" }], "title": "4.3. The view-transition-class property" }, { "refs": [{ "id": "ref-for-identifier-value\u2468" }, { "id": "ref-for-identifier-value\u2460\u24ea" }, { "id": "ref-for-identifier-value\u2460\u2460" }, { "id": "ref-for-identifier-value\u2460\u2461" }], "title": "4.4. Additions to named view transition pseudo-elements" }], "url": "https://www.w3.org/TR/css-values-4/#identifier-value" },
                "a4c36929": { "dfnID": "a4c36929", "dfnText": "NavigationType", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-navigationtype" }], "title": "2.3.2. The navigation descriptor" }, { "refs": [{ "id": "ref-for-navigationtype\u2460" }], "title": "6.3.1. Check eligibility for outbound cross-document view transition" }], "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#navigationtype" },
                "a5c91173": { "dfnID": "a5c91173", "dfnText": "SameObject", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-SameObject" }], "title": "2.3.3. Accessing the @view-transition rule using CSSOM" }], "url": "https://webidl.spec.whatwg.org/#SameObject" },
                "a5d6c9d2": { "dfnID": "a5d6c9d2", "dfnText": "@supports", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-at-ruledef-supports" }], "title": "2.3.1. The @view-transition rule" }], "url": "https://www.w3.org/TR/css-conditional-3/#at-ruledef-supports" },
                "a72449dd": { "dfnID": "a72449dd", "dfnText": "in parallel", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-in-parallel" }], "title": "2.3.1. The @view-transition rule" }, { "refs": [{ "id": "ref-for-in-parallel\u2460" }], "title": "6.1.1. Additions to Document" }, { "refs": [{ "id": "ref-for-in-parallel\u2461" }], "title": "6.3.1. Check eligibility for outbound cross-document view transition" }], "url": "https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" },
                "a81b1fb8": { "dfnID": "a81b1fb8", "dfnText": "<declaration-list>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-declaration-list" }], "title": "2.3.1. The @view-transition rule" }], "url": "https://www.w3.org/TR/css-syntax-3/#typedef-declaration-list" },
                "a8ff7689": { "dfnID": "a8ff7689", "dfnText": "update callback done promise", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-viewtransition-update-callback-done-promise" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#viewtransition-update-callback-done-promise" },
                "a94f7564": { "dfnID": "a94f7564", "dfnText": "capture the new state", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-capture-the-new-state" }], "title": "2.1.4. Lifecycle" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#capture-the-new-state" },
                "a973e0fe": { "dfnID": "a973e0fe", "dfnText": "document", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-document" }], "title": "1. Introduction" }], "url": "https://dom.spec.whatwg.org/#concept-document" },
                "a9aefc80": { "dfnID": "a9aefc80", "dfnText": "::view-transition-image-pair()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-selectordef-view-transition-image-pair" }], "title": "4.3. The view-transition-class property" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-image-pair" },
                "aa734171": { "dfnID": "aa734171", "dfnText": "view-transition-name", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-propdef-view-transition-name" }, { "id": "ref-for-propdef-view-transition-name\u2460" }, { "id": "ref-for-propdef-view-transition-name\u2461" }, { "id": "ref-for-propdef-view-transition-name\u2462" }, { "id": "ref-for-propdef-view-transition-name\u2463" }], "title": "4.3. The view-transition-class property" }, { "refs": [{ "id": "ref-for-propdef-view-transition-name\u2464" }], "title": "4.4. Additions to named view transition pseudo-elements" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#propdef-view-transition-name" },
                "ab3919d2": { "dfnID": "ab3919d2", "dfnText": "clone (for map)", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-map-clone" }], "title": "6.3.5. Proceed with cross-document view transition after capturing the old state" }], "url": "https://infra.spec.whatwg.org/#map-clone" },
                "abb51c3c": { "dfnID": "abb51c3c", "dfnText": "UpdateCallback", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-callbackdef-updatecallback" }, { "id": "ref-for-callbackdef-updatecallback\u2460" }, { "id": "ref-for-callbackdef-updatecallback\u2461" }], "title": "5. Extending document.startViewTransition()" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#callbackdef-updatecallback" },
                "active-view-transition-pseudo": { "dfnID": "active-view-transition-pseudo", "dfnText": ":active-view-transition", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-active-view-transition-pseudo" }, { "id": "ref-for-active-view-transition-pseudo\u2460" }], "title": "3.1. Overview" }, { "refs": [{ "id": "ref-for-active-view-transition-pseudo\u2461" }, { "id": "ref-for-active-view-transition-pseudo\u2462" }, { "id": "ref-for-active-view-transition-pseudo\u2463" }], "title": "3.3.1. The :active-view-transition pseudo-class" }], "url": "#active-view-transition-pseudo" },
                "active-view-transition-type-pseudo": { "dfnID": "active-view-transition-type-pseudo", "dfnText": ":active-view-transition-type()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-active-view-transition-type-pseudo" }, { "id": "ref-for-active-view-transition-type-pseudo\u2460" }], "title": "3.1. Overview" }, { "refs": [{ "id": "ref-for-active-view-transition-type-pseudo\u2461" }, { "id": "ref-for-active-view-transition-type-pseudo\u2462" }, { "id": "ref-for-active-view-transition-type-pseudo\u2463" }], "title": "3.3.2. The :active-view-transition-type() pseudo-class" }], "url": "#active-view-transition-type-pseudo" },
                "ae8def21": { "dfnID": "ae8def21", "dfnText": "contain", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-list-contain" }], "title": "3.3.2. The :active-view-transition-type() pseudo-class" }, { "refs": [{ "id": "ref-for-list-contain\u2460" }], "title": "4.4. Additions to named view transition pseudo-elements" }], "url": "https://infra.spec.whatwg.org/#list-contain" },
                "af4a190d": { "dfnID": "af4a190d", "dfnText": "+", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-one-plus" }], "title": "3.5. Activating the transition type for cross-document view transitions" }, { "refs": [{ "id": "ref-for-mult-one-plus\u2460" }], "title": "4.3. The view-transition-class property" }, { "refs": [{ "id": "ref-for-mult-one-plus\u2461" }], "title": "4.4. Additions to named view transition pseudo-elements" }], "url": "https://www.w3.org/TR/css-values-4/#mult-one-plus" },
                "at-view-transition-rule": { "dfnID": "at-view-transition-rule", "dfnText": "@view-transition", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-at-view-transition-rule" }], "title": "1. Introduction" }, { "refs": [{ "id": "ref-for-at-view-transition-rule\u2460" }], "title": "2.1.1. Activation" }, { "refs": [{ "id": "ref-for-at-view-transition-rule\u2461" }], "title": "2.2. Examples" }, { "refs": [{ "id": "ref-for-at-view-transition-rule\u2462" }, { "id": "ref-for-at-view-transition-rule\u2463" }, { "id": "ref-for-at-view-transition-rule\u2464" }, { "id": "ref-for-at-view-transition-rule\u2465" }, { "id": "ref-for-at-view-transition-rule\u2466" }, { "id": "ref-for-at-view-transition-rule\u2467" }], "title": "2.3.1. The @view-transition rule" }, { "refs": [{ "id": "ref-for-at-view-transition-rule\u2468" }], "title": "2.3.2. The navigation descriptor" }, { "refs": [{ "id": "ref-for-at-view-transition-rule\u2460\u24ea" }, { "id": "ref-for-at-view-transition-rule\u2460\u2460" }], "title": "2.3.3. Accessing the @view-transition rule using CSSOM" }, { "refs": [{ "id": "ref-for-at-view-transition-rule\u2460\u2461" }], "title": "3.5. Activating the transition type for cross-document view transitions" }, { "refs": [{ "id": "ref-for-at-view-transition-rule\u2460\u2462" }, { "id": "ref-for-at-view-transition-rule\u2460\u2463" }], "title": "6.2. Resolving the @view-transition rule" }], "url": "#at-view-transition-rule" },
                "b4c365f8": { "dfnID": "b4c365f8", "dfnText": "visibility state", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-visibility-state" }], "title": "6.2. Resolving the @view-transition rule" }], "url": "https://html.spec.whatwg.org/multipage/interaction.html#visibility-state" },
                "b5be7607": { "dfnID": "b5be7607", "dfnText": "class selector", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-class-selector" }], "title": "4.1. Overview" }], "url": "https://www.w3.org/TR/selectors-4/#class-selector" },
                "ba72ce8f": { "dfnID": "ba72ce8f", "dfnText": "specificity", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-specificity" }], "title": "3.3.1. The :active-view-transition pseudo-class" }, { "refs": [{ "id": "ref-for-specificity\u2460" }], "title": "3.3.2. The :active-view-transition-type() pseudo-class" }, { "refs": [{ "id": "ref-for-specificity\u2461" }, { "id": "ref-for-specificity\u2462" }], "title": "4.4. Additions to named view transition pseudo-elements" }], "url": "https://www.w3.org/TR/selectors-4/#specificity" },
                "c00d8c81": { "dfnID": "c00d8c81", "dfnText": "finished", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-viewtransition-finished" }], "title": "2.1.3.1. Handling the view transition in the old document" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-finished" },
                "c297b070": { "dfnID": "c297b070", "dfnText": "#", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-comma" }], "title": "3.3.2. The :active-view-transition-type() pseudo-class" }], "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
                "c62cd7cf": { "dfnID": "c62cd7cf", "dfnText": "origin", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-document-origin" }, { "id": "ref-for-concept-document-origin\u2460" }], "title": "6.3.1. Check eligibility for outbound cross-document view transition" }], "url": "https://dom.spec.whatwg.org/#concept-document-origin" },
                "c88f3887": { "dfnID": "c88f3887", "dfnText": "item", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-struct-item" }], "title": "6.1.3. Serializable view transition params" }], "url": "https://infra.spec.whatwg.org/#struct-item" },
                "c9ff317b": { "dfnID": "c9ff317b", "dfnText": "push", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-navigationtype-push" }], "title": "2.3.2. The navigation descriptor" }], "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-push" },
                "captured-element-class-list": { "dfnID": "captured-element-class-list", "dfnText": "class list", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-captured-element-class-list" }], "title": "4.4. Additions to named view transition pseudo-elements" }, { "refs": [{ "id": "ref-for-captured-element-class-list\u2460" }], "title": "6.5. Capturing the view-transition-class" }], "url": "#captured-element-class-list" },
                "cssviewtransitionrule": { "dfnID": "cssviewtransitionrule", "dfnText": "CSSViewTransitionRule", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-cssviewtransitionrule" }], "title": "2.3.3. Accessing the @view-transition rule using CSSOM" }], "url": "#cssviewtransitionrule" },
                "d1fbbaaa": { "dfnID": "d1fbbaaa", "dfnText": "ready", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-viewtransition-ready" }], "title": "2.1.3.2. Handling the view transition in the new document" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-ready" },
                "d25dfb2c": { "dfnID": "d25dfb2c", "dfnText": "AbortError", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-aborterror" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }], "url": "https://webidl.spec.whatwg.org/#aborterror" },
                "d4441b24": { "dfnID": "d4441b24", "dfnText": "?", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-opt" }], "title": "4.4. Additions to named view transition pseudo-elements" }], "url": "https://www.w3.org/TR/css-values-4/#mult-opt" },
                "da45ed1a": { "dfnID": "da45ed1a", "dfnText": "skip the view transition", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-skip-the-view-transition" }], "title": "5. Extending document.startViewTransition()" }, { "refs": [{ "id": "ref-for-skip-the-view-transition\u2460" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }, { "refs": [{ "id": "ref-for-skip-the-view-transition\u2461" }], "title": "6.3.4. Proceed with navigation if view transition is skipped" }, { "refs": [{ "id": "ref-for-skip-the-view-transition\u2462" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#skip-the-view-transition" },
                "dca2de17": { "dfnID": "dca2de17", "dfnText": "DOMException", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-idl-DOMException" }], "title": "5. Extending document.startViewTransition()" }, { "refs": [{ "id": "ref-for-idl-DOMException\u2460" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }, { "refs": [{ "id": "ref-for-idl-DOMException\u2461" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://webidl.spec.whatwg.org/#idl-DOMException" },
                "dcf5fafa": { "dfnID": "dcf5fafa", "dfnText": "FrozenArray", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-idl-frozen-array" }], "title": "2.3.3. Accessing the @view-transition rule using CSSOM" }], "url": "https://webidl.spec.whatwg.org/#idl-frozen-array" },
                "descdef-view-transition-navigation": { "dfnID": "descdef-view-transition-navigation", "dfnText": "navigation", "external": false, "refSections": [], "url": "#descdef-view-transition-navigation" },
                "descdef-view-transition-types": { "dfnID": "descdef-view-transition-types", "dfnText": "types", "external": false, "refSections": [], "url": "#descdef-view-transition-types" },
                "dfd67b05": { "dfnID": "dfd67b05", "dfnText": "*", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-x" }], "title": "4.4. Additions to named view transition pseudo-elements" }], "url": "https://www.w3.org/TR/selectors-3/#x" },
                "dictdef-startviewtransitionoptions": { "dfnID": "dictdef-startviewtransitionoptions", "dfnText": "StartViewTransitionOptions", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-dictdef-startviewtransitionoptions" }, { "id": "ref-for-dictdef-startviewtransitionoptions\u2460" }, { "id": "ref-for-dictdef-startviewtransitionoptions\u2461" }], "title": "5. Extending document.startViewTransition()" }], "url": "#dictdef-startviewtransitionoptions" },
                "document-can-initiate-outbound-view-transition": { "dfnID": "document-can-initiate-outbound-view-transition", "dfnText": "can initiate outbound view transition", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-document-can-initiate-outbound-view-transition" }], "title": "6.3.1. Check eligibility for outbound cross-document view transition" }, { "refs": [{ "id": "ref-for-document-can-initiate-outbound-view-transition\u2460" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }, { "refs": [{ "id": "ref-for-document-can-initiate-outbound-view-transition\u2461" }, { "id": "ref-for-document-can-initiate-outbound-view-transition\u2462" }], "title": "6.3.3. Update the opt-in flag to reflect the current state" }], "url": "#document-can-initiate-outbound-view-transition" },
                "document-inbound-view-transition-params": { "dfnID": "document-inbound-view-transition-params", "dfnText": "inbound view transition params", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-document-inbound-view-transition-params" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }, { "refs": [{ "id": "ref-for-document-inbound-view-transition-params\u2460" }, { "id": "ref-for-document-inbound-view-transition-params\u2461" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "#document-inbound-view-transition-params" },
                "dom-cssrule-view_transition_rule": { "dfnID": "dom-cssrule-view_transition_rule", "dfnText": "VIEW_TRANSITION_RULE", "external": false, "refSections": [], "url": "#dom-cssrule-view_transition_rule" },
                "dom-cssviewtransitionrule-navigation": { "dfnID": "dom-cssviewtransitionrule-navigation", "dfnText": "navigation", "external": false, "refSections": [], "url": "#dom-cssviewtransitionrule-navigation" },
                "dom-cssviewtransitionrule-types": { "dfnID": "dom-cssviewtransitionrule-types", "dfnText": "types", "external": false, "refSections": [], "url": "#dom-cssviewtransitionrule-types" },
                "dom-document-startviewtransition": { "dfnID": "dom-document-startviewtransition", "dfnText": "startViewTransition(callbackOptions)", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-dom-document-startviewtransition" }], "title": "2.1.1. Activation" }, { "refs": [{ "id": "ref-for-dom-document-startviewtransition\u2460" }], "title": "2.1.2. Waiting for the new state to stabilize" }, { "refs": [{ "id": "ref-for-dom-document-startviewtransition\u2461" }], "title": "2.1.3. Customization" }, { "refs": [{ "id": "ref-for-dom-document-startviewtransition\u2462" }], "title": "3.1. Overview" }, { "refs": [{ "id": "ref-for-dom-document-startviewtransition\u2463" }], "title": "3.5. Activating the transition type for cross-document view transitions" }, { "refs": [{ "id": "ref-for-dom-document-startviewtransition\u2464" }, { "id": "ref-for-dom-document-startviewtransition\u2465" }], "title": "5. Extending document.startViewTransition()" }], "url": "#dom-document-startviewtransition" },
                "dom-document-startviewtransition-callbackoptions-callbackoptions": { "dfnID": "dom-document-startviewtransition-callbackoptions-callbackoptions", "dfnText": "callbackOptions", "external": false, "refSections": [], "url": "#dom-document-startviewtransition-callbackoptions-callbackoptions" },
                "dom-startviewtransitionoptions-types": { "dfnID": "dom-startviewtransitionoptions-types", "dfnText": "types", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-dom-startviewtransitionoptions-types" }], "title": "3.5. Activating the transition type for cross-document view transitions" }, { "refs": [{ "id": "ref-for-dom-startviewtransitionoptions-types\u2460" }], "title": "5. Extending document.startViewTransition()" }], "url": "#dom-startviewtransitionoptions-types" },
                "dom-startviewtransitionoptions-update": { "dfnID": "dom-startviewtransitionoptions-update", "dfnText": "update", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-dom-startviewtransitionoptions-update" }], "title": "5. Extending document.startViewTransition()" }], "url": "#dom-startviewtransitionoptions-update" },
                "dom-viewtransition-types": { "dfnID": "dom-viewtransition-types", "dfnText": "types", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-dom-viewtransition-types" }], "title": "2.1.3.1. Handling the view transition in the old document" }, { "refs": [{ "id": "ref-for-dom-viewtransition-types\u2460" }], "title": "2.1.3.2. Handling the view transition in the new document" }, { "refs": [{ "id": "ref-for-dom-viewtransition-types\u2461" }, { "id": "ref-for-dom-viewtransition-types\u2462" }], "title": "2.1.4. Lifecycle" }, { "refs": [{ "id": "ref-for-dom-viewtransition-types\u2463" }], "title": "3.1. Overview" }, { "refs": [{ "id": "ref-for-dom-viewtransition-types\u2464" }], "title": "3.4. Changing the types of an ongoing view transition" }, { "refs": [{ "id": "ref-for-dom-viewtransition-types\u2465" }], "title": "5. Extending document.startViewTransition()" }, { "refs": [{ "id": "ref-for-dom-viewtransition-types\u2466" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }], "url": "#dom-viewtransition-types" },
                "dom-viewtransitionnavigation-auto": { "dfnID": "dom-viewtransitionnavigation-auto", "dfnText": "\"auto\"", "external": false, "refSections": [], "url": "#dom-viewtransitionnavigation-auto" },
                "dom-viewtransitionnavigation-none": { "dfnID": "dom-viewtransitionnavigation-none", "dfnText": "\"none\"", "external": false, "refSections": [], "url": "#dom-viewtransitionnavigation-none" },
                "e10e7eb7": { "dfnID": "e10e7eb7", "dfnText": "dom manipulation task source", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-manipulation-task-source" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" },
                "e270bd2a": { "dfnID": "e270bd2a", "dfnText": "task", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-task" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" },
                "e63d01fd": { "dfnID": "e63d01fd", "dfnText": "::view-transition-new()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-selectordef-view-transition-new" }], "title": "4.3. The view-transition-class property" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-new" },
                "e8b75507": { "dfnID": "e8b75507", "dfnText": "element", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-element" }], "title": "6.5. Capturing the view-transition-class" }], "url": "https://drafts.csswg.org/css2/#element" },
                "e93b877c": { "dfnID": "e93b877c", "dfnText": "reactivate", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-reactivate-a-document" }], "title": "Security Considerations" }], "url": "https://html.spec.whatwg.org/multipage/browsing-the-web.html#reactivate-a-document" },
                "e99bd18e": { "dfnID": "e99bd18e", "dfnText": "relevant global object", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-concept-relevant-global" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" },
                "enumdef-viewtransitionnavigation": { "dfnID": "enumdef-viewtransitionnavigation", "dfnText": "ViewTransitionNavigation", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-enumdef-viewtransitionnavigation" }], "title": "2.3.3. Accessing the @view-transition rule using CSSOM" }], "url": "#enumdef-viewtransitionnavigation" },
                "f0ba495b": { "dfnID": "f0ba495b", "dfnText": "TimeoutError", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-timeouterror" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://webidl.spec.whatwg.org/#timeouterror" },
                "f1a41224": { "dfnID": "f1a41224", "dfnText": "conditional group rule", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-conditional-group-rule" }], "title": "2.3.1. The @view-transition rule" }], "url": "https://www.w3.org/TR/css-conditional-3/#conditional-group-rule" },
                "f9e53f84": { "dfnID": "f9e53f84", "dfnText": "skipTransition()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-viewtransition-skiptransition" }, { "id": "ref-for-dom-viewtransition-skiptransition\u2460" }], "title": "2.1.4. Lifecycle" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-skiptransition" },
                "fa3348cc": { "dfnID": "fa3348cc", "dfnText": "traverse", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-navigationtype-traverse" }], "title": "2.1.1. Activation" }, { "refs": [{ "id": "ref-for-dom-navigationtype-traverse\u2460" }], "title": "2.3.2. The navigation descriptor" }, { "refs": [{ "id": "ref-for-dom-navigationtype-traverse\u2461" }], "title": "6.3.1. Check eligibility for outbound cross-document view transition" }], "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-traverse" },
                "fb8b141f": { "dfnID": "fb8b141f", "dfnText": "ViewTransition", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-viewtransition" }, { "id": "ref-for-viewtransition\u2460" }, { "id": "ref-for-viewtransition\u2461" }], "title": "2.1.3. Customization" }, { "refs": [{ "id": "ref-for-viewtransition\u2462" }, { "id": "ref-for-viewtransition\u2463" }, { "id": "ref-for-viewtransition\u2464" }], "title": "2.1.4. Lifecycle" }, { "refs": [{ "id": "ref-for-viewtransition\u2465" }], "title": "2.2. Examples" }, { "refs": [{ "id": "ref-for-viewtransition\u2466" }], "title": "2.3.1. The @view-transition rule" }, { "refs": [{ "id": "ref-for-viewtransition\u2467" }], "title": "3.1. Overview" }, { "refs": [{ "id": "ref-for-viewtransition\u2468" }, { "id": "ref-for-viewtransition\u2460\u24ea" }], "title": "3.4. Changing the types of an ongoing view transition" }, { "refs": [{ "id": "ref-for-viewtransition\u2460\u2460" }, { "id": "ref-for-viewtransition\u2460\u2461" }], "title": "5. Extending document.startViewTransition()" }, { "refs": [{ "id": "ref-for-viewtransition\u2460\u2462" }, { "id": "ref-for-viewtransition\u2460\u2463" }], "title": "6.1.2. Additions to ViewTransition" }, { "refs": [{ "id": "ref-for-viewtransition\u2460\u2464" }, { "id": "ref-for-viewtransition\u2460\u2465" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }, { "refs": [{ "id": "ref-for-viewtransition\u2460\u2466" }], "title": "6.3.4. Proceed with navigation if view transition is skipped" }, { "refs": [{ "id": "ref-for-viewtransition\u2460\u2467" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "https://www.w3.org/TR/css-view-transitions-1/#viewtransition" },
                "navigation-can-trigger-a-cross-document-view-transition": { "dfnID": "navigation-can-trigger-a-cross-document-view-transition", "dfnText": "navigation can trigger a cross-document view-transition?", "external": false, "refSections": [], "url": "#navigation-can-trigger-a-cross-document-view-transition" },
                "propdef-view-transition-class": { "dfnID": "propdef-view-transition-class", "dfnText": "view-transition-class", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-propdef-view-transition-class" }], "title": "1. Introduction" }, { "refs": [{ "id": "ref-for-propdef-view-transition-class\u2460" }, { "id": "ref-for-propdef-view-transition-class\u2461" }, { "id": "ref-for-propdef-view-transition-class\u2462" }, { "id": "ref-for-propdef-view-transition-class\u2463" }, { "id": "ref-for-propdef-view-transition-class\u2464" }, { "id": "ref-for-propdef-view-transition-class\u2465" }], "title": "4.3. The view-transition-class property" }, { "refs": [{ "id": "ref-for-propdef-view-transition-class\u2466" }, { "id": "ref-for-propdef-view-transition-class\u2467" }], "title": "6.5. Capturing the view-transition-class" }], "url": "#propdef-view-transition-class" },
                "resolve-inbound-cross-document-view-transition": { "dfnID": "resolve-inbound-cross-document-view-transition", "dfnText": "resolve inbound cross-document view-transition", "external": false, "refSections": [], "url": "#resolve-inbound-cross-document-view-transition" },
                "resolve-view-transition-rule": { "dfnID": "resolve-view-transition-rule", "dfnText": "resolve @view-transition rule", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-resolve-view-transition-rule" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }, { "refs": [{ "id": "ref-for-resolve-view-transition-rule\u2460" }], "title": "6.3.3. Update the opt-in flag to reflect the current state" }, { "refs": [{ "id": "ref-for-resolve-view-transition-rule\u2461" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "#resolve-view-transition-rule" },
                "setup-cross-document-view-transition": { "dfnID": "setup-cross-document-view-transition", "dfnText": "setup cross-document view-transition", "external": false, "refSections": [], "url": "#setup-cross-document-view-transition" },
                "typedef-pt-class-selector": { "dfnID": "typedef-pt-class-selector", "dfnText": "<pt-class-selector>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-pt-class-selector" }, { "id": "ref-for-typedef-pt-class-selector\u2460" }, { "id": "ref-for-typedef-pt-class-selector\u2461" }, { "id": "ref-for-typedef-pt-class-selector\u2462" }, { "id": "ref-for-typedef-pt-class-selector\u2463" }, { "id": "ref-for-typedef-pt-class-selector\u2464" }, { "id": "ref-for-typedef-pt-class-selector\u2465" }], "title": "4.4. Additions to named view transition pseudo-elements" }], "url": "#typedef-pt-class-selector" },
                "typedef-pt-name-and-class-selector": { "dfnID": "typedef-pt-name-and-class-selector", "dfnText": "<pt-name-and-class-selector>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-pt-name-and-class-selector" }, { "id": "ref-for-typedef-pt-name-and-class-selector\u2460" }, { "id": "ref-for-typedef-pt-name-and-class-selector\u2461" }, { "id": "ref-for-typedef-pt-name-and-class-selector\u2462" }, { "id": "ref-for-typedef-pt-name-and-class-selector\u2463" }], "title": "4.4. Additions to named view transition pseudo-elements" }], "url": "#typedef-pt-name-and-class-selector" },
                "update-the-opt-in-state-for-outbound-transitions": { "dfnID": "update-the-opt-in-state-for-outbound-transitions", "dfnText": "update the opt-in state for outbound transitions", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-update-the-opt-in-state-for-outbound-transitions" }], "title": "2.3.1. The @view-transition rule" }, { "refs": [{ "id": "ref-for-update-the-opt-in-state-for-outbound-transitions\u2460" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "#update-the-opt-in-state-for-outbound-transitions" },
                "valdef-view-transition-class-custom-ident": { "dfnID": "valdef-view-transition-class-custom-ident", "dfnText": "<custom-ident>+", "external": false, "refSections": [], "url": "#valdef-view-transition-class-custom-ident" },
                "valdef-view-transition-class-none": { "dfnID": "valdef-view-transition-class-none", "dfnText": "none", "external": false, "refSections": [], "url": "#valdef-view-transition-class-none" },
                "valdef-view-transition-navigation-auto": { "dfnID": "valdef-view-transition-navigation-auto", "dfnText": "auto", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-view-transition-navigation-auto" }], "title": "2.3.2. The navigation descriptor" }, { "refs": [{ "id": "ref-for-valdef-view-transition-navigation-auto\u2460" }], "title": "6.2. Resolving the @view-transition rule" }], "url": "#valdef-view-transition-navigation-auto" },
                "valdef-view-transition-navigation-none": { "dfnID": "valdef-view-transition-navigation-none", "dfnText": "none", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-view-transition-navigation-none" }], "title": "6.2. Resolving the @view-transition rule" }], "url": "#valdef-view-transition-navigation-none" },
                "view-transition-navigation": { "dfnID": "view-transition-navigation", "dfnText": "navigation", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-view-transition-navigation" }], "title": "2.3.1. The @view-transition rule" }, { "refs": [{ "id": "ref-for-view-transition-navigation\u2460" }], "title": "2.3.2. The navigation descriptor" }, { "refs": [{ "id": "ref-for-view-transition-navigation\u2461" }, { "id": "ref-for-view-transition-navigation\u2462" }], "title": "6.2. Resolving the @view-transition rule" }], "url": "#view-transition-navigation" },
                "view-transition-params": { "dfnID": "view-transition-params", "dfnText": "view transition params", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-view-transition-params" }], "title": "6.1.1. Additions to Document" }, { "refs": [{ "id": "ref-for-view-transition-params\u2460" }], "title": "6.1.3. Serializable view transition params" }, { "refs": [{ "id": "ref-for-view-transition-params\u2461" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }, { "refs": [{ "id": "ref-for-view-transition-params\u2462" }], "title": "6.3.5. Proceed with cross-document view transition after capturing the old state" }], "url": "#view-transition-params" },
                "view-transition-params-initial-snapshot-containing-block-size": { "dfnID": "view-transition-params-initial-snapshot-containing-block-size", "dfnText": "initial snapshot containing block size", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-view-transition-params-initial-snapshot-containing-block-size" }], "title": "6.3.5. Proceed with cross-document view transition after capturing the old state" }, { "refs": [{ "id": "ref-for-view-transition-params-initial-snapshot-containing-block-size\u2460" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "#view-transition-params-initial-snapshot-containing-block-size" },
                "view-transition-params-named-elements": { "dfnID": "view-transition-params-named-elements", "dfnText": "named elements", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-view-transition-params-named-elements" }], "title": "6.3.5. Proceed with cross-document view transition after capturing the old state" }, { "refs": [{ "id": "ref-for-view-transition-params-named-elements\u2460" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "#view-transition-params-named-elements" },
                "view-transition-types": { "dfnID": "view-transition-types", "dfnText": "types", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-view-transition-types" }], "title": "2.3.1. The @view-transition rule" }, { "refs": [{ "id": "ref-for-view-transition-types\u2460" }], "title": "3.1. Overview" }, { "refs": [{ "id": "ref-for-view-transition-types\u2461" }, { "id": "ref-for-view-transition-types\u2462" }], "title": "3.5. Activating the transition type for cross-document view transitions" }, { "refs": [{ "id": "ref-for-view-transition-types\u2463" }], "title": "6.2. Resolving the @view-transition rule" }, { "refs": [{ "id": "ref-for-view-transition-types\u2464" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }], "url": "#view-transition-types" },
                "viewtransition-active-types": { "dfnID": "viewtransition-active-types", "dfnText": "active types", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-viewtransition-active-types" }, { "id": "ref-for-viewtransition-active-types\u2460" }, { "id": "ref-for-viewtransition-active-types\u2461" }], "title": "3.1. Overview" }, { "refs": [{ "id": "ref-for-viewtransition-active-types\u2462" }], "title": "3.3.2. The :active-view-transition-type() pseudo-class" }, { "refs": [{ "id": "ref-for-viewtransition-active-types\u2463" }], "title": "3.4. Changing the types of an ongoing view transition" }, { "refs": [{ "id": "ref-for-viewtransition-active-types\u2464" }], "title": "3.5. Activating the transition type for cross-document view transitions" }, { "refs": [{ "id": "ref-for-viewtransition-active-types\u2465" }], "title": "5. Extending document.startViewTransition()" }, { "refs": [{ "id": "ref-for-viewtransition-active-types\u2466" }, { "id": "ref-for-viewtransition-active-types\u2467" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }, { "refs": [{ "id": "ref-for-viewtransition-active-types\u2468" }], "title": "6.4. Activating the view transition in the new Document" }], "url": "#viewtransition-active-types" },
                "viewtransition-outbound-post-capture-steps": { "dfnID": "viewtransition-outbound-post-capture-steps", "dfnText": "outbound post-capture steps", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-viewtransition-outbound-post-capture-steps" }], "title": "5. Extending document.startViewTransition()" }, { "refs": [{ "id": "ref-for-viewtransition-outbound-post-capture-steps\u2460" }], "title": "6.3.2. Setup the outbound transition when ready to swap pages" }, { "refs": [{ "id": "ref-for-viewtransition-outbound-post-capture-steps\u2461" }, { "id": "ref-for-viewtransition-outbound-post-capture-steps\u2462" }], "title": "6.3.4. Proceed with navigation if view transition is skipped" }, { "refs": [{ "id": "ref-for-viewtransition-outbound-post-capture-steps\u2463" }, { "id": "ref-for-viewtransition-outbound-post-capture-steps\u2464" }], "title": "6.3.5. Proceed with cross-document view transition after capturing the old state" }], "url": "#viewtransition-outbound-post-capture-steps" },
                "viewtransitiontypeset": { "dfnID": "viewtransitiontypeset", "dfnText": "ViewTransitionTypeSet", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-viewtransitiontypeset" }, { "id": "ref-for-viewtransitiontypeset\u2460" }, { "id": "ref-for-viewtransitiontypeset\u2461" }], "title": "3.4. Changing the types of an ongoing view transition" }, { "refs": [{ "id": "ref-for-viewtransitiontypeset\u2462" }], "title": "6.1.2. Additions to ViewTransition" }], "url": "#viewtransitiontypeset" },
            };

            document.addEventListener("DOMContentLoaded", () => {
                genAllDfnPanels();

                document.body.addEventListener("click", (e) => {
                    // If not handled already, just hide all dfn panels.
                    hideAllDfnPanels();
                });
            });

            window.addEventListener("resize", () => {
                // Pin any visible dfn panel
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => positionDfnPanel(el));
            });

            function genAllDfnPanels() {
                for (const panelData of Object.values(dfnPanelData)) {
                    const dfnID = panelData.dfnID;
                    const dfn = document.getElementById(dfnID);
                    if (!dfn) {
                        console.log(`Can't find dfn#${dfnID}.`, panelData);
                        continue;
                    }
                    dfn.panelData = panelData;
                    insertDfnPopupAction(dfn);
                }
            }

            function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
                const dfnPanel = mk.aside({
                    class: "dfn-panel on",
                    id: `infopanel-for-${dfnID}`,
                    "data-for": dfnID,
                    "aria-labelled-by": `infopaneltitle-for-${dfnID}`,
                },
                    mk.span({ id: `infopaneltitle-for-${dfnID}`, style: "display:none" },
                        `Info about the '${dfnText}' ${external ? "external" : ""} reference.`),
                    mk.a({ href: url, class: "dfn-link" }, url),
                    refSections.length == 0 ? [] :
                        mk.b({}, "Referenced in:"),
                    mk.ul({},
                        ...refSections.map(section =>
                            mk.li({},
                                ...section.refs.map((ref, refI) =>
                                    [
                                        mk.a({ href: `#${ref.id}` },
                                            (refI == 0) ? section.title : `(${refI + 1})`
                                        ),
                                        " ",
                                    ]
                                ),
                            ),
                        ),
                    ),
                    genLinkingSyntaxes(dfn),
                );

                dfnPanel.addEventListener('click', (event) => {
                    if (event.target.nodeName == 'A') {
                        scrollToTargetAndHighlight(event);
                        pinDfnPanel(dfnPanel);
                    }
                    event.stopPropagation();
                    refocusOnTarget(event);
                });
                dfnPanel.addEventListener('keydown', (event) => {
                    if (event.keyCode == 27) { // Escape key
                        hideDfnPanel({ dfnPanel });
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });

                dfnPanel.dfn = dfn;
                dfn.dfnPanel = dfnPanel;
                return dfnPanel;
            }



            function hideAllDfnPanels() {
                // Delete the currently-active dfn panel.
                queryAll(".dfn-panel").forEach(dfnPanel => hideDfnPanel({ dfnPanel }));
            }

            function showDfnPanel(dfn) {
                hideAllDfnPanels(); // Only display one at a time.

                dfn.setAttribute("aria-expanded", "true");

                const dfnPanel = genDfnPanel(dfn, dfn.panelData);

                // Give the dfn a unique tabindex, and then
                // give all the tabbable panel bits successive indexes.
                let tabIndex = 100;
                dfn.tabIndex = tabIndex++;
                const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
                for (const el of tabbable) {
                    el.tabIndex = tabIndex++;
                }

                append(document.body, dfnPanel);
                positionDfnPanel(dfnPanel);
            }

            function positionDfnPanel(dfnPanel) {
                const dfn = dfnPanel.dfn;
                const dfnPos = getBounds(dfn);
                dfnPanel.style.top = dfnPos.bottom + "px";
                dfnPanel.style.left = dfnPos.left + "px";

                const panelPos = dfnPanel.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
                    dfnPanel.style.left = newLeft + "px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.position = "fixed";
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel({ dfn, dfnPanel }) {
                if (!dfnPanel) dfnPanel = dfn.dfnPanel;
                if (!dfn) dfn = dfnPanel.dfn;
                dfn.dfnPanel = undefined;
                dfnPanel.dfn = undefined;
                dfn.setAttribute("aria-expanded", "false");
                dfn.tabIndex = undefined;
                dfnPanel.remove()
            }

            function toggleDfnPanel(dfn) {
                if (dfn.dfnPanel) {
                    hideDfnPanel(dfn);
                } else {
                    showDfnPanel(dfn);
                }
            }

            function insertDfnPopupAction(dfn) {
                dfn.setAttribute('role', 'button');
                dfn.setAttribute('aria-expanded', 'false')
                dfn.tabIndex = 0;
                dfn.classList.add('has-dfn-panel');
                dfn.addEventListener('click', (event) => {
                    toggleDfnPanel(dfn);
                    event.stopPropagation();
                });
                dfn.addEventListener('keypress', (event) => {
                    const kc = event.keyCode;
                    // 32->Space, 13->Enter
                    if (kc == 32 || kc == 13) {
                        toggleDfnPanel(dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });
            }

            function refocusOnTarget(event) {
                const target = event.target;
                setTimeout(() => {
                    // Refocus on the event.target element.
                    // This is needed after browser scrolls to the destination.
                    target.focus();
                });
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function scrollToTargetAndHighlight(event) {
                let hash = event.target.hash;
                if (hash) {
                    hash = decodeURIComponent(hash.substring(1));
                    const dest = document.getElementById(hash);
                    if (dest) {
                        dest.classList.add('highlighted');
                        setTimeout(() => dest.classList.remove('highlighted'), 1000);
                    }
                }
            }

            // Functions, divided by link type, that wrap an autolink's
            // contents with the appropriate outer syntax.
            // Alternately, a string naming another type they format
            // the same as.
            function needsFor(type) {
                switch (type) {
                    case "descriptor":
                    case "value":
                    case "element-attr":
                    case "attr-value":
                    case "element-state":
                    case "method":
                    case "constructor":
                    case "argument":
                    case "attribute":
                    case "const":
                    case "dict-member":
                    case "event":
                    case "enum-value":
                    case "stringifier":
                    case "serializer":
                    case "iterator":
                    case "maplike":
                    case "setlike":
                    case "state":
                    case "mode":
                    case "context":
                    case "facet": return true;

                    default: return false;
                }
            }
            function refusesFor(type) {
                switch (type) {
                    case "property":
                    case "element":
                    case "interface":
                    case "namespace":
                    case "callback":
                    case "dictionary":
                    case "enum":
                    case "exception":
                    case "typedef":
                    case "http-header":
                    case "permission": return true;

                    default: return false;
                }
            }
            function linkFormatterFromType(type) {
                switch (type) {
                    case 'scheme':
                    case 'permission':
                    case 'dfn': return (text) => `[=${text}=]`;

                    case 'abstract-op': return (text) => `[\$${text}\$]`;

                    case 'function':
                    case 'at-rule':
                    case 'selector':
                    case 'value': return (text) => `''${text}''`;

                    case 'http-header': return (text) => `[:${text}:]`;

                    case 'interface':
                    case 'constructor':
                    case 'method':
                    case 'argument':
                    case 'attribute':
                    case 'callback':
                    case 'dictionary':
                    case 'dict-member':
                    case 'enum':
                    case 'enum-value':
                    case 'exception':
                    case 'const':
                    case 'typedef':
                    case 'stringifier':
                    case 'serializer':
                    case 'iterator':
                    case 'maplike':
                    case 'setlike':
                    case 'extended-attribute':
                    case 'event':
                    case 'idl': return (text) => `{{${text}}}`;

                    case 'element-state':
                    case 'element-attr':
                    case 'attr-value':
                    case 'element': return (element) => `<{${element}}>`;

                    case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

                    case 'type': return (text) => `<<${text}>>`;

                    case 'descriptor':
                    case 'property': return (text) => `'${text}'`;

                    default: return;
                };
            };

            function genLinkingSyntaxes(dfn) {
                if (dfn.tagName != "DFN") return;

                const type = dfn.getAttribute('data-dfn-type');
                if (!type) {
                    console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
                    return [];
                }

                // Return a function that wraps link text based on the type
                const linkFormatter = linkFormatterFromType(type);
                if (!linkFormatter) {
                    console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
                    return [];
                }

                let ltAlts;
                if (dfn.hasAttribute('data-lt')) {
                    ltAlts = dfn.getAttribute('data-lt')
                        .split("|")
                        .map(x => x.trim());
                } else {
                    ltAlts = [dfn.textContent.trim()];
                }
                if (type == "type") {
                    // lt of "<foo>", but "foo" is the interior;
                    // <<foo/bar>> is how you write it with a for,
                    // not <foo/<bar>> or whatever.
                    for (var i = 0; i < ltAlts.length; i++) {
                        const lt = ltAlts[i];
                        const match = /<(.*)>/.exec(lt);
                        if (match) { ltAlts[i] = match[1]; }
                    }
                }

                let forAlts;
                if (dfn.hasAttribute('data-dfn-for')) {
                    forAlts = dfn.getAttribute('data-dfn-for')
                        .split(",")
                        .map(x => x.trim());
                } else {
                    forAlts = [''];
                }

                let linkingSyntaxes = [];
                if (!needsFor(type)) {
                    for (const lt of ltAlts) {
                        linkingSyntaxes.push(linkFormatter(lt));
                    }
                }
                if (!refusesFor(type)) {
                    for (const f of forAlts) {
                        linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
                    }
                }
                return [
                    mk.b({}, 'Possible linking syntaxes:'),
                    mk.ul({},
                        ...linkingSyntaxes.map(link => {
                            const copyLink = async () =>
                                await navigator.clipboard.writeText(link);
                            return mk.li({},
                                mk.div({ class: 'link-item' },
                                    mk.button({
                                        class: 'copy-icon', title: 'Copy',
                                        type: 'button',
                                        _onclick: copyLink,
                                        tabindex: 0,
                                    }, mk.span({ class: 'icon' })),
                                    mk.span({}, link)
                                )
                            );
                        })
                    )
                ];
            }
        }
    </script>
    <script>/* Boilerplate: script-ref-hints */
        "use strict";
        {
            let refsData = {
                "#active-view-transition-pseudo": { "export": true, "for_": [], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": ":active-view-transition", "type": "selector", "url": "#active-view-transition-pseudo" },
                "#active-view-transition-type-pseudo": { "export": true, "for_": [], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": ":active-view-transition-type()", "type": "selector", "url": "#active-view-transition-type-pseudo" },
                "#at-view-transition-rule": { "export": true, "for_": [], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "@view-transition", "type": "at-rule", "url": "#at-view-transition-rule" },
                "#captured-element-class-list": { "export": true, "for_": ["captured element"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "class list", "type": "dfn", "url": "#captured-element-class-list" },
                "#cssviewtransitionrule": { "export": true, "for_": [], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "CSSViewTransitionRule", "type": "interface", "url": "#cssviewtransitionrule" },
                "#descdef-view-transition-navigation": { "export": true, "for_": ["@view-transition"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "navigation", "type": "descriptor", "url": "#descdef-view-transition-navigation" },
                "#descdef-view-transition-types": { "export": true, "for_": ["@view-transition"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "types", "type": "descriptor", "url": "#descdef-view-transition-types" },
                "#dictdef-startviewtransitionoptions": { "export": true, "for_": [], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "StartViewTransitionOptions", "type": "dictionary", "url": "#dictdef-startviewtransitionoptions" },
                "#document-can-initiate-outbound-view-transition": { "export": true, "for_": ["document"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "can initiate outbound view transition", "type": "dfn", "url": "#document-can-initiate-outbound-view-transition" },
                "#document-inbound-view-transition-params": { "export": true, "for_": ["document"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "inbound view transition params", "type": "dfn", "url": "#document-inbound-view-transition-params" },
                "#dom-document-startviewtransition": { "export": true, "for_": ["Document"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "startViewTransition()", "type": "method", "url": "#dom-document-startviewtransition" },
                "#dom-startviewtransitionoptions-types": { "export": true, "for_": ["StartViewTransitionOptions"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "types", "type": "dict-member", "url": "#dom-startviewtransitionoptions-types" },
                "#dom-startviewtransitionoptions-update": { "export": true, "for_": ["StartViewTransitionOptions"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "update", "type": "dict-member", "url": "#dom-startviewtransitionoptions-update" },
                "#dom-viewtransition-types": { "export": true, "for_": ["ViewTransition"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "types", "type": "attribute", "url": "#dom-viewtransition-types" },
                "#enumdef-viewtransitionnavigation": { "export": true, "for_": [], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "ViewTransitionNavigation", "type": "enum", "url": "#enumdef-viewtransitionnavigation" },
                "#propdef-view-transition-class": { "export": true, "for_": [], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "view-transition-class", "type": "property", "url": "#propdef-view-transition-class" },
                "#resolve-view-transition-rule": { "export": true, "for_": [], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "resolve @view-transition rule", "type": "dfn", "url": "#resolve-view-transition-rule" },
                "#typedef-pt-class-selector": { "export": true, "for_": [], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "<pt-class-selector>", "type": "type", "url": "#typedef-pt-class-selector" },
                "#typedef-pt-name-and-class-selector": { "export": true, "for_": [], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "<pt-name-and-class-selector>", "type": "type", "url": "#typedef-pt-name-and-class-selector" },
                "#update-the-opt-in-state-for-outbound-transitions": { "export": true, "for_": [], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "update the opt-in state for outbound transitions", "type": "dfn", "url": "#update-the-opt-in-state-for-outbound-transitions" },
                "#valdef-view-transition-navigation-auto": { "export": true, "for_": ["@view-transition/navigation", "navigation"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "auto", "type": "value", "url": "#valdef-view-transition-navigation-auto" },
                "#valdef-view-transition-navigation-none": { "export": true, "for_": ["@view-transition/navigation", "navigation"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "none", "type": "value", "url": "#valdef-view-transition-navigation-none" },
                "#view-transition-navigation": { "export": true, "for_": ["@view-transition"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "navigation", "type": "dfn", "url": "#view-transition-navigation" },
                "#view-transition-params": { "export": true, "for_": [], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "view transition params", "type": "dfn", "url": "#view-transition-params" },
                "#view-transition-params-initial-snapshot-containing-block-size": { "export": true, "for_": ["view transition params"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "initial snapshot containing block size", "type": "dfn", "url": "#view-transition-params-initial-snapshot-containing-block-size" },
                "#view-transition-params-named-elements": { "export": true, "for_": ["view transition params"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "named elements", "type": "dfn", "url": "#view-transition-params-named-elements" },
                "#view-transition-types": { "export": true, "for_": ["@view-transition"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "types", "type": "dfn", "url": "#view-transition-types" },
                "#viewtransition-active-types": { "export": true, "for_": ["ViewTransition"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "active types", "type": "dfn", "url": "#viewtransition-active-types" },
                "#viewtransition-outbound-post-capture-steps": { "export": true, "for_": ["ViewTransition"], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "outbound post-capture steps", "type": "dfn", "url": "#viewtransition-outbound-post-capture-steps" },
                "#viewtransitiontypeset": { "export": true, "for_": [], "level": "2", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-2", "status": "local", "text": "ViewTransitionTypeSet", "type": "interface", "url": "#viewtransitiontypeset" },
                "https://dom.spec.whatwg.org/#concept-class": { "export": true, "for_": ["Element"], "level": "1", "normative": true, "shortname": "dom", "spec": "dom", "status": "current", "text": "class", "type": "dfn", "url": "https://dom.spec.whatwg.org/#concept-class" },
                "https://dom.spec.whatwg.org/#concept-document": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "dom", "spec": "dom", "status": "current", "text": "document", "type": "dfn", "url": "https://dom.spec.whatwg.org/#concept-document" },
                "https://dom.spec.whatwg.org/#concept-document-origin": { "export": true, "for_": ["Document"], "level": "1", "normative": true, "shortname": "dom", "spec": "dom", "status": "current", "text": "origin", "type": "dfn", "url": "https://dom.spec.whatwg.org/#concept-document-origin" },
                "https://dom.spec.whatwg.org/#concept-node-document": { "export": true, "for_": ["Node"], "level": "1", "normative": true, "shortname": "dom", "spec": "dom", "status": "current", "text": "node document", "type": "dfn", "url": "https://dom.spec.whatwg.org/#concept-node-document" },
                "https://dom.spec.whatwg.org/#document": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "dom", "spec": "dom", "status": "current", "text": "Document", "type": "interface", "url": "https://dom.spec.whatwg.org/#document" },
                "https://dom.spec.whatwg.org/#document-element": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "dom", "spec": "dom", "status": "current", "text": "document element", "type": "dfn", "url": "https://dom.spec.whatwg.org/#document-element" },
                "https://drafts.csswg.org/css2/#element": { "export": false, "for_": [], "level": "1", "normative": true, "shortname": "css", "spec": "css22", "status": "current", "text": "element", "type": "dfn", "url": "https://drafts.csswg.org/css2/#element" },
                "https://html.spec.whatwg.org/multipage/browsers.html#same-origin": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "same origin", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/browsers.html#same-origin" },
                "https://html.spec.whatwg.org/multipage/browsing-the-web.html#has-been-revealed": { "export": false, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "has been revealed", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/browsing-the-web.html#has-been-revealed" },
                "https://html.spec.whatwg.org/multipage/browsing-the-web.html#reactivate-a-document": { "export": true, "for_": ["Document"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "reactivate", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/browsing-the-web.html#reactivate-a-document" },
                "https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active": { "export": true, "for_": ["Document"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "fully active", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active" },
                "https://html.spec.whatwg.org/multipage/dom.html#render-blocking-mechanism": { "export": false, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "render-blocking mechanism", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/dom.html#render-blocking-mechanism" },
                "https://html.spec.whatwg.org/multipage/dom.html#was-created-via-cross-origin-redirects": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "was created via cross-origin redirects", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/dom.html#was-created-via-cross-origin-redirects" },
                "https://html.spec.whatwg.org/multipage/indices.html#event-pagereveal": { "export": true, "for_": ["Window"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "pagereveal", "type": "event", "url": "https://html.spec.whatwg.org/multipage/indices.html#event-pagereveal" },
                "https://html.spec.whatwg.org/multipage/indices.html#event-pageswap": { "export": true, "for_": ["Window"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "pageswap", "type": "event", "url": "https://html.spec.whatwg.org/multipage/indices.html#event-pageswap" },
                "https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "in parallel", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" },
                "https://html.spec.whatwg.org/multipage/interaction.html#visibility-state": { "export": true, "for_": ["Document"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "visibility state", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/interaction.html#visibility-state" },
                "https://html.spec.whatwg.org/multipage/links.html#link-type-expect": { "export": true, "for_": ["link/rel"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "expect", "type": "attr-value", "url": "https://html.spec.whatwg.org/multipage/links.html#link-type-expect" },
                "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-push": { "export": true, "for_": ["NavigationType"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "push", "type": "enum-value", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-push" },
                "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-reload": { "export": true, "for_": ["NavigationType"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "reload", "type": "enum-value", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-reload" },
                "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-replace": { "export": true, "for_": ["NavigationType"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "replace", "type": "enum-value", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-replace" },
                "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-traverse": { "export": true, "for_": ["NavigationType"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "traverse", "type": "enum-value", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-traverse" },
                "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pagerevealevent-viewtransition": { "export": true, "for_": ["PageRevealEvent"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "viewTransition", "type": "attribute", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pagerevealevent-viewtransition" },
                "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pageswapevent-activation": { "export": true, "for_": ["PageSwapEvent"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "activation", "type": "attribute", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pageswapevent-activation" },
                "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pageswapevent-viewtransition": { "export": true, "for_": ["PageSwapEvent"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "viewTransition", "type": "attribute", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pageswapevent-viewtransition" },
                "https://html.spec.whatwg.org/multipage/nav-history-apis.html#navigationtype": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "NavigationType", "type": "enum", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#navigationtype" },
                "https://html.spec.whatwg.org/multipage/nav-history-apis.html#pageswapevent": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "PageSwapEvent", "type": "interface", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#pageswapevent" },
                "https://html.spec.whatwg.org/multipage/scripting.html#dom-script-blocking": { "export": true, "for_": ["HTMLScriptElement"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "blocking", "type": "attribute", "url": "https://html.spec.whatwg.org/multipage/scripting.html#dom-script-blocking" },
                "https://html.spec.whatwg.org/multipage/semantics.html#dom-style-blocking": { "export": true, "for_": ["HTMLStyleElement"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "blocking", "type": "attribute", "url": "https://html.spec.whatwg.org/multipage/semantics.html#dom-style-blocking" },
                "https://html.spec.whatwg.org/multipage/semantics.html#htmllinkelement": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "HTMLLinkElement", "type": "interface", "url": "https://html.spec.whatwg.org/multipage/semantics.html#htmllinkelement" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "relevant global object", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "relevant realm", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability": { "export": true, "for_": ["environment settings object"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "cross-origin isolated capability", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#concept-task": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "task", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "dom manipulation task source", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "queue a global task", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" },
                "https://html.spec.whatwg.org/multipage/webappapis.html#rendering-opportunity": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "rendering opportunity", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#rendering-opportunity" },
                "https://html.spec.whatwg.org/multipage/webstorage.html#dom-sessionstorage": { "export": true, "for_": ["WindowSessionStorage"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "sessionStorage", "type": "attribute", "url": "https://html.spec.whatwg.org/multipage/webstorage.html#dom-sessionstorage" },
                "https://infra.spec.whatwg.org/#assert": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "assert", "type": "dfn", "url": "https://infra.spec.whatwg.org/#assert" },
                "https://infra.spec.whatwg.org/#implementation-defined": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "implementation-defined", "type": "dfn", "url": "https://infra.spec.whatwg.org/#implementation-defined" },
                "https://infra.spec.whatwg.org/#list": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "list", "type": "dfn", "url": "https://infra.spec.whatwg.org/#list" },
                "https://infra.spec.whatwg.org/#list-clone": { "export": true, "for_": ["list", "stack", "queue", "set"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "clone", "type": "dfn", "url": "https://infra.spec.whatwg.org/#list-clone" },
                "https://infra.spec.whatwg.org/#list-contain": { "export": true, "for_": ["list", "stack", "queue", "set"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "contain", "type": "dfn", "url": "https://infra.spec.whatwg.org/#list-contain" },
                "https://infra.spec.whatwg.org/#map-clone": { "export": true, "for_": ["map"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "clone", "type": "dfn", "url": "https://infra.spec.whatwg.org/#map-clone" },
                "https://infra.spec.whatwg.org/#ordered-map": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "map", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ordered-map" },
                "https://infra.spec.whatwg.org/#ordered-set": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "set", "type": "dfn", "url": "https://infra.spec.whatwg.org/#ordered-set" },
                "https://infra.spec.whatwg.org/#struct": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "struct", "type": "dfn", "url": "https://infra.spec.whatwg.org/#struct" },
                "https://infra.spec.whatwg.org/#struct-item": { "export": true, "for_": ["struct", "tuple"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "item", "type": "dfn", "url": "https://infra.spec.whatwg.org/#struct-item" },
                "https://infra.spec.whatwg.org/#tuple": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "tuple", "type": "dfn", "url": "https://infra.spec.whatwg.org/#tuple" },
                "https://webidl.spec.whatwg.org/#Exposed": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "Exposed", "type": "extended-attribute", "url": "https://webidl.spec.whatwg.org/#Exposed" },
                "https://webidl.spec.whatwg.org/#SameObject": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "SameObject", "type": "extended-attribute", "url": "https://webidl.spec.whatwg.org/#SameObject" },
                "https://webidl.spec.whatwg.org/#aborterror": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "AbortError", "type": "exception", "url": "https://webidl.spec.whatwg.org/#aborterror" },
                "https://webidl.spec.whatwg.org/#getter-steps": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "getter steps", "type": "dfn", "url": "https://webidl.spec.whatwg.org/#getter-steps" },
                "https://webidl.spec.whatwg.org/#idl-DOMException": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "DOMException", "type": "interface", "url": "https://webidl.spec.whatwg.org/#idl-DOMException" },
                "https://webidl.spec.whatwg.org/#idl-DOMString": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "DOMString", "type": "interface", "url": "https://webidl.spec.whatwg.org/#idl-DOMString" },
                "https://webidl.spec.whatwg.org/#idl-frozen-array": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "FrozenArray", "type": "interface", "url": "https://webidl.spec.whatwg.org/#idl-frozen-array" },
                "https://webidl.spec.whatwg.org/#idl-sequence": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "sequence", "type": "dfn", "url": "https://webidl.spec.whatwg.org/#idl-sequence" },
                "https://webidl.spec.whatwg.org/#idl-unsigned-short": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "unsigned short", "type": "interface", "url": "https://webidl.spec.whatwg.org/#idl-unsigned-short" },
                "https://webidl.spec.whatwg.org/#invalidstateerror": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "InvalidStateError", "type": "exception", "url": "https://webidl.spec.whatwg.org/#invalidstateerror" },
                "https://webidl.spec.whatwg.org/#method-steps": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "method steps", "type": "dfn", "url": "https://webidl.spec.whatwg.org/#method-steps" },
                "https://webidl.spec.whatwg.org/#resolve": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "resolve", "type": "dfn", "url": "https://webidl.spec.whatwg.org/#resolve" },
                "https://webidl.spec.whatwg.org/#this": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "this", "type": "dfn", "url": "https://webidl.spec.whatwg.org/#this" },
                "https://webidl.spec.whatwg.org/#timeouterror": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "webidl", "spec": "webidl", "status": "current", "text": "TimeoutError", "type": "exception", "url": "https://webidl.spec.whatwg.org/#timeouterror" },
                "https://www.w3.org/TR/css-cascade-5/#computed-value": { "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-cascade", "spec": "css-cascade-5", "status": "snapshot", "text": "computed value", "type": "dfn", "url": "https://www.w3.org/TR/css-cascade-5/#computed-value" },
                "https://www.w3.org/TR/css-conditional-3/#at-ruledef-media": { "export": true, "for_": [], "level": "3", "normative": true, "shortname": "css-conditional", "spec": "css-conditional-3", "status": "snapshot", "text": "@media", "type": "at-rule", "url": "https://www.w3.org/TR/css-conditional-3/#at-ruledef-media" },
                "https://www.w3.org/TR/css-conditional-3/#at-ruledef-supports": { "export": true, "for_": [], "level": "3", "normative": true, "shortname": "css-conditional", "spec": "css-conditional-3", "status": "snapshot", "text": "@supports", "type": "at-rule", "url": "https://www.w3.org/TR/css-conditional-3/#at-ruledef-supports" },
                "https://www.w3.org/TR/css-conditional-3/#conditional-group-rule": { "export": true, "for_": [], "level": "3", "normative": true, "shortname": "css-conditional", "spec": "css-conditional-3", "status": "snapshot", "text": "conditional group rule", "type": "dfn", "url": "https://www.w3.org/TR/css-conditional-3/#conditional-group-rule" },
                "https://www.w3.org/TR/css-syntax-3/#typedef-declaration-list": { "export": true, "for_": [], "level": "3", "normative": true, "shortname": "css-syntax", "spec": "css-syntax-3", "status": "snapshot", "text": "<declaration-list>", "type": "type", "url": "https://www.w3.org/TR/css-syntax-3/#typedef-declaration-list" },
                "https://www.w3.org/TR/css-values-4/#comb-one": { "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "|", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#comb-one" },
                "https://www.w3.org/TR/css-values-4/#identifier-value": { "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "<custom-ident>", "type": "type", "url": "https://www.w3.org/TR/css-values-4/#identifier-value" },
                "https://www.w3.org/TR/css-values-4/#mult-comma": { "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "#", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
                "https://www.w3.org/TR/css-values-4/#mult-one-plus": { "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "+", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-one-plus" },
                "https://www.w3.org/TR/css-values-4/#mult-opt": { "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "?", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-opt" },
                "https://www.w3.org/TR/css-view-transitions-1/#activate-view-transition": { "export": false, "for_": [], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "activate view transition", "type": "dfn", "url": "https://www.w3.org/TR/css-view-transitions-1/#activate-view-transition" },
                "https://www.w3.org/TR/css-view-transitions-1/#callbackdef-updatecallback": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "UpdateCallback", "type": "callback", "url": "https://www.w3.org/TR/css-view-transitions-1/#callbackdef-updatecallback" },
                "https://www.w3.org/TR/css-view-transitions-1/#capture-the-new-state": { "export": false, "for_": [], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "capture the new state", "type": "dfn", "url": "https://www.w3.org/TR/css-view-transitions-1/#capture-the-new-state" },
                "https://www.w3.org/TR/css-view-transitions-1/#capture-the-old-state": { "export": false, "for_": [], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "capture the old state", "type": "dfn", "url": "https://www.w3.org/TR/css-view-transitions-1/#capture-the-old-state" },
                "https://www.w3.org/TR/css-view-transitions-1/#captured-element": { "export": false, "for_": [], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "captured element", "type": "dfn", "url": "https://www.w3.org/TR/css-view-transitions-1/#captured-element" },
                "https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition": { "export": false, "for_": ["document"], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "active view transition", "type": "dfn", "url": "https://www.w3.org/TR/css-view-transitions-1/#document-active-view-transition" },
                "https://www.w3.org/TR/css-view-transitions-1/#document-rendering-suppression-for-view-transitions": { "export": false, "for_": ["document"], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "rendering suppression for view transitions", "type": "dfn", "url": "https://www.w3.org/TR/css-view-transitions-1/#document-rendering-suppression-for-view-transitions" },
                "https://www.w3.org/TR/css-view-transitions-1/#dom-document-startviewtransition": { "export": true, "for_": ["Document"], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "startViewTransition(updateCallback)", "type": "method", "url": "https://www.w3.org/TR/css-view-transitions-1/#dom-document-startviewtransition" },
                "https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-finished": { "export": true, "for_": ["ViewTransition"], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "finished", "type": "attribute", "url": "https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-finished" },
                "https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-ready": { "export": true, "for_": ["ViewTransition"], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "ready", "type": "attribute", "url": "https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-ready" },
                "https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-skiptransition": { "export": true, "for_": ["ViewTransition"], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "skipTransition()", "type": "method", "url": "https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-skiptransition" },
                "https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-updatecallbackdone": { "export": true, "for_": ["ViewTransition"], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "updateCallbackDone", "type": "attribute", "url": "https://www.w3.org/TR/css-view-transitions-1/#dom-viewtransition-updatecallbackdone" },
                "https://www.w3.org/TR/css-view-transitions-1/#named-view-transition-pseudo-elements": { "export": false, "for_": [], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "named view transition pseudo-elements", "type": "dfn", "url": "https://www.w3.org/TR/css-view-transitions-1/#named-view-transition-pseudo-elements" },
                "https://www.w3.org/TR/css-view-transitions-1/#perform-pending-transition-operations": { "export": false, "for_": [], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "perform pending transition operations", "type": "dfn", "url": "https://www.w3.org/TR/css-view-transitions-1/#perform-pending-transition-operations" },
                "https://www.w3.org/TR/css-view-transitions-1/#propdef-view-transition-name": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "view-transition-name", "type": "property", "url": "https://www.w3.org/TR/css-view-transitions-1/#propdef-view-transition-name" },
                "https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-group": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "::view-transition-group()", "type": "selector", "url": "https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-group" },
                "https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-image-pair": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "::view-transition-image-pair()", "type": "selector", "url": "https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-image-pair" },
                "https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-new": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "::view-transition-new()", "type": "selector", "url": "https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-new" },
                "https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-old": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "::view-transition-old()", "type": "selector", "url": "https://www.w3.org/TR/css-view-transitions-1/#selectordef-view-transition-old" },
                "https://www.w3.org/TR/css-view-transitions-1/#skip-the-view-transition": { "export": false, "for_": [], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "skip the view transition", "type": "dfn", "url": "https://www.w3.org/TR/css-view-transitions-1/#skip-the-view-transition" },
                "https://www.w3.org/TR/css-view-transitions-1/#typedef-pt-name-selector": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "<pt-name-selector>", "type": "type", "url": "https://www.w3.org/TR/css-view-transitions-1/#typedef-pt-name-selector" },
                "https://www.w3.org/TR/css-view-transitions-1/#viewtransition": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "ViewTransition", "type": "interface", "url": "https://www.w3.org/TR/css-view-transitions-1/#viewtransition" },
                "https://www.w3.org/TR/css-view-transitions-1/#viewtransition-initial-snapshot-containing-block-size": { "export": false, "for_": ["ViewTransition"], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "initial snapshot containing block size", "type": "dfn", "url": "https://www.w3.org/TR/css-view-transitions-1/#viewtransition-initial-snapshot-containing-block-size" },
                "https://www.w3.org/TR/css-view-transitions-1/#viewtransition-named-elements": { "export": false, "for_": ["ViewTransition"], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "named elements", "type": "dfn", "url": "https://www.w3.org/TR/css-view-transitions-1/#viewtransition-named-elements" },
                "https://www.w3.org/TR/css-view-transitions-1/#viewtransition-phase": { "export": false, "for_": ["ViewTransition"], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "phase", "type": "dfn", "url": "https://www.w3.org/TR/css-view-transitions-1/#viewtransition-phase" },
                "https://www.w3.org/TR/css-view-transitions-1/#viewtransition-update-callback": { "export": false, "for_": ["ViewTransition"], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "update callback", "type": "dfn", "url": "https://www.w3.org/TR/css-view-transitions-1/#viewtransition-update-callback" },
                "https://www.w3.org/TR/css-view-transitions-1/#viewtransition-update-callback-done-promise": { "export": false, "for_": ["ViewTransition"], "level": "1", "normative": true, "shortname": "css-view-transitions", "spec": "css-view-transitions-1", "status": "snapshot", "text": "update callback done promise", "type": "dfn", "url": "https://www.w3.org/TR/css-view-transitions-1/#viewtransition-update-callback-done-promise" },
                "https://www.w3.org/TR/cssom-1/#cssomstring": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "cssom", "spec": "cssom-1", "status": "snapshot", "text": "CSSOMString", "type": "interface", "url": "https://www.w3.org/TR/cssom-1/#cssomstring" },
                "https://www.w3.org/TR/cssom-1/#cssrule": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "cssom", "spec": "cssom-1", "status": "snapshot", "text": "CSSRule", "type": "interface", "url": "https://www.w3.org/TR/cssom-1/#cssrule" },
                "https://www.w3.org/TR/selectors-3/#x": { "export": true, "for_": [], "level": "3", "normative": true, "shortname": "selectors", "spec": "selectors-3", "status": "snapshot", "text": "*", "type": "selector", "url": "https://www.w3.org/TR/selectors-3/#x" },
                "https://www.w3.org/TR/selectors-4/#class-selector": { "export": true, "for_": [], "level": "4", "normative": true, "shortname": "selectors", "spec": "selectors-4", "status": "snapshot", "text": "class selector", "type": "dfn", "url": "https://www.w3.org/TR/selectors-4/#class-selector" },
                "https://www.w3.org/TR/selectors-4/#selector": { "export": true, "for_": [], "level": "4", "normative": true, "shortname": "selectors", "spec": "selectors-4", "status": "snapshot", "text": "selector", "type": "dfn", "url": "https://www.w3.org/TR/selectors-4/#selector" },
                "https://www.w3.org/TR/selectors-4/#specificity": { "export": true, "for_": [], "level": "4", "normative": true, "shortname": "selectors", "spec": "selectors-4", "status": "snapshot", "text": "specificity", "type": "dfn", "url": "https://www.w3.org/TR/selectors-4/#specificity" },
                "https://www.w3.org/TR/selectors-4/#type-selector": { "export": true, "for_": [], "level": "4", "normative": true, "shortname": "selectors", "spec": "selectors-4", "status": "snapshot", "text": "type selector", "type": "dfn", "url": "https://www.w3.org/TR/selectors-4/#type-selector" },
            };

            function mkRefHint(link, ref) {
                const linkText = link.textContent;
                let dfnTextElements = '';
                if (ref.text != linkText) {
                    dfnTextElements =
                        mk.li({},
                            mk.b({}, "Term: "),
                            mk.span({}, ref.text)
                        );
                }
                const forList = ref.for_;
                let forListElements;
                if (forList.length == 0) {
                    forListElements = [];
                } else if (forList.length == 1) {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.span({}, forList[0]),
                    );
                } else {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.ul({},
                            ...forList.map(forItem =>
                                mk.li({},
                                    mk.span({}, forItem)
                                ),
                            ),
                        ),
                    );
                }
                const url = ref.url;
                const safeUrl = encodeURIComponent(url);
                const hintPanel = mk.aside({
                    class: "ref-hint",
                    id: `ref-hint-for-${safeUrl}`,
                    "data-for": url,
                    "aria-labelled-by": `ref-hint-for-${safeUrl}`,
                },
                    mk.ul({},
                        dfnTextElements,
                        mk.li({},
                            mk.b({}, "URL: "),
                            mk.a({ href: url, class: "ref" }, url),
                        ),
                        mk.li({},
                            mk.b({}, "Type: "),
                            mk.span({}, `${ref.type}`),
                        ),
                        mk.li({},
                            mk.b({}, "Spec: "),
                            mk.span({}, `${ref.spec ? ref.spec : ''}`),
                        ),
                        forListElements
                    ),
                );
                hintPanel.forLink = link;
                setupRefHintEventListeners(link, hintPanel);
                return hintPanel;
            }

            function hideAllRefHints() {
                queryAll(".ref-hint").forEach(el => hideRefHint(el));
            }

            function hideRefHint(refHint) {
                const link = refHint.forLink;
                link.setAttribute("aria-expanded", "false");
                if (refHint.teardownEventListeners) {
                    refHint.teardownEventListeners();
                }
                refHint.remove();
            }

            function showRefHint(link) {
                if (link.classList.contains("dfn-link")) return;
                const url = link.getAttribute("href");
                const ref = refsData[url];
                if (!ref) return;

                hideAllRefHints(); // Only display one at this time.

                const refHint = mkRefHint(link, ref);
                append(document.body, refHint);
                link.setAttribute("aria-expanded", "true");
                positionRefHint(refHint);
            }

            function setupRefHintEventListeners(link, refHint) {
                if (refHint.teardownEventListeners) return;
                // Add event handlers to hide the refHint after the user moves away
                // from both the link and refHint, if not hovering either within one second.
                let timeout = null;
                const startHidingRefHint = (event) => {
                    if (timeout) {
                        clearTimeout(timeout);
                    }
                    timeout = setTimeout(() => {
                        hideRefHint(refHint);
                    }, 1000);
                }
                const resetHidingRefHint = (event) => {
                    if (timeout) clearTimeout(timeout);
                    timeout = null;
                };
                link.addEventListener("mouseleave", startHidingRefHint);
                link.addEventListener("mouseenter", resetHidingRefHint);
                link.addEventListener("blur", startHidingRefHint);
                link.addEventListener("focus", resetHidingRefHint);
                refHint.addEventListener("mouseleave", startHidingRefHint);
                refHint.addEventListener("mouseenter", resetHidingRefHint);
                refHint.addEventListener("blur", startHidingRefHint);
                refHint.addEventListener("focus", resetHidingRefHint);

                refHint.teardownEventListeners = () => {
                    // remove event listeners
                    resetHidingRefHint();
                    link.removeEventListener("mouseleave", startHidingRefHint);
                    link.removeEventListener("mouseenter", resetHidingRefHint);
                    link.removeEventListener("blur", startHidingRefHint);
                    link.removeEventListener("focus", resetHidingRefHint);
                    refHint.removeEventListener("mouseleave", startHidingRefHint);
                    refHint.removeEventListener("mouseenter", resetHidingRefHint);
                    refHint.removeEventListener("blur", startHidingRefHint);
                    refHint.removeEventListener("focus", resetHidingRefHint);
                };
            }

            function positionRefHint(refHint) {
                const link = refHint.forLink;
                const linkPos = getBounds(link);
                refHint.style.top = linkPos.bottom + "px";
                refHint.style.left = linkPos.left + "px";

                const panelPos = refHint.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
                    refHint.style.left = newLeft + "px";
                }
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function showRefHintListener(e) {
                // If the target isn't in a link (or is a link),
                // just ignore it.
                let link = e.target.closest("a");
                if (!link) return;

                // If the target is in a ref-hint panel
                // (aka a link in the already-open one),
                // also just ignore it.
                if (link.closest(".ref-hint")) return;

                // Otherwise, show the panel for the link.
                showRefHint(link);
            }

            function hideAllHintsListener(e) {
                // If the click is inside a ref-hint panel, ignore it.
                if (e.target.closest(".ref-hint")) return;
                // Otherwise, close all the current panels.
                hideAllRefHints();
            }

            document.addEventListener("DOMContentLoaded", () => {
                document.body.addEventListener("mousedown", showRefHintListener);
                document.body.addEventListener("focus", showRefHintListener);

                document.body.addEventListener("click", hideAllHintsListener);
            });

            window.addEventListener("resize", () => {
                // Hide any open ref hint.
                hideAllRefHints();
            });
        }
    </script>
    <script>/* Boilerplate: script-var-click-highlighting */
        "use strict";
        {
            /*
            Color-choosing design:
            
            * Colors are ordered by goodness.
            * On clicking a var, give it the earliest color
                with the lowest usage in the algorithm.
            * On re-clicking, re-use the var's most recent color
                if that's not currently being used elsewhere.
            */

            const COLOR_COUNT = 7;

            document.addEventListener("click", e => {
                if (e.target.nodeName == "VAR") {
                    highlightSameAlgoVars(e.target);
                }
            });

            function highlightSameAlgoVars(v) {
                // Find the algorithm container.
                let algoContainer = findAlgoContainer(v);

                // Not highlighting document-global vars,
                // too likely to be unrelated.
                if (algoContainer == null) return;

                const varName = nameFromVar(v);
                if (!v.hasAttribute("data-var-color")) {
                    const newColor = chooseHighlightColor(algoContainer, v);
                    for (const el of algoContainer.querySelectorAll("var")) {
                        if (nameFromVar(el) == varName) {
                            el.setAttribute("data-var-color", newColor);
                            el.setAttribute("data-var-last-color", newColor);
                        }
                    }
                } else {
                    for (const el of algoContainer.querySelectorAll("var")) {
                        if (nameFromVar(el) == varName) {
                            el.removeAttribute("data-var-color");
                        }
                    }
                }
            }
            function findAlgoContainer(el) {
                while (el != document.body) {
                    if (el.hasAttribute("data-algorithm")) return el;
                    el = el.parentNode;
                }
                return null;
            }
            function nameFromVar(el) {
                return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
            }
            function colorCountsFromContainer(container) {
                const namesFromColor = Array.from({ length: COLOR_COUNT }, x => new Set());
                for (let v of container.querySelectorAll("var[data-var-color]")) {
                    let color = +v.getAttribute("data-var-color");
                    namesFromColor[color].add(nameFromVar(v));
                }

                return namesFromColor.map(x => x.size);
            }
            function leastUsedColor(colors) {
                // Find the earliest color with the lowest count.
                let minCount = Infinity;
                let minColor = null;
                for (var i = 0; i < colors.length; i++) {
                    if (colors[i] < minCount) {
                        minColor = i;
                        minCount = colors[i];
                    }
                }
                return minColor;
            }
            function chooseHighlightColor(container, v) {
                const colorCounts = colorCountsFromContainer(container);
                if (v.hasAttribute("data-var-last-color")) {
                    let color = +v.getAttribute("data-var-last-color");
                    if (colorCounts[color] == 0) return color;
                }
                return leastUsedColor(colorCounts);
            }
        }
    </script>