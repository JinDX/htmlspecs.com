<!doctype html>
<html lang="zh-hans">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>选择器 第 5 级</title>
    <meta content="FPWD" name="w3c-status">
    <!-- <meta content="Bikeshed version b25686b9f, updated Fri Mar 14 14:15:20 2025 -0700" name="generator"> -->
    <link href="https://www.w3.org/TR/selectors-5/" rel="canonical">
    <!-- <meta content="aeb01368e528fad2cd6f708300ab31cb7eacf434" name="revision"> -->
    <meta content="dark light" name="color-scheme">
    <style>
        /* Boilerplate: style-autolinks */
        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: var(--a-normal-text);
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --selflink-text: black;
                --selflink-bg: silver;
                --selflink-hover-text: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-colors */
        /* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
        :root {
            color-scheme: light dark;

            --text: black;
            --bg: white;

            --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

            --logo-bg: #1a5e9a;
            --logo-active-bg: #c00;
            --logo-text: white;

            --tocnav-normal-text: #707070;
            --tocnav-normal-bg: var(--bg);
            --tocnav-hover-text: var(--tocnav-normal-text);
            --tocnav-hover-bg: #f8f8f8;
            --tocnav-active-text: #c00;
            --tocnav-active-bg: var(--tocnav-normal-bg);

            --tocsidebar-text: var(--text);
            --tocsidebar-bg: #f7f8f9;
            --tocsidebar-shadow: rgba(0, 0, 0, .1);
            --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

            --toclink-text: var(--text);
            --toclink-underline: #3980b5;
            --toclink-visited-text: var(--toclink-text);
            --toclink-visited-underline: #054572;

            --heading-text: #005a9c;

            --hr-text: var(--text);

            --algo-border: #def;

            --del-text: red;
            --del-bg: transparent;
            --ins-text: #080;
            --ins-bg: transparent;

            --a-normal-text: #034575;
            --a-normal-underline: #bbb;
            --a-visited-text: var(--a-normal-text);
            --a-visited-underline: #707070;
            --a-hover-bg: rgba(75%, 75%, 75%, .25);
            --a-active-text: #c00;
            --a-active-underline: #c00;

            --blockquote-border: silver;
            --blockquote-bg: transparent;
            --blockquote-text: currentcolor;

            --issue-border: #e05252;
            --issue-bg: #fbe9e9;
            --issue-text: var(--text);
            --issueheading-text: #831616;

            --example-border: #e0cb52;
            --example-bg: #fcfaee;
            --example-text: var(--text);
            --exampleheading-text: #574b0f;

            --note-border: #52e052;
            --note-bg: #e9fbe9;
            --note-text: var(--text);
            --noteheading-text: hsl(120, 70%, 30%);
            --notesummary-underline: silver;

            --assertion-border: #aaa;
            --assertion-bg: #eee;
            --assertion-text: black;

            --advisement-border: orange;
            --advisement-bg: #fec;
            --advisement-text: var(--text);
            --advisementheading-text: #b35f00;

            --warning-border: red;
            --warning-bg: hsla(40, 100%, 50%, 0.95);
            --warning-text: var(--text);

            --amendment-border: #330099;
            --amendment-bg: #F5F0FF;
            --amendment-text: var(--text);
            --amendmentheading-text: #220066;

            --def-border: #8ccbf2;
            --def-bg: #def;
            --def-text: var(--text);
            --defrow-border: #bbd7e9;

            --datacell-border: silver;

            --indexinfo-text: #707070;

            --indextable-hover-text: black;
            --indextable-hover-bg: #f7f8f9;

            --outdatedspec-bg: rgba(0, 0, 0, .5);
            --outdatedspec-text: black;
            --outdated-bg: maroon;
            --outdated-text: white;
            --outdated-shadow: red;

            --editedrec-bg: darkorange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --text: #ddd;
                --bg: black;

                --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

                --logo-bg: #1a5e9a;
                --logo-active-bg: #c00;
                --logo-text: white;

                --tocnav-normal-text: #999;
                --tocnav-normal-bg: var(--bg);
                --tocnav-hover-text: var(--tocnav-normal-text);
                --tocnav-hover-bg: #080808;
                --tocnav-active-text: #f44;
                --tocnav-active-bg: var(--tocnav-normal-bg);

                --tocsidebar-text: var(--text);
                --tocsidebar-bg: #080808;
                --tocsidebar-shadow: rgba(255, 255, 255, .1);
                --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

                --toclink-text: var(--text);
                --toclink-underline: #6af;
                --toclink-visited-text: var(--toclink-text);
                --toclink-visited-underline: #054572;

                --heading-text: #8af;

                --hr-text: var(--text);

                --algo-border: #456;

                --del-text: #f44;
                --del-bg: transparent;
                --ins-text: #4a4;
                --ins-bg: transparent;

                --a-normal-text: #6af;
                --a-normal-underline: #555;
                --a-visited-text: var(--a-normal-text);
                --a-visited-underline: var(--a-normal-underline);
                --a-hover-bg: rgba(25%, 25%, 25%, .2);
                --a-active-text: #f44;
                --a-active-underline: var(--a-active-text);

                --borderedblock-bg: rgba(255, 255, 255, .05);

                --blockquote-border: silver;
                --blockquote-bg: var(--borderedblock-bg);
                --blockquote-text: currentcolor;

                --issue-border: #e05252;
                --issue-bg: var(--borderedblock-bg);
                --issue-text: var(--text);
                --issueheading-text: hsl(0deg, 70%, 70%);

                --example-border: hsl(50deg, 90%, 60%);
                --example-bg: var(--borderedblock-bg);
                --example-text: var(--text);
                --exampleheading-text: hsl(50deg, 70%, 70%);

                --note-border: hsl(120deg, 100%, 35%);
                --note-bg: var(--borderedblock-bg);
                --note-text: var(--text);
                --noteheading-text: hsl(120, 70%, 70%);
                --notesummary-underline: silver;

                --assertion-border: #444;
                --assertion-bg: var(--borderedblock-bg);
                --assertion-text: var(--text);

                --advisement-border: orange;
                --advisement-bg: #222218;
                --advisement-text: var(--text);
                --advisementheading-text: #f84;

                --warning-border: red;
                --warning-bg: hsla(40, 100%, 20%, 0.95);
                --warning-text: var(--text);

                --amendment-border: #330099;
                --amendment-bg: #080010;
                --amendment-text: var(--text);
                --amendmentheading-text: #cc00ff;

                --def-border: #8ccbf2;
                --def-bg: #080818;
                --def-text: var(--text);
                --defrow-border: #136;

                --datacell-border: silver;

                --indexinfo-text: #aaa;

                --indextable-hover-text: var(--text);
                --indextable-hover-bg: #181818;

                --outdatedspec-bg: rgba(255, 255, 255, .5);
                --outdatedspec-text: black;
                --outdated-bg: maroon;
                --outdated-text: white;
                --outdated-shadow: red;

                --editedrec-bg: darkorange;
            }

            /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
            img {
                background: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-counters */
        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* Boilerplate: style-dfn-panel */
        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
            --dfnpanel-target-bg: #ffc;
            --dfnpanel-target-outline: orange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --dfnpanel-bg: #222;
                --dfnpanel-text: var(--text);
                --dfnpanel-target-bg: #333;
                --dfnpanel-target-outline: silver;
            }
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel a:focus {
            outline: 5px auto Highlight;
            outline: 5px auto -webkit-focus-ring-color;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0 0 0 1em;
            list-style: none;
        }

        .dfn-panel li a {
            max-width: calc(300px - 1.5em - 1em);
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: 8px;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
            transition: left 1s ease-out, bottom 1s ease-out;
        }

        .dfn-panel .link-item:hover {
            text-decoration: underline;
        }

        .dfn-panel .link-item .copy-icon {
            opacity: 0;
        }

        .dfn-panel .link-item:hover .copy-icon,
        .dfn-panel .link-item .copy-icon:focus {
            opacity: 1;
        }

        .dfn-panel .copy-icon {
            display: inline-block;
            margin-right: 0.5em;
            width: 0.85em;
            height: 1em;
            border-radius: 3px;
            background-color: #ccc;
            cursor: pointer;
        }

        .dfn-panel .copy-icon .icon {
            width: 100%;
            height: 100%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .dfn-panel .copy-icon .icon::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1px solid black;
            background-color: #ccc;
            opacity: 0.25;
            transform: translate(3px, -3px);
        }

        .dfn-panel .copy-icon:active .icon::before {
            opacity: 1;
        }

        .dfn-paneled[role="button"] {
            cursor: help;
        }

        .highlighted {
            animation: target-fade 3s;
        }

        @keyframes target-fade {
            from {
                background-color: var(--dfnpanel-target-bg);
                outline: 5px solid var(--dfnpanel-target-outline);
            }

            to {
                color: var(--a-normal-text);
                background-color: transparent;
                outline: transparent;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-issues */
        a[href].issue-return {
            float: right;
            float: inline-end;
            color: var(--issueheading-text);
            font-weight: bold;
            text-decoration: none;
        }
    </style>
    <style>
        /* Boilerplate: style-md-lists */
        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* Boilerplate: style-ref-hints */
        :root {
            --ref-hint-bg: #ddd;
            --ref-hint-text: var(--text);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --ref-hint-bg: #222;
                --ref-hint-text: var(--text);
            }
        }

        .ref-hint {
            display: inline-block;
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.5em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--ref-hint-bg);
            color: var(--ref-hint-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .ref-hint * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .ref-hint ul {
            padding: 0 0 0 1em;
            list-style: none;
        }
    </style>
    <style>
        /* Boilerplate: style-selflinks */
        :root {
            --selflink-text: white;
            --selflink-bg: gray;
            --selflink-hover-text: black;
        }

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        .example>a.self-link,
        .note>a.self-link,
        .issue>a.self-link {
            /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
            left: auto;
            right: 0;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: var(--selflink-bg);
            color: var(--selflink-text);
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: var(--selflink-hover-text);
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <style>
        /* Boilerplate: style-wpt */
        :root {
            --wpt-border: hsl(0, 0%, 60%);
            --wpt-bg: hsl(0, 0%, 95%);
            --wpt-text: var(--text);
            --wptheading-text: hsl(0, 0%, 30%);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --wpt-border: hsl(0, 0%, 30%);
                --wpt-bg: var(--borderedblock-bg);
                --wpt-text: var(--text);
                --wptheading-text: hsl(0, 0%, 60%);
            }
        }

        .wpt-tests-block {
            list-style: none;
            border-left: .5em solid var(--wpt-border);
            background: var(--wpt-bg);
            color: var(--wpt-text);
            margin: 1em auto;
            padding: .5em;
        }

        .wpt-tests-block summary {
            color: var(--wptheading-text);
            font-weight: normal;
            text-transform: uppercase;
        }

        .wpt-tests-block summary::marker {
            color: var(--wpt-border);
        }

        .wpt-tests-block summary:hover::marker {
            color: var(--wpt-text);
        }

        /*
   The only content  of a wpt test block in its closed state is the <summary>,
   which contains the word TESTS,
   and that is absolutely positioned.
   In that closed state, wpt test blocks are styled
   to have a top margin whose height is exactly equal
   to the height of the absolutely positioned <summary>,
   and no other background/padding/margin/border.
   The wpt test block elements will therefore allow the maring
   of the previous/next block elements
   to collapse through them;
   if this combined margin would be larger than its own top margin,
   it stays as is,
   and therefore the pre-existing vertical rhythm of the document is undisturbed.
   If that combined margin would be smaller, it is grown to that size.
   This means that the wpt test block ensures
   that there's always enough vertical space to insert the summary,
   without adding more than is needed.
*/
        .wpt-tests-block:not([open]) {
            padding: 0;
            border: none;
            background: none;
            font-size: 0.75em;
            line-height: 1;
            position: relative;
            margin: 1em 0 0;
        }

        .wpt-tests-block:not([open]) summary {
            position: absolute;
            right: 0;
            bottom: 0;
        }

        /*
   It is possible that both the last child of a block element
   and the block element itself
   would be annotated with a <wpt> block each.
   If the block element has a padding or a border,
   that's fine, but otherwise
   the bottom margin of the block and of its last child would collapse
   and both <wpt> elements would overlap, being both placed there.
   To avoid that, add 1px of padding to the <wpt> element annotating the last child
   to prevent the bottom margin of the block and of its last child from collapsing
   (and as much negative margin,
   as wel only want to prevent margin collapsing,
   but are not trying to actually take more space).
*/
        .wpt-tests-block:not([open]):last-child {
            padding-bottom: 1px;
            margin-bottom: -1px;
        }

        /*
   Exception to the previous rule:
   don't do that in non-last list items,
   because it's not necessary,
   and would therefore consume more space than strictly needed.
   Lists must have list items as children, not <wpt> elements,
   so a <wpt> element cannot be a sibling of a list item,
   and the collision that the previous rule avoids cannot happen.
*/
        li:not(:last-child)>.wpt-tests-block:not([open]):last-child,
        dd:not(:last-child)>.wpt-tests-block:not([open]):last-child {
            padding-bottom: 0;
            margin-bottom: 0;
        }

        .wpt-tests-block:not([open]):not(:hover) {
            opacity: 0.5;
        }

        .wpt-tests-list {
            list-style: none;
            display: grid;
            margin: 0;
            padding: 0;
            grid-template-columns: 1fr max-content auto auto;
            grid-column-gap: .5em;
        }

        .wpt-tests-block hr:last-child {
            display: none;
        }

        .wpt-test {
            display: contents;
        }

        .wpt-test>a {
            text-decoration: underline;
            border: none;
        }

        .wpt-test>.wpt-name {
            grid-column: 1;
        }

        .wpt-test>.wpt-results {
            grid-column: 2;
        }

        .wpt-test>.wpt-live {
            grid-column: 3;
        }

        .wpt-test>.wpt-source {
            grid-column: 4;
        }

        .wpt-test>.wpt-results {
            display: flex;
            gap: .1em;
        }

        .wpt-test .wpt-result {
            display: inline-block;
            height: 1em;
            width: 1em;
            border-radius: 50%;
            position: relative;
        }
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD" rel="stylesheet">
    <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet"
        type="text/css">

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
        <h1 class="p-name no-ref" id="title">选择器 第 5 级</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types/#FPWD">W3C 首份公开工作草案</a>, <time class="dt-updated"
                datetime="2026-02-17">2026 年 2 月 17 日</time></p>
        <details open>
            <summary>关于本文件的更多细节</summary>
            <div data-fill-with="spec-metadata">
                <dl>
                    <dt>本版本：
                    <dd><a class="u-url"
                            href="https://www.w3.org/TR/2026/WD-selectors-5-20260217/">https://www.w3.org/TR/2026/WD-selectors-5-20260217/</a>
                    <dt>最新发布版本：
                    <dd><a href="https://www.w3.org/TR/selectors-5/">https://www.w3.org/TR/selectors-5/</a>
                    <dt>编辑草案：
                    <dd><a href="https://drafts.csswg.org/selectors-5/">https://drafts.csswg.org/selectors-5/</a>
                    <dt>历史：
                    <dd><a class="u-url"
                            href="https://www.w3.org/standards/history/selectors-5/">https://www.w3.org/standards/history/selectors-5/</a>
                    <dt>反馈：
                    <dd><a href="https://github.com/w3c/csswg-drafts/labels/selectors-5">CSSWG 问题仓库</a>
                    <dd><a href="#issues-index">规范内联</a>
                    <dt class="editor">编辑：
                    <dd class="editor p-author h-card vcard" data-editor-id="35400"><a class="p-name fn u-url url"
                            href="http://fantasai.inkedblade.net/contact">Elika J. Etemad / fantasai</a>（<span
                            class="p-org org">Apple</span>）
                    <dd class="editor p-author h-card vcard" data-editor-id="42199"><a class="p-name fn u-url url"
                            href="http://xanthir.com/contact/">Tab Atkins Jr.</a>（<span class="p-org org">Google</span>）
                    <dt>为本规范建议编辑：
                    <dd><a href="https://github.com/w3c/csswg-drafts/blob/main/selectors-5/Overview.bs">GitHub
                            编辑器</a>
                    <dt>差异规范（Delta Spec）：
                    <dd>是
                    <dt>测试套件：
                    <dd class="wpt-overview"><a
                            href="https://wpt.fyi/results/css/selectors/">https://wpt.fyi/results/css/selectors/</a>
                </dl>
            </div>
        </details>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> ©
            2026 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr
                title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a
                href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a
                href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a
                href="https://www.w3.org/copyright/software-license/" rel="license"
                title="W3C Software and Document License">permissive document license</a> rules apply. </p>
        <hr title="Separator for header">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">摘要</span></h2>
        <p><a data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#selector"
                id="ref-for-selector">选择器</a>是在树中与元素匹配的模式，因此构成了可用于在文档中选择节点的若干技术之一。选择器已针对 HTML 与 XML
            的使用进行了优化，并被设计为可用于性能关键的代码中。它们是 <abbr title="Cascading Style Sheets">CSS</abbr>（层叠样式表）的核心组件，CSS
            使用选择器将样式属性绑定到文档中的元素上。
            《选择器 第 5 级》描述了 <a data-link-type="biblio" href="#biblio-selectors-4"
                title="Selectors Level 4">[selectors-4]</a> 中已存在的选择器，并进一步为 CSS 以及其他可能需要它们的语言引入了新的选择器。</p>
        <a href="https://www.w3.org/TR/CSS/">CSS</a> 是一种用于描述结构化文档
        （如 HTML 和 XML）
        在屏幕、纸张等介质上的呈现方式的语言。
    </div>
    <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">本文档状态</span></h2>
    <div data-fill-with="status">
        <p><em>本节描述本文档在发布时的状态。
                当前 W3C 出版物列表
                以及本技术报告的最新修订版
                可在 <a href="https://www.w3.org/TR/">W3C 标准与草案索引</a> 中找到。</em> </p>
        <p> 本文档由 <a href="https://www.w3.org/groups/wg/css">CSS 工作组</a>
            按照 <a href="https://www.w3.org/policies/process/20250818/#recs-and-notes">推荐标准
                轨道</a>
            发布为 <strong>首份公开工作草案</strong>。
            作为首份公开工作草案发布
            并不意味着 <abbr title="World Wide Web Consortium">W3C</abbr> 及其成员的认可。</p>
        <p> 这是一份草案文档，
            并且可能随时被更新、替换
            或被其他文档废止。
            不应将本文档作为除“进行中的工作”之外的内容来引用。</p>
        <p>请通过 <a href="https://github.com/w3c/csswg-drafts/issues">在 GitHub 中提交 issue</a>（推荐）
            发送反馈，
            并在标题中包含规范代码 “selectors”，例如：
            “[selectors] <i>…评论摘要…</i>”。
            所有 issue 与评论都会被<a href="https://lists.w3.org/Archives/Public/public-css-archive/">归档</a>。
            或者，也可以将反馈发送到（<a href="https://lists.w3.org/Archives/Public/www-style/">已归档</a>的）公开邮件列表 <a
                href="mailto:www-style@w3.org?Subject=%5Bselectors%5D%20PUT%20SUBJECT%20HERE">www-style@w3.org</a>。</p>
        <p>本文档受 <a href="https://www.w3.org/policies/process/20250818/" id="w3c_process_revision">2025 年 8 月 18 日《W3C
                流程文档》</a> 的约束。</p>
        <p>本文档由一个在 <a href="https://www.w3.org/policies/patent-policy/20200915/">W3C 专利政策</a> 下运作的工作组编制。
            W3C 维护一份与该工作组交付成果相关的<a href="https://www.w3.org/groups/wg/css/ipr" rel="disclosure">任何专利披露的公开列表</a>；
            该页面也包含披露专利的说明。
            任何个人若实际知悉其认为包含<a href="https://www.w3.org/policies/patent-policy/20200915/#def-essential">必要权利要求</a>的专利，
            必须依照 <a href="https://www.w3.org/policies/patent-policy/20200915/#sec-Disclosure">W3C 专利政策第 6 节</a>
            披露相关信息。</p>
    </div>
    <div data-fill-with="at-risk"></div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目录</h2>
        <ol class="toc" role="directory">
            <li>
                <a href="#intro"><span class="secno">1</span> <span class="content"> 引言</span></a>
                <ol class="toc">
                    <li><a href="#placement"><span class="secno">1.1</span> <span class="content"> 模块交互</span></a>
                </ol>
            <li>
                <a href="#location"><span class="secno">2</span> <span class="content"> 位置伪类</span></a>
                <ol class="toc">
                    <li><a href="#local-pseudo"><span class="secno">2.1</span> <span class="content"> 本地链接伪类 <span
                                    class="css">:local-link</span></span></a>
                </ol>
            <li>
                <a href="#useraction-pseudos"><span class="secno">3</span> <span class="content"> 用户行为伪类</span></a>
                <ol class="toc">
                    <li><a href="#interest-pseudos"><span class="secno">3.1</span> <span class="content"> 兴趣伪类：<span
                                    class="css">:interest-source</span> 和 <span
                                    class="css">:interest-target</span></span></a>
                </ol>
            <li>
                <a href="#input-pseudos"><span class="secno">4</span> <span class="content"> 输入伪类</span></a>
                <ol class="toc">
                    <li>
                        <a href="#ui-validity"><span class="secno">4.1</span> <span class="content"> 输入值校验</span></a>
                        <ol class="toc">
                            <li><a href="#blank"><span class="secno">4.1.1</span> <span class="content"> 空值伪类：<span
                                            class="css">:blank</span></span></a>
                        </ol>
                </ol>
            <li>
                <a href="#time-pseudos"><span class="secno">5</span> <span class="content"> 时间维度伪类</span></a>
                <ol class="toc">
                    <li><a href="#the-current-pseudo"><span class="secno">5.1</span> <span class="content"> 当前元素伪类：<span
                                    class="css">:current</span></span></a>
                    <li><a href="#the-past-pseudo"><span class="secno">5.2</span> <span class="content"> 过去元素伪类：<span
                                    class="css">:past</span></span></a>
                    <li><a href="#the-future-pseudo"><span class="secno">5.3</span> <span class="content"> 未来元素伪类：<span
                                    class="css">:future</span></span></a>
                </ol>
            <li><a href="#custom-state"><span class="secno">6</span> <span class="content"> 暴露自定义状态：<span
                            class="css">:state()</span> 伪类</span></a>
            <li><a href="#headings"><span class="secno">7</span> <span class="content"> 标题结构：标题伪类 <span
                            class="css">:heading</span> 与 <span class="css">:heading()</span></span></a>
            <li>
                <a href="#grid-structural-selectors"><span class="secno">8</span> <span class="content">
                        网格结构选择器</span></a>
                <ol class="toc">
                    <li><a href="#the-column-combinator"><span class="secno">8.1</span> <span class="content">
                                列组合符（<code>||</code>）</span></a>
                    <li><a href="#the-nth-col-pseudo"><span class="secno">8.2</span> <span class="content"> <span
                                    class="css">:nth-col()</span> 伪类</span></a>
                    <li><a href="#the-nth-last-col-pseudo"><span class="secno">8.3</span> <span class="content"> <span
                                    class="css">:nth-last-col()</span> 伪类</span></a>
                </ol>
            <li>
                <a href="#combinators"><span class="secno">9</span> <span class="content"> 组合符</span></a>
                <ol class="toc">
                    <li><a href="#idref-combinators"><span class="secno">9.1</span> <span class="content"> 引用组合符
                                <code>/ref/</code></span></a>
                </ol>
            <li>
                <a href="#changes"><span class="secno">10</span> <span class="content"> 变更</span></a>
                <ol class="toc">
                    <li><a href="#changes-level-4"><span class="secno">10.1</span> <span class="content"> 自第 4
                                级以来的变更</span></a>
                </ol>
            <li><a href="#acknowledgements"><span class="secno">11</span> <span class="content">
                        致谢</span></a>
            <li><a href="#privacy"><span class="secno"></span> <span class="content">隐私注意事项</span></a>
            <li><a href="#security"><span class="secno"></span> <span class="content">安全注意事项</span></a>
            <li>
                <a href="#w3c-conformance"><span class="secno"></span> <span class="content"> 一致性</span></a>
                <ol class="toc">
                    <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content"> 文档约定</span></a>
                    <li><a href="#w3c-conformance-classes"><span class="secno"></span> <span class="content">
                                一致性类别</span></a>
                    <li>
                        <a href="#w3c-partial"><span class="secno"></span> <span class="content"> 部分实现</span></a>
                        <ol class="toc">
                            <li><a href="#w3c-conform-future-proofing"><span class="secno"></span> <span
                                        class="content">不稳定与专有特性的实现</span></a>
                        </ol>
                    <li><a href="#w3c-testing"><span class="secno"></span> <span class="content"> 非试验性实现</span></a>
                </ol>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本规范定义的术语</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">通过引用定义的术语</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考文献</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">规范性参考文献</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">资料性参考文献</span></a>
                </ol>
            <li><a href="#issues-index"><span class="secno"></span> <span class="content">问题索引</span></a>
        </ol>
    </nav>
    <main>
        <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">
                引言</span><a class="self-link" href="#intro"></a></h2>
        <p class="issue" id="issue-edc8dd61"><a class="self-link" href="#issue-edc8dd61"></a> <strong>这是相对于 <a
                    href="https://www.w3.org/TR/selectors-4/">选择器 第 4 级</a> 的差异规范。</strong></p>
        <h3 class="heading settled" data-level="1.1" id="placement"><span class="secno">1.1. </span><span
                class="content"> 模块交互</span><a class="self-link" href="#placement"></a></h3>
        <p>本模块扩展了在 <a data-link-type="biblio" href="#biblio-selectors-4" title="Selectors Level 4">[selectors-4]</a> 中为
            CSS 定义的选择器集合。</p>
        <h2 class="heading settled" data-level="2" id="location"><span class="secno">2. </span><span class="content">
                位置伪类</span><a class="self-link" href="#location"></a></h2>
        <h3 class="heading settled" data-level="2.1" id="local-pseudo"><span class="secno">2.1. </span><span
                class="content"> 本地链接伪类 <a class="css" data-link-type="maybe" href="#local-link-pseudo"
                    id="ref-for-local-link-pseudo">:local-link</a></span><a class="self-link" href="#local-pseudo"></a>
        </h3>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export id="local-link-pseudo">:local-link</dfn>
            伪类允许作者基于用户在站点内的当前位置来为 <a
                href="https://www.w3.org/TR/selectors-4/#the-any-link-pseudo">超链接</a>设置样式，并区分站点内部链接与站点外部链接。</p>
        <p>（非函数式的）<a class="css" data-link-type="maybe" href="#local-link-pseudo"
                id="ref-for-local-link-pseudo①">:local-link</a> 伪类表示这样一个元素：它是某个超链接的源锚点，且该超链接目标的绝对 URL
            与该元素自身文档的 URL 相匹配。
            在将文档 URL 与链接 URL 进行匹配之前，会先去除任何片段标识符（fragment identifier）；
            否则将考虑 URL 的所有部分。</p>
        <div class="example" id="example-d2555a3c">
            <a class="self-link" href="#example-d2555a3c"></a> 例如，下面这条规则会阻止当导航列表中的链接指向当前页面时出现下划线：
            <pre>nav :local-link { text-decoration: none; } </pre>
        </div>
        <p>作为函数式伪类，<span class="css">:local-link()</span> 也可以接受一个非负整数作为其唯一参数；
            若文档 URL 属于层级式（hierarchical）方案，则该参数表示要匹配的路径层级数量：</p>
        <ul>
            <li><span class="css">:local-link(0)</span> 表示目标与文档 URL 具有相同源（origin）的链接元素
            <li><span class="css">:local-link(1)</span> 表示目标具有相同源以及相同的第一个路径片段的链接元素
            <li><span class="css">:local-link(2)</span> 表示目标具有相同源、相同的第一个与第二个路径片段的链接元素
            <li>等等。
        </ul>
        <div class="example" id="example-a43b38c7">
            <a class="self-link" href="#example-a43b38c7"></a> 下面的示例会将所有站点外部链接设置为虚线下划线。
            <pre>:not(:local-link(0)) { text-decoration-style: dashed; } </pre>
        </div>
        <p>路径片段是 URL 路径中由正斜杠（/）分隔的部分。
            若文档 URL 中缺少某个片段，则要求该片段匹配的伪类将不会匹配任何元素。</p>
        <div class="example" id="example-c9a76ca6">
            <a class="self-link" href="#example-c9a76ca6"></a> 因此，给定以下链接：
            <ol>
                <li><code>&lt;a href="http://www.example.com">主页&lt;/a></code>
                <li><code>&lt;a href="http://www.example.com/2011">2011&lt;/a></code>
                <li><code>&lt;a href="http://www.example.com/2011/03">三月&lt;/a></code>
                <li><code>&lt;a href="http://www.example.com/2011/03/">三月&lt;/a></code>
                <li><code>&lt;a href="http://www.example.com/2011/03/21">3 月 21 日&lt;/a></code>
                <li><code>&lt;a href="https://www.example.com/2011/03/">三月&lt;/a></code>
                <li><code>&lt;a href="http://example.com/2011/03/">三月&lt;/a></code>
            </ol>
            <p>以及以下样式：</p>
            <ol type="A">
                <li><code>a:local-link {...}</code>
                <li><code>a:local-link(0) {...}</code>
                <li><code>a:local-link(1) {...}</code>
                <li><code>a:local-link(2) {...}</code>
                <li><code>a:local-link(3) {...}</code>
                <li><code>a:local-link(4) {...}</code>
            </ol>
            <p>若文档 URL 为 <code>http://www.example.com/2011/03/</code>：</p>
            <ol>
                <li>链接 1 将应用样式 B
                <li>链接 2 将应用样式 B 与 C
                <li>链接 3 将应用样式 B、C 与 D
                <li>链接 4 也将应用样式 A、B、C、D 与 E
                <li>链接 5 将应用样式 B、C 与 D
                <li>链接 6 将保持无样式
                <li>链接 7 将保持无样式
                <li>样式 F 不会应用到任何元素
            </ol>
        </div>
        <p>URL 的“源”（origin）由 <a href="http://tools.ietf.org/html/rfc6454#section-4">RFC 6454 第 4 节</a> 定义。
            当与 <span class="css">:local-link(<var>n</var>)</span> 进行匹配时，不考虑 URL 的用户名、密码、查询字符串与片段部分。
            若文档 URL 不属于层级式方案，则该函数式伪类不匹配任何元素。</p>
        <p class="issue" id="issue-dd3371ba"><a class="self-link" href="#issue-dd3371ba"></a> 很明显，如果文档 URL 至少有 N 个片段，
            那么 <span class="css">:local-link(N)</span> 只会匹配 URL 至少有 N 个片段的链接。
            （这让你可以为 :local-link 赋予一致的语义，例如，:local-link(2) 在 GitHub 上表示“仓库内”链接。）
            但如果文档 URL 的片段数少于 N，
            且链接是同页链接呢？
            “空片段（null segments）”应该算作匹配，还是不算？</p>
        <h2 class="heading settled" data-level="3" id="useraction-pseudos"><span class="secno">3. </span><span
                class="content"> 用户行为伪类</span><a class="self-link" href="#useraction-pseudos"></a>
        </h2>
        <h3 class="heading settled" data-level="3.1" id="interest-pseudos"><span class="secno">3.1. </span><span
                class="content"> 兴趣伪类：<a class="css" data-link-type="maybe" href="#selectordef-interest-source"
                    id="ref-for-selectordef-interest-source">:interest-source</a>
                和 <a class="css" data-link-type="maybe" href="#selectordef-interest-target"
                    id="ref-for-selectordef-interest-target">:interest-target</a></span><a class="self-link"
                href="#interest-pseudos"></a></h3>
        <p>一种常见的 UI 特性是允许用户对某些元素“显示兴趣”
            （<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="interest-source">兴趣源</dfn>），
            并让 UI 对该兴趣作出响应，
            通过在另一个元素中显示额外信息
            （<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="interest-target">兴趣目标</dfn>），
            通常是一个弹出层（popup）。
            例如，将鼠标悬停在页面中的用户名上
            可能会弹出该用户的信息卡片；
            或者长按一个链接
            可能会弹出该链接目标的预览。
            每当发生这种情况时，第一个元素</p>
        <p class="note" role="note"><span class="marker">注：</span>究竟哪些元素能够成为 <a data-link-type="dfn"
                href="#interest-source" id="ref-for-interest-source">兴趣源</a>，
            它们如何与 <a data-link-type="dfn" href="#interest-target" id="ref-for-interest-target">兴趣目标</a> 关联，
            以及“兴趣”如何展示，
            都由<a data-link-type="dfn" href="https://w3c.github.io/aria/#dfn-host-language"
                id="ref-for-dfn-host-language">宿主语言</a>定义。
            例如在 HTML 中，
            通过 <code><a data-link-type="element-sub">interestfor</a></code> 属性
            来指示一个能够“显示兴趣”的元素
            （即成为一个 <span id="ref-for-interest-source①">兴趣源</span>），
            并且该属性指向另一个元素，
            该元素用于显示额外信息
            （即关联的 <span id="ref-for-interest-target①">兴趣目标</span>）
            （通常是一个
            <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/popover.html#attr-popover" id="ref-for-attr-popover">popover</a></code>
            元素）。
        </p>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export
                id="selectordef-interest-source">:interest-source</dfn> 伪类
            适用于用户当前正在“显示兴趣”的某个 <a data-link-type="dfn" href="#interest-source" id="ref-for-interest-source②">兴趣源</a> 元素；
            而 <dfn class="dfn-paneled css" data-dfn-type="selector" data-export
                id="selectordef-interest-target">:interest-target</dfn> 伪类
            适用于与匹配 <a class="css" data-link-type="maybe" href="#selectordef-interest-source"
                id="ref-for-selectordef-interest-source①">:interest-source</a> 的元素相关联的 <a data-link-type="dfn"
                href="#interest-target" id="ref-for-interest-target②">兴趣目标</a>。</p>
        <p class="note" role="note"><span class="marker">注：</span><a class="css" data-link-type="maybe"
                href="#selectordef-interest-source" id="ref-for-selectordef-interest-source②">:interest-source</a>
            只会匹配用户<em>当前</em>感兴趣的某个 <a data-link-type="dfn" href="#interest-source"
                id="ref-for-interest-source③">兴趣源</a>，
            而不是任何<em>潜在</em>能够被显示兴趣的元素。
            例如在 HTML 中，
            仅仅拥有 <code><a data-link-type="element-sub">interestfor</a></code> 属性并不会让元素匹配该伪类；
            用户还必须实际对其表示兴趣。
            同样，<a class="css" data-link-type="maybe" href="#selectordef-interest-target"
                id="ref-for-selectordef-interest-target①">:interest-target</a> 只会匹配一个 <a data-link-type="dfn"
                href="#interest-target" id="ref-for-interest-target③">兴趣目标</a>：它必须与用户<em>当前</em>感兴趣的元素相链接，
            而不是任何被 <code><a data-link-type="element-sub">interestfor</a></code> 属性指向的元素。</p>
        <h2 class="heading settled" data-level="4" id="input-pseudos"><span class="secno">4. </span><span
                class="content"> 输入伪类</span><a class="self-link" href="#input-pseudos"></a></h2>
        <h3 class="heading settled" data-level="4.1" id="ui-validity"><span class="secno">4.1. </span><span
                class="content"> 输入值校验</span><a class="self-link" href="#ui-validity"></a></h3>
        <h4 class="heading settled" data-level="4.1.1" id="blank"><span class="secno">4.1.1. </span><span
                class="content"> 空值伪类：<a class="css" data-link-type="maybe" href="#blank-pseudo"
                    id="ref-for-blank-pseudo">:blank</a></span><a class="self-link" href="#blank"></a></h4>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export id="blank-pseudo">:blank</dfn>
            伪类
            适用于用户输入元素：其输入值为空
            （由空字符串构成或为其他空输入）。</p>
        <div class="note" role="note">
            大体来说，如果一个人查看表单的打印稿
            会说它是空白的，
            那它就匹配 <a class="css" data-link-type="maybe" href="#blank-pseudo" id="ref-for-blank-pseudo①">:blank</a>。
            <p>用于解释表单控件上 <a class="css" data-link-type="maybe" href="#blank-pseudo"
                    id="ref-for-blank-pseudo②">:blank</a> 的一个经验法则是：</p>
            <ul>
                <li data-md>
                    <p>如果控件总是会提交，
                        并且在值为空时会提交空字符串，则它匹配 <a class="css" data-link-type="maybe" href="#blank-pseudo"
                            id="ref-for-blank-pseudo③">:blank</a>。
                        （例如 HTML 的 <code>&lt;input type=text></code> 在其值为空时。）</p>
                <li data-md>
                    <p>如果它有时会提交，而当其被设置为不提交时，则它匹配 <a class="css" data-link-type="maybe" href="#blank-pseudo"
                            id="ref-for-blank-pseudo④">:blank</a>。
                        （例如 HTML 的 <code>&lt;input type=checkbox></code> 在未勾选时。）</p>
                <li data-md>
                    <p>如果它是一个“动作按钮”
                        （而不是表示某种状态的“切换按钮”），
                        例如 <code>&lt;button></code>、<code>&lt;input type=submit></code> 等，
                        则它永远不会匹配 <a class="css" data-link-type="maybe" href="#blank-pseudo"
                            id="ref-for-blank-pseudo⑤">:blank</a>。</p>
            </ul>
            <p>宿主语言可以为表单控件何时匹配 <a class="css" data-link-type="maybe" href="#blank-pseudo"
                    id="ref-for-blank-pseudo⑥">:blank</a> 指定更精确的规则。</p>
        </div>
        <h2 class="heading settled" data-level="5" id="time-pseudos"><span class="secno">5. </span><span
                class="content"> 时间维度伪类</span><a class="self-link" href="#time-pseudos"></a>
        </h2>
        <p>这些伪类根据某个时间线中
            当前显示或处于活动状态的位置来对元素进行分类，例如
            在文档的语音渲染过程中，
            或者在使用 WebVTT 渲染字幕的视频播放过程中。</p>
        <p>CSS 不定义这条时间线；
            宿主语言必须定义它。
            若某个元素未定义时间线，
            这些伪类就不得匹配该元素。</p>
        <p class="note" role="note"><span class="marker">注：</span><a class="css" data-link-type="maybe"
                href="#current-pseudo" id="ref-for-current-pseudo">:current</a> 元素的祖先元素也同样是
            <span class="css" id="ref-for-current-pseudo①">:current</span>，
            但 <a class="css" data-link-type="maybe" href="#past-pseudo" id="ref-for-past-pseudo">:past</a> 或 <a
                class="css" data-link-type="maybe" href="#future-pseudo" id="ref-for-future-pseudo">:future</a>
            元素的祖先元素不一定也同样是 <span class="css" id="ref-for-past-pseudo①">:past</span> 或 <span class="css"
                id="ref-for-future-pseudo①">:future</span>。
            给定元素最多只能匹配 <span class="css" id="ref-for-current-pseudo②">:current</span>、<span class="css"
                id="ref-for-past-pseudo②">:past</span> 或 <span class="css" id="ref-for-future-pseudo②">:future</span>
            之一。
        </p>
        <h3 class="heading settled" data-level="5.1" id="the-current-pseudo"><span class="secno">5.1. </span><span
                class="content"> 当前元素伪类：<a class="css" data-link-type="maybe" href="#current-pseudo"
                    id="ref-for-current-pseudo③">:current</a></span><a class="self-link" href="#the-current-pseudo"></a>
        </h3>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export id="current-pseudo">:current</dfn>
            伪类表示当前正在显示的元素，或该元素的某个祖先元素。</p>
        <p>其另一种形式 <dfn class="dfn-paneled css" data-dfn-type="selector" data-export
                id="selectordef-current">:current()</dfn> 接受一个由 <a data-link-type="dfn"
                href="https://www.w3.org/TR/selectors-4/#compound" id="ref-for-compound">复合选择器</a> 组成的列表作为参数：
            它表示匹配该参数的 <a class="css" data-link-type="maybe" href="#current-pseudo"
                id="ref-for-current-pseudo④">:current</a> 元素；
            或者若其不匹配，则表示匹配该参数的 <span class="css" id="ref-for-current-pseudo⑤">:current</span> 元素的最内层祖先元素。
            （如果 <span class="css" id="ref-for-current-pseudo⑥">:current</span> 元素及其祖先都不匹配参数，则该选择器不表示任何元素。）</p>
        <div class="example" id="example-34db2617">
            <a class="self-link" href="#example-34db2617"></a> 例如，下面这条规则会高亮文档语音渲染中正在被朗读的段落或列表项：
            <pre>:current(p, li, dt, dd) {
  background: yellow;
}
</pre>
        </div>
        <h3 class="heading settled" data-level="5.2" id="the-past-pseudo"><span class="secno">5.2. </span><span
                class="content"> 过去元素伪类：<a class="css" data-link-type="maybe" href="#past-pseudo"
                    id="ref-for-past-pseudo③">:past</a></span><a class="self-link" href="#the-past-pseudo"></a></h3>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export id="past-pseudo">:past</dfn>
            伪类表示任何被定义为完全发生在某个 <a class="css" data-link-type="maybe" href="#current-pseudo"
                id="ref-for-current-pseudo⑦">:current</a> 元素之前的元素。
            例如，WebVTT 规范定义了 <a class="css" data-link-type="maybe" href="#past-pseudo"
                id="ref-for-past-pseudo④">:past</a> 伪类是<a
                href="https://w3c.github.io/webvtt/#the-past-and-future-pseudo-classes">相对于媒体元素当前播放位置</a>而言的。
            若文档语言未定义基于时间的元素顺序，
            则它表示任何作为 <span class="css" id="ref-for-current-pseudo⑧">:current</span> 元素的（可能为间接的）前一个兄弟元素的元素。</p>
        <h3 class="heading settled" data-level="5.3" id="the-future-pseudo"><span class="secno">5.3. </span><span
                class="content"> 未来元素伪类：<a class="css" data-link-type="maybe" href="#future-pseudo"
                    id="ref-for-future-pseudo③">:future</a></span><a class="self-link" href="#the-future-pseudo"></a>
        </h3>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export id="future-pseudo">:future</dfn>
            伪类表示任何被定义为完全发生在某个 <a class="css" data-link-type="maybe" href="#current-pseudo"
                id="ref-for-current-pseudo⑨">:current</a> 元素之后的元素。
            例如，WebVTT 规范定义了 <a class="css" data-link-type="maybe" href="#future-pseudo"
                id="ref-for-future-pseudo④">:future</a> 伪类是<a
                href="https://w3c.github.io/webvtt/#the-past-and-future-pseudo-classes">相对于媒体元素当前播放位置</a>而言的。
            若文档语言未定义基于时间的元素顺序，
            则它表示任何作为 <span class="css" id="ref-for-current-pseudo①⓪">:current</span> 元素的（可能为间接的）后一个兄弟元素的元素。</p>
        <h2 class="heading settled" data-level="6" id="custom-state"><span class="secno">6. </span><span
                class="content"> 暴露自定义状态：<a class="css" data-link-type="maybe" href="#state-pseudo"
                    id="ref-for-state-pseudo">:state()</a> 伪类</span><a class="self-link" href="#custom-state"></a></h2>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export id="state-pseudo">:state( <a
                    class="production css" data-link-type="type"
                    href="https://www.w3.org/TR/css-values-4/#typedef-ident" id="ref-for-typedef-ident">&lt;ident></a>
                )</dfn> 伪类
            匹配那些 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/custom-elements.html#custom-element"
                id="ref-for-custom-element">自定义元素</a>：其 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/custom-elements.html#states-set"
                id="ref-for-states-set">状态集合（states set）</a> 包含某个字符串，
            该字符串 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-is" id="ref-for-string-is">是</a>
            选择器参数值的字符串。</p>
        <details class="wpt-tests-block" dir="ltr" lang="en">
            <summary>Tests</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/selectors/parsing/parse-state.html"
                        title="css/selectors/parsing/parse-state.html">parse-state.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/selectors/parsing/parse-state.html"><small>(live test)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/selectors/parsing/parse-state.html"><small>(source)</small></a>
            </ul>
        </details>
        <p class="note" role="note"><span class="marker">注：</span>“<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#string-is" id="ref-for-string-is①">is</a>” 的匹配行为按码点比较字符串；
            需要注意的是，它区分大小写。
            因此，如果 “foo” 在 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/custom-elements.html#states-set"
                id="ref-for-states-set①">状态集合</a> 中，<span class="css">:state(FOO)</span> 将<em>不会</em>匹配。
        </p>
        <p><a class="css" data-link-type="maybe" href="#state-pseudo" id="ref-for-state-pseudo①">:state()</a> 伪类的精确匹配行为
            由宿主语言定义。
            为清晰起见，用于解释该伪类的概念链接到 HTML 的定义；
            更多细节请参见 <a href="https://html.spec.whatwg.org/multipage/custom-elements.html#custom-state-pseudo-class">HTML
                的定义</a>。
            其他宿主语言必须定义该伪类如何匹配。</p>
        <h2 class="heading settled" data-level="7" id="headings"><span class="secno">7. </span><span class="content">
                标题结构：标题伪类 <a class="css" data-link-type="maybe" href="#heading-pseudo"
                    id="ref-for-heading-pseudo">:heading</a> 与 <a class="css" data-link-type="maybe"
                    href="#heading-functional-pseudo" id="ref-for-heading-functional-pseudo">:heading()</a></span><a
                class="self-link" href="#headings"></a></h2>
        <p>（非函数式的）<dfn class="dfn-paneled css" data-dfn-type="selector" data-export id="heading-pseudo">:heading</dfn>
            伪类
            匹配具有某个 <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/sections.html#heading-level"
                id="ref-for-heading-level">标题级别（heading level）</a> 的元素（相对于文档语言所定义的语义，例如 <a data-link-type="biblio"
                href="#biblio-html5" title="HTML5">[HTML5]</a>）。</p>
        <p><a data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#specificity"
                id="ref-for-specificity">特异性（specificity）</a>之于 <a class="css" data-link-type="maybe"
                href="#heading-pseudo" id="ref-for-heading-pseudo①">:heading</a> 等同于一个类。</p>
        <div class="example" id="example-640da181">
            <a class="self-link" href="#example-640da181"></a> 例如，下面的样式表包含一条规则，用于应用到当前页面中的所有标题元素：
            <pre>:heading { text-decoration: underline; }</pre>
        </div>
        <p>作为函数式伪类，<dfn class="dfn-paneled css" data-dfn-type="selector" data-export
                id="heading-functional-pseudo">:heading()</dfn> 记法表示这样一些元素：其 <a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/sections.html#heading-level"
                id="ref-for-heading-level①">标题级别</a> 在所提供的若干 <var>integer</var> 值中匹配任意一个。
            其语法为：</p>
        <pre class="prod">:heading() = :heading( <a class="production" data-link-type="type" href="#typedef-level" id="ref-for-typedef-level">&lt;level></a><a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-comma" id="ref-for-mult-comma">#</a> )
</pre>
        <p>其中 <dfn class="dfn-paneled css" data-dfn-type="type" data-export
                id="typedef-level"><code>&lt;level></code></dfn> 是一个 <a class="production css" data-link-type="type"
                href="https://www.w3.org/TR/css-syntax-3/#typedef-number-token"
                id="ref-for-typedef-number-token">&lt;number-token></a>，并且其类型标志被设置为 “integer”。</p>
        <p><a class="css" data-link-type="maybe" href="#heading-functional-pseudo"
                id="ref-for-heading-functional-pseudo①">:heading()</a> 的 <a data-link-type="dfn"
                href="https://www.w3.org/TR/selectors-4/#specificity" id="ref-for-specificity①">特异性（specificity）</a>
            等同于一个类。</p>
        <div class="example" id="example-8a5e281d">
            <a class="self-link" href="#example-8a5e281d"></a> 下面的示例将级别在 1 到 3 之间的标题设置为 900 的字重，而将 6 及之后级别的标题设置为 500
            的字重；此外，标题级别 1 与 2 会有下划线，而 3 及之后将没有 text-decoration：
            <pre>:heading(1, 2, 3) { font-weight: 900; }</pre>
            <pre>:heading(6, 7, 8, 9) { font-weight: 500; }</pre>
            <pre>:heading(1, 2) { text-decoration: underline; }</pre>
            <pre>:heading(3, 4, 5, 6, 7, 8, 9) { text-decoration: none; }</pre>
        </div>
        <p class="note" role="note"><span class="marker">注：</span><a data-link-type="dfn"
                href="https://html.spec.whatwg.org/multipage/sections.html#heading-level"
                id="ref-for-heading-level②">标题级别</a> 可能与元素的 <a data-link-type="dfn"
                href="https://www.w3.org/TR/CSS2/selector.html#x11" id="ref-for-x11">类型选择器</a> 不同。因此，选择器 <span
                class="css">h1:heading(3)</span> 会匹配任何暴露出的标题级别为 3 的 <span class="css">h1</span> 标签。</p>
        <details class="wpt-tests-block" dir="ltr" lang="en">
            <summary>Tests</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/selectors/heading.html"
                        title="css/selectors/heading.html">heading.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/selectors/heading.html"><small>(live test)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/selectors/heading.html"><small>(source)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/selectors/parsing/parse-heading.html"
                        title="css/selectors/parsing/parse-heading.html">parse-heading.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/selectors/parsing/parse-heading.html"><small>(live test)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/selectors/parsing/parse-heading.html"><small>(source)</small></a>
            </ul>
        </details>
        <h2 class="heading settled" data-level="8" id="grid-structural-selectors"><span class="secno">8. </span><span
                class="bs-old-id" id="table-pseudos"></span><span class="content"> 网格结构选择器</span><a class="self-link"
                href="#grid-structural-selectors"></a></h2>
        <p>二维网格中的单元格具有双重关联（关联到其行与列），
            这种关联无法通过层级式标记语言中的亲子关系来表示。
            其中只有一种关联可以以层级方式表示：另一种必须在文档语言的语义中显式或隐式定义。
            在 HTML 与 DocBook 这两种最常见的层级式标记语言中，标记是“以行优先”的（也就是说，行关联以层级方式表示）；列必须通过推断得出。
            为了能够表示这种隐式的、基于列的关系，定义了 <a data-link-type="dfn" href="#column-combinator"
                id="ref-for-column-combinator">列组合符</a> 以及 <a class="css" data-link-type="maybe" href="#nth-col-pseudo"
                id="ref-for-nth-col-pseudo">:nth-col()</a> 与 <a class="css" data-link-type="maybe"
                href="#nth-last-col-pseudo" id="ref-for-nth-last-col-pseudo">:nth-last-col()</a> 伪类。
            在以列优先的格式中，这些伪类则改为匹配行关联。</p>
        <h3 class="heading settled" data-level="8.1" id="the-column-combinator"><span class="secno">8.1. </span><span
                class="content"> 列组合符（<code>||</code>）</span><a class="self-link" href="#the-column-combinator"></a>
        </h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="column-combinator">列组合符</dfn>由两个竖线组成（<dfn
                class="dfn-paneled css" data-dfn-type="selector" data-export id="selectordef-column">||</dfn>），
            表示列元素与属于该列的单元格元素之间的关系。
            列成员关系仅依据文档语言的语义来确定：
            不考虑元素是否以及如何呈现。
            若某个单元格元素属于多个列，
            则由一个指示属于其中任意列的选择器来表示。</p>
        <div class="example" id="example-60f47339">
            <a class="self-link" href="#example-60f47339"></a> 下面的例子会让单元格 C、E 与 G 变为灰色。
            <pre>col.selected || td {
  background: gray;
  color: white;
  font-weight: bold;
}
</pre>
            <pre>&lt;table>
  &lt;col span="2">
  &lt;col class="selected">
  &lt;tr>&lt;td>A &lt;td>B &lt;td>C
  &lt;tr>&lt;td colspan="2">D &lt;td>E
  &lt;tr>&lt;td>F &lt;td colspan="2">G
&lt;/table>
</pre>
        </div>
        <h3 class="heading settled" data-level="8.2" id="the-nth-col-pseudo"><span class="secno">8.2. </span><span
                class="content"> <a class="css" data-link-type="maybe" href="#nth-col-pseudo"
                    id="ref-for-nth-col-pseudo①">:nth-col()</a> 伪类</span><a class="self-link"
                href="#the-nth-col-pseudo"></a></h3>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export data-lt=":nth-col()"
                id="nth-col-pseudo">:nth-col(<var>An+B</var>)</dfn> 伪类记法表示这样的单元格元素：它属于某个列，
            并且在它之前有 <var>An+B</var>-1 个列，其中 <code>n</code> 可以取任意正整数或零。
            列成员关系仅依据文档语言的语义来确定：不考虑元素是否以及如何呈现。
            若某个单元格元素属于多个列，则由一个指示属于其中任意列的选择器来表示。</p>
        <p>CSS Syntax Module <a data-link-type="biblio" href="#biblio-css3syn"
                title="CSS Syntax Module Level 3">[CSS3SYN]</a> 定义了 <a
                href="https://drafts.csswg.org/css-syntax/#anb"><var>An+B</var> 记法</a>。</p>
        <h3 class="heading settled" data-level="8.3" id="the-nth-last-col-pseudo"><span class="secno">8.3. </span><span
                class="content"> <a class="css" data-link-type="maybe" href="#nth-last-col-pseudo"
                    id="ref-for-nth-last-col-pseudo①">:nth-last-col()</a> 伪类</span><a class="self-link"
                href="#the-nth-last-col-pseudo"></a></h3>
        <p><dfn class="dfn-paneled css" data-dfn-type="selector" data-export data-lt=":nth-last-col()"
                id="nth-last-col-pseudo">:nth-last-col(<var>An+B</var>)</dfn> 伪类记法表示这样的单元格元素：它属于某个列，
            并且在它之后有 <var>An+B</var>-1 个列，其中 <code>n</code> 可以取任意正整数或零。
            列成员关系仅依据文档语言的语义来确定：不考虑元素是否以及如何呈现。
            若某个单元格元素属于多个列，则由一个指示属于其中任意列的选择器来表示。</p>
        <p>CSS Syntax Module <a data-link-type="biblio" href="#biblio-css3syn"
                title="CSS Syntax Module Level 3">[CSS3SYN]</a> 定义了 <a
                href="https://drafts.csswg.org/css-syntax/#anb"><var>An+B</var> 记法</a>。</p>
        <h2 class="heading settled" data-level="9" id="combinators"><span class="secno">9. </span><span class="content">
                组合符</span><a class="self-link" href="#combinators"></a></h2>
        <h3 class="heading settled" data-level="9.1" id="idref-combinators"><span class="secno">9.1. </span><span
                class="content"> 引用组合符 <code>/ref/</code></span><a class="self-link" href="#idref-combinators"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="reference-combinator">引用组合符</dfn>由两个斜杠组成，
            中间夹着一个 <a href="https://www.w3.org/TR/css3-namespace/#css-qnames">CSS 限定名称</a>，
            并分隔两个 <a data-link-type="dfn" href="https://www.w3.org/TR/selectors-4/#compound"
                id="ref-for-compound①">复合选择器</a>，
            例如 <span class="css">A /attr/ B</span>。
            第一个 <span id="ref-for-compound②">复合选择器</span>所表示的元素显式引用
            第二个 <span id="ref-for-compound③">复合选择器</span>所表示的元素。
            除非宿主语言为表达该关系定义了不同语法，
            否则当第一个元素上指定属性的值为 IDREF 或者为引用第二个元素的 <a data-link-type="dfn"
                href="https://www.w3.org/TR/selectors-4/#id-selector" id="ref-for-id-selector">ID 选择器</a> 时，
            视为该关系存在。</p>
        <p>引用组合符的属性匹配遵循与 <a href="https://www.w3.org/TR/css3-selectors/#attribute-selectors">属性选择器</a> 相同的规则。</p>
        <div class="example" id="example-69e878ec">
            <a class="self-link" href="#example-69e878ec"></a> 下面的例子会在其 <a data-link-type="element"
                href="https://html.spec.whatwg.org/multipage/input.html#the-input-element"
                id="ref-for-the-input-element">input</a> 元素的 <a
                href="https://www.w3.org/TR/html40/interact/forms.html#h-17.9"><code>&lt;label></code></a> 获得焦点或被悬停时，高亮该
            input 元素：
            <pre>label:is(:hover, :focus) /for/ input,       /* 通过 "for" 属性关联 */
label:is(:hover, :focus):not([for]) input { /* 通过包含关系关联 */
  box-shadow: yellow 0 0 10px;
}
</pre>
        </div>
        <h2 class="heading settled" data-level="10" id="changes"><span class="secno">10. </span><span class="content">
                变更</span><a class="self-link" href="#changes"></a></h2>
        <h3 class="heading settled" data-level="10.1" id="changes-level-4"><span class="secno">10.1. </span><span
                class="content"> 自第 4 级以来的变更</span><a class="self-link" href="#changes-level-4"></a></h3>
        <p>自 <a href="https://www.w3.org/TR/selectors-4/">第 4 级</a> 以来新增内容：</p>
        <ul>
            <li>引用组合符
                （从《选择器 4》的<a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/">早期草案</a>中推迟）
            <li><a class="css" data-link-type="maybe" href="#local-link-pseudo"
                    id="ref-for-local-link-pseudo②">:local-link</a> 伪类的函数式形式
                （从《选择器 4》的<a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/">早期草案</a>中推迟）
            <li><a class="css" data-link-type="maybe" href="#state-pseudo" id="ref-for-state-pseudo②">:state()</a>
                伪类
            <li><a class="css" data-link-type="maybe" href="#heading-pseudo" id="ref-for-heading-pseudo②">:heading</a> 与
                <a class="css" data-link-type="maybe" href="#heading-functional-pseudo"
                    id="ref-for-heading-functional-pseudo②">:heading()</a>
                伪类
            <li><a class="css" data-link-type="maybe" href="#local-link-pseudo"
                    id="ref-for-local-link-pseudo③">:local-link</a> 伪类
                （从《选择器 4》的<a href="https://www.w3.org/TR/2022/WD-selectors-4-20221111/">早期草案</a>中推迟）
            <li><a class="css" data-link-type="maybe" href="#selectordef-interest-source"
                    id="ref-for-selectordef-interest-source③">:interest-source</a> 与 <a class="css"
                    data-link-type="maybe" href="#selectordef-interest-target"
                    id="ref-for-selectordef-interest-target②">:interest-target</a> 伪类
            <li><a class="css" data-link-type="maybe" href="#blank-pseudo" id="ref-for-blank-pseudo⑦">:blank</a>
                伪类
                （从《选择器 4》的<a href="https://www.w3.org/TR/2022/WD-selectors-4-20221111/">早期草案</a>中推迟）
            <li><a href="#grid-structural-selectors">网格结构（列）选择器</a>（从《选择器 4》的<a
                    href="https://www.w3.org/TR/2022/WD-selectors-4-20221111/">早期草案</a>中推迟）
            <li><a href="#time-pseudos">时间维度伪类</a>（从《选择器 4》的<a
                    href="https://www.w3.org/TR/2022/WD-selectors-4-20221111/">早期草案</a>中推迟）
        </ul>
        <h2 class="heading settled" data-level="11" id="acknowledgements"><span class="secno">11. </span><span
                class="content">致谢</span><a class="self-link" href="#acknowledgements"></a></h2>
        <p>CSS 工作组希望感谢多年来为 <a href="https://www.w3.org/TR/selectors-4">此前的选择器</a> 规范做出贡献的所有人，
            因为这些规范构成了本规范的基础。
            尤其是，工作组希望就以下人士对《选择器 第 5 级》的具体贡献致以特别感谢：
            Joey Arhar。</p>
        <h2 class="no-num heading settled" id="privacy"><span class="content">隐私注意事项</span><a class="self-link"
                href="#privacy"></a></h2>
        <p>在适当时应从第 4 级复制。</p>
        <h2 class="no-num heading settled" id="security"><span class="content">安全注意事项</span><a class="self-link"
                href="#security"></a></h2>
        <p>在适当时应从第 4 级复制。</p>
    </main>
    <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content"> 一致性</span><a class="self-link"
            href="#w3c-conformance"></a></h2>
    <h3 class="no-ref heading settled" id="w3c-conventions"><span class="content"> 文档约定</span><a class="self-link"
            href="#w3c-conventions"></a></h3>
    <p>一致性要求通过描述性断言与 RFC 2119 术语的组合来表达。关键词 “MUST”，
        “MUST NOT”， “REQUIRED”， “SHALL”， “SHALL NOT”， “SHOULD”， “SHOULD NOT”，
        “RECOMMENDED”， “MAY”，以及 “OPTIONAL” 在本文档规范性部分中
        应按 RFC 2119 中所述进行解释。
        然而，为了便于阅读，这些词在本规范中并未全部以全大写字母出现。</p>
    <p>除非某些章节被明确标记为非规范性内容、示例和注释之外，本规范的全部文本均为规范性内容。 <a data-link-type="biblio" href="#biblio-rfc2119"
            title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a></p>
    <p>本规范中的示例以 “例如” 等词引入，
        或者使用 <code>class="example"</code> 将其与规范性文本区分开来，
        如下所示：</p>
    <div class="example" id="w3c-example">
        <a class="self-link" href="#w3c-example"></a>
        <p>这是一个资料性示例的示例。</p>
    </div>
    <p>资料性注释以 “注” 一词开头，并使用 <code>class="note"</code> 将其与规范性文本区分开来，
        如下所示：</p>
    <p class="note" role="note">注，这是一条资料性注释。</p>
    <p>提示（Advisements）是以特殊样式呈现、用于引起特别注意的规范性章节，并且
        使用 <code>&lt;strong class="advisement"></code> 将其与其他规范性文本区分开来，例如：
        <strong class="advisement"> 用户代理必须提供一种无障碍替代方案。 </strong>
    </p>
    <details class="wpt-tests-block" dir="ltr" lang="en" open>
        <summary>测试</summary>
        <p>与本规范内容相关的测试
            可以像本块这样记录在 “测试” 区块中。
            任何此类区块均为非规范性内容。</p>
        <ul class="wpt-tests-list"></ul>
        <hr>
    </details>
    <h3 class="no-ref heading settled" id="w3c-conformance-classes"><span class="content"> 一致性类别</span><a
            class="self-link" href="#w3c-conformance-classes"></a></h3>
    <p>对本规范的一致性
        为以下三类一致性类别定义：</p>
    <dl>
        <dt>样式表
        <dd><a href="https://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS
                样式表</a>。
        <dt>渲染器
        <dd>解释样式表语义并渲染使用这些语义的文档的 <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>。
        <dt>创作工具
        <dd>编写样式表的 <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>。
    </dl>
    <p>若某样式表中所有使用本模块定义语法的声明
        都符合通用 CSS 语法以及本模块中每个特性各自的语法，
        则该样式表符合本规范。</p>
    <p>若某渲染器除了按相应规范解释样式表之外，
        还能通过正确解析并相应渲染文档来支持本规范定义的所有特性，
        则该渲染器符合本规范。然而，UA 因设备限制而无法正确渲染文档
        并不会使该 UA 不符合规范。（例如，UA 不要求在单色显示器上渲染颜色。）</p>
    <p>若某创作工具编写的样式表在语法上符合通用 CSS 语法以及本模块中各特性的各自语法，
        并满足本模块所述的样式表的所有其他一致性要求，
        则该创作工具符合本规范。</p>
    <h3 class="no-ref heading settled" id="w3c-partial"><span class="content"> 部分实现</span><a class="self-link"
            href="#w3c-partial"></a></h3>
    <p>为了使作者能够利用前向兼容的解析规则来指定回退值，
        CSS 渲染器 <strong>必须</strong> 将其不具备可用支持级别的任何 at 规则、属性、属性值、关键字
        以及其他语法结构视为无效（并 <a href="https://www.w3.org/TR/CSS21/conform.html#ignore">按需忽略</a>）。
        尤其是，用户代理 <strong>不得</strong> 在单个多值属性声明中选择性忽略不支持的组件值而对支持的值予以认可：
        若任一值被视为无效（不支持的值必须如此），CSS 要求忽略整条声明。</p>
    <h4 class="heading settled" id="w3c-conform-future-proofing"><span class="content">不稳定与专有特性的实现</span><a
            class="self-link" href="#w3c-conform-future-proofing"></a></h4>
    <p>为避免与未来稳定的 CSS 特性发生冲突，
        CSSWG 建议在实现 <a href="https://www.w3.org/TR/CSS/#unstable">不稳定</a> 特性以及 CSS 的 <a
            href="https://www.w3.org/TR/CSS/#proprietary-extension">专有扩展</a> 时 <a
            href="https://www.w3.org/TR/CSS/#future-proofing">遵循最佳实践</a>。</p>
    <h3 class="no-ref heading settled" id="w3c-testing"><span class="content"> 非试验性实现</span><a class="self-link"
            href="#w3c-testing"></a></h3>
    <p>当某规范达到候选推荐（Candidate Recommendation）阶段后，
        就可能出现非试验性实现，且实现者应发布其能够证明已按规范正确实现的任何 CR 级特性的无前缀实现。</p>
    <p>为建立并维持 CSS 在不同实现之间的互操作性，
        CSS 工作组请求非试验性的 CSS 渲染器在发布任何 CSS 特性的无前缀实现之前，
        向 W3C 提交实现报告（以及在必要时，用于该实现报告的测试用例）。
        提交给 W3C 的测试用例将由 CSS 工作组进行审查与修正。</p>
    <p>关于提交测试用例与实现报告的更多信息
        可在 CSS 工作组网站 <a href="https://www.w3.org/Style/CSS/Test/">https://www.w3.org/Style/CSS/Test/</a> 上找到。
        问题应发送至 <a href="https://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a> 邮件列表。
    </p>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本规范定义的术语</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#selectordef-column">||</a><span>，在 § 8.1</span>
        <li><a href="#blank-pseudo">:blank</a><span>，在 § 4.1.1</span>
        <li><a href="#column-combinator">column combinator</a><span>，在 § 8.1</span>
        <li><a href="#current-pseudo">:current</a><span>，在 § 5.1</span>
        <li><a href="#selectordef-current">:current()</a><span>，在 § 5.1</span>
        <li><a href="#future-pseudo">:future</a><span>，在 § 5.3</span>
        <li><a href="#heading-pseudo">:heading</a><span>，在 § 7</span>
        <li><a href="#heading-functional-pseudo">:heading()</a><span>，在 § 7</span>
        <li><a href="#selectordef-interest-source">:interest-source</a><span>，在 § 3.1</span>
        <li><a href="#interest-source">interest source</a><span>，在 § 3.1</span>
        <li><a href="#selectordef-interest-target">:interest-target</a><span>，在 § 3.1</span>
        <li><a href="#interest-target">interest target</a><span>，在 § 3.1</span>
        <li><a href="#typedef-level">&lt;level></a><span>，在 § 7</span>
        <li><a href="#local-link-pseudo">:local-link</a><span>，在 § 2.1</span>
        <li><a href="#nth-col-pseudo">:nth-col()</a><span>，在 § 8.2</span>
        <li><a href="#nth-last-col-pseudo">:nth-last-col()</a><span>，在 § 8.3</span>
        <li><a href="#past-pseudo">:past</a><span>，在 § 5.2</span>
        <li><a href="#reference-combinator">reference combinator</a><span>，在 § 9.1</span>
        <li><a href="#state-pseudo">:state( &lt;ident> )</a><span>，在 § 6</span>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">通过引用定义的术语</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[CSS-VALUES-4]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="c297b070">#</span>
                <li><span class="dfn-paneled" id="dcecfc13">&lt;ident></span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS2]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="05a372b0">type selector</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS3SYN]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="eebbfe3d">&lt;number-token></span>
            </ul>
        <li>
            <a data-link-type="biblio">[HTML]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="b6fb7a51">custom element</span>
                <li><span class="dfn-paneled" id="b87923a3">heading level</span>
                <li><span class="dfn-paneled" id="d7d642a2">input</span>
                <li><span class="dfn-paneled" id="f4da6587">popover</span>
                <li><span class="dfn-paneled" id="141caf46">states set</span>
            </ul>
        <li>
            <a data-link-type="biblio">[INFRA]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="7a87d819">is</span>
            </ul>
        <li>
            <a data-link-type="biblio">[SELECTORS-4]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="31c47bc6">compound selector</span>
                <li><span class="dfn-paneled" id="41bf002c">ID selector</span>
                <li><span class="dfn-paneled" id="388bc3fc">selector</span>
                <li><span class="dfn-paneled" id="ba72ce8f">specificity</span>
            </ul>
        <li>
            <a data-link-type="biblio">[WAI-ARIA-1.2]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="f00338b8">host language</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">规范性参考文献</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-css-values-4">[CSS-VALUES-4]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-4/"><cite>CSS Values and Units
                    Module Level 4</cite></a>. 12 March 2024. WD. URL: <a
                href="https://www.w3.org/TR/css-values-4/">https://www.w3.org/TR/css-values-4/</a>
        <dt id="biblio-css3syn">[CSS3SYN]
        <dd>Tab Atkins Jr.; Simon Sapin. <a href="https://www.w3.org/TR/css-syntax-3/"><cite>CSS Syntax Module Level
                    3</cite></a>. 24 December 2021. CRD. URL: <a
                href="https://www.w3.org/TR/css-syntax-3/">https://www.w3.org/TR/css-syntax-3/</a>
        <dt id="biblio-html">[HTML]
        <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>.
            Living Standard. URL: <a
                href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        <dt id="biblio-infra">[INFRA]
        <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra
                    Standard</cite></a>. Living Standard. URL: <a
                href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
        <dt id="biblio-rfc2119">[RFC2119]
        <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to
                    Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a
                href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
        <dt id="biblio-selectors-4">[SELECTORS-4]
        <dd>Elika Etemad; Tab Atkins Jr.. <a href="https://www.w3.org/TR/selectors-4/"><cite>Selectors Level
                    4</cite></a>. 22 January 2026. WD. URL: <a
                href="https://www.w3.org/TR/selectors-4/">https://www.w3.org/TR/selectors-4/</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">资料性参考文献</span><a class="self-link"
            href="#informative"></a></h3>
    <dl>
        <dt id="biblio-css2">[CSS2]
        <dd>Bert Bos; et al. <a href="https://www.w3.org/TR/CSS2/"><cite>Cascading Style Sheets Level 2 Revision 1 (CSS
                    2.1) Specification</cite></a>. 7 June 2011. REC. URL: <a
                href="https://www.w3.org/TR/CSS2/">https://www.w3.org/TR/CSS2/</a>
        <dt id="biblio-html5">[HTML5]
        <dd>Ian Hickson; et al. <a href="https://www.w3.org/TR/html5/"><cite>HTML5</cite></a>. 27 March 2018. REC. URL:
            <a href="https://www.w3.org/TR/html5/">https://www.w3.org/TR/html5/</a>
        <dt id="biblio-wai-aria-12">[WAI-ARIA-1.2]
        <dd>Joanmarie Diggs; et al. <a href="https://www.w3.org/TR/wai-aria-1.2/"><cite>Accessible Rich Internet
                    Applications (WAI-ARIA) 1.2</cite></a>. 6 June 2023. REC. URL: <a
                href="https://www.w3.org/TR/wai-aria-1.2/">https://www.w3.org/TR/wai-aria-1.2/</a>
    </dl>
    <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">问题索引</span><a class="self-link"
            href="#issues-index"></a></h2>
    <div style="counter-reset:issue">
        <div class="issue"> <strong>这是相对于 <a href="https://www.w3.org/TR/selectors-4/">选择器 第 4 级</a> 的差异规范。</strong> <a
                class="issue-return" href="#issue-edc8dd61" title="Jump to section">↵</a>
        </div>
        <div class="issue"> 很明显，如果文档 URL 至少有 N 个片段，
            那么 <span class="css">:local-link(N)</span> 只会匹配 URL 至少有 N 个片段的链接。
            （这让你可以为 :local-link 赋予一致的语义，例如，:local-link(2) 在 GitHub 上表示“仓库内”链接。）
            但如果文档 URL 的片段数少于 N，
            且链接是同页链接呢？
            “空片段（null segments）”应该算作匹配，还是不算？ <a class="issue-return" href="#issue-dd3371ba"
                title="Jump to section">↵</a></div>
    </div>
    <script>/* Boilerplate: script-dom-helper */
        "use strict";
        function query(sel) { return document.querySelector(sel); }

        function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

        function iter(obj) {
            if (!obj) return [];
            var it = obj[Symbol.iterator];
            if (it) return it;
            return Object.entries(obj);
        }

        function mk(tagname, attrs, ...children) {
            const el = document.createElement(tagname);
            for (const [k, v] of iter(attrs)) {
                if (k.slice(0, 3) == "_on") {
                    const eventName = k.slice(3);
                    el.addEventListener(eventName, v);
                } else if (k[0] == "_") {
                    // property, not attribute
                    el[k.slice(1)] = v;
                } else {
                    if (v === false || v == null) {
                        continue;
                    } else if (v === true) {
                        el.setAttribute(k, "");
                        continue;
                    } else {
                        el.setAttribute(k, v);
                    }
                }
            }
            append(el, children);
            return el;
        }

        /* Create shortcuts for every known HTML element */
        [
            "a",
            "abbr",
            "acronym",
            "address",
            "applet",
            "area",
            "article",
            "aside",
            "audio",
            "b",
            "base",
            "basefont",
            "bdo",
            "big",
            "blockquote",
            "body",
            "br",
            "button",
            "canvas",
            "caption",
            "center",
            "cite",
            "code",
            "col",
            "colgroup",
            "datalist",
            "dd",
            "del",
            "details",
            "dfn",
            "dialog",
            "div",
            "dl",
            "dt",
            "em",
            "embed",
            "fieldset",
            "figcaption",
            "figure",
            "font",
            "footer",
            "form",
            "frame",
            "frameset",
            "head",
            "header",
            "h1",
            "h2",
            "h3",
            "h4",
            "h5",
            "h6",
            "hr",
            "html",
            "i",
            "iframe",
            "img",
            "input",
            "ins",
            "kbd",
            "label",
            "legend",
            "li",
            "link",
            "main",
            "map",
            "mark",
            "meta",
            "meter",
            "nav",
            "nobr",
            "noscript",
            "object",
            "ol",
            "optgroup",
            "option",
            "output",
            "p",
            "param",
            "pre",
            "progress",
            "q",
            "s",
            "samp",
            "script",
            "section",
            "select",
            "small",
            "source",
            "span",
            "strike",
            "strong",
            "style",
            "sub",
            "summary",
            "sup",
            "table",
            "tbody",
            "td",
            "template",
            "textarea",
            "tfoot",
            "th",
            "thead",
            "time",
            "title",
            "tr",
            "u",
            "ul",
            "var",
            "video",
            "wbr",
            "xmp",
        ].forEach(tagname => {
            mk[tagname] = (...args) => mk(tagname, ...args);
        });

        function* nodesFromChildList(children) {
            for (const child of children.flat(Infinity)) {
                if (child instanceof Node) {
                    yield child;
                } else {
                    yield new Text(child);
                }
            }
        }
        function append(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                if (el instanceof Node) el.appendChild(child);
                else el.push(child);
            }
            return el;
        }

        function insertAfter(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                el.parentNode.insertBefore(child, el.nextSibling);
            }
            return el;
        }

        function clearContents(el) {
            el.innerHTML = "";
            return el;
        }

        function parseHTML(markup) {
            if (markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
                const doc = document.implementation.createHTMLDocument("");
                doc.documentElement.innerHTML = markup;
                return doc;
            } else {
                const el = mk.template({});
                el.innerHTML = markup;
                return el.content;
            }
        }</script>
    <script>/* Boilerplate: script-dfn-panel */
        "use strict";
        {
            let dfnPanelData = {
                "05a372b0": { "dfnID": "05a372b0", "dfnText": "type selector", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-x11" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }], "url": "https://www.w3.org/TR/CSS2/selector.html#x11" },
                "141caf46": { "dfnID": "141caf46", "dfnText": "states set", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-states-set" }, { "id": "ref-for-states-set\u2460" }], "title": "6. \nExposing custom state: the :state() pseudo-class" }], "url": "https://html.spec.whatwg.org/multipage/custom-elements.html#states-set" },
                "31c47bc6": { "dfnID": "31c47bc6", "dfnText": "compound selector", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-compound" }], "title": "5.1. \nThe Current-element Pseudo-class: :current" }, { "refs": [{ "id": "ref-for-compound\u2460" }, { "id": "ref-for-compound\u2461" }, { "id": "ref-for-compound\u2462" }], "title": "9.1. \nReference combinators /ref/" }], "url": "https://www.w3.org/TR/selectors-4/#compound" },
                "388bc3fc": { "dfnID": "388bc3fc", "dfnText": "selector", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-selector" }], "title": "Unnumbered Section" }], "url": "https://www.w3.org/TR/selectors-4/#selector" },
                "41bf002c": { "dfnID": "41bf002c", "dfnText": "ID selector", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-id-selector" }], "title": "9.1. \nReference combinators /ref/" }], "url": "https://www.w3.org/TR/selectors-4/#id-selector" },
                "7a87d819": { "dfnID": "7a87d819", "dfnText": "is", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-string-is" }, { "id": "ref-for-string-is\u2460" }], "title": "6. \nExposing custom state: the :state() pseudo-class" }], "url": "https://infra.spec.whatwg.org/#string-is" },
                "b6fb7a51": { "dfnID": "b6fb7a51", "dfnText": "custom element", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-custom-element" }], "title": "6. \nExposing custom state: the :state() pseudo-class" }], "url": "https://html.spec.whatwg.org/multipage/custom-elements.html#custom-element" },
                "b87923a3": { "dfnID": "b87923a3", "dfnText": "heading level", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-heading-level" }, { "id": "ref-for-heading-level\u2460" }, { "id": "ref-for-heading-level\u2461" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }], "url": "https://html.spec.whatwg.org/multipage/sections.html#heading-level" },
                "ba72ce8f": { "dfnID": "ba72ce8f", "dfnText": "specificity", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-specificity" }, { "id": "ref-for-specificity\u2460" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }], "url": "https://www.w3.org/TR/selectors-4/#specificity" },
                "blank-pseudo": { "dfnID": "blank-pseudo", "dfnText": ":blank", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-blank-pseudo" }, { "id": "ref-for-blank-pseudo\u2460" }, { "id": "ref-for-blank-pseudo\u2461" }, { "id": "ref-for-blank-pseudo\u2462" }, { "id": "ref-for-blank-pseudo\u2463" }, { "id": "ref-for-blank-pseudo\u2464" }, { "id": "ref-for-blank-pseudo\u2465" }], "title": "4.1.1. \nThe Empty-Value Pseudo-class: :blank" }, { "refs": [{ "id": "ref-for-blank-pseudo\u2466" }], "title": "10.1. \nChanges Since Level 4" }], "url": "#blank-pseudo" },
                "c297b070": { "dfnID": "c297b070", "dfnText": "#", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-comma" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }], "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
                "column-combinator": { "dfnID": "column-combinator", "dfnText": "column combinator", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-column-combinator" }], "title": "8. \nGrid-Structural Selectors" }], "url": "#column-combinator" },
                "current-pseudo": { "dfnID": "current-pseudo", "dfnText": ":current", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-current-pseudo" }, { "id": "ref-for-current-pseudo\u2460" }, { "id": "ref-for-current-pseudo\u2461" }], "title": "5. \nTime-dimensional Pseudo-classes" }, { "refs": [{ "id": "ref-for-current-pseudo\u2462" }, { "id": "ref-for-current-pseudo\u2463" }, { "id": "ref-for-current-pseudo\u2464" }, { "id": "ref-for-current-pseudo\u2465" }], "title": "5.1. \nThe Current-element Pseudo-class: :current" }, { "refs": [{ "id": "ref-for-current-pseudo\u2466" }, { "id": "ref-for-current-pseudo\u2467" }], "title": "5.2. \nThe Past-element Pseudo-class: :past" }, { "refs": [{ "id": "ref-for-current-pseudo\u2468" }, { "id": "ref-for-current-pseudo\u2460\u24ea" }], "title": "5.3. \nThe Future-element Pseudo-class: :future" }], "url": "#current-pseudo" },
                "d7d642a2": { "dfnID": "d7d642a2", "dfnText": "input", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-the-input-element" }], "title": "9.1. \nReference combinators /ref/" }], "url": "https://html.spec.whatwg.org/multipage/input.html#the-input-element" },
                "dcecfc13": { "dfnID": "dcecfc13", "dfnText": "<ident>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-ident" }], "title": "6. \nExposing custom state: the :state() pseudo-class" }], "url": "https://www.w3.org/TR/css-values-4/#typedef-ident" },
                "eebbfe3d": { "dfnID": "eebbfe3d", "dfnText": "<number-token>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-number-token" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }], "url": "https://www.w3.org/TR/css-syntax-3/#typedef-number-token" },
                "f00338b8": { "dfnID": "f00338b8", "dfnText": "host language", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dfn-host-language" }], "title": "3.1. \nThe Interest Pseudo-classes: :interest-source and :interest-target" }], "url": "https://w3c.github.io/aria/#dfn-host-language" },
                "f4da6587": { "dfnID": "f4da6587", "dfnText": "popover", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-attr-popover" }], "title": "3.1. \nThe Interest Pseudo-classes: :interest-source and :interest-target" }], "url": "https://html.spec.whatwg.org/multipage/popover.html#attr-popover" },
                "future-pseudo": { "dfnID": "future-pseudo", "dfnText": ":future", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-future-pseudo" }, { "id": "ref-for-future-pseudo\u2460" }, { "id": "ref-for-future-pseudo\u2461" }], "title": "5. \nTime-dimensional Pseudo-classes" }, { "refs": [{ "id": "ref-for-future-pseudo\u2462" }, { "id": "ref-for-future-pseudo\u2463" }], "title": "5.3. \nThe Future-element Pseudo-class: :future" }], "url": "#future-pseudo" },
                "heading-functional-pseudo": { "dfnID": "heading-functional-pseudo", "dfnText": ":heading()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-heading-functional-pseudo" }, { "id": "ref-for-heading-functional-pseudo\u2460" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }, { "refs": [{ "id": "ref-for-heading-functional-pseudo\u2461" }], "title": "10.1. \nChanges Since Level 4" }], "url": "#heading-functional-pseudo" },
                "heading-pseudo": { "dfnID": "heading-pseudo", "dfnText": ":heading", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-heading-pseudo" }, { "id": "ref-for-heading-pseudo\u2460" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }, { "refs": [{ "id": "ref-for-heading-pseudo\u2461" }], "title": "10.1. \nChanges Since Level 4" }], "url": "#heading-pseudo" },
                "interest-source": { "dfnID": "interest-source", "dfnText": "interest source", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-interest-source" }, { "id": "ref-for-interest-source\u2460" }, { "id": "ref-for-interest-source\u2461" }, { "id": "ref-for-interest-source\u2462" }], "title": "3.1. \nThe Interest Pseudo-classes: :interest-source and :interest-target" }], "url": "#interest-source" },
                "interest-target": { "dfnID": "interest-target", "dfnText": "interest target", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-interest-target" }, { "id": "ref-for-interest-target\u2460" }, { "id": "ref-for-interest-target\u2461" }, { "id": "ref-for-interest-target\u2462" }], "title": "3.1. \nThe Interest Pseudo-classes: :interest-source and :interest-target" }], "url": "#interest-target" },
                "local-link-pseudo": { "dfnID": "local-link-pseudo", "dfnText": ":local-link", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-local-link-pseudo" }, { "id": "ref-for-local-link-pseudo\u2460" }], "title": "2.1. \nThe Local Link Pseudo-class :local-link" }, { "refs": [{ "id": "ref-for-local-link-pseudo\u2461" }, { "id": "ref-for-local-link-pseudo\u2462" }], "title": "10.1. \nChanges Since Level 4" }], "url": "#local-link-pseudo" },
                "nth-col-pseudo": { "dfnID": "nth-col-pseudo", "dfnText": ":nth-col(An+B)", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-nth-col-pseudo" }], "title": "8. \nGrid-Structural Selectors" }, { "refs": [{ "id": "ref-for-nth-col-pseudo\u2460" }], "title": "8.2. \n:nth-col() pseudo-class" }], "url": "#nth-col-pseudo" },
                "nth-last-col-pseudo": { "dfnID": "nth-last-col-pseudo", "dfnText": ":nth-last-col(An+B)", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-nth-last-col-pseudo" }], "title": "8. \nGrid-Structural Selectors" }, { "refs": [{ "id": "ref-for-nth-last-col-pseudo\u2460" }], "title": "8.3. \n:nth-last-col() pseudo-class" }], "url": "#nth-last-col-pseudo" },
                "past-pseudo": { "dfnID": "past-pseudo", "dfnText": ":past", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-past-pseudo" }, { "id": "ref-for-past-pseudo\u2460" }, { "id": "ref-for-past-pseudo\u2461" }], "title": "5. \nTime-dimensional Pseudo-classes" }, { "refs": [{ "id": "ref-for-past-pseudo\u2462" }, { "id": "ref-for-past-pseudo\u2463" }], "title": "5.2. \nThe Past-element Pseudo-class: :past" }], "url": "#past-pseudo" },
                "reference-combinator": { "dfnID": "reference-combinator", "dfnText": "reference combinator", "external": false, "refSections": [], "url": "#reference-combinator" },
                "selectordef-column": { "dfnID": "selectordef-column", "dfnText": "||", "external": false, "refSections": [], "url": "#selectordef-column" },
                "selectordef-current": { "dfnID": "selectordef-current", "dfnText": ":current()", "external": false, "refSections": [], "url": "#selectordef-current" },
                "selectordef-interest-source": { "dfnID": "selectordef-interest-source", "dfnText": ":interest-source", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-selectordef-interest-source" }, { "id": "ref-for-selectordef-interest-source\u2460" }, { "id": "ref-for-selectordef-interest-source\u2461" }], "title": "3.1. \nThe Interest Pseudo-classes: :interest-source and :interest-target" }, { "refs": [{ "id": "ref-for-selectordef-interest-source\u2462" }], "title": "10.1. \nChanges Since Level 4" }], "url": "#selectordef-interest-source" },
                "selectordef-interest-target": { "dfnID": "selectordef-interest-target", "dfnText": ":interest-target", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-selectordef-interest-target" }, { "id": "ref-for-selectordef-interest-target\u2460" }], "title": "3.1. \nThe Interest Pseudo-classes: :interest-source and :interest-target" }, { "refs": [{ "id": "ref-for-selectordef-interest-target\u2461" }], "title": "10.1. \nChanges Since Level 4" }], "url": "#selectordef-interest-target" },
                "state-pseudo": { "dfnID": "state-pseudo", "dfnText": ":state( <ident> )", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-state-pseudo" }, { "id": "ref-for-state-pseudo\u2460" }], "title": "6. \nExposing custom state: the :state() pseudo-class" }, { "refs": [{ "id": "ref-for-state-pseudo\u2461" }], "title": "10.1. \nChanges Since Level 4" }], "url": "#state-pseudo" },
                "typedef-level": { "dfnID": "typedef-level", "dfnText": "<level>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-level" }], "title": "7. \nHeading Structures: the heading pseudo-classes :heading, and :heading()" }], "url": "#typedef-level" },
            };

            document.addEventListener("DOMContentLoaded", () => {
                genAllDfnPanels();

                document.body.addEventListener("click", (e) => {
                    // If not handled already, just hide all dfn panels.
                    hideAllDfnPanels();
                });
            });

            window.addEventListener("resize", () => {
                // Pin any visible dfn panel
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => positionDfnPanel(el));
            });

            function genAllDfnPanels() {
                for (const panelData of Object.values(dfnPanelData)) {
                    const dfnID = panelData.dfnID;
                    const dfn = document.getElementById(dfnID);
                    if (!dfn) {
                        console.log(`Can't find dfn#${dfnID}.`, panelData);
                        continue;
                    }
                    dfn.panelData = panelData;
                    insertDfnPopupAction(dfn);
                }
            }

            function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
                const dfnPanel = mk.aside({
                    class: "dfn-panel on",
                    id: `infopanel-for-${dfnID}`,
                    "data-for": dfnID,
                    "aria-labelled-by": `infopaneltitle-for-${dfnID}`,
                },
                    mk.span({ id: `infopaneltitle-for-${dfnID}`, style: "display:none" },
                        `Info about the '${dfnText}' ${external ? "external" : ""} reference.`),
                    mk.a({ href: url, class: "dfn-link" }, url),
                    refSections.length == 0 ? [] :
                        mk.b({}, "Referenced in:"),
                    mk.ul({},
                        ...refSections.map(section =>
                            mk.li({},
                                ...section.refs.map((ref, refI) =>
                                    [
                                        mk.a({ href: `#${ref.id}` },
                                            (refI == 0) ? section.title : `(${refI + 1})`
                                        ),
                                        " ",
                                    ]
                                ),
                            ),
                        ),
                    ),
                    genLinkingSyntaxes(dfn),
                );

                dfnPanel.addEventListener('click', (event) => {
                    if (event.target.nodeName == 'A') {
                        scrollToTargetAndHighlight(event);
                        pinDfnPanel(dfnPanel);
                    }
                    event.stopPropagation();
                    refocusOnTarget(event);
                });
                dfnPanel.addEventListener('keydown', (event) => {
                    if (event.keyCode == 27) { // Escape key
                        hideDfnPanel({ dfnPanel });
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });

                dfnPanel.dfn = dfn;
                dfn.dfnPanel = dfnPanel;
                return dfnPanel;
            }



            function hideAllDfnPanels() {
                // Delete the currently-active dfn panel.
                queryAll(".dfn-panel").forEach(dfnPanel => hideDfnPanel({ dfnPanel }));
            }

            function showDfnPanel(dfn) {
                hideAllDfnPanels(); // Only display one at a time.

                dfn.setAttribute("aria-expanded", "true");

                const dfnPanel = genDfnPanel(dfn, dfn.panelData);

                // Give the dfn a unique tabindex, and then
                // give all the tabbable panel bits successive indexes.
                let tabIndex = 100;
                dfn.tabIndex = tabIndex++;
                const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
                for (const el of tabbable) {
                    el.tabIndex = tabIndex++;
                }

                append(document.body, dfnPanel);
                positionDfnPanel(dfnPanel);
            }

            function positionDfnPanel(dfnPanel) {
                const dfn = dfnPanel.dfn;
                const dfnPos = getBounds(dfn);
                dfnPanel.style.top = dfnPos.bottom + "px";
                dfnPanel.style.left = dfnPos.left + "px";

                const panelPos = dfnPanel.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
                    dfnPanel.style.left = newLeft + "px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.position = "fixed";
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel({ dfn, dfnPanel }) {
                if (!dfnPanel) dfnPanel = dfn.dfnPanel;
                if (!dfn) dfn = dfnPanel.dfn;
                dfn.dfnPanel = undefined;
                dfnPanel.dfn = undefined;
                dfn.setAttribute("aria-expanded", "false");
                dfn.tabIndex = undefined;
                dfnPanel.remove()
            }

            function toggleDfnPanel(dfn) {
                if (dfn.dfnPanel) {
                    hideDfnPanel(dfn);
                } else {
                    showDfnPanel(dfn);
                }
            }

            function insertDfnPopupAction(dfn) {
                dfn.setAttribute('role', 'button');
                dfn.setAttribute('aria-expanded', 'false')
                dfn.tabIndex = 0;
                dfn.classList.add('has-dfn-panel');
                dfn.addEventListener('click', (event) => {
                    toggleDfnPanel(dfn);
                    event.stopPropagation();
                });
                dfn.addEventListener('keypress', (event) => {
                    const kc = event.keyCode;
                    // 32->Space, 13->Enter
                    if (kc == 32 || kc == 13) {
                        toggleDfnPanel(dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });
            }

            function refocusOnTarget(event) {
                const target = event.target;
                setTimeout(() => {
                    // Refocus on the event.target element.
                    // This is needed after browser scrolls to the destination.
                    target.focus();
                });
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function scrollToTargetAndHighlight(event) {
                let hash = event.target.hash;
                if (hash) {
                    hash = decodeURIComponent(hash.substring(1));
                    const dest = document.getElementById(hash);
                    if (dest) {
                        dest.classList.add('highlighted');
                        setTimeout(() => dest.classList.remove('highlighted'), 1000);
                    }
                }
            }

            // Functions, divided by link type, that wrap an autolink's
            // contents with the appropriate outer syntax.
            // Alternately, a string naming another type they format
            // the same as.
            function needsFor(type) {
                switch (type) {
                    case "descriptor":
                    case "value":
                    case "element-attr":
                    case "attr-value":
                    case "element-state":
                    case "method":
                    case "constructor":
                    case "argument":
                    case "attribute":
                    case "const":
                    case "dict-member":
                    case "event":
                    case "enum-value":
                    case "stringifier":
                    case "serializer":
                    case "iterator":
                    case "maplike":
                    case "setlike":
                    case "state":
                    case "mode":
                    case "context":
                    case "facet": return true;

                    default: return false;
                }
            }
            function refusesFor(type) {
                switch (type) {
                    case "property":
                    case "element":
                    case "interface":
                    case "namespace":
                    case "callback":
                    case "dictionary":
                    case "enum":
                    case "exception":
                    case "typedef":
                    case "http-header":
                    case "permission": return true;

                    default: return false;
                }
            }
            function linkFormatterFromType(type) {
                switch (type) {
                    case 'scheme':
                    case 'permission':
                    case 'dfn': return (text) => `[=${text}=]`;

                    case 'abstract-op': return (text) => `[\$${text}\$]`;

                    case 'function':
                    case 'at-rule':
                    case 'selector':
                    case 'value': return (text) => `''${text}''`;

                    case 'http-header': return (text) => `[:${text}:]`;

                    case 'interface':
                    case 'constructor':
                    case 'method':
                    case 'argument':
                    case 'attribute':
                    case 'callback':
                    case 'dictionary':
                    case 'dict-member':
                    case 'enum':
                    case 'enum-value':
                    case 'exception':
                    case 'const':
                    case 'typedef':
                    case 'stringifier':
                    case 'serializer':
                    case 'iterator':
                    case 'maplike':
                    case 'setlike':
                    case 'extended-attribute':
                    case 'event':
                    case 'idl': return (text) => `{{${text}}}`;

                    case 'element-state':
                    case 'element-attr':
                    case 'attr-value':
                    case 'element': return (element) => `<{${element}}>`;

                    case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

                    case 'type': return (text) => `<<${text}>>`;

                    case 'descriptor':
                    case 'property': return (text) => `'${text}'`;

                    default: return;
                };
            };

            function genLinkingSyntaxes(dfn) {
                if (dfn.tagName != "DFN") return;

                const type = dfn.getAttribute('data-dfn-type');
                if (!type) {
                    console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
                    return [];
                }

                // Return a function that wraps link text based on the type
                const linkFormatter = linkFormatterFromType(type);
                if (!linkFormatter) {
                    console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
                    return [];
                }

                let ltAlts;
                if (dfn.hasAttribute('data-lt')) {
                    ltAlts = dfn.getAttribute('data-lt')
                        .split("|")
                        .map(x => x.trim());
                } else {
                    ltAlts = [dfn.textContent.trim()];
                }
                if (type == "type") {
                    // lt of "<foo>", but "foo" is the interior;
                    // <<foo/bar>> is how you write it with a for,
                    // not <foo/<bar>> or whatever.
                    for (var i = 0; i < ltAlts.length; i++) {
                        const lt = ltAlts[i];
                        const match = /<(.*)>/.exec(lt);
                        if (match) { ltAlts[i] = match[1]; }
                    }
                }

                let forAlts;
                if (dfn.hasAttribute('data-dfn-for')) {
                    forAlts = dfn.getAttribute('data-dfn-for')
                        .split(",")
                        .map(x => x.trim());
                } else {
                    forAlts = [''];
                }

                let linkingSyntaxes = [];
                if (!needsFor(type)) {
                    for (const lt of ltAlts) {
                        linkingSyntaxes.push(linkFormatter(lt));
                    }
                }
                if (!refusesFor(type)) {
                    for (const f of forAlts) {
                        linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
                    }
                }
                return [
                    mk.b({}, 'Possible linking syntaxes:'),
                    mk.ul({},
                        ...linkingSyntaxes.map(link => {
                            const copyLink = async () =>
                                await navigator.clipboard.writeText(link);
                            return mk.li({},
                                mk.div({ class: 'link-item' },
                                    mk.button({
                                        class: 'copy-icon', title: 'Copy',
                                        type: 'button',
                                        _onclick: copyLink,
                                        tabindex: 0,
                                    }, mk.span({ class: 'icon' })),
                                    mk.span({}, link)
                                )
                            );
                        })
                    )
                ];
            }
        }
    </script>
    <script>/* Boilerplate: script-ref-hints */
        "use strict";
        {
            let refsData = {
                "#blank-pseudo": { "displayText": ":blank", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":blank", "type": "selector", "url": "#blank-pseudo" },
                "#column-combinator": { "displayText": "column combinator", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": "column combinator", "type": "dfn", "url": "#column-combinator" },
                "#current-pseudo": { "displayText": ":current", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":current", "type": "selector", "url": "#current-pseudo" },
                "#future-pseudo": { "displayText": ":future", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":future", "type": "selector", "url": "#future-pseudo" },
                "#heading-functional-pseudo": { "displayText": ":heading()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":heading()", "type": "selector", "url": "#heading-functional-pseudo" },
                "#heading-pseudo": { "displayText": ":heading", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":heading", "type": "selector", "url": "#heading-pseudo" },
                "#interest-source": { "displayText": "interest source", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": "interest source", "type": "dfn", "url": "#interest-source" },
                "#interest-target": { "displayText": "interest target", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": "interest target", "type": "dfn", "url": "#interest-target" },
                "#local-link-pseudo": { "displayText": ":local-link", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":local-link", "type": "selector", "url": "#local-link-pseudo" },
                "#nth-col-pseudo": { "displayText": ":nth-col()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":nth-col()", "type": "selector", "url": "#nth-col-pseudo" },
                "#nth-last-col-pseudo": { "displayText": ":nth-last-col()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":nth-last-col()", "type": "selector", "url": "#nth-last-col-pseudo" },
                "#past-pseudo": { "displayText": ":past", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":past", "type": "selector", "url": "#past-pseudo" },
                "#selectordef-interest-source": { "displayText": ":interest-source", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":interest-source", "type": "selector", "url": "#selectordef-interest-source" },
                "#selectordef-interest-target": { "displayText": ":interest-target", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":interest-target", "type": "selector", "url": "#selectordef-interest-target" },
                "#state-pseudo": { "displayText": ":state( <ident> )", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": ":state( <ident> )", "type": "selector", "url": "#state-pseudo" },
                "#typedef-level": { "displayText": "<level>", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "selectors", "spec": "selectors-5", "status": "local", "text": "<level>", "type": "type", "url": "#typedef-level" },
                "https://html.spec.whatwg.org/multipage/custom-elements.html#custom-element": { "displayText": "custom element", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "custom element", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/custom-elements.html#custom-element" },
                "https://html.spec.whatwg.org/multipage/custom-elements.html#states-set": { "displayText": "states set", "export": false, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "states set", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/custom-elements.html#states-set" },
                "https://html.spec.whatwg.org/multipage/input.html#the-input-element": { "displayText": "input", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "input", "type": "element", "url": "https://html.spec.whatwg.org/multipage/input.html#the-input-element" },
                "https://html.spec.whatwg.org/multipage/popover.html#attr-popover": { "displayText": "popover", "export": true, "for_": ["html-global"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "popover", "type": "element-attr", "url": "https://html.spec.whatwg.org/multipage/popover.html#attr-popover" },
                "https://html.spec.whatwg.org/multipage/sections.html#heading-level": { "displayText": "heading level", "export": false, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "heading level", "type": "dfn", "url": "https://html.spec.whatwg.org/multipage/sections.html#heading-level" },
                "https://infra.spec.whatwg.org/#string-is": { "displayText": "is", "export": true, "for_": ["string"], "level": "1", "normative": true, "shortname": "infra", "spec": "infra", "status": "current", "text": "is", "type": "dfn", "url": "https://infra.spec.whatwg.org/#string-is" },
                "https://w3c.github.io/aria/#dfn-host-language": { "displayText": "host language", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "wai-aria", "spec": "wai-aria-1.2", "status": "current", "text": "host language", "type": "dfn", "url": "https://w3c.github.io/aria/#dfn-host-language" },
                "https://www.w3.org/TR/CSS2/selector.html#x11": { "displayText": "type selector", "export": true, "for_": [], "level": "2", "normative": true, "shortname": "css", "spec": "css2", "status": "snapshot", "text": "type selector", "type": "dfn", "url": "https://www.w3.org/TR/CSS2/selector.html#x11" },
                "https://www.w3.org/TR/css-syntax-3/#typedef-number-token": { "displayText": "<number-token>", "export": true, "for_": [], "level": "3", "normative": true, "shortname": "css-syntax", "spec": "css-syntax-3", "status": "snapshot", "text": "<number-token>", "type": "type", "url": "https://www.w3.org/TR/css-syntax-3/#typedef-number-token" },
                "https://www.w3.org/TR/css-values-4/#mult-comma": { "displayText": "#", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "#", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
                "https://www.w3.org/TR/css-values-4/#typedef-ident": { "displayText": "<ident>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "<ident>", "type": "type", "url": "https://www.w3.org/TR/css-values-4/#typedef-ident" },
                "https://www.w3.org/TR/selectors-4/#compound": { "displayText": "compound selector", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "selectors", "spec": "selectors-4", "status": "snapshot", "text": "compound selector", "type": "dfn", "url": "https://www.w3.org/TR/selectors-4/#compound" },
                "https://www.w3.org/TR/selectors-4/#id-selector": { "displayText": "ID selector", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "selectors", "spec": "selectors-4", "status": "snapshot", "text": "id selector", "type": "dfn", "url": "https://www.w3.org/TR/selectors-4/#id-selector" },
                "https://www.w3.org/TR/selectors-4/#selector": { "displayText": "selector", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "selectors", "spec": "selectors-4", "status": "snapshot", "text": "selector", "type": "dfn", "url": "https://www.w3.org/TR/selectors-4/#selector" },
                "https://www.w3.org/TR/selectors-4/#specificity": { "displayText": "specificity", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "selectors", "spec": "selectors-4", "status": "snapshot", "text": "specificity", "type": "dfn", "url": "https://www.w3.org/TR/selectors-4/#specificity" },
            };

            function mkRefHint(link, ref) {
                const linkText = link.textContent;
                let dfnTextElements = '';
                if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
                    // Give the original term if it's being displayed in a different way.
                    // But allow casing differences, they're insignificant.
                    dfnTextElements =
                        mk.li({},
                            mk.b({}, "Term: "),
                            mk.span({}, ref.displayText)
                        );
                }
                const forList = ref.for_;
                let forListElements;
                if (forList.length == 0) {
                    forListElements = [];
                } else if (forList.length == 1) {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.span({}, forList[0]),
                    );
                } else {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.ul({},
                            ...forList.map(forItem =>
                                mk.li({},
                                    mk.span({}, forItem)
                                ),
                            ),
                        ),
                    );
                }
                const url = ref.url;
                const safeUrl = encodeURIComponent(url);
                const hintPanel = mk.aside({
                    class: "ref-hint",
                    id: `ref-hint-for-${safeUrl}`,
                    "data-for": url,
                    "aria-labelled-by": `ref-hint-for-${safeUrl}`,
                },
                    mk.ul({},
                        dfnTextElements,
                        mk.li({},
                            mk.b({}, "URL: "),
                            mk.a({ href: url, class: "ref" }, url),
                        ),
                        mk.li({},
                            mk.b({}, "Type: "),
                            mk.span({}, `${ref.type}`),
                        ),
                        mk.li({},
                            mk.b({}, "Spec: "),
                            mk.span({}, `${ref.spec ? ref.spec : ''}`),
                        ),
                        forListElements
                    ),
                );
                hintPanel.forLink = link;
                setupRefHintEventListeners(link, hintPanel);
                return hintPanel;
            }

            function hideAllRefHints() {
                queryAll(".ref-hint").forEach(el => hideRefHint(el));
            }

            function hideRefHint(refHint) {
                const link = refHint.forLink;
                link.setAttribute("aria-expanded", "false");
                if (refHint.teardownEventListeners) {
                    refHint.teardownEventListeners();
                }
                refHint.remove();
            }

            function showRefHint(link) {
                if (link.classList.contains("dfn-link")) return;
                const url = link.getAttribute("href");
                const refHintKey = link.getAttribute("data-refhint-key");
                let key = url;
                if (refHintKey) {
                    key = refHintKey + "_" + url;
                }
                const ref = refsData[key];
                if (!ref) return;

                hideAllRefHints(); // Only display one at this time.

                const refHint = mkRefHint(link, ref);
                append(document.body, refHint);
                link.setAttribute("aria-expanded", "true");
                positionRefHint(refHint);
            }

            function setupRefHintEventListeners(link, refHint) {
                if (refHint.teardownEventListeners) return;
                // Add event handlers to hide the refHint after the user moves away
                // from both the link and refHint, if not hovering either within one second.
                let timeout = null;
                const startHidingRefHint = (event) => {
                    if (timeout) {
                        clearTimeout(timeout);
                    }
                    timeout = setTimeout(() => {
                        hideRefHint(refHint);
                    }, 1000);
                }
                const resetHidingRefHint = (event) => {
                    if (timeout) clearTimeout(timeout);
                    timeout = null;
                };
                link.addEventListener("mouseleave", startHidingRefHint);
                link.addEventListener("mouseenter", resetHidingRefHint);
                link.addEventListener("blur", startHidingRefHint);
                link.addEventListener("focus", resetHidingRefHint);
                refHint.addEventListener("mouseleave", startHidingRefHint);
                refHint.addEventListener("mouseenter", resetHidingRefHint);
                refHint.addEventListener("blur", startHidingRefHint);
                refHint.addEventListener("focus", resetHidingRefHint);

                refHint.teardownEventListeners = () => {
                    // remove event listeners
                    resetHidingRefHint();
                    link.removeEventListener("mouseleave", startHidingRefHint);
                    link.removeEventListener("mouseenter", resetHidingRefHint);
                    link.removeEventListener("blur", startHidingRefHint);
                    link.removeEventListener("focus", resetHidingRefHint);
                    refHint.removeEventListener("mouseleave", startHidingRefHint);
                    refHint.removeEventListener("mouseenter", resetHidingRefHint);
                    refHint.removeEventListener("blur", startHidingRefHint);
                    refHint.removeEventListener("focus", resetHidingRefHint);
                };
            }

            function positionRefHint(refHint) {
                const link = refHint.forLink;
                const linkPos = getBounds(link);
                refHint.style.top = linkPos.bottom + "px";
                refHint.style.left = linkPos.left + "px";

                const panelPos = refHint.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
                    refHint.style.left = newLeft + "px";
                }
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function showRefHintListener(e) {
                // If the target isn't in a link (or is a link),
                // just ignore it.
                let link = e.target.closest("a");
                if (!link) return;

                // If the target is in a ref-hint panel
                // (aka a link in the already-open one),
                // also just ignore it.
                if (link.closest(".ref-hint")) return;

                // Otherwise, show the panel for the link.
                showRefHint(link);
            }

            function hideAllHintsListener(e) {
                // If the click is inside a ref-hint panel, ignore it.
                if (e.target.closest(".ref-hint")) return;
                // Otherwise, close all the current panels.
                hideAllRefHints();
            }

            document.addEventListener("DOMContentLoaded", () => {
                document.body.addEventListener("mousedown", showRefHintListener);
                document.body.addEventListener("focus", showRefHintListener);

                document.body.addEventListener("click", hideAllHintsListener);
            });

            window.addEventListener("resize", () => {
                // Hide any open ref hint.
                hideAllRefHints();
            });
        }
    </script>
    <script>/* Boilerplate: script-wpt */
        "use strict";
        {
            let wptData = {
                "paths": ["/css/css-pseudo/", "/css/selectors/"],
            };

            document.addEventListener("DOMContentLoaded", async () => {
                if (wptData.paths.length == 0) return;

                const runsUrl = "https://wpt.fyi/api/runs?label=master&label=stable&max-count=1&product=chrome&product=firefox&product=safari&product=edge";
                const runs = await (await fetch(runsUrl)).json();

                let testResults = [];
                for (const pathPrefix of wptData.paths) {
                    const pathResults = await (await fetch("https://wpt.fyi/api/search", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            "run_ids": runs.map(x => x.id),
                            "query": { "path": pathPrefix },
                        })
                    })).json();
                    testResults = testResults.concat(pathResults.results);
                }

                const browsers = runs.map(x => ({ name: x.browser_name, version: x.browser_version, passes: 0, total: 0 }));
                const resultsFromPath = new Map(testResults.map(result => {
                    const testPath = result.test;
                    const passes = result.legacy_status.map(x => [x.passes, x.total]);
                    return [testPath, passes];
                }));
                const seenTests = new Set();
                document.querySelectorAll(".wpt-name").forEach(nameEl => {
                    const passData = resultsFromPath.get("/" + nameEl.getAttribute("title"));
                    if (!passData) {
                        console.log("Couldn't find test in results:", nameEl);
                        return
                    }
                    const numTests = passData[0][1];
                    if (numTests > 1) {
                        nameEl.insertAdjacentElement("beforeend",
                            mk.small({}, ` (${numTests} tests)`));
                    }
                    if (passData == undefined) return;
                    const resultsEl = mk.span({ "class": "wpt-results" },
                        ...passData.map((p, i) => mk.span(
                            {
                                "title": `${browsers[i].name} ${p[0]}/${p[1]}`,
                                "class": "wpt-result",
                                "style": `background: conic-gradient(forestgreen ${p[0] / p[1] * 360}deg, darkred 0deg);`,
                            })),
                    );
                    nameEl.insertAdjacentElement("afterend", resultsEl);

                    // Only update the summary pass/total count if we haven't seen this
                    // test before, to support authors listing the same test multiple times
                    // in a spec.
                    if (!seenTests.has(nameEl.getAttribute("title"))) {
                        seenTests.add(nameEl.getAttribute("title"));
                        passData.forEach((p, i) => {
                            browsers[i].passes += p[0];
                            browsers[i].total += p[1];
                        });
                    }
                });
                const overview = document.querySelector(".wpt-overview");
                if (overview) {
                    overview.appendChild(mk.ul({}, ...browsers.map(formatWptResult)));
                    document.head.appendChild(mk.style({},
                        `.wpt-overview ul { display: flex; flex-flow: row wrap; gap: .2em; justify-content: start; list-style: none; padding: 0; margin: 0;}
             .wpt-overview li { padding: .25em 1em; color: black; text-align: center; }
             .wpt-overview img { height: 1.5em; height: max(1.5em, 32px); background: transparent; }
             .wpt-overview .browser { font-weight: bold; }
             .wpt-overview .passes-none { background: #e57373; }
             .wpt-overview .passes-hardly { background: #ffb74d; }
             .wpt-overview .passes-a-few { background: #ffd54f; }
             .wpt-overview .passes-half { background: #fff176; }
             .wpt-overview .passes-lots { background: #dce775; }
             .wpt-overview .passes-most { background: #aed581; }
             .wpt-overview .passes-all { background: #81c784; }`));
                }
            });

            function formatWptResult({ name, version, passes, total }) {
                const passRate = passes / total;
                let passClass = "";
                if (passRate == 0) passClass = "passes-none";
                else if (passRate < .2) passClass = "passes-hardly";
                else if (passRate < .4) passClass = "passes-a-few";
                else if (passRate < .6) passClass = "passes-half";
                else if (passRate < .8) passClass = "passes-lots";
                else if (passRate < 1) passClass = "passes-most";
                else passClass = "passes-all";

                name = name[0].toUpperCase() + name.slice(1);
                const shortVersion = /^\d+/.exec(version);
                const icon = []

                if (name == "Chrome") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/chrome_64x64.png" }));
                if (name == "Edge") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/edge_64x64.png" }));
                if (name == "Safari") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/safari_64x64.png" }));
                if (name == "Firefox") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/firefox_64x64.png" }));

                return mk.li({ "class": passClass },
                    mk.nobr({ 'class': 'browser' }, ...icon, ` ${name} ${shortVersion}`),
                    mk.br(),
                    mk.nobr({ 'class': 'pass-rate' }, `${passes}/${total}`)
                );
            }
        }
    </script>
    <script src="/dropdown.js"></script>