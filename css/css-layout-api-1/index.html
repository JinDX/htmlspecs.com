<!doctype html>
<html lang="zh-hans">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <title>CSS 布局 API 第 1 级</title>
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <meta content="WD" name="w3c-status">
    <link href="default.css" rel="stylesheet" type="text/css">
    <meta content="Bikeshed version 1760a0346ebf3096d8d47b818b15ffcad41e99a0" name="generator">
    <link href="https://www.w3.org/TR/css-layout-api-1/" rel="canonical">
    <style>
        /* Put nice boxes around each algorithm. */
        [data-algorithm]:not(.heading) {
            padding: .5em;
            border: thin solid #ddd;
            border-radius: .5em;
            margin: .5em calc(-0.5em - 1px);
        }

        [data-algorithm]:not(.heading)> :first-child {
            margin-top: 0;
        }

        [data-algorithm]:not(.heading)> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* style-md-lists */

        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* style-selflinks */

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: gray;
            color: white;
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: black;
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <style>
        /* style-counters */

        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* style-autolinks */

        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: #005a9c;
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }
    </style>
    <style>
        /* style-dfn-panel */

        .dfn-panel {
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            width: fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #DDDDDD;
            color: black;
            border: outset 0.2em;
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: black;
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0;
        }

        .dfn-panel li {
            list-style: inside;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled {
            cursor: pointer;
        }
    </style>
    <style>
        /* style-syntax-highlighting */
        pre.idl.highlight {
            color: #708090;
        }

        .highlight:not(.idl) {
            background: hsl(24, 20%, 95%);
        }

        code.highlight {
            padding: .1em;
            border-radius: .3em;
        }

        pre.highlight,
        pre>code.highlight {
            display: block;
            padding: 1em;
            margin: .5em 0;
            overflow: auto;
            border-radius: 0;
        }

        .highlight .c {
            color: #708090
        }

        /* Comment */
        .highlight .k {
            color: #990055
        }

        /* Keyword */
        .highlight .l {
            color: #000000
        }

        /* Literal */
        .highlight .n {
            color: #0077aa
        }

        /* Name */
        .highlight .o {
            color: #999999
        }

        /* Operator */
        .highlight .p {
            color: #999999
        }

        /* Punctuation */
        .highlight .cm {
            color: #708090
        }

        /* Comment.Multiline */
        .highlight .cp {
            color: #708090
        }

        /* Comment.Preproc */
        .highlight .c1 {
            color: #708090
        }

        /* Comment.Single */
        .highlight .cs {
            color: #708090
        }

        /* Comment.Special */
        .highlight .kc {
            color: #990055
        }

        /* Keyword.Constant */
        .highlight .kd {
            color: #990055
        }

        /* Keyword.Declaration */
        .highlight .kn {
            color: #990055
        }

        /* Keyword.Namespace */
        .highlight .kp {
            color: #990055
        }

        /* Keyword.Pseudo */
        .highlight .kr {
            color: #990055
        }

        /* Keyword.Reserved */
        .highlight .kt {
            color: #990055
        }

        /* Keyword.Type */
        .highlight .ld {
            color: #000000
        }

        /* Literal.Date */
        .highlight .m {
            color: #000000
        }

        /* Literal.Number */
        .highlight .s {
            color: #a67f59
        }

        /* Literal.String */
        .highlight .na {
            color: #0077aa
        }

        /* Name.Attribute */
        .highlight .nc {
            color: #0077aa
        }

        /* Name.Class */
        .highlight .no {
            color: #0077aa
        }

        /* Name.Constant */
        .highlight .nd {
            color: #0077aa
        }

        /* Name.Decorator */
        .highlight .ni {
            color: #0077aa
        }

        /* Name.Entity */
        .highlight .ne {
            color: #0077aa
        }

        /* Name.Exception */
        .highlight .nf {
            color: #0077aa
        }

        /* Name.Function */
        .highlight .nl {
            color: #0077aa
        }

        /* Name.Label */
        .highlight .nn {
            color: #0077aa
        }

        /* Name.Namespace */
        .highlight .py {
            color: #0077aa
        }

        /* Name.Property */
        .highlight .nt {
            color: #669900
        }

        /* Name.Tag */
        .highlight .nv {
            color: #222222
        }

        /* Name.Variable */
        .highlight .ow {
            color: #999999
        }

        /* Operator.Word */
        .highlight .mb {
            color: #000000
        }

        /* Literal.Number.Bin */
        .highlight .mf {
            color: #000000
        }

        /* Literal.Number.Float */
        .highlight .mh {
            color: #000000
        }

        /* Literal.Number.Hex */
        .highlight .mi {
            color: #000000
        }

        /* Literal.Number.Integer */
        .highlight .mo {
            color: #000000
        }

        /* Literal.Number.Oct */
        .highlight .sb {
            color: #a67f59
        }

        /* Literal.String.Backtick */
        .highlight .sc {
            color: #a67f59
        }

        /* Literal.String.Char */
        .highlight .sd {
            color: #a67f59
        }

        /* Literal.String.Doc */
        .highlight .s2 {
            color: #a67f59
        }

        /* Literal.String.Double */
        .highlight .se {
            color: #a67f59
        }

        /* Literal.String.Escape */
        .highlight .sh {
            color: #a67f59
        }

        /* Literal.String.Heredoc */
        .highlight .si {
            color: #a67f59
        }

        /* Literal.String.Interpol */
        .highlight .sx {
            color: #a67f59
        }

        /* Literal.String.Other */
        .highlight .sr {
            color: #a67f59
        }

        /* Literal.String.Regex */
        .highlight .s1 {
            color: #a67f59
        }

        /* Literal.String.Single */
        .highlight .ss {
            color: #a67f59
        }

        /* Literal.String.Symbol */
        .highlight .vc {
            color: #0077aa
        }

        /* Name.Variable.Class */
        .highlight .vg {
            color: #0077aa
        }

        /* Name.Variable.Global */
        .highlight .vi {
            color: #0077aa
        }

        /* Name.Variable.Instance */
        .highlight .il {
            color: #000000
        }

        /* Literal.Number.Integer.Long */
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-WD" rel="stylesheet" type="text/css">

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"> </a> </p>
        <h1 class="p-name no-ref" id="title">CSS 布局 API 第 1 级</h1>
        <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">W3C 首次公开工作草案, <time
                    class="dt-updated" datetime="2018-04-12">2018 年 4 月 12 日</time></span></h2>
        <div data-fill-with="spec-metadata">
            <dl>
                <dt>此版本:
                <dd><a class="u-url"
                        href="https://www.w3.org/TR/2018/WD-css-layout-api-1-20180412/">https://www.w3.org/TR/2018/WD-css-layout-api-1-20180412/</a>
                <dt>最新发布版本:
                <dd><a href="https://www.w3.org/TR/css-layout-api-1/">https://www.w3.org/TR/css-layout-api-1/</a>
                <dt>编辑草案:
                <dd><a
                        href="https://drafts.css-houdini.org/css-layout-api-1/">https://drafts.css-houdini.org/css-layout-api-1/</a>
                <dt>反馈:
                <dd><span><a
                            href="mailto:public-houdini@w3.org?subject=%5Bcss-layout-api%5D%20YOUR%20TOPIC%20HERE">public-houdini@w3.org</a>
                        邮件主题为 “<kbd>[css-layout-api] <i data-lt="">… 信息主题 …</i></kbd>” (<a
                            href="https://lists.w3.org/Archives/Public/public-houdini/" rel="discussion">存档</a>)</span>
                <dt>问题跟踪:
                <dd><a href="https://github.com/w3c/css-houdini-drafts/issues/">GitHub</a>
                <dd><a href="#issues-index">规范内嵌问题</a>
                <dt class="editor">编辑:
                <dd class="editor p-author h-card vcard" data-editor-id="69511"><a class="p-name fn u-email email"
                        href="mailto:gwhit@microsoft.com">Greg Whitworth</a> (<span class="p-org org">微软</span>)
                <dd class="editor p-author h-card vcard" data-editor-id="73001"><a class="p-name fn u-email email"
                        href="mailto:ikilpatrick@chromium.org">Ian Kilpatrick</a> (<span class="p-org org">谷歌</span>)
                <dd class="editor p-author h-card vcard" data-editor-id="42199"><a class="p-name fn u-url url"
                        href="http://xanthir.com/contact/">Tab Atkins-Bittner</a> (<span class="p-org org">谷歌</span>)
                <dd class="editor p-author h-card vcard" data-editor-id="47691"><a class="p-name fn u-email email"
                        href="mailto:shanestephens@google.com">Shane Stephens</a> (<span class="p-org org">谷歌</span>)
                <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email"
                        href="mailto:robert@ocallahan.org">Robert O'Callahan</a>
                <dd class="editor p-author h-card vcard" data-editor-id="49885"><a class="p-name fn u-email email"
                        href="mailto:rossen.atanassov@microsoft.com">Rossen Atanassov</a> (<span
                        class="p-org org">微软</span>)
            </dl>
        </div>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a
                href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">版权</a> © 2018 <a
                href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a
                href="http://www.csail.mit.edu/"><abbr title="麻省理工学院">MIT</abbr></a>, <a
                href="http://www.ercim.eu/"><abbr title="欧洲信息与数学研究联盟">ERCIM</abbr></a>, <a
                href="http://www.keio.ac.jp/">庆应义塾大学</a>, <a href="http://ev.buaa.edu.cn/">北京航空航天大学</a>)。W3C <a
                href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">法律责任</a>, <a
                href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">商标</a> 和 <a
                href="https://www.w3.org/Consortium/Legal/copyright-documents">文档使用</a> 规则适用。 </p>
        <hr title="页头分隔线">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">摘要</span></h2>
        <p>本规范描述了一种 API，允许开发人员响应计算样式和 <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box">盒模型</a>
            以及 <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box-tree">盒树</a> 的变化来布局盒子。</p>

    </div>
    <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">本文档状态</span>
    </h2>
    <div data-fill-with="status">
        <p><em>本节描述了本文档在发布时的状态。其他文档可能会取代本文档。当前 W3C 发布的文档列表及该技术报告的最新修订版可在 <a href="https://www.w3.org/TR/">W3C 技术报告索引
                    https://www.w3.org/TR/</a> 中找到。</em> </p>
        <p>本文档为 <b>首次公开工作草案</b>。</p>
        <p>作为首次公开工作草案发布并不意味着 W3C 会员对其表示认可。这是一份草案文件，可能会随时更新、替换或废止。引用此文档不应被视为引用最终的工作成果。</p>
        <p>建议通过 <a href="https://github.com/w3c/css-houdini-drafts/issues">GitHub Issues</a> 讨论本规范。
            提交问题时，请在标题中包含 “css-layout-api”，最好像这样：
            “[css-layout-api] <i>…评论摘要…</i>”。
            所有问题和评论均 <a href="https://lists.w3.org/Archives/Public/public-houdini-archive/">存档</a>。</p>
        <p>本文档由 <a href="https://www.w3.org/Style/CSS/members">CSS 工作组</a> 制作。</p>
        <p>本文档由依据 <a href="https://www.w3.org/Consortium/Patent-Policy/">W3C 专利政策</a> 运营的一个小组制作。W3C
            维护了与该小组交付成果相关的任何专利披露的 <a href="https://www.w3.org/2004/01/pp-impl/32061/status"
                rel="disclosure">公开列表</a>；该页面还包括披露专利的说明。如果个人掌握了他们认为包含 <a
                href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">必要声明</a> 的专利，则必须根据 <a
                href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">W3C 专利政策第 6 条</a> 披露相关信息。</p>
        <p>本文档受 <a id="w3c_process_revision" href="https://www.w3.org/2018/Process-20180201/">2018 年 2 月 1 日 W3C
                流程文件</a> 约束。</p>
    </div>
    <div data-fill-with="at-risk"></div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目录</h2>
        <ol class="toc" role="directory">
            <li><a href="#intro"><span class="secno">1</span> <span class="content">介绍</span></a>
            <li>
                <a href="#layout-api-containers"><span class="secno">2</span> <span class="content">布局 API 容器</span></a>
                <ol class="toc">
                    <li><a href="#painting"><span class="secno">2.1</span> <span class="content">布局 API 容器绘制</span></a>
                    <li><a href="#layout-api-box-tree"><span class="secno">2.2</span> <span
                                class="content">盒树转换</span></a>
                </ol>
            <li>
                <a href="#layout-api-model-and-terminology"><span class="secno">3</span> <span class="content">布局 API
                        模型和术语</span></a>
                <ol class="toc">
                    <li>
                        <a href="#layout-children"><span class="secno">3.1</span> <span class="content">布局子元素</span></a>
                        <ol class="toc">
                            <li><a href="#layout-child-box-tree"><span class="secno">3.1.1</span> <span
                                        class="content">布局子元素和盒树</span></a>
                        </ol>
                    <li><a href="#layout-fragments"><span class="secno">3.2</span> <span class="content">布局片段</span></a>
                    <li><a href="#intrinsic-sizes"><span class="secno">3.3</span> <span class="content">固有尺寸</span></a>
                    <li><a href="#layout-constraints"><span class="secno">3.4</span> <span
                                class="content">布局约束</span></a>
                    <li><a href="#breaking-and-fragmentation"><span class="secno">3.5</span> <span
                                class="content">断点和分片</span></a>
                    <li><a href="#edges"><span class="secno">3.6</span> <span class="content">边缘</span></a>
                </ol>
            <li>
                <a href="#interactions-with-other-modules"><span class="secno">4</span> <span
                        class="content">与其他模块的交互</span></a>
                <ol class="toc">
                    <li>
                        <a href="#interaction-sizing"><span class="secno">4.1</span> <span
                                class="content">尺寸调整</span></a>
                        <ol class="toc">
                            <li><a href="#interaction-sizing-positiong-layout"><span class="secno">4.1.1</span> <span
                                        class="content">定位布局尺寸调整</span></a>
                        </ol>
                    <li><a href="#interaction-positioning"><span class="secno">4.2</span> <span
                                class="content">定位</span></a>
                    <li><a href="#interaction-overflow"><span class="secno">4.3</span> <span
                                class="content">溢出</span></a>
                    <li><a href="#interaction-fragmentation"><span class="secno">4.4</span> <span
                                class="content">分片</span></a>
                    <li><a href="#interaction-alignment"><span class="secno">4.5</span> <span
                                class="content">对齐</span></a>
                </ol>
            <li>
                <a href="#layout"><span class="secno">5</span> <span class="content">布局</span></a>
                <ol class="toc">
                    <li><a href="#concepts"><span class="secno">5.1</span> <span class="content">概念</span></a>
                    <li><a href="#layout-invalidation"><span class="secno">5.2</span> <span
                                class="content">布局无效化</span></a>
                    <li><a href="#layout-worklet"><span class="secno">5.3</span> <span class="content">布局工作线程</span></a>
                    <li><a href="#registering-layout"><span class="secno">5.4</span> <span
                                class="content">注册布局</span></a>
                    <li>
                        <a href="#layout-engine"><span class="secno">5.5</span> <span class="content">布局引擎</span></a>
                        <ol class="toc">
                            <li><a href="#request-objects"><span class="secno">5.5.1</span> <span
                                        class="content">请求对象</span></a>
                        </ol>
                    <li>
                        <a href="#performing-layout"><span class="secno">5.6</span> <span
                                class="content">执行布局</span></a>
                        <ol class="toc">
                            <li><a href="#determining-intrinsic-sizes"><span class="secno">5.6.1</span> <span
                                        class="content">确定固有尺寸</span></a>
                            <li><a href="#generating-fragments"><span class="secno">5.6.2</span> <span
                                        class="content">生成片段</span></a>
                            <li><a href="#utility-algorithms"><span class="secno">5.6.3</span> <span
                                        class="content">实用算法</span></a>
                        </ol>
                </ol>
            <li><a href="#security-considerations"><span class="secno">6</span> <span class="content">安全注意事项</span></a>
            <li><a href="#privacy-considerations"><span class="secno">7</span> <span class="content">隐私注意事项</span></a>
            <li>
                <a href="#conformance"><span class="secno"></span> <span class="content">符合性</span></a>
                <ol class="toc">
                    <li><a href="#conventions"><span class="secno"></span> <span class="content">文档约定</span></a>
                    <li><a href="#conformance-classes"><span class="secno"></span> <span
                                class="content">符合性类别</span></a>
                    <li>
                        <a href="#partial"><span class="secno"></span> <span class="content">部分实现</span></a>
                        <ol class="toc">
                            <li><a href="#conform-future-proofing"><span class="secno"></span> <span class="content">
                                        不稳定和专有特性的实现</span></a>
                        </ol>
                    <li><a href="#testing"><span class="secno"></span> <span class="content">非实验性实现</span></a>
                </ol>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本规范定义的术语</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">引用定义的术语</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考资料</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">规范性参考资料</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">信息性参考资料</span></a>
                </ol>
            <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL 索引</span></a>
            <li><a href="#issues-index"><span class="secno"></span> <span class="content">问题索引</span></a>
        </ol>
    </nav>
    <main>
        <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span
                class="content">介绍</span><a class="self-link" href="#intro"></a></h2>
        <p><em>本节非规范性内容。</em></p>
        <p>CSS 的布局阶段负责从<a data-link-type="dfn" href="https://www.w3.org/TR/css3-break/#fragment"
                id="ref-for-fragment">片段</a>和<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-display-3/#box-tree" id="ref-for-box-tree">盒树</a>中生成和定位内容。</p>
        <p>本规范描述了一种 API，允许开发人员根据计算的样式和<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box-tree"
                id="ref-for-box-tree①">盒树</a>的变化来布局一个<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-display-3/#box" id="ref-for-box">盒模型</a>。</p>
        <h2 class="heading settled" data-level="2" id="layout-api-containers"><span class="secno">2. </span><span
                class="content">布局 API 容器</span><a class="self-link" href="#layout-api-containers"></a></h2>
        <p>为<a href="https://www.w3.org/TR/css-values-3/#comb-one">替代</a>值新增了一种<a class="production css"
                data-link-type="type" href="https://www.w3.org/TR/css-display-3/#typedef-display-inside"
                id="ref-for-typedef-display-inside"
                title="扩展为: flex | flow | grid | flow-root | table | ruby">&lt;display-inside></a>属性:
            <code>layout(<a class="production css" data-link-type="type" href="https://www.w3.org/TR/css3-values/#typedef-ident" id="ref-for-typedef-ident">&lt;ident></a>)</code>。
        </p>
        <dl>
            <dt><dfn class="dfn-paneled css" data-dfn-for="display" data-dfn-type="value" data-export=""
                    id="valdef-display-layout">layout()</dfn>
            <dd> 此值会使元素生成一个<a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container">布局 API
                    容器</a>盒模型。
        </dl>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="layout-api-container">布局 API
                容器</dfn>是元素通过<a class="production css" data-link-type="type"
                href="https://www.w3.org/TR/css-display-3/#typedef-display-inside" id="ref-for-typedef-display-inside①"
                title="扩展为: flex | flow | grid | flow-root | table | ruby">&lt;display-inside></a>的<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-cascade-4/#computed-value"
                id="ref-for-computed-value">计算值</a>为<a class="css" data-link-type="maybe" href="#valdef-display-layout"
                id="ref-for-valdef-display-layout">layout()</a>生成的盒模型。</p>
        <p>一个<a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container①">布局 API
                容器</a>为其内容建立一个新的<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="layout-api-formatting-context">布局 API 格式化上下文</dfn>。这与建立块格式化上下文相同，但使用作者提供的布局而不是块布局。
            例如，浮动不会进入布局 API 容器，布局 API 容器的边距不会与其内容的边距重叠。</p>
        <p>布局 API 容器的所有流入子元素称为<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="layout-api-children">布局
                API 子元素</dfn>，并使用作者定义的布局进行布局。</p>
        <p><a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container③">布局 API
                容器</a>为其内容形成一个包含块，<a
                href="https://www.w3.org/TR/CSS2/visudet.html#containing-block-details">与块容器完全相同</a>。<a
                data-link-type="biblio" href="#biblio-css21">[CSS21]</a></p>
        <p class="note" role="note"><span>注意：</span> 在规范的未来版本中，可能会有方法来覆盖包含块的行为。</p>
        <p><a class="property" data-link-type="propdesc" href="https://www.w3.org/TR/css-overflow-3/#propdef-overflow"
                id="ref-for-propdef-overflow">overflow</a>
            属性适用于<a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container④">布局 API
                容器</a>。详情见 <a href="#interaction-overflow">§4.3 Overflow</a>。</p>
        <p>由于布局完全由作者决定，其他布局模式（例如 flex、block）中使用的属性可能不适用。例如，作者可能不会遵循子元素上的<a class="property" data-link-type="propdesc"
                href="https://www.w3.org/TR/CSS22/box.html#propdef-margin" id="ref-for-propdef-margin">边距</a>属性。</p>
        <h3 class="heading settled" data-level="2.1" id="painting"><span class="secno">2.1. </span><span
                class="content">布局 API 容器绘制</span><a class="self-link" href="#painting"></a></h3>
        <p><a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container⑤">布局 API
                容器</a>的子元素绘制方式与内联块<a data-link-type="biblio" href="#biblio-css21">[CSS21]</a>完全相同，除了布局方法返回的顺序（通过<code
                class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-childfragments" id="ref-for-dom-fragmentresultoptions-childfragments">childFragments</a></code>）
            替代了原始文档顺序，且<a class="property" data-link-type="propdesc"
                href="https://www.w3.org/TR/css3-positioning/#propdef-z-index" id="ref-for-propdef-z-index">z-index</a>
            的非<a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css3-positioning/#valdef-z-index-auto"
                id="ref-for-valdef-z-index-auto">auto</a>值即使<a class="property" data-link-type="propdesc"
                href="https://www.w3.org/TR/css3-positioning/#propdef-position"
                id="ref-for-propdef-position">position</a>是<a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css3-positioning/#valdef-position-static"
                id="ref-for-valdef-position-static">static</a>时，也会创建一个层叠上下文。</p>
        <h3 class="heading settled" data-level="2.2" id="layout-api-box-tree"><span class="secno">2.2. </span><span
                class="content">盒树转换</span><a class="self-link" href="#layout-api-box-tree"></a>
        </h3>
        <p><a data-link-type="dfn" href="#layout-api-children" id="ref-for-layout-api-children">布局 API 子元素</a>可以根据<a
                data-link-type="dfn" href="#document-layout-definition-layout-options"
                id="ref-for-document-layout-definition-layout-options">布局选项</a>的值以不同方式表现，<code
                class="idl"><a data-link-type="idl" href="#dom-layoutoptions-childdisplay" id="ref-for-dom-layoutoptions-childdisplay">childDisplay</a></code>
            由类上的<code>layoutOptions</code>设置。</p>
        <p>如果<a data-link-type="dfn" href="#document-layout-definition-layout-options"
                id="ref-for-document-layout-definition-layout-options①">布局选项</a>的<code
                class="idl"><a data-link-type="idl" href="#dom-layoutoptions-childdisplay" id="ref-for-dom-layoutoptions-childdisplay①">childDisplay</a></code>
            的值为<code>"block"</code>，则该子元素的<a class="property" data-link-type="propdesc"
                href="https://www.w3.org/TR/css-ruby-1/#propdef-display" id="ref-for-propdef-display">display</a>值将被<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#blockify"
                id="ref-for-blockify">块化</a>。这类似于<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-flexbox-1/#flex-container" id="ref-for-flex-container">弹性容器</a>或<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-grid-1/#grid-container"
                id="ref-for-grid-container">网格容器</a>的子元素。
            参见<a data-link-type="biblio" href="#biblio-css3-display">[css3-display]</a>。</p>
        <p>如果<a data-link-type="dfn" href="#document-layout-definition-layout-options"
                id="ref-for-document-layout-definition-layout-options②">布局选项</a>的<code
                class="idl"><a data-link-type="idl" href="#dom-layoutoptions-childdisplay" id="ref-for-dom-layoutoptions-childdisplay②">childDisplay</a></code>
            的值为<code>"normal"</code>，则不会发生<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#blockify"
                id="ref-for-blockify①">块化</a>。
            相反，具有<a class="production css" data-link-type="type"
                href="https://www.w3.org/TR/css-display-3/#typedef-display-outside" id="ref-for-typedef-display-outside"
                title="扩展为: inline | run-in | block">&lt;display-outside></a><a data-link-type="dfn"
                href="https://www.w3.org/TR/css-cascade-4/#computed-value" id="ref-for-computed-value①">计算值</a>为<a
                class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-display-3/#valdef-display-inline"
                id="ref-for-valdef-display-inline">内联</a>的子元素（<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-inline-3/#root-inline-box" id="ref-for-root-inline-box">根内联盒</a>）
            在调用<code
                class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment">layoutNextFragment()</a></code>
            时，将为每一行生成一个<code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment">布局片段</a></code>。
        </p>
        <p class="note" role="note"><span>注意：</span> 这允许作者调整每一行的可用内联大小，并单独定位每一行。</p>
        <p>表示<a data-link-type="dfn" href="https://www.w3.org/TR/css-inline-3/#root-inline-box"
                id="ref-for-root-inline-box①">根内联盒</a>的<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild">布局子元素</a></code>的子元素也有一些额外的转换。
        </p>
        <ul>
            <li data-md="">
                <p><a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#block-level"
                        id="ref-for-block-level">块级</a>盒子内的<a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-display-3/#inline-level" id="ref-for-inline-level">内联级</a>盒子将被<a
                        data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inlinify"
                        id="ref-for-inlinify">内联化</a>，即其<a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-display-3/#typedef-display-outside"
                        id="ref-for-typedef-display-outside①"
                        title="扩展为: inline | run-in | block">&lt;display-outside></a>值将被设置为<a class="css"
                        data-link-type="maybe" href="https://www.w3.org/TR/css-display-3/#valdef-display-inline"
                        id="ref-for-valdef-display-inline①">内联</a>。</p>
            <li data-md="">
                <p>位于<a data-link-type="dfn" href="https://drafts.csswg.org/css-page-floats-3/#float"
                        id="ref-for-float">浮动</a>内的<a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-display-3/#inline-level"
                        id="ref-for-inline-level①">内联级</a>盒子不会脱离文档流。相反，它必须被视为在流内，并被<a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-display-3/#inlinify" id="ref-for-inlinify①">内联化</a>。</p>
        </ul>
        <p>在上述两种情况下，子元素都会变成<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#atomic-inline"
                id="ref-for-atomic-inline">原子内联</a>。</p>
        <p class="note" role="note"><span>注意：</span> 当用户代理遇到<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-display-3/#block-level"
                id="ref-for-block-level①">块级</a>盒子时，不会执行任何“内联拆分”或分片。</p>
        <div class="note" role="note">
            注意：在以下示例中，“inline-span”将表示为单个<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①">布局子元素</a></code>，
            同时“block”和“float”将成为<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#atomic-inline"
                id="ref-for-atomic-inline①">原子内联</a>。
            <pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">"inline-span"</span><span class="p">></span>
  Text
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"block"</span><span class="p">>&lt;/</span><span class="nt">div</span><span class="p">></span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"float"</span><span class="p">>&lt;/</span><span class="nt">div</span><span class="p">></span>
  Text
<span class="p">&lt;/</span><span class="nt">span</span><span class="p">></span>
</pre>
        </div>
        <h2 class="heading settled" data-level="3" id="layout-api-model-and-terminology"><span class="secno">3.
            </span><span class="content">布局 API 模型和术语</span><a class="self-link"
                href="#layout-api-model-and-terminology"></a></h2>
        <p>本节概述了提供给作者的布局 API。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="current-layout">当前布局</dfn>是我们正在为其执行布局的<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box" id="ref-for-box3">盒模型</a>的布局算法。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="parent-layout">父布局</dfn>是<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box"
                id="ref-for-box2">盒模型</a>的直接父元素的布局算法（该布局算法正在请求执行<a data-link-type="dfn" href="#current-layout"
                id="ref-for-current-layout">当前布局</a>）。</p>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="child-layout">子布局</dfn>是<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②">LayoutChild</a></code>的布局算法，属于<a
                data-link-type="dfn" href="#current-layout" id="ref-for-current-layout①">当前布局</a>的子元素。</p>
        <h3 class="heading settled" data-level="3.1" id="layout-children"><span class="secno">3.1. </span><span
                class="content">布局子元素</span><a class="self-link" href="#layout-children"></a></h3>
        <pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="layoutchild"><code>LayoutChild</code></dfn> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/css-typed-om-1/#stylepropertymapreadonly" id="ref-for-stylepropertymapreadonly">StylePropertyMapReadOnly</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="StylePropertyMapReadOnly" href="#dom-layoutchild-stylemap" id="ref-for-dom-layoutchild-stylemap">styleMap</a>;

    <a class="n" data-link-type="idl-name" href="#intrinsicsizesrequest" id="ref-for-intrinsicsizesrequest">IntrinsicSizesRequest</a> <a class="nv idl-code" data-link-type="method" href="#dom-layoutchild-intrinsicsizes" id="ref-for-dom-layoutchild-intrinsicsizes">intrinsicSizes</a>();
    <a class="n" data-link-type="idl-name" href="#layoutfragmentrequest" id="ref-for-layoutfragmentrequest">LayoutFragmentRequest</a> <a class="nv idl-code" data-link-type="method" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment①">layoutNextFragment</a>(<a class="n" data-link-type="idl-name" href="#layoutconstraints" id="ref-for-layoutconstraints">LayoutConstraints</a> <dfn class="nv idl-code" data-dfn-for="LayoutChild/layoutNextFragment(constraints, breakToken)" data-dfn-type="argument" data-export="" id="dom-layoutchild-layoutnextfragment-constraints-breaktoken-constraints"><code>constraints</code><a class="self-link" href="#dom-layoutchild-layoutnextfragment-constraints-breaktoken-constraints"></a></dfn>, <a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken">ChildBreakToken</a> <dfn class="nv idl-code" data-dfn-for="LayoutChild/layoutNextFragment(constraints, breakToken)" data-dfn-type="argument" data-export="" id="dom-layoutchild-layoutnextfragment-constraints-breaktoken-breaktoken"><code>breakToken</code><a class="self-link" href="#dom-layoutchild-layoutnextfragment-constraints-breaktoken-breaktoken"></a></dfn>);
};
</pre>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild③">LayoutChild</a></code>包含以下内部槽位：
        </p>
        <ul>
            <li data-md="">
                <p><dfn class="dfn-paneled idl-code" data-dfn-for="LayoutChild" data-dfn-type="attribute" data-export=""
                        id="dom-layoutchild-box-slot"><code>[[box]]</code></dfn> 一个 CSS <a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-display-3/#box" id="ref-for-box③">盒模型</a>。</p>
            <li data-md="">
                <p><dfn class="dfn-paneled idl-code" data-dfn-for="LayoutChild" data-dfn-type="attribute" data-export=""
                        id="dom-layoutchild-stylemap-slot"><code>[[styleMap]]</code></dfn> 一个<code
                        class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-typed-om-1/#stylepropertymapreadonly" id="ref-for-stylepropertymapreadonly①">StylePropertyMapReadOnly</a></code>，这是该子元素的计算样式，包含在<code>childInputProperties</code>中列出的属性。
                </p>
        </ul>
        <hr>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild④">LayoutChild</a></code>表示一个
            CSS 生成的<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box"
                id="ref-for-box④">盒模型</a>，在布局发生之前（这些盒模型的计算值都不是<a class="property" data-link-type="propdesc"
                href="https://www.w3.org/TR/css-ruby-1/#propdef-display" id="ref-for-propdef-display①">display</a>为<a
                class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-display-3/#valdef-display-none"
                id="ref-for-valdef-display-none">none</a>）。</p>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild⑤">LayoutChild</a></code>本身不包含任何布局信息（如内联或块大小），但可以用来生成包含布局信息的<code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①">LayoutFragment</a></code>。
        </p>
        <p>作者不能通过此 API 构造<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild⑥">LayoutChild</a></code>，这是在渲染引擎的独立阶段（样式解析后）完成的。
        </p>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild⑦">LayoutChild</a></code>可以由以下元素生成：
        </p>
        <ul>
            <li data-md="">
                <p>一个<a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-element"
                        id="ref-for-concept-element">元素</a>。</p>
            <li data-md="">
                <p>一个<a data-link-type="dfn" href="https://www.w3.org/TR/css-inline-3/#root-inline-box"
                        id="ref-for-root-inline-box②">根内联盒</a>。</p>
            <li data-md="">
                <p>一个<a class="css" data-link-type="selector"
                        href="https://www.w3.org/TR/css-pseudo-4/#selectordef-before"
                        id="ref-for-selectordef-before">::before</a>或<a class="css" data-link-type="selector"
                        href="https://www.w3.org/TR/css-pseudo-4/#selectordef-after"
                        id="ref-for-selectordef-after">::after</a>伪元素。</p>
                <p class="note" role="note"><span>注意：</span> 其他伪元素，如<a class="css" data-link-type="selector"
                        href="https://www.w3.org/TR/css-pseudo-4/#selectordef-first-letter"
                        id="ref-for-selectordef-first-letter">::first-letter</a>或<a class="css"
                        data-link-type="selector" href="https://www.w3.org/TR/css-pseudo-4/#selectordef-first-line"
                        id="ref-for-selectordef-first-line">::first-line</a>不会为布局目的生成<code
                        class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild⑧">LayoutChild</a></code>。它们是文本节点的附加样式信息。
                </p>
            <li data-md="">
                <p>一个<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#anonymous"
                        id="ref-for-anonymous">匿名盒</a>。例如，可能插入匿名盒的情况包括：</p>
                <ul>
                    <li data-md="">
                        <p>一个经过<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#blockify"
                                id="ref-for-blockify②">块化</a>的文本节点。（或者更普遍地，经过<a data-link-type="dfn"
                                href="https://www.w3.org/TR/css-inline-3/#root-inline-box"
                                id="ref-for-root-inline-box③">根内联盒</a>的<a data-link-type="dfn"
                                href="https://www.w3.org/TR/css-display-3/#blockify" id="ref-for-blockify③">块化</a>）。</p>
                    <li data-md="">
                        <p>一个具有<a class="css" data-link-type="propdesc"
                                href="https://www.w3.org/TR/css-ruby-1/#propdef-display"
                                id="ref-for-propdef-display②">display: table-cell</a>的元素，其父元素没有设置<a class="css"
                                data-link-type="propdesc" href="https://www.w3.org/TR/css-ruby-1/#propdef-display"
                                id="ref-for-propdef-display③">display: table</a>。</p>
                </ul>
        </ul>
        <div class="note" role="note">
            注意：以下示例将被放置到三个<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild⑨">LayoutChild</a></code>中：
            <pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">style</span><span class="p">></span>
  <span class="p">#</span><span class="nn">box</span><span class="p">::</span><span class="nd">before</span> <span class="p">{</span> <span class="k">content</span><span class="p">:</span> <span class="s1">'hello!'</span><span class="p">;</span> <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">></span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"box"</span><span class="p">></span>A block level box with text.<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">"..."</span> <span class="p">/></span>
</pre>
        </div>
        <div class="note" role="note">
            注意：以下示例将被放置到一个<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①⓪">LayoutChild</a></code>中，因为它们共享一个<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-inline-3/#root-inline-box"
                id="ref-for-root-inline-box④">根内联盒</a>：
            <pre class="lang-html highlight">This is a next node, <span class="p">&lt;</span><span class="nt">span</span><span class="p">></span>with some additional styling,
that may<span class="p">&lt;/</span><span class="nt">span</span><span class="p">></span> break over<span class="p">&lt;</span><span class="nt">br</span><span class="p">></span>multiple lines.
</pre>
        </div>
        <p>多个非<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#atomic-inline"
                id="ref-for-atomic-inline②">原子内联</a>的内容将被放置在同一个<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①①">LayoutChild</a></code>中，以允许渲染引擎跨元素边界执行文本排版。
        </p>
        <div class="note" role="note">
            注意：以下示例应生成一个<code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment②">布局片段</a></code>，但它来自三个非<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#atomic-inline"
                id="ref-for-atomic-inline③">原子内联</a>元素：
            <pre class="lang-html highlight">ع<span class="p">&lt;</span><span class="nt">span</span> <span class="na">style</span><span class="o">=</span><span class="s">"color: blue"</span><span class="p">></span>ع<span class="p">&lt;/</span><span class="nt">span</span><span class="p">></span>ع
</pre>
        </div>
        <p>一个<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①②">LayoutChild</a></code>数组被传递到布局方法中，表示正在布局的当前盒子的子元素。
        </p>
        <div class="algorithm" data-algorithm="styleMap">
            获取<dfn class="dfn-paneled idl-code" data-dfn-for="LayoutChild" data-dfn-type="attribute" data-export=""
                id="dom-layoutchild-stylemap"><code>styleMap</code></dfn>时，用户代理必须执行以下步骤：
            <ol>
                <li data-md="">
                    <p>返回<var>this</var>的<code
                            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-typed-om-1/#stylepropertymapreadonly" id="ref-for-stylepropertymapreadonly②">StylePropertyMapReadOnly</a></code>，该值包含在<code
                            class="idl"><a data-link-type="idl" href="#dom-layoutchild-stylemap-slot" id="ref-for-dom-layoutchild-stylemap-slot">[[styleMap]]</a></code>内部槽中。
                    </p>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="layoutNextFragment(constraints, breakToken)">
            当在<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①④">LayoutChild</a></code>上调用<dfn
                class="dfn-paneled idl-code" data-dfn-for="LayoutChild" data-dfn-type="method" data-export=""
                id="dom-layoutchild-layoutnextfragment"><code>layoutNextFragment(<var>constraints</var>, <var>breakToken</var>)</code></dfn>方法时，用户代理必须执行以下步骤：
            <ol>
                <li data-md="">
                    <p>创建一个新的<code
                            class="idl"><a data-link-type="idl" href="#layoutfragmentrequest" id="ref-for-layoutfragmentrequest①">LayoutFragmentRequest</a></code>，其内部槽位为：
                    </p>
                    <ul>
                        <li data-md="">
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragmentrequest-layoutchild-slot" id="ref-for-dom-layoutfragmentrequest-layoutchild-slot">[[layoutChild]]</a></code>设置为<var>this</var>。
                            </p>
                        <li data-md="">
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragmentrequest-layoutconstraints-slot" id="ref-for-dom-layoutfragmentrequest-layoutconstraints-slot">[[layoutConstraints]]</a></code>设置为<var>constraints</var>。
                            </p>
                        <li data-md="">
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragmentrequest-breaktoken-slot" id="ref-for-dom-layoutfragmentrequest-breaktoken-slot">[[breakToken]]</a></code>设置为<var>breakToken</var>。
                            </p>
                    </ul>
                <li data-md="">
                    <p>返回<var>request</var>。</p>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="intrinsicSizes()">
            当在<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①⑤">LayoutChild</a></code>上调用<dfn
                class="dfn-paneled idl-code" data-dfn-for="LayoutChild" data-dfn-type="method" data-export=""
                id="dom-layoutchild-intrinsicsizes"><code>intrinsicSizes()</code></dfn>方法时，用户代理必须执行以下步骤：
            <ol>
                <li data-md="">
                    <p>创建一个新的<code
                            class="idl"><a data-link-type="idl" href="#intrinsicsizesrequest" id="ref-for-intrinsicsizesrequest①">IntrinsicSizesRequest</a></code>，其内部槽位为：
                    </p>
                    <ul>
                        <li data-md="">
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-intrinsicsizesrequest-layoutchild-slot" id="ref-for-dom-intrinsicsizesrequest-layoutchild-slot">[[layoutChild]]</a></code>设置为<var>this</var>。
                            </p>
                    </ul>
                <li data-md="">
                    <p>返回<var>request</var>。</p>
            </ol>
        </div>
        <p class="note" role="note"><span>注意：</span> <code
                class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment②">layoutNextFragment()</a></code>和<code
                class="idl"><a data-link-type="idl" href="#dom-layoutchild-intrinsicsizes" id="ref-for-dom-layoutchild-intrinsicsizes①">intrinsicSizes()</a></code>不会同步运行。有关完整描述，请参见<a
                href="#request-objects">§5.5.1 请求对象</a>。</p>
        <h4 class="heading settled" data-level="3.1.1" id="layout-child-box-tree"><span class="secno">3.1.1.
            </span><span class="content">布局子元素与盒树</span><a class="self-link" href="#layout-child-box-tree"></a></h4>
        <p>每个<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box" id="ref-for-box⑤">盒模型</a>都有一个<dfn
                class="dfn-paneled idl-code" data-dfn-for="box" data-dfn-type="attribute" data-export=""
                id="dom-box-layoutchildmap-slot"><code>[[layoutChildMap]]</code></dfn>内部槽位，这是一个<code
                class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope">LayoutWorkletGlobalScope</a></code>到<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①⑥">LayoutChild</a></code>的<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map"
                id="ref-for-ordered-map">有序映射</a>。</p>
        <div class="algorithm" data-algorithm="get a layout child">
            当用户代理在给定<var>workletGlobalScope</var>、<var>name</var>和<var>box</var>的情况下<dfn class="dfn-paneled"
                data-dfn-type="dfn" data-noexport="" id="get-a-layout-child">获取布局子元素</dfn>时，<em>必须</em>执行以下步骤：
            <ol>
                <li data-md="">
                    <p>确认以下内容：</p>
                    <ul>
                        <li data-md="">
                            <p><var>box</var>当前已附加到<a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-display-3/#box-tree" id="ref-for-box-tree②">盒树</a>中。
                            </p>
                        <li data-md="">
                            <p><var>box</var>的<a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-display-3/#containing-block"
                                    id="ref-for-containing-block">包含块</a>是一个<a data-link-type="dfn"
                                    href="#layout-api-container" id="ref-for-layout-api-container⑥">布局 API 容器</a>。</p>
                        <li data-md="">
                            <p>该<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#containing-block"
                                    id="ref-for-containing-block①">包含块</a>的<a class="css" data-link-type="maybe"
                                    href="#valdef-display-layout"
                                    id="ref-for-valdef-display-layout①">layout()</a>函数的第一个参数为<var>name</var>。</p>
                    </ul>
                <li data-md="">
                    <p>将<var>layoutChildMap</var>设置为<var>box</var>的<code
                            class="idl"><a data-link-type="idl" href="#dom-box-layoutchildmap-slot" id="ref-for-dom-box-layoutchildmap-slot">[[layoutChildMap]]</a></code>。
                    </p>
                <li data-md="">
                    <p>如果<var>layoutChildMap</var>[<var>workletGlobalScope</var>]不存在，执行以下步骤：</p>
                    <ol>
                        <li data-md="">
                            <p>通过给定的<var>name</var>和<var>workletGlobalScope</var>，获取<a data-link-type="dfn"
                                    href="#get-a-layout-definition" id="ref-for-get-a-layout-definition">布局定义</a>。</p>
                            <p>确认<a data-link-type="dfn" href="#get-a-layout-definition"
                                    id="ref-for-get-a-layout-definition①">获取布局定义</a>成功，且<var>definition</var>不是<code>"invalid"</code>。
                            </p>
                        <li data-md="">
                            <p>将<var>childInputProperties</var>设置为<var>definition</var>的<a data-link-type="dfn"
                                    href="#layout-definition-child-input-properties"
                                    id="ref-for-layout-definition-child-input-properties">子输入属性</a>。</p>
                        <li data-md="">
                            <p>创建一个新的<code
                                    class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①⑦">LayoutChild</a></code>，其内部槽位为：
                            </p>
                            <ul>
                                <li data-md="">
                                    <p><code
                                            class="idl"><a data-link-type="idl" href="#dom-layoutchild-box-slot" id="ref-for-dom-layoutchild-box-slot">[[box]]</a></code>设置为<var>box</var>。
                                    </p>
                                <li data-md="">
                                    <p><code
                                            class="idl"><a data-link-type="idl" href="#dom-layoutchild-stylemap-slot" id="ref-for-dom-layoutchild-stylemap-slot①">[[styleMap]]</a></code>设置为一个新的<code
                                            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-typed-om-1/#stylepropertymapreadonly" id="ref-for-stylepropertymapreadonly③">StylePropertyMapReadOnly</a></code>，并仅包含<var>childInputProperties</var>中列出的<a
                                            data-link-type="dfn"
                                            href="https://www.w3.org/TR/css-cascade-4/#computed-value"
                                            id="ref-for-computed-value②">计算值</a>。</p>
                            </ul>
                        <li data-md="">
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set"
                                    id="ref-for-map-set">将</a><var>layoutChildMap</var>[<var>workletGlobalScope</var>]设置为<var>layoutChild</var>。
                            </p>
                    </ol>
                <li data-md="">
                    <p>返回<var>layoutChildMap</var>[<var>workletGlobalScope</var>]的获取结果。</p>
            </ol>
        </div>
        <p>当一个<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box" id="ref-for-box⑥">盒模型</a>插入到<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box-tree"
                id="ref-for-box-tree③">盒树</a>中时，用户代理<em>可以</em>为所有<code
                class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope①">LayoutWorkletGlobalScope</a></code>预填充<code
                class="idl"><a data-link-type="idl" href="#dom-box-layoutchildmap-slot" id="ref-for-dom-box-layoutchildmap-slot①">[[layoutChildMap]]</a></code>。
        </p>
        <p>当一个<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box" id="ref-for-box⑦">盒模型</a>从<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box-tree"
                id="ref-for-box-tree④">盒树</a>中移除时，用户代理<em>必须</em>清除<code
                class="idl"><a data-link-type="idl" href="#dom-box-layoutchildmap-slot" id="ref-for-dom-box-layoutchildmap-slot②">[[layoutChildMap]]</a></code>。
        </p>
        <div class="algorithm" data-algorithm="update a layout child style">
            当用户代理想要在给定<var>box</var>的情况下<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="update-a-layout-child-style">更新布局子元素样式</dfn>时，<em>必须</em>执行以下步骤：
            <ol>
                <li data-md="">
                    <p>确认以下内容：</p>
                    <ul>
                        <li data-md="">
                            <p><var>box</var>当前已附加到<a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-display-3/#box-tree" id="ref-for-box-tree⑤">盒树</a>中。
                            </p>
                    </ul>
                <li data-md="">
                    <p>如果<var>box</var>的<a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-display-3/#containing-block"
                            id="ref-for-containing-block②">包含块</a>不是<a data-link-type="dfn" href="#layout-api-container"
                            id="ref-for-layout-api-container⑦">布局 API 容器</a>，则中止这些步骤。</p>
                <li data-md="">
                    <p>将<var>layoutChildMap</var>设置为<var>box</var>的<code
                            class="idl"><a data-link-type="idl" href="#dom-box-layoutchildmap-slot" id="ref-for-dom-box-layoutchildmap-slot③">[[layoutChildMap]]</a></code>。
                    </p>
                <li data-md="">
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate"
                            id="ref-for-map-iterate">对</a> <var>layoutChildMap</var>中的每个<var>layoutChild</var>进行以下操作：
                    </p>
                    <ol>
                        <li data-md="">
                            <p>将<var>styleMap</var>设置为<var>layoutChild</var>的<code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutchild-stylemap-slot" id="ref-for-dom-layoutchild-stylemap-slot②">[[styleMap]]</a></code>。
                            </p>
                        <li data-md="">
                            <p>根据<var>box</var>的新计算样式更新<var>styleMap</var>的<a data-link-type="dfn"
                                    href="https://drafts.csswg.org/css-syntax-3/#declaration"
                                    id="ref-for-declaration">声明</a>。</p>
                    </ol>
            </ol>
        </div>
        <p>当<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box"
                id="ref-for-box⑧">盒模型</a>的计算样式发生变化时，用户代理必须运行<a data-link-type="dfn" href="#update-a-layout-child-style"
                id="ref-for-update-a-layout-child-style">更新布局子元素样式</a>算法。</p>
        <h3 class="heading settled" data-level="3.2" id="layout-fragments"><span class="secno">3.2. </span><span
                class="content">布局片段</span><a class="self-link" href="#layout-fragments"></a></h3>
        <pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="layoutfragment"><code>LayoutFragment</code></dfn> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutFragment" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutfragment-inlinesize"><code>inlineSize</code></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutFragment" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutfragment-blocksize"><code>blockSize</code></dfn>;

    <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutFragment" data-dfn-type="attribute" data-export="" data-type="double" id="dom-layoutfragment-inlineoffset"><code>inlineOffset</code></dfn>;
    <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double③"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutFragment" data-dfn-type="attribute" data-export="" data-type="double" id="dom-layoutfragment-blockoffset"><code>blockOffset</code></dfn>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">any</span> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutFragment" data-dfn-type="attribute" data-export="" data-readonly="" data-type="any" id="dom-layoutfragment-data"><code>data</code></dfn>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken①">ChildBreakToken</a>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutFragment" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ChildBreakToken?" id="dom-layoutfragment-breaktoken"><code>breakToken</code></dfn>;
};
</pre>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment③">LayoutFragment</a></code>具有以下内部槽位：
        </p>
        <ul>
            <li data-md="">
                <p><dfn class="dfn-paneled idl-code" data-dfn-for="LayoutFragment" data-dfn-type="attribute"
                        data-export=""
                        id="dom-layoutfragment-layoutfragmentrequest-slot"><code>[[layoutFragmentRequest]]</code></dfn>
                    一个<code
                        class="idl"><a data-link-type="idl" href="#layoutfragmentrequest" id="ref-for-layoutfragmentrequest②">LayoutFragmentRequest</a></code>，即生成该片段的请求。
                </p>
            <li data-md="">
                <p><dfn class="dfn-paneled idl-code" data-dfn-for="LayoutFragment" data-dfn-type="attribute"
                        data-export="" id="dom-layoutfragment-generator-slot"><code>[[generator]]</code></dfn>生成该片段的生成器。
                </p>
        </ul>
        <hr>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment④">LayoutFragment</a></code>表示一个
            CSS <a data-link-type="dfn" href="https://www.w3.org/TR/css3-break/#fragment"
                id="ref-for-fragment①">片段</a>，该片段是在<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①⑧">LayoutChild</a></code>上执行布局后生成的。这是由<code
                class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment③">layoutNextFragment()</a></code>方法生成的。
        </p>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment⑤">LayoutFragment</a></code>具有<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlinesize" id="ref-for-dom-layoutfragment-inlinesize">inlineSize</a></code>和<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blocksize" id="ref-for-dom-layoutfragment-blocksize">blockSize</a></code>属性，这些属性由相应子元素的布局算法设置。它们表示该
            CSS <a data-link-type="dfn" href="https://www.w3.org/TR/css3-break/#fragment"
                id="ref-for-fragment②">片段</a>的<b>边框盒</b>大小，且相对于<a data-link-type="dfn" href="#current-layout"
                id="ref-for-current-layout②">当前布局</a>的书写模式。</p>
        <p><code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlinesize" id="ref-for-dom-layoutfragment-inlinesize①">inlineSize</a></code>和<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blocksize" id="ref-for-dom-layoutfragment-blocksize①">blockSize</a></code>属性不可更改。如果<a
                data-link-type="dfn" href="#current-layout" id="ref-for-current-layout③">当前布局</a>需要不同的<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlinesize" id="ref-for-dom-layoutfragment-inlinesize②">inlineSize</a></code>或<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blocksize" id="ref-for-dom-layoutfragment-blocksize②">blockSize</a></code>，则作者必须再次执行<code
                class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment④">layoutNextFragment()</a></code>，并使用不同的参数来获得不同的结果。
        </p>
        <p>当前布局中的作者可以通过设置其<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlineoffset" id="ref-for-dom-layoutfragment-inlineoffset">inlineOffset</a></code>和<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blockoffset" id="ref-for-dom-layoutfragment-blockoffset">blockOffset</a></code>属性来定位生成的<code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment⑥">LayoutFragment</a></code>。如果作者未设置，它们默认值为零。<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlineoffset" id="ref-for-dom-layoutfragment-inlineoffset①">inlineOffset</a></code>和<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blockoffset" id="ref-for-dom-layoutfragment-blockoffset①">blockOffset</a></code>属性表示<code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment⑦">LayoutFragment</a></code>相对于其父元素<b>边框盒</b>的位置，未应用变换或定位（例如，如果片段是<a
                data-link-type="dfn" href="https://www.w3.org/TR/css3-positioning/#relative-position"
                id="ref-for-relative-position">相对定位</a>的情况）。</p>
        <div class="example" id="example-b52e89c9">
            <a class="self-link" href="#example-b52e89c9"></a>布局算法执行块状布局（按块方向顺序排列片段），同时将其子元素在内联方向上居中对齐。
            <pre class="lang-javascript highlight">registerLayout<span class="p">(</span><span class="s1">'block-like'</span><span class="p">,</span> <span class="kr">class</span> <span class="p">{</span>
    <span class="o">*</span>intrinsicSizes<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> styleMap<span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> childrenSizes <span class="o">=</span> <span class="k">yield</span> children<span class="p">.</span>map<span class="p">((</span>child<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
          <span class="k">return</span> child<span class="p">.</span>intrinsicSizes<span class="p">();</span>
      <span class="p">});</span>

      <span class="kr">const</span> maxContentSize <span class="o">=</span> childrenSizes<span class="p">.</span>reduce<span class="p">((</span>max<span class="p">,</span> childSizes<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
          <span class="k">return</span> Math<span class="p">.</span>max<span class="p">(</span>max<span class="p">,</span> childSizes<span class="p">.</span>maxContentSize<span class="p">);</span>
      <span class="p">},</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> edges<span class="p">.</span>all<span class="p">.</span>inline<span class="p">;</span>

      <span class="kr">const</span> minContentSize <span class="o">=</span> childrenSizes<span class="p">.</span>reduce<span class="p">((</span>max<span class="p">,</span> childSizes<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
          <span class="k">return</span> Math<span class="p">.</span>max<span class="p">(</span>max<span class="p">,</span> childSizes<span class="p">.</span>minContentSize<span class="p">);</span>
      <span class="p">},</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> edges<span class="p">.</span>all<span class="p">.</span>inline<span class="p">;</span>

      <span class="k">return</span> <span class="p">{</span>maxContentSize<span class="p">,</span> minContentSize<span class="p">};</span>
    <span class="p">}</span>

    <span class="o">*</span>layout<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> constraints<span class="p">,</span> styleMap<span class="p">)</span> <span class="p">{</span>
        <span class="kr">const</span> availableInlineSize <span class="o">=</span> constraints<span class="p">.</span>fixedInlineSize <span class="o">-</span> edges<span class="p">.</span>all<span class="p">.</span>inline<span class="p">;</span>
        <span class="kr">const</span> availableBlockSize <span class="o">=</span> <span class="p">(</span>constraints<span class="p">.</span>fixedBlockSize <span class="o">||</span> <span class="kc">Infinity</span><span class="p">)</span> <span class="o">-</span> edges<span class="p">.</span>all<span class="p">.</span>block<span class="p">;</span>

        <span class="kr">const</span> childFragments <span class="o">=</span> <span class="p">[];</span>
        <span class="kr">const</span> childConstraints <span class="o">=</span> <span class="p">{</span> availableInlineSize<span class="p">,</span> availableBlockSize <span class="p">};</span>

        <span class="kr">const</span> childFragments <span class="o">=</span> <span class="k">yield</span> children<span class="p">.</span>map<span class="p">((</span>child<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
            <span class="k">return</span> child<span class="p">.</span>layoutNextFragment<span class="p">(</span>childConstraints<span class="p">);</span>
        <span class="p">});</span>

        <span class="kd">let</span> blockOffset <span class="o">=</span> edges<span class="p">.</span>all<span class="p">.</span>blockStart<span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> fragment <span class="k">of</span> childFragments<span class="p">)</span> <span class="p">{</span>
            <span class="c1">// 按块状方式排列片段，并在内联方向居中。</span>
            fragment<span class="p">.</span>blockOffset <span class="o">=</span> blockOffset<span class="p">;</span>
            fragment<span class="p">.</span>inlineOffset <span class="o">=</span> Math<span class="p">.</span>max<span class="p">(</span>
                edges<span class="p">.</span>all<span class="p">.</span>inlineStart<span class="p">,</span>
                <span class="p">(</span>availableInlineSize <span class="o">-</span> fragment<span class="p">.</span>inlineSize<span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>

            blockOffset <span class="o">+=</span> fragment<span class="p">.</span>blockSize<span class="p">;</span>
        <span class="p">}</span>

        <span class="kr">const</span> autoBlockSize <span class="o">=</span> blockOffset <span class="o">+</span> edges<span class="p">.</span>all<span class="p">.</span>blockEnd<span class="p">;</span>

        <span class="k">return</span> <span class="p">{</span>
            autoBlockSize<span class="p">,</span>
            childFragments<span class="p">,</span>
        <span class="p">};</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre>
        </div>
        <p><a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container⑧">布局 API
                容器</a>可以通过<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-data" id="ref-for-dom-layoutfragment-data">data</a></code>属性与其他<a
                data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container⑨">布局 API
                容器</a>通信。该属性由<code
                class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-data" id="ref-for-dom-fragmentresultoptions-data">data</a></code>成员在<code
                class="idl"><a data-link-type="idl" href="#dictdef-fragmentresultoptions" id="ref-for-dictdef-fragmentresultoptions">FragmentResultOptions</a></code>字典中设置。
        </p>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment⑧">LayoutFragment</a></code>的<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken">breakToken</a></code>指定了<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①⑨">LayoutChild</a></code>最后一次分割的位置。如果<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken①">breakToken</a></code>为null，则<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②⓪">LayoutChild</a></code>不会为该token链生成更多<code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment⑨">LayoutFragment</a></code>。<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken②">breakToken</a></code>可以传递给<code
                class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment⑤">layoutNextFragment()</a></code>函数以为特定子元素生成下一个<code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①⓪">LayoutFragment</a></code>。<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken③">breakToken</a></code>不可更改。如果<a
                data-link-type="dfn" href="#current-layout" id="ref-for-current-layout④">当前布局</a>需要不同的<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken④">breakToken</a></code>，作者必须再次执行<code
                class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment⑥">layoutNextFragment()</a></code>，并使用不同的参数。
        </p>
        <div class="algorithm" data-algorithm="create a layout fragment">
            当用户代理想要在给定<var>generator</var>、<var>layoutFragmentRequest</var>和<var>internalFragment</var>的情况下<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="create-a-layout-fragment">创建布局片段</dfn>时，<em>必须</em>执行以下步骤：
            <ol>
                <li data-md="">
                    <p>将<var>targetRealm</var>设置为<var>generator</var>的<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm"
                            id="ref-for-concept-global-object-realm">域</a>。</p>
                <li data-md="">
                    <p>创建一个新的<code
                            class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①①">LayoutFragment</a></code>，其包含：
                    </p>
                    <ul>
                        <li data-md="">
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragment-layoutfragmentrequest-slot" id="ref-for-dom-layoutfragment-layoutfragmentrequest-slot">[[layoutFragmentRequest]]</a></code>内部槽位设置为<var>layoutFragmentRequest</var>。
                            </p>
                        <li data-md="">
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragment-generator-slot" id="ref-for-dom-layoutfragment-generator-slot">[[generator]]</a></code>内部槽位设置为<var>generator</var>。
                            </p>
                        <li data-md="">
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlinesize" id="ref-for-dom-layoutfragment-inlinesize③">inlineSize</a></code>设置为<var>internalFragment</var>相对于<a
                                    data-link-type="dfn" href="#current-layout"
                                    id="ref-for-current-layout⑤">当前布局</a>书写模式的<a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-writing-modes-3/#inline-size"
                                    id="ref-for-inline-size">内联大小</a>。</p>
                        <li data-md="">
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blocksize" id="ref-for-dom-layoutfragment-blocksize③">blockSize</a></code>设置为<var>internalFragment</var>相对于<a
                                    data-link-type="dfn" href="#current-layout"
                                    id="ref-for-current-layout⑥">当前布局</a>书写模式的<a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-writing-modes-3/#block-size"
                                    id="ref-for-block-size">块大小</a>。</p>
                        <li data-md="">
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlineoffset" id="ref-for-dom-layoutfragment-inlineoffset②">inlineOffset</a></code>初始值为0。
                            </p>
                        <li data-md="">
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blockoffset" id="ref-for-dom-layoutfragment-blockoffset②">blockOffset</a></code>初始值为0。
                            </p>
                        <li data-md="">
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken⑤">breakToken</a></code>设置为一个新的<code
                                    class="idl"><a data-link-type="idl" href="#childbreaktoken" id="ref-for-childbreaktoken②">ChildBreakToken</a></code>，表示<var>internalFragment</var>的内部断点标记（如果有的话）。
                            </p>
                        <li data-md="">
                            <p>如果<var>internalFragment</var>中存储了一个<var>clonedData</var>对象，则将<code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragment-data" id="ref-for-dom-layoutfragment-data①">data</a></code>设置为<a
                                    data-link-type="dfn" href="https://html.spec.whatwg.org/#structureddeserialize"
                                    id="ref-for-structureddeserialize">StructuredDeserialize</a>(<var>clonedData</var>，<var>targetRealm</var>)的结果，否则为null。
                            </p>
                    </ul>
                <li data-md="">
                    <p>返回<var>fragment</var>。</p>
            </ol>
        </div>
        <h3 class="heading settled" data-level="3.3" id="intrinsic-sizes"><span class="secno">3.3. </span><span
                class="content">固有尺寸</span><a class="self-link" href="#intrinsic-sizes"></a></h3>
        <pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed②">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="intrinsicsizes"><code>IntrinsicSizes</code></dfn> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double④"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="IntrinsicSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-intrinsicsizes-mincontentsize"><code>minContentSize</code></dfn>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑤"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="IntrinsicSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-intrinsicsizes-maxcontentsize"><code>maxContentSize</code></dfn>;
};
</pre>
        <p><code
                class="idl"><a data-link-type="idl" href="#intrinsicsizes" id="ref-for-intrinsicsizes">IntrinsicSizes</a></code>对象具有以下内部槽位：
        </p>
        <ul>
            <li data-md="">
                <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntrinsicSizes" data-dfn-type="attribute"
                        data-export=""
                        id="dom-intrinsicsizes-intrinsicsizesrequest-slot"><code>[[intrinsicSizesRequest]]</code></dfn>
                    一个<code
                        class="idl"><a data-link-type="idl" href="#intrinsicsizesrequest" id="ref-for-intrinsicsizesrequest②">IntrinsicSizesRequest</a></code>，即生成这些固有尺寸的请求。
                </p>
        </ul>
        <hr>
        <p><code
                class="idl"><a data-link-type="idl" href="#intrinsicsizes" id="ref-for-intrinsicsizes①">IntrinsicSizes</a></code>对象表示一个
            CSS <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box" id="ref-for-box⑨">盒模型</a>的<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-sizing-3/#min-content"
                id="ref-for-min-content">最小内容尺寸</a>和<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-sizing-3/#max-content" id="ref-for-max-content">最大内容尺寸</a>。它具有<code
                class="idl"><a data-link-type="idl" href="#dom-intrinsicsizes-mincontentsize" id="ref-for-dom-intrinsicsizes-mincontentsize">minContentSize</a></code>和<code
                class="idl"><a data-link-type="idl" href="#dom-intrinsicsizes-maxcontentsize" id="ref-for-dom-intrinsicsizes-maxcontentsize">maxContentSize</a></code>属性，这些属性表示<a
                data-link-type="dfn" href="#current-layout" id="ref-for-current-layout⑦">当前布局</a>中<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②①">LayoutChild</a></code>的<b>边框盒</b>最小/最大内容贡献。这些属性相对于<a
                data-link-type="dfn" href="#current-layout" id="ref-for-current-layout⑧">当前布局</a>的书写模式的内联方向。</p>
        <p><code
                class="idl"><a data-link-type="idl" href="#dom-intrinsicsizes-mincontentsize" id="ref-for-dom-intrinsicsizes-mincontentsize①">minContentSize</a></code>和<code
                class="idl"><a data-link-type="idl" href="#dom-intrinsicsizes-maxcontentsize" id="ref-for-dom-intrinsicsizes-maxcontentsize①">maxContentSize</a></code>属性不可更改。在当前布局过程中，<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②②">LayoutChild</a></code>的这些值不能更改。
        </p>
        <div class="example" id="example-43c1ff85">
            <a class="self-link" href="#example-43c1ff85"></a> 下面的示例展示了两个子元素的边框盒固有尺寸。
            <pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">style</span><span class="p">></span>
<span class="p">.</span><span class="nc">child-0</span> <span class="p">{</span>
  <span class="k">width</span><span class="p">:</span> <span class="mi">380</span><span class="kt">px</span><span class="p">;</span>
  <span class="k">border</span><span class="p">:</span> <span class="kc">solid</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">child-1</span> <span class="p">{</span>
  <span class="k">border</span><span class="p">:</span> <span class="kc">solid</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">box</span> <span class="p">{</span>
  <span class="k">display</span><span class="p">:</span> <span class="nf">layout</span><span class="p">(</span><span class="n">intrinsic</span><span class="o">-</span><span class="n">sizes</span><span class="o">-</span><span class="n">example</span><span class="p">);</span>
  <span class="k">font</span><span class="p">:</span> <span class="mi">25</span><span class="kt">px</span><span class="o">/</span><span class="mi">1</span> <span class="n">Ahem</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">></span>

<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"box"</span><span class="p">></span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"child-0"</span><span class="p">>&lt;/</span><span class="nt">div</span><span class="p">></span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"child-1"</span><span class="p">></span>XXX XXXX<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
</pre>
            <pre class="lang-javascript highlight">registerLayout<span class="p">(</span><span class="s1">'intrinsic-sizes-example'</span><span class="p">,</span> <span class="kr">class</span> <span class="p">{</span>
    <span class="o">*</span>intrinsicSizes<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> styleMap<span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> childrenSizes <span class="o">=</span> <span class="k">yield</span> children<span class="p">.</span>map<span class="p">((</span>child<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
          <span class="k">return</span> child<span class="p">.</span>intrinsicSizes<span class="p">();</span>
      <span class="p">});</span>

      childrenSizes<span class="p">[</span><span class="mi">0</span><span class="p">].</span>minContentSize<span class="p">;</span> <span class="c1">// 400, (380+10+10) child has a fixed size.</span>
<span class="c1"></span>      childrenSizes<span class="p">[</span><span class="mi">0</span><span class="p">].</span>maxContentSize<span class="p">;</span> <span class="c1">// 400, (380+10+10) child has a fixed size.</span>
<span class="c1"></span>
      childrenSizes<span class="p">[</span><span class="mi">1</span><span class="p">].</span>minContentSize<span class="p">;</span> <span class="c1">// 100, size of "XXXX".</span>
<span class="c1"></span>      childrenSizes<span class="p">[</span><span class="mi">1</span><span class="p">].</span>maxContentSize<span class="p">;</span> <span class="c1">// 200, size of "XXX XXXX".</span>
<span class="c1"></span>    <span class="p">}</span>

    <span class="o">*</span>layout<span class="p">()</span> <span class="p">{}</span>
<span class="p">});</span>
</pre>
        </div>
        <div class="algorithm" data-algorithm="create an intrinsic sizes object">
            当用户代理想要在给定<var>intrinsicSizesRequest</var>和<var>internalIntrinsicSizes</var>的情况下<dfn class="dfn-paneled"
                data-dfn-type="dfn" data-noexport=""
                id="create-an-intrinsic-sizes-object">创建固有尺寸对象</dfn>时，<em>必须</em>执行以下步骤：
            <ol>
                <li data-md="">
                    <p>创建一个新的<var>intrinsicSizes</var> <code
                            class="idl"><a data-link-type="idl" href="#intrinsicsizes" id="ref-for-intrinsicsizes②">IntrinsicSizes</a></code>对象，包含：
                    </p>
                    <ul>
                        <li data-md="">
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-intrinsicsizes-intrinsicsizesrequest-slot" id="ref-for-dom-intrinsicsizes-intrinsicsizesrequest-slot">[[intrinsicSizesRequest]]</a></code>内部槽位设置为<var>intrinsicSizesRequest</var>。
                            </p>
                        <li data-md="">
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-intrinsicsizes-mincontentsize" id="ref-for-dom-intrinsicsizes-mincontentsize②">minContentSize</a></code>设置为<var>internalIntrinsicSizes</var>的<b>边框盒</b>最小内容贡献，相对于<a
                                    data-link-type="dfn" href="#current-layout"
                                    id="ref-for-current-layout⑨">当前布局</a>的书写模式。</p>
                        <li data-md="">
                            <p><code
                                    class="idl"><a data-link-type="idl" href="#dom-intrinsicsizes-maxcontentsize" id="ref-for-dom-intrinsicsizes-maxcontentsize②">maxContentSize</a></code>设置为<var>internalIntrinsicSizes</var>的<b>边框盒</b>最大内容贡献，相对于<a
                                    data-link-type="dfn" href="#current-layout"
                                    id="ref-for-current-layout①⓪">当前布局</a>的书写模式。</p>
                    </ul>
                <li data-md="">
                    <p>返回<var>intrinsicSizes</var>。</p>
            </ol>
        </div>
        <h3 class="heading settled" data-level="3.4" id="layout-constraints"><span class="secno">3.4. </span><span
                class="content">布局约束</span><a class="self-link" href="#layout-constraints"></a></h3>
        <pre class="idl highlight def">[<dfn class="nv idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="constructor" data-export="" data-lt="LayoutConstraints(options)|LayoutConstraints()" id="dom-layoutconstraints-layoutconstraints"><code>Constructor</code><a class="self-link" href="#dom-layoutconstraints-layoutconstraints"></a></dfn>(<span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-layoutconstraintsoptions" id="ref-for-dictdef-layoutconstraintsoptions">LayoutConstraintsOptions</a> <dfn class="nv idl-code" data-dfn-for="LayoutConstraints/LayoutConstraints(options)" data-dfn-type="argument" data-export="" id="dom-layoutconstraints-layoutconstraints-options-options"><code>options</code><a class="self-link" href="#dom-layoutconstraints-layoutconstraints-options-options"></a></dfn>),<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed③">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="layoutconstraints"><code>LayoutConstraints</code></dfn> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑥"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutconstraints-availableinlinesize"><code>availableInlineSize</code></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑦"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutconstraints-availableblocksize"><code>availableBlockSize</code></dfn>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑧"><span class="kt">double</span></a>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double?" id="dom-layoutconstraints-fixedinlinesize"><code>fixedInlineSize</code></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑨"><span class="kt">double</span></a>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double?" id="dom-layoutconstraints-fixedblocksize"><code>fixedBlockSize</code></dfn>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⓪"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutconstraints-percentageinlinesize"><code>percentageInlineSize</code></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①①"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutconstraints-percentageblocksize"><code>percentageBlockSize</code></dfn>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①②"><span class="kt">double</span></a>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double?" id="dom-layoutconstraints-blockfragmentationoffset"><code>blockFragmentationOffset</code></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#enumdef-blockfragmentationtype" id="ref-for-enumdef-blockfragmentationtype">BlockFragmentationType</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="BlockFragmentationType" id="dom-layoutconstraints-blockfragmentationtype"><code>blockFragmentationType</code></dfn>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">any</span> <dfn class="nv idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="any" id="dom-layoutconstraints-data"><code>data</code><a class="self-link" href="#dom-layoutconstraints-data"></a></dfn>;
};

<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-layoutconstraintsoptions"><code>LayoutConstraintsOptions</code></dfn> {
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①③"><span class="kt">double</span></a> <dfn class="nv idl-code" data-default="0" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-layoutconstraintsoptions-availableinlinesize"><code>availableInlineSize</code><a class="self-link" href="#dom-layoutconstraintsoptions-availableinlinesize"></a></dfn> = 0;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①④"><span class="kt">double</span></a> <dfn class="nv idl-code" data-default="0" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-layoutconstraintsoptions-availableblocksize"><code>availableBlockSize</code><a class="self-link" href="#dom-layoutconstraintsoptions-availableblocksize"></a></dfn> = 0;

    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑤"><span class="kt">double</span></a> <dfn class="nv idl-code" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-layoutconstraintsoptions-fixedinlinesize"><code>fixedInlineSize</code><a class="self-link" href="#dom-layoutconstraintsoptions-fixedinlinesize"></a></dfn>;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑥"><span class="kt">double</span></a> <dfn class="nv idl-code" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-layoutconstraintsoptions-fixedblocksize"><code>fixedBlockSize</code><a class="self-link" href="#dom-layoutconstraintsoptions-fixedblocksize"></a></dfn>;

    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑦"><span class="kt">double</span></a> <dfn class="nv idl-code" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-layoutconstraintsoptions-percentageinlinesize"><code>percentageInlineSize</code><a class="self-link" href="#dom-layoutconstraintsoptions-percentageinlinesize"></a></dfn>;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑧"><span class="kt">double</span></a> <dfn class="nv idl-code" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-layoutconstraintsoptions-percentageblocksize"><code>percentageBlockSize</code><a class="self-link" href="#dom-layoutconstraintsoptions-percentageblocksize"></a></dfn>;

    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑨"><span class="kt">double</span></a> <dfn class="nv idl-code" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-layoutconstraintsoptions-blockfragmentationoffset"><code>blockFragmentationOffset</code><a class="self-link" href="#dom-layoutconstraintsoptions-blockfragmentationoffset"></a></dfn>;
    <a class="n" data-link-type="idl-name" href="#enumdef-blockfragmentationtype" id="ref-for-enumdef-blockfragmentationtype①">BlockFragmentationType</a> <dfn class="nv idl-code" data-default="&quot;none&quot;" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="BlockFragmentationType " id="dom-layoutconstraintsoptions-blockfragmentationtype"><code>blockFragmentationType</code><a class="self-link" href="#dom-layoutconstraintsoptions-blockfragmentationtype"></a></dfn> = "none";

    <span class="kt">any</span> <dfn class="nv idl-code" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="any " id="dom-layoutconstraintsoptions-data"><code>data</code><a class="self-link" href="#dom-layoutconstraintsoptions-data"></a></dfn>;
};

<span class="kt">enum</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-blockfragmentationtype"><code>BlockFragmentationType</code></dfn> { <dfn class="s idl-code" data-dfn-for="BlockFragmentationType" data-dfn-type="enum-value" data-export="" data-lt="&quot;none&quot;|none" id="dom-blockfragmentationtype-none"><code>"none"</code><a class="self-link" href="#dom-blockfragmentationtype-none"></a></dfn>, <dfn class="s idl-code" data-dfn-for="BlockFragmentationType" data-dfn-type="enum-value" data-export="" data-lt="&quot;page&quot;|page" id="dom-blockfragmentationtype-page"><code>"page"</code><a class="self-link" href="#dom-blockfragmentationtype-page"></a></dfn>, <dfn class="s idl-code" data-dfn-for="BlockFragmentationType" data-dfn-type="enum-value" data-export="" data-lt="&quot;column&quot;|column" id="dom-blockfragmentationtype-column"><code>"column"</code><a class="self-link" href="#dom-blockfragmentationtype-column"></a></dfn>, <dfn class="s idl-code" data-dfn-for="BlockFragmentationType" data-dfn-type="enum-value" data-export="" data-lt="&quot;region&quot;|region" id="dom-blockfragmentationtype-region"><code>"region"</code><a class="self-link" href="#dom-blockfragmentationtype-region"></a></dfn> };
</pre>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints①">LayoutConstraints</a></code>对象被传递给布局方法，表示用于<a
                data-link-type="dfn" href="#current-layout"
                id="ref-for-current-layout①①">当前布局</a>进行内部布局的所有约束条件。它还用于将可用空间的信息传递给<a data-link-type="dfn"
                href="#child-layout" id="ref-for-child-layout">子布局</a>。</p>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints②">LayoutConstraints</a></code>对象具有<code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-availableinlinesize" id="ref-for-dom-layoutconstraints-availableinlinesize">availableInlineSize</a></code>和<code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-availableblocksize" id="ref-for-dom-layoutconstraints-availableblocksize">availableBlockSize</a></code>属性。这表示布局中应遵守的<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-sizing-3/#available"
                id="ref-for-available">可用空间</a>，以生成<code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①②">LayoutFragment</a></code>。
        </p>
        <p class="note" role="note"><span>注意：</span> 某些布局可能需要生成超出此尺寸的<code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①③">LayoutFragment</a></code>。例如，一个<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#replaced-element"
                id="ref-for-replaced-element">替换元素</a>。<a data-link-type="dfn" href="#parent-layout"
                id="ref-for-parent-layout">父布局</a>应预期这种情况并适当地处理。</p>
        <p><a data-link-type="dfn" href="#parent-layout" id="ref-for-parent-layout①">父布局</a>可能要求<a data-link-type="dfn"
                href="#current-layout" id="ref-for-current-layout①②">当前布局</a>必须具有特定的尺寸。如果指定了<code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedinlinesize" id="ref-for-dom-layoutconstraints-fixedinlinesize">fixedInlineSize</a></code>或<code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedblocksize" id="ref-for-dom-layoutconstraints-fixedblocksize">fixedBlockSize</a></code>，<a
                data-link-type="dfn" href="#current-layout" id="ref-for-current-layout①③">当前布局</a>应生成具有指定方向上尺寸的<code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①④">LayoutFragment</a></code>。
        </p>
        <div class="example" id="example-3e825702">
            <a class="self-link" href="#example-3e825702"></a> 该布局算法在内联方向上执行类似于弹性盒子的空余空间分配。它创建了子布局约束，指定子元素应具有固定的内联尺寸。
            <pre class="lang-javascript highlight">registerLayout<span class="p">(</span><span class="s1">'flex-distribution-like'</span><span class="p">,</span> <span class="kr">class</span> <span class="p">{</span>
    <span class="o">*</span>intrinsicSizes<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> styleMap<span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> childrenSizes <span class="o">=</span> <span class="k">yield</span> children<span class="p">.</span>map<span class="p">((</span>child<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
          <span class="k">return</span> child<span class="p">.</span>intrinsicSizes<span class="p">();</span>
      <span class="p">});</span>

      <span class="kr">const</span> maxContentSize <span class="o">=</span> childrenSizes<span class="p">.</span>reduce<span class="p">((</span>sum<span class="p">,</span> childSizes<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
          <span class="k">return</span> sum <span class="o">+</span> childSizes<span class="p">.</span>maxContentSize<span class="p">;</span>
      <span class="p">},</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> edges<span class="p">.</span>all<span class="p">.</span>inline<span class="p">;</span>

      <span class="kr">const</span> minContentSize <span class="o">=</span> childrenSizes<span class="p">.</span>reduce<span class="p">((</span>max<span class="p">,</span> childSizes<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
          <span class="k">return</span> sum <span class="o">+</span> childSizes<span class="p">.</span>minContentSize<span class="p">;</span>
      <span class="p">},</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> edges<span class="p">.</span>all<span class="p">.</span>inline<span class="p">;</span>

      <span class="k">return</span> <span class="p">{</span>maxContentSize<span class="p">,</span> minContentSize<span class="p">};</span>
    <span class="p">}</span>

    <span class="o">*</span>layout<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> constraints<span class="p">,</span> styleMap<span class="p">)</span> <span class="p">{</span>

        <span class="kr">const</span> availableInlineSize <span class="o">=</span>
            constraints<span class="p">.</span>fixedInlineSize <span class="o">-</span> edges<span class="p">.</span>all<span class="p">.</span>inline<span class="p">;</span>
        <span class="kr">const</span> availableBlockSize <span class="o">=</span>
            <span class="p">(</span>constraints<span class="p">.</span>fixedInlineSize <span class="o">||</span> <span class="kc">Infinity</span><span class="p">)</span> <span class="o">-</span> edges<span class="p">.</span>all<span class="p">.</span>block<span class="p">;</span>

        <span class="kr">const</span> childConstraints <span class="o">=</span> <span class="p">{</span> availableInlineSize<span class="p">,</span> availableBlockSize <span class="p">};</span>

        <span class="kr">const</span> unconstrainedChildFragments <span class="o">=</span> <span class="k">yield</span> children<span class="p">.</span>map<span class="p">((</span>child<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
            <span class="k">return</span> child<span class="p">.</span>layoutNextFragment<span class="p">(</span>childConstraints<span class="p">);</span>
        <span class="p">});</span>

        <span class="kr">const</span> unconstrainedSizes <span class="o">=</span> <span class="p">[];</span>
        <span class="kr">const</span> totalSize <span class="o">=</span> unconstrainedChildFragments<span class="p">.</span>reduce<span class="p">((</span>sum<span class="p">,</span> fragment<span class="p">,</span> i<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
            unconstrainedSizes<span class="p">[</span>i<span class="p">]</span> <span class="o">=</span> fragment<span class="p">.</span>inlineSize<span class="p">;</span>
            <span class="k">return</span> sum <span class="o">+</span> fragment<span class="p">.</span>inlineSize<span class="p">;</span>
        <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>

        <span class="c1">// 在子元素之间分配剩余空间。</span>
<span class="c1"></span>        <span class="kr">const</span> remainingSpace <span class="o">=</span> Math<span class="p">.</span>max<span class="p">(</span><span class="mi">0</span><span class="p">,</span> inlineSize <span class="o">-</span> totalSize<span class="p">);</span>
        <span class="kr">const</span> extraSpace <span class="o">=</span> remainingSpace <span class="o">/</span> children<span class="p">.</span>length<span class="p">;</span>

        <span class="kr">const</span> childFragments <span class="o">=</span> <span class="k">yield</span> children<span class="p">.</span>map<span class="p">((</span>child<span class="p">,</span> i<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
            <span class="k">return</span> child<span class="p">.</span>layoutNextFragment<span class="p">({</span>
                fixedInlineSize<span class="o">:</span> unconstrainedSizes<span class="p">[</span>i<span class="p">]</span> <span class="o">+</span> extraSpace<span class="p">,</span>
                availableBlockSize
            <span class="p">});</span>
        <span class="p">});</span>

        <span class="c1">// 位置片段。</span>
<span class="c1"></span>        <span class="kd">let</span> inlineOffset <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kd">let</span> maxChildBlockSize <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> fragment <span class="k">of</span> childFragments<span class="p">)</span> <span class="p">{</span>
            fragment<span class="p">.</span>inlineOffset <span class="o">=</span> inlineOffset<span class="p">;</span>
            fragment<span class="p">.</span>blockOffset <span class="o">=</span> edges<span class="p">.</span>all<span class="p">.</span>blockStart<span class="p">;</span>

            inlineOffset <span class="o">+=</span> fragment<span class="p">.</span>inlineSize<span class="p">;</span>
            maxChildBlockSize <span class="o">=</span> Math<span class="p">.</span>max<span class="p">(</span>maxChildBlockSize<span class="p">,</span> fragment<span class="p">.</span>blockSize<span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="p">{</span>
            autoBlockSize<span class="o">:</span> maxChildBlockSize <span class="o">+</span> edges<span class="p">.</span>all<span class="p">.</span>block<span class="p">,</span>
            childFragments<span class="p">,</span>
        <span class="p">};</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre>
        </div>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints③">LayoutConstraints</a></code>对象具有<code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-percentageinlinesize" id="ref-for-dom-layoutconstraints-percentageinlinesize">percentageInlineSize</a></code>和<code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-percentageblocksize" id="ref-for-dom-layoutconstraints-percentageblocksize">percentageBlockSize</a></code>属性。这些属性表示在执行布局时百分比应解析的尺寸。
        </p>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints④">LayoutConstraints</a></code>对象具有<code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationtype" id="ref-for-dom-layoutconstraints-blockfragmentationtype">blockFragmentationType</a></code>属性。<a
                data-link-type="dfn" href="#current-layout" id="ref-for-current-layout①④">当前布局</a>应生成一个在<code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationoffset" id="ref-for-dom-layoutconstraints-blockfragmentationoffset">blockFragmentationOffset</a></code>处进行分片的<code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①⑤">LayoutFragment</a></code>，如果可能的话。
        </p>
        <p><a data-link-type="dfn" href="#current-layout" id="ref-for-current-layout①⑤">当前布局</a>可以根据<code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationtype" id="ref-for-dom-layoutconstraints-blockfragmentationtype①">blockFragmentationType</a></code>选择不对某个<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②③">LayoutChild</a></code>进行分片，例如，如果该子元素具有类似于<a
                class="css" data-link-type="propdesc" href="https://www.w3.org/TR/css3-break/#propdef-break-inside"
                id="ref-for-propdef-break-inside">break-inside: avoid-page;</a>的属性。</p>
        <div class="algorithm" data-algorithm="create a layout constraints object">
            当用户代理想要在给定<var>sizingMode</var>、<var>box</var>和<var>internalLayoutConstraints</var>的情况下<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="create-a-layout-constraints-object">创建布局约束对象</dfn>时，<em>必须</em>执行以下步骤：
            <ol>
                <li data-md="">
                    <p>如果<var>sizingMode</var>为<code>"block-like"</code>，则：</p>
                    <ol>
                        <li data-md="">
                            <p>将<var>fixedInlineSize</var>设置为计算<var>box</var>的<b>边框盒</b><a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-writing-modes-3/#inline-size"
                                    id="ref-for-inline-size①">内联尺寸</a>的结果（相对于<var>box</var>的书写模式），就像块容器一样。</p>
                        <li data-md="">
                            <p>如果<var>box</var>的<a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-writing-modes-3/#block-size"
                                    id="ref-for-block-size①">块尺寸</a>是<a class="css" data-link-type="maybe"
                                    href="https://www.w3.org/TR/css-sizing-3/#valdef-width-auto"
                                    id="ref-for-valdef-width-auto">auto</a>，则将<var>fixedBlockSize</var>设置为null，否则将其设置为计算<var>box</var>的<b>边框盒</b><a
                                    data-link-type="dfn" href="https://www.w3.org/TR/css-writing-modes-3/#block-size"
                                    id="ref-for-block-size②">块尺寸</a>的结果，就像块容器一样。</p>
                        <li data-md="">
                            <p>返回一个新的<code
                                    class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints⑤">LayoutConstraints</a></code>对象，包含：
                            </p>
                            <ul>
                                <li data-md="">
                                    <p>设置<code
                                            class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedinlinesize" id="ref-for-dom-layoutconstraints-fixedinlinesize①">fixedInlineSize</a></code>和<code
                                            class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-availableinlinesize" id="ref-for-dom-layoutconstraints-availableinlinesize①">availableInlineSize</a></code>为<var>fixedInlineSize</var>。
                                    </p>
                                <li data-md="">
                                    <p>将<code
                                            class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-percentageinlinesize" id="ref-for-dom-layoutconstraints-percentageinlinesize①">percentageInlineSize</a></code>设置为<var>internalLayoutConstraints</var>的内联轴百分比解析尺寸（相对于<var>box</var>的书写模式）。
                                    </p>
                                <li data-md="">
                                    <p>将<code
                                            class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedblocksize" id="ref-for-dom-layoutconstraints-fixedblocksize①">fixedBlockSize</a></code>设置为<var>fixedBlockSize</var>。
                                    </p>
                                <li data-md="">
                                    <p>如果<var>fixedBlockSize</var>不为null，则将<code
                                            class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-availableblocksize" id="ref-for-dom-layoutconstraints-availableblocksize①">availableBlockSize</a></code>设置为<var>fixedBlockSize</var>，否则设置为<var>internalLayoutConstraints</var>在块轴上的<a
                                            data-link-type="dfn" href="https://www.w3.org/TR/css-sizing-3/#available"
                                            id="ref-for-available①">可用空间</a>（相对于<var>box</var>的书写模式）。</p>
                                <li data-md="">
                                    <p>将<code
                                            class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-percentageblocksize" id="ref-for-dom-layoutconstraints-percentageblocksize①">percentageBlockSize</a></code>设置为<var>internalLayoutConstraints</var>在块轴上的百分比解析尺寸（相对于<var>box</var>的书写模式）。
                                    </p>
                            </ul>
                    </ol>
                <li data-md="">
                    <p>如果<var>sizingMode</var>为<code>"manual"</code>，则：</p>
                    <ol>
                        <li data-md="">
                            <p>返回一个新的<code
                                    class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints⑥">LayoutConstraints</a></code>对象，包含：
                            </p>
                            <ul>
                                <li data-md="">
                                    <p>将<code
                                            class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedinlinesize" id="ref-for-dom-layoutconstraints-fixedinlinesize②">fixedInlineSize</a></code>/<code
                                            class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedblocksize" id="ref-for-dom-layoutconstraints-fixedblocksize②">fixedBlockSize</a></code>设置为<var>internalLayoutConstraints</var>的固定内联/块尺寸（相对于<var>box</var>的书写模式），由<a
                                            data-link-type="dfn" href="#parent-layout"
                                            id="ref-for-parent-layout②">父布局</a>强加。两者中的任意一个都可以为null。</p>
                                    <p class="note" role="note"><span>注意：</span>请参阅<a href="#interaction-sizing">§4.1
                                            尺寸</a>以了解可能发生此情况的不同场景。</p>
                                <li data-md="">
                                    <p>将<code
                                            class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-availableinlinesize" id="ref-for-dom-layoutconstraints-availableinlinesize②">availableInlineSize</a></code>/<code
                                            class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-availableblocksize" id="ref-for-dom-layoutconstraints-availableblocksize②">availableBlockSize</a></code>设置为<var>internalLayoutConstraints</var>的<a
                                            data-link-type="dfn" href="https://www.w3.org/TR/css-sizing-3/#available"
                                            id="ref-for-available②">可用空间</a>。</p>
                                <li data-md="">
                                    <p>将<code
                                            class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-percentageinlinesize" id="ref-for-dom-layoutconstraints-percentageinlinesize②">percentageInlineSize</a></code>/<code
                                            class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-percentageblocksize" id="ref-for-dom-layoutconstraints-percentageblocksize②">percentageBlockSize</a></code>设置为<var>internalLayoutConstraints</var>的百分比解析尺寸。
                                    </p>
                            </ul>
                    </ol>
            </ol>
        </div>
        <h3 class="heading settled" data-level="3.5" id="breaking-and-fragmentation"><span class="secno">3.5.
            </span><span class="content">分割与碎片化</span><a class="self-link" href="#breaking-and-fragmentation"></a></h3>
        <pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed④">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="childbreaktoken"><code>ChildBreakToken</code></dfn> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#enumdef-breaktype" id="ref-for-enumdef-breaktype">BreakType</a> <dfn class="nv idl-code" data-dfn-for="ChildBreakToken" data-dfn-type="attribute" data-export="" data-readonly="" data-type="BreakType" id="dom-childbreaktoken-breaktype"><code>breakType</code><a class="self-link" href="#dom-childbreaktoken-breaktype"></a></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutchild" id="ref-for-layoutchild②④">LayoutChild</a> <dfn class="nv idl-code" data-dfn-for="ChildBreakToken" data-dfn-type="attribute" data-export="" data-readonly="" data-type="LayoutChild" id="dom-childbreaktoken-child"><code>child</code><a class="self-link" href="#dom-childbreaktoken-child"></a></dfn>;
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑤">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="breaktoken"><code>BreakToken</code></dfn> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken③">ChildBreakToken</a>> <dfn class="nv idl-code" data-dfn-for="BreakToken" data-dfn-type="attribute" data-export="" data-readonly="" data-type="sequence<ChildBreakToken>" id="dom-breaktoken-childbreaktokens"><code>childBreakTokens</code><a class="self-link" href="#dom-breaktoken-childbreaktokens"></a></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">any</span> <dfn class="nv idl-code" data-dfn-for="BreakToken" data-dfn-type="attribute" data-export="" data-readonly="" data-type="any" id="dom-breaktoken-data"><code>data</code><a class="self-link" href="#dom-breaktoken-data"></a></dfn>;
};

<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-breaktokenoptions"><code>BreakTokenOptions</code></dfn> {
    <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken④">ChildBreakToken</a>> <dfn class="nv idl-code" data-dfn-for="BreakTokenOptions" data-dfn-type="dict-member" data-export="" data-type="sequence<ChildBreakToken> " id="dom-breaktokenoptions-childbreaktokens"><code>childBreakTokens</code><a class="self-link" href="#dom-breaktokenoptions-childbreaktokens"></a></dfn>;
    <span class="kt">any</span> <dfn class="nv idl-code" data-default="null" data-dfn-for="BreakTokenOptions" data-dfn-type="dict-member" data-export="" data-type="any " id="dom-breaktokenoptions-data"><code>data</code><a class="self-link" href="#dom-breaktokenoptions-data"></a></dfn> = <span class="kt">null</span>;
};

<span class="kt">enum</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-breaktype"><code>BreakType</code></dfn> { <dfn class="s idl-code" data-dfn-for="BreakType" data-dfn-type="enum-value" data-export="" data-lt="&quot;none&quot;|none" id="dom-breaktype-none"><code>"none"</code><a class="self-link" href="#dom-breaktype-none"></a></dfn>, <dfn class="s idl-code" data-dfn-for="BreakType" data-dfn-type="enum-value" data-export="" data-lt="&quot;line&quot;|line" id="dom-breaktype-line"><code>"line"</code><a class="self-link" href="#dom-breaktype-line"></a></dfn>, <dfn class="s idl-code" data-dfn-for="BreakType" data-dfn-type="enum-value" data-export="" data-lt="&quot;column&quot;|column" id="dom-breaktype-column"><code>"column"</code><a class="self-link" href="#dom-breaktype-column"></a></dfn>, <dfn class="s idl-code" data-dfn-for="BreakType" data-dfn-type="enum-value" data-export="" data-lt="&quot;page&quot;|page" id="dom-breaktype-page"><code>"page"</code><a class="self-link" href="#dom-breaktype-page"></a></dfn>, <dfn class="s idl-code" data-dfn-for="BreakType" data-dfn-type="enum-value" data-export="" data-lt="&quot;region&quot;|region" id="dom-breaktype-region"><code>"region"</code><a class="self-link" href="#dom-breaktype-region"></a></dfn> };
</pre>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②⑤">LayoutChild</a></code>可以生成多个<code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①⑥">LayoutFragment</a></code>。
            如果<code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationtype" id="ref-for-dom-layoutconstraints-blockfragmentationtype②">blockFragmentationType</a></code>不为none，则<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②⑥">LayoutChild</a></code>可以在块方向上分片。此外，表示<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-level"
                id="ref-for-inline-level②">内联级</a>内容的<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②⑦">LayoutChild</a></code>可能会逐行分片，如果<a
                data-link-type="dfn" href="#document-layout-definition-layout-options"
                id="ref-for-document-layout-definition-layout-options③">布局选项</a>的<code
                class="idl"><a data-link-type="idl" href="#dom-layoutoptions-childdisplay" id="ref-for-dom-layoutoptions-childdisplay③">childDisplay</a></code>（由<code>layoutOptions</code>设置）为<code>"normal"</code>。
        </p>
        <p>可以使用前一个<code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①⑧">LayoutFragment</a></code>的<code
                class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken⑥">breakToken</a></code>生成后续的<code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①⑦">LayoutFragment</a></code>。
            这告诉<a data-link-type="dfn" href="#child-layout" id="ref-for-child-layout①">子布局</a>从编码在<code
                class="idl"><a data-link-type="idl" href="#childbreaktoken" id="ref-for-childbreaktoken⑤">ChildBreakToken</a></code>中的点开始生成<code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①⑨">LayoutFragment</a></code>。
        </p>
        <div class="example" id="example-a07cbd1c">
            <a class="self-link" href="#example-a07cbd1c"></a>此示例显示了一个简单的布局，缩进子片段一定的行数。
            <p>此示例还演示了如何使用<code
                    class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken⑦">breakToken</a></code>生成<code
                    class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②⑧">LayoutChild</a></code>的下一个片段。
            </p>
            <p>它还演示了如何使用<code
                    class="idl"><a data-link-type="idl" href="#breaktoken" id="ref-for-breaktoken">BreakToken</a></code>来符合<code
                    class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints⑦">LayoutConstraints</a></code>的<code
                    class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationtype" id="ref-for-dom-layoutconstraints-blockfragmentationtype③">blockFragmentationType</a></code>，它从上一个<code
                    class="idl"><a data-link-type="idl" href="#breaktoken" id="ref-for-breaktoken①">BreakToken</a></code>继续布局。
                它返回一个带有<code
                    class="idl"><a data-link-type="idl" href="#dictdef-fragmentresultoptions" id="ref-for-dictdef-fragmentresultoptions①">FragmentResultOptions</a></code>的<code
                    class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-breaktoken" id="ref-for-dom-fragmentresultoptions-breaktoken">breakToken</a></code>，用于恢复布局。
            </p>
            <pre class="lang-javascript highlight">registerLayout<span class="p">(</span><span class="s1">'indent-lines'</span><span class="p">,</span> <span class="kr">class</span> <span class="p">{</span>
    <span class="kr">static</span> layoutOptions <span class="o">=</span> <span class="p">{</span>childDisplay<span class="o">:</span> <span class="s1">'normal'</span><span class="p">};</span>
    <span class="kr">static</span> inputProperties <span class="o">=</span> <span class="p">[</span><span class="s1">'--indent'</span><span class="p">,</span> <span class="s1">'--indent-lines'</span><span class="p">];</span>

    <span class="o">*</span>layout<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> constraints<span class="p">,</span> styleMap<span class="p">,</span> breakToken<span class="p">)</span> <span class="p">{</span>

        <span class="c1">// 确定我们的（内部）可用尺寸。</span>
<span class="c1"></span>        <span class="kr">const</span> availableInlineSize <span class="o">=</span>
            constraints<span class="p">.</span>fixedInlineSize <span class="o">-</span> edges<span class="p">.</span>all<span class="p">.</span>inline<span class="p">;</span>
        <span class="kr">const</span> availableBlockSize <span class="o">=</span>
            <span class="p">(</span>constraints<span class="p">.</span>fixedBlockSize <span class="o">||</span> <span class="kc">Infinity</span><span class="p">)</span> <span class="o">-</span> edges<span class="p">.</span>all<span class="p">.</span>block<span class="p">;</span>

        <span class="c1">// 确定要缩进的行数和缩进量。</span>
<span class="c1"></span>        <span class="kr">const</span> indent <span class="o">=</span> resolveLength<span class="p">(</span>constraints<span class="p">,</span> styleMap<span class="p">.</span>get<span class="p">(</span><span class="s1">'--indent'</span><span class="p">));</span>
        <span class="kd">let</span> lines <span class="o">=</span> styleMap<span class="p">.</span>get<span class="p">(</span><span class="s1">'--indent-lines'</span><span class="p">).</span>value<span class="p">;</span>

        <span class="kr">const</span> childFragments <span class="o">=</span> <span class="p">[];</span>

        <span class="kd">let</span> childBreakToken <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span>breakToken<span class="p">)</span> <span class="p">{</span>
            childBreakToken <span class="o">=</span> breakToken<span class="p">.</span>childBreakTokens<span class="p">[</span><span class="mi">0</span><span class="p">];</span>

            <span class="c1">// 删除所有已为其生成片段的子元素。</span>
<span class="c1"></span>            children<span class="p">.</span>splice<span class="p">(</span><span class="mi">0</span><span class="p">,</span> children<span class="p">.</span>indexOf<span class="p">(</span>childBreakToken<span class="p">.</span>child<span class="p">));</span>
        <span class="p">}</span>

        <span class="kd">let</span> blockOffset <span class="o">=</span> edges<span class="p">.</span>all<span class="p">.</span>blockStart<span class="p">;</span>
        <span class="kd">let</span> child <span class="o">=</span> children<span class="p">.</span>shift<span class="p">();</span>
        <span class="k">while</span> <span class="p">(</span>child<span class="p">)</span> <span class="p">{</span>
            <span class="kr">const</span> shouldIndent <span class="o">=</span> lines<span class="o">--</span> <span class="o">></span> <span class="mi">0</span><span class="p">;</span>

            <span class="c1">// 调整缩进的内联尺寸。</span>
<span class="c1"></span>            <span class="kr">const</span> childAvailableInlineSize <span class="o">=</span> shouldIndent <span class="o">?</span>
                availableInlineSize <span class="o">-</span> indent <span class="o">:</span> availableInlineSize<span class="p">;</span>

            <span class="kr">const</span> childConstraints <span class="o">=</span> <span class="p">{</span>
                availableInlineSize<span class="o">:</span> childAvailableInlineSize<span class="p">,</span>
                availableBlockSize<span class="p">,</span>
                percentageInlineSize<span class="o">:</span> availableInlineSize<span class="p">,</span>
                blockFragmentationType<span class="o">:</span> constraints<span class="p">.</span>blockFragmentationType<span class="p">,</span>
            <span class="p">};</span>

            <span class="kr">const</span> fragment <span class="o">=</span> <span class="k">yield</span> child<span class="p">.</span>layoutNextFragment<span class="p">(</span>childConstraints<span class="p">,</span>
                                                            childBreakToken<span class="p">);</span>
            childFragments<span class="p">.</span>push<span class="p">(</span>fragment<span class="p">);</span>

            <span class="c1">// 定位片段。</span>
<span class="c1"></span>            fragment<span class="p">.</span>inlineOffset <span class="o">=</span> shouldIndent <span class="o">?</span>
                edges<span class="p">.</span>all<span class="p">.</span>inlineStart <span class="o">+</span> indent <span class="o">:</span> edges<span class="p">.</span>all<span class="p">.</span>inlineStart<span class="p">;</span>
            fragment<span class="p">.</span>blockOffset <span class="o">=</span> blockOffset<span class="p">;</span>
            blockOffset <span class="o">+=</span> fragment<span class="p">.</span>blockSize<span class="p">;</span>

            <span class="c1">// 检查我们是否已超出块分割限制。</span>
<span class="c1"></span>            <span class="k">if</span> <span class="p">(</span>constraints<span class="p">.</span>blockFragmentationType <span class="o">!=</span> <span class="s1">'none'</span> <span class="o">&amp;&amp;</span>
                blockOffset <span class="o">></span> constraints<span class="p">.</span>blockSize<span class="p">)</span> <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span>fragment<span class="p">.</span>breakToken<span class="p">)</span> <span class="p">{</span>
                childBreakToken <span class="o">=</span> fragment<span class="p">.</span>breakToken<span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="c1">// 如果片段没有断点标记，我们将继续处理下一个子元素。</span>
<span class="c1"></span>                <span class="c1">// 下一个子元素。</span>
<span class="c1"></span>                child <span class="o">=</span> children<span class="p">.</span>shift<span class="p">();</span>
                childBreakToken <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kr">const</span> autoBlockSize <span class="o">=</span> blockOffset <span class="o">+</span> edges<span class="p">.</span>all<span class="p">.</span>blockEnd<span class="p">;</span>

        <span class="c1">// 返回我们的片段。</span>
<span class="c1"></span>        <span class="kr">const</span> result <span class="o">=</span> <span class="p">{</span>
            autoBlockSize<span class="p">,</span>
            childFragments<span class="o">:</span> childFragments<span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span>childBreakToken<span class="p">)</span> <span class="p">{</span>
            result<span class="p">.</span>breakToken <span class="o">=</span> <span class="p">{</span>
                childBreakTokens<span class="o">:</span> <span class="p">[</span>childBreakToken<span class="p">],</span>
            <span class="p">};</span>
        <span class="p">}</span>

        <span class="k">return</span> result<span class="p">;</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre>
        </div>
        <h3 class="heading settled" data-level="3.6" id="edges"><span class="secno">3.6. </span><span
                class="content">边缘</span><a class="self-link" href="#edges"></a></h3>
        <pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑥">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="layoutedgesizes"><code>LayoutEdgeSizes</code></dfn> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⓪"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdgeSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutedgesizes-inlinestart"><code>inlineStart</code></dfn>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②①"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdgeSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutedgesizes-inlineend"><code>inlineEnd</code></dfn>;

  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②②"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdgeSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutedgesizes-blockstart"><code>blockStart</code></dfn>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②③"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdgeSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutedgesizes-blockend"><code>blockEnd</code></dfn>;

  // Convenience attributes for the sum in one direction.
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②④"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdgeSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutedgesizes-inline"><code>inline</code></dfn>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑤"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdgeSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutedgesizes-block"><code>block</code></dfn>;
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑦">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="layoutedges"><code>LayoutEdges</code></dfn> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes">LayoutEdgeSizes</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdges" data-dfn-type="attribute" data-export="" data-readonly="" data-type="LayoutEdgeSizes" id="dom-layoutedges-border"><code>border</code></dfn>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes①">LayoutEdgeSizes</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdges" data-dfn-type="attribute" data-export="" data-readonly="" data-type="LayoutEdgeSizes" id="dom-layoutedges-scrollbar"><code>scrollbar</code></dfn>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes②">LayoutEdgeSizes</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdges" data-dfn-type="attribute" data-export="" data-readonly="" data-type="LayoutEdgeSizes" id="dom-layoutedges-padding"><code>padding</code></dfn>;

  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes③">LayoutEdgeSizes</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdges" data-dfn-type="attribute" data-export="" data-readonly="" data-type="LayoutEdgeSizes" id="dom-layoutedges-all"><code>all</code></dfn>;
};
</pre>
        <p>一个 <code
                class="idl"><a data-link-type="idl" href="#layoutedges" id="ref-for-layoutedges">LayoutEdges</a></code>
            对象被传入布局方法。它表示正在布局的当前框的 <a data-link-type="dfn" href="https://www.w3.org/TR/CSS21/box.html#box-dimensions"
                id="ref-for-box-dimensions">盒模型边缘</a> 的大小。</p>
        <p>这个 <code
                class="idl"><a data-link-type="idl" href="#layoutedges" id="ref-for-layoutedges①">LayoutEdges</a></code>
            对象有 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutedges-border" id="ref-for-dom-layoutedges-border">border</a></code>、
            <code
                class="idl"><a data-link-type="idl" href="#dom-layoutedges-scrollbar" id="ref-for-dom-layoutedges-scrollbar">scrollbar</a></code>
            和 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutedges-padding" id="ref-for-dom-layoutedges-padding">padding</a></code>
            属性。每个属性都表示其相应边缘的宽度。
        </p>
        <p>这个 <code
                class="idl"><a data-link-type="idl" href="#layoutedges" id="ref-for-layoutedges②">LayoutEdges</a></code>
            对象有 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutedges-all" id="ref-for-dom-layoutedges-all">all</a></code>
            属性。它是一个便捷属性，表示 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutedges-border" id="ref-for-dom-layoutedges-border①">border</a></code>、<code
                class="idl"><a data-link-type="idl" href="#dom-layoutedges-scrollbar" id="ref-for-dom-layoutedges-scrollbar①">scrollbar</a></code>
            和 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutedges-padding" id="ref-for-dom-layoutedges-padding①">padding</a></code>
            边缘的总和。</p>
        <p>这个 <code
                class="idl"><a data-link-type="idl" href="#layoutedgesizes" id="ref-for-layoutedgesizes④">LayoutEdgeSizes</a></code>
            对象表示每个 <a data-link-type="dfn" href="https://www.w3.org/TR/css-writing-modes-3/#abstract-dimensions"
                id="ref-for-abstract-dimensions">抽象方向</a>（<code
                class="idl"><a data-link-type="idl" href="#dom-layoutedgesizes-inlinestart" id="ref-for-dom-layoutedgesizes-inlinestart">inlineStart</a></code>、<code
                class="idl"><a data-link-type="idl" href="#dom-layoutedgesizes-inlineend" id="ref-for-dom-layoutedgesizes-inlineend">inlineEnd</a></code>、<code
                class="idl"><a data-link-type="idl" href="#dom-layoutedgesizes-blockstart" id="ref-for-dom-layoutedgesizes-blockstart">blockStart</a></code>、<code
                class="idl"><a data-link-type="idl" href="#dom-layoutedgesizes-blockend" id="ref-for-dom-layoutedgesizes-blockend">blockEnd</a></code>）中边缘的宽度，以CSS像素为单位。
        </p>
        <p>这个 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutedgesizes-inline" id="ref-for-dom-layoutedgesizes-inline">inline</a></code>
            和 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutedgesizes-block" id="ref-for-dom-layoutedgesizes-block">block</a></code>
            是 <code
                class="idl"><a data-link-type="idl" href="#layoutedgesizes" id="ref-for-layoutedgesizes⑤">LayoutEdgeSizes</a></code>
            对象上的便捷属性，表示该方向的总和。</p>
        <div class="example" id="example-9efc3451">
            <a class="self-link" href="#example-9efc3451"></a> 此示例展示了一个通过CSS样式化的节点，以及它的 <code
                class="idl"><a data-link-type="idl" href="#layoutedges" id="ref-for-layoutedges③">LayoutEdges</a></code>
            可能包含的内容。
            <pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">style</span><span class="p">></span>
<span class="p">.</span><span class="nc">container</span> <span class="p">{</span>
  <span class="k">width</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
  <span class="k">height</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">box</span> <span class="p">{</span>
  <span class="k">display</span><span class="p">:</span> <span class="nf">layout</span><span class="p">(</span><span class="n">box</span><span class="o">-</span><span class="kc">edges</span><span class="p">);</span>

  <span class="k">padding</span><span class="p">:</span> <span class="mi">10</span><span class="kt">%</span><span class="p">;</span>
  <span class="k">border</span><span class="p">:</span> <span class="kc">solid</span> <span class="mi">2</span><span class="kt">px</span><span class="p">;</span>
  <span class="k">overflow-y</span><span class="p">:</span> <span class="kc">scroll</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">></span>

<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"container"</span><span class="p">></span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"box"</span><span class="p">>&lt;/</span><span class="nt">div</span><span class="p">></span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
</pre>
            <pre class="lang-javascript highlight">registerLayout<span class="p">(</span><span class="s1">'box-edges'</span><span class="p">,</span> <span class="kr">class</span> <span class="p">{</span>
    <span class="o">*</span>layout<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> constraints<span class="p">,</span> styleMap<span class="p">,</span> breakToken<span class="p">)</span> <span class="p">{</span>
        edges<span class="p">.</span>padding<span class="p">.</span>inlineStart<span class="p">;</span> <span class="c1">// 5 (as 10% * 50px = 5px).</span>
<span class="c1"></span>        edges<span class="p">.</span>border<span class="p">.</span>blockEnd<span class="p">;</span> <span class="c1">// 2</span>
<span class="c1"></span>        edges<span class="p">.</span>scrollbar<span class="p">.</span>inlineEnd<span class="p">;</span> <span class="c1">// UA-dependent, may be 0 or >0 (e.g. 16).</span>
<span class="c1"></span>        edges<span class="p">.</span>all<span class="p">.</span>block<span class="p">;</span> <span class="c1">// 14 (2 + 5 + 5 + 2).</span>
<span class="c1"></span>    <span class="p">}</span>
<span class="p">}</span>
</pre>
        </div>
        <h2 class="heading settled" data-level="4" id="interactions-with-other-modules"><span class="secno">4.
            </span><span class="content">与其他模块的交互</span><a class="self-link"
                href="#interactions-with-other-modules"></a></h2>
        <p>本节描述了其他CSS模块如何与CSS布局API进行交互。</p>
        <h3 class="heading settled" data-level="4.1" id="interaction-sizing"><span class="secno">4.1. </span><span
                class="content">大小调整</span><a class="self-link" href="#interaction-sizing"></a></h3>
        <p>用户代理必须使用 <code
                class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints⑧">LayoutConstraints</a></code>
            对象与 <a data-link-type="dfn" href="#current-layout" id="ref-for-current-layout①⑥">当前布局</a> 进行通信，以指示他们希望片段的大小。
        </p>
        <p>如果用户代理希望强制对框设置大小，它可以使用 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedinlinesize" id="ref-for-dom-layoutconstraints-fixedinlinesize③">fixedInlineSize</a></code>
            和 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedblocksize" id="ref-for-dom-layoutconstraints-fixedblocksize③">fixedBlockSize</a></code>
            属性来实现。</p>
        <p>根据 <a data-link-type="dfn" href="#document-layout-definition-layout-options"
                id="ref-for-document-layout-definition-layout-options④">布局选项</a> 的 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutoptions-sizing" id="ref-for-dom-layoutoptions-sizing">sizing</a></code>（由类中的
            <code>layoutOptions</code> 设置）的值，<a data-link-type="dfn" href="#layout-api-container"
                id="ref-for-layout-api-container①⓪">布局API容器</a>可以通过不同方式接收大小信息。
        </p>
        <p>如果 <a data-link-type="dfn" href="#document-layout-definition-layout-options"
                id="ref-for-document-layout-definition-layout-options⑤">布局选项</a> 的 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutoptions-sizing" id="ref-for-dom-layoutoptions-sizing①">sizing</a></code>
            值为 <code>"block-like"</code>，那么传递给 <a data-link-type="dfn" href="#layout-api-container"
                id="ref-for-layout-api-container①①">布局API容器</a> 的 <code
                class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints⑨">LayoutConstraints</a></code>：
        </p>
        <ul>
            <li data-md="">
                <p><em>必须</em> 基于 <a data-link-type="biblio" href="#biblio-css-sizing-3">[css-sizing-3]</a>
                    中的规则以及它所参与的格式化上下文，计算并设置 <code
                        class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedinlinesize" id="ref-for-dom-layoutconstraints-fixedinlinesize④">fixedInlineSize</a></code>，例如：
                </p>
                <ul>
                    <li data-md="">
                        <p>作为一个 <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#block-level"
                                id="ref-for-block-level②">块级</a> 框在 <a data-link-type="dfn"
                                href="https://www.w3.org/TR/css-display-3/#block-formatting-context"
                                id="ref-for-block-formatting-context">块格式化上下文</a> 中，它的大小像一个 <a data-link-type="dfn"
                                href="https://www.w3.org/TR/css-display-3/#block-box" id="ref-for-block-box">块框</a>
                            那样，设置格式化上下文，<a class="css" data-link-type="maybe"
                                href="https://www.w3.org/TR/css-sizing-3/#valdef-width-auto"
                                id="ref-for-valdef-width-auto①">auto</a> <a data-link-type="dfn"
                                href="https://www.w3.org/TR/css-writing-modes-3/#inline-size"
                                id="ref-for-inline-size②">inline size</a> 按照非替换块框的计算方式计算。</p>
                    <li data-md="">
                        <p>作为 <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#inline-level"
                                id="ref-for-inline-level③">行内级</a> 框在 <a data-link-type="dfn"
                                href="https://www.w3.org/TR/css-display-3/#inline-formatting-context"
                                id="ref-for-inline-formatting-context">行内格式化上下文</a> 中，它的大小像一个原子行内级框（例如行内块）。</p>
                </ul>
            <li data-md="">
                <p><em>必须</em> 基于 <a data-link-type="biblio" href="#biblio-css-sizing-3">[css-sizing-3]</a>
                    中的规则以及它所参与的格式化上下文，计算并设置 <code
                        class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedblocksize" id="ref-for-dom-layoutconstraints-fixedblocksize④">fixedBlockSize</a></code>。如果
                    <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container①②">布局API容器</a>
                    的 <a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-sizing-3/#valdef-width-auto"
                        id="ref-for-valdef-width-auto②">auto</a> <a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-writing-modes-3/#block-size" id="ref-for-block-size③">block
                        size</a> 无法提前确定，必须将 <code
                        class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedblocksize" id="ref-for-dom-layoutconstraints-fixedblocksize⑤">fixedBlockSize</a></code>
                    设置为 <code>null</code>。
                </p>
        </ul>
        <p>如果 <a data-link-type="dfn" href="#document-layout-definition-layout-options"
                id="ref-for-document-layout-definition-layout-options⑥">布局选项</a> 的 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutoptions-sizing" id="ref-for-dom-layoutoptions-sizing②">sizing</a></code>
            值为 <code>"manual"</code>，则用户代理在布局API容器的大小由所参与的格式化上下文强制设定时，除非提前强制设置特定的大小，否则不应预先计算 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedinlinesize" id="ref-for-dom-layoutconstraints-fixedinlinesize⑤">fixedInlineSize</a></code>
            和/或 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedblocksize" id="ref-for-dom-layoutconstraints-fixedblocksize⑥">fixedBlockSize</a></code>，例如：
        </p>
        <ul>
            <li data-md="">
                <p>如果 <a data-link-type="dfn" href="#layout-api-container"
                        id="ref-for-layout-api-container①③">布局API容器</a> 在 <a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-display-3/#block-formatting-context"
                        id="ref-for-block-formatting-context①">块格式化上下文</a> 中，处于流内，并且具有 <a class="css"
                        data-link-type="maybe" href="https://www.w3.org/TR/css-sizing-3/#valdef-width-auto"
                        id="ref-for-valdef-width-auto③">auto</a> 行内尺寸，用户代理 <em>必须</em> 将 <code
                        class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedinlinesize" id="ref-for-dom-layoutconstraints-fixedinlinesize⑥">fixedInlineSize</a></code>
                    设置为 <a data-link-type="dfn" href="https://www.w3.org/TR/css-sizing-3/#stretch-fit-inline-size"
                        id="ref-for-stretch-fit-inline-size">拉伸适应的行内尺寸</a>。</p>
        </ul>
        <div class="note" role="note">
            注意：在下面的示例中，<a data-link-type="dfn" href="#layout-api-container"
                id="ref-for-layout-api-container①④">布局API容器</a> 的行内尺寸设置为50。
            <pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">style</span><span class="p">></span>
  <span class="p">#</span><span class="nn">container</span> <span class="p">{</span>
    <span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">box-sizing</span><span class="p">:</span> <span class="kc">border-box</span><span class="p">;</span>
    <span class="k">padding</span><span class="p">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">#</span><span class="nn">layout-api</span> <span class="p">{</span>
    <span class="k">display</span><span class="p">:</span> <span class="nf">layout</span><span class="p">(</span><span class="n">foo</span><span class="p">);</span>
    <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">></span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"container"</span><span class="p">></span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"layout-api"</span><span class="p">>&lt;/</span><span class="nt">div</span><span class="p">></span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
</pre>
        </div>
        <h4 class="heading settled" data-level="4.1.1" id="interaction-sizing-positiong-layout"><span
                class="secno">4.1.1. </span><span class="content">定位布局大小调整</span><a class="self-link"
                href="#interaction-sizing-positiong-layout"></a></h4>
        <p>如果 <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container①⑤">布局API容器</a>
            是脱离文档流定位的，用户代理 <em>必须</em> 解算定位尺寸方程（<a
                href="https://www.w3.org/TR/css3-positioning/#abs-non-replaced-width">CSS定位布局3 §8.1
                绝对或固定定位、非替换元素的宽度</a>，<a href="https://www.w3.org/TR/css3-positioning/#abs-non-replaced-height">CSS定位布局3
                §8.3 绝对或固定定位、非替换元素的高度</a>），并设置合适的 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedinlinesize" id="ref-for-dom-layoutconstraints-fixedinlinesize⑦">fixedInlineSize</a></code>
            和 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedblocksize" id="ref-for-dom-layoutconstraints-fixedblocksize⑦">fixedBlockSize</a></code>。
        </p>
        <div class="note" role="note">
            注意：在下面的示例中，<a data-link-type="dfn" href="#layout-api-container"
                id="ref-for-layout-api-container①⑥">布局API容器</a> 的行内和块大小被固定为80。
            <pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">style</span><span class="p">></span>
  <span class="p">#</span><span class="nn">container</span> <span class="p">{</span>
    <span class="k">position</span><span class="p">:</span> <span class="kc">relative</span><span class="p">;</span>
    <span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">#</span><span class="nn">layout-api</span> <span class="p">{</span>
    <span class="k">display</span><span class="p">:</span> <span class="nf">layout</span><span class="p">(</span><span class="n">foo</span><span class="p">);</span>
    <span class="k">top</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">bottom</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">left</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">right</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">></span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"container"</span><span class="p">></span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"layout-api"</span><span class="p">>&lt;/</span><span class="nt">div</span><span class="p">></span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
</pre>
        </div>
        <h3 class="heading settled" data-level="4.2" id="interaction-positioning"><span class="secno">4.2. </span><span
                class="content">定位</span><a class="self-link" href="#interaction-positioning"></a></h3>
        <p>本级别规范中的所有定位由用户代理处理。</p>
        <p>因此：</p>
        <ul>
            <li data-md="">
                <p>脱离文档流的子元素不会作为 <code
                        class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②⑨">LayoutChild</a></code>
                    子元素出现。</p>
            <li data-md="">
                <p><a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container①⑦">布局API容器</a>
                    与 <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#containing-block"
                        id="ref-for-containing-block③">包含块</a> 一样建立 <a
                        href="https://www.w3.org/TR/CSS2/visudet.html#containing-block-details">包含块</a>。<a
                        data-link-type="biblio" href="#biblio-css21">[CSS21]</a></p>
            <li data-md="">
                <p><code
                        class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlineoffset" id="ref-for-dom-layoutfragment-inlineoffset③">inlineOffset</a></code>
                    和 <code
                        class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blockoffset" id="ref-for-dom-layoutfragment-blockoffset③">blockOffset</a></code>
                    代表了在任何定位和变换发生之前的片段位置。</p>
            <li data-md="">
                <p>绝对定位的 <a data-link-type="dfn" href="https://www.w3.org/TR/CSS21/visudet.html#static-position"
                        id="ref-for-static-position">静态位置</a> 子元素的静态位置将被设置为 <a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-writing-modes-3/#inline-start" id="ref-for-inline-start">行首</a>
                    和 <a data-link-type="dfn" href="https://www.w3.org/TR/css-writing-modes-3/#block-start"
                        id="ref-for-block-start">块首</a> 的填充边缘，自动边距会被视为零。</p>
        </ul>
        <div class="note" role="note">
            注意：在下面的示例中：
            <ul>
                <li data-md="">
                    <p>“child-relative” 将是唯一传递给作者布局的子元素。如果它的位置在 (<code
                            class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlineoffset" id="ref-for-dom-layoutfragment-inlineoffset④">inlineOffset</a></code>
                        <code>= 20</code>, <code
                            class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blockoffset" id="ref-for-dom-layoutfragment-blockoffset④">blockOffset</a></code>
                        <code>= 30</code>), 那么它的最终位置将是 (<code>25</code>, <code>40</code>)，相对定位由用户代理处理。
                    </p>
                <li data-md="">
                    <p>“child-absolute” 不会作为 <code
                            class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild③⓪">LayoutChild</a></code>
                        出现，而是由用户代理布局并定位。</p>
                <li data-md="">
                    <p>上述示例也类似适用于黏性和固定定位的子元素。</p>
            </ul>
            <pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">style</span><span class="p">></span>
  <span class="p">#</span><span class="nn">container</span> <span class="p">{</span>
    <span class="k">display</span><span class="p">:</span> <span class="nf">layout</span><span class="p">(</span><span class="n">foo</span><span class="p">);</span>
    <span class="k">position</span><span class="p">:</span> <span class="kc">relative</span><span class="p">;</span> <span class="c">/* container is a containing block */</span>
    <span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">#</span><span class="nn">child-relative</span> <span class="p">{</span>
    <span class="k">position</span><span class="p">:</span> <span class="kc">relative</span><span class="p">;</span>
    <span class="k">left</span><span class="p">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">top</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">></span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"container"</span><span class="p">></span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"child-relative"</span><span class="p">>&lt;/</span><span class="nt">div</span><span class="p">></span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"child-absolute"</span><span class="p">>&lt;/</span><span class="nt">div</span><span class="p">></span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
</pre>
        </div>
        <h3 class="heading settled" data-level="4.3" id="interaction-overflow"><span class="secno">4.3. </span><span
                class="content">溢出</span><a class="self-link" href="#interaction-overflow"></a></h3>
        <p><a data-link-type="dfn" href="https://www.w3.org/TR/css-overflow-3/#scrollable-overflow"
                id="ref-for-scrollable-overflow">可滚动溢出</a>对于 <a data-link-type="dfn" href="#layout-api-container"
                id="ref-for-layout-api-container②⓪">布局API容器</a> 由用户代理在本规范级别处理。</p>
        <p><a data-link-type="dfn" href="#layout-api-container"
                id="ref-for-layout-api-container②①">布局API容器</a>应像块容器那样计算其可滚动溢出。</p>
        <p>即使作者的 <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container②②">布局API容器</a>
            将片段放置在 <a data-link-type="dfn" href="https://www.w3.org/TR/css-overflow-3/#scrollable-overflow"
                id="ref-for-scrollable-overflow①">可滚动溢出</a>区域内，相对定位或变换可能会导致片段移动，使得它的 <a data-link-type="dfn"
                href="https://www.w3.org/TR/css-overflow-3/#scrollable-overflow"
                id="ref-for-scrollable-overflow②">可滚动溢出</a>区域不会产生溢出。</p>

        <h3 class="heading settled" data-level="4.4" id="interaction-fragmentation"><span class="secno">4.4.
            </span><span class="content">分片</span><a class="self-link" href="#interaction-fragmentation"></a></h3>
        <p><a data-link-type="dfn" href="#parent-layout" id="ref-for-parent-layout③">父布局</a>可以通过设置 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationtype" id="ref-for-dom-layoutconstraints-blockfragmentationtype④">blockFragmentationType</a></code>
            和 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationoffset" id="ref-for-dom-layoutconstraints-blockfragmentationoffset①">blockFragmentationOffset</a></code>
            来要求 <a data-link-type="dfn" href="#current-layout" id="ref-for-current-layout①⑦">当前布局</a>进行分片。</p>
        <p>例如，<a data-link-type="biblio" href="#biblio-css-multicol-1">[css-multicol-1]</a> 布局会将 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationtype" id="ref-for-dom-layoutconstraints-blockfragmentationtype⑤">blockFragmentationType</a></code>
            设置为 <code>"column"</code> 并将 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationoffset" id="ref-for-dom-layoutconstraints-blockfragmentationoffset②">blockFragmentationOffset</a></code>
            设置为需要子片段的地方。</p>

        <h3 class="heading settled" data-level="4.5" id="interaction-alignment"><span class="secno">4.5. </span><span
                class="content">对齐</span><a class="self-link" href="#interaction-alignment"></a></h3>
        <p><a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container②③">布局API容器</a>
            的第一/最后基线集与块容器生成的方式相同（参见 <a href="https://www.w3.org/TR/css3-align/#baseline-export">CSS 盒对齐 3 §9.1
                确定盒子的基线</a>）。不过，流内子元素的顺序应由布局方法返回的顺序决定（通过 <code
                class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-childfragments" id="ref-for-dom-fragmentresultoptions-childfragments①">childFragments</a></code>）而不是文档顺序。
        </p>

        <div class="note" role="note">
            注意：在未来的规范级别中，作者将能够自行定义基线。这将以如下形式出现：
            <p>从 <code
                    class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild③①">LayoutChild</a></code>
                中查询基线信息。</p>
            <pre class="lang-javascript highlight"><span class="kr">const</span> fragment <span class="o">=</span> <span class="k">yield</span> child<span class="p">.</span>layoutNextFragment<span class="p">({</span>
  fixedInlineSize<span class="o">:</span> availableInlineSize<span class="p">,</span>
  baselineRequests<span class="o">:</span> <span class="p">[</span><span class="s1">'alphabetic'</span><span class="p">,</span> <span class="s1">'middle'</span><span class="p">],</span>
<span class="p">});</span>
fragment<span class="p">.</span>baselines<span class="p">.</span>get<span class="p">(</span><span class="s1">'alphabetic'</span><span class="p">)</span> <span class="o">===</span> <span class="mi">25</span> <span class="cm">/* 或其他值 */</span><span class="p">;</span>
</pre>
            <p>为 <a data-link-type="dfn" href="#parent-layout" id="ref-for-parent-layout④">父布局</a> 生成基线信息：</p>
            <pre class="lang-javascript highlight">registerLayout<span class="p">(</span><span class="s1">'baseline-producing'</span><span class="p">,</span> <span class="kr">class</span> <span class="p">{</span>
  <span class="o">*</span>layout<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> constraints<span class="p">,</span> styleMap<span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> result <span class="o">=</span> <span class="p">{</span>baselines<span class="o">:</span> <span class="p">{}};</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> baselineRequest <span class="k">of</span> constraints<span class="p">.</span>baselineRequests<span class="p">)</span> <span class="p">{</span>
      <span class="c1">// baselineRequest === 'alphabetic' 或其他值。</span>
      result<span class="p">.</span>baselines<span class="p">[</span>baselineRequest<span class="p">]</span> <span class="o">=</span> <span class="mi">25</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> result<span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre>
        </div>
        <h2 class="heading settled" data-level="5" id="layout"><span class="secno">5. </span><span
                class="content">布局</span><a class="self-link" href="#layout"></a></h2>
        <p>本节描述了CSS布局API如何与用户代理的布局引擎交互。</p>

        <h3 class="heading settled" data-level="5.1" id="concepts"><span class="secno">5.1. </span><span
                class="content">概念</span><a class="self-link" href="#concepts"></a></h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="layout-definition">布局定义</dfn>是一个<a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct">结构体</a>，描述了 <code
                class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope②">LayoutWorkletGlobalScope</a></code>
            需要的关于作者定义布局的信息（可由<a class="css" data-link-type="maybe" href="#valdef-display-layout"
                id="ref-for-valdef-display-layout②">layout()</a>函数引用）。它包括：</p>
        <ul>
            <li data-md="">
                <p><dfn class="dfn-paneled" data-dfn-for="layout definition" data-dfn-type="dfn" data-noexport=""
                        id="layout-definition-class-constructor">类构造函数</dfn>，这是类的<a data-link-type="dfn"
                        href="https://tc39.github.io/ecma262/#sec-constructor" id="ref-for-sec-constructor">构造函数</a>。
                </p>
            <li data-md="">
                <p><dfn class="dfn-paneled" data-dfn-for="layout definition" data-dfn-type="dfn" data-noexport=""
                        id="layout-definition-layout-generator-function">布局生成器函数</dfn>，这是布局的<a data-link-type="dfn"
                        href="https://tc39.github.io/ecma262/#sec-generatorfunction"
                        id="ref-for-sec-generatorfunction">生成器函数</a>回调。</p>
            <li data-md="">
                <p><dfn class="dfn-paneled" data-dfn-for="layout definition" data-dfn-type="dfn" data-noexport=""
                        id="layout-definition-intrinsic-sizes-generator-function">固有尺寸生成器函数</dfn>，这是固有尺寸的<a
                        data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-generatorfunction"
                        id="ref-for-sec-generatorfunction①">生成器函数</a>回调。</p>
            <li data-md="">
                <p><dfn class="dfn-paneled" data-dfn-for="layout definition" data-dfn-type="dfn" data-noexport=""
                        id="layout-definition-constructor-valid-flag">构造函数有效标志</dfn>。</p>
            <li data-md="">
                <p><dfn class="dfn-paneled" data-dfn-for="layout definition" data-dfn-type="dfn" data-noexport=""
                        id="layout-definition-input-properties">输入属性</dfn>，这是一个<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#list" id="ref-for-list">列表</a>，包含 <code>DOMStrings</code>。
                </p>
            <li data-md="">
                <p><dfn class="dfn-paneled" data-dfn-for="layout definition" data-dfn-type="dfn" data-noexport=""
                        id="layout-definition-child-input-properties">子输入属性</dfn>，这是一个<a data-link-type="dfn"
                        href="https://infra.spec.whatwg.org/#list" id="ref-for-list①">列表</a>，包含 <code>DOMStrings</code>。
                </p>
            <li data-md="">
                <p><dfn class="dfn-paneled" data-dfn-for="layout definition" data-dfn-type="dfn" data-noexport=""
                        id="layout-definition-layout-options">布局选项</dfn>，一个 <code
                        class="idl"><a data-link-type="idl" href="#dictdef-layoutoptions" id="ref-for-dictdef-layoutoptions">LayoutOptions</a></code>。
                </p>
        </ul>

        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="document-layout-definition">文档布局定义</dfn>是一个<a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct①">结构体</a>，描述了<a data-link-type="dfn"
                href="https://dom.spec.whatwg.org/#concept-document"
                id="ref-for-concept-document">文档</a>需要的关于作者定义布局的信息（可由<a class="css" data-link-type="maybe"
                href="#valdef-display-layout" id="ref-for-valdef-display-layout③">layout()</a>函数引用）。它包括：</p>
        <ul>
            <li data-md="">
                <p><dfn class="dfn-paneled" data-dfn-for="document layout definition" data-dfn-type="dfn"
                        data-noexport="" id="document-layout-definition-input-properties">输入属性</dfn>，这是一个<a
                        data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list②">列表</a>，包含
                    <code>DOMStrings</code>。
                </p>
            <li data-md="">
                <p><dfn class="dfn-paneled" data-dfn-for="document layout definition" data-dfn-type="dfn"
                        data-noexport="" id="document-layout-definition-child-input-properties">子输入属性</dfn>，这是一个<a
                        data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list③">列表</a>，包含
                    <code>DOMStrings</code>。
                </p>
            <li data-md="">
                <p><dfn class="dfn-paneled" data-dfn-for="document layout definition" data-dfn-type="dfn"
                        data-noexport="" id="document-layout-definition-layout-options">布局选项</dfn>，一个 <code
                        class="idl"><a data-link-type="idl" href="#dictdef-layoutoptions" id="ref-for-dictdef-layoutoptions①">LayoutOptions</a></code>。
                </p>
        </ul>
        <h3 class="heading settled" data-level="5.2" id="layout-invalidation"><span class="secno">5.2. </span><span
                class="content">布局失效</span><a class="self-link" href="#layout-invalidation"></a></h3>
        <p>每个<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box"
                id="ref-for-box①⓪">盒子</a>都有一个关联的<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="layout-valid-flag">布局有效标志</dfn>。它可以是<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="layout-valid">布局有效</dfn>或<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="layout-invalid">布局无效</dfn>。初始状态为<a data-link-type="dfn" href="#layout-invalid"
                id="ref-for-layout-invalid">布局无效</a>。</p>
        <p>每个<a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box"
                id="ref-for-box①①">盒子</a>都有一个关联的<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="intrinsic-sizes-valid-flag">固有尺寸有效标志</dfn>。它可以是<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-noexport="" id="intrinsic-sizes-valid">固有尺寸有效</dfn>或<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-noexport="" id="intrinsic-sizes-invalid">固有尺寸无效</dfn>。初始状态为<a data-link-type="dfn"
                href="#intrinsic-sizes-invalid" id="ref-for-intrinsic-sizes-invalid">固有尺寸无效</a>。</p>

        <div class="algorithm" data-algorithm="invalidate layout functions">
            当用户代理想要<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="invalidate-layout-functions">使布局函数失效</dfn>，并给定<var>box</var>时，用户代理<em>必须</em>执行以下步骤：
            <ol>
                <li data-md="">
                    <p>将<var>layoutFunction</var>设为<var>box</var>的<a class="css" data-link-type="maybe"
                            href="#valdef-display-layout"
                            id="ref-for-valdef-display-layout④">layout()</a>函数。如果它是其他类型的值（如<a class="css"
                            data-link-type="maybe" href="https://www.w3.org/TR/css-display-3/#valdef-display-grid"
                            id="ref-for-valdef-display-grid">grid</a>），则终止这些步骤。</p>
                <li data-md="">
                    <p>将<var>name</var>设为<var>layoutFunction</var>的第一个参数。</p>
                <li data-md="">
                    <p>将<var>documentDefinition</var>设为<a data-link-type="dfn" href="#get-a-document-layout-definition"
                            id="ref-for-get-a-document-layout-definition">获取文档布局定义</a>的结果，给定<var>name</var>。</p>
                    <p>如果<a data-link-type="dfn" href="#get-a-document-layout-definition"
                            id="ref-for-get-a-document-layout-definition①">获取文档布局定义</a>失败，或<var>documentDefinition</var>为<code>"无效"</code>，则终止这些步骤。
                    </p>
                <li data-md="">
                    <p>将<var>inputProperties</var>设为<var>documentDefinition</var>的<a data-link-type="dfn"
                            href="#document-layout-definition-input-properties"
                            id="ref-for-document-layout-definition-input-properties">输入属性</a>。</p>
                <li data-md="">
                    <p>将<var>childInputProperties</var>设为<var>documentDefinition</var>的<a data-link-type="dfn"
                            href="#document-layout-definition-child-input-properties"
                            id="ref-for-document-layout-definition-child-input-properties">子输入属性</a>。</p>
                <li data-md="">
                    <p>对于<var>inputProperties</var>中的每个<var>property</var>，如果<var>property</var>的<a data-link-type="dfn"
                            href="https://www.w3.org/TR/css-cascade-4/#computed-value"
                            id="ref-for-computed-value③">计算值</a>已更改，将该<a data-link-type="dfn" href="#layout-valid-flag"
                            id="ref-for-layout-valid-flag">布局有效标志</a>设为<a data-link-type="dfn" href="#layout-invalid"
                            id="ref-for-layout-invalid①">布局无效</a>，并将<a data-link-type="dfn"
                            href="#intrinsic-sizes-valid-flag" id="ref-for-intrinsic-sizes-valid-flag">固有尺寸有效标志</a>设为<a
                            data-link-type="dfn" href="#intrinsic-sizes-invalid"
                            id="ref-for-intrinsic-sizes-invalid①">固有尺寸无效</a>。</p>
                <li data-md="">
                    <p>对于<var>childInputProperties</var>中的每个<var>property</var>，如果<var>property</var>的<a
                            data-link-type="dfn" href="https://www.w3.org/TR/css-cascade-4/#computed-value"
                            id="ref-for-computed-value④">计算值</a>已更改，将该<a data-link-type="dfn" href="#layout-valid-flag"
                            id="ref-for-layout-valid-flag①">布局有效标志</a>设为<a data-link-type="dfn" href="#layout-invalid"
                            id="ref-for-layout-invalid②">布局无效</a>，并将<a data-link-type="dfn"
                            href="#intrinsic-sizes-valid-flag" id="ref-for-intrinsic-sizes-valid-flag①">固有尺寸有效标志</a>设为<a
                            data-link-type="dfn" href="#intrinsic-sizes-invalid"
                            id="ref-for-intrinsic-sizes-invalid②">固有尺寸无效</a>。</p>
            </ol>
        </div>

        <p>当用户代理重新计算盒子的计算样式时，或该盒子的子项计算样式重新计算时，<a data-link-type="dfn" href="#invalidate-layout-functions"
                id="ref-for-invalidate-layout-functions">使布局函数失效</a> <em>必须</em>被运行。</p>

        <p>当由<code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild③②">LayoutChild</a></code>表示的子<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box" id="ref-for-box①④">盒子</a>被添加或移除到<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box-tree"
                id="ref-for-box-tree⑥">盒子树</a>中，或者其布局因计算样式更改或子项更改而失效时，并且这种失效需要向上传播到盒子树，将当前<a data-link-type="dfn"
                href="#layout-valid-flag" id="ref-for-layout-valid-flag②">布局有效标志</a>设为<a data-link-type="dfn"
                href="#layout-invalid" id="ref-for-layout-invalid③">布局无效</a>，并将当前<a data-link-type="dfn"
                href="#intrinsic-sizes-valid-flag" id="ref-for-intrinsic-sizes-valid-flag②">固有尺寸有效标志</a>设为<a
                data-link-type="dfn" href="#intrinsic-sizes-invalid" id="ref-for-intrinsic-sizes-invalid③">固有尺寸无效</a>。
        </p>

        <p>当<a data-link-type="dfn" href="#layout-api-container"
                id="ref-for-layout-api-container②④">布局API容器</a>的计算样式更改，并且此更改影响了<code
                class="idl"><a data-link-type="idl" href="#layoutedges" id="ref-for-layoutedges④">LayoutEdges</a></code>对象内的值时，将盒子的<a
                data-link-type="dfn" href="#layout-valid-flag" id="ref-for-layout-valid-flag③">布局有效标志</a>设为<a
                data-link-type="dfn" href="#layout-invalid" id="ref-for-layout-invalid④">布局无效</a>，并将盒子的<a
                data-link-type="dfn" href="#intrinsic-sizes-valid-flag"
                id="ref-for-intrinsic-sizes-valid-flag③">固有尺寸有效标志</a>设为<a data-link-type="dfn"
                href="#intrinsic-sizes-invalid" id="ref-for-intrinsic-sizes-invalid④">固有尺寸无效</a>。</p>

        <p>如果计算样式的更改影响了<code
                class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints①⓪">LayoutConstraints</a></code>对象内的值，则只需将盒子的<a
                data-link-type="dfn" href="#intrinsic-sizes-valid-flag"
                id="ref-for-intrinsic-sizes-valid-flag④">固有尺寸有效标志</a>设为<a data-link-type="dfn"
                href="#intrinsic-sizes-invalid" id="ref-for-intrinsic-sizes-invalid⑤">固有尺寸无效</a>。</p>

        <p class="note" role="note"><span>注意：</span>由于<code
                class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints①①">LayoutConstraints</a></code>对象仅在布局函数中传递，因此无需使固有尺寸失效。
        </p>

        <div class="note" role="note">
            注意：以下属性的更改可能会影响<code
                class="idl"><a data-link-type="idl" href="#layoutedges" id="ref-for-layoutedges⑤">LayoutEdges</a></code>对象：
            <ul>
                <li data-md="">
                    <p><a class="property" data-link-type="propdesc"
                            href="https://www.w3.org/TR/CSS22/box.html#propdef-padding-top"
                            id="ref-for-propdef-padding-top">padding-top</a></p>
                <li data-md="">
                    <p><a class="property" data-link-type="propdesc"
                            href="https://www.w3.org/TR/css3-background/#propdef-border-left-width"
                            id="ref-for-propdef-border-left-width">border-left-width</a></p>
                <li data-md="">
                    <p><a class="property" data-link-type="propdesc"
                            href="https://www.w3.org/TR/css-overflow-3/#propdef-overflow-y"
                            id="ref-for-propdef-overflow-y">overflow-y</a></p>
            </ul>
            <p>以下属性的更改可能会影响<code
                    class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints①②">LayoutConstraints</a></code>对象：
            </p>
            <ul>
                <li data-md="">
                    <p><a class="property" data-link-type="propdesc"
                            href="https://www.w3.org/TR/CSS22/visudet.html#propdef-width"
                            id="ref-for-propdef-width">width</a></p>
                <li data-md="">
                    <p><a class="property" data-link-type="propdesc"
                            href="https://www.w3.org/TR/CSS22/visudet.html#propdef-max-width"
                            id="ref-for-propdef-max-width">max-width</a></p>
                <li data-md="">
                    <p><a class="property" data-link-type="propdesc"
                            href="https://www.w3.org/TR/CSS22/visudet.html#propdef-height"
                            id="ref-for-propdef-height">height</a></p>
            </ul>
        </div>

        <p class="note" role="note"><span>注意：</span>这仅描述了与CSS布局API相关的布局失效。所有<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-display-3/#box" id="ref-for-box①⑦">盒子</a>从概念上都有一个<a data-link-type="dfn"
                href="#layout-valid-flag" id="ref-for-layout-valid-flag④">布局有效标志</a>，这些更改通过<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-display-3/#box-tree" id="ref-for-box-tree⑦">盒子树</a>传播。</p>
        <h3 class="heading settled" data-level="5.3" id="layout-worklet"><span class="secno">5.3. </span><span
                class="content">布局 Worklet</span><a class="self-link" href="#layout-worklet"></a></h3>
        <p><code
                class="idl"><a data-link-type="idl" href="#dom-css-layoutworklet" id="ref-for-dom-css-layoutworklet">layoutWorklet</a></code>属性允许访问负责与布局相关的所有类的<code
                class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/worklets-1/#worklet" id="ref-for-worklet">Worklet</a></code>。
        </p>
        <p><code
                class="idl"><a data-link-type="idl" href="#dom-css-layoutworklet" id="ref-for-dom-css-layoutworklet①">layoutWorklet</a></code>的<a
                data-link-type="dfn" href="https://www.w3.org/TR/worklets-1/#worklet-global-scope-type"
                id="ref-for-worklet-global-scope-type">worklet 全局作用域类型</a>为<code
                class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope③">LayoutWorkletGlobalScope</a></code>。
        </p>
        <pre class="idl highlight def"><span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://www.w3.org/TR/cssom-1/#css" id="ref-for-css">CSS</a> {
    [<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SameObject" id="ref-for-SameObject">SameObject</a>] <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/worklets-1/#worklet" id="ref-for-worklet①">Worklet</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="CSS" data-dfn-type="attribute" data-export="" data-readonly="" data-type="Worklet" id="dom-css-layoutworklet"><code>layoutWorklet</code></dfn>;
};
</pre>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope④">LayoutWorkletGlobalScope</a></code>是<code
                class="idl"><a data-link-type="idl" href="#dom-css-layoutworklet" id="ref-for-dom-css-layoutworklet②">layoutWorklet</a></code>的全局执行上下文。
        </p>
        <pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Global" id="ref-for-Global">Global</a>=(<a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/worklets-1/#worklet" id="ref-for-worklet②">Worklet</a>,<a class="n" data-link-type="idl-name">LayoutWorklet</a>),<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑧">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="layoutworkletglobalscope"><code>LayoutWorkletGlobalScope</code></dfn> : <a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/worklets-1/#workletglobalscope" id="ref-for-workletglobalscope">WorkletGlobalScope</a> {
    <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-layoutworkletglobalscope-registerlayout" id="ref-for-dom-layoutworkletglobalscope-registerlayout">registerLayout</a>(<a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString"><span class="kt">DOMString</span></a> <dfn class="nv idl-code" data-dfn-for="LayoutWorkletGlobalScope/registerLayout(name, layoutCtor)" data-dfn-type="argument" data-export="" id="dom-layoutworkletglobalscope-registerlayout-name-layoutctor-name"><code>name</code><a class="self-link" href="#dom-layoutworkletglobalscope-registerlayout-name-layoutctor-name"></a></dfn>, <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#VoidFunction" id="ref-for-VoidFunction">VoidFunction</a> <dfn class="nv idl-code" data-dfn-for="LayoutWorkletGlobalScope/registerLayout(name, layoutCtor)" data-dfn-type="argument" data-export="" id="dom-layoutworkletglobalscope-registerlayout-name-layoutctor-layoutctor"><code>layoutCtor</code><a class="self-link" href="#dom-layoutworkletglobalscope-registerlayout-name-layoutctor-layoutctor"></a></dfn>);
};
</pre>
        <h3 class="heading settled" data-level="5.4" id="registering-layout"><span class="secno">5.4. </span><span
                class="content">注册布局</span><a class="self-link" href="#registering-layout"></a></h3>
        <pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑨">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-layoutoptions"><code>LayoutOptions</code></dfn> {
  <a class="n" data-link-type="idl-name" href="#enumdef-childdisplaytype" id="ref-for-enumdef-childdisplaytype">ChildDisplayType</a> <dfn class="nv dfn-paneled idl-code" data-default="&quot;block&quot;" data-dfn-for="LayoutOptions" data-dfn-type="dict-member" data-export="" data-type="ChildDisplayType " id="dom-layoutoptions-childdisplay"><code>childDisplay</code></dfn> = "block";
  <a class="n" data-link-type="idl-name" href="#enumdef-layoutsizingmode" id="ref-for-enumdef-layoutsizingmode">LayoutSizingMode</a> <dfn class="nv dfn-paneled idl-code" data-default="&quot;block-like&quot;" data-dfn-for="LayoutOptions" data-dfn-type="dict-member" data-export="" data-type="LayoutSizingMode " id="dom-layoutoptions-sizing"><code>sizing</code></dfn> = "block-like";
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①⓪">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">enum</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-childdisplaytype"><code>ChildDisplayType</code></dfn> {
    <dfn class="s idl-code" data-dfn-for="ChildDisplayType" data-dfn-type="enum-value" data-export="" data-lt="&quot;block&quot;|block" id="dom-childdisplaytype-block"><code>"block"</code><a class="self-link" href="#dom-childdisplaytype-block"></a></dfn>,
    <dfn class="s idl-code" data-dfn-for="ChildDisplayType" data-dfn-type="enum-value" data-export="" data-lt="&quot;normal&quot;|normal" id="dom-childdisplaytype-normal"><code>"normal"</code><a class="self-link" href="#dom-childdisplaytype-normal"></a></dfn>,
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">enum</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-layoutsizingmode"><code>LayoutSizingMode</code></dfn> {
    <dfn class="s idl-code" data-dfn-for="LayoutSizingMode" data-dfn-type="enum-value" data-export="" data-lt="&quot;block-like&quot;|block-like" id="dom-layoutsizingmode-block-like"><code>"block-like"</code><a class="self-link" href="#dom-layoutsizingmode-block-like"></a></dfn>,
    <dfn class="s idl-code" data-dfn-for="LayoutSizingMode" data-dfn-type="enum-value" data-export="" data-lt="&quot;manual&quot;|manual" id="dom-layoutsizingmode-manual"><code>"manual"</code><a class="self-link" href="#dom-layoutsizingmode-manual"></a></dfn>,
};
</pre>
        <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document"
                id="ref-for-concept-document①">文档</a>有一个 <a data-link-type="dfn"
                href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①">映射</a>，存储<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="document-layout-definitions">文档布局定义</dfn>。初始时该映射为空；当调用 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutworkletglobalscope-registerlayout" id="ref-for-dom-layoutworkletglobalscope-registerlayout①">registerLayout(name, layoutCtor)</a></code>
            时填充。</p>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope⑤">LayoutWorkletGlobalScope</a></code>
            有一个 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map"
                id="ref-for-ordered-map②">映射</a>，存储<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="layout-definitions">布局定义</dfn>。初始时该映射为空，当调用 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutworkletglobalscope-registerlayout" id="ref-for-dom-layoutworkletglobalscope-registerlayout②">registerLayout(name, layoutCtor)</a></code>
            时填充。</p>
        <p>表示 <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container②⑤">布局 API 容器</a> 的每个
            <a data-link-type="dfn" href="https://www.w3.org/TR/css-display-3/#box" id="ref-for-box①⑧">盒子</a>都有一个 <a
                data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map"
                id="ref-for-ordered-map③">映射</a>，存储<dfn class="dfn-paneled" data-dfn-type="dfn"
                data-lt="layout class instances" data-noexport=""
                id="layout-class-instances">布局类实例</dfn>。初始时该映射为空，当用户代理调用 <a data-link-type="dfn"
                href="#determine-the-intrinsic-sizes" id="ref-for-determine-the-intrinsic-sizes">确定内在尺寸</a> 或 <a
                data-link-type="dfn" href="#generate-a-fragment" id="ref-for-generate-a-fragment">生成片段</a> 时填充。
        </p>
        <div class="algorithm" data-algorithm="registerLayout(name, layoutCtor)">
            当调用 <dfn class="dfn-paneled idl-code" data-dfn-for="LayoutWorkletGlobalScope" data-dfn-type="method"
                data-export=""
                id="dom-layoutworkletglobalscope-registerlayout"><code>registerLayout(<var>name</var>, <var>layoutCtor</var>)</code></dfn>
            方法时，用户代理 <em>必须</em> 执行以下步骤：
            <ol>
                <li data-md="">
                    <p>如果 <var>name</var> 是一个空字符串，<a data-link-type="dfn"
                            href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw">抛出</a> 一个 <a
                            data-link-type="dfn"
                            href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror"
                            id="ref-for-sec-native-error-types-used-in-this-standard-typeerror">TypeError</a> 并终止所有这些步骤。
                    </p>
                <li data-md="">
                    <p>令 <var>layoutDefinitionMap</var> 为 <code
                            class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope⑥">LayoutWorkletGlobalScope</a></code>
                        的 <a data-link-type="dfn" href="#layout-definitions" id="ref-for-layout-definitions">布局定义</a>
                        映射。</p>
                <li data-md="">
                    <p>如果 <var>layoutDefinitionMap</var>[<var>name</var>] <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①">存在</a>，<a
                            data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw"
                            id="ref-for-dfn-throw①">抛出</a> 一个 "<a data-link-type="dfn"
                            href="https://heycam.github.io/webidl/#invalidmodificationerror"
                            id="ref-for-invalidmodificationerror">InvalidModificationError</a>" <a data-link-type="dfn"
                            href="https://heycam.github.io/webidl/#es-DOMException"
                            id="ref-for-es-DOMException">DOMException</a> 并终止所有这些步骤。</p>
                <li data-md="">
                    <p>令 <var>inputProperties</var> 为一个空的 <code>sequence&lt;DOMString></code>。</p>
                <li data-md="">
                    <p>令 <var>inputPropertiesIterable</var> 为 <a data-link-type="dfn"
                            href="https://tc39.github.io/ecma262/#sec-get-o-p"
                            id="ref-for-sec-get-o-p">Get</a>(<var>layoutCtor</var>, "inputProperties") 的结果。</p>
                <li data-md="">
                    <p>如果 <var>inputPropertiesIterable</var> 不为 undefined，则将 <var>inputProperties</var> 设置为 <a
                            data-link-type="dfn" href="https://heycam.github.io/webidl/#es-type-mapping"
                            id="ref-for-es-type-mapping">转换</a> <var>inputPropertiesIterable</var> 为
                        <code>sequence&lt;DOMString></code> 的结果。如果抛出异常，则重新抛出该异常并终止所有这些步骤。
                    </p>
                    <p class="note" role="note"><span>注意：</span> 由输入属性获取器提供的 CSS 属性列表可以是自定义的或原生的 CSS 属性。</p>
                    <p class="note" role="note"><span>注意：</span> CSS 属性列表可能包含简写属性。</p>
                    <p class="note" role="note"><span>注意：</span> 为了使布局类向前兼容，CSS 属性列表还可以包含当前对用户代理无效的属性。例如
                        <code>margin-bikeshed-property</code>。
                    </p>
                <li data-md="">
                    <p>令 <var>childInputProperties</var> 为一个空的 <code>sequence&lt;DOMString></code>。</p>
                <li data-md="">
                    <p>令 <var>childInputPropertiesIterable</var> 为 <a data-link-type="dfn"
                            href="https://tc39.github.io/ecma262/#sec-get-o-p"
                            id="ref-for-sec-get-o-p①">Get</a>(<var>layoutCtor</var>, "childInputProperties") 的结果。</p>
                <li data-md="">
                    <p>如果 <var>childInputPropertiesIterable</var> 不为 undefined，则将 <var>childInputProperties</var> 设置为 <a
                            data-link-type="dfn" href="https://heycam.github.io/webidl/#es-type-mapping"
                            id="ref-for-es-type-mapping①">转换</a> <var>childInputPropertiesIterable</var> 为
                        <code>sequence&lt;DOMString></code> 的结果。如果抛出异常，则重新抛出该异常并终止所有这些步骤。
                    </p>
                <li data-md="">
                    <p>令 <var>layoutOptionsValue</var> 为 <a data-link-type="dfn"
                            href="https://tc39.github.io/ecma262/#sec-get-o-p"
                            id="ref-for-sec-get-o-p②">Get</a>(<var>layoutCtor</var>, "layoutOptions") 的结果。</p>
                <li data-md="">
                    <p>令 <var>layoutOptions</var> 为 <a data-link-type="dfn"
                            href="https://heycam.github.io/webidl/#es-type-mapping" id="ref-for-es-type-mapping②">转换</a>
                        <var>layoutOptionsValue</var> 为 <code
                            class="idl"><a data-link-type="idl" href="#dictdef-layoutoptions" id="ref-for-dictdef-layoutoptions②">LayoutOptions</a></code>
                        的结果。如果抛出异常，则重新抛出该异常并终止所有这些步骤。
                    </p>
                <li data-md="">
                    <p>如果 <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-isconstructor"
                            id="ref-for-sec-isconstructor">IsConstructor</a>(<var>layoutCtor</var>) 的结果为 false，<a
                            data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw"
                            id="ref-for-dfn-throw⑤">抛出</a> 一个 <a data-link-type="dfn"
                            href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror"
                            id="ref-for-sec-native-error-types-used-in-this-standard-typeerror①">TypeError</a>
                        并终止所有这些步骤。</p>
                <li data-md="">
                    <p>令 <var>prototype</var> 为 <a data-link-type="dfn"
                            href="https://tc39.github.io/ecma262/#sec-get-o-p"
                            id="ref-for-sec-get-o-p③">Get</a>(<var>layoutCtor</var>, "prototype") 的结果。</p>
                <li data-md="">
                    <p>如果 <a data-link-type="dfn"
                            href="https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values"
                            id="ref-for-sec-ecmascript-data-types-and-values">Type</a>(<var>prototype</var>) 的结果不是
                        Object，<a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw"
                            id="ref-for-dfn-throw⑥">抛出</a> 一个 <a data-link-type="dfn"
                            href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror"
                            id="ref-for-sec-native-error-types-used-in-this-standard-typeerror②">TypeError</a>
                        并终止所有这些步骤。</p>
                <li data-md="">
                    <p>令 <var>intrinsicSizes</var> 为 <a data-link-type="dfn"
                            href="https://tc39.github.io/ecma262/#sec-get-o-p"
                            id="ref-for-sec-get-o-p④">Get</a>(<var>prototype</var>, <code>"intrinsicSizes"</code>) 的结果。
                    </p>
                <li data-md="">
                    <p>如果 <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-iscallable"
                            id="ref-for-sec-iscallable">IsCallable</a>(<var>intrinsicSizes</var>) 的结果为 false，<a
                            data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw"
                            id="ref-for-dfn-throw⑦">抛出</a> 一个 <a data-link-type="dfn"
                            href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror"
                            id="ref-for-sec-native-error-types-used-in-this-standard-typeerror③">TypeError</a>
                        并终止所有这些步骤。</p>
                <li data-md="">
                    <p>如果 <var>intrinsicSizes</var> 的 <code>[[FunctionKind]]</code> 内部槽不是 <code>"generator"</code>，<a
                            data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw"
                            id="ref-for-dfn-throw⑧">抛出</a> 一个 <a data-link-type="dfn"
                            href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror"
                            id="ref-for-sec-native-error-types-used-in-this-standard-typeerror④">TypeError</a>
                        并终止所有这些步骤。</p>
                <li data-md="">
                    <p>令 <var>layout</var> 为 <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-get-o-p"
                            id="ref-for-sec-get-o-p⑤">Get</a>(<var>prototype</var>, <code>"layout"</code>) 的结果。</p>
                <li data-md="">
                    <p>如果 <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-iscallable"
                            id="ref-for-sec-iscallable①">IsCallable</a>(<var>layout</var>) 的结果为 false，<a
                            data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw"
                            id="ref-for-dfn-throw⑨">抛出</a> 一个 <a data-link-type="dfn"
                            href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror"
                            id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤">TypeError</a>
                        并终止所有这些步骤。</p>
                <li data-md="">
                    <p>如果 <var>layout</var> 的 <code>[[FunctionKind]]</code> 内部槽不是 <code>"generator"</code>，<a
                            data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw"
                            id="ref-for-dfn-throw①⓪">抛出</a> 一个 <a data-link-type="dfn"
                            href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror"
                            id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑥">TypeError</a>
                        并终止所有这些步骤。</p>
                <li data-md="">
                    <p>令 <var>definition</var> 为一个新的 <a data-link-type="dfn" href="#layout-definition"
                            id="ref-for-layout-definition">布局定义</a>，其属性为：</p>
                    <ul>
                        <li data-md="">
                            <p><a data-link-type="dfn" href="#layout-definition-class-constructor"
                                    id="ref-for-layout-definition-class-constructor">类构造函数</a> 为 <var>layoutCtor</var>。
                            </p>
                        <li data-md="">
                            <p><a data-link-type="dfn" href="#layout-definition-layout-generator-function"
                                    id="ref-for-layout-definition-layout-generator-function">布局生成函数</a> 为
                                <var>layout</var>。
                            </p>
                        <li data-md="">
                            <p><a data-link-type="dfn" href="#layout-definition-intrinsic-sizes-generator-function"
                                    id="ref-for-layout-definition-intrinsic-sizes-generator-function">固有尺寸生成函数</a> 为
                                <var>intrinsicSizes</var>。
                            </p>
                        <li data-md="">
                            <p><a data-link-type="dfn" href="#layout-definition-constructor-valid-flag"
                                    id="ref-for-layout-definition-constructor-valid-flag">构造函数有效标志</a> 为 <b>true</b>。
                            </p>
                        <li data-md="">
                            <p><a data-link-type="dfn" href="#layout-definition-input-properties"
                                    id="ref-for-layout-definition-input-properties">输入属性</a> 为
                                <var>inputProperties</var>。
                            </p>
                        <li data-md="">
                            <p><a data-link-type="dfn" href="#layout-definition-child-input-properties"
                                    id="ref-for-layout-definition-child-input-properties①">子输入属性</a> 为
                                <var>childInputProperties</var>。
                            </p>
                        <li data-md="">
                            <p><a data-link-type="dfn" href="#layout-definition-layout-options"
                                    id="ref-for-layout-definition-layout-options">布局选项</a> 为 <var>layoutOptions</var>。
                            </p>
                    </ul>
                <li data-md="">
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set"
                            id="ref-for-map-set①">设置</a> <var>layoutDefinitionMap</var>[<var>name</var>] 为
                        <var>definition</var>。
                    </p>
                <li data-md="">
                    <p><a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                            id="ref-for-queue-a-task">排队任务</a> 以运行以下步骤：</p>
                    <ol>
                        <li data-md="">
                            <p>令 <var>documentLayoutDefinitionMap</var> 为相关的 <a data-link-type="dfn"
                                    href="https://dom.spec.whatwg.org/#concept-document"
                                    id="ref-for-concept-document②">文档的</a> <a data-link-type="dfn"
                                    href="#document-layout-definitions"
                                    id="ref-for-document-layout-definitions">文档布局定义</a> <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map④">映射</a>。
                            </p>
                        <li data-md="">
                            <p>令 <var>documentDefinition</var> 为一个新的 <a data-link-type="dfn"
                                    href="#document-layout-definition"
                                    id="ref-for-document-layout-definition">文档布局定义</a>，其属性为：</p>
                            <ul>
                                <li data-md="">
                                    <p><a data-link-type="dfn" href="#document-layout-definition-input-properties"
                                            id="ref-for-document-layout-definition-input-properties①">输入属性</a> 为
                                        <var>inputProperties</var>。
                                    </p>
                                <li data-md="">
                                    <p><a data-link-type="dfn" href="#document-layout-definition-child-input-properties"
                                            id="ref-for-document-layout-definition-child-input-properties①">子输入属性</a> 为
                                        <var>childInputProperties</var>。
                                    </p>
                                <li data-md="">
                                    <p><a data-link-type="dfn" href="#document-layout-definition-layout-options"
                                            id="ref-for-document-layout-definition-layout-options⑦">布局选项</a> 为
                                        <var>layoutOptions</var>。
                                    </p>
                            </ul>
                        <li data-md="">
                            <p>如果 <var>documentLayoutDefinitionMap</var>[<var>name</var>] <a data-link-type="dfn"
                                    href="https://infra.spec.whatwg.org/#map-exists"
                                    id="ref-for-map-exists②">存在</a>，执行以下步骤：</p>
                            <ol>
                                <li data-md="">
                                    <p>令 <var>existingDocumentDefinition</var> 为 <a data-link-type="dfn"
                                            href="https://infra.spec.whatwg.org/#map-get" id="ref-for-map-get①">获取</a>
                                        <var>documentLayoutDefinitionMap</var>[<var>name</var>] 的结果。
                                    </p>
                                <li data-md="">
                                    <p>如果 <var>existingDocumentDefinition</var> 是 <code>"invalid"</code>，终止所有这些步骤。</p>
                                <li data-md="">
                                    <p>如果 <var>existingDocumentDefinition</var> 和 <var>documentDefinition</var> 不相等（即 <a
                                            data-link-type="dfn" href="#document-layout-definition-input-properties"
                                            id="ref-for-document-layout-definition-input-properties②">输入属性</a>、<a
                                            data-link-type="dfn"
                                            href="#document-layout-definition-child-input-properties"
                                            id="ref-for-document-layout-definition-child-input-properties②">子输入属性</a> 和
                                        <a data-link-type="dfn" href="#document-layout-definition-layout-options"
                                            id="ref-for-document-layout-definition-layout-options⑧">布局选项</a> 不同），则：
                                    </p>
                                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set"
                                            id="ref-for-map-set②">设置</a>
                                        <var>documentLayoutDefinitionMap</var>[<var>name</var>] 为
                                        <code>"invalid"</code>。
                                    </p>
                                    <p>向调试控制台记录错误，指出相同的类已使用不同的
                                        <code>inputProperties</code>、<code>childInputProperties</code> 或
                                        <code>layoutOptions</code> 注册。
                                    </p>
                            </ol>
                        <li data-md="">
                            <p>否则，<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set"
                                    id="ref-for-map-set③">设置</a> <var>documentLayoutDefinitionMap</var>[<var>name</var>]
                                为 <var>documentDefinition</var>。</p>
                    </ol>
            </ol>
            <div class="note" role="note">
                注意：类的结构应为：
                <pre class="lang-javascript highlight"><span class="kr">class</span> MyLayout <span class="p">{</span>
    <span class="kr">static</span> get inputProperties<span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="p">[</span><span class="s1">'--foo'</span><span class="p">];</span> <span class="p">}</span>
    <span class="kr">static</span> get childrenInputProperties<span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="p">[</span><span class="s1">'--bar'</span><span class="p">];</span> <span class="p">}</span>
    <span class="kr">static</span> get layoutOptions<span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>childDisplay<span class="o">:</span> <span class="s1">'normal'</span><span class="p">,</span> sizing<span class="o">:</span> <span class="s1">'block-like'</span><span class="p">}</span>
    <span class="p">}</span>

    <span class="o">*</span>intrinsicSizes<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> styleMap<span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Intrinsic sizes code goes here.</span>
<span class="c1"></span>    <span class="p">}</span>

    <span class="o">*</span>layout<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> constraints<span class="p">,</span> styleMap<span class="p">,</span> breakToken<span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Layout code goes here.</span>
<span class="c1"></span>    <span class="p">}</span>
<span class="p">}</span>
</pre>
            </div>
        </div>
        <h3 class="heading settled" data-level="5.5" id="layout-engine"><span class="secno">5.5. </span><span
                class="content">布局引擎</span><a class="self-link" href="#layout-engine"></a></h3>
        <div class="issue" id="issue-ac1b3ccd">
            <a class="self-link" href="#issue-ac1b3ccd"></a> 问题：当前的 API 是可迭代生成器形式。基于实现经验和
            web 开发者的经验，这可能会更改为基于 Promise 的 API。这两者各有优缺点。
            <p><em>Promises</em></p>
            <ul>
                <li data-md="">
                    <p>更好的错误报告。</p>
                <li data-md="">
                    <p>可能更符合开发者的习惯。</p>
            </ul>
            <p><em>生成器</em></p>
            <ul>
                <li data-md="">
                    <p>更“严格” - 只能执行布局操作。不必限制每次调用中哪些 Promise API 可用。</p>
                <li data-md="">
                    <p>可能具有更好的绑定开销。</p>
            </ul>
        </div>
        <h4 class="heading settled" data-level="5.5.1" id="request-objects"><span class="secno">5.5.1. </span><span
                class="content">请求对象</span><a class="self-link" href="#request-objects"></a></h4>
        <pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①②">Exposed</a>=<span class="n">LayoutWorklet</span>]
        <span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="intrinsicsizesrequest"><code>IntrinsicSizesRequest</code></dfn> {
        };
        
        [<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①③">Exposed</a>=<span class="n">LayoutWorklet</span>]
        <span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="layoutfragmentrequest"><code>LayoutFragmentRequest</code></dfn> {
        };
        
        <span class="kt">typedef</span> (<a class="n" data-link-type="idl-name" href="#intrinsicsizesrequest" id="ref-for-intrinsicsizesrequest③">IntrinsicSizesRequest</a> <span class="kt">or</span> <a class="n" data-link-type="idl-name" href="#layoutfragmentrequest" id="ref-for-layoutfragmentrequest③">LayoutFragmentRequest</a>)
            <dfn class="nv dfn-paneled idl-code" data-dfn-type="typedef" data-export="" id="typedefdef-layoutfragmentrequestorintrinsicsizesrequest"><code>LayoutFragmentRequestOrIntrinsicSizesRequest</code></dfn>;
        </pre>
        <p><code
                class="idl"><a data-link-type="idl" href="#intrinsicsizesrequest" id="ref-for-intrinsicsizesrequest④">IntrinsicSizesRequest</a></code>
            具有内部槽：</p>
        <ul>
            <li data-md="">
                <p><dfn class="dfn-paneled idl-code" data-dfn-for="IntrinsicSizesRequest" data-dfn-type="attribute"
                        data-export=""
                        id="dom-intrinsicsizesrequest-layoutchild-slot"><code>[[layoutChild]]</code></dfn> 是一个 <code
                        class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild③③">LayoutChild</a></code>，
                    这是必须计算固有尺寸的子元素。</p>
        </ul>
        <p><code
                class="idl"><a data-link-type="idl" href="#layoutfragmentrequest" id="ref-for-layoutfragmentrequest④">LayoutFragmentRequest</a></code>
            具有内部槽：</p>
        <ul>
            <li data-md="">
                <p><dfn class="dfn-paneled idl-code" data-dfn-for="LayoutFragmentRequest" data-dfn-type="attribute"
                        data-export=""
                        id="dom-layoutfragmentrequest-layoutchild-slot"><code>[[layoutChild]]</code></dfn> 是一个 <code
                        class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild③④">LayoutChild</a></code>，
                    这是必须为其生成片段的子元素。</p>
            <li data-md="">
                <p><dfn class="dfn-paneled idl-code" data-dfn-for="LayoutFragmentRequest" data-dfn-type="attribute"
                        data-export=""
                        id="dom-layoutfragmentrequest-layoutconstraints-slot"><code>[[layoutConstraints]]</code></dfn>
                    是一个 <code
                        class="idl"><a data-link-type="idl" href="#dictdef-layoutconstraintsoptions" id="ref-for-dictdef-layoutconstraintsoptions①">LayoutConstraintsOptions</a></code>
                    字典，这是 <code
                        class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild③⑤">LayoutChild</a></code>
                    布局算法的输入约束。</p>
            <li data-md="">
                <p><dfn class="dfn-paneled idl-code" data-dfn-for="LayoutFragmentRequest" data-dfn-type="attribute"
                        data-export="" id="dom-layoutfragmentrequest-breaktoken-slot"><code>[[breakToken]]</code></dfn>
                    是一个 <code
                        class="idl"><a data-link-type="idl" href="#childbreaktoken" id="ref-for-childbreaktoken⑥">ChildBreakToken</a></code>
                    对象，
                    这是布局必须恢复的中断标记。</p>
        </ul>
        <hr>
        <p>作者提供的布局类上的 layout 方法和固有尺寸方法是生成器函数，而不是常规的 JavaScript 函数。这样做是为了让用户代理支持异步和并行布局引擎。</p>
        <p>当作者在 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment⑦">layoutNextFragment()</a></code>
            方法上调用 <code
                class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild③⑥">LayoutChild</a></code>
            时，
            用户代理不会同步生成一个 <code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment②①">LayoutFragment</a></code>
            来返回给作者的代码。
            相反，它会返回一个 <code
                class="idl"><a data-link-type="idl" href="#layoutfragmentrequest" id="ref-for-layoutfragmentrequest⑤">LayoutFragmentRequest</a></code>。
            对作者而言，这个对象是完全不透明的，但它包含内部槽，封装了 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment⑧">layoutNextFragment()</a></code>
            方法调用。</p>
        <p>当从布局生成器对象中生成一个或多个 <code
                class="idl"><a data-link-type="idl" href="#layoutfragmentrequest" id="ref-for-layoutfragmentrequest⑥">LayoutFragmentRequest</a></code>
            时，
            用户代理的布局引擎可能与其他工作异步运行该算法，和/或在不同的执行线程上运行。当引擎生成一个或多个 <code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment②②">LayoutFragment</a></code>
            时，
            用户代理将用生成的 <code
                class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment②③">LayoutFragment</a></code>
            来“触发”生成器对象。
        </p>
        <p>同样适用于 <code
                class="idl"><a data-link-type="idl" href="#dom-layoutchild-intrinsicsizes" id="ref-for-dom-layoutchild-intrinsicsizes②">intrinsicSizes()</a></code>
            方法。</p>
        <div class="example" id="example-4d7c19cf">
            <a class="self-link" href="#example-4d7c19cf"></a> 下面显示了一个用 JavaScript 编写的布局引擎示例。
            <pre class="lang-javascript highlight"><span class="kr">class</span> LayoutEngine <span class="p">{</span>
  <span class="c1">// This function takes the root of the box-tree, a LayoutConstraints object, and a</span>
<span class="c1"></span>  <span class="c1">// BreakToken to (if paginating for printing for example) and generates a</span>
<span class="c1"></span>  <span class="c1">// LayoutFragment.</span>
<span class="c1"></span>  layoutEntry<span class="p">(</span>rootBox<span class="p">,</span> rootPageConstraints<span class="p">,</span> breakToken<span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> layoutFragment<span class="p">({</span>
      box<span class="o">:</span> rootBox<span class="p">,</span>
      layoutConstraints<span class="o">:</span> rootPageConstraints<span class="p">,</span>
      breakToken<span class="o">:</span> breakToken<span class="p">,</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="c1">// 该函数接收一个 LayoutFragmentRequest 并调用相应的函数</span>
<span class="c1"></span>  <span class="c1">// layout algorithm to generate the a LayoutFragment.</span>
<span class="c1"></span>  layoutFragment<span class="p">(</span>fragmentRequest<span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> box <span class="o">=</span> fragmentRequest<span class="p">.</span>layoutChild<span class="p">;</span>
    <span class="kr">const</span> algorithm <span class="o">=</span> selectLayoutAlgorithmForBox<span class="p">(</span>box<span class="p">);</span>
    <span class="kr">const</span> fragmentRequestGenerator <span class="o">=</span> algorithm<span class="p">.</span>layout<span class="p">(</span>
        fragmentRequest<span class="p">.</span>layoutConstraints<span class="p">,</span>
        box<span class="p">.</span>children<span class="p">,</span>
        box<span class="p">.</span>styleMap<span class="p">,</span>
        fragmentRequest<span class="p">.</span>breakToken<span class="p">);</span>

    <span class="kd">let</span> nextFragmentRequest <span class="o">=</span> fragmentRequestGenerator<span class="p">.</span>next<span class="p">();</span>

    <span class="k">while</span> <span class="p">(</span><span class="o">!</span>nextFragmentRequest<span class="p">.</span>done<span class="p">)</span> <span class="p">{</span>
        <span class="c1">// 用户代理可能会决定执行布局以生成片段</span>
<span class="c1"></span>      <span class="c1">// parallel on separate threads. This example performs them synchronously</span>
<span class="c1"></span>      <span class="c1">// in order.</span>
<span class="c1"></span>      <span class="kd">let</span> fragments <span class="o">=</span> nextFragmentRequest<span class="p">.</span>value<span class="p">.</span>map<span class="p">(</span>layoutFragment<span class="p">);</span>

      <span class="c1">// 用户代理可能会在恢复此布局工作之前中断去执行其他工作（例如垃圾回收）</span>
<span class="c1"></span>      <span class="c1">// 此示例只是同步执行布局，无法进行中断。</span>
<span class="c1"></span>      nextFragmentRequest <span class="o">=</span> fragmentRequestGenerator<span class="p">.</span>next<span class="p">(</span>fragments<span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> nextFragmentRequest<span class="p">.</span>value<span class="p">;</span> <span class="c1">// Return the final LayoutFragment.</span>
<span class="c1"></span>  <span class="p">}</span>
<span class="p">}</span>
</pre>
        </div>
        <h3 class="heading settled" data-level="5.6" id="performing-layout"><span class="secno">5.6. </span><span
                class="content">执行布局</span><a class="self-link" href="#performing-layout"></a></h3>
        <pre class="idl highlight def">// This is the final return value from the author defined layout() method.
<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-fragmentresultoptions"><code>FragmentResultOptions</code></dfn> {
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑥"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-default="0" data-dfn-for="FragmentResultOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-fragmentresultoptions-inlinesize"><code>inlineSize</code></dfn> = 0;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑦"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-default="0" data-dfn-for="FragmentResultOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-fragmentresultoptions-blocksize"><code>blockSize</code></dfn> = 0;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑧"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-default="0" data-dfn-for="FragmentResultOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-fragmentresultoptions-autoblocksize"><code>autoBlockSize</code></dfn> = 0;
    <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#layoutfragment" id="ref-for-layoutfragment②④">LayoutFragment</a>> <dfn class="nv dfn-paneled idl-code" data-default="None" data-dfn-for="FragmentResultOptions" data-dfn-type="dict-member" data-export="" data-type="sequence<LayoutFragment> " id="dom-fragmentresultoptions-childfragments"><code>childFragments</code></dfn> = [];
    <span class="kt">any</span> <dfn class="nv dfn-paneled idl-code" data-default="null" data-dfn-for="FragmentResultOptions" data-dfn-type="dict-member" data-export="" data-type="any " id="dom-fragmentresultoptions-data"><code>data</code></dfn> = <span class="kt">null</span>;
    <a class="n" data-link-type="idl-name" href="#dictdef-breaktokenoptions" id="ref-for-dictdef-breaktokenoptions">BreakTokenOptions</a> <dfn class="nv dfn-paneled idl-code" data-default="null" data-dfn-for="FragmentResultOptions" data-dfn-type="dict-member" data-export="" data-type="BreakTokenOptions " id="dom-fragmentresultoptions-breaktoken"><code>breakToken</code></dfn> = <span class="kt">null</span>;
};

<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-intrinsicsizesresultoptions"><code>IntrinsicSizesResultOptions</code></dfn> {
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑨"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="IntrinsicSizesResultOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-intrinsicsizesresultoptions-maxcontentsize"><code>maxContentSize</code></dfn>;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double③⓪"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="IntrinsicSizesResultOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-intrinsicsizesresultoptions-mincontentsize"><code>minContentSize</code></dfn>;
};
</pre>
        <h4 class="heading settled" data-level="5.6.1" id="determining-intrinsic-sizes"><span class="secno">5.6.1.
            </span><span class="content">确定固有尺寸</span><a class="self-link" href="#determining-intrinsic-sizes"></a></h4>
        <p><a data-link-type="dfn" href="#determine-the-intrinsic-sizes"
                id="ref-for-determine-the-intrinsic-sizes①">确定固有尺寸</a>算法定义了用户代理如何查询作者定义的布局，获取<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-display-3/#box" id="ref-for-box②⓪">盒子</a>的<a data-link-type="dfn"
                href="https://drafts.csswg.org/css-sizing/#intrinsic-sizes" id="ref-for-intrinsic-sizes">固有尺寸</a>信息。</p>
        <p class="note" role="note"><span>注意：</span> <a data-link-type="dfn" href="#determine-the-intrinsic-sizes"
                id="ref-for-determine-the-intrinsic-sizes②">确定固有尺寸</a>算法允许用户代理缓存任意数量的先前调用以便重用。</p>
        <div class="algorithm" data-algorithm="determine the intrinsic sizes">
            当用户代理希望为给定的<var>box</var>、<var>childBoxes</var> <dfn class="dfn-paneled" data-dfn-type="dfn"
                data-noexport="" id="determine-the-intrinsic-sizes">确定固有尺寸</dfn>的<a data-link-type="dfn"
                href="#layout-api-formatting-context"
                id="ref-for-layout-api-formatting-context">布局API格式化上下文</a>时，它<em>必须</em>执行以下步骤：
            <ol>
                <li data-md="">
                    <p>令<var>layoutFunction</var>为<var>box</var>的<a class="css" data-link-type="maybe"
                            href="#valdef-display-layout" id="ref-for-valdef-display-layout⑤">布局()</a>。</p>
                <li data-md="">
                    <p>如果<var>layoutFunction</var>的<a data-link-type="dfn" href="#intrinsic-sizes-valid-flag"
                            id="ref-for-intrinsic-sizes-valid-flag⑤">固有尺寸有效标志</a>为<a data-link-type="dfn"
                            href="#intrinsic-sizes-valid"
                            id="ref-for-intrinsic-sizes-valid">固有尺寸有效</a>，则用户代理<em>可以</em>使用先前调用中的固有尺寸。如果是这样，它<em>可以</em>中止所有这些步骤并使用先前的固有尺寸值。
                    </p>
                <li data-md="">
                    <p>将<var>layoutFunction</var>的<a data-link-type="dfn" href="#intrinsic-sizes-valid-flag"
                            id="ref-for-intrinsic-sizes-valid-flag⑥">固有尺寸有效标志</a>设置为<a data-link-type="dfn"
                            href="#intrinsic-sizes-valid" id="ref-for-intrinsic-sizes-valid①">固有尺寸有效</a>。</p>
                <li data-md="">
                    <p>令<var>name</var>为<var>layoutFunction</var>的第一个参数。</p>
                <li data-md="">
                    <p>令<var>documentDefinition</var>为<a data-link-type="dfn" href="#get-a-document-layout-definition"
                            id="ref-for-get-a-document-layout-definition②">获取文档布局定义</a>给定的<var>name</var>的结果。</p>
                    <p>如果<a data-link-type="dfn" href="#get-a-document-layout-definition"
                            id="ref-for-get-a-document-layout-definition③">获取文档布局定义</a>返回失败，或<var>documentDefinition</var>为<code>"invalid"</code>，则让<var>box</var>回退到<a
                            data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout"
                            id="ref-for-flow-layout">流布局</a>，并中止所有这些步骤。</p>
                <li data-md="">
                    <p>令<var>workletGlobalScope</var>为来自布局<a class="idl" data-link-type="idl"
                            href="https://www.w3.org/TR/worklets-1/#worklet" id="ref-for-worklet③">Worklet</a>中<a
                            data-link-type="dfn" href="https://www.w3.org/TR/worklets-1/#worklets-workletglobalscopes"
                            id="ref-for-worklets-workletglobalscopes">工作域的WorkletGlobalScopes</a>列表中的<code
                            class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope⑦">LayoutWorkletGlobalScope</a></code>。
                    </p>
                    <p>用户代理<em>必须</em>拥有并从至少两个<code
                            class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope⑧">LayoutWorkletGlobalScope</a></code>中选择，除非用户代理处于内存限制下。
                    </p>
                    <p class="note" role="note"><span>注意：</span> 这是为了确保作者不依赖于能够在全局对象上存储状态或不可再生成的类状态。</p>
                    <p>用户代理<em>也可以</em>在此时<a data-link-type="dfn">创建一个 WorkletGlobalScope</a>，给定布局<code
                            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/worklets-1/#worklet" id="ref-for-worklet④">Worklet</a></code>。
                    </p>
                <li data-md="">
                    <p>运行<a data-link-type="dfn" href="#invoke-a-intrinsic-sizes-callback"
                            id="ref-for-invoke-a-intrinsic-sizes-callback">调用固有尺寸回调</a>给定的<var>name</var>、<var>box</var>、<var>childBoxes</var>和<var>workletGlobalScope</var>，可选地<a
                            data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                            id="ref-for-in-parallel">并行</a>。</p>
                    <p class="note" role="note"><span>注意：</span> 如果用户代理在<a data-link-type="dfn"
                            href="#invoke-a-intrinsic-sizes-callback"
                            id="ref-for-invoke-a-intrinsic-sizes-callback①">调用固有尺寸回调</a>时在一个线程上<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                            id="ref-for-in-parallel①">并行</a>运行，它应选择可以在该线程上使用的布局工作域。</p>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="invoke a intrinsic sizes callback">
            当用户代理希望为<var>name</var>、<var>box</var>、<var>childBoxes</var>和<var>workletGlobalScope</var><dfn
                class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="invoke-a-intrinsic-sizes-callback">调用固有尺寸回调</dfn>时，它<em>必须</em>执行以下步骤：
            <ol>
                <li data-md="">
                    <p>令<var>definition</var>为<a data-link-type="dfn" href="#get-a-layout-definition"
                            id="ref-for-get-a-layout-definition②">获取布局定义</a>给定的<var>name</var>和<var>workletGlobalScope</var>的结果。
                    </p>
                    <p>如果<a data-link-type="dfn" href="#get-a-layout-definition"
                            id="ref-for-get-a-layout-definition③">获取布局定义</a>返回失败，则让<var>box</var>回退到<a
                            data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout"
                            id="ref-for-flow-layout①">流布局</a>，并中止所有这些步骤。</p>
                <li data-md="">
                    <p>令<var>layoutInstance</var>为<a data-link-type="dfn" href="#get-a-layout-class-instance"
                            id="ref-for-get-a-layout-class-instance">获取布局类实例</a>给定<var>box</var>、<var>definition</var>和<var>workletGlobalScope</var>的结果。
                    </p>
                    <p>如果<a data-link-type="dfn" href="#get-a-layout-class-instance"
                            id="ref-for-get-a-layout-class-instance①">获取布局类实例</a>返回失败，则让<var>box</var>回退到<a
                            data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout"
                            id="ref-for-flow-layout②">流布局</a>，并中止所有这些步骤。</p>
                <li data-md="">
                    <p>令<var>inputProperties</var>为<var>definition</var>的<a data-link-type="dfn"
                            href="#layout-definition-input-properties"
                            id="ref-for-layout-definition-input-properties①">输入属性</a>。</p>
                <li data-md="">
                    <p>令<var>children</var>为一个新的<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                            id="ref-for-list⑤">列表</a>。</p>
                <li data-md="">
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate">对于每个</a><var>childBox</var>在<var>childBoxes</var>中执行以下子步骤：</p>
                    <ol>
                        <li data-md="">
                            <p>令<var>layoutChild</var>为<a data-link-type="dfn" href="#get-a-layout-child"
                                    id="ref-for-get-a-layout-child">获取布局子元素</a>给定<var>workletGlobalScope</var>、<var>name</var>和<var>childBox</var>的结果。
                            </p>
                        <li data-md="">
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append"
                                    id="ref-for-list-append">追加</a><var>layoutChild</var>到<var>children</var>。</p>
                    </ol>
                <li data-md="">
                    <p>令<var>edges</var>为一个新的<code
                            class="idl"><a data-link-type="idl" href="#layoutedgesizes" id="ref-for-layoutedgesizes⑥">LayoutEdgeSizes</a></code>，其填充了<var>box</var>的所有<a
                            data-link-type="dfn" href="https://www.w3.org/TR/css-cascade-4/#computed-value"
                            id="ref-for-computed-value⑥">计算值</a>的<a data-link-type="dfn"
                            href="https://www.w3.org/TR/CSS21/box.html#box-dimensions"
                            id="ref-for-box-dimensions①">盒模型边缘</a>。</p>
                <li data-md="">
                    <p>令<var>styleMap</var>为一个新的<code
                            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-typed-om-1/#stylepropertymapreadonly" id="ref-for-stylepropertymapreadonly④">StylePropertyMapReadOnly</a></code>，仅填充了<var>box</var>的<var>inputProperties</var>列表中的<a
                            data-link-type="dfn" href="https://www.w3.org/TR/css-cascade-4/#computed-value"
                            id="ref-for-computed-value⑦">计算值</a>。</p>
                    <p class="issue" id="issue-233d3cc5"><a class="self-link" href="#issue-233d3cc5"></a>
                        我们可能希望将<var>styleMap</var>存储在<var>box</var>上，类似于<var>layoutInstance</var>。</p>
                <li data-md="">
                    <p>在此阶段，如果<var>children</var>、<var>styleMap</var>等同于先前的调用，用户代理可以重用先前调用中的<a data-link-type="dfn"
                            href="https://drafts.csswg.org/css-sizing/#intrinsic-sizes"
                            id="ref-for-intrinsic-sizes①">固有尺寸</a>。如果是这样，则让固有尺寸为缓存的固有尺寸，并中止所有这些步骤。</p>
                <li data-md="">
                    <p>令<var>intrinsicSizesGeneratorFunction</var>为<var>definition</var>的<a data-link-type="dfn"
                            href="#layout-definition-intrinsic-sizes-generator-function"
                            id="ref-for-layout-definition-intrinsic-sizes-generator-function①">固有尺寸生成器函数</a>。</p>
                <li data-md="">
                    <p>令<var>intrinsicSizesGenerator</var>为<a data-link-type="dfn"
                            href="https://heycam.github.io/webidl/#es-invoking-callback-functions"
                            id="ref-for-es-invoking-callback-functions">调用</a>(<var>intrinsicSizesGeneratorFunction</var>，<var>layoutInstance</var>，«<var>children</var>，<var>edges</var>，<var>styleMap</var>»）的结果。
                    </p>
                    <p>如果抛出<a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw"
                            id="ref-for-dfn-throw①①">异常</a>，则让<var>box</var>回退到<a data-link-type="dfn"
                            href="https://drafts.csswg.org/css-display-3/#flow-layout"
                            id="ref-for-flow-layout③">流布局</a>，并中止所有这些步骤。</p>
                <li data-md="">
                    <p>令<var>intrinsicSizesValue</var>为<a data-link-type="dfn" href="#run-a-generator"
                            id="ref-for-run-a-generator">运行生成器</a>给定的<var>intrinsicSizesGenerator</var>和<code>"intrinsic-sizes"</code>的结果。
                    </p>
                    <p>如果<a data-link-type="dfn" href="#run-a-generator"
                            id="ref-for-run-a-generator①">运行生成器</a>返回失败，则让<var>box</var>回退到<a data-link-type="dfn"
                            href="https://drafts.csswg.org/css-display-3/#flow-layout"
                            id="ref-for-flow-layout④">流布局</a>，并中止所有这些步骤。</p>
                <li data-md="">
                    <p>令<var>intrinsicSizes</var>为<a data-link-type="dfn"
                            href="https://heycam.github.io/webidl/#es-type-mapping"
                            id="ref-for-es-type-mapping③">转换</a><var>intrinsicSizesValue</var>为<code
                            class="idl"><a data-link-type="idl" href="#dictdef-intrinsicsizesresultoptions" id="ref-for-dictdef-intrinsicsizesresultoptions">IntrinsicSizesResultOptions</a></code>的结果。
                    </p>
                    <p>如果抛出<a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw"
                            id="ref-for-dfn-throw①②">异常</a>，则让<var>box</var>回退到<a data-link-type="dfn"
                            href="https://drafts.csswg.org/css-display-3/#flow-layout"
                            id="ref-for-flow-layout⑤">流布局</a>，并中止所有这些步骤。</p>
                <li data-md="">
                    <p>设置<var>box</var>的<a data-link-type="dfn"
                            href="https://drafts.csswg.org/css-sizing/#intrinsic-sizes"
                            id="ref-for-intrinsic-sizes②">固有尺寸</a>：</p>
                    <ul>
                        <li data-md="">
                            <p>令<var>intrinsicSizes</var>的<code
                                    class="idl"><a data-link-type="idl" href="#dom-intrinsicsizesresultoptions-mincontentsize" id="ref-for-dom-intrinsicsizesresultoptions-mincontentsize">minContentSize</a></code>为<var>box</var>的<a
                                    data-link-type="dfn" href="https://www.w3.org/TR/css-sizing-3/#min-content"
                                    id="ref-for-min-content①">最小内容尺寸</a>。</p>
                        <li data-md="">
                            <p>令<var>intrinsicSizes</var>的<code
                                    class="idl"><a data-link-type="idl" href="#dom-intrinsicsizesresultoptions-maxcontentsize" id="ref-for-dom-intrinsicsizesresultoptions-maxcontentsize">maxContentSize</a></code>为<var>box</var>的<a
                                    data-link-type="dfn" href="https://www.w3.org/TR/css-sizing-3/#max-content"
                                    id="ref-for-max-content①">最大内容尺寸</a>。</p>
                    </ul>
            </ol>
        </div>
        <h4 class="heading settled" data-level="5.6.2" id="generating-fragments"><span class="secno">5.6.2. </span><span
                class="content">生成片段</span><a class="self-link" href="#generating-fragments"></a></h4>
        <p><a data-link-type="dfn" href="#generate-a-fragment"
                id="ref-for-generate-a-fragment①">生成片段</a>算法定义了用户代理如何为作者定义的布局生成<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-display-3/#box" id="ref-for-box②①">盒子</a>的<a data-link-type="dfn"
                href="https://www.w3.org/TR/css3-break/#fragment" id="ref-for-fragment④">片段</a>。</p>
        <p class="note" role="note"><span>注意：</span> <a data-link-type="dfn" href="#generate-a-fragment"
                id="ref-for-generate-a-fragment②">生成片段</a>算法允许用户代理缓存任意数量的先前调用以便重用。</p>
        <div class="algorithm" data-algorithm="generate a fragment">
            当用户代理希望为给定的<var>box</var>、<var>childBoxes</var>、<var>internalLayoutConstraints</var>和可选的<var>internalBreakToken</var>生成<var>布局API格式化上下文</var>的<dfn
                class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="generate-a-fragment">片段</dfn>时，它<em>必须</em>执行以下步骤：
            <ol>
                <li data-md="">
                    <p>令<var>layoutFunction</var>为<var>box</var>的<a class="css" data-link-type="maybe"
                            href="#valdef-display-layout" id="ref-for-valdef-display-layout⑥">布局()</a>。</p>
                <li data-md="">
                    <p>如果<var>layoutFunction</var>的<a data-link-type="dfn" href="#layout-valid-flag"
                            id="ref-for-layout-valid-flag⑤">布局有效标志</a>为<a data-link-type="dfn" href="#layout-valid"
                            id="ref-for-layout-valid">布局有效</a>，用户代理<em>可以</em>使用先前调用中的固有尺寸。如果是这样，它<em>可以</em>中止所有这些步骤并使用先前的固有尺寸值。
                    </p>
                <li data-md="">
                    <p>将<var>layoutFunction</var>的<a data-link-type="dfn" href="#layout-valid-flag"
                            id="ref-for-layout-valid-flag⑥">布局有效标志</a>设置为<a data-link-type="dfn" href="#layout-valid"
                            id="ref-for-layout-valid①">布局有效</a>。</p>
                <li data-md="">
                    <p>令<var>name</var>为<var>layoutFunction</var>的第一个参数。</p>
                <li data-md="">
                    <p>令<var>documentDefinition</var>为<a data-link-type="dfn" href="#get-a-document-layout-definition"
                            id="ref-for-get-a-document-layout-definition④">获取文档布局定义</a>给定的<var>name</var>的结果。</p>
                    <p>如果<a data-link-type="dfn" href="#get-a-document-layout-definition"
                            id="ref-for-get-a-document-layout-definition⑤">获取文档布局定义</a>返回失败，或<var>documentDefinition</var>为<code>"invalid"</code>，则让<var>box</var>回退到<a
                            data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout"
                            id="ref-for-flow-layout⑥">流布局</a>，并中止所有这些步骤。</p>
                <li data-md="">
                    <p>令<var>workletGlobalScope</var>为来自布局<code
                            class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope⑨">LayoutWorkletGlobalScope</a></code>的<a
                            data-link-type="dfn" href="https://www.w3.org/TR/worklets-1/#worklets-workletglobalscopes"
                            id="ref-for-worklets-workletglobalscopes②">工作域列表</a>中的一个。</p>
                    <p>用户代理<em>必须</em>拥有并从至少两个<code
                            class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope①⓪">LayoutWorkletGlobalScope</a></code>中选择，除非用户代理处于内存限制下。
                    </p>
                    <p class="note" role="note"><span>注意：</span> 这是为了确保作者不依赖于能够在全局对象上存储状态或无法再生成的类状态。</p>
                    <p>用户代理<em>也可以</em>在此时<a data-link-type="dfn">创建一个 WorkletGlobalScope</a>，给定布局<code
                            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/worklets-1/#worklet" id="ref-for-worklet⑥">Worklet</a></code>。
                    </p>
                <li data-md="">
                    <p>运行<a data-link-type="dfn" href="#invoke-a-layout-callback"
                            id="ref-for-invoke-a-layout-callback">调用布局回调</a>给定的<var>name</var>、<var>box</var>、<var>childBoxes</var>、<var>internalLayoutConstraints</var>、<var>internalBreakToken</var>和<var>workletGlobalScope</var>，可选地<a
                            data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                            id="ref-for-in-parallel②">并行</a>。</p>
                    <p class="note" role="note"><span>注意：</span> 如果用户代理在一个线程上<a data-link-type="dfn"
                            href="#invoke-a-intrinsic-sizes-callback"
                            id="ref-for-invoke-a-intrinsic-sizes-callback②">调用固有尺寸回调</a>时<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                            id="ref-for-in-parallel③">并行</a>运行，它应选择可以在该线程上使用的布局工作域。</p>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="invoke a layout callback">
            当用户代理希望为<var>name</var>、<var>box</var>、<var>childBoxes</var>、<var>internalLayoutConstraints</var>、<var>internalBreakToken</var>和<var>workletGlobalScope</var><dfn
                class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="invoke-a-layout-callback">调用布局回调</dfn>时，它<em>必须</em>执行以下步骤：
            <ol>
                <li data-md="">
                    <p>令<var>definition</var>为<a data-link-type="dfn" href="#get-a-layout-definition"
                            id="ref-for-get-a-layout-definition④">获取布局定义</a>给定<var>name</var>和<var>workletGlobalScope</var>的结果。
                    </p>
                    <p>如果<a data-link-type="dfn" href="#get-a-layout-definition"
                            id="ref-for-get-a-layout-definition⑤">获取布局定义</a>返回失败，则让<var>box</var>回退到<a
                            data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout"
                            id="ref-for-flow-layout⑦">流布局</a>，并中止所有这些步骤。</p>
                <li data-md="">
                    <p>令<var>layoutInstance</var>为<a data-link-type="dfn" href="#get-a-layout-class-instance"
                            id="ref-for-get-a-layout-class-instance②">获取布局类实例</a>给定<var>box</var>、<var>definition</var>和<var>workletGlobalScope</var>的结果。
                    </p>
                    <p>如果<a data-link-type="dfn" href="#get-a-layout-class-instance"
                            id="ref-for-get-a-layout-class-instance③">获取布局类实例</a>返回失败，则让<var>box</var>回退到<a
                            data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout"
                            id="ref-for-flow-layout⑧">流布局</a>，并中止所有这些步骤。</p>
                <li data-md="">
                    <p>令<var>sizingMode</var>为<var>definition</var>的<a data-link-type="dfn"
                            href="#layout-definition-layout-options"
                            id="ref-for-layout-definition-layout-options①">布局选项</a>的<code
                            class="idl"><a data-link-type="idl" href="#dom-layoutoptions-sizing" id="ref-for-dom-layoutoptions-sizing③">sizing</a></code>属性。
                    </p>
                <li data-md="">
                    <p>令<var>inputProperties</var>为<var>definition</var>的<a data-link-type="dfn"
                            href="#layout-definition-input-properties"
                            id="ref-for-layout-definition-input-properties②">输入属性</a>。</p>
                <li data-md="">
                    <p>令<var>children</var>为一个新的<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list"
                            id="ref-for-list⑦">列表</a>。</p>
                <li data-md="">
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate①">对于每个</a><var>childBox</var>在<var>childBoxes</var>中执行以下子步骤：</p>
                    <ol>
                        <li data-md="">
                            <p>令<var>layoutChild</var>为<a data-link-type="dfn" href="#get-a-layout-child"
                                    id="ref-for-get-a-layout-child①">获取布局子元素</a>给定<var>workletGlobalScope</var>、<var>name</var>和<var>childBox</var>的结果。
                            </p>
                        <li data-md="">
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append"
                                    id="ref-for-list-append①">追加</a><var>layoutChild</var>到<var>children</var>。</p>
                    </ol>
                <li data-md="">
                    <p>令<var>edges</var>为一个新的<code
                            class="idl"><a data-link-type="idl" href="#layoutedgesizes" id="ref-for-layoutedgesizes⑦">LayoutEdgeSizes</a></code>，其填充了<var>box</var>的所有<a
                            data-link-type="dfn" href="https://www.w3.org/TR/css-cascade-4/#computed-value"
                            id="ref-for-computed-value⑨">计算值</a>的<a data-link-type="dfn"
                            href="https://www.w3.org/TR/CSS21/box.html#box-dimensions"
                            id="ref-for-box-dimensions②">盒模型边缘</a>。</p>
                <li data-md="">
                    <p>令<var>layoutConstraints</var>为<a data-link-type="dfn" href="#create-a-layout-constraints-object"
                            id="ref-for-create-a-layout-constraints-object">创建布局约束对象</a>给定的<var>internalLayoutConstraints</var>、<var>box</var>和<var>sizingMode</var>的结果。
                    </p>
                <li data-md="">
                    <p>令<var>styleMap</var>为一个新的<code
                            class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/css-typed-om-1/#stylepropertymapreadonly" id="ref-for-stylepropertymapreadonly⑤">StylePropertyMapReadOnly</a></code>，仅填充了<var>box</var>的<var>inputProperties</var>列表中的<a
                            data-link-type="dfn" href="https://www.w3.org/TR/css-cascade-4/#computed-value"
                            id="ref-for-computed-value①⓪">计算值</a>。</p>
                    <p class="issue" id="issue-233d3cc5①"><a class="self-link" href="#issue-233d3cc5①"></a>
                        我们可能希望将<var>styleMap</var>存储在<var>box</var>上，类似于<var>layoutInstance</var>。</p>
                <li data-md="">
                    <p>令<var>breakToken</var>为一个新的<code
                            class="idl"><a data-link-type="idl" href="#breaktoken" id="ref-for-breaktoken②">BreakToken</a></code>，其中填充了<var>internalBreakToken</var>的相关信息。
                    </p>
                    <p>如果<var>internalBreakToken</var>为null，则令<var>breakToken</var>为null。</p>
                <li data-md="">
                    <p>在此阶段，如果<var>children</var>、<var>styleMap</var>、<var>layoutConstraints</var>、<var>breakToken</var>等同于先前的调用，用户代理可以重用先前调用中的<a
                            data-link-type="dfn" href="https://www.w3.org/TR/css3-break/#fragment"
                            id="ref-for-fragment⑤">片段</a>。如果是这样，则让输出片段为缓存的片段，并中止所有这些步骤。</p>
                <li data-md="">
                    <p>令<var>layoutGeneratorFunction</var>为<var>definition</var>的<a data-link-type="dfn"
                            href="#layout-definition-layout-generator-function"
                            id="ref-for-layout-definition-layout-generator-function①">布局生成器函数</a>。</p>
                <li data-md="">
                    <p>令<var>layoutGenerator</var>为<a data-link-type="dfn"
                            href="https://heycam.github.io/webidl/#es-invoking-callback-functions"
                            id="ref-for-es-invoking-callback-functions①">调用</a>(<var>layoutGeneratorFunction</var>，<var>layoutInstance</var>，«<var>children</var>，<var>edges</var>，<var>layoutConstraints</var>，<var>styleMap</var>，<var>breakToken</var>»）的结果。
                    </p>
                    <p>如果抛出<a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw"
                            id="ref-for-dfn-throw①③">异常</a>，则让<var>box</var>回退到<a data-link-type="dfn"
                            href="https://drafts.csswg.org/css-display-3/#flow-layout"
                            id="ref-for-flow-layout⑨">流布局</a>，并中止所有这些步骤。</p>
                <li data-md="">
                    <p>令<var>fragmentValue</var>为<a data-link-type="dfn" href="#run-a-generator"
                            id="ref-for-run-a-generator②">运行生成器</a>给定的<var>layoutGenerator</var>和<code>"layout"</code>的结果。
                    </p>
                    <p>如果<a data-link-type="dfn" href="#run-a-generator"
                            id="ref-for-run-a-generator③">运行生成器</a>返回失败，则让<var>box</var>回退到<a data-link-type="dfn"
                            href="https://drafts.csswg.org/css-display-3/#flow-layout"
                            id="ref-for-flow-layout①⓪">流布局</a>，并中止所有这些步骤。</p>
                <li data-md="">
                    <p>令<var>fragment</var>为<a data-link-type="dfn"
                            href="https://heycam.github.io/webidl/#es-type-mapping"
                            id="ref-for-es-type-mapping④">转换</a><var>fragmentValue</var>为<code
                            class="idl"><a data-link-type="idl" href="#dictdef-fragmentresultoptions" id="ref-for-dictdef-fragmentresultoptions②">FragmentResultOptions</a></code>的结果。
                    </p>
                    <p>如果抛出<a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw"
                            id="ref-for-dfn-throw①④">异常</a>，则让<var>box</var>回退到<a data-link-type="dfn"
                            href="https://drafts.csswg.org/css-display-3/#flow-layout"
                            id="ref-for-flow-layout①①">流布局</a>，并中止所有这些步骤。</p>
                <li data-md="">
                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                            id="ref-for-list-iterate②">对于每个</a><var>childFragment</var>在<var>fragment</var>的<code
                            class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-childfragments" id="ref-for-dom-fragmentresultoptions-childfragments②">子片段</a></code>中执行以下步骤：
                    </p>
                    <ol>
                        <li data-md="">
                            <p>如果<var>childFragment</var>的<code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragment-generator-slot" id="ref-for-dom-layoutfragment-generator-slot①">[[generator]]</a></code>内部插槽不等于<var>layoutGenerator</var>，则让<var>box</var>回退到<a
                                    data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout"
                                    id="ref-for-flow-layout①②">流布局</a>，并中止所有这些步骤。</p>
                    </ol>
                <li data-md="">
                    <p>如果<var>sizingMode</var>为<code>"block-like"</code>：</p>
                    <ul>
                        <li data-md="">
                            <p>则：</p>
                            <ol>
                                <li data-md="">
                                    <p>令<var>inlineSize</var>为<var>layoutConstraints</var>的<code
                                            class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedinlinesize" id="ref-for-dom-layoutconstraints-fixedinlinesize⑧">固定行内尺寸</a></code>。（如果我们使用<code>"block-like"</code>的尺寸模式，则必须设置此值）。
                                    </p>
                                <li data-md="">
                                    <p>令<var>blockSize</var>为计算<var>box</var>的<b>边框盒</b><a data-link-type="dfn"
                                            href="https://www.w3.org/TR/css-writing-modes-3/#block-size"
                                            id="ref-for-block-size④">块级大小</a>的结果（相对于<var>box</var>的书写模式），如同块容器一样，给定<var>fragment</var>的<code
                                            class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-autoblocksize" id="ref-for-dom-fragmentresultoptions-autoblocksize">自动块大小</a></code>作为"固有高度"。
                                    </p>
                            </ol>
                        <li data-md="">
                            <p>否则（<var>sizingMode</var>为<code>"manual"</code>）：</p>
                            <ol>
                                <li data-md="">
                                    <p>令<var>inlineSize</var>为<var>fragment</var>的<code
                                            class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-inlinesize" id="ref-for-dom-fragmentresultoptions-inlinesize">行内尺寸</a></code>。
                                    </p>
                                <li data-md="">
                                    <p>令<var>blockSize</var>为<var>fragment</var>的<code
                                            class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-blocksize" id="ref-for-dom-fragmentresultoptions-blocksize">块大小</a></code>。
                                    </p>
                            </ol>
                    </ul>
                <li data-md="">
                    <p>为<var>box</var>返回一个<a data-link-type="dfn" href="https://www.w3.org/TR/css3-break/#fragment"
                            id="ref-for-fragment⑥">片段</a>，其包含以下内容：</p>
                    <ul>
                        <li data-md="">
                            <p><a data-link-type="dfn" href="https://www.w3.org/TR/css-writing-modes-3/#inline-size"
                                    id="ref-for-inline-size③">行内尺寸</a>设置为<var>inlineSize</var>。</p>
                        <li data-md="">
                            <p><a data-link-type="dfn" href="https://www.w3.org/TR/css-writing-modes-3/#block-size"
                                    id="ref-for-block-size⑤">块大小</a>设置为<var>blockSize</var>。</p>
                        <li data-md="">
                            <p>子片段设置为<var>fragment</var>的<code
                                    class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-childfragments" id="ref-for-dom-fragmentresultoptions-childfragments③">子片段</a></code>列表。顺序<em>很</em>重要，因为这决定了它们的绘制顺序（如<a
                                    href="#layout-api-containers">第2节
                                    布局API容器</a>所述）。它们相对于<var>fragment</var>的<b>边框盒</b>的位置应基于作者指定的<code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlineoffset" id="ref-for-dom-layoutfragment-inlineoffset⑤">inlineOffset</a></code>和<code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blockoffset" id="ref-for-dom-layoutfragment-blockoffset⑤">blockOffset</a></code>。
                            </p>
                        <li data-md="">
                            <p><a data-link-type="dfn" href="https://drafts.csswg.org/css-break/#fragmentation-break"
                                    id="ref-for-fragmentation-break">片段化中断</a>信息设置为<var>fragment</var>的<code
                                    class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-breaktoken" id="ref-for-dom-fragmentresultoptions-breaktoken①">breakToken</a></code>。
                            </p>
                        <li data-md="">
                            <p>令<var>clonedData</var>为调用<a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/#structuredserializeforstorage"
                                    id="ref-for-structuredserializeforstorage">StructuredSerializeForStorage</a>获取<var>fragment</var>的<code
                                    class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-data" id="ref-for-dom-fragmentresultoptions-data①">数据</a></code>的结果。
                            </p>
                            <p>用户代理必须将<var>clonedData</var>与<a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css3-break/#fragment" id="ref-for-fragment⑦">片段</a>一起存储。
                            </p>
                    </ul>
            </ol>
        </div>
        <h4 class="heading settled" data-level="5.6.3" id="utility-algorithms"><span class="secno">5.6.3. </span><span
                class="content">实用算法</span><a class="self-link" href="#utility-algorithms"></a></h4>
        <p>本节指定了<a data-link-type="dfn" href="#determine-the-intrinsic-sizes"
                id="ref-for-determine-the-intrinsic-sizes③">确定固有尺寸</a>和<a data-link-type="dfn"
                href="#generate-a-fragment" id="ref-for-generate-a-fragment③">生成片段</a>算法中通用的算法。</p>
        <div class="algorithm" data-algorithm="get a document layout definition">
            当用户代理希望<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="get-a-document-layout-definition">获取文档布局定义</dfn>时，它<em>必须</em>执行以下步骤：
            <ol>
                <li data-md="">
                    <p>令<var>documentLayoutDefinitionMap</var>为关联的<a data-link-type="dfn"
                            href="https://dom.spec.whatwg.org/#concept-document"
                            id="ref-for-concept-document③">文档</a>的<a data-link-type="dfn"
                            href="#document-layout-definitions" id="ref-for-document-layout-definitions①">文档布局定义</a>映射。
                    </p>
                <li data-md="">
                    <p>如果 <var>documentLayoutDefinitionMap</var>[<var>name</var>] 不 <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#map-exists"
                            id="ref-for-map-exists③">存在</a>，则返回失败并中止所有这些步骤。</p>
                <li data-md="">
                    <p>返回<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-get"
                            id="ref-for-map-get②">获取</a>的<var>documentLayoutDefinitionMap</var>[<var>name</var>]的结果。</p>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="get a layout definition">
            当用户代理希望<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="get-a-layout-definition">获取布局定义</dfn>时，给定<var>name</var>和<var>workletGlobalScope</var>，它<em>必须</em>执行以下步骤：
            <ol>
                <li data-md="">
                    <p>令<var>layoutDefinitionMap</var>为<var>workletGlobalScope</var>的<a data-link-type="dfn"
                            href="#layout-definitions" id="ref-for-layout-definitions①">布局定义</a>映射。</p>
                <li data-md="">
                    <p>如果 <var>layoutDefinitionMap</var>[<var>name</var>] 不 <a data-link-type="dfn"
                            href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists④">存在</a>，则运行以下步骤：
                    </p>
                    <ol>
                        <li data-md="">
                            <p><a data-link-type="dfn"
                                    href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"
                                    id="ref-for-queue-a-task①">排队任务</a>以执行以下步骤：</p>
                            <ol>
                                <li data-md="">
                                    <p>令<var>documentLayoutDefinitionMap</var>为关联的<a data-link-type="dfn"
                                            href="https://dom.spec.whatwg.org/#concept-document"
                                            id="ref-for-concept-document④">文档</a>的<a data-link-type="dfn"
                                            href="#document-layout-definition"
                                            id="ref-for-document-layout-definition①">文档布局定义</a>映射。</p>
                                <li data-md="">
                                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set"
                                            id="ref-for-map-set④">设置</a><var>documentLayoutDefinitionMap</var>[<var>name</var>]为<code>"invalid"</code>。
                                    </p>
                                <li data-md="">
                                    <p>用户代理<em>应</em>在调试控制台中记录一个错误，指出类未在所有<code
                                            class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope①①">LayoutWorkletGlobalScope</a></code>中注册。
                                    </p>
                            </ol>
                        <li data-md="">
                            <p>返回失败并中止所有这些步骤。</p>
                    </ol>
                <li data-md="">
                    <p>返回<a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-get-o-p"
                            id="ref-for-sec-get-o-p⑥">获取</a><var>layoutDefinitionMap</var>[<var>name</var>]的结果。</p>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="get a layout class instance">
            当用户代理希望<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="get-a-layout-class-instance">获取布局类实例</dfn>时，给定<var>box</var>、<var>definition</var>和<var>workletGlobalScope</var>，它<em>必须</em>执行以下步骤：
            <ol>
                <li data-md="">
                    <p>令<var>layoutClassInstanceMap</var>为<var>box</var>的<a data-link-type="dfn"
                            href="#layout-class-instances" id="ref-for-layout-class-instances">布局类实例</a>映射。</p>
                <li data-md="">
                    <p>令<var>layoutInstance</var>为<a data-link-type="dfn"
                            href="https://tc39.github.io/ecma262/#sec-get-o-p"
                            id="ref-for-sec-get-o-p⑦">获取</a><var>layoutClassInstanceMap</var>[<var>workletGlobalScope</var>]的结果。如果<var>layoutInstance</var>为null，执行以下步骤：
                    </p>
                    <ol>
                        <li data-md="">
                            <p>如果<var>definition</var>的<a data-link-type="dfn"
                                    href="#layout-definition-constructor-valid-flag"
                                    id="ref-for-layout-definition-constructor-valid-flag①">构造函数有效标志</a>为false，则返回失败并中止所有这些步骤。
                            </p>
                        <li data-md="">
                            <p>令<var>layoutCtor</var>为<var>definition</var>的<a data-link-type="dfn"
                                    href="#layout-definition-class-constructor"
                                    id="ref-for-layout-definition-class-constructor①">类构造函数</a>。</p>
                        <li data-md="">
                            <p>令<var>layoutInstance</var>为<a data-link-type="dfn"
                                    href="https://tc39.github.io/ecma262/#sec-construct"
                                    id="ref-for-sec-construct">构造</a>(<var>layoutCtor</var>)的结果。</p>
                            <p>如果<a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-construct"
                                    id="ref-for-sec-construct①">构造</a>抛出异常，则将<var>definition</var>的<a
                                    data-link-type="dfn" href="#layout-definition-constructor-valid-flag"
                                    id="ref-for-layout-definition-constructor-valid-flag②">构造函数有效标志</a>设置为false，然后返回失败并中止所有这些步骤。
                            </p>
                        <li data-md="">
                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set"
                                    id="ref-for-map-set⑤">设置</a><var>layoutClassInstanceMap</var>[<var>workletGlobalScope</var>]为<var>layoutInstance</var>。
                            </p>
                    </ol>
                <li data-md="">
                    <p>返回<var>layoutInstance</var>。</p>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="run a generator">
            当用户代理希望<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="run-a-generator">运行生成器</dfn>时，给定<var>generator</var>和<var>generatorType</var>，它<em>必须</em>执行以下步骤：
            <ol>
                <li data-md="">
                    <p>令<var>done</var>为<a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-boolean"
                            id="ref-for-idl-boolean">布尔值</a>，初始化为<code>false</code>。</p>
                <li data-md="">
                    <p>令<var>nextValue</var>为未定义。</p>
                <li data-md="">
                    <p>执行以下子步骤，直到<var>done</var>为<code>true</code>：</p>
                    <ol>
                        <li data-md="">
                            <p>令<var>nextFunction</var>为<a data-link-type="dfn"
                                    href="https://tc39.github.io/ecma262/#sec-get-o-p"
                                    id="ref-for-sec-get-o-p⑧">获取</a>的<var>generator</var>中的<code>"next"</code>的结果。</p>
                        <li data-md="">
                            <p>如果<a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-iscallable"
                                    id="ref-for-sec-iscallable②">IsCallable</a>(<var>nextFunction</var>)的结果为false，<a
                                    data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw"
                                    id="ref-for-dfn-throw①⑤">抛出</a><a data-link-type="dfn"
                                    href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror"
                                    id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑦">TypeError</a>并中止所有这些步骤。
                            </p>
                        <li data-md="">
                            <p>令<var>nextResult</var>为调用<a data-link-type="dfn"
                                    href="https://heycam.github.io/webidl/#es-invoking-callback-functions"
                                    id="ref-for-es-invoking-callback-functions②">Invoke</a>(<var>nextFunction</var>，<var>generator</var>，«<var>nextValue</var>»)的结果。
                            </p>
                            <p>如果抛出异常，返回失败并中止所有这些步骤。</p>
                        <li data-md="">
                            <p>如果<a data-link-type="dfn"
                                    href="https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values"
                                    id="ref-for-sec-ecmascript-data-types-and-values①">Type</a>(<var>nextResult</var>)的结果不是Object，<a
                                    data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw"
                                    id="ref-for-dfn-throw①⑦">抛出</a><a data-link-type="dfn"
                                    href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror"
                                    id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑧">TypeError</a>并中止所有这些步骤。
                            </p>
                        <li data-md="">
                            <p>令<var>requestOrRequests</var>为<a data-link-type="dfn"
                                    href="https://tc39.github.io/ecma262/#sec-get-o-p"
                                    id="ref-for-sec-get-o-p⑨">获取</a>(<var>nextResult</var>中的<code>"value"</code>的结果)。
                            </p>
                        <li data-md="">
                            <p>令<var>done</var>为<a data-link-type="dfn"
                                    href="https://tc39.github.io/ecma262/#sec-get-o-p"
                                    id="ref-for-sec-get-o-p①⓪">获取</a>的<var>nextResult</var>中的<code>"done"</code>的结果。</p>
                        <li data-md="">
                            <p>如果<a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-getmethod"
                                    id="ref-for-sec-getmethod">GetMethod</a>(<var>requestOrRequests</var>，<code>@@iterable</code>)存在，则：
                            </p>
                            <ol>
                                <li data-md="">
                                    <p>令<var>results</var>为一个新的<a data-link-type="dfn"
                                            href="https://infra.spec.whatwg.org/#list-empty"
                                            id="ref-for-list-empty">空</a>的<a data-link-type="dfn"
                                            href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑨">列表</a>。</p>
                                <li data-md="">
                                    <p>令<var>requests</var>为<a data-link-type="dfn"
                                            href="https://heycam.github.io/webidl/#es-type-mapping"
                                            id="ref-for-es-type-mapping⑤">转换</a>的<var>requestOrRequests</var>为<code>sequence&lt;LayoutFragmentRequestOrIntrinsicSizesRequest></code>的结果。
                                    </p>
                                    <p>如果抛出异常，重新抛出该异常并中止所有这些步骤。</p>
                                <li data-md="">
                                    <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate"
                                            id="ref-for-list-iterate③">对于每个</a> <var>request</var>
                                        在<var>requests</var>中，执行以下子步骤：</p>
                                    <ol>
                                        <li data-md="">
                                            <p>令<var>result</var>为<a data-link-type="dfn"
                                                    href="#produce-a-generator-result"
                                                    id="ref-for-produce-a-generator-result">生成生成器结果</a>(<var>request</var>，<var>generator</var>，<var>generatorType</var>)的结果。
                                            </p>
                                        <li data-md="">
                                            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append"
                                                    id="ref-for-list-append②">追加</a>
                                                <var>result</var>到<var>results</var>。
                                            </p>
                                    </ol>
                                <li data-md="">
                                    <p>将<var>nextValue</var>设置为<var>results</var>。</p>
                                <li data-md="">
                                    <p>继续。</p>
                            </ol>
                        <li data-md="">
                            <p>令<var>request</var>为<a data-link-type="dfn"
                                    href="https://heycam.github.io/webidl/#es-type-mapping"
                                    id="ref-for-es-type-mapping⑥">转换</a>(<var>requestOrRequests</var>为<code
                                    class="idl"><a data-link-type="idl" href="#typedefdef-layoutfragmentrequestorintrinsicsizesrequest" id="ref-for-typedefdef-layoutfragmentrequestorintrinsicsizesrequest">LayoutFragmentRequestOrIntrinsicSizesRequest</a></code>)的结果。
                            </p>
                            <p>如果抛出异常，重新抛出异常并中止所有这些步骤。</p>
                        <li data-md="">
                            <p>令<var>result</var>为<a data-link-type="dfn" href="#produce-a-generator-result"
                                    id="ref-for-produce-a-generator-result①">生成生成器结果</a>(<var>request</var>，<var>generator</var>，<var>generatorType</var>)的结果。
                            </p>
                            <p>如果<a data-link-type="dfn" href="#produce-a-generator-result"
                                    id="ref-for-produce-a-generator-result②">生成生成器结果</a>返回失败，返回失败并中止所有这些步骤。</p>
                        <li data-md="">
                            <p>将<var>nextValue</var>设置为<var>result</var>。</p>
                        <li data-md="">
                            <p>继续。</p>
                    </ol>
                    <p>用户代理可以乱序执行上面的循环，并且可以<a data-link-type="dfn"
                            href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"
                            id="ref-for-in-parallel④">并行</a>执行。但是<var>requests</var>和<var>results</var>的顺序<em>必须</em>保持一致。
                    </p>
                    <p class="note" role="note">
                        <span>注意：</span>这允许用户代理在不同线程或异步运行适当的布局算法（例如与其他工作时间切片布局工作）。如果用户代理并行执行循环，则外部循环必须等待所有跨线程任务完成后才能再次调用生成器。它不能向作者返回部分结果。
                    </p>
                <li data-md="">
                    <p>返回调用<a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-get-o-p"
                            id="ref-for-sec-get-o-p①①">获取</a>的<var>nextResult</var>中的<code>"value"</code>的结果。</p>
            </ol>
        </div>
        <div class="algorithm" data-algorithm="produce a generator result">
            当用户代理希望<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport=""
                id="produce-a-generator-result">生成生成器结果</dfn>时，给定<var>request</var>、<var>generator</var>和<var>generatorType</var>，它<em>必须</em>执行以下步骤：
            <ol>
                <li data-md="">
                    <p>如果<var>request</var>是<code
                            class="idl"><a data-link-type="idl" href="#intrinsicsizesrequest" id="ref-for-intrinsicsizesrequest⑤">IntrinsicSizesRequest</a></code>，则：
                    </p>
                    <ol>
                        <li data-md="">
                            <p>令<var>layoutChild</var>为在<var>request</var>上查找内部槽<code
                                    class="idl"><a data-link-type="idl" href="#dom-intrinsicsizesrequest-layoutchild-slot" id="ref-for-dom-intrinsicsizesrequest-layoutchild-slot①">[[layoutChild]]</a></code>的结果。
                            </p>
                        <li data-md="">
                            <p>令<var>box</var>为在<var>layoutChild</var>上查找内部槽<code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutchild-box-slot" id="ref-for-dom-layoutchild-box-slot①">[[box]]</a></code>的结果。
                            </p>
                        <li data-md="">
                            <p>如果<var>box</var>未附加到<a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-display-3/#box-tree"
                                    id="ref-for-box-tree⑧">盒子树</a>，返回失败并中止所有这些步骤。</p>
                            <p class="note" role="note"><span>注意：</span>作者可能会保留来自先前调用的<code
                                    class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild③⑦">LayoutChild</a></code>。假设一个盒子只能附加到盒子树一次，且不会被重复使用。
                            </p>
                        <li data-md="">
                            <p>令<var>internalIntrinsicSizes</var>为用户代理计算的<var>box</var>的<b>边框盒</b>最小/最大内容贡献的结果。</p>
                        <li data-md="">
                            <p>返回<a data-link-type="dfn" href="#create-an-intrinsic-sizes-object"
                                    id="ref-for-create-an-intrinsic-sizes-object">创建固有尺寸对象</a>(<var>request</var>和<var>internalIntrinsicSizes</var>)的结果。
                            </p>
                    </ol>
                <li data-md="">
                    <p>如果<var>request</var>是<code
                            class="idl"><a data-link-type="idl" href="#layoutfragmentrequest" id="ref-for-layoutfragmentrequest⑦">LayoutFragmentRequest</a></code>，并且<var>generatorType</var>为<code>"layout"</code>，则：
                    </p>
                    <ol>
                        <li data-md="">
                            <p>令<var>layoutChild</var>为在<var>request</var>上查找内部槽<code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragmentrequest-layoutchild-slot" id="ref-for-dom-layoutfragmentrequest-layoutchild-slot①">[[layoutChild]]</a></code>的结果。
                            </p>
                        <li data-md="">
                            <p>令<var>box</var>为在<var>layoutChild</var>上查找内部槽<code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutchild-box-slot" id="ref-for-dom-layoutchild-box-slot②">[[box]]</a></code>的结果。
                            </p>
                        <li data-md="">
                            <p>如果<var>box</var>未附加到<a data-link-type="dfn"
                                    href="https://www.w3.org/TR/css-display-3/#box-tree"
                                    id="ref-for-box-tree⑨">盒子树</a>，返回失败并中止所有这些步骤。</p>
                            <p class="note" role="note"><span>注意：</span>作者可能会保留来自先前调用的<code
                                    class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild③⑧">LayoutChild</a></code>。假设一个盒子只能附加到盒子树一次，且不会被重复使用。
                            </p>
                        <li data-md="">
                            <p>令<var>childLayoutConstraints</var>为在<var>request</var>上查找内部槽<code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragmentrequest-layoutconstraints-slot" id="ref-for-dom-layoutfragmentrequest-layoutconstraints-slot①">[[layoutConstraints]]</a></code>的结果。
                            </p>
                        <li data-md="">
                            <p>令<var>childBreakToken</var>为在<var>request</var>上查找内部槽<code
                                    class="idl"><a data-link-type="idl" href="#dom-layoutfragmentrequest-breaktoken-slot" id="ref-for-dom-layoutfragmentrequest-breaktoken-slot①">[[breakToken]]</a></code>的结果。
                            </p>
                        <li data-md="">
                            <p>令<var>internalFragment</var>为用户代理基于<var>box</var>、<var>childLayoutConstraints</var>和<var>childBreakToken</var>生成的<a
                                    data-link-type="dfn" href="https://www.w3.org/TR/css3-break/#fragment"
                                    id="ref-for-fragment⑧">片段</a>的结果。</p>
                        <li data-md="">
                            <p>返回<a data-link-type="dfn" href="#create-a-layout-fragment"
                                    id="ref-for-create-a-layout-fragment">创建布局片段</a>(<var>generator</var>、<var>request</var>和<var>internalFragment</var>)的结果。
                            </p>
                    </ol>
                <li data-md="">
                    <p>返回失败（以上分支均未被采用）。</p>
            </ol>
        </div>
        <h2 class="heading settled" data-level="6" id="security-considerations"><span class="secno">6. </span><span
                class="content">安全性考虑</span><a class="self-link" href="#security-considerations"></a></h2>
        <p>这些功能没有已知的安全问题。</p>

        <h2 class="heading settled" data-level="7" id="privacy-considerations"><span class="secno">7. </span><span
                class="content">隐私考虑</span><a class="self-link" href="#privacy-considerations"></a></h2>
        <p>这些功能没有已知的隐私问题。</p>
    </main>
    <h2 class="no-ref no-num heading settled" id="conformance"><span class="content">一致性</span><a class="self-link"
            href="#conformance"></a></h2>
    <h3 class="no-ref heading settled" id="conventions"><span class="content">文档约定</span><a class="self-link"
            href="#conventions"></a></h3>
    <p>一致性要求通过描述性断言和 RFC 2119 术语的组合来表达。规范中的“必须（MUST）”、“不得（MUST NOT）”、“必需（REQUIRED）”、“应（SHALL）”、“不应（SHALL
        NOT）”、“应当（SHOULD）”、“不应当（SHOULD NOT）”、“推荐（RECOMMENDED）”、“可以（MAY）”和“可选（OPTIONAL）”等关键字，应按照 RFC 2119
        中的定义进行解释。不过，为了可读性，这些词语在本规范中不会全部使用大写字母。</p>
    <p>本规范的所有文本都是规范性的，除非明确标记为非规范性、示例和注释部分。<a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>
    <p>本规范中的示例以“例如”开头，或与规范性文本分开，并用<code>class="example"</code>标记，例如：</p>
    <div class="example" id="example-f839f6c8">
        <a class="self-link" href="#example-f839f6c8"></a>
        <p>这是一个说明性示例。</p>
    </div>
    <p>说明性注释以“注”开头，并与规范性文本分开，使用<code>class="note"</code>标记，例如：</p>
    <p class="note" role="note">注：这是一个说明性注释。</p>
    <p>建议性内容是规范性部分，样式特别，以引起特别关注，并使用<code>&lt;strong class="advisement"></code>标记，例如：<strong class="advisement">
            用户代理必须提供一个可访问的替代方案。</strong></p>

    <h3 class="no-ref heading settled" id="conformance-classes"><span class="content">一致性类别</span><a class="self-link"
            href="#conformance-classes"></a></h3>
    <p>本规范的一致性定义分为三类：</p>
    <dl>
        <dt>样式表
        <dd>指<a href="https://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS 样式表</a>。
        <dt>渲染器
        <dd>指<a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">用户代理（UA）</a>，其解释样式表的语义并渲染使用它们的文档。
        <dt>创作工具
        <dd>指<a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">用户代理（UA）</a>，用于编写样式表。
    </dl>
    <p>样式表如果符合本模块定义的通用 CSS 语法和每个特性定义的单独语法，则其符合本规范。</p>
    <p>渲染器如果不仅按照适当的规范解释样式表，还正确解析并渲染文档，同时支持本规范中定义的所有功能，则符合本规范。不过，由于设备限制，用户代理无法正确渲染文档的情况不会使其不符合规范。（例如，用户代理不要求在单色显示器上渲染颜色。）
    </p>
    <p>创作工具如果编写的样式表在语法上符合本模块的通用 CSS 语法和每个特性的单独语法，并且符合本模块描述的所有其他样式表一致性要求，则符合本规范。</p>

    <h3 class="no-ref heading settled" id="partial"><span class="content">部分实现</span><a class="self-link"
            href="#partial"></a></h3>
    <p>为了让作者能够利用前向兼容的解析规则分配回退值，CSS 渲染器<strong>必须</strong>将任何其无可用支持的 at-rules、属性、属性值、关键字和其他语法结构视为无效，并<a
            href="https://www.w3.org/TR/CSS21/conform.html#ignore">适当地忽略</a>。特别是，用户代理<strong>不得</strong>选择性地忽略不支持的组件值并保留支持的值在同一个多值属性声明中：如果任何值被视为无效（不支持的值必须视为无效），CSS
        要求忽略整个声明。</p>
    <h4 class="heading settled" id="conform-future-proofing"><span class="content">不稳定和专有功能的实现</span><a
            class="self-link" href="#conform-future-proofing"></a></h4>
    <p>为了避免与未来稳定的 CSS 功能发生冲突，CSS 工作组建议<a href="https://www.w3.org/TR/CSS/#future-proofing">遵循最佳实践</a>，以实现<a
            href="https://www.w3.org/TR/CSS/#unstable">不稳定</a>的功能和 CSS 的<a
            href="https://www.w3.org/TR/CSS/#proprietary-extension">专有扩展</a>。</p>

    <h3 class="no-ref heading settled" id="testing"><span class="content">非实验性实现</span><a class="self-link"
            href="#testing"></a></h3>
    <p>一旦规范达到候选推荐阶段，非实验性实现就变得可能，且实现者应发布未加前缀的实现，只要他们能够证明其符合规范正确实现了任何 CR 级别的功能。</p>
    <p>为了建立并维护 CSS 在不同实现间的互操作性，CSS 工作组请求非实验性的 CSS 渲染器在发布任何未加前缀的 CSS 功能实现之前，向 W3C 提交实现报告（以及如果需要的话，提交用于该实现报告的测试用例）。提交给 W3C
        的测试用例将由 CSS 工作组进行审查和修正。</p>
    <p>关于提交测试用例和实现报告的更多信息，请访问 CSS 工作组网站：<a
            href="https://www.w3.org/Style/CSS/Test/">https://www.w3.org/Style/CSS/Test/</a>。如有问题，请发送至 <a
            href="https://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a> 邮件列表。
        <script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
    </p>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本规范定义的术语</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#dom-layoutedges-all">all</a><span>，在 §3.6</span></li>
        <li><a href="#dom-fragmentresultoptions-autoblocksize">autoBlockSize</a><span>，在 §5.6</span></li>
        <li>
            availableBlockSize
            <ul>
                <li><a href="#dom-layoutconstraints-availableblocksize">LayoutConstraints 的属性</a><span>，在 §3.4</span>
                </li>
                <li><a href="#dom-layoutconstraintsoptions-availableblocksize">LayoutConstraintsOptions
                        的字典成员</a><span>，在 §3.4</span></li>
            </ul>
        </li>
        <li>
            availableInlineSize
            <ul>
                <li><a href="#dom-layoutconstraints-availableinlinesize">LayoutConstraints 的属性</a><span>，在 §3.4</span>
                </li>
                <li><a href="#dom-layoutconstraintsoptions-availableinlinesize">LayoutConstraintsOptions
                        的字典成员</a><span>，在 §3.4</span></li>
            </ul>
        </li>
        <li>
            block
            <ul>
                <li><a href="#dom-layoutedgesizes-block">LayoutEdgeSizes 的属性</a><span>，在 §3.6</span></li>
                <li><a href="#dom-childdisplaytype-block">ChildDisplayType 的枚举值</a><span>，在 §5.4</span></li>
            </ul>
        </li>
        <li><a href="#dom-childdisplaytype-block">"block"</a><span>，在 §5.4</span></li>
        <li><a href="#dom-layoutedgesizes-blockend">blockEnd</a><span>，在 §3.6</span></li>
        <li>
            blockFragmentationOffset
            <ul>
                <li><a href="#dom-layoutconstraints-blockfragmentationoffset">LayoutConstraints 的属性</a><span>，在
                        §3.4</span></li>
                <li><a href="#dom-layoutconstraintsoptions-blockfragmentationoffset">LayoutConstraintsOptions
                        的字典成员</a><span>，在 §3.4</span></li>
            </ul>
        </li>
        <li>
            blockFragmentationType
            <ul>
                <li><a href="#dom-layoutconstraints-blockfragmentationtype">LayoutConstraints 的属性</a><span>，在
                        §3.4</span></li>
                <li><a href="#dom-layoutconstraintsoptions-blockfragmentationtype">LayoutConstraintsOptions
                        的字典成员</a><span>，在 §3.4</span></li>
            </ul>
        </li>
        <li><a href="#enumdef-blockfragmentationtype">BlockFragmentationType</a><span>，在 §3.4</span></li>
        <li><a href="#dom-layoutsizingmode-block-like">block-like</a><span>，在 §5.4</span></li>
        <li><a href="#dom-layoutsizingmode-block-like">"block-like"</a><span>，在 §5.4</span></li>
        <li><a href="#dom-layoutfragment-blockoffset">blockOffset</a><span>，在 §3.2</span></li>
        <li>
            blockSize
            <ul>
                <li><a href="#dom-layoutfragment-blocksize">LayoutFragment 的属性</a><span>，在 §3.2</span></li>
                <li><a href="#dom-fragmentresultoptions-blocksize">FragmentResultOptions 的字典成员</a><span>，在 §5.6</span>
                </li>
            </ul>
        </li>
        <li><a href="#dom-layoutedgesizes-blockstart">blockStart</a><span>，在 §3.6</span></li>
        <li><a href="#dom-layoutedges-border">border</a><span>，在 §3.6</span></li>
        <li><a href="#dom-layoutchild-box-slot">[[box]]</a><span>，在 §3.1</span></li>
        <li>
            breakToken
            <ul>
                <li><a href="#dom-layoutfragment-breaktoken">LayoutFragment 的属性</a><span>，在 §3.2</span></li>
                <li><a href="#dom-fragmentresultoptions-breaktoken">FragmentResultOptions 的字典成员</a><span>，在 §5.6</span>
                </li>
            </ul>
        </li>
        <li><a href="#breaktoken">BreakToken</a><span>，在 §3.5</span></li>
        <li><a href="#dom-layoutfragmentrequest-breaktoken-slot">[[breakToken]]</a><span>，在 §5.5.1</span></li>
        <li><a href="#dictdef-breaktokenoptions">BreakTokenOptions</a><span>，在 §3.5</span></li>
        <li><a href="#enumdef-breaktype">BreakType</a><span>，在 §3.5</span></li>
        <li><a href="#dom-childbreaktoken-breaktype">breakType</a><span>，在 §3.5</span></li>
        <li><a href="#dom-childbreaktoken-child">child</a><span>，在 §3.5</span></li>
        <li><a href="#childbreaktoken">ChildBreakToken</a><span>，在 §3.5</span></li>
        <li>
            childBreakTokens
            <ul>
                <li><a href="#dom-breaktoken-childbreaktokens">BreakToken 的属性</a><span>，在 §3.5</span></li>
                <li><a href="#dom-breaktokenoptions-childbreaktokens">BreakTokenOptions 的字典成员</a><span>，在 §3.5</span>
                </li>
            </ul>
        </li>
        <li><a href="#dom-layoutoptions-childdisplay">childDisplay</a><span>，在 §5.4</span></li>
        <li><a href="#enumdef-childdisplaytype">ChildDisplayType</a><span>，在 §5.4</span></li>
        <li><a href="#dom-fragmentresultoptions-childfragments">childFragments</a><span>，在 §5.6</span></li>
        <li>
            子输入属性
            <ul>
                <li><a href="#layout-definition-child-input-properties">layout 定义中的定义</a><span>，在 §5.1</span></li>
                <li><a href="#document-layout-definition-child-input-properties">文档布局定义中的定义</a><span>，在 §5.1</span></li>
            </ul>
        </li>
        <li><a href="#child-layout">子布局</a><span>，在 §3</span></li>
        <li><a href="#layout-definition-class-constructor">类构造函数</a><span>，在 §5.1</span></li>
        <li>
            "column"
            <ul>
                <li><a href="#dom-blockfragmentationtype-column">BlockFragmentationType 的枚举值</a><span>，在 §3.4</span>
                </li>
                <li><a href="#dom-breaktype-column">BreakType 的枚举值</a><span>，在 §3.5</span></li>
            </ul>
        </li>
        <li>
            column
            <ul>
                <li><a href="#dom-blockfragmentationtype-column">BlockFragmentationType 的枚举值</a><span>，在 §3.4</span>
                </li>
                <li><a href="#dom-breaktype-column">BreakType 的枚举值</a><span>，在 §3.5</span></li>
            </ul>
        </li>
        <li><a href="#layout-definition-constructor-valid-flag">构造函数有效标志</a><span>，在 §5.1</span></li>
        <li><a href="#create-a-layout-constraints-object">创建布局约束对象</a><span>，在 §3.4</span></li>
        <li><a href="#create-a-layout-fragment">创建布局片段</a><span>，在 §3.2</span></li>
        <li><a href="#create-an-intrinsic-sizes-object">创建内在尺寸对象</a><span>，在 §3.3</span></li>
        <li><a href="#current-layout">当前布局</a><span>，在 §3</span></li>
        <li>
            数据
            <ul>
                <li><a href="#dom-layoutfragment-data">LayoutFragment 的属性</a><span>，在 §3.2</span></li>
                <li><a href="#dom-layoutconstraints-data">LayoutConstraints 的属性</a><span>，在 §3.4</span></li>
                <li><a href="#dom-layoutconstraintsoptions-data">LayoutConstraintsOptions 的字典成员</a><span>，在 §3.4</span>
                </li>
                <li><a href="#dom-breaktoken-data">BreakToken 的属性</a><span>，在 §3.5</span></li>
                <li><a href="#dom-breaktokenoptions-data">BreakTokenOptions 的字典成员</a><span>，在 §3.5</span></li>
                <li><a href="#dom-fragmentresultoptions-data">FragmentResultOptions 的字典成员</a><span>，在 §5.6</span></li>
            </ul>
        </li>
        <li><a href="#determine-the-intrinsic-sizes">确定内在尺寸</a><span>，在 §5.6.1</span></li>
        <li><a href="#document-layout-definition">文档布局定义</a><span>，在 §5.1</span></li>
        <li><a href="#document-layout-definitions">文档布局定义</a><span>，在 §5.4</span></li>
        <li>
            fixedBlockSize
            <ul>
                <li><a href="#dom-layoutconstraints-fixedblocksize">LayoutConstraints 的属性</a><span>，在 §3.4</span></li>
                <li><a href="#dom-layoutconstraintsoptions-fixedblocksize">LayoutConstraintsOptions 的字典成员</a><span>，在
                        §3.4</span></li>
            </ul>
        </li>
        <li>
            fixedInlineSize
            <ul>
                <li><a href="#dom-layoutconstraints-fixedinlinesize">LayoutConstraints 的属性</a><span>，在 §3.4</span></li>
                <li><a href="#dom-layoutconstraintsoptions-fixedinlinesize">LayoutConstraintsOptions 的字典成员</a><span>，在
                        §3.4</span></li>
            </ul>
        </li>
        <li><a href="#dictdef-fragmentresultoptions">FragmentResultOptions</a><span>，在 §5.6</span></li>
        <li><a href="#generate-a-fragment">生成片段</a><span>，在 §5.6.2</span></li>
        <li><a href="#dom-layoutfragment-generator-slot">[[generator]]</a><span>，在 §3.2</span></li>
        <li><a href="#get-a-document-layout-definition">获取文档布局定义</a><span>，在 §5.6.3</span></li>
        <li><a href="#get-a-layout-child">获取布局子项</a><span>，在 §3.1.1</span></li>
        <li><a href="#get-a-layout-class-instance">获取布局类实例</a><span>，在 §5.6.3</span></li>
        <li><a href="#get-a-layout-definition">获取布局定义</a><span>，在 §5.6.3</span></li>
        <li><a href="#dom-layoutedgesizes-inline">inline</a><span>，在 §3.6</span></li>
        <li><a href="#dom-layoutedgesizes-inlineend">inlineEnd</a><span>，在 §3.6</span></li>
        <li><a href="#dom-layoutfragment-inlineoffset">inlineOffset</a><span>，在 §3.2</span></li>
        <li>
            inlineSize
            <ul>
                <li><a href="#dom-layoutfragment-inlinesize">LayoutFragment 的属性</a><span>，在 §3.2</span></li>
                <li><a href="#dom-fragmentresultoptions-inlinesize">FragmentResultOptions 的字典成员</a><span>，在 §5.6</span>
                </li>
            </ul>
        </li>
        <li><a href="#dom-layoutedgesizes-inlinestart">inlineStart</a><span>，在 §3.6</span></li>
        <li>
            输入属性
            <ul>
                <li><a href="#layout-definition-input-properties">layout 定义中的定义</a><span>，在 §5.1</span></li>
                <li><a href="#document-layout-definition-input-properties">文档布局定义中的定义</a><span>，在 §5.1</span></li>
            </ul>
        </li>
        <li><a href="#dom-layoutchild-intrinsicsizes">intrinsicSizes()</a><span>，在 §3.1</span></li>
        <li><a href="#intrinsicsizes">IntrinsicSizes</a><span>，在 §3.3</span></li>
        <li><a href="#layout-definition-intrinsic-sizes-generator-function">内在尺寸生成函数</a><span>，在 §5.1</span></li>
        <li><a href="#intrinsic-sizes-invalid">intrinsic-sizes-invalid</a><span>，在 §5.2</span></li>
        <li><a href="#intrinsicsizesrequest">IntrinsicSizesRequest</a><span>，在 §5.5.1</span></li>
        <li><a href="#dom-intrinsicsizes-intrinsicsizesrequest-slot">[[intrinsicSizesRequest]]</a><span>，在 §3.3</span>
        </li>
        <li><a href="#dictdef-intrinsicsizesresultoptions">IntrinsicSizesResultOptions</a><span>，在 §5.6</span></li>
        <li><a href="#intrinsic-sizes-valid">intrinsic-sizes-valid</a><span>，在 §5.2</span></li>
        <li><a href="#intrinsic-sizes-valid-flag">内在尺寸有效标志</a><span>，在 §5.2</span></li>
        <li><a href="#invalidate-layout-functions">无效的布局函数</a><span>，在 §5.2</span></li>
        <li><a href="#invoke-a-intrinsic-sizes-callback">调用内在尺寸回调</a><span>，在 §5.6.1</span></li>
        <li><a href="#invoke-a-layout-callback">调用布局回调</a><span>，在 §5.6.2</span></li>
        <li><a href="#valdef-display-layout">layout()</a><span>，在 §2</span></li>
        <li><a href="#layout-api-children">layout API 子项</a><span>，在 §2</span></li>
        <li><a href="#layout-api-container">layout API 容器</a><span>，在 §2</span></li>
        <li><a href="#layout-api-formatting-context">layout API 排版上下文</a><span>，在 §2</span></li>
        <li><a href="#layoutchild">LayoutChild</a><span>，在 §3.1</span></li>
        <li>
            [[layoutChild]]
            <ul>
                <li><a href="#dom-intrinsicsizesrequest-layoutchild-slot">IntrinsicSizesRequest 的属性</a><span>，在
                        §5.5.1</span></li>
                <li><a href="#dom-layoutfragmentrequest-layoutchild-slot">LayoutFragmentRequest 的属性</a><span>，在
                        §5.5.1</span></li>
            </ul>
        </li>
        <li><a href="#dom-box-layoutchildmap-slot">[[layoutChildMap]]</a><span>，在 §3.1.1</span></li>
        <li><a href="#layout-class-instances">布局类实例</a><span>，在 §5.4</span></li>
        <li><a href="#dom-layoutconstraints-layoutconstraints">LayoutConstraints()</a><span>，在 §3.4</span></li>
        <li><a href="#layoutconstraints">LayoutConstraints</a><span>，在 §3.4</span></li>
        <li><a href="#dom-layoutfragmentrequest-layoutconstraints-slot">[[layoutConstraints]]</a><span>，在 §5.5.1</span>
        </li>
        <li><a href="#dictdef-layoutconstraintsoptions">LayoutConstraintsOptions</a><span>，在 §3.4</span></li>
        <li><a href="#dom-layoutconstraints-layoutconstraints">LayoutConstraints(options)</a><span>，在 §3.4</span></li>
        <li><a href="#layout-definition">布局定义</a><span>，在 §5.1</span></li>
        <li><a href="#layout-definitions">布局定义</a><span>，在 §5.4</span></li>
        <li><a href="#layoutedges">LayoutEdges</a><span>，在 §3.6</span></li>
        <li><a href="#layoutedgesizes">LayoutEdgeSizes</a><span>，在 §3.6</span></li>
        <li><a href="#layoutfragment">LayoutFragment</a><span>，在 §3.2</span></li>
        <li><a href="#dom-layoutfragment-layoutfragmentrequest-slot">[[layoutFragmentRequest]]</a><span>，在 §3.2</span>
        </li>
        <li><a href="#layoutfragmentrequest">LayoutFragmentRequest</a><span>，在 §5.5.1</span></li>
        <li><a
                href="#typedefdef-layoutfragmentrequestorintrinsicsizesrequest">LayoutFragmentRequestOrIntrinsicSizesRequest</a><span>，在
                §5.5.1</span></li>
        <li><a href="#layout-definition-layout-generator-function">布局生成函数</a><span>，在 §5.1</span></li>
        <li><a href="#layout-invalid">layout-invalid</a><span>，在 §5.2</span></li>
        <li><a href="#dom-layoutchild-layoutnextfragment">layoutNextFragment(constraints, breakToken)</a><span>，在
                §3.1</span></li>
        <li>
            布局选项
            <ul>
                <li><a href="#layout-definition-layout-options">布局定义中的定义</a><span>，在 §5.1</span></li>
                <li><a href="#document-layout-definition-layout-options">文档布局定义中的定义</a><span>，在 §5.1</span></li>
            </ul>
        </li>
        <li><a href="#dictdef-layoutoptions">LayoutOptions</a><span>，在 §5.4</span></li>
        <li><a href="#enumdef-layoutsizingmode">LayoutSizingMode</a><span>，在 §5.4</span></li>
        <li><a href="#layout-valid">layout-valid</a><span>，在 §5.2</span></li>
        <li><a href="#layout-valid-flag">布局有效标志</a><span>，在 §5.2</span></li>
        <li><a href="#dom-css-layoutworklet">layoutWorklet</a><span>，在 §5.3</span></li>
        <li><a href="#layoutworkletglobalscope">LayoutWorkletGlobalScope</a><span>，在 §5.3</span></li>
        <li><a href="#dom-breaktype-line">"line"</a><span>，在 §3.5</span></li>
        <li><a href="#dom-breaktype-line">line</a><span>，在 §3.5</span></li>
        <li><a href="#dom-layoutsizingmode-manual">"manual"</a><span>，在 §5.4</span></li>
        <li><a href="#dom-layoutsizingmode-manual">manual</a><span>，在 §5.4</span></li>
        <li>
            maxContentSize
            <ul>
                <li><a href="#dom-intrinsicsizes-maxcontentsize">IntrinsicSizes 的属性</a><span>，在 §3.3</span></li>
                <li><a href="#dom-intrinsicsizesresultoptions-maxcontentsize">IntrinsicSizesResultOptions
                        的字典成员</a><span>，在 §5.6</span></li>
            </ul>
        </li>
        <li>
            minContentSize
            <ul>
                <li><a href="#dom-intrinsicsizes-mincontentsize">IntrinsicSizes 的属性</a><span>，在 §3.3</span></li>
                <li><a href="#dom-intrinsicsizesresultoptions-mincontentsize">IntrinsicSizesResultOptions
                        的字典成员</a><span>，在 §5.6</span></li>
            </ul>
        </li>
        <li>
            "none"
            <ul>
                <li><a href="#dom-blockfragmentationtype-none">BlockFragmentationType 的枚举值</a><span>，在 §3.4</span></li>
                <li><a href="#dom-breaktype-none">BreakType 的枚举值</a><span>，在 §3.5</span></li>
            </ul>
        </li>
        <li>
            none
            <ul>
                <li><a href="#dom-blockfragmentationtype-none">BlockFragmentationType 的枚举值</a><span>，在 §3.4</span></li>
                <li><a href="#dom-breaktype-none">BreakType 的枚举值</a><span>，在 §3.5</span></li>
            </ul>
        </li>
        <li><a href="#dom-childdisplaytype-normal">"normal"</a><span>，在 §5.4</span></li>
        <li><a href="#dom-childdisplaytype-normal">normal</a><span>，在 §5.4</span></li>
        <li><a href="#dom-layoutedges-padding">padding</a><span>，在 §3.6</span></li>
        <li>
            页面
            <ul>
                <li><a href="#dom-blockfragmentationtype-page">BlockFragmentationType 的枚举值</a><span>，在 §3.4</span></li>
                <li><a href="#dom-breaktype-page">BreakType 的枚举值</a><span>，在 §3.5</span></li>
            </ul>
        </li>
        <li>
            "页面"
            <ul>
                <li><a href="#dom-blockfragmentationtype-page">BlockFragmentationType 的枚举值</a><span>，在 §3.4</span></li>
                <li><a href="#dom-breaktype-page">BreakType 的枚举值</a><span>，在 §3.5</span></li>
            </ul>
        </li>
        <li><a href="#parent-layout">父布局</a><span>，在 §3</span></li>
        <li>
            percentageBlockSize
            <ul>
                <li><a href="#dom-layoutconstraints-percentageblocksize">LayoutConstraints 的属性</a><span>，在 §3.4</span>
                </li>
                <li><a href="#dom-layoutconstraintsoptions-percentageblocksize">LayoutConstraintsOptions
                        的字典成员</a><span>，在 §3.4</span></li>
            </ul>
        </li>
        <li>
            percentageInlineSize
            <ul>
                <li><a href="#dom-layoutconstraints-percentageinlinesize">LayoutConstraints 的属性</a><span>，在 §3.4</span>
                </li>
                <li><a href="#dom-layoutconstraintsoptions-percentageinlinesize">LayoutConstraintsOptions
                        的字典成员</a><span>，在 §3.4</span></li>
            </ul>
        </li>
        <li><a href="#produce-a-generator-result">生成生成器结果</a><span>，在 §5.6.3</span></li>
        <li>
            "region"
            <ul>
                <li><a href="#dom-blockfragmentationtype-region">BlockFragmentationType 的枚举值</a><span>，在 §3.4</span>
                </li>
                <li><a href="#dom-breaktype-region">BreakType 的枚举值</a><span>，在 §3.5</span></li>
            </ul>
        </li>
        <li>
            region
            <ul>
                <li><a href="#dom-blockfragmentationtype-region">BlockFragmentationType 的枚举值</a><span>，在 §3.4</span>
                </li>
                <li><a href="#dom-breaktype-region">BreakType 的枚举值</a><span>，在 §3.5</span></li>
            </ul>
        </li>
        <li><a href="#dom-layoutworkletglobalscope-registerlayout">registerLayout(name, layoutCtor)</a><span>，在
                §5.4</span></li>
        <li><a href="#run-a-generator">运行生成器</a><span>，在 §5.6.3</span></li>
        <li><a href="#dom-layoutedges-scrollbar">scrollbar</a><span>，在 §3.6</span></li>
        <li><a href="#dom-layoutoptions-sizing">sizing</a><span>，在 §5.4</span></li>
        <li><a href="#dom-layoutchild-stylemap-slot">[[styleMap]]</a><span>，在 §3.1</span></li>
        <li><a href="#dom-layoutchild-stylemap">styleMap</a><span>，在 §3.1</span></li>
        <li><a href="#update-a-layout-child-style">更新布局子项样式</a><span>，在 §3.1.1</span></li>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">术语定义引用</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[css-backgrounds-3]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/css3-background/#propdef-border-left-width">border-left-width</a>
            </ul>
        <li>
            <a data-link-type="biblio">[css-break-3]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/css3-break/#propdef-break-inside">break-inside</a>
                <li><a href="https://www.w3.org/TR/css3-break/#fragment">fragment</a>
            </ul>
        <li>
            <a data-link-type="biblio">[css-cascade-4]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/css-cascade-4/#computed-value">computed value</a>
            </ul>
        <li>
            <a data-link-type="biblio">[css-flexbox-1]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/css-flexbox-1/#flex-container">flex container</a>
            </ul>
        <li>
            <a data-link-type="biblio">[css-grid-1]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/css-grid-1/#grid-container">grid container</a>
            </ul>
        <li>
            <a data-link-type="biblio">[css-inline-3]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/css-inline-3/#root-inline-box">root inline box</a>
            </ul>
        <li>
            <a data-link-type="biblio">[css-overflow-3]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/css-overflow-3/#propdef-overflow">overflow</a>
                <li><a href="https://www.w3.org/TR/css-overflow-3/#propdef-overflow-y">overflow-y</a>
                <li><a href="https://www.w3.org/TR/css-overflow-3/#scrollable-overflow">scrollable overflow</a>
            </ul>
        <li>
            <a data-link-type="biblio">[css-page-floats-3]</a> 定义了以下术语:
            <ul>
                <li><a href="https://drafts.csswg.org/css-page-floats-3/#float">float</a>
            </ul>
        <li>
            <a data-link-type="biblio">[css-position-3]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/css3-positioning/#valdef-z-index-auto">auto</a>
                <li><a href="https://www.w3.org/TR/css3-positioning/#propdef-position">position</a>
                <li><a href="https://www.w3.org/TR/css3-positioning/#relative-position">relatively position</a>
                <li><a href="https://www.w3.org/TR/css3-positioning/#valdef-position-static">static</a>
                <li><a href="https://www.w3.org/TR/css3-positioning/#propdef-z-index">z-index</a>
            </ul>
        <li>
            <a data-link-type="biblio">[css-pseudo-4]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-after">::after</a>
                <li><a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-before">::before</a>
                <li><a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-first-letter">::first-letter</a>
                <li><a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-first-line">::first-line</a>
            </ul>
        <li>
            <a data-link-type="biblio">[css-ruby-1]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/css-ruby-1/#propdef-display">display</a>
            </ul>
        <li>
            <a data-link-type="biblio">[css-sizing-3]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/css-sizing-3/#valdef-width-auto">auto</a>
                <li><a href="https://www.w3.org/TR/css-sizing-3/#available">available space</a>
                <li><a href="https://www.w3.org/TR/css-sizing-3/#max-content">max-content size</a>
                <li><a href="https://www.w3.org/TR/css-sizing-3/#min-content">min-content size</a>
                <li><a href="https://www.w3.org/TR/css-sizing-3/#stretch-fit-inline-size">stretch-fit inline size</a>
            </ul>
        <li>
            <a data-link-type="biblio">[css-syntax-3]</a> 定义了以下术语:
            <ul>
                <li><a href="https://drafts.csswg.org/css-syntax-3/#declaration">declaration</a>
            </ul>
        <li>
            <a data-link-type="biblio">[css-typed-om-1]</a> 定义了以下术语:
            <ul>
                <li><a
                        href="https://www.w3.org/TR/css-typed-om-1/#stylepropertymapreadonly">StylePropertyMapReadOnly</a>
            </ul>
        <li>
            <a data-link-type="biblio">[css-values-3]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/css3-values/#typedef-ident">&lt;ident></a>
            </ul>
        <li>
            <a data-link-type="biblio">[css-writing-modes-3]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/css-writing-modes-3/#abstract-dimensions">abstract dimensions</a>
                <li><a href="https://www.w3.org/TR/css-writing-modes-3/#block-size">block size</a>
                <li><a href="https://www.w3.org/TR/css-writing-modes-3/#block-start">block-start</a>
                <li><a href="https://www.w3.org/TR/css-writing-modes-3/#inline-size">inline size</a>
                <li><a href="https://www.w3.org/TR/css-writing-modes-3/#inline-start">inline-start</a>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS22]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/CSS22/visudet.html#propdef-height">height</a>
                <li><a href="https://www.w3.org/TR/CSS22/box.html#propdef-margin">margin</a>
                <li><a href="https://www.w3.org/TR/CSS22/visudet.html#propdef-max-width">max-width</a>
                <li><a href="https://www.w3.org/TR/CSS22/box.html#propdef-padding-top">padding-top</a>
                <li><a href="https://www.w3.org/TR/CSS22/visudet.html#propdef-width">width</a>
            </ul>
        <li>
            <a data-link-type="biblio">[css3-display]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/css-display-3/#typedef-display-inside">&lt;display-inside></a>
                <li><a href="https://www.w3.org/TR/css-display-3/#typedef-display-outside">&lt;display-outside></a>
                <li><a href="https://www.w3.org/TR/css-display-3/#anonymous">anonymous box</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#atomic-inline">atomic inline</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#block-box">block box</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#block-formatting-context">block formatting context</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#block-level">block-level</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#blockify">blockification</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#blockify">blockify</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#box">box</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#box-tree">box tree</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#containing-block">containing block</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#valdef-display-grid">grid</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#valdef-display-inline">inline</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#inline-formatting-context">inline formatting
                        context</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#inline-level">inline-level</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#inlinify">inlinify</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#valdef-display-none">none</a>
                <li><a href="https://www.w3.org/TR/css-display-3/#replaced-element">replaced element</a>
            </ul>
        <li>
            <a data-link-type="biblio">[cssom-1]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/cssom-1/#css">CSS</a>
            </ul>
        <li>
            <a data-link-type="biblio">[DOM]</a> 定义了以下术语:
            <ul>
                <li><a href="https://dom.spec.whatwg.org/#concept-document">document</a>
                <li><a href="https://dom.spec.whatwg.org/#concept-element">element</a>
            </ul>
        <li>
            <a data-link-type="biblio">[HTML]</a> 定义了以下术语:
            <ul>
                <li><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>
                <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a>
                <li><a
                        href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm">realm</a>
            </ul>
        <li>
            <a data-link-type="biblio">[INFRA]</a> 定义了以下术语:
            <ul>
                <li><a href="https://infra.spec.whatwg.org/#list-append">append</a>
                <li><a href="https://infra.spec.whatwg.org/#list-empty">empty</a>
                <li><a href="https://infra.spec.whatwg.org/#map-exists">exist</a>
                <li><a href="https://infra.spec.whatwg.org/#list-iterate">for each <small>(for list)</small></a>
                <li><a href="https://infra.spec.whatwg.org/#map-iterate">for each <small>(for map)</small></a>
                <li><a href="https://infra.spec.whatwg.org/#map-get">get</a>
                <li><a href="https://infra.spec.whatwg.org/#list">list</a>
                <li><a href="https://infra.spec.whatwg.org/#ordered-map">map</a>
                <li><a href="https://infra.spec.whatwg.org/#map-set">set</a>
                <li><a href="https://infra.spec.whatwg.org/#struct">struct</a>
            </ul>
        <li>
            <a data-link-type="biblio">[WebIDL]</a> 定义了以下术语:
            <ul>
                <li><a href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>
                <li><a href="https://heycam.github.io/webidl/#Exposed">Exposed</a>
                <li><a href="https://heycam.github.io/webidl/#Global">Global</a>
                <li><a href="https://heycam.github.io/webidl/#SameObject">SameObject</a>
                <li><a href="https://heycam.github.io/webidl/#VoidFunction">VoidFunction</a>
                <li><a href="https://heycam.github.io/webidl/#idl-double">double</a>
                <li><a href="https://heycam.github.io/webidl/#dfn-throw">throw</a>
            </ul>
        <li>
            <a data-link-type="biblio">[worklets-1]</a> 定义了以下术语:
            <ul>
                <li><a href="https://www.w3.org/TR/worklets-1/#worklet">Worklet</a>
                <li><a href="https://www.w3.org/TR/worklets-1/#workletglobalscope">WorkletGlobalScope</a>
                <li><a href="https://www.w3.org/TR/worklets-1/#worklet-global-scope-type">worklet global scope type</a>
                <li><a href="https://www.w3.org/TR/worklets-1/#worklets-workletglobalscopes">worklet's
                        workletglobalscopes</a>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">规范性引用</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-css-break-3">[CSS-BREAK-3]
        <dd>Rossen Atanassov; Elika Etemad. <a href="https://www.w3.org/TR/css-break-3/">CSS 碎片化模块第 3 级</a>. 2017年2月9日.
            CR. URL: <a href="https://www.w3.org/TR/css-break-3/">https://www.w3.org/TR/css-break-3/</a>
        <dt id="biblio-css-cascade-4">[CSS-CASCADE-4]
        <dd>Elika Etemad; Tab Atkins Jr.. <a href="https://www.w3.org/TR/css-cascade-4/">CSS 级联与继承第 4 级</a>. 2016年1月14日.
            CR. URL: <a href="https://www.w3.org/TR/css-cascade-4/">https://www.w3.org/TR/css-cascade-4/</a>
        <dt id="biblio-css-flexbox-1">[CSS-FLEXBOX-1]
        <dd>Tab Atkins Jr.; Elika Etemad; Rossen Atanassov. <a href="https://www.w3.org/TR/css-flexbox-1/">CSS 弹性盒布局模块第
                1 级</a>. 2017年10月19日. CR. URL: <a
                href="https://www.w3.org/TR/css-flexbox-1/">https://www.w3.org/TR/css-flexbox-1/</a>
        <dt id="biblio-css-grid-1">[CSS-GRID-1]
        <dd>Tab Atkins Jr.; Elika Etemad; Rossen Atanassov. <a href="https://www.w3.org/TR/css-grid-1/">CSS 网格布局模块第 1
                级</a>. 2017年12月14日. CR. URL: <a
                href="https://www.w3.org/TR/css-grid-1/">https://www.w3.org/TR/css-grid-1/</a>
        <dt id="biblio-css-inline-3">[CSS-INLINE-3]
        <dd>Dave Cramer; Elika Etemad; Steve Zilles. <a href="https://www.w3.org/TR/css-inline-3/">CSS 内联布局模块第 3 级</a>.
            2016年5月24日. WD. URL: <a href="https://www.w3.org/TR/css-inline-3/">https://www.w3.org/TR/css-inline-3/</a>
        <dt id="biblio-css-overflow-3">[CSS-OVERFLOW-3]
        <dd>David Baron; Florian Rivoal. <a href="https://www.w3.org/TR/css-overflow-3/">CSS 溢出模块第 3 级</a>. 2016年5月31日.
            WD. URL: <a href="https://www.w3.org/TR/css-overflow-3/">https://www.w3.org/TR/css-overflow-3/</a>
        <dt id="biblio-css-page-floats-3">[CSS-PAGE-FLOATS-3]
        <dd>Johannes Wilm. <a href="https://www.w3.org/TR/css-page-floats-3/">CSS 页面浮动</a>. 2015年9月15日. WD. URL: <a
                href="https://www.w3.org/TR/css-page-floats-3/">https://www.w3.org/TR/css-page-floats-3/</a>
        <dt id="biblio-css-position-3">[CSS-POSITION-3]
        <dd>Rossen Atanassov; Arron Eicholz. <a href="https://www.w3.org/TR/css-position-3/">CSS 定位布局模块第 3 级</a>.
            2016年5月17日. WD. URL: <a
                href="https://www.w3.org/TR/css-position-3/">https://www.w3.org/TR/css-position-3/</a>
        <dt id="biblio-css-pseudo-4">[CSS-PSEUDO-4]
        <dd>Daniel Glazman; Elika Etemad; Alan Stearns. <a href="https://www.w3.org/TR/css-pseudo-4/">CSS 伪元素模块第 4
                级</a>. 2016年6月7日. WD. URL: <a
                href="https://www.w3.org/TR/css-pseudo-4/">https://www.w3.org/TR/css-pseudo-4/</a>
        <dt id="biblio-css-ruby-1">[CSS-RUBY-1]
        <dd>Elika Etemad; Koji Ishii. <a href="https://www.w3.org/TR/css-ruby-1/">CSS Ruby 布局模块第 1 级</a>. 2014年8月5日. WD.
            URL: <a href="https://www.w3.org/TR/css-ruby-1/">https://www.w3.org/TR/css-ruby-1/</a>
        <dt id="biblio-css-sizing-3">[CSS-SIZING-3]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-sizing-3/">CSS 内在与外在尺寸模块第 3 级</a>.
            2018年3月4日. WD. URL: <a href="https://www.w3.org/TR/css-sizing-3/">https://www.w3.org/TR/css-sizing-3/</a>
        <dt id="biblio-css-syntax-3">[CSS-SYNTAX-3]
        <dd>Tab Atkins Jr.; Simon Sapin. <a href="https://www.w3.org/TR/css-syntax-3/">CSS 语法模块第 3 级</a>. 2014年2月20日.
            CR. URL: <a href="https://www.w3.org/TR/css-syntax-3/">https://www.w3.org/TR/css-syntax-3/</a>
        <dt id="biblio-css-typed-om-1">[CSS-TYPED-OM-1]
        <dd>Shane Stephens; Tab Atkins Jr.. <a href="https://www.w3.org/TR/css-typed-om-1/">CSS 类型化 OM 第 1 级</a>.
            2017年8月1日. WD. URL: <a
                href="https://www.w3.org/TR/css-typed-om-1/">https://www.w3.org/TR/css-typed-om-1/</a>
        <dt id="biblio-css-values-3">[CSS-VALUES-3]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-3/">CSS 值与单位模块第 3 级</a>. 2016年9月29日.
            CR. URL: <a href="https://www.w3.org/TR/css-values-3/">https://www.w3.org/TR/css-values-3/</a>
        <dt id="biblio-css-writing-modes-3">[CSS-WRITING-MODES-3]
        <dd>Elika Etemad; Koji Ishii. <a href="https://www.w3.org/TR/css-writing-modes-3/">CSS 书写模式第 3 级</a>.
            2017年12月7日. CR. URL: <a
                href="https://www.w3.org/TR/css-writing-modes-3/">https://www.w3.org/TR/css-writing-modes-3/</a>
        <dt id="biblio-css21">[CSS21]
        <dd>Bert Bos; et al. <a href="https://www.w3.org/TR/CSS2/">层叠样式表第 2 级修订版（CSS 2.1）规范</a>. 2011年6月7日. REC. URL: <a
                href="https://www.w3.org/TR/CSS2/">https://www.w3.org/TR/CSS2/</a>
        <dt id="biblio-css22">[CSS22]
        <dd>Bert Bos. <a href="https://www.w3.org/TR/CSS22/">层叠样式表第 2 级修订版（CSS 2.2）规范</a>. 2016年4月12日. WD. URL: <a
                href="https://www.w3.org/TR/CSS22/">https://www.w3.org/TR/CSS22/</a>
        <dt id="biblio-css3-display">[CSS3-DISPLAY]
        <dd>Elika Etemad. <a href="https://www.w3.org/TR/css-display-3/">CSS 显示模块第 3 级</a>. 2017年7月20日. WD. URL: <a
                href="https://www.w3.org/TR/css-display-3/">https://www.w3.org/TR/css-display-3/</a>
        <dt id="biblio-cssom-1">[CSSOM-1]
        <dd>Simon Pieters; Glenn Adams. <a href="https://www.w3.org/TR/cssom-1/">CSS 对象模型（CSSOM）</a>. 2016年3月17日. WD.
            URL: <a href="https://www.w3.org/TR/cssom-1/">https://www.w3.org/TR/cssom-1/</a>
        <dt id="biblio-dom">[DOM]
        <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM 标准</a>. 现行标准. URL: <a
                href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
        <dt id="biblio-html">[HTML]
        <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/">HTML 标准</a>. 现行标准. URL: <a
                href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        <dt id="biblio-infra">[INFRA]
        <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/">基础标准</a>. 现行标准. URL: <a
                href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
        <dt id="biblio-rfc2119">[RFC2119]
        <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">在 RFC 中指示需求级别的关键字</a>. 1997年3月. 当前最佳实践. URL: <a
                href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
        <dt id="biblio-webidl">[WebIDL]
        <dd>Cameron McCormack; Boris Zbarsky; Tobie Langel. <a href="https://heycam.github.io/webidl/">Web IDL</a>.
            2016年12月15日. ED. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
        <dt id="biblio-worklets-1">[WORKLETS-1]
        <dd>Ian Kilpatrick. <a href="https://www.w3.org/TR/worklets-1/">工作线程第 1 级</a>. 2016年6月7日. WD. URL: <a
                href="https://www.w3.org/TR/worklets-1/">https://www.w3.org/TR/worklets-1/</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">参考性引用</span><a class="self-link"
            href="#informative"></a></h3>
    <dl>
        <dt id="biblio-css-backgrounds-3">[CSS-BACKGROUNDS-3]
        <dd>Bert Bos; Elika Etemad; Brad Kemper. <a href="https://www.w3.org/TR/css-backgrounds-3/">CSS 背景与边框模块第 3
                级</a>. 2017年10月17日. CR. URL: <a
                href="https://www.w3.org/TR/css-backgrounds-3/">https://www.w3.org/TR/css-backgrounds-3/</a>
        <dt id="biblio-css-multicol-1">[CSS-MULTICOL-1]
        <dd>Håkon Wium Lie; Florian Rivoal; Rachel Andrew. <a href="https://www.w3.org/TR/css-multicol-1/">CSS 多列布局模块第 1
                级</a>. 2017年10月5日. WD. URL: <a
                href="https://www.w3.org/TR/css-multicol-1/">https://www.w3.org/TR/css-multicol-1/</a>
    </dl>
    <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL 索引</span><a class="self-link"
            href="#idl-index"></a></h2>
    <pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①④">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#layoutchild"><code>LayoutChild</code></a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/css-typed-om-1/#stylepropertymapreadonly" id="ref-for-stylepropertymapreadonly⑥">StylePropertyMapReadOnly</a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="StylePropertyMapReadOnly" href="#dom-layoutchild-stylemap" id="ref-for-dom-layoutchild-stylemap①">styleMap</a>;

    <a class="n" data-link-type="idl-name" href="#intrinsicsizesrequest" id="ref-for-intrinsicsizesrequest⑥">IntrinsicSizesRequest</a> <a class="nv idl-code" data-link-type="method" href="#dom-layoutchild-intrinsicsizes" id="ref-for-dom-layoutchild-intrinsicsizes③">intrinsicSizes</a>();
    <a class="n" data-link-type="idl-name" href="#layoutfragmentrequest" id="ref-for-layoutfragmentrequest⑧">LayoutFragmentRequest</a> <a class="nv idl-code" data-link-type="method" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment①①">layoutNextFragment</a>(<a class="n" data-link-type="idl-name" href="#layoutconstraints" id="ref-for-layoutconstraints①③">LayoutConstraints</a> <a class="nv" href="#dom-layoutchild-layoutnextfragment-constraints-breaktoken-constraints"><code>constraints</code></a>, <a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken⑦">ChildBreakToken</a> <a class="nv" href="#dom-layoutchild-layoutnextfragment-constraints-breaktoken-breaktoken"><code>breakToken</code></a>);
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①⑤">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#layoutfragment"><code>LayoutFragment</code></a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double③②"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutfragment-inlinesize"><code>inlineSize</code></a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①①⓪"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutfragment-blocksize"><code>blockSize</code></a>;

    <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②①⓪"><span class="kt">double</span></a> <a class="nv" data-type="double" href="#dom-layoutfragment-inlineoffset"><code>inlineOffset</code></a>;
    <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double③①"><span class="kt">double</span></a> <a class="nv" data-type="double" href="#dom-layoutfragment-blockoffset"><code>blockOffset</code></a>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">any</span> <a class="nv" data-readonly="" data-type="any" href="#dom-layoutfragment-data"><code>data</code></a>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken①①">ChildBreakToken</a>? <a class="nv" data-readonly="" data-type="ChildBreakToken?" href="#dom-layoutfragment-breaktoken"><code>breakToken</code></a>;
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed②①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#intrinsicsizes"><code>IntrinsicSizes</code></a> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double④①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-intrinsicsizes-mincontentsize"><code>minContentSize</code></a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑤①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-intrinsicsizes-maxcontentsize"><code>maxContentSize</code></a>;
};

[<a class="nv" href="#dom-layoutconstraints-layoutconstraints"><code>Constructor</code></a>(<span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-layoutconstraintsoptions" id="ref-for-dictdef-layoutconstraintsoptions②">LayoutConstraintsOptions</a> <a class="nv" href="#dom-layoutconstraints-layoutconstraints-options-options"><code>options</code></a>),<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed③①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#layoutconstraints"><code>LayoutConstraints</code></a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑥①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutconstraints-availableinlinesize"><code>availableInlineSize</code></a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑦①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutconstraints-availableblocksize"><code>availableBlockSize</code></a>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑧①"><span class="kt">double</span></a>? <a class="nv" data-readonly="" data-type="double?" href="#dom-layoutconstraints-fixedinlinesize"><code>fixedInlineSize</code></a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑨①"><span class="kt">double</span></a>? <a class="nv" data-readonly="" data-type="double?" href="#dom-layoutconstraints-fixedblocksize"><code>fixedBlockSize</code></a>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⓪①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutconstraints-percentageinlinesize"><code>percentageInlineSize</code></a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①①①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutconstraints-percentageblocksize"><code>percentageBlockSize</code></a>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①②①"><span class="kt">double</span></a>? <a class="nv" data-readonly="" data-type="double?" href="#dom-layoutconstraints-blockfragmentationoffset"><code>blockFragmentationOffset</code></a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#enumdef-blockfragmentationtype" id="ref-for-enumdef-blockfragmentationtype②">BlockFragmentationType</a> <a class="nv" data-readonly="" data-type="BlockFragmentationType" href="#dom-layoutconstraints-blockfragmentationtype"><code>blockFragmentationType</code></a>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">any</span> <a class="nv" data-readonly="" data-type="any" href="#dom-layoutconstraints-data"><code>data</code></a>;
};

<span class="kt">dictionary</span> <a class="nv" href="#dictdef-layoutconstraintsoptions"><code>LayoutConstraintsOptions</code></a> {
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①③①"><span class="kt">double</span></a> <a class="nv" data-default="0" data-type="double " href="#dom-layoutconstraintsoptions-availableinlinesize"><code>availableInlineSize</code></a> = 0;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①④①"><span class="kt">double</span></a> <a class="nv" data-default="0" data-type="double " href="#dom-layoutconstraintsoptions-availableblocksize"><code>availableBlockSize</code></a> = 0;

    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑤①"><span class="kt">double</span></a> <a class="nv" data-type="double " href="#dom-layoutconstraintsoptions-fixedinlinesize"><code>fixedInlineSize</code></a>;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑥①"><span class="kt">double</span></a> <a class="nv" data-type="double " href="#dom-layoutconstraintsoptions-fixedblocksize"><code>fixedBlockSize</code></a>;

    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑦①"><span class="kt">double</span></a> <a class="nv" data-type="double " href="#dom-layoutconstraintsoptions-percentageinlinesize"><code>percentageInlineSize</code></a>;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑧①"><span class="kt">double</span></a> <a class="nv" data-type="double " href="#dom-layoutconstraintsoptions-percentageblocksize"><code>percentageBlockSize</code></a>;

    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑨①"><span class="kt">double</span></a> <a class="nv" data-type="double " href="#dom-layoutconstraintsoptions-blockfragmentationoffset"><code>blockFragmentationOffset</code></a>;
    <a class="n" data-link-type="idl-name" href="#enumdef-blockfragmentationtype" id="ref-for-enumdef-blockfragmentationtype①①">BlockFragmentationType</a> <a class="nv" data-default="&quot;none&quot;" data-type="BlockFragmentationType " href="#dom-layoutconstraintsoptions-blockfragmentationtype"><code>blockFragmentationType</code></a> = "none";

    <span class="kt">any</span> <a class="nv" data-type="any " href="#dom-layoutconstraintsoptions-data"><code>data</code></a>;
};

<span class="kt">enum</span> <a class="nv" href="#enumdef-blockfragmentationtype"><code>BlockFragmentationType</code></a> { <a class="s" href="#dom-blockfragmentationtype-none"><code>"none"</code></a>, <a class="s" href="#dom-blockfragmentationtype-page"><code>"page"</code></a>, <a class="s" href="#dom-blockfragmentationtype-column"><code>"column"</code></a>, <a class="s" href="#dom-blockfragmentationtype-region"><code>"region"</code></a> };

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed④①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#childbreaktoken"><code>ChildBreakToken</code></a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#enumdef-breaktype" id="ref-for-enumdef-breaktype①">BreakType</a> <a class="nv" data-readonly="" data-type="BreakType" href="#dom-childbreaktoken-breaktype"><code>breakType</code></a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutchild" id="ref-for-layoutchild②④①">LayoutChild</a> <a class="nv" data-readonly="" data-type="LayoutChild" href="#dom-childbreaktoken-child"><code>child</code></a>;
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑤①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#breaktoken"><code>BreakToken</code></a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken③①">ChildBreakToken</a>> <a class="nv" data-readonly="" data-type="sequence<ChildBreakToken>" href="#dom-breaktoken-childbreaktokens"><code>childBreakTokens</code></a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">any</span> <a class="nv" data-readonly="" data-type="any" href="#dom-breaktoken-data"><code>data</code></a>;
};

<span class="kt">dictionary</span> <a class="nv" href="#dictdef-breaktokenoptions"><code>BreakTokenOptions</code></a> {
    <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken④①">ChildBreakToken</a>> <a class="nv" data-type="sequence<ChildBreakToken> " href="#dom-breaktokenoptions-childbreaktokens"><code>childBreakTokens</code></a>;
    <span class="kt">any</span> <a class="nv" data-default="null" data-type="any " href="#dom-breaktokenoptions-data"><code>data</code></a> = <span class="kt">null</span>;
};

<span class="kt">enum</span> <a class="nv" href="#enumdef-breaktype"><code>BreakType</code></a> { <a class="s" href="#dom-breaktype-none"><code>"none"</code></a>, <a class="s" href="#dom-breaktype-line"><code>"line"</code></a>, <a class="s" href="#dom-breaktype-column"><code>"column"</code></a>, <a class="s" href="#dom-breaktype-page"><code>"page"</code></a>, <a class="s" href="#dom-breaktype-region"><code>"region"</code></a> };

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑥①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#layoutedgesizes"><code>LayoutEdgeSizes</code></a> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⓪①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutedgesizes-inlinestart"><code>inlineStart</code></a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②①①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutedgesizes-inlineend"><code>inlineEnd</code></a>;

  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②②①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutedgesizes-blockstart"><code>blockStart</code></a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②③①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutedgesizes-blockend"><code>blockEnd</code></a>;

  // Convenience attributes for the sum in one direction.
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②④①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutedgesizes-inline"><code>inline</code></a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑤①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutedgesizes-block"><code>block</code></a>;
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑦①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#layoutedges"><code>LayoutEdges</code></a> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes⑧">LayoutEdgeSizes</a> <a class="nv" data-readonly="" data-type="LayoutEdgeSizes" href="#dom-layoutedges-border"><code>border</code></a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes①①">LayoutEdgeSizes</a> <a class="nv" data-readonly="" data-type="LayoutEdgeSizes" href="#dom-layoutedges-scrollbar"><code>scrollbar</code></a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes②①">LayoutEdgeSizes</a> <a class="nv" data-readonly="" data-type="LayoutEdgeSizes" href="#dom-layoutedges-padding"><code>padding</code></a>;

  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes③①">LayoutEdgeSizes</a> <a class="nv" data-readonly="" data-type="LayoutEdgeSizes" href="#dom-layoutedges-all"><code>all</code></a>;
};

<span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://www.w3.org/TR/cssom-1/#css" id="ref-for-css①">CSS</a> {
    [<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SameObject" id="ref-for-SameObject①">SameObject</a>] <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/worklets-1/#worklet" id="ref-for-worklet①①">Worklet</a> <a class="nv" data-readonly="" data-type="Worklet" href="#dom-css-layoutworklet"><code>layoutWorklet</code></a>;
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Global" id="ref-for-Global①">Global</a>=(<a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/worklets-1/#worklet" id="ref-for-worklet②①">Worklet</a>,<a class="n" data-link-type="idl-name">LayoutWorklet</a>),<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑧①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#layoutworkletglobalscope"><code>LayoutWorkletGlobalScope</code></a> : <a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/worklets-1/#workletglobalscope" id="ref-for-workletglobalscope①">WorkletGlobalScope</a> {
    <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-layoutworkletglobalscope-registerlayout" id="ref-for-dom-layoutworkletglobalscope-registerlayout③">registerLayout</a>(<a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①"><span class="kt">DOMString</span></a> <a class="nv" href="#dom-layoutworkletglobalscope-registerlayout-name-layoutctor-name"><code>name</code></a>, <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#VoidFunction" id="ref-for-VoidFunction①">VoidFunction</a> <a class="nv" href="#dom-layoutworkletglobalscope-registerlayout-name-layoutctor-layoutctor"><code>layoutCtor</code></a>);
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑨①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">dictionary</span> <a class="nv" href="#dictdef-layoutoptions"><code>LayoutOptions</code></a> {
  <a class="n" data-link-type="idl-name" href="#enumdef-childdisplaytype" id="ref-for-enumdef-childdisplaytype①">ChildDisplayType</a> <a class="nv" data-default="&quot;block&quot;" data-type="ChildDisplayType " href="#dom-layoutoptions-childdisplay"><code>childDisplay</code></a> = "block";
  <a class="n" data-link-type="idl-name" href="#enumdef-layoutsizingmode" id="ref-for-enumdef-layoutsizingmode①">LayoutSizingMode</a> <a class="nv" data-default="&quot;block-like&quot;" data-type="LayoutSizingMode " href="#dom-layoutoptions-sizing"><code>sizing</code></a> = "block-like";
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①⓪①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">enum</span> <a class="nv" href="#enumdef-childdisplaytype"><code>ChildDisplayType</code></a> {
    <a class="s" href="#dom-childdisplaytype-block"><code>"block"</code></a>,
    <a class="s" href="#dom-childdisplaytype-normal"><code>"normal"</code></a>,
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①①①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">enum</span> <a class="nv" href="#enumdef-layoutsizingmode"><code>LayoutSizingMode</code></a> {
    <a class="s" href="#dom-layoutsizingmode-block-like"><code>"block-like"</code></a>,
    <a class="s" href="#dom-layoutsizingmode-manual"><code>"manual"</code></a>,
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①②①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#intrinsicsizesrequest"><code>IntrinsicSizesRequest</code></a> {
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①③①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#layoutfragmentrequest"><code>LayoutFragmentRequest</code></a> {
};

<span class="kt">typedef</span> (<a class="n" data-link-type="idl-name" href="#intrinsicsizesrequest" id="ref-for-intrinsicsizesrequest③①">IntrinsicSizesRequest</a> <span class="kt">or</span> <a class="n" data-link-type="idl-name" href="#layoutfragmentrequest" id="ref-for-layoutfragmentrequest③①">LayoutFragmentRequest</a>)
    <a class="nv" href="#typedefdef-layoutfragmentrequestorintrinsicsizesrequest"><code>LayoutFragmentRequestOrIntrinsicSizesRequest</code></a>;

// This is the final return value from the author defined layout() method.
<span class="kt">dictionary</span> <a class="nv" href="#dictdef-fragmentresultoptions"><code>FragmentResultOptions</code></a> {
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑥①"><span class="kt">double</span></a> <a class="nv" data-default="0" data-type="double " href="#dom-fragmentresultoptions-inlinesize"><code>inlineSize</code></a> = 0;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑦①"><span class="kt">double</span></a> <a class="nv" data-default="0" data-type="double " href="#dom-fragmentresultoptions-blocksize"><code>blockSize</code></a> = 0;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑧①"><span class="kt">double</span></a> <a class="nv" data-default="0" data-type="double " href="#dom-fragmentresultoptions-autoblocksize"><code>autoBlockSize</code></a> = 0;
    <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#layoutfragment" id="ref-for-layoutfragment②④①">LayoutFragment</a>> <a class="nv" data-default="None" data-type="sequence<LayoutFragment> " href="#dom-fragmentresultoptions-childfragments"><code>childFragments</code></a> = [];
    <span class="kt">any</span> <a class="nv" data-default="null" data-type="any " href="#dom-fragmentresultoptions-data"><code>data</code></a> = <span class="kt">null</span>;
    <a class="n" data-link-type="idl-name" href="#dictdef-breaktokenoptions" id="ref-for-dictdef-breaktokenoptions①">BreakTokenOptions</a> <a class="nv" data-default="null" data-type="BreakTokenOptions " href="#dom-fragmentresultoptions-breaktoken"><code>breakToken</code></a> = <span class="kt">null</span>;
};

<span class="kt">dictionary</span> <a class="nv" href="#dictdef-intrinsicsizesresultoptions"><code>IntrinsicSizesResultOptions</code></a> {
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑨①"><span class="kt">double</span></a> <a class="nv" data-type="double " href="#dom-intrinsicsizesresultoptions-maxcontentsize"><code>maxContentSize</code></a>;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double③⓪①"><span class="kt">double</span></a> <a class="nv" data-type="double " href="#dom-intrinsicsizesresultoptions-mincontentsize"><code>minContentSize</code></a>;
};

</pre>
    <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">问题索引</span><a class="self-link"
            href="#issues-index"></a></h2>
    <div style="counter-reset:issue">
        <div class="issue">
            问题: 目前 API 是一个可迭代的生成器形式。基于实现经验和 Web 开发者经验，这可能会更改为基于 Promise 的 API。每种形式都有其优点和缺点。
            <p><em>Promises</em></p>
            <ul>
                <li data-md="">
                    <p>更好的错误报告。</p>
                <li data-md="">
                    <p>可能更符合开发者的习惯。</p>
            </ul>
            <p><em>Generator</em></p>
            <ul>
                <li data-md="">
                    <p>更“严格” - 只能执行布局操作。不必限制每次调用使用哪些 Promise API。</p>
                <li data-md="">
                    <p>可能具有更好的绑定开销。</p>
            </ul>
            <a href="#issue-ac1b3ccd"> ↵ </a>
        </div>
        <div class="issue"> 我们可能希望将 <var>styleMap</var> 存储在 <var>box</var> 上，类似于 <var>layoutInstance</var>。<a
                href="#issue-233d3cc5"> ↵ </a>
        </div>
        <div class="issue"> 我们可能希望将 <var>styleMap</var> 存储在 <var>box</var> 上，类似于 <var>layoutInstance</var>。<a
                href="#issue-233d3cc5①"> ↵ </a>
        </div>
    </div>
    <aside class="dfn-panel" data-for="valdef-display-layout">
        <b><a href="#valdef-display-layout">#valdef-display-layout</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-valdef-display-layout">2. Layout API Containers</a>
            <li><a href="#ref-for-valdef-display-layout①">3.1.1. LayoutChildren and the Box Tree</a>
            <li><a href="#ref-for-valdef-display-layout②">5.1. Concepts</a> <a
                    href="#ref-for-valdef-display-layout③">(2)</a>
            <li><a href="#ref-for-valdef-display-layout④">5.2. Layout Invalidation</a>
            <li><a href="#ref-for-valdef-display-layout⑤">5.6.1. Determining Intrinsic Sizes</a>
            <li><a href="#ref-for-valdef-display-layout⑥">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-api-container">
        <b><a href="#layout-api-container">#layout-api-container</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layout-api-container">2. Layout API Containers</a> <a
                    href="#ref-for-layout-api-container①">(2)</a> <a href="#ref-for-layout-api-container②">(3)</a> <a
                    href="#ref-for-layout-api-container③">(4)</a> <a href="#ref-for-layout-api-container④">(5)</a>
            <li><a href="#ref-for-layout-api-container⑤">2.1. Layout API Container Painting</a>
            <li><a href="#ref-for-layout-api-container⑥">3.1.1. LayoutChildren and the Box Tree</a> <a
                    href="#ref-for-layout-api-container⑦">(2)</a>
            <li><a href="#ref-for-layout-api-container⑧">3.2. Layout Fragments</a> <a
                    href="#ref-for-layout-api-container⑨">(2)</a>
            <li><a href="#ref-for-layout-api-container①⓪">4.1. Sizing</a> <a
                    href="#ref-for-layout-api-container①①">(2)</a> <a href="#ref-for-layout-api-container①②">(3)</a> <a
                    href="#ref-for-layout-api-container①③">(4)</a> <a href="#ref-for-layout-api-container①④">(5)</a>
            <li><a href="#ref-for-layout-api-container①⑤">4.1.1. Positioned layout sizing</a> <a
                    href="#ref-for-layout-api-container①⑥">(2)</a>
            <li><a href="#ref-for-layout-api-container①⑦">4.2. Positioning</a> <a
                    href="#ref-for-layout-api-container①⑧">(2)</a> <a href="#ref-for-layout-api-container①⑨">(3)</a>
            <li><a href="#ref-for-layout-api-container②⓪">4.3. Overflow</a> <a
                    href="#ref-for-layout-api-container②①">(2)</a> <a href="#ref-for-layout-api-container②②">(3)</a>
            <li><a href="#ref-for-layout-api-container②③">4.5. Alignment</a>
            <li><a href="#ref-for-layout-api-container②④">5.2. Layout Invalidation</a>
            <li><a href="#ref-for-layout-api-container②⑤">5.4. Registering A Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-api-formatting-context">
        <b><a href="#layout-api-formatting-context">#layout-api-formatting-context</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layout-api-formatting-context">5.6.1. Determining Intrinsic Sizes</a>
            <li><a href="#ref-for-layout-api-formatting-context①">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-api-children">
        <b><a href="#layout-api-children">#layout-api-children</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layout-api-children">2.2. Box Tree Transformations</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="current-layout">
        <b><a href="#current-layout">#current-layout</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-current-layout">3. Layout API Model and Terminology</a> <a
                    href="#ref-for-current-layout①">(2)</a>
            <li><a href="#ref-for-current-layout②">3.2. Layout Fragments</a> <a href="#ref-for-current-layout③">(2)</a>
                <a href="#ref-for-current-layout④">(3)</a> <a href="#ref-for-current-layout⑤">(4)</a> <a
                    href="#ref-for-current-layout⑥">(5)</a>
            <li><a href="#ref-for-current-layout⑦">3.3. Intrinsic Sizes</a> <a href="#ref-for-current-layout⑧">(2)</a>
                <a href="#ref-for-current-layout⑨">(3)</a> <a href="#ref-for-current-layout①⓪">(4)</a>
            <li><a href="#ref-for-current-layout①①">3.4. Layout Constraints</a> <a
                    href="#ref-for-current-layout①②">(2)</a> <a href="#ref-for-current-layout①③">(3)</a> <a
                    href="#ref-for-current-layout①④">(4)</a> <a href="#ref-for-current-layout①⑤">(5)</a>
            <li><a href="#ref-for-current-layout①⑥">4.1. Sizing</a>
            <li><a href="#ref-for-current-layout①⑦">4.4. Fragmentation</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="parent-layout">
        <b><a href="#parent-layout">#parent-layout</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-parent-layout">3.4. Layout Constraints</a> <a href="#ref-for-parent-layout①">(2)</a>
                <a href="#ref-for-parent-layout②">(3)</a>
            <li><a href="#ref-for-parent-layout③">4.4. Fragmentation</a>
            <li><a href="#ref-for-parent-layout④">4.5. Alignment</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="child-layout">
        <b><a href="#child-layout">#child-layout</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-child-layout">3.4. Layout Constraints</a>
            <li><a href="#ref-for-child-layout①">3.5. Breaking and Fragmentation</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layoutchild">
        <b><a href="#layoutchild">#layoutchild</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layoutchild">2.2. Box Tree Transformations</a> <a href="#ref-for-layoutchild①">(2)</a>
            <li><a href="#ref-for-layoutchild②">3. Layout API Model and Terminology</a>
            <li><a href="#ref-for-layoutchild③">3.1. Layout Children</a> <a href="#ref-for-layoutchild④">(2)</a> <a
                    href="#ref-for-layoutchild⑤">(3)</a> <a href="#ref-for-layoutchild⑥">(4)</a> <a
                    href="#ref-for-layoutchild⑦">(5)</a> <a href="#ref-for-layoutchild⑧">(6)</a> <a
                    href="#ref-for-layoutchild⑨">(7)</a> <a href="#ref-for-layoutchild①⓪">(8)</a> <a
                    href="#ref-for-layoutchild①①">(9)</a> <a href="#ref-for-layoutchild①②">(10)</a> <a
                    href="#ref-for-layoutchild①③">(11)</a> <a href="#ref-for-layoutchild①④">(12)</a> <a
                    href="#ref-for-layoutchild①⑤">(13)</a>
            <li><a href="#ref-for-layoutchild①⑥">3.1.1. LayoutChildren and the Box Tree</a> <a
                    href="#ref-for-layoutchild①⑦">(2)</a>
            <li><a href="#ref-for-layoutchild①⑧">3.2. Layout Fragments</a> <a href="#ref-for-layoutchild①⑨">(2)</a> <a
                    href="#ref-for-layoutchild②⓪">(3)</a>
            <li><a href="#ref-for-layoutchild②①">3.3. Intrinsic Sizes</a> <a href="#ref-for-layoutchild②②">(2)</a>
            <li><a href="#ref-for-layoutchild②③">3.4. Layout Constraints</a>
            <li><a href="#ref-for-layoutchild②④">3.5. Breaking and Fragmentation</a> <a
                    href="#ref-for-layoutchild②⑤">(2)</a> <a href="#ref-for-layoutchild②⑥">(3)</a> <a
                    href="#ref-for-layoutchild②⑦">(4)</a> <a href="#ref-for-layoutchild②⑧">(5)</a>
            <li><a href="#ref-for-layoutchild②⑨">4.2. Positioning</a> <a href="#ref-for-layoutchild③⓪">(2)</a>
            <li><a href="#ref-for-layoutchild③①">4.5. Alignment</a>
            <li><a href="#ref-for-layoutchild③②">5.2. Layout Invalidation</a>
            <li><a href="#ref-for-layoutchild③③">5.5.1. Request Objects</a> <a href="#ref-for-layoutchild③④">(2)</a> <a
                    href="#ref-for-layoutchild③⑤">(3)</a> <a href="#ref-for-layoutchild③⑥">(4)</a>
            <li><a href="#ref-for-layoutchild③⑦">5.6.3. Utility Algorithms</a> <a href="#ref-for-layoutchild③⑧">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutchild-box-slot">
        <b><a href="#dom-layoutchild-box-slot">#dom-layoutchild-box-slot</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutchild-box-slot">3.1.1. LayoutChildren and the Box Tree</a>
            <li><a href="#ref-for-dom-layoutchild-box-slot①">5.6.3. Utility Algorithms</a> <a
                    href="#ref-for-dom-layoutchild-box-slot②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutchild-stylemap-slot">
        <b><a href="#dom-layoutchild-stylemap-slot">#dom-layoutchild-stylemap-slot</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutchild-stylemap-slot">3.1. Layout Children</a>
            <li><a href="#ref-for-dom-layoutchild-stylemap-slot①">3.1.1. LayoutChildren and the Box Tree</a> <a
                    href="#ref-for-dom-layoutchild-stylemap-slot②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutchild-stylemap">
        <b><a href="#dom-layoutchild-stylemap">#dom-layoutchild-stylemap</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutchild-stylemap">3.1. Layout Children</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutchild-layoutnextfragment">
        <b><a href="#dom-layoutchild-layoutnextfragment">#dom-layoutchild-layoutnextfragment</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutchild-layoutnextfragment">2.2. Box Tree Transformations</a>
            <li><a href="#ref-for-dom-layoutchild-layoutnextfragment①">3.1. Layout Children</a> <a
                    href="#ref-for-dom-layoutchild-layoutnextfragment②">(2)</a>
            <li><a href="#ref-for-dom-layoutchild-layoutnextfragment③">3.2. Layout Fragments</a> <a
                    href="#ref-for-dom-layoutchild-layoutnextfragment④">(2)</a> <a
                    href="#ref-for-dom-layoutchild-layoutnextfragment⑤">(3)</a> <a
                    href="#ref-for-dom-layoutchild-layoutnextfragment⑥">(4)</a>
            <li><a href="#ref-for-dom-layoutchild-layoutnextfragment⑦">5.5.1. Request Objects</a> <a
                    href="#ref-for-dom-layoutchild-layoutnextfragment⑧">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutchild-intrinsicsizes">
        <b><a href="#dom-layoutchild-intrinsicsizes">#dom-layoutchild-intrinsicsizes</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutchild-intrinsicsizes">3.1. Layout Children</a> <a
                    href="#ref-for-dom-layoutchild-intrinsicsizes①">(2)</a>
            <li><a href="#ref-for-dom-layoutchild-intrinsicsizes②">5.5.1. Request Objects</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-box-layoutchildmap-slot">
        <b><a href="#dom-box-layoutchildmap-slot">#dom-box-layoutchildmap-slot</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-box-layoutchildmap-slot">3.1.1. LayoutChildren and the Box Tree</a> <a
                    href="#ref-for-dom-box-layoutchildmap-slot①">(2)</a> <a
                    href="#ref-for-dom-box-layoutchildmap-slot②">(3)</a> <a
                    href="#ref-for-dom-box-layoutchildmap-slot③">(4)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="get-a-layout-child">
        <b><a href="#get-a-layout-child">#get-a-layout-child</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-get-a-layout-child">5.6.1. Determining Intrinsic Sizes</a>
            <li><a href="#ref-for-get-a-layout-child①">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="update-a-layout-child-style">
        <b><a href="#update-a-layout-child-style">#update-a-layout-child-style</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-update-a-layout-child-style">3.1.1. LayoutChildren and the Box Tree</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layoutfragment">
        <b><a href="#layoutfragment">#layoutfragment</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layoutfragment">2.2. Box Tree Transformations</a>
            <li><a href="#ref-for-layoutfragment①">3.1. Layout Children</a> <a href="#ref-for-layoutfragment②">(2)</a>
            <li><a href="#ref-for-layoutfragment③">3.2. Layout Fragments</a> <a href="#ref-for-layoutfragment④">(2)</a>
                <a href="#ref-for-layoutfragment⑤">(3)</a> <a href="#ref-for-layoutfragment⑥">(4)</a> <a
                    href="#ref-for-layoutfragment⑦">(5)</a> <a href="#ref-for-layoutfragment⑧">(6)</a> <a
                    href="#ref-for-layoutfragment⑨">(7)</a> <a href="#ref-for-layoutfragment①⓪">(8)</a> <a
                    href="#ref-for-layoutfragment①①">(9)</a>
            <li><a href="#ref-for-layoutfragment①②">3.4. Layout Constraints</a> <a
                    href="#ref-for-layoutfragment①③">(2)</a> <a href="#ref-for-layoutfragment①④">(3)</a> <a
                    href="#ref-for-layoutfragment①⑤">(4)</a>
            <li><a href="#ref-for-layoutfragment①⑥">3.5. Breaking and Fragmentation</a> <a
                    href="#ref-for-layoutfragment①⑦">(2)</a> <a href="#ref-for-layoutfragment①⑧">(3)</a> <a
                    href="#ref-for-layoutfragment①⑨">(4)</a> <a href="#ref-for-layoutfragment②⓪">(5)</a>
            <li><a href="#ref-for-layoutfragment②①">5.5.1. Request Objects</a> <a
                    href="#ref-for-layoutfragment②②">(2)</a> <a href="#ref-for-layoutfragment②③">(3)</a>
            <li><a href="#ref-for-layoutfragment②④">5.6. Performing Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutfragment-inlinesize">
        <b><a href="#dom-layoutfragment-inlinesize">#dom-layoutfragment-inlinesize</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutfragment-inlinesize">3.2. Layout Fragments</a> <a
                    href="#ref-for-dom-layoutfragment-inlinesize①">(2)</a> <a
                    href="#ref-for-dom-layoutfragment-inlinesize②">(3)</a> <a
                    href="#ref-for-dom-layoutfragment-inlinesize③">(4)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutfragment-blocksize">
        <b><a href="#dom-layoutfragment-blocksize">#dom-layoutfragment-blocksize</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutfragment-blocksize">3.2. Layout Fragments</a> <a
                    href="#ref-for-dom-layoutfragment-blocksize①">(2)</a> <a
                    href="#ref-for-dom-layoutfragment-blocksize②">(3)</a> <a
                    href="#ref-for-dom-layoutfragment-blocksize③">(4)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutfragment-inlineoffset">
        <b><a href="#dom-layoutfragment-inlineoffset">#dom-layoutfragment-inlineoffset</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutfragment-inlineoffset">3.2. Layout Fragments</a> <a
                    href="#ref-for-dom-layoutfragment-inlineoffset①">(2)</a> <a
                    href="#ref-for-dom-layoutfragment-inlineoffset②">(3)</a>
            <li><a href="#ref-for-dom-layoutfragment-inlineoffset③">4.2. Positioning</a> <a
                    href="#ref-for-dom-layoutfragment-inlineoffset④">(2)</a>
            <li><a href="#ref-for-dom-layoutfragment-inlineoffset⑤">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutfragment-blockoffset">
        <b><a href="#dom-layoutfragment-blockoffset">#dom-layoutfragment-blockoffset</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutfragment-blockoffset">3.2. Layout Fragments</a> <a
                    href="#ref-for-dom-layoutfragment-blockoffset①">(2)</a> <a
                    href="#ref-for-dom-layoutfragment-blockoffset②">(3)</a>
            <li><a href="#ref-for-dom-layoutfragment-blockoffset③">4.2. Positioning</a> <a
                    href="#ref-for-dom-layoutfragment-blockoffset④">(2)</a>
            <li><a href="#ref-for-dom-layoutfragment-blockoffset⑤">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutfragment-data">
        <b><a href="#dom-layoutfragment-data">#dom-layoutfragment-data</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutfragment-data">3.2. Layout Fragments</a> <a
                    href="#ref-for-dom-layoutfragment-data①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutfragment-breaktoken">
        <b><a href="#dom-layoutfragment-breaktoken">#dom-layoutfragment-breaktoken</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutfragment-breaktoken">3.2. Layout Fragments</a> <a
                    href="#ref-for-dom-layoutfragment-breaktoken①">(2)</a> <a
                    href="#ref-for-dom-layoutfragment-breaktoken②">(3)</a> <a
                    href="#ref-for-dom-layoutfragment-breaktoken③">(4)</a> <a
                    href="#ref-for-dom-layoutfragment-breaktoken④">(5)</a> <a
                    href="#ref-for-dom-layoutfragment-breaktoken⑤">(6)</a>
            <li><a href="#ref-for-dom-layoutfragment-breaktoken⑥">3.5. Breaking and Fragmentation</a> <a
                    href="#ref-for-dom-layoutfragment-breaktoken⑦">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutfragment-layoutfragmentrequest-slot">
        <b><a
                href="#dom-layoutfragment-layoutfragmentrequest-slot">#dom-layoutfragment-layoutfragmentrequest-slot</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutfragment-layoutfragmentrequest-slot">3.2. Layout Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutfragment-generator-slot">
        <b><a href="#dom-layoutfragment-generator-slot">#dom-layoutfragment-generator-slot</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutfragment-generator-slot">3.2. Layout Fragments</a>
            <li><a href="#ref-for-dom-layoutfragment-generator-slot①">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="create-a-layout-fragment">
        <b><a href="#create-a-layout-fragment">#create-a-layout-fragment</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-create-a-layout-fragment">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="intrinsicsizes">
        <b><a href="#intrinsicsizes">#intrinsicsizes</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-intrinsicsizes">3.3. Intrinsic Sizes</a> <a href="#ref-for-intrinsicsizes①">(2)</a> <a
                    href="#ref-for-intrinsicsizes②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-intrinsicsizes-mincontentsize">
        <b><a href="#dom-intrinsicsizes-mincontentsize">#dom-intrinsicsizes-mincontentsize</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-intrinsicsizes-mincontentsize">3.3. Intrinsic Sizes</a> <a
                    href="#ref-for-dom-intrinsicsizes-mincontentsize①">(2)</a> <a
                    href="#ref-for-dom-intrinsicsizes-mincontentsize②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-intrinsicsizes-maxcontentsize">
        <b><a href="#dom-intrinsicsizes-maxcontentsize">#dom-intrinsicsizes-maxcontentsize</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-intrinsicsizes-maxcontentsize">3.3. Intrinsic Sizes</a> <a
                    href="#ref-for-dom-intrinsicsizes-maxcontentsize①">(2)</a> <a
                    href="#ref-for-dom-intrinsicsizes-maxcontentsize②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-intrinsicsizes-intrinsicsizesrequest-slot">
        <b><a
                href="#dom-intrinsicsizes-intrinsicsizesrequest-slot">#dom-intrinsicsizes-intrinsicsizesrequest-slot</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-intrinsicsizes-intrinsicsizesrequest-slot">3.3. Intrinsic Sizes</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="create-an-intrinsic-sizes-object">
        <b><a href="#create-an-intrinsic-sizes-object">#create-an-intrinsic-sizes-object</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-create-an-intrinsic-sizes-object">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layoutconstraints">
        <b><a href="#layoutconstraints">#layoutconstraints</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layoutconstraints">3.1. Layout Children</a>
            <li><a href="#ref-for-layoutconstraints①">3.4. Layout Constraints</a> <a
                    href="#ref-for-layoutconstraints②">(2)</a> <a href="#ref-for-layoutconstraints③">(3)</a> <a
                    href="#ref-for-layoutconstraints④">(4)</a> <a href="#ref-for-layoutconstraints⑤">(5)</a> <a
                    href="#ref-for-layoutconstraints⑥">(6)</a>
            <li><a href="#ref-for-layoutconstraints⑦">3.5. Breaking and Fragmentation</a>
            <li><a href="#ref-for-layoutconstraints⑧">4.1. Sizing</a> <a href="#ref-for-layoutconstraints⑨">(2)</a>
            <li><a href="#ref-for-layoutconstraints①⓪">5.2. Layout Invalidation</a> <a
                    href="#ref-for-layoutconstraints①①">(2)</a> <a href="#ref-for-layoutconstraints①②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutconstraints-availableinlinesize">
        <b><a
                href="#dom-layoutconstraints-availableinlinesize">#dom-layoutconstraints-availableinlinesize</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutconstraints-availableinlinesize">3.4. Layout Constraints</a> <a
                    href="#ref-for-dom-layoutconstraints-availableinlinesize①">(2)</a> <a
                    href="#ref-for-dom-layoutconstraints-availableinlinesize②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutconstraints-availableblocksize">
        <b><a
                href="#dom-layoutconstraints-availableblocksize">#dom-layoutconstraints-availableblocksize</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutconstraints-availableblocksize">3.4. Layout Constraints</a> <a
                    href="#ref-for-dom-layoutconstraints-availableblocksize①">(2)</a> <a
                    href="#ref-for-dom-layoutconstraints-availableblocksize②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutconstraints-fixedinlinesize">
        <b><a href="#dom-layoutconstraints-fixedinlinesize">#dom-layoutconstraints-fixedinlinesize</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutconstraints-fixedinlinesize">3.4. Layout Constraints</a> <a
                    href="#ref-for-dom-layoutconstraints-fixedinlinesize①">(2)</a> <a
                    href="#ref-for-dom-layoutconstraints-fixedinlinesize②">(3)</a>
            <li><a href="#ref-for-dom-layoutconstraints-fixedinlinesize③">4.1. Sizing</a> <a
                    href="#ref-for-dom-layoutconstraints-fixedinlinesize④">(2)</a> <a
                    href="#ref-for-dom-layoutconstraints-fixedinlinesize⑤">(3)</a> <a
                    href="#ref-for-dom-layoutconstraints-fixedinlinesize⑥">(4)</a>
            <li><a href="#ref-for-dom-layoutconstraints-fixedinlinesize⑦">4.1.1. Positioned layout sizing</a>
            <li><a href="#ref-for-dom-layoutconstraints-fixedinlinesize⑧">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutconstraints-fixedblocksize">
        <b><a href="#dom-layoutconstraints-fixedblocksize">#dom-layoutconstraints-fixedblocksize</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutconstraints-fixedblocksize">3.4. Layout Constraints</a> <a
                    href="#ref-for-dom-layoutconstraints-fixedblocksize①">(2)</a> <a
                    href="#ref-for-dom-layoutconstraints-fixedblocksize②">(3)</a>
            <li><a href="#ref-for-dom-layoutconstraints-fixedblocksize③">4.1. Sizing</a> <a
                    href="#ref-for-dom-layoutconstraints-fixedblocksize④">(2)</a> <a
                    href="#ref-for-dom-layoutconstraints-fixedblocksize⑤">(3)</a> <a
                    href="#ref-for-dom-layoutconstraints-fixedblocksize⑥">(4)</a>
            <li><a href="#ref-for-dom-layoutconstraints-fixedblocksize⑦">4.1.1. Positioned layout sizing</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutconstraints-percentageinlinesize">
        <b><a
                href="#dom-layoutconstraints-percentageinlinesize">#dom-layoutconstraints-percentageinlinesize</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutconstraints-percentageinlinesize">3.4. Layout Constraints</a> <a
                    href="#ref-for-dom-layoutconstraints-percentageinlinesize①">(2)</a> <a
                    href="#ref-for-dom-layoutconstraints-percentageinlinesize②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutconstraints-percentageblocksize">
        <b><a
                href="#dom-layoutconstraints-percentageblocksize">#dom-layoutconstraints-percentageblocksize</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutconstraints-percentageblocksize">3.4. Layout Constraints</a> <a
                    href="#ref-for-dom-layoutconstraints-percentageblocksize①">(2)</a> <a
                    href="#ref-for-dom-layoutconstraints-percentageblocksize②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutconstraints-blockfragmentationoffset">
        <b><a
                href="#dom-layoutconstraints-blockfragmentationoffset">#dom-layoutconstraints-blockfragmentationoffset</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutconstraints-blockfragmentationoffset">3.4. Layout Constraints</a>
            <li><a href="#ref-for-dom-layoutconstraints-blockfragmentationoffset①">4.4. Fragmentation</a> <a
                    href="#ref-for-dom-layoutconstraints-blockfragmentationoffset②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutconstraints-blockfragmentationtype">
        <b><a
                href="#dom-layoutconstraints-blockfragmentationtype">#dom-layoutconstraints-blockfragmentationtype</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutconstraints-blockfragmentationtype">3.4. Layout Constraints</a> <a
                    href="#ref-for-dom-layoutconstraints-blockfragmentationtype①">(2)</a>
            <li><a href="#ref-for-dom-layoutconstraints-blockfragmentationtype②">3.5. Breaking and Fragmentation</a> <a
                    href="#ref-for-dom-layoutconstraints-blockfragmentationtype③">(2)</a>
            <li><a href="#ref-for-dom-layoutconstraints-blockfragmentationtype④">4.4. Fragmentation</a> <a
                    href="#ref-for-dom-layoutconstraints-blockfragmentationtype⑤">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dictdef-layoutconstraintsoptions">
        <b><a href="#dictdef-layoutconstraintsoptions">#dictdef-layoutconstraintsoptions</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dictdef-layoutconstraintsoptions">3.4. Layout Constraints</a>
            <li><a href="#ref-for-dictdef-layoutconstraintsoptions①">5.5.1. Request Objects</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="enumdef-blockfragmentationtype">
        <b><a href="#enumdef-blockfragmentationtype">#enumdef-blockfragmentationtype</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-enumdef-blockfragmentationtype">3.4. Layout Constraints</a> <a
                    href="#ref-for-enumdef-blockfragmentationtype①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="create-a-layout-constraints-object">
        <b><a href="#create-a-layout-constraints-object">#create-a-layout-constraints-object</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-create-a-layout-constraints-object">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="childbreaktoken">
        <b><a href="#childbreaktoken">#childbreaktoken</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-childbreaktoken">3.1. Layout Children</a>
            <li><a href="#ref-for-childbreaktoken①">3.2. Layout Fragments</a> <a
                    href="#ref-for-childbreaktoken②">(2)</a>
            <li><a href="#ref-for-childbreaktoken③">3.5. Breaking and Fragmentation</a> <a
                    href="#ref-for-childbreaktoken④">(2)</a> <a href="#ref-for-childbreaktoken⑤">(3)</a>
            <li><a href="#ref-for-childbreaktoken⑥">5.5.1. Request Objects</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="breaktoken">
        <b><a href="#breaktoken">#breaktoken</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-breaktoken">3.5. Breaking and Fragmentation</a> <a href="#ref-for-breaktoken①">(2)</a>
            <li><a href="#ref-for-breaktoken②">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dictdef-breaktokenoptions">
        <b><a href="#dictdef-breaktokenoptions">#dictdef-breaktokenoptions</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dictdef-breaktokenoptions">5.6. Performing Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="enumdef-breaktype">
        <b><a href="#enumdef-breaktype">#enumdef-breaktype</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-enumdef-breaktype">3.5. Breaking and Fragmentation</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layoutedgesizes">
        <b><a href="#layoutedgesizes">#layoutedgesizes</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layoutedgesizes">3.6. Edges</a> <a href="#ref-for-layoutedgesizes①">(2)</a> <a
                    href="#ref-for-layoutedgesizes②">(3)</a> <a href="#ref-for-layoutedgesizes③">(4)</a> <a
                    href="#ref-for-layoutedgesizes④">(5)</a> <a href="#ref-for-layoutedgesizes⑤">(6)</a>
            <li><a href="#ref-for-layoutedgesizes⑥">5.6.1. Determining Intrinsic Sizes</a>
            <li><a href="#ref-for-layoutedgesizes⑦">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutedgesizes-inlinestart">
        <b><a href="#dom-layoutedgesizes-inlinestart">#dom-layoutedgesizes-inlinestart</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutedgesizes-inlinestart">3.6. Edges</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutedgesizes-inlineend">
        <b><a href="#dom-layoutedgesizes-inlineend">#dom-layoutedgesizes-inlineend</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutedgesizes-inlineend">3.6. Edges</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutedgesizes-blockstart">
        <b><a href="#dom-layoutedgesizes-blockstart">#dom-layoutedgesizes-blockstart</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutedgesizes-blockstart">3.6. Edges</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutedgesizes-blockend">
        <b><a href="#dom-layoutedgesizes-blockend">#dom-layoutedgesizes-blockend</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutedgesizes-blockend">3.6. Edges</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutedgesizes-inline">
        <b><a href="#dom-layoutedgesizes-inline">#dom-layoutedgesizes-inline</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutedgesizes-inline">3.6. Edges</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutedgesizes-block">
        <b><a href="#dom-layoutedgesizes-block">#dom-layoutedgesizes-block</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutedgesizes-block">3.6. Edges</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layoutedges">
        <b><a href="#layoutedges">#layoutedges</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layoutedges">3.6. Edges</a> <a href="#ref-for-layoutedges①">(2)</a> <a
                    href="#ref-for-layoutedges②">(3)</a> <a href="#ref-for-layoutedges③">(4)</a>
            <li><a href="#ref-for-layoutedges④">5.2. Layout Invalidation</a> <a href="#ref-for-layoutedges⑤">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutedges-border">
        <b><a href="#dom-layoutedges-border">#dom-layoutedges-border</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutedges-border">3.6. Edges</a> <a
                    href="#ref-for-dom-layoutedges-border①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutedges-scrollbar">
        <b><a href="#dom-layoutedges-scrollbar">#dom-layoutedges-scrollbar</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutedges-scrollbar">3.6. Edges</a> <a
                    href="#ref-for-dom-layoutedges-scrollbar①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutedges-padding">
        <b><a href="#dom-layoutedges-padding">#dom-layoutedges-padding</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutedges-padding">3.6. Edges</a> <a
                    href="#ref-for-dom-layoutedges-padding①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutedges-all">
        <b><a href="#dom-layoutedges-all">#dom-layoutedges-all</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutedges-all">3.6. Edges</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-definition">
        <b><a href="#layout-definition">#layout-definition</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layout-definition">5.4. Registering A Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-definition-class-constructor">
        <b><a href="#layout-definition-class-constructor">#layout-definition-class-constructor</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-layout-definition-class-constructor">5.4. Registering A Layout</a>
            <li><a href="#ref-for-layout-definition-class-constructor①">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-definition-layout-generator-function">
        <b><a
                href="#layout-definition-layout-generator-function">#layout-definition-layout-generator-function</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-layout-definition-layout-generator-function">5.4. Registering A Layout</a>
            <li><a href="#ref-for-layout-definition-layout-generator-function①">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-definition-intrinsic-sizes-generator-function">
        <b><a
                href="#layout-definition-intrinsic-sizes-generator-function">#layout-definition-intrinsic-sizes-generator-function</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-layout-definition-intrinsic-sizes-generator-function">5.4. Registering A Layout</a>
            <li><a href="#ref-for-layout-definition-intrinsic-sizes-generator-function①">5.6.1. Determining Intrinsic
                    Sizes</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-definition-constructor-valid-flag">
        <b><a
                href="#layout-definition-constructor-valid-flag">#layout-definition-constructor-valid-flag</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-layout-definition-constructor-valid-flag">5.4. Registering A Layout</a>
            <li><a href="#ref-for-layout-definition-constructor-valid-flag①">5.6.3. Utility Algorithms</a> <a
                    href="#ref-for-layout-definition-constructor-valid-flag②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-definition-input-properties">
        <b><a href="#layout-definition-input-properties">#layout-definition-input-properties</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-layout-definition-input-properties">5.4. Registering A Layout</a>
            <li><a href="#ref-for-layout-definition-input-properties①">5.6.1. Determining Intrinsic Sizes</a>
            <li><a href="#ref-for-layout-definition-input-properties②">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-definition-child-input-properties">
        <b><a
                href="#layout-definition-child-input-properties">#layout-definition-child-input-properties</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-layout-definition-child-input-properties">3.1.1. LayoutChildren and the Box Tree</a>
            <li><a href="#ref-for-layout-definition-child-input-properties①">5.4. Registering A Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-definition-layout-options">
        <b><a href="#layout-definition-layout-options">#layout-definition-layout-options</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layout-definition-layout-options">5.4. Registering A Layout</a>
            <li><a href="#ref-for-layout-definition-layout-options①">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="document-layout-definition">
        <b><a href="#document-layout-definition">#document-layout-definition</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-document-layout-definition">5.4. Registering A Layout</a>
            <li><a href="#ref-for-document-layout-definition①">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="document-layout-definition-input-properties">
        <b><a
                href="#document-layout-definition-input-properties">#document-layout-definition-input-properties</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-document-layout-definition-input-properties">5.2. Layout Invalidation</a>
            <li><a href="#ref-for-document-layout-definition-input-properties①">5.4. Registering A Layout</a> <a
                    href="#ref-for-document-layout-definition-input-properties②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="document-layout-definition-child-input-properties">
        <b><a
                href="#document-layout-definition-child-input-properties">#document-layout-definition-child-input-properties</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-document-layout-definition-child-input-properties">5.2. Layout Invalidation</a>
            <li><a href="#ref-for-document-layout-definition-child-input-properties①">5.4. Registering A Layout</a> <a
                    href="#ref-for-document-layout-definition-child-input-properties②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="document-layout-definition-layout-options">
        <b><a
                href="#document-layout-definition-layout-options">#document-layout-definition-layout-options</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-document-layout-definition-layout-options">2.2. Box Tree Transformations</a> <a
                    href="#ref-for-document-layout-definition-layout-options①">(2)</a> <a
                    href="#ref-for-document-layout-definition-layout-options②">(3)</a>
            <li><a href="#ref-for-document-layout-definition-layout-options③">3.5. Breaking and Fragmentation</a>
            <li><a href="#ref-for-document-layout-definition-layout-options④">4.1. Sizing</a> <a
                    href="#ref-for-document-layout-definition-layout-options⑤">(2)</a> <a
                    href="#ref-for-document-layout-definition-layout-options⑥">(3)</a>
            <li><a href="#ref-for-document-layout-definition-layout-options⑦">5.4. Registering A Layout</a> <a
                    href="#ref-for-document-layout-definition-layout-options⑧">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-valid-flag">
        <b><a href="#layout-valid-flag">#layout-valid-flag</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layout-valid-flag">5.2. Layout Invalidation</a> <a
                    href="#ref-for-layout-valid-flag①">(2)</a> <a href="#ref-for-layout-valid-flag②">(3)</a> <a
                    href="#ref-for-layout-valid-flag③">(4)</a> <a href="#ref-for-layout-valid-flag④">(5)</a>
            <li><a href="#ref-for-layout-valid-flag⑤">5.6.2. Generating Fragments</a> <a
                    href="#ref-for-layout-valid-flag⑥">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-valid">
        <b><a href="#layout-valid">#layout-valid</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layout-valid">5.6.2. Generating Fragments</a> <a href="#ref-for-layout-valid①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-invalid">
        <b><a href="#layout-invalid">#layout-invalid</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layout-invalid">5.2. Layout Invalidation</a> <a
                    href="#ref-for-layout-invalid①">(2)</a> <a href="#ref-for-layout-invalid②">(3)</a> <a
                    href="#ref-for-layout-invalid③">(4)</a> <a href="#ref-for-layout-invalid④">(5)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="intrinsic-sizes-valid-flag">
        <b><a href="#intrinsic-sizes-valid-flag">#intrinsic-sizes-valid-flag</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-intrinsic-sizes-valid-flag">5.2. Layout Invalidation</a> <a
                    href="#ref-for-intrinsic-sizes-valid-flag①">(2)</a> <a
                    href="#ref-for-intrinsic-sizes-valid-flag②">(3)</a> <a
                    href="#ref-for-intrinsic-sizes-valid-flag③">(4)</a> <a
                    href="#ref-for-intrinsic-sizes-valid-flag④">(5)</a>
            <li><a href="#ref-for-intrinsic-sizes-valid-flag⑤">5.6.1. Determining Intrinsic Sizes</a> <a
                    href="#ref-for-intrinsic-sizes-valid-flag⑥">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="intrinsic-sizes-valid">
        <b><a href="#intrinsic-sizes-valid">#intrinsic-sizes-valid</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-intrinsic-sizes-valid">5.6.1. Determining Intrinsic Sizes</a> <a
                    href="#ref-for-intrinsic-sizes-valid①">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="intrinsic-sizes-invalid">
        <b><a href="#intrinsic-sizes-invalid">#intrinsic-sizes-invalid</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-intrinsic-sizes-invalid">5.2. Layout Invalidation</a> <a
                    href="#ref-for-intrinsic-sizes-invalid①">(2)</a> <a href="#ref-for-intrinsic-sizes-invalid②">(3)</a>
                <a href="#ref-for-intrinsic-sizes-invalid③">(4)</a> <a href="#ref-for-intrinsic-sizes-invalid④">(5)</a>
                <a href="#ref-for-intrinsic-sizes-invalid⑤">(6)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="invalidate-layout-functions">
        <b><a href="#invalidate-layout-functions">#invalidate-layout-functions</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-invalidate-layout-functions">5.2. Layout Invalidation</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-css-layoutworklet">
        <b><a href="#dom-css-layoutworklet">#dom-css-layoutworklet</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-css-layoutworklet">5.3. Layout Worklet</a> <a
                    href="#ref-for-dom-css-layoutworklet①">(2)</a> <a href="#ref-for-dom-css-layoutworklet②">(3)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layoutworkletglobalscope">
        <b><a href="#layoutworkletglobalscope">#layoutworkletglobalscope</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layoutworkletglobalscope">3.1.1. LayoutChildren and the Box Tree</a> <a
                    href="#ref-for-layoutworkletglobalscope①">(2)</a>
            <li><a href="#ref-for-layoutworkletglobalscope②">5.1. Concepts</a>
            <li><a href="#ref-for-layoutworkletglobalscope③">5.3. Layout Worklet</a> <a
                    href="#ref-for-layoutworkletglobalscope④">(2)</a>
            <li><a href="#ref-for-layoutworkletglobalscope⑤">5.4. Registering A Layout</a> <a
                    href="#ref-for-layoutworkletglobalscope⑥">(2)</a>
            <li><a href="#ref-for-layoutworkletglobalscope⑦">5.6.1. Determining Intrinsic Sizes</a> <a
                    href="#ref-for-layoutworkletglobalscope⑧">(2)</a>
            <li><a href="#ref-for-layoutworkletglobalscope⑨">5.6.2. Generating Fragments</a> <a
                    href="#ref-for-layoutworkletglobalscope①⓪">(2)</a>
            <li><a href="#ref-for-layoutworkletglobalscope①①">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dictdef-layoutoptions">
        <b><a href="#dictdef-layoutoptions">#dictdef-layoutoptions</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dictdef-layoutoptions">5.1. Concepts</a> <a
                    href="#ref-for-dictdef-layoutoptions①">(2)</a>
            <li><a href="#ref-for-dictdef-layoutoptions②">5.4. Registering A Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutoptions-childdisplay">
        <b><a href="#dom-layoutoptions-childdisplay">#dom-layoutoptions-childdisplay</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutoptions-childdisplay">2.2. Box Tree Transformations</a> <a
                    href="#ref-for-dom-layoutoptions-childdisplay①">(2)</a> <a
                    href="#ref-for-dom-layoutoptions-childdisplay②">(3)</a>
            <li><a href="#ref-for-dom-layoutoptions-childdisplay③">3.5. Breaking and Fragmentation</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutoptions-sizing">
        <b><a href="#dom-layoutoptions-sizing">#dom-layoutoptions-sizing</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutoptions-sizing">4.1. Sizing</a> <a
                    href="#ref-for-dom-layoutoptions-sizing①">(2)</a> <a
                    href="#ref-for-dom-layoutoptions-sizing②">(3)</a>
            <li><a href="#ref-for-dom-layoutoptions-sizing③">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="enumdef-childdisplaytype">
        <b><a href="#enumdef-childdisplaytype">#enumdef-childdisplaytype</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-enumdef-childdisplaytype">5.4. Registering A Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="enumdef-layoutsizingmode">
        <b><a href="#enumdef-layoutsizingmode">#enumdef-layoutsizingmode</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-enumdef-layoutsizingmode">5.4. Registering A Layout</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="document-layout-definitions">
        <b><a href="#document-layout-definitions">#document-layout-definitions</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-document-layout-definitions">5.4. Registering A Layout</a>
            <li><a href="#ref-for-document-layout-definitions①">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-definitions">
        <b><a href="#layout-definitions">#layout-definitions</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layout-definitions">5.4. Registering A Layout</a>
            <li><a href="#ref-for-layout-definitions①">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layout-class-instances">
        <b><a href="#layout-class-instances">#layout-class-instances</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layout-class-instances">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutworkletglobalscope-registerlayout">
        <b><a
                href="#dom-layoutworkletglobalscope-registerlayout">#dom-layoutworkletglobalscope-registerlayout</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutworkletglobalscope-registerlayout">5.3. Layout Worklet</a>
            <li><a href="#ref-for-dom-layoutworkletglobalscope-registerlayout①">5.4. Registering A Layout</a> <a
                    href="#ref-for-dom-layoutworkletglobalscope-registerlayout②">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="intrinsicsizesrequest">
        <b><a href="#intrinsicsizesrequest">#intrinsicsizesrequest</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-intrinsicsizesrequest">3.1. Layout Children</a> <a
                    href="#ref-for-intrinsicsizesrequest①">(2)</a>
            <li><a href="#ref-for-intrinsicsizesrequest②">3.3. Intrinsic Sizes</a>
            <li><a href="#ref-for-intrinsicsizesrequest③">5.5.1. Request Objects</a> <a
                    href="#ref-for-intrinsicsizesrequest④">(2)</a>
            <li><a href="#ref-for-intrinsicsizesrequest⑤">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="layoutfragmentrequest">
        <b><a href="#layoutfragmentrequest">#layoutfragmentrequest</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-layoutfragmentrequest">3.1. Layout Children</a> <a
                    href="#ref-for-layoutfragmentrequest①">(2)</a>
            <li><a href="#ref-for-layoutfragmentrequest②">3.2. Layout Fragments</a>
            <li><a href="#ref-for-layoutfragmentrequest③">5.5.1. Request Objects</a> <a
                    href="#ref-for-layoutfragmentrequest④">(2)</a> <a href="#ref-for-layoutfragmentrequest⑤">(3)</a> <a
                    href="#ref-for-layoutfragmentrequest⑥">(4)</a>
            <li><a href="#ref-for-layoutfragmentrequest⑦">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="typedefdef-layoutfragmentrequestorintrinsicsizesrequest">
        <b><a
                href="#typedefdef-layoutfragmentrequestorintrinsicsizesrequest">#typedefdef-layoutfragmentrequestorintrinsicsizesrequest</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-typedefdef-layoutfragmentrequestorintrinsicsizesrequest">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-intrinsicsizesrequest-layoutchild-slot">
        <b><a
                href="#dom-intrinsicsizesrequest-layoutchild-slot">#dom-intrinsicsizesrequest-layoutchild-slot</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-intrinsicsizesrequest-layoutchild-slot">3.1. Layout Children</a>
            <li><a href="#ref-for-dom-intrinsicsizesrequest-layoutchild-slot①">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutfragmentrequest-layoutchild-slot">
        <b><a
                href="#dom-layoutfragmentrequest-layoutchild-slot">#dom-layoutfragmentrequest-layoutchild-slot</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutfragmentrequest-layoutchild-slot">3.1. Layout Children</a>
            <li><a href="#ref-for-dom-layoutfragmentrequest-layoutchild-slot①">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutfragmentrequest-layoutconstraints-slot">
        <b><a
                href="#dom-layoutfragmentrequest-layoutconstraints-slot">#dom-layoutfragmentrequest-layoutconstraints-slot</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutfragmentrequest-layoutconstraints-slot">3.1. Layout Children</a>
            <li><a href="#ref-for-dom-layoutfragmentrequest-layoutconstraints-slot①">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-layoutfragmentrequest-breaktoken-slot">
        <b><a
                href="#dom-layoutfragmentrequest-breaktoken-slot">#dom-layoutfragmentrequest-breaktoken-slot</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-layoutfragmentrequest-breaktoken-slot">3.1. Layout Children</a>
            <li><a href="#ref-for-dom-layoutfragmentrequest-breaktoken-slot①">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dictdef-fragmentresultoptions">
        <b><a href="#dictdef-fragmentresultoptions">#dictdef-fragmentresultoptions</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dictdef-fragmentresultoptions">3.2. Layout Fragments</a>
            <li><a href="#ref-for-dictdef-fragmentresultoptions①">3.5. Breaking and Fragmentation</a>
            <li><a href="#ref-for-dictdef-fragmentresultoptions②">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-fragmentresultoptions-inlinesize">
        <b><a href="#dom-fragmentresultoptions-inlinesize">#dom-fragmentresultoptions-inlinesize</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-fragmentresultoptions-inlinesize">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-fragmentresultoptions-blocksize">
        <b><a href="#dom-fragmentresultoptions-blocksize">#dom-fragmentresultoptions-blocksize</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-fragmentresultoptions-blocksize">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-fragmentresultoptions-autoblocksize">
        <b><a
                href="#dom-fragmentresultoptions-autoblocksize">#dom-fragmentresultoptions-autoblocksize</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-fragmentresultoptions-autoblocksize">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-fragmentresultoptions-childfragments">
        <b><a
                href="#dom-fragmentresultoptions-childfragments">#dom-fragmentresultoptions-childfragments</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-fragmentresultoptions-childfragments">2.1. Layout API Container Painting</a>
            <li><a href="#ref-for-dom-fragmentresultoptions-childfragments①">4.5. Alignment</a>
            <li><a href="#ref-for-dom-fragmentresultoptions-childfragments②">5.6.2. Generating Fragments</a> <a
                    href="#ref-for-dom-fragmentresultoptions-childfragments③">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-fragmentresultoptions-data">
        <b><a href="#dom-fragmentresultoptions-data">#dom-fragmentresultoptions-data</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-dom-fragmentresultoptions-data">3.2. Layout Fragments</a>
            <li><a href="#ref-for-dom-fragmentresultoptions-data①">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-fragmentresultoptions-breaktoken">
        <b><a href="#dom-fragmentresultoptions-breaktoken">#dom-fragmentresultoptions-breaktoken</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-fragmentresultoptions-breaktoken">3.5. Breaking and Fragmentation</a>
            <li><a href="#ref-for-dom-fragmentresultoptions-breaktoken①">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dictdef-intrinsicsizesresultoptions">
        <b><a href="#dictdef-intrinsicsizesresultoptions">#dictdef-intrinsicsizesresultoptions</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dictdef-intrinsicsizesresultoptions">5.6.1. Determining Intrinsic Sizes</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-intrinsicsizesresultoptions-maxcontentsize">
        <b><a
                href="#dom-intrinsicsizesresultoptions-maxcontentsize">#dom-intrinsicsizesresultoptions-maxcontentsize</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-intrinsicsizesresultoptions-maxcontentsize">5.6.1. Determining Intrinsic Sizes</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="dom-intrinsicsizesresultoptions-mincontentsize">
        <b><a
                href="#dom-intrinsicsizesresultoptions-mincontentsize">#dom-intrinsicsizesresultoptions-mincontentsize</a></b><b>Referenced
            in:</b>
        <ul>
            <li><a href="#ref-for-dom-intrinsicsizesresultoptions-mincontentsize">5.6.1. Determining Intrinsic Sizes</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="determine-the-intrinsic-sizes">
        <b><a href="#determine-the-intrinsic-sizes">#determine-the-intrinsic-sizes</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-determine-the-intrinsic-sizes">5.4. Registering A Layout</a>
            <li><a href="#ref-for-determine-the-intrinsic-sizes①">5.6.1. Determining Intrinsic Sizes</a> <a
                    href="#ref-for-determine-the-intrinsic-sizes②">(2)</a>
            <li><a href="#ref-for-determine-the-intrinsic-sizes③">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="invoke-a-intrinsic-sizes-callback">
        <b><a href="#invoke-a-intrinsic-sizes-callback">#invoke-a-intrinsic-sizes-callback</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-invoke-a-intrinsic-sizes-callback">5.6.1. Determining Intrinsic Sizes</a> <a
                    href="#ref-for-invoke-a-intrinsic-sizes-callback①">(2)</a>
            <li><a href="#ref-for-invoke-a-intrinsic-sizes-callback②">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="generate-a-fragment">
        <b><a href="#generate-a-fragment">#generate-a-fragment</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-generate-a-fragment">5.4. Registering A Layout</a>
            <li><a href="#ref-for-generate-a-fragment①">5.6.2. Generating Fragments</a> <a
                    href="#ref-for-generate-a-fragment②">(2)</a>
            <li><a href="#ref-for-generate-a-fragment③">5.6.3. Utility Algorithms</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="invoke-a-layout-callback">
        <b><a href="#invoke-a-layout-callback">#invoke-a-layout-callback</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-invoke-a-layout-callback">5.6.2. Generating Fragments</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="get-a-document-layout-definition">
        <b><a href="#get-a-document-layout-definition">#get-a-document-layout-definition</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-get-a-document-layout-definition">5.2. Layout Invalidation</a> <a
                    href="#ref-for-get-a-document-layout-definition①">(2)</a>
            <li><a href="#ref-for-get-a-document-layout-definition②">5.6.1. Determining Intrinsic Sizes</a> <a
                    href="#ref-for-get-a-document-layout-definition③">(2)</a>
            <li><a href="#ref-for-get-a-document-layout-definition④">5.6.2. Generating Fragments</a> <a
                    href="#ref-for-get-a-document-layout-definition⑤">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="get-a-layout-definition">
        <b><a href="#get-a-layout-definition">#get-a-layout-definition</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-get-a-layout-definition">3.1.1. LayoutChildren and the Box Tree</a> <a
                    href="#ref-for-get-a-layout-definition①">(2)</a>
            <li><a href="#ref-for-get-a-layout-definition②">5.6.1. Determining Intrinsic Sizes</a> <a
                    href="#ref-for-get-a-layout-definition③">(2)</a>
            <li><a href="#ref-for-get-a-layout-definition④">5.6.2. Generating Fragments</a> <a
                    href="#ref-for-get-a-layout-definition⑤">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="get-a-layout-class-instance">
        <b><a href="#get-a-layout-class-instance">#get-a-layout-class-instance</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-get-a-layout-class-instance">5.6.1. Determining Intrinsic Sizes</a> <a
                    href="#ref-for-get-a-layout-class-instance①">(2)</a>
            <li><a href="#ref-for-get-a-layout-class-instance②">5.6.2. Generating Fragments</a> <a
                    href="#ref-for-get-a-layout-class-instance③">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="run-a-generator">
        <b><a href="#run-a-generator">#run-a-generator</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-run-a-generator">5.6.1. Determining Intrinsic Sizes</a> <a
                    href="#ref-for-run-a-generator①">(2)</a>
            <li><a href="#ref-for-run-a-generator②">5.6.2. Generating Fragments</a> <a
                    href="#ref-for-run-a-generator③">(2)</a>
        </ul>
    </aside>
    <aside class="dfn-panel" data-for="produce-a-generator-result">
        <b><a href="#produce-a-generator-result">#produce-a-generator-result</a></b><b>Referenced in:</b>
        <ul>
            <li><a href="#ref-for-produce-a-generator-result">5.6.3. Utility Algorithms</a> <a
                    href="#ref-for-produce-a-generator-result①">(2)</a> <a
                    href="#ref-for-produce-a-generator-result②">(3)</a>
        </ul>
    </aside>
    <p role="navigation" id="back-to-top"><a href="#toc"><abbr title="Back to top">↑</abbr></a></p>
    <script>/* script-dfn-panel */

        document.body.addEventListener("click", function (e) {
            var queryAll = function (sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            var hitALink = false;
            while (el.parentElement) {
                if (el.tagName == "A") {
                    // Clicking on a link in a <dfn> shouldn't summon the panel
                    hitALink = true;
                }
                if (el.classList.contains("dfn-paneled")) {
                    target = "dfn";
                    break;
                }
                if (el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if (target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function (el) {
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if (target == "dfn" && !hitALink) {
                // open the panel
                var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
                if (dfnPanel) {
                    console.log(dfnPanel);
                    dfnPanel.classList.add("on");
                    var rect = el.getBoundingClientRect();
                    dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
                    dfnPanel.style.top = window.scrollY + rect.top + "px";
                    var panelRect = dfnPanel.getBoundingClientRect();
                    var panelWidth = panelRect.right - panelRect.left;
                    if (panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                        // Reposition, because the panel is overflowing
                        dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
                    }
                } else {
                    console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
                }
            } else if (target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
                el.style.left = null;
                el.style.top = null;
            }

        });
    </script>
    <script src="/dropdown.js"></script>