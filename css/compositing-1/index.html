<!doctype html>
<html lang="zh-hans">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>合成与混合 第1级</title>
    <meta content="CRD" name="w3c-status">
    <meta content="Bikeshed version d5d58a306, updated Fri Jan 26 16:12:28 2024 -0800" name="generator">
    <link href="https://www.w3.org/TR/compositing-1/" rel="canonical">
    <meta content="c2c067e8ed0ba59e04de166bb8cc81eecf6fca02" name="revision">
    <style>
        a[data-link-type=element]::before,
        span[data-link-type=element]::before {
            content: '<';
        }

        a[data-link-type=element]::after,
        span[data-link-type=element]::after {
            content: '>';
        }
    </style>
    <style>
        /* Boilerplate: style-autolinks */
        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: var(--a-normal-text);
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --selflink-text: black;
                --selflink-bg: silver;
                --selflink-hover-text: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-colors */
        /* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
        :root {
            color-scheme: light dark;

            --text: black;
            --bg: white;

            --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

            --logo-bg: #1a5e9a;
            --logo-active-bg: #c00;
            --logo-text: white;

            --tocnav-normal-text: #707070;
            --tocnav-normal-bg: var(--bg);
            --tocnav-hover-text: var(--tocnav-normal-text);
            --tocnav-hover-bg: #f8f8f8;
            --tocnav-active-text: #c00;
            --tocnav-active-bg: var(--tocnav-normal-bg);

            --tocsidebar-text: var(--text);
            --tocsidebar-bg: #f7f8f9;
            --tocsidebar-shadow: rgba(0, 0, 0, .1);
            --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

            --toclink-text: var(--text);
            --toclink-underline: #3980b5;
            --toclink-visited-text: var(--toclink-text);
            --toclink-visited-underline: #054572;

            --heading-text: #005a9c;

            --hr-text: var(--text);

            --algo-border: #def;

            --del-text: red;
            --del-bg: transparent;
            --ins-text: #080;
            --ins-bg: transparent;

            --a-normal-text: #034575;
            --a-normal-underline: #bbb;
            --a-visited-text: var(--a-normal-text);
            --a-visited-underline: #707070;
            --a-hover-bg: rgba(75%, 75%, 75%, .25);
            --a-active-text: #c00;
            --a-active-underline: #c00;

            --blockquote-border: silver;
            --blockquote-bg: transparent;
            --blockquote-text: currentcolor;

            --issue-border: #e05252;
            --issue-bg: #fbe9e9;
            --issue-text: var(--text);
            --issueheading-text: #831616;

            --example-border: #e0cb52;
            --example-bg: #fcfaee;
            --example-text: var(--text);
            --exampleheading-text: #574b0f;

            --note-border: #52e052;
            --note-bg: #e9fbe9;
            --note-text: var(--text);
            --noteheading-text: hsl(120, 70%, 30%);
            --notesummary-underline: silver;

            --assertion-border: #aaa;
            --assertion-bg: #eee;
            --assertion-text: black;

            --advisement-border: orange;
            --advisement-bg: #fec;
            --advisement-text: var(--text);
            --advisementheading-text: #b35f00;

            --warning-border: red;
            --warning-bg: hsla(40, 100%, 50%, 0.95);
            --warning-text: var(--text);

            --amendment-border: #330099;
            --amendment-bg: #F5F0FF;
            --amendment-text: var(--text);
            --amendmentheading-text: #220066;

            --def-border: #8ccbf2;
            --def-bg: #def;
            --def-text: var(--text);
            --defrow-border: #bbd7e9;

            --datacell-border: silver;

            --indexinfo-text: #707070;

            --indextable-hover-text: black;
            --indextable-hover-bg: #f7f8f9;

            --outdatedspec-bg: rgba(0, 0, 0, .5);
            --outdatedspec-text: black;
            --outdated-bg: maroon;
            --outdated-text: white;
            --outdated-shadow: red;

            --editedrec-bg: darkorange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --text: #ddd;
                --bg: black;

                --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

                --logo-bg: #1a5e9a;
                --logo-active-bg: #c00;
                --logo-text: white;

                --tocnav-normal-text: #999;
                --tocnav-normal-bg: var(--bg);
                --tocnav-hover-text: var(--tocnav-normal-text);
                --tocnav-hover-bg: #080808;
                --tocnav-active-text: #f44;
                --tocnav-active-bg: var(--tocnav-normal-bg);

                --tocsidebar-text: var(--text);
                --tocsidebar-bg: #080808;
                --tocsidebar-shadow: rgba(255, 255, 255, .1);
                --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

                --toclink-text: var(--text);
                --toclink-underline: #6af;
                --toclink-visited-text: var(--toclink-text);
                --toclink-visited-underline: #054572;

                --heading-text: #8af;

                --hr-text: var(--text);

                --algo-border: #456;

                --del-text: #f44;
                --del-bg: transparent;
                --ins-text: #4a4;
                --ins-bg: transparent;

                --a-normal-text: #6af;
                --a-normal-underline: #555;
                --a-visited-text: var(--a-normal-text);
                --a-visited-underline: var(--a-normal-underline);
                --a-hover-bg: rgba(25%, 25%, 25%, .2);
                --a-active-text: #f44;
                --a-active-underline: var(--a-active-text);

                --borderedblock-bg: rgba(255, 255, 255, .05);

                --blockquote-border: silver;
                --blockquote-bg: var(--borderedblock-bg);
                --blockquote-text: currentcolor;

                --issue-border: #e05252;
                --issue-bg: var(--borderedblock-bg);
                --issue-text: var(--text);
                --issueheading-text: hsl(0deg, 70%, 70%);

                --example-border: hsl(50deg, 90%, 60%);
                --example-bg: var(--borderedblock-bg);
                --example-text: var(--text);
                --exampleheading-text: hsl(50deg, 70%, 70%);

                --note-border: hsl(120deg, 100%, 35%);
                --note-bg: var(--borderedblock-bg);
                --note-text: var(--text);
                --noteheading-text: hsl(120, 70%, 70%);
                --notesummary-underline: silver;

                --assertion-border: #444;
                --assertion-bg: var(--borderedblock-bg);
                --assertion-text: var(--text);

                --advisement-border: orange;
                --advisement-bg: #222218;
                --advisement-text: var(--text);
                --advisementheading-text: #f84;

                --warning-border: red;
                --warning-bg: hsla(40, 100%, 20%, 0.95);
                --warning-text: var(--text);

                --amendment-border: #330099;
                --amendment-bg: #080010;
                --amendment-text: var(--text);
                --amendmentheading-text: #cc00ff;

                --def-border: #8ccbf2;
                --def-bg: #080818;
                --def-text: var(--text);
                --defrow-border: #136;

                --datacell-border: silver;

                --indexinfo-text: #aaa;

                --indextable-hover-text: var(--text);
                --indextable-hover-bg: #181818;

                --outdatedspec-bg: rgba(255, 255, 255, .5);
                --outdatedspec-text: black;
                --outdated-bg: maroon;
                --outdated-text: white;
                --outdated-shadow: red;

                --editedrec-bg: darkorange;
            }

            /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
            img {
                background: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-counters */
        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* Boilerplate: style-dfn-panel */
        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
            --dfnpanel-target-bg: #ffc;
            --dfnpanel-target-outline: orange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --dfnpanel-bg: #222;
                --dfnpanel-text: var(--text);
                --dfnpanel-target-bg: #333;
                --dfnpanel-target-outline: silver;
            }
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel a:focus {
            outline: 5px auto Highlight;
            outline: 5px auto -webkit-focus-ring-color;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0 0 0 1em;
            list-style: none;
        }

        .dfn-panel li a {
            max-width: calc(300px - 1.5em - 1em);
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: 8px;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
            transition: left 1s ease-out, bottom 1s ease-out;
        }

        .dfn-panel .link-item:hover {
            text-decoration: underline;
        }

        .dfn-panel .link-item .copy-icon {
            opacity: 0;
        }

        .dfn-panel .link-item:hover .copy-icon,
        .dfn-panel .link-item .copy-icon:focus {
            opacity: 1;
        }

        .dfn-panel .copy-icon {
            display: inline-block;
            margin-right: 0.5em;
            width: 0.85em;
            height: 1em;
            border-radius: 3px;
            background-color: #ccc;
            cursor: pointer;
        }

        .dfn-panel .copy-icon .icon {
            width: 100%;
            height: 100%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .dfn-panel .copy-icon .icon::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1px solid black;
            background-color: #ccc;
            opacity: 0.25;
            transform: translate(3px, -3px);
        }

        .dfn-panel .copy-icon:active .icon::before {
            opacity: 1;
        }

        .dfn-paneled[role="button"] {
            cursor: help;
        }

        .highlighted {
            animation: target-fade 3s;
        }

        @keyframes target-fade {
            from {
                background-color: var(--dfnpanel-target-bg);
                outline: 5px solid var(--dfnpanel-target-outline);
            }

            to {
                color: var(--a-normal-text);
                background-color: transparent;
                outline: transparent;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-issues */
        a[href].issue-return {
            float: right;
            float: inline-end;
            color: var(--issueheading-text);
            font-weight: bold;
            text-decoration: none;
        }
    </style>
    <style>
        /* Boilerplate: style-md-lists */
        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* Boilerplate: style-ref-hints */
        :root {
            --ref-hint-bg: #ddd;
            --ref-hint-text: var(--text);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --ref-hint-bg: #222;
                --ref-hint-text: var(--text);
            }
        }

        .ref-hint {
            display: inline-block;
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.5em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--ref-hint-bg);
            color: var(--ref-hint-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .ref-hint * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .ref-hint ul {
            padding: 0 0 0 1em;
            list-style: none;
        }
    </style>
    <style>
        /* Boilerplate: style-selflinks */
        :root {
            --selflink-text: white;
            --selflink-bg: gray;
            --selflink-hover-text: black;
        }

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        .example>a.self-link,
        .note>a.self-link,
        .issue>a.self-link {
            /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
            left: auto;
            right: 0;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: var(--selflink-bg);
            color: var(--selflink-text);
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: var(--selflink-hover-text);
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <style>
        /* Boilerplate: style-wpt */
        :root {
            --wpt-border: hsl(0, 0%, 60%);
            --wpt-bg: hsl(0, 0%, 95%);
            --wpt-text: var(--text);
            --wptheading-text: hsl(0, 0%, 30%);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --wpt-border: hsl(0, 0%, 30%);
                --wpt-bg: var(--borderedblock-bg);
                --wpt-text: var(--text);
                --wptheading-text: hsl(0, 0%, 60%);
            }
        }

        .wpt-tests-block {
            list-style: none;
            border-left: .5em solid var(--wpt-border);
            background: var(--wpt-bg);
            color: var(--wpt-text);
            margin: 1em auto;
            padding: .5em;
        }

        .wpt-tests-block summary {
            color: var(--wptheading-text);
            font-weight: normal;
            text-transform: uppercase;
        }

        .wpt-tests-block summary::marker {
            color: var(--wpt-border);
        }

        .wpt-tests-block summary:hover::marker {
            color: var(--wpt-text);
        }

        /*
   The only content  of a wpt test block in its closed state is the <summary>,
   which contains the word TESTS,
   and that is absolutely positioned.
   In that closed state, wpt test blocks are styled
   to have a top margin whose height is exactly equal
   to the height of the absolutely positioned <summary>,
   and no other background/padding/margin/border.
   The wpt test block elements will therefore allow the maring
   of the previous/next block elements
   to collapse through them;
   if this combined margin would be larger than its own top margin,
   it stays as is,
   and therefore the pre-existing vertical rhythm of the document is undisturbed.
   If that combined margin would be smaller, it is grown to that size.
   This means that the wpt test block ensures
   that there's always enough vertical space to insert the summary,
   without adding more than is needed.
*/
        .wpt-tests-block:not([open]) {
            padding: 0;
            border: none;
            background: none;
            font-size: 0.75em;
            line-height: 1;
            position: relative;
            margin: 1em 0 0;
        }

        .wpt-tests-block:not([open]) summary {
            position: absolute;
            right: 0;
            bottom: 0;
        }

        /*
   It is possible that both the last child of a block element
   and the block element itself
   would be annotated with a <wpt> block each.
   If the block element has a padding or a border,
   that's fine, but otherwise
   the bottom margin of the block and of its last child would collapse
   and both <wpt> elements would overlap, being both placed there.
   To avoid that, add 1px of padding to the <wpt> element annotating the last child
   to prevent the bottom margin of the block and of its last child from collapsing
   (and as much negative margin,
   as wel only want to prevent margin collapsing,
   but are not trying to actually take more space).
*/
        .wpt-tests-block:not([open]):last-child {
            padding-bottom: 1px;
            margin-bottom: -1px;
        }

        /*
   Exception to the previous rule:
   don't do that in non-last list items,
   because it's not necessary,
   and would therefore consume more space than strictly needed.
   Lists must have list items as children, not <wpt> elements,
   so a <wpt> element cannot be a sibling of a list item,
   and the collision that the previous rule avoids cannot happen.
*/
        li:not(:last-child)>.wpt-tests-block:not([open]):last-child,
        dd:not(:last-child)>.wpt-tests-block:not([open]):last-child {
            padding-bottom: 0;
            margin-bottom: 0;
        }

        .wpt-tests-block:not([open]):not(:hover) {
            opacity: 0.5;
        }

        .wpt-tests-list {
            list-style: none;
            display: grid;
            margin: 0;
            padding: 0;
            grid-template-columns: 1fr max-content auto auto;
            grid-column-gap: .5em;
        }

        .wpt-tests-block hr:last-child {
            display: none;
        }

        .wpt-test {
            display: contents;
        }

        .wpt-test>a {
            text-decoration: underline;
            border: none;
        }

        .wpt-test>.wpt-name {
            grid-column: 1;
        }

        .wpt-test>.wpt-results {
            grid-column: 2;
        }

        .wpt-test>.wpt-live {
            grid-column: 3;
        }

        .wpt-test>.wpt-source {
            grid-column: 4;
        }

        .wpt-test>.wpt-results {
            display: flex;
            gap: .1em;
        }

        .wpt-test .wpt-result {
            display: inline-block;
            height: 1em;
            width: 1em;
            border-radius: 50%;
            position: relative;
        }
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-CRD" rel="stylesheet">

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
        <h1>合成与混合 第1级</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types#CRD">W3C 候选推荐草案</a>, <time class="dt-updated"
                datetime="2024-03-21">2024年3月21日</time></p>
        <details open>
            <summary>关于本文档的更多详情</summary>
            <div data-fill-with="spec-metadata">
                <dl>
                    <dt>此版本:
                    <dd><a class="u-url"
                            href="https://www.w3.org/TR/2024/CRD-compositing-1-20240321/">https://www.w3.org/TR/2024/CRD-compositing-1-20240321/</a>
                    <dt>最新发布版本:
                    <dd><a href="https://www.w3.org/TR/compositing-1/">https://www.w3.org/TR/compositing-1/</a>
                    <dt>编辑草案:
                    <dd><a href="https://drafts.fxtf.org/compositing-1/">https://drafts.fxtf.org/compositing-1/</a>
                    <dt>以前版本:
                    <dd><a href="https://www.w3.org/TR/2015/CR-compositing-1-20150113/"
                            rel="prev">https://www.w3.org/TR/2015/CR-compositing-1-20150113/</a>
                    <dt>历史记录:
                    <dd><a class="u-url"
                            href="https://www.w3.org/standards/history/compositing-1/">https://www.w3.org/standards/history/compositing-1/</a>
                    <dt>实现报告:
                    <dd><a href="https://wpt.fyi/results/css/compositing">https://wpt.fyi/results/css/compositing</a>
                    <dt>反馈:
                    <dd><a href="https://github.com/w3c/csswg-drafts/labels/compositing-1">CSSWG 问题库</a>
                    <dd><a href="https://github.com/w3c/fxtf-drafts/labels/compositing-1">GitHub</a>
                    <dd>https://github.com/w3c/fxtf-drafts/labels/compositing-1
                    <dt class="editor">编辑:
                    <dd class="editor p-author h-card vcard" data-editor-id="90243"><a class="p-name fn u-email email"
                            href="mailto:chrishtr@chromium.org">Chris Harrelson</a> (<span
                            class="p-org org">Google</span>)
                    <dt class="editor">前编辑:
                    <dd class="editor p-author h-card vcard" data-editor-id="106988"><span class="p-name fn">Rik
                            Cabanier</span> (<span class="p-org org">时为 Adobe Systems Inc.</span>)
                    <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email"
                            href="mailto:Nikos.Andronikos@cisra.canon.com.au">Nikos Andronikos</a> (<span
                            class="p-org org">佳能信息系统研究澳大利亚</span>)
                        <!-- <dt>建议编辑此规范:
      <dd><a href="https://github.com/w3c/csswg-drafts/blob/main/compositing-1/Overview.bs">GitHub 编辑器</a> -->
                    <dt>测试套件:
                    <dd class="wpt-overview"><a
                            href="https://wpt.fyi/results/css/compositing/">https://wpt.fyi/results/css/compositing/</a>
                </dl>
            </div>
        </details>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">版权</a> ©
            2024 <a href="https://www.w3.org/">万维网联盟</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup>
            <a href="https://www.w3.org/policies/#Legal_Disclaimer">法律免责声明</a>, <a
                href="https://www.w3.org/policies/#W3C_Trademarks">商标</a> 和 <a
                href="https://www.w3.org/copyright/software-license/" rel="license" title="W3C 软件和文档许可">宽松文档许可</a> 规则适用。
        </p>
        <hr title="标题分隔符">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">摘要</span></h2>
        <p>合成描述了如何将不同元素的形状组合成单个图像。对于合成有多种可能的方法。以前版本的 SVG 和 CSS 使用了<a
                href="https://www.w3.org/TR/SVG11/masking.html#SimpleAlphaBlending">简单 Alpha
                合成</a>。在这种模型中，每个元素都会渲染到自己的缓冲区中，然后使用 Porter Duff <span class="css">source-over</span> 操作符与其<a
                data-link-type="dfn" href="#backdrop" id="ref-for-backdrop">背景</a>合并。此规范将定义一个新的合成模型，基于简单 Alpha
            合成模型扩展，提供以下功能：</p>
        <ul>
            <li>额外的 Porter Duff 合成操作符
            <li>高级混合模式，允许控制形状重叠区域的颜色如何混合
            <li>合成组
        </ul>
        此外，本规范将定义用于混合和组隔离的 CSS 属性，以及 <code
            class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/canvas.html#dom-context-2d-globalcompositeoperation" id="ref-for-dom-context-2d-globalcompositeoperation">globalCompositeOperation</a></code>
        属性的特性。<a href="https://www.w3.org/TR/CSS/">CSS</a> 是一种用于描述结构化文档
        (如 HTML 和 XML) 在屏幕、纸张等上的渲染语言。
    </div>
    <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">本文档的状态</span></h2>
    <div data-fill-with="status">
        <p><em>本节描述了本文档在发布时的状态。
                当前 W3C 发布物的列表和该技术报告的最新修订版可在 <a href="https://www.w3.org/TR/">W3C 技术报告索引 https://www.w3.org/TR/</a>
                找到。</em> </p>
        <p> 本文档由 <a href="https://www.w3.org/groups/wg/css">CSS 工作组</a> 作为<strong>候选推荐草案</strong>发布，采用 <a
                href="https://www.w3.org/2023/Process-20231103/#recs-and-notes">推荐路径</a>。
            发布为候选推荐不表示 <abbr title="World Wide Web Consortium">W3C</abbr> 及其成员的认可。
            候选推荐草案整合了工作组打算包含在后续候选推荐快照中的前一个候选推荐的变更。</p>
        <p> 这是一个草案文档，可能随时更新、替换或被其他文档废弃。
            除非作为正在进行的工作，否则引用此文档是不合适的。</p>
        <p>请通过<a href="https://github.com/w3c/csswg-drafts/issues">在 GitHub
                上提交问题</a>（首选）反馈意见，并在标题中包括规范代码“compositing”，例如：
            “[compositing] <i>…评论摘要…</i>”。
            所有问题和评论均<a href="https://lists.w3.org/Archives/Public/public-css-archive/">归档</a>。
            另外，反馈也可以发送到(<a href="https://lists.w3.org/Archives/Public/www-style/">归档</a>)公共邮件列表 <a
                href="mailto:www-style@w3.org?Subject=%5Bcompositing%5D%20PUT%20SUBJECT%20HERE">www-style@w3.org</a>。
        </p>
        <p>本文档受 <a href="https://www.w3.org/2023/Process-20231103/" id="w3c_process_revision">2023年11月03日 W3C 进程文档</a>
            管辖。 </p>
        <p>本文档由根据 <a href="https://www.w3.org/Consortium/Patent-Policy-20200915/">W3C 专利政策</a> 运营的小组制作。
            W3C 维护了<a href="https://www.w3.org/groups/wg/css/ipr" rel="disclosure">与该小组交付物相关的任何专利披露的公共列表</a>；
            该页面还包含披露专利的说明。
            个人如果实际知道某项专利，并认为该专利包含<a
                href="https://www.w3.org/Consortium/Patent-Policy-20200915/#def-essential">基本权利要求</a>，必须按照<a
                href="https://www.w3.org/Consortium/Patent-Policy-20200915/#sec-Disclosure">W3C 专利政策第6节</a>披露信息。 </p>
        <p></p>
    </div>
    <div data-fill-with="at-risk"></div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目录</h2>
        <ol class="toc" role="directory">
            <li><a href="#introduction"><span class="secno">1</span> <span class="content">简介</span></a>
            <li>
                <a href="#reading-this-document"><span class="secno">2</span> <span class="content">阅读本文档</span></a>
                <ol class="toc">
                    <li><a href="#module-interactions"><span class="secno">2.1</span> <span
                                class="content">模块交互</span></a>
                    <li><a href="#values"><span class="secno">2.2</span> <span class="content">值</span></a>
                </ol>
            <li>
                <a href="#csscompositingandblending"><span class="secno">3</span> <span class="content">在 CSS
                        中指定混合</span></a>
                <ol class="toc">
                    <li><a href="#compositingandblendingorder"><span class="secno">3.1</span> <span
                                class="content">图形操作顺序</span></a>
                    <li><a href="#csscompositingrules_CSS"><span class="secno">3.2</span> <span class="content">HTML
                                特定行为</span></a>
                    <li><a href="#csscompositingrules_SVG"><span class="secno">3.3</span> <span class="content">SVG
                                特定行为</span></a>
                    <li>
                        <a href="#csskeywords"><span class="secno">3.4</span> <span class="content">CSS 属性</span></a>
                        <ol class="toc">
                            <li><a href="#mix-blend-mode"><span class="secno">3.4.1</span> <span class="content"> <span
                                            class="property">mix-blend-mode</span> 属性</span></a>
                            <li><a href="#isolation"><span class="secno">3.4.2</span> <span class="content"> <span
                                            class="property">isolation</span> 属性</span></a>
                            <li><a href="#background-blend-mode"><span class="secno">3.4.3</span> <span class="content">
                                        <span class="property">background-blend-mode</span> 属性</span></a>
                        </ol>
                </ol>
            <li><a href="#canvascompositingandblending"><span class="secno">4</span> <span class="content">在 Canvas 2D
                        中指定合成和混合</span></a>
            <li>
                <a href="#whatiscompositing"><span class="secno">5</span> <span class="content">合成简介</span></a>
                <ol class="toc">
                    <li>
                        <a href="#simplealphacompositing"><span class="secno">5.1</span> <span class="content">简单 alpha
                                合成</span></a>
                        <ol class="toc">
                            <li><a href="#simplealphacompositingexamples"><span class="secno">5.1.1</span> <span
                                        class="content">简单 alpha 合成示例</span></a>
                        </ol>
                </ol>
            <li><a href="#generalformula"><span class="secno">6</span> <span class="content">合成和混合的通用公式</span></a>
            <li>
                <a href="#backdropCalc"><span class="secno">7</span> <span class="content">背景计算</span></a>
                <ol class="toc">
                    <li><a href="#backdropexamples"><span class="secno">7.1</span> <span
                                class="content">背景计算示例</span></a>
                </ol>
            <li>
                <a href="#groups"><span class="secno">8</span> <span class="content">合成组</span></a>
                <ol class="toc">
                    <li><a href="#groupinvariance"><span class="secno">8.1</span> <span class="content">组不变性</span></a>
                    <li><a href="#isolatedgroups"><span class="secno">8.2</span> <span class="content">隔离组</span></a>
                    <li><a href="#pagebackdrop"><span class="secno">8.3</span> <span class="content">根元素组</span></a>
                    <li><a href="#rootgroup"><span class="secno">8.4</span> <span class="content">根组</span></a>
                </ol>
            <li>
                <a href="#advancedcompositing"><span class="secno">9</span> <span class="content">高级合成功能</span></a>
                <ol class="toc">
                    <li>
                        <a href="#porterduffcompositingoperators"><span class="secno">9.1</span> <span
                                class="content">Porter Duff 合成操作符</span></a>
                        <ol class="toc">
                            <li><a href="#porterduffcompositingoperators_clear"><span class="secno">9.1.1</span> <span
                                        class="content">清除</span></a>
                            <li><a href="#porterduffcompositingoperators_src"><span class="secno">9.1.2</span> <span
                                        class="content">复制</span></a>
                            <li><a href="#porterduffcompositingoperators_dst"><span class="secno">9.1.3</span> <span
                                        class="content">目标</span></a>
                            <li><a href="#porterduffcompositingoperators_srcover"><span class="secno">9.1.4</span> <span
                                        class="content">源覆盖</span></a>
                            <li><a href="#porterduffcompositingoperators_dstover"><span class="secno">9.1.5</span> <span
                                        class="content">目标覆盖</span></a>
                            <li><a href="#porterduffcompositingoperators_srcin"><span class="secno">9.1.6</span> <span
                                        class="content">源内</span></a>
                            <li><a href="#porterduffcompositingoperators_dstin"><span class="secno">9.1.7</span> <span
                                        class="content">目标内</span></a>
                            <li><a href="#porterduffcompositingoperators_srcout"><span class="secno">9.1.8</span> <span
                                        class="content">源外</span></a>
                            <li><a href="#porterduffcompositingoperators_dstout"><span class="secno">9.1.9</span> <span
                                        class="content">目标外</span></a>
                            <li><a href="#porterduffcompositingoperators_srcatop"><span class="secno">9.1.10</span>
                                    <span class="content">源顶置</span></a>
                            <li><a href="#porterduffcompositingoperators_dstatop"><span class="secno">9.1.11</span>
                                    <span class="content">目标顶置</span></a>
                            <li><a href="#porterduffcompositingoperators_xor"><span class="secno">9.1.12</span> <span
                                        class="content">异或</span></a>
                            <li><a href="#porterduffcompositingoperators_plus"><span class="secno">9.1.13</span> <span
                                        class="content">更亮</span></a>
                        </ol>
                    <li><a href="#groupcompositing"><span class="secno">9.2</span> <span class="content">组合群组行为与Porter
                                Duff模式</span></a>
                </ol>
            <li>
                <a href="#blending"><span class="secno">10</span> <span class="content">混合</span></a>
                <ol class="toc">
                    <li>
                        <a href="#blendingseparable"><span class="secno">10.1</span> <span
                                class="content">可分离混合模式</span></a>
                        <ol class="toc">
                            <li><a href="#blendingnormal"><span class="secno">10.1.1</span> <span
                                        class="content"><span>正常</span> 混合模式</span></a>
                            <li><a href="#blendingmultiply"><span class="secno">10.1.2</span> <span
                                        class="content"><span>正片叠底</span> 混合模式</span></a>
                            <li><a href="#blendingscreen"><span class="secno">10.1.3</span> <span
                                        class="content"><span>滤色</span> 混合模式</span></a>
                            <li><a href="#blendingoverlay"><span class="secno">10.1.4</span> <span
                                        class="content"><span>叠加</span> 混合模式</span></a>
                            <li><a href="#blendingdarken"><span class="secno">10.1.5</span> <span
                                        class="content"><span>变暗</span> 混合模式</span></a>
                            <li><a href="#blendinglighten"><span class="secno">10.1.6</span> <span
                                        class="content"><span>变亮</span> 混合模式</span></a>
                            <li><a href="#blendingcolordodge"><span class="secno">10.1.7</span> <span
                                        class="content"><span>颜色减淡</span> 混合模式</span></a>
                            <li><a href="#blendingcolorburn"><span class="secno">10.1.8</span> <span
                                        class="content"><span>颜色加深</span> 混合模式</span></a>
                            <li><a href="#blendinghardlight"><span class="secno">10.1.9</span> <span
                                        class="content"><span>硬光</span> 混合模式</span></a>
                            <li><a href="#blendingsoftlight"><span class="secno">10.1.10</span> <span
                                        class="content"><span>柔光</span> 混合模式</span></a>
                            <li><a href="#blendingdifference"><span class="secno">10.1.11</span> <span
                                        class="content"><span>差值</span> 混合模式</span></a>
                            <li><a href="#blendingexclusion"><span class="secno">10.1.12</span> <span
                                        class="content"><span>排除</span> 混合模式</span></a>
                        </ol>
                    <li>
                        <a href="#blendingnonseparable"><span class="secno">10.2</span> <span
                                class="content">不可分离混合模式</span></a>
                        <ol class="toc">
                            <li><a href="#blendinghue"><span class="secno">10.2.1</span> <span
                                        class="content"><span>色相</span> 混合模式</span></a>
                            <li><a href="#blendingsaturation"><span class="secno">10.2.2</span> <span
                                        class="content"><span>饱和度</span> 混合模式</span></a>
                            <li><a href="#blendingcolor"><span class="secno">10.2.3</span> <span
                                        class="content"><span>颜色</span> 混合模式</span></a>
                            <li><a href="#blendingluminosity"><span class="secno">10.2.4</span> <span
                                        class="content"><span>亮度</span> 混合模式</span></a>
                        </ol>
                    <li><a href="#isolationblending"><span class="secno">10.3</span> <span
                                class="content">隔离组对混合的影响</span></a>
                </ol>
            <li><a href="#privacy"><span class="secno"></span> <span class="content"> 隐私注意事项</span></a>
            <li><a href="#security"><span class="secno"></span> <span class="content"> 安全注意事项</span></a>
            <li><a href="#changes"><span class="secno"></span> <span class="content">更改</span></a>
            <li>
                <a href="#w3c-conformance"><span class="secno"></span> <span class="content"> 符合性</span></a>
                <ol class="toc">
                    <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content"> 文档约定</span></a>
                    <li><a href="#w3c-conformance-classes"><span class="secno"></span> <span class="content">
                                符合性类别</span></a>
                    <li>
                        <a href="#w3c-partial"><span class="secno"></span> <span class="content"> 部分实现</span></a>
                        <ol class="toc">
                            <li><a href="#w3c-conform-future-proofing"><span class="secno"></span> <span
                                        class="content"> 不稳定和专有功能的实现</span></a>
                        </ol>
                    <li><a href="#w3c-testing"><span class="secno"></span> <span class="content"> 非实验性实现</span></a>
                    <li><a href="#w3c-cr-exit-criteria"><span class="secno"></span> <span class="content"> CR
                                退出标准</span></a>
                </ol>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本规范定义的术语</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">由引用定义的术语</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考文献</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">规范性参考文献</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">参考性参考文献</span></a>
                </ol>
            <li><a href="#property-index"><span class="secno"></span> <span class="content">属性索引</span></a>
        </ol>
    </nav>
    <main>
        <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span
                class="content">简介</span><a class="self-link" href="#introduction"></a></h2>
        <p><em>本小节为非规范性内容。</em><br> 本文档的第一部分描述了用于控制 CSS 中合成的属性。
            第二部分将描述 Porter Duff 合成和混合的算法。</p>
        <h2 class="heading settled" data-level="2" id="reading-this-document"><span class="secno">2. </span><span
                class="content">阅读本文档</span><a class="self-link" href="#reading-this-document"></a></h2>
        <p>除非另有说明，否则本文档的每个部分都是规范性的。</p>
        <h3 class="heading settled" data-level="2.1" id="module-interactions"><span class="secno">2.1. </span><span
                class="content">模块交互</span><a class="self-link" href="#module-interactions"></a></h3>
        <p>本规范定义了一组 CSS 属性，这些属性影响应用这些属性的元素的视觉渲染；这些效果在元素根据 <a href="https://www.w3.org/TR/CSS2/visuren.html"
                title="视觉格式化模型">视觉格式化模型</a>从 <a data-link-type="biblio" href="#biblio-css21"
                title="层叠样式表第2版修订版 (CSS 2.1) 规范">[CSS21]</a> 中定位和大小调整后应用。其中某些属性的值会导致创建<a
                href="https://www.w3.org/TR/CSS2/visuren.html#containing-block" title="视觉格式化模型">包含块</a>，或创建<a
                href="https://www.w3.org/tr/css21/visuren.html#x43">层叠上下文</a>。</p>
        <p><a class="property css" data-link-type="property" href="#propdef-background-blend-mode"
                id="ref-for-propdef-background-blend-mode">background-blend-mode</a> 属性还基于 <a
                href="https://www.w3.org/TR/css3-background/#placement" title="背景与边框">CSS 背景与边框</a>模块中的属性<a
                data-link-type="biblio" href="#biblio-css3bg" title="CSS 背景与边框模块第3级">[CSS3BG]</a>进行扩展。</p>
        <p>本规范还增强了 <a href="https://www.w3.org/TR/2003/REC-SVG11-20030114/masking.html#SimpleAlphaBlending"
                title="简单 alpha 合成">第 14.2 节 简单 alpha 合成</a> 中的规则，来自 <a data-link-type="biblio" href="#biblio-svg11"
                title="可缩放矢量图形 (SVG) 1.1 (第二版)">[SVG11]</a> 和 <a href="https://www.w3.org/TR/css-color-4/#alpha"
                title="简单 alpha 合成">简单 alpha 合成</a>，来自 <a data-link-type="biblio" href="#biblio-css-color-4"
                title="CSS 颜色模块第4级">[CSS-COLOR-4]</a>。</p>
        <p>本模块还扩展了 <code
                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/canvas.html#dom-context-2d-globalcompositeoperation" id="ref-for-dom-context-2d-globalcompositeoperation①">globalCompositeOperation</a></code>
            属性。</p>
        <h3 class="heading settled" data-level="2.2" id="values"><span class="secno">2.2. </span><span
                class="content">值</span><a class="self-link" href="#values"></a></h3>
        <p>本规范遵循 <a href="https://www.w3.org/TR/CSS21/about.html#property-defs">CSS 属性定义约定</a>，来自 <a
                data-link-type="biblio" href="#biblio-css21" title="层叠样式表第2版修订版 (CSS 2.1) 规范">[CSS21]</a>。本规范中未定义的值类型在
            CSS 第 2 版修订版 <span title="层叠样式表第2版修订版 (CSS 2.1) 规范">[CSS21]</span> 中定义。其他 CSS
            模块可能会扩展这些值类型的定义：例如，当与本模块结合使用时，<a data-link-type="biblio" href="#biblio-css-color-4"
                title="CSS 颜色模块第4级">[CSS-COLOR-4]</a> 扩展了本规范中使用的 &lt;color> 值类型的定义。</p>
        <p>除定义中列出的特定于属性的值外，
            本规范中定义的所有属性也接受 <a href="https://www.w3.org/TR/CSS21/cascade.html#value-def-inherit">inherit</a>
            关键字作为其属性值。为了可读性，未显式重复该值。</p>
        <h2 class="heading settled" data-level="3" id="csscompositingandblending"><span class="secno">3. </span><span
                class="content">在 CSS 中指定混合</span><a class="self-link" href="#csscompositingandblending"></a></h2>
        <h3 class="heading settled" data-level="3.1" id="compositingandblendingorder"><span class="secno">3.1.
            </span><span class="content">图形操作顺序</span><a class="self-link" href="#compositingandblendingorder"></a></h3>
        <p>合成模型必须遵循 <a href="https://www.w3.org/TR/SVG11/render.html#Introduction">SVG 合成</a> 模型 <a
                data-link-type="biblio" href="#biblio-svg11"
                title="可缩放矢量图形 (SVG) 1.1 (第二版)">[SVG11]</a>：首先应用任何滤镜效果，然后进行剪裁、遮罩、混合和合成。</p>
        <h3 class="heading settled" data-level="3.2" id="csscompositingrules_CSS"><span class="secno">3.2. </span><span
                class="content">HTML 特定行为</span><a class="self-link" href="#csscompositingrules_CSS"></a></h3>
        <p>CSS 中创建<a href="https://www.w3.org/TR/CSS21/zindex.html">层叠上下文</a>的所有内容必须视为<a
                href="#isolatedgroups">“隔离”组</a>。HTML 元素本身不应创建组。</p>
        <p>应用混合的元素，必须与该元素所属的<a href="https://www.w3.org/tr/css21/visuren.html#x43">层叠上下文</a> <a data-link-type="biblio"
                href="#biblio-css21" title="层叠样式表第2版修订版 (CSS 2.1) 规范">[CSS21]</a>中的所有底层内容进行混合。</p>
        <p>HTML 文档的根元素是<a href="https://dom.spec.whatwg.org/#document-element">文档元素</a>。</p>
        <h3 class="heading settled" data-level="3.3" id="csscompositingrules_SVG"><span class="secno">3.3. </span><span
                class="content">SVG 特定行为</span><a class="self-link" href="#csscompositingrules_SVG"></a>
        </h3>
        <p>默认情况下，每个元素都必须创建一个<a href="#isolatedgroups">非隔离组</a>。</p>
        <p>但是，SVG 中的某些操作会创建<a href="#isolatedgroups">隔离组</a>。如果使用以下功能之一，组必须变为隔离的：</p>
        <ul>
            <li>不透明度
            <li>滤镜
            <li>3D 变换（2D 变换不得导致隔离）
            <li>混合
            <li>遮罩
        </ul>
        <p>SVG 的根元素是<a href="https://www.w3.org/TR/SVG11/struct.html#NewDocument">SVG 元素</a>。</p>
        <h3 class="heading settled" data-level="3.4" id="csskeywords"><span class="secno">3.4. </span><span
                class="content">CSS 属性</span><a class="self-link" href="#csskeywords"></a></h3>
        <h4 class="heading settled" data-level="3.4.1" id="mix-blend-mode"><span class="secno">3.4.1. </span><span
                class="content"><a class="property css" data-link-type="property" href="#propdef-mix-blend-mode"
                    id="ref-for-propdef-mix-blend-mode">mix-blend-mode</a> 属性</span><a class="self-link"
                href="#mix-blend-mode"></a></h4>
        <p>混合模式定义了必须用于将颜色与背景混合的公式。
            此行为在<a href="#blending">混合</a>中有更详细的描述。</p>
        <table class="def propdef" data-link-for-hint="mix-blend-mode">
            <tbody>
                <tr>
                    <th>名称：
                    <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export
                            id="propdef-mix-blend-mode">mix-blend-mode</dfn>
                <tr class="value">
                    <th><a href="https://www.w3.org/TR/css-values/#value-defs">值：</a>
                    <td class="prod"><a class="production css" data-link-type="type" href="#ltblendmodegt"
                            id="ref-for-ltblendmodegt">&lt;blend-mode></a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">初始值：</a>
                    <td>normal
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">应用于：</a>
                    <td>所有元素。在 SVG 中，它适用于<a
                            href="https://www.w3.org/TR/SVG11/intro.html#TermContainerElement">容器元素</a>、<a
                            href="https://www.w3.org/TR/SVG11/intro.html#TermGraphicsElement">图形元素</a>和
                        <a
                            href="https://www.w3.org/TR/2011/REC-SVG11-20110816/intro.html#TermGraphicsReferencingElement">图形引用元素</a>。<a
                            data-link-type="biblio" href="#biblio-svg11" title="可缩放矢量图形 (SVG) 1.1 (第二版)">[SVG11]</a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">继承：</a>
                    <td>否
                <tr>
                    <th><a href="https://www.w3.org/TR/css-values/#percentages">百分比：</a>
                    <td>N/A
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#computed">计算值：</a>
                    <td>按指定
                <tr>
                    <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">规范顺序：</a>
                    <td>按语法
                <tr>
                    <th><a href="https://www.w3.org/TR/web-animations/#animation-type">动画类型：</a>
                    <td>离散
                <tr>
                    <th>媒体：
                    <td>视觉
        </table>
        <p>属性 <a class="production css" data-link-type="type" href="#ltblendmodegt"
                id="ref-for-ltblendmodegt①">&lt;blend-mode></a> 的语法如下：</p>
        <pre class="blendmode prod"><dfn class="dfn-paneled" data-dfn-type="type" data-export id="ltblendmodegt">&lt;blend-mode></dfn> =
  <a data-link-type="value" href="#valdef-blend-mode-normal" id="ref-for-valdef-blend-mode-normal">normal</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one">|</a>
  <a data-link-type="value" href="#valdef-blend-mode-darken" id="ref-for-valdef-blend-mode-darken">darken</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①">|</a> <a data-link-type="value" href="#valdef-blend-mode-multiply" id="ref-for-valdef-blend-mode-multiply">multiply</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②">|</a> <a data-link-type="value" href="#valdef-blend-mode-color-burn" id="ref-for-valdef-blend-mode-color-burn">color-burn</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③">|</a>
  <a data-link-type="value" href="#valdef-blend-mode-lighten" id="ref-for-valdef-blend-mode-lighten">lighten</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one④">|</a> <a data-link-type="value" href="#valdef-blend-mode-screen" id="ref-for-valdef-blend-mode-screen">screen</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑤">|</a> <a data-link-type="value" href="#valdef-blend-mode-color-dodge" id="ref-for-valdef-blend-mode-color-dodge">color-dodge</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑥">|</a>
  <a data-link-type="value" href="#valdef-blend-mode-overlay" id="ref-for-valdef-blend-mode-overlay">overlay</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑦">|</a> <a data-link-type="value" href="#valdef-blend-mode-soft-light" id="ref-for-valdef-blend-mode-soft-light">soft-light</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑧">|</a> <a data-link-type="value" href="#valdef-blend-mode-hard-light" id="ref-for-valdef-blend-mode-hard-light">hard-light</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑨">|</a>
  <a data-link-type="value" href="#valdef-blend-mode-difference" id="ref-for-valdef-blend-mode-difference">difference</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⓪">|</a> <a data-link-type="value" href="#valdef-blend-mode-exclusion" id="ref-for-valdef-blend-mode-exclusion">exclusion</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①①">|</a>
  <a data-link-type="value" href="#valdef-blend-mode-hue" id="ref-for-valdef-blend-mode-hue">hue</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①②">|</a> <a data-link-type="value" href="#valdef-blend-mode-saturation" id="ref-for-valdef-blend-mode-saturation">saturation</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①③">|</a> <a data-link-type="value" href="#valdef-blend-mode-color" id="ref-for-valdef-blend-mode-color">color</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①④">|</a> <a data-link-type="value" href="#valdef-blend-mode-luminosity" id="ref-for-valdef-blend-mode-luminosity">luminosity</a>
</pre>
        <p>将 <a class="css" data-link-type="value" href="#valdef-blend-mode-normal"
                id="ref-for-valdef-blend-mode-normal①">normal</a> 以外的混合模式应用于元素，必须创建一个新的<a
                href="https://www.w3.org/tr/css21/visuren.html#x43">层叠上下文</a> <a data-link-type="biblio"
                href="#biblio-css21" title="层叠样式表第2版修订版 (CSS 2.1) 规范">[CSS21]</a>。然后必须将该组与包含该元素的<a
                href="https://www.w3.org/tr/css21/visuren.html#x43">层叠上下文</a>进行混合和合成。</p>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>测试</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><span class="wpt-name">Blending_in_a_group_with_filter.html (视觉测试) </span><a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/Blending_in_a_group_with_filter.html"><small>(来源)</small></a>
                <li class="wpt-test"><span class="wpt-name">Blending_in_a_group_with_opacity.html (视觉测试)
                    </span><a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/Blending_in_a_group_with_opacity.html"><small>(来源)</small></a>
                <li class="wpt-test"><span class="wpt-name">Text_with_SVG_background.html (视觉测试) </span><a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/Text_with_SVG_background.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/compositing/inheritance.html"
                        title="css/compositing/inheritance.html">inheritance.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/compositing/inheritance.html"><small>(实时测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/inheritance.html"><small>(来源)</small></a>
                <li class="wpt-test"><span class="wpt-name">line-with-svg-background.html (视觉测试) </span><a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/line-with-svg-background.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/svg/mix-blend-mode-in-svg-image.html"
                        title="css/compositing/svg/mix-blend-mode-in-svg-image.html">mix-blend-mode-in-svg-image.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/svg/mix-blend-mode-in-svg-image.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/svg/mix-blend-mode-in-svg-image.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/svg/mix-blend-mode-svg-rectangle.html"
                        title="css/compositing/svg/mix-blend-mode-svg-rectangle.html">mix-blend-mode-svg-rectangle.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/svg/mix-blend-mode-svg-rectangle.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/svg/mix-blend-mode-svg-rectangle.html"><small>(来源)</small></a>
                <li class="wpt-test"><span class="wpt-name">text-with-svg-background.html (视觉测试) </span><a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/text-with-svg-background.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-animation.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-animation.html">mix-blend-mode-animation.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-animation.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-animation.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-blended-element-interposed.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-blended-element-interposed.html">mix-blend-mode-blended-element-interposed.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-blended-element-interposed.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-blended-element-interposed.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-blended-element-overflow-hidden-and-border-radius.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-blended-element-overflow-hidden-and-border-radius.html">mix-blend-mode-blended-element-overflow-hidden-and-border-radius.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-blended-element-overflow-hidden-and-border-radius.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-blended-element-overflow-hidden-and-border-radius.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-blended-element-overflow-scroll.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-blended-element-overflow-scroll.html">mix-blend-mode-blended-element-overflow-scroll.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-blended-element-overflow-scroll.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-blended-element-overflow-scroll.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-blended-element-with-transparent-pixels.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-blended-element-with-transparent-pixels.html">mix-blend-mode-blended-element-with-transparent-pixels.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-blended-element-with-transparent-pixels.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-blended-element-with-transparent-pixels.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-blended-with-3D-transform.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-blended-with-3D-transform.html">mix-blend-mode-blended-with-3D-transform.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-blended-with-3D-transform.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-blended-with-3D-transform.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-blended-with-transform-and-perspective.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-blended-with-transform-and-perspective.html">mix-blend-mode-blended-with-transform-and-perspective.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-blended-with-transform-and-perspective.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-blended-with-transform-and-perspective.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-blending-with-sibling.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-blending-with-sibling.html">mix-blend-mode-blending-with-sibling.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-blending-with-sibling.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-blending-with-sibling.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-border-image.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-border-image.html">mix-blend-mode-border-image.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-border-image.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-border-image.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-both-parent-and-blended-with-3D-transform.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-both-parent-and-blended-with-3D-transform.html">mix-blend-mode-both-parent-and-blended-with-3D-transform.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-both-parent-and-blended-with-3D-transform.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-both-parent-and-blended-with-3D-transform.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-canvas-parent.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-canvas-parent.html">mix-blend-mode-canvas-parent.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-canvas-parent.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-canvas-parent.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-canvas-sibling.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-canvas-sibling.html">mix-blend-mode-canvas-sibling.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-canvas-sibling.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-canvas-sibling.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-creates-stacking-context.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-creates-stacking-context.html">mix-blend-mode-creates-stacking-context.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-creates-stacking-context.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-creates-stacking-context.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-filter.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-filter.html">mix-blend-mode-filter.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-filter.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-filter.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-iframe-parent.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-iframe-parent.html">mix-blend-mode-iframe-parent.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-iframe-parent.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-iframe-parent.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-iframe-sibling.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-iframe-sibling.html">mix-blend-mode-iframe-sibling.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-iframe-sibling.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-iframe-sibling.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-image.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-image.html">mix-blend-mode-image.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-image.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-image.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-intermediate-element-overflow-hidden-and-border-radius.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-intermediate-element-overflow-hidden-and-border-radius.html">mix-blend-mode-intermediate-element-overflow-hidden-and-border-radius.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-intermediate-element-overflow-hidden-and-border-radius.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-intermediate-element-overflow-hidden-and-border-radius.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-mask.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-mask.html">mix-blend-mode-mask.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-mask.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-mask.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-overflowing-child-of-blended-element.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-overflowing-child-of-blended-element.html">mix-blend-mode-overflowing-child-of-blended-element.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-overflowing-child-of-blended-element.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-overflowing-child-of-blended-element.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-overflowing-child.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-overflowing-child.html">mix-blend-mode-overflowing-child.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-overflowing-child.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-overflowing-child.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-paragraph-background-image.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-paragraph-background-image.html">mix-blend-mode-paragraph-background-image.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-paragraph-background-image.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-paragraph-background-image.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-paragraph.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-paragraph.html">mix-blend-mode-paragraph.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-paragraph.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-paragraph.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-parent-element-overflow-hidden-and-border-radius.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-parent-element-overflow-hidden-and-border-radius.html">mix-blend-mode-parent-element-overflow-hidden-and-border-radius.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-parent-element-overflow-hidden-and-border-radius.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-parent-element-overflow-hidden-and-border-radius.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-parent-element-overflow-scroll-blended-position-fixed.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-parent-element-overflow-scroll-blended-position-fixed.html">mix-blend-mode-parent-element-overflow-scroll-blended-position-fixed.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-parent-element-overflow-scroll-blended-position-fixed.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-parent-element-overflow-scroll-blended-position-fixed.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-parent-element-overflow-scroll.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-parent-element-overflow-scroll.html">mix-blend-mode-parent-element-overflow-scroll.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-parent-element-overflow-scroll.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-parent-element-overflow-scroll.html"><small>(来源)</small></a>
                <li class="wpt-test"><span class="wpt-name">mix-blend-mode-parent-with-3D-transform-and-transition.html
                        (视觉测试) </span><a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-parent-with-3D-transform-and-transition.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-parent-with-3D-transform.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-parent-with-3D-transform.html">mix-blend-mode-parent-with-3D-transform.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-parent-with-3D-transform.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-parent-with-3D-transform.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-parent-with-border-radius.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-parent-with-border-radius.html">mix-blend-mode-parent-with-border-radius.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-parent-with-border-radius.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-parent-with-border-radius.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-parent-with-text.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-parent-with-text.html">mix-blend-mode-parent-with-text.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-parent-with-text.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-parent-with-text.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-parsing.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-parsing.html">mix-blend-mode-parsing.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-parsing.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-parsing.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter-basic.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter-basic.html">mix-blend-mode-plus-lighter-basic.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter-basic.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter-basic.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter-svg-basic.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter-svg-basic.html">mix-blend-mode-plus-lighter-svg-basic.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter-svg-basic.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter-svg-basic.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter-svg.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter-svg.html">mix-blend-mode-plus-lighter-svg.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter-svg.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter-svg.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter.html">mix-blend-mode-plus-lighter.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-plus-lighter.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-root-element-group.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-root-element-group.html">mix-blend-mode-root-element-group.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-root-element-group.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-root-element-group.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-rotated-clip.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-rotated-clip.html">mix-blend-mode-rotated-clip.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-rotated-clip.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-rotated-clip.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-script.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-script.html">mix-blend-mode-script.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-script.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-script.html"><small>(来源)</small></a>
                <li class="wpt-test"><span class="wpt-name">mix-blend-mode-sibling-with-3D-transform-and-transition.html
                        (视觉测试) </span><a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-sibling-with-3D-transform-and-transition.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-sibling-with-3D-transform.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-sibling-with-3D-transform.html">mix-blend-mode-sibling-with-3D-transform.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-sibling-with-3D-transform.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-sibling-with-3D-transform.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-simple.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-simple.html">mix-blend-mode-simple.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-simple.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-simple.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-stacking-context-001.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-stacking-context-001.html">mix-blend-mode-stacking-context-001.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-stacking-context-001.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-stacking-context-001.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-stacking-context-creates-isolation.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-stacking-context-creates-isolation.html">mix-blend-mode-stacking-context-creates-isolation.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-stacking-context-creates-isolation.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-stacking-context-creates-isolation.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-svg.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-svg.html">mix-blend-mode-svg.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-svg.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-svg.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-video-sibling.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-video-sibling.html">mix-blend-mode-video-sibling.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-video-sibling.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-video-sibling.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-video.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-video.html">mix-blend-mode-video.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-video.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-video.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/mix-blend-mode/mix-blend-mode-with-transform-and-preserve-3D.html"
                        title="css/compositing/mix-blend-mode/mix-blend-mode-with-transform-and-preserve-3D.html">mix-blend-mode-with-transform-and-preserve-3D.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/mix-blend-mode/mix-blend-mode-with-transform-and-preserve-3D.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/mix-blend-mode/mix-blend-mode-with-transform-and-preserve-3D.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/parsing/mix-blend-mode-computed.html"
                        title="css/compositing/parsing/mix-blend-mode-computed.html">mix-blend-mode-computed.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/compositing/parsing/mix-blend-mode-computed.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/parsing/mix-blend-mode-computed.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/parsing/mix-blend-mode-invalid.html"
                        title="css/compositing/parsing/mix-blend-mode-invalid.html">mix-blend-mode-invalid.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/compositing/parsing/mix-blend-mode-invalid.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/parsing/mix-blend-mode-invalid.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/parsing/mix-blend-mode-valid.html"
                        title="css/compositing/parsing/mix-blend-mode-valid.html">mix-blend-mode-valid.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/compositing/parsing/mix-blend-mode-valid.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/parsing/mix-blend-mode-valid.html"><small>(来源)</small></a>
            </ul>
        </details>
        <div class="example" id="ex-duck-on-lime">
            <a class="self-link" href="#ex-duck-on-lime"></a>
            <p>给定以下示例标记：</p>
            <pre>&lt;body>
  &lt;img src="ducky.png"/>
&lt;/body>
</pre>
            <p>以及以下样式规则：</p>
            <pre>body { background-color: lime; }
</pre>
            <p> ... 将产生以下结果： </p>
            <div class="figure">
                <img alt="文件中鸭子图片与绿色背景的示例" height="537"
                    src="https://www.w3.org/TR/compositing-1/examples/ducky_normal.png" style="width:30%" width="489">
                <p class="caption"> 部分透明的图片在绿色背景上</p>
            </div>
            <p>如果我们将样式规则更改为包括混合：</p>
            <pre>body { background-color: lime; }
img { mix-blend-mode: multiply; }
</pre>
            <p> ... 输出将是图像与 &lt;body> 元素的绿色背景进行混合。 </p>
            <div class="figure">
                <img alt="鸭子图片与文件绿色背景混合的示例" height="537"
                    src="https://www.w3.org/TR/compositing-1/examples/ducky_multiply.png" style="width:30%" width="489">
                <p class="caption"> 透明图像在绿色背景上的混合效果。</p>
            </div>
        </div>
        <div class="example" id="ex-svg-screen-mode">
            <a class="self-link" href="#ex-svg-screen-mode"></a>
            <p>给定以下 SVG 代码：</p>
            <pre>&lt;svg>
  &lt;circle cx="40" cy="40" r="40" fill="red"/>
  &lt;circle cx="80" cy="40" r="40" fill="lime"/>
  &lt;circle cx="60" cy="80" r="40" fill="blue"/>
&lt;/svg>
</pre>
            <p>以及以下样式规则：</p>
            <pre>circle { mix-blend-mode: screen; }
</pre>
            <p> ... 输出将是三个圆的混合效果。每个圆从底部到顶部依次渲染。元素重叠的区域中，混合模式会改变颜色。</p>
            <div class="figure">
                <img alt="三个圆形以屏幕混合模式混合的示例" src="https://www.w3.org/TR/compositing-1/examples/screen_example.svg"
                    style="width:30%">
                <p class="caption"> 屏幕混合模式下三个圆的混合示例 </p>
            </div>
        </div>
        <div class="example" id="ex-opacity-stacking">
            <a class="self-link" href="#ex-opacity-stacking"></a>
            <p>在以下样式表和文档片段中：</p>
            <pre>body { background-color: lime; }
div { background-color: red; width: 200px; opacity: .95}
img { mix-blend-mode: difference; }

&lt;body>
  &lt;div>
     &lt;img src="ducky.png"/>
  &lt;/div>
&lt;/body>
</pre>
            <p> ... &lt;div> 元素上的 <a class="property css" data-link-type="property"
                    href="https://www.w3.org/TR/css-color-4/#propdef-opacity" id="ref-for-propdef-opacity">不透明度</a>
                导致创建了一个层叠上下文。这创建了一个新的组，因此图像不会与 &lt;body> 的颜色混合。</p>
            <div class="figure">
                <img alt="鸭子图片与文件绿色背景混合的示例" height="537"
                    src="https://www.w3.org/TR/compositing-1/examples/ducky_difference.png" style="width:30%"
                    width="489">
                <p class="caption"> 在层叠上下文中的混合示例。</p>
            </div>
            <p> 请注意图像没有与绿色背景混合。</p>
        </div>
        <div class="example" id="ex-overlay-blend">
            <a class="self-link" href="#ex-overlay-blend"></a>
            <p>给定以下示例标记：</p>
            <pre>&lt;body>
   &lt;div>
     &lt;p><a class="css" data-link-type="maybe" href="#valdef-blend-mode-overlay" id="ref-for-valdef-blend-mode-overlay①">overlay</a> 混合在文本上&lt;/p>
   &lt;/div>
&lt;/body>
</pre>
            <p>以及以下样式规则：</p>
            <pre>div { background-image: url('texture.png'); }
@font-face {
  font-family: "Mythos Std";
  src: url("http://myfontvendor.com/mythos.otf");
}
p {
  mix-blend-mode: overlay;
  font-family: "Mythos Std"
}
</pre>
            <div class="figure">
                <img alt="带有覆盖混合效果的文字在纹理图像上" height="295"
                    src="https://www.w3.org/TR/compositing-1/examples/overlay_text.png" style="width:75%" width="510">
                <p class="caption"> 带有混合覆盖效果的文字在图像上 </p>
            </div>
        </div>
        <h4 class="heading settled" data-level="3.4.2" id="isolation"><span class="secno">3.4.2. </span><span
                class="content"><a class="property css" data-link-type="property" href="#propdef-isolation"
                    id="ref-for-propdef-isolation">isolation</a> 属性</span><a class="self-link" href="#isolation"></a>
        </h4>
        <p>在 SVG 中，这定义了一个元素是否是隔离的。<br> 对于 CSS，将 <a class="property css" data-link-type="property"
                href="#propdef-isolation" id="ref-for-propdef-isolation①">isolation</a> 设置为
            <span class="css">isolate</span> 会将元素变成一个层叠上下文。
        </p>
        <p>默认情况下，元素使用 <span class="css">auto</span> 关键字，这意味着它们不是隔离的。
            但是，会导致创建层叠上下文的操作 <a data-link-type="biblio" href="#biblio-css21"
                title="层叠样式表第2版修订版 (CSS 2.1) 规范">[CSS21]</a> 必须导致组被隔离。这些操作在 <a href="#csscompositingrules_CSS">'HTML
                特定行为'</a> 和 <a href="#csscompositingrules_SVG">'SVG 特定行为'</a> 中描述。</p>
        <table class="def propdef" data-link-for-hint="isolation">
            <tbody>
                <tr>
                    <th>名称：
                    <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export
                            id="propdef-isolation">isolation</dfn>
                <tr class="value">
                    <th><a href="https://www.w3.org/TR/css-values/#value-defs">值：</a>
                    <td class="prod"><a class="production css" data-link-type="type" href="#isolated-propid"
                            id="ref-for-isolated-propid">&lt;isolation-mode></a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">初始值：</a>
                    <td>auto
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">应用于：</a>
                    <td>所有元素。在 SVG 中，它适用于<a href="https://www.w3.org/TR/SVG11/intro.html#TermContainerElement">容器元素</a>、
                        <a href="https://www.w3.org/TR/SVG11/intro.html#TermGraphicsElement">图形元素</a>和
                        <a
                            href="https://www.w3.org/TR/2011/REC-SVG11-20110816/intro.html#TermGraphicsReferencingElement">图形引用元素</a>。<a
                            data-link-type="biblio" href="#biblio-svg11" title="可缩放矢量图形 (SVG) 1.1 (第二版)">[SVG11]</a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">继承：</a>
                    <td>否
                <tr>
                    <th><a href="https://www.w3.org/TR/css-values/#percentages">百分比：</a>
                    <td>N/A
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#computed">计算值：</a>
                    <td>按指定
                <tr>
                    <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">规范顺序：</a>
                    <td>按语法
                <tr>
                    <th><a href="https://www.w3.org/TR/web-animations/#animation-type">动画类型：</a>
                    <td>离散
                <tr>
                    <th>媒体：
                    <td>视觉
        </table>
        <p>属性 <a class="production css" data-link-type="type" href="#isolated-propid"
                id="ref-for-isolated-propid①">&lt;isolation-mode></a> 的语法如下：</p>
        <pre
            class="isolated prod"><dfn class="dfn-paneled" data-dfn-type="type" data-export id="isolated-propid">&lt;isolation-mode></dfn> = auto <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑤">|</a> isolate</pre>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>测试</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/compositing/inheritance.html"
                        title="css/compositing/inheritance.html">inheritance.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/compositing/inheritance.html"><small>(实时测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/inheritance.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/isolation/animation/isolation-no-interpolation.html"
                        title="css/compositing/isolation/animation/isolation-no-interpolation.html">isolation-no-interpolation.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/isolation/animation/isolation-no-interpolation.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/isolation/animation/isolation-no-interpolation.html"><small>(来源)</small></a>
                <li class="wpt-test"><span class="wpt-name">blend-isolation.html (视觉测试) </span><a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/isolation/blend-isolation.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/parsing/isolation-computed.html"
                        title="css/compositing/parsing/isolation-computed.html">isolation-computed.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/compositing/parsing/isolation-computed.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/parsing/isolation-computed.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/parsing/isolation-invalid.html"
                        title="css/compositing/parsing/isolation-invalid.html">isolation-invalid.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/compositing/parsing/isolation-invalid.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/parsing/isolation-invalid.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/parsing/isolation-valid.html"
                        title="css/compositing/parsing/isolation-valid.html">isolation-valid.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/compositing/parsing/isolation-valid.html"><small>(实时测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/parsing/isolation-valid.html"><small>(来源)</small></a>
            </ul>
        </details>
        <p id="img_isolation"> 在 CSS 中，背景图像或 <a data-link-type="element"
                href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element"
                id="ref-for-the-img-element">img</a> 的内容必须始终渲染到隔离组中。<br>例如，如果你通过 <span
                id="ref-for-the-img-element①">img</span> 标签链接到一个 SVG 文件，则该 SVG 的作品不会与内容的背景混合。</p>
        <p>在 SVG 中，<a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-masking-1/#propdef-mask" id="ref-for-propdef-mask">mask</a> 始终创建一个隔离组。
        </p>
        <h4 class="heading settled" data-level="3.4.3" id="background-blend-mode"><span class="secno">3.4.3.
            </span><span class="content"><a class="property css" data-link-type="property"
                    href="#propdef-background-blend-mode"
                    id="ref-for-propdef-background-blend-mode①">background-blend-mode</a> 属性</span><a class="self-link"
                href="#background-blend-mode"></a></h4>
        <p>定义每个背景层的混合模式。</p>
        <p>每个背景层必须与其下方的元素背景层以及元素的背景颜色混合。背景层不得与元素背后的内容混合，而是必须像在隔离组中渲染一样运行。</p>
        <p><a class="property css" data-link-type="property" href="#propdef-background-blend-mode"
                id="ref-for-propdef-background-blend-mode②">background-blend-mode</a> 属性的描述如下：</p>
        <table class="def propdef" data-link-for-hint="background-blend-mode">
            <tbody>
                <tr>
                    <th>名称：
                    <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export
                            id="propdef-background-blend-mode">background-blend-mode</dfn>
                <tr class="value">
                    <th><a href="https://www.w3.org/TR/css-values/#value-defs">值：</a>
                    <td class="prod"><a class="production css" data-link-type="type" href="#ltblendmodegt"
                            id="ref-for-ltblendmodegt②">&lt;blend-mode></a><a data-link-type="grammar"
                            href="https://www.w3.org/TR/css-values-4/#mult-comma" id="ref-for-mult-comma">#</a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">初始值：</a>
                    <td>normal
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">应用于：</a>
                    <td>所有 HTML 元素
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">继承：</a>
                    <td>否
                <tr>
                    <th><a href="https://www.w3.org/TR/css-values/#percentages">百分比：</a>
                    <td>N/A
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#computed">计算值：</a>
                    <td>按指定
                <tr>
                    <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">规范顺序：</a>
                    <td>按语法
                <tr>
                    <th><a href="https://www.w3.org/TR/web-animations/#animation-type">动画类型：</a>
                    <td>离散
                <tr>
                    <th>媒体：
                    <td>视觉
        </table>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>测试</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/compositing/inheritance.html"
                        title="css/compositing/inheritance.html">inheritance.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/compositing/inheritance.html"><small>(实时测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/inheritance.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/background-blending/background-blend-mode-gradient-image.html"
                        title="css/compositing/background-blending/background-blend-mode-gradient-image.html">background-blend-mode-gradient-image.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/background-blending/background-blend-mode-gradient-image.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/background-blending/background-blend-mode-gradient-image.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/background-blending/background-blend-mode-plus-lighter.html"
                        title="css/compositing/background-blending/background-blend-mode-plus-lighter.html">background-blend-mode-plus-lighter.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/background-blending/background-blend-mode-plus-lighter.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/background-blending/background-blend-mode-plus-lighter.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/parsing/background-blend-mode-computed-multiple.html"
                        title="css/compositing/parsing/background-blend-mode-computed-multiple.html">background-blend-mode-computed-multiple.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/parsing/background-blend-mode-computed-multiple.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/parsing/background-blend-mode-computed-multiple.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/parsing/background-blend-mode-computed.html"
                        title="css/compositing/parsing/background-blend-mode-computed.html">background-blend-mode-computed.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/parsing/background-blend-mode-computed.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/parsing/background-blend-mode-computed.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/parsing/background-blend-mode-invalid.html"
                        title="css/compositing/parsing/background-blend-mode-invalid.html">background-blend-mode-invalid.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/parsing/background-blend-mode-invalid.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/parsing/background-blend-mode-invalid.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/parsing/background-blend-mode-valid.html"
                        title="css/compositing/parsing/background-blend-mode-valid.html">background-blend-mode-valid.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/parsing/background-blend-mode-valid.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/parsing/background-blend-mode-valid.html"><small>(来源)</small></a>
            </ul>
        </details>
        <p>列表中的 <a class="property css" data-link-type="property" href="#propdef-background-blend-mode"
                id="ref-for-propdef-background-blend-mode③">background-blend-mode</a> 必须按与 <a class="property css"
                data-link-type="property" href="https://www.w3.org/TR/css-backgrounds-3/#propdef-background-image"
                id="ref-for-propdef-background-image">background-image</a> 相同的顺序应用 <a data-link-type="biblio"
                href="#biblio-css3bg"
                title="CSS 背景与边框模块第3级">[CSS3BG]</a>。这意味着列表中的第一个元素将应用于顶部的图层。如果属性没有足够的逗号分隔值来匹配图层数量，UA
            必须通过重复值列表来计算其使用值，直到有足够的值。</p>
        <p></p>
        <p>如果使用 <a class="property css" data-link-type="property"
                href="https://www.w3.org/TR/css-backgrounds-3/#propdef-background"
                id="ref-for-propdef-background">background</a> 简写 <a data-link-type="biblio" href="#biblio-css3bg"
                title="CSS 背景与边框模块第3级">[CSS3BG]</a>，则该元素的 <a class="property css" data-link-type="property"
                href="#propdef-background-blend-mode"
                id="ref-for-propdef-background-blend-mode④">background-blend-mode</a> 属性必须重置为其初始值。</p>
        <div class="example" id="ex-background-blend">
            <a class="self-link" href="#ex-background-blend"></a>
            <p>给定以下示例标记：</p>
            <pre>&lt;body>
   &lt;div>&lt;/div>
&lt;/body>
</pre>
            <p>以及以下样式规则：</p>
            <pre>body { background-color: lime; }
div {
  width: 200px;
  height: 200px;
  background-size: 200px 200px;
  background-repeat:no-repeat;
  background-image: linear-gradient(to right, #000000 0%,#ffffff 100%), url('ducky.png');
  background-blend-mode: difference, normal;
}
</pre>
            <div class="figure">
                <img alt="带有鸭子图片和渐变背景混合的 div 示例" height="576"
                    src="https://www.w3.org/TR/compositing-1/examples/ducky_background_blend.png" style="width:30%"
                    width="504">
                <p class="caption"> 两个背景图像的混合。</p>
            </div>
            <p> 注意，渐变并未与 <a data-link-type="element"
                    href="https://html.spec.whatwg.org/multipage/sections.html#the-body-element"
                    id="ref-for-the-body-element">body</a> 的颜色混合。相反，它保留了原始颜色。 </p>
        </div>
        <h2 class="heading settled" data-level="4" id="canvascompositingandblending"><span class="secno">4. </span><span
                class="content">在 Canvas 2D 中指定合成和混合</span><a class="self-link"
                href="#canvascompositingandblending"></a></h2>
        <p><a href="https://html.spec.whatwg.org/multipage/canvas.html#2dcontext">canvas 2d</a> 上下文定义了
            <code
                class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/canvas.html#dom-context-2d-globalcompositeoperation" id="ref-for-dom-context-2d-globalcompositeoperation②">globalCompositeOperation</a></code>
            属性，该属性用于设置当前的合成和混合操作符。
        </p>
        <p>该属性接受以下值：</p>
        <div class="propdef">
            <dl>
                <dt id="propdef-mix"><a class="self-link" href="#propdef-mix"></a><span
                        class="propdef-title prop-name">‘globalCompositeOperation’</span>
                <dd>
                    <table class="propinfo">
                        <tbody>
                            <tr>
                                <td><em>值：</em>
                                <td> <a class="production css" data-link-type="type" href="#ltblendmodegt"
                                        id="ref-for-ltblendmodegt③">&lt;blend-mode></a> | <a class="production css"
                                        data-link-type="type" href="#compositemode"
                                        id="ref-for-compositemode">&lt;composite-mode></a>
                            <tr>
                                <td><em>初始值：</em>
                                <td>source-over
                    </table>
            </dl>
        </div>
        <p><a class="production css" data-link-type="type" href="#compositemode"
                id="ref-for-compositemode①">&lt;composite-mode></a> 属性的语法如下：</p>
        <pre
            class="compositemode prod"><dfn class="dfn-paneled" data-dfn-type="type" data-export id="compositemode">&lt;composite-mode></dfn> = <a href="#porterduffcompositingoperators_clear">clear</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑥">|</a> <a href="#porterduffcompositingoperators_src">copy</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑦">|</a> <a href="#porterduffcompositingoperators_srcover">source-over</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑧">|</a> <a href="#porterduffcompositingoperators_dstover">destination-over</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑨">|</a> <a href="#porterduffcompositingoperators_srcin">source-in</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⓪">|</a>    <br><a href="#porterduffcompositingoperators_dstin">destination-in</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②①">|</a> <a href="#porterduffcompositingoperators_srcout">source-out</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②②">|</a> <a href="#porterduffcompositingoperators_dstout">destination-out</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②③">|</a> <a href="#porterduffcompositingoperators_srcatop">source-atop</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②④">|</a>    <br><a href="#porterduffcompositingoperators_dstatop">destination-atop</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑤">|</a> <a href="#porterduffcompositingoperators_xor">xor</a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑥">|</a> <a href="#porterduffcompositingoperators_plus">lighter</a></pre>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>测试</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/canvas-composite-modes.html"
                        title="css/compositing/canvas-composite-modes.html">canvas-composite-modes.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/compositing/canvas-composite-modes.html"><small>(实时测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/canvas-composite-modes.html"><small>(来源)</small></a>
            </ul>
        </details>
        <h2 class="heading settled" data-level="5" id="whatiscompositing"><span class="secno">5. </span><span
                class="content">合成简介</span><a class="self-link" href="#whatiscompositing"></a>
        </h2>
        <p>合成是将图形元素与其背景进行组合的过程。</p>
        <p>在本规范描述的模型中，整体合成操作分为两步 - <a href="#advancedcompositing">Porter-Duff 合成</a> 和 <a href="#blending">混合</a>。
            混合步骤决定了图形元素与背景的颜色如何相互作用。</p>
        <p>通常，先执行混合步骤，然后再进行 Porter-Duff 合成步骤。
            在混合步骤中，计算图形元素和 <a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop①">背景</a>
            颜色混合的结果色。图形元素的颜色将被此结果色替换。
            然后，使用指定的合成操作符将图形元素与 <span id="ref-for-backdrop②">背景</span> 进行合成。</p>
        <p class="note" role="note"><span class="marker">注意：</span> 形状由形状的数学描述定义。某一点要么在形状内部，要么不在。没有渐变。</p>
        <p class="note" role="note"><span class="marker">注意：</span> 不透明度使用与每个特定点的颜色值一起存储的 alpha 值来描述。alpha 值在 0 和 1
            之间，包括这两个值。
            值为 0 表示该像素在该点上没有覆盖，因此是透明的；即没有几何体的颜色贡献，因为几何体没有覆盖该像素。值为 1 表示像素完全不透明；几何体完全覆盖了该像素。
        </p>
        <h3 class="heading settled" data-level="5.1" id="simplealphacompositing"><span class="secno">5.1. </span><span
                class="content">简单 alpha 合成</span><a class="self-link" href="#simplealphacompositing"></a>
        </h3>
        <p>简单 alpha 合成的公式为</p>
        <pre>co = Cs x αs + Cb x αb x (1 - αs)
</pre>
        <p>其中</p>
        <ul>
            <li>co: 合成后的预乘像素值
            <li>Cs: 正在合成的源图形元素的颜色值
            <li>αs: 正在合成的源图形元素的 alpha 值
            <li>Cb: <a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop③">背景</a> 的颜色值
            <li>αb: <a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop④">背景</a> 的 alpha 值
        </ul>
        <p class="note" role="note"><span class="marker">注意：</span> 所有值都在 0 到 1 之间。</p>
        <p>合成后的像素值 (co) 是通过加上源图形元素 [Cs x αs] 和背景 [Cb x αb x (1 - αs)] 的贡献得出的。
            对于图形元素和背景，颜色值乘以 alpha 以确定颜色的贡献量。
            Alpha 值为 0 意味着颜色不贡献，而部分 alpha 值意味着颜色贡献了一部分。
            背景的贡献进一步根据图形元素的不透明度减少。
            从概念上讲，(1 - αs) 的背景显示在图形元素后面，这意味着如果图形元素完全不透明 (αs=1)，则背景不会显示。</p>
        <p>上面列出的简单 alpha 合成公式给出了结果色，该结果色是背景色和图形元素色的加权平均值，权重由背景和
            图形元素的 alpha 决定。
            合成结果的 alpha 值是合成元素的贡献 alpha 之和。
            合成结果的 alpha 值公式为</p>
        <pre>αo = αs + αb x (1 - αs)
</pre>
        <p>其中</p>
        <ul>
            <li>αo: 合成的 alpha 值
            <li>αs: 正在合成的图形元素的 alpha 值
            <li>αb: <a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop⑤">背景</a> 的 alpha 值
        </ul>
        <p></p>
        <div class="note" role="note">
            <p> 通常，更有效的做法是存储颜色和不透明度的 <code>预乘值</code>。
                预乘值为 </p>
            <pre>cs = Cs x αs
</pre>
            <p>其中</p>
            <ul>
                <li>cs: 预乘值
                <li>Cs: 颜色值
                <li>αs: alpha 值
            </ul>
            <p> 因此，使用预乘值的简单 alpha 合成公式变为 </p>
            <pre>co = cs + cb x (1 - αs)
</pre>
            <p></p>
            <p></p>
            <p> 要提取预乘值的颜色分量，公式为： </p>
            <pre>Co = co / αo
</pre>
            <p></p>
        </div>
        <h4 class="heading settled" data-level="5.1.1" id="simplealphacompositingexamples"><span class="secno">5.1.1.
            </span><span class="content">简单 alpha 合成的示例</span><a class="self-link"
                href="#simplealphacompositingexamples"></a></h4>
        <div class="example" id="ex-basic-alpha">
            <a class="self-link" href="#ex-basic-alpha"></a>
            <div class="figure">
                <img alt="显示 alpha 合成的简单框" src="https://www.w3.org/TR/compositing-1/examples/simple_box.svg">
                <p class="caption"></p>
            </div>
            <p> 这是最基本的情况。它由一个用实色填充的形状（α = 1）组成。
                该形状与空背景进行合成。空背景对合成结果没有影响。 </p>
            <pre>Cs = RGB(1,0,0)
αs = 1
Cb = RGB(0,0,0)
αb = 0

co = Cs x αs + Cb x αb x (1 - αs)
co = RGB(1,0,0) x 1 + RGB(0,0,0) x 0 x (1 - 1)
co = RGB(1,0,0) x 1
co = RGB(1,0,0)
</pre>
            <p></p>
        </div>
        <div class="example" id="ex-shapes-intersect">
            <a class="self-link" href="#ex-shapes-intersect"></a>
            <div class="figure">
                <img alt="简单形状" src="https://www.w3.org/TR/compositing-1/examples/two_box.svg">
                <p class="caption"></p>
            </div>
            <p> 这是一个更复杂的示例。没有透明度，但两个形状相交。 </p>
            <p> 在相交区域应用合成公式，得出： </p>
            <pre>Cs = RGB(0,0,1)
αs = 1
Cb = RGB(1,0,0)
αb = 1

co = Cs x αs + Cb x αb x (1 - αs)
co = RGB(0,0,1) x 1 + RGB(1,0,0) x 1 x (1 - 1)
co = RGB(0,0,1) x 1 + RGB(1,0,0) x 1 x 0
co = RGB(0,0,1) x 1
co = RGB(0,0,1)
</pre>
            <p>计算合成结果的 alpha 值</p>
            <pre>αo = αs + αb x (1 - αs)
αo = 1 + 1 x (1 - 1)
αo = 1
</pre>
            <p>计算合成结果的颜色分量</p>
            <pre>Co = co / αo
Co = RGB(0, 0, 1) / 1
Co = RGB(0, 0, 1)
</pre>
            <p></p>
        </div>
        <div class="example" id="ex-transparent-over-opaque">
            <a class="self-link" href="#ex-transparent-over-opaque"></a>
            <div class="figure">
                <img alt="不透明盒子上方透明盒子的交互作用" src="https://www.w3.org/TR/compositing-1/examples/two_box_transparency.svg">
                <p class="caption"></p>
            </div>
            <p> 这是一个示例，其中形状具有一定的透明度，但 <a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop⑥">背景</a> 完全不透明。 </p>
            <p> 在相交区域应用合成公式，得出： </p>
            <pre>Cs = RGB(0,0,1)
αs = 0.5
Cb = RGB(1,0,0)
αb = 1

co = Cs x αs + Cb x αb x (1 - αs)
co = RGB(0,0,1) x 0.5 + RGB(1,0,0) x 1 x (1 - 0.5)
co = RGB(0,0,1) x 0.5 + RGB(1,0,0) x 0.5
co = RGB(0.5,0,0.5)
</pre>
            <p>计算合成结果的 alpha 值</p>
            <pre>αo = αs + αb x (1 - αs)
αo = 0.5 + 1 x (1 - 0.5)
αo = 1
</pre>
            <p>计算合成结果的颜色分量</p>
            <pre>Co = co / αo
Co = RGB(0.5, 0, 0.5) / 1
Co = RGB(0.5, 0, 0.5)
</pre>
            <p></p>
        </div>
        <div class="example" id="ex-two-transparent">
            <a class="self-link" href="#ex-two-transparent"></a>
            <div class="figure">
                <img alt="两个透明盒子的交互作用" src="https://www.w3.org/TR/compositing-1/examples/two_box_transparency_both.svg">
                <p class="caption"></p>
            </div>
            <p> 图 4 显示了一个示例，其中形状和 <a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop⑦">背景</a> 都是透明的。 </p>
            <p> 在相交区域应用合成公式，得出： </p>
            <pre>Cs = RGB(0,0,1)
αs = 0.5
Cb = RGB(1,0,0)
αb = 0.5

co = Cs x αs + Cb x αb x (1 - αs)
co = RGB(0,0,1) x 0.5 + RGB(1,0,0) x 0.5 x (1 - 0.5)
co = RGB(0,0,1) x 0.5 + RGB(1,0,0) x 0.25
co = RGB(0.25, 0, 0.5)
</pre>
            <p>计算合成结果的 alpha 值</p>
            <pre>αo = αs + αb x (1 - αs)
αo = 0.5 + 0.5 x (1 - 0.5)
αo = 0.75
</pre>
            <p>计算合成结果的颜色分量</p>
            <pre>Co = co / αo
Co = RGB(0.25, 0, 0.5) / 0.75
Co = RGB(0.33, 0, 0.66)
</pre>
            <p></p>
        </div>
        <h2 class="heading settled" data-level="6" id="generalformula"><span class="secno">6. </span><span
                class="content">合成和混合的通用公式</span><a class="self-link" href="#generalformula"></a></h2>
        <p>合成和混合的通用公式允许选择合成运算符和混合函数，包含两个步骤。
            这些函数中使用的术语将在以下章节中详细描述。</p>
        <p>进行原位混合</p>
        <pre>Cs = (1 - αb) x Cs + αb x B(Cb, Cs)
</pre>
        <p>合成</p>
        <pre>Co = αs x Fa x Cs + αb x Fb x Cb
</pre>
        <p>其中：</p>
        <ul>
            <li><strong>Cs</strong>：源颜色
            <li><strong>Cb</strong>：背景颜色
            <li><strong>αs</strong>：源 alpha 值
            <li><strong>αb</strong>：背景 alpha 值
            <li><strong>B(Cb, Cs)</strong>：混合函数
            <li><strong>Fa</strong>：由使用的 Porter Duff 运算符定义
            <li><strong>Fb</strong>：由使用的 Porter Duff 运算符定义
        </ul>
        <h2 class="heading settled" data-level="7" id="backdropCalc"><span class="secno">7. </span><span
                class="content">背景计算</span><a class="self-link" href="#backdropCalc"></a></h2>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="backdrop">背景</dfn> 是元素背后的内容，是与元素合成的部分。
            这意味着背景是合成所有先前元素的结果。</p>
        <h3 class="heading settled" data-level="7.1" id="backdropexamples"><span class="secno">7.1. </span><span
                class="content">背景计算示例</span><a class="self-link" href="#backdropexamples"></a></h3>
        <div class="example" id="ex-simple-backdrop-calculation">
            <a class="self-link" href="#ex-simple-backdrop-calculation"></a>
            <div class="figure">
                <img alt="简单背景计算的示例" src="https://www.w3.org/TR/compositing-1/examples/simple_backdrop.svg">
                <p class="caption"></p>
            </div>
            <p> 该示例包含两个简单形状。蓝色形状的背景包括红色形状的右下角。
                虚线显示了合成蓝色形状时检查的区域。 </p>
        </div>
        <div class="example" id="ex-backdrop-with-alpha">
            <a class="self-link" href="#ex-backdrop-with-alpha"></a>
            <div class="figure">
                <img alt="带有 alpha 值的背景示例" src="https://www.w3.org/TR/compositing-1/examples/simple_backdrop_alpha.svg">
                <p class="caption"></p>
            </div>
            <p> 背景中的形状具有 alpha 值。在计算背景时，背景形状的 alpha 值被保留。 </p>
        </div>
        <h2 class="heading settled" data-level="8" id="groups"><span class="secno">8. </span><span
                class="content">合成组</span><a class="self-link" href="#groups"></a></h2>
        <p>合成组允许更好地控制合成与背景的交互。可以使用组来指定组内的合成效果将如何与场景中已经存在的内容（背景）进行交互。</p>
        <p>合成组可以由任意数量的元素组成，并且可以包含其他合成组。</p>
        <p>合成组的默认属性不会导致与没有组时的视觉差异。参见 <a href="#groupinvariance">组不变性</a>。</p>
        <p>合成组通过首先将组的元素合成到初始背景上来渲染。结果是一个包含颜色和 alpha 信息的单一元素。然后将该元素合成到组背景上。
            需要确保组背景只对最终合成做出一次贡献。
        </p>
        <dl>
            <dt id="initialbackdrop"><a class="self-link" href="#initialbackdrop"></a>初始背景
            <dd> 初始背景是用于合成组第一个元素的背景。在非隔离组中，这将与组背景相同，而在隔离组中则为完全透明的背景。
            <dt id="groupbackdrop"><a class="self-link" href="#groupbackdrop"></a>组背景
            <dd> 组背景是合成所有元素（不包括组中的第一个元素）的结果。
        </dl>
        <h3 class="heading settled" data-level="8.1" id="groupinvariance"><span class="secno">8.1. </span><span
                class="content">组不变性</span><a class="self-link" href="#groupinvariance"></a></h3>
        <p>简单 alpha 合成的一个重要特性是其组不变性。该行为在本规范中描述的更复杂的模型中得以保留。
            添加或删除具有默认属性的分组不应显示视觉差异。</p>
        <pre>so: A + B + C = A + (B + C) = (A + B) + C</pre>
        <p>当向组中添加诸如 <span class="css">isolate</span> 之类的属性，或使用 <a class="css" data-link-type="maybe"
                href="#valdef-blend-mode-normal" id="ref-for-valdef-blend-mode-normal②">normal</a> 以外的混合模式或 <span
                class="css">source-over</span> 以外的 Porter Duff 合成操作符时，组可能不再具有不变性。</p>
        <h3 class="heading settled" data-level="8.2" id="isolatedgroups"><span class="secno">8.2. </span><span
                class="content">隔离组</span><a class="self-link" href="#isolatedgroups"></a></h3>
        <p>在隔离组中，初始背景应为黑色且完全透明。</p>
        <p>在这种情况下，初始背景与组背景不同。只有当组的计算颜色、形状和 alpha 与组背景合成时，才会发生与组背景的交互。</p>
        <p>有关隔离组对合成的影响的描述，请参见 '<a href="#groupcompositing">隔离组和 Porter Duff 模式</a>'。
            有关隔离组对混合的影响的描述，请参见 '<a href="#isolationblending">组隔离对混合的影响</a>'。</p>
        <h3 class="heading settled" data-level="8.3" id="pagebackdrop"><span class="secno">8.3. </span><span
                class="content">根元素组</span><a class="self-link" href="#pagebackdrop"></a></h3>
        <p><a href="#isolatedgroups">隔离组</a> 的根元素是根元素组。所有其他元素和组都合成到该组中。根元素的背景（如果指定）被绘制到
            根元素组中，然后应用任何滤镜、剪裁路径、遮罩和不透明度，
            在合成到 <a href="#rootgroup">根组</a> 中之前（如果存在）。</p>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>测试</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/root-element-background-image-transparency-001.html"
                        title="css/compositing/root-element-background-image-transparency-001.html">root-element-background-image-transparency-001.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/root-element-background-image-transparency-001.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/root-element-background-image-transparency-001.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/root-element-background-image-transparency-002.html"
                        title="css/compositing/root-element-background-image-transparency-002.html">root-element-background-image-transparency-002.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/root-element-background-image-transparency-002.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/root-element-background-image-transparency-002.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/root-element-background-image-transparency-003.html"
                        title="css/compositing/root-element-background-image-transparency-003.html">root-element-background-image-transparency-003.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/root-element-background-image-transparency-003.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/root-element-background-image-transparency-003.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/root-element-background-image-transparency-004.html"
                        title="css/compositing/root-element-background-image-transparency-004.html">root-element-background-image-transparency-004.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/root-element-background-image-transparency-004.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/root-element-background-image-transparency-004.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/root-element-background-transparency.html"
                        title="css/compositing/root-element-background-transparency.html">root-element-background-transparency.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/root-element-background-transparency.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/root-element-background-transparency.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/root-element-blend-mode.html"
                        title="css/compositing/root-element-blend-mode.html">root-element-blend-mode.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/compositing/root-element-blend-mode.html"><small>(实时测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/root-element-blend-mode.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/root-element-filter-background-clip-text-crash.html"
                        title="css/compositing/root-element-filter-background-clip-text-crash.html">root-element-filter-background-clip-text-crash.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/root-element-filter-background-clip-text-crash.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/root-element-filter-background-clip-text-crash.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/root-element-filter.html"
                        title="css/compositing/root-element-filter.html">root-element-filter.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/compositing/root-element-filter.html"><small>(实时测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/root-element-filter.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/root-element-opacity-change.html"
                        title="css/compositing/root-element-opacity-change.html">root-element-opacity-change.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/compositing/root-element-opacity-change.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/root-element-opacity-change.html"><small>(来源)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/root-element-opacity.html"
                        title="css/compositing/root-element-opacity.html">root-element-opacity.html</a> <a
                        class="wpt-live"
                        href="http://wpt.live/css/compositing/root-element-opacity.html"><small>(实时测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/root-element-opacity.html"><small>(来源)</small></a>
            </ul>
        </details>
        <h3 class="heading settled" data-level="8.4" id="rootgroup"><span class="secno">8.4. </span><span
                class="content">根组</span><a class="self-link" href="#rootgroup"></a></h3>
        <p>根组包含整个画布，并包含（或位于）网页根元素的根元素组之下。</p>
        <p class="note allow-2119" role="note">浏览器通常使用无限的<a href="https://www.w3.org/TR/css-color-4/#sample">白色、100%
                不透明</a>的根组进行最终合成，但这不是必需的。</p>
        <h2 class="heading settled" data-level="9" id="advancedcompositing"><span class="secno">9. </span><span
                class="content">高级合成功能</span><a class="self-link" href="#advancedcompositing"></a></h2>
        <p><a href="#simplealphacompositing">简单 alpha 合成</a> 使用 <a
                href="#porterduffcompositingoperators_srcover">source-over</a> Porter Duff 合成操作符。</p>
        <p>Porter Duff 合成基于像素模型，其中两个形状（源和目标）可能对像素的最终颜色做出贡献。像素被分为四个子像素区域，每个区域代表源和目标的可能组合。<a data-link-type="biblio"
                href="#biblio-porterduff" title="数字图像合成">[PORTERDUFF]</a></p>
        <p></p>
        <p>四个区域分别是：</p>
        <dl>
            <dt>仅源
            <dd>只有源对像素颜色做出贡献
            <dt>仅目标
            <dd>只有目标对像素颜色做出贡献
            <dt>两者
            <dd>源和目标 - 源和目标都可能组合定义像素颜色
            <dt>无
            <dd>无源或目标 - 两者都不对最终像素颜色做出贡献
        </dl>
        <p class="note" role="note"><span class="marker">注意：</span>目标与背景同义。在本节中使用“目标”这一术语，因为这是使用 Porter Duff
            合成时的标准。此外，合成操作符名称中使用了 <span class="css">destination</span>。</p>
        <div class="figure">
            <p style="text-align:center"><img alt="受 Porter Duff 影响的区域概述"
                    src="https://www.w3.org/TR/compositing-1/examples/PD_regions.svg"></p>
            <p class="caption"></p>
        </div>
        <p>每个区域对最终像素颜色的贡献由该像素的形状覆盖范围和使用的操作符定义。
            覆盖范围用 alpha 表示。完整的 alpha (1) 表示完全覆盖，而 alpha 为零 (0) 表示没有覆盖。
            这意味着子像素中每个区域的面积取决于对像素贡献的每个形状的覆盖范围。
            每个区域的面积可以通过以下公式计算：</p>
        <div class="data">
            <table>
                <tbody>
                    <tr>
                        <th>两者
                        <th>αs x αb
                    <tr>
                        <th>仅源
                        <th>αs x (1 – αb)
                    <tr>
                        <th>仅目标
                        <th>αb x (1 – αs)
                    <tr>
                        <th>无
                        <th>(1 – αs) x (1 – αb)
            </table>
        </div>
        <p>上图表示源和目标的覆盖范围均为 0.5。</p>
        <pre>两者 = 0.5 x 0.5 = 0.25
仅源 = 0.5 (1 – 0.5) = 0.25
仅目标 = 0.5(1 – 0.5) = 0.25
无 = (1 – 0.5)(1 – 0.5) = 0.25
</pre>
        <p>因此，在此示例中，每个区域的覆盖范围为 0.25。</p>
        <h3 class="heading settled" data-level="9.1" id="porterduffcompositingoperators"><span class="secno">9.1.
            </span><span class="content">Porter Duff 合成操作符</span><a class="self-link"
                href="#porterduffcompositingoperators"></a></h3>
        <p>Lucasfilm 的 Thomas Porter 和 Tom Duff 的开创性论文定义了合成的代数并开发了十二个“Porter
            Duff”操作符。这些操作符控制着图形对象重叠形成的四个子像素区域的混合结果，这些图形对象具有 alpha 或像素覆盖通道/值。操作符使用了四个区域的所有实际组合。</p>
        <p>共有 12 个基本的 Porter Duff 操作符，满足源和目标的所有可能组合。</p>
        <p>从每个操作符的几何表示可以看出，每个形状的贡献表示为输出总覆盖范围的一个分数。
            例如，在 source-over 模式中，源的可能贡献为全部 (1)，目标的可能贡献为剩余的部分 (1 – αs)。这由源和目标的覆盖范围修改，以得出像素最终覆盖范围的公式：</p>
        <pre>αo = αs x 1 + αb x (1 – αs)
</pre>
        <p>分数项 Fa（此示例中的 1）和 Fb（此示例中的 1 – αs）由每个操作符定义，并指定可能对最终像素值贡献的形状分数。
            覆盖范围的通用公式为：</p>
        <pre>αs x Fa + αb x Fb
</pre>
        <p>结合颜色，得到 Porter Duff 的通用公式</p>
        <pre>co = αs x Fa x Cs + αb x Fb x Cb
</pre>
        <p>其中：</p>
        <ul>
            <li>co 是与输出 alpha 相乘的输出颜色 [0 &lt;= co &lt;= 1]
            <li>αs 是源的覆盖范围 Fa 由操作符定义，控制源 Cs 的包含
                是源的颜色（未乘以 alpha）
            <li>αb 是目标的覆盖范围 Fb 由操作符定义，控制目标的包含
                Cb 是目标的颜色（未乘以 alpha）
        </ul>
        <h4 class="heading settled" data-level="9.1.1" id="porterduffcompositingoperators_clear"><span
                class="secno">9.1.1. </span><span class="content">清除</span><a class="self-link"
                href="#porterduffcompositingoperators_clear"></a></h4>
        <p>没有启用的区域。</p>
        <div class="figure">
            <img alt="Porter Duff 清除示例" src="https://www.w3.org/TR/compositing-1/examples/PD_clr.svg">
            <p class="caption"></p>
        </div>
        <pre>Fa = 0; Fb = 0
co = 0
αo = 0
</pre>
        <h4 class="heading settled" data-level="9.1.2" id="porterduffcompositingoperators_src"><span
                class="secno">9.1.2. </span><span class="content">复制</span><a class="self-link"
                href="#porterduffcompositingoperators_src"></a></h4>
        <p>只有源会显示。</p>
        <div class="figure">
            <img alt="Porter Duff 复制示例" src="https://www.w3.org/TR/compositing-1/examples/PD_src.svg">
            <p class="caption"></p>
        </div>
        <pre>Fa = 1; Fb = 0
co = αs x Cs
αo = αs
</pre>
        <h4 class="heading settled" data-level="9.1.3" id="porterduffcompositingoperators_dst"><span
                class="secno">9.1.3. </span><span class="content">目标</span><a class="self-link"
                href="#porterduffcompositingoperators_dst"></a></h4>
        <p>只有目标会显示。</p>
        <div class="figure">
            <img alt="Porter Duff 目标示例" src="https://www.w3.org/TR/compositing-1/examples/PD_dst.svg">
            <p class="caption"></p>
        </div>
        <pre>Fa = 0; Fb = 1
co = αb x Cb
αo = αb
</pre>
        <h4 class="heading settled" data-level="9.1.4" id="porterduffcompositingoperators_srcover"><span
                class="secno">9.1.4. </span><span class="content">源覆盖</span><a class="self-link"
                href="#porterduffcompositingoperators_srcover"></a></h4>
        <p>源被放置在目标上方。</p>
        <div class="figure">
            <img alt="Porter Duff 源覆盖示例" src="https://www.w3.org/TR/compositing-1/examples/PD_src-over.svg">
            <p class="caption"></p>
        </div>
        <pre>Fa = 1; Fb = 1 – αs
co = αs x Cs + αb x Cb x (1 – αs)
αo = αs + αb x (1 – αs)
</pre>
        <h4 class="heading settled" data-level="9.1.5" id="porterduffcompositingoperators_dstover"><span
                class="secno">9.1.5. </span><span class="content">目标覆盖</span><a class="self-link"
                href="#porterduffcompositingoperators_dstover"></a></h4>
        <p>目标被放置在源上方。</p>
        <div class="figure">
            <img alt="Porter Duff 目标覆盖示例" src="https://www.w3.org/TR/compositing-1/examples/PD_dst-over.svg">
            <p class="caption"></p>
        </div>
        <pre>Fa = 1 – αb; Fb = 1
co = αs x Cs x (1 – αb) + αb x Cb
αo = αs x (1 – αb) + αb
</pre>
        <h4 class="heading settled" data-level="9.1.6" id="porterduffcompositingoperators_srcin"><span
                class="secno">9.1.6. </span><span class="content">源内</span><a class="self-link"
                href="#porterduffcompositingoperators_srcin"></a></h4>
        <p>与目标重叠的源替换目标。</p>
        <div class="figure">
            <img alt="Porter Duff 源内示例" src="https://www.w3.org/TR/compositing-1/examples/PD_src-in.svg">
            <p class="caption"></p>
        </div>
        <pre>Fa = αb; Fb = 0
co = αs x Cs x αb
αo = αs x αb
</pre>
        <h4 class="heading settled" data-level="9.1.7" id="porterduffcompositingoperators_dstin"><span
                class="secno">9.1.7. </span><span class="content">目标内</span><a class="self-link"
                href="#porterduffcompositingoperators_dstin"></a></h4>
        <p>与源重叠的目标替换源。</p>
        <div class="figure">
            <img alt="Porter Duff 目标内示例" src="https://www.w3.org/TR/compositing-1/examples/PD_dst-in.svg">
            <p class="caption"></p>
        </div>
        <pre>Fa = 0; Fb = αs
co = αb x Cb x αs
αo = αb x αs
</pre>
        <h4 class="heading settled" data-level="9.1.8" id="porterduffcompositingoperators_srcout"><span
                class="secno">9.1.8. </span><span class="content">源外</span><a class="self-link"
                href="#porterduffcompositingoperators_srcout"></a></h4>
        <p>源被放置在目标之外的地方。</p>
        <div class="figure">
            <img alt="Porter Duff 源外示例" src="https://www.w3.org/TR/compositing-1/examples/PD_src-out.svg">
            <p class="caption"></p>
        </div>
        <pre>Fa = 1 – αb; Fb = 0
co = αs x Cs x (1 – αb)
αo = αs x (1 – αb)
</pre>
        <h4 class="heading settled" data-level="9.1.9" id="porterduffcompositingoperators_dstout"><span
                class="secno">9.1.9. </span><span class="content">目标外</span><a class="self-link"
                href="#porterduffcompositingoperators_dstout"></a></h4>
        <p>目标被放置在源之外的地方。</p>
        <div class="figure">
            <img alt="Porter Duff 目标外示例" src="https://www.w3.org/TR/compositing-1/examples/PD_dst-out.svg">
            <p class="caption"></p>
        </div>
        <pre>Fa = 0; Fb = 1 – αs
co = αb x Cb x (1 – αs)
αo = αb x (1 – αs)
</pre>
        <h4 class="heading settled" data-level="9.1.10" id="porterduffcompositingoperators_srcatop"><span
                class="secno">9.1.10. </span><span class="content">源顶置</span><a class="self-link"
                href="#porterduffcompositingoperators_srcatop"></a></h4>
        <p>与目标重叠的源替换目标。目标被放置在其他地方。</p>
        <div class="figure">
            <img alt="Porter Duff 源顶置示例" src="https://www.w3.org/TR/compositing-1/examples/PD_src-atop.svg">
            <p class="caption"></p>
        </div>
        <pre>Fa = αb; Fb = 1 – αs
co = αs x Cs x αb + αb x Cb x (1 – αs)
αo = αs x αb + αb x (1 – αs)
</pre>
        <h4 class="heading settled" data-level="9.1.11" id="porterduffcompositingoperators_dstatop"><span
                class="secno">9.1.11. </span><span class="content">目标顶置</span><a class="self-link"
                href="#porterduffcompositingoperators_dstatop"></a></h4>
        <p>与源重叠的目标替换源。源被放置在其他地方。</p>
        <div class="figure">
            <img alt="Porter Duff 目标顶置示例" src="https://www.w3.org/TR/compositing-1/examples/PD_dst-atop.svg">
            <p class="caption"></p>
        </div>
        <pre>Fa = 1 - αb; Fb = αs
co = αs x Cs x (1 - αb) + αb x Cb x αs
αo = αs x (1 - αb) + αb x αs
</pre>
        <h4 class="heading settled" data-level="9.1.12" id="porterduffcompositingoperators_xor"><span
                class="secno">9.1.12. </span><span class="content">异或 (XOR)</span><a class="self-link"
                href="#porterduffcompositingoperators_xor"></a></h4>
        <p>源和目标的非重叠区域被组合。</p>
        <div class="figure">
            <img alt="Porter Duff 异或示例" src="https://www.w3.org/TR/compositing-1/examples/PD_xor.svg">
            <p class="caption"></p>
        </div>
        <pre>Fa = 1 - αb; Fb = 1 – αs
co = αs x Cs x (1 - αb) + αb x Cb x (1 – αs)
αo = αs x (1 - αb) + αb x (1 – αs)
</pre>
        <h4 class="heading settled" data-level="9.1.13" id="porterduffcompositingoperators_plus"><span
                class="secno">9.1.13. </span><span class="content">更亮</span><a class="self-link"
                href="#porterduffcompositingoperators_plus"></a></h4>
        <p>显示源图像和目标图像的总和。它在 Porter Duff 论文中被定义为 <span class="css">plus</span> 操作符 <a data-link-type="biblio"
                href="#biblio-porterduff" title="数字图像合成">[PORTERDUFF]</a>。</p>
        <pre>Fa = 1; Fb = 1
co = αs x Cs + αb x Cb;
αo = αs + αb
</pre>
        <h3 class="heading settled" data-level="9.2" id="groupcompositing"><span class="secno">9.2. </span><span
                class="content">组合群组行为与Porter Duff模式</span><a class="self-link" href="#groupcompositing"></a></h3>
        <p>在隔离的群组内组合元素时，这些元素会被组合在透明的黑色初始背景上。如果群组中的底层元素使用依赖背景的Porter Duff组合操作符，比如
            <a href="#porterduffcompositingoperators_dst">destination</a>、
            <a href="#porterduffcompositingoperators_srcin">source-in</a>、
            <a href="#porterduffcompositingoperators_dstin">destination-in</a>、
            <a href="#porterduffcompositingoperators_dstout">destination-out</a>或
            <a href="#porterduffcompositingoperators_srcatop">source-atop</a>，
            那么组合结果将会是空的。群组内后续的元素将与第一次组合的结果进行组合。
        </p>
        <h2 class="heading settled" data-level="10" id="blending"><span class="secno">10. </span><span
                class="content">混合</span><a class="self-link" href="#blending"></a></h2>
        <p>混合是组合的一个方面，它计算源元素和<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop⑧">背景</a>重叠区域的颜色混合。
            <br> 概念上，源元素中的颜色在与背景混合时被保留在原地。混合后，修改过的源元素与背景进行组合。
            实际上，这通常是一步完成的。<br>混合计算不能使用预乘色值。
        </p>
        <p>“混合”公式定义为：</p>
        <pre>Cm = B(Cb, Cs)
</pre>
        <p>其中：</p>
        <ul>
            <li>Cm：混合后的结果颜色
            <li>B：执行混合的公式
            <li>Cb：<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop⑨">背景</a>颜色
            <li>Cs：源颜色
        </ul>
        <p>混合公式的结果必须被限制在颜色范围的最小和最大值之间。</p>
        <p>混合函数的结果受背景透明度的调制。完全不透明的背景允许混合函数完全实现。透明背景会导致最终结果是源颜色和混合颜色之间的加权平均，权重由背景透明度控制。
            新颜色的值变为：</p>
        <pre>Cr = (1 - αb) x Cs + αb x B(Cb, Cs)
</pre>
        <p>其中：</p>
        <ul>
            <li>Cr：结果颜色
            <li>B：执行混合的公式
            <li>Cs：源颜色
            <li>Cb：<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop①⓪">背景</a>颜色
            <li>αb：<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop①①">背景</a>透明度
        </ul>
        <div class="example" id="ex-blend-with-opacity">
            <a class="self-link" href="#ex-blend-with-opacity"></a>
            <div class="figure">
                <img alt="带透明度的混合示例" src="https://www.w3.org/TR/compositing-1/examples/blend_background_opacity.svg">
                <p class="caption"></p>
            </div>
            <p> 此示例展示了一个红色矩形带有混合模式，并放置在一组具有不同不透明度的绿色矩形上方。</p>
            <p> 请注意，随着<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop①②">背景</a>透明度的降低，顶部矩形颜色逐渐向红色过渡。</p>
        </div>
        <p class="note" role="note"> 注意：以下公式给出了源和背景交叠区域的颜色值，然后与指定的Porter Duff组合公式进行组合。对于简单的alpha混合，公式变为： </p>
        <pre>简单alpha混合:
    co = cs + cb x (1 - αs)
写为非预乘形式:
    αo x Co = αs x Cs + (1 - αs) x αb x Cb
现在将混合结果代入Cs:
    αo x Co = αs x ((1 - αb) x Cs + αb x B(Cb, Cs)) + (1 - αs) x αb x Cb
            = αs x (1 - αb) x Cs + αs x αb x B(Cb, Cs) + (1 - αs) x αb x Cb
</pre>
        <p></p>
        <h3 class="heading settled" data-level="10.1" id="blendingseparable"><span class="secno">10.1. </span><span
                class="content">可分离混合模式</span><a class="self-link" href="#blendingseparable"></a></h3>
        <p>如果结果颜色的每个分量完全由组成的<a data-link-type="dfn" href="#backdrop"
                id="ref-for-backdrop①③">背景</a>和源颜色的相应分量确定，则这种混合模式称为可分离的，即混合公式<strong>分别</strong>应用于每组相应的分量。
        </p>
        <p>以下每种混合模式都将在每个颜色分量上应用混合函数B(Cb, Cs)。为简化起见，本章中的所有示例都使用<a
                href="#porterduffcompositingoperators_srcover">源覆盖</a>组合。</p>
        <h4 class="heading settled" data-level="10.1.1" id="blendingnormal"><span class="secno">10.1.1. </span><span
                class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-normal">正常</dfn>混合模式</span><a class="self-link"
                href="#blendingnormal"></a></h4>
        <p>这是默认属性，指定无混合。混合公式简单地选择源颜色。</p>
        <pre>B(Cb, Cs) = Cs
</pre>
        <div class="figure">
            <img alt="正常混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/normal.png" width="200">
            <p class="caption"></p>
        </div>
        <h4 class="heading settled" data-level="10.1.2" id="blendingmultiply"><span class="secno">10.1.2. </span><span
                class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-multiply">正片叠底</dfn>混合模式</span><a class="self-link"
                href="#blendingmultiply"></a></h4>
        <p>源颜色与目标颜色相乘并替换目标颜色。</p>
        <p>结果颜色总是与源或目标颜色一样深或更深。将任何颜色与黑色相乘会产生黑色，将任何颜色与白色相乘会保留原始颜色。</p>
        <pre>B(Cb, Cs) = Cb x Cs
</pre>
        <div class="figure">
            <img alt="正片叠底混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/multiply.png"
                width="200">
            <p class="caption"></p>
        </div>
        <h4 class="heading settled" data-level="10.1.3" id="blendingscreen"><span class="secno">10.1.3. </span><span
                class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-screen">滤色</dfn>混合模式</span><a class="self-link"
                href="#blendingscreen"></a></h4>
        <p>先乘以<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop①④">背景</a>和源颜色值的补色，然后补充结果。</p>
        <p>结果颜色总是与两个组成颜色中的任一个一样亮或更亮。用白色滤色产生白色；用黑色滤色保持原始颜色不变。效果类似于同时将多个幻灯片投影到一个屏幕上。</p>
        <pre>B(Cb, Cs) = 1 - [(1 - Cb) x (1 - Cs)]
          = Cb + Cs -(Cb x Cs)
</pre>
        <div class="figure">
            <img alt="滤色混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/screen.png" width="200">
            <p class="caption"></p>
        </div>
        <h4 class="heading settled" data-level="10.1.4" id="blendingoverlay"><span class="secno">10.1.4. </span><span
                class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-overlay">叠加</dfn>混合模式</span><a class="self-link"
                href="#blendingoverlay"></a></h4>
        <p>根据<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop①⑤">背景</a>颜色值对颜色进行相乘或滤色处理。</p>
        <p>源颜色叠加在<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop①⑥">背景</a>上，同时保留其高光和阴影。<span
                id="ref-for-backdrop①⑦">背景</span>颜色不会被替换，而是与源颜色混合以反映<span id="ref-for-backdrop①⑧">背景</span>的亮度或暗度。</p>
        <pre>B(Cb, Cs) = 硬光(Cs, Cb)
</pre>
        <p>叠加是<a class="css" data-link-type="value" href="#valdef-blend-mode-hard-light"
                id="ref-for-valdef-blend-mode-hard-light①">硬光</a>混合模式的反向。请参阅<span
                id="ref-for-valdef-blend-mode-hard-light②">硬光</span>的定义以获取公式。</p>
        <div class="figure">
            <img alt="叠加混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/overlay.png" width="200">
            <p class="caption"></p>
        </div>
        <h4 class="heading settled" data-level="10.1.5" id="blendingdarken"><span class="secno">10.1.5. </span><span
                class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-darken">变暗</dfn>混合模式</span><a class="self-link"
                href="#blendingdarken"></a></h4>
        <p>选择<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop①⑨">背景</a>和源颜色中较暗的颜色。</p>
        <p>当源颜色较暗时，<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop②⓪">背景</a>将被替换；否则保持不变。</p>
        <pre>B(Cb, Cs) = min(Cb, Cs)
</pre>
        <div class="figure">
            <img alt="变暗混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/darken.png" width="200">
            <p class="caption"></p>
        </div>
        <h4 class="heading settled" data-level="10.1.6" id="blendinglighten"><span class="secno">10.1.6. </span><span
                class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-lighten">变亮</dfn>混合模式</span><a class="self-link"
                href="#blendinglighten"></a></h4>
        <p>选择<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop②①">背景</a>和源颜色中较亮的颜色。</p>
        <p>当源颜色较亮时，<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop②②">背景</a>将被替换；否则保持不变。</p>
        <pre>B(Cb, Cs) = max(Cb, Cs)
</pre>
        <p>如果结果超出范围，必须向下取整。</p>
        <div class="figure">
            <img alt="变亮混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/lighten.png" width="200">
            <p class="caption"></p>
        </div>
        <h4 class="heading settled" data-level="10.1.7" id="blendingcolordodge"><span class="secno">10.1.7. </span><span
                class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-color-dodge">颜色减淡</dfn>混合模式</span><a class="self-link"
                href="#blendingcolordodge"></a></h4>
        <p>使<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop②③">背景</a>颜色变亮以反映源颜色。使用黑色绘制不会产生任何变化。</p>
        <pre>if(Cb == 0)
    B(Cb, Cs) = 0
else if(Cs == 1)
    B(Cb, Cs) = 1
else
    B(Cb, Cs) = min(1, Cb / (1 - Cs))
</pre>
        <div class="figure">
            <img alt="颜色减淡混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/colordodge.png"
                width="200">
            <p class="caption"></p>
        </div>
        <h4 class="heading settled" data-level="10.1.8" id="blendingcolorburn"><span class="secno">10.1.8. </span><span
                class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-color-burn">颜色加深</dfn>混合模式</span><a class="self-link"
                href="#blendingcolorburn"></a></h4>
        <p>使<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop②④">背景</a>颜色变暗以反映源颜色。使用白色绘制不会产生任何变化。</p>
        <pre>if(Cb == 1)
    B(Cb, Cs) = 1
else if(Cs == 0)
    B(Cb, Cs) = 0
else
    B(Cb, Cs) = 1 - min(1, (1 - Cb) / Cs)
</pre>
        <div class="figure">
            <img alt="颜色加深混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/colorburn.png"
                width="200">
            <p class="caption"></p>
        </div>
        <h4 class="heading settled" data-level="10.1.9" id="blendinghardlight"><span class="secno">10.1.9. </span><span
                class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-hard-light">硬光</dfn>混合模式</span><a class="self-link"
                href="#blendinghardlight"></a></h4>
        <p>根据源颜色值对颜色进行相乘或滤色处理。效果类似于用强烈的聚光灯照射<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop②⑤">背景</a>。</p>
        <pre>if(Cs &lt;= 0.5)
    B(Cb, Cs) = 正片叠底(Cb, 2 x Cs)
else
    B(Cb, Cs) = 滤色(Cb, 2 x Cs -1)
</pre>
        <p>请参阅<a class="css" data-link-type="value" href="#valdef-blend-mode-multiply"
                id="ref-for-valdef-blend-mode-multiply①">正片叠底</a>和<a class="css" data-link-type="value"
                href="#valdef-blend-mode-screen" id="ref-for-valdef-blend-mode-screen①">滤色</a>的定义以获取它们的公式。
        </p>
        <div class="figure">
            <img alt="硬光混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/hardlight.png" width="200">
            <p class="caption"></p>
        </div>
        <h4 class="heading settled" data-level="10.1.10" id="blendingsoftlight"><span class="secno">10.1.10.
            </span><span class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-soft-light">柔光</dfn>混合模式</span><a class="self-link"
                href="#blendingsoftlight"></a></h4>
        <p>根据源颜色值对颜色进行变暗或变亮处理。效果类似于用柔和的聚光灯照射<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop②⑥">背景</a>。</p>
        <pre>    if(Cs &lt;= 0.5)
        B(Cb, Cs) = Cb - (1 - 2 x Cs) x Cb x (1 - Cb)
    else
        B(Cb, Cs) = Cb + (2 x Cs - 1) x (D(Cb) - Cb)
with
    if(Cb &lt;= 0.25)
        D(Cb) = ((16 * Cb - 12) x Cb + 4) x Cb
    else
        D(Cb) = sqrt(Cb)
</pre>
        <div class="figure">
            <img alt="柔光混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/softlight.png" width="200">
            <p class="caption"></p>
        </div>
        <h4 class="heading settled" data-level="10.1.11" id="blendingdifference"><span class="secno">10.1.11.
            </span><span class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-difference">差值</dfn>混合模式</span><a class="self-link"
                href="#blendingdifference"></a></h4>
        <p>从较亮的颜色中减去两种组成颜色中的较暗者。</p>
        <p>用白色绘制会反转<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop②⑦">背景</a>颜色；用黑色绘制不会产生任何变化。</p>
        <pre>B(Cb, Cs) = | Cb - Cs |
</pre>
        <div class="figure">
            <img alt="差值混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/difference.png"
                width="200">
            <p class="caption"></p>
        </div>
        <h4 class="heading settled" data-level="10.1.12" id="blendingexclusion"><span class="secno">10.1.12.
            </span><span class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-exclusion">排除</dfn>混合模式</span><a class="self-link"
                href="#blendingexclusion"></a></h4>
        <p>产生类似于差值模式的效果，但对比度较低。用白色绘制会反转<a data-link-type="dfn" href="#backdrop"
                id="ref-for-backdrop②⑧">背景</a>颜色；用黑色绘制不会产生任何变化。</p>
        <pre>B(Cb, Cs) = Cb + Cs - 2 x Cb x Cs
</pre>
        <div class="figure">
            <img alt="排除混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/exclusion.png" width="200">
            <p class="caption"></p>
        </div>
        <h3 class="heading settled" data-level="10.2" id="blendingnonseparable"><span class="secno">10.2. </span><span
                class="content">不可分离混合模式</span><a class="self-link" href="#blendingnonseparable"></a>
        </h3>
        <p>不可分离的混合模式结合所有颜色分量，而不是像可分离的那样单独考虑每个分量。
            所有这些混合模式概念上都涉及以下步骤：</p>
        <ol>
            <li>将<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop②⑨">背景</a>和源颜色从混合颜色空间转换为中间的色相-饱和度-亮度表示。
            <li>从<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop③⓪">背景</a>和源颜色中选择的色相、饱和度和亮度组件组合创建新颜色。
            <li>将结果转换回原始颜色空间。
        </ol>
        <p>不可分离的混合模式公式使用几个辅助函数：</p>
        <pre>    Lum(C) = 0.3 x Cred + 0.59 x Cgreen + 0.11 x Cblue

    ClipColor(C)
        L = Lum(C)
        n = min(Cred, Cgreen, Cblue)
        x = max(Cred, Cgreen, Cblue)
        if(n &lt; 0)
            C = L + (((C - L) × L) / (L - n))

        if(x > 1)
            C = L + (((C - L) × (1 - L)) / (x - L))

        return C

    SetLum(C, l)
        d = l - Lum(C)
        Cred = Cred + d
        Cgreen = Cgreen + d
        Cblue = Cblue + d
        return ClipColor(C)

    Sat(C) = max(Cred, Cgreen, Cblue) - min(Cred, Cgreen, Cblue)

The subscripts min, mid, and max in the next function refer to the color
components having the minimum, middle, and maximum values upon entry to the function.

    SetSat(C, s)
        if(Cmax > Cmin)
            Cmid = (((Cmid - Cmin) x s) / (Cmax - Cmin))
            Cmax = s
        else
            Cmid = Cmax = 0
        Cmin = 0
        return C;
</pre>
        <h4 class="heading settled" data-level="10.2.1" id="blendinghue"><span class="secno">10.2.1. </span><span
                class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-hue">色相</dfn>混合模式</span><a class="self-link"
                href="#blendinghue"></a></h4>
        <p>使用源颜色的色相以及<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop③①">背景</a>颜色的饱和度和亮度创建颜色。</p>
        <pre>B(Cb, Cs) = SetLum(SetSat(Cs, Sat(Cb)), Lum(Cb))
</pre>
        <div class="figure">
            <img alt="色相混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/hue.png" width="200">
            <p class="caption"></p>
        </div>
        <h4 class="heading settled" data-level="10.2.2" id="blendingsaturation"><span class="secno">10.2.2. </span><span
                class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-saturation">饱和度</dfn>混合模式</span><a class="self-link"
                href="#blendingsaturation"></a></h4>
        <p>使用源颜色的饱和度以及<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop③②">背景</a>颜色的色相和亮度创建颜色。如果在<span
                id="ref-for-backdrop③③">背景</span>的纯灰色区域（无饱和度）上使用此模式绘制，不会产生任何变化。</p>
        <pre>B(Cb, Cs) = SetLum(SetSat(Cb, Sat(Cs)), Lum(Cb))
</pre>
        <div class="figure">
            <img alt="饱和度混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/saturation.png"
                width="200">
            <p class="caption"></p>
        </div>
        <h4 class="heading settled" data-level="10.2.3" id="blendingcolor"><span class="secno">10.2.3. </span><span
                class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-color">颜色</dfn>混合模式</span><a class="self-link"
                href="#blendingcolor"></a></h4>
        <p>使用源颜色的色相和饱和度以及<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop③④">背景</a>颜色的亮度创建颜色。这保留了<span
                id="ref-for-backdrop③⑤">背景</span>的灰度级，非常适合为单色图像着色或为彩色图像着色。</p>
        <pre>B(Cb, Cs) = SetLum(Cs, Lum(Cb))
</pre>
        <div class="figure">
            <img alt="颜色混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/color.png" width="200">
            <p class="caption"></p>
        </div>
        <h4 class="heading settled" data-level="10.2.4" id="blendingluminosity"><span class="secno">10.2.4. </span><span
                class="content"><dfn class="dfn-paneled css" data-dfn-for="<blend-mode>" data-dfn-type="value"
                    data-export id="valdef-blend-mode-luminosity">亮度</dfn>混合模式</span><a class="self-link"
                href="#blendingluminosity"></a></h4>
        <p>使用源颜色的亮度以及<a data-link-type="dfn" href="#backdrop" id="ref-for-backdrop③⑥">背景</a>颜色的色相和饱和度创建颜色。此效果与颜色模式相反。
        </p>
        <pre>B(Cb, Cs) = SetLum(Cb, Lum(Cs))
</pre>
        <div class="figure">
            <img alt="亮度混合示例" height="200" src="https://www.w3.org/TR/compositing-1/examples/luminosity.png"
                width="200">
            <p class="caption"></p>
        </div>
        <h3 class="heading settled" data-level="10.3" id="isolationblending"><span class="secno">10.3. </span><span
                class="content">隔离组对混合的影响</span><a class="self-link" href="#isolationblending"></a></h3>
        <p class="note" role="note"><span class="marker">注意：</span> 在下面的例子中，用于构造纸飞机的元素位于一个组内。每个元素的混合模式都设置为 multiply。</p>
        <div class="example" id="ex-isolated-group">
            <a class="self-link" href="#ex-isolated-group"></a> 左边的飞机是普通组，右边的飞机是一个<a href="#isolatedgroups">隔离组</a>。
            <p></p>
            <p> 在隔离组中，组内的元素被组合到一个空的初始背景上，这阻止了组内的元素与背景相乘。
                在普通组中，组内的元素组合到包含土地和天空的初始背景上。因此，飞机的元素与土地和天空相乘。
                在这两种情况下，组合成的结果都通过正常的混合模式（应用于组的默认混合模式）与土地和天空组合。 </p>
            <div class="figure">
                <img alt="隔离组混合示例" height="200"
                    src="https://www.w3.org/TR/compositing-1/examples/isolate_blend_example.png" width="506">
                <p class="caption"></p>
            </div>
        </div>
        <h2 class="no-num heading settled" id="privacy"><span class="content">隐私注意事项</span><a class="self-link"
                href="#privacy"></a></h2>
        <p>此规范未报告任何新的隐私问题。</p>
        <h2 class="no-num heading settled" id="security"><span class="content">安全注意事项</span><a class="self-link"
                href="#security"></a></h2>
        <p>重要的是，混合和合成操作的时间与源像素和目标像素无关。操作的实现方式必须确保无论像素值如何，操作所需的时间始终相同。</p>
        <p></p>
        <div class="note" role="note">
            <p> 如果不遵守此规则，攻击者可能会推断出信息并发动计时攻击。 </p>
            <p>计时攻击是一种基于研究操作发生所需时间的方法，用于获取受保护的内容。如果，例如，绘制红色像素比绘制绿色像素花费更多时间，攻击者可能在没有访问元素内容的情况下重建元素的粗略图像。</p>
        </div>
        <h2 class="no-num heading settled" id="changes"><span class="content">更改</span><a class="self-link"
                href="#changes"></a></h2>
        <p>相对于<a href="https://www.w3.org/TR/2015/CR-compositing-1-20150113/">2015年1月13日候选推荐标准</a>做出了以下更改：</p>
        <ul>
            <li>添加了隐私和安全章节
            <li>更新了“可动画：否”为“动画类型：离散”
            <li>定义了 HTML 和 SVG 的根元素及根元素组
            <li>澄清了根组不一定是不透明的白色
            <li>为根组和隔离组提供了更好的定义
            <li>一致地使用乘号 ×，而不是 x 或 *
            <li>更正了使用 <a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-green"
                    id="ref-for-valdef-color-green">绿色</a>示例中的错误，该示例本应使用 <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-4/#valdef-color-lime" id="ref-for-valdef-color-lime">柠檬绿</a>
            <li>更正了 background-blend-mode 的初始值
            <li>各种标记和链接修复
        </ul>
        <p>相对于<a href="https://www.w3.org/TR/2014/CR-compositing-1-20140220/">2014年2月20日候选推荐标准</a>做出的更改：</p>
        <ul>
            <li>强制隔离嵌入为 &lt;img> 的 SVG 图像已不再存在风险
            <li>移除了 <a class="production css" data-link-type="type" href="#compositemode"
                    id="ref-for-compositemode②">&lt;合成模式></a>中目的地作为选项
        </ul>
        <p>相对于<a href="https://www.w3.org/TR/2013/WD-compositing-1-20131010/">2014年1月7日最后一次工作草案</a>做出的更改：</p>
        <ul>
            <li>移除了不需要的规范性和信息性参考文献
        </ul>
        <p>相对于<a href="https://www.w3.org/TR/2013/WD-compositing-1-20131010/">2013年10月10日工作草案</a>做出的更改：</p>
        <ul>
            <li>从 SVG 中移除了将剪辑作为创建隔离组的操作之一
            <li>修改了 background-blend-mode，使其与其他背景语法的重复行为匹配
            <li>移除了 mix-composite 属性
            <li>解决了所有未解决的问题
        </ul>
        <details class="wpt-tests-block" data-var-ignore dir="ltr" lang="en" open>
            <summary>测试</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/compositing/opacity-and-transform-animation-crash.html"
                        title="css/compositing/opacity-and-transform-animation-crash.html">opacity-and-transform-animation-crash.html</a>
                    <a class="wpt-live"
                        href="http://wpt.live/css/compositing/opacity-and-transform-animation-crash.html"><small>(实时测试)</small></a>
                    <a class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/compositing/opacity-and-transform-animation-crash.html"><small>(来源)</small></a>
            </ul>
        </details>
    </main>
    <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">符合性</span><a class="self-link"
            href="#w3c-conformance"></a></h2>
    <h3 class="no-ref heading settled" id="w3c-conventions"><span class="content">文档约定</span><a class="self-link"
            href="#w3c-conventions"></a></h3>
    <p>符合性要求通过描述性声明和 RFC 2119 术语的组合来表达。规范中的“必须”（MUST）、“不得”（MUST NOT）、“需要”（REQUIRED）、“应”（SHALL）、“不应”（SHALL
        NOT）、“应”（SHOULD）、“不应”（SHOULD NOT）、“推荐”（RECOMMENDED）、“可以”（MAY）和“可选”（OPTIONAL）等关键词应按 RFC 2119 的描述进行解释。
        然而，为了可读性，本规范中这些词汇并没有全部大写。</p>
    <p>本规范中的所有文本均为规范性内容，除明确标记为非规范性的部分、示例和注释外。<a data-link-type="biblio" href="#biblio-rfc2119"
            title="用于表明 RFC 中要求级别的关键词">[RFC2119]</a></p>
    <p>本规范中的示例以“例如”开头，或与规范性文本分开，使用<code>class="example"</code>，例如：</p>
    <div class="example" id="w3c-example">
        <a class="self-link" href="#w3c-example"></a>
        <p>这是一个信息性示例。</p>
    </div>
    <p>信息性注释以“注”开头，且与规范性文本分开，使用<code>class="note"</code>，例如：</p>
    <p class="note" role="note">注，这是一个信息性注释。</p>
    <p>告示是需要特别关注的规范性部分，使用<strong class="advisement">样式声明，像这样：</strong><strong class="advisement"> UA
            必须提供可访问的替代方案。</strong></p>
    <details class="wpt-tests-block" dir="ltr" lang="en" open>
        <summary>测试</summary>
        <p>与本规范内容相关的测试可能会记录在类似于此的“测试”块中。任何此类块都是非规范性的。</p>
        <ul class="wpt-tests-list"></ul>
        <hr>
    </details>
    <h3 class="no-ref heading settled" id="w3c-conformance-classes"><span class="content">符合性类别</span><a
            class="self-link" href="#w3c-conformance-classes"></a></h3>
    <p>本规范的符合性定义为三个符合性类别：</p>
    <dl>
        <dt>样式表
        <dd><a href="https://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS 样式表</a>。
        <dt>渲染器
        <dd>解释样式表语义并渲染使用它们的文档的<a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">用户代理</a>。
        <dt>创作工具
        <dd>编写样式表的<a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">用户代理</a>。
    </dl>
    <p>如果样式表中使用的语法符合通用 CSS 语法和本模块中每个功能定义的语法，则该样式表符合本规范。</p>
    <p>如果渲染器除了按照相关规范解释样式表外，还通过正确解析并渲染文档来支持本规范中定义的所有功能，则该渲染器符合本规范。然而，由于设备限制而无法正确渲染文档并不意味着 UA 不符合规范。（例如，UA
        不需要在单色显示器上渲染颜色。）</p>
    <p>如果创作工具编写的样式表在语法上符合通用 CSS 语法和本模块中每个功能的语法，并满足本模块描述的样式表的所有其他符合性要求，则该创作工具符合本规范。</p>
    <h3 class="no-ref heading settled" id="w3c-partial"><span class="content">部分实现</span><a class="self-link"
            href="#w3c-partial"></a></h3>
    <p>为了使作者能够利用向前兼容的解析规则分配回退值，CSS
        渲染器<strong>必须</strong>将无法使用的级别支持的任何规则、属性、属性值、关键字以及其他语法构造视为无效，并<strong>按适当方式</strong><a
            href="https://www.w3.org/TR/CSS21/conform.html#ignore">忽略</a>它们。特别是，用户代理<strong>不得</strong>选择性忽略不支持的组件值并在单个多值属性声明中应用支持的值：如果任何值被视为无效（如不支持的值必须这样），CSS
        要求忽略整个声明。</p>
    <h4 class="heading settled" id="w3c-conform-future-proofing"><span class="content">不稳定和专有功能的实现</span><a
            class="self-link" href="#w3c-conform-future-proofing"></a></h4>
    <p>为了避免与未来稳定的 CSS 功能发生冲突，CSSWG 建议遵循<a href="https://www.w3.org/TR/CSS/#future-proofing">最佳实践</a>来实现<a
            href="https://www.w3.org/TR/CSS/#unstable">不稳定</a>功能和<a
            href="https://www.w3.org/TR/CSS/#proprietary-extension">专有扩展</a>到 CSS。</p>
    <h3 class="no-ref heading settled" id="w3c-testing"><span class="content">非实验性实现</span><a class="self-link"
            href="#w3c-testing"></a></h3>
    <p>一旦规范进入候选推荐阶段，可以进行非实验性实现，且实现者应发布任何 CR 级别功能的无前缀实现，前提是他们能够证明这些功能根据规范被正确实现。</p>
    <p>为了建立并维护 CSS 在不同实现之间的互操作性，CSS 工作组要求非实验性 CSS 渲染器在发布任何 CSS 功能的无前缀实现之前，向 W3C 提交实现报告（如有必要，还需提交该实现报告使用的测试用例）。提交给 W3C
        的测试用例将由 CSS 工作组进行审查和修正。</p>
    <p>有关提交测试用例和实现报告的进一步信息，请访问 CSS 工作组的网站：<a
            href="https://www.w3.org/Style/CSS/Test/">https://www.w3.org/Style/CSS/Test/</a>。问题请发送到 <a
            href="https://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a> 邮件列表。</p>
    <h3 class="no-ref heading settled" id="w3c-cr-exit-criteria"><span class="content">CR 退出标准</span><a
            class="self-link" href="#w3c-cr-exit-criteria"></a></h3>
    <p>为了将本规范推进到建议推荐阶段，每个功能至少需要有两个独立的、可互操作的实现。每个功能可以由不同的产品集实现，不要求所有功能都由单一产品实现。为满足此标准，以下术语定义如下：</p>
    <dl>
        <dt>独立的
        <dd>每个实现必须由不同的方开发，且不能共享、重用或派生自另一合格实现使用的代码。与本规范的实现无关的代码部分不受此要求的约束。
        <dt>可互操作的
        <dd>通过官方 CSS 测试套件中的相应测试用例，或者如果实现不是 Web 浏览器，则通过等效的测试。每个相关的测试在测试套件中应有等效的测试创建，如果使用此类用户代理（UA）声称互操作性，则必须有一个或多个其他 UA
            也能以相同的方式通过这些等效测试以实现互操作性。等效测试必须公开供同行评审。
        <dt>实现
        <dd>
            一个用户代理，它：
            <ol class="inline">
                <li>实现了规范。
                <li>向公众开放。该实现可以是正式发布的产品，也可以是其他公开可用的版本（如测试版、预览版或“每夜构建”）。非正式发布的产品必须至少实现这些功能一个月，以证明其稳定性。
                <li>不是实验性的（即，专为通过测试套件而设计的版本，且不打算继续作为常规使用版本）。
            </ol>
    </dl>
    <p>该规范将至少保持候选推荐状态六个月。</p>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本规范定义的术语</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#backdrop">backdrop</a><span>，见 § 7</span>
        <li><a href="#propdef-background-blend-mode">background-blend-mode</a><span>，见 § 3.4.3</span>
        <li><a href="#ltblendmodegt">&lt;blend-mode></a><span>，见 § 3.4.1</span>
        <li><a href="#valdef-blend-mode-color">color</a><span>，见 § 10.2.3</span>
        <li><a href="#valdef-blend-mode-color-burn">color-burn</a><span>，见 § 10.1.8</span>
        <li><a href="#valdef-blend-mode-color-dodge">color-dodge</a><span>，见 § 10.1.7</span>
        <li><a href="#compositemode">&lt;composite-mode></a><span>，见 § 4</span>
        <li><a href="#valdef-blend-mode-darken">darken</a><span>，见 § 10.1.5</span>
        <li><a href="#valdef-blend-mode-difference">difference</a><span>，见 § 10.1.11</span>
        <li><a href="#valdef-blend-mode-exclusion">exclusion</a><span>，见 § 10.1.12</span>
        <li><a href="#valdef-blend-mode-hard-light">hard-light</a><span>，见 § 10.1.9</span>
        <li><a href="#valdef-blend-mode-hue">hue</a><span>，见 § 10.2.1</span>
        <li><a href="#propdef-isolation">isolation</a><span>，见 § 3.4.2</span>
        <li><a href="#isolated-propid">&lt;isolation-mode></a><span>，见 § 3.4.2</span>
        <li><a href="#valdef-blend-mode-lighten">lighten</a><span>，见 § 10.1.6</span>
        <li><a href="#valdef-blend-mode-luminosity">luminosity</a><span>，见 § 10.2.4</span>
        <li><a href="#propdef-mix-blend-mode">mix-blend-mode</a><span>，见 § 3.4.1</span>
        <li><a href="#valdef-blend-mode-multiply">multiply</a><span>，见 § 10.1.2</span>
        <li><a href="#valdef-blend-mode-normal">normal</a><span>，见 § 10.1.1</span>
        <li><a href="#valdef-blend-mode-overlay">overlay</a><span>，见 § 10.1.4</span>
        <li><a href="#valdef-blend-mode-saturation">saturation</a><span>，见 § 10.2.2</span>
        <li><a href="#valdef-blend-mode-screen">screen</a><span>，见 § 10.1.3</span>
        <li><a href="#valdef-blend-mode-soft-light">soft-light</a><span>，见 § 10.1.10</span>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">由引用定义的术语</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[CSS-COLOR-4]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="45dae945">green</span>
                <li><span class="dfn-paneled" id="f8e15dd7">lime</span>
                <li><span class="dfn-paneled" id="3b7558dc">opacity</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-MASKING-1]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="5b43edf4">mask</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-VALUES-4]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="c297b070">#</span>
                <li><span class="dfn-paneled" id="4eb9d37e">|</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS3BG]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="db6870d5">background</span>
                <li><span class="dfn-paneled" id="5ced56d0">background-image</span>
            </ul>
        <li>
            <a data-link-type="biblio">[HTML]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="2f0492ac">body</span>
                <li><span class="dfn-paneled" id="33db4476">globalCompositeOperation</span>
                <li><span class="dfn-paneled" id="f0811ff8">img</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">规范性参考文献</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-css-color-4">[CSS-COLOR-4]
        <dd>Tab Atkins Jr.; Chris Lilley; Lea Verou. <a href="https://www.w3.org/TR/css-color-4/"><cite>CSS Color Module
                    Level 4</cite></a>. 2022年11月1日. CR. URL: <a
                href="https://www.w3.org/TR/css-color-4/">https://www.w3.org/TR/css-color-4/</a>
        <dt id="biblio-css-masking-1">[CSS-MASKING-1]
        <dd>Dirk Schulze; Brian Birtles; Tab Atkins Jr.. <a href="https://www.w3.org/TR/css-masking-1/"><cite>CSS
                    Masking Module Level 1</cite></a>. 2021年8月5日. CR. URL: <a
                href="https://www.w3.org/TR/css-masking-1/">https://www.w3.org/TR/css-masking-1/</a>
        <dt id="biblio-css-values-4">[CSS-VALUES-4]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-4/"><cite>CSS Values and Units
                    Module Level 4</cite></a>. 2023年12月18日. WD. URL: <a
                href="https://www.w3.org/TR/css-values-4/">https://www.w3.org/TR/css-values-4/</a>
        <dt id="biblio-css21">[CSS21]
        <dd>Bert Bos 等. <a href="https://www.w3.org/TR/CSS21/"><cite>级联样式表 第2级修订版 (CSS 2.1) 规范</cite></a>. 2011年6月7日.
            REC. URL: <a href="https://www.w3.org/TR/CSS21/">https://www.w3.org/TR/CSS21/</a>
        <dt id="biblio-css3bg">[CSS3BG]
        <dd>Elika Etemad; Brad Kemper. <a href="https://www.w3.org/TR/css-backgrounds-3/"><cite>CSS Backgrounds and
                    Borders Module Level 3</cite></a>. 2023年12月19日. CR. URL: <a
                href="https://www.w3.org/TR/css-backgrounds-3/">https://www.w3.org/TR/css-backgrounds-3/</a>
        <dt id="biblio-html">[HTML]
        <dd>Anne van Kesteren 等. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML 标准</cite></a>. 现行标准. URL:
            <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
        <dt id="biblio-rfc2119">[RFC2119]
        <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>在RFC中指示需求等级的关键字</cite></a>.
            1997年3月. 最佳现行实践. URL: <a
                href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
        <dt id="biblio-svg11">[SVG11]
        <dd>Erik Dahlström 等. <a href="https://www.w3.org/TR/SVG11/"><cite>可缩放矢量图形 (SVG) 1.1 (第二版)</cite></a>.
            2011年8月16日. REC. URL: <a href="https://www.w3.org/TR/SVG11/">https://www.w3.org/TR/SVG11/</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">参考性参考文献</span><a class="self-link"
            href="#informative"></a></h3>
    <dl>
        <dt id="biblio-porterduff">[PORTERDUFF]
        <dd>Thomas Porter; Tom Duff. <cite>数字图像合成</cite>. 1984年7月.
    </dl>
    <h2 class="no-num no-ref heading settled" id="property-index"><span class="content">属性索引</span><a class="self-link"
            href="#property-index"></a></h2>
    <div class="big-element-wrapper">
        <table class="index">
            <thead>
                <tr>
                    <th scope="col">名称
                    <th scope="col">值
                    <th scope="col">初始值
                    <th scope="col">适用于
                    <th scope="col">继承性
                    <th scope="col">百分比
                    <th scope="col">动画类型
                    <th scope="col">规范顺序
                    <th scope="col">计算值
                    <th scope="col">媒体
            <tbody>
                <tr>
                    <th scope="row"><a class="css" data-link-type="property" href="#propdef-background-blend-mode"
                            id="ref-for-propdef-background-blend-mode⑤">background-blend-mode</a>
                    <td>&lt;blend-mode>#
                    <td>normal
                    <td>所有HTML元素
                    <td>no
                    <td>N/A
                    <td>离散
                    <td>按语法
                    <td>按指定
                    <td>视觉
                <tr>
                    <th scope="row"><a class="css" data-link-type="property" href="#propdef-isolation"
                            id="ref-for-propdef-isolation②">isolation</a>
                    <td>&lt;isolation-mode>
                    <td>auto
                    <td>所有元素。在SVG中，它适用于容器元素、图形元素和图形引用元素。[SVG11]
                    <td>no
                    <td>N/A
                    <td>离散
                    <td>按语法
                    <td>按指定
                    <td>视觉
                <tr>
                    <th scope="row"><a class="css" data-link-type="property" href="#propdef-mix-blend-mode"
                            id="ref-for-propdef-mix-blend-mode①">mix-blend-mode</a>
                    <td>&lt;blend-mode>
                    <td>normal
                    <td>所有元素。在SVG中，它适用于容器元素、图形元素和图形引用元素。[SVG11]
                    <td>no
                    <td>N/A
                    <td>离散
                    <td>按语法
                    <td>按指定
                    <td>视觉
        </table>
    </div>
    <script>/* Boilerplate: script-dom-helper */
        "use strict";
        function query(sel) { return document.querySelector(sel); }

        function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

        function iter(obj) {
            if (!obj) return [];
            var it = obj[Symbol.iterator];
            if (it) return it;
            return Object.entries(obj);
        }

        function mk(tagname, attrs, ...children) {
            const el = document.createElement(tagname);
            for (const [k, v] of iter(attrs)) {
                if (k.slice(0, 3) == "_on") {
                    const eventName = k.slice(3);
                    el.addEventListener(eventName, v);
                } else if (k[0] == "_") {
                    // property, not attribute
                    el[k.slice(1)] = v;
                } else {
                    if (v === false || v == null) {
                        continue;
                    } else if (v === true) {
                        el.setAttribute(k, "");
                        continue;
                    } else {
                        el.setAttribute(k, v);
                    }
                }
            }
            append(el, children);
            return el;
        }

        /* Create shortcuts for every known HTML element */
        [
            "a",
            "abbr",
            "acronym",
            "address",
            "applet",
            "area",
            "article",
            "aside",
            "audio",
            "b",
            "base",
            "basefont",
            "bdo",
            "big",
            "blockquote",
            "body",
            "br",
            "button",
            "canvas",
            "caption",
            "center",
            "cite",
            "code",
            "col",
            "colgroup",
            "datalist",
            "dd",
            "del",
            "details",
            "dfn",
            "dialog",
            "div",
            "dl",
            "dt",
            "em",
            "embed",
            "fieldset",
            "figcaption",
            "figure",
            "font",
            "footer",
            "form",
            "frame",
            "frameset",
            "head",
            "header",
            "h1",
            "h2",
            "h3",
            "h4",
            "h5",
            "h6",
            "hr",
            "html",
            "i",
            "iframe",
            "img",
            "input",
            "ins",
            "kbd",
            "label",
            "legend",
            "li",
            "link",
            "main",
            "map",
            "mark",
            "meta",
            "meter",
            "nav",
            "nobr",
            "noscript",
            "object",
            "ol",
            "optgroup",
            "option",
            "output",
            "p",
            "param",
            "pre",
            "progress",
            "q",
            "s",
            "samp",
            "script",
            "section",
            "select",
            "small",
            "source",
            "span",
            "strike",
            "strong",
            "style",
            "sub",
            "summary",
            "sup",
            "table",
            "tbody",
            "td",
            "template",
            "textarea",
            "tfoot",
            "th",
            "thead",
            "time",
            "title",
            "tr",
            "u",
            "ul",
            "var",
            "video",
            "wbr",
            "xmp",
        ].forEach(tagname => {
            mk[tagname] = (...args) => mk(tagname, ...args);
        });

        function* nodesFromChildList(children) {
            for (const child of children.flat(Infinity)) {
                if (child instanceof Node) {
                    yield child;
                } else {
                    yield new Text(child);
                }
            }
        }
        function append(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                if (el instanceof Node) el.appendChild(child);
                else el.push(child);
            }
            return el;
        }

        function insertAfter(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                el.parentNode.insertBefore(child, el.nextSibling);
            }
            return el;
        }

        function clearContents(el) {
            el.innerHTML = "";
            return el;
        }

        function parseHTML(markup) {
            if (markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
                const doc = document.implementation.createHTMLDocument("");
                doc.documentElement.innerHTML = markup;
                return doc;
            } else {
                const el = mk.template({});
                el.innerHTML = markup;
                return el.content;
            }
        }</script>
    <script>/* Boilerplate: script-dfn-panel */
        "use strict";
        {
            let dfnPanelData = {
                "2f0492ac": { "dfnID": "2f0492ac", "dfnText": "body", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-the-body-element" }], "title": "3.4.3. The background-blend-mode property" }], "url": "https://html.spec.whatwg.org/multipage/sections.html#the-body-element" },
                "33db4476": { "dfnID": "33db4476", "dfnText": "globalCompositeOperation", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-dom-context-2d-globalcompositeoperation" }], "title": "Unnumbered Section" }, { "refs": [{ "id": "ref-for-dom-context-2d-globalcompositeoperation\u2460" }], "title": "2.1. Module interactions" }, { "refs": [{ "id": "ref-for-dom-context-2d-globalcompositeoperation\u2461" }], "title": "4. Specifying Compositing and Blending in Canvas 2D" }], "url": "https://html.spec.whatwg.org/multipage/canvas.html#dom-context-2d-globalcompositeoperation" },
                "3b7558dc": { "dfnID": "3b7558dc", "dfnText": "opacity", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-propdef-opacity" }], "title": "3.4.1. The mix-blend-mode property" }], "url": "https://www.w3.org/TR/css-color-4/#propdef-opacity" },
                "45dae945": { "dfnID": "45dae945", "dfnText": "green", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-valdef-color-green" }], "title": "Changes" }], "url": "https://www.w3.org/TR/css-color-4/#valdef-color-green" },
                "4eb9d37e": { "dfnID": "4eb9d37e", "dfnText": "|", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-comb-one" }, { "id": "ref-for-comb-one\u2460" }, { "id": "ref-for-comb-one\u2461" }, { "id": "ref-for-comb-one\u2462" }, { "id": "ref-for-comb-one\u2463" }, { "id": "ref-for-comb-one\u2464" }, { "id": "ref-for-comb-one\u2465" }, { "id": "ref-for-comb-one\u2466" }, { "id": "ref-for-comb-one\u2467" }, { "id": "ref-for-comb-one\u2468" }, { "id": "ref-for-comb-one\u2460\u24ea" }, { "id": "ref-for-comb-one\u2460\u2460" }, { "id": "ref-for-comb-one\u2460\u2461" }, { "id": "ref-for-comb-one\u2460\u2462" }, { "id": "ref-for-comb-one\u2460\u2463" }], "title": "3.4.1. The mix-blend-mode property" }, { "refs": [{ "id": "ref-for-comb-one\u2460\u2464" }], "title": "3.4.2. The isolation property" }, { "refs": [{ "id": "ref-for-comb-one\u2460\u2465" }, { "id": "ref-for-comb-one\u2460\u2466" }, { "id": "ref-for-comb-one\u2460\u2467" }, { "id": "ref-for-comb-one\u2460\u2468" }, { "id": "ref-for-comb-one\u2461\u24ea" }, { "id": "ref-for-comb-one\u2461\u2460" }, { "id": "ref-for-comb-one\u2461\u2461" }, { "id": "ref-for-comb-one\u2461\u2462" }, { "id": "ref-for-comb-one\u2461\u2463" }, { "id": "ref-for-comb-one\u2461\u2464" }, { "id": "ref-for-comb-one\u2461\u2465" }], "title": "4. Specifying Compositing and Blending in Canvas 2D" }], "url": "https://www.w3.org/TR/css-values-4/#comb-one" },
                "5b43edf4": { "dfnID": "5b43edf4", "dfnText": "mask", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-propdef-mask" }], "title": "3.4.2. The isolation property" }], "url": "https://www.w3.org/TR/css-masking-1/#propdef-mask" },
                "5ced56d0": { "dfnID": "5ced56d0", "dfnText": "background-image", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-propdef-background-image" }], "title": "3.4.3. The background-blend-mode property" }], "url": "https://www.w3.org/TR/css-backgrounds-3/#propdef-background-image" },
                "backdrop": { "dfnID": "backdrop", "dfnText": "backdrop", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-backdrop\u2460" }, { "id": "ref-for-backdrop\u2461" }], "title": "5. Introduction to compositing" }, { "refs": [{ "id": "ref-for-backdrop\u2462" }, { "id": "ref-for-backdrop\u2463" }, { "id": "ref-for-backdrop\u2464" }], "title": "5.1. Simple alpha compositing" }, { "refs": [{ "id": "ref-for-backdrop\u2465" }, { "id": "ref-for-backdrop\u2466" }], "title": "5.1.1. Examples of simple alpha compositing" }, { "refs": [{ "id": "ref-for-backdrop\u2467" }, { "id": "ref-for-backdrop\u2468" }, { "id": "ref-for-backdrop\u2460\u24ea" }, { "id": "ref-for-backdrop\u2460\u2460" }, { "id": "ref-for-backdrop\u2460\u2461" }], "title": "10. Blending" }, { "refs": [{ "id": "ref-for-backdrop\u2460\u2462" }], "title": "10.1. Separable blend modes" }, { "refs": [{ "id": "ref-for-backdrop\u2460\u2463" }], "title": "10.1.3. screen blend mode" }, { "refs": [{ "id": "ref-for-backdrop\u2460\u2464" }, { "id": "ref-for-backdrop\u2460\u2465" }, { "id": "ref-for-backdrop\u2460\u2466" }, { "id": "ref-for-backdrop\u2460\u2467" }], "title": "10.1.4. overlay blend mode" }, { "refs": [{ "id": "ref-for-backdrop\u2460\u2468" }, { "id": "ref-for-backdrop\u2461\u24ea" }], "title": "10.1.5. darken blend mode" }, { "refs": [{ "id": "ref-for-backdrop\u2461\u2460" }, { "id": "ref-for-backdrop\u2461\u2461" }], "title": "10.1.6. lighten blend mode" }, { "refs": [{ "id": "ref-for-backdrop\u2461\u2462" }], "title": "10.1.7. color-dodge blend mode" }, { "refs": [{ "id": "ref-for-backdrop\u2461\u2463" }], "title": "10.1.8. color-burn blend mode" }, { "refs": [{ "id": "ref-for-backdrop\u2461\u2464" }], "title": "10.1.9. hard-light blend mode" }, { "refs": [{ "id": "ref-for-backdrop\u2461\u2465" }], "title": "10.1.10. soft-light blend mode" }, { "refs": [{ "id": "ref-for-backdrop\u2461\u2466" }], "title": "10.1.11. difference blend mode" }, { "refs": [{ "id": "ref-for-backdrop\u2461\u2467" }], "title": "10.1.12. exclusion blend mode" }, { "refs": [{ "id": "ref-for-backdrop\u2461\u2468" }, { "id": "ref-for-backdrop\u2462\u24ea" }], "title": "10.2. Non-separable blend modes" }, { "refs": [{ "id": "ref-for-backdrop\u2462\u2460" }], "title": "10.2.1. hue blend mode" }, { "refs": [{ "id": "ref-for-backdrop\u2462\u2461" }, { "id": "ref-for-backdrop\u2462\u2462" }], "title": "10.2.2. saturation blend mode" }, { "refs": [{ "id": "ref-for-backdrop\u2462\u2463" }, { "id": "ref-for-backdrop\u2462\u2464" }], "title": "10.2.3. color blend mode" }, { "refs": [{ "id": "ref-for-backdrop\u2462\u2465" }], "title": "10.2.4. luminosity blend mode" }], "url": "#backdrop" },
                "c297b070": { "dfnID": "c297b070", "dfnText": "#", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-comma" }], "title": "3.4.3. The background-blend-mode property" }], "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
                "compositemode": { "dfnID": "compositemode", "dfnText": "<composite-mode>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-compositemode" }, { "id": "ref-for-compositemode\u2460" }], "title": "4. Specifying Compositing and Blending in Canvas 2D" }, { "refs": [{ "id": "ref-for-compositemode\u2461" }], "title": "Changes" }], "url": "#compositemode" },
                "db6870d5": { "dfnID": "db6870d5", "dfnText": "background", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-propdef-background" }], "title": "3.4.3. The background-blend-mode property" }], "url": "https://www.w3.org/TR/css-backgrounds-3/#propdef-background" },
                "f0811ff8": { "dfnID": "f0811ff8", "dfnText": "img", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-the-img-element" }, { "id": "ref-for-the-img-element\u2460" }], "title": "3.4.2. The isolation property" }], "url": "https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element" },
                "f8e15dd7": { "dfnID": "f8e15dd7", "dfnText": "lime", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-valdef-color-lime" }], "title": "Changes" }], "url": "https://www.w3.org/TR/css-color-4/#valdef-color-lime" },
                "isolated-propid": { "dfnID": "isolated-propid", "dfnText": "<isolation-mode>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-isolated-propid" }, { "id": "ref-for-isolated-propid\u2460" }], "title": "3.4.2. The isolation property" }], "url": "#isolated-propid" },
                "ltblendmodegt": { "dfnID": "ltblendmodegt", "dfnText": "<blend-mode>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-ltblendmodegt" }, { "id": "ref-for-ltblendmodegt\u2460" }], "title": "3.4.1. The mix-blend-mode property" }, { "refs": [{ "id": "ref-for-ltblendmodegt\u2461" }], "title": "3.4.3. The background-blend-mode property" }, { "refs": [{ "id": "ref-for-ltblendmodegt\u2462" }], "title": "4. Specifying Compositing and Blending in Canvas 2D" }], "url": "#ltblendmodegt" },
                "propdef-background-blend-mode": { "dfnID": "propdef-background-blend-mode", "dfnText": "background-blend-mode", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-propdef-background-blend-mode" }], "title": "2.1. Module interactions" }, { "refs": [{ "id": "ref-for-propdef-background-blend-mode\u2460" }, { "id": "ref-for-propdef-background-blend-mode\u2461" }, { "id": "ref-for-propdef-background-blend-mode\u2462" }, { "id": "ref-for-propdef-background-blend-mode\u2463" }], "title": "3.4.3. The background-blend-mode property" }], "url": "#propdef-background-blend-mode" },
                "propdef-isolation": { "dfnID": "propdef-isolation", "dfnText": "isolation", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-propdef-isolation" }, { "id": "ref-for-propdef-isolation\u2460" }], "title": "3.4.2. The isolation property" }], "url": "#propdef-isolation" },
                "propdef-mix-blend-mode": { "dfnID": "propdef-mix-blend-mode", "dfnText": "mix-blend-mode", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-propdef-mix-blend-mode" }], "title": "3.4.1. The mix-blend-mode property" }], "url": "#propdef-mix-blend-mode" },
                "valdef-blend-mode-color": { "dfnID": "valdef-blend-mode-color", "dfnText": "color", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-color" }], "title": "3.4.1. The mix-blend-mode property" }], "url": "#valdef-blend-mode-color" },
                "valdef-blend-mode-color-burn": { "dfnID": "valdef-blend-mode-color-burn", "dfnText": "color-burn", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-color-burn" }], "title": "3.4.1. The mix-blend-mode property" }], "url": "#valdef-blend-mode-color-burn" },
                "valdef-blend-mode-color-dodge": { "dfnID": "valdef-blend-mode-color-dodge", "dfnText": "color-dodge", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-color-dodge" }], "title": "3.4.1. The mix-blend-mode property" }], "url": "#valdef-blend-mode-color-dodge" },
                "valdef-blend-mode-darken": { "dfnID": "valdef-blend-mode-darken", "dfnText": "darken", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-darken" }], "title": "3.4.1. The mix-blend-mode property" }], "url": "#valdef-blend-mode-darken" },
                "valdef-blend-mode-difference": { "dfnID": "valdef-blend-mode-difference", "dfnText": "difference", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-difference" }], "title": "3.4.1. The mix-blend-mode property" }], "url": "#valdef-blend-mode-difference" },
                "valdef-blend-mode-exclusion": { "dfnID": "valdef-blend-mode-exclusion", "dfnText": "exclusion", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-exclusion" }], "title": "3.4.1. The mix-blend-mode property" }], "url": "#valdef-blend-mode-exclusion" },
                "valdef-blend-mode-hard-light": { "dfnID": "valdef-blend-mode-hard-light", "dfnText": "hard-light", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-hard-light" }], "title": "3.4.1. The mix-blend-mode property" }, { "refs": [{ "id": "ref-for-valdef-blend-mode-hard-light\u2460" }, { "id": "ref-for-valdef-blend-mode-hard-light\u2461" }], "title": "10.1.4. overlay blend mode" }], "url": "#valdef-blend-mode-hard-light" },
                "valdef-blend-mode-hue": { "dfnID": "valdef-blend-mode-hue", "dfnText": "hue", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-hue" }], "title": "3.4.1. The mix-blend-mode property" }], "url": "#valdef-blend-mode-hue" },
                "valdef-blend-mode-lighten": { "dfnID": "valdef-blend-mode-lighten", "dfnText": "lighten", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-lighten" }], "title": "3.4.1. The mix-blend-mode property" }], "url": "#valdef-blend-mode-lighten" },
                "valdef-blend-mode-luminosity": { "dfnID": "valdef-blend-mode-luminosity", "dfnText": "luminosity", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-luminosity" }], "title": "3.4.1. The mix-blend-mode property" }], "url": "#valdef-blend-mode-luminosity" },
                "valdef-blend-mode-multiply": { "dfnID": "valdef-blend-mode-multiply", "dfnText": "multiply", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-multiply" }], "title": "3.4.1. The mix-blend-mode property" }, { "refs": [{ "id": "ref-for-valdef-blend-mode-multiply\u2460" }], "title": "10.1.9. hard-light blend mode" }], "url": "#valdef-blend-mode-multiply" },
                "valdef-blend-mode-normal": { "dfnID": "valdef-blend-mode-normal", "dfnText": "normal", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-normal" }, { "id": "ref-for-valdef-blend-mode-normal\u2460" }], "title": "3.4.1. The mix-blend-mode property" }, { "refs": [{ "id": "ref-for-valdef-blend-mode-normal\u2461" }], "title": "8.1. Group invariance" }], "url": "#valdef-blend-mode-normal" },
                "valdef-blend-mode-overlay": { "dfnID": "valdef-blend-mode-overlay", "dfnText": "overlay", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-overlay" }, { "id": "ref-for-valdef-blend-mode-overlay\u2460" }], "title": "3.4.1. The mix-blend-mode property" }], "url": "#valdef-blend-mode-overlay" },
                "valdef-blend-mode-saturation": { "dfnID": "valdef-blend-mode-saturation", "dfnText": "saturation", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-saturation" }], "title": "3.4.1. The mix-blend-mode property" }], "url": "#valdef-blend-mode-saturation" },
                "valdef-blend-mode-screen": { "dfnID": "valdef-blend-mode-screen", "dfnText": "screen", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-screen" }], "title": "3.4.1. The mix-blend-mode property" }, { "refs": [{ "id": "ref-for-valdef-blend-mode-screen\u2460" }], "title": "10.1.9. hard-light blend mode" }], "url": "#valdef-blend-mode-screen" },
                "valdef-blend-mode-soft-light": { "dfnID": "valdef-blend-mode-soft-light", "dfnText": "soft-light", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-blend-mode-soft-light" }], "title": "3.4.1. The mix-blend-mode property" }], "url": "#valdef-blend-mode-soft-light" },
            };

            document.addEventListener("DOMContentLoaded", () => {
                genAllDfnPanels();

                document.body.addEventListener("click", (e) => {
                    // If not handled already, just hide all dfn panels.
                    hideAllDfnPanels();
                });
            });

            window.addEventListener("resize", () => {
                // Pin any visible dfn panel
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => positionDfnPanel(el));
            });

            function genAllDfnPanels() {
                for (const panelData of Object.values(dfnPanelData)) {
                    const dfnID = panelData.dfnID;
                    const dfn = document.getElementById(dfnID);
                    if (!dfn) {
                        console.log(`Can't find dfn#${dfnID}.`, panelData);
                        continue;
                    }
                    dfn.panelData = panelData;
                    insertDfnPopupAction(dfn);
                }
            }

            function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
                const dfnPanel = mk.aside({
                    class: "dfn-panel on",
                    id: `infopanel-for-${dfnID}`,
                    "data-for": dfnID,
                    "aria-labelled-by": `infopaneltitle-for-${dfnID}`,
                },
                    mk.span({ id: `infopaneltitle-for-${dfnID}`, style: "display:none" },
                        `Info about the '${dfnText}' ${external ? "external" : ""} reference.`),
                    mk.a({ href: url, class: "dfn-link" }, url),
                    refSections.length == 0 ? [] :
                        mk.b({}, "Referenced in:"),
                    mk.ul({},
                        ...refSections.map(section =>
                            mk.li({},
                                ...section.refs.map((ref, refI) =>
                                    [
                                        mk.a({ href: `#${ref.id}` },
                                            (refI == 0) ? section.title : `(${refI + 1})`
                                        ),
                                        " ",
                                    ]
                                ),
                            ),
                        ),
                    ),
                    genLinkingSyntaxes(dfn),
                );

                dfnPanel.addEventListener('click', (event) => {
                    if (event.target.nodeName == 'A') {
                        scrollToTargetAndHighlight(event);
                        pinDfnPanel(dfnPanel);
                    }
                    event.stopPropagation();
                    refocusOnTarget(event);
                });
                dfnPanel.addEventListener('keydown', (event) => {
                    if (event.keyCode == 27) { // Escape key
                        hideDfnPanel({ dfnPanel });
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });

                dfnPanel.dfn = dfn;
                dfn.dfnPanel = dfnPanel;
                return dfnPanel;
            }



            function hideAllDfnPanels() {
                // Delete the currently-active dfn panel.
                queryAll(".dfn-panel").forEach(dfnPanel => hideDfnPanel({ dfnPanel }));
            }

            function showDfnPanel(dfn) {
                hideAllDfnPanels(); // Only display one at a time.

                dfn.setAttribute("aria-expanded", "true");

                const dfnPanel = genDfnPanel(dfn, dfn.panelData);

                // Give the dfn a unique tabindex, and then
                // give all the tabbable panel bits successive indexes.
                let tabIndex = 100;
                dfn.tabIndex = tabIndex++;
                const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
                for (const el of tabbable) {
                    el.tabIndex = tabIndex++;
                }

                append(document.body, dfnPanel);
                positionDfnPanel(dfnPanel);
            }

            function positionDfnPanel(dfnPanel) {
                const dfn = dfnPanel.dfn;
                const dfnPos = getBounds(dfn);
                dfnPanel.style.top = dfnPos.bottom + "px";
                dfnPanel.style.left = dfnPos.left + "px";

                const panelPos = dfnPanel.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
                    dfnPanel.style.left = newLeft + "px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.position = "fixed";
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel({ dfn, dfnPanel }) {
                if (!dfnPanel) dfnPanel = dfn.dfnPanel;
                if (!dfn) dfn = dfnPanel.dfn;
                dfn.dfnPanel = undefined;
                dfnPanel.dfn = undefined;
                dfn.setAttribute("aria-expanded", "false");
                dfn.tabIndex = undefined;
                dfnPanel.remove()
            }

            function toggleDfnPanel(dfn) {
                if (dfn.dfnPanel) {
                    hideDfnPanel(dfn);
                } else {
                    showDfnPanel(dfn);
                }
            }

            function insertDfnPopupAction(dfn) {
                dfn.setAttribute('role', 'button');
                dfn.setAttribute('aria-expanded', 'false')
                dfn.tabIndex = 0;
                dfn.classList.add('has-dfn-panel');
                dfn.addEventListener('click', (event) => {
                    toggleDfnPanel(dfn);
                    event.stopPropagation();
                });
                dfn.addEventListener('keypress', (event) => {
                    const kc = event.keyCode;
                    // 32->Space, 13->Enter
                    if (kc == 32 || kc == 13) {
                        toggleDfnPanel(dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });
            }

            function refocusOnTarget(event) {
                const target = event.target;
                setTimeout(() => {
                    // Refocus on the event.target element.
                    // This is needed after browser scrolls to the destination.
                    target.focus();
                });
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function scrollToTargetAndHighlight(event) {
                let hash = event.target.hash;
                if (hash) {
                    hash = decodeURIComponent(hash.substring(1));
                    const dest = document.getElementById(hash);
                    if (dest) {
                        dest.classList.add('highlighted');
                        setTimeout(() => dest.classList.remove('highlighted'), 1000);
                    }
                }
            }

            // Functions, divided by link type, that wrap an autolink's
            // contents with the appropriate outer syntax.
            // Alternately, a string naming another type they format
            // the same as.
            function needsFor(type) {
                switch (type) {
                    case "descriptor":
                    case "value":
                    case "element-attr":
                    case "attr-value":
                    case "element-state":
                    case "method":
                    case "constructor":
                    case "argument":
                    case "attribute":
                    case "const":
                    case "dict-member":
                    case "event":
                    case "enum-value":
                    case "stringifier":
                    case "serializer":
                    case "iterator":
                    case "maplike":
                    case "setlike":
                    case "state":
                    case "mode":
                    case "context":
                    case "facet": return true;

                    default: return false;
                }
            }
            function refusesFor(type) {
                switch (type) {
                    case "property":
                    case "element":
                    case "interface":
                    case "namespace":
                    case "callback":
                    case "dictionary":
                    case "enum":
                    case "exception":
                    case "typedef":
                    case "http-header":
                    case "permission": return true;

                    default: return false;
                }
            }
            function linkFormatterFromType(type) {
                switch (type) {
                    case 'scheme':
                    case 'permission':
                    case 'dfn': return (text) => `[=${text}=]`;

                    case 'abstract-op': return (text) => `[\$${text}\$]`;

                    case 'function':
                    case 'at-rule':
                    case 'selector':
                    case 'value': return (text) => `''${text}''`;

                    case 'http-header': return (text) => `[:${text}:]`;

                    case 'interface':
                    case 'constructor':
                    case 'method':
                    case 'argument':
                    case 'attribute':
                    case 'callback':
                    case 'dictionary':
                    case 'dict-member':
                    case 'enum':
                    case 'enum-value':
                    case 'exception':
                    case 'const':
                    case 'typedef':
                    case 'stringifier':
                    case 'serializer':
                    case 'iterator':
                    case 'maplike':
                    case 'setlike':
                    case 'extended-attribute':
                    case 'event':
                    case 'idl': return (text) => `{{${text}}}`;

                    case 'element-state':
                    case 'element-attr':
                    case 'attr-value':
                    case 'element': return (element) => `<{${element}}>`;

                    case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

                    case 'type': return (text) => `<<${text}>>`;

                    case 'descriptor':
                    case 'property': return (text) => `'${text}'`;

                    default: return;
                };
            };

            function genLinkingSyntaxes(dfn) {
                if (dfn.tagName != "DFN") return;

                const type = dfn.getAttribute('data-dfn-type');
                if (!type) {
                    console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
                    return [];
                }

                // Return a function that wraps link text based on the type
                const linkFormatter = linkFormatterFromType(type);
                if (!linkFormatter) {
                    console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
                    return [];
                }

                let ltAlts;
                if (dfn.hasAttribute('data-lt')) {
                    ltAlts = dfn.getAttribute('data-lt')
                        .split("|")
                        .map(x => x.trim());
                } else {
                    ltAlts = [dfn.textContent.trim()];
                }
                if (type == "type") {
                    // lt of "<foo>", but "foo" is the interior;
                    // <<foo/bar>> is how you write it with a for,
                    // not <foo/<bar>> or whatever.
                    for (var i = 0; i < ltAlts.length; i++) {
                        const lt = ltAlts[i];
                        const match = /<(.*)>/.exec(lt);
                        if (match) { ltAlts[i] = match[1]; }
                    }
                }

                let forAlts;
                if (dfn.hasAttribute('data-dfn-for')) {
                    forAlts = dfn.getAttribute('data-dfn-for')
                        .split(",")
                        .map(x => x.trim());
                } else {
                    forAlts = [''];
                }

                let linkingSyntaxes = [];
                if (!needsFor(type)) {
                    for (const lt of ltAlts) {
                        linkingSyntaxes.push(linkFormatter(lt));
                    }
                }
                if (!refusesFor(type)) {
                    for (const f of forAlts) {
                        linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
                    }
                }
                return [
                    mk.b({}, 'Possible linking syntaxes:'),
                    mk.ul({},
                        ...linkingSyntaxes.map(link => {
                            const copyLink = async () =>
                                await navigator.clipboard.writeText(link);
                            return mk.li({},
                                mk.div({ class: 'link-item' },
                                    mk.button({
                                        class: 'copy-icon', title: 'Copy',
                                        type: 'button',
                                        _onclick: copyLink,
                                        tabindex: 0,
                                    }, mk.span({ class: 'icon' })),
                                    mk.span({}, link)
                                )
                            );
                        })
                    )
                ];
            }
        }
    </script>
    <script>/* Boilerplate: script-link-titles */
        "use strict";
        {
            let linkTitleData = {
                "#ltblendmodegt": "Expands to: color | color-burn | color-dodge | darken | difference | exclusion | hard-light | hue | lighten | luminosity | multiply | normal | overlay | saturation | screen | soft-light",
            };

            function setTypeTitles() {
                for (let el of document.querySelectorAll("a[href]")) {
                    if (el.href in linkTitleData && !el.hasAttribute("title")) {
                        el.setAttribute("title", linkTitleData[el.href]);
                    }
                }
            }

            document.addEventListener("DOMContentLoaded", setTypeTitles);
        }
    </script>
    <script>/* Boilerplate: script-ref-hints */
        "use strict";
        {
            let refsData = {
                "#backdrop": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "backdrop", "type": "dfn", "url": "#backdrop" },
                "#compositemode": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "<composite-mode>", "type": "type", "url": "#compositemode" },
                "#isolated-propid": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "<isolation-mode>", "type": "type", "url": "#isolated-propid" },
                "#ltblendmodegt": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "<blend-mode>", "type": "type", "url": "#ltblendmodegt" },
                "#propdef-background-blend-mode": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "background-blend-mode", "type": "property", "url": "#propdef-background-blend-mode" },
                "#propdef-isolation": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "isolation", "type": "property", "url": "#propdef-isolation" },
                "#propdef-mix-blend-mode": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "mix-blend-mode", "type": "property", "url": "#propdef-mix-blend-mode" },
                "#valdef-blend-mode-color": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "color", "type": "value", "url": "#valdef-blend-mode-color" },
                "#valdef-blend-mode-color-burn": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "color-burn", "type": "value", "url": "#valdef-blend-mode-color-burn" },
                "#valdef-blend-mode-color-dodge": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "color-dodge", "type": "value", "url": "#valdef-blend-mode-color-dodge" },
                "#valdef-blend-mode-darken": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "darken", "type": "value", "url": "#valdef-blend-mode-darken" },
                "#valdef-blend-mode-difference": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "difference", "type": "value", "url": "#valdef-blend-mode-difference" },
                "#valdef-blend-mode-exclusion": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "exclusion", "type": "value", "url": "#valdef-blend-mode-exclusion" },
                "#valdef-blend-mode-hard-light": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "hard-light", "type": "value", "url": "#valdef-blend-mode-hard-light" },
                "#valdef-blend-mode-hue": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "hue", "type": "value", "url": "#valdef-blend-mode-hue" },
                "#valdef-blend-mode-lighten": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "lighten", "type": "value", "url": "#valdef-blend-mode-lighten" },
                "#valdef-blend-mode-luminosity": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "luminosity", "type": "value", "url": "#valdef-blend-mode-luminosity" },
                "#valdef-blend-mode-multiply": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "multiply", "type": "value", "url": "#valdef-blend-mode-multiply" },
                "#valdef-blend-mode-normal": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "normal", "type": "value", "url": "#valdef-blend-mode-normal" },
                "#valdef-blend-mode-overlay": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "overlay", "type": "value", "url": "#valdef-blend-mode-overlay" },
                "#valdef-blend-mode-saturation": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "saturation", "type": "value", "url": "#valdef-blend-mode-saturation" },
                "#valdef-blend-mode-screen": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "screen", "type": "value", "url": "#valdef-blend-mode-screen" },
                "#valdef-blend-mode-soft-light": { "export": true, "for_": ["<blend-mode>"], "level": "1", "normative": true, "shortname": "compositing", "spec": "compositing-1", "status": "local", "text": "soft-light", "type": "value", "url": "#valdef-blend-mode-soft-light" },
                "https://html.spec.whatwg.org/multipage/canvas.html#dom-context-2d-globalcompositeoperation": { "export": true, "for_": ["CanvasCompositing"], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "globalCompositeOperation", "type": "attribute", "url": "https://html.spec.whatwg.org/multipage/canvas.html#dom-context-2d-globalcompositeoperation" },
                "https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "img", "type": "element", "url": "https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element" },
                "https://html.spec.whatwg.org/multipage/sections.html#the-body-element": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "html", "spec": "html", "status": "current", "text": "body", "type": "element", "url": "https://html.spec.whatwg.org/multipage/sections.html#the-body-element" },
                "https://www.w3.org/TR/css-backgrounds-3/#propdef-background": { "export": true, "for_": [], "level": "3", "normative": true, "shortname": "css-backgrounds", "spec": "css-backgrounds-3", "status": "snapshot", "text": "background", "type": "property", "url": "https://www.w3.org/TR/css-backgrounds-3/#propdef-background" },
                "https://www.w3.org/TR/css-backgrounds-3/#propdef-background-image": { "export": true, "for_": [], "level": "3", "normative": true, "shortname": "css-backgrounds", "spec": "css-backgrounds-3", "status": "snapshot", "text": "background-image", "type": "property", "url": "https://www.w3.org/TR/css-backgrounds-3/#propdef-background-image" },
                "https://www.w3.org/TR/css-color-4/#propdef-opacity": { "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "opacity", "type": "property", "url": "https://www.w3.org/TR/css-color-4/#propdef-opacity" },
                "https://www.w3.org/TR/css-color-4/#valdef-color-green": { "export": true, "for_": ["<color>", "<named-color>"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "green", "type": "value", "url": "https://www.w3.org/TR/css-color-4/#valdef-color-green" },
                "https://www.w3.org/TR/css-color-4/#valdef-color-lime": { "export": true, "for_": ["<color>", "<named-color>"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "lime", "type": "value", "url": "https://www.w3.org/TR/css-color-4/#valdef-color-lime" },
                "https://www.w3.org/TR/css-masking-1/#propdef-mask": { "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-masking", "spec": "css-masking-1", "status": "snapshot", "text": "mask", "type": "property", "url": "https://www.w3.org/TR/css-masking-1/#propdef-mask" },
                "https://www.w3.org/TR/css-values-4/#comb-one": { "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "|", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#comb-one" },
                "https://www.w3.org/TR/css-values-4/#mult-comma": { "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "#", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
            };

            function mkRefHint(link, ref) {
                const linkText = link.textContent;
                let dfnTextElements = '';
                if (ref.text != linkText) {
                    dfnTextElements =
                        mk.li({},
                            mk.b({}, "Term: "),
                            mk.span({}, ref.text)
                        );
                }
                const forList = ref.for_;
                let forListElements;
                if (forList.length == 0) {
                    forListElements = [];
                } else if (forList.length == 1) {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.span({}, forList[0]),
                    );
                } else {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.ul({},
                            ...forList.map(forItem =>
                                mk.li({},
                                    mk.span({}, forItem)
                                ),
                            ),
                        ),
                    );
                }
                const url = ref.url;
                const safeUrl = encodeURIComponent(url);
                const hintPanel = mk.aside({
                    class: "ref-hint",
                    id: `ref-hint-for-${safeUrl}`,
                    "data-for": url,
                    "aria-labelled-by": `ref-hint-for-${safeUrl}`,
                },
                    mk.ul({},
                        dfnTextElements,
                        mk.li({},
                            mk.b({}, "URL: "),
                            mk.a({ href: url, class: "ref" }, url),
                        ),
                        mk.li({},
                            mk.b({}, "Type: "),
                            mk.span({}, `${ref.type}`),
                        ),
                        mk.li({},
                            mk.b({}, "Spec: "),
                            mk.span({}, `${ref.spec ? ref.spec : ''}`),
                        ),
                        forListElements
                    ),
                );
                hintPanel.forLink = link;
                setupRefHintEventListeners(link, hintPanel);
                return hintPanel;
            }

            function hideAllRefHints() {
                queryAll(".ref-hint").forEach(el => hideRefHint(el));
            }

            function hideRefHint(refHint) {
                const link = refHint.forLink;
                link.setAttribute("aria-expanded", "false");
                if (refHint.teardownEventListeners) {
                    refHint.teardownEventListeners();
                }
                refHint.remove();
            }

            function showRefHint(link) {
                if (link.classList.contains("dfn-link")) return;
                const url = link.getAttribute("href");
                const ref = refsData[url];
                if (!ref) return;

                hideAllRefHints(); // Only display one at this time.

                const refHint = mkRefHint(link, ref);
                append(document.body, refHint);
                link.setAttribute("aria-expanded", "true");
                positionRefHint(refHint);
            }

            function setupRefHintEventListeners(link, refHint) {
                if (refHint.teardownEventListeners) return;
                // Add event handlers to hide the refHint after the user moves away
                // from both the link and refHint, if not hovering either within one second.
                let timeout = null;
                const startHidingRefHint = (event) => {
                    if (timeout) {
                        clearTimeout(timeout);
                    }
                    timeout = setTimeout(() => {
                        hideRefHint(refHint);
                    }, 1000);
                }
                const resetHidingRefHint = (event) => {
                    if (timeout) clearTimeout(timeout);
                    timeout = null;
                };
                link.addEventListener("mouseleave", startHidingRefHint);
                link.addEventListener("mouseenter", resetHidingRefHint);
                link.addEventListener("blur", startHidingRefHint);
                link.addEventListener("focus", resetHidingRefHint);
                refHint.addEventListener("mouseleave", startHidingRefHint);
                refHint.addEventListener("mouseenter", resetHidingRefHint);
                refHint.addEventListener("blur", startHidingRefHint);
                refHint.addEventListener("focus", resetHidingRefHint);

                refHint.teardownEventListeners = () => {
                    // remove event listeners
                    resetHidingRefHint();
                    link.removeEventListener("mouseleave", startHidingRefHint);
                    link.removeEventListener("mouseenter", resetHidingRefHint);
                    link.removeEventListener("blur", startHidingRefHint);
                    link.removeEventListener("focus", resetHidingRefHint);
                    refHint.removeEventListener("mouseleave", startHidingRefHint);
                    refHint.removeEventListener("mouseenter", resetHidingRefHint);
                    refHint.removeEventListener("blur", startHidingRefHint);
                    refHint.removeEventListener("focus", resetHidingRefHint);
                };
            }

            function positionRefHint(refHint) {
                const link = refHint.forLink;
                const linkPos = getBounds(link);
                refHint.style.top = linkPos.bottom + "px";
                refHint.style.left = linkPos.left + "px";

                const panelPos = refHint.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
                    refHint.style.left = newLeft + "px";
                }
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function showRefHintListener(e) {
                // If the target isn't in a link (or is a link),
                // just ignore it.
                let link = e.target.closest("a");
                if (!link) return;

                // If the target is in a ref-hint panel
                // (aka a link in the already-open one),
                // also just ignore it.
                if (link.closest(".ref-hint")) return;

                // Otherwise, show the panel for the link.
                showRefHint(link);
            }

            function hideAllHintsListener(e) {
                // If the click is inside a ref-hint panel, ignore it.
                if (e.target.closest(".ref-hint")) return;
                // Otherwise, close all the current panels.
                hideAllRefHints();
            }

            document.addEventListener("DOMContentLoaded", () => {
                document.body.addEventListener("mousedown", showRefHintListener);
                document.body.addEventListener("focus", showRefHintListener);

                document.body.addEventListener("click", hideAllHintsListener);
            });

            window.addEventListener("resize", () => {
                // Hide any open ref hint.
                hideAllRefHints();
            });
        }
    </script>
    <script>/* Boilerplate: script-wpt */
        "use strict";
        {
            let wptData = {
                "paths": ["/css/compositing/"],
            };

            document.addEventListener("DOMContentLoaded", async () => {
                if (wptData.paths.length == 0) return;

                const runsUrl = "https://wpt.fyi/api/runs?label=master&label=stable&max-count=1&product=chrome&product=firefox&product=safari&product=edge";
                const runs = await (await fetch(runsUrl)).json();

                let testResults = [];
                for (const pathPrefix of wptData.paths) {
                    const pathResults = await (await fetch("https://wpt.fyi/api/search", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            "run_ids": runs.map(x => x.id),
                            "query": { "path": pathPrefix },
                        })
                    })).json();
                    testResults = testResults.concat(pathResults.results);
                }

                const browsers = runs.map(x => ({ name: x.browser_name, version: x.browser_version, passes: 0, total: 0 }));
                const resultsFromPath = new Map(testResults.map(result => {
                    const testPath = result.test;
                    const passes = result.legacy_status.map(x => [x.passes, x.total]);
                    return [testPath, passes];
                }));
                const seenTests = new Set();
                document.querySelectorAll(".wpt-name").forEach(nameEl => {
                    const passData = resultsFromPath.get("/" + nameEl.getAttribute("title"));
                    if (!passData) {
                        console.log("Couldn't find test in results:", nameEl);
                        return
                    }
                    const numTests = passData[0][1];
                    if (numTests > 1) {
                        nameEl.insertAdjacentElement("beforeend",
                            mk.small({}, ` (${numTests} tests)`));
                    }
                    if (passData == undefined) return;
                    const resultsEl = mk.span({ "class": "wpt-results" },
                        ...passData.map((p, i) => mk.span(
                            {
                                "title": `${browsers[i].name} ${p[0]}/${p[1]}`,
                                "class": "wpt-result",
                                "style": `background: conic-gradient(forestgreen ${p[0] / p[1] * 360}deg, darkred 0deg);`,
                            })),
                    );
                    nameEl.insertAdjacentElement("afterend", resultsEl);

                    // Only update the summary pass/total count if we haven't seen this
                    // test before, to support authors listing the same test multiple times
                    // in a spec.
                    if (!seenTests.has(nameEl.getAttribute("title"))) {
                        seenTests.add(nameEl.getAttribute("title"));
                        passData.forEach((p, i) => {
                            browsers[i].passes += p[0];
                            browsers[i].total += p[1];
                        });
                    }
                });
                const overview = document.querySelector(".wpt-overview");
                if (overview) {
                    overview.appendChild(mk.ul({}, ...browsers.map(formatWptResult)));
                    document.head.appendChild(mk.style({},
                        `.wpt-overview ul { display: flex; flex-flow: row wrap; gap: .2em; justify-content: start; list-style: none; padding: 0; margin: 0;}
             .wpt-overview li { padding: .25em 1em; color: black; text-align: center; }
             .wpt-overview img { height: 1.5em; height: max(1.5em, 32px); background: transparent; }
             .wpt-overview .browser { font-weight: bold; }
             .wpt-overview .passes-none { background: #e57373; }
             .wpt-overview .passes-hardly { background: #ffb74d; }
             .wpt-overview .passes-a-few { background: #ffd54f; }
             .wpt-overview .passes-half { background: #fff176; }
             .wpt-overview .passes-lots { background: #dce775; }
             .wpt-overview .passes-most { background: #aed581; }
             .wpt-overview .passes-all { background: #81c784; }`));
                }
            });

            function formatWptResult({ name, version, passes, total }) {
                const passRate = passes / total;
                let passClass = "";
                if (passRate == 0) passClass = "passes-none";
                else if (passRate < .2) passClass = "passes-hardly";
                else if (passRate < .4) passClass = "passes-a-few";
                else if (passRate < .6) passClass = "passes-half";
                else if (passRate < .8) passClass = "passes-lots";
                else if (passRate < 1) passClass = "passes-most";
                else passClass = "passes-all";

                name = name[0].toUpperCase() + name.slice(1);
                const shortVersion = /^\d+/.exec(version);
                const icon = []

                if (name == "Chrome") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/chrome_64x64.png" }));
                if (name == "Edge") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/edge_64x64.png" }));
                if (name == "Safari") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/safari_64x64.png" }));
                if (name == "Firefox") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/firefox_64x64.png" }));

                return mk.li({ "class": passClass },
                    mk.nobr({ 'class': 'browser' }, ...icon, ` ${name} ${shortVersion}`),
                    mk.br(),
                    mk.nobr({ 'class': 'pass-rate' }, `${passes}/${total}`)
                );
            }
        }
    </script>