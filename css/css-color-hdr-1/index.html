<!doctype html>
<html lang="zh-hans">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>CSS 颜色 HDR 模块 1 级</title>
    <meta content="FPWD" name="w3c-status">
    <!-- <meta content="Bikeshed version ac5ea272d, updated Fri Dec 6 15:45:15 2024 -0800" name="generator"> -->
    <link href="https://www.w3.org/TR/css-color-hdr-1/" rel="canonical">
    <!-- <meta content="97f683a0274c6386a874a31ed1dfa99a6f19b034" name="revision"> -->
    <meta content="dark light" name="color-scheme">
    <link href="https://www.w3.org/TR/css-color-hdr-1/style.css" rel="stylesheet">
    <style>
        /* Boilerplate: style-autolinks */
        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: var(--a-normal-text);
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --selflink-text: black;
                --selflink-bg: silver;
                --selflink-hover-text: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-colors */
        /* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
        :root {
            color-scheme: light dark;

            --text: black;
            --bg: white;

            --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

            --logo-bg: #1a5e9a;
            --logo-active-bg: #c00;
            --logo-text: white;

            --tocnav-normal-text: #707070;
            --tocnav-normal-bg: var(--bg);
            --tocnav-hover-text: var(--tocnav-normal-text);
            --tocnav-hover-bg: #f8f8f8;
            --tocnav-active-text: #c00;
            --tocnav-active-bg: var(--tocnav-normal-bg);

            --tocsidebar-text: var(--text);
            --tocsidebar-bg: #f7f8f9;
            --tocsidebar-shadow: rgba(0, 0, 0, .1);
            --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

            --toclink-text: var(--text);
            --toclink-underline: #3980b5;
            --toclink-visited-text: var(--toclink-text);
            --toclink-visited-underline: #054572;

            --heading-text: #005a9c;

            --hr-text: var(--text);

            --algo-border: #def;

            --del-text: red;
            --del-bg: transparent;
            --ins-text: #080;
            --ins-bg: transparent;

            --a-normal-text: #034575;
            --a-normal-underline: #bbb;
            --a-visited-text: var(--a-normal-text);
            --a-visited-underline: #707070;
            --a-hover-bg: rgba(75%, 75%, 75%, .25);
            --a-active-text: #c00;
            --a-active-underline: #c00;

            --blockquote-border: silver;
            --blockquote-bg: transparent;
            --blockquote-text: currentcolor;

            --issue-border: #e05252;
            --issue-bg: #fbe9e9;
            --issue-text: var(--text);
            --issueheading-text: #831616;

            --example-border: #e0cb52;
            --example-bg: #fcfaee;
            --example-text: var(--text);
            --exampleheading-text: #574b0f;

            --note-border: #52e052;
            --note-bg: #e9fbe9;
            --note-text: var(--text);
            --noteheading-text: hsl(120, 70%, 30%);
            --notesummary-underline: silver;

            --assertion-border: #aaa;
            --assertion-bg: #eee;
            --assertion-text: black;

            --advisement-border: orange;
            --advisement-bg: #fec;
            --advisement-text: var(--text);
            --advisementheading-text: #b35f00;

            --warning-border: red;
            --warning-bg: hsla(40, 100%, 50%, 0.95);
            --warning-text: var(--text);

            --amendment-border: #330099;
            --amendment-bg: #F5F0FF;
            --amendment-text: var(--text);
            --amendmentheading-text: #220066;

            --def-border: #8ccbf2;
            --def-bg: #def;
            --def-text: var(--text);
            --defrow-border: #bbd7e9;

            --datacell-border: silver;

            --indexinfo-text: #707070;

            --indextable-hover-text: black;
            --indextable-hover-bg: #f7f8f9;

            --outdatedspec-bg: rgba(0, 0, 0, .5);
            --outdatedspec-text: black;
            --outdated-bg: maroon;
            --outdated-text: white;
            --outdated-shadow: red;

            --editedrec-bg: darkorange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --text: #ddd;
                --bg: black;

                --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

                --logo-bg: #1a5e9a;
                --logo-active-bg: #c00;
                --logo-text: white;

                --tocnav-normal-text: #999;
                --tocnav-normal-bg: var(--bg);
                --tocnav-hover-text: var(--tocnav-normal-text);
                --tocnav-hover-bg: #080808;
                --tocnav-active-text: #f44;
                --tocnav-active-bg: var(--tocnav-normal-bg);

                --tocsidebar-text: var(--text);
                --tocsidebar-bg: #080808;
                --tocsidebar-shadow: rgba(255, 255, 255, .1);
                --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

                --toclink-text: var(--text);
                --toclink-underline: #6af;
                --toclink-visited-text: var(--toclink-text);
                --toclink-visited-underline: #054572;

                --heading-text: #8af;

                --hr-text: var(--text);

                --algo-border: #456;

                --del-text: #f44;
                --del-bg: transparent;
                --ins-text: #4a4;
                --ins-bg: transparent;

                --a-normal-text: #6af;
                --a-normal-underline: #555;
                --a-visited-text: var(--a-normal-text);
                --a-visited-underline: var(--a-normal-underline);
                --a-hover-bg: rgba(25%, 25%, 25%, .2);
                --a-active-text: #f44;
                --a-active-underline: var(--a-active-text);

                --borderedblock-bg: rgba(255, 255, 255, .05);

                --blockquote-border: silver;
                --blockquote-bg: var(--borderedblock-bg);
                --blockquote-text: currentcolor;

                --issue-border: #e05252;
                --issue-bg: var(--borderedblock-bg);
                --issue-text: var(--text);
                --issueheading-text: hsl(0deg, 70%, 70%);

                --example-border: hsl(50deg, 90%, 60%);
                --example-bg: var(--borderedblock-bg);
                --example-text: var(--text);
                --exampleheading-text: hsl(50deg, 70%, 70%);

                --note-border: hsl(120deg, 100%, 35%);
                --note-bg: var(--borderedblock-bg);
                --note-text: var(--text);
                --noteheading-text: hsl(120, 70%, 70%);
                --notesummary-underline: silver;

                --assertion-border: #444;
                --assertion-bg: var(--borderedblock-bg);
                --assertion-text: var(--text);

                --advisement-border: orange;
                --advisement-bg: #222218;
                --advisement-text: var(--text);
                --advisementheading-text: #f84;

                --warning-border: red;
                --warning-bg: hsla(40, 100%, 20%, 0.95);
                --warning-text: var(--text);

                --amendment-border: #330099;
                --amendment-bg: #080010;
                --amendment-text: var(--text);
                --amendmentheading-text: #cc00ff;

                --def-border: #8ccbf2;
                --def-bg: #080818;
                --def-text: var(--text);
                --defrow-border: #136;

                --datacell-border: silver;

                --indexinfo-text: #aaa;

                --indextable-hover-text: var(--text);
                --indextable-hover-bg: #181818;

                --outdatedspec-bg: rgba(255, 255, 255, .5);
                --outdatedspec-text: black;
                --outdated-bg: maroon;
                --outdated-text: white;
                --outdated-shadow: red;

                --editedrec-bg: darkorange;
            }

            /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
            img {
                background: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-counters */
        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* Boilerplate: style-dfn-panel */
        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
            --dfnpanel-target-bg: #ffc;
            --dfnpanel-target-outline: orange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --dfnpanel-bg: #222;
                --dfnpanel-text: var(--text);
                --dfnpanel-target-bg: #333;
                --dfnpanel-target-outline: silver;
            }
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel a:focus {
            outline: 5px auto Highlight;
            outline: 5px auto -webkit-focus-ring-color;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0 0 0 1em;
            list-style: none;
        }

        .dfn-panel li a {
            max-width: calc(300px - 1.5em - 1em);
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: 8px;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
            transition: left 1s ease-out, bottom 1s ease-out;
        }

        .dfn-panel .link-item:hover {
            text-decoration: underline;
        }

        .dfn-panel .link-item .copy-icon {
            opacity: 0;
        }

        .dfn-panel .link-item:hover .copy-icon,
        .dfn-panel .link-item .copy-icon:focus {
            opacity: 1;
        }

        .dfn-panel .copy-icon {
            display: inline-block;
            margin-right: 0.5em;
            width: 0.85em;
            height: 1em;
            border-radius: 3px;
            background-color: #ccc;
            cursor: pointer;
        }

        .dfn-panel .copy-icon .icon {
            width: 100%;
            height: 100%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .dfn-panel .copy-icon .icon::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1px solid black;
            background-color: #ccc;
            opacity: 0.25;
            transform: translate(3px, -3px);
        }

        .dfn-panel .copy-icon:active .icon::before {
            opacity: 1;
        }

        .dfn-paneled[role="button"] {
            cursor: help;
        }

        .highlighted {
            animation: target-fade 3s;
        }

        @keyframes target-fade {
            from {
                background-color: var(--dfnpanel-target-bg);
                outline: 5px solid var(--dfnpanel-target-outline);
            }

            to {
                color: var(--a-normal-text);
                background-color: transparent;
                outline: transparent;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-issues */
        a[href].issue-return {
            float: right;
            float: inline-end;
            color: var(--issueheading-text);
            font-weight: bold;
            text-decoration: none;
        }
    </style>
    <style>
        /* Boilerplate: style-md-lists */
        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* Boilerplate: style-ref-hints */
        :root {
            --ref-hint-bg: #ddd;
            --ref-hint-text: var(--text);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --ref-hint-bg: #222;
                --ref-hint-text: var(--text);
            }
        }

        .ref-hint {
            display: inline-block;
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.5em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--ref-hint-bg);
            color: var(--ref-hint-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .ref-hint * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .ref-hint ul {
            padding: 0 0 0 1em;
            list-style: none;
        }
    </style>
    <style>
        /* Boilerplate: style-selflinks */
        :root {
            --selflink-text: white;
            --selflink-bg: gray;
            --selflink-hover-text: black;
        }

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        .example>a.self-link,
        .note>a.self-link,
        .issue>a.self-link {
            /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
            left: auto;
            right: 0;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: var(--selflink-bg);
            color: var(--selflink-text);
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: var(--selflink-hover-text);
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <style>
        /* Boilerplate: style-syntax-highlighting */
        code.highlight {
            padding: .1em;
            border-radius: .3em;
        }

        pre.highlight,
        pre>code.highlight {
            display: block;
            padding: 1em;
            margin: .5em 0;
            overflow: auto;
            border-radius: 0;
        }

        .highlight:not(.idl) {
            background: rgba(0, 0, 0, .03);
        }

        c-[a] {
            color: #990055
        }

        /* Keyword.Declaration */
        c-[b] {
            color: #990055
        }

        /* Keyword.Type */
        c-[c] {
            color: #708090
        }

        /* Comment */
        c-[d] {
            color: #708090
        }

        /* Comment.Multiline */
        c-[e] {
            color: #0077aa
        }

        /* Name.Attribute */
        c-[f] {
            color: #669900
        }

        /* Name.Tag */
        c-[g] {
            color: #222222
        }

        /* Name.Variable */
        c-[k] {
            color: #990055
        }

        /* Keyword */
        c-[l] {
            color: #000000
        }

        /* Literal */
        c-[m] {
            color: #000000
        }

        /* Literal.Number */
        c-[n] {
            color: #0077aa
        }

        /* Name */
        c-[o] {
            color: #999999
        }

        /* Operator */
        c-[p] {
            color: #999999
        }

        /* Punctuation */
        c-[s] {
            color: #a67f59
        }

        /* Literal.String */
        c-[t] {
            color: #a67f59
        }

        /* Literal.String.Single */
        c-[u] {
            color: #a67f59
        }

        /* Literal.String.Double */
        c-[cp] {
            color: #708090
        }

        /* Comment.Preproc */
        c-[c1] {
            color: #708090
        }

        /* Comment.Single */
        c-[cs] {
            color: #708090
        }

        /* Comment.Special */
        c-[kc] {
            color: #990055
        }

        /* Keyword.Constant */
        c-[kn] {
            color: #990055
        }

        /* Keyword.Namespace */
        c-[kp] {
            color: #990055
        }

        /* Keyword.Pseudo */
        c-[kr] {
            color: #990055
        }

        /* Keyword.Reserved */
        c-[ld] {
            color: #000000
        }

        /* Literal.Date */
        c-[nc] {
            color: #0077aa
        }

        /* Name.Class */
        c-[no] {
            color: #0077aa
        }

        /* Name.Constant */
        c-[nd] {
            color: #0077aa
        }

        /* Name.Decorator */
        c-[ni] {
            color: #0077aa
        }

        /* Name.Entity */
        c-[ne] {
            color: #0077aa
        }

        /* Name.Exception */
        c-[nf] {
            color: #0077aa
        }

        /* Name.Function */
        c-[nl] {
            color: #0077aa
        }

        /* Name.Label */
        c-[nn] {
            color: #0077aa
        }

        /* Name.Namespace */
        c-[py] {
            color: #0077aa
        }

        /* Name.Property */
        c-[ow] {
            color: #999999
        }

        /* Operator.Word */
        c-[mb] {
            color: #000000
        }

        /* Literal.Number.Bin */
        c-[mf] {
            color: #000000
        }

        /* Literal.Number.Float */
        c-[mh] {
            color: #000000
        }

        /* Literal.Number.Hex */
        c-[mi] {
            color: #000000
        }

        /* Literal.Number.Integer */
        c-[mo] {
            color: #000000
        }

        /* Literal.Number.Oct */
        c-[sb] {
            color: #a67f59
        }

        /* Literal.String.Backtick */
        c-[sc] {
            color: #a67f59
        }

        /* Literal.String.Char */
        c-[sd] {
            color: #a67f59
        }

        /* Literal.String.Doc */
        c-[se] {
            color: #a67f59
        }

        /* Literal.String.Escape */
        c-[sh] {
            color: #a67f59
        }

        /* Literal.String.Heredoc */
        c-[si] {
            color: #a67f59
        }

        /* Literal.String.Interpol */
        c-[sx] {
            color: #a67f59
        }

        /* Literal.String.Other */
        c-[sr] {
            color: #a67f59
        }

        /* Literal.String.Regex */
        c-[ss] {
            color: #a67f59
        }

        /* Literal.String.Symbol */
        c-[vc] {
            color: #0077aa
        }

        /* Name.Variable.Class */
        c-[vg] {
            color: #0077aa
        }

        /* Name.Variable.Global */
        c-[vi] {
            color: #0077aa
        }

        /* Name.Variable.Instance */
        c-[il] {
            color: #000000
        }

        /* Literal.Number.Integer.Long */

        @media (prefers-color-scheme: dark) {
            .highlight:not(.idl) {
                background: rgba(255, 255, 255, .05);
            }

            c-[a] {
                color: #d33682
            }

            /* Keyword.Declaration */
            c-[b] {
                color: #d33682
            }

            /* Keyword.Type */
            c-[c] {
                color: #2aa198
            }

            /* Comment */
            c-[d] {
                color: #2aa198
            }

            /* Comment.Multiline */
            c-[e] {
                color: #268bd2
            }

            /* Name.Attribute */
            c-[f] {
                color: #b58900
            }

            /* Name.Tag */
            c-[g] {
                color: #cb4b16
            }

            /* Name.Variable */
            c-[k] {
                color: #d33682
            }

            /* Keyword */
            c-[l] {
                color: #657b83
            }

            /* Literal */
            c-[m] {
                color: #657b83
            }

            /* Literal.Number */
            c-[n] {
                color: #268bd2
            }

            /* Name */
            c-[o] {
                color: #657b83
            }

            /* Operator */
            c-[p] {
                color: #657b83
            }

            /* Punctuation */
            c-[s] {
                color: #6c71c4
            }

            /* Literal.String */
            c-[t] {
                color: #6c71c4
            }

            /* Literal.String.Single */
            c-[u] {
                color: #6c71c4
            }

            /* Literal.String.Double */
            c-[ch] {
                color: #2aa198
            }

            /* Comment.Hashbang */
            c-[cp] {
                color: #2aa198
            }

            /* Comment.Preproc */
            c-[cpf] {
                color: #2aa198
            }

            /* Comment.PreprocFile */
            c-[c1] {
                color: #2aa198
            }

            /* Comment.Single */
            c-[cs] {
                color: #2aa198
            }

            /* Comment.Special */
            c-[kc] {
                color: #d33682
            }

            /* Keyword.Constant */
            c-[kn] {
                color: #d33682
            }

            /* Keyword.Namespace */
            c-[kp] {
                color: #d33682
            }

            /* Keyword.Pseudo */
            c-[kr] {
                color: #d33682
            }

            /* Keyword.Reserved */
            c-[ld] {
                color: #657b83
            }

            /* Literal.Date */
            c-[nc] {
                color: #268bd2
            }

            /* Name.Class */
            c-[no] {
                color: #268bd2
            }

            /* Name.Constant */
            c-[nd] {
                color: #268bd2
            }

            /* Name.Decorator */
            c-[ni] {
                color: #268bd2
            }

            /* Name.Entity */
            c-[ne] {
                color: #268bd2
            }

            /* Name.Exception */
            c-[nf] {
                color: #268bd2
            }

            /* Name.Function */
            c-[nl] {
                color: #268bd2
            }

            /* Name.Label */
            c-[nn] {
                color: #268bd2
            }

            /* Name.Namespace */
            c-[py] {
                color: #268bd2
            }

            /* Name.Property */
            c-[ow] {
                color: #657b83
            }

            /* Operator.Word */
            c-[mb] {
                color: #657b83
            }

            /* Literal.Number.Bin */
            c-[mf] {
                color: #657b83
            }

            /* Literal.Number.Float */
            c-[mh] {
                color: #657b83
            }

            /* Literal.Number.Hex */
            c-[mi] {
                color: #657b83
            }

            /* Literal.Number.Integer */
            c-[mo] {
                color: #657b83
            }

            /* Literal.Number.Oct */
            c-[sa] {
                color: #6c71c4
            }

            /* Literal.String.Affix */
            c-[sb] {
                color: #6c71c4
            }

            /* Literal.String.Backtick */
            c-[sc] {
                color: #6c71c4
            }

            /* Literal.String.Char */
            c-[dl] {
                color: #6c71c4
            }

            /* Literal.String.Delimiter */
            c-[sd] {
                color: #6c71c4
            }

            /* Literal.String.Doc */
            c-[se] {
                color: #6c71c4
            }

            /* Literal.String.Escape */
            c-[sh] {
                color: #6c71c4
            }

            /* Literal.String.Heredoc */
            c-[si] {
                color: #6c71c4
            }

            /* Literal.String.Interpol */
            c-[sx] {
                color: #6c71c4
            }

            /* Literal.String.Other */
            c-[sr] {
                color: #6c71c4
            }

            /* Literal.String.Regex */
            c-[ss] {
                color: #6c71c4
            }

            /* Literal.String.Symbol */
            c-[fm] {
                color: #268bd2
            }

            /* Name.Function.Magic */
            c-[vc] {
                color: #cb4b16
            }

            /* Name.Variable.Class */
            c-[vg] {
                color: #cb4b16
            }

            /* Name.Variable.Global */
            c-[vi] {
                color: #cb4b16
            }

            /* Name.Variable.Instance */
            c-[vm] {
                color: #cb4b16
            }

            /* Name.Variable.Magic */
            c-[il] {
                color: #657b83
            }

            /* Literal.Number.Integer.Long */
        }
    </style>
    <style>
        /* Boilerplate: style-wpt */
        :root {
            --wpt-border: hsl(0, 0%, 60%);
            --wpt-bg: hsl(0, 0%, 95%);
            --wpt-text: var(--text);
            --wptheading-text: hsl(0, 0%, 30%);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --wpt-border: hsl(0, 0%, 30%);
                --wpt-bg: var(--borderedblock-bg);
                --wpt-text: var(--text);
                --wptheading-text: hsl(0, 0%, 60%);
            }
        }

        .wpt-tests-block {
            list-style: none;
            border-left: .5em solid var(--wpt-border);
            background: var(--wpt-bg);
            color: var(--wpt-text);
            margin: 1em auto;
            padding: .5em;
        }

        .wpt-tests-block summary {
            color: var(--wptheading-text);
            font-weight: normal;
            text-transform: uppercase;
        }

        .wpt-tests-block summary::marker {
            color: var(--wpt-border);
        }

        .wpt-tests-block summary:hover::marker {
            color: var(--wpt-text);
        }

        /*
   The only content  of a wpt test block in its closed state is the <summary>,
   which contains the word TESTS,
   and that is absolutely positioned.
   In that closed state, wpt test blocks are styled
   to have a top margin whose height is exactly equal
   to the height of the absolutely positioned <summary>,
   and no other background/padding/margin/border.
   The wpt test block elements will therefore allow the maring
   of the previous/next block elements
   to collapse through them;
   if this combined margin would be larger than its own top margin,
   it stays as is,
   and therefore the pre-existing vertical rhythm of the document is undisturbed.
   If that combined margin would be smaller, it is grown to that size.
   This means that the wpt test block ensures
   that there's always enough vertical space to insert the summary,
   without adding more than is needed.
*/
        .wpt-tests-block:not([open]) {
            padding: 0;
            border: none;
            background: none;
            font-size: 0.75em;
            line-height: 1;
            position: relative;
            margin: 1em 0 0;
        }

        .wpt-tests-block:not([open]) summary {
            position: absolute;
            right: 0;
            bottom: 0;
        }

        /*
   It is possible that both the last child of a block element
   and the block element itself
   would be annotated with a <wpt> block each.
   If the block element has a padding or a border,
   that's fine, but otherwise
   the bottom margin of the block and of its last child would collapse
   and both <wpt> elements would overlap, being both placed there.
   To avoid that, add 1px of padding to the <wpt> element annotating the last child
   to prevent the bottom margin of the block and of its last child from collapsing
   (and as much negative margin,
   as wel only want to prevent margin collapsing,
   but are not trying to actually take more space).
*/
        .wpt-tests-block:not([open]):last-child {
            padding-bottom: 1px;
            margin-bottom: -1px;
        }

        /*
   Exception to the previous rule:
   don't do that in non-last list items,
   because it's not necessary,
   and would therefore consume more space than strictly needed.
   Lists must have list items as children, not <wpt> elements,
   so a <wpt> element cannot be a sibling of a list item,
   and the collision that the previous rule avoids cannot happen.
*/
        li:not(:last-child)>.wpt-tests-block:not([open]):last-child,
        dd:not(:last-child)>.wpt-tests-block:not([open]):last-child {
            padding-bottom: 0;
            margin-bottom: 0;
        }

        .wpt-tests-block:not([open]):not(:hover) {
            opacity: 0.5;
        }

        .wpt-tests-list {
            list-style: none;
            display: grid;
            margin: 0;
            padding: 0;
            grid-template-columns: 1fr max-content auto auto;
            grid-column-gap: .5em;
        }

        .wpt-tests-block hr:last-child {
            display: none;
        }

        .wpt-test {
            display: contents;
        }

        .wpt-test>a {
            text-decoration: underline;
            border: none;
        }

        .wpt-test>.wpt-name {
            grid-column: 1;
        }

        .wpt-test>.wpt-results {
            grid-column: 2;
        }

        .wpt-test>.wpt-live {
            grid-column: 3;
        }

        .wpt-test>.wpt-source {
            grid-column: 4;
        }

        .wpt-test>.wpt-results {
            display: flex;
            gap: .1em;
        }

        .wpt-test .wpt-result {
            display: inline-block;
            height: 1em;
            width: 1em;
            border-radius: 50%;
            position: relative;
        }
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD" rel="stylesheet">
    <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet"
        type="text/css">

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
        <h1 class="p-name no-ref" id="title">CSS 颜色 HDR 模块 1 级</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types/#FPWD">W3C 首次公开工作草案</a>, <time class="dt-updated"
                datetime="2024-12-17">2024年12月17日</time></p>
        <details open>
            <summary>关于本文档的更多信息</summary>
            <div data-fill-with="spec-metadata">
                <dl>
                    <dt>本版本：
                    <dd><a class="u-url"
                            href="https://www.w3.org/TR/2024/WD-css-color-hdr-1-20241217/">https://www.w3.org/TR/2024/WD-css-color-hdr-1-20241217/</a>
                    <dt>最新发布版本：
                    <dd><a href="https://www.w3.org/TR/css-color-hdr-1/">https://www.w3.org/TR/css-color-hdr-1/</a>
                    <dt>编辑草案：
                    <dd><a
                            href="https://drafts.csswg.org/css-color-hdr-1/">https://drafts.csswg.org/css-color-hdr-1/</a>
                    <dt>历史记录：
                    <dd><a class="u-url"
                            href="https://www.w3.org/standards/history/css-color-hdr-1/">https://www.w3.org/standards/history/css-color-hdr-1/</a>
                    <dt>反馈：
                    <dd><a href="https://github.com/w3c/csswg-drafts/labels/css-color-hdr-1">CSSWG 问题库</a>
                    <dd><a href="#issues-index">规范内反馈</a>
                    <dt class="editor">编辑：
                    <dd class="editor p-author h-card vcard" data-editor-id="1438"><a class="p-name fn u-url url"
                            href="https://svgees.us/">Chris Lilley</a> (<span class="p-org org">W3C</span>)
                    <dt>为本规范建议修改：
                    <dd><a href="https://github.com/w3c/csswg-drafts/blob/main/css-color-hdr-1/Overview.bs">GitHub
                            编辑器</a>
                    <dt>测试套件：
                    <dd class="wpt-overview"><a
                            href="https://wpt.fyi/results/css/css-color-hdr/">https://wpt.fyi/results/css/css-color-hdr/</a>
                </dl>
            </div>
        </details>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> ©
            2024 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr
                title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a
                href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a
                href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a
                href="https://www.w3.org/copyright/software-license/" rel="license"
                title="W3C Software and Document License">permissive document license</a> rules apply. </p>
        <hr title="Separator for header">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">摘要</span></h2>
        <p>本模块在 CSS Color 4 的基础上进行扩展，以支持高动态范围（HDR）。</p>
        <a href="https://www.w3.org/TR/CSS/">CSS</a> 是一种用于描述结构化文档（如 HTML 和 XML）在屏幕、纸张等介质上渲染效果的语言。
    </div>
    <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">本文档状态</span></h2>
    <div data-fill-with="status">
        <p><em>本节描述了本文档在发布时的状态。
                当前 W3C 发布物的列表及本技术报告的最新修订版
                可在 <a href="https://www.w3.org/TR/">W3C 技术报告索引 https://www.w3.org/TR/</a> 中找到。
            </em></p>
        <p> 本文档由 <a href="https://www.w3.org/groups/wg/css">CSS 工作组</a> 作为 <strong>首次公开工作草案</strong>，
            按照 <a href="https://www.w3.org/policies/process/20231103/#recs-and-notes">推荐规范流程</a> 发布。
            作为首次公开工作草案发布，
            并不表示 <abbr title="World Wide Web Consortium">W3C</abbr> 及其成员的认可。
        </p>
        <p> 本文档为草案文件，
            可能会随时被更新、替换或废弃。
            除非作为进行中的工作，否则不应引用本文件。
        </p>
        <p>欢迎通过 <a href="https://github.com/w3c/csswg-drafts/issues">在 GitHub 提交 issue</a>（推荐）反馈意见，
            并在标题中包含规范代码 “css-color-hdr”，格式如下：
            “[css-color-hdr] <i>…评论摘要…</i>”。
            所有问题和评论均已 <a href="https://lists.w3.org/Archives/Public/public-css-archive/">存档</a>。
            另外，也可通过（<a href="https://lists.w3.org/Archives/Public/www-style/">已存档</a>）的公共邮件列表 <a
                href="mailto:www-style@w3.org?Subject=%5Bcss-color-hdr%5D%20PUT%20SUBJECT%20HERE">www-style@w3.org</a>
            发送反馈。
        </p>
        <p>本文件受 <a href="https://www.w3.org/policies/process/20231103/" id="w3c_process_revision">2023 年 11 月 3 日 W3C
                流程文件</a> 管辖。</p>
        <p>本文件由遵循 <a href="https://www.w3.org/policies/patent-policy/20200915/">W3C 专利政策</a> 的小组制作。
            W3C 保持一份与该小组交付物相关的<a href="https://www.w3.org/groups/wg/css/ipr" rel="disclosure">已披露专利的公开列表</a>；
            该页面还包含披露专利的说明。
            如果个人实际知晓某专利，并认为该专利包含<a href="https://www.w3.org/policies/patent-policy/20200915/#def-essential">必要声明</a>，
            则必须按照 <a href="https://www.w3.org/policies/patent-policy/20200915/#sec-Disclosure">W3C 专利政策第6节</a> 进行披露。
        </p>
        <p></p>
    </div>
    <div data-fill-with="at-risk"></div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目录</h2>
        <ol class="toc" role="directory">
            <li>
                <a href="#intro"><span class="secno">1</span> <span class="content">引言</span></a>
                <ol class="toc">
                    <li><a href="#values"><span class="secno">1.1</span> <span class="content">值定义</span></a>
                </ol>
            <li>
                <a href="#controlling-dynamic-range"><span class="secno">2</span> <span
                        class="content">动态范围控制</span></a>
                <ol class="toc">
                    <li><a href="#defining-dynamic-range"><span class="secno">2.1</span> <span
                                class="content">动态范围定义</span></a>
                    <li><a href="#introducing-headroom"><span class="secno">2.2</span> <span class="content">引入
                                Headroom</span></a>
                    <li><a href="#the-dynamic-range-limit-property"><span class="secno">2.3</span> <span
                                class="content"><span class="property">dynamic-range-limit</span> 属性</span></a>
                    <li><a href="#dynamic-range-limit-mix"><span class="secno">2.4</span> <span
                                class="content">动态范围限制混合：<span class="css">dynamic-range-limit-mix()</span>
                                函数</span></a>
                    <li><a href="#computing-dynamic-range-limit"><span class="secno">2.5</span> <span class="content">
                                <span class="property">dynamic-range-limit</span> 的计算值</span></a>
                </ol>
            <li><a href="#color-function"><span class="secno">3</span> <span class="content">指定预定义和自定义色彩空间：<span
                            class="css">color()</span> 函数</span></a>
            <li>
                <a href="#predefined-HDR"><span class="secno">4</span> <span class="content">HDR 预定义色彩空间：</span></a>
                <ol class="toc">
                    <li><a href="#valdef-color-rec2100-pq"><span class="secno">4.1</span> <span
                                class="content"><span>rec2100-pq</span></span></a>
                    <li><a href="#valdef-color-rec2100-hlg"><span class="secno">4.2</span> <span
                                class="content"><span>rec2100-hlg</span></span></a>
                    <li><a href="#valdef-color-rec2100-linear"><span class="secno">4.3</span> <span
                                class="content"><span>rec2100-linear</span></span></a>
                    <li><a href="#Jzazbz"><span class="secno">4.4</span> <span
                                class="content"><span>Jzazbz</span></span></a>
                    <li>
                        <a href="#JzCzHz"><span class="secno">4.5</span> <span
                                class="content"><span>JzCzHz</span></span></a>
                        <ol class="toc">
                            <li><a href="#Jzazbz-to-JzCzHz"><span class="secno">4.5.1</span> <span class="content">
                                        <span class="css">Jzazbz</span> 颜色到 <span class="css">JzCzHz</span>
                                        颜色的转换</span></a>
                            <li><a href="#JzCzHz-to-Jzazbz"><span class="secno">4.5.2</span> <span class="content">
                                        JzCzHz 颜色到 Jzazbz 颜色的转换</span></a>
                        </ol>
                    <li><a href="#ICtCp"><span class="secno">4.6</span> <span
                                class="content"><span>ICtCp</span></span></a>
                </ol>
            <li><a href="#Compositing-SDR-HDR"><span class="secno">5</span> <span class="content">合成 SDR 与 HDR
                        内容</span></a>
            <li>
                <a href="#serializing-color-values"><span class="secno">6</span> <span class="content">序列化 <span
                            class="production">&lt;color></span> 值</span></a>
                <ol class="toc">
                    <li><a href="#serializing-color-function-values"><span class="secno">6.1</span> <span
                                class="content">序列化 <span class="css">color()</span> 函数的值</span></a>
                </ol>
            <li><a href="#privacy"><span class="secno"></span> <span class="content">隐私注意事项</span></a>
            <li><a href="#security"><span class="secno"></span> <span class="content">安全注意事项</span></a>
            <li><a href="#a11y"><span class="secno"></span> <span class="content">可访问性注意事项</span></a>
            <li>
                <a href="#w3c-conformance"><span class="secno"></span> <span class="content">一致性</span></a>
                <ol class="toc">
                    <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">文档约定</span></a>
                    <li><a href="#w3c-conformance-classes"><span class="secno"></span> <span
                                class="content">一致性类别</span></a>
                    <li>
                        <a href="#w3c-partial"><span class="secno"></span> <span class="content">部分实现</span></a>
                        <ol class="toc">
                            <li><a href="#w3c-conform-future-proofing"><span class="secno"></span> <span
                                        class="content">不稳定与专有特性的实现</span></a>
                        </ol>
                    <li><a href="#w3c-testing"><span class="secno"></span> <span class="content">非实验性实现</span></a>
                </ol>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本规范定义的术语</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">通过引用定义的术语</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考文献</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">规范性参考文献</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">参考性参考文献</span></a>
                </ol>
            <li><a href="#property-index"><span class="secno"></span> <span class="content">属性索引</span></a>
            <li><a href="#issues-index"><span class="secno"></span> <span class="content">问题索引</span></a>
        </ol>
    </nav>
    <main>
        <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span
                class="content">引言</span><a class="self-link" href="#intro"></a></h2>
        <p><em>本节为非规范性内容。</em></p>
        <p>CSS Color 4 为开放 Web 平台引入了广色域（WCG）色彩空间。
            这些色彩空间在设计上都是标准动态范围（SDR）色彩空间。
            本规范定义了对高动态范围（HDR）支持的扩展。</p>
        <figure id="fig-eotf">
            <p><img alt height="803" src="https://www.w3.org/TR/css-color-hdr-1/images/lin-srgb-hlg-pq.png" width="839">
            </p>
            <figcaption> 四种色彩空间的电光转换函数（EOTF）：
                扩展 sRGB 和线性光 sRGB
                （在 CSS Color 4 中定义），以及
                本规范定义的感知量化器（PQ）和混合对数伽玛（HLG），来自 <a data-link-type="biblio" href="#biblio-rec_bt2100"
                    title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            </figcaption>
        </figure>
        <p>虽然广色域相关规范已稳定数十年，
            HDR 标准还不够成熟，
            并在过去十年间经历了频繁修订。</p>
        <h3 class="heading settled" data-level="1.1" id="values"><span class="secno">1.1. </span><span
                class="content">值定义</span><a class="self-link" href="#values"></a></h3>
        <p>本规范遵循 <a href="https://www.w3.org/TR/CSS2/about.html#property-defs">CSS 属性定义约定</a>
            （参见 <a data-link-type="biblio" href="#biblio-css2"
                title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>），并采用
            <a href="https://www.w3.org/TR/css-values-3/#value-defs">值定义语法</a>
            （参见 <a data-link-type="biblio" href="#biblio-css-values-3"
                title="CSS Values and Units Module Level 3">[CSS-VALUES-3]</a>）。
            未在本规范中定义的值类型在 CSS Values &amp; Units <span title="CSS Values and Units Module Level 3">[CSS-VALUES-3]</span>
            中定义。
            与其它 CSS 模块结合时，可能会扩展这些值类型的定义。
        </p>
        <p>除了各属性定义中列出的特定值外，
            本规范定义的所有属性
            也接受 <a data-link-type="dfn" href="https://www.w3.org/TR/css-values-4/#css-wide-keywords"
                id="ref-for-css-wide-keywords">CSS 全局关键字</a> 作为属性值。
            为提升可读性，未在每处重复列出。</p>
        <h2 class="heading settled" data-level="2" id="controlling-dynamic-range"><span class="secno">2. </span><span
                class="content">动态范围控制</span><a class="self-link" href="#controlling-dynamic-range"></a></h2>
        <h3 class="heading settled" data-level="2.1" id="defining-dynamic-range"><span class="secno">2.1. </span><span
                class="content">动态范围的定义</span><a class="self-link" href="#defining-dynamic-range"></a>
        </h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="dynamic-range">动态范围</dfn>
            指的是<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-4/#luminance"
                id="ref-for-luminance">亮度</a>在<em>最亮</em>与<em>最暗</em>颜色之间的差值。
            动态范围以摄影中的<em>级（stop）</em>为单位衡量。
            每增加一级，亮度翻倍。</p>
        <pre class="lang-js highlight"><c- a>function</c-> DynamicRange <c- p>(</c->high<c- p>,</c-> low<c- p>)</c-> <c- p>{</c->
  <c- k>return</c-> Math<c- p>.</c->log2<c- p>(</c->high<c- p>)</c-> <c- o>-</c-> Math<c- p>.</c->log2<c- p>(</c->low<c- p>);</c->
  <c- p>}</c-> 
</pre>
        <p>在<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="standard-dynamic-range">标准动态范围</dfn>（SDR）中，
            媒体白（即常规白色背景的颜色，
            或暗色背景上的白色文字）
            是最亮的颜色。</p>
        <div class="example" id="ex-SDR-dynamic-range"><a class="self-link" href="#ex-SDR-dynamic-range"></a> 例如，在<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#sRGB-space"
                id="ref-for-sRGB-space">sRGB</a>中，
            白色被定义为 80 cd/m² 亮度，
            黑色被定义为 0.2 cd/m² 亮度。
            因此，动态范围为 8.6 级（stop）。 </div>
        <p>对于 SDR，<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-4/#luminance"
                id="ref-for-luminance①">亮度</a>被视为<em>相对于</em>媒体白的相对值。
            增加屏幕亮度并不会改变动态范围，
            因为最暗的颜色也会变亮。</p>
        <div class="example" id="ex-SDR-brighter-dynamic-range"><a class="self-link"
                href="#ex-SDR-brighter-dynamic-range"></a> 例如，一台<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-color-4/#sRGB-space" id="ref-for-sRGB-space①">sRGB</a> 屏幕，
            可能设置为白色亮度 160 cd/m²，
            最深的黑色为 0.4 cd/m²。
            动态范围仍为 8.6 级。 </div>
        <p>在<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="high-dynamic-range">高动态范围</dfn>（HDR）中，
            可显示比媒体白更亮的颜色。
            例如，在 HDR 显示器上将媒体白设置为约 200 cd/m² 时，
            可能可以显示高光达到 1000 cd/m²。
            通常，最亮的颜色只能显示在屏幕的很小区域，
            并且持续时间有限。
            这是出于能耗和发热的考虑。</p>
        <div class="example" id="ex-HDR-dynamic-range"><a class="self-link" href="#ex-HDR-dynamic-range"></a> 例如，在 HDR
            参考母版显示器上，
            小面积峰值白色可能亮度为 1000 cd/m²，
            而最深的黑色为 0.05 cd/m²。
            因此，动态范围为 14.3 级。 </div>
        <p>对于 HDR，<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-4/#luminance"
                id="ref-for-luminance②">亮度</a>被视为<em>绝对值</em>，
            而不是相对于媒体白。
            使用更亮的屏幕会增加动态范围，
            媒体白的亮度保持不变。</p>
        <div class="example" id="ex-HDR-PQ-dynamic-range"><a class="self-link" href="#ex-HDR-PQ-dynamic-range"></a>
            例如，使用
            <span class="css">rec2100-pq</span> 色彩空间
            （定义见 <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>），
            最大峰值白色亮度定义为 10000 cd/m²，
            最深黑色为 0.001 cd/m²。
            因此，编码的动态范围为 23.3 级。
        </div>
        <h3 class="heading settled" data-level="2.2" id="introducing-headroom"><span class="secno">2.2. </span><span
                class="content">引入 Headroom</span><a class="self-link" href="#introducing-headroom"></a></h3>
        <p><em>本节为非规范性内容</em></p>
        <p>HDR 显示器能够产生的亮度等级
            差异很大。</p>
        <p>峰值白色比媒体白高出的部分
            被称为 <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="hdr-headroom">HDR headroom</dfn>（HDR 余量），
            其大小取决于媒体白的水平、
            用户偏好
            以及观看环境。</p>
        <p>该余量通常以摄影<strong>级（stop）</strong>为单位表示。
            因此，<a data-link-type="dfn" href="#standard-dynamic-range"
                id="ref-for-standard-dynamic-range">标准动态范围</a>（SDR）
            根据定义，其<a data-link-type="dfn" href="#hdr-headroom" id="ref-for-hdr-headroom">HDR 余量</a>为 0 级，
            因为最亮的白就是媒体白。</p>
        <div class="example" id="ex-low-headroom"><a class="self-link" href="#ex-low-headroom"></a> 例如，一台低端 HDR 显示器
            （仅满足 <a href="https://displayhdr.org/">DisplayHDR 400</a>
            ——Vesa 认证 DisplayHDR 最低级别 <a data-link-type="biblio" href="#biblio-displayhdr"
                title="Summary of DisplayHDR Specs under CTS 1.2">[DisplayHDR]</a>）
            可能媒体白最高为
            200 cd/m<sup>2</sup>，而峰值白色仅为
            400 cd/m<sup>2</sup>（在最亮媒体白下，只有一级 HDR 余量）。 </div>
        <div class="example" id="ex-high-headroom">
            <a class="self-link" href="#ex-high-headroom"></a> 例如，一台高端 HDR 显示器
            （高于 <a href="https://displayhdr.org/">DisplayHDR 1400</a>
            ——Vesa 认证 DisplayHDR 最高级别）
            其媒体白最高可达
            400 cd/m<sup>2</sup>，而峰值白色为
            1600 cd/m<sup>2</sup>。
            <p>在昏暗的观看环境下，
                将媒体白设为 100 cd/m<sup>2</sup> 时，
                可获得四级（16 倍）的 HDR 余量。</p>
        </div>
        <p id="headroom-privacy"> Web 平台目前不会
            直接暴露显示器的余量水平，
            因为它取决于观看环境，
            并且实时、非量化的余量信息
            可能成为跟踪用户的手段
            （例如，检测用户是否移至室外且为晴天）。</p>
        <p id="constrained-headroom"> 并非总是希望
            使用全部可用的
            HDR 余量。
            CSS 提供了一种方式来大致控制
            期望的余量大小；
            此余量可按元素和时间变化。</p>
        <div class="example" id="ex-photo-grid"><a class="self-link" href="#ex-photo-grid"></a> 例如，设想一个
            网页显示照片网格。
            其中一些为 HDR 图片，包括一些动态范围极高的照片，
            如正对太阳的拍摄。
            若所有照片都以完整动态范围显示会令人疲劳。
            同时，
            如果全部限制为 SDR 范围，
            又无法充分体现某些照片的特点。
            设计目标是在显示足够 HDR 效果的同时，
            便于对照片组进行有意义的评估。
        </div>
        <h3 class="heading settled" data-level="2.3" id="the-dynamic-range-limit-property"><span class="secno">2.3.
            </span><span class="content"><a class="property css" data-link-type="property"
                    href="#propdef-dynamic-range-limit" id="ref-for-propdef-dynamic-range-limit">dynamic-range-limit</a>
                属性</span><a class="self-link" href="#the-dynamic-range-limit-property"></a></h3>
        <table class="def propdef" data-link-for-hint="dynamic-range-limit">
            <tbody>
                <tr>
                    <th>名称:
                    <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export
                            id="propdef-dynamic-range-limit">dynamic-range-limit</dfn>
                <tr class="value">
                    <th><a href="https://www.w3.org/TR/css-values/#value-defs">值：</a>
                    <td class="prod">standard <a data-link-type="grammar"
                            href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one">|</a> high <span
                            id="ref-for-comb-one①">|</span> constrained-high <span id="ref-for-comb-one②">|</span> <a
                            class="production css" data-link-type="function" href="#funcdef-dynamic-range-limit-mix"
                            id="ref-for-funcdef-dynamic-range-limit-mix">&lt;dynamic-range-limit-mix()></a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">初始值：</a>
                    <td>high
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">适用对象：</a>
                    <td><a href="https://www.w3.org/TR/css-pseudo/#generated-content"
                            title="包含 ::before 和 ::after 伪元素。">所有元素</a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">是否继承：</a>
                    <td>是
                <tr>
                    <th><a href="https://www.w3.org/TR/css-values/#percentages">百分比：</a>
                    <td>不适用
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#computed">计算值：</a>
                    <td>见 <a href="#computing-dynamic-range-limit">dynamic-range-limit 的计算值</a>
                <tr>
                    <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">规范顺序：</a>
                    <td>按照语法
                <tr>
                    <th><a href="https://www.w3.org/TR/web-animations/#animation-type">动画类型：</a>
                    <td>通过 <a class="css" data-link-type="maybe" href="#funcdef-dynamic-range-limit-mix"
                            id="ref-for-funcdef-dynamic-range-limit-mix①">dynamic-range-limit-mix()</a>
        </table>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>测试</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/computed.html"
                        title="css/css-color-hdr/computed.html">computed.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/computed.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/computed.html"><small>(源码)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/inheritance.html"
                        title="css/css-color-hdr/inheritance.html">inheritance.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/inheritance.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/inheritance.html"><small>(源码)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/interpolation.html"
                        title="css/css-color-hdr/interpolation.html">interpolation.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/interpolation.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/interpolation.html"><small>(源码)</small></a>
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/parsing.html"
                        title="css/css-color-hdr/parsing.html">parsing.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/parsing.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/parsing.html"><small>(源码)</small></a>
            </ul>
        </details>
        <dl>
            <dt><dfn class="dfn-paneled css" data-dfn-for="dynamic-range-limit" data-dfn-type="value" data-export
                    id="valdef-dynamic-range-limit-standard">standard</dfn>
            <dd> 显示的最高亮度颜色
                与媒体白相同，即 CSS 颜色 <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                    id="ref-for-valdef-color-white">white</a>。
            <dt><dfn class="dfn-paneled css" data-dfn-for="dynamic-range-limit" data-dfn-type="value" data-export
                    id="valdef-dynamic-range-limit-high">high</dfn>
            <dd> 显示的最高峰值亮度
                远高于媒体白，即 CSS 颜色 <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                    id="ref-for-valdef-color-white①">white</a>；
                具体水平未指定。
            <dt><dfn class="dfn-paneled css" data-dfn-for="dynamic-range-limit" data-dfn-type="value" data-export
                    id="valdef-dynamic-range-limit-constrained-high">constrained-high</dfn>
            <dd> 显示的最高峰值亮度
                比媒体白略高，即 CSS 颜色 <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                    id="ref-for-valdef-color-white②">white</a>，
                可使 SDR 和 HDR 内容混合显示时更舒适。
        </dl>
        <div class="example" id="ex-hdr-limit-photogrid">
            <a class="self-link" href="#ex-hdr-limit-photogrid"></a>
            <pre class="lang-css highlight">body <c- p>{</c-> <c- k>dynamic-range-limit</c-><c- p>:</c-> standard<c- p>;</c-> <c- p>}</c->
div.photogrid img <c- p>{</c-> <c- k>dynamic-range-limit</c-><c- p>:</c-> constrained-high <c- p>}</c->
</pre>
        </div>
        <h3 class="heading settled" data-level="2.4" id="dynamic-range-limit-mix"><span class="secno">2.4. </span><span
                class="content">动态范围限制混合：<a class="css" data-link-type="maybe" href="#funcdef-dynamic-range-limit-mix"
                    id="ref-for-funcdef-dynamic-range-limit-mix②">dynamic-range-limit-mix()</a> 函数</span><a
                class="self-link" href="#dynamic-range-limit-mix"></a></h3>
        <p>该函数接受两个 <a class="property css" data-link-type="property" href="#propdef-dynamic-range-limit"
                id="ref-for-propdef-dynamic-range-limit①">dynamic-range-limit</a> 值，
            内部将它们转换为高于媒体白的 stop 值，
            并根据指定比例混合后调整显示。
            实际计算结果不会暴露。</p>
        <pre class="prod"><dfn class="dfn-paneled" data-dfn-type="function" data-export id="funcdef-dynamic-range-limit-mix">dynamic-range-limit-mix()</dfn> = dynamic-range-limit-mix( [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#typedef-ident" id="ref-for-typedef-ident">&lt;ident></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-all" id="ref-for-comb-all">&amp;&amp;</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value">&lt;percentage [0,100]></a> ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-comma" id="ref-for-mult-comma">#</a>)
</pre>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>测试</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/computed.html"
                        title="css/css-color-hdr/computed.html">computed.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/computed.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/computed.html"><small>(源码)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/inheritance.html"
                        title="css/css-color-hdr/inheritance.html">inheritance.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/inheritance.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/inheritance.html"><small>(源码)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/interpolation.html"
                        title="css/css-color-hdr/interpolation.html">interpolation.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/interpolation.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/interpolation.html"><small>(源码)</small></a>
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/parsing.html"
                        title="css/css-color-hdr/parsing.html">parsing.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/parsing.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/parsing.html"><small>(源码)</small></a>
            </ul>
        </details>
        <p>如果所有百分比之和为 0%，则该函数无效。</p>
        <h3 class="heading settled" data-level="2.5" id="computing-dynamic-range-limit"><span class="secno">2.5.
            </span><span class="content"> <a class="property css" data-link-type="property"
                    href="#propdef-dynamic-range-limit"
                    id="ref-for-propdef-dynamic-range-limit②">dynamic-range-limit</a> 的计算值 </span><a class="self-link"
                href="#computing-dynamic-range-limit"></a></h3>
        <p>如果指定值为 <a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-standard"
                id="ref-for-valdef-dynamic-range-limit-standard">standard</a>、<a class="css" data-link-type="maybe"
                href="#valdef-dynamic-range-limit-constrained-high"
                id="ref-for-valdef-dynamic-range-limit-constrained-high">constrained-high</a> 或 <a class="css"
                data-link-type="maybe" href="#valdef-dynamic-range-limit-high"
                id="ref-for-valdef-dynamic-range-limit-high">high</a>，则计算值为指定值。
        </p>
        <p>如果指定值为 <a class="css" data-link-type="maybe" href="#funcdef-dynamic-range-limit-mix"
                id="ref-for-funcdef-dynamic-range-limit-mix③">dynamic-range-limit-mix()</a>，则计算值按以下算法确定：</p>
        <ol>
            <li data-md>
                <p>令 <var>v1</var>, ..., <var>vN</var> 为待混合参数的计算值。</p>
            <li data-md>
                <p>令 <var>p1</var>, ..., <var>pN</var> 为混合百分比，归一化后和为 100%。</p>
            <li data-md>
                <p>定义贡献百分比如下：</p>
                <ul>
                    <li data-md>
                        <p>令 <var>p1_standard</var>,...,<var>pN_standard</var> 为 <a class="css" data-link-type="maybe"
                                href="#valdef-dynamic-range-limit-standard"
                                id="ref-for-valdef-dynamic-range-limit-standard①">standard</a> 在
                            <var>v1</var>,...,<var>vN</var> 中的百分比
                        </p>
                    <li data-md>
                        <p>令 <var>p1_constrained_high</var>,...,<var>pN_constrained_high</var> 为
                            <a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-constrained-high"
                                id="ref-for-valdef-dynamic-range-limit-constrained-high①">constrained-high</a> 在
                            <var>v1</var>,...,<var>vN</var> 中的百分比
                        </p>
                    <li data-md>
                        <p>令 <var>p1_high</var>,...,<var>pN_high</var> 为 <a class="css" data-link-type="maybe"
                                href="#valdef-dynamic-range-limit-high"
                                id="ref-for-valdef-dynamic-range-limit-high①">high</a> 在
                            <var>v1</var>,...,<var>vN</var> 中的百分比
                        </p>
                </ul>
            <li data-md>
                <p>按如下方式计算加权和：</p>
                <ul>
                    <li data-md>
                        <p><var>p_standard</var>=(<var>p1_standard</var>*<var>p1</var>+...+<var>pN_standard</var>*<var>pN</var>)/100。
                        </p>
                    <li data-md>
                        <p><var>p_constrained_high</var>=(<var>p1_constrained_high</var>*<var>p1</var>+...+<var>pN_constrained_high</var>*<var>pN</var>)/100。
                        </p>
                    <li data-md>
                        <p><var>p_high</var>=(<var>p1_high</var>*<var>p1</var>+...+<var>pN_high</var>*<var>pN</var>)/100。
                        </p>
                </ul>
            <li data-md>
                <p>如果 <var>p_standard</var>、<var>p_constrained_high</var> 或 <var>p_high</var> 等于 100%，则计算值分别为 <a
                        class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-standard"
                        id="ref-for-valdef-dynamic-range-limit-standard②">standard</a>、<a class="css"
                        data-link-type="maybe" href="#valdef-dynamic-range-limit-constrained-high"
                        id="ref-for-valdef-dynamic-range-limit-constrained-high②">constrained-high</a> 或 <a class="css"
                        data-link-type="maybe" href="#valdef-dynamic-range-limit-high"
                        id="ref-for-valdef-dynamic-range-limit-high②">high</a>。</p>
            <li data-md>
                <p>否则，计算值为 <a class="css" data-link-type="maybe" href="#funcdef-dynamic-range-limit-mix"
                        id="ref-for-funcdef-dynamic-range-limit-mix④">dynamic-range-limit-mix()</a>，其参数为 <a class="css"
                        data-link-type="maybe" href="#valdef-dynamic-range-limit-standard"
                        id="ref-for-valdef-dynamic-range-limit-standard③">standard</a>、<a class="css"
                        data-link-type="maybe" href="#valdef-dynamic-range-limit-constrained-high"
                        id="ref-for-valdef-dynamic-range-limit-constrained-high③">constrained-high</a> 和 <a class="css"
                        data-link-type="maybe" href="#valdef-dynamic-range-limit-high"
                        id="ref-for-valdef-dynamic-range-limit-high③">high</a>，按此顺序，百分比分别为
                    <var>p_standard</var>、<var>p_constrained_high</var> 和 <var>p_high</var>，忽略百分比为 0% 的参数。
                </p>
        </ol>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>测试</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/computed.html"
                        title="css/css-color-hdr/computed.html">computed.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/computed.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/computed.html"><small>(源码)</small></a>
            </ul>
        </details>
        <div class="example" id="ex-hdr-limit-mix">
            <a class="self-link" href="#ex-hdr-limit-mix"></a> 下列代码的计算值为
            <pre class="lang-css highlight"><c- nf>dynamic-range-limit-mix</c-><c- p>(</c->
    high <c- m>10</c-><c- k>%</c-><c- p>,</c->
    <c- nf>dynamic-range-limit-mix</c-><c- p>(</c->standard <c- m>25</c-><c- k>%</c-><c- p>,</c-> constrained-high <c- m>75</c-><c- k>%</c-><c- p>)</c-> <c- m>20</c-><c- k>%</c-><c- p>,</c->
    <c- nf>dynamic-range-limit-mix</c-><c- p>(</c->constrained-high <c- m>10</c-><c- k>%</c-><c- p>,</c-> high <c- m>30</c-><c- k>%</c-><c- p>)</c-> <c- m>20</c-><c- k>%</c-><c- p>)</c->
</pre>
            <p>为</p>
            <pre class="lang-css highlight"><c- nf>dynamic-range-limit-mix</c-><c- p>(</c->standard <c- m>10</c-><c- k>%</c-><c- p>,</c-> constrained-high <c- m>40</c-><c- k>%</c-><c- p>,</c-> high <c- m>50</c-><c- k>%</c-><c- p>)</c->
</pre>
        </div>
        <h2 class="heading settled" data-level="3" id="color-function"><span class="secno">3. </span><span
                class="content"> 指定预定义和自定义色彩空间：<a class="css" data-link-type="maybe" href="#funcdef-color"
                    id="ref-for-funcdef-color">color()</a> 函数
            </span><a class="self-link" href="#color-function"></a></h2>
        <p><a class="css" data-link-type="maybe" href="#funcdef-color" id="ref-for-funcdef-color①">color()</a>
            函数允许在特定的<a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#color-space"
                id="ref-for-color-space">色彩空间</a>中指定颜色（而不是大多数其他颜色函数使用的隐式 sRGB 色彩空间）。</p>
        <p>在本规范中，<a class="css" data-link-type="maybe" href="#funcdef-color" id="ref-for-funcdef-color②">color()</a>
            函数被扩展为
            除了来自<a href="https://www.w3.org/TR/css-color-4/#predefined"><cite>CSS Color 4</cite> § 10. 预定义色彩空间</a>的预定义
            SDR 空间和<a href="https://www.w3.org/TR/css-color-5/#relative-colors"><cite>CSS Color 5</cite> § 4
                相对颜色语法</a>的相对色彩语法外，
            还允许使用<a href="#predefined-HDR">HDR 的预定义色彩空间</a>。
        </p>
        <p>其语法如下：</p>
        <pre class="prod"><dfn class="dfn-paneled" data-dfn-type="function" data-export id="funcdef-color">color()</dfn> = color( [from <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color">&lt;color></a>]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt">?</a> <a class="production" data-link-type="type" href="#typedef-colorspace-params" id="ref-for-typedef-colorspace-params">&lt;colorspace-params></a> [ / [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" id="ref-for-typedef-color-alpha-value">&lt;alpha-value></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③">|</a> none ] ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt①">?</a> )
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-colorspace-params">&lt;colorspace-params></dfn> = [<a class="production" data-link-type="type" href="#typedef-custom-params" id="ref-for-typedef-custom-params">&lt;custom-params></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one④">|</a> <a class="production" data-link-type="type" href="#typedef-predefined-rgb-params" id="ref-for-typedef-predefined-rgb-params">&lt;predefined-rgb-params></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑤">|</a> 
  <a class="production" data-link-type="type" href="#typedef-predefined-polar-params" id="ref-for-typedef-predefined-polar-params">&lt;predefined-polar-params></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑥">|</a> <a class="production" data-link-type="type" href="#typedef-predefined-rectangular-params" id="ref-for-typedef-predefined-rectangular-params">&lt;predefined-rectangular-params></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑦">|</a> <a class="production" data-link-type="type" href="#typedef-xyz-params" id="ref-for-typedef-xyz-params">&lt;xyz-params></a>]
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-custom-params">&lt;custom-params></dfn> = <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#typedef-dashed-ident" id="ref-for-typedef-dashed-ident">&lt;dashed-ident></a> [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑧">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value①">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑨">|</a> none ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-one-plus" id="ref-for-mult-one-plus">+</a>
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-predefined-rgb-params">&lt;predefined-rgb-params></dfn> = <a class="production" data-link-type="type" href="#typedef-predefined-rgb" id="ref-for-typedef-predefined-rgb">&lt;predefined-rgb></a> [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value①">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⓪">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value②">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①①">|</a> none ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-num" id="ref-for-mult-num">{3}</a>
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-predefined-polar-params">&lt;predefined-polar-params></dfn> = jzczhz [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value②">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①②">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value③">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①③">|</a> none ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-num" id="ref-for-mult-num①">{2}</a> [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-4/#typedef-hue" id="ref-for-typedef-hue">&lt;hue></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①④">|</a> none]
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-predefined-rectangular-params">&lt;predefined-rectangular-params></dfn> = <a class="production" data-link-type="type" href="#typedef-predefined-rectangular" id="ref-for-typedef-predefined-rectangular">&lt;predefined-rectangular></a> [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value③">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑤">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value④">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑥">|</a> none ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-num" id="ref-for-mult-num②">{3}</a>
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-predefined-rgb">&lt;predefined-rgb></dfn> = srgb <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑦">|</a> srgb-linear <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑧">|</a> display-p3 <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑨">|</a> a98-rgb <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⓪">|</a> prophoto-rgb <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②①">|</a> rec2020 <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②②">|</a> 
  rec2100-pq <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②③">|</a> rec2100-hlg <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②④">|</a> rec2100-linear
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-predefined-rectangular">&lt;predefined-rectangular></dfn> = jzazbz <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑤">|</a> ictcp
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-xyz-params">&lt;xyz-params></dfn> = <a class="production" data-link-type="type" href="#typedef-xyz" id="ref-for-typedef-xyz">&lt;xyz></a> [ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value④">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑥">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value⑤">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑦">|</a> none ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-num" id="ref-for-mult-num③">{3}</a>
<dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-xyz">&lt;xyz></dfn> = xyz <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑧">|</a> xyz-d50 <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑨">|</a> xyz-d65
</pre>
        <h2 class="heading settled" data-level="4" id="predefined-HDR"><span class="secno">4. </span><span
                class="content">HDR 预定义色彩空间：</span><a class="self-link" href="#predefined-HDR"></a>
        </h2>
        <p>除了 CSS Color 4 定义的<a href="https://drafts.csswg.org/css-color-4/#predefined">SDR
                色彩空间</a>外，下列 HDR 色彩空间也被定义，可在 color 函数中使用。</p>
        <p>这些新色彩空间值的序列化方式与<a href="https://www.w3.org/TR/css-color-4/#serializing-color-values"><cite>CSS Color 4</cite>
                §  15. 序列化 &lt;color> 值</a>中的描述一致。</p>
        <h3 class="heading settled" data-level="4.1" id="valdef-color-rec2100-pq"><span class="secno">4.1. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="rec2100-pq">rec2100-pq</dfn></span><a class="self-link" href="#valdef-color-rec2100-pq"></a>
        </h3>
        <p><span class="css">rec2100-pq</span> <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            色彩空间接受三个数值参数，
            分别代表该颜色的红、绿、蓝通道，
            每个通道的有效范围为 [0, 1]，
            与实际位深（每通道 10 或 12 位）无关。</p>
        <p>采用感知量化器（PQ）电光转换函数 <a data-link-type="biblio" href="#biblio-smpte-st-2084"
                title="ST 2084:2014 - SMPTE Standard - High Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays">[SMPTE-ST-2084]</a>，<a
                data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            PQ 假定参考观看环境下屏幕周围亮度为 5 cd/m²。</p>
        <p>ITU Reference 2100 用于 HDR 4k 和 8k 电视。</p>
        <p>与 SDR 色彩空间及部分 HDR 色彩空间不同，
            PQ 值是<em>绝对</em>值而非相对值。</p>
        <p class="issue" id="issue-b905ab0c"><a class="self-link" href="#issue-b905ab0c"></a> 补充一张用对数刻度显示 SDR 和 HDR
            动态范围的图</p>
        <p>其特性如下：
            （显示基色与<a data-link-type="biblio" href="#biblio-rec2020"
                title="Recommendation  ITU-R  BT.2020-2:  Parameter values for ultra-high definition television systems for production and international programme exchange">[Rec.2020]</a>相同）：
        </p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>红色色度
                    <td>0.708
                    <td>0.292
                <tr>
                    <th>绿色色度
                    <td>0.170
                    <td>0.797
                <tr>
                    <th>蓝色色度
                    <td>0.131
                    <td>0.046
                <tr>
                    <th>白色色度
                    <td colspan="2"><a data-link-type="dfn">D65</a>
                <tr>
                    <th>转换函数
                    <td colspan="2">Perceptual Quantizer
                <tr>
                    <th>白色亮度
                    <td colspan="2">203 cd/m²
                <tr>
                    <th>峰值白亮度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黑色亮度
                    <td colspan="2">≤ 0.005 cd/m²
                <tr>
                    <th>图像状态
                    <td colspan="2">display-referred
                <tr>
                    <th>百分比
                    <td colspan="2">R、G、B 均可用百分比
                <tr>
                    <th>百分比参考范围
                    <td>R、G、B：0% = 0.0，100% = 1.0
        </table>
        <p>对于非参考观看环境下的窄范围 PQ 视频，
            或 HLG（任何观看环境），
            应使用<a data-link-type="biblio" href="#biblio-rec_bt814"
                title="Specifications of PLUGE test signals and alignment procedures for setting of brightness and contrast of displays">[Rec_BT.814]</a>
            附录中的 PLUGE 测试信号和程序来调整黑位。
            对于 CSS 中的 PQ 值（使用宽范围），
            黑色对应码点 0。</p>
        <div class="example" id="example-dbd71f8e">
            <a class="self-link" href="#example-dbd71f8e"></a> 此颜色表示一个炫目的白色，
            亮度为 10,000 cd/m²。
            这种极亮颜色只能在屏幕的小区域短暂显示。
            内容通常以较低的峰值白进行母版制作，
            如 4,000 cd/m²。
            <pre><span class="swatch oog" style="--color: white"></span> color(rec2100-pq 1.0 1.0 1.0);
</pre>
        </div>
        <div class="example" id="example-f604e8a3">
            <a class="self-link" href="#example-f604e8a3"></a> 此颜色表示舒适的“漫反射白”
            可长时间显示，
            或用于字幕，
            可用于屏幕任何区域。
            它与 sRGB <a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                id="ref-for-valdef-color-white③">white</a> 颜色相同。
            漫反射白为 203 cd/m² <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            <pre><span class="swatch" style="--color: white"></span> color(rec2100-pq 0.58 0.58 0.58);
</pre>
            <p>此颜色表示中灰，
                类似摄影师用的“18% 反射率灰卡”，
                亮度为 17 cd/m²。</p>
            <pre><span class="swatch" style="--color: rgb(46.632% 46.632% 46.632%)"></span> color(rec2100-pq 0.34 0.34 0.34)
</pre>
        </div>
        <p class="issue" id="issue-3762b88c"><a class="self-link" href="#issue-3762b88c"></a> 补充更多示例，包括 sRGB 红、绿、蓝和 P3
            红、绿、蓝的编码。</p>
        <p>线性光 RGB 信号到 PQ 编码的转换如下。采用绝对亮度标尺，因此需要用漫反射（媒体）白的亮度对相对亮度进行缩放。PQ 最大可编码值（峰值，小面积白）为 10,000 cd/m²。媒体白为 203 cd/m² <a
                data-link-type="biblio" href="#biblio-rpt_bt2408"
                title="Report ITU-R BT.2408-0 Operational practices in HDR television production">[Rpt_BT.2408]</a>。</p>
        <pre class="lang-javascript highlight"><c- a>var</c-> Er<c- p>;</c->      <c- c1>// 红、绿、蓝分量，[0, 1] 为 SDR，[0, 70 左右] 为 HDR</c->
<c- a>var</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c->  <c- c1>// 漫反射白的绝对亮度，cd/m²</c->
<c- a>var</c-> x <c- o>=</c-> Er <c- o>*</c-> Yw <c- o>/</c-> <c- mf>10000</c-><c- p>;</c->   <c- c1>// 峰值白的绝对亮度为 10,000 cd/m²。</c->
<c- a>const</c-> n <c- o>=</c-> <c- mf>2610</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>);</c->
<c- a>const</c-> m <c- o>=</c-> <c- mf>2523</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>);</c->
<c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>);</c->
<c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
<c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
xPQ <c- o>=</c-> <c- p>(((</c->c1 <c- o>+</c-> <c- p>(</c->c2 <c- o>*</c-> <c- p>(</c->x <c- o>**</c-> n<c- p>)))</c-> <c- o>/</c-> <c- p>(</c-><c- mf>1</c-> <c- o>+</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->x <c- o>**</c-> n<c- p>))))</c-> <c- o>**</c-> m<c- p>);</c->

</pre>
        <p>xPQ 是“伽马校正后”（OETF 调整后）的信号 [0, 1]。</p>
        <p>PQ 编码值到线性光的转换如下：</p>
        <pre class="lang-javascript highlight"><c- a>var</c-> xPQ<c- p>;</c->      <c- c1>// PQ 编码红、绿、蓝分量，[0, 1]</c->
<c- a>const</c-> ninv <c- o>=</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2610</c-><c- p>;</c->
<c- a>const</c-> minv <c- o>=</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2523</c-><c- p>;</c->
<c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>);</c->
<c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
<c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
<c- a>var</c-> x <c- o>=</c-> <c- p>(((</c->Math<c- p>.</c->max<c- p>(((</c->xPQ <c- o>**</c-> minv<c- p>)</c-> <c- o>-</c-> c1<c- p>),</c-> <c- mf>0</c-><c- p>)</c-> <c- o>/</c-> <c- p>(</c->c2 <c- o>-</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->xPQ <c- o>**</c-> minv<c- p>))))</c-> <c- o>**</c-> ninv<c- p>);</c->
<c- a>var</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c->      <c- c1>// 漫反射白的绝对亮度，cd/m²</c->
<c- a>var</c-> Ea <c- o>=</c-> x <c- o>*</c-> <c- mf>10000</c-><c- p>;</c->   <c- c1>// 绝对亮度，[0, 10,000]</c->
<c- a>var</c-> Er <c- o>=</c-> x <c- o>*</c-> <c- mf>10000</c-> <c- o>/</c-> Yw<c- p>;</c->   <c- c1>// 相对漫反射白的亮度，[0, 70 左右]</c->
</pre>
        <h3 class="heading settled" data-level="4.2" id="valdef-color-rec2100-hlg"><span class="secno">4.2. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="rec2100-hlg">rec2100-hlg</dfn></span><a class="self-link" href="#valdef-color-rec2100-hlg"></a>
        </h3>
        <p><span class="css">rec2100-hlg</span> <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            色彩空间接受三个数值参数，
            分别代表该颜色的红、绿、蓝通道，
            每个通道的有效范围为 [0, 1]，
            与实际位深（每通道 10 或 12 位）无关。</p>
        <p>采用混合对数伽玛（HLG）电光转换函数
            <a data-link-type="biblio" href="#biblio-arib_std-b67"
                title="Essential Parameter Values for the Extended Image Dynamic Range Television (EIDRTV) System for Programme Production">[ARIB_STD-B67]</a>，<a
                data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            HLG 可用于各种亮度的显示器，
            并适应广泛的观看环境，
            用户可控制整体亮度水平。
            值 0.75 表示“漫反射”或“媒体”白，
            而“18% 反射灰卡”为 0.38。<a data-link-type="biblio" href="#biblio-rec_bt2390"
                title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>。
        </p>
        <p>其特性如下：
            （显示基色与<a data-link-type="biblio" href="#biblio-rec2020"
                title="Recommendation  ITU-R  BT.2020-2:  Parameter values for ultra-high definition television systems for production and international programme exchange">[Rec.2020]</a>相同）：
        </p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>红色色度
                    <td>0.708
                    <td>0.292
                <tr>
                    <th>绿色色度
                    <td>0.170
                    <td>0.797
                <tr>
                    <th>蓝色色度
                    <td>0.131
                    <td>0.046
                <tr>
                    <th>白色色度
                    <td colspan="2"><a data-link-type="dfn">D65</a>
                <tr>
                    <th>转换函数
                    <td colspan="2">Hybrid log Gamma
                <tr>
                    <th>白色亮度
                <tr>
                    <td colspan="2">取决于观看条件
                <tr>
                    <th>峰值白亮度
                    <td colspan="2">12 倍参考白
                <tr>
                    <th>黑色亮度
                    <td colspan="2">取决于参考白，详见正文
                <tr>
                    <th>图像状态
                    <td colspan="2">scene-referred
                <tr>
                    <th>百分比
                    <td colspan="2">R、G、B 均可用百分比
                <tr>
                    <th>百分比参考范围
                    <td>R、G、B：0% = 0.0，100% = 1.0
        </table>
        <p>对于窄范围 HLG 视频（任何观看环境），
            应使用<a data-link-type="biblio" href="#biblio-rec_bt814"
                title="Specifications of PLUGE test signals and alignment procedures for setting of brightness and contrast of displays">[Rec_BT.814]</a>
            附录 4 中的 PLUGE 测试信号和程序来调整黑位。
            对于 CSS 中的 HLG 值（使用宽范围），
            黑色对应码点 0。</p>
        <p class="issue" id="issue-63bd5f3d"><a class="self-link" href="#issue-63bd5f3d"></a> 补充更多示例</p>
        <div class="example" id="example-8d914a69">
            <a class="self-link" href="#example-8d914a69"></a> 此颜色表示舒适的“漫反射白”
            可长时间显示，
            或用于字幕，
            可用于屏幕任何区域。
            内容通常母版峰值白为 1,000–4,000 cd/m²，
            则漫反射白为 203–581 cd/m²。
            <pre><span class="swatch" style="--color: white"></span> color(rec2100-hlg 0.75 0.75 0.75);
</pre>
            <p>此颜色表示中灰，
                亮度为 26–104 cd/m²。</p>
            <pre><span class="swatch" style="--color: rgb(46.632% 46.632% 46.632%)"></span> color(rec2100-hlg 0.38 0.38 0.38)
</pre>
        </div>
        <p>线性光 RGB 信号到 HLG 编码的转换如下 <a data-link-type="biblio" href="#biblio-rec_bt2390"
                title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>：
        </p>
        <pre class="lang-javascript highlight"><c- a>var</c-> E<c- p>;</c->      <c- c1>// 红、绿、蓝分量，[0, 1]</c->
<c- a>const</c-> a <c- o>=</c-> <c- mf>0.17883277</c-><c- p>;</c->
<c- a>const</c-> b <c- o>=</c-> <c- mf>0.28466892</c-><c- p>;</c->   <c- c1>// 1 - (4 * a)</c->
<c- a>const</c-> c <c- o>=</c-> <c- mf>0.55991073</c-><c- p>;</c->   <c- c1>// 0.5 - a * Math.log(4 *a)</c->
<c- c1>// 处理负值</c->
<c- a>var</c-> sign <c- o>=</c-> E <c- o>&lt;</c-> <c- mf>0</c-><c- o>?</c-> <c- o>-</c-><c- mf>1</c-> <c- o>:</c-> <c- mf>1</c-><c- p>;</c->
<c- a>var</c-> abs <c- o>=</c-> Math<c- p>.</c->abs<c- p>(</c->E<c- p>);</c->
<c- k>if</c-> <c- p>(</c->abs <c- o>&lt;=</c-> <c- mf>1</c-><c- o>/</c-><c- mf>12</c-><c- p>)</c-> <c- p>{</c->
  Edash <c- o>=</c-> sign <c- o>*</c-> Math<c- p>.</c->sqrt<c- p>(</c-> <c- mf>3</c-> <c- o>*</c-> abs<c- p>);</c->
<c- p>}</c->
<c- k>else</c-> <c- p>{</c->
  Edash <c- o>=</c-> a <c- o>*</c-> Math<c- p>.</c->log<c- p>(</c-><c- mf>12</c-> <c- o>*</c-> E <c- o>-</c-> b<c- p>)</c-> <c- o>+</c-> c<c- p>;</c->
<c- p>}</c->
</pre>
        <p>Edash 为“伽马校正后”（OETF 调整后）信号。</p>
        <p>反向转换（HLG 编码到线性光）如下 <a data-link-type="biblio" href="#biblio-rec_bt2390"
                title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>：
        </p>
        <pre class="lang-javascript highlight"><c- a>var</c-> Edash<c- p>;</c->      <c- c1>// 编码红、绿、蓝分量，[0, 1]</c->
<c- a>const</c-> a <c- o>=</c-> <c- mf>0.17883277</c-><c- p>;</c->
<c- a>const</c-> b <c- o>=</c-> <c- mf>0.28466892</c-><c- p>;</c->   <c- c1>// 1 - (4 * a)</c->
<c- a>const</c-> c <c- o>=</c-> <c- mf>0.55991073</c-><c- p>;</c->   <c- c1>// 0.5 - a * Math.log(4 *a)</c->
<c- k>if</c-> <c- p>(</c->Edash <c- o>&lt;=</c-> <c- mf>0.5</c-><c- p>)</c-> <c- p>{</c->
  E <c- o>=</c-> <c- p>(</c->Edash <c- o>**</c-> <c- mf>2</c-><c- p>)</c-> <c- o>/</c-> <c- mf>3</c-><c- p>;</c->
<c- p>}</c->
<c- k>else</c-> <c- p>{</c->
  E <c- o>=</c-> <c- p>(</c->Math<c- p>.</c->exp<c- p>((</c->Edash <c- o>-</c-> c<c- p>)</c-> <c- o>/</c-> a<c- p>)</c-> <c- o>+</c-> b<c- p>)</c-> <c- o>/</c-> <c- mf>12</c-><c- p>;</c->
<c- p>}</c->
</pre>
        <p class="issue" id="issue-fb589d17"><a class="self-link" href="#issue-fb589d17"></a> 是否补充同页定义的黑位提升 Β？</p>
        <h3 class="heading settled" data-level="4.3" id="valdef-color-rec2100-linear"><span class="secno">4.3.
            </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="rec2100-linear">rec2100-linear</dfn></span><a class="self-link"
                href="#valdef-color-rec2100-linear"></a></h3>
        <p><span class="css">rec2100-linear</span> <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            色彩空间接受三个数值参数，
            分别代表该颜色的红、绿、蓝通道，
            每个通道的标称范围为 [0, 1]，
            与实际位深（每通道 10 或 12 位）无关。</p>
        <p>红、绿、蓝都为 1.0 的颜色
            表示 HDR 参考白，其绝对亮度为
            203 cd/m²。</p>
        <pre
            class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>1</c-> <c- m>1</c-> <c- m>1</c-><c- p>)</c-></pre>
        <div class="example" id="example-9e27a38c">
            <a class="self-link" href="#example-9e27a38c"></a> 例如，下列颜色
            <pre
                class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>9.852</c-> <c- m>9.852</c-> <c- m>9.852</c-><c- p>)</c-></pre>
            <p>表示亮度为
                9.852 × 203 = 1,999 cd/m² 的白色高光。</p>
        </div>
        <div class="example" id="example-071a1469">
            <a class="self-link" href="#example-071a1469"></a> 此颜色表示舒适的“漫反射白”
            可长时间显示，
            或用于字幕，
            可用于屏幕任何区域。
            它与 sRGB <a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                id="ref-for-valdef-color-white④">white</a> 颜色相同。
            漫反射白为 203 cd/m² <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            <pre><span class="swatch" style="--color: white"></span> color(rec2100-linear 1 1 1)
</pre>
        </div>
        <p>使用线性光电光转换函数。</p>
        <p>其特性如下：
            （显示基色与<a data-link-type="biblio" href="#biblio-rec2020"
                title="Recommendation  ITU-R  BT.2020-2:  Parameter values for ultra-high definition television systems for production and international programme exchange">[Rec.2020]</a>相同）：
        </p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>红色色度
                    <td>0.708
                    <td>0.292
                <tr>
                    <th>绿色色度
                    <td>0.170
                    <td>0.797
                <tr>
                    <th>蓝色色度
                    <td>0.131
                    <td>0.046
                <tr>
                    <th>白色色度
                    <td colspan="2"><a data-link-type="dfn">D65</a>
                <tr>
                    <th>转换函数
                    <td colspan="2">Linear
                <tr>
                    <th>白色亮度
                    <td colspan="2">203 cd/m²
                <tr>
                    <th>峰值白亮度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黑色亮度
                    <td colspan="2">0.001 cd/m²
                <tr>
                    <th>图像状态
                    <td colspan="2">display-referred
                <tr>
                    <th>百分比
                    <td colspan="2">R、G、B 均可用百分比
                <tr>
                    <th>百分比参考范围
                    <td>R、G、B：0% = 0.0，100% = 1.0
        </table>
        <h3 class="heading settled" data-level="4.4" id="Jzazbz"><span class="secno">4.4. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="jzazbz">Jzazbz</dfn></span><a class="self-link" href="#Jzazbz"></a></h3>
        <p><span class="css">Jzazbz</span> 色彩空间 <a data-link-type="biblio" href="#biblio-safdar-pucs"
                title="Perceptually uniform color space for image signals including high dynamic range and wide gamut">[Safdar-PUCS]</a>
            接受三个数值参数，
            其中 J<sub>z</sub> 代表明度（类似 Lab 中的 L），
            a<sub>z</sub> 和 b<sub>z</sub> 分别代表
            红-绿和黄-蓝对立色轴（类似 Lab 中的 a 和 b）。</p>
        <p>CIE Lab 使用 [0%, 100%] 范围的明度刻度，
            相对于媒体白，
            并已实验性扩展到 L=400%。
            相比之下，<span class="css">Jzazbz</span> 的 J<sub>z</sub> 轴范围为 [0, 1.0]，
            采用与 PQ 类似的编码，
            可表示超过 13 级的动态范围。</p>
        <p>其特性如下：</p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>白色色度
                    <td colspan="2"><a data-link-type="dfn">D65</a>
                <tr>
                    <th>转换函数
                    <td colspan="2">Perceptual Quantizer
                <tr>
                    <th>峰值白亮度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黑色亮度
                    <td colspan="2">0.001 cd/m²
                <tr>
                    <th>图像状态
                    <td colspan="2">display-referred
                <tr>
                    <th>百分比
                    <td colspan="2">Jz、az、bz 均可用百分比
                <tr>
                    <th>百分比参考范围
                    <td>Jz：0% = 0.0，100% = 1.0<br>az、bz：-100% = -1.0，100% = 1.0
        </table>
        <p>注意，与 Lab 不同，使用的是 <a data-link-type="dfn">D65</a> 白点。
            因此对于大多数 RGB 空间
            （同样采用 D65 白点），
            无需进行色度适配步骤。</p>
        <div class="example" id="example-ff468b89">
            <a class="self-link" href="#example-ff468b89"></a> 此颜色表示舒适的“漫反射白”
            可长时间显示，
            或用于字幕，
            可用于屏幕任何区域。
            它与 sRGB <a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                id="ref-for-valdef-color-white⑤">white</a> 颜色相同。
            漫反射白为 203 cd/m² <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            <pre><span class="swatch" style="--color: white"></span> color(jzazbz 0.22207 -0.00016 -0.00012)
</pre>
        </div>
        <h3 class="heading settled" data-level="4.5" id="JzCzHz"><span class="secno">4.5. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="jzczhz">JzCzHz</dfn></span><a class="self-link" href="#JzCzHz"></a></h3>
        <p>类似于 Lab 的极坐标形式 LCH，<span class="css">JzCzHz</span> 是 <span class="css">Jzazbz</span> 的极坐标形式。
            J<sub>z</sub> 与 <span class="css">JzCzHz</span> 中的值相同，代表明度，
            C<sub>z</sub> 代表色度或色彩度，
            H<sub>z</sub> 代表色相角，
            从正 a<sub>z</sub> 轴起，朝正 b<sub>z</sub> 轴方向计。</p>
        <div class="example" id="example-34868c8f">
            <a class="self-link" href="#example-34868c8f"></a> 此颜色表示 sRGB“lime”在 <span class="css">Jzazbz</span> 空间下的值
            <pre><span class="swatch" style="--color: lime"></span> color(jzazbz 0.17542 -0.1179 0.1092)
</pre>
            <p>同样颜色的极坐标形式如下</p>
            <pre><span class="swatch" style="--color: lime"></span> color(jzczhz 0.17542 0.1614 132.50)
</pre>
        </div>
        <h4 class="heading settled" data-level="4.5.1" id="Jzazbz-to-JzCzHz"><span class="secno">4.5.1. </span><span
                class="content"> <span class="css">Jzazbz</span> 颜色到 <span class="css">JzCzHz</span> 颜色的转换</span><a
                class="self-link" href="#Jzazbz-to-JzCzHz"></a></h4>
        <p>转换到 <span class="css">JzCzHz</span> 极为简单：</p>
        <ol>
            <li>Hz = atan2(bz, az) // 但要转换为度！
            <li>Cz = sqrt(az^2 + bz^2)
            <li>Jz 不变
        </ol>
        <h4 class="heading settled" data-level="4.5.2" id="JzCzHz-to-Jzazbz"><span class="secno">4.5.2. </span><span
                class="content"> JzCzHz 颜色到 Jzazbz 颜色的转换</span><a class="self-link" href="#JzCzHz-to-Jzazbz"></a></h4>
        <p>转换到 <span class="css">Jzazbz</span> 也极为简单：</p>
        <ol>
            <li>az = Cz cos(H) // 先转换为弧度！
            <li>bz = Cz sin(H) // 先转换为弧度！
            <li>Jz 不变
        </ol>
        <h3 class="heading settled" data-level="4.6" id="ICtCp"><span class="secno">4.6. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="ictcp">ICtCp</dfn></span><a
                class="self-link" href="#ICtCp"></a></h3>
        <p><span class="css">ICtCp</span> 色彩空间被定义为在 <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            中的 Constant Intensity IC<sub>T</sub>C<sub>P</sub> 信号格式，
            接受三个数值参数，
            其中 I 表示强度（类似于 Lab 中的 L，但覆盖可达 10,000 cd/m<sup>2</sup> 的亮度范围），
            而 C<sub>T</sub> 与 C<sub>P</sub> 分别表示黄-蓝（tritanope）和红-绿（protanope）的对立色轴（分别类似于 Lab 中的 b 和 a）。</p>
        <p>它基于人类视觉系统的 LMS 视锥原色；
            使用 Hunt-Pointer-Estevez (HPE) 的 XYZ 到 LMS 变换，
            并规范化到 <a data-link-type="dfn">D65</a> 白点。
            随后应用串扰矩阵，
            以减少 BT.2020 RGB 的色域轮廓凹陷，
            从而减少插值误差。
            串扰还改善了恒定色相线和 JND（刚好可察觉差异）MacAdam 椭圆的一致性。</p>
        <p>其特性如下：</p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>白色色度
                    <td colspan="2"><a data-link-type="dfn">D65</a>
                <tr>
                    <th>转换函数
                    <td colspan="2">Perceptual Quantizer
                <tr>
                    <th>白色亮度
                    <td colspan="2">203 cd/m²
                <tr>
                    <th>峰值白亮度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黑色亮度
                    <td colspan="2">0.001 cd/m²
                <tr>
                    <th>图像状态
                    <td colspan="2">display-referred
                <tr>
                    <th>百分比
                    <td colspan="2">允许用于 I、Ct 和 Cp
                <tr>
                    <th>百分比参考范围
                    <td>对 I：0% = 0.0，100% = 1.0<br> 对 Ct 和 Cp：-100% = -1.0，100% = 1.0
        </table>
        <p>尽管 <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            通过从线性光 BT.2100 RGB 的转换来定义 IC<sub>T</sub>C<sub>P</sub>（见 [Rec_BT.2100]），
            该转换是经由 LMS 进行的，因此任何其他色彩空间也可以通过应用 XYZ 到 LMS 的变换来表示。</p>
        <p>注意，与 Lab 不同，这里使用的是 <a data-link-type="dfn">D65</a> 白点。</p>
        <p>此外，不同于主要以低强度反射色测试的 Lab，
            IC<sub>T</sub>C<sub>P</sub> 已使用高色度、自发光和高强度（HDR）颜色进行测试。
            这使其适用于色差测量（deltaE ITP）
            以及对 SDR 和 HDR 颜色的色域映射。</p>
        <div class="example" id="example-c4316f3d">
            <a class="self-link" href="#example-c4316f3d"></a> 此颜色表示 <span class="css">ICtCp</span> 空间下的 sRGB 颜色 “lime”
            <pre><span class="swatch" style="--color: lime"></span> color(ictcp 0.5393 -0.2643 -0.0625)
</pre>
        </div>
        <div class="example" id="example-2c7022c8">
            <a class="self-link" href="#example-2c7022c8"></a> 此颜色表示舒适的“漫反射白”
            该颜色可长时间显示，
            或用于字幕，
            适用于屏幕任意大小的区域。
            它与 sRGB 的 <a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                id="ref-for-valdef-color-white⑥">white</a> 相同。
            漫反射白为 203 cd/m² <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            <pre><span class="swatch" style="--color: white"></span> color(ictcp 0.58069 0 0)
</pre>
        </div>
        <h2 class="heading settled" data-level="5" id="Compositing-SDR-HDR"><span class="secno">5. </span><span
                class="content">合成 SDR 与 HDR 内容</span><a class="self-link" href="#Compositing-SDR-HDR"></a></h2>
        <p>合成应当在 CIE XYZ 中进行，
            因为它是一个线性光空间且没有色域限制。
            实现也可以选择在线性光 RGB 空间中进行合成，
            只要正确处理并保留超出色域的值（负值或大于 100% 的值），
            并在最终传送到设备色彩空间之前不执行裁剪或色域映射，结果将相同。</p>
        <p>使用 HLG 传输函数的相对 HDR 必须将 SDR 媒体白映射到用于显示 75% HLG 值的相同亮度。 <a data-link-type="biblio" href="#biblio-smpte-st-2084"
                title="ST 2084:2014 - SMPTE Standard - High Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays">[SMPTE-ST-2084]</a>
        </p>
        <p>更多细节请参见 ITU Rpt_BT.2408-0 的表 3 和表 4 <a data-link-type="biblio" href="#biblio-rpt_bt2408"
                title="Report ITU-R BT.2408-0 Operational practices in HDR television production">[Rpt_BT.2408]</a></p>
        <p>使用 PQ 传输函数的绝对 HDR 应当将 SDR 媒体白映射到 203 cd/m²，
            这与用于显示 58% PQ 值的亮度相同。 <a data-link-type="biblio" href="#biblio-smpte-st-2084"
                title="ST 2084:2014 - SMPTE Standard - High Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays">[SMPTE-ST-2084]</a>
            但是，实施者可以选择加入色彩重渲染步骤（OOTF）
            以考虑非参考观看条件。</p>
        <h2 class="heading settled" data-level="6" id="serializing-color-values"><span class="secno">6. </span><span
                class="content"> 序列化 <a class="production css" data-link-type="type"
                    href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color①">&lt;color></a>
                值</span><a class="self-link" href="#serializing-color-values"></a></h2>
        <h3 class="heading settled" data-level="6.1" id="serializing-color-function-values"><span class="secno">6.1.
            </span><span class="content"> 序列化 <a class="css" data-link-type="maybe" href="#funcdef-color"
                    id="ref-for-funcdef-color③">color()</a> 函数的值</span><a class="self-link"
                href="#serializing-color-function-values"></a></h3>
        <p>本节扩展了 <a href="https://www.w3.org/TR/css-color-4/#serializing-color-function-values"><cite>CSS
                    Color 4</cite> § 15.5 序列化 color() 函数的值</a></p>
        <p><a class="css" data-link-type="maybe" href="#funcdef-color" id="ref-for-funcdef-color④">color()</a> 值的序列化形式
            源自 <a data-link-type="dfn" href="https://www.w3.org/TR/css-cascade-5/#computed-value"
                id="ref-for-computed-value">计算值</a> 并使用 <span class="css" id="ref-for-funcdef-color⑤">color()</span> 形式，
            函数名和色彩空间名称使用 <a href="https://infra.spec.whatwg.org/#ascii-lowercase">ASCII 小写</a> 字母。</p>
        <p>组件值以 10 进制序列化，
            作为 <a class="production css" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value"
                id="ref-for-number-value⑤">&lt;number></a>。
            组件值之间以及色彩空间名与第一个颜色分量之间必须使用单个 ASCII 空格字符 " " 作为分隔符。</p>
        <p>对于预定义的 HDR 色彩空间，
            用于往返（round-tripping）的最小精度如下：</p>
        <table class="data" id="predefined-precision-table">
            <tbody>
                <tr>
                    <th>HDR 色彩空间
                    <th>最少位数
                <tr>
                    <td><span class="css">rec2100-pq</span>, <span class="css">rec2100-hlg</span>
                    <td>10
                <tr>
                    <td><span class="css">rec2100-linear</span>, <span class="css">jzazbz</span>, <span
                            class="css">jzczhz</span>, <span class="css">ictcp</span>
                    <td>16
        </table>
        <p>（建议内部存储使用 16bit、half-float 或 float <em>每分量</em>）。
            值必须 <a href="https://drafts.csswg.org/css-values-4/#combine-integers">向 +∞ 四舍五入</a>，而非截断。</p>
        <p class="issue" id="issue-ffacc2d5"><a class="self-link" href="#issue-ffacc2d5"></a> 基于 PQ
            的色彩空间在不同观看环境中是否需要进行色调映射（OOTF）以便显示？</p>
        <h2 class="no-num heading settled" id="privacy"><span class="content">隐私注意事项</span><a class="self-link"
                href="#privacy"></a></h2>
        <p>Web 平台不直接暴露 <a data-link-type="dfn" href="#hdr-headroom" id="ref-for-hdr-headroom①">HDR headroom</a>
            的数值原因是，暴露这些信息会泄露当前的观看条件，构成对用户的 <a href="#headroom-privacy">隐私侵害</a>。</p>
        <h2 class="no-num heading settled" id="security"><span class="content">安全注意事项</span><a class="self-link"
                href="#security"></a></h2>
        <p>目前尚未就本文档提出安全方面的关注</p>
        <h2 class="no-num heading settled" id="a11y"><span class="content">可访问性注意事项</span><a class="self-link"
                href="#a11y"></a></h2>
        <p>部分用户可能对非常明亮的颜色敏感，
            因此用户代理应提供一种机制，
            允许用户选项限制最大亮度。 <span class="non-normative">建议采用 <a data-link-type="biblio" href="#biblio-rec_bt2390"
                    title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>
                第 5.4.1 节 <em>Mapping to display with limited brightness range</em> 中的 toe 和 knee 程序作为合适方法。</span></p>
        <p>用户样式表中也可以将 <span class="css">dynamic-range-limit</span> 属性设置为 <a class="css" data-link-type="maybe"
                href="#valdef-dynamic-range-limit-standard"
                id="ref-for-valdef-dynamic-range-limit-standard④">standard</a> 或 <a class="css" data-link-type="maybe"
                href="#valdef-dynamic-range-limit-constrained-high"
                id="ref-for-valdef-dynamic-range-limit-constrained-high④">constrained-high</a>。</p>
    </main>
    <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content"> 一致性</span><a class="self-link"
            href="#w3c-conformance"></a></h2>
    <h3 class="no-ref heading settled" id="w3c-conventions"><span class="content"> 文档约定</span><a class="self-link"
            href="#w3c-conventions"></a></h3>
    <p>一致性要求以描述性断言和 RFC 2119 术语的组合来表达。规范性部分中的关键词 “MUST”、
        “MUST NOT”、 “REQUIRED”、 “SHALL”、 “SHALL NOT”、 “SHOULD”、 “SHOULD NOT”、
        “RECOMMENDED”、 “MAY” 和 “OPTIONAL” 应按 RFC 2119 的描述解释。
        但为可读性起见，这些词并不总以全大写形式出现在本规范中。 </p>
    <p>除明确标注为非规范性的章节、示例和注释外，本规范的所有文本均为规范性内容。 <a data-link-type="biblio" href="#biblio-rfc2119"
            title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a></p>
    <p>本规范中的示例以“for example”引入，或通过 <code>class="example"</code> 与规范性文本区分开，例如：</p>
    <div class="example" id="w3c-example">
        <a class="self-link" href="#w3c-example"></a>
        <p>这是一个信息性示例。</p>
    </div>
    <p>信息性注释以 “Note” 开头，并用 <code>class="note"</code> 与规范性文本区分，例如：</p>
    <p class="note" role="note">注意，这是一条信息性注释。</p>
    <p>告诫性段落为规范性内容，具有特殊强调样式，并用 <code>&lt;strong class="advisement"></code> 与其它规范性文本区分，例如： <strong class="advisement">
            UAs MUST provide an accessible alternative. </strong></p>
    <details class="wpt-tests-block" dir="ltr" lang="en" open>
        <summary>Tests</summary>
        <p>与本规范内容相关的测试可能以类似的 “Tests” 模块记录。
            任何此类模块均为非规范性。</p>
        <ul class="wpt-tests-list"></ul>
        <hr>
    </details>
    <h3 class="no-ref heading settled" id="w3c-conformance-classes"><span class="content"> 一致性类别</span><a
            class="self-link" href="#w3c-conformance-classes"></a></h3>
    <p>本规范定义了三类一致性： </p>
    <dl>
        <dt>样式表
        <dd>一个 <a href="https://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS 样式表</a>。
        <dt>渲染器
        <dd>一个 <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">用户代理</a>，解释样式表语义并渲染使用它们的文档。
        <dt>创作工具
        <dd>一个 <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">用户代理</a>，用于编写样式表。
    </dl>
    <p>如果样式表中使用了本模块定义的语法，其声明在语法上是有效的，并且符合通用 CSS 语法和每个特性的单独语法，则该样式表与本规范一致。 </p>
    <p>渲染器若还正确支持本规范定义的所有特性（包括正确解析并据此渲染文档），则视为与本规范一致。然而，若某用户代理因设备限制无法正确渲染文档，并不使该用户代理不一致。（例如，用户代理无需在单色显示器上渲染颜色。） </p>
    <p>创作工具若能生成语法上正确的样式表（符合通用 CSS 语法和本模块中各特性的语法），并满足样式表的一切其他一致性要求，则视为与本规范一致。 </p>
    <h3 class="no-ref heading settled" id="w3c-partial"><span class="content"> 部分实现</span><a class="self-link"
            href="#w3c-partial"></a></h3>
    <p>为了让作者能利用向前兼容的解析规则来指定回退值，CSS 渲染器 <strong>必须</strong> 将其无法支持的 at-rules、属性、属性值、关键字和其它语法结构视为无效（并在适当时 <a
            href="https://www.w3.org/TR/CSS21/conform.html#ignore">忽略</a>）。特别是，用户代理 <strong>不得</strong>
        在单个多值属性声明中选择性忽略不支持的组件值并保留支持的值：若任何值被视为无效（如不支持的值应被视为），CSS 要求整个声明被忽略。</p>
    <h4 class="heading settled" id="w3c-conform-future-proofing"><span class="content"> 不稳定与专有特性的实现</span><a
            class="self-link" href="#w3c-conform-future-proofing"></a></h4>
    <p>为避免与未来稳定的 CSS 特性冲突，CSSWG 建议在实现 <a href="https://www.w3.org/TR/CSS/#future-proofing">不稳定</a> 特性和 <a
            href="https://www.w3.org/TR/CSS/#proprietary-extension">专有扩展</a> 时遵循最佳实践。 </p>
    <h3 class="no-ref heading settled" id="w3c-testing"><span class="content"> 非实验性实现</span><a class="self-link"
            href="#w3c-testing"></a></h3>
    <p>一旦规范达到候选推荐（CR）阶段，非实验性实现成为可能，且实现者应在能证明其按规范正确实现 CR 级特性时发布无前缀实现。 </p>
    <p>为建立并维护各实现间的互操作性，CSS 工作组请求非实验性 CSS 渲染器在发布任何已正确实现的 CR 级特性（无前缀实现）之前，向 W3C 提交实现报告（如有必要，还包括用于该实现报告的测试用例）。提交给 W3C
        的测试用例将由 CSS 工作组审查并修正。 </p>
    <p>关于提交测试用例和实现报告的更多信息，请访问 CSS 工作组网站 <a
            href="https://www.w3.org/Style/CSS/Test/">https://www.w3.org/Style/CSS/Test/</a>。问题请发往 <a
            href="https://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a> 邮件列表。</p>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本规范定义的术语</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#funcdef-color">color()</a><span>, in § 3</span>
        <li><a href="#typedef-colorspace-params">&lt;colorspace-params></a><span>, in § 3</span>
        <li><a href="#valdef-dynamic-range-limit-constrained-high">constrained-high</a><span>, in § 2.3</span>
        <li><a href="#typedef-custom-params">&lt;custom-params></a><span>, in § 3</span>
        <li><a href="#dynamic-range">Dynamic range</a><span>, in § 2.1</span>
        <li><a href="#propdef-dynamic-range-limit">dynamic-range-limit</a><span>, in § 2.3</span>
        <li><a href="#funcdef-dynamic-range-limit-mix">dynamic-range-limit-mix()</a><span>, in § 2.4</span>
        <li><a href="#hdr-headroom">HDR headroom</a><span>, in § 2.2</span>
        <li><a href="#valdef-dynamic-range-limit-high">high</a><span>, in § 2.3</span>
        <li><a href="#high-dynamic-range">High Dynamic Range</a><span>, in § 2.1</span>
        <li><a href="#ictcp">ICtCp</a><span>, in § 4.6</span>
        <li><a href="#jzazbz">Jzazbz</a><span>, in § 4.4</span>
        <li><a href="#jzczhz">JzCzHz</a><span>, in § 4.5</span>
        <li><a href="#typedef-predefined-polar-params">&lt;predefined-polar-params></a><span>, in § 3</span>
        <li><a href="#typedef-predefined-rectangular">&lt;predefined-rectangular></a><span>, in § 3</span>
        <li><a href="#typedef-predefined-rectangular-params">&lt;predefined-rectangular-params></a><span>, in § 3</span>
        <li><a href="#typedef-predefined-rgb">&lt;predefined-rgb></a><span>, in § 3</span>
        <li><a href="#typedef-predefined-rgb-params">&lt;predefined-rgb-params></a><span>, in § 3</span>
        <li><a href="#rec2100-hlg">rec2100-hlg</a><span>, in § 4.2</span>
        <li><a href="#rec2100-linear">rec2100-linear</a><span>, in § 4.3</span>
        <li><a href="#rec2100-pq">rec2100-pq</a><span>, in § 4.1</span>
        <li><a href="#valdef-dynamic-range-limit-standard">standard</a><span>, in § 2.3</span>
        <li><a href="#standard-dynamic-range">Standard Dynamic Range</a><span>, in § 2.1</span>
        <li><a href="#typedef-xyz">&lt;xyz></a><span>, in § 3</span>
        <li><a href="#typedef-xyz-params">&lt;xyz-params></a><span>, in § 3</span>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">通过引用定义的术语</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[CSS-CASCADE-5]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="8c8e51b4">computed value</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-COLOR-4]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="e5db470f">&lt;alpha-value></span>
                <li><span class="dfn-paneled" id="33347c0e">&lt;hue></span>
                <li><span class="dfn-paneled" id="f6f69187">color space</span>
                <li><span class="dfn-paneled" id="33c7b9d0">luminance</span>
                <li><span class="dfn-paneled" id="bd774466">sRGB</span>
                <li><span class="dfn-paneled" id="17858dc9">white</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-COLOR-5]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="d04b6986">&lt;color></span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-VALUES-4]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="c297b070">#</span>
                <li><span class="dfn-paneled" id="bdb4e757">&amp;&amp;</span>
                <li><span class="dfn-paneled" id="af4a190d">+</span>
                <li><span class="dfn-paneled" id="f5b34cad">&lt;dashed-ident></span>
                <li><span class="dfn-paneled" id="dcecfc13">&lt;ident></span>
                <li><span class="dfn-paneled" id="61bb5e44">&lt;number></span>
                <li><span class="dfn-paneled" id="128295ac">&lt;percentage></span>
                <li><span class="dfn-paneled" id="d4441b24">?</span>
                <li><span class="dfn-paneled" id="8a110a7b">CSS-wide keywords</span>
                <li><span class="dfn-paneled" id="8cbc2b3b">{A}</span>
                <li><span class="dfn-paneled" id="4eb9d37e">|</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">规范性参考文献</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-css-cascade-5">[CSS-CASCADE-5]
        <dd>Elika Etemad; Miriam Suzanne; Tab Atkins Jr.. <a href="https://www.w3.org/TR/css-cascade-5/"><cite>CSS
                    Cascading and Inheritance Level 5</cite></a>. 13 January 2022. CR. URL: <a
                href="https://www.w3.org/TR/css-cascade-5/">https://www.w3.org/TR/css-cascade-5/</a>
        <dt id="biblio-css-color-4">[CSS-COLOR-4]
        <dd>Chris Lilley; Tab Atkins Jr.; Lea Verou. <a href="https://www.w3.org/TR/css-color-4/"><cite>CSS Color Module
                    Level 4</cite></a>. 13 February 2024. CR. URL: <a
                href="https://www.w3.org/TR/css-color-4/">https://www.w3.org/TR/css-color-4/</a>
        <dt id="biblio-css-color-5">[CSS-COLOR-5]
        <dd>Chris Lilley; et al. <a href="https://www.w3.org/TR/css-color-5/"><cite>CSS Color Module Level 5</cite></a>.
            29 February 2024. WD. URL: <a
                href="https://www.w3.org/TR/css-color-5/">https://www.w3.org/TR/css-color-5/</a>
        <dt id="biblio-css-values-3">[CSS-VALUES-3]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-3/"><cite>CSS Values and Units
                    Module Level 3</cite></a>. 22 March 2024. CR. URL: <a
                href="https://www.w3.org/TR/css-values-3/">https://www.w3.org/TR/css-values-3/</a>
        <dt id="biblio-css-values-4">[CSS-VALUES-4]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-4/"><cite>CSS Values and Units
                    Module Level 4</cite></a>. 12 March 2024. WD. URL: <a
                href="https://www.w3.org/TR/css-values-4/">https://www.w3.org/TR/css-values-4/</a>
        <dt id="biblio-css2">[CSS2]
        <dd>Bert Bos; et al. <a href="https://www.w3.org/TR/CSS21/"><cite>Cascading Style Sheets Level 2 Revision 1 (CSS
                    2.1) Specification</cite></a>. 7 June 2011. REC. URL: <a
                href="https://www.w3.org/TR/CSS21/">https://www.w3.org/TR/CSS21/</a>
        <dt id="biblio-rec2020">[Rec.2020]
        <dd><a href="http://www.itu.int/rec/R-REC-BT.2020/en"><cite>Recommendation ITU-R BT.2020-2: Parameter values for
                    ultra-high definition television systems for production and international programme
                    exchange</cite></a>. October 2015. URL: <a
                href="http://www.itu.int/rec/R-REC-BT.2020/en">http://www.itu.int/rec/R-REC-BT.2020/en</a>
        <dt id="biblio-rec_bt2100">[Rec_BT.2100]
        <dd><a href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.2100-2-201807-I!!PDF-E.pdf"><cite>ITU-R
                    BT.2100-2 Image parameter values for high dynamic range television for use in production and
                    international programme exchange</cite></a>. URL: <a
                href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.2100-2-201807-I!!PDF-E.pdf">https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.2100-2-201807-I!!PDF-E.pdf</a>
        <dt id="biblio-rec_bt2390">[Rec_BT.2390]
        <dd><a href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-8-2020-PDF-E.pdf"><cite>ITU-R BT.2390-8
                    High dynamic range television for production and international programme exchange</cite></a>. URL:
            <a
                href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-8-2020-PDF-E.pdf">https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-8-2020-PDF-E.pdf</a>
        <dt id="biblio-rfc2119">[RFC2119]
        <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to
                    Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a
                href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
        <dt id="biblio-rpt_bt2408">[Rpt_BT.2408]
        <dd><a href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2408-2017-PDF-E.pdf"><cite>Report ITU-R
                    BT.2408-0 Operational practices in HDR television production</cite></a>. URL: <a
                href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2408-2017-PDF-E.pdf">https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2408-2017-PDF-E.pdf</a>
        <dt id="biblio-safdar-pucs">[Safdar-PUCS]
        <dd>Safdar, Muhammad; et al. <a
                href="https://opg.optica.org/oe/fulltext.cfm?uri=oe-25-13-15131&amp;id=368272"><cite>Perceptually
                    uniform color space for image signals including high dynamic range and wide gamut</cite></a>. URL:
            <a
                href="https://opg.optica.org/oe/fulltext.cfm?uri=oe-25-13-15131&amp;id=368272">https://opg.optica.org/oe/fulltext.cfm?uri=oe-25-13-15131&amp;id=368272</a>
        <dt id="biblio-smpte-st-2084">[SMPTE-ST-2084]
        <dd><a href="https://pub.smpte.org/latest/st2084/st2084-2014.pdf"><cite>ST 2084:2014 - SMPTE Standard - High
                    Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays</cite></a>. URL: <a
                href="https://pub.smpte.org/latest/st2084/st2084-2014.pdf">https://pub.smpte.org/latest/st2084/st2084-2014.pdf</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">参考性参考文献</span><a class="self-link"
            href="#informative"></a></h3>
    <dl>
        <dt id="biblio-arib_std-b67">[ARIB_STD-B67]
        <dd><a href="https://www.arib.or.jp/english/html/overview/doc/2-STD-B67v1_0.pdf"><cite>Essential Parameter
                    Values for the Extended Image Dynamic Range Television (EIDRTV) System for Programme
                    Production</cite></a>. URL: <a
                href="https://www.arib.or.jp/english/html/overview/doc/2-STD-B67v1_0.pdf">https://www.arib.or.jp/english/html/overview/doc/2-STD-B67v1_0.pdf</a>
        <dt id="biblio-displayhdr">[DisplayHDR]
        <dd><a href="https://displayhdr.org/performance-criteria/"><cite>Summary of DisplayHDR Specs under CTS
                    1.2</cite></a>. URL: <a
                href="https://displayhdr.org/performance-criteria/">https://displayhdr.org/performance-criteria/</a>
        <dt id="biblio-rec_bt814">[Rec_BT.814]
        <dd><a href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.814-4-201807-I!!PDF-E.pdf"><cite>Specifications
                    of PLUGE test signals and alignment procedures for setting of brightness and contrast of
                    displays</cite></a>. URL: <a
                href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.814-4-201807-I!!PDF-E.pdf">https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.814-4-201807-I!!PDF-E.pdf</a>
    </dl>
    <h2 class="no-num no-ref heading settled" id="property-index"><span class="content">属性索引</span><a class="self-link"
            href="#property-index"></a></h2>
    <div class="big-element-wrapper">
        <table class="index">
            <thead>
                <tr>
                    <th scope="col">名称
                    <th scope="col">值
                    <th scope="col">初始
                    <th scope="col">适用对象
                    <th scope="col">继承
                    <th scope="col">%ages
                    <th scope="col">动画类型
                    <th scope="col">规范顺序
                    <th scope="col">计算值
            <tbody>
                <tr>
                    <th scope="row"><a class="css" data-link-type="property" href="#propdef-dynamic-range-limit"
                            id="ref-for-propdef-dynamic-range-limit③">dynamic-range-limit</a>
                    <td>standard | high | constrained-high | &lt;dynamic-range-limit-mix()>
                    <td>high
                    <td>所有元素
                    <td>是
                    <td>不适用
                    <td>由 dynamic-range-limit-mix()
                    <td>按语法
                    <td>见 dynamic-range-limit 的计算值
        </table>
    </div>
    <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">问题索引</span><a class="self-link"
            href="#issues-index"></a></h2>
    <div style="counter-reset:issue">
        <div class="issue"> 补充一张用对数刻度显示 SDR 和 HDR 动态范围的图 <a class="issue-return" href="#issue-b905ab0c"
                title="Jump to section">↵</a></div>
        <div class="issue"> 补充更多示例，包括 sRGB 红、绿、蓝 和 P3 红、绿、蓝 的编码。 <a class="issue-return" href="#issue-3762b88c"
                title="Jump to section">↵</a></div>
        <div class="issue"> 补充更多示例 <a class="issue-return" href="#issue-63bd5f3d" title="Jump to section">↵</a></div>
        <div class="issue"> 是否补充同页定义的黑位提升 Β？ <a class="issue-return" href="#issue-fb589d17"
                title="Jump to section">↵</a></div>
        <div class="issue"> 基于 PQ 的色彩空间在不同观看环境中是否需要进行色调映射（OOTF）以便显示？ <a class="issue-return" href="#issue-ffacc2d5"
                title="Jump to section">↵</a></div>
    </div>
    <script>/* Boilerplate: script-dom-helper */
        "use strict";
        function query(sel) { return document.querySelector(sel); }

        function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

        function iter(obj) {
            if (!obj) return [];
            var it = obj[Symbol.iterator];
            if (it) return it;
            return Object.entries(obj);
        }

        function mk(tagname, attrs, ...children) {
            const el = document.createElement(tagname);
            for (const [k, v] of iter(attrs)) {
                if (k.slice(0, 3) == "_on") {
                    const eventName = k.slice(3);
                    el.addEventListener(eventName, v);
                } else if (k[0] == "_") {
                    // property, not attribute
                    el[k.slice(1)] = v;
                } else {
                    if (v === false || v == null) {
                        continue;
                    } else if (v === true) {
                        el.setAttribute(k, "");
                        continue;
                    } else {
                        el.setAttribute(k, v);
                    }
                }
            }
            append(el, children);
            return el;
        }

        /* Create shortcuts for every known HTML element */
        [
            "a",
            "abbr",
            "acronym",
            "address",
            "applet",
            "area",
            "article",
            "aside",
            "audio",
            "b",
            "base",
            "basefont",
            "bdo",
            "big",
            "blockquote",
            "body",
            "br",
            "button",
            "canvas",
            "caption",
            "center",
            "cite",
            "code",
            "col",
            "colgroup",
            "datalist",
            "dd",
            "del",
            "details",
            "dfn",
            "dialog",
            "div",
            "dl",
            "dt",
            "em",
            "embed",
            "fieldset",
            "figcaption",
            "figure",
            "font",
            "footer",
            "form",
            "frame",
            "frameset",
            "head",
            "header",
            "h1",
            "h2",
            "h3",
            "h4",
            "h5",
            "h6",
            "hr",
            "html",
            "i",
            "iframe",
            "img",
            "input",
            "ins",
            "kbd",
            "label",
            "legend",
            "li",
            "link",
            "main",
            "map",
            "mark",
            "meta",
            "meter",
            "nav",
            "nobr",
            "noscript",
            "object",
            "ol",
            "optgroup",
            "option",
            "output",
            "p",
            "param",
            "pre",
            "progress",
            "q",
            "s",
            "samp",
            "script",
            "section",
            "select",
            "small",
            "source",
            "span",
            "strike",
            "strong",
            "style",
            "sub",
            "summary",
            "sup",
            "table",
            "tbody",
            "td",
            "template",
            "textarea",
            "tfoot",
            "th",
            "thead",
            "time",
            "title",
            "tr",
            "u",
            "ul",
            "var",
            "video",
            "wbr",
            "xmp",
        ].forEach(tagname => {
            mk[tagname] = (...args) => mk(tagname, ...args);
        });

        function* nodesFromChildList(children) {
            for (const child of children.flat(Infinity)) {
                if (child instanceof Node) {
                    yield child;
                } else {
                    yield new Text(child);
                }
            }
        }
        function append(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                if (el instanceof Node) el.appendChild(child);
                else el.push(child);
            }
            return el;
        }

        function insertAfter(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                el.parentNode.insertBefore(child, el.nextSibling);
            }
            return el;
        }

        function clearContents(el) {
            el.innerHTML = "";
            return el;
        }

        function parseHTML(markup) {
            if (markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
                const doc = document.implementation.createHTMLDocument("");
                doc.documentElement.innerHTML = markup;
                return doc;
            } else {
                const el = mk.template({});
                el.innerHTML = markup;
                return el.content;
            }
        }</script>
    <script>/* Boilerplate: script-dfn-panel */
        "use strict";
        {
            let dfnPanelData = {
                "128295ac": { "dfnID": "128295ac", "dfnText": "<percentage>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-percentage-value" }], "title": "2.4. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-percentage-value\u2460" }, { "id": "ref-for-percentage-value\u2461" }, { "id": "ref-for-percentage-value\u2462" }, { "id": "ref-for-percentage-value\u2463" }, { "id": "ref-for-percentage-value\u2464" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-values-4/#percentage-value" },
                "17858dc9": { "dfnID": "17858dc9", "dfnText": "white", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-valdef-color-white" }, { "id": "ref-for-valdef-color-white\u2460" }, { "id": "ref-for-valdef-color-white\u2461" }], "title": "2.3. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2462" }], "title": "4.1. rec2100-pq" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2463" }], "title": "4.3. rec2100-linear" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2464" }], "title": "4.4. Jzazbz" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2465" }], "title": "4.6. ICtCp" }], "url": "https://www.w3.org/TR/css-color-4/#valdef-color-white" },
                "33347c0e": { "dfnID": "33347c0e", "dfnText": "<hue>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-hue" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-color-4/#typedef-hue" },
                "33c7b9d0": { "dfnID": "33c7b9d0", "dfnText": "luminance", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-luminance" }, { "id": "ref-for-luminance\u2460" }, { "id": "ref-for-luminance\u2461" }], "title": "2.1. Defining Dynamic Range" }], "url": "https://drafts.csswg.org/css-color-4/#luminance" },
                "4eb9d37e": { "dfnID": "4eb9d37e", "dfnText": "|", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-comb-one" }, { "id": "ref-for-comb-one\u2460" }, { "id": "ref-for-comb-one\u2461" }], "title": "2.3. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-comb-one\u2462" }, { "id": "ref-for-comb-one\u2463" }, { "id": "ref-for-comb-one\u2464" }, { "id": "ref-for-comb-one\u2465" }, { "id": "ref-for-comb-one\u2466" }, { "id": "ref-for-comb-one\u2467" }, { "id": "ref-for-comb-one\u2468" }, { "id": "ref-for-comb-one\u2460\u24ea" }, { "id": "ref-for-comb-one\u2460\u2460" }, { "id": "ref-for-comb-one\u2460\u2461" }, { "id": "ref-for-comb-one\u2460\u2462" }, { "id": "ref-for-comb-one\u2460\u2463" }, { "id": "ref-for-comb-one\u2460\u2464" }, { "id": "ref-for-comb-one\u2460\u2465" }, { "id": "ref-for-comb-one\u2460\u2466" }, { "id": "ref-for-comb-one\u2460\u2467" }, { "id": "ref-for-comb-one\u2460\u2468" }, { "id": "ref-for-comb-one\u2461\u24ea" }, { "id": "ref-for-comb-one\u2461\u2460" }, { "id": "ref-for-comb-one\u2461\u2461" }, { "id": "ref-for-comb-one\u2461\u2462" }, { "id": "ref-for-comb-one\u2461\u2463" }, { "id": "ref-for-comb-one\u2461\u2464" }, { "id": "ref-for-comb-one\u2461\u2465" }, { "id": "ref-for-comb-one\u2461\u2466" }, { "id": "ref-for-comb-one\u2461\u2467" }, { "id": "ref-for-comb-one\u2461\u2468" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-values-4/#comb-one" },
                "61bb5e44": { "dfnID": "61bb5e44", "dfnText": "<number>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-number-value" }, { "id": "ref-for-number-value\u2460" }, { "id": "ref-for-number-value\u2461" }, { "id": "ref-for-number-value\u2462" }, { "id": "ref-for-number-value\u2463" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }, { "refs": [{ "id": "ref-for-number-value\u2464" }], "title": "6.1. \nSerializing values of the color() function" }], "url": "https://www.w3.org/TR/css-values-4/#number-value" },
                "8a110a7b": { "dfnID": "8a110a7b", "dfnText": "CSS-wide keywords", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-css-wide-keywords" }], "title": "1.1. Value Definitions" }], "url": "https://www.w3.org/TR/css-values-4/#css-wide-keywords" },
                "8c8e51b4": { "dfnID": "8c8e51b4", "dfnText": "computed value", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-computed-value" }], "title": "6.1. \nSerializing values of the color() function" }], "url": "https://www.w3.org/TR/css-cascade-5/#computed-value" },
                "8cbc2b3b": { "dfnID": "8cbc2b3b", "dfnText": "{A}", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-num" }, { "id": "ref-for-mult-num\u2460" }, { "id": "ref-for-mult-num\u2461" }, { "id": "ref-for-mult-num\u2462" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-values-4/#mult-num" },
                "af4a190d": { "dfnID": "af4a190d", "dfnText": "+", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-one-plus" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-values-4/#mult-one-plus" },
                "bd774466": { "dfnID": "bd774466", "dfnText": "sRGB", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-sRGB-space" }, { "id": "ref-for-sRGB-space\u2460" }], "title": "2.1. Defining Dynamic Range" }], "url": "https://www.w3.org/TR/css-color-4/#sRGB-space" },
                "bdb4e757": { "dfnID": "bdb4e757", "dfnText": "&&", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-comb-all" }], "title": "2.4. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }], "url": "https://www.w3.org/TR/css-values-4/#comb-all" },
                "c297b070": { "dfnID": "c297b070", "dfnText": "#", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-comma" }], "title": "2.4. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }], "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
                "d04b6986": { "dfnID": "d04b6986", "dfnText": "<color>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-color" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }, { "refs": [{ "id": "ref-for-typedef-color\u2460" }], "title": "6. \nSerializing <color> Values" }], "url": "https://www.w3.org/TR/css-color-5/#typedef-color" },
                "d4441b24": { "dfnID": "d4441b24", "dfnText": "?", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-opt" }, { "id": "ref-for-mult-opt\u2460" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-values-4/#mult-opt" },
                "dcecfc13": { "dfnID": "dcecfc13", "dfnText": "<ident>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-ident" }], "title": "2.4. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }], "url": "https://www.w3.org/TR/css-values-4/#typedef-ident" },
                "dynamic-range": { "dfnID": "dynamic-range", "dfnText": "Dynamic range", "external": false, "refSections": [], "url": "#dynamic-range" },
                "e5db470f": { "dfnID": "e5db470f", "dfnText": "<alpha-value>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-color-alpha-value" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" },
                "f5b34cad": { "dfnID": "f5b34cad", "dfnText": "<dashed-ident>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-dashed-ident" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-values-4/#typedef-dashed-ident" },
                "f6f69187": { "dfnID": "f6f69187", "dfnText": "color space", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-color-space" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-color-4/#color-space" },
                "funcdef-color": { "dfnID": "funcdef-color", "dfnText": "color()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-color" }, { "id": "ref-for-funcdef-color\u2460" }, { "id": "ref-for-funcdef-color\u2461" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }, { "refs": [{ "id": "ref-for-funcdef-color\u2462" }, { "id": "ref-for-funcdef-color\u2463" }, { "id": "ref-for-funcdef-color\u2464" }], "title": "6.1. \nSerializing values of the color() function" }], "url": "#funcdef-color" },
                "funcdef-dynamic-range-limit-mix": { "dfnID": "funcdef-dynamic-range-limit-mix", "dfnText": "dynamic-range-limit-mix()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-dynamic-range-limit-mix" }, { "id": "ref-for-funcdef-dynamic-range-limit-mix\u2460" }], "title": "2.3. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-funcdef-dynamic-range-limit-mix\u2461" }], "title": "2.4. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-funcdef-dynamic-range-limit-mix\u2462" }, { "id": "ref-for-funcdef-dynamic-range-limit-mix\u2463" }], "title": "2.5. \n\tComputed Value for dynamic-range-limit\n" }], "url": "#funcdef-dynamic-range-limit-mix" },
                "hdr-headroom": { "dfnID": "hdr-headroom", "dfnText": "HDR headroom", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-hdr-headroom" }], "title": "2.2. Introducing Headroom" }, { "refs": [{ "id": "ref-for-hdr-headroom\u2460" }], "title": "Privacy Considerations" }], "url": "#hdr-headroom" },
                "high-dynamic-range": { "dfnID": "high-dynamic-range", "dfnText": "High Dynamic Range", "external": false, "refSections": [], "url": "#high-dynamic-range" },
                "ictcp": { "dfnID": "ictcp", "dfnText": "ICtCp", "external": false, "refSections": [], "url": "#ictcp" },
                "jzazbz": { "dfnID": "jzazbz", "dfnText": "Jzazbz", "external": false, "refSections": [], "url": "#jzazbz" },
                "jzczhz": { "dfnID": "jzczhz", "dfnText": "JzCzHz", "external": false, "refSections": [], "url": "#jzczhz" },
                "propdef-dynamic-range-limit": { "dfnID": "propdef-dynamic-range-limit", "dfnText": "dynamic-range-limit", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-propdef-dynamic-range-limit" }], "title": "2.3. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-propdef-dynamic-range-limit\u2460" }], "title": "2.4. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-propdef-dynamic-range-limit\u2461" }], "title": "2.5. \n\tComputed Value for dynamic-range-limit\n" }], "url": "#propdef-dynamic-range-limit" },
                "rec2100-hlg": { "dfnID": "rec2100-hlg", "dfnText": "rec2100-hlg", "external": false, "refSections": [], "url": "#rec2100-hlg" },
                "rec2100-linear": { "dfnID": "rec2100-linear", "dfnText": "rec2100-linear", "external": false, "refSections": [], "url": "#rec2100-linear" },
                "rec2100-pq": { "dfnID": "rec2100-pq", "dfnText": "rec2100-pq", "external": false, "refSections": [], "url": "#rec2100-pq" },
                "standard-dynamic-range": { "dfnID": "standard-dynamic-range", "dfnText": "Standard Dynamic Range", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-standard-dynamic-range" }], "title": "2.2. Introducing Headroom" }], "url": "#standard-dynamic-range" },
                "typedef-colorspace-params": { "dfnID": "typedef-colorspace-params", "dfnText": "<colorspace-params>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-colorspace-params" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-colorspace-params" },
                "typedef-custom-params": { "dfnID": "typedef-custom-params", "dfnText": "<custom-params>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-custom-params" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-custom-params" },
                "typedef-predefined-polar-params": { "dfnID": "typedef-predefined-polar-params", "dfnText": "<predefined-polar-params>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-predefined-polar-params" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-predefined-polar-params" },
                "typedef-predefined-rectangular": { "dfnID": "typedef-predefined-rectangular", "dfnText": "<predefined-rectangular>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-predefined-rectangular" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-predefined-rectangular" },
                "typedef-predefined-rectangular-params": { "dfnID": "typedef-predefined-rectangular-params", "dfnText": "<predefined-rectangular-params>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-predefined-rectangular-params" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-predefined-rectangular-params" },
                "typedef-predefined-rgb": { "dfnID": "typedef-predefined-rgb", "dfnText": "<predefined-rgb>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-predefined-rgb" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-predefined-rgb" },
                "typedef-predefined-rgb-params": { "dfnID": "typedef-predefined-rgb-params", "dfnText": "<predefined-rgb-params>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-predefined-rgb-params" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-predefined-rgb-params" },
                "typedef-xyz": { "dfnID": "typedef-xyz", "dfnText": "<xyz>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-xyz" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-xyz" },
                "typedef-xyz-params": { "dfnID": "typedef-xyz-params", "dfnText": "<xyz-params>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-xyz-params" }], "title": "3. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "#typedef-xyz-params" },
                "valdef-dynamic-range-limit-constrained-high": { "dfnID": "valdef-dynamic-range-limit-constrained-high", "dfnText": "constrained-high", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-constrained-high" }, { "id": "ref-for-valdef-dynamic-range-limit-constrained-high\u2460" }, { "id": "ref-for-valdef-dynamic-range-limit-constrained-high\u2461" }, { "id": "ref-for-valdef-dynamic-range-limit-constrained-high\u2462" }], "title": "2.5. \n\tComputed Value for dynamic-range-limit\n" }, { "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-constrained-high\u2463" }], "title": "Accessibility Considerations" }], "url": "#valdef-dynamic-range-limit-constrained-high" },
                "valdef-dynamic-range-limit-high": { "dfnID": "valdef-dynamic-range-limit-high", "dfnText": "high", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-high" }, { "id": "ref-for-valdef-dynamic-range-limit-high\u2460" }, { "id": "ref-for-valdef-dynamic-range-limit-high\u2461" }, { "id": "ref-for-valdef-dynamic-range-limit-high\u2462" }], "title": "2.5. \n\tComputed Value for dynamic-range-limit\n" }], "url": "#valdef-dynamic-range-limit-high" },
                "valdef-dynamic-range-limit-standard": { "dfnID": "valdef-dynamic-range-limit-standard", "dfnText": "standard", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-standard" }, { "id": "ref-for-valdef-dynamic-range-limit-standard\u2460" }, { "id": "ref-for-valdef-dynamic-range-limit-standard\u2461" }, { "id": "ref-for-valdef-dynamic-range-limit-standard\u2462" }], "title": "2.5. \n\tComputed Value for dynamic-range-limit\n" }, { "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-standard\u2463" }], "title": "Accessibility Considerations" }], "url": "#valdef-dynamic-range-limit-standard" },
            };

            document.addEventListener("DOMContentLoaded", () => {
                genAllDfnPanels();

                document.body.addEventListener("click", (e) => {
                    // If not handled already, just hide all dfn panels.
                    hideAllDfnPanels();
                });
            });

            window.addEventListener("resize", () => {
                // Pin any visible dfn panel
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => positionDfnPanel(el));
            });

            function genAllDfnPanels() {
                for (const panelData of Object.values(dfnPanelData)) {
                    const dfnID = panelData.dfnID;
                    const dfn = document.getElementById(dfnID);
                    if (!dfn) {
                        console.log(`Can't find dfn#${dfnID}.`, panelData);
                        continue;
                    }
                    dfn.panelData = panelData;
                    insertDfnPopupAction(dfn);
                }
            }

            function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
                const dfnPanel = mk.aside({
                    class: "dfn-panel on",
                    id: `infopanel-for-${dfnID}`,
                    "data-for": dfnID,
                    "aria-labelled-by": `infopaneltitle-for-${dfnID}`,
                },
                    mk.span({ id: `infopaneltitle-for-${dfnID}`, style: "display:none" },
                        `Info about the '${dfnText}' ${external ? "external" : ""} reference.`),
                    mk.a({ href: url, class: "dfn-link" }, url),
                    refSections.length == 0 ? [] :
                        mk.b({}, "Referenced in:"),
                    mk.ul({},
                        ...refSections.map(section =>
                            mk.li({},
                                ...section.refs.map((ref, refI) =>
                                    [
                                        mk.a({ href: `#${ref.id}` },
                                            (refI == 0) ? section.title : `(${refI + 1})`
                                        ),
                                        " ",
                                    ]
                                ),
                            ),
                        ),
                    ),
                    genLinkingSyntaxes(dfn),
                );

                dfnPanel.addEventListener('click', (event) => {
                    if (event.target.nodeName == 'A') {
                        scrollToTargetAndHighlight(event);
                        pinDfnPanel(dfnPanel);
                    }
                    event.stopPropagation();
                    refocusOnTarget(event);
                });
                dfnPanel.addEventListener('keydown', (event) => {
                    if (event.keyCode == 27) { // Escape key
                        hideDfnPanel({ dfnPanel });
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });

                dfnPanel.dfn = dfn;
                dfn.dfnPanel = dfnPanel;
                return dfnPanel;
            }



            function hideAllDfnPanels() {
                // Delete the currently-active dfn panel.
                queryAll(".dfn-panel").forEach(dfnPanel => hideDfnPanel({ dfnPanel }));
            }

            function showDfnPanel(dfn) {
                hideAllDfnPanels(); // Only display one at a time.

                dfn.setAttribute("aria-expanded", "true");

                const dfnPanel = genDfnPanel(dfn, dfn.panelData);

                // Give the dfn a unique tabindex, and then
                // give all the tabbable panel bits successive indexes.
                let tabIndex = 100;
                dfn.tabIndex = tabIndex++;
                const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
                for (const el of tabbable) {
                    el.tabIndex = tabIndex++;
                }

                append(document.body, dfnPanel);
                positionDfnPanel(dfnPanel);
            }

            function positionDfnPanel(dfnPanel) {
                const dfn = dfnPanel.dfn;
                const dfnPos = getBounds(dfn);
                dfnPanel.style.top = dfnPos.bottom + "px";
                dfnPanel.style.left = dfnPos.left + "px";

                const panelPos = dfnPanel.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
                    dfnPanel.style.left = newLeft + "px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.position = "fixed";
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel({ dfn, dfnPanel }) {
                if (!dfnPanel) dfnPanel = dfn.dfnPanel;
                if (!dfn) dfn = dfnPanel.dfn;
                dfn.dfnPanel = undefined;
                dfnPanel.dfn = undefined;
                dfn.setAttribute("aria-expanded", "false");
                dfn.tabIndex = undefined;
                dfnPanel.remove()
            }

            function toggleDfnPanel(dfn) {
                if (dfn.dfnPanel) {
                    hideDfnPanel(dfn);
                } else {
                    showDfnPanel(dfn);
                }
            }

            function insertDfnPopupAction(dfn) {
                dfn.setAttribute('role', 'button');
                dfn.setAttribute('aria-expanded', 'false')
                dfn.tabIndex = 0;
                dfn.classList.add('has-dfn-panel');
                dfn.addEventListener('click', (event) => {
                    toggleDfnPanel(dfn);
                    event.stopPropagation();
                });
                dfn.addEventListener('keypress', (event) => {
                    const kc = event.keyCode;
                    // 32->Space, 13->Enter
                    if (kc == 32 || kc == 13) {
                        toggleDfnPanel(dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });
            }

            function refocusOnTarget(event) {
                const target = event.target;
                setTimeout(() => {
                    // Refocus on the event.target element.
                    // This is needed after browser scrolls to the destination.
                    target.focus();
                });
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function scrollToTargetAndHighlight(event) {
                let hash = event.target.hash;
                if (hash) {
                    hash = decodeURIComponent(hash.substring(1));
                    const dest = document.getElementById(hash);
                    if (dest) {
                        dest.classList.add('highlighted');
                        setTimeout(() => dest.classList.remove('highlighted'), 1000);
                    }
                }
            }

            // Functions, divided by link type, that wrap an autolink's
            // contents with the appropriate outer syntax.
            // Alternately, a string naming another type they format
            // the same as.
            function needsFor(type) {
                switch (type) {
                    case "descriptor":
                    case "value":
                    case "element-attr":
                    case "attr-value":
                    case "element-state":
                    case "method":
                    case "constructor":
                    case "argument":
                    case "attribute":
                    case "const":
                    case "dict-member":
                    case "event":
                    case "enum-value":
                    case "stringifier":
                    case "serializer":
                    case "iterator":
                    case "maplike":
                    case "setlike":
                    case "state":
                    case "mode":
                    case "context":
                    case "facet": return true;

                    default: return false;
                }
            }
            function refusesFor(type) {
                switch (type) {
                    case "property":
                    case "element":
                    case "interface":
                    case "namespace":
                    case "callback":
                    case "dictionary":
                    case "enum":
                    case "exception":
                    case "typedef":
                    case "http-header":
                    case "permission": return true;

                    default: return false;
                }
            }
            function linkFormatterFromType(type) {
                switch (type) {
                    case 'scheme':
                    case 'permission':
                    case 'dfn': return (text) => `[=${text}=]`;

                    case 'abstract-op': return (text) => `[\$${text}\$]`;

                    case 'function':
                    case 'at-rule':
                    case 'selector':
                    case 'value': return (text) => `''${text}''`;

                    case 'http-header': return (text) => `[:${text}:]`;

                    case 'interface':
                    case 'constructor':
                    case 'method':
                    case 'argument':
                    case 'attribute':
                    case 'callback':
                    case 'dictionary':
                    case 'dict-member':
                    case 'enum':
                    case 'enum-value':
                    case 'exception':
                    case 'const':
                    case 'typedef':
                    case 'stringifier':
                    case 'serializer':
                    case 'iterator':
                    case 'maplike':
                    case 'setlike':
                    case 'extended-attribute':
                    case 'event':
                    case 'idl': return (text) => `{{${text}}}`;

                    case 'element-state':
                    case 'element-attr':
                    case 'attr-value':
                    case 'element': return (element) => `<{${element}}>`;

                    case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

                    case 'type': return (text) => `<<${text}>>`;

                    case 'descriptor':
                    case 'property': return (text) => `'${text}'`;

                    default: return;
                };
            };

            function genLinkingSyntaxes(dfn) {
                if (dfn.tagName != "DFN") return;

                const type = dfn.getAttribute('data-dfn-type');
                if (!type) {
                    console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
                    return [];
                }

                // Return a function that wraps link text based on the type
                const linkFormatter = linkFormatterFromType(type);
                if (!linkFormatter) {
                    console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
                    return [];
                }

                let ltAlts;
                if (dfn.hasAttribute('data-lt')) {
                    ltAlts = dfn.getAttribute('data-lt')
                        .split("|")
                        .map(x => x.trim());
                } else {
                    ltAlts = [dfn.textContent.trim()];
                }
                if (type == "type") {
                    // lt of "<foo>", but "foo" is the interior;
                    // <<foo/bar>> is how you write it with a for,
                    // not <foo/<bar>> or whatever.
                    for (var i = 0; i < ltAlts.length; i++) {
                        const lt = ltAlts[i];
                        const match = /<(.*)>/.exec(lt);
                        if (match) { ltAlts[i] = match[1]; }
                    }
                }

                let forAlts;
                if (dfn.hasAttribute('data-dfn-for')) {
                    forAlts = dfn.getAttribute('data-dfn-for')
                        .split(",")
                        .map(x => x.trim());
                } else {
                    forAlts = [''];
                }

                let linkingSyntaxes = [];
                if (!needsFor(type)) {
                    for (const lt of ltAlts) {
                        linkingSyntaxes.push(linkFormatter(lt));
                    }
                }
                if (!refusesFor(type)) {
                    for (const f of forAlts) {
                        linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
                    }
                }
                return [
                    mk.b({}, 'Possible linking syntaxes:'),
                    mk.ul({},
                        ...linkingSyntaxes.map(link => {
                            const copyLink = async () =>
                                await navigator.clipboard.writeText(link);
                            return mk.li({},
                                mk.div({ class: 'link-item' },
                                    mk.button({
                                        class: 'copy-icon', title: 'Copy',
                                        type: 'button',
                                        _onclick: copyLink,
                                        tabindex: 0,
                                    }, mk.span({ class: 'icon' })),
                                    mk.span({}, link)
                                )
                            );
                        })
                    )
                ];
            }
        }
    </script>
    <script>/* Boilerplate: script-link-titles */
        "use strict";
        {
            let linkTitleData = {
                "https://www.w3.org/TR/css-color-5/#typedef-color": "Expands to: <alpha-value> | aliceblue | antiquewhite | aqua | aquamarine | azure | beige | bisque | black | blanchedalmond | blue | blueviolet | brown | burlywood | cadetblue | chartreuse | chocolate | coral | cornflowerblue | cornsilk | crimson | currentcolor | cyan | darkblue | darkcyan | darkgoldenrod | darkgray | darkgreen | darkgrey | darkkhaki | darkmagenta | darkolivegreen | darkorange | darkorchid | darkred | darksalmon | darkseagreen | darkslateblue | darkslategray | darkslategrey | darkturquoise | darkviolet | deeppink | deepskyblue | dimgray | dimgrey | dodgerblue | firebrick | floralwhite | forestgreen | fuchsia | gainsboro | ghostwhite | gold | goldenrod | gray | green | greenyellow | grey | honeydew | hotpink | indianred | indigo | ivory | khaki | lavender | lavenderblush | lawngreen | lemonchiffon | lightblue | lightcoral | lightcyan | lightgoldenrodyellow | lightgray | lightgreen | lightgrey | lightpink | lightsalmon | lightseagreen | lightskyblue | lightslategray | lightslategrey | lightsteelblue | lightyellow | lime | limegreen | linen | magenta | maroon | mediumaquamarine | mediumblue | mediumorchid | mediumpurple | mediumseagreen | mediumslateblue | mediumspringgreen | mediumturquoise | mediumvioletred | midnightblue | mintcream | mistyrose | moccasin | navajowhite | navy | none | oldlace | olive | olivedrab | orange | orangered | orchid | palegoldenrod | palegreen | paleturquoise | palevioletred | papayawhip | peachpuff | peru | pink | plum | powderblue | purple | rebeccapurple | red | rosybrown | royalblue | saddlebrown | salmon | sandybrown | seagreen | seashell | sienna | silver | skyblue | slateblue | slategray | slategrey | snow | springgreen | steelblue | tan | teal | thistle | tomato | transparent | turquoise | violet | wheat | white | whitesmoke | yellow | yellowgreen",
            };

            function setTypeTitles() {
                for (let el of document.querySelectorAll("a[href]")) {
                    if (el.href in linkTitleData && !el.hasAttribute("title")) {
                        el.setAttribute("title", linkTitleData[el.href]);
                    }
                }
            }

            document.addEventListener("DOMContentLoaded", setTypeTitles);
        }
    </script>
    <script>/* Boilerplate: script-ref-hints */
        "use strict";
        {
            let refsData = {
                "#funcdef-color": { "displayText": "color()", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "color()", "type": "function", "url": "#funcdef-color" },
                "#funcdef-dynamic-range-limit-mix": { "displayText": "dynamic-range-limit-mix()", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "dynamic-range-limit-mix()", "type": "function", "url": "#funcdef-dynamic-range-limit-mix" },
                "#hdr-headroom": { "displayText": "hdr headroom", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "hdr headroom", "type": "dfn", "url": "#hdr-headroom" },
                "#propdef-dynamic-range-limit": { "displayText": "dynamic-range-limit", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "dynamic-range-limit", "type": "property", "url": "#propdef-dynamic-range-limit" },
                "#standard-dynamic-range": { "displayText": "standard dynamic range", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "standard dynamic range", "type": "dfn", "url": "#standard-dynamic-range" },
                "#typedef-colorspace-params": { "displayText": "<colorspace-params>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<colorspace-params>", "type": "type", "url": "#typedef-colorspace-params" },
                "#typedef-custom-params": { "displayText": "<custom-params>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<custom-params>", "type": "type", "url": "#typedef-custom-params" },
                "#typedef-predefined-polar-params": { "displayText": "<predefined-polar-params>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<predefined-polar-params>", "type": "type", "url": "#typedef-predefined-polar-params" },
                "#typedef-predefined-rectangular": { "displayText": "<predefined-rectangular>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<predefined-rectangular>", "type": "type", "url": "#typedef-predefined-rectangular" },
                "#typedef-predefined-rectangular-params": { "displayText": "<predefined-rectangular-params>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<predefined-rectangular-params>", "type": "type", "url": "#typedef-predefined-rectangular-params" },
                "#typedef-predefined-rgb": { "displayText": "<predefined-rgb>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<predefined-rgb>", "type": "type", "url": "#typedef-predefined-rgb" },
                "#typedef-predefined-rgb-params": { "displayText": "<predefined-rgb-params>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<predefined-rgb-params>", "type": "type", "url": "#typedef-predefined-rgb-params" },
                "#typedef-xyz": { "displayText": "<xyz>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<xyz>", "type": "type", "url": "#typedef-xyz" },
                "#typedef-xyz-params": { "displayText": "<xyz-params>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<xyz-params>", "type": "type", "url": "#typedef-xyz-params" },
                "#valdef-dynamic-range-limit-constrained-high": { "displayText": "constrained-high", "export": true, "for_": ["dynamic-range-limit"], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "constrained-high", "type": "value", "url": "#valdef-dynamic-range-limit-constrained-high" },
                "#valdef-dynamic-range-limit-high": { "displayText": "high", "export": true, "for_": ["dynamic-range-limit"], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "high", "type": "value", "url": "#valdef-dynamic-range-limit-high" },
                "#valdef-dynamic-range-limit-standard": { "displayText": "standard", "export": true, "for_": ["dynamic-range-limit"], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "standard", "type": "value", "url": "#valdef-dynamic-range-limit-standard" },
                "https://drafts.csswg.org/css-color-4/#luminance": { "displayText": "luminance", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "current", "text": "luminance", "type": "dfn", "url": "https://drafts.csswg.org/css-color-4/#luminance" },
                "https://www.w3.org/TR/css-cascade-5/#computed-value": { "displayText": "computed value", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-cascade", "spec": "css-cascade-5", "status": "snapshot", "text": "computed value", "type": "dfn", "url": "https://www.w3.org/TR/css-cascade-5/#computed-value" },
                "https://www.w3.org/TR/css-color-4/#color-space": { "displayText": "color space", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "color space", "type": "dfn", "url": "https://www.w3.org/TR/css-color-4/#color-space" },
                "https://www.w3.org/TR/css-color-4/#sRGB-space": { "displayText": "sRGB", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "srgb", "type": "dfn", "url": "https://www.w3.org/TR/css-color-4/#sRGB-space" },
                "https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value": { "displayText": "<alpha-value>", "export": true, "for_": ["<color>"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "<alpha-value>", "type": "type", "url": "https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" },
                "https://www.w3.org/TR/css-color-4/#typedef-hue": { "displayText": "<hue>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "<hue>", "type": "type", "url": "https://www.w3.org/TR/css-color-4/#typedef-hue" },
                "https://www.w3.org/TR/css-color-4/#valdef-color-white": { "displayText": "white", "export": true, "for_": ["<color>", "<named-color>"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "white", "type": "value", "url": "https://www.w3.org/TR/css-color-4/#valdef-color-white" },
                "https://www.w3.org/TR/css-color-5/#typedef-color": { "displayText": "<color>", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "<color>", "type": "type", "url": "https://www.w3.org/TR/css-color-5/#typedef-color" },
                "https://www.w3.org/TR/css-values-4/#comb-all": { "displayText": "&&", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "&&", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#comb-all" },
                "https://www.w3.org/TR/css-values-4/#comb-one": { "displayText": "|", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "|", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#comb-one" },
                "https://www.w3.org/TR/css-values-4/#css-wide-keywords": { "displayText": "CSS-wide keywords", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "css-wide keywords", "type": "dfn", "url": "https://www.w3.org/TR/css-values-4/#css-wide-keywords" },
                "https://www.w3.org/TR/css-values-4/#mult-comma": { "displayText": "#", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "#", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
                "https://www.w3.org/TR/css-values-4/#mult-num": { "displayText": "{A}", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "{a}", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-num" },
                "https://www.w3.org/TR/css-values-4/#mult-one-plus": { "displayText": "+", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "+", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-one-plus" },
                "https://www.w3.org/TR/css-values-4/#mult-opt": { "displayText": "?", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "?", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-opt" },
                "https://www.w3.org/TR/css-values-4/#number-value": { "displayText": "<number>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "<number>", "type": "type", "url": "https://www.w3.org/TR/css-values-4/#number-value" },
                "https://www.w3.org/TR/css-values-4/#percentage-value": { "displayText": "<percentage>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "<percentage>", "type": "type", "url": "https://www.w3.org/TR/css-values-4/#percentage-value" },
                "https://www.w3.org/TR/css-values-4/#typedef-dashed-ident": { "displayText": "<dashed-ident>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "<dashed-ident>", "type": "type", "url": "https://www.w3.org/TR/css-values-4/#typedef-dashed-ident" },
                "https://www.w3.org/TR/css-values-4/#typedef-ident": { "displayText": "<ident>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "<ident>", "type": "type", "url": "https://www.w3.org/TR/css-values-4/#typedef-ident" },
            };

            function mkRefHint(link, ref) {
                const linkText = link.textContent;
                let dfnTextElements = '';
                if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
                    // Give the original term if it's being displayed in a different way.
                    // But allow casing differences, they're insignificant.
                    dfnTextElements =
                        mk.li({},
                            mk.b({}, "Term: "),
                            mk.span({}, ref.displayText)
                        );
                }
                const forList = ref.for_;
                let forListElements;
                if (forList.length == 0) {
                    forListElements = [];
                } else if (forList.length == 1) {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.span({}, forList[0]),
                    );
                } else {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.ul({},
                            ...forList.map(forItem =>
                                mk.li({},
                                    mk.span({}, forItem)
                                ),
                            ),
                        ),
                    );
                }
                const url = ref.url;
                const safeUrl = encodeURIComponent(url);
                const hintPanel = mk.aside({
                    class: "ref-hint",
                    id: `ref-hint-for-${safeUrl}`,
                    "data-for": url,
                    "aria-labelled-by": `ref-hint-for-${safeUrl}`,
                },
                    mk.ul({},
                        dfnTextElements,
                        mk.li({},
                            mk.b({}, "URL: "),
                            mk.a({ href: url, class: "ref" }, url),
                        ),
                        mk.li({},
                            mk.b({}, "Type: "),
                            mk.span({}, `${ref.type}`),
                        ),
                        mk.li({},
                            mk.b({}, "Spec: "),
                            mk.span({}, `${ref.spec ? ref.spec : ''}`),
                        ),
                        forListElements
                    ),
                );
                hintPanel.forLink = link;
                setupRefHintEventListeners(link, hintPanel);
                return hintPanel;
            }

            function hideAllRefHints() {
                queryAll(".ref-hint").forEach(el => hideRefHint(el));
            }

            function hideRefHint(refHint) {
                const link = refHint.forLink;
                link.setAttribute("aria-expanded", "false");
                if (refHint.teardownEventListeners) {
                    refHint.teardownEventListeners();
                }
                refHint.remove();
            }

            function showRefHint(link) {
                if (link.classList.contains("dfn-link")) return;
                const url = link.getAttribute("href");
                const ref = refsData[url];
                if (!ref) return;

                hideAllRefHints(); // Only display one at this time.

                const refHint = mkRefHint(link, ref);
                append(document.body, refHint);
                link.setAttribute("aria-expanded", "true");
                positionRefHint(refHint);
            }

            function setupRefHintEventListeners(link, refHint) {
                if (refHint.teardownEventListeners) return;
                // Add event handlers to hide the refHint after the user moves away
                // from both the link and refHint, if not hovering either within one second.
                let timeout = null;
                const startHidingRefHint = (event) => {
                    if (timeout) {
                        clearTimeout(timeout);
                    }
                    timeout = setTimeout(() => {
                        hideRefHint(refHint);
                    }, 1000);
                }
                const resetHidingRefHint = (event) => {
                    if (timeout) clearTimeout(timeout);
                    timeout = null;
                };
                link.addEventListener("mouseleave", startHidingRefHint);
                link.addEventListener("mouseenter", resetHidingRefHint);
                link.addEventListener("blur", startHidingRefHint);
                link.addEventListener("focus", resetHidingRefHint);
                refHint.addEventListener("mouseleave", startHidingRefHint);
                refHint.addEventListener("mouseenter", resetHidingRefHint);
                refHint.addEventListener("blur", startHidingRefHint);
                refHint.addEventListener("focus", resetHidingRefHint);

                refHint.teardownEventListeners = () => {
                    // remove event listeners
                    resetHidingRefHint();
                    link.removeEventListener("mouseleave", startHidingRefHint);
                    link.removeEventListener("mouseenter", resetHidingRefHint);
                    link.removeEventListener("blur", startHidingRefHint);
                    link.removeEventListener("focus", resetHidingRefHint);
                    refHint.removeEventListener("mouseleave", startHidingRefHint);
                    refHint.removeEventListener("mouseenter", resetHidingRefHint);
                    refHint.removeEventListener("blur", startHidingRefHint);
                    refHint.removeEventListener("focus", resetHidingRefHint);
                };
            }

            function positionRefHint(refHint) {
                const link = refHint.forLink;
                const linkPos = getBounds(link);
                refHint.style.top = linkPos.bottom + "px";
                refHint.style.left = linkPos.left + "px";

                const panelPos = refHint.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
                    refHint.style.left = newLeft + "px";
                }
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function showRefHintListener(e) {
                // If the target isn't in a link (or is a link),
                // just ignore it.
                let link = e.target.closest("a");
                if (!link) return;

                // If the target is in a ref-hint panel
                // (aka a link in the already-open one),
                // also just ignore it.
                if (link.closest(".ref-hint")) return;

                // Otherwise, show the panel for the link.
                showRefHint(link);
            }

            function hideAllHintsListener(e) {
                // If the click is inside a ref-hint panel, ignore it.
                if (e.target.closest(".ref-hint")) return;
                // Otherwise, close all the current panels.
                hideAllRefHints();
            }

            document.addEventListener("DOMContentLoaded", () => {
                document.body.addEventListener("mousedown", showRefHintListener);
                document.body.addEventListener("focus", showRefHintListener);

                document.body.addEventListener("click", hideAllHintsListener);
            });

            window.addEventListener("resize", () => {
                // Hide any open ref hint.
                hideAllRefHints();
            });
        }
    </script>
    <script>/* Boilerplate: script-wpt */
        "use strict";
        {
            let wptData = {
                "paths": ["/css/css-color-hdr/"],
            };

            document.addEventListener("DOMContentLoaded", async () => {
                if (wptData.paths.length == 0) return;

                const runsUrl = "https://wpt.fyi/api/runs?label=master&label=stable&max-count=1&product=chrome&product=firefox&product=safari&product=edge";
                const runs = await (await fetch(runsUrl)).json();

                let testResults = [];
                for (const pathPrefix of wptData.paths) {
                    const pathResults = await (await fetch("https://wpt.fyi/api/search", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            "run_ids": runs.map(x => x.id),
                            "query": { "path": pathPrefix },
                        })
                    })).json();
                    testResults = testResults.concat(pathResults.results);
                }

                const browsers = runs.map(x => ({ name: x.browser_name, version: x.browser_version, passes: 0, total: 0 }));
                const resultsFromPath = new Map(testResults.map(result => {
                    const testPath = result.test;
                    const passes = result.legacy_status.map(x => [x.passes, x.total]);
                    return [testPath, passes];
                }));
                const seenTests = new Set();
                document.querySelectorAll(".wpt-name").forEach(nameEl => {
                    const passData = resultsFromPath.get("/" + nameEl.getAttribute("title"));
                    if (!passData) {
                        console.log("Couldn't find test in results:", nameEl);
                        return
                    }
                    const numTests = passData[0][1];
                    if (numTests > 1) {
                        nameEl.insertAdjacentElement("beforeend",
                            mk.small({}, ` (${numTests} tests)`));
                    }
                    if (passData == undefined) return;
                    const resultsEl = mk.span({ "class": "wpt-results" },
                        ...passData.map((p, i) => mk.span(
                            {
                                "title": `${browsers[i].name} ${p[0]}/${p[1]}`,
                                "class": "wpt-result",
                                "style": `background: conic-gradient(forestgreen ${p[0] / p[1] * 360}deg, darkred 0deg);`,
                            })),
                    );
                    nameEl.insertAdjacentElement("afterend", resultsEl);

                    // Only update the summary pass/total count if we haven't seen this
                    // test before, to support authors listing the same test multiple times
                    // in a spec.
                    if (!seenTests.has(nameEl.getAttribute("title"))) {
                        seenTests.add(nameEl.getAttribute("title"));
                        passData.forEach((p, i) => {
                            browsers[i].passes += p[0];
                            browsers[i].total += p[1];
                        });
                    }
                });
                const overview = document.querySelector(".wpt-overview");
                if (overview) {
                    overview.appendChild(mk.ul({}, ...browsers.map(formatWptResult)));
                    document.head.appendChild(mk.style({},
                        `.wpt-overview ul { display: flex; flex-flow: row wrap; gap: .2em; justify-content: start; list-style: none; padding: 0; margin: 0;}
             .wpt-overview li { padding: .25em 1em; color: black; text-align: center; }
             .wpt-overview img { height: 1.5em; height: max(1.5em, 32px); background: transparent; }
             .wpt-overview .browser { font-weight: bold; }
             .wpt-overview .passes-none { background: #e57373; }
             .wpt-overview .passes-hardly { background: #ffb74d; }
             .wpt-overview .passes-a-few { background: #ffd54f; }
             .wpt-overview .passes-half { background: #fff176; }
             .wpt-overview .passes-lots { background: #dce775; }
             .wpt-overview .passes-most { background: #aed581; }
             .wpt-overview .passes-all { background: #81c784; }`));
                }
            });

            function formatWptResult({ name, version, passes, total }) {
                const passRate = passes / total;
                let passClass = "";
                if (passRate == 0) passClass = "passes-none";
                else if (passRate < .2) passClass = "passes-hardly";
                else if (passRate < .4) passClass = "passes-a-few";
                else if (passRate < .6) passClass = "passes-half";
                else if (passRate < .8) passClass = "passes-lots";
                else if (passRate < 1) passClass = "passes-most";
                else passClass = "passes-all";

                name = name[0].toUpperCase() + name.slice(1);
                const shortVersion = /^\d+/.exec(version);
                const icon = []

                if (name == "Chrome") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/chrome_64x64.png" }));
                if (name == "Edge") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/edge_64x64.png" }));
                if (name == "Safari") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/safari_64x64.png" }));
                if (name == "Firefox") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/firefox_64x64.png" }));

                return mk.li({ "class": passClass },
                    mk.nobr({ 'class': 'browser' }, ...icon, ` ${name} ${shortVersion}`),
                    mk.br(),
                    mk.nobr({ 'class': 'pass-rate' }, `${passes}/${total}`)
                );
            }
        }
    </script>
    <script src="/dropdown.js"></script>