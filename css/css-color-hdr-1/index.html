<!doctype html>
<html lang="zh-hans">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>CSS 颜色 HDR 模块 1 级</title>
    <meta content="FPWD" name="w3c-status">
    <!-- <meta content="Bikeshed version ac5ea272d, updated Fri Dec 6 15:45:15 2024 -0800" name="generator"> -->
    <link href="https://www.w3.org/TR/css-color-hdr-1/" rel="canonical">
    <!-- <meta content="97f683a0274c6386a874a31ed1dfa99a6f19b034" name="revision"> -->
    <meta content="dark light" name="color-scheme">
    <link href="https://www.w3.org/TR/css-color-hdr-1/style.css" rel="stylesheet">
    <style>
        /* Boilerplate: style-autolinks */
        .css.css,
        .property.property,
        .descriptor.descriptor {
            color: var(--a-normal-text);
            font-size: inherit;
            font-family: inherit;
        }

        .css::before,
        .property::before,
        .descriptor::before {
            content: "‘";
        }

        .css::after,
        .property::after,
        .descriptor::after {
            content: "’";
        }

        .property,
        .descriptor {
            /* Don't wrap property and descriptor names */
            white-space: nowrap;
        }

        .type {
            /* CSS value <type> */
            font-style: italic;
        }

        pre .property::before,
        pre .property::after {
            content: "";
        }

        [data-link-type="property"]::before,
        [data-link-type="propdesc"]::before,
        [data-link-type="descriptor"]::before,
        [data-link-type="value"]::before,
        [data-link-type="function"]::before,
        [data-link-type="at-rule"]::before,
        [data-link-type="selector"]::before,
        [data-link-type="maybe"]::before {
            content: "‘";
        }

        [data-link-type="property"]::after,
        [data-link-type="propdesc"]::after,
        [data-link-type="descriptor"]::after,
        [data-link-type="value"]::after,
        [data-link-type="function"]::after,
        [data-link-type="at-rule"]::after,
        [data-link-type="selector"]::after,
        [data-link-type="maybe"]::after {
            content: "’";
        }

        [data-link-type].production::before,
        [data-link-type].production::after,
        .prod [data-link-type]::before,
        .prod [data-link-type]::after {
            content: "";
        }

        [data-link-type=element],
        [data-link-type=element-attr] {
            font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
            font-size: .9em;
        }

        [data-link-type=element]::before {
            content: "<"
        }

        [data-link-type=element]::after {
            content: ">"
        }

        [data-link-type=biblio] {
            white-space: pre;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --selflink-text: black;
                --selflink-bg: silver;
                --selflink-hover-text: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-colors */
        /* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
        :root {
            color-scheme: light dark;

            --text: black;
            --bg: white;

            --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

            --logo-bg: #1a5e9a;
            --logo-active-bg: #c00;
            --logo-text: white;

            --tocnav-normal-text: #707070;
            --tocnav-normal-bg: var(--bg);
            --tocnav-hover-text: var(--tocnav-normal-text);
            --tocnav-hover-bg: #f8f8f8;
            --tocnav-active-text: #c00;
            --tocnav-active-bg: var(--tocnav-normal-bg);

            --tocsidebar-text: var(--text);
            --tocsidebar-bg: #f7f8f9;
            --tocsidebar-shadow: rgba(0, 0, 0, .1);
            --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

            --toclink-text: var(--text);
            --toclink-underline: #3980b5;
            --toclink-visited-text: var(--toclink-text);
            --toclink-visited-underline: #054572;

            --heading-text: #005a9c;

            --hr-text: var(--text);

            --algo-border: #def;

            --del-text: red;
            --del-bg: transparent;
            --ins-text: #080;
            --ins-bg: transparent;

            --a-normal-text: #034575;
            --a-normal-underline: #bbb;
            --a-visited-text: var(--a-normal-text);
            --a-visited-underline: #707070;
            --a-hover-bg: rgba(75%, 75%, 75%, .25);
            --a-active-text: #c00;
            --a-active-underline: #c00;

            --blockquote-border: silver;
            --blockquote-bg: transparent;
            --blockquote-text: currentcolor;

            --issue-border: #e05252;
            --issue-bg: #fbe9e9;
            --issue-text: var(--text);
            --issueheading-text: #831616;

            --example-border: #e0cb52;
            --example-bg: #fcfaee;
            --example-text: var(--text);
            --exampleheading-text: #574b0f;

            --note-border: #52e052;
            --note-bg: #e9fbe9;
            --note-text: var(--text);
            --noteheading-text: hsl(120, 70%, 30%);
            --notesummary-underline: silver;

            --assertion-border: #aaa;
            --assertion-bg: #eee;
            --assertion-text: black;

            --advisement-border: orange;
            --advisement-bg: #fec;
            --advisement-text: var(--text);
            --advisementheading-text: #b35f00;

            --warning-border: red;
            --warning-bg: hsla(40, 100%, 50%, 0.95);
            --warning-text: var(--text);

            --amendment-border: #330099;
            --amendment-bg: #F5F0FF;
            --amendment-text: var(--text);
            --amendmentheading-text: #220066;

            --def-border: #8ccbf2;
            --def-bg: #def;
            --def-text: var(--text);
            --defrow-border: #bbd7e9;

            --datacell-border: silver;

            --indexinfo-text: #707070;

            --indextable-hover-text: black;
            --indextable-hover-bg: #f7f8f9;

            --outdatedspec-bg: rgba(0, 0, 0, .5);
            --outdatedspec-text: black;
            --outdated-bg: maroon;
            --outdated-text: white;
            --outdated-shadow: red;

            --editedrec-bg: darkorange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --text: #ddd;
                --bg: black;

                --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

                --logo-bg: #1a5e9a;
                --logo-active-bg: #c00;
                --logo-text: white;

                --tocnav-normal-text: #999;
                --tocnav-normal-bg: var(--bg);
                --tocnav-hover-text: var(--tocnav-normal-text);
                --tocnav-hover-bg: #080808;
                --tocnav-active-text: #f44;
                --tocnav-active-bg: var(--tocnav-normal-bg);

                --tocsidebar-text: var(--text);
                --tocsidebar-bg: #080808;
                --tocsidebar-shadow: rgba(255, 255, 255, .1);
                --tocsidebar-heading-text: hsla(203, 20%, 40%, .7);

                --toclink-text: var(--text);
                --toclink-underline: #6af;
                --toclink-visited-text: var(--toclink-text);
                --toclink-visited-underline: #054572;

                --heading-text: #8af;

                --hr-text: var(--text);

                --algo-border: #456;

                --del-text: #f44;
                --del-bg: transparent;
                --ins-text: #4a4;
                --ins-bg: transparent;

                --a-normal-text: #6af;
                --a-normal-underline: #555;
                --a-visited-text: var(--a-normal-text);
                --a-visited-underline: var(--a-normal-underline);
                --a-hover-bg: rgba(25%, 25%, 25%, .2);
                --a-active-text: #f44;
                --a-active-underline: var(--a-active-text);

                --borderedblock-bg: rgba(255, 255, 255, .05);

                --blockquote-border: silver;
                --blockquote-bg: var(--borderedblock-bg);
                --blockquote-text: currentcolor;

                --issue-border: #e05252;
                --issue-bg: var(--borderedblock-bg);
                --issue-text: var(--text);
                --issueheading-text: hsl(0deg, 70%, 70%);

                --example-border: hsl(50deg, 90%, 60%);
                --example-bg: var(--borderedblock-bg);
                --example-text: var(--text);
                --exampleheading-text: hsl(50deg, 70%, 70%);

                --note-border: hsl(120deg, 100%, 35%);
                --note-bg: var(--borderedblock-bg);
                --note-text: var(--text);
                --noteheading-text: hsl(120, 70%, 70%);
                --notesummary-underline: silver;

                --assertion-border: #444;
                --assertion-bg: var(--borderedblock-bg);
                --assertion-text: var(--text);

                --advisement-border: orange;
                --advisement-bg: #222218;
                --advisement-text: var(--text);
                --advisementheading-text: #f84;

                --warning-border: red;
                --warning-bg: hsla(40, 100%, 20%, 0.95);
                --warning-text: var(--text);

                --amendment-border: #330099;
                --amendment-bg: #080010;
                --amendment-text: var(--text);
                --amendmentheading-text: #cc00ff;

                --def-border: #8ccbf2;
                --def-bg: #080818;
                --def-text: var(--text);
                --defrow-border: #136;

                --datacell-border: silver;

                --indexinfo-text: #aaa;

                --indextable-hover-text: var(--text);
                --indextable-hover-bg: #181818;

                --outdatedspec-bg: rgba(255, 255, 255, .5);
                --outdatedspec-text: black;
                --outdated-bg: maroon;
                --outdated-text: white;
                --outdated-shadow: red;

                --editedrec-bg: darkorange;
            }

            /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
            img {
                background: white;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-counters */
        body {
            counter-reset: example figure issue;
        }

        .issue {
            counter-increment: issue;
        }

        .issue:not(.no-marker)::before {
            content: "Issue " counter(issue);
        }

        .example {
            counter-increment: example;
        }

        .example:not(.no-marker)::before {
            content: "Example " counter(example);
        }

        .invalid.example:not(.no-marker)::before,
        .illegal.example:not(.no-marker)::before {
            content: "Invalid Example" counter(example);
        }

        figcaption {
            counter-increment: figure;
        }

        figcaption:not(.no-marker)::before {
            content: "Figure " counter(figure) " ";
        }
    </style>
    <style>
        /* Boilerplate: style-dfn-panel */
        :root {
            --dfnpanel-bg: #ddd;
            --dfnpanel-text: var(--text);
            --dfnpanel-target-bg: #ffc;
            --dfnpanel-target-outline: orange;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --dfnpanel-bg: #222;
                --dfnpanel-text: var(--text);
                --dfnpanel-target-bg: #333;
                --dfnpanel-target-outline: silver;
            }
        }

        .dfn-panel {
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--dfnpanel-bg);
            color: var(--dfnpanel-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .dfn-panel:not(.on) {
            display: none;
        }

        .dfn-panel * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .dfn-panel>b {
            display: block;
        }

        .dfn-panel a {
            color: var(--dfnpanel-text);
        }

        .dfn-panel a:not(:hover) {
            text-decoration: none !important;
            border-bottom: none !important;
        }

        .dfn-panel a:focus {
            outline: 5px auto Highlight;
            outline: 5px auto -webkit-focus-ring-color;
        }

        .dfn-panel>b+b {
            margin-top: 0.25em;
        }

        .dfn-panel ul {
            padding: 0 0 0 1em;
            list-style: none;
        }

        .dfn-panel li a {
            max-width: calc(300px - 1.5em - 1em);
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: 8px;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
            transition: left 1s ease-out, bottom 1s ease-out;
        }

        .dfn-panel .link-item:hover {
            text-decoration: underline;
        }

        .dfn-panel .link-item .copy-icon {
            opacity: 0;
        }

        .dfn-panel .link-item:hover .copy-icon,
        .dfn-panel .link-item .copy-icon:focus {
            opacity: 1;
        }

        .dfn-panel .copy-icon {
            display: inline-block;
            margin-right: 0.5em;
            width: 0.85em;
            height: 1em;
            border-radius: 3px;
            background-color: #ccc;
            cursor: pointer;
        }

        .dfn-panel .copy-icon .icon {
            width: 100%;
            height: 100%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .dfn-panel .copy-icon .icon::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1px solid black;
            background-color: #ccc;
            opacity: 0.25;
            transform: translate(3px, -3px);
        }

        .dfn-panel .copy-icon:active .icon::before {
            opacity: 1;
        }

        .dfn-paneled[role="button"] {
            cursor: help;
        }

        .highlighted {
            animation: target-fade 3s;
        }

        @keyframes target-fade {
            from {
                background-color: var(--dfnpanel-target-bg);
                outline: 5px solid var(--dfnpanel-target-outline);
            }

            to {
                color: var(--a-normal-text);
                background-color: transparent;
                outline: transparent;
            }
        }
    </style>
    <style>
        /* Boilerplate: style-issues */
        a[href].issue-return {
            float: right;
            float: inline-end;
            color: var(--issueheading-text);
            font-weight: bold;
            text-decoration: none;
        }
    </style>
    <style>
        /* Boilerplate: style-md-lists */
        /* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
        [data-md]> :first-child {
            margin-top: 0;
        }

        [data-md]> :last-child {
            margin-bottom: 0;
        }
    </style>
    <style>
        /* Boilerplate: style-ref-hints */
        :root {
            --ref-hint-bg: #ddd;
            --ref-hint-text: var(--text);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --ref-hint-bg: #222;
                --ref-hint-text: var(--text);
            }
        }

        .ref-hint {
            display: inline-block;
            position: absolute;
            z-index: 35;
            width: 20em;
            width: 300px;
            height: auto;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.5em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: var(--ref-hint-bg);
            color: var(--ref-hint-text);
            border: outset 0.2em;
            white-space: normal;
            /* in case it's moved into a pre */
        }

        .ref-hint * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .ref-hint ul {
            padding: 0 0 0 1em;
            list-style: none;
        }
    </style>
    <style>
        /* Boilerplate: style-selflinks */
        :root {
            --selflink-text: white;
            --selflink-bg: gray;
            --selflink-hover-text: black;
        }

        .heading,
        .issue,
        .note,
        .example,
        li,
        dt {
            position: relative;
        }

        a.self-link {
            position: absolute;
            top: 0;
            left: calc(-1 * (3.5rem - 26px));
            width: calc(3.5rem - 26px);
            height: 2em;
            text-align: center;
            border: none;
            transition: opacity .2s;
            opacity: .5;
        }

        a.self-link:hover {
            opacity: 1;
        }

        .heading>a.self-link {
            font-size: 83%;
        }

        .example>a.self-link,
        .note>a.self-link,
        .issue>a.self-link {
            /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
            left: auto;
            right: 0;
        }

        li>a.self-link {
            left: calc(-1 * (3.5rem - 26px) - 2em);
        }

        dfn>a.self-link {
            top: auto;
            left: auto;
            opacity: 0;
            width: 1.5em;
            height: 1.5em;
            background: var(--selflink-bg);
            color: var(--selflink-text);
            font-style: normal;
            transition: opacity .2s, background-color .2s, color .2s;
        }

        dfn:hover>a.self-link {
            opacity: 1;
        }

        dfn>a.self-link:hover {
            color: var(--selflink-hover-text);
        }

        a.self-link::before {
            content: "¶";
        }

        .heading>a.self-link::before {
            content: "§";
        }

        dfn>a.self-link::before {
            content: "#";
        }
    </style>
    <style>
        /* Boilerplate: style-syntax-highlighting */
        code.highlight {
            padding: .1em;
            border-radius: .3em;
        }

        pre.highlight,
        pre>code.highlight {
            display: block;
            padding: 1em;
            margin: .5em 0;
            overflow: auto;
            border-radius: 0;
        }

        .highlight:not(.idl) {
            background: rgba(0, 0, 0, .03);
        }

        c-[a] {
            color: #990055
        }

        /* Keyword.Declaration */
        c-[b] {
            color: #990055
        }

        /* Keyword.Type */
        c-[c] {
            color: #708090
        }

        /* Comment */
        c-[d] {
            color: #708090
        }

        /* Comment.Multiline */
        c-[e] {
            color: #0077aa
        }

        /* Name.Attribute */
        c-[f] {
            color: #669900
        }

        /* Name.Tag */
        c-[g] {
            color: #222222
        }

        /* Name.Variable */
        c-[k] {
            color: #990055
        }

        /* Keyword */
        c-[l] {
            color: #000000
        }

        /* Literal */
        c-[m] {
            color: #000000
        }

        /* Literal.Number */
        c-[n] {
            color: #0077aa
        }

        /* Name */
        c-[o] {
            color: #999999
        }

        /* Operator */
        c-[p] {
            color: #999999
        }

        /* Punctuation */
        c-[s] {
            color: #a67f59
        }

        /* Literal.String */
        c-[t] {
            color: #a67f59
        }

        /* Literal.String.Single */
        c-[u] {
            color: #a67f59
        }

        /* Literal.String.Double */
        c-[cp] {
            color: #708090
        }

        /* Comment.Preproc */
        c-[c1] {
            color: #708090
        }

        /* Comment.Single */
        c-[cs] {
            color: #708090
        }

        /* Comment.Special */
        c-[kc] {
            color: #990055
        }

        /* Keyword.Constant */
        c-[kn] {
            color: #990055
        }

        /* Keyword.Namespace */
        c-[kp] {
            color: #990055
        }

        /* Keyword.Pseudo */
        c-[kr] {
            color: #990055
        }

        /* Keyword.Reserved */
        c-[ld] {
            color: #000000
        }

        /* Literal.Date */
        c-[nc] {
            color: #0077aa
        }

        /* Name.Class */
        c-[no] {
            color: #0077aa
        }

        /* Name.Constant */
        c-[nd] {
            color: #0077aa
        }

        /* Name.Decorator */
        c-[ni] {
            color: #0077aa
        }

        /* Name.Entity */
        c-[ne] {
            color: #0077aa
        }

        /* Name.Exception */
        c-[nf] {
            color: #0077aa
        }

        /* Name.Function */
        c-[nl] {
            color: #0077aa
        }

        /* Name.Label */
        c-[nn] {
            color: #0077aa
        }

        /* Name.Namespace */
        c-[py] {
            color: #0077aa
        }

        /* Name.Property */
        c-[ow] {
            color: #999999
        }

        /* Operator.Word */
        c-[mb] {
            color: #000000
        }

        /* Literal.Number.Bin */
        c-[mf] {
            color: #000000
        }

        /* Literal.Number.Float */
        c-[mh] {
            color: #000000
        }

        /* Literal.Number.Hex */
        c-[mi] {
            color: #000000
        }

        /* Literal.Number.Integer */
        c-[mo] {
            color: #000000
        }

        /* Literal.Number.Oct */
        c-[sb] {
            color: #a67f59
        }

        /* Literal.String.Backtick */
        c-[sc] {
            color: #a67f59
        }

        /* Literal.String.Char */
        c-[sd] {
            color: #a67f59
        }

        /* Literal.String.Doc */
        c-[se] {
            color: #a67f59
        }

        /* Literal.String.Escape */
        c-[sh] {
            color: #a67f59
        }

        /* Literal.String.Heredoc */
        c-[si] {
            color: #a67f59
        }

        /* Literal.String.Interpol */
        c-[sx] {
            color: #a67f59
        }

        /* Literal.String.Other */
        c-[sr] {
            color: #a67f59
        }

        /* Literal.String.Regex */
        c-[ss] {
            color: #a67f59
        }

        /* Literal.String.Symbol */
        c-[vc] {
            color: #0077aa
        }

        /* Name.Variable.Class */
        c-[vg] {
            color: #0077aa
        }

        /* Name.Variable.Global */
        c-[vi] {
            color: #0077aa
        }

        /* Name.Variable.Instance */
        c-[il] {
            color: #000000
        }

        /* Literal.Number.Integer.Long */

        @media (prefers-color-scheme: dark) {
            .highlight:not(.idl) {
                background: rgba(255, 255, 255, .05);
            }

            c-[a] {
                color: #d33682
            }

            /* Keyword.Declaration */
            c-[b] {
                color: #d33682
            }

            /* Keyword.Type */
            c-[c] {
                color: #2aa198
            }

            /* Comment */
            c-[d] {
                color: #2aa198
            }

            /* Comment.Multiline */
            c-[e] {
                color: #268bd2
            }

            /* Name.Attribute */
            c-[f] {
                color: #b58900
            }

            /* Name.Tag */
            c-[g] {
                color: #cb4b16
            }

            /* Name.Variable */
            c-[k] {
                color: #d33682
            }

            /* Keyword */
            c-[l] {
                color: #657b83
            }

            /* Literal */
            c-[m] {
                color: #657b83
            }

            /* Literal.Number */
            c-[n] {
                color: #268bd2
            }

            /* Name */
            c-[o] {
                color: #657b83
            }

            /* Operator */
            c-[p] {
                color: #657b83
            }

            /* Punctuation */
            c-[s] {
                color: #6c71c4
            }

            /* Literal.String */
            c-[t] {
                color: #6c71c4
            }

            /* Literal.String.Single */
            c-[u] {
                color: #6c71c4
            }

            /* Literal.String.Double */
            c-[ch] {
                color: #2aa198
            }

            /* Comment.Hashbang */
            c-[cp] {
                color: #2aa198
            }

            /* Comment.Preproc */
            c-[cpf] {
                color: #2aa198
            }

            /* Comment.PreprocFile */
            c-[c1] {
                color: #2aa198
            }

            /* Comment.Single */
            c-[cs] {
                color: #2aa198
            }

            /* Comment.Special */
            c-[kc] {
                color: #d33682
            }

            /* Keyword.Constant */
            c-[kn] {
                color: #d33682
            }

            /* Keyword.Namespace */
            c-[kp] {
                color: #d33682
            }

            /* Keyword.Pseudo */
            c-[kr] {
                color: #d33682
            }

            /* Keyword.Reserved */
            c-[ld] {
                color: #657b83
            }

            /* Literal.Date */
            c-[nc] {
                color: #268bd2
            }

            /* Name.Class */
            c-[no] {
                color: #268bd2
            }

            /* Name.Constant */
            c-[nd] {
                color: #268bd2
            }

            /* Name.Decorator */
            c-[ni] {
                color: #268bd2
            }

            /* Name.Entity */
            c-[ne] {
                color: #268bd2
            }

            /* Name.Exception */
            c-[nf] {
                color: #268bd2
            }

            /* Name.Function */
            c-[nl] {
                color: #268bd2
            }

            /* Name.Label */
            c-[nn] {
                color: #268bd2
            }

            /* Name.Namespace */
            c-[py] {
                color: #268bd2
            }

            /* Name.Property */
            c-[ow] {
                color: #657b83
            }

            /* Operator.Word */
            c-[mb] {
                color: #657b83
            }

            /* Literal.Number.Bin */
            c-[mf] {
                color: #657b83
            }

            /* Literal.Number.Float */
            c-[mh] {
                color: #657b83
            }

            /* Literal.Number.Hex */
            c-[mi] {
                color: #657b83
            }

            /* Literal.Number.Integer */
            c-[mo] {
                color: #657b83
            }

            /* Literal.Number.Oct */
            c-[sa] {
                color: #6c71c4
            }

            /* Literal.String.Affix */
            c-[sb] {
                color: #6c71c4
            }

            /* Literal.String.Backtick */
            c-[sc] {
                color: #6c71c4
            }

            /* Literal.String.Char */
            c-[dl] {
                color: #6c71c4
            }

            /* Literal.String.Delimiter */
            c-[sd] {
                color: #6c71c4
            }

            /* Literal.String.Doc */
            c-[se] {
                color: #6c71c4
            }

            /* Literal.String.Escape */
            c-[sh] {
                color: #6c71c4
            }

            /* Literal.String.Heredoc */
            c-[si] {
                color: #6c71c4
            }

            /* Literal.String.Interpol */
            c-[sx] {
                color: #6c71c4
            }

            /* Literal.String.Other */
            c-[sr] {
                color: #6c71c4
            }

            /* Literal.String.Regex */
            c-[ss] {
                color: #6c71c4
            }

            /* Literal.String.Symbol */
            c-[fm] {
                color: #268bd2
            }

            /* Name.Function.Magic */
            c-[vc] {
                color: #cb4b16
            }

            /* Name.Variable.Class */
            c-[vg] {
                color: #cb4b16
            }

            /* Name.Variable.Global */
            c-[vi] {
                color: #cb4b16
            }

            /* Name.Variable.Instance */
            c-[vm] {
                color: #cb4b16
            }

            /* Name.Variable.Magic */
            c-[il] {
                color: #657b83
            }

            /* Literal.Number.Integer.Long */
        }
    </style>
    <style>
        /* Boilerplate: style-wpt */
        :root {
            --wpt-border: hsl(0, 0%, 60%);
            --wpt-bg: hsl(0, 0%, 95%);
            --wpt-text: var(--text);
            --wptheading-text: hsl(0, 0%, 30%);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --wpt-border: hsl(0, 0%, 30%);
                --wpt-bg: var(--borderedblock-bg);
                --wpt-text: var(--text);
                --wptheading-text: hsl(0, 0%, 60%);
            }
        }

        .wpt-tests-block {
            list-style: none;
            border-left: .5em solid var(--wpt-border);
            background: var(--wpt-bg);
            color: var(--wpt-text);
            margin: 1em auto;
            padding: .5em;
        }

        .wpt-tests-block summary {
            color: var(--wptheading-text);
            font-weight: normal;
            text-transform: uppercase;
        }

        .wpt-tests-block summary::marker {
            color: var(--wpt-border);
        }

        .wpt-tests-block summary:hover::marker {
            color: var(--wpt-text);
        }

        /*
   The only content  of a wpt test block in its closed state is the <summary>,
   which contains the word TESTS,
   and that is absolutely positioned.
   In that closed state, wpt test blocks are styled
   to have a top margin whose height is exactly equal
   to the height of the absolutely positioned <summary>,
   and no other background/padding/margin/border.
   The wpt test block elements will therefore allow the maring
   of the previous/next block elements
   to collapse through them;
   if this combined margin would be larger than its own top margin,
   it stays as is,
   and therefore the pre-existing vertical rhythm of the document is undisturbed.
   If that combined margin would be smaller, it is grown to that size.
   This means that the wpt test block ensures
   that there's always enough vertical space to insert the summary,
   without adding more than is needed.
*/
        .wpt-tests-block:not([open]) {
            padding: 0;
            border: none;
            background: none;
            font-size: 0.75em;
            line-height: 1;
            position: relative;
            margin: 1em 0 0;
        }

        .wpt-tests-block:not([open]) summary {
            position: absolute;
            right: 0;
            bottom: 0;
        }

        /*
   It is possible that both the last child of a block element
   and the block element itself
   would be annotated with a <wpt> block each.
   If the block element has a padding or a border,
   that's fine, but otherwise
   the bottom margin of the block and of its last child would collapse
   and both <wpt> elements would overlap, being both placed there.
   To avoid that, add 1px of padding to the <wpt> element annotating the last child
   to prevent the bottom margin of the block and of its last child from collapsing
   (and as much negative margin,
   as wel only want to prevent margin collapsing,
   but are not trying to actually take more space).
*/
        .wpt-tests-block:not([open]):last-child {
            padding-bottom: 1px;
            margin-bottom: -1px;
        }

        /*
   Exception to the previous rule:
   don't do that in non-last list items,
   because it's not necessary,
   and would therefore consume more space than strictly needed.
   Lists must have list items as children, not <wpt> elements,
   so a <wpt> element cannot be a sibling of a list item,
   and the collision that the previous rule avoids cannot happen.
*/
        li:not(:last-child)>.wpt-tests-block:not([open]):last-child,
        dd:not(:last-child)>.wpt-tests-block:not([open]):last-child {
            padding-bottom: 0;
            margin-bottom: 0;
        }

        .wpt-tests-block:not([open]):not(:hover) {
            opacity: 0.5;
        }

        .wpt-tests-list {
            list-style: none;
            display: grid;
            margin: 0;
            padding: 0;
            grid-template-columns: 1fr max-content auto auto;
            grid-column-gap: .5em;
        }

        .wpt-tests-block hr:last-child {
            display: none;
        }

        .wpt-test {
            display: contents;
        }

        .wpt-test>a {
            text-decoration: underline;
            border: none;
        }

        .wpt-test>.wpt-name {
            grid-column: 1;
        }

        .wpt-test>.wpt-results {
            grid-column: 2;
        }

        .wpt-test>.wpt-live {
            grid-column: 3;
        }

        .wpt-test>.wpt-source {
            grid-column: 4;
        }

        .wpt-test>.wpt-results {
            display: flex;
            gap: .1em;
        }

        .wpt-test .wpt-result {
            display: inline-block;
            height: 1em;
            width: 1em;
            border-radius: 50%;
            position: relative;
        }
    </style>
    <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD" rel="stylesheet">
    <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet"
        type="text/css">

<body class="h-entry">
    <div class="head">
        <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48"
                    src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
        <h1 class="p-name no-ref" id="title">CSS 颜色 HDR 模块 1 级</h1>
        <p id="w3c-state"><a href="https://www.w3.org/standards/types/#FPWD">W3C 首次公开工作草案</a>, <time class="dt-updated"
                datetime="2025-12-02">2025年12月2日</time></p>
        <details open>
            <summary>关于本文档的更多信息</summary>
            <div data-fill-with="spec-metadata">
                <dl>
                    <dt>本版本：
                    <dd><a class="u-url"
                            href="https://www.w3.org/TR/2025/WD-css-color-hdr-1-20251202/">https://www.w3.org/TR/2025/WD-css-color-hdr-1-20251202/</a>
                    <dt>最新发布版本：
                    <dd><a href="https://www.w3.org/TR/css-color-hdr-1/">https://www.w3.org/TR/css-color-hdr-1/</a>
                    <dt>编辑草案：
                    <dd><a
                            href="https://drafts.csswg.org/css-color-hdr-1/">https://drafts.csswg.org/css-color-hdr-1/</a>
                    <dt>历史记录：
                    <dd><a class="u-url"
                            href="https://www.w3.org/standards/history/css-color-hdr-1/">https://www.w3.org/standards/history/css-color-hdr-1/</a>
                    <dt>反馈：
                    <dd><a href="https://github.com/w3c/csswg-drafts/labels/css-color-hdr-1">CSSWG 问题库</a>
                    <dd><a href="#issues-index">规范内反馈</a>
                    <dt class="editor">编辑：
                    <dd class="editor p-author h-card vcard" data-editor-id="1438"><a class="p-name fn u-url url"
                            href="https://svgees.us/">Chris Lilley</a> (<span class="p-org org">W3C</span>)
                    <dt>为本规范建议修改：
                    <dd><a href="https://github.com/w3c/csswg-drafts/blob/main/css-color-hdr-1/Overview.bs">GitHub
                            编辑器</a>
                    <dt>测试套件：
                    <dd class="wpt-overview"><a
                            href="https://wpt.fyi/results/css/css-color-hdr/">https://wpt.fyi/results/css/css-color-hdr/</a>
                </dl>
            </div>
        </details>
        <div data-fill-with="warning"></div>
        <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> ©
            2025 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr
                title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a
                href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a
                href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a
                href="https://www.w3.org/copyright/software-license/" rel="license"
                title="W3C Software and Document License">permissive document license</a> rules apply. </p>
        <hr title="Separator for header">
    </div>
    <div class="p-summary" data-fill-with="abstract">
        <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">摘要</span></h2>
        <p>本模块定义了对 CSS Color 4 和 5 的扩展，以支持高动态范围（HDR）。</p>
        <a href="https://www.w3.org/TR/CSS/">CSS</a> 是一种用于描述结构化文档（如 HTML 和 XML）在屏幕、纸张等介质上渲染方式的语言。
    </div>
    <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">本文档状态</span></h2>
    <div data-fill-with="status">
        <p><em>本节描述了本文件在发布时的状态。
                当前 W3C 发布物和本技术报告的最新修订版
                可在 <a href="https://www.w3.org/TR/">W3C 标准与草案索引</a> 中找到。</em></p>
        <p> 本文档由 <a href="https://www.w3.org/groups/wg/css">CSS 工作组</a> 作为 <strong>工作草案</strong> 发布，
            并采用了 <a href="https://www.w3.org/policies/process/20250818/#recs-and-notes">推荐轨道</a>。
            发布为工作草案并不意味着得到了 <abbr title="World Wide Web Consortium">W3C</abbr> 及其成员的认可。 </p>
        <p> 本文为草案文件，
            可能会随时由其他文档进行更新、更替或废止。
            不应该将本文件作为最终成果引用，只能视为正在进行的工作。</p>
        <p>请通过 <a href="https://github.com/w3c/csswg-drafts/issues">在 GitHub 提交
                issue</a>（推荐）反馈意见，标题中请包含规范代码“css-color-hdr”，如：
            “[css-color-hdr] <i>…评论摘要…</i>”。
            所有问题和评论均已 <a href="https://lists.w3.org/Archives/Public/public-css-archive/">归档</a>。
            或者，可以发送至 (<a href="https://lists.w3.org/Archives/Public/www-style/">已归档</a>) 公开邮件列表 <a
                href="mailto:www-style@w3.org?Subject=%5Bcss-color-hdr%5D%20PUT%20SUBJECT%20HERE">www-style@w3.org</a>。
        </p>
        <p>本文件受 <a href="https://www.w3.org/policies/process/20250818/" id="w3c_process_revision">2025年8月18日 W3C
                流程文档</a> 管辖。</p>
        <p>本文件由遵守 <a href="https://www.w3.org/policies/patent-policy/20200915/">W3C 专利政策</a> 的小组制作。
            W3C 维护了一份 <a href="https://www.w3.org/groups/wg/css/ipr" rel="disclosure">与本小组交付内容相关的专利声明公开列表</a>；
            该页面还包括专利披露的说明。
            若个人实际知晓某项专利并认为包含<a href="https://www.w3.org/policies/patent-policy/20200915/#def-essential">必要声明</a>，
            则必须根据 <a href="https://www.w3.org/policies/patent-policy/20200915/#sec-Disclosure">W3C 专利政策第6节</a> 披露相关信息。
        </p>
    </div>
    <div data-fill-with="at-risk"></div>
    <nav data-fill-with="table-of-contents" id="toc">
        <h2 class="no-num no-toc no-ref" id="contents">目录</h2>
        <ol class="toc" role="directory">
            <li>
                <a href="#intro"><span class="secno">1</span> <span class="content">引言</span></a>
                <ol class="toc">
                    <li><a href="#values"><span class="secno">1.1</span> <span class="content">值的定义</span></a>
                </ol>
            <li>
                <a href="#terminology"><span class="secno">2</span> <span class="content">HDR 术语</span></a>
                <ol class="toc">
                    <li><a href="#defining-dynamic-range"><span class="secno">2.1</span> <span
                                class="content">动态范围的定义</span></a>
                    <li><a href="#introducing-headroom"><span class="secno">2.2</span> <span
                                class="content">Headroom简介</span></a>
                </ol>
            <li>
                <a href="#controlling-dynamic-range"><span class="secno">3</span> <span
                        class="content">动态范围控制</span></a>
                <ol class="toc">
                    <li><a href="#the-dynamic-range-limit-property"><span class="secno">3.1</span> <span
                                class="content"><span class="property">dynamic-range-limit</span> 属性</span></a>
                    <li><a href="#dynamic-range-limit-mix"><span class="secno">3.2</span> <span
                                class="content">动态范围限制混合：<span class="css">dynamic-range-limit-mix()</span>
                                函数</span></a>
                    <li><a href="#computing-dynamic-range-limit"><span class="secno">3.3</span> <span class="content">
                                <span class="property">dynamic-range-limit</span> 的计算值</span></a>
                </ol>
            <li><a href="#color-syntax"><span class="secno">4</span> <span class="content"><span
                            class="production">&lt;color></span> 语法</span></a>
            <li>
                <a href="#hdr-color-function"><span class="secno">5</span> <span class="content">带 headroom 参数的 HDR
                        颜色：<span class="css">hdr-color()</span> 函数</span></a>
                <ol class="toc">
                    <li><a href="#headroom-interpolation"><span class="secno">5.1</span> <span class="content">
                                基于 headroom 的颜色插值</span></a>
                </ol>
            <li>
                <a href="#DI-HDR"><span class="secno">6</span> <span class="content">设备无关 HDR 颜色</span></a>
                <ol class="toc">
                    <li><a href="#ictcp-intro"><span class="secno">6.1</span> <span class="content">ICtCp 介绍</span></a>
                    <li><a href="#jaz-intro"><span class="secno">6.2</span> <span class="content">Jzazbz 与 JzCzhz
                                介绍</span></a>
                    <li><a href="#ICtCp"><span class="secno">6.3</span> <span
                                class="content"><span>ICtCp</span></span></a>
                    <li><a href="#Jzazbz"><span class="secno">6.4</span> <span
                                class="content"><span>Jzazbz</span></span></a>
                    <li>
                        <a href="#JzCzhz"><span class="secno">6.5</span> <span
                                class="content"><span>JzCzhz</span></span></a>
                        <ol class="toc">
                            <li><a href="#Jzazbz-to-JzCzHz"><span class="secno">6.5.1</span> <span class="content">
                                        <span class="css">Jzazbz</span> 颜色转 <span class="css">JzCzhz</span>
                                        颜色</span></a>
                            <li><a href="#JzCzHz-to-Jzazbz"><span class="secno">6.5.2</span> <span class="content">
                                        JzCzhz 颜色转 Jzazbz 颜色</span></a>
                        </ol>
                </ol>
            <li><a href="#color-function"><span class="secno">7</span> <span class="content">指定预定义与自定义色彩空间：<span
                            class="css">color()</span> 函数</span></a>
            <li>
                <a href="#predefined-HDR"><span class="secno">8</span> <span class="content">HDR 预定义色彩空间：</span></a>
                <ol class="toc">
                    <li><a href="#valdef-color-rec2100-pq"><span class="secno">8.1</span> <span
                                class="content"><span>rec2100-pq</span></span></a>
                    <li><a href="#valdef-color-rec2100-hlg"><span class="secno">8.2</span> <span
                                class="content"><span>rec2100-hlg</span></span></a>
                    <li><a href="#valdef-color-rec2100-linear"><span class="secno">8.3</span> <span
                                class="content"><span>rec2100-linear</span></span></a>
                </ol>
            <li><a href="#Compositing-SDR-HDR"><span class="secno">9</span> <span class="content">SDR 与 HDR
                        内容合成</span></a>
            <li>
                <a href="#serializing-color-values"><span class="secno">10</span> <span class="content">序列化 <span
                            class="production">&lt;color></span> 值</span></a>
                <ol class="toc">
                    <li><a href="#serializing-color-function-values"><span class="secno">10.1</span> <span
                                class="content">序列化 <span class="css">color()</span> 函数值</span></a>
                </ol>
            <li>
                <a href="#color-conversion-code"><span class="secno">11</span> <span class="content">颜色转换示例代码</span></a>
                <ol class="toc">
                    <li><a href="#rec2100-linear_code"><span class="secno">11.1</span> <span class="content"><span
                                    class="css">rec2100-linear</span> 示例代码</span></a>
                    <li><a href="#rec2100-pq_code"><span class="secno">11.2</span> <span class="content"><span
                                    class="css">rec2100-pq</span> 示例代码</span></a>
                    <li><a href="#rec2100-hlg_code"><span class="secno">11.3</span> <span class="content"><span
                                    class="css">rec2100-hlg</span> 示例代码</span></a>
                    <li><a href="#jzazbz_code"><span class="secno">11.4</span> <span class="content"><span
                                    class="css">jzazbz</span> 示例代码</span></a>
                    <li><a href="#ictcp_code"><span class="secno">11.5</span> <span class="content"><span
                                    class="css">ICtCp</span> 示例代码</span></a>
                    <li><a href="#hdr-color-code"><span class="secno">11.6</span> <span class="content"><span
                                    class="css">hdr-color()</span> 示例代码</span></a>
                </ol>
            <li><a href="#deltaE"><span class="secno">12</span> <span class="content">ΔEITP 颜色差示例代码</span></a>
            <li><a href="#privacy"><span class="secno"></span> <span class="content">隐私注意事项</span></a>
            <li><a href="#security"><span class="secno"></span> <span class="content">安全注意事项</span></a>
            <li><a href="#a11y"><span class="secno"></span> <span class="content">可访问性注意事项</span></a>
            <li>
                <a href="#changes"><span class="secno"></span> <span class="content">变更记录</span></a>
                <ol class="toc">
                    <li><a href="#changes-20241217"><span class="secno"></span> <span class="content">自 <span>2024 年 12
                                    月 17 日首次公开工作草案 </span> 以来的变更</span></a>
                </ol>
            <li>
                <a href="#w3c-conformance"><span class="secno"></span> <span class="content">一致性</span></a>
                <ol class="toc">
                    <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">文档约定</span></a>
                    <li><a href="#w3c-conformance-classes"><span class="secno"></span> <span
                                class="content">一致性类别</span></a>
                    <li>
                        <a href="#w3c-partial"><span class="secno"></span> <span class="content">部分实现</span></a>
                        <ol class="toc">
                            <li><a href="#w3c-conform-future-proofing"><span class="secno"></span> <span
                                        class="content">不稳定与专有特性的实现</span></a>
                        </ol>
                    <li><a href="#w3c-testing"><span class="secno"></span> <span class="content">非实验性实现</span></a>
                </ol>
            <li>
                <a href="#index"><span class="secno"></span> <span class="content">索引</span></a>
                <ol class="toc">
                    <li><a href="#index-defined-here"><span class="secno"></span> <span
                                class="content">本规范定义的术语</span></a>
                    <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span
                                class="content">通过引用定义的术语</span></a>
                </ol>
            <li>
                <a href="#references"><span class="secno"></span> <span class="content">参考文献</span></a>
                <ol class="toc">
                    <li><a href="#normative"><span class="secno"></span> <span class="content">规范性参考文献</span></a>
                    <li><a href="#informative"><span class="secno"></span> <span class="content">参考性参考文献</span></a>
                </ol>
            <li><a href="#property-index"><span class="secno"></span> <span class="content">属性索引</span></a>
            <li><a href="#issues-index"><span class="secno"></span> <span class="content">问题索引</span></a>
        </ol>
    </nav>
    <main>
        <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span
                class="content">引言</span><a class="self-link" href="#intro"></a></h2>
        <p><em>本节为非规范性内容。</em></p>
        <p>CSS Color 4 为开放 Web 平台引入了广色域（WCG）色彩空间。
            这些色彩空间本质上都是标准动态范围（SDR）色彩空间。
            本规范定义了支持高动态范围（HDR）的扩展。</p>
        <figure id="fig-eotf">
            <p><img alt src="./images/lin-srgb-hlg-pq.png" width="839"></p>
            <figcaption> 四个色彩空间的电光转换函数（EOTF）：
                扩展 sRGB 和线性光 sRGB
                （定义于 CSS Color 4），以及
                感知量化器（PQ）与混合对数伽马（HLG）
                按照本规范定义，内容引用自<a data-link-type="biblio" href="#biblio-rec_bt2100"
                    title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            </figcaption>
        </figure>
        <p>虽然 WCG 规范已基本稳定数十年，
            但 HDR 标准则不那么成熟，
            在过去十年中经历了多次修订。</p>
        <h3 class="heading settled" data-level="1.1" id="values"><span class="secno">1.1. </span><span
                class="content">值定义</span><a class="self-link" href="#values"></a></h3>
        <p>本规范遵循<a href="https://www.w3.org/TR/CSS2/about.html#property-defs">CSS 属性定义约定</a>
            （来自<a data-link-type="biblio" href="#biblio-css2"
                title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>），
            并使用<a href="https://www.w3.org/TR/css-values-3/#value-defs">值定义语法</a>
            （来自<a data-link-type="biblio" href="#biblio-css-values-3"
                title="CSS Values and Units Module Level 3">[CSS-VALUES-3]</a>）。
            本规范未定义的值类型，请参考 CSS Values &amp; Units <span
                title="CSS Values and Units Module Level 3">[CSS-VALUES-3]</span>。
            与其他 CSS 模块组合时，可能会拓展这些值类型的定义。</p>
        <p>除每个属性定义中列出的特定属性值外，
            本规范定义的所有属性
            还接受<a data-link-type="dfn" href="https://www.w3.org/TR/css-values-4/#css-wide-keywords"
                id="ref-for-css-wide-keywords">CSS 范围关键字</a> 作为属性值。
            为增强可读性，此处未重复列出。</p>
        <h2 class="heading settled" data-level="2" id="terminology"><span class="secno">2. </span><span
                class="content">HDR 术语</span><a class="self-link" href="#terminology"></a></h2>
        <h3 class="heading settled" data-level="2.1" id="defining-dynamic-range"><span class="secno">2.1. </span><span
                class="content">动态范围的定义</span><a class="self-link" href="#defining-dynamic-range"></a>
        </h3>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="dynamic-range">动态范围</dfn>指<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#luminance"
                id="ref-for-luminance">亮度</a>在<em>最亮</em>与<em>最暗</em>颜色之间的差距。
            动态范围以摄影的<em>档</em>（stop）度量。
            每增长一档，亮度加倍。</p>
        <pre class="lang-js highlight"><c- a>function</c-> DynamicRange <c- p>(</c->high<c- p>,</c-> low<c- p>)</c-> <c- p>{</c->
  <c- k>return</c-> Math<c- p>.</c->log2<c- p>(</c->high<c- p>)</c-> <c- o>-</c-> Math<c- p>.</c->log2<c- p>(</c->low<c- p>);</c->
  <c- p>}</c-> 
</pre>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="hdr-reference-white">HDR 参考白</dfn>
            ，也称为媒体白，
            是指普通白色背景，
            或深色背景下的白色文本。
            它可以在整个屏幕上舒适地被观看。</p>
        <p>在<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="standard-dynamic-range">标准动态范围</dfn>（SDR）下，
            HDR 参考白也是
            能达到的最亮颜色，
            即红绿蓝全亮时产生的颜色。</p>
        <div class="example" id="ex-SDR-dynamic-range"><a class="self-link" href="#ex-SDR-dynamic-range"></a> 例如，在<a
                data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#sRGB-space"
                id="ref-for-sRGB-space">sRGB</a>中，
            在标准观看条件下，
            白色定义亮度为 80 cd/m²，
            黑色定义为 0.2 cd/m²。
            因此，动态范围为 8.6 档。</div>
        <p>通常会根据用户偏好或观看环境不同，
            调整屏幕的整体亮度，
            以适应非标准场景。</p>
        <p>对于 SDR，提升屏幕亮度不会改变动态范围，
            因为最暗的颜色也会变得更亮。</p>
        <div class="example" id="ex-SDR-brighter-dynamic-range"><a class="self-link"
                href="#ex-SDR-brighter-dynamic-range"></a> 例如，一个<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-color-4/#sRGB-space" id="ref-for-sRGB-space①">sRGB</a> 屏幕，
            可能将白色设置为 160 cd/m²，
            此时最深的黑色则为 0.4 cd/m²。
            动态范围仍然是 8.6 档。</div>
        <p>在<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="high-dynamic-range">高动态范围</dfn>（HDR）下，
            能够显示比<a data-link-type="dfn" href="#hdr-reference-white" id="ref-for-hdr-reference-white">HDR 参考白</a>更亮的颜色。
            例如，当 HDR 显示器上的 HDR 参考白设为 203 cd/m² 时，
            可能可以呈现高达 1000 cd/m² 的小高光。
            通常，最亮颜色只能在显示屏的一小部分区域、
            并且持续时间有限地显示。
            这主要是因为能耗和发热限制。</p>
        <div class="example" id="ex-HDR-dynamic-range"><a class="self-link" href="#ex-HDR-dynamic-range"></a> 例如，一台 HDR
            参考母版显示器，
            小面积高亮白的亮度可以达到 1000 cd/m²，
            而最深的黑色只有 0.05 cd/m²。
            因此，动态范围为 14.3 档。</div>
        <p>对于 HDR，提升屏幕亮度会增加动态范围，
            而HDR 参考白的亮度保持不变。</p>
        <div class="example" id="ex-HDR-PQ-dynamic-range"><a class="self-link" href="#ex-HDR-PQ-dynamic-range"></a>
            例如，采用<a class="css">rec2100-pq</a> 颜色空间
            （见<a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>），
            最亮的高亮白亮度定义为 10,000 cd/m²，
            最深的黑色为 0.001 cd/m²。
            因此，编码动态范围为 23.3 档。</div>
        <p class="issue" id="issue-b905ab0c"><a class="self-link" href="#issue-b905ab0c"></a> 需要补充一张对数坐标下的SDR与HDR动态范围图示
        </p>
        <p>在<a href="#Compositing-SDR-HDR">§ 9 SDR 与 HDR 内容合成</a>过程中，
            以及色彩空间转换时，
            SDR 内容的 HDR 参考白
            应锚定为<strong>203 cd/m²</strong> <a data-link-type="biblio" href="#biblio-rpt_bt2408"
                title="Report ITU-R BT.2408-0 Operational practices in HDR television production">[Rpt_BT.2408]</a>，
            以确保输入合成时的 HDR 参考白
            最终与合成信号的 HDR 参考白一致。</p>
        <p>在显示 HDR（或混合 SDR 和 HDR）内容时，
            如果显示设备能力不及母版参考显示器，
            或观看条件不同于标准条件，
            则会执行<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="color-re-rendering">色彩重渲染</dfn>步骤（OOTF）。
            此时，HDR 参考白的显示值
            可能低于或高于 203 cd/m²。</p>
        <h3 class="heading settled" data-level="2.2" id="introducing-headroom"><span class="secno">2.2. </span><span
                class="content">Headroom简介</span><a class="self-link" href="#introducing-headroom"></a></h3>
        <p>HDR 显示设备所能达到的峰值<a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#luminance"
                id="ref-for-luminance①">亮度</a>水平
            差异极大。</p>
        <p>峰值白色大于 HDR 参考白的幅度，
            被称为<dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="hdr-headroom">HDR headroom</dfn>，
            其数值取决于 HDR 参考白亮度、
            用户偏好
            以及观看条件。</p>
        <p>它通常以摄影<strong>档</strong>（stop）为单位表示。
            因此，<a data-link-type="dfn" href="#standard-dynamic-range"
                id="ref-for-standard-dynamic-range">标准动态范围</a>（SDR）
            的<a data-link-type="dfn" href="#hdr-headroom" id="ref-for-hdr-headroom">HDR headroom</a> 定义为0档，
            因为最亮的白即为HDR参考白。</p>
        <div class="example" id="ex-low-headroom"><a class="self-link" href="#ex-low-headroom"></a> 例如，一台低端 HDR 显示器
            （仅<em>刚好</em>满足 <a href="https://displayhdr.org/">DisplayHDR 400</a> 认证最低级别 Vesa Certified DisplayHDR 标准<a
                data-link-type="biblio" href="#biblio-displayhdr"
                title="Summary of DisplayHDR Specs under CTS 1.2">[DisplayHDR]</a>）
            可能将 HDR 参考白亮度设在 200 cd/m<sup>2</sup>，
            峰值白只有 400 cd/m<sup>2</sup>（即在最高 HDR 参考白时，仅有一档 HDR headroom）。 </div>
        <div class="example" id="ex-high-headroom">
            <a class="self-link" href="#ex-high-headroom"></a> 例如，一台高端 HDR 显示器
            （超过 <a href="https://displayhdr.org/">DisplayHDR 1400</a> 要求，即Vesa Certified DisplayHDR 当前最高级别）
            可能会将 HDR 参考白设置为 400 cd/m<sup>2</sup>，峰值白达 1600 cd/m<sup>2</sup>。
            <p>在较暗环境中，
                将 HDR 参考白设定为 100 cd/m<sup>2</sup>，
                则可获得四档（16倍）HDR headroom。</p>
        </div>
        <p id="headroom-privacy"> Web 平台目前
            并不直接暴露显示器的 headroom 水平，
            因为它依赖于观看条件，
            并且实时、非量化的 headroom 信息
            可能成为跟踪途径
            （例如，侦测到用户出门且是晴天）。 </p>
        <p id="constrained-headroom"> 并非总是希望
            使用显示器全部可用的
            HDR headroom。
            CSS 提供了一种方式，
            用来粗略地控制
            期望使用多大 headroom；
            这个数值可以按元素、
            甚至随时间变化。 </p>
        <div class="example" id="ex-photo-grid"><a class="self-link" href="#ex-photo-grid"></a> 例如，考虑一个
            用于展示照片网格的网页。
            其中某些照片为 HDR，包括一些超高动态范围的画面
            （如直拍太阳）。
            如果所有照片都以全部动态范围同时显示，
            会使观感疲劳。
            但若全部压缩至SDR范围，
            又无法充分体现每张照片的特色。
            设计目标是展示“足够的”HDR效果，
            让用户可以对整组照片进行有意义的评比。 </div>
        <h2 class="heading settled" data-level="3" id="controlling-dynamic-range"><span class="secno">3. </span><span
                class="content">动态范围控制</span><a class="self-link" href="#controlling-dynamic-range"></a></h2>
        <h3 class="heading settled" data-level="3.1" id="the-dynamic-range-limit-property"><span class="secno">3.1.
            </span><span class="content"><a class="property css" data-link-type="property"
                    href="#propdef-dynamic-range-limit" id="ref-for-propdef-dynamic-range-limit">dynamic-range-limit</a>
                属性</span><a class="self-link" href="#the-dynamic-range-limit-property"></a></h3>
        <table class="def propdef" data-link-for-hint="dynamic-range-limit">
            <tbody>
                <tr>
                    <th>名称:
                    <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export
                            id="propdef-dynamic-range-limit">dynamic-range-limit</dfn>
                <tr class="value">
                    <th><a href="https://www.w3.org/TR/css-values/#value-defs">取值:</a>
                    <td class="prod">standard <a data-link-type="grammar"
                            href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one">|</a> no-limit
                        <span id="ref-for-comb-one①">|</span> constrained <span id="ref-for-comb-one②">|</span> <a
                            class="production css" data-link-type="function" href="#funcdef-dynamic-range-limit-mix"
                            id="ref-for-funcdef-dynamic-range-limit-mix">&lt;dynamic-range-limit-mix()></a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">初始值:</a>
                    <td>no-limit
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">适用元素:</a>
                    <td><a href="https://www.w3.org/TR/css-pseudo/#generated-content"
                            title="包括 ::before 和 ::after 伪元素。">所有元素</a>
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">继承性:</a>
                    <td>yes
                <tr>
                    <th><a href="https://www.w3.org/TR/css-values/#percentages">百分比:</a>
                    <td>n/a
                <tr>
                    <th><a href="https://www.w3.org/TR/css-cascade/#computed">计算值:</a>
                    <td>见 <a href="#computing-dynamic-range-limit">dynamic-range-limit 的计算值</a>
                <tr>
                    <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">规范顺序:</a>
                    <td>按语法
                <tr>
                    <th><a href="https://www.w3.org/TR/web-animations/#animation-type">动画类型:</a>
                    <td>按 <a class="css" data-link-type="maybe" href="#funcdef-dynamic-range-limit-mix"
                            id="ref-for-funcdef-dynamic-range-limit-mix①">dynamic-range-limit-mix()</a>
        </table>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>测试</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/computed.html"
                        title="css/css-color-hdr/computed.html">computed.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/computed.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/computed.html"><small>(源码)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/inheritance.html"
                        title="css/css-color-hdr/inheritance.html">inheritance.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/inheritance.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/inheritance.html"><small>(源码)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/interpolation.html"
                        title="css/css-color-hdr/interpolation.html">interpolation.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/interpolation.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/interpolation.html"><small>(源码)</small></a>
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/parsing.html"
                        title="css/css-color-hdr/parsing.html">parsing.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/parsing.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/parsing.html"><small>(源码)</small></a>
            </ul>
        </details>
        <dl>
            <dt><dfn class="dfn-paneled css" data-dfn-for="dynamic-range-limit" data-dfn-type="value" data-export
                    id="valdef-dynamic-range-limit-standard">standard</dfn>
            <dd> 显示的最高亮度颜色
                与 HDR 参考白相同，即 CSS 颜色 <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                    id="ref-for-valdef-color-white">white</a>。
            <dt><dfn class="dfn-paneled css" data-dfn-for="dynamic-range-limit" data-dfn-type="value" data-export
                    id="valdef-dynamic-range-limit-no-limit">no-limit</dfn>
            <dd> 显示的峰值亮度
                远高于 HDR 参考白，即 CSS 颜色 <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                    id="ref-for-valdef-color-white①">white</a>；
                具体亮度不做规定。
            <dt><dfn class="dfn-paneled css" data-dfn-for="dynamic-range-limit" data-dfn-type="value" data-export
                    id="valdef-dynamic-range-limit-constrained">constrained</dfn>
            <dd> 显示的峰值亮度
                略高于 HDR 参考白，即 CSS 颜色 <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                    id="ref-for-valdef-color-white②">white</a>，
                使得 SDR 与 HDR 内容可以舒适地共同呈现。
        </dl>
        <div class="example" id="ex-hdr-limit-photogrid">
            <a class="self-link" href="#ex-hdr-limit-photogrid"></a>
            <pre class="lang-css highlight">body <c- p>{</c-> <c- k>dynamic-range-limit</c-><c- p>:</c-> standard<c- p>;</c-> <c- p>}</c->
div.photogrid img <c- p>{</c-> <c- k>dynamic-range-limit</c-><c- p>:</c-> constrained <c- p>}</c->
</pre>
        </div>
        <h3 class="heading settled" data-level="3.2" id="dynamic-range-limit-mix"><span class="secno">3.2. </span><span
                class="content">动态范围限制混合：<a class="css" data-link-type="maybe" href="#funcdef-dynamic-range-limit-mix"
                    id="ref-for-funcdef-dynamic-range-limit-mix②">dynamic-range-limit-mix()</a> 函数</span><a
                class="self-link" href="#dynamic-range-limit-mix"></a></h3>
        <p>该函数接受一个或多个<a class="property css" data-link-type="property" href="#propdef-dynamic-range-limit"
                id="ref-for-propdef-dynamic-range-limit①">dynamic-range-limit</a>
            值，
            内部转换为相对于 HDR 参考白的停数值，
            并根据指定权重混合后调整显示效果。
            出于隐私原因，实际计算结果不会被暴露。</p>
        <pre class="prod"><dfn class="dfn-paneled" data-dfn-type="function" data-export id="funcdef-dynamic-range-limit-mix">dynamic-range-limit-mix()</dfn> = dynamic-range-limit-mix( [ <a class="production" data-link-type="property" href="#propdef-dynamic-range-limit" id="ref-for-propdef-dynamic-range-limit②">&lt;'dynamic-range-limit'></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-all" id="ref-for-comb-all">&amp;&amp;</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value">&lt;percentage [0,100]></a> ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-comma" id="ref-for-mult-comma">#{2,}</a> )
</pre>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>测试</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/computed.html"
                        title="css/css-color-hdr/computed.html">computed.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/computed.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/computed.html"><small>(源码)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/inheritance.html"
                        title="css/css-color-hdr/inheritance.html">inheritance.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/inheritance.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/inheritance.html"><small>(源码)</small></a>
                <li class="wpt-test"><a class="wpt-name"
                        href="https://wpt.fyi/results/css/css-color-hdr/interpolation.html"
                        title="css/css-color-hdr/interpolation.html">interpolation.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/interpolation.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/interpolation.html"><small>(源码)</small></a>
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/parsing.html"
                        title="css/css-color-hdr/parsing.html">parsing.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/parsing.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/parsing.html"><small>(源码)</small></a>
            </ul>
        </details>
        <h3 class="heading settled" data-level="3.3" id="computing-dynamic-range-limit"><span class="secno">3.3.
            </span><span class="content"><a class="property css" data-link-type="property"
                    href="#propdef-dynamic-range-limit"
                    id="ref-for-propdef-dynamic-range-limit③">dynamic-range-limit</a> 的计算值</span><a class="self-link"
                href="#computing-dynamic-range-limit"></a></h3>
        <p>如果指定值为 <a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-standard"
                id="ref-for-valdef-dynamic-range-limit-standard">standard</a>、<a class="css" data-link-type="maybe"
                href="#valdef-dynamic-range-limit-constrained"
                id="ref-for-valdef-dynamic-range-limit-constrained">constrained</a> 或 <a class="css"
                data-link-type="maybe" href="#valdef-dynamic-range-limit-no-limit"
                id="ref-for-valdef-dynamic-range-limit-no-limit">no-limit</a>，则计算值为指定值。</p>
        <p>如果指定值是 <a class="css" data-link-type="maybe" href="#funcdef-dynamic-range-limit-mix"
                id="ref-for-funcdef-dynamic-range-limit-mix③">dynamic-range-limit-mix()</a>，则计算值采用以下算法：</p>
        <ol>
            <li data-md>
                <p>令 <var>v1</var>, ..., <var>vN</var> 为要混合的参数的计算值。</p>
            <li data-md>
                <p>令 <var>p1</var>, ..., <var>pN</var> 为混合百分比，归一化后总和为 100%。</p>
            <li data-md>
                <p>贡献百分比如下定义：</p>
                <ul>
                    <li data-md>
                        <p>令 <var>p1_standard</var>,...,<var>pN_standard</var> 为 <a class="css" data-link-type="maybe"
                                href="#valdef-dynamic-range-limit-standard"
                                id="ref-for-valdef-dynamic-range-limit-standard①">standard</a> 在
                            <var>v1</var>,...,<var>vN</var> 中的百分比
                        </p>
                    <li data-md>
                        <p>令 <var>p1_constrained_high</var>,...,<var>pN_constrained_high</var> 为
                            <a class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-constrained"
                                id="ref-for-valdef-dynamic-range-limit-constrained①">constrained</a> 在
                            <var>v1</var>,...,<var>vN</var> 中的百分比
                        </p>
                    <li data-md>
                        <p>令 <var>p1_no_limit</var>,...,<var>pN_no_limit</var> 为 <a class="css" data-link-type="maybe"
                                href="#valdef-dynamic-range-limit-no-limit"
                                id="ref-for-valdef-dynamic-range-limit-no-limit①">no-limit</a> 在
                            <var>v1</var>,...,<var>vN</var> 中的百分比
                        </p>
                </ul>
            <li data-md>
                <p>按下式计算加权和：</p>
                <ul>
                    <li data-md>
                        <p><var>p_standard</var>=(<var>p1_standard</var>*<var>p1</var>+...+<var>pN_standard</var>*<var>pN</var>)/100。
                        </p>
                    <li data-md>
                        <p><var>p_constrained_high</var>=(<var>p1_constrained_high</var>*<var>p1</var>+...+<var>pN_constrained_high</var>*<var>pN</var>)/100。
                        </p>
                    <li data-md>
                        <p><var>p_no_limit</var>=(<var>p1_no_limit</var>*<var>p1</var>+...+<var>pN_no_limit</var>*<var>pN</var>)/100。
                        </p>
                </ul>
            <li data-md>
                <p>如果 <var>p_standard</var>、<var>p_constrained_high</var> 或 <var>p_no_limit</var> 等于 100%，则计算值分别为 <a
                        class="css" data-link-type="maybe" href="#valdef-dynamic-range-limit-standard"
                        id="ref-for-valdef-dynamic-range-limit-standard②">standard</a>、<a class="css"
                        data-link-type="maybe" href="#valdef-dynamic-range-limit-constrained"
                        id="ref-for-valdef-dynamic-range-limit-constrained②">constrained</a> 或 <a class="css"
                        data-link-type="maybe" href="#valdef-dynamic-range-limit-no-limit"
                        id="ref-for-valdef-dynamic-range-limit-no-limit②">no-limit</a>。</p>
            <li data-md>
                <p>否则，计算值为 <a class="css" data-link-type="maybe" href="#funcdef-dynamic-range-limit-mix"
                        id="ref-for-funcdef-dynamic-range-limit-mix④">dynamic-range-limit-mix()</a>，其参数为 <a class="css"
                        data-link-type="maybe" href="#valdef-dynamic-range-limit-standard"
                        id="ref-for-valdef-dynamic-range-limit-standard③">standard</a>、<a class="css"
                        data-link-type="maybe" href="#valdef-dynamic-range-limit-constrained"
                        id="ref-for-valdef-dynamic-range-limit-constrained③">constrained</a> 和 <a class="css"
                        data-link-type="maybe" href="#valdef-dynamic-range-limit-no-limit"
                        id="ref-for-valdef-dynamic-range-limit-no-limit③">no-limit</a>，按该顺序，百分比分别为
                    <var>p_standard</var>、<var>p_constrained_high</var> 与 <var>p_no_limit</var>，百分比为 0%
                    的参数省略。如果<em>所有</em>参数均被省略，则计算值为初始值。
                </p>
        </ol>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>测试</summary>
            <ul class="wpt-tests-list">
                <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/css/css-color-hdr/computed.html"
                        title="css/css-color-hdr/computed.html">computed.html</a> <a class="wpt-live"
                        href="http://wpt.live/css/css-color-hdr/computed.html"><small>(在线测试)</small></a> <a
                        class="wpt-source"
                        href="https://github.com/web-platform-tests/wpt/blob/master/css/css-color-hdr/computed.html"><small>(源码)</small></a>
            </ul>
        </details>
        <div class="example" id="ex-hdr-limit-mix">
            <a class="self-link" href="#ex-hdr-limit-mix"></a> 下例的计算值
            <pre class="lang-css highlight"><c- nf>dynamic-range-limit-mix</c-><c- p>(</c->
    high <c- m>10</c-><c- k>%</c-><c- p>,</c->
    <c- nf>dynamic-range-limit-mix</c-><c- p>(</c->standard <c- m>25</c-><c- k>%</c-><c- p>,</c-> constrained <c- m>75</c-><c- k>%</c-><c- p>)</c-> <c- m>20</c-><c- k>%</c-><c- p>,</c->
    <c- nf>dynamic-range-limit-mix</c-><c- p>(</c->constrained <c- m>10</c-><c- k>%</c-><c- p>,</c-> no-limit <c- m>30</c-><c- k>%</c-><c- p>)</c-> <c- m>20</c-><c- k>%</c-><c- p>)</c->
</pre>
            <p>为</p>
            <pre class="lang-css highlight"><c- nf>dynamic-range-limit-mix</c-><c- p>(</c->standard <c- m>10</c-><c- k>%</c-><c- p>,</c-> constrained <c- m>40</c-><c- k>%</c-><c- p>,</c-> no-limit <c- m>50</c-><c- k>%</c-><c- p>)</c->
</pre>
        </div>
        <h2 class="heading settled" data-level="4" id="color-syntax"><span class="secno">4. </span><span
                class="content"><a class="production css" data-link-type="type"
                    href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color">&lt;color></a>
                语法</span><a class="self-link" href="#color-syntax"></a></h2>
        <p>本模块扩展了 <a class="production css" data-link-type="type" href="#typedef-color-function"
                id="ref-for-typedef-color-function">&lt;color-function></a> 类型：</p>
        <pre class="prod"><dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-color-function">&lt;color-function></dfn> = <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-4/#funcdef-rgb" id="ref-for-funcdef-rgb">&lt;rgb()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③">|</a> <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-4/#funcdef-rgba" id="ref-for-funcdef-rgba">&lt;rgba()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one④">|</a>
    <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-4/#funcdef-hsl" id="ref-for-funcdef-hsl">&lt;hsl()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑤">|</a> <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-4/#funcdef-hsla" id="ref-for-funcdef-hsla">&lt;hsla()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑥">|</a> <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-5/#funcdef-hwb" id="ref-for-funcdef-hwb">&lt;hwb()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑦">|</a>
    <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-5/#funcdef-lab" id="ref-for-funcdef-lab">&lt;lab()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑧">|</a> <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-5/#funcdef-lch" id="ref-for-funcdef-lch">&lt;lch()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one⑨">|</a> <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-5/#funcdef-oklab" id="ref-for-funcdef-oklab">&lt;oklab()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⓪">|</a> <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-5/#funcdef-oklch" id="ref-for-funcdef-oklch">&lt;oklch()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①①">|</a>
    <a class="production" data-link-type="function" href="#funcdef-ictcp" id="ref-for-funcdef-ictcp">&lt;ictcp()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①②">|</a> <a class="production" data-link-type="function" href="#funcdef-jzazbz" id="ref-for-funcdef-jzazbz">&lt;jzazbz()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①③">|</a> <a class="production" data-link-type="function" href="#funcdef-jzczhz" id="ref-for-funcdef-jzczhz">&lt;jzczhz()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①④">|</a>
    <a class="production" data-link-type="function" href="https://drafts.csswg.org/css-color-5/#funcdef-alpha" id="ref-for-funcdef-alpha">&lt;alpha()></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑤">|</a>
    <a class="production" data-link-type="function" href="https://www.w3.org/TR/css-color-5/#funcdef-color" id="ref-for-funcdef-color">&lt;color()></a>
<dfn class="dfn-paneled" data-dfn-type="function" data-export id="funcdef-ictcp">ictcp()</dfn> = ictcp([from <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color①">&lt;color></a>]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt">?</a>
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value①">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑥">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑦">|</a> none]
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value②">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑧">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value①">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one①⑨">|</a> none]
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value③">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⓪">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value②">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②①">|</a> none]
  [ / [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" id="ref-for-typedef-color-alpha-value">&lt;alpha-value></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②②">|</a> none] ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt①">?</a> )
<dfn class="dfn-paneled" data-dfn-type="function" data-export id="funcdef-jzazbz">jzazbz()</dfn> = jzazbz([from <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color②">&lt;color></a>]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt②">?</a>
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value④">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②③">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value③">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②④">|</a> none]
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value⑤">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑤">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value④">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑥">|</a> none]
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value⑥">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑦">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value⑤">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑧">|</a> none]
  [ / [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" id="ref-for-typedef-color-alpha-value①">&lt;alpha-value></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one②⑨">|</a> none] ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt③">?</a> )
<dfn class="dfn-paneled" data-dfn-type="function" data-export id="funcdef-jzczhz">jzczhz()</dfn> = jzczhz([from <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color③">&lt;color></a>]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt④">?</a>
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value⑦">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③⓪">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value⑥">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③①">|</a> none]
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#percentage-value" id="ref-for-percentage-value⑧">&lt;percentage></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③②">|</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value⑦">&lt;number></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③③">|</a> none]
  [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-4/#typedef-hue" id="ref-for-typedef-hue">&lt;hue></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③④">|</a> none]
  [ / [<a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" id="ref-for-typedef-color-alpha-value②">&lt;alpha-value></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③⑤">|</a> none] ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt⑤">?</a> )
</pre>
        <h2 class="heading settled" data-level="5" id="hdr-color-function"><span class="secno">5. </span><span
                class="content">带 headroom 参数的 HDR 颜色：<a class="css" data-link-type="maybe" href="#funcdef-hdr-color"
                    id="ref-for-funcdef-hdr-color">hdr-color()</a> 函数</span><a class="self-link"
                href="#hdr-color-function"></a></h2>
        <p><a class="css" data-link-type="maybe" href="#funcdef-hdr-color"
                id="ref-for-funcdef-hdr-color①">hdr-color()</a> 函数允许指定一系列颜色，
            其值会根据<a data-link-type="dfn" href="#hdr-headroom" id="ref-for-hdr-headroom①">HDR headroom</a> 自动计算。</p>
        <p>具体方法是声明两个<a class="production css" data-link-type="type"
                href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color④">&lt;color></a>
            值，
            每个都绑定一个 HDR headroom 水平。
            （这两个headroom值不能相同）。
            实际颜色值会基于当前的 HDR headroom，
            按照<a href="#headroom-interpolation">§ 5.1 基于 headroom 的颜色插值</a>所述，
            在这两个颜色间插值获得。</p>
        <div class="informative"> 这与栅格图片规范 <a data-link-type="biblio" href="#biblio-iso_21496-1"
                title="Gain map metadata for image conversion: Part 1: Dynamic Range Conversion">[ISO_21496-1]</a> 的
            gain map 机制相似，
            也类似于<a data-link-type="biblio" href="#biblio-smpte-st-2094-50"
                title="Dynamic Metadata for Color Volume Transform - Application #5 (Broadcast)">[SMPTE-ST-2094-50]</a>
            的自适应增益曲线。
        </div>
        <p>出于隐私原因，实际计算的颜色和实际 HDR headroom 都不会暴露，
            因为这属于浏览器指纹收集向量。</p>
        <p>其语法如下：</p>
        <pre class="prod"><dfn class="dfn-paneled" data-dfn-type="function" data-export id="funcdef-hdr-color">hdr-color()</dfn> = color-hdr([ <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color⑤">&lt;color></a> <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-all" id="ref-for-comb-all①">&amp;&amp;</a> <a class="production" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value" id="ref-for-number-value⑧">&lt;number [0,∞]></a><a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-opt" id="ref-for-mult-opt⑥">?</a> ]<a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#mult-comma" id="ref-for-mult-comma①">#{2}</a>)
</pre>
        <div class="example" id="ex-hdr-color-simple">
            <a class="self-link" href="#ex-hdr-color-simple"></a> 考虑以下颜色：
            <pre class="lang-css highlight"><c- nf>color-hdr</c-><c- p>(</c->
  <c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>0.9</c-> <c- m>1.0</c-> <c- m>0.8</c-><c- p>)</c-> <c- m>0</c-><c- p>,</c->
  <c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>1.8</c-> <c- m>2.0</c-> <c- m>1.5</c-><c- p>)</c-> <c- m>2</c-><c- p>);</c->
</pre>
            <p>在 <a data-link-type="dfn" href="#hdr-headroom" id="ref-for-hdr-headroom②">HDR
                    headroom</a> &lt;= 0 时，
                也即 SDR 显示器上，
                此色显示为</p>
            <pre
                class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>0.9</c-> <c- m>1.0</c-> <c- m>0.8</c-><c- p>)</c-></pre>
            <p>当显示器 <a data-link-type="dfn" href="#hdr-headroom" id="ref-for-hdr-headroom③">HDR
                    headroom</a> >= 2 时，
                此色显示为</p>
            <pre class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>1.8</c-> <c- m>2.0</c-> <c- m>1.5</c-><c- p>)</c-> <c- m>2</c-><c- p>);</c->
</pre>
            <p>对于 headroom 在 0 到 2 之间的显示器，颜色将进行插值。例如见<a href="#ex-hdr-interpolate">示例</a>，
                如 headroom = 1 时：</p>
            <p>X = 243.664, Y = 275.713, Z = 244.000</p>
        </div>
        <p>颜色在 <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="absolute-d65-cie-xyz">绝对 D65 CIE XYZ</dfn>
            空间插值。</p>
        <p>它是通过将<a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-xyz-d65"
                id="ref-for-valdef-color-xyz-d65">xyz-d65</a>的每个颜色分量乘以 203 <a data-link-type="biblio"
                href="#biblio-rpt_bt2408"
                title="Report ITU-R BT.2408-0 Operational practices in HDR television production">[Rpt_BT.2408]</a> 获得，
            实现由相对单位（白色的 Y 分量为 1，无论实际亮度如何）
            向绝对单位 cd/m² 转换，也称为“尼特”。
            在<a href="#color-conversion-code">示例代码</a>中，
            此常量记作 <var>Yw</var>，
            即 HDR 参考白的亮度。</p>
        <div class="example" id="ex-rel-to-abs">
            <a class="self-link" href="#ex-rel-to-abs"></a> 例如，css 颜色 <a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-color-4/#valdef-color-white" id="ref-for-valdef-color-white③">white</a>
            为
            <pre
                class="lang-css highlight"><c- nf>color</c-><c- p>(</c->xyz-d65 <c- m>0.9505</c-> <c- m>1</c-> <c- m>1.089</c-><c- p>)</c-></pre>
            <p>对应绝对 D65 XYX 为
                [192.9426, 203, 221.0787]</p>
        </div>
        <h3 class="heading settled" data-level="5.1" id="headroom-interpolation"><span class="secno">5.1. </span><span
                class="content"> 基于 headroom 的颜色插值 </span><a class="self-link" href="#headroom-interpolation"></a></h3>
        <p>在 headroom 为 <var>H</var> 时，颜色 <var>c1</var> 在 headroom <var>H1</var> 与颜色 <var>c2</var> 在 headroom
            <var>H2</var> 之间插值得到结果色 <var>cxyz</var>，方法如下：
        </p>
        <ol>
            <li data-md>
                <p>令 <var>c1xyz</var> 为 <var>c1</var> 转换为<a data-link-type="dfn" href="#absolute-d65-cie-xyz"
                        id="ref-for-absolute-d65-cie-xyz">绝对 D65 CIE XYZ</a></p>
            <li data-md>
                <p>令 <var>c2xyz</var> 为 <var>c2</var> 转换为<a data-link-type="dfn" href="#absolute-d65-cie-xyz"
                        id="ref-for-absolute-d65-cie-xyz①">绝对 D65 CIE XYZ</a></p>
            <li data-md>
                <p>令 <var> w1</var> = clamp((<var>H</var> - <var>H2</var>) / (<var>H1</var> - <var>H2</var>), 0, 1)
                </p>
            <li data-md>
                <p>令 <var> w2</var> = clamp((<var>H</var> - <var>H1</var>) / (<var>H2</var> - <var>H1</var>), 0, 1)
                    注意 <var> w2</var> = 1 - <var> w1</var></p>
            <li data-md>
                <p>令 <var>eps</var> = 0.001</p>
            <li data-md>
                <p>令 <var>cxyz</var> = Array(3)</p>
            <li data-md>
                <p>对 i = 0 到 2:
                    令 <var>cxyz</var>[i] = pow(<var>c1xyz</var>[i] + <var>eps</var>, <var>w1</var> ) *
                    pow(<var>c2xyz</var>[i] + <var>eps</var>, <var>w2</var> ) - <var>eps</var></p>
        </ol>
        <p class="note" role="note"><span class="marker">注意:</span> <var>eps</var> 用于防止除零，
            尤其是在与接近黑色的 SDR 颜色插值时非常重要。</p>
        <div class="example" id="ex-hdr-interpolate">
            <a class="self-link" href="#ex-hdr-interpolate"></a> 例：给定 c1 = color(rec2100-linear 0.9 1.0
            0.8)，
            c2 = color(rec2100-linear 1.8 2.0 1.5)，
            H1 = 0, H2 = 2, 且 H = 1 时：
            <pre class="lang-css highlight">c1xyz = <c- p>[</c-> <c- m>173.156</c-><c- p>,</c-> <c- m>195.260</c-><c- p>,</c-> <c- m>178.003</c-> <c- p>]</c->
c2xyz = <c- p>[</c-> <c- m>342.883</c-><c- p>,</c-> <c- m>389.315</c-><c- p>,</c-> <c- m>334.467</c-> <c- p>]</c->
w1 = <c- m>0.5</c->
w2 = <c- m>0.5</c->
cxyz = <c- p>[</c-> <c- m>243.664</c-><c- p>,</c-> <c- m>275.713</c-><c- p>,</c-> <c- m>244.000</c-> <c- p>]</c->
</pre>
        </div>
        <div class="example" id="ex-hdr-interpolate-2">
            <a class="self-link" href="#ex-hdr-interpolate-2"></a> 例：c1 = color(display-p3 1 1 0.33)，
            c2 = jzczhz(70% 0.14 100)，
            H1 = 0.5, H2 = 4，H = 2：
            <pre class="lang-css highlight">c1xyz = <c- p>[</c-> <c- m>156.285</c-><c- p>,</c-> <c- m>188.337</c-><c- p>,</c-> <c- m>28.015</c-> <c- p>]</c->
c2xyz = <c- p>[</c-> <c- m>3776.1434</c-><c- p>,</c-> <c- m>4362.407</c-><c- p>,</c-> <c- m>1577.913</c-> <c- p>]</c->
w1 = <c- m>0.571</c-> 
w2 = <c- m>0.429</c->
cxyz = <c- p>[</c-> <c- m>611.911</c-><c- p>,</c-> <c- m>724.180</c-><c- p>,</c-> <c- m>157.650</c-> <c- p>]</c->
</pre>
            <p>注意：headroom &lt;= 0.5 时将始终使用 c1，headroom >= 4 时始终使用 c2。</p>
        </div>
        <h2 class="heading settled" data-level="6" id="DI-HDR"><span class="secno">6. </span><span class="content">
                设备无关 HDR 颜色 </span><a class="self-link" href="#DI-HDR"></a></h2>
        <p>正如 <a href="https://www.w3.org/TR/css-color-4/#lab-colors"><cite>CSS Color 4</cite> § 9
                设备无关颜色：CIE Lab 和 LCH, Oklab 和 OKLCh</a> 允许指定设备无关的 SDR 颜色一样，
            本规范允许指定设备无关的 HDR 颜色。</p>
        <h3 class="informative heading settled" data-level="6.1" id="ictcp-intro"><span class="secno">6.1. </span><span
                class="content"> ICtCp 介绍 </span><a class="self-link" href="#ictcp-intro"></a></h3>
        <p><em>本节为非规范性内容。</em></p>
        <p>IC<sub>T</sub>C<sub>P</sub> 色彩空间
            的感知均匀性优于 CIE Lab，
            并被广泛用作高动态范围（HDR）与广色域（WCG）图像
            的视频和数码摄影系统色彩成像流程的一部分。</p>
        <p>T 和 P 下标指代人类视觉中的
            Tritanope（黄蓝轴）
            和 Protanope（红绿轴）对立颜色轴。
            为避免下标繁琐，简写常用 ICtCp。</p>
        <p>IC<sub>T</sub>C<sub>P</sub> 最初由杜比实验室 <a data-link-type="biblio" href="#biblio-what_is_ictcp"
                title="What is ICtCp, v7.1">[What_is_ICtCp]</a> 基于 Ebner 和 Fairchild 的 IPT 色彩空间 <a
                data-link-type="biblio" href="#biblio-development_itp"
                title="Development and testing of a color space (IPT) with improved hue uniformity. In: Proceedings of The Sixth Color Imaging Conference, 8-13, 1998">[Development_ITP]</a>
            发展而来，
            并在 <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            中定义为
            Constant Intensity IC<sub>T</sub>C<sub>P</sub> 信号格式。
            它的设计目的是取代 YCbCr <a data-link-type="biblio" href="#biblio-perrin"
                title="ICtCp Versus Y&apos;CbCr: Evaluation of ICtCp Color Space and an Adaptive Reshaper for HDR and WCG">[Perrin]</a>。
        </p>
        <p>它基于 LMS 锥体原色模型；
            使用 Hunt-Pointer-Estevez (HPE) XYZ 到 LMS 的变换，
            并以<a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#d65" id="ref-for-d65">D65</a> 白点归一化。
            随后应用 4% 串扰矩阵 <a data-link-type="biblio" href="#biblio-what_is_ictcp"
                title="What is ICtCp, v7.1">[What_is_ICtCp]</a>，
            用于减少 BT.2020 RGB 的色域包壳凹陷，
            从而降低插值误差。
            同时提升了恒色调线条和 Just Noticeable Difference (JND) MacAdam 椭圆的均匀性。</p>
        <p>与<a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-lab-lab"
                id="ref-for-valdef-lab-lab">Lab</a> 主要是针对
            低强度<em>反射</em>色的实验不同，
            IC<sub>T</sub>C<sub>P</sub> 经过了
            高饱和度（广色域）、
            自发光、高强度（HDR）颜色的测试。</p>
        <p>这使其非常适合 HDR 色差度量 <a href="#deltaE">(deltaE ITP)</a> 和 SDR 与 HDR 混合色的色域映射。</p>
        <div class="example" id="ex-DE-ITP">
            <a class="self-link" href="#ex-DE-ITP"></a> 例如，BT.2020 和 BT.2100 拥有相同的原色与白点。
            BT.2020 为 SDR 色域，而 BT.2100 为 HDR，
            其 HDR 参考白在码值接近 0.58 的位置。
            <p>下面分别为两个色域下极广色域主红：</p>
            <pre class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-pq <c- m>0.58</c-> <c- m>0</c-> <c- m>0</c-><c- p>)</c-> <c- c>/* ictcp(44.6% -0.129 0.399) */</c->
<c- nf>color</c-><c- p>(</c->rec2020 <c- m>1</c-> <c- m>0</c-> <c- m>0</c-><c- p>)</c->       <c- c>/* ictcp(44.7% -0.130 0.399)  */</c->
</pre>
            <p>两者在 ICTCP 空间内极为接近，
                deltaE ITP = 0.487，
                表明视觉上基本无差异。</p>
            <p>而和 sRGB“红色”差别很大：</p>
            <pre class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-pq <c- m>0.58</c-> <c- m>0</c-> <c- m>0</c-><c- p>)</c-> <c- c>/* ictcp(44.6% -0.129 0.399) */</c->
red                        <c- c>/* ictcp(42.8% -0.116 0.279) */</c->
</pre>
            <p>deltaE ITP = 87.7，
                说明两者视觉差异极大。</p>
        </div>
        <h3 class="informative heading settled" data-level="6.2" id="jaz-intro"><span class="secno">6.2. </span><span
                class="content">Jzazbz 与 JzCzhz 介绍</span><a class="self-link" href="#jaz-intro"></a></h3>
        <p><em>本节为非规范性内容。</em></p>
        <p>J<sub>z</sub>a<sub>z</sub>b<sub>z</sub> 色彩空间 <a data-link-type="biblio" href="#biblio-safdar-pucs"
                title="Perceptually uniform color space for image signals including high dynamic range and wide gamut">[Safdar-PUCS]</a>，
            及其极坐标形式 J<sub>z</sub>C<sub>z</sub>h<sub>z</sub>，
            专为提升广色域如 BT.2020 的感知均匀性，
            准确预测亮度（尤其涵盖 HDR），
            并实现色彩属性（亮度、色度和色相）间的最小干扰而设计。
            相比于 CAM16-UCS <span
                title="Perceptually uniform color space for image signals including high dynamic range and wide gamut">[Safdar-PUCS]</span>，色相均匀性更好。
        </p>
        <p>CIE Lab 的亮度分布在 [0%, 100%] 区间，
            以 HDR 参考白为基准；
            类似地，Oklab 的亮度区间为 [0, 1.0]，
            其中 1.0 也代表 HDR 参考白。
            不同的是，<span class="css">Jzazbz</span> 里的 J<sub>z</sub> 轴取值区间为 [0, 1.0]，
            编码方式类似于 Perceptual Quantizer，
            可表示超 13 档的动态范围。</p>
        <h3 class="heading settled" data-level="6.3" id="ICtCp"><span class="secno">6.3. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="ictcp">ICtCp</dfn></span><a
                class="self-link" href="#ICtCp"></a></h3>
        <p><span class="css">ICtCp</span> 色彩空间接受三个数值参数，
            其中 I 表示亮度
            （类似于 Lab 色彩空间的 L，但覆盖亮度高达 10,000 cd/m<sup>2</sup>），
            C<sub>T</sub> 和 C<sub>P</sub> 分别表示
            黄蓝（tritanope）和红绿（protanope）对立色轴（类似于 Lab 的 b 和 a 分量）。</p>
        <p>其主要特性如下：</p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>白点色度
                    <td colspan="2"><a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#d65"
                            id="ref-for-d65①">D65</a>
                <tr>
                    <th>传递函数
                    <td colspan="2">感知量化器
                <tr>
                    <th>白色亮度
                    <td colspan="2">203 cd/m²
                <tr>
                    <th>峰值白亮度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黑色亮度
                    <td colspan="2">0.001 cd/m²
                <tr>
                    <th>图像状态
                    <td colspan="2">display-referred
                <tr>
                    <th>百分比
                    <td colspan="2">I、Ct 和 Cp 可用百分比
                <tr>
                    <th>百分比参考范围
                    <td>对 I：0% = 0.0，100% = 1.0<br> 对 Ct/Cp：-100% = -0.5，100% = 0.5
        </table>
        <p>虽然 <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            定义了 IC<sub>T</sub>C<sub>P</sub> 从线性光 BT.2100 RGB <span
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</span>
            转换方式，
            但实际上，这一转换经过 LMS，
            所以任何其他色彩空间也可以按 <a data-link-type="biblio" href="#biblio-what_is_ictcp"
                title="What is ICtCp, v7.1">[What_is_ICtCp]</a> 的 XYZ 到 LMS 变换来表达。
            <a href="#ictcp_code">示例代码</a> 采用该方法实现。
        </p>
        <div class="example" id="example-c42f1cee">
            <a class="self-link" href="#example-c42f1cee"></a> 该色代表 sRGB 颜色“lime”在 <span class="css">ICtCp</span>
            色彩空间中的数值
            <pre><span class="swatch" style="--color: lime"></span> ictcp(0.5393 -0.2643 -0.0625)
</pre>
        </div>
        <div class="example" id="example-c8369b18">
            <a class="self-link" href="#example-c8369b18"></a> 该色代表可长时间显示、适用于字幕的“舒适扩散白”
            可在屏幕任意大区域持续显示。
            与 sRGB 的 <a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                id="ref-for-valdef-color-white④">white</a> 相同。
            扩散白以 203 cd/m² <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            标准。
            <pre><span class="swatch" style="--color: white"></span> ictcp(0.58069 0 0)
</pre>
        </div>
        <p>在 <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#relative-color"
                id="ref-for-relative-color">相对颜色</a> 语法的 <a class="css" data-link-type="maybe" href="#funcdef-ictcp"
                id="ref-for-funcdef-ictcp①">ictcp()</a> 函数内，
            允许的<a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#component-keyword"
                id="ref-for-component-keyword">分量关键词</a>有：</p>
        <ul>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="ictcp()" data-dfn-type="value" data-export
                        id="valdef-ictcp-i">i</dfn> 为 <a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value⑨">&lt;number></a>，表示<a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-color-5/#origin-color" id="ref-for-origin-color">原色</a>的
                    I（亮度）分量，
                    经过如有需要的 <a data-link-type="dfn" href="https://drafts.csswg.org/css-color-5/#required-conversion"
                        id="ref-for-required-conversion">转换</a>后为 ictcp。1.0 相当于 100%。</p>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="ictcp()" data-dfn-type="value" data-export
                        id="valdef-ictcp-ct">ct</dfn> 及 <dfn class="dfn-paneled css" data-dfn-for="ictcp()"
                        data-dfn-type="value" data-export id="valdef-ictcp-cp">cp</dfn> 皆为 <a class="production css"
                        data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①⓪">&lt;number></a>，
                    分别对应<a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#origin-color"
                        id="ref-for-origin-color①">原色</a>的 ct 和 cp 轴，
                    如有需要经过 <a data-link-type="dfn" href="https://drafts.csswg.org/css-color-5/#required-conversion"
                        id="ref-for-required-conversion①">转换</a>。0.5 等价 100%，-0.5 等价 -100%。</p>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="ictcp()" data-dfn-type="value" data-export
                        id="valdef-ictcp-alpha">alpha</dfn> 为 <a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①①">&lt;number></a>，对应该<a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-color-5/#origin-color" id="ref-for-origin-color②">原色</a>透明度。1.0
                    等同 100%。</p>
        </ul>
        <h3 class="heading settled" data-level="6.4" id="Jzazbz"><span class="secno">6.4. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="jzazbz">Jzazbz</dfn></span><a class="self-link" href="#Jzazbz"></a></h3>
        <p><span class="css">Jzazbz</span> 色彩空间接受三个数值参数，
            其中 J<sub>z</sub> 表示亮度（类似于 Lab 的 L），
            a<sub>z</sub> 和 b<sub>z</sub> 分别表示
            红-绿与黄-蓝的对立色通道（类似于 Lab 的 a 和 b）。</p>
        <p><span class="css">Jzazbz</span> 具有以下特性：</p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>白点色度
                    <td colspan="2"><a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#d65"
                            id="ref-for-d65②">D65</a>
                <tr>
                    <th>转移函数
                    <td colspan="2">感知量化器
                <tr>
                    <th>峰值白亮度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黑色亮度
                    <td colspan="2">0.001 cd/m²
                <tr>
                    <th>图像状态
                    <td colspan="2">display-referred
                <tr>
                    <th>百分比
                    <td colspan="2">Jz、az、bz 可用百分比
                <tr>
                    <th>百分比参考范围
                    <td>Jz: 0% = 0.0, 100% = 1.0<br> az 和 bz: -100% = -0.21, 100% = 0.21
        </table>
        <p>注意，与 Lab 不同的是，这里采用 <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#d65"
                id="ref-for-d65③">D65</a> 白点。
            因此多数 RGB 色域（也采用 D65 白点）无需执行色度自适应步骤。</p>
        <p>已提供将 XYZ-D65 与 <span class="css">Jzazbz</span> 互转的<a href="#jzazbz_code">示例代码</a>。</p>
        <div class="example" id="example-1fad9c22">
            <a class="self-link" href="#example-1fad9c22"></a> 该色可作为舒适的“漫反射白”，
            可长时间显示或做字幕使用，
            可在屏幕任意区域显示，
            其与 sRGB 的 <a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                id="ref-for-valdef-color-white⑤">white</a> 相同。
            漫反射白亮度为 203 cd/m² <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            <pre><span class="swatch" style="--color: white"></span> jzazbz(0.22207 -0.00016 -0.00012)
</pre>
        </div>
        <p>在 <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#relative-color"
                id="ref-for-relative-color①">相对颜色</a> 语法的 <a class="css" data-link-type="maybe" href="#funcdef-jzazbz"
                id="ref-for-funcdef-jzazbz①">jzazbz()</a> 函数中，
            可用的 <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#component-keyword"
                id="ref-for-component-keyword①">分量关键字</a>有：</p>
        <ul>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="jzazbz()" data-dfn-type="value" data-export
                        id="valdef-jzazbz-j">j</dfn> 为 <a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①②">&lt;number></a>，对应<a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-color-5/#origin-color" id="ref-for-origin-color③">原色</a>的
                    Jz（亮度）分量，
                    如有需要经<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-5/#required-conversion"
                        id="ref-for-required-conversion②">转换</a>，转换至 jzazbz。
                    1.0 等价于 100%。</p>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="jzazbz()" data-dfn-type="value" data-export
                        id="valdef-jzazbz-a">a</dfn> 和 <dfn class="dfn-paneled css" data-dfn-for="jzazbz()"
                        data-dfn-type="value" data-export id="valdef-jzazbz-b">b</dfn> 为 <a class="production css"
                        data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①③">&lt;number></a>，
                    分别对应<a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#origin-color"
                        id="ref-for-origin-color④">原色</a>的 az 和 bz 分量，
                    如有需要经<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-5/#required-conversion"
                        id="ref-for-required-conversion③">转换</a>，转换至 jzazbz。
                    0.21 等价于 100%，-0.21 等价于 -100%。</p>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="jzazbz()" data-dfn-type="value" data-export
                        id="valdef-jzazbz-alpha">alpha</dfn> 为 <a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①④">&lt;number></a>，对应<a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-color-5/#origin-color" id="ref-for-origin-color⑤">原色</a>的 alpha
                    透明度。1.0 等价于 100%。</p>
        </ul>
        <h3 class="heading settled" data-level="6.5" id="JzCzhz"><span class="secno">6.5. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="jzczhz">JzCzhz</dfn></span><a class="self-link" href="#JzCzhz"></a></h3>
        <p>类似于 LCH 是 Lab 的极坐标表示，<span class="css">JzCzhz</span> 是 <span class="css">Jzazbz</span> 的极坐标形式。</p>
        <p>J<sub>z</sub> 与 <span class="css">Jzazbz</span> 中的数值一致且表示亮度，
            C<sub>z</sub> 表示色度（色彩度），
            h<sub>z</sub> 表示色相角，
            从正 a<sub>z</sub> 轴往正 b<sub>z</sub> 轴的方向度量。</p>
        <p>其特性如下：</p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>白点色度
                    <td colspan="2"><a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#d65"
                            id="ref-for-d65④">D65</a>
                <tr>
                    <th>转移函数
                    <td colspan="2">感知量化器
                <tr>
                    <th>峰值白亮度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黑色亮度
                    <td colspan="2">0.001 cd/m²
                <tr>
                    <th>图像状态
                    <td colspan="2">display-referred
                <tr>
                    <th>百分比
                    <td colspan="2">Jz 和 Cz 可用百分比
                <tr>
                    <th>百分比参考范围
                    <td>Jz: 0% = 0.0, 100% = 1.0<br> Cz: 0% = 0.0, 100% = 0.26
                <tr>
                    <th>无色相 ε
                    <td>Cz &lt;= 0.0000026
        </table>
        <div class="example" id="example-86e60443">
            <a class="self-link" href="#example-86e60443"></a> 该色代表了 sRGB 颜色“lime”在 <span class="css">Jzazbz</span>
            空间中的值
            <pre><span class="swatch" style="--color: lime"></span> jzazbz(0.17542 -0.1179 0.1092)
</pre>
            <p>下面是其极坐标形式</p>
            <pre><span class="swatch" style="--color: lime"></span> jzczhz(0.17542 0.1614 132.50)
</pre>
        </div>
        <p>在 <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#relative-color"
                id="ref-for-relative-color②">相对颜色</a> 语法的 <a class="css" data-link-type="maybe" href="#funcdef-jzczhz"
                id="ref-for-funcdef-jzczhz①">jzczhz()</a> 函数中，
            可用的 <a data-link-type="dfn" href="https://www.w3.org/TR/css-color-5/#component-keyword"
                id="ref-for-component-keyword②">分量关键字</a>有：</p>
        <ul>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="jzczhz()" data-dfn-type="value" data-export
                        id="valdef-jzczhz-j">j</dfn> 为 <a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①⑤">&lt;number></a>，对应<a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-color-5/#origin-color" id="ref-for-origin-color⑥">原色</a>的
                    Jz（亮度）分量，
                    如有需要经<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-5/#required-conversion"
                        id="ref-for-required-conversion④">转换</a>，转换至 jzczhz。
                    100 等价于 100%。</p>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="jzczhz()" data-dfn-type="value" data-export
                        id="valdef-jzczhz-c">c</dfn> 为 <a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①⑥">&lt;number></a>，对应<a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-color-5/#origin-color" id="ref-for-origin-color⑦">原色</a>的
                    Cz（色度），
                    如有需要经<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-5/#required-conversion"
                        id="ref-for-required-conversion⑤">转换</a>，转换至 jzczhz。
                    0.26 等价于 100%。</p>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="jzczhz()" data-dfn-type="value" data-export
                        id="valdef-jzczhz-h">h</dfn> 为 <a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①⑦">&lt;number></a>，对应<a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-color-5/#origin-color" id="ref-for-origin-color⑧">原色</a>的
                    hz（色相），以度为单位，
                    如有需要经<a data-link-type="dfn" href="https://drafts.csswg.org/css-color-5/#required-conversion"
                        id="ref-for-required-conversion⑥">转换</a>，转换至 jzczhz，
                    并归一到 [0, 360] 范围。90 即 90deg。</p>
            <li data-md>
                <p><dfn class="dfn-paneled css" data-dfn-for="jzczhz()" data-dfn-type="value" data-export
                        id="valdef-jzczhz-alpha">alpha</dfn> 为 <a class="production css" data-link-type="type"
                        href="https://www.w3.org/TR/css-values-4/#number-value"
                        id="ref-for-number-value①⑧">&lt;number></a>，对应<a data-link-type="dfn"
                        href="https://www.w3.org/TR/css-color-5/#origin-color" id="ref-for-origin-color⑨">原色</a>的 alpha
                    透明度。1.0 等价于 100%。</p>
        </ul>
        <h4 class="heading settled" data-level="6.5.1" id="Jzazbz-to-JzCzHz"><span class="secno">6.5.1. </span><span
                class="content"> <span class="css">Jzazbz</span> 颜色转 <span class="css">JzCzhz</span> 颜色</span><a
                class="self-link" href="#Jzazbz-to-JzCzHz"></a></h4>
        <p>转为 <span class="css">JzCzhz</span> 的过程十分简单：</p>
        <ol>
            <li>hz = atan2(bz, az) // 但需转换为度数！
            <li>Cz = sqrt(az^2 + bz^2)
            <li>Jz 保持不变
        </ol>
        <p>此外，实际代码应在 Cz 小于 ε 时返回<a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-color-4/#valdef-color-none" id="ref-for-valdef-color-none">none</a>。</p>
        <h4 class="heading settled" data-level="6.5.2" id="JzCzHz-to-Jzazbz"><span class="secno">6.5.2. </span><span
                class="content"> JzCzhz 颜色转 Jzazbz 颜色</span><a class="self-link" href="#JzCzHz-to-Jzazbz"></a></h4>
        <p>转为 <span class="css">Jzazbz</span> 的过程也十分简单：</p>
        <ol>
            <li>az = Cz cos(H) // H 需先转为弧度
            <li>bz = Cz sin(H) // H 需先转为弧度
            <li>Jz 保持不变
        </ol>
        <p>此外，实际代码应检测 hz 是否为<a class="css" data-link-type="maybe"
                href="https://www.w3.org/TR/css-color-4/#valdef-color-none" id="ref-for-valdef-color-none①">none</a>。
        </p>
        <h2 class="heading settled" data-level="7" id="color-function"><span class="secno">7. </span><span
                class="content"> 指定预定义与自定义色彩空间：<a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-5/#funcdef-color" id="ref-for-funcdef-color①">color()</a> 函数
            </span><a class="self-link" href="#color-function"></a></h2>
        <p><a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-5/#funcdef-color"
                id="ref-for-funcdef-color②">color()</a> 函数可以在指定的<a data-link-type="dfn"
                href="https://www.w3.org/TR/css-color-4/#color-space"
                id="ref-for-color-space">色彩空间</a>中（而非大多数其他色彩函数默认的隐式 sRGB 色彩空间）指定颜色。</p>
        <p>本规范扩展了 <a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-5/#funcdef-color"
                id="ref-for-funcdef-color③">color()</a> 函数，
            使其不限于<a href="#predefined-HDR">HDR 预定义色彩空间</a>，
            还可使用 <a href="https://www.w3.org/TR/css-color-4/#predefined"><cite>CSS Color 4</cite> §  10 预定义色彩空间</a>中的
            SDR 预定义空间及
            <a href="https://www.w3.org/TR/css-color-5/#relative-colors"><cite>CSS Color 5</cite> § 4 相对颜色</a>的相对色彩语法。
        </p>
        <p>现有语法如下：</p>
        <pre class="prod"><dfn class="dfn-paneled" data-dfn-type="type" data-export id="typedef-predefined-rgb">&lt;predefined-rgb></dfn> = srgb <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③⑥">|</a> srgb-linear <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③⑦">|</a> display-p3 <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③⑧">|</a> display-p3-linear <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one③⑨">|</a> a98-rgb <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one④⓪">|</a> prophoto-rgb <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one④①">|</a> rec2020 <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one④②">|</a> 
  rec2100-pq <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one④③">|</a> rec2100-hlg <a data-link-type="grammar" href="https://www.w3.org/TR/css-values-4/#comb-one" id="ref-for-comb-one④④">|</a> rec2100-linear
</pre>
        <h2 class="heading settled" data-level="8" id="predefined-HDR"><span class="secno">8. </span><span
                class="content">HDR 预定义色彩空间：</span><a class="self-link" href="#predefined-HDR"></a>
        </h2>
        <p>除了 CSS Color 4 定义的 <a href="https://drafts.csswg.org/css-color-4/#predefined">SDR
                色彩空间</a> 外，以下 HDR 色彩空间也被定义，可在 color 函数中使用。</p>
        <p>这些新色彩空间的序列化值与 <a href="https://www.w3.org/TR/css-color-4/#serializing-color-values"><cite>CSS Color 4</cite>
                §  15.
                序列化 &lt;color> 值</a> 中的描述完全一致。</p>
        <h3 class="heading settled" data-level="8.1" id="valdef-color-rec2100-pq"><span class="secno">8.1. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="rec2100-pq">rec2100-pq</dfn></span><a class="self-link" href="#valdef-color-rec2100-pq"></a>
        </h3>
        <p><span class="css">rec2100-pq</span> <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            色彩空间接受三个数值参数，
            分别代表颜色的红、绿、蓝通道，
            每个参数的有效范围为 [0, 1]，
            无论实际每分量的位深（10位或12位）。</p>
        <p>采用感知量化器（PQ）电光转换函数 <a data-link-type="biblio" href="#biblio-smpte-st-2084"
                title="ST 2084:2014 - SMPTE Standard - High Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays">[SMPTE-ST-2084]</a>,<a
                data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            PQ 假定参考观看条件下
            屏幕环境光为 5 cd/m²。</p>
        <p>ITU 参考 2100 标准用于 4K 和 8K HDR 电视。</p>
        <p>其主要特征如下：
            （显示器原色与 <a data-link-type="biblio" href="#biblio-rec2020"
                title="Recommendation  ITU-R  BT.2020-2:  Parameter values for ultra-high definition television systems for production and international programme exchange">[Rec.2020]</a>
            相同）：
        </p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>红色色度
                    <td>0.708
                    <td>0.292
                <tr>
                    <th>绿色色度
                    <td>0.170
                    <td>0.797
                <tr>
                    <th>蓝色色度
                    <td>0.131
                    <td>0.046
                <tr>
                    <th>白点色度
                    <td colspan="2"><a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#d65"
                            id="ref-for-d65⑤">D65</a>
                <tr>
                    <th>转移函数
                    <td colspan="2">感知量化器
                <tr>
                    <th>白色亮度
                    <td colspan="2">203 cd/m²
                <tr>
                    <th>峰值白亮度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黑色亮度
                    <td colspan="2">≤ 0.005 cd/m²
                <tr>
                    <th>图像状态
                    <td colspan="2">display-referred
                <tr>
                    <th>百分比
                    <td colspan="2">R、G、B 可用百分比
                <tr>
                    <th>百分比参考范围
                    <td>R、G、B: 0% = 0.0, 100% = 1.0
        </table>
        <p>对于在非参考观看环境下的窄范围 PQ 视频，
            或 HLG（在任意观看环境下），
            黑阶应通过 PLUGE 测试信号及其设定流程进行调整，详见 <a data-link-type="biblio" href="#biblio-rec_bt814"
                title="Specifications of PLUGE test signals and alignment procedures for setting of brightness and contrast of displays">[Rec_BT.814]</a>
            附录。
            对于 CSS 的 PQ 值（宽范围），
            黑色对应码值 0。</p>
        <div class="example" id="example-dbd71f8e">
            <a class="self-link" href="#example-dbd71f8e"></a> 此色代表 10,000 cd/m² 的炫目白色。
            如此高亮色只能在屏幕小范围短时显示。
            内容通常以较低峰值白（如 4,000 cd/m²）制作。
            <pre><span class="swatch oog" style="--color: white"></span> color(rec2100-pq 1.0 1.0 1.0);
</pre>
        </div>
        <div class="example" id="example-f604e8a3">
            <a class="self-link" href="#example-f604e8a3"></a> 此色为舒适的“漫反射白”，
            可长时间显示,
            或用于字幕，
            可用于屏幕任意面积。
            它与 sRGB 的 <a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                id="ref-for-valdef-color-white⑥">white</a> 相同。
            漫反射白为 203 cd/m² <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            <pre><span class="swatch" style="--color: white"></span> color(rec2100-pq 0.58 0.58 0.58);
</pre>
            <p>此色为中灰，
                类似摄影师常用的“18% 反射灰板”，
                亮度约 17 cd/m²。</p>
            <pre><span class="swatch" style="--color: rgb(46.632% 46.632% 46.632%)"></span> color(rec2100-pq 0.34 0.34 0.34)
</pre>
        </div>
        <p class="issue" id="issue-3762b88c"><a class="self-link" href="#issue-3762b88c"></a> 添加其他示例，包括 sRGB 红绿蓝和 P3
            红绿蓝的编码。</p>
        <p>线性光 RGB 信号按以下方式编码为 PQ。
            PQ 可编码的最大亮度为 10,000 cd/m²（峰值小面积白）。
            HDR 参考白为 203 cd/m² <a data-link-type="biblio" href="#biblio-rpt_bt2408"
                title="Report ITU-R BT.2408-0 Operational practices in HDR television production">[Rpt_BT.2408]</a>。</p>
        <pre class="lang-javascript highlight"><c- a>var</c-> Er<c- p>;</c->      <c- c1>// 红、绿或蓝分量，SDR范围[0, 1]，HDR可至70左右</c->
<c- a>var</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c->  <c- c1>// 漫反射白亮度，单位cd/m²</c->
<c- a>var</c-> x <c- o>=</c-> Er <c- o>*</c-> Yw <c- o>/</c-> <c- mf>10000</c-><c- p>;</c->   <c- c1>// 峰值白亮度为10,000cd/m²</c->
<c- a>const</c-> n <c- o>=</c-> <c- mf>2610</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>);</c->
<c- a>const</c-> m <c- o>=</c-> <c- mf>2523</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>);</c->
<c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>);</c->
<c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
<c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
xPQ <c- o>=</c-> <c- p>(((</c->c1 <c- o>+</c-> <c- p>(</c->c2 <c- o>*</c-> <c- p>(</c->x <c- o>**</c-> n<c- p>)))</c-> <c- o>/</c-> <c- p>(</c-><c- mf>1</c-> <c- o>+</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->x <c- o>**</c-> n<c- p>))))</c-> <c- o>**</c-> m<c- p>);</c->

</pre>
        <p>xPQ 是“伽玛校正”（OETF校正）信号，范围[0, 1]。</p>
        <p>PQ 编码值还原为线性光过程如下：</p>
        <pre class="lang-javascript highlight"><c- a>var</c-> xPQ<c- p>;</c->      <c- c1>// PQ编码的红绿蓝分量，[0, 1]</c->
<c- a>const</c-> ninv <c- o>=</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2610</c-><c- p>;</c->
<c- a>const</c-> minv <c- o>=</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2523</c-><c- p>;</c->
<c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>);</c->
<c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
<c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
<c- a>var</c-> x <c- o>=</c-> <c- p>(</c->(Math<c- p>.</c->max<c- p>(((</c->xPQ <c- o>**</c-> minv<c- p>)</c-> <c- o>-</c-> c1<c- p>),</c-> <c- mf>0</c-><c- p>)</c-> <c- o>/</c-> <c- p>(</c->c2 <c- o>-</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->xPQ <c- o>**</c-> minv<c- p>))))</c-> <c- o>**</c-> ninv<c- p>);</c->
<c- a>var</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c->      <c- c1>// 漫反射白亮度，cd/m²</c->
<c- a>var</c-> Ea <c- o>=</c-> x <c- o>*</c-> <c- mf>10000</c-><c- p>;</c->   <c- c1>// 亮度, [0, 10000]。</c->
<c- a>var</c-> Er <c- o>=</c-> x <c- o>*</c-> <c- mf>10000</c-> <c- o>/</c-> Yw<c- p>;</c->   <c- c1>// 相对漫反射白亮度, [0, 70左右]。</c->
</pre>
        <h3 class="heading settled" data-level="8.2" id="valdef-color-rec2100-hlg"><span class="secno">8.2. </span><span
                class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="rec2100-hlg">rec2100-hlg</dfn></span><a class="self-link" href="#valdef-color-rec2100-hlg"></a>
        </h3>
        <p><span class="css">rec2100-hlg</span> <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            色彩空间接受三个数值参数，
            代表颜色的红、绿、蓝通道，
            每个参数有效范围为 [0, 1]，
            无论分量实际位深。</p>
        <p>采用混合对数伽马（HLG）电光转换函数
            <a data-link-type="biblio" href="#biblio-arib_std-b67"
                title="Essential Parameter Values for the Extended Image Dynamic Range Television (EIDRTV) System for Programme Production">[ARIB_STD-B67]</a>,<a
                data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            HLG 可适用于不同亮度的显示器，
            并适配各种观看环境，
            用户可调整体亮度。
            0.75 代表“漫反射”或“媒体白”，
            “18% 反射灰板” 对应值为 0.38。<a data-link-type="biblio" href="#biblio-rec_bt2390"
                title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>。
        </p>
        <p>其主要特征如下：（显示器原色与 <a data-link-type="biblio" href="#biblio-rec2020"
                title="Recommendation  ITU-R  BT.2020-2:  Parameter values for ultra-high definition television systems for production and international programme exchange">[Rec.2020]</a>
            相同）</p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>红色色度
                    <td>0.708
                    <td>0.292
                <tr>
                    <th>绿色色度
                    <td>0.170
                    <td>0.797
                <tr>
                    <th>蓝色色度
                    <td>0.131
                    <td>0.046
                <tr>
                    <th>白点色度
                    <td colspan="2"><a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#d65"
                            id="ref-for-d65⑥">D65</a>
                <tr>
                    <th>转移函数
                    <td colspan="2">混合对数伽马
                <tr>
                    <th>白色亮度
                    <td colspan="2">取决于观看环境
                <tr>
                    <th>峰值白亮度
                    <td colspan="2">为参考白的 12 倍
                <tr>
                    <th>黑色亮度
                    <td colspan="2">取决于参考白，见正文
                <tr>
                    <th>图像状态
                    <td colspan="2">scene-referred
                <tr>
                    <th>百分比
                    <td colspan="2">R、G、B 可用百分比
                <tr>
                    <th>百分比参考范围
                    <td>R、G、B: 0% = 0.0, 100% = 1.0
        </table>
        <p>对于所有观看环境下的窄范围 HLG 视频，
            黑阶应通过 PLUGE 测试信号和设定流程调整，详见 <a data-link-type="biblio" href="#biblio-rec_bt814"
                title="Specifications of PLUGE test signals and alignment procedures for setting of brightness and contrast of displays">[Rec_BT.814]</a>
            附录 4。</p>
        <p>对于 CSS 下的 HLG 值（宽范围），
            黑色对应码值 0。</p>
        <p class="issue" id="issue-63bd5f3d"><a class="self-link" href="#issue-63bd5f3d"></a> 添加其他示例</p>
        <div class="example" id="example-8d914a69">
            <a class="self-link" href="#example-8d914a69"></a> 该色为舒适的“漫反射白”，
            可长时间显示，
            也可用于字幕，
            也适用于屏幕任意面积。
            内容往往以 1,000~4,000 cd/m² 的峰值白母带制作，
            因而漫反射白对应 203~581 cd/m²。
            <pre><span class="swatch" style="--color: white"></span> color(rec2100-hlg 0.75 0.75 0.75);
</pre>
            <p>此色为中灰，
                亮度处于 26~104 cd/m²。</p>
            <pre><span class="swatch" style="--color: rgb(46.632% 46.632% 46.632%)"></span> color(rec2100-hlg 0.38 0.38 0.38)
</pre>
        </div>
        <p>线性光 RGB 信号到 HLG 编码的方式如下 <a data-link-type="biblio" href="#biblio-rec_bt2390"
                title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>：
        </p>
        <pre class="lang-javascript highlight"><c- a>var</c-> E<c- p>;</c->      <c- c1>// 红绿蓝分量, [0, 1]</c->
<c- a>const</c-> a <c- o>=</c-> <c- mf>0.17883277</c-><c- p>;</c->
<c- a>const</c-> b <c- o>=</c-> <c- mf>0.28466892</c-><c- p>;</c->   <c- c1>// 1 - (4 * a)</c->
<c- a>const</c-> c <c- o>=</c-> <c- mf>0.55991073</c-><c- p>;</c->   <c- c1>// 0.5 - a * Math.log(4 *a)</c->
<c- c1>// 处理负数值</c->
<c- a>var</c-> sign <c- o>=</c-> E <c- o>&lt;</c-> <c- mf>0</c-><c- o>?</c-> <c- o>-</c-><c- mf>1</c-> <c- o>:</c-> <c- mf>1</c-><c- p>;</c->
<c- a>var</c-> abs <c- o>=</c-> Math<c- p>.</c->abs<c- p>(</c->E<c- p>);</c->
<c- k>if</c-> <c- p>(</c->abs <c- o>&lt;=</c-> <c- mf>1</c-><c- o>/</c-><c- mf>12</c-><c- p>)</c-> <c- p>{</c->
  Edash <c- o>=</c-> sign <c- o>*</c-> Math<c- p>.</c->sqrt<c- p>(</c-> <c- mf>3</c-> <c- o>*</c-> abs<c- p>);</c->
<c- p>}</c->
<c- k>else</c-> <c- p>{</c->
  Edash <c- o>=</c-> a <c- o>*</c-> Math<c- p>.</c->log<c- p>(</c-><c- mf>12</c-> <c- o>*</c-> E <c- o>-</c-> b<c- p>)</c-> <c- o>+</c-> c<c- p>;</c->
<c- p>}</c->
</pre>
        <p>Edash 为“伽玛校正”（OETF 校正）信号。</p>
        <p>HLG 解码还原到线性光如下 <a data-link-type="biblio" href="#biblio-rec_bt2390"
                title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>：
        </p>
        <pre class="lang-javascript highlight"><c- a>var</c-> Edash<c- p>;</c->      <c- c1>// 编码红绿蓝分量, [0, 1]</c->
<c- a>const</c-> a <c- o>=</c-> <c- mf>0.17883277</c-><c- p>;</c->
<c- a>const</c-> b <c- o>=</c-> <c- mf>0.28466892</c-><c- p>;</c->   <c- c1>// 1 - (4 * a)</c->
<c- a>const</c-> c <c- o>=</c-> <c- mf>0.55991073</c-><c- p>;</c->   <c- c1>// 0.5 - a * Math.log(4 *a)</c->
<c- k>if</c-> <c- p>(</c->Edash <c- o>&lt;=</c-> <c- mf>0.5</c-><c- p>)</c-> <c- p>{</c->
  E <c- o>=</c-> <c- p>(</c->Edash <c- o>**</c-> <c- mf>2</c-><c- p>)</c-> <c- o>/</c-> <c- mf>3</c-><c- p>;</c->
<c- p>}</c->
<c- k>else</c-> <c- p>{</c->
  E <c- o>=</c-> <c- p>(</c->Math<c- p>.</c->exp<c- p>((</c->Edash <c- o>-</c-> c<c- p>)</c-> <c- o>/</c-> a<c- p>)</c-> <c- o>+</c-> b<c- p>)</c-> <c- o>/</c-> <c- mf>12</c-><c- p>;</c->
<c- p>}</c->
</pre>
        <p class="issue" id="issue-fb589d17"><a class="self-link" href="#issue-fb589d17"></a> 是否要加入黑电平提升 Β，如同页所定义？</p>
        <h3 class="heading settled" data-level="8.3" id="valdef-color-rec2100-linear"><span class="secno">8.3.
            </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-export
                    id="rec2100-linear">rec2100-linear</dfn></span><a class="self-link"
                href="#valdef-color-rec2100-linear"></a></h3>
        <p><span class="css">rec2100-linear</span> <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            色彩空间接受三个数值参数，
            代表红、绿、蓝三通道，
            每个分量标称范围为[0, 1]，
            不受分量位深影响。</p>
        <p>红、绿、蓝全为 1.0
            表示<a data-link-type="dfn" href="#hdr-reference-white" id="ref-for-hdr-reference-white①">HDR
                参考白</a>，亮度为
            203 cd/m²。</p>
        <pre
            class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>1</c-> <c- m>1</c-> <c- m>1</c-><c- p>)</c-></pre>
        <div class="example" id="example-bda29122">
            <a class="self-link" href="#example-bda29122"></a> 例如，以下颜色：
            <pre
                class="lang-css highlight"><c- nf>color</c-><c- p>(</c->rec2100-linear <c- m>9.852</c-> <c- m>9.852</c-> <c- m>9.852</c-><c- p>)</c-></pre>
            <p>表示
                亮度为 9.852 × 203 = 1,999 cd/m² 的白色高光。</p>
        </div>
        <div class="example" id="example-071a1469">
            <a class="self-link" href="#example-071a1469"></a> 此色为舒适的“漫反射白”，
            可长时间显示，
            或做字幕使用，
            适合屏幕任意区域。
            与 sRGB 的 <a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-4/#valdef-color-white"
                id="ref-for-valdef-color-white⑦">white</a> 相同。
            漫反射白为 203 cd/m² <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>。
            <pre><span class="swatch" style="--color: white"></span> color(rec2100-linear 1 1 1)
</pre>
        </div>
        <p>采用线性光电-光转换函数。</p>
        <p>主要特征如下：（显示器原色与 <a data-link-type="biblio" href="#biblio-rec2020"
                title="Recommendation  ITU-R  BT.2020-2:  Parameter values for ultra-high definition television systems for production and international programme exchange">[Rec.2020]</a>
            相同）：</p>
        <table>
            <thead>
                <tr>
                    <td>
                    <td>x
                    <td>y
            <tbody>
                <tr>
                    <th>红色色度
                    <td>0.708
                    <td>0.292
                <tr>
                    <th>绿色色度
                    <td>0.170
                    <td>0.797
                <tr>
                    <th>蓝色色度
                    <td>0.131
                    <td>0.046
                <tr>
                    <th>白点色度
                    <td colspan="2"><a data-link-type="dfn" href="https://www.w3.org/TR/css-color-4/#d65"
                            id="ref-for-d65⑦">D65</a>
                <tr>
                    <th>转移函数
                    <td colspan="2">线性
                <tr>
                    <th>白色亮度
                    <td colspan="2">203 cd/m²
                <tr>
                    <th>峰值白亮度
                    <td colspan="2">10,000 cd/m²
                <tr>
                    <th>黑色亮度
                    <td colspan="2">0.001 cd/m²
                <tr>
                    <th>图像状态
                    <td colspan="2">display-referred
                <tr>
                    <th>百分比
                    <td colspan="2">R、G、B 可用百分比
                <tr>
                    <th>百分比参考范围
                    <td>R、G、B: 0% = 0.0, 100% = 1.0
        </table>
        <h2 class="heading settled" data-level="9" id="Compositing-SDR-HDR"><span class="secno">9. </span><span
                class="content">SDR 与 HDR 内容合成</span><a class="self-link" href="#Compositing-SDR-HDR"></a></h2>
        <p>内容合成应在 CIE XYZ 空间进行，
            因其为线性光空间，无色域限制。
            实现也可以选择在线性光 RGB 空间混合，
            只要正确处理超色域值（负数或超过100%），
            并确保直到最终转到设备色域时才裁剪或映射。</p>
        <p>使用 HLG 转换的 HDR，
            必须将 SDR HDR 参考白
            映射到 HLG 0.75 的亮度。 <a data-link-type="biblio" href="#biblio-smpte-st-2084"
                title="ST 2084:2014 - SMPTE Standard - High Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays">[SMPTE-ST-2084]</a>
        </p>
        <p>更多细节见 ITU Rpt_BT.2408-0 第 3 与第 4 表格 <a data-link-type="biblio" href="#biblio-rpt_bt2408"
                title="Report ITU-R BT.2408-0 Operational practices in HDR television production">[Rpt_BT.2408]</a></p>
        <p>使用 PQ 转换的 HDR，
            应将 SDR 的 HDR 参考白
            映射到 203 cd/m²，即显示 PQ 0.58 的亮度。 <a data-link-type="biblio" href="#biblio-smpte-st-2084"
                title="ST 2084:2014 - SMPTE Standard - High Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays">[SMPTE-ST-2084]</a>。
        </p>
        <p>不过，实现可以选择引入
            色彩重渲染，
            以适应非参考观看条件。</p>
        <h2 class="heading settled" data-level="10" id="serializing-color-values"><span class="secno">10. </span><span
                class="content"> 序列化 <a class="production css" data-link-type="type"
                    href="https://www.w3.org/TR/css-color-5/#typedef-color" id="ref-for-typedef-color⑥">&lt;color></a>
                值</span><a class="self-link" href="#serializing-color-values"></a></h2>
        <h3 class="heading settled" data-level="10.1" id="serializing-color-function-values"><span class="secno">10.1.
            </span><span class="content"> 序列化 <a class="css" data-link-type="maybe"
                    href="https://www.w3.org/TR/css-color-5/#funcdef-color" id="ref-for-funcdef-color④">color()</a>
                函数值</span><a class="self-link" href="#serializing-color-function-values"></a></h3>
        <p>本节扩展了 <a href="https://www.w3.org/TR/css-color-4/#serializing-color-function-values"><cite>CSS
                    Color 4</cite> § 15.5 color() 函数值序列化</a></p>
        <p><a class="css" data-link-type="maybe" href="https://www.w3.org/TR/css-color-5/#funcdef-color"
                id="ref-for-funcdef-color⑤">color()</a> 值的序列化形式
            来源于<a data-link-type="dfn" href="https://www.w3.org/TR/css-cascade-5/#computed-value"
                id="ref-for-computed-value">计算值</a>，采用 <span class="css" id="ref-for-funcdef-color⑥">color()</span> 语法，
            函数名及色彩空间名均采用 <a href="https://infra.spec.whatwg.org/#ascii-lowercase">ASCII 小写字母</a>。</p>
        <p>分量值采用十进制序列化，
            格式为 <a class="production css" data-link-type="type" href="https://www.w3.org/TR/css-values-4/#number-value"
                id="ref-for-number-value①⑨">&lt;number></a>。
            各分量间，以及色彩空间名和首个色值间，
            均用单个 ASCII 空格分隔。</p>
        <p>HDR 预定义色彩空间的往返<em>最低</em>精度如下：</p>
        <table class="data" id="predefined-precision-table">
            <tbody>
                <tr>
                    <th>HDR 色彩空间
                    <th>最小位数
                <tr>
                    <td><span class="css">rec2100-pq</span>, <span class="css">rec2100-hlg</span>
                    <td>10
                <tr>
                    <td><span class="css">rec2100-linear</span>, <span class="css">jzazbz</span>, <span
                            class="css">jzczhz</span>, <span class="css">ictcp</span>
                    <td>16
        </table>
        <p>（建议内部存储使用 16 位、half-float 或 float <em>每个分量</em>）。
            值必须<a href="https://drafts.csswg.org/css-values-4/#combine-integers">向 +∞ 舍入</a>，不得直接截断。</p>
        <h2 class="heading settled" data-level="11" id="color-conversion-code"><span class="secno">11. </span><span
                class="content"> 颜色转换示例代码</span><a class="self-link" href="#color-conversion-code"></a></h2>
        <p><em>本节为非规范性内容。</em></p>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>测试</summary>
            <p>本节为非规范性内容，不需要测试。</p>
            <ul class="wpt-tests-list"></ul>
            <hr>
        </details>
        <p>为清晰起见，使用了用于矩阵乘法的<a href="https://drafts.csswg.org/css-color-4/multiply-matrices.js">一个库</a>。
            （这比将所有乘法与加法内联更易读）。
            矩阵采用<a
                href="https://www.scratchapixel.com/lessons/mathematics-physics-for-computer-graphics/geometry/row-major-vs-column-major-vector">列主序</a>。
        </p>
        <p>本代码还假设已提供自 <a href="https://www.w3.org/TR/css-color-4/#color-conversion-code"><cite>CSS Color 4</cite> §  18.
                颜色转换示例代码</a> 的全部转换代码。</p>
        <p><span class="css">Jzazbz</span> 中使用的 LMS 与 <span class="css">ICtCp</span> 中使用的不同，
            请务必使用正确的版本！</p>
        <h3 class="heading settled" data-level="11.1" id="rec2100-linear_code"><span class="secno">11.1. </span><span
                class="content"> <span class="css">rec2100-linear</span> 示例代码 </span><a class="self-link"
                href="#rec2100-linear_code"></a></h3>
        <p>BT.2020 与 BT.2100 色彩空间使用相同的 RGB 原色与白点，且二者都将 HDR 参考白置于分量值 1.0。</p>
        <pre class="include-code highlight"><c- c1>// 这些函数使用了 CSS Color 4 中的颜色转换函数</c->

<c- a>function</c-> XYZ_to_lin_2100<c- p>(</c->XYZ<c- p>)</c-> <c- p>{</c->
    <c- c1>// 将 D65 XYZ 数组转换为线性光 BT.2100 RGB</c->
    <c- c1>// 使得 [0,0,0] 为黑色，[1,1,1] 为媒体白</c->
    <c- c1>// 大于 1 的分量值表示 HDR 颜色</c->

    <c- k>return</c->  XYZ_to_lin_2020<c- p>(</c->XYZ<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> lin_2100_to_XYZ<c- p>(</c->RGB<c- p>)</c-> <c- p>{</c->
    <c- c1>// 将线性光 BT.2100 RGB 数组</c->
    <c- c1>// 转换为 D65 XYZ</c->

    <c- k>return</c-> lin_2020_to_XYZ<c- p>(</c->RGB<c- p>);</c->
<c- p>}</c-></pre>
        <h3 class="heading settled" data-level="11.2" id="rec2100-pq_code"><span class="secno">11.2. </span><span
                class="content"> <span class="css">rec2100-pq</span> 示例代码 </span><a class="self-link"
                href="#rec2100-pq_code"></a></h3>
        <pre class="include-code highlight"><c- a>function</c-> XYZ_to_pq_2100<c- p>(</c->XYZ<c- p>)</c-> <c- p>{</c->
    <c- c1>// 将 D65 XYZ 数组转换为 PQ 编码的 BT.2100 RGB</c->
    <c- c1>// 使得 [0,0,0] 为黑色，[1,1,1] 为 10,000 cd/m^2 的白；</c->
    <c- c1>// 媒体白约为 [0.5807,0.5807,0.5807]（四位有效数字）</c->

    <c- a>let</c-> linRGB <c- o>=</c-> XYZ_to_lin_2100<c- p>(</c->XYZ<c- p>);</c->
    <c- k>return</c-> pq_encode<c- p>(</c->linRGB<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> pq_2100_to_XYZ<c- p>(</c->RGB<c- p>)</c-> <c- p>{</c->
    <c- c1>// 将 PQ 编码的 BT.2100 RGB 数组</c->
    <c- c1>// 转换为 D65 XYZ</c->

    <c- a>let</c-> linRGB <c- o>=</c-> pq_decode<c- p>(</c->RGB<c- p>);</c->
    <c- k>return</c-> lin_2100_to_XYZ<c- p>(</c->linRGB<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> pq_encode<c- p>(</c->RGB<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c->    <c- c1>// 媒体白的绝对亮度，cd/m²</c->
    <c- a>const</c-> n <c- o>=</c-> <c- mf>2610</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>);</c->
    <c- a>const</c-> m <c- o>=</c-> <c- mf>2523</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>);</c->
    <c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>);</c->
    <c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
    <c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->

    <c- c1>// 给定范围 [0, 1] 的 PQ 编码分量</c->
    <c- c1>// 返回相对于媒体白的线性光值</c->
    <c- k>return</c-> RGB<c- p>.</c->map<c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
        <c- a>let</c-> x <c- o>=</c-> Math<c- p>.</c->max<c- p>(</c->val <c- o>*</c-> Yw <c- o>/</c-> <c- mf>10000</c-><c- p>,</c-> <c- mf>0</c-><c- p>);</c->     <c- c1>// 峰值白的绝对亮度为 10,000 cd/m²</c->
        <c- a>let</c-> num <c- o>=</c-> <c- p>(</c->c1 <c- o>+</c-> <c- p>(</c->c2 <c- o>*</c-> <c- p>(</c->x <c- o>**</c-> n<c- p>)));</c->
        <c- a>let</c-> denom <c- o>=</c-> <c- p>(</c-><c- mf>1</c-> <c- o>+</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->x <c- o>**</c-> n<c- p>)));</c->

        <c- k>return</c-> <c- p>((</c->num <c- o>/</c-> denom<c- p>)</c->  <c- o>**</c-> m<c- p>);</c->
    <c- p>});</c->
<c- p>}</c->

<c- a>function</c-> pq_decode<c- p>(</c->RGB<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c->    <c- c1>// 媒体白的绝对亮度，cd/m²</c->
    <c- a>const</c-> ninv <c- o>=</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2610</c-><c- p>;</c->
    <c- a>const</c-> minv <c- o>=</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2523</c-><c- p>;</c->
    <c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>);</c->
    <c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
    <c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->

    <c- c1>// 给定范围 [0, 1] 的 PQ 编码分量</c->
    <c- c1>// 返回相对于媒体白的线性光值</c->
    <c- k>return</c-> RGB<c- p>.</c->map<c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
        <c- a>let</c-> x <c- o>=</c-> <c- p>((</c->Math<c- p>.</c->max<c- p>(((</c->val <c- o>**</c-> minv<c- p>)</c-> <c- o>-</c-> c1<c- p>),</c-> <c- mf>0</c-><c- p>)</c-> <c- o>/</c-> <c- p>(</c->c2 <c- o>-</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->val <c- o>**</c-> minv<c- p>))))</c-> <c- o>**</c-> ninv<c- p>);</c->
        <c- k>return</c-> <c- p>(</c->x <c- o>*</c-> <c- mf>10000</c-> <c- o>/</c-> Yw<c- p>);</c->     <c- c1>// 相对于漫反射白的亮度，[0，约 70]</c->
    <c- p>});</c->
<c- p>}</c-></pre>
        <h3 class="heading settled" data-level="11.3" id="rec2100-hlg_code"><span class="secno">11.3. </span><span
                class="content"> <span class="css">rec2100-hlg</span> 示例代码 </span><a class="self-link"
                href="#rec2100-hlg_code"></a></h3>
        <pre class="include-code highlight"><c- a>function</c-> XYZ_to_hlg_2100<c- p>(</c->XYZ<c- p>)</c-> <c- p>{</c->
    <c- c1>// 将 D65 XYZ 数组转换为 HLG 编码的 BT.2100 RGB</c->
    <c- c1>// 使得 [0,0,0] 为黑色，[0.75,0.75,0.75] 为媒体白</c->

    <c- a>let</c-> linRGB <c- o>=</c-> XYZ_to_lin_2100<c- p>(</c->XYZ<c- p>);</c->
    <c- k>return</c-> hlg_encode<c- p>(</c->linRGB<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> hlg_2100_to_XYZ<c- p>(</c->RGB<c- p>)</c-> <c- p>{</c->
    <c- c1>// 将 PQ 编码的 BT.2100 RGB 数组</c->
    <c- c1>// 转换为 D65 XYZ</c->

    <c- a>let</c-> linRGB <c- o>=</c-> hlg_decode<c- p>(</c->RGB<c- p>);</c->
    <c- k>return</c-> lin_2100_to_XYZ<c- p>(</c->linRGB<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> hlg_encode<c- p>(</c->RGB<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> a <c- o>=</c-> <c- mf>0.17883277</c-><c- p>;</c->
    <c- a>const</c-> b <c- o>=</c-> <c- mf>0.28466892</c-><c- p>;</c-> <c- c1>// 1 - (4 * a)</c->
    <c- a>const</c-> c <c- o>=</c-> <c- mf>0.55991073</c-><c- p>;</c-> <c- c1>// 0.5 - a * Math.log(4 *a)</c->
    <c- a>const</c-> scale <c- o>=</c-> <c- mf>3.7743</c-><c- p>;</c->    <c- c1>// 将 18% 灰置于 HLG 0.38，从而媒体白为 0.75</c->

    <c- k>return</c-> RGB<c- p>.</c->map<c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
        <c- c1>// 先缩放，使线性光媒体白位于 1/3</c->
        val <c- o>/=</c-> scale<c- p>;</c->
        <c- c1>// 然后应用 HLG OETF</c->
        <c- c1>// ITU-R BT.2390-10 第 23 页</c->
        <c- c1>// 6.1 HLG 光电传递函数（OETF）</c->
        <c- k>if</c-> <c- p>(</c->val <c- o>&lt;=</c-> <c- mf>1</c-> <c- o>/</c-> <c- mf>12</c-><c- p>)</c-> <c- p>{</c->
            <c- k>return</c-> spow<c- p>(</c-><c- mf>3</c-> <c- o>*</c-> val<c- p>,</c-> <c- mf>0.5</c-><c- p>);</c->
        <c- p>}</c->
        <c- k>return</c-> a <c- o>*</c-> Math<c- p>.</c->log<c- p>(</c-><c- mf>12</c-> <c- o>*</c-> val <c- o>-</c-> b<c- p>)</c-> <c- o>+</c-> c<c- p>;</c->
    <c- p>});</c->
<c- p>}</c->

<c- a>function</c-> hlg_decode<c- p>(</c->RGB<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> a <c- o>=</c-> <c- mf>0.17883277</c-><c- p>;</c->
    <c- a>const</c-> b <c- o>=</c-> <c- mf>0.28466892</c-><c- p>;</c-> <c- c1>// 1 - (4 * a)</c->
    <c- a>const</c-> c <c- o>=</c-> <c- mf>0.55991073</c-><c- p>;</c-> <c- c1>// 0.5 - a * Math.log(4 *a)</c->
    <c- a>const</c-> scale <c- o>=</c-> <c- mf>3.7743</c-><c- p>;</c->    <c- c1>// 将 18% 灰置于 HLG 0.38，从而媒体白为 0.75</c->

    <c- k>return</c-> RGB<c- p>.</c->map<c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
        <c- c1>// 先应用 HLG EOTF</c->
        <c- c1>// ITU-R BT.2390-10 第 30 页</c->
        <c- c1>// 6.3 HLG 电光传递函数（EOTF）</c->
        <c- c1>// 然后乘以 scale，使媒体白为 1.0</c->
        <c- k>if</c-> <c- p>(</c->val <c- o>&lt;=</c-> <c- mf>0.5</c-><c- p>)</c-> <c- p>{</c->
            <c- k>return</c-> <c- p>(</c->val <c- o>**</c-> <c- mf>2</c-><c- p>)</c-> <c- o>/</c-> <c- mf>3</c-> <c- o>*</c-> scale<c- p>;</c->
        <c- p>}</c->
        <c- k>return</c-> <c- p>((</c->Math<c- p>.</c->exp<c- p>((</c->val <c- o>-</c-> c<c- p>)</c-> <c- o>/</c-> a<c- p>)</c-> <c- o>+</c-> b<c- p>)</c-> <c- o>/</c-> <c- mf>12</c-><c- p>)</c-> <c- o>*</c-> scale<c- p>;</c->
    <c- p>});</c->
<c- p>}</c->

<c- a>function</c-> spow <c- p>(</c->base<c- p>,</c-> exp<c- p>)</c-> <c- p>{</c->
    <c- a>let</c-> sign <c- o>=</c-> base <c- o>&lt;</c-> <c- mf>0</c-><c- o>?</c-> <c- o>-</c-><c- mf>1</c-> <c- o>:</c-> <c- mf>1</c-><c- p>;</c->
    <c- k>return</c-> sign <c- o>*</c-> <c- p>(</c->Math<c- p>.</c->abs<c- p>(</c->base<c- p>)</c-> <c- o>**</c-> exp<c- p>);</c->
<c- p>}</c-></pre>
        <h3 class="heading settled" data-level="11.4" id="jzazbz_code"><span class="secno">11.4. </span><span
                class="content"> <span class="css">jzazbz</span> 示例代码 </span><a class="self-link"
                href="#jzazbz_code"></a></h3>
        <p>这里复用上文定义的带符号幂函数（spow）。</p>
        <pre class="include-code highlight"><c- a>function</c-> XYZ_to_Jzazbz <c- p>(</c->XYZ<c- p>)</c-> <c- p>{</c->
    <c- c1>// 将 D65 XYZ 数组转换为 JzAzBz</c->
    <c- c1>// 使得 [0,0,0] 为黑色，</c->
    <c- c1>// 媒体白为 [0.2220, -0.00016, -0.0001]</c->

    <c- a>const</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c-> <c- c1>// 媒体白的绝对亮度</c->
    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c->  <c- mf>0.41478972</c-><c- p>,</c-> <c- mf>0.579999</c-><c- p>,</c->  <c- mf>0.0146480</c-> <c- p>],</c->
        <c- p>[</c-> <c- o>-</c-><c- mf>0.2015100</c-><c- p>,</c->  <c- mf>1.120649</c-><c- p>,</c->  <c- mf>0.0531008</c-> <c- p>],</c->
        <c- p>[</c-> <c- o>-</c-><c- mf>0.0166008</c-><c- p>,</c->  <c- mf>0.264800</c-><c- p>,</c->  <c- mf>0.6684799</c-> <c- p>],</c->
    <c- p>];</c->
    <c- a>const</c-> b <c- o>=</c-> <c- mf>1.15</c-><c- p>;</c->
    <c- a>const</c-> g <c- o>=</c-> <c- mf>0.66</c-><c- p>;</c->

    <c- c1>// 先将 XYZ 转换为绝对值（非媒体白相对）</c->
    <c- c1>// PQ 的最大亮度为 10,000 cd/m²</c->
    <c- c1>// BT.2048 指定媒体白 Y=203 cd/m²</c->
    <c- a>let</c-> <c- p>[</c->Xa<c- p>,</c-> Ya<c- p>,</c-> Za<c- p>]</c-> <c- o>=</c-> XYZ<c- p>.</c->map<c- p>(</c->v <c- p>=></c-> v <c- o>*</c-> Yw<c- p>);</c->

    <c- c1>// 然后修正 X 与 Y，以减小蓝色曲率</c->
    <c- a>let</c-> Xm <c- o>=</c-> b <c- o>*</c-> Xa <c- o>-</c-> <c- p>(</c->b <c- o>-</c-> <c- mf>1</c-><c- p>)</c-> <c- o>*</c-> Za<c- p>;</c->
    <c- a>let</c-> Ym <c- o>=</c-> g <c- o>*</c-> Ya <c- o>-</c-> <c- p>(</c->g <c- o>-</c-> <c- mf>1</c-><c- p>)</c-> <c- o>*</c-> Xa<c- p>;</c->

    <c- c1>// 进入 LMS 锥体域</c->
    <c- a>let</c-> LMS <c- o>=</c-> multiplyMatrices<c- p>(</c->M<c- p>,</c-> <c- p>[</c->Xm<c- p>,</c-> Ym<c- p>,</c-> Za<c- p>]);</c->
    <c- k>return</c-> LMStoJzazbz<c- p>(</c->LMS<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> LMStoJzazbz<c- p>(</c->LMS<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c->  <c- mf>0.5</c-><c- p>,</c->       <c- mf>0.5</c-><c- p>,</c->       <c- mf>0</c->        <c- p>],</c->
        <c- p>[</c->  <c- mf>3.524000</c-><c- p>,</c-> <c- o>-</c-><c- mf>4.066708</c-><c- p>,</c->  <c- mf>0.542708</c-> <c- p>],</c->
        <c- p>[</c->  <c- mf>0.199076</c-><c- p>,</c->  <c- mf>1.096799</c-><c- p>,</c-> <c- o>-</c-><c- mf>1.295875</c-> <c- p>],</c->
    <c- p>];</c->
    <c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>;</c->
    <c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>;</c->
    <c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>;</c->
    <c- a>const</c-> n <c- o>=</c-> <c- mf>2610</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>;</c->
    <c- a>const</c-> p <c- o>=</c-> <c- p>(</c-><c- mf>1.7</c-> <c- o>*</c-> <c- mf>2523</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>;</c->    <c- c1>// 相比常规 PQ，使用 1.7 的缩放</c->
    <c- a>const</c-> d <c- o>=</c-> <c- o>-</c-><c- mf>0.56</c-><c- p>;</c->
    <c- a>const</c-> d0 <c- o>=</c-> <c- mf>1.6295499532821566e-11</c-><c- p>;</c->  <c- c1>// 极小偏移，将黑位回调至 0</c->


    <c- c1>// 对 LMS 进行 PQ 编码</c->
    <c- a>let</c-> PQLMS <c- o>=</c-> <c- p>(</c->
        LMS<c- p>.</c->map<c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
            <c- a>let</c-> num <c- o>=</c-> c1 <c- o>+</c-> c2 <c- o>*</c-> spow<c- p>((</c->val <c- o>/</c-> <c- mf>10000</c-><c- p>),</c-> n<c- p>);</c->
            <c- a>let</c-> denom <c- o>=</c-> <c- mf>1</c-> <c- o>+</c-> c3 <c- o>*</c-> spow<c- p>((</c->val <c- o>/</c-> <c- mf>10000</c-><c- p>),</c-> n<c- p>);</c->

            <c- k>return</c-> spow<c- p>((</c->num <c- o>/</c-> denom<c- p>),</c-> p<c- p>);</c->
        <c- p>})</c->
    <c- p>);</c->

    <c- c1>// 计算 Iz、az、bz</c->
    <c- a>let</c-> <c- p>[</c->Iz<c- p>,</c-> az<c- p>,</c-> bz<c- p>]</c-> <c- o>=</c-> multiplyMatrices<c- p>(</c->M<c- p>,</c-> PQLMS<c- p>);</c->
    <c- c1>// 由 Iz 求 Jz</c->
    <c- a>let</c-> Jz <c- o>=</c-> <c- p>((</c-><c- mf>1</c-> <c- o>+</c-> d<c- p>)</c-> <c- o>*</c-> Iz<c- p>)</c-> <c- o>/</c-> <c- p>(</c-><c- mf>1</c-> <c- o>+</c-> d <c- o>*</c-> Iz<c- p>)</c-> <c- o>-</c-> d0<c- p>;</c->
    <c- k>return</c-> <c- p>[</c->Jz<c- p>,</c-> az<c- p>,</c-> bz<c- p>];</c->
<c- p>}</c->

<c- a>function</c-> Jzazbz_to_XYZ <c- p>(</c->Jzazbz<c- p>)</c-> <c- p>{</c->
    <c- c1>// 将 JzAzBz 数组转换为 D65 XYZ</c->
    <c- c1>// 使得 [0,0,0] 为黑色，</c->
    <c- c1>// 媒体白为 [0.2220, -0.00016, -0.0001]</c->

    <c- a>const</c-> b <c- o>=</c-> <c- mf>1.15</c-><c- p>;</c->
    <c- a>const</c-> g <c- o>=</c-> <c- mf>0.66</c-><c- p>;</c->
    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c->  <c- mf>1.9242264357876067</c-><c- p>,</c->  <c- o>-</c-><c- mf>1.0047923125953657</c-><c- p>,</c->  <c- mf>0.037651404030618</c->   <c- p>],</c->
        <c- p>[</c->  <c- mf>0.35031676209499907</c-><c- p>,</c->  <c- mf>0.7264811939316552</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.06538442294808501</c-> <c- p>],</c->
        <c- p>[</c-> <c- o>-</c-><c- mf>0.09098281098284752</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.3127282905230739</c-><c- p>,</c->  <c- mf>1.5227665613052603</c->  <c- p>],</c->
    <c- p>];</c->

    <c- a>let</c-> LMS <c- o>=</c-> Jzazbz_to_LMS <c- p>(</c->Jzazbz<c- p>);</c->
    <c- c1>// 修正后的绝对 XYZ</c->
	<c- a>let</c-> <c- p>[</c->Xm<c- p>,</c-> Ym<c- p>,</c-> Za<c- p>]</c-> <c- o>=</c-> multiplyMatrices<c- p>(</c->LMS<c- p>,</c-> M<c- p>);</c->

    <c- c1>// 反向修正 X 与 Y，得到以媒体白为基准的 D65 XYZ</c->
    <c- a>let</c-> Xa <c- o>=</c-> <c- p>(</c->Xm <c- o>+</c-> <c- p>(</c->b <c- o>-</c-> <c- mf>1</c-><c- p>)</c-> <c- o>*</c-> Za<c- p>)</c-> <c- o>/</c-> b<c- p>;</c->
    <c- a>let</c-> Ya <c- o>=</c-> <c- p>(</c->Ym <c- o>+</c-> <c- p>(</c->g <c- o>-</c-> <c- mf>1</c-><c- p>)</c-> <c- o>*</c-> Xa<c- p>)</c-> <c- o>/</c-> g<c- p>;</c->
    <c- k>return</c-> <c- p>[</c->Xa<c- p>,</c-> Ya<c- p>,</c-> Za<c- p>];</c->
<c- p>}</c->

<c- a>function</c-> Jzazbz_to_LMS <c- p>(</c->Jzazbz<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> d <c- o>=</c-> <c- o>-</c-><c- mf>0.56</c-><c- p>;</c->
    <c- a>const</c-> d0 <c- o>=</c-> <c- mf>1.6295499532821566e-11</c-><c- p>;</c->
    <c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>;</c->
    <c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>;</c->
    <c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>;</c->
    <c- a>const</c-> pinv <c- o>=</c-> <c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-> <c- o>/</c-> <c- p>(</c-><c- mf>1.7</c-> <c- o>*</c-> <c- mf>2523</c-><c- p>);</c->
    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c-> <c- mf>1</c-><c- p>,</c->  <c- mf>0.13860504327153927</c-><c- p>,</c->   <c- mf>0.05804731615611883</c->  <c- p>],</c->
        <c- p>[</c-> <c- mf>1</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.1386050432715393</c-><c- p>,</c->   <c- o>-</c-><c- mf>0.058047316156118904</c-> <c- p>],</c->
        <c- p>[</c-> <c- mf>1</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.09601924202631895</c-><c- p>,</c->  <c- o>-</c-><c- mf>0.81189189605603900</c->  <c- p>],</c->
    <c- p>];</c->

    <c- a>let</c-> <c- p>[</c->Jz<c- p>,</c-> az<c- p>,</c-> bz<c- p>]</c-> <c- o>=</c-> Jzazbz<c- p>;</c->
	<c- a>let</c-> Iz <c- o>=</c-> <c- p>(</c->Jz <c- o>+</c-> d0<c- p>)</c-> <c- o>/</c-> <c- p>(</c-><c- mf>1</c-> <c- o>+</c-> d <c- o>-</c-> d <c- o>*</c-> <c- p>(</c->Jz <c- o>+</c-> d0<c- p>));</c->

    <c- c1>// 转至 LMS 锥体域</c->
	<c- a>let</c-> PQLMS <c- o>=</c-> multiplyMatrices<c- p>([</c->Iz<c- p>,</c-> az<c- p>,</c-> bz<c- p>],</c-> M<c- p>);</c->

    <c- c1>// 从 PQ 编码转换为线性光 LMS</c->
    <c- a>let</c-> LMS <c- o>=</c-> <c- p>(</c->
        PQLMS<c- p>.</c->map<c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
            <c- a>let</c-> num <c- o>=</c-> c1 <c- o>-</c-> spow<c- p>(</c->val<c- p>,</c-> pinv<c- p>);</c->
            <c- a>let</c-> denom <c- o>=</c-> c3 <c- o>*</c-> spow<c- p>(</c->val<c- p>,</c-> pinv<c- p>)</c-> <c- o>-</c-> c2<c- p>;</c->
            <c- a>let</c-> x <c- o>=</c-> <c- mf>10000</c-> <c- o>*</c-> spow<c- p>(</c->num <c- o>/</c-> denom<c- p>,</c-> ninv<c- p>);</c->

            <c- k>return</c-> x<c- p>;</c-> <c- c1>// 相对于漫反射白的亮度，[0，约 70]</c->
        <c- p>})</c->
    <c- p>);</c->
    <c- k>return</c-> LMS<c- p>;</c->
<c- p>}</c->
</pre>
        <h3 class="heading settled" data-level="11.5" id="ictcp_code"><span class="secno">11.5. </span><span
                class="content"> <span class="css">ICtCp</span> 示例代码 </span><a class="self-link" href="#ictcp_code"></a>
        </h3>
        <p>与其先转换到 <span class="css">rec2100-linear</span>
            （这是 <a data-link-type="biblio" href="#biblio-rec_bt2100"
                title="ITU-R BT.2100-3 Image parameter values for high dynamic range television for use in production and international programme exchange">[Rec_BT.2100]</a>
            中的定义方式），
            本示例直接从绝对 CIE XYZ 出发，
            以便与其他颜色转换代码保持一致。</p>
        <p>4% 串扰矩阵与色相旋转也被合并进 XYZ 到 LMS 的步骤中，
            而不是拆成三个独立步骤。</p>
        <p>最终结果相同，但步骤更少。</p>
        <pre class="include-code highlight">
<c- a>function</c-> XYZ_to_ICtCp <c- p>(</c->XYZ<c- p>)</c-> <c- p>{</c->
    <c- c1>// 将 D65 XYZ 数组转换为 ICtCp</c->

    <c- c1>// 下述矩阵包含 4% 串扰分量</c->
    <c- c1>// 来自杜比《What is ICtCp》文档中的流程</c->
    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c->  <c- mf>0.3592832590121217</c-><c- p>,</c->  <c- mf>0.6976051147779502</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.0358915932320290</c-> <c- p>],</c->
        <c- p>[</c-> <c- o>-</c-><c- mf>0.1920808463704993</c-><c- p>,</c->  <c- mf>1.1004767970374321</c-><c- p>,</c->  <c- mf>0.0753748658519118</c-> <c- p>],</c->
        <c- p>[</c->  <c- mf>0.0070797844607479</c-><c- p>,</c->  <c- mf>0.0748396662186362</c-><c- p>,</c->  <c- mf>0.8433265453898765</c-> <c- p>],</c->
    <c- p>];</c->

    <c- a>let</c-> LMS <c- o>=</c-> multiplyMatrices<c- p>(</c->M<c- p>,</c-> XYZ<c- p>.</c->map<c- p>(</c->v <c- p>=></c-> v <c- o>*</c-> Yw<c- p>));</c->
    <c- k>return</c-> LMStoICtCp<c- p>(</c->LMS<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> LMStoICtCp <c- p>(</c->LMS<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>;</c->
    <c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- mf>128</c-><c- p>;</c->
    <c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- mf>128</c-><c- p>;</c->
    <c- a>const</c-> m1 <c- o>=</c-> <c- mf>2610</c-> <c- o>/</c-> <c- mf>16384</c-><c- p>;</c->
    <c- a>const</c-> m2 <c- o>=</c-> <c- mf>2523</c-> <c- o>/</c-> <c- mf>32</c-><c- p>;</c->

    <c- c1>// 此矩阵包含 Ebner LMS 系数、</c->
    <c- c1>// 旋转以及到 [-0.5, 0.5] 范围的缩放</c->
    <c- c1>// 有理项参见 Fröhlich 第 97 页</c->
    <c- c1>// 以及 ITU-R BT.2124-0 第 2–3 页</c->
    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c->  <c- mf>2048</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>,</c->   <c- mf>2048</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>,</c->       <c- mf>0</c->      <c- p>],</c->
        <c- p>[</c->  <c- mf>6610</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>,</c-> <c- o>-</c-><c- mf>13613</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>,</c->  <c- mf>7003</c-> <c- o>/</c-> <c- mf>4096</c-> <c- p>],</c->
        <c- p>[</c-> <c- mf>17933</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>,</c-> <c- o>-</c-><c- mf>17390</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>,</c->  <c- o>-</c-><c- mf>543</c-> <c- o>/</c-> <c- mf>4096</c-> <c- p>],</c->
    <c- p>];</c->

    <c- c1>// 应用 PQ EOTF</c->
    <c- c1>// 值被缩放到 [0, 10,000] → [0, 1]</c->
    <c- c1>// 分母因带有 “1 +” 不会出现除零问题</c->
    <c- a>let</c-> PQLMS <c- o>=</c-> LMS<c- p>.</c->map <c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
        <c- a>let</c-> num <c- o>=</c-> c1 <c- o>+</c-> <c- p>(</c->c2 <c- o>*</c-> <c- p>((</c->val <c- o>/</c-> <c- mf>10000</c-><c- p>)</c-> <c- o>**</c-> m1<c- p>));</c->
        <c- a>let</c-> denom <c- o>=</c-> <c- mf>1</c-> <c- o>+</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>((</c->val <c- o>/</c-> <c- mf>10000</c-><c- p>)</c-> <c- o>**</c-> m1<c- p>));</c->

        <c- k>return</c-> <c- p>(</c->num <c- o>/</c-> denom<c- p>)</c->  <c- o>**</c-> m2<c- p>;</c->
    <c- p>});</c->

    <c- c1>// LMS → IPT，并包含与 Y'C'bC'r 兼容的旋转</c->
    <c- k>return</c-> multiplyMatrices<c- p>(</c->M<c- p>,</c-> PQLMS<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> ICtCp_to_XYZ <c- p>(</c->ICtCp<c- p>)</c-> <c- p>{</c->
    <c- c1>// 将 ICtCp 转换为绝对 D65 XYZ 数组</c->

    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c->  <c- mf>2.0701522183894223</c-><c- p>,</c-> <c- o>-</c-><c- mf>1.3263473389671563</c-><c- p>,</c->  <c- mf>0.2066510476294053</c-> <c- p>],</c->
        <c- p>[</c->  <c- mf>0.3647385209748072</c-><c- p>,</c->  <c- mf>0.6805660249472273</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.0453045459220347</c-> <c- p>],</c->
        <c- p>[</c-> <c- o>-</c-><c- mf>0.0497472075358123</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.0492609666966131</c-><c- p>,</c->  <c- mf>1.1880659249923042</c-> <c- p>],</c->
    <c- p>];</c->

    <c- a>let</c-> LMS <c- o>=</c-> ICtCptoLMS<c- p>(</c->ICtCp<c- p>);</c->
    <c- k>return</c-> multiplyMatrices<c- p>(</c->M<c- p>,</c-> LMS<c- p>);</c->
<c- p>}</c->

<c- a>function</c-> ICtCptoLMS <c- p>(</c->ICtCp<c- p>)</c-> <c- p>{</c->

    <c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- mf>4096</c-><c- p>;</c->
    <c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- mf>128</c-><c- p>;</c->
    <c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- mf>128</c-><c- p>;</c->
    <c- a>const</c-> im1 <c- o>=</c-> <c- mf>16384</c-> <c- o>/</c-> <c- mf>2610</c-><c- p>;</c->
    <c- a>const</c-> im2 <c- o>=</c-> <c- mf>32</c-> <c- o>/</c-> <c- mf>2523</c-><c- p>;</c->

    <c- a>const</c-> M <c- o>=</c-> <c- p>[</c->
        <c- p>[</c-> <c- mf>0.9999999999999998</c-><c- p>,</c->  <c- mf>0.0086090370379328</c-><c- p>,</c->  <c- mf>0.1110296250030260</c-> <c- p>],</c->
        <c- p>[</c-> <c->0.9999999999999998</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.0086090370379328</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.1110296250030259</c-> <c- p>],</c->
        <c- p>[</c-> <c- mf>0.9999999999999998</c-><c- p>,</c->  <c- mf>0.5600313357106791</c-><c- p>,</c-> <c- o>-</c-><c- mf>0.3206271749873188</c-> <c- p>],</c->
    <c- p>];</c->

    <c- a>let</c-> PQLMS <c- o>=</c-> multiplyMatrices<c- p>(</c->M<c- p>,</c-> ICtCp<c- p>);</c->

    <c- c1>// 撤销 PQ 编码，来源：BT.2124-0 附录 2 转换 3</c->
    <c- a>let</c-> LMS <c- o>=</c-> PQLMS<c- p>.</c->map <c- p>(</c-><c- a>function</c-> <c- p>(</c->val<c- p>)</c-> <c- p>{</c->
        <c- a>let</c-> num  <c- o>=</c-> Math<c- p>.</c->max<c- p>((</c->val <c- o>**</c-> im2<c- p>)</c-> <c- o>-</c-> c1<c- p>,</c-> <c- mf>0</c-><c- p>);</c->
        <c- a>let</c-> denom <c- o>=</c-> <c- p>(</c->c2 <c- o>-</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->val <c- o>**</c-> im2<c- p>)));</c->
        <c- k>return</c-> <c- mf>10000</c-> <c- o>*</c-> <c- p>((</c->num <c- o>/</c-> denom<c- p>)</c-> <c- o>**</c-> im1<c- p>);</c->
    <c- p>});</c->

    <c- k>return</c-> LMS<c- p>;</c->
<c- p>}</c-></pre>
        <h3 class="heading settled" data-level="11.6" id="hdr-color-code"><span class="secno">11.6. </span><span
                class="content"> <a class="css" data-link-type="maybe" href="#funcdef-hdr-color"
                    id="ref-for-funcdef-hdr-color②">hdr-color()</a> 示例代码 </span><a class="self-link"
                href="#hdr-color-code"></a></h3>
        <pre class="include-code highlight"><c- a>function</c-> hdrColor<c- p>(</c->col1<c- p>,</c-> H1<c- p>,</c-> col2<c- p>,</c-> H2<c- p>,</c-> H<c- p>)</c-> <c- p>{</c->

    <c- c1>// col1、col2 是表示两种颜色的数组，使用绝对 XYZ</c->
    <c- c1>// H1 与 H2 是各自颜色的 headroom（以档计，即对数尺度，0 = SDR）</c->
    <c- c1>// H 是可用的 headroom</c->

    <c- c1>// 首先检查 headroom 是否不同</c->
    <c- k>if</c-> <c- p>(</c->H1 <c- o>==</c-> H2<c- p>)</c-> <c- k>return</c-> <c- mf>0</c-><c- p>;</c->

    <c- a>let</c-> w1 <c- o>=</c-> clamp<c- p>((</c->H <c- o>-</c-> H2<c- p>)</c-> <c- o>/</c-> <c- p>(</c->H1 <c- o>-</c-> H2<c- p>),</c-> <c- mf>0</c-><c- p>,</c-> <c- mf>1</c-><c- p>);</c->
    <c- a>let</c-> w2 <c- o>=</c-> clamp<c- p>((</c->H <c- o>-</c-> H1<c- p>)</c-> <c- o>/</c-> <c- p>(</c->H2 <c- o>-</c-> H1<c- p>),</c-> <c- mf>0</c-><c- p>,</c-> <c- mf>1</c-><c- p>);</c->
    <c- a>let</c-> eps <c- o>=</c-> <c- mf>0.001</c-><c- p>;</c->
    <c- a>let</c-> cxyz <c- o>=</c-> Array<c- p>(</c-><c- mf>3</c-><c- p>);</c->
    <c- k>for</c-> <c- p>(</c-><c- a>let</c-> i<c- o>=</c-><c- mf>0</c-><c- p>;</c-> i<c- o>&lt;</c-><c- mf>3</c-><c- p>;</c-> i<c- o>++</c-><c- p>)</c-> <c- p>{</c->
        cxyz<c- p>[</c->i<c- p>]</c-> <c- o>=</c-> Math<c- p>.</c->pow<c- p>(</c->c1xyz<c- p>[</c->i<c- p>]</c-> <c- o>+</c-> eps<c- p>,</c-> w1<c- p>)</c-> <c- o>*</c-> Math<c- p>.</c->pow<c- p>(</c->c2xyz<c- p>[</c->i<c- p>]</c-> <c- o>+</c-> eps<c- p>,</c-> w2<c- p>)</c-> <c- o>-</c-> eps<c- p>;</c->
    <c- p>}</c->
    <c- k>return</c-> cxyz<c- p>;</c->
<c- p>}</c->

<c- a>const</c-> clamp <c- o>=</c-> <c- p>(</c->n<c- p>,</c-> min<c- p>,</c-> max<c- p>)</c-> <c- p>=></c->
  Math<c- p>.</c->min<c- p>(</c->Math<c- p>.</c->max<c- p>(</c->n<c- p>,</c-> min<c- p>),</c-> max<c- p>)</c->
</pre>
        <h2 class="heading settled" data-level="12" id="deltaE"><span class="secno">12. </span><span class="content">
                ΔEITP 颜色差异示例代码 </span><a class="self-link" href="#deltaE"></a></h2>
        <p><em>本节为非规范性内容。</em></p>
        <details class="wpt-tests-block" dir="ltr" lang="en" open>
            <summary>测试</summary>
            <p>本节为非规范性内容，不需要测试。</p>
            <ul class="wpt-tests-list"></ul>
            <hr>
        </details>
        <p>ΔEITP <a data-link-type="biblio" href="#biblio-rec_bt2124"
                title="ITU-R BT.2124-0 Objective metric for the assessment of the potential visibility of colour differences in television">[Rec_BT.2124]</a>
            颜色差度量
            可用于测量在 HDR 或混合 SDR/HDR 场景中
            两个显示参照（display-referred）颜色之间的感知差异，
            例如用于显示校准或色域/色调映射。</p>
        <p>它是在 <span class="css">ICtCp</span> 色彩空间中的欧氏距离，
            并经过缩放，使 ΔEITP = 1.0
            表示一次恰可感知差异（JND）。</p>
        <pre class="include-code highlight"><c- c1>// 计算 deltaE ITP</c->
<c- c1>// 缩放的平方和开根</c->
<c- c1>// ITU-R BT.2124-0 附录 1</c->
<c- d>/**</c->
<c- d> * @param {number[]} reference - ICtCp 数组：I 为 0..1，Ct 与 Cp 为 -1..1</c->
<c- d> * @param {number[]} sample -    ICtCp 数组：I 为 0..1，Ct 与 Cp 为 -1..1</c->
<c- d> * @return {number} 样本颜色与参考颜色的差异程度</c->
<c- d> */</c->
<c- a>function</c-> deltaEITP <c- p>(</c->reference<c- p>,</c-> sample<c- p>)</c-> <c- p>{</c->
    <c- a>let</c-> <c- p>[</c->I1<c- p>,</c-> Ct1<c- p>,</c-> Cp1<c- p>]</c-> <c- o>=</c-> reference<c- p>;</c->
	<c- a>let</c-> <c- p>[</c->I2<c- p>,</c-> Ct2<c- p>,</c-> Cp2<c- p>]</c-> <c- o>=</c-> sample<c- p>;</c->
	<c- a>let</c-> ΔI <c- o>=</c-> I1 <c- o>-</c-> I2<c- p>;</c->
	<c- a>let</c-> ΔT <c- o>=</c-> <c- mf>0.5</c-> <c- o>*</c-> <c- p>(</c->Ct1 <c- o>-</c-> Ct2<c- p>);</c->
	<c- a>let</c-> ΔP <c- o>=</c-> Cp1 <c- o>-</c-> Cp2<c- p>;</c->
	<c- k>return</c-> <c- mf>720</c-> <c- o>*</c-> Math<c- p>.</c->sqrt<c- p>(</c->ΔI <c- o>**</c-> <c- mf>2</c-> <c- o>+</c-> ΔT <c- o>**</c-> <c- mf>2</c-> <c- o>+</c-> ΔP <c- o>**</c-> <c- mf>2</c-><c- p>);</c->
<c- p>}</c-></pre>
        <h2 class="no-num heading settled" id="privacy"><span class="content">隐私注意事项</span><a class="self-link"
                href="#privacy"></a></h2>
        <p>Web 平台之所以不直接暴露 <a data-link-type="dfn" href="#hdr-headroom" id="ref-for-hdr-headroom④">HDR headroom</a> 的数值，
            是因为那样会暴露当前的观看条件，
            构成<a href="#headroom-privacy">隐私侵犯</a>。</p>
        <h2 class="no-num heading settled" id="security"><span class="content">安全注意事项</span><a class="self-link"
                href="#security"></a></h2>
        <p>本文档未提出任何安全方面的顾虑</p>
        <h2 class="no-num heading settled" id="a11y"><span class="content">可访问性注意事项</span><a class="self-link"
                href="#a11y"></a></h2>
        <p>部分用户可能对非常明亮的颜色较为敏感，
            因此用户代理应提供一种机制，
            允许用户选择限制最大亮度。<span class="non-normative">建议采用 <a data-link-type="biblio" href="#biblio-rec_bt2390"
                    title="ITU-R BT.2390-8 High dynamic range television for production and international programme exchange">[Rec_BT.2390]</a>
                第 5.4.1 节 <em>将映射到亮度范围受限的显示器</em> 中的 toe 与 knee 过程。</span></p>
        <p><span class="css">dynamic-range-limit</span> 属性也可以在用户样式表中设置为 <a class="css" data-link-type="maybe"
                href="#valdef-dynamic-range-limit-standard"
                id="ref-for-valdef-dynamic-range-limit-standard④">standard</a> 或 <a class="css" data-link-type="maybe"
                href="#valdef-dynamic-range-limit-constrained"
                id="ref-for-valdef-dynamic-range-limit-constrained④">constrained</a>。</p>
        <h2 class="no-num heading settled" id="changes"><span class="content"> 变更 </span><a class="self-link"
                href="#changes"></a></h2>
        <h3 class="heading settled" id="changes-20241217"><span class="content">自 <a
                    href="https://www.w3.org/TR/2024/WD-css-color-hdr-1-20241217/">2024 年 12 月 17 日
                    首次公开工作草案</a> 以来的变更</span><a class="self-link" href="#changes-20241217"></a></h3>
        <ul>
            <li>移除了以 SMPTE-ST-2094-50 作为 eps 理由的相关表述
                (<a href="https://github.com/w3c/csswg-drafts/issues/12873">#12873</a>, <a
                    href="https://github.com/w3c/csswg-drafts/issues/11788">#11788</a>)
            <li>指出 hdr-color 与自适应增益曲线的相似性
            <li>在颜色语法中添加 alpha() RCS <a href="https://github.com/w3c/csswg-drafts/issues/10689">#10689</a>
            <li>将 display-p3-linear 添加到用于插值的色彩空间
                (<a href="https://github.com/w3c/csswg-drafts/issues/12596">#12596</a>)
            <li>补充了若干 ΔE ITP 示例
                (<a href="https://github.com/w3c/csswg-drafts/issues/11250">#11250</a>)
            <li>添加了 display-p3-linear 色彩空间
                (<a href="https://github.com/w3c/csswg-drafts/issues/12596">#12596</a>)
            <li>添加了 hdr-color() 使用的 clamp 函数
            <li>添加了 hdr-color() 示例代码
            <li>说明了 eps 因子的用途
                (<a href="https://github.com/w3c/csswg-drafts/issues/11788">#11788</a>)
            <li>添加了第二个 color-hdr() 示例
            <li>定义了术语 “Absolute D65 CIE XYZ”
            <li>明确了 color-hdr() 的伪代码，表明各分量分别计算
                (<a href="https://github.com/w3c/csswg-drafts/issues/11694">#11694</a>)
            <li>在 dynamic-range-limit-mix() 中，按工作组决议改为 “一个或多个”
                (<a href="https://github.com/w3c/csswg-drafts/issues/11694">#11694</a>)
            <li>阐明当 dynamic-range-limit-mix() 的所有参数都被省略时，其计算值为初始值
                (<a href="https://github.com/w3c/csswg-drafts/issues/11678">#11678</a>)
            <li>移除了对 “color()” 的重新定义，改为链接到 CSS Color 5 中的定义
                (<a href="https://github.com/w3c/csswg-drafts/issues/11954">#11954</a>)
            <li>依据工作组决议，将 “constrained-high” 改回 “constrained”
                (<a href="https://github.com/w3c/csswg-drafts/issues/11698">#11698</a>)
            <li>为 JzCzhz 的色度定义了 ε，用于无色相情况
                (<a href="https://github.com/w3c/csswg-drafts/issues/11706">#11706</a>)
            <li>正确导出了术语 “required conversion”，并在全文一致使用
            <li>移除了 JzCzhz 中错误的负色度参考范围
            <li>为相对 ictcp、jzazbz 和 jzczhz 添加了 RCS 分量关键字
                (<a href="https://github.com/w3c/csswg-drafts/issues/11713">#11713</a>)
            <li>避免 color() 链接指向仅支持 SDR 的 CSS Color 5
            <li>新增 ICtCp 的介绍性章节，并将定义从 color() 中移出
                (<a href="https://github.com/w3c/csswg-drafts/issues/11713">#11713</a>)
            <li>移除了已在 CSS Color 5 中存在的重复产生式
                (<a href="https://github.com/w3c/csswg-drafts/issues/11954">#11954</a>)
            <li>参考范围涵盖 BT.2100 色域
                (<a href="https://github.com/w3c/csswg-drafts/issues/11710">#11710</a>)
            <li>依据 CSS 工作组决议，移除了 “若总和为零则无效” 的表述
                (<a href="https://github.com/w3c/csswg-drafts/issues/11678">#11678</a>)
            <li>统一采用对数量纲（stops）的 headroom 定义，而非线性（倍数）headroom
                (<a href="https://github.com/w3c/csswg-drafts/issues/11787">#11787</a>)
            <li>统一使用推荐术语 “HDR reference white”，而非 “media white”
            <li>添加了颜色插值示例
                (<a href="https://github.com/w3c/csswg-drafts/issues/11616">#11616</a>)
            <li>添加了插值算法
                (<a href="https://github.com/w3c/csswg-drafts/issues/11616">#11616</a>)
            <li>添加了按 headroom 参数化的颜色插值章节
                (<a href="https://github.com/w3c/csswg-drafts/issues/11616">#11616</a>)
            <li>根据工作组决议添加了 color-hdr 函数。
                添加 ISO 21496-1 的资料性参考
                (<a href="https://github.com/w3c/csswg-drafts/issues/11616">#11616</a>)
            <li>添加了 Jzazbz 示例代码
                (<a href="https://github.com/w3c/csswg-drafts/issues/9934">#9934</a>)
            <li>补充了示例代码所缺失的有符号幂函数
            <li>添加了 rec2100 色彩空间示例代码
                (<a href="https://github.com/w3c/csswg-drafts/issues/9934">#9934</a>)
            <li>添加了 ICtCp 示例代码
                (<a href="https://github.com/w3c/csswg-drafts/issues/9934">#9934</a>)
            <li>添加了 Perrin ICtCp 论文的资料性参考
            <li>新增“颜色转换示例代码”章节
                (<a href="https://github.com/w3c/csswg-drafts/issues/9934">#9934</a>)
            <li>添加了杜比 “What is ICtCp” 白皮书的资料性参考
                (<a href="https://github.com/w3c/csswg-drafts/issues/9934">#9934</a>)
            <li>明确了 dynamic-range-limit-mix() 的语法与规范文本
                (<a href="https://github.com/w3c/csswg-drafts/issues/11672">#11672</a>)
            <li>添加了来自 BT.2124 的 ΔEITP 颜色差度量
                (<a href="https://github.com/w3c/csswg-drafts/issues/11250">#11250</a>)
            <li>对于 dynamic-range-limit，将 high 更改为 no-limit
                (<a href="https://github.com/w3c/csswg-drafts/issues/11698">#11698</a>)
            <li>修正文字，dynamic-range-limit-mix 接受 2 个或更多值
                (<a href="https://github.com/w3c/csswg-drafts/issues/11694">#11694</a>)
            <li>移除了绝对与相对 HDR 概念，改为强调场景参照（scene-referred）与显示参照（display-referred）。
                锚定 media white，并允许色彩重渲染
                (<a href="https://github.com/w3c/csswg-drafts/issues/10460">#10460</a>)
            <li>更清晰地定义了 “media white”
            <li>将说明性材料汇集至导言部分
        </ul>
    </main>
    <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content"> 一致性</span><a class="self-link"
            href="#w3c-conformance"></a></h2>
    <h3 class="no-ref heading settled" id="w3c-conventions"><span class="content"> 文档约定</span><a class="self-link"
            href="#w3c-conventions"></a></h3>
    <p>一致性要求以描述性断言和 RFC 2119 术语的组合来表达。规范性部分中的关键词 “MUST”、
        “MUST NOT”、 “REQUIRED”、 “SHALL”、 “SHALL NOT”、 “SHOULD”、 “SHOULD NOT”、
        “RECOMMENDED”、 “MAY” 和 “OPTIONAL” 应按 RFC 2119 的描述解释。
        但为可读性起见，这些词并不总以全大写形式出现在本规范中。 </p>
    <p>除明确标注为非规范性的章节、示例和注释外，本规范的所有文本均为规范性内容。 <a data-link-type="biblio" href="#biblio-rfc2119"
            title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a></p>
    <p>本规范中的示例以“for example”引入，或通过 <code>class="example"</code> 与规范性文本区分开，例如：</p>
    <div class="example" id="w3c-example">
        <a class="self-link" href="#w3c-example"></a>
        <p>这是一个信息性示例。</p>
    </div>
    <p>信息性注释以 “Note” 开头，并用 <code>class="note"</code> 与规范性文本区分，例如：</p>
    <p class="note" role="note">注意，这是一条信息性注释。</p>
    <p>告诫性段落为规范性内容，具有特殊强调样式，并用 <code>&lt;strong class="advisement"></code> 与其它规范性文本区分，例如： <strong class="advisement">
            UAs MUST provide an accessible alternative. </strong></p>
    <details class="wpt-tests-block" dir="ltr" lang="en" open>
        <summary>Tests</summary>
        <p>与本规范内容相关的测试可能以类似的 “Tests” 模块记录。
            任何此类模块均为非规范性。</p>
        <ul class="wpt-tests-list"></ul>
        <hr>
    </details>
    <h3 class="no-ref heading settled" id="w3c-conformance-classes"><span class="content"> 一致性类别</span><a
            class="self-link" href="#w3c-conformance-classes"></a></h3>
    <p>本规范定义了三类一致性： </p>
    <dl>
        <dt>样式表
        <dd>一个 <a href="https://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS 样式表</a>。
        <dt>渲染器
        <dd>一个 <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">用户代理</a>，解释样式表语义并渲染使用它们的文档。
        <dt>创作工具
        <dd>一个 <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">用户代理</a>，用于编写样式表。
    </dl>
    <p>如果样式表中使用了本模块定义的语法，其声明在语法上是有效的，并且符合通用 CSS 语法和每个特性的单独语法，则该样式表与本规范一致。 </p>
    <p>渲染器若还正确支持本规范定义的所有特性（包括正确解析并据此渲染文档），则视为与本规范一致。然而，若某用户代理因设备限制无法正确渲染文档，并不使该用户代理不一致。（例如，用户代理无需在单色显示器上渲染颜色。） </p>
    <p>创作工具若能生成语法上正确的样式表（符合通用 CSS 语法和本模块中各特性的语法），并满足样式表的一切其他一致性要求，则视为与本规范一致。 </p>
    <h3 class="no-ref heading settled" id="w3c-partial"><span class="content"> 部分实现</span><a class="self-link"
            href="#w3c-partial"></a></h3>
    <p>为了让作者能利用向前兼容的解析规则来指定回退值，CSS 渲染器 <strong>必须</strong> 将其无法支持的 at-rules、属性、属性值、关键字和其它语法结构视为无效（并在适当时 <a
            href="https://www.w3.org/TR/CSS21/conform.html#ignore">忽略</a>）。特别是，用户代理 <strong>不得</strong>
        在单个多值属性声明中选择性忽略不支持的组件值并保留支持的值：若任何值被视为无效（如不支持的值应被视为），CSS 要求整个声明被忽略。</p>
    <h4 class="heading settled" id="w3c-conform-future-proofing"><span class="content"> 不稳定与专有特性的实现</span><a
            class="self-link" href="#w3c-conform-future-proofing"></a></h4>
    <p>为避免与未来稳定的 CSS 特性冲突，CSSWG 建议在实现 <a href="https://www.w3.org/TR/CSS/#future-proofing">不稳定</a> 特性和 <a
            href="https://www.w3.org/TR/CSS/#proprietary-extension">专有扩展</a> 时遵循最佳实践。 </p>
    <h3 class="no-ref heading settled" id="w3c-testing"><span class="content"> 非实验性实现</span><a class="self-link"
            href="#w3c-testing"></a></h3>
    <p>一旦规范达到候选推荐（CR）阶段，非实验性实现成为可能，且实现者应在能证明其按规范正确实现 CR 级特性时发布无前缀实现。 </p>
    <p>为建立并维护各实现间的互操作性，CSS 工作组请求非实验性 CSS 渲染器在发布任何已正确实现的 CR 级特性（无前缀实现）之前，向 W3C 提交实现报告（如有必要，还包括用于该实现报告的测试用例）。提交给 W3C
        的测试用例将由 CSS 工作组审查并修正。 </p>
    <p>关于提交测试用例和实现报告的更多信息，请访问 CSS 工作组网站 <a
            href="https://www.w3.org/Style/CSS/Test/">https://www.w3.org/Style/CSS/Test/</a>。问题请发往 <a
            href="https://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a> 邮件列表。</p>
    <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
    <h2 class="no-num no-ref heading settled" id="index"><span class="content">索引</span><a class="self-link"
            href="#index"></a></h2>
    <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">本规范定义的术语</span><a
            class="self-link" href="#index-defined-here"></a></h3>
    <ul class="index">
        <li><a href="#valdef-jzazbz-a">a</a><span>，见 § 6.4</span>
        <li><a href="#absolute-d65-cie-xyz">绝对 D65 CIE XYZ</a><span>，见 § 5</span>
        <li>
            alpha
            <ul>
                <li><a href="#valdef-ictcp-alpha">ictcp() 的值</a><span>，见 § 6.3</span>
                <li><a href="#valdef-jzazbz-alpha">jzazbz() 的值</a><span>，见 § 6.4</span>
                <li><a href="#valdef-jzczhz-alpha">jzczhz() 的值</a><span>，见 § 6.5</span>
            </ul>
        <li><a href="#valdef-jzazbz-b">b</a><span>，见 § 6.4</span>
        <li><a href="#valdef-jzczhz-c">c</a><span>，见 § 6.5</span>
        <li><a href="#typedef-color-function">&lt;color-function></a><span>，见 § 4</span>
        <li><a href="#color-re-rendering">色彩重渲染</a><span>，见 § 2.1</span>
        <li><a href="#valdef-dynamic-range-limit-constrained">constrained</a><span>，见 § 3.1</span>
        <li><a href="#valdef-ictcp-cp">cp</a><span>，见 § 6.3</span>
        <li><a href="#valdef-ictcp-ct">ct</a><span>，见 § 6.3</span>
        <li><a href="#dynamic-range">动态范围</a><span>，见 § 2.1</span>
        <li><a href="#propdef-dynamic-range-limit">dynamic-range-limit</a><span>，见 § 3.1</span>
        <li><a href="#funcdef-dynamic-range-limit-mix">dynamic-range-limit-mix()</a><span>，见 § 3.2</span>
        <li><a href="#valdef-jzczhz-h">h</a><span>，见 § 6.5</span>
        <li><a href="#funcdef-hdr-color">hdr-color()</a><span>，见 § 5</span>
        <li><a href="#hdr-headroom">HDR headroom</a><span>，见 § 2.2</span>
        <li><a href="#hdr-reference-white">HDR 参考白</a><span>，见 § 2.1</span>
        <li><a href="#high-dynamic-range">高动态范围</a><span>，见 § 2.1</span>
        <li><a href="#valdef-ictcp-i">i</a><span>，见 § 6.3</span>
        <li><a href="#ictcp">ICtCp</a><span>，见 § 6.3</span>
        <li><a href="#funcdef-ictcp">ictcp()</a><span>，见 § 4</span>
        <li>
            j
            <ul>
                <li><a href="#valdef-jzazbz-j">jzazbz() 的值</a><span>，见 § 6.4</span>
                <li><a href="#valdef-jzczhz-j">jzczhz() 的值</a><span>，见 § 6.5</span>
            </ul>
        <li><a href="#jzazbz">Jzazbz</a><span>，见 § 6.4</span>
        <li><a href="#funcdef-jzazbz">jzazbz()</a><span>，见 § 4</span>
        <li><a href="#jzczhz">JzCzhz</a><span>，见 § 6.5</span>
        <li><a href="#funcdef-jzczhz">jzczhz()</a><span>，见 § 4</span>
        <li><a href="#valdef-dynamic-range-limit-no-limit">no-limit</a><span>，见 § 3.1</span>
        <li><a href="#typedef-predefined-rgb">&lt;predefined-rgb></a><span>，见 § 7</span>
        <li><a href="#rec2100-hlg">rec2100-hlg</a><span>，见 § 8.2</span>
        <li><a href="#rec2100-linear">rec2100-linear</a><span>，见 § 8.3</span>
        <li><a href="#rec2100-pq">rec2100-pq</a><span>，见 § 8.1</span>
        <li><a href="#valdef-dynamic-range-limit-standard">standard</a><span>，见 § 3.1</span>
        <li><a href="#standard-dynamic-range">标准动态范围</a><span>，见 § 2.1</span>
    </ul>
    <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">通过引用定义的术语</span><a
            class="self-link" href="#index-defined-elsewhere"></a></h3>
    <ul class="index">
        <li>
            <a data-link-type="biblio">[CSS-CASCADE-5]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="8c8e51b4">计算值</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-COLOR-4]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="e5db470f">&lt;alpha-value></span>
                <li><span class="dfn-paneled" id="33347c0e">&lt;hue></span>
                <li><span class="dfn-paneled" id="f6f69187">色彩空间</span>
                <li><span class="dfn-paneled" id="c1a0e909">d65</span>
                <li><span class="dfn-paneled" id="5bd3632a">hsl()</span>
                <li><span class="dfn-paneled" id="239640fd">hsla()</span>
                <li><span class="dfn-paneled" id="4a14e4dc">lab</span>
                <li><span class="dfn-paneled" id="795f4c8b">亮度</span>
                <li><span class="dfn-paneled" id="528ea935">none</span>
                <li><span class="dfn-paneled" id="daabf294">rgb()</span>
                <li><span class="dfn-paneled" id="f3226176">rgba()</span>
                <li><span class="dfn-paneled" id="bd774466">sRGB</span>
                <li><span class="dfn-paneled" id="17858dc9">white</span>
                <li><span class="dfn-paneled" id="b3bfee63">xyz-d65</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-COLOR-5]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="d04b6986">&lt;color></span>
                <li><span class="dfn-paneled" id="49716633">alpha()</span>
                <li><span class="dfn-paneled" id="4966c7f8">color()</span>
                <li><span class="dfn-paneled" id="59963a3c">分量关键词</span>
                <li><span class="dfn-paneled" id="f7f2e8bc">hwb()</span>
                <li><span class="dfn-paneled" id="f1cce64a">lab()</span>
                <li><span class="dfn-paneled" id="9b2c9faa">lch()</span>
                <li><span class="dfn-paneled" id="deb378dd">oklab()</span>
                <li><span class="dfn-paneled" id="0e5d2494">oklch()</span>
                <li><span class="dfn-paneled" id="1953bdac">原色</span>
                <li><span class="dfn-paneled" id="b786b3c1">相对颜色</span>
                <li><span class="dfn-paneled" id="f4b08404">所需转换</span>
            </ul>
        <li>
            <a data-link-type="biblio">[CSS-VALUES-4]</a> 定义了以下术语：
            <ul>
                <li><span class="dfn-paneled" id="c297b070">#</span>
                <li><span class="dfn-paneled" id="bdb4e757">&amp;&amp;</span>
                <li><span class="dfn-paneled" id="61bb5e44">&lt;number></span>
                <li><span class="dfn-paneled" id="128295ac">&lt;percentage></span>
                <li><span class="dfn-paneled" id="d4441b24">?</span>
                <li><span class="dfn-paneled" id="8a110a7b">CSS 范围关键字</span>
                <li><span class="dfn-paneled" id="4eb9d37e">|</span>
            </ul>
    </ul>
    <h2 class="no-num no-ref heading settled" id="references"><span class="content">参考文献</span><a class="self-link"
            href="#references"></a></h2>
    <h3 class="no-num no-ref heading settled" id="normative"><span class="content">规范性参考文献</span><a class="self-link"
            href="#normative"></a></h3>
    <dl>
        <dt id="biblio-css-cascade-5">[CSS-CASCADE-5]
        <dd>Elika Etemad; Miriam Suzanne; Tab Atkins Jr.. <a href="https://www.w3.org/TR/css-cascade-5/"><cite>CSS
                    Cascading and Inheritance Level 5</cite></a>。2022 年 1 月 13 日。CR。URL: <a
                href="https://www.w3.org/TR/css-cascade-5/">https://www.w3.org/TR/css-cascade-5/</a>
        <dt id="biblio-css-color-4">[CSS-COLOR-4]
        <dd>Chris Lilley; Tab Atkins Jr.; Lea Verou. <a href="https://www.w3.org/TR/css-color-4/"><cite>CSS Color Module
                    Level 4</cite></a>。2025 年 4 月 24 日。CRD。URL: <a
                href="https://www.w3.org/TR/css-color-4/">https://www.w3.org/TR/css-color-4/</a>
        <dt id="biblio-css-color-5">[CSS-COLOR-5]
        <dd>Chris Lilley; 等。<a href="https://www.w3.org/TR/css-color-5/"><cite>CSS Color Module Level 5</cite></a>。
            2025 年 3 月 18 日。WD。URL: <a href="https://www.w3.org/TR/css-color-5/">https://www.w3.org/TR/css-color-5/</a>
        <dt id="biblio-css-values-3">[CSS-VALUES-3]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-3/"><cite>CSS Values and Units
                    Module Level 3</cite></a>。2024 年 3 月 22 日。CRD。URL: <a
                href="https://www.w3.org/TR/css-values-3/">https://www.w3.org/TR/css-values-3/</a>
        <dt id="biblio-css-values-4">[CSS-VALUES-4]
        <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-4/"><cite>CSS Values and Units
                    Module Level 4</cite></a>。2024 年 3 月 12 日。WD。URL: <a
                href="https://www.w3.org/TR/css-values-4/">https://www.w3.org/TR/css-values-4/</a>
        <dt id="biblio-css2">[CSS2]
        <dd>Bert Bos; 等。<a href="https://www.w3.org/TR/CSS2/"><cite>Cascading Style Sheets Level 2 Revision 1 (CSS
                    2.1) Specification</cite></a>。2011 年 6 月 7 日。REC。URL: <a
                href="https://www.w3.org/TR/CSS2/">https://www.w3.org/TR/CSS2/</a>
        <dt id="biblio-rec2020">[Rec.2020]
        <dd><a href="http://www.itu.int/rec/R-REC-BT.2020/en"><cite>Recommendation ITU-R BT.2020-2: Parameter values for
                    ultra-high definition television systems for production and international programme
                    exchange</cite></a>。2015 年 10 月。URL: <a
                href="http://www.itu.int/rec/R-REC-BT.2020/en">http://www.itu.int/rec/R-REC-BT.2020/en</a>
        <dt id="biblio-rec_bt2100">[Rec_BT.2100]
        <dd><a href="https://www.itu.int/rec/recommendation.asp?lang=en&amp;parent=R-REC-BT.2100-3-202502-I"><cite>ITU-R
                    BT.2100-3 Image parameter values for high dynamic range television for use in production and
                    international programme exchange</cite></a>。2025 年 2 月。URL: <a
                href="https://www.itu.int/rec/recommendation.asp?lang=en&amp;parent=R-REC-BT.2100-3-202502-I">https://www.itu.int/rec/recommendation.asp?lang=en&amp;parent=R-REC-BT.2100-3-202502-I</a>
        <dt id="biblio-rec_bt2390">[Rec_BT.2390]
        <dd><a href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-8-2020-PDF-E.pdf"><cite>ITU-R BT.2390-8
                    High dynamic range television for production and international programme exchange</cite></a>。
            2020 年 2 月。URL: <a
                href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-8-2020-PDF-E.pdf">https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-8-2020-PDF-E.pdf</a>
        <dt id="biblio-rfc2119">[RFC2119]
        <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to
                    Indicate Requirement Levels</cite></a>。1997 年 3 月。最佳当前实践。URL: <a
                href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
        <dt id="biblio-rpt_bt2408">[Rpt_BT.2408]
        <dd><a href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2408-2017-PDF-E.pdf"><cite>Report ITU-R
                    BT.2408-0 Operational practices in HDR television production</cite></a>。2017 年 10 月。URL: <a
                href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2408-2017-PDF-E.pdf">https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2408-2017-PDF-E.pdf</a>
        <dt id="biblio-safdar-pucs">[Safdar-PUCS]
        <dd>Safdar, Muhammad; 等。<a
                href="https://opg.optica.org/oe/fulltext.cfm?uri=oe-25-13-15131&amp;id=368272"><cite>Perceptually
                    uniform color space for image signals including high dynamic range and wide gamut</cite></a>。2017 年
            6 月 26 日。URL: <a
                href="https://opg.optica.org/oe/fulltext.cfm?uri=oe-25-13-15131&amp;id=368272">https://opg.optica.org/oe/fulltext.cfm?uri=oe-25-13-15131&amp;id=368272</a>
        <dt id="biblio-smpte-st-2084">[SMPTE-ST-2084]
        <dd><a href="https://pub.smpte.org/latest/st2084/st2084-2014.pdf"><cite>ST 2084:2014 - SMPTE Standard - High
                    Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays</cite></a>。2014 年 8
            月 29 日。URL: <a
                href="https://pub.smpte.org/latest/st2084/st2084-2014.pdf">https://pub.smpte.org/latest/st2084/st2084-2014.pdf</a>
    </dl>
    <h3 class="no-num no-ref heading settled" id="informative"><span class="content">参考性参考文献</span><a class="self-link"
            href="#informative"></a></h3>
    <dl>
        <dt id="biblio-arib_std-b67">[ARIB_STD-B67]
        <dd><a href="https://www.arib.or.jp/english/html/overview/doc/2-STD-B67v1_0.pdf"><cite>Essential Parameter
                    Values for the Extended Image Dynamic Range Television (EIDRTV) System for Programme
                    Production</cite></a>。2015 年 7 月 3 日。URL: <a
                href="https://www.arib.or.jp/english/html/overview/doc/2-STD-B67v1_0.pdf">https://www.arib.or.jp/english/html/overview/doc/2-STD-B67v1_0.pdf</a>
        <dt id="biblio-development_itp">[Development_ITP]
        <dd>F.Ebner; M.D.Fairchild。<a
                href="https://www.researchgate.net/publication/221677980_Development_and_Testing_of_a_Color_Space_IPT_with_Improved_Hue_Uniformity"><cite>Development
                    and testing of a color space (IPT) with improved hue uniformity. In: Proceedings of The Sixth Color
                    Imaging Conference, 8-13, 1998</cite></a>。1998 年 1 月。URL: <a
                href="https://www.researchgate.net/publication/221677980_Development_and_Testing_of_a_Color_Space_IPT_with_Improved_Hue_Uniformity">https://www.researchgate.net/publication/221677980_Development_and_Testing_of_a_Color_Space_IPT_with_Improved_Hue_Uniformity</a>
        <dt id="biblio-displayhdr">[DisplayHDR]
        <dd><a href="https://displayhdr.org/performance-criteria/"><cite>Summary of DisplayHDR Specs under CTS
                    1.2</cite></a>。2024 年 5 月 17 日。URL: <a
                href="https://displayhdr.org/performance-criteria/">https://displayhdr.org/performance-criteria/</a>
        <dt id="biblio-iso_21496-1">[ISO_21496-1]
        <dd><a href="https://www.iso.org/standard/86775.html"><cite>Gain map metadata for image conversion: Part 1:
                    Dynamic Range Conversion</cite></a>。URL: <a
                href="https://www.iso.org/standard/86775.html">https://www.iso.org/standard/86775.html</a>
        <dt id="biblio-perrin">[Perrin]
        <dd>Perrin, A-F.; et al. <a href="https://ieeexplore.ieee.org/document/8333011"><cite>ICtCp Versus Y'CbCr:
                    Evaluation of ICtCp Color Space and an Adaptive Reshaper for HDR and WCG</cite></a>。2018 年 5 月。URL:
            <a href="https://ieeexplore.ieee.org/document/8333011">https://ieeexplore.ieee.org/document/8333011</a>
        <dt id="biblio-rec_bt2124">[Rec_BT.2124]
        <dd><a href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.2124-0-201901-I!!PDF-E.pdf"><cite>ITU-R
                    BT.2124-0 Objective metric for the assessment of the potential visibility of colour differences in
                    television</cite></a>。URL: <a
                href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.2124-0-201901-I!!PDF-E.pdf">https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.2124-0-201901-I!!PDF-E.pdf</a>
        <dt id="biblio-rec_bt814">[Rec_BT.814]
        <dd><a href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.814-4-201807-I!!PDF-E.pdf"><cite>Specifications
                    of PLUGE test signals and alignment procedures for setting of brightness and contrast of
                    displays</cite></a>。2018 年 7 月。URL: <a
                href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.814-4-201807-I!!PDF-E.pdf">https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.814-4-201807-I!!PDF-E.pdf</a>
        <dt id="biblio-smpte-st-2094-50">[SMPTE-ST-2094-50]
        <dd><a href="https://github.com/SMPTE/st2094-50"><cite>Dynamic Metadata for Color Volume Transform - Application
                    #5 (Broadcast)</cite></a>。2025 年。URL: <a
                href="https://github.com/SMPTE/st2094-50">https://github.com/SMPTE/st2094-50</a>
        <dt id="biblio-what_is_ictcp">[What_is_ICtCp]
        <dd><a href="https://professional.dolby.com/siteassets/pdfs/ictcp_dolbywhitepaper_v071.pdf"><cite>What is ICtCp,
                    v7.1</cite></a>。URL: <a
                href="https://professional.dolby.com/siteassets/pdfs/ictcp_dolbywhitepaper_v071.pdf">https://professional.dolby.com/siteassets/pdfs/ictcp_dolbywhitepaper_v071.pdf</a>
    </dl>
    <h2 class="no-num no-ref heading settled" id="property-index"><span class="content">属性索引</span><a class="self-link"
            href="#property-index"></a></h2>
    <div class="big-element-wrapper">
        <table class="index">
            <thead>
                <tr>
                    <th scope="col">名称
                    <th scope="col">取值
                    <th scope="col">初始值
                    <th scope="col">适用元素
                    <th scope="col">继承性
                    <th scope="col">百分比
                    <th scope="col">动画类型
                    <th scope="col">规范顺序
                    <th scope="col">计算值
            <tbody>
                <tr>
                    <th scope="row"><a class="css" data-link-type="property" href="#propdef-dynamic-range-limit"
                            id="ref-for-propdef-dynamic-range-limit④">dynamic-range-limit</a>
                    <td>standard | no-limit | constrained | &lt;dynamic-range-limit-mix()>
                    <td>no-limit
                    <td>所有元素
                    <td>yes
                    <td>n/a
                    <td>按 dynamic-range-limit-mix()
                    <td>按语法
                    <td>见 dynamic-range-limit 的计算值
        </table>
    </div>
    <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">问题索引</span><a class="self-link"
            href="#issues-index"></a></h2>
    <div style="counter-reset:issue">
        <div class="issue"> 补充一张用对数刻度显示 SDR 和 HDR 动态范围的图 <a class="issue-return" href="#issue-b905ab0c"
                title="Jump to section">↵</a></div>
        <div class="issue"> 补充更多示例，包括 sRGB 红、绿、蓝 和 P3 红、绿、蓝 的编码。 <a class="issue-return" href="#issue-3762b88c"
                title="Jump to section">↵</a></div>
        <div class="issue"> 补充更多示例 <a class="issue-return" href="#issue-63bd5f3d" title="Jump to section">↵</a></div>
        <div class="issue"> 是否补充同页定义的黑位提升 Β？ <a class="issue-return" href="#issue-fb589d17"
                title="Jump to section">↵</a></div>
    </div>
    <script>/* Boilerplate: script-dom-helper */
        "use strict";
        function query(sel) { return document.querySelector(sel); }

        function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

        function iter(obj) {
            if (!obj) return [];
            var it = obj[Symbol.iterator];
            if (it) return it;
            return Object.entries(obj);
        }

        function mk(tagname, attrs, ...children) {
            const el = document.createElement(tagname);
            for (const [k, v] of iter(attrs)) {
                if (k.slice(0, 3) == "_on") {
                    const eventName = k.slice(3);
                    el.addEventListener(eventName, v);
                } else if (k[0] == "_") {
                    // property, not attribute
                    el[k.slice(1)] = v;
                } else {
                    if (v === false || v == null) {
                        continue;
                    } else if (v === true) {
                        el.setAttribute(k, "");
                        continue;
                    } else {
                        el.setAttribute(k, v);
                    }
                }
            }
            append(el, children);
            return el;
        }

        /* Create shortcuts for every known HTML element */
        [
            "a",
            "abbr",
            "acronym",
            "address",
            "applet",
            "area",
            "article",
            "aside",
            "audio",
            "b",
            "base",
            "basefont",
            "bdo",
            "big",
            "blockquote",
            "body",
            "br",
            "button",
            "canvas",
            "caption",
            "center",
            "cite",
            "code",
            "col",
            "colgroup",
            "datalist",
            "dd",
            "del",
            "details",
            "dfn",
            "dialog",
            "div",
            "dl",
            "dt",
            "em",
            "embed",
            "fieldset",
            "figcaption",
            "figure",
            "font",
            "footer",
            "form",
            "frame",
            "frameset",
            "head",
            "header",
            "h1",
            "h2",
            "h3",
            "h4",
            "h5",
            "h6",
            "hr",
            "html",
            "i",
            "iframe",
            "img",
            "input",
            "ins",
            "kbd",
            "label",
            "legend",
            "li",
            "link",
            "main",
            "map",
            "mark",
            "meta",
            "meter",
            "nav",
            "nobr",
            "noscript",
            "object",
            "ol",
            "optgroup",
            "option",
            "output",
            "p",
            "param",
            "pre",
            "progress",
            "q",
            "s",
            "samp",
            "script",
            "section",
            "select",
            "small",
            "source",
            "span",
            "strike",
            "strong",
            "style",
            "sub",
            "summary",
            "sup",
            "table",
            "tbody",
            "td",
            "template",
            "textarea",
            "tfoot",
            "th",
            "thead",
            "time",
            "title",
            "tr",
            "u",
            "ul",
            "var",
            "video",
            "wbr",
            "xmp",
        ].forEach(tagname => {
            mk[tagname] = (...args) => mk(tagname, ...args);
        });

        function* nodesFromChildList(children) {
            for (const child of children.flat(Infinity)) {
                if (child instanceof Node) {
                    yield child;
                } else {
                    yield new Text(child);
                }
            }
        }
        function append(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                if (el instanceof Node) el.appendChild(child);
                else el.push(child);
            }
            return el;
        }

        function insertAfter(el, ...children) {
            for (const child of nodesFromChildList(children)) {
                el.parentNode.insertBefore(child, el.nextSibling);
            }
            return el;
        }

        function clearContents(el) {
            el.innerHTML = "";
            return el;
        }

        function parseHTML(markup) {
            if (markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
                const doc = document.implementation.createHTMLDocument("");
                doc.documentElement.innerHTML = markup;
                return doc;
            } else {
                const el = mk.template({});
                el.innerHTML = markup;
                return el.content;
            }
        }</script>
    <script>/* Boilerplate: script-dfn-panel */
        "use strict";
        {
            let dfnPanelData = {
                "0e5d2494": { "dfnID": "0e5d2494", "dfnText": "oklch()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-oklch" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-5/#funcdef-oklch" },
                "128295ac": { "dfnID": "128295ac", "dfnText": "<percentage>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-percentage-value" }], "title": "3.2. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-percentage-value\u2460" }, { "id": "ref-for-percentage-value\u2461" }, { "id": "ref-for-percentage-value\u2462" }, { "id": "ref-for-percentage-value\u2463" }, { "id": "ref-for-percentage-value\u2464" }, { "id": "ref-for-percentage-value\u2465" }, { "id": "ref-for-percentage-value\u2466" }, { "id": "ref-for-percentage-value\u2467" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-values-4/#percentage-value" },
                "17858dc9": { "dfnID": "17858dc9", "dfnText": "white", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-valdef-color-white" }, { "id": "ref-for-valdef-color-white\u2460" }, { "id": "ref-for-valdef-color-white\u2461" }], "title": "3.1. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2462" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2463" }], "title": "6.3. ICtCp" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2464" }], "title": "6.4. Jzazbz" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2465" }], "title": "8.1. rec2100-pq" }, { "refs": [{ "id": "ref-for-valdef-color-white\u2466" }], "title": "8.3. rec2100-linear" }], "url": "https://www.w3.org/TR/css-color-4/#valdef-color-white" },
                "1953bdac": { "dfnID": "1953bdac", "dfnText": "origin color", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-origin-color" }, { "id": "ref-for-origin-color\u2460" }, { "id": "ref-for-origin-color\u2461" }], "title": "6.3. ICtCp" }, { "refs": [{ "id": "ref-for-origin-color\u2462" }, { "id": "ref-for-origin-color\u2463" }, { "id": "ref-for-origin-color\u2464" }], "title": "6.4. Jzazbz" }, { "refs": [{ "id": "ref-for-origin-color\u2465" }, { "id": "ref-for-origin-color\u2466" }, { "id": "ref-for-origin-color\u2467" }, { "id": "ref-for-origin-color\u2468" }], "title": "6.5. JzCzhz" }], "url": "https://www.w3.org/TR/css-color-5/#origin-color" },
                "239640fd": { "dfnID": "239640fd", "dfnText": "hsla()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-hsla" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-4/#funcdef-hsla" },
                "33347c0e": { "dfnID": "33347c0e", "dfnText": "<hue>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-hue" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-4/#typedef-hue" },
                "4966c7f8": { "dfnID": "4966c7f8", "dfnText": "color()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-color" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-funcdef-color\u2460" }, { "id": "ref-for-funcdef-color\u2461" }, { "id": "ref-for-funcdef-color\u2462" }], "title": "7. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }, { "refs": [{ "id": "ref-for-funcdef-color\u2463" }, { "id": "ref-for-funcdef-color\u2464" }, { "id": "ref-for-funcdef-color\u2465" }], "title": "10.1. \nSerializing values of the color() function" }], "url": "https://www.w3.org/TR/css-color-5/#funcdef-color" },
                "49716633": { "dfnID": "49716633", "dfnText": "alpha()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-alpha" }], "title": "4. The <color> syntax" }], "url": "https://drafts.csswg.org/css-color-5/#funcdef-alpha" },
                "4a14e4dc": { "dfnID": "4a14e4dc", "dfnText": "lab", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-valdef-lab-lab" }], "title": "6.1. \n\tIntroducing ICtCp\n" }], "url": "https://www.w3.org/TR/css-color-4/#valdef-lab-lab" },
                "4eb9d37e": { "dfnID": "4eb9d37e", "dfnText": "|", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-comb-one" }, { "id": "ref-for-comb-one\u2460" }, { "id": "ref-for-comb-one\u2461" }], "title": "3.1. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-comb-one\u2462" }, { "id": "ref-for-comb-one\u2463" }, { "id": "ref-for-comb-one\u2464" }, { "id": "ref-for-comb-one\u2465" }, { "id": "ref-for-comb-one\u2466" }, { "id": "ref-for-comb-one\u2467" }, { "id": "ref-for-comb-one\u2468" }, { "id": "ref-for-comb-one\u2460\u24ea" }, { "id": "ref-for-comb-one\u2460\u2460" }, { "id": "ref-for-comb-one\u2460\u2461" }, { "id": "ref-for-comb-one\u2460\u2462" }, { "id": "ref-for-comb-one\u2460\u2463" }, { "id": "ref-for-comb-one\u2460\u2464" }, { "id": "ref-for-comb-one\u2460\u2465" }, { "id": "ref-for-comb-one\u2460\u2466" }, { "id": "ref-for-comb-one\u2460\u2467" }, { "id": "ref-for-comb-one\u2460\u2468" }, { "id": "ref-for-comb-one\u2461\u24ea" }, { "id": "ref-for-comb-one\u2461\u2460" }, { "id": "ref-for-comb-one\u2461\u2461" }, { "id": "ref-for-comb-one\u2461\u2462" }, { "id": "ref-for-comb-one\u2461\u2463" }, { "id": "ref-for-comb-one\u2461\u2464" }, { "id": "ref-for-comb-one\u2461\u2465" }, { "id": "ref-for-comb-one\u2461\u2466" }, { "id": "ref-for-comb-one\u2461\u2467" }, { "id": "ref-for-comb-one\u2461\u2468" }, { "id": "ref-for-comb-one\u2462\u24ea" }, { "id": "ref-for-comb-one\u2462\u2460" }, { "id": "ref-for-comb-one\u2462\u2461" }, { "id": "ref-for-comb-one\u2462\u2462" }, { "id": "ref-for-comb-one\u2462\u2463" }, { "id": "ref-for-comb-one\u2462\u2464" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-comb-one\u2462\u2465" }, { "id": "ref-for-comb-one\u2462\u2466" }, { "id": "ref-for-comb-one\u2462\u2467" }, { "id": "ref-for-comb-one\u2462\u2468" }, { "id": "ref-for-comb-one\u2463\u24ea" }, { "id": "ref-for-comb-one\u2463\u2460" }, { "id": "ref-for-comb-one\u2463\u2461" }, { "id": "ref-for-comb-one\u2463\u2462" }, { "id": "ref-for-comb-one\u2463\u2463" }], "title": "7. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-values-4/#comb-one" },
                "528ea935": { "dfnID": "528ea935", "dfnText": "none", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-valdef-color-none" }], "title": "6.5.1. \n\t\tConverting Jzazbz colors to JzCzhz colors" }, { "refs": [{ "id": "ref-for-valdef-color-none\u2460" }], "title": "6.5.2. \n\tConverting JzCzhz colors to Jzazbz  colors" }], "url": "https://www.w3.org/TR/css-color-4/#valdef-color-none" },
                "59963a3c": { "dfnID": "59963a3c", "dfnText": "component keyword", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-component-keyword" }], "title": "6.3. ICtCp" }, { "refs": [{ "id": "ref-for-component-keyword\u2460" }], "title": "6.4. Jzazbz" }, { "refs": [{ "id": "ref-for-component-keyword\u2461" }], "title": "6.5. JzCzhz" }], "url": "https://www.w3.org/TR/css-color-5/#component-keyword" },
                "5bd3632a": { "dfnID": "5bd3632a", "dfnText": "hsl()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-hsl" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-4/#funcdef-hsl" },
                "61bb5e44": { "dfnID": "61bb5e44", "dfnText": "<number>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-number-value" }, { "id": "ref-for-number-value\u2460" }, { "id": "ref-for-number-value\u2461" }, { "id": "ref-for-number-value\u2462" }, { "id": "ref-for-number-value\u2463" }, { "id": "ref-for-number-value\u2464" }, { "id": "ref-for-number-value\u2465" }, { "id": "ref-for-number-value\u2466" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-number-value\u2467" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }, { "refs": [{ "id": "ref-for-number-value\u2468" }, { "id": "ref-for-number-value\u2460\u24ea" }, { "id": "ref-for-number-value\u2460\u2460" }], "title": "6.3. ICtCp" }, { "refs": [{ "id": "ref-for-number-value\u2460\u2461" }, { "id": "ref-for-number-value\u2460\u2462" }, { "id": "ref-for-number-value\u2460\u2463" }], "title": "6.4. Jzazbz" }, { "refs": [{ "id": "ref-for-number-value\u2460\u2464" }, { "id": "ref-for-number-value\u2460\u2465" }, { "id": "ref-for-number-value\u2460\u2466" }, { "id": "ref-for-number-value\u2460\u2467" }], "title": "6.5. JzCzhz" }, { "refs": [{ "id": "ref-for-number-value\u2460\u2468" }], "title": "10.1. \nSerializing values of the color() function" }], "url": "https://www.w3.org/TR/css-values-4/#number-value" },
                "795f4c8b": { "dfnID": "795f4c8b", "dfnText": "luminance", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-luminance" }], "title": "2.1. Defining Dynamic Range" }, { "refs": [{ "id": "ref-for-luminance\u2460" }], "title": "2.2. Introducing Headroom" }], "url": "https://www.w3.org/TR/css-color-4/#luminance" },
                "8a110a7b": { "dfnID": "8a110a7b", "dfnText": "CSS-wide keywords", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-css-wide-keywords" }], "title": "1.1. Value Definitions" }], "url": "https://www.w3.org/TR/css-values-4/#css-wide-keywords" },
                "8c8e51b4": { "dfnID": "8c8e51b4", "dfnText": "computed value", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-computed-value" }], "title": "10.1. \nSerializing values of the color() function" }], "url": "https://www.w3.org/TR/css-cascade-5/#computed-value" },
                "9b2c9faa": { "dfnID": "9b2c9faa", "dfnText": "lch()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-lch" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-5/#funcdef-lch" },
                "absolute-d65-cie-xyz": { "dfnID": "absolute-d65-cie-xyz", "dfnText": "Absolute D65 CIE XYZ", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-absolute-d65-cie-xyz" }, { "id": "ref-for-absolute-d65-cie-xyz\u2460" }], "title": "5.1. \n\tInterpolating colors based on headroom\n" }], "url": "#absolute-d65-cie-xyz" },
                "b3bfee63": { "dfnID": "b3bfee63", "dfnText": "xyz-d65", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-valdef-color-xyz-d65" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }], "url": "https://www.w3.org/TR/css-color-4/#valdef-color-xyz-d65" },
                "b786b3c1": { "dfnID": "b786b3c1", "dfnText": "relative color", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-relative-color" }], "title": "6.3. ICtCp" }, { "refs": [{ "id": "ref-for-relative-color\u2460" }], "title": "6.4. Jzazbz" }, { "refs": [{ "id": "ref-for-relative-color\u2461" }], "title": "6.5. JzCzhz" }], "url": "https://www.w3.org/TR/css-color-5/#relative-color" },
                "bd774466": { "dfnID": "bd774466", "dfnText": "sRGB", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-sRGB-space" }, { "id": "ref-for-sRGB-space\u2460" }], "title": "2.1. Defining Dynamic Range" }], "url": "https://www.w3.org/TR/css-color-4/#sRGB-space" },
                "bdb4e757": { "dfnID": "bdb4e757", "dfnText": "&&", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-comb-all" }], "title": "3.2. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-comb-all\u2460" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }], "url": "https://www.w3.org/TR/css-values-4/#comb-all" },
                "c1a0e909": { "dfnID": "c1a0e909", "dfnText": "d65", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-d65" }], "title": "6.1. \n\tIntroducing ICtCp\n" }, { "refs": [{ "id": "ref-for-d65\u2460" }], "title": "6.3. ICtCp" }, { "refs": [{ "id": "ref-for-d65\u2461" }, { "id": "ref-for-d65\u2462" }], "title": "6.4. Jzazbz" }, { "refs": [{ "id": "ref-for-d65\u2463" }], "title": "6.5. JzCzhz" }, { "refs": [{ "id": "ref-for-d65\u2464" }], "title": "8.1. rec2100-pq" }, { "refs": [{ "id": "ref-for-d65\u2465" }], "title": "8.2. rec2100-hlg" }, { "refs": [{ "id": "ref-for-d65\u2466" }], "title": "8.3. rec2100-linear" }], "url": "https://www.w3.org/TR/css-color-4/#d65" },
                "c297b070": { "dfnID": "c297b070", "dfnText": "#", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-comma" }], "title": "3.2. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-mult-comma\u2460" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }], "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
                "color-re-rendering": { "dfnID": "color-re-rendering", "dfnText": "color re-rendering", "external": false, "refSections": [], "url": "#color-re-rendering" },
                "d04b6986": { "dfnID": "d04b6986", "dfnText": "<color>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-color" }, { "id": "ref-for-typedef-color\u2460" }, { "id": "ref-for-typedef-color\u2461" }, { "id": "ref-for-typedef-color\u2462" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-typedef-color\u2463" }, { "id": "ref-for-typedef-color\u2464" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }, { "refs": [{ "id": "ref-for-typedef-color\u2465" }], "title": "10. \nSerializing <color> Values" }], "url": "https://www.w3.org/TR/css-color-5/#typedef-color" },
                "d4441b24": { "dfnID": "d4441b24", "dfnText": "?", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-mult-opt" }, { "id": "ref-for-mult-opt\u2460" }, { "id": "ref-for-mult-opt\u2461" }, { "id": "ref-for-mult-opt\u2462" }, { "id": "ref-for-mult-opt\u2463" }, { "id": "ref-for-mult-opt\u2464" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-mult-opt\u2465" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }], "url": "https://www.w3.org/TR/css-values-4/#mult-opt" },
                "daabf294": { "dfnID": "daabf294", "dfnText": "rgb()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-rgb" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-4/#funcdef-rgb" },
                "deb378dd": { "dfnID": "deb378dd", "dfnText": "oklab()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-oklab" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-5/#funcdef-oklab" },
                "dynamic-range": { "dfnID": "dynamic-range", "dfnText": "Dynamic range", "external": false, "refSections": [], "url": "#dynamic-range" },
                "e5db470f": { "dfnID": "e5db470f", "dfnText": "<alpha-value>", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-typedef-color-alpha-value" }, { "id": "ref-for-typedef-color-alpha-value\u2460" }, { "id": "ref-for-typedef-color-alpha-value\u2461" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" },
                "f1cce64a": { "dfnID": "f1cce64a", "dfnText": "lab()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-lab" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-5/#funcdef-lab" },
                "f3226176": { "dfnID": "f3226176", "dfnText": "rgba()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-rgba" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-4/#funcdef-rgba" },
                "f4b08404": { "dfnID": "f4b08404", "dfnText": "required conversion", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-required-conversion" }, { "id": "ref-for-required-conversion\u2460" }], "title": "6.3. ICtCp" }, { "refs": [{ "id": "ref-for-required-conversion\u2461" }, { "id": "ref-for-required-conversion\u2462" }], "title": "6.4. Jzazbz" }, { "refs": [{ "id": "ref-for-required-conversion\u2463" }, { "id": "ref-for-required-conversion\u2464" }, { "id": "ref-for-required-conversion\u2465" }], "title": "6.5. JzCzhz" }], "url": "https://drafts.csswg.org/css-color-5/#required-conversion" },
                "f6f69187": { "dfnID": "f6f69187", "dfnText": "color space", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-color-space" }], "title": "7. \n\tSpecifying Predefined and Custom Color Spaces: the color() Function\n" }], "url": "https://www.w3.org/TR/css-color-4/#color-space" },
                "f7f2e8bc": { "dfnID": "f7f2e8bc", "dfnText": "hwb()", "external": true, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-hwb" }], "title": "4. The <color> syntax" }], "url": "https://www.w3.org/TR/css-color-5/#funcdef-hwb" },
                "funcdef-dynamic-range-limit-mix": { "dfnID": "funcdef-dynamic-range-limit-mix", "dfnText": "dynamic-range-limit-mix()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-dynamic-range-limit-mix" }, { "id": "ref-for-funcdef-dynamic-range-limit-mix\u2460" }], "title": "3.1. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-funcdef-dynamic-range-limit-mix\u2461" }], "title": "3.2. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-funcdef-dynamic-range-limit-mix\u2462" }, { "id": "ref-for-funcdef-dynamic-range-limit-mix\u2463" }], "title": "3.3. \n\tComputed Value for dynamic-range-limit\n" }], "url": "#funcdef-dynamic-range-limit-mix" },
                "funcdef-hdr-color": { "dfnID": "funcdef-hdr-color", "dfnText": "hdr-color()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-hdr-color" }, { "id": "ref-for-funcdef-hdr-color\u2460" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }, { "refs": [{ "id": "ref-for-funcdef-hdr-color\u2461" }], "title": "11.6. \n\tSample code for hdr-color()\n" }], "url": "#funcdef-hdr-color" },
                "funcdef-ictcp": { "dfnID": "funcdef-ictcp", "dfnText": "ictcp()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-ictcp" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-funcdef-ictcp\u2460" }], "title": "6.3. ICtCp" }], "url": "#funcdef-ictcp" },
                "funcdef-jzazbz": { "dfnID": "funcdef-jzazbz", "dfnText": "jzazbz()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-jzazbz" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-funcdef-jzazbz\u2460" }], "title": "6.4. Jzazbz" }], "url": "#funcdef-jzazbz" },
                "funcdef-jzczhz": { "dfnID": "funcdef-jzczhz", "dfnText": "jzczhz()", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-funcdef-jzczhz" }], "title": "4. The <color> syntax" }, { "refs": [{ "id": "ref-for-funcdef-jzczhz\u2460" }], "title": "6.5. JzCzhz" }], "url": "#funcdef-jzczhz" },
                "hdr-headroom": { "dfnID": "hdr-headroom", "dfnText": "HDR headroom", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-hdr-headroom" }], "title": "2.2. Introducing Headroom" }, { "refs": [{ "id": "ref-for-hdr-headroom\u2460" }, { "id": "ref-for-hdr-headroom\u2461" }, { "id": "ref-for-hdr-headroom\u2462" }], "title": "5. HDR colors parameterized by headroom: the hdr-color() function" }, { "refs": [{ "id": "ref-for-hdr-headroom\u2463" }], "title": "Privacy Considerations" }], "url": "#hdr-headroom" },
                "hdr-reference-white": { "dfnID": "hdr-reference-white", "dfnText": "HDR reference white", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-hdr-reference-white" }], "title": "2.1. Defining Dynamic Range" }, { "refs": [{ "id": "ref-for-hdr-reference-white\u2460" }], "title": "8.3. rec2100-linear" }], "url": "#hdr-reference-white" },
                "high-dynamic-range": { "dfnID": "high-dynamic-range", "dfnText": "High Dynamic Range", "external": false, "refSections": [], "url": "#high-dynamic-range" },
                "ictcp": { "dfnID": "ictcp", "dfnText": "ICtCp", "external": false, "refSections": [], "url": "#ictcp" },
                "jzazbz": { "dfnID": "jzazbz", "dfnText": "Jzazbz", "external": false, "refSections": [], "url": "#jzazbz" },
                "jzczhz": { "dfnID": "jzczhz", "dfnText": "JzCzhz", "external": false, "refSections": [], "url": "#jzczhz" },
                "propdef-dynamic-range-limit": { "dfnID": "propdef-dynamic-range-limit", "dfnText": "dynamic-range-limit", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-propdef-dynamic-range-limit" }], "title": "3.1. The dynamic-range-limit property" }, { "refs": [{ "id": "ref-for-propdef-dynamic-range-limit\u2460" }, { "id": "ref-for-propdef-dynamic-range-limit\u2461" }], "title": "3.2. Mixing Dynamic Range Limits: the dynamic-range-limit-mix() function" }, { "refs": [{ "id": "ref-for-propdef-dynamic-range-limit\u2462" }], "title": "3.3. \n\tComputed Value for dynamic-range-limit\n" }], "url": "#propdef-dynamic-range-limit" },
                "rec2100-hlg": { "dfnID": "rec2100-hlg", "dfnText": "rec2100-hlg", "external": false, "refSections": [], "url": "#rec2100-hlg" },
                "rec2100-linear": { "dfnID": "rec2100-linear", "dfnText": "rec2100-linear", "external": false, "refSections": [], "url": "#rec2100-linear" },
                "rec2100-pq": { "dfnID": "rec2100-pq", "dfnText": "rec2100-pq", "external": false, "refSections": [], "url": "#rec2100-pq" },
                "standard-dynamic-range": { "dfnID": "standard-dynamic-range", "dfnText": "Standard Dynamic Range", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-standard-dynamic-range" }], "title": "2.2. Introducing Headroom" }], "url": "#standard-dynamic-range" },
                "typedef-color-function": { "dfnID": "typedef-color-function", "dfnText": "<color-function>", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-typedef-color-function" }], "title": "4. The <color> syntax" }], "url": "#typedef-color-function" },
                "typedef-predefined-rgb": { "dfnID": "typedef-predefined-rgb", "dfnText": "<predefined-rgb>", "external": false, "refSections": [], "url": "#typedef-predefined-rgb" },
                "valdef-dynamic-range-limit-constrained": { "dfnID": "valdef-dynamic-range-limit-constrained", "dfnText": "constrained", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-constrained" }, { "id": "ref-for-valdef-dynamic-range-limit-constrained\u2460" }, { "id": "ref-for-valdef-dynamic-range-limit-constrained\u2461" }, { "id": "ref-for-valdef-dynamic-range-limit-constrained\u2462" }], "title": "3.3. \n\tComputed Value for dynamic-range-limit\n" }, { "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-constrained\u2463" }], "title": "Accessibility Considerations" }], "url": "#valdef-dynamic-range-limit-constrained" },
                "valdef-dynamic-range-limit-no-limit": { "dfnID": "valdef-dynamic-range-limit-no-limit", "dfnText": "no-limit", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-no-limit" }, { "id": "ref-for-valdef-dynamic-range-limit-no-limit\u2460" }, { "id": "ref-for-valdef-dynamic-range-limit-no-limit\u2461" }, { "id": "ref-for-valdef-dynamic-range-limit-no-limit\u2462" }], "title": "3.3. \n\tComputed Value for dynamic-range-limit\n" }], "url": "#valdef-dynamic-range-limit-no-limit" },
                "valdef-dynamic-range-limit-standard": { "dfnID": "valdef-dynamic-range-limit-standard", "dfnText": "standard", "external": false, "refSections": [{ "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-standard" }, { "id": "ref-for-valdef-dynamic-range-limit-standard\u2460" }, { "id": "ref-for-valdef-dynamic-range-limit-standard\u2461" }, { "id": "ref-for-valdef-dynamic-range-limit-standard\u2462" }], "title": "3.3. \n\tComputed Value for dynamic-range-limit\n" }, { "refs": [{ "id": "ref-for-valdef-dynamic-range-limit-standard\u2463" }], "title": "Accessibility Considerations" }], "url": "#valdef-dynamic-range-limit-standard" },
                "valdef-ictcp-alpha": { "dfnID": "valdef-ictcp-alpha", "dfnText": "alpha", "external": false, "refSections": [], "url": "#valdef-ictcp-alpha" },
                "valdef-ictcp-cp": { "dfnID": "valdef-ictcp-cp", "dfnText": "cp", "external": false, "refSections": [], "url": "#valdef-ictcp-cp" },
                "valdef-ictcp-ct": { "dfnID": "valdef-ictcp-ct", "dfnText": "ct", "external": false, "refSections": [], "url": "#valdef-ictcp-ct" },
                "valdef-ictcp-i": { "dfnID": "valdef-ictcp-i", "dfnText": "i", "external": false, "refSections": [], "url": "#valdef-ictcp-i" },
                "valdef-jzazbz-a": { "dfnID": "valdef-jzazbz-a", "dfnText": "a", "external": false, "refSections": [], "url": "#valdef-jzazbz-a" },
                "valdef-jzazbz-alpha": { "dfnID": "valdef-jzazbz-alpha", "dfnText": "alpha", "external": false, "refSections": [], "url": "#valdef-jzazbz-alpha" },
                "valdef-jzazbz-b": { "dfnID": "valdef-jzazbz-b", "dfnText": "b", "external": false, "refSections": [], "url": "#valdef-jzazbz-b" },
                "valdef-jzazbz-j": { "dfnID": "valdef-jzazbz-j", "dfnText": "j", "external": false, "refSections": [], "url": "#valdef-jzazbz-j" },
                "valdef-jzczhz-alpha": { "dfnID": "valdef-jzczhz-alpha", "dfnText": "alpha", "external": false, "refSections": [], "url": "#valdef-jzczhz-alpha" },
                "valdef-jzczhz-c": { "dfnID": "valdef-jzczhz-c", "dfnText": "c", "external": false, "refSections": [], "url": "#valdef-jzczhz-c" },
                "valdef-jzczhz-h": { "dfnID": "valdef-jzczhz-h", "dfnText": "h", "external": false, "refSections": [], "url": "#valdef-jzczhz-h" },
                "valdef-jzczhz-j": { "dfnID": "valdef-jzczhz-j", "dfnText": "j", "external": false, "refSections": [], "url": "#valdef-jzczhz-j" },
            };

            document.addEventListener("DOMContentLoaded", () => {
                genAllDfnPanels();

                document.body.addEventListener("click", (e) => {
                    // If not handled already, just hide all dfn panels.
                    hideAllDfnPanels();
                });
            });

            window.addEventListener("resize", () => {
                // Pin any visible dfn panel
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el => positionDfnPanel(el));
            });

            function genAllDfnPanels() {
                for (const panelData of Object.values(dfnPanelData)) {
                    const dfnID = panelData.dfnID;
                    const dfn = document.getElementById(dfnID);
                    if (!dfn) {
                        console.log(`Can't find dfn#${dfnID}.`, panelData);
                        continue;
                    }
                    dfn.panelData = panelData;
                    insertDfnPopupAction(dfn);
                }
            }

            function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
                const dfnPanel = mk.aside({
                    class: "dfn-panel on",
                    id: `infopanel-for-${dfnID}`,
                    "data-for": dfnID,
                    "aria-labelled-by": `infopaneltitle-for-${dfnID}`,
                },
                    mk.span({ id: `infopaneltitle-for-${dfnID}`, style: "display:none" },
                        `Info about the '${dfnText}' ${external ? "external" : ""} reference.`),
                    mk.a({ href: url, class: "dfn-link" }, url),
                    refSections.length == 0 ? [] :
                        mk.b({}, "Referenced in:"),
                    mk.ul({},
                        ...refSections.map(section =>
                            mk.li({},
                                ...section.refs.map((ref, refI) =>
                                    [
                                        mk.a({ href: `#${ref.id}` },
                                            (refI == 0) ? section.title : `(${refI + 1})`
                                        ),
                                        " ",
                                    ]
                                ),
                            ),
                        ),
                    ),
                    genLinkingSyntaxes(dfn),
                );

                dfnPanel.addEventListener('click', (event) => {
                    if (event.target.nodeName == 'A') {
                        scrollToTargetAndHighlight(event);
                        pinDfnPanel(dfnPanel);
                    }
                    event.stopPropagation();
                    refocusOnTarget(event);
                });
                dfnPanel.addEventListener('keydown', (event) => {
                    if (event.keyCode == 27) { // Escape key
                        hideDfnPanel({ dfnPanel });
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });

                dfnPanel.dfn = dfn;
                dfn.dfnPanel = dfnPanel;
                return dfnPanel;
            }



            function hideAllDfnPanels() {
                // Delete the currently-active dfn panel.
                queryAll(".dfn-panel").forEach(dfnPanel => hideDfnPanel({ dfnPanel }));
            }

            function showDfnPanel(dfn) {
                hideAllDfnPanels(); // Only display one at a time.

                dfn.setAttribute("aria-expanded", "true");

                const dfnPanel = genDfnPanel(dfn, dfn.panelData);

                // Give the dfn a unique tabindex, and then
                // give all the tabbable panel bits successive indexes.
                let tabIndex = 100;
                dfn.tabIndex = tabIndex++;
                const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
                for (const el of tabbable) {
                    el.tabIndex = tabIndex++;
                }

                append(document.body, dfnPanel);
                positionDfnPanel(dfnPanel);
            }

            function positionDfnPanel(dfnPanel) {
                const dfn = dfnPanel.dfn;
                const dfnPos = getBounds(dfn);
                dfnPanel.style.top = dfnPos.bottom + "px";
                dfnPanel.style.left = dfnPos.left + "px";

                const panelPos = dfnPanel.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
                    dfnPanel.style.left = newLeft + "px";
                }
            }

            function pinDfnPanel(dfnPanel) {
                // Switch it to "activated" state, which pins it.
                dfnPanel.classList.add("activated");
                dfnPanel.style.position = "fixed";
                dfnPanel.style.left = null;
                dfnPanel.style.top = null;
            }

            function hideDfnPanel({ dfn, dfnPanel }) {
                if (!dfnPanel) dfnPanel = dfn.dfnPanel;
                if (!dfn) dfn = dfnPanel.dfn;
                dfn.dfnPanel = undefined;
                dfnPanel.dfn = undefined;
                dfn.setAttribute("aria-expanded", "false");
                dfn.tabIndex = undefined;
                dfnPanel.remove()
            }

            function toggleDfnPanel(dfn) {
                if (dfn.dfnPanel) {
                    hideDfnPanel(dfn);
                } else {
                    showDfnPanel(dfn);
                }
            }

            function insertDfnPopupAction(dfn) {
                dfn.setAttribute('role', 'button');
                dfn.setAttribute('aria-expanded', 'false')
                dfn.tabIndex = 0;
                dfn.classList.add('has-dfn-panel');
                dfn.addEventListener('click', (event) => {
                    toggleDfnPanel(dfn);
                    event.stopPropagation();
                });
                dfn.addEventListener('keypress', (event) => {
                    const kc = event.keyCode;
                    // 32->Space, 13->Enter
                    if (kc == 32 || kc == 13) {
                        toggleDfnPanel(dfn);
                        event.stopPropagation();
                        event.preventDefault();
                    }
                });
            }

            function refocusOnTarget(event) {
                const target = event.target;
                setTimeout(() => {
                    // Refocus on the event.target element.
                    // This is needed after browser scrolls to the destination.
                    target.focus();
                });
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function scrollToTargetAndHighlight(event) {
                let hash = event.target.hash;
                if (hash) {
                    hash = decodeURIComponent(hash.substring(1));
                    const dest = document.getElementById(hash);
                    if (dest) {
                        dest.classList.add('highlighted');
                        setTimeout(() => dest.classList.remove('highlighted'), 1000);
                    }
                }
            }

            // Functions, divided by link type, that wrap an autolink's
            // contents with the appropriate outer syntax.
            // Alternately, a string naming another type they format
            // the same as.
            function needsFor(type) {
                switch (type) {
                    case "descriptor":
                    case "value":
                    case "element-attr":
                    case "attr-value":
                    case "element-state":
                    case "method":
                    case "constructor":
                    case "argument":
                    case "attribute":
                    case "const":
                    case "dict-member":
                    case "event":
                    case "enum-value":
                    case "stringifier":
                    case "serializer":
                    case "iterator":
                    case "maplike":
                    case "setlike":
                    case "state":
                    case "mode":
                    case "context":
                    case "facet": return true;

                    default: return false;
                }
            }
            function refusesFor(type) {
                switch (type) {
                    case "property":
                    case "element":
                    case "interface":
                    case "namespace":
                    case "callback":
                    case "dictionary":
                    case "enum":
                    case "exception":
                    case "typedef":
                    case "http-header":
                    case "permission": return true;

                    default: return false;
                }
            }
            function linkFormatterFromType(type) {
                switch (type) {
                    case 'scheme':
                    case 'permission':
                    case 'dfn': return (text) => `[=${text}=]`;

                    case 'abstract-op': return (text) => `[\$${text}\$]`;

                    case 'function':
                    case 'at-rule':
                    case 'selector':
                    case 'value': return (text) => `''${text}''`;

                    case 'http-header': return (text) => `[:${text}:]`;

                    case 'interface':
                    case 'constructor':
                    case 'method':
                    case 'argument':
                    case 'attribute':
                    case 'callback':
                    case 'dictionary':
                    case 'dict-member':
                    case 'enum':
                    case 'enum-value':
                    case 'exception':
                    case 'const':
                    case 'typedef':
                    case 'stringifier':
                    case 'serializer':
                    case 'iterator':
                    case 'maplike':
                    case 'setlike':
                    case 'extended-attribute':
                    case 'event':
                    case 'idl': return (text) => `{{${text}}}`;

                    case 'element-state':
                    case 'element-attr':
                    case 'attr-value':
                    case 'element': return (element) => `<{${element}}>`;

                    case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

                    case 'type': return (text) => `<<${text}>>`;

                    case 'descriptor':
                    case 'property': return (text) => `'${text}'`;

                    default: return;
                };
            };

            function genLinkingSyntaxes(dfn) {
                if (dfn.tagName != "DFN") return;

                const type = dfn.getAttribute('data-dfn-type');
                if (!type) {
                    console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
                    return [];
                }

                // Return a function that wraps link text based on the type
                const linkFormatter = linkFormatterFromType(type);
                if (!linkFormatter) {
                    console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
                    return [];
                }

                let ltAlts;
                if (dfn.hasAttribute('data-lt')) {
                    ltAlts = dfn.getAttribute('data-lt')
                        .split("|")
                        .map(x => x.trim());
                } else {
                    ltAlts = [dfn.textContent.trim()];
                }
                if (type == "type") {
                    // lt of "<foo>", but "foo" is the interior;
                    // <<foo/bar>> is how you write it with a for,
                    // not <foo/<bar>> or whatever.
                    for (var i = 0; i < ltAlts.length; i++) {
                        const lt = ltAlts[i];
                        const match = /<(.*)>/.exec(lt);
                        if (match) { ltAlts[i] = match[1]; }
                    }
                }

                let forAlts;
                if (dfn.hasAttribute('data-dfn-for')) {
                    forAlts = dfn.getAttribute('data-dfn-for')
                        .split(",")
                        .map(x => x.trim());
                } else {
                    forAlts = [''];
                }

                let linkingSyntaxes = [];
                if (!needsFor(type)) {
                    for (const lt of ltAlts) {
                        linkingSyntaxes.push(linkFormatter(lt));
                    }
                }
                if (!refusesFor(type)) {
                    for (const f of forAlts) {
                        linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
                    }
                }
                return [
                    mk.b({}, 'Possible linking syntaxes:'),
                    mk.ul({},
                        ...linkingSyntaxes.map(link => {
                            const copyLink = async () =>
                                await navigator.clipboard.writeText(link);
                            return mk.li({},
                                mk.div({ class: 'link-item' },
                                    mk.button({
                                        class: 'copy-icon', title: 'Copy',
                                        type: 'button',
                                        _onclick: copyLink,
                                        tabindex: 0,
                                    }, mk.span({ class: 'icon' })),
                                    mk.span({}, link)
                                )
                            );
                        })
                    )
                ];
            }
        }
    </script>
    <script>/* Boilerplate: script-link-titles */
        "use strict";
        {
            let linkTitleData = {
                "https://www.w3.org/TR/css-color-5/#typedef-color": "Expands to: <alpha-value> | aliceblue | antiquewhite | aqua | aquamarine | azure | beige | bisque | black | blanchedalmond | blue | blueviolet | brown | burlywood | cadetblue | chartreuse | chocolate | coral | cornflowerblue | cornsilk | crimson | currentcolor | cyan | darkblue | darkcyan | darkgoldenrod | darkgray | darkgreen | darkgrey | darkkhaki | darkmagenta | darkolivegreen | darkorange | darkorchid | darkred | darksalmon | darkseagreen | darkslateblue | darkslategray | darkslategrey | darkturquoise | darkviolet | deeppink | deepskyblue | dimgray | dimgrey | dodgerblue | firebrick | floralwhite | forestgreen | fuchsia | gainsboro | ghostwhite | gold | goldenrod | gray | green | greenyellow | grey | honeydew | hotpink | indianred | indigo | ivory | khaki | lavender | lavenderblush | lawngreen | lemonchiffon | lightblue | lightcoral | lightcyan | lightgoldenrodyellow | lightgray | lightgreen | lightgrey | lightpink | lightsalmon | lightseagreen | lightskyblue | lightslategray | lightslategrey | lightsteelblue | lightyellow | lime | limegreen | linen | magenta | maroon | mediumaquamarine | mediumblue | mediumorchid | mediumpurple | mediumseagreen | mediumslateblue | mediumspringgreen | mediumturquoise | mediumvioletred | midnightblue | mintcream | mistyrose | moccasin | navajowhite | navy | none | oldlace | olive | olivedrab | orange | orangered | orchid | palegoldenrod | palegreen | paleturquoise | palevioletred | papayawhip | peachpuff | peru | pink | plum | powderblue | purple | rebeccapurple | red | rosybrown | royalblue | saddlebrown | salmon | sandybrown | seagreen | seashell | sienna | silver | skyblue | slateblue | slategray | slategrey | snow | springgreen | steelblue | tan | teal | thistle | tomato | transparent | turquoise | violet | wheat | white | whitesmoke | yellow | yellowgreen",
            };

            function setTypeTitles() {
                for (let el of document.querySelectorAll("a[href]")) {
                    if (el.href in linkTitleData && !el.hasAttribute("title")) {
                        el.setAttribute("title", linkTitleData[el.href]);
                    }
                }
            }

            document.addEventListener("DOMContentLoaded", setTypeTitles);
        }
    </script>
    <script>/* Boilerplate: script-ref-hints */
        "use strict";
        {
            let refsData = {
                "#absolute-d65-cie-xyz": { "displayText": "absolute d65 cie xyz", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "absolute d65 cie xyz", "type": "dfn", "url": "#absolute-d65-cie-xyz" },
                "#funcdef-dynamic-range-limit-mix": { "displayText": "dynamic-range-limit-mix()", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "dynamic-range-limit-mix()", "type": "function", "url": "#funcdef-dynamic-range-limit-mix" },
                "#funcdef-hdr-color": { "displayText": "hdr-color()", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "hdr-color()", "type": "function", "url": "#funcdef-hdr-color" },
                "#funcdef-ictcp": { "displayText": "ictcp()", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "ictcp()", "type": "function", "url": "#funcdef-ictcp" },
                "#funcdef-jzazbz": { "displayText": "jzazbz()", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "jzazbz()", "type": "function", "url": "#funcdef-jzazbz" },
                "#funcdef-jzczhz": { "displayText": "jzczhz()", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "jzczhz()", "type": "function", "url": "#funcdef-jzczhz" },
                "#hdr-headroom": { "displayText": "hdr headroom", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "hdr headroom", "type": "dfn", "url": "#hdr-headroom" },
                "#hdr-reference-white": { "displayText": "hdr reference white", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "hdr reference white", "type": "dfn", "url": "#hdr-reference-white" },
                "#propdef-dynamic-range-limit": { "displayText": "dynamic-range-limit", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "dynamic-range-limit", "type": "property", "url": "#propdef-dynamic-range-limit" },
                "#standard-dynamic-range": { "displayText": "standard dynamic range", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "standard dynamic range", "type": "dfn", "url": "#standard-dynamic-range" },
                "#typedef-color-function": { "displayText": "<color-function>", "export": true, "for_": [], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "<color-function>", "type": "type", "url": "#typedef-color-function" },
                "#valdef-dynamic-range-limit-constrained": { "displayText": "constrained", "export": true, "for_": ["dynamic-range-limit"], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "constrained", "type": "value", "url": "#valdef-dynamic-range-limit-constrained" },
                "#valdef-dynamic-range-limit-no-limit": { "displayText": "no-limit", "export": true, "for_": ["dynamic-range-limit"], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "no-limit", "type": "value", "url": "#valdef-dynamic-range-limit-no-limit" },
                "#valdef-dynamic-range-limit-standard": { "displayText": "standard", "export": true, "for_": ["dynamic-range-limit"], "level": "1", "normative": true, "shortname": "css-color-hdr", "spec": "css-color-hdr-1", "status": "local", "text": "standard", "type": "value", "url": "#valdef-dynamic-range-limit-standard" },
                "https://drafts.csswg.org/css-color-5/#funcdef-alpha": { "displayText": "alpha()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "current", "text": "alpha()", "type": "function", "url": "https://drafts.csswg.org/css-color-5/#funcdef-alpha" },
                "https://drafts.csswg.org/css-color-5/#required-conversion": { "displayText": "required conversion", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "current", "text": "required conversion", "type": "dfn", "url": "https://drafts.csswg.org/css-color-5/#required-conversion" },
                "https://www.w3.org/TR/css-cascade-5/#computed-value": { "displayText": "computed value", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-cascade", "spec": "css-cascade-5", "status": "snapshot", "text": "computed value", "type": "dfn", "url": "https://www.w3.org/TR/css-cascade-5/#computed-value" },
                "https://www.w3.org/TR/css-color-4/#color-space": { "displayText": "color space", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "color space", "type": "dfn", "url": "https://www.w3.org/TR/css-color-4/#color-space" },
                "https://www.w3.org/TR/css-color-4/#d65": { "displayText": "d65", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "d65", "type": "dfn", "url": "https://www.w3.org/TR/css-color-4/#d65" },
                "https://www.w3.org/TR/css-color-4/#funcdef-hsl": { "displayText": "hsl()", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "hsl()", "type": "function", "url": "https://www.w3.org/TR/css-color-4/#funcdef-hsl" },
                "https://www.w3.org/TR/css-color-4/#funcdef-hsla": { "displayText": "hsla()", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "hsla()", "type": "function", "url": "https://www.w3.org/TR/css-color-4/#funcdef-hsla" },
                "https://www.w3.org/TR/css-color-4/#funcdef-rgb": { "displayText": "rgb()", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "rgb()", "type": "function", "url": "https://www.w3.org/TR/css-color-4/#funcdef-rgb" },
                "https://www.w3.org/TR/css-color-4/#funcdef-rgba": { "displayText": "rgba()", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "rgba()", "type": "function", "url": "https://www.w3.org/TR/css-color-4/#funcdef-rgba" },
                "https://www.w3.org/TR/css-color-4/#luminance": { "displayText": "luminance", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "luminance", "type": "dfn", "url": "https://www.w3.org/TR/css-color-4/#luminance" },
                "https://www.w3.org/TR/css-color-4/#sRGB-space": { "displayText": "sRGB", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "srgb", "type": "dfn", "url": "https://www.w3.org/TR/css-color-4/#sRGB-space" },
                "https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value": { "displayText": "<alpha-value>", "export": true, "for_": ["<color>"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "<alpha-value>", "type": "type", "url": "https://www.w3.org/TR/css-color-4/#typedef-color-alpha-value" },
                "https://www.w3.org/TR/css-color-4/#typedef-hue": { "displayText": "<hue>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "<hue>", "type": "type", "url": "https://www.w3.org/TR/css-color-4/#typedef-hue" },
                "https://www.w3.org/TR/css-color-4/#valdef-color-none": { "displayText": "none", "export": true, "for_": ["<color>"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "none", "type": "value", "url": "https://www.w3.org/TR/css-color-4/#valdef-color-none" },
                "https://www.w3.org/TR/css-color-4/#valdef-color-white": { "displayText": "white", "export": true, "for_": ["<color>", "<named-color>"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "white", "type": "value", "url": "https://www.w3.org/TR/css-color-4/#valdef-color-white" },
                "https://www.w3.org/TR/css-color-4/#valdef-color-xyz-d65": { "displayText": "xyz-d65", "export": true, "for_": ["color()"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "xyz-d65", "type": "value", "url": "https://www.w3.org/TR/css-color-4/#valdef-color-xyz-d65" },
                "https://www.w3.org/TR/css-color-4/#valdef-lab-lab": { "displayText": "lab", "export": true, "for_": ["lab()"], "level": "4", "normative": true, "shortname": "css-color", "spec": "css-color-4", "status": "snapshot", "text": "lab", "type": "value", "url": "https://www.w3.org/TR/css-color-4/#valdef-lab-lab" },
                "https://www.w3.org/TR/css-color-5/#component-keyword": { "displayText": "component keyword", "export": false, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "component keyword", "type": "dfn", "url": "https://www.w3.org/TR/css-color-5/#component-keyword" },
                "https://www.w3.org/TR/css-color-5/#funcdef-color": { "displayText": "color()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "color()", "type": "function", "url": "https://www.w3.org/TR/css-color-5/#funcdef-color" },
                "https://www.w3.org/TR/css-color-5/#funcdef-hwb": { "displayText": "hwb()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "hwb()", "type": "function", "url": "https://www.w3.org/TR/css-color-5/#funcdef-hwb" },
                "https://www.w3.org/TR/css-color-5/#funcdef-lab": { "displayText": "lab()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "lab()", "type": "function", "url": "https://www.w3.org/TR/css-color-5/#funcdef-lab" },
                "https://www.w3.org/TR/css-color-5/#funcdef-lch": { "displayText": "lch()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "lch()", "type": "function", "url": "https://www.w3.org/TR/css-color-5/#funcdef-lch" },
                "https://www.w3.org/TR/css-color-5/#funcdef-oklab": { "displayText": "oklab()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "oklab()", "type": "function", "url": "https://www.w3.org/TR/css-color-5/#funcdef-oklab" },
                "https://www.w3.org/TR/css-color-5/#funcdef-oklch": { "displayText": "oklch()", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "oklch()", "type": "function", "url": "https://www.w3.org/TR/css-color-5/#funcdef-oklch" },
                "https://www.w3.org/TR/css-color-5/#origin-color": { "displayText": "origin color", "export": false, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "origin color", "type": "dfn", "url": "https://www.w3.org/TR/css-color-5/#origin-color" },
                "https://www.w3.org/TR/css-color-5/#relative-color": { "displayText": "relative color", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "relative color", "type": "dfn", "url": "https://www.w3.org/TR/css-color-5/#relative-color" },
                "https://www.w3.org/TR/css-color-5/#typedef-color": { "displayText": "<color>", "export": true, "for_": [], "level": "5", "normative": true, "shortname": "css-color", "spec": "css-color-5", "status": "snapshot", "text": "<color>", "type": "type", "url": "https://www.w3.org/TR/css-color-5/#typedef-color" },
                "https://www.w3.org/TR/css-values-4/#comb-all": { "displayText": "&&", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "&&", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#comb-all" },
                "https://www.w3.org/TR/css-values-4/#comb-one": { "displayText": "|", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "|", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#comb-one" },
                "https://www.w3.org/TR/css-values-4/#css-wide-keywords": { "displayText": "CSS-wide keywords", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "css-wide keywords", "type": "dfn", "url": "https://www.w3.org/TR/css-values-4/#css-wide-keywords" },
                "https://www.w3.org/TR/css-values-4/#mult-comma": { "displayText": "#", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "#", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-comma" },
                "https://www.w3.org/TR/css-values-4/#mult-opt": { "displayText": "?", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "?", "type": "grammar", "url": "https://www.w3.org/TR/css-values-4/#mult-opt" },
                "https://www.w3.org/TR/css-values-4/#number-value": { "displayText": "<number>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "<number>", "type": "type", "url": "https://www.w3.org/TR/css-values-4/#number-value" },
                "https://www.w3.org/TR/css-values-4/#percentage-value": { "displayText": "<percentage>", "export": true, "for_": [], "level": "4", "normative": true, "shortname": "css-values", "spec": "css-values-4", "status": "snapshot", "text": "<percentage>", "type": "type", "url": "https://www.w3.org/TR/css-values-4/#percentage-value" },
            };

            function mkRefHint(link, ref) {
                const linkText = link.textContent;
                let dfnTextElements = '';
                if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
                    // Give the original term if it's being displayed in a different way.
                    // But allow casing differences, they're insignificant.
                    dfnTextElements =
                        mk.li({},
                            mk.b({}, "Term: "),
                            mk.span({}, ref.displayText)
                        );
                }
                const forList = ref.for_;
                let forListElements;
                if (forList.length == 0) {
                    forListElements = [];
                } else if (forList.length == 1) {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.span({}, forList[0]),
                    );
                } else {
                    forListElements = mk.li({},
                        mk.b({}, "For: "),
                        mk.ul({},
                            ...forList.map(forItem =>
                                mk.li({},
                                    mk.span({}, forItem)
                                ),
                            ),
                        ),
                    );
                }
                const url = ref.url;
                const safeUrl = encodeURIComponent(url);
                const hintPanel = mk.aside({
                    class: "ref-hint",
                    id: `ref-hint-for-${safeUrl}`,
                    "data-for": url,
                    "aria-labelled-by": `ref-hint-for-${safeUrl}`,
                },
                    mk.ul({},
                        dfnTextElements,
                        mk.li({},
                            mk.b({}, "URL: "),
                            mk.a({ href: url, class: "ref" }, url),
                        ),
                        mk.li({},
                            mk.b({}, "Type: "),
                            mk.span({}, `${ref.type}`),
                        ),
                        mk.li({},
                            mk.b({}, "Spec: "),
                            mk.span({}, `${ref.spec ? ref.spec : ''}`),
                        ),
                        forListElements
                    ),
                );
                hintPanel.forLink = link;
                setupRefHintEventListeners(link, hintPanel);
                return hintPanel;
            }

            function hideAllRefHints() {
                queryAll(".ref-hint").forEach(el => hideRefHint(el));
            }

            function hideRefHint(refHint) {
                const link = refHint.forLink;
                link.setAttribute("aria-expanded", "false");
                if (refHint.teardownEventListeners) {
                    refHint.teardownEventListeners();
                }
                refHint.remove();
            }

            function showRefHint(link) {
                if (link.classList.contains("dfn-link")) return;
                const url = link.getAttribute("href");
                const refHintKey = link.getAttribute("data-refhint-key");
                let key = url;
                if (refHintKey) {
                    key = refHintKey + "_" + url;
                }
                const ref = refsData[key];
                if (!ref) return;

                hideAllRefHints(); // Only display one at this time.

                const refHint = mkRefHint(link, ref);
                append(document.body, refHint);
                link.setAttribute("aria-expanded", "true");
                positionRefHint(refHint);
            }

            function setupRefHintEventListeners(link, refHint) {
                if (refHint.teardownEventListeners) return;
                // Add event handlers to hide the refHint after the user moves away
                // from both the link and refHint, if not hovering either within one second.
                let timeout = null;
                const startHidingRefHint = (event) => {
                    if (timeout) {
                        clearTimeout(timeout);
                    }
                    timeout = setTimeout(() => {
                        hideRefHint(refHint);
                    }, 1000);
                }
                const resetHidingRefHint = (event) => {
                    if (timeout) clearTimeout(timeout);
                    timeout = null;
                };
                link.addEventListener("mouseleave", startHidingRefHint);
                link.addEventListener("mouseenter", resetHidingRefHint);
                link.addEventListener("blur", startHidingRefHint);
                link.addEventListener("focus", resetHidingRefHint);
                refHint.addEventListener("mouseleave", startHidingRefHint);
                refHint.addEventListener("mouseenter", resetHidingRefHint);
                refHint.addEventListener("blur", startHidingRefHint);
                refHint.addEventListener("focus", resetHidingRefHint);

                refHint.teardownEventListeners = () => {
                    // remove event listeners
                    resetHidingRefHint();
                    link.removeEventListener("mouseleave", startHidingRefHint);
                    link.removeEventListener("mouseenter", resetHidingRefHint);
                    link.removeEventListener("blur", startHidingRefHint);
                    link.removeEventListener("focus", resetHidingRefHint);
                    refHint.removeEventListener("mouseleave", startHidingRefHint);
                    refHint.removeEventListener("mouseenter", resetHidingRefHint);
                    refHint.removeEventListener("blur", startHidingRefHint);
                    refHint.removeEventListener("focus", resetHidingRefHint);
                };
            }

            function positionRefHint(refHint) {
                const link = refHint.forLink;
                const linkPos = getBounds(link);
                refHint.style.top = linkPos.bottom + "px";
                refHint.style.left = linkPos.left + "px";

                const panelPos = refHint.getBoundingClientRect();
                const panelMargin = 8;
                const maxRight = document.body.parentNode.clientWidth - panelMargin;
                if (panelPos.right > maxRight) {
                    const overflowAmount = panelPos.right - maxRight;
                    const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
                    refHint.style.left = newLeft + "px";
                }
            }

            // TODO: shared util
            // Returns the root-level absolute position {left and top} of element.
            function getBounds(el, relativeTo = document.body) {
                const relativeRect = relativeTo.getBoundingClientRect();
                const elRect = el.getBoundingClientRect();
                const top = elRect.top - relativeRect.top;
                const left = elRect.left - relativeRect.left;
                return {
                    top,
                    left,
                    bottom: top + elRect.height,
                    right: left + elRect.width,
                }
            }

            function showRefHintListener(e) {
                // If the target isn't in a link (or is a link),
                // just ignore it.
                let link = e.target.closest("a");
                if (!link) return;

                // If the target is in a ref-hint panel
                // (aka a link in the already-open one),
                // also just ignore it.
                if (link.closest(".ref-hint")) return;

                // Otherwise, show the panel for the link.
                showRefHint(link);
            }

            function hideAllHintsListener(e) {
                // If the click is inside a ref-hint panel, ignore it.
                if (e.target.closest(".ref-hint")) return;
                // Otherwise, close all the current panels.
                hideAllRefHints();
            }

            document.addEventListener("DOMContentLoaded", () => {
                document.body.addEventListener("mousedown", showRefHintListener);
                document.body.addEventListener("focus", showRefHintListener);

                document.body.addEventListener("click", hideAllHintsListener);
            });

            window.addEventListener("resize", () => {
                // Hide any open ref hint.
                hideAllRefHints();
            });
        }
    </script>
    <script>/* Boilerplate: script-wpt */
        "use strict";
        {
            let wptData = {
                "paths": ["/css/css-color-hdr/"],
            };

            document.addEventListener("DOMContentLoaded", async () => {
                if (wptData.paths.length == 0) return;

                const runsUrl = "https://wpt.fyi/api/runs?label=master&label=stable&max-count=1&product=chrome&product=firefox&product=safari&product=edge";
                const runs = await (await fetch(runsUrl)).json();

                let testResults = [];
                for (const pathPrefix of wptData.paths) {
                    const pathResults = await (await fetch("https://wpt.fyi/api/search", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            "run_ids": runs.map(x => x.id),
                            "query": { "path": pathPrefix },
                        })
                    })).json();
                    testResults = testResults.concat(pathResults.results);
                }

                const browsers = runs.map(x => ({ name: x.browser_name, version: x.browser_version, passes: 0, total: 0 }));
                const resultsFromPath = new Map(testResults.map(result => {
                    const testPath = result.test;
                    const passes = result.legacy_status.map(x => [x.passes, x.total]);
                    return [testPath, passes];
                }));
                const seenTests = new Set();
                document.querySelectorAll(".wpt-name").forEach(nameEl => {
                    const passData = resultsFromPath.get("/" + nameEl.getAttribute("title"));
                    if (!passData) {
                        console.log("Couldn't find test in results:", nameEl);
                        return
                    }
                    const numTests = passData[0][1];
                    if (numTests > 1) {
                        nameEl.insertAdjacentElement("beforeend",
                            mk.small({}, ` (${numTests} tests)`));
                    }
                    if (passData == undefined) return;
                    const resultsEl = mk.span({ "class": "wpt-results" },
                        ...passData.map((p, i) => mk.span(
                            {
                                "title": `${browsers[i].name} ${p[0]}/${p[1]}`,
                                "class": "wpt-result",
                                "style": `background: conic-gradient(forestgreen ${p[0] / p[1] * 360}deg, darkred 0deg);`,
                            })),
                    );
                    nameEl.insertAdjacentElement("afterend", resultsEl);

                    // Only update the summary pass/total count if we haven't seen this
                    // test before, to support authors listing the same test multiple times
                    // in a spec.
                    if (!seenTests.has(nameEl.getAttribute("title"))) {
                        seenTests.add(nameEl.getAttribute("title"));
                        passData.forEach((p, i) => {
                            browsers[i].passes += p[0];
                            browsers[i].total += p[1];
                        });
                    }
                });
                const overview = document.querySelector(".wpt-overview");
                if (overview) {
                    overview.appendChild(mk.ul({}, ...browsers.map(formatWptResult)));
                    document.head.appendChild(mk.style({},
                        `.wpt-overview ul { display: flex; flex-flow: row wrap; gap: .2em; justify-content: start; list-style: none; padding: 0; margin: 0;}
             .wpt-overview li { padding: .25em 1em; color: black; text-align: center; }
             .wpt-overview img { height: 1.5em; height: max(1.5em, 32px); background: transparent; }
             .wpt-overview .browser { font-weight: bold; }
             .wpt-overview .passes-none { background: #e57373; }
             .wpt-overview .passes-hardly { background: #ffb74d; }
             .wpt-overview .passes-a-few { background: #ffd54f; }
             .wpt-overview .passes-half { background: #fff176; }
             .wpt-overview .passes-lots { background: #dce775; }
             .wpt-overview .passes-most { background: #aed581; }
             .wpt-overview .passes-all { background: #81c784; }`));
                }
            });

            function formatWptResult({ name, version, passes, total }) {
                const passRate = passes / total;
                let passClass = "";
                if (passRate == 0) passClass = "passes-none";
                else if (passRate < .2) passClass = "passes-hardly";
                else if (passRate < .4) passClass = "passes-a-few";
                else if (passRate < .6) passClass = "passes-half";
                else if (passRate < .8) passClass = "passes-lots";
                else if (passRate < 1) passClass = "passes-most";
                else passClass = "passes-all";

                name = name[0].toUpperCase() + name.slice(1);
                const shortVersion = /^\d+/.exec(version);
                const icon = []

                if (name == "Chrome") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/chrome_64x64.png" }));
                if (name == "Edge") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/edge_64x64.png" }));
                if (name == "Safari") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/safari_64x64.png" }));
                if (name == "Firefox") icon.push(mk.img({ alt: "", src: "https://wpt.fyi/static/firefox_64x64.png" }));

                return mk.li({ "class": passClass },
                    mk.nobr({ 'class': 'browser' }, ...icon, ` ${name} ${shortVersion}`),
                    mk.br(),
                    mk.nobr({ 'class': 'pass-rate' }, `${passes}/${total}`)
                );
            }
        }
    </script>
    <script src="/dropdown.js"></script>